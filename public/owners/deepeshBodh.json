{
  "owner": {
    "id": "deepeshBodh",
    "display_name": "deepeshBodh",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/178582603?u=10795333a93e3d456db50c6787a1a26bee011a06&v=4",
    "url": "https://github.com/deepeshBodh",
    "bio": null,
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 6,
      "total_skills": 16,
      "total_stars": 3,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "deepeshBodh/human-in-loop",
      "url": "https://github.com/deepeshBodh/human-in-loop",
      "description": "SPEC-first multi-agent framework for Claude Code.",
      "homepage": "https://www.humaninloop.dev/",
      "signals": {
        "stars": 3,
        "forks": 0,
        "pushed_at": "2026-01-07T04:49:57Z",
        "created_at": "2025-12-31T13:01:30Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 485
        },
        {
          "path": ".claude",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude/agents/release-manager.md",
          "type": "blob",
          "size": 28430
        },
        {
          "path": ".claude/settings.json",
          "type": "blob",
          "size": 27
        },
        {
          "path": ".gitignore",
          "type": "blob",
          "size": 946
        },
        {
          "path": ".humaninloop",
          "type": "tree",
          "size": null
        },
        {
          "path": ".humaninloop/memory",
          "type": "tree",
          "size": null
        },
        {
          "path": ".humaninloop/memory/constitution.md",
          "type": "blob",
          "size": 5191
        },
        {
          "path": "CHANGELOG.md",
          "type": "blob",
          "size": 28436
        },
        {
          "path": "CLAUDE.md",
          "type": "blob",
          "size": 7894
        },
        {
          "path": "CONTRIBUTING.md",
          "type": "blob",
          "size": 4407
        },
        {
          "path": "LICENSE",
          "type": "blob",
          "size": 1068
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 4177
        },
        {
          "path": "RELEASES.md",
          "type": "blob",
          "size": 3018
        },
        {
          "path": "ROADMAP.md",
          "type": "blob",
          "size": 2426
        },
        {
          "path": "docs",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/agent-skills-documentation.md",
          "type": "blob",
          "size": 43468
        },
        {
          "path": "docs/claude-plugin-documentation.md",
          "type": "blob",
          "size": 31558
        },
        {
          "path": "docs/decisions",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/decisions/001-multi-agent-architecture.md",
          "type": "blob",
          "size": 2503
        },
        {
          "path": "docs/decisions/002-claude-code-native.md",
          "type": "blob",
          "size": 2396
        },
        {
          "path": "docs/decisions/003-brownfield-first.md",
          "type": "blob",
          "size": 2690
        },
        {
          "path": "docs/decisions/004-skill-augmented-agents.md",
          "type": "blob",
          "size": 5945
        },
        {
          "path": "docs/decisions/005-decoupled-agents-architecture.md",
          "type": "blob",
          "size": 12393
        },
        {
          "path": "docs/decisions/README.md",
          "type": "blob",
          "size": 1594
        },
        {
          "path": "docs/images",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/images/hero.png",
          "type": "blob",
          "size": 36181
        },
        {
          "path": "docs/internal",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/internal/feedback",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/internal/feedback/_template.md",
          "type": "blob",
          "size": 2255
        },
        {
          "path": "docs/internal/feedback/methodology.md",
          "type": "blob",
          "size": 5477
        },
        {
          "path": "docs/internal/feedback/round-1.md",
          "type": "blob",
          "size": 7201
        },
        {
          "path": "docs/speckit-artefacts",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/speckit-artefacts/.claude",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.analyze.md",
          "type": "blob",
          "size": 7175
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.checklist.md",
          "type": "blob",
          "size": 16809
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.clarify.md",
          "type": "blob",
          "size": 11335
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.constitution.md",
          "type": "blob",
          "size": 5247
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.implement.md",
          "type": "blob",
          "size": 7503
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.plan.md",
          "type": "blob",
          "size": 3120
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.specify.md",
          "type": "blob",
          "size": 12838
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.tasks.md",
          "type": "blob",
          "size": 6331
        },
        {
          "path": "docs/speckit-artefacts/.claude/speckit.taskstoissues.md",
          "type": "blob",
          "size": 1089
        },
        {
          "path": "docs/speckit-artefacts/.specify",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/speckit-artefacts/.specify/memory",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/speckit-artefacts/.specify/memory/constitution.md",
          "type": "blob",
          "size": 2346
        },
        {
          "path": "docs/speckit-artefacts/.specify/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/speckit-artefacts/.specify/scripts/bash",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/speckit-artefacts/.specify/scripts/bash/check-prerequisites.sh",
          "type": "blob",
          "size": 4985
        },
        {
          "path": "docs/speckit-artefacts/.specify/scripts/bash/common.sh",
          "type": "blob",
          "size": 4901
        },
        {
          "path": "docs/speckit-artefacts/.specify/scripts/bash/create-new-feature.sh",
          "type": "blob",
          "size": 10191
        },
        {
          "path": "docs/speckit-artefacts/.specify/scripts/bash/setup-plan.sh",
          "type": "blob",
          "size": 1627
        },
        {
          "path": "docs/speckit-artefacts/.specify/scripts/bash/update-agent-context.sh",
          "type": "blob",
          "size": 25556
        },
        {
          "path": "docs/speckit-artefacts/.specify/templates",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/speckit-artefacts/.specify/templates/agent-file-template.md",
          "type": "blob",
          "size": 464
        },
        {
          "path": "docs/speckit-artefacts/.specify/templates/checklist-template.md",
          "type": "blob",
          "size": 1312
        },
        {
          "path": "docs/speckit-artefacts/.specify/templates/plan-template.md",
          "type": "blob",
          "size": 3671
        },
        {
          "path": "docs/speckit-artefacts/.specify/templates/spec-template.md",
          "type": "blob",
          "size": 3960
        },
        {
          "path": "docs/speckit-artefacts/.specify/templates/tasks-template.md",
          "type": "blob",
          "size": 9177
        },
        {
          "path": "plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 672
        },
        {
          "path": "plugins/humaninloop/README.md",
          "type": "blob",
          "size": 12507
        },
        {
          "path": "plugins/humaninloop/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/agents/devils-advocate.md",
          "type": "blob",
          "size": 6171
        },
        {
          "path": "plugins/humaninloop/agents/plan-architect.md",
          "type": "blob",
          "size": 8845
        },
        {
          "path": "plugins/humaninloop/agents/principal-architect.md",
          "type": "blob",
          "size": 3898
        },
        {
          "path": "plugins/humaninloop/agents/requirements-analyst.md",
          "type": "blob",
          "size": 3218
        },
        {
          "path": "plugins/humaninloop/agents/task-architect.md",
          "type": "blob",
          "size": 8019
        },
        {
          "path": "plugins/humaninloop/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/commands/audit.md",
          "type": "blob",
          "size": 9050
        },
        {
          "path": "plugins/humaninloop/commands/implement.md",
          "type": "blob",
          "size": 11791
        },
        {
          "path": "plugins/humaninloop/commands/plan.md",
          "type": "blob",
          "size": 18695
        },
        {
          "path": "plugins/humaninloop/commands/setup.md",
          "type": "blob",
          "size": 16880
        },
        {
          "path": "plugins/humaninloop/commands/specify.md",
          "type": "blob",
          "size": 13047
        },
        {
          "path": "plugins/humaninloop/commands/tasks.md",
          "type": "blob",
          "size": 15723
        },
        {
          "path": "plugins/humaninloop/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/scripts/check-prerequisites.sh",
          "type": "blob",
          "size": 5697
        },
        {
          "path": "plugins/humaninloop/scripts/common.sh",
          "type": "blob",
          "size": 4917
        },
        {
          "path": "plugins/humaninloop/scripts/create-new-feature.sh",
          "type": "blob",
          "size": 10651
        },
        {
          "path": "plugins/humaninloop/scripts/setup-plan.sh",
          "type": "blob",
          "size": 2628
        },
        {
          "path": "plugins/humaninloop/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/analysis-codebase",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/analysis-codebase/BROWNFIELD-ANALYSIS.md",
          "type": "blob",
          "size": 4263
        },
        {
          "path": "plugins/humaninloop/skills/analysis-codebase/CONTEXT-GATHERING.md",
          "type": "blob",
          "size": 4398
        },
        {
          "path": "plugins/humaninloop/skills/analysis-codebase/SKILL.md",
          "type": "blob",
          "size": 10937
        },
        {
          "path": "plugins/humaninloop/skills/analysis-codebase/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/analysis-codebase/scripts/detect-stack.sh",
          "type": "blob",
          "size": 13040
        },
        {
          "path": "plugins/humaninloop/skills/analysis-iterative",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/analysis-iterative/SKILL.md",
          "type": "blob",
          "size": 5343
        },
        {
          "path": "plugins/humaninloop/skills/analysis-iterative/SYNTHESIS.md",
          "type": "blob",
          "size": 2219
        },
        {
          "path": "plugins/humaninloop/skills/analysis-specifications",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/analysis-specifications/SKILL.md",
          "type": "blob",
          "size": 4605
        },
        {
          "path": "plugins/humaninloop/skills/authoring-constitution",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/authoring-constitution/RFC-2119-KEYWORDS.md",
          "type": "blob",
          "size": 6181
        },
        {
          "path": "plugins/humaninloop/skills/authoring-constitution/SKILL.md",
          "type": "blob",
          "size": 9932
        },
        {
          "path": "plugins/humaninloop/skills/authoring-constitution/SYNC-IMPACT-FORMAT.md",
          "type": "blob",
          "size": 8995
        },
        {
          "path": "plugins/humaninloop/skills/authoring-requirements",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/authoring-requirements/EDGE-CASES.md",
          "type": "blob",
          "size": 5548
        },
        {
          "path": "plugins/humaninloop/skills/authoring-requirements/RFC-2119-KEYWORDS.md",
          "type": "blob",
          "size": 5535
        },
        {
          "path": "plugins/humaninloop/skills/authoring-requirements/SKILL.md",
          "type": "blob",
          "size": 5167
        },
        {
          "path": "plugins/humaninloop/skills/authoring-requirements/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/authoring-requirements/scripts/validate-requirements.py",
          "type": "blob",
          "size": 8748
        },
        {
          "path": "plugins/humaninloop/skills/authoring-roadmap",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/authoring-roadmap/SKILL.md",
          "type": "blob",
          "size": 7226
        },
        {
          "path": "plugins/humaninloop/skills/authoring-user-stories",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/authoring-user-stories/EXAMPLES.md",
          "type": "blob",
          "size": 5525
        },
        {
          "path": "plugins/humaninloop/skills/authoring-user-stories/PRIORITY-DEFINITIONS.md",
          "type": "blob",
          "size": 3608
        },
        {
          "path": "plugins/humaninloop/skills/authoring-user-stories/SKILL.md",
          "type": "blob",
          "size": 3775
        },
        {
          "path": "plugins/humaninloop/skills/authoring-user-stories/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/authoring-user-stories/scripts/validate-user-stories.py",
          "type": "blob",
          "size": 8626
        },
        {
          "path": "plugins/humaninloop/skills/brownfield-constitution",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/brownfield-constitution/EMERGENT-CEILING-PATTERNS.md",
          "type": "blob",
          "size": 10793
        },
        {
          "path": "plugins/humaninloop/skills/brownfield-constitution/ESSENTIAL-FLOOR.md",
          "type": "blob",
          "size": 6358
        },
        {
          "path": "plugins/humaninloop/skills/brownfield-constitution/SKILL.md",
          "type": "blob",
          "size": 5692
        },
        {
          "path": "plugins/humaninloop/skills/patterns-api-contracts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/patterns-api-contracts/ERROR-PATTERNS.md",
          "type": "blob",
          "size": 9949
        },
        {
          "path": "plugins/humaninloop/skills/patterns-api-contracts/OPENAPI-TEMPLATE.yaml",
          "type": "blob",
          "size": 22940
        },
        {
          "path": "plugins/humaninloop/skills/patterns-api-contracts/PAGINATION-PATTERNS.md",
          "type": "blob",
          "size": 11157
        },
        {
          "path": "plugins/humaninloop/skills/patterns-api-contracts/SKILL.md",
          "type": "blob",
          "size": 6094
        },
        {
          "path": "plugins/humaninloop/skills/patterns-api-contracts/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/patterns-api-contracts/scripts/validate-openapi.py",
          "type": "blob",
          "size": 14016
        },
        {
          "path": "plugins/humaninloop/skills/patterns-entity-modeling",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/patterns-entity-modeling/RELATIONSHIP-PATTERNS.md",
          "type": "blob",
          "size": 5737
        },
        {
          "path": "plugins/humaninloop/skills/patterns-entity-modeling/SKILL.md",
          "type": "blob",
          "size": 7570
        },
        {
          "path": "plugins/humaninloop/skills/patterns-entity-modeling/STATE-MACHINES.md",
          "type": "blob",
          "size": 4297
        },
        {
          "path": "plugins/humaninloop/skills/patterns-entity-modeling/VALIDATION-RULES.md",
          "type": "blob",
          "size": 6845
        },
        {
          "path": "plugins/humaninloop/skills/patterns-entity-modeling/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/patterns-entity-modeling/scripts/validate-model.py",
          "type": "blob",
          "size": 14043
        },
        {
          "path": "plugins/humaninloop/skills/patterns-technical-decisions",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/patterns-technical-decisions/DECISION-RECORD.md",
          "type": "blob",
          "size": 5243
        },
        {
          "path": "plugins/humaninloop/skills/patterns-technical-decisions/EVALUATION-MATRIX.md",
          "type": "blob",
          "size": 4401
        },
        {
          "path": "plugins/humaninloop/skills/patterns-technical-decisions/SKILL.md",
          "type": "blob",
          "size": 4214
        },
        {
          "path": "plugins/humaninloop/skills/patterns-vertical-tdd",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/patterns-vertical-tdd/CYCLE-STRUCTURE.md",
          "type": "blob",
          "size": 9467
        },
        {
          "path": "plugins/humaninloop/skills/patterns-vertical-tdd/SKILL.md",
          "type": "blob",
          "size": 6633
        },
        {
          "path": "plugins/humaninloop/skills/patterns-vertical-tdd/SLICE-IDENTIFICATION.md",
          "type": "blob",
          "size": 4727
        },
        {
          "path": "plugins/humaninloop/skills/syncing-claude-md",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/syncing-claude-md/SECTION-TEMPLATES.md",
          "type": "blob",
          "size": 4291
        },
        {
          "path": "plugins/humaninloop/skills/syncing-claude-md/SKILL.md",
          "type": "blob",
          "size": 5769
        },
        {
          "path": "plugins/humaninloop/skills/syncing-claude-md/SYNC-PATTERNS.md",
          "type": "blob",
          "size": 5836
        },
        {
          "path": "plugins/humaninloop/skills/validation-constitution",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/validation-constitution/ANTI-PATTERNS.md",
          "type": "blob",
          "size": 2529
        },
        {
          "path": "plugins/humaninloop/skills/validation-constitution/QUALITY-CHECKLIST.md",
          "type": "blob",
          "size": 1791
        },
        {
          "path": "plugins/humaninloop/skills/validation-constitution/SKILL.md",
          "type": "blob",
          "size": 3150
        },
        {
          "path": "plugins/humaninloop/skills/validation-plan-artifacts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/validation-plan-artifacts/ISSUE-TEMPLATES.md",
          "type": "blob",
          "size": 3977
        },
        {
          "path": "plugins/humaninloop/skills/validation-plan-artifacts/PHASE-CHECKLISTS.md",
          "type": "blob",
          "size": 5549
        },
        {
          "path": "plugins/humaninloop/skills/validation-plan-artifacts/SKILL.md",
          "type": "blob",
          "size": 3168
        },
        {
          "path": "plugins/humaninloop/skills/validation-plan-artifacts/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/validation-plan-artifacts/scripts/check-artifacts.py",
          "type": "blob",
          "size": 13092
        },
        {
          "path": "plugins/humaninloop/skills/validation-task-artifacts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/skills/validation-task-artifacts/ISSUE-TEMPLATES.md",
          "type": "blob",
          "size": 5926
        },
        {
          "path": "plugins/humaninloop/skills/validation-task-artifacts/PHASE-CHECKLISTS.md",
          "type": "blob",
          "size": 6134
        },
        {
          "path": "plugins/humaninloop/skills/validation-task-artifacts/SKILL.md",
          "type": "blob",
          "size": 3850
        },
        {
          "path": "plugins/humaninloop/templates",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/humaninloop/templates/advocate-report-template.md",
          "type": "blob",
          "size": 768
        },
        {
          "path": "plugins/humaninloop/templates/analyst-report-template.md",
          "type": "blob",
          "size": 551
        },
        {
          "path": "plugins/humaninloop/templates/codebase-analysis-template.md",
          "type": "blob",
          "size": 4362
        },
        {
          "path": "plugins/humaninloop/templates/codebase-inventory-schema.json",
          "type": "blob",
          "size": 17089
        },
        {
          "path": "plugins/humaninloop/templates/constitution-context-template.md",
          "type": "blob",
          "size": 2273
        },
        {
          "path": "plugins/humaninloop/templates/constitution-template.md",
          "type": "blob",
          "size": 10153
        },
        {
          "path": "plugins/humaninloop/templates/context-template.md",
          "type": "blob",
          "size": 728
        },
        {
          "path": "plugins/humaninloop/templates/evolution-roadmap-template.md",
          "type": "blob",
          "size": 4302
        },
        {
          "path": "plugins/humaninloop/templates/plan-advocate-report-template.md",
          "type": "blob",
          "size": 3095
        },
        {
          "path": "plugins/humaninloop/templates/plan-context-template.md",
          "type": "blob",
          "size": 960
        },
        {
          "path": "plugins/humaninloop/templates/plan-template.md",
          "type": "blob",
          "size": 3571
        },
        {
          "path": "plugins/humaninloop/templates/planner-report-template.md",
          "type": "blob",
          "size": 1047
        },
        {
          "path": "plugins/humaninloop/templates/spec-template.md",
          "type": "blob",
          "size": 434
        },
        {
          "path": "plugins/humaninloop/templates/tasks-context-template.md",
          "type": "blob",
          "size": 1061
        },
        {
          "path": "plugins/humaninloop/templates/tasks-template.md",
          "type": "blob",
          "size": 6287
        },
        {
          "path": "specs",
          "type": "tree",
          "size": null
        },
        {
          "path": "specs/README.md",
          "type": "blob",
          "size": 1261
        },
        {
          "path": "specs/completed",
          "type": "tree",
          "size": null
        },
        {
          "path": "specs/completed/.gitkeep",
          "type": "blob",
          "size": 71
        },
        {
          "path": "specs/in-progress",
          "type": "tree",
          "size": null
        },
        {
          "path": "specs/in-progress/.gitkeep",
          "type": "blob",
          "size": 83
        },
        {
          "path": "specs/planned",
          "type": "tree",
          "size": null
        },
        {
          "path": "specs/planned/.gitkeep",
          "type": "blob",
          "size": 82
        }
      ],
      "marketplace": {
        "name": "humaninloop-plugins",
        "version": "0.7.7",
        "description": "Multi-agent workflow plugins for specification-driven development",
        "owner_info": {
          "name": "HumanInLoop",
          "email": "support@humaninloop.dev",
          "url": "https://humaninloop.dev"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "humaninloop",
            "description": "Specification-driven development workflow: setup → specify → plan → tasks → implement",
            "source": "./plugins/humaninloop",
            "category": null,
            "version": null,
            "author": null,
            "install_commands": [
              "/plugin marketplace add deepeshBodh/human-in-loop",
              "/plugin install humaninloop@humaninloop-plugins"
            ],
            "signals": {
              "stars": 3,
              "forks": 0,
              "pushed_at": "2026-01-07T04:49:57Z",
              "created_at": "2025-12-31T13:01:30Z",
              "license": "MIT"
            },
            "commands": [
              {
                "name": "/audit",
                "description": "Comprehensive artifact analysis with reviewer-friendly output mode. Consolidates checklist and analyze functionality.",
                "path": "plugins/humaninloop/commands/audit.md",
                "frontmatter": {
                  "description": "Comprehensive artifact analysis with reviewer-friendly output mode. Consolidates checklist and analyze functionality."
                },
                "content": "# Audit Command\n\nComprehensive analysis of feature artifacts with two output modes:\n- **Full mode** (default): Deep diagnostics for authors/maintainers\n- **Review mode** (`--review`): Scannable summary for peer reviewers\n\n## User Input\n\n```text\n$ARGUMENTS\n```\n\n### Parsing Arguments\n\nParse `$ARGUMENTS` for:\n- `--review`: Enable review mode (scannable summary output)\n- `--full`: Explicit full mode (default behavior)\n- `--security`, `--ux`, `--api`, `--performance`: Domain filters\n- Feature ID or path (optional)\n\nIf `$ARGUMENTS` is empty, proceed with full mode on auto-detected feature.\n\n### Empty Input Check\n\nIf `$ARGUMENTS` is empty (blank string with no content), use AskUserQuestion to handle a known Claude Code bug where inputs containing `@` file references don't reach plugin commands:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"Known Issue: Input may have been lost\\n\\nClaude Code has a bug where inputs containing @ file references don't reach plugin commands.\\n\\nWould you like to re-enter your input?\",\n    header: \"Input\",\n    options: [\n      {label: \"Re-enter input\", description: \"I'll type my input in the terminal\"},\n      {label: \"Continue without input\", description: \"Proceed with auto-detected feature\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\n---\n\n## Operating Constraints\n\n**STRICTLY READ-ONLY**: Do **not** modify any files. Output analysis report only.\n\n**Constitution Authority**: The project constitution (`.humaninloop/memory/constitution.md`) is **non-negotiable**. Constitution conflicts are automatically CRITICAL severity.\n\n---\n\n## Execution Steps\n\n### 1. Initialize Context\n\nRun `${CLAUDE_PLUGIN_ROOT}/scripts/check-prerequisites.sh --json` from repo root and parse JSON for:\n- `FEATURE_DIR`: Active feature directory\n- `AVAILABLE_DOCS`: List of available artifacts\n\nDerive absolute paths for artifacts that exist:\n- SPEC = FEATURE_DIR/spec.md (if exists)\n- PLAN = FEATURE_DIR/plan.md (if exists)\n- TASKS = FEATURE_DIR/tasks.md (if exists)\n- RESEARCH = FEATURE_DIR/research.md (if exists)\n- DATA_MODEL = FEATURE_DIR/data-model.md (if exists)\n- CONTRACTS = FEATURE_DIR/contracts/ (if exists)\n\n**No artifacts required**: Unlike analyze, this command works on whatever exists.\n\nFor single quotes in args, use escape syntax: e.g., `'I'\\''m Groot'` (or double-quote: `\"I'm Groot\"`).\n\n### 2. Load Constitution\n\nLoad `.humaninloop/memory/constitution.md` if it exists:\n- Extract principle names and MUST/SHOULD normative statements\n- These become validation criteria\n\nIf constitution doesn't exist, note this in output but continue.\n\n### 3. Detect Artifacts and Load Context\n\nFor each artifact that exists, load relevant sections:\n\n**From spec.md:**\n- Overview/Context\n- User Stories (count and IDs)\n- Functional Requirements (count and IDs)\n- Non-Functional Requirements\n- Edge Cases\n- Success Criteria\n\n**From plan.md / research.md / data-model.md:**\n- Key decisions\n- Entities defined\n- Technical constraints\n\n**From tasks.md:**\n- Cycle count\n- Task count\n- Phase groupings\n- Coverage markers\n\n**From contracts/:**\n- Endpoint count\n- Schema definitions\n\n### 4. Execute Analysis Passes\n\nUse existing skills for artifact-specific validation:\n\n#### 4a. Specification Analysis\n\nIf spec.md exists, apply `analysis-specifications` skill criteria:\n- User story completeness\n- Requirement clarity (vague terms flagged)\n- Success criteria measurability\n- Edge case coverage\n\n#### 4b. Plan Artifact Analysis\n\nIf plan artifacts exist, apply `validation-plan-artifacts` skill criteria:\n- Research decision quality\n- Data model entity coverage\n- Contract endpoint coverage\n- Cross-artifact consistency\n\n#### 4c. Task Artifact Analysis\n\nIf tasks.md exists, apply `validation-task-artifacts` skill criteria:\n- Story-to-cycle mapping\n- TDD structure (test-first)\n- Vertical slice integrity\n- File path specificity\n\n#### 4d. Cross-Artifact Analysis\n\nRun these detection passes across all artifacts:\n\n| Pass | Description |\n|------|-------------|\n| **Duplication** | Near-duplicate requirements across files |\n| **Ambiguity** | Vague terms without measurable criteria (fast, scalable, secure, intuitive) |\n| **Underspecification** | Requirements with verbs but missing outcomes |\n| **Constitution Alignment** | Violations of MUST principles |\n| **Coverage Gaps** | Requirements with no corresponding tasks |\n| **Inconsistency** | Terminology drift, entity mismatches, conflicting statements |\n\n### 5. Classify Findings\n\nAssign severity to each finding:\n\n| Severity | Definition |\n|----------|------------|\n| **CRITICAL** | Blocks progress: constitution violation, missing core artifact, zero-coverage requirement |\n| **HIGH** | Significant gap: duplicate/conflicting requirement, untestable criterion |\n| **MEDIUM** | Quality issue: terminology drift, missing NFR coverage, underspecified edge case |\n| **LOW** | Polish: wording improvements, minor redundancy |\n\n### 6. Generate Output\n\nOutput format depends on mode:\n\n---\n\n## Review Mode Output (`--review`)\n\nScannable summary for peer reviewers:\n\n```markdown\n# Audit Summary: {feature-id}\n\n**Mode**: Review | **Generated**: {date}\n**Artifacts**: {list with checkmarks}\n\n---\n\n## Coverage\n\n| Category | Status | Count | Reference |\n|----------|--------|-------|-----------|\n| User Stories | {status} | {n/total} | Spec US |\n| Functional Reqs | {status} | {n/total} | Spec FR |\n| Non-Functional | {status} | {n/total} | Spec NFR |\n| Edge Cases | {status} | {n/total} | Spec EC |\n| Task Coverage | {status} | {n/total} | Tasks |\n\nStatus key: ✓ Complete | ⚠ Partial | ✗ Gaps\n\n---\n\n## Flagged Issues ({count})\n\n| ID | Severity | Issue | Location |\n|----|----------|-------|----------|\n{top issues, max 10}\n\n---\n\n## Metrics\n\n- **Coverage**: {pct}% ({covered}/{total} requirements with tasks)\n- **Critical Issues**: {count}\n- **Important Issues**: {count}\n- **Minor Issues**: {count}\n\n---\n\n## Recommendation\n\n{verdict with one-line rationale}\n```\n\n**Verdict options:**\n- `Ready for review` - No critical/high issues\n- `Review with caution` - Has high-severity issues to note\n- `Not ready` - Has critical issues blocking progress\n\n---\n\n## Full Mode Output (default)\n\nDetailed diagnostics for authors/maintainers:\n\n```markdown\n# Audit Report: {feature-id}\n\n**Mode**: Full | **Generated**: {date}\n**Artifacts Analyzed**: {list}\n\n---\n\n## Findings\n\n| ID | Category | Severity | Location(s) | Summary | Recommendation |\n|----|----------|----------|-------------|---------|----------------|\n{all findings, max 50}\n\n---\n\n## Coverage Summary\n\n| Requirement | Has Task? | Task IDs | Notes |\n|-------------|-----------|----------|-------|\n{coverage mapping}\n\n---\n\n## Constitution Alignment\n\n{issues or \"No violations detected\"}\n\n---\n\n## Unmapped Items\n\n**Requirements without tasks:**\n{list or \"None\"}\n\n**Tasks without requirements:**\n{list or \"None\"}\n\n---\n\n## Metrics\n\n- Total Requirements: {count}\n- Total Tasks: {count}\n- Coverage: {pct}%\n- Findings by Severity:\n  - Critical: {count}\n  - High: {count}\n  - Medium: {count}\n  - Low: {count}\n\n---\n\n## Next Actions\n\n{prioritized recommendations based on findings}\n```\n\n---\n\n## Domain Filters\n\nWhen domain filter is specified (`--security`, `--ux`, `--api`, `--performance`):\n\n1. Focus analysis on domain-relevant sections\n2. Prioritize domain-specific checks\n3. Filter output to domain-relevant findings\n4. Adjust coverage metrics to domain scope\n\n| Filter | Focus Areas |\n|--------|-------------|\n| `--security` | Auth, permissions, data protection, input validation, secrets |\n| `--ux` | User flows, error messages, accessibility, responsiveness |\n| `--api` | Endpoints, schemas, error handling, versioning, rate limits |\n| `--performance` | Latency, throughput, caching, optimization, load handling |\n\n---\n\n## Remediation Offer (Full Mode Only)\n\nAfter full mode output, offer remediation:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"Would you like suggestions for resolving the top issues?\",\n    header: \"Remediation\",\n    options: [\n      {label: \"Yes\", description: \"Show concrete fix suggestions\"},\n      {label: \"No\", description: \"I'll handle it myself\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\nIf yes, provide specific remediation suggestions for top 5 issues. Do NOT apply changes automatically.\n\n---\n\n## Examples\n\n### Review Mode\n\n```bash\n/humaninloop:audit --review\n```\n\nOutput: Scannable coverage summary with flagged issues for PR review.\n\n### Full Mode with Domain Filter\n\n```bash\n/humaninloop:audit --security\n```\n\nOutput: Detailed security-focused analysis with all findings.\n\n### Review Mode with Domain Filter\n\n```bash\n/humaninloop:audit --review --ux\n```\n\nOutput: UX-focused coverage summary for design review.\n\n---\n\n## Background\n\nThis command consolidates functionality that was previously split across two commands:\n- **Checklist functionality** → Now available via `audit --review`\n- **Analyze functionality** → Now available via `audit` (default mode)"
              },
              {
                "name": "/implement",
                "description": "Execute the implementation plan by processing and executing all tasks defined in tasks.md",
                "path": "plugins/humaninloop/commands/implement.md",
                "frontmatter": {
                  "description": "Execute the implementation plan by processing and executing all tasks defined in tasks.md"
                },
                "content": "## User Input\n\n```text\n$ARGUMENTS\n```\n\nYou **MUST** consider the user input before proceeding (if not empty).\n\n### Empty Input Check\n\nIf `$ARGUMENTS` is empty (blank string with no content), use AskUserQuestion to handle a known Claude Code bug where inputs containing `@` file references don't reach plugin commands:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"⚠️ Known Issue: Input may have been lost\\n\\nClaude Code has a bug where inputs containing @ file references don't reach plugin commands.\\n\\nWould you like to re-enter your input?\",\n    header: \"Input\",\n    options: [\n      {label: \"Re-enter input\", description: \"I'll type my input in the terminal\"},\n      {label: \"Continue without input\", description: \"Proceed with no input provided\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\n- If user selects \"Re-enter input\" → wait for user to type their input in the terminal, then use that as the effective `$ARGUMENTS`\n- If user selects \"Continue without input\" → proceed with empty input (existing behavior)\n\n## Outline\n\n1. Run `${CLAUDE_PLUGIN_ROOT}/scripts/check-prerequisites.sh --json --require-tasks --include-tasks` from repo root and parse FEATURE_DIR and AVAILABLE_DOCS list. All paths must be absolute. For single quotes in args like \"I'm Groot\", use escape syntax: e.g 'I'\\''m Groot' (or double-quote if possible: \"I'm Groot\").\n\n1.5. **Entry Gate: Verify Tasks Workflow Complete**\n\n   Check if the tasks workflow completed successfully before proceeding:\n\n   **1.5.1 Check for tasks-context.md**:\n   ```bash\n   test -f {FEATURE_DIR}/.workflow/tasks-context.md\n   ```\n\n   **1.5.2 If found**: Read frontmatter and check `status` field\n\n   **1.5.3 Route based on status**:\n\n   | Status | Action |\n   |--------|--------|\n   | `completed` | Proceed to step 2 |\n   | `awaiting-architect` / `awaiting-advocate` / `awaiting-user` | Tasks workflow incomplete - prompt user |\n   | Not found | No workflow context - proceed with warning |\n\n   **If status is not `completed`**:\n   ```\n   AskUserQuestion(\n     questions: [{\n       question: \"Tasks workflow not complete (status: {status}). Implementation requires completed tasks.\\n\\nPhase: {phase}, Iteration: {iteration}\",\n       header: \"Entry Gate\",\n       options: [\n         {label: \"Complete tasks first\", description: \"Return to /humaninloop:tasks to finish\"},\n         {label: \"Proceed anyway\", description: \"Implement with current tasks.md (may be incomplete)\"},\n         {label: \"Abort\", description: \"Cancel implementation\"}\n       ],\n       multiSelect: false\n     }]\n   )\n   ```\n\n   **1.5.4 Optional context from workflow artifacts**:\n   - If `{FEATURE_DIR}/.workflow/planner-report.md` exists: Note any assumptions made by Task Architect\n   - If `{FEATURE_DIR}/.workflow/advocate-report.md` exists: Note any known gaps/limitations flagged\n\n2. Load and analyze the implementation context:\n   - **REQUIRED**: Read tasks.md for the complete task list and execution plan\n   - **REQUIRED**: Read plan.md for tech stack, architecture, and file structure\n   - **IF EXISTS**: Read task-mapping.md for:\n     - Story-to-cycle mapping and coverage verification\n     - Cycle dependencies and parallel opportunities\n     - Per-cycle deliverables with specific file paths\n     - Success criteria and traceability to requirements\n     - Risk assessment and mitigation strategies\n   - **IF EXISTS**: Read data-model.md for entities and relationships\n   - **IF EXISTS**: Read contracts/ for API specifications and test requirements\n   - **IF EXISTS**: Read research.md for technical decisions and constraints\n   - **IF EXISTS**: Read quickstart.md for integration scenarios\n\n3. **Project Setup Verification**:\n   - **REQUIRED**: Create/verify ignore files based on actual project setup:\n\n   **Detection & Creation Logic**:\n   - Check if the following command succeeds to determine if the repository is a git repo (create/verify .gitignore if so):\n\n     ```sh\n     git rev-parse --git-dir 2>/dev/null\n     ```\n\n   - Check if Dockerfile* exists or Docker in plan.md → create/verify .dockerignore\n   - Check if .eslintrc* exists → create/verify .eslintignore\n   - Check if eslint.config.* exists → ensure the config's `ignores` entries cover required patterns\n   - Check if .prettierrc* exists → create/verify .prettierignore\n   - Check if .npmrc or package.json exists → create/verify .npmignore (if publishing)\n   - Check if terraform files (*.tf) exist → create/verify .terraformignore\n   - Check if .helmignore needed (helm charts present) → create/verify .helmignore\n\n   **If ignore file already exists**: Verify it contains essential patterns, append missing critical patterns only\n   **If ignore file missing**: Create with full pattern set for detected technology\n\n   **Common Patterns by Technology** (from plan.md tech stack):\n   - **Node.js/JavaScript/TypeScript**: `node_modules/`, `dist/`, `build/`, `*.log`, `.env*`\n   - **Python**: `__pycache__/`, `*.pyc`, `.venv/`, `venv/`, `dist/`, `*.egg-info/`\n   - **Java**: `target/`, `*.class`, `*.jar`, `.gradle/`, `build/`\n   - **C#/.NET**: `bin/`, `obj/`, `*.user`, `*.suo`, `packages/`\n   - **Go**: `*.exe`, `*.test`, `vendor/`, `*.out`\n   - **Ruby**: `.bundle/`, `log/`, `tmp/`, `*.gem`, `vendor/bundle/`\n   - **PHP**: `vendor/`, `*.log`, `*.cache`, `*.env`\n   - **Rust**: `target/`, `debug/`, `release/`, `*.rs.bk`, `*.rlib`, `*.prof*`, `.idea/`, `*.log`, `.env*`\n   - **Kotlin**: `build/`, `out/`, `.gradle/`, `.idea/`, `*.class`, `*.jar`, `*.iml`, `*.log`, `.env*`\n   - **C++**: `build/`, `bin/`, `obj/`, `out/`, `*.o`, `*.so`, `*.a`, `*.exe`, `*.dll`, `.idea/`, `*.log`, `.env*`\n   - **C**: `build/`, `bin/`, `obj/`, `out/`, `*.o`, `*.a`, `*.so`, `*.exe`, `Makefile`, `config.log`, `.idea/`, `*.log`, `.env*`\n   - **Swift**: `.build/`, `DerivedData/`, `*.swiftpm/`, `Packages/`\n   - **R**: `.Rproj.user/`, `.Rhistory`, `.RData`, `.Ruserdata`, `*.Rproj`, `packrat/`, `renv/`\n   - **Universal**: `.DS_Store`, `Thumbs.db`, `*.tmp`, `*.swp`, `.vscode/`, `.idea/`\n\n   **Tool-Specific Patterns**:\n   - **Docker**: `node_modules/`, `.git/`, `Dockerfile*`, `.dockerignore`, `*.log*`, `.env*`, `coverage/`\n   - **ESLint**: `node_modules/`, `dist/`, `build/`, `coverage/`, `*.min.js`\n   - **Prettier**: `node_modules/`, `dist/`, `build/`, `coverage/`, `package-lock.json`, `yarn.lock`, `pnpm-lock.yaml`\n   - **Terraform**: `.terraform/`, `*.tfstate*`, `*.tfvars`, `.terraform.lock.hcl`\n   - **Kubernetes/k8s**: `*.secret.yaml`, `secrets/`, `.kube/`, `kubeconfig*`, `*.key`, `*.crt`\n\n4. Parse tasks.md structure and extract:\n\n   **4.1 Summary Metrics** (from `## Summary` table):\n   - Total cycles, foundation cycles, feature cycles\n   - Total tasks count\n   - Parallel opportunities (which cycles can run concurrently)\n\n   **4.2 Enrich with task-mapping.md** (if exists):\n   - Use `## Cycle Details` for per-cycle success criteria\n   - Use `## Dependency Graph` for visual verification of execution order\n   - Use `## Risk Assessment` to identify cycles needing extra care\n   - Use deliverable tables to verify expected file paths\n\n   **4.3 Foundation Cycles** (from `## Foundation Cycles (Sequential)`):\n   - These MUST complete in order (C1 → C2 → C3 → ...)\n   - Each cycle has: Stories, Dependencies, Type in metadata block\n   - Parse cycle headers: `### Cycle N: Title`\n\n   **4.4 Feature Cycles** (from `## Feature Cycles`):\n   - Can begin only after ALL foundation cycles complete\n   - Cycles marked `[P]` are parallel-eligible\n   - Parse cycle headers: `### Cycle N: Title [P]`\n   - Dependencies in metadata show required prior cycles\n\n   **4.5 Task Details**:\n   - Task pattern: `- [ ] **T{cycle}.{task}**: Description`\n   - File paths in backticks within description\n   - Brownfield markers `[EXTEND]` or `[MODIFY]` in task description\n   - Multi-line task descriptions with sub-bullets for details\n   - Checkpoint at end of each cycle defines done criteria\n\n   **4.6 Quality Gates** (from `## Quality Gates`):\n   - Build/lint requirements that apply to all cycles\n   - These should be verified after each cycle completes\n\n5. Execute implementation following the task plan:\n\n   **Cycle-based execution rules**:\n\n   **Foundation Cycles (Sequential)**:\n   - Execute C1 completely before starting C2, C2 before C3, etc.\n   - Within each cycle, execute tasks in order (T1.1 → T1.2 → T1.3 → ...)\n   - Each cycle starts with a failing test task (TN.1)\n   - Verify cycle checkpoint before proceeding to next cycle\n\n   **Feature Cycles (After Foundation)**:\n   - Only begin feature cycles after ALL foundation cycles complete\n   - Cycles marked `[P]` can execute in parallel with each other\n   - Non-parallel feature cycles respect their Dependencies metadata\n   - Within each cycle, execute tasks sequentially (TDD order)\n\n   **TDD Discipline**:\n   - Task TN.1 is always \"Write failing test\" - execute first\n   - Subsequent tasks implement code to make tests pass\n   - Final task in cycle is typically \"Demo and verify\"\n\n   **Checkpoints**:\n   - Each cycle ends with a `**Checkpoint**:` statement\n   - Verify checkpoint criteria before marking cycle complete\n   - Run quality gates (`pnpm lint`, `pnpm build`, tests) after each cycle\n\n6. Implementation execution guidance:\n\n   **Per-Task Execution**:\n   - Read full task description including sub-bullets\n   - Extract file path from backticks in description\n   - For `[EXTEND]` tasks: read existing file, add new code\n   - For `[MODIFY]` tasks: read existing file, modify specific sections\n   - Mark task complete: change `- [ ]` to `- [x]`\n   - **Do NOT run git commands** - leave version control to the user\n\n   **Per-Cycle Completion**:\n   - After final task in cycle, verify checkpoint criteria\n   - Run quality gates if defined (lint, build, tests)\n   - Report cycle completion to user before starting next cycle\n\n   **Error Handling Within Cycles**:\n   - If a task fails, stop the cycle and report\n   - Do not proceed to next task until current task passes\n   - For test tasks (TN.1): failing test is EXPECTED initially\n   - For implementation tasks: failing means fix before continuing\n\n7. Progress tracking and error handling:\n   - Report progress after each completed task and cycle\n   - Halt cycle execution if any task fails (except TN.1 failing tests which are expected)\n   - For parallel cycles `[P]`, can run multiple cycles concurrently\n   - Provide clear error messages with context for debugging\n   - Suggest next steps if implementation cannot proceed\n   - **IMPORTANT**: Mark completed tasks as `- [x] **T#.#**:` in tasks.md\n   - **IMPORTANT**: Report cycle checkpoint verification before proceeding\n\n8. Completion validation:\n   - Verify all cycles are completed (all tasks marked `[x]`)\n   - Verify all cycle checkpoints passed\n   - Run final quality gates (`pnpm lint`, `pnpm build`, full test suite)\n   - Check traceability matrix coverage (all user stories have implementing cycles)\n   - Validate constitution alignment (if `## Constitution Alignment` section exists)\n   - Report final status:\n     ```markdown\n     ## Implementation Complete\n\n     **Feature**: {feature_id}\n\n     | Metric | Value |\n     |--------|-------|\n     | Foundation Cycles | {N}/{N} complete |\n     | Feature Cycles | {N}/{N} complete |\n     | Total Tasks | {N}/{N} complete |\n\n     ### Quality Gates\n     - Lint: ✓ Pass\n     - Build: ✓ Pass\n     - Tests: ✓ Pass ({N} passing)\n\n     ### Next Steps\n     - Review implementation at `{paths}`\n     - Deploy or continue with next feature\n     ```\n\nNote: This command assumes a complete task breakdown exists in tasks.md. If tasks are incomplete or missing, suggest running `/humaninloop:tasks` first to regenerate the task list."
              },
              {
                "name": "/plan",
                "description": "Execute the multi-agent implementation planning workflow with specialized agents and validation loops",
                "path": "plugins/humaninloop/commands/plan.md",
                "frontmatter": {
                  "description": "Execute the multi-agent implementation planning workflow with specialized agents and validation loops"
                },
                "content": "# Two-Agent Planning Workflow\n\nYou are the **Supervisor** orchestrating a two-agent planning workflow. You own the loop, manage state via files, and route based on agent outputs.\n\n## User Input\n\n```text\n$ARGUMENTS\n```\n\nIf `$ARGUMENTS` is empty or appears literally, check for resume state first, then proceed with the detected feature.\n\n### Empty Input Check\n\nIf `$ARGUMENTS` is empty (blank string with no content), use AskUserQuestion to handle a known Claude Code bug where inputs containing `@` file references don't reach plugin commands:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"⚠️ Known Issue: Input may have been lost\\n\\nClaude Code has a bug where inputs containing @ file references don't reach plugin commands.\\n\\nWould you like to re-enter your input?\",\n    header: \"Input\",\n    options: [\n      {label: \"Re-enter input\", description: \"I'll type my input in the terminal\"},\n      {label: \"Continue without input\", description: \"Proceed with no input provided\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\n- If user selects \"Re-enter input\" → wait for user to type their input in the terminal, then use that as the effective `$ARGUMENTS`\n- If user selects \"Continue without input\" → proceed with empty input (check resume state, then detect feature from branch)\n\n---\n\n## Architecture Overview\n\n```\nSUPERVISOR (this command)\n    │\n    ├── Creates context + directories\n    ├── Invokes agents with minimal prompts\n    ├── Parses structured prose outputs\n    ├── Updates context between phases\n    └── Owns all routing decisions\n\nAGENTS (independent, no workflow knowledge)\n    │\n    ├── Plan Architect → Writes research.md, data-model.md, contracts/\n    └── Devil's Advocate → Reviews artifacts, finds gaps\n```\n\n**Communication Pattern**: Context + Artifacts + Separate Reports\n\n```\nspecs/{feature-id}/\n├── spec.md                          # Input (from specify workflow)\n├── research.md                      # Phase 1 output\n├── data-model.md                    # Phase 2 output\n├── contracts/                       # Phase 3 output\n│   └── api.yaml\n├── quickstart.md                    # Phase 3 output\n├── plan.md                          # Summary (completion)\n└── .workflow/\n    ├── context.md                   # Context + instructions (specify)\n    ├── plan-context.md              # Context + instructions (plan)\n    ├── planner-report.md            # Plan Architect output\n    └── advocate-report.md           # Devil's Advocate output\n```\n\n---\n\n## Agents Used\n\n| Agent | File | Purpose |\n|-------|------|---------|\n| Plan Architect | `${CLAUDE_PLUGIN_ROOT}/agents/plan-architect.md` | Transform spec into planning artifacts |\n| Devil's Advocate | `${CLAUDE_PLUGIN_ROOT}/agents/devils-advocate.md` | Review artifacts, find gaps, generate clarifications |\n\n---\n\n## Pre-Execution: Entry Gate\n\nBefore starting, verify the specification workflow is complete:\n\n1. **Identify the feature directory**:\n   - If `$ARGUMENTS` specifies a feature ID: use that\n   - Otherwise: Detect from current git branch (branch name = feature ID, e.g., `001-user-auth`)\n   - Fallback: Find most recent spec in `specs/` by highest numeric prefix\n\n2. **Check for spec.md**: Read `specs/{feature-id}/spec.md`\n   - If NOT found: Block and tell user to run `/humaninloop:specify` first\n\n3. **Check specify workflow status**: Read `specs/{feature-id}/.workflow/context.md`\n   - If `status` != `completed`:\n     ```\n     AskUserQuestion(\n       questions: [{\n         question: \"Specification workflow not complete (status: {status}). Planning requires a completed spec.\",\n         header: \"Entry Gate\",\n         options: [\n           {label: \"Complete specification first\", description: \"Return to /humaninloop:specify\"},\n           {label: \"Abort\", description: \"Cancel planning workflow\"}\n         ],\n         multiSelect: false\n       }]\n     )\n     ```\n\n4. **If entry gate passes**: Continue to Resume Detection\n\n---\n\n## Pre-Execution: Resume Detection\n\nBefore starting, check for interrupted planning workflows:\n\n1. **Check for existing plan-context.md**:\n   ```bash\n   test -f specs/{feature-id}/.workflow/plan-context.md\n   ```\n\n2. **If found**: Read frontmatter, check `status` and `phase` fields\n\n3. **If status is not completed**:\n   ```\n   AskUserQuestion(\n     questions: [{\n       question: \"Found interrupted planning workflow for '{feature_id}' (phase: {phase}, status: {status}). Resume or start fresh?\",\n       header: \"Resume?\",\n       options: [\n         {label: \"Resume\", description: \"Continue from {phase} phase\"},\n         {label: \"Start fresh\", description: \"Delete plan artifacts and restart\"}\n       ],\n       multiSelect: false\n     }]\n   )\n   ```\n\n4. **If resume**: Read context, jump to appropriate phase based on status\n5. **If fresh**: Delete plan artifacts (research.md, data-model.md, contracts/) and proceed\n\n---\n\n## Phase 1: Initialize\n\n### 1.1 Create Plan Context\n\nUse the template at `${CLAUDE_PLUGIN_ROOT}/templates/plan-context-template.md`.\n\nWrite to `specs/{feature-id}/.workflow/plan-context.md` with these values:\n\n| Placeholder | Value |\n|-------------|-------|\n| `{{phase}}` | `research` |\n| `{{status}}` | `awaiting-planner` |\n| `{{iteration}}` | `1` |\n| `{{feature_id}}` | Feature ID |\n| `{{created}}` | ISO date |\n| `{{updated}}` | ISO date |\n| `{{spec_status}}` | `present` |\n| `{{constitution_path}}` | Path to constitution |\n| `{{constitution_principles}}` | Extracted key principles |\n| `{{spec_path}}` | `specs/{feature-id}/spec.md` |\n| `{{research_path}}` | `specs/{feature-id}/research.md` |\n| `{{research_status}}` | `pending` |\n| `{{datamodel_path}}` | `specs/{feature-id}/data-model.md` |\n| `{{datamodel_status}}` | `pending` |\n| `{{contracts_path}}` | `specs/{feature-id}/contracts/` |\n| `{{contracts_status}}` | `pending` |\n| `{{planner_report_path}}` | `specs/{feature-id}/.workflow/planner-report.md` |\n| `{{advocate_report_path}}` | `specs/{feature-id}/.workflow/advocate-report.md` |\n| `{{codebase_context}}` | Empty (filled by planner if brownfield) |\n| `{{supervisor_instructions}}` | See Phase 2 for initial instructions |\n| `{{clarification_log}}` | Empty on first iteration |\n\n---\n\n## Phase 2: Research\n\n### 2.1 Set Supervisor Instructions for Planner\n\nUpdate `{{supervisor_instructions}}` in plan-context.md:\n\n```markdown\n**Phase**: Research\n\nCreate technical research document resolving all unknowns from the specification.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Constitution: `.humaninloop/memory/constitution.md`\n\n**Write**:\n- Research: `specs/{feature-id}/research.md`\n- Report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Use Skills**:\n- `analysis-codebase` (if brownfield)\n- `patterns-technical-decisions`\n\n**Report format**: Follow `${CLAUDE_PLUGIN_ROOT}/templates/planner-report-template.md`\n```\n\n### 2.2 Update Context Status\n\nUpdate plan-context.md frontmatter:\n```yaml\nphase: research\nstatus: awaiting-planner\nupdated: {ISO date}\n```\n\n### 2.3 Invoke Plan Architect\n\n```\nTask(\n  subagent_type: \"humaninloop:plan-architect\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/plan-context.md\",\n  description: \"Create research document\"\n)\n```\n\n### 2.4 Verify Output\n\nConfirm the agent created:\n- `specs/{feature-id}/research.md`\n- `specs/{feature-id}/.workflow/planner-report.md`\n\nIf missing, report error and stop.\n\n### 2.5 Advocate Review\n\nUpdate context for advocate:\n\n```markdown\n**Phase**: Research Review\n\nReview the research document for gaps and quality.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Research: `specs/{feature-id}/research.md`\n- Planner report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Write**:\n- Report: `specs/{feature-id}/.workflow/advocate-report.md`\n\n**Use Skills**:\n- `validation-plan-artifacts` (phase: research)\n\n**Report format**: Follow `${CLAUDE_PLUGIN_ROOT}/templates/advocate-report-template.md`\n```\n\nUpdate status:\n```yaml\nstatus: awaiting-advocate\n```\n\nInvoke advocate:\n```\nTask(\n  subagent_type: \"humaninloop:devils-advocate\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/plan-context.md\",\n  description: \"Review research document\"\n)\n```\n\n### 2.6 Route Based on Verdict\n\nRead advocate report and extract verdict.\n\n**If verdict is `ready`**:\n- Update `{{research_status}}` to `complete`\n- Proceed to Phase 3 (Data Model)\n\n**If verdict is `needs-revision` or `critical-gaps`**:\n- Present clarifications to user (see Clarification Loop)\n- Update context with answers\n- Increment iteration\n- Loop back to 2.3\n\n---\n\n## Phase 3: Data Model\n\n### 3.1 Set Supervisor Instructions for Planner\n\nUpdate `{{supervisor_instructions}}` in plan-context.md:\n\n```markdown\n**Phase**: Data Model\n\nCreate data model document extracting entities, relationships, and validation rules.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Research: `specs/{feature-id}/research.md`\n- Constitution: `.humaninloop/memory/constitution.md`\n\n**Write**:\n- Data Model: `specs/{feature-id}/data-model.md`\n- Report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Use Skills**:\n- `analysis-codebase` (if brownfield, for existing entities)\n- `patterns-entity-modeling`\n\n**Report format**: Follow `${CLAUDE_PLUGIN_ROOT}/templates/planner-report-template.md`\n```\n\n### 3.2 Update Context Status\n\n```yaml\nphase: datamodel\nstatus: awaiting-planner\niteration: 1\nupdated: {ISO date}\n```\n\n### 3.3 Invoke Plan Architect\n\n```\nTask(\n  subagent_type: \"humaninloop:plan-architect\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/plan-context.md\",\n  description: \"Create data model\"\n)\n```\n\n### 3.4 Verify Output\n\nConfirm: `specs/{feature-id}/data-model.md`\n\n### 3.5 Advocate Review (Cumulative)\n\nUpdate context for advocate:\n\n```markdown\n**Phase**: Data Model Review\n\nReview the data model for completeness and consistency with spec + research.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Research: `specs/{feature-id}/research.md`\n- Data Model: `specs/{feature-id}/data-model.md`\n- Planner report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Write**:\n- Report: `specs/{feature-id}/.workflow/advocate-report.md`\n\n**Use Skills**:\n- `validation-plan-artifacts` (phase: datamodel)\n\n**Check**:\n- Entity coverage (all nouns from requirements)\n- Relationship completeness\n- Consistency with research decisions\n```\n\nInvoke advocate and route based on verdict (same as Phase 2).\n\n**If ready**: Proceed to Phase 4 (Contracts)\n\n---\n\n## Phase 4: Contracts\n\n### 4.1 Set Supervisor Instructions for Planner\n\nUpdate `{{supervisor_instructions}}` in plan-context.md:\n\n```markdown\n**Phase**: Contracts\n\nCreate API contracts and integration guide.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Research: `specs/{feature-id}/research.md`\n- Data Model: `specs/{feature-id}/data-model.md`\n- Constitution: `.humaninloop/memory/constitution.md`\n\n**Write**:\n- Contracts: `specs/{feature-id}/contracts/api.yaml`\n- Quickstart: `specs/{feature-id}/quickstart.md`\n- Report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Use Skills**:\n- `analysis-codebase` (if brownfield, for existing API patterns)\n- `patterns-api-contracts`\n\n**Report format**: Follow `${CLAUDE_PLUGIN_ROOT}/templates/planner-report-template.md`\n```\n\n### 4.2 Update Context Status\n\n```yaml\nphase: contracts\nstatus: awaiting-planner\niteration: 1\nupdated: {ISO date}\n```\n\n### 4.3 Invoke Plan Architect\n\n```\nTask(\n  subagent_type: \"humaninloop:plan-architect\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/plan-context.md\",\n  description: \"Create API contracts\"\n)\n```\n\n### 4.4 Verify Output\n\nConfirm:\n- `specs/{feature-id}/contracts/api.yaml`\n- `specs/{feature-id}/quickstart.md`\n\n### 4.5 Advocate Review (Cumulative)\n\nUpdate context for advocate:\n\n```markdown\n**Phase**: Contracts Review\n\nReview API contracts for completeness and consistency with all previous artifacts.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Research: `specs/{feature-id}/research.md`\n- Data Model: `specs/{feature-id}/data-model.md`\n- Contracts: `specs/{feature-id}/contracts/api.yaml`\n- Quickstart: `specs/{feature-id}/quickstart.md`\n- Planner report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Write**:\n- Report: `specs/{feature-id}/.workflow/advocate-report.md`\n\n**Use Skills**:\n- `validation-plan-artifacts` (phase: contracts)\n\n**Check**:\n- Endpoint coverage (all user actions mapped)\n- Schema consistency with data model\n- Error handling completeness\n- Cross-artifact consistency\n```\n\nInvoke advocate and route based on verdict.\n\n**If ready**: Proceed to Phase 5 (Completion)\n\n---\n\n## Clarification Loop\n\nWhen advocate verdict is `needs-revision` or `critical-gaps`:\n\n1. **Present clarifications to user** using AskUserQuestion:\n   ```\n   AskUserQuestion(\n     questions: clarifications.map(c => ({\n       question: c.question,\n       header: c.gap_id,\n       options: c.options || [\n         {label: \"Yes\", description: \"\"},\n         {label: \"No\", description: \"\"},\n         {label: \"Not sure\", description: \"Needs more discussion\"}\n       ],\n       multiSelect: false\n     }))\n   )\n   ```\n\n2. **Update context with user answers**:\n   Append to `## Clarification Log`:\n   ```markdown\n   ### Phase: {phase} - Iteration {N}\n\n   #### Gaps Identified\n   {List from advocate report}\n\n   #### User Answers\n   | Gap ID | Question | Answer |\n   |--------|----------|--------|\n   | G1 | {question} | {user's answer} |\n   ```\n\n3. **Update supervisor instructions for revision**:\n   ```markdown\n   **Phase**: {phase} (Revision)\n\n   Revise the {artifact} based on user feedback.\n\n   **Read**:\n   - Current artifact: `specs/{feature-id}/{artifact}`\n   - Gaps and user answers: See `## Clarification Log` below\n   - Previous artifacts for context\n\n   **Write**:\n   - Updated artifact: `specs/{feature-id}/{artifact}`\n   - Report: `specs/{feature-id}/.workflow/planner-report.md`\n   ```\n\n4. **Increment iteration** in context frontmatter\n\n5. **Loop back to Planner invocation**\n\n---\n\n## Supervisor Judgment: When to Exit Early\n\nUse your judgment to recommend exiting if:\n\n- **Gaps aren't resolving**: Same issues recurring across iterations\n- **Only minor gaps remain**: Offer to finalize with known limitations\n- **User seems satisfied**: Offer to complete even with open gaps\n\nAlways give the user the choice—never force-terminate without consent:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"We've been iterating on the {phase} phase. {Context}. How should we proceed?\",\n    header: \"Next Step\",\n    options: [\n      {label: \"Continue refining\", description: \"Another round of revision\"},\n      {label: \"Accept current state\", description: \"Proceed to next phase with known gaps\"},\n      {label: \"Stop and review manually\", description: \"Exit workflow, review artifacts yourself\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\n---\n\n## Phase 5: Completion\n\n### 5.1 Generate plan.md Summary\n\nWrite `specs/{feature-id}/plan.md`:\n\n```markdown\n# Implementation Plan: {feature_id}\n\n> Summary document for the planning workflow.\n\n---\n\n## Overview\n\n{2-3 sentence summary extracted from spec.md}\n\n---\n\n## Key Decisions\n\n| Decision | Choice | See |\n|----------|--------|-----|\n{For each decision in research.md}\n\n---\n\n## Entities\n\n| Entity | Status | Attributes | Relationships |\n|--------|--------|------------|---------------|\n{For each entity in data-model.md}\n\n---\n\n## Endpoints\n\n| Endpoint | Method | Description |\n|----------|--------|-------------|\n{For each endpoint in contracts/api.yaml}\n\n---\n\n## Artifacts\n\n| Artifact | Path | Status |\n|----------|------|--------|\n| Specification | specs/{feature-id}/spec.md | ✓ Complete |\n| Research | specs/{feature-id}/research.md | ✓ Complete |\n| Data Model | specs/{feature-id}/data-model.md | ✓ Complete |\n| API Contracts | specs/{feature-id}/contracts/api.yaml | ✓ Complete |\n| Quickstart | specs/{feature-id}/quickstart.md | ✓ Complete |\n\n---\n\n## Next Steps\n\nRun `/humaninloop:tasks` to generate implementation tasks from this plan.\n```\n\n### 5.2 Update Final Status\n\nUpdate plan-context.md frontmatter:\n```yaml\nphase: completed\nstatus: completed\nupdated: {ISO date}\n```\n\nUpdate artifact statuses:\n```yaml\nresearch_status: complete\ndatamodel_status: complete\ncontracts_status: complete\n```\n\n### 5.3 Generate Completion Report\n\nOutput to user:\n\n```markdown\n## Planning Complete\n\n**Feature**: {feature_id}\n\n### Summary\n- Decisions documented: {count from research.md}\n- Entities modeled: {count from data-model.md}\n- Endpoints designed: {count from contracts/}\n\n### Artifacts Generated\n- `specs/{feature-id}/plan.md` - Summary document\n- `specs/{feature-id}/research.md` - Technical decisions\n- `specs/{feature-id}/data-model.md` - Entity definitions\n- `specs/{feature-id}/contracts/api.yaml` - OpenAPI specification\n- `specs/{feature-id}/quickstart.md` - Integration guide\n\n### Known Limitations\n{Any minor gaps deferred, if applicable}\n\n### Next Steps\n1. Review the plan at `specs/{feature-id}/plan.md`\n2. Run `/humaninloop:tasks` to generate implementation tasks\n```\n\n---\n\n## Error Handling\n\n### Agent Failure\n\n```markdown\n**Agent Failed**\n\nError: {error_message}\nAgent: {agent_name}\nPhase: {phase}\n\nThe workflow state has been saved. Run `/humaninloop:plan` to resume from {phase} phase.\n```\n\n### Missing Files\n\nIf expected output files are missing after agent invocation:\n1. Log the issue\n2. Ask user: Retry agent, or abort?\n\n---\n\n## State Recovery\n\nResume logic based on `phase` and `status` fields:\n\n| Phase | Status | Resume Point |\n|-------|--------|--------------|\n| `research` | `awaiting-planner` | Phase 2.3 (invoke planner) |\n| `research` | `awaiting-advocate` | Phase 2.5 (invoke advocate) |\n| `research` | `awaiting-user` | Clarification loop |\n| `datamodel` | `awaiting-planner` | Phase 3.3 (invoke planner) |\n| `datamodel` | `awaiting-advocate` | Phase 3.5 (invoke advocate) |\n| `datamodel` | `awaiting-user` | Clarification loop |\n| `contracts` | `awaiting-planner` | Phase 4.3 (invoke planner) |\n| `contracts` | `awaiting-advocate` | Phase 4.5 (invoke advocate) |\n| `contracts` | `awaiting-user` | Clarification loop |\n| `completed` | `completed` | Report already done |\n\n---\n\n## Important Notes\n\n- Do NOT modify git config or push to remote\n- Use judgment for iteration limits (no hard caps)\n- Always use Task tool to invoke agents\n- Agents have NO workflow knowledge—all context via context file\n- Supervisor owns ALL routing and state decisions\n- Advocate reviews are cumulative (check against all previous artifacts)"
              },
              {
                "name": "/setup",
                "description": "Create or update the project constitution using the Principal Architect agent.",
                "path": "plugins/humaninloop/commands/setup.md",
                "frontmatter": {
                  "description": "Create or update the project constitution using the Principal Architect agent."
                },
                "content": "## User Input\n\n```text\n$ARGUMENTS\n```\n\n## Workflow\n\nThis supervisor follows a multi-phase architecture for brownfield-aware constitution setup.\n\n### Phase 0: Brownfield Detection\n\n1. **Ensure directory exists**\n   ```bash\n   mkdir -p .humaninloop/memory\n   ```\n\n2. **Run detection script**\n   ```bash\n   bash ${CLAUDE_PLUGIN_ROOT}/skills/analysis-codebase/scripts/detect-stack.sh .\n   ```\n\n3. **Count source files** (heuristic for brownfield detection)\n   ```bash\n   find . -type f \\( -name \"*.ts\" -o -name \"*.js\" -o -name \"*.py\" -o -name \"*.go\" -o -name \"*.java\" -o -name \"*.rb\" -o -name \"*.rs\" \\) \\\n     -not -path \"*/node_modules/*\" -not -path \"*/.git/*\" -not -path \"*/vendor/*\" -not -path \"*/__pycache__/*\" | wc -l\n   ```\n\n4. **Check for existing constitution**\n   ```bash\n   cat .humaninloop/memory/constitution.md 2>/dev/null\n   ```\n   - If exists: `constitution_mode: amend`\n   - If not: `constitution_mode: create`\n\n5. **Determine brownfield status**\n   - If file count > 5 AND detect-stack finds framework/ORM → Suggest brownfield mode\n   - Otherwise → Default to greenfield mode\n\n6. **Present detection result to user**:\n   ```\n   AskUserQuestion(\n     questions: [{\n       question: \"Found [N] source files with [framework/language] detected.\\n\\nBrownfield analysis will:\\n- Inventory existing patterns and entities\\n- Assess essential floor coverage (Security, Testing, Error Handling, Observability)\\n- Produce codebase-analysis.md alongside constitution.md\\n- Generate evolution-roadmap.md with gap cards\\n\\nHow would you like to proceed?\",\n       header: \"Setup Mode\",\n       options: [\n         {label: \"Brownfield - Full analysis\", description: \"Analyze codebase, create 3 artefacts (Recommended for existing codebases)\"},\n         {label: \"Greenfield - Constitution only\", description: \"Create constitution with defaults, skip analysis\"},\n         {label: \"Amend existing\", description: \"Update existing constitution without re-analysis\"}\n       ],\n       multiSelect: false\n     }]\n   )\n   ```\n\n7. **Route based on answer**:\n   - \"Brownfield\" → Continue to Phase 1\n   - \"Greenfield\" → Skip to Phase 3 (greenfield mode)\n   - \"Amend\" → Skip to Phase 3 (amend mode)\n\n---\n\n### Phase 1: Brownfield Analysis (Brownfield Mode Only)\n\n1. **Generate context filename with timestamp**\n   ```bash\n   CONTEXT_FILE=\".humaninloop/memory/setup-context-$(date +%Y%m%d-%H%M%S).md\"\n   ```\n\n2. **Create context artifact** for analysis phase\n\n   Write to `$CONTEXT_FILE`:\n\n   ```markdown\n   ---\n   type: brownfield-setup\n   mode: brownfield\n   phase: analysis\n   constitution_mode: [create|amend]\n   iteration: 1\n   created: [ISO date]\n   updated: [ISO date]\n   ---\n\n   # Setup Context\n\n   ## User Input\n\n   [User's request or \"Set up project governance\"]\n\n   ## Detection Results\n\n   [Output from detect-stack.sh - JSON or summary]\n\n   ## Project Context\n\n   | Aspect | Value |\n   |--------|-------|\n   | Project Name | [detected] |\n   | Primary Language | [detected] |\n   | Framework | [detected] |\n   | Source Files | [count] |\n   | CLAUDE.md Exists | [Yes/No] |\n\n   ## Existing Constitution\n\n   [If amending: \"Existing constitution at .humaninloop/memory/constitution.md\"]\n   [If creating: \"None - creating new constitution\"]\n\n   ## Supervisor Instructions\n\n   **Phase**: Brownfield Analysis\n\n   Perform comprehensive codebase analysis using `analysis-codebase` skill (mode: setup-brownfield).\n\n   **Write**:\n   - Analysis: `.humaninloop/memory/codebase-analysis.md`\n   - Report: `.humaninloop/memory/architect-report.md`\n\n   **Report format**:\n   - ## Summary - Key findings (2-3 sentences)\n   - ## Essential Floor Status - Table with Security/Testing/Error Handling/Observability\n   - ## Entities Found - Count and highlights\n   - ## Architecture - Pattern identified\n   - ## Clarifications Needed - Questions for user (if any)\n\n   ## Clarification Log\n\n   [Empty on first iteration]\n   ```\n\n3. **Invoke Principal Architect**\n   ```\n   Task(\n     subagent_type: \"humaninloop:principal-architect\",\n     prompt: \"\n       Work on the brownfield analysis phase.\n\n       Read the context at: $CONTEXT_FILE\n\n       The context file contains all instructions and where to write output.\n     \",\n     description: \"Analyze existing codebase\"\n   )\n   ```\n\n4. **Verify output exists**\n   ```bash\n   test -f .humaninloop/memory/codebase-analysis.md && echo \"Analysis complete\"\n   test -f .humaninloop/memory/architect-report.md && echo \"Report complete\"\n   ```\n\n---\n\n### Phase 2: Analysis Checkpoint (Brownfield Mode Only)\n\n1. **Read architect report**\n   ```bash\n   cat .humaninloop/memory/architect-report.md\n   ```\n\n2. **Present analysis summary to user**\n   ```\n   AskUserQuestion(\n     questions: [{\n       question: \"[Summary from architect-report.md]\\n\\n**Essential Floor Status:**\\n[Table from report]\\n\\n**Architecture**: [Pattern from report]\\n**Entities Found**: [Count from report]\\n\\nIs this analysis accurate?\",\n       header: \"Analysis Review\",\n       options: [\n         {label: \"Confirm - Proceed to constitution\", description: \"Analysis is accurate, continue\"},\n         {label: \"Edit - Provide corrections\", description: \"I'll add corrections before proceeding\"},\n         {label: \"Reject - Start over\", description: \"Analysis is wrong, abort brownfield mode\"}\n       ],\n       multiSelect: false\n     }]\n   )\n   ```\n\n3. **Route based on answer**:\n\n   **If \"Confirm\"**:\n   - Proceed to Phase 3\n\n   **If \"Edit\"**:\n   - Collect user corrections\n   - Append to `$CONTEXT_FILE`'s `## Clarification Log`:\n     ```markdown\n     ### Iteration N - User Corrections\n     [User's corrections and clarifications]\n     ```\n   - Update `$CONTEXT_FILE`'s `## Supervisor Instructions`:\n     ```markdown\n     User provided corrections to the analysis (see Clarification Log).\n     Update codebase-analysis.md incorporating their feedback.\n     ```\n   - Increment `iteration` in frontmatter\n   - **Loop back to Phase 1 step 3** (re-invoke agent)\n\n   **If \"Reject\"**:\n   - Ask user: \"Would you like to continue with greenfield mode instead?\"\n   - If yes → Skip to Phase 3 (greenfield mode)\n   - If no → Abort workflow\n\n---\n\n### Phase 3: Constitution Generation\n\n1. **Update context for constitution phase**\n\n   Update `$CONTEXT_FILE` frontmatter:\n   ```yaml\n   phase: constitution\n   updated: [ISO date]\n   ```\n\n   Update `## Supervisor Instructions`:\n\n   **For Brownfield Mode**:\n   ```markdown\n   **Phase**: Constitution (Brownfield)\n\n   Create project constitution informed by codebase analysis.\n\n   **Read**:\n   - Codebase analysis: `.humaninloop/memory/codebase-analysis.md`\n\n   **Requirements**:\n   - Essential floor principles MUST be included (Security, Testing, Error Handling, Observability)\n   - Emergent ceiling from codebase analysis (codify existing good patterns)\n   - Each principle: Statement, Enforcement, Testability, Rationale\n   - Use RFC 2119 keywords (MUST, SHOULD, MAY)\n\n   **CRITICAL - Populate from Analysis**:\n   - Technology Stack: Use ACTUAL tools/versions from codebase-analysis.md, NOT placeholders\n   - Quality Gates: Use ACTUAL commands from codebase-analysis.md (e.g., if analysis found \"pytest\", write `pytest --cov`, NOT `[TEST_COMMAND]`)\n   - Coverage thresholds: Use numeric values from analysis OR sensible defaults (warning <80%, blocking <60%)\n   - Security scanning: Name specific tools found (e.g., \"Trivy + Snyk\") NOT `[SECURITY_COMMAND]`\n   - Governance Approvers: Check for CODEOWNERS file; if exists, reference it (e.g., \"as defined in CODEOWNERS\"); otherwise use team/role from analysis\n   - If analysis doesn't specify a tool, use industry-standard defaults for the detected language/framework\n\n   **Write**:\n   - Constitution: `.humaninloop/memory/constitution.md`\n   - Report: `.humaninloop/memory/architect-report.md`\n\n   **Report format**:\n   - ## What I Created - Constitution version, principle count\n   - ## Essential Floor Principles - List the 4 with status\n   - ## Emergent Ceiling Principles - List principles from codebase patterns\n   - ## CLAUDE.md Sync Status - What was synced\n   - ## Clarifications Needed - Questions (if any)\n   - ## Assumptions Made - Decisions made when ambiguous\n   ```\n\n   **For Greenfield Mode**:\n   ```markdown\n   **Phase**: Constitution (Greenfield)\n\n   Create project constitution with opinionated defaults.\n\n   **Requirements**:\n   - Essential floor principles with industry-standard defaults\n   - Each principle: Statement, Enforcement, Testability, Rationale\n   - Use RFC 2119 keywords (MUST, SHOULD, MAY)\n\n   **CRITICAL - No Placeholders**:\n   - Technology Stack: Use detected language/framework from Phase 0, or ask user\n   - Quality Gates: Use concrete commands appropriate for the detected stack (e.g., `npm test`, `pytest`, `dotnet test`)\n   - Coverage thresholds: Use numeric defaults (warning <80%, blocking <60%)\n   - Security scanning: Recommend appropriate tools for the stack (e.g., npm audit, pip-audit, Trivy)\n   - NEVER write `[PLACEHOLDER]` syntax - always use actual tool names or sensible defaults\n\n   **Write**:\n   - Constitution: `.humaninloop/memory/constitution.md`\n   - Report: `.humaninloop/memory/architect-report.md`\n\n   **Report format**:\n   - ## What I Created - Constitution version, principle count\n   - ## Essential Floor Principles - List the 4\n   - ## CLAUDE.md Sync Status - What was synced\n   - ## Clarifications Needed - Questions (if any)\n   - ## Assumptions Made - Decisions made when ambiguous\n   ```\n\n   **For Amend Mode**:\n   ```markdown\n   **Phase**: Constitution (Amend)\n\n   Update existing constitution based on user request.\n\n   **Read**:\n   - Existing constitution: `.humaninloop/memory/constitution.md`\n\n   **Requirements**:\n   - Preserve existing principles unless explicitly changing\n   - Update version per semantic versioning\n   - Each changed principle: Statement, Enforcement, Testability, Rationale\n\n   **Write**:\n   - Constitution: `.humaninloop/memory/constitution.md`\n   - Report: `.humaninloop/memory/architect-report.md`\n\n   **Report format**:\n   - ## What I Changed - Summary of amendments\n   - ## Version Update - Old → New version with rationale\n   - ## CLAUDE.md Sync Status - What was synced\n   - ## Clarifications Needed - Questions (if any)\n   ```\n\n2. **Invoke Principal Architect**\n   ```\n   Task(\n     subagent_type: \"humaninloop:principal-architect\",\n     prompt: \"\n       Work on the constitution phase.\n\n       Read the context at: $CONTEXT_FILE\n\n       The context file contains all instructions and where to write output.\n     \",\n     description: \"Create project constitution\"\n   )\n   ```\n\n3. **Parse agent output and handle clarifications**\n\n   **If `## Clarifications Needed` has questions:**\n   1. Present questions to user\n   2. Collect answers\n   3. Append to `$CONTEXT_FILE`'s `## Clarification Log`:\n      ```markdown\n      ### Constitution Round N - Agent Questions\n      [Questions from agent output]\n\n      ### Constitution Round N - User Answers\n      [User's responses]\n      ```\n   4. Update `$CONTEXT_FILE`'s `## Supervisor Instructions`:\n      ```markdown\n      User answered your questions (see Clarification Log).\n      Finalize the constitution incorporating their answers.\n      ```\n   5. Increment `iteration` in frontmatter\n   6. **Loop back to step 2** (re-invoke agent)\n\n   **If no clarifications (or max 3 iterations reached):**\n   - **Brownfield mode**: Proceed to Phase 4\n   - **Greenfield/Amend mode**: Proceed to Phase 5\n\n---\n\n### Phase 4: Evolution Roadmap (Brownfield Mode Only)\n\n1. **Update context for roadmap phase**\n\n   Update `$CONTEXT_FILE` frontmatter:\n   ```yaml\n   phase: roadmap\n   updated: [ISO date]\n   ```\n\n   Update `## Supervisor Instructions`:\n   ```markdown\n   **Phase**: Evolution Roadmap\n\n   Create gap analysis between current codebase state and constitution requirements.\n\n   **Read**:\n   - Codebase analysis: `.humaninloop/memory/codebase-analysis.md`\n   - Constitution: `.humaninloop/memory/constitution.md`\n\n   **Gap Identification Process**:\n   1. For each Essential Floor category with \"partial\" or \"absent\" → Gap card\n   2. For each constitution principle → Check codebase compliance → Gap card if non-compliant\n   3. Prioritize: P1 (security/blocking), P2 (testing/errors), P3 (observability/nice-to-have)\n   4. Identify dependencies between gaps\n\n   **Write**:\n   - Roadmap: `.humaninloop/memory/evolution-roadmap.md`\n   - Report: `.humaninloop/memory/architect-report.md`\n\n   **Report format**:\n   - ## Gap Summary - Total count by priority (P1/P2/P3)\n   - ## Critical Gaps (P1) - List with brief description\n   - ## Dependency Chain - Key blocking relationships\n   ```\n\n2. **Invoke Principal Architect**\n   ```\n   Task(\n     subagent_type: \"humaninloop:principal-architect\",\n     prompt: \"\n       Work on the evolution roadmap phase.\n\n       Read the context at: $CONTEXT_FILE\n\n       The context file contains all instructions and where to write output.\n     \",\n     description: \"Create evolution roadmap\"\n   )\n   ```\n\n3. **Verify output exists**\n   ```bash\n   test -f .humaninloop/memory/evolution-roadmap.md && echo \"Roadmap complete\"\n   ```\n\n---\n\n### Phase 5: Finalize\n\n1. **Read final report**\n   ```bash\n   cat .humaninloop/memory/architect-report.md\n   ```\n\n2. **Report to user**\n\n   **For Brownfield Mode**:\n   ```markdown\n   ## Setup Complete (Brownfield Mode)\n\n   ### Artefacts Created\n   - `.humaninloop/memory/codebase-analysis.md` - Codebase inventory and assessment\n   - `.humaninloop/memory/constitution.md` - Project governance (v1.0.0)\n   - `.humaninloop/memory/evolution-roadmap.md` - Gap cards for improvement\n\n   ### Summary\n   - Principles defined: [count from report]\n   - Essential floor: [status summary]\n   - Gaps identified: [P1 count] critical, [P2 count] important, [P3 count] nice-to-have\n\n   ### Suggested Commit\n   ```\n   docs: create constitution v1.0.0 with brownfield analysis\n   ```\n\n   ### Next Steps\n   1. Review the constitution at `.humaninloop/memory/constitution.md`\n   2. Review evolution roadmap for prioritized improvements\n   3. Address P1 gaps before starting new features\n   4. Run `/humaninloop:specify` to start feature specification\n   ```\n\n   **For Greenfield Mode**:\n   ```markdown\n   ## Setup Complete (Greenfield Mode)\n\n   ### Artefacts Created\n   - `.humaninloop/memory/constitution.md` - Project governance (v1.0.0)\n\n   ### Summary\n   - Principles defined: [count from report]\n   - Essential floor: All four categories covered with defaults\n\n   ### Suggested Commit\n   ```\n   docs: create constitution v1.0.0\n   ```\n\n   ### Next Steps\n   1. Review the constitution at `.humaninloop/memory/constitution.md`\n   2. Run `/humaninloop:specify` to start feature specification\n   ```\n\n   **For Amend Mode**:\n   ```markdown\n   ## Setup Complete (Amendment)\n\n   ### Artefacts Updated\n   - `.humaninloop/memory/constitution.md` - Updated to [new version]\n\n   ### Summary\n   - [Changes summary from report]\n\n   ### Suggested Commit\n   ```\n   docs: update constitution to v[X.Y.Z]\n   ```\n\n   ### Next Steps\n   1. Review the updated constitution\n   2. Ensure CLAUDE.md is synchronized (if applicable)\n   ```\n\n3. **Cleanup prompt**\n   ```\n   AskUserQuestion(\n     questions: [{\n       question: \"Would you like to delete the context file used during this setup?\\n\\nFile: $CONTEXT_FILE\",\n       header: \"Cleanup\",\n       options: [\n         {label: \"Yes - Delete context file\", description: \"Remove temporary setup context\"},\n         {label: \"No - Keep for reference\", description: \"Retain for debugging or review\"}\n       ],\n       multiSelect: false\n     }]\n   )\n   ```\n   - If yes: `rm $CONTEXT_FILE`\n   - If no: Inform user the file is retained\n\n---\n\n## State Recovery\n\nIf workflow is interrupted, detect resume point from context file:\n\n| Phase | Status Indicator | Resume Point |\n|-------|-----------------|--------------|\n| `analysis` | `phase: analysis` in context | Phase 1 step 3 |\n| `analysis` | `codebase-analysis.md` exists | Phase 2 (checkpoint) |\n| `constitution` | `phase: constitution` in context | Phase 3 step 2 |\n| `constitution` | `constitution.md` exists + brownfield | Phase 4 |\n| `roadmap` | `phase: roadmap` in context | Phase 4 step 2 |\n| `completed` | All 3 files exist (brownfield) | Phase 5 (report) |\n| `completed` | Constitution exists (greenfield) | Phase 5 (report) |\n\n---\n\n## Supervisor Behaviors\n\n- **Owns the loop**: Decides when to iterate vs. finalize\n- **Modifies context**: Updates `$CONTEXT_FILE` instructions and appends to clarification log\n- **Presents checkpoints**: User reviews analysis before constitution generation\n- **Injects context**: Can add sections to `$CONTEXT_FILE` if needed mid-loop\n- **Max iterations**: Limit to 3 rounds per phase to prevent infinite loops\n- **Mode awareness**: Tracks brownfield vs greenfield throughout workflow"
              },
              {
                "name": "/specify",
                "description": "Create feature specification using decoupled two-agent architecture (Requirements Analyst + Devil's Advocate)",
                "path": "plugins/humaninloop/commands/specify.md",
                "frontmatter": {
                  "description": "Create feature specification using decoupled two-agent architecture (Requirements Analyst + Devil's Advocate)"
                },
                "content": "# Decoupled Specify Workflow\n\nYou are the **Supervisor** orchestrating a two-agent specification workflow. You own the loop, manage state via files, and route based on agent outputs.\n\n## User Input\n\n```text\n$ARGUMENTS\n```\n\nIf `$ARGUMENTS` is empty or appears literally, check for resume state first, then ask for a feature description.\n\n### Empty Input Check\n\nIf `$ARGUMENTS` is empty (blank string with no content), use AskUserQuestion to handle a known Claude Code bug where inputs containing `@` file references don't reach plugin commands:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"⚠️ Known Issue: Input may have been lost\\n\\nClaude Code has a bug where inputs containing @ file references don't reach plugin commands.\\n\\nWould you like to re-enter your input?\",\n    header: \"Input\",\n    options: [\n      {label: \"Re-enter input\", description: \"I'll type my input in the terminal\"},\n      {label: \"Continue without input\", description: \"Proceed with no input provided\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\n- If user selects \"Re-enter input\" → wait for user to type their input in the terminal, then use that as the effective `$ARGUMENTS`\n- If user selects \"Continue without input\" → proceed with empty input (check resume state, then ask for feature description)\n\n---\n\n## Pre-Execution: Constitution Check\n\nBefore any workflow execution, verify that the project constitution exists:\n\n1. **Check for constitution file** at `.humaninloop/memory/constitution.md`\n2. **If NOT found**, display the following and STOP execution:\n\n```\nConstitution Required\n\nThe HumanInLoop specify workflow requires a project constitution to be configured.\n\nThe constitution defines project principles that guide specification quality validation.\n\nTo set up your constitution, run:\n/humaninloop:setup\n\nThis will walk you through defining your project's core principles.\n\nThen retry /humaninloop:specify\n```\n\n3. **If found**: Continue to Resume Detection\n\n---\n\n## Architecture Overview\n\n```\nSUPERVISOR (this command)\n    │\n    ├── Creates context + directories\n    ├── Invokes agents with minimal prompts\n    ├── Parses structured prose outputs\n    ├── Updates context between iterations\n    └── Owns all routing decisions\n\nAGENTS (independent, no workflow knowledge)\n    │\n    ├── Requirements Analyst → Writes spec.md\n    └── Devil's Advocate → Reviews spec.md, finds gaps\n```\n\n**Communication Pattern**: Context + Spec File + Separate Reports\n\n```\nspecs/{feature-id}/\n├── spec.md                          # The deliverable\n└── .workflow/\n    ├── context.md                   # Context + instructions\n    ├── analyst-report.md            # Requirements Analyst output\n    └── advocate-report.md           # Devil's Advocate output\n```\n\n---\n\n## Agents Used\n\n| Agent | File | Purpose |\n|-------|------|---------|\n| Requirements Analyst | `${CLAUDE_PLUGIN_ROOT}/agents/requirements-analyst.md` | Transform feature request into spec |\n| Devil's Advocate | `${CLAUDE_PLUGIN_ROOT}/agents/devils-advocate.md` | Review spec, find gaps, generate clarifications |\n\n---\n\n## Pre-Execution: Resume Detection\n\nBefore starting, check for interrupted workflows:\n\n1. **Search for existing context files** with `status` not `completed`:\n   ```bash\n   find specs -name \"context.md\" -path \"*/.workflow/*\" 2>/dev/null\n   ```\n\n2. **If found**: Read context frontmatter, check `status` field\n\n3. **If status is not completed**:\n   ```\n   AskUserQuestion(\n     questions: [{\n       question: \"Found interrupted workflow for '{feature_id}' (status: {status}). Resume or start fresh?\",\n       header: \"Resume?\",\n       options: [\n         {label: \"Resume\", description: \"Continue from where you left off\"},\n         {label: \"Start fresh\", description: \"Delete existing and start over\"}\n       ],\n       multiSelect: false\n     }]\n   )\n   ```\n\n4. **If resume**: Read context, jump to appropriate phase based on status\n5. **If fresh**: Delete existing feature directory and proceed\n\n---\n\n## Phase 1: Initialize\n\n### 1.1 Create Feature Branch and Directory\n\nRun the `create-new-feature.sh` script to create the branch and initialize the spec:\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/scripts/create-new-feature.sh --json \"<feature description>\"\n```\n\nThe script will:\n1. Fetch all remote branches (`git fetch --all --prune`)\n2. Find the highest feature number across:\n   - Remote branches matching `###-*` pattern\n   - Local branches matching `###-*` pattern\n   - Existing `specs/###-*` directories\n3. Generate a short name from the description (filters stop words, keeps meaningful keywords)\n4. Create branch `{NNN}-{short-name}` (e.g., `001-user-auth`)\n5. Create directory `specs/{NNN}-{short-name}/`\n6. Copy spec template to `specs/{NNN}-{short-name}/spec.md`\n\n**Parse JSON output** to get:\n- `BRANCH_NAME`: The created branch name (e.g., `001-user-auth`)\n- `SPEC_FILE`: Path to spec file (e.g., `specs/001-user-auth/spec.md`)\n- `FEATURE_NUM`: The feature number (e.g., `001`)\n\nUse `BRANCH_NAME` as the `{feature-id}` for all subsequent steps.\n\n### 1.2 Create Workflow Directory\n\n```bash\nmkdir -p specs/{feature-id}/.workflow\n```\n\n### 1.3 Create Context\n\nUse the template at `${CLAUDE_PLUGIN_ROOT}/templates/context-template.md`.\n\nWrite to `specs/{feature-id}/.workflow/context.md` with these values:\n\n| Placeholder | Value |\n|-------------|-------|\n| `{{status}}` | `awaiting-analyst` |\n| `{{iteration}}` | `1` |\n| `{{feature_id}}` | Generated feature ID |\n| `{{created}}` | ISO date |\n| `{{updated}}` | ISO date |\n| `{{user_input}}` | Original user input from $ARGUMENTS |\n| `{{project_name}}` | Detected from package.json, etc. |\n| `{{tech_stack}}` | Detected |\n| `{{constitution_path}}` | Path if exists, or \"not configured\" |\n| `{{constitution_principles}}` | Extracted key principles, or \"No constitution configured. Use general best practices.\" |\n| `{{spec_path}}` | `specs/{feature-id}/spec.md` |\n| `{{context_path}}` | `specs/{feature-id}/.workflow/context.md` |\n| `{{analyst_report_path}}` | `specs/{feature-id}/.workflow/analyst-report.md` |\n| `{{advocate_report_path}}` | `specs/{feature-id}/.workflow/advocate-report.md` |\n| `{{supervisor_instructions}}` | See Phase 2 for initial analyst instructions |\n| `{{clarification_log}}` | Empty on first iteration |\n\n### 1.4 Create Spec File\n\nUse the template at `${CLAUDE_PLUGIN_ROOT}/templates/spec-template.md`.\n\nWrite to `specs/{feature-id}/spec.md` with initial values:\n\n| Placeholder | Value |\n|-------------|-------|\n| `{{feature_title}}` | Derived from user input |\n| `{{feature_id}}` | Generated feature ID |\n| `{{created}}` | ISO date |\n| `{{status}}` | `draft` |\n| All other sections | Empty (to be filled by analyst) |\n\n---\n\n## Phase 2: Requirements Analyst\n\n### 2.1 Set Supervisor Instructions for Analyst\n\nUpdate `{{supervisor_instructions}}` in context:\n\n```markdown\nCreate a feature specification based on the user input above.\n\n**Read**:\n- Spec template: `${CLAUDE_PLUGIN_ROOT}/templates/spec-template.md`\n\n**Write**:\n- Spec: `specs/{feature-id}/spec.md`\n- Report: `specs/{feature-id}/.workflow/analyst-report.md`\n\n**Report format**: Follow `${CLAUDE_PLUGIN_ROOT}/templates/analyst-report-template.md`\n```\n\n### 2.2 Update Context Status\n\nUpdate context frontmatter:\n```yaml\nstatus: awaiting-analyst\nupdated: {ISO date}\n```\n\n### 2.3 Invoke Agent\n\n```\nTask(\n  subagent_type: \"humaninloop:requirements-analyst\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/context.md\",\n  description: \"Write feature specification\"\n)\n```\n\n### 2.4 Verify Output\n\nConfirm the agent created:\n- `specs/{feature-id}/spec.md` (updated with content)\n- `specs/{feature-id}/.workflow/analyst-report.md`\n\nIf missing, report error and stop.\n\n---\n\n## Phase 3: Devil's Advocate\n\n### 3.1 Set Supervisor Instructions for Advocate\n\nUpdate `{{supervisor_instructions}}` in context:\n\n```markdown\nReview the specification and find gaps.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Analyst report: `specs/{feature-id}/.workflow/analyst-report.md`\n\n**Write**:\n- Report: `specs/{feature-id}/.workflow/advocate-report.md`\n\n**Report format**: Follow `${CLAUDE_PLUGIN_ROOT}/templates/advocate-report-template.md`\n```\n\n### 3.2 Update Context Status\n\nUpdate context frontmatter:\n```yaml\nstatus: awaiting-advocate\nupdated: {ISO date}\n```\n\n### 3.3 Invoke Agent\n\n```\nTask(\n  subagent_type: \"humaninloop:devils-advocate\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/context.md\",\n  description: \"Review spec for gaps\"\n)\n```\n\n### 3.4 Parse Advocate Report\n\nRead `specs/{feature-id}/.workflow/advocate-report.md` and extract:\n- `verdict`: ready | needs-clarification | major-gaps\n- `gaps`: List of gaps with severity\n- `clarifications`: List of questions\n\n---\n\n## Phase 4: Route Based on Verdict\n\n### If Verdict is `ready`\n\n1. Update context status to `completed`\n2. Generate completion report (see Phase 5)\n3. Exit workflow\n\n### If Verdict is `needs-clarification` or `major-gaps`\n\n1. **Present clarifications to user** using AskUserQuestion:\n   ```\n   AskUserQuestion(\n     questions: clarifications.map(c => ({\n       question: c.question,\n       header: c.gap_id,\n       options: c.options || [\n         {label: \"Yes\", description: \"\"},\n         {label: \"No\", description: \"\"},\n         {label: \"Not sure\", description: \"Needs more discussion\"}\n       ],\n       multiSelect: false\n     }))\n   )\n   ```\n\n2. **Update context with user answers**:\n   Append to `## Clarification Log`:\n   ```markdown\n   ### Iteration {N}\n\n   #### Gaps Identified\n   {List from advocate report}\n\n   #### User Answers\n   | Gap ID | Question | Answer |\n   |--------|----------|--------|\n   | G1 | {question} | {user's answer} |\n   | G2 | {question} | {user's answer} |\n   ```\n\n3. **Update supervisor instructions for next analyst pass**:\n   ```markdown\n   Revise the specification based on user feedback.\n\n   **Read**:\n   - Current spec: `specs/{feature-id}/spec.md`\n   - Gaps and user answers: See `## Clarification Log` below\n   - Spec template: `${CLAUDE_PLUGIN_ROOT}/templates/spec-template.md`\n\n   **Write**:\n   - Updated spec: `specs/{feature-id}/spec.md`\n   - Report: `specs/{feature-id}/.workflow/analyst-report.md`\n\n   **Report format**: Follow `${CLAUDE_PLUGIN_ROOT}/templates/analyst-report-template.md`\n   ```\n\n4. **Increment iteration** in context frontmatter\n\n5. **Loop back to Phase 2**\n\n---\n\n## Supervisor Judgment: When to Exit Early\n\nUse your judgment to recommend exiting if:\n\n- **Iteration count exceeds 5**: Recommend accepting current spec or manual review\n- **User answers aren't resolving gaps**: Ask how to proceed\n- **Only minor gaps remain**: Offer to finalize with known limitations\n- **User seems satisfied**: Offer to complete even with open gaps\n\nAlways give the user the choice—never force-terminate without consent:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"We've iterated {N} times. {Context}. How should we proceed?\",\n    header: \"Next Step\",\n    options: [\n      {label: \"Continue refining\", description: \"Another round of clarification\"},\n      {label: \"Accept current spec\", description: \"Finalize with known gaps as limitations\"},\n      {label: \"Stop and review manually\", description: \"Exit workflow, review spec yourself\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\n---\n\n## Phase 5: Completion\n\n### 5.1 Update Final Status\n\nUpdate context frontmatter:\n```yaml\nstatus: completed\nupdated: {ISO date}\n```\n\n### 5.2 Generate Completion Report\n\nOutput to user:\n\n```markdown\n## Specification Complete\n\n**Feature**: {feature_id}\n**Iterations**: {count}\n\n### Files Created\n- Spec: `specs/{feature-id}/spec.md`\n- Workflow: `specs/{feature-id}/.workflow/`\n\n### Summary\n{From analyst report: user story count, requirement count}\n\n### Known Limitations\n{Any minor gaps deferred, if applicable}\n\n### Next Steps\n1. Review the spec at `specs/{feature-id}/spec.md`\n2. Run `/humaninloop:plan` to create implementation plan\n```\n\n---\n\n## Error Handling\n\n### Agent Failure\n\n```markdown\n**Agent Failed**\n\nError: {error_message}\nAgent: {agent_name}\nPhase: {phase}\n\nThe workflow state has been saved. Run `/humaninloop:specify` to resume.\n```\n\n### Missing Files\n\nIf expected output files are missing after agent invocation:\n1. Log the issue\n2. Ask user: Retry agent, or abort?\n\n---\n\n## State Recovery\n\nResume logic based on `status` field:\n\n| Status | Resume Point |\n|--------|--------------|\n| `awaiting-analyst` | Phase 2 (invoke analyst) |\n| `awaiting-advocate` | Phase 3 (invoke advocate) |\n| `awaiting-user` | Phase 4 (present clarifications) |\n| `completed` | Report already done |\n\n---\n\n## Important Notes\n\n- Do NOT modify git config or push to remote\n- Maximum practical iterations: ~5 (use judgment, not hard limit)\n- Always use Task tool to invoke agents\n- Agents have NO workflow knowledge—all context via context file\n- Supervisor owns ALL routing and state decisions"
              },
              {
                "name": "/tasks",
                "description": "Execute the multi-agent task generation workflow with specialized agents and validation loops",
                "path": "plugins/humaninloop/commands/tasks.md",
                "frontmatter": {
                  "description": "Execute the multi-agent task generation workflow with specialized agents and validation loops"
                },
                "content": "# Two-Agent Tasks Workflow\n\nYou are the **Supervisor** orchestrating a two-agent tasks workflow. You own the loop, manage state via files, and route based on agent outputs.\n\n## User Input\n\n```text\n$ARGUMENTS\n```\n\nIf `$ARGUMENTS` is empty or appears literally, check for resume state first, then proceed with the detected feature.\n\n### Empty Input Check\n\nIf `$ARGUMENTS` is empty (blank string with no content), use AskUserQuestion to handle a known Claude Code bug where inputs containing `@` file references don't reach plugin commands:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"⚠️ Known Issue: Input may have been lost\\n\\nClaude Code has a bug where inputs containing @ file references don't reach plugin commands.\\n\\nWould you like to re-enter your input?\",\n    header: \"Input\",\n    options: [\n      {label: \"Re-enter input\", description: \"I'll type my input in the terminal\"},\n      {label: \"Continue without input\", description: \"Proceed with no input provided\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\n- If user selects \"Re-enter input\" → wait for user to type their input in the terminal, then use that as the effective `$ARGUMENTS`\n- If user selects \"Continue without input\" → proceed with empty input (check resume state, then detect feature from branch)\n\n---\n\n## Architecture Overview\n\n```\nSUPERVISOR (this command)\n    │\n    ├── Creates context + directories\n    ├── Invokes agents with minimal prompts\n    ├── Parses structured prose outputs\n    ├── Updates context between phases\n    └── Owns all routing decisions\n\nAGENTS (independent, no workflow knowledge)\n    │\n    ├── Task Architect → Writes task-mapping.md, tasks.md\n    └── Devil's Advocate → Reviews artifacts, finds gaps\n```\n\n**Communication Pattern**: Context + Artifacts + Separate Reports\n\n```\nspecs/{feature-id}/\n├── spec.md                          # Input (from specify workflow)\n├── plan.md                          # Input (from plan workflow)\n├── research.md                      # Input (from plan workflow)\n├── data-model.md                    # Input (from plan workflow)\n├── contracts/                       # Input (from plan workflow)\n│   └── api.yaml\n├── task-mapping.md                  # Mapping phase output\n├── tasks.md                         # Tasks phase output\n└── .workflow/\n    ├── context.md                   # Context (specify workflow)\n    ├── plan-context.md              # Context (plan workflow)\n    ├── tasks-context.md             # Context (this workflow)\n    ├── planner-report.md            # Task Architect output\n    └── advocate-report.md           # Devil's Advocate output\n```\n\n---\n\n## Agents Used\n\n| Agent | File | Purpose |\n|-------|------|---------|\n| Task Architect | `${CLAUDE_PLUGIN_ROOT}/agents/task-architect.md` | Transform plan artifacts into task mappings and task lists |\n| Devil's Advocate | `${CLAUDE_PLUGIN_ROOT}/agents/devils-advocate.md` | Review artifacts, find gaps, generate clarifications |\n\n---\n\n## Pre-Execution: Entry Gate\n\nBefore starting, verify the plan workflow is complete:\n\n1. **Identify the feature directory**:\n   - If `$ARGUMENTS` specifies a feature ID: use that\n   - Otherwise: Detect from current git branch (branch name = feature ID, e.g., `001-user-auth`)\n   - Fallback: Find most recent spec in `specs/` by highest numeric prefix\n\n2. **Check for plan.md**: Read `specs/{feature-id}/plan.md`\n   - If NOT found: Block and tell user to run `/humaninloop:plan` first\n\n3. **Check plan workflow status**: Read `specs/{feature-id}/.workflow/plan-context.md`\n   - If `status` != `completed`:\n     ```\n     AskUserQuestion(\n       questions: [{\n         question: \"Plan workflow not complete (status: {status}). Tasks workflow requires a completed plan.\",\n         header: \"Entry Gate\",\n         options: [\n           {label: \"Complete plan first\", description: \"Return to /humaninloop:plan\"},\n           {label: \"Abort\", description: \"Cancel tasks workflow\"}\n         ],\n         multiSelect: false\n       }]\n     )\n     ```\n\n4. **If entry gate passes**: Continue to Resume Detection\n\n---\n\n## Pre-Execution: Resume Detection\n\nBefore starting, check for interrupted tasks workflows:\n\n1. **Check for existing tasks-context.md**:\n   ```bash\n   test -f specs/{feature-id}/.workflow/tasks-context.md\n   ```\n\n2. **If found**: Read frontmatter, check `status` and `phase` fields\n\n3. **If status is not completed**:\n   ```\n   AskUserQuestion(\n     questions: [{\n       question: \"Found interrupted tasks workflow for '{feature_id}' (phase: {phase}, status: {status}). Resume or start fresh?\",\n       header: \"Resume?\",\n       options: [\n         {label: \"Resume\", description: \"Continue from {phase} phase\"},\n         {label: \"Start fresh\", description: \"Delete task artifacts and restart\"}\n       ],\n       multiSelect: false\n     }]\n   )\n   ```\n\n4. **If resume**: Read context, jump to appropriate phase based on status\n5. **If fresh**: Delete task artifacts (task-mapping.md, tasks.md) and proceed\n\n---\n\n## Phase 1: Initialize\n\n### 1.1 Create Tasks Context\n\nUse the template at `${CLAUDE_PLUGIN_ROOT}/templates/tasks-context-template.md`.\n\nWrite to `specs/{feature-id}/.workflow/tasks-context.md` with these values:\n\n| Placeholder | Value |\n|-------------|-------|\n| `{{phase}}` | `mapping` |\n| `{{status}}` | `awaiting-architect` |\n| `{{iteration}}` | `1` |\n| `{{feature_id}}` | Feature ID |\n| `{{created}}` | ISO date |\n| `{{updated}}` | ISO date |\n| `{{plan_status}}` | `present` |\n| `{{constitution_path}}` | Path to constitution |\n| `{{constitution_principles}}` | Extracted key principles |\n| `{{spec_path}}` | `specs/{feature-id}/spec.md` |\n| `{{spec_status}}` | `present` |\n| `{{plan_path}}` | `specs/{feature-id}/plan.md` |\n| `{{research_path}}` | `specs/{feature-id}/research.md` |\n| `{{research_status}}` | Status (present/missing) |\n| `{{datamodel_path}}` | `specs/{feature-id}/data-model.md` |\n| `{{datamodel_status}}` | Status (present/missing) |\n| `{{contracts_path}}` | `specs/{feature-id}/contracts/` |\n| `{{contracts_status}}` | Status (present/missing) |\n| `{{mapping_path}}` | `specs/{feature-id}/task-mapping.md` |\n| `{{mapping_status}}` | `pending` |\n| `{{tasks_path}}` | `specs/{feature-id}/tasks.md` |\n| `{{tasks_status}}` | `pending` |\n| `{{architect_report_path}}` | `specs/{feature-id}/.workflow/planner-report.md` |\n| `{{advocate_report_path}}` | `specs/{feature-id}/.workflow/advocate-report.md` |\n| `{{supervisor_instructions}}` | See Phase 2 for initial instructions |\n| `{{clarification_log}}` | Empty on first iteration |\n\n---\n\n## Phase 2: Mapping\n\n### 2.1 Set Supervisor Instructions for Architect\n\nUpdate `{{supervisor_instructions}}` in tasks-context.md:\n\n```markdown\n**Phase**: Mapping\n\nCreate task mapping document from plan artifacts.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Plan: `specs/{feature-id}/plan.md`\n- Research: `specs/{feature-id}/research.md`\n- Data Model: `specs/{feature-id}/data-model.md`\n- Contracts: `specs/{feature-id}/contracts/`\n- Constitution: `.humaninloop/memory/constitution.md`\n\n**Write**:\n- Mapping: `specs/{feature-id}/task-mapping.md`\n- Report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Use Skills**:\n- `patterns-vertical-tdd` (identify vertical slices)\n\n**Report format**: Follow planner report template\n```\n\n### 2.2 Update Context Status\n\nUpdate tasks-context.md frontmatter:\n```yaml\nphase: mapping\nstatus: awaiting-architect\nupdated: {ISO date}\n```\n\n### 2.3 Invoke Task Architect\n\n```\nTask(\n  subagent_type: \"humaninloop:task-architect\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/tasks-context.md\",\n  description: \"Create task mapping\"\n)\n```\n\n### 2.4 Verify Output\n\nConfirm the agent created:\n- `specs/{feature-id}/task-mapping.md`\n- `specs/{feature-id}/.workflow/planner-report.md`\n\nIf missing, report error and stop.\n\n### 2.5 Advocate Review\n\nUpdate context for advocate:\n\n```markdown\n**Phase**: Mapping Review\n\nReview the task mapping for gaps and quality.\n\n**Read**:\n- Spec: `specs/{feature-id}/spec.md`\n- Plan: `specs/{feature-id}/plan.md`\n- Task Mapping: `specs/{feature-id}/task-mapping.md`\n- Architect report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Write**:\n- Report: `specs/{feature-id}/.workflow/advocate-report.md`\n\n**Use Skills**:\n- `validation-task-artifacts` (phase: mapping)\n\n**Report format**: Follow advocate report template\n```\n\nUpdate status:\n```yaml\nstatus: awaiting-advocate\n```\n\nInvoke advocate:\n```\nTask(\n  subagent_type: \"humaninloop:devils-advocate\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/tasks-context.md\",\n  description: \"Review task mapping\"\n)\n```\n\n### 2.6 Route Based on Verdict\n\nRead advocate report and extract verdict.\n\n**If verdict is `ready`**:\n- Update `{{mapping_status}}` to `complete`\n- Proceed to Phase 3 (Tasks)\n\n**If verdict is `needs-revision` or `critical-gaps`**:\n- Present clarifications to user (see Clarification Loop)\n- Update context with answers\n- Increment iteration\n- Loop back to 2.3\n\n---\n\n## Phase 3: Tasks\n\n### 3.1 Set Supervisor Instructions for Architect\n\nUpdate `{{supervisor_instructions}}` in tasks-context.md:\n\n```markdown\n**Phase**: Tasks\n\nCreate implementation task list from mapping.\n\n**Read**:\n- Task Mapping: `specs/{feature-id}/task-mapping.md`\n- Spec: `specs/{feature-id}/spec.md`\n- Plan: `specs/{feature-id}/plan.md`\n- Research: `specs/{feature-id}/research.md`\n- Data Model: `specs/{feature-id}/data-model.md`\n- Contracts: `specs/{feature-id}/contracts/`\n- Constitution: `.humaninloop/memory/constitution.md`\n\n**Write**:\n- Tasks: `specs/{feature-id}/tasks.md`\n- Report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Use Skills**:\n- `patterns-vertical-tdd` (TDD cycle structure)\n\n**Report format**: Follow planner report template\n```\n\n### 3.2 Update Context Status\n\n```yaml\nphase: tasks\nstatus: awaiting-architect\niteration: 1\nupdated: {ISO date}\n```\n\n### 3.3 Invoke Task Architect\n\n```\nTask(\n  subagent_type: \"humaninloop:task-architect\",\n  prompt: \"Read your instructions from: specs/{feature-id}/.workflow/tasks-context.md\",\n  description: \"Create implementation tasks\"\n)\n```\n\n### 3.4 Verify Output\n\nConfirm: `specs/{feature-id}/tasks.md`\n\n### 3.5 Advocate Review (Cumulative)\n\nUpdate context for advocate:\n\n```markdown\n**Phase**: Tasks Review\n\nReview the task list for completeness and TDD structure.\n\n**Read**:\n- Task Mapping: `specs/{feature-id}/task-mapping.md`\n- Tasks: `specs/{feature-id}/tasks.md`\n- Spec: `specs/{feature-id}/spec.md`\n- Architect report: `specs/{feature-id}/.workflow/planner-report.md`\n\n**Write**:\n- Report: `specs/{feature-id}/.workflow/advocate-report.md`\n\n**Use Skills**:\n- `validation-task-artifacts` (phase: tasks)\n\n**Check**:\n- TDD structure (test-first ordering in each cycle)\n- Cycle coverage (all mapped cycles have tasks)\n- File path specificity\n- Cross-artifact consistency with mapping\n```\n\nInvoke advocate and route based on verdict (same as Phase 2).\n\n**If ready**: Proceed to Phase 4 (Completion)\n\n---\n\n## Clarification Loop\n\nWhen advocate verdict is `needs-revision` or `critical-gaps`:\n\n1. **Present clarifications to user** using AskUserQuestion:\n   ```\n   AskUserQuestion(\n     questions: clarifications.map(c => ({\n       question: c.question,\n       header: c.gap_id,\n       options: c.options || [\n         {label: \"Yes\", description: \"\"},\n         {label: \"No\", description: \"\"},\n         {label: \"Not sure\", description: \"Needs more discussion\"}\n       ],\n       multiSelect: false\n     }))\n   )\n   ```\n\n2. **Update context with user answers**:\n   Append to `## Clarification Log`:\n   ```markdown\n   ### Phase: {phase} - Iteration {N}\n\n   #### Gaps Identified\n   {List from advocate report}\n\n   #### User Answers\n   | Gap ID | Question | Answer |\n   |--------|----------|--------|\n   | G1 | {question} | {user's answer} |\n   ```\n\n3. **Update supervisor instructions for revision**:\n   ```markdown\n   **Phase**: {phase} (Revision)\n\n   Revise the {artifact} based on user feedback.\n\n   **Read**:\n   - Current artifact: `specs/{feature-id}/{artifact}`\n   - Gaps and user answers: See `## Clarification Log` below\n   - Previous artifacts for context\n\n   **Write**:\n   - Updated artifact: `specs/{feature-id}/{artifact}`\n   - Report: `specs/{feature-id}/.workflow/planner-report.md`\n   ```\n\n4. **Increment iteration** in context frontmatter\n\n5. **Loop back to Architect invocation**\n\n---\n\n## Supervisor Judgment: When to Exit Early\n\nUse your judgment to recommend exiting if:\n\n- **Gaps aren't resolving**: Same issues recurring across iterations\n- **Only minor gaps remain**: Offer to finalize with known limitations\n- **User seems satisfied**: Offer to complete even with open gaps\n\nAlways give the user the choice—never force-terminate without consent:\n\n```\nAskUserQuestion(\n  questions: [{\n    question: \"We've been iterating on the {phase} phase. {Context}. How should we proceed?\",\n    header: \"Next Step\",\n    options: [\n      {label: \"Continue refining\", description: \"Another round of revision\"},\n      {label: \"Accept current state\", description: \"Proceed to next phase with known gaps\"},\n      {label: \"Stop and review manually\", description: \"Exit workflow, review artifacts yourself\"}\n    ],\n    multiSelect: false\n  }]\n)\n```\n\n---\n\n## Phase 4: Completion\n\n### 4.1 Update Final Status\n\nUpdate tasks-context.md frontmatter:\n```yaml\nphase: completed\nstatus: completed\nupdated: {ISO date}\n```\n\nUpdate artifact statuses:\n```yaml\nmapping_status: complete\ntasks_status: complete\n```\n\n### 4.2 Generate Completion Report\n\nOutput to user:\n\n```markdown\n## Tasks Workflow Complete\n\n**Feature**: {feature_id}\n\n### Summary\n- Cycles mapped: {count from task-mapping.md}\n- Tasks generated: {count from tasks.md}\n- Foundation cycles: {count}\n- Feature cycles: {count}\n- Parallel opportunities: {count with [P] marker}\n\n### Artifacts Generated\n- `specs/{feature-id}/task-mapping.md` - Story to cycle mapping\n- `specs/{feature-id}/tasks.md` - Implementation tasks with TDD structure\n\n### Known Limitations\n{Any minor gaps deferred, if applicable}\n\n### Next Steps\n1. Review the tasks at `specs/{feature-id}/tasks.md`\n2. Run `/humaninloop:implement` to execute the implementation\n```\n\n---\n\n## Error Handling\n\n### Agent Failure\n\n```markdown\n**Agent Failed**\n\nError: {error_message}\nAgent: {agent_name}\nPhase: {phase}\n\nThe workflow state has been saved. Run `/humaninloop:tasks` to resume from {phase} phase.\n```\n\n### Missing Files\n\nIf expected output files are missing after agent invocation:\n1. Log the issue\n2. Ask user: Retry agent, or abort?\n\n---\n\n## State Recovery\n\nResume logic based on `phase` and `status` fields:\n\n| Phase | Status | Resume Point |\n|-------|--------|--------------|\n| `mapping` | `awaiting-architect` | Phase 2.3 (invoke architect) |\n| `mapping` | `awaiting-advocate` | Phase 2.5 (invoke advocate) |\n| `mapping` | `awaiting-user` | Clarification loop |\n| `tasks` | `awaiting-architect` | Phase 3.3 (invoke architect) |\n| `tasks` | `awaiting-advocate` | Phase 3.5 (invoke advocate) |\n| `tasks` | `awaiting-user` | Clarification loop |\n| `completed` | `completed` | Report already done |\n\n---\n\n## Important Notes\n\n- Do NOT modify git config or push to remote\n- Use judgment for iteration limits (no hard caps)\n- Always use Task tool to invoke agents\n- Agents have NO workflow knowledge—all context via context file\n- Supervisor owns ALL routing and state decisions\n- Advocate reviews are cumulative (check against mapping when reviewing tasks)\n- Brownfield context comes from plan artifacts, not re-analyzed"
              }
            ],
            "skills": [
              {
                "name": "analysis-codebase",
                "description": "Analyze existing codebases for tech stack, conventions, entities, and patterns. Use when scanning projects for context, brownfield analysis, or when you see \"tech stack\", \"codebase analysis\", \"existing code\", \"collision risk\", \"brownfield\", or \"project context\".",
                "path": "plugins/humaninloop/skills/analysis-codebase/SKILL.md",
                "frontmatter": {
                  "name": "analysis-codebase",
                  "description": "Analyze existing codebases for tech stack, conventions, entities, and patterns. Use when scanning projects for context, brownfield analysis, or when you see \"tech stack\", \"codebase analysis\", \"existing code\", \"collision risk\", \"brownfield\", or \"project context\"."
                },
                "content": "# Analyzing Codebase\n\n## Purpose\n\nSystematically analyze existing codebases to extract structural information. Supports three modes:\n\n1. **Context Mode**: Gather project characteristics to inform constitution authoring\n2. **Brownfield Mode**: Extract entities, endpoints, and collision risks for planning\n3. **Setup-Brownfield Mode**: Comprehensive analysis for `/humaninloop:setup` producing codebase-analysis.md\n\n## Mode Selection\n\n| Mode | When to Use | Output |\n|------|-------------|--------|\n| **Context** | Setting up constitution, understanding project DNA | Markdown report for humans |\n| **Brownfield** | Planning new features against existing code | JSON inventory with collision risks |\n| **Setup-Brownfield** | `/humaninloop:setup` on existing codebase | `codebase-analysis.md` with inventory + assessment |\n\n## Project Type Detection\n\nIdentify project type from package manager files:\n\n| File | Project Type |\n|------|--------------|\n| `package.json` | Node.js/JavaScript/TypeScript |\n| `pyproject.toml` / `requirements.txt` | Python |\n| `go.mod` | Go |\n| `Cargo.toml` | Rust |\n| `pom.xml` / `build.gradle` | Java |\n| `Gemfile` | Ruby |\n| `pubspec.yaml` | Flutter/Dart |\n\n## Framework Detection\n\n### Web Frameworks\n\n| Framework | Indicators |\n|-----------|------------|\n| **Express** | `express()`, `router.get()`, `app.use()` |\n| **FastAPI** | `@app.get()`, `FastAPI()`, `APIRouter` |\n| **Django** | `urls.py`, `views.py`, `models.py` pattern |\n| **Flask** | `@app.route()`, `@bp.route()` |\n| **Rails** | `routes.rb`, `app/models/`, `app/controllers/` |\n| **Spring** | `@RestController`, `@GetMapping`, `@Entity` |\n| **Gin/Echo** | `r.GET()`, `e.GET()` |\n\n### ORM/Database Frameworks\n\n| Framework | Indicators |\n|-----------|------------|\n| **Prisma** | `schema.prisma`, `@prisma/client` |\n| **TypeORM** | `@Entity()`, `@Column()`, `DataSource` |\n| **SQLAlchemy** | `Base`, `db.Model`, `Column()` |\n| **Django ORM** | `models.Model`, `models.CharField` |\n| **GORM** | `gorm.Model`, `db.AutoMigrate` |\n| **Mongoose** | `mongoose.Schema`, `new Schema({` |\n| **ActiveRecord** | `ApplicationRecord`, `has_many` |\n\n## Architecture Pattern Recognition\n\n| Pattern | Indicators |\n|---------|------------|\n| **Layered** | `src/models/`, `src/services/`, `src/controllers/` |\n| **Feature-based** | `src/auth/`, `src/users/`, `src/tasks/` |\n| **Microservices** | Multiple package files, docker compose |\n| **Serverless** | `serverless.yml`, `lambda/`, `functions/` |\n| **MVC** | `models/`, `views/`, `controllers/` |\n| **Clean/Hexagonal** | `domain/`, `application/`, `infrastructure/` |\n\n## Mode: Context Gathering\n\nFor constitution authoring - gather broad project characteristics.\n\n**What to Extract:**\n- Tech stack with versions\n- Linting/formatting conventions\n- CI/CD quality gates\n- Team signals (test coverage, required approvals, CODEOWNERS)\n- Existing governance docs (CODEOWNERS, ADRs, CONTRIBUTING.md)\n\n**Output**: Project Context Report (markdown)\n\nSee [CONTEXT-GATHERING.md](CONTEXT-GATHERING.md) for detailed guidance.\n\n## Mode: Brownfield Analysis\n\nFor planning - extract structural details for collision detection.\n\n**What to Extract:**\n- Entities with fields and relationships\n- Endpoints with handlers\n- Collision risks against proposed spec\n\n**Output**: Codebase Inventory (JSON)\n\nSee [BROWNFIELD-ANALYSIS.md](BROWNFIELD-ANALYSIS.md) for detailed guidance.\n\n## Mode: Setup Brownfield\n\nFor `/humaninloop:setup` - comprehensive analysis combining Context + Brownfield with Essential Floor assessment.\n\n**What to Extract:**\n- Everything from Context mode (tech stack, conventions, architecture)\n- Everything from Brownfield mode (entities, relationships)\n- Essential Floor assessment (Security, Testing, Error Handling, Observability)\n- Inconsistencies and strengths assessment\n\n**Output**: `.humaninloop/memory/codebase-analysis.md` following `codebase-analysis-template.md`\n\n### Essential Floor Analysis\n\nAssess each of the four essential floor categories:\n\n#### Security Assessment\n\n| Check | How to Detect | Status Values |\n|-------|---------------|---------------|\n| Auth at boundaries | Middleware patterns (`authenticate`, `authorize`, `requireAuth`) | present/partial/absent |\n| Secrets from env | `.env.example` exists, no hardcoded credentials in code | present/partial/absent |\n| Input validation | Schema validation libraries, input checking patterns | present/partial/absent |\n\n**Indicators to search:**\n```bash\n# Auth middleware\ngrep -r \"authenticate\\|authorize\\|requireAuth\\|isAuthenticated\" src/ 2>/dev/null\n\n# Environment variables\nls .env.example .env.sample 2>/dev/null\ngrep -r \"process.env\\|os.environ\\|os.Getenv\" src/ 2>/dev/null\n\n# Validation\ngrep -r \"zod\\|yup\\|joi\\|pydantic\\|validator\" package.json pyproject.toml 2>/dev/null\n```\n\n#### Testing Assessment\n\n| Check | How to Detect | Status Values |\n|-------|---------------|---------------|\n| Test framework configured | Config files (`jest.config.*`, `pytest.ini`, `vitest.config.*`) | present/partial/absent |\n| Test files present | Files matching `*.test.*`, `*_test.*`, `test_*.*` | present/partial/absent |\n| CI runs tests | Test commands in workflow files | present/partial/absent |\n\n**Indicators to search:**\n```bash\n# Test config\nls jest.config.* vitest.config.* pytest.ini pyproject.toml 2>/dev/null\n\n# Test files\nfind . -name \"*.test.*\" -o -name \"*_test.*\" -o -name \"test_*.*\" 2>/dev/null | head -5\n\n# CI test commands\ngrep -r \"npm test\\|yarn test\\|pytest\\|go test\" .github/workflows/ 2>/dev/null\n```\n\n#### Error Handling Assessment\n\n| Check | How to Detect | Status Values |\n|-------|---------------|---------------|\n| Explicit error types | Custom error classes/types defined | present/partial/absent |\n| Context preservation | Error messages include context, stack traces logged | present/partial/absent |\n| Appropriate status codes | API responses use correct HTTP status codes | present/partial/absent |\n\n**Indicators to search:**\n```bash\n# Custom errors\ngrep -r \"class.*Error\\|extends Error\\|Exception\" src/ 2>/dev/null | head -5\n\n# Error logging\ngrep -r \"error.*context\\|error.*stack\\|logger.error\" src/ 2>/dev/null | head -3\n\n# Status codes\ngrep -r \"status(4\\|status(5\\|HttpStatus\\|status_code\" src/ 2>/dev/null | head -3\n```\n\n#### Observability Assessment\n\n| Check | How to Detect | Status Values |\n|-------|---------------|---------------|\n| Structured logging | Logger config (winston, pino, structlog, logrus) | present/partial/absent |\n| Correlation IDs | Request ID middleware, trace ID patterns | present/partial/absent |\n| No PII in logs | Log sanitization, no email/password in log statements | present/partial/absent |\n\n**Indicators to search:**\n```bash\n# Logger config\ngrep -r \"winston\\|pino\\|structlog\\|logrus\\|zap\" package.json pyproject.toml go.mod 2>/dev/null\n\n# Correlation IDs\ngrep -r \"requestId\\|correlationId\\|traceId\\|x-request-id\" src/ 2>/dev/null | head -3\n\n# PII check (negative - should NOT find these in logs)\ngrep -r \"logger.*email\\|logger.*password\\|log.*password\" src/ 2>/dev/null\n```\n\n### Setup-Brownfield Quality Checklist\n\nBefore finalizing setup-brownfield analysis:\n\n- [ ] Project identity complete (name, language, framework, entry points)\n- [ ] Directory structure documented with purposes\n- [ ] Architecture pattern identified with evidence\n- [ ] Naming conventions documented (files, variables, functions, classes)\n- [ ] All four Essential Floor categories assessed\n- [ ] Domain entities extracted with relationships\n- [ ] External dependencies documented\n- [ ] Strengths to preserve identified (minimum 2-3)\n- [ ] Inconsistencies documented with severity\n- [ ] Recommendations provided for constitution focus\n\n## Detection Script\n\nRun the automated detection script for fast, deterministic stack identification:\n\n```bash\nbash scripts/detect-stack.sh /path/to/project\n```\n\n**Output:**\n```json\n{\n  \"project_type\": \"nodejs\",\n  \"package_manager\": \"npm\",\n  \"frameworks\": [\"express\"],\n  \"orms\": [\"prisma\"],\n  \"architecture\": [\"feature-based\"],\n  \"ci_cd\": [\"github-actions\"],\n  \"files_found\": {...}\n}\n```\n\nThe script detects:\n- **Project type**: nodejs, python, go, rust, java, ruby, flutter, elixir\n- **Package manager**: npm, yarn, pnpm, pip, poetry, cargo, etc.\n- **Frameworks**: express, fastapi, django, nextjs, gin, rails, spring-boot, etc.\n- **ORMs**: prisma, typeorm, sqlalchemy, mongoose, gorm, activerecord, etc.\n- **Architecture**: clean-architecture, mvc, layered, feature-based, serverless, microservices\n- **CI/CD**: github-actions, gitlab-ci, jenkins, circleci, etc.\n\n**Usage pattern:**\n1. Run script first for deterministic baseline\n2. Use script output to guide deeper LLM analysis\n3. Script findings are ground truth; LLM adds nuance\n\n## Manual Detection Commands\n\nFor cases where script detection is insufficient:\n\n```bash\n# Tech stack detection\ncat package.json | jq '{name, engines, dependencies}'\ncat pyproject.toml\ncat .tool-versions .nvmrc .python-version 2>/dev/null\n\n# Architecture detection\nls -d src/domain src/application src/features 2>/dev/null\n\n# CI/CD detection\nls .github/workflows/*.yml .gitlab-ci.yml 2>/dev/null\n\n# Governance detection\nls CODEOWNERS .github/CODEOWNERS docs/CODEOWNERS 2>/dev/null\ncat CODEOWNERS 2>/dev/null | head -20\n\n# Test structure\nls -d test/ tests/ spec/ __tests__/ 2>/dev/null\n```\n\n## Quality Checklist\n\nBefore finalizing analysis:\n\n**Both Modes:**\n- [ ] Project type and framework correctly identified\n- [ ] Architecture pattern documented\n- [ ] File paths cited for all findings\n\n**Context Mode:**\n- [ ] Existing linting/formatting config extracted\n- [ ] CI quality gates analyzed\n- [ ] Existing governance docs checked (CODEOWNERS, ADRs, CONTRIBUTING.md)\n- [ ] Approvers identified (from CODEOWNERS or team structure)\n- [ ] Recommendations provided\n\n**Brownfield Mode:**\n- [ ] All entity directories scanned\n- [ ] All route directories scanned\n- [ ] Collision risks classified by severity\n\n**Setup-Brownfield Mode:**\n- [ ] All Context Mode checks completed\n- [ ] All four Essential Floor categories assessed\n- [ ] Strengths and inconsistencies documented\n- [ ] Output written to `.humaninloop/memory/codebase-analysis.md`\n\n## Anti-Patterns\n\n| Anti-Pattern | Problem | Fix |\n|--------------|---------|-----|\n| **Assuming framework** | Guessing without evidence | Verify with code patterns |\n| **Missing directories** | Only checking standard paths | Projects vary, explore |\n| **Over-extracting** | Analyzing every file | Focus on config and patterns |\n| **Ignoring governance** | Missing existing decisions | Check README, CLAUDE.md, ADRs |\n| **Inventing findings** | Documenting assumptions | Only report what's found |"
              },
              {
                "name": "analysis-iterative",
                "description": "This skill should be used when the user says \"brainstorm\", \"deep analysis\", \"let's think through\", \"analyze this with me\", or \"help me think through\". Provides progressive deep analysis through one-by-one questioning with 2-3 options per question and clear recommendations. Challenges disagreement to strengthen thinking and concludes with a synthesis document.",
                "path": "plugins/humaninloop/skills/analysis-iterative/SKILL.md",
                "frontmatter": {
                  "name": "analysis-iterative",
                  "description": "This skill should be used when the user says \"brainstorm\", \"deep analysis\", \"let's think through\", \"analyze this with me\", or \"help me think through\". Provides progressive deep analysis through one-by-one questioning with 2-3 options per question and clear recommendations. Challenges disagreement to strengthen thinking and concludes with a synthesis document."
                },
                "content": "# Iterative Analysis\n\n## Purpose\n\nGuide deep thinking through progressive, one-at-a-time questioning. Each question builds on previous answers, creating a collaborative exploration that concludes with a structured synthesis document.\n\n## Workflow Phases\n\n### Phase 1: Opening\n\nWhen triggered, acknowledge the topic and set expectations:\n\n```\nI'll help you think through [topic] with a series of focused questions.\n\nFor each question, I'll present options with my recommendation. Feel free to\ndisagree—I'll push back to help strengthen your thinking.\n\nLet's begin.\n```\n\nThen ask the first question.\n\n### Phase 2: Iterative Questioning\n\n**Core Rules:**\n1. ONE question per turn—never multiple questions\n2. Always provide 2-3 concrete options\n3. Always state your recommendation with reasoning\n4. After each answer, briefly show how it affects the analysis before the next question\n\n**Question Format:**\n\n```\n[Brief context showing current understanding and how previous answer shaped thinking]\n\n**Question [N]**: [Clear, focused question]\n\n**Options:**\n- **A) [Option name]**: [What this means and its implications]\n- **B) [Option name]**: [What this means and its implications]\n- **C) [Option name]**: [What this means and its implications]\n\n**My Recommendation**: Option [X] because [clear reasoning based on what we know so far]\n```\n\n**After receiving an answer:**\n\n```\n[Acknowledge the choice]\n\n[Show how this shapes the analysis—what it opens up, what it rules out,\nwhat becomes more important to explore]\n\n[Transition to next question]\n```\n\n### Phase 3: Handling Disagreement\n\nWhen the user picks differently than recommended:\n\n1. **Explore their reasoning**: \"What's drawing you to that direction?\"\n2. **Present counterarguments**: Share your concerns respectfully but directly\n3. **If they maintain their choice**: Accept it, integrate it, and proceed\n\nExample:\n```\nInteresting—you're leaning toward [their choice] over [your recommendation].\n\nBefore we lock that in, let me push back: [specific concern or trade-off they\nmay not have considered].\n\nWhat's your thinking on that?\n```\n\nIf they confirm after the challenge, acknowledge and integrate:\n```\nFair enough. That's a deliberate choice with eyes open to the trade-offs.\nLet me factor that in...\n\n[Show how this affects the analysis]\n```\n\n### Phase 4: Conclusion\n\nWhen core decisions are made or user signals completion, generate the synthesis.\n\n**Transition to synthesis:**\n```\nI think we've covered the key decision points. Let me synthesize what we've\nworked through...\n```\n\nThen generate the synthesis document. See [SYNTHESIS.md](SYNTHESIS.md) for the template.\n\n## Adaptive Depth\n\nDo NOT force a fixed number of questions. Continue until:\n- Core decisions are made\n- The user signals they're ready to conclude\n- A natural stopping point is reached\n\nSigns to wrap up:\n- Answers are becoming more confirmatory than exploratory\n- Key trade-offs have been explicitly addressed\n- The user's confidence in direction is increasing\n\n## Examples\n\n### Good Question\n```\nBased on your focus on rapid iteration, we need to decide on the feedback mechanism.\n\n**Question 3**: How quickly do users need to see the impact of their changes?\n\n**Options:**\n- **A) Real-time (< 100ms)**: Changes reflect instantly. Highest technical complexity\n  but most responsive feel.\n- **B) Near-real-time (1-3 seconds)**: Brief processing delay. Simpler to implement,\n  still feels responsive.\n- **C) On-demand refresh**: User explicitly triggers update. Simplest, but breaks flow.\n\n**My Recommendation**: Option B because your team is small and time-to-market\nmatters. Real-time adds significant complexity for marginal UX gain at this stage.\nYou can always upgrade later.\n```\n\n### Good Disagreement Handling\n```\nYou're leaning toward real-time over my near-real-time recommendation.\n\nI want to make sure you've weighed this: real-time means WebSocket infrastructure,\nhandling reconnection logic, and conflict resolution—easily 2-3x the implementation\nwork. Your team of three would be stretched thin.\n\nIs the instant feedback worth that trade-off, or is there a specific user flow\nwhere real-time is non-negotiable?\n```\n\n### Good Transition After Answer\n```\nGot it—you're prioritizing simplicity with the on-demand refresh approach.\n\nThat's a pragmatic call. It means we can skip the real-time infrastructure entirely\nand focus engineering time on the core value proposition. Users will need a clear\n\"refresh\" affordance, but that's a UI detail we can nail.\n\nThis actually opens up our next question about data freshness expectations...\n```\n\n## Anti-Patterns to Avoid\n\n- Asking multiple questions in one turn\n- Presenting options without a clear recommendation\n- Accepting user's choice without exploring disagreement\n- Asking questions that don't build on previous answers\n- Rushing to conclusion before core decisions are made\n- Making the synthesis before explicitly transitioning"
              },
              {
                "name": "analysis-specifications",
                "description": "Review specifications to find gaps and generate clarifying questions. Use when reviewing spec.md, finding missing requirements, identifying ambiguities, or when you see \"review spec\", \"find gaps\", \"what's missing\", or \"clarify requirements\". Focuses on product decisions, not implementation details.",
                "path": "plugins/humaninloop/skills/analysis-specifications/SKILL.md",
                "frontmatter": {
                  "name": "analysis-specifications",
                  "description": "Review specifications to find gaps and generate clarifying questions. Use when reviewing spec.md, finding missing requirements, identifying ambiguities, or when you see \"review spec\", \"find gaps\", \"what's missing\", or \"clarify requirements\". Focuses on product decisions, not implementation details."
                },
                "content": "# Reviewing Specifications\n\n## Purpose\n\nFind gaps in specifications and generate clarifying questions that a product owner or stakeholder can answer. Focus on WHAT is missing, not HOW to implement.\n\n## Core Principle\n\n**Ask product questions, not implementation questions.**\n\n| Wrong (Technical) | Right (Product) |\n|-------------------|-----------------|\n| \"What happens if the database connection fails?\" | \"What should users see if the system is temporarily unavailable?\" |\n| \"Should we use optimistic or pessimistic locking?\" | \"Can two users edit the same item simultaneously?\" |\n| \"What's the retry policy for failed API calls?\" | \"How long should users wait before seeing an error?\" |\n| \"What HTTP status code for invalid input?\" | \"What message should users see for invalid input?\" |\n\n## Question Format\n\nFrame every question as a decision the user can make:\n\n```markdown\n**Question**: [Clear product decision]\n\n**Options**:\n1. [Concrete choice] - [What this means for users]\n2. [Concrete choice] - [What this means for users]\n3. [Concrete choice] - [What this means for users]\n\n**Why this matters**: [User or business impact]\n```\n\n## Gap Categories\n\nFocus on these user-facing gaps:\n\n| Category | Example Questions |\n|----------|-------------------|\n| **User expectations** | \"What should users see when...?\" |\n| **Business rules** | \"Is X allowed? Under what conditions?\" |\n| **Scope boundaries** | \"Is Y in scope for this feature?\" |\n| **Success/failure states** | \"What happens if the user...?\" |\n| **Permissions** | \"Who can do X? Who cannot?\" |\n\n## What to Avoid\n\n- Implementation details (databases, APIs, protocols)\n- Technical edge cases (connection failures, race conditions)\n- Architecture decisions (caching, queuing, scaling)\n- Performance specifications (latency, throughput)\n\nThese are valid concerns but belong in the planning phase, not specification.\n\n## Severity Classification\n\n| Severity | Definition | Action |\n|----------|------------|--------|\n| **Critical** | Cannot build without this answer | Must ask now |\n| **Important** | Will cause rework if not clarified | Should ask now |\n| **Minor** | Polish issue, can defer | Log and continue |\n\n## Output Format\n\n```markdown\n## Gaps Found\n\n### Critical\n- **Gap**: [What's missing]\n  - **Question**: [Product decision needed]\n  - **Options**: [2-3 choices]\n\n### Important\n- **Gap**: [What's missing]\n  - **Question**: [Product decision needed]\n  - **Options**: [2-3 choices]\n\n### Minor (Deferred)\n- [Gap description] - can be resolved during planning\n```\n\n## Review Process\n\n1. **Read the full specification** before identifying gaps\n2. **Check each user story** for completeness\n3. **Verify success criteria** are measurable\n4. **Identify missing edge cases** for each flow\n5. **Classify gaps** by severity\n6. **Generate questions** with concrete options\n7. **Group related gaps** to avoid overwhelming stakeholders\n\n## Quality Checklist\n\nBefore finalizing the review, verify:\n\n- [ ] All user stories reviewed for completeness\n- [ ] Success criteria checked for measurability\n- [ ] Edge cases identified for each main flow\n- [ ] Gaps classified by severity (Critical/Important/Minor)\n- [ ] All questions are product-focused (not technical)\n- [ ] Each question has 2-3 concrete options\n- [ ] \"Why this matters\" explains user/business impact\n- [ ] Related gaps grouped together\n- [ ] No implementation details in questions\n\n## Anti-Patterns to Avoid\n\n| Anti-Pattern | Problem | Fix |\n|--------------|---------|-----|\n| **Technical questions** | \"What retry policy?\" asks implementation | Ask \"How long should users wait?\" |\n| **Vague questions** | \"What about errors?\" is unclear | Be specific: \"What message when X fails?\" |\n| **No options** | Open-ended questions are hard to answer | Provide 2-3 concrete choices |\n| **Too many gaps** | Overwhelming stakeholders | Limit to 5-7 critical/important per round |\n| **Missing impact** | Stakeholder doesn't know why it matters | Add \"Why this matters\" for each |\n| **Implementation bias** | Framing assumes technical solution | Focus on user outcomes |\n| **Scope creep** | Adding new features as \"gaps\" | Only clarify existing scope |\n| **Ignoring context** | Missing domain knowledge | Reference existing patterns/decisions |"
              },
              {
                "name": "authoring-constitution",
                "description": "Write enforceable, testable constitution content with proper principle structure, section templates, and RFC 2119 keywords. Use when creating constitutions, writing principles, defining governance, or when you see \"constitution\", \"governance\", \"principles\", \"enforcement\", or \"amendment process\". Core skill for greenfield projects.",
                "path": "plugins/humaninloop/skills/authoring-constitution/SKILL.md",
                "frontmatter": {
                  "name": "authoring-constitution",
                  "description": "Write enforceable, testable constitution content with proper principle structure, section templates, and RFC 2119 keywords. Use when creating constitutions, writing principles, defining governance, or when you see \"constitution\", \"governance\", \"principles\", \"enforcement\", or \"amendment process\". Core skill for greenfield projects."
                },
                "content": "# Authoring Constitution\n\n## Purpose\n\nWrite project constitutions that teams actually follow. Every principle must be enforceable, testable, and justified. Vague aspirations are rejected in favor of actionable constraints with measurable criteria.\n\n## The Three-Part Principle Rule\n\nEvery principle MUST have three components. A principle without all three is incomplete and should not be accepted.\n\n### 1. Enforcement\n\nHow compliance is verified. Without enforcement, a principle is a suggestion.\n\n```markdown\n**Enforcement**:\n- CI runs `ruff check .` and blocks merge on violations\n- Code review MUST verify test files accompany new functionality\n- Quarterly audit checks exception registry for staleness\n```\n\n**Enforcement Types**:\n\n| Type | Examples | Strength |\n|------|----------|----------|\n| **CI Automated** | Linting, tests, coverage gates | Strongest—no human judgment needed |\n| **Code Review** | Architecture compliance, security review | Strong—explicit checklist item |\n| **Tooling** | Pre-commit hooks, IDE plugins | Medium—can be bypassed |\n| **Audit** | Quarterly review, compliance check | Weaker—periodic, not continuous |\n\n### 2. Testability\n\nWhat pass/fail looks like. If you can't test it, it's not a principle—it's an aspiration.\n\n```markdown\n**Testability**:\n- Pass: `flutter analyze` exits with code 0\n- Pass: All functions have ≤10 cyclomatic complexity\n- Fail: Any file exceeds 400 lines without documented exception\n```\n\n**Testability Requirements**:\n- Binary outcome (pass or fail)\n- Measurable threshold where applicable\n- Observable without subjective judgment\n- Reproducible by any team member\n\n### 3. Rationale\n\nWhy this constraint exists. Future maintainers need this to evaluate if the rule is still relevant.\n\n```markdown\n**Rationale**: Tests written after implementation tend to validate what was built rather than what was intended. Test-first ensures requirements drive implementation, catches defects early, and produces inherently testable, modular code.\n```\n\n**Rationale Requirements**:\n- Explains the failure mode this prevents\n- Describes the success this enables\n- Provides context for future evaluation\n- Justifies the enforcement overhead\n\n## Principle Writing Format\n\n```markdown\n### I. [Principle Name]\n\n[Declarative statement of the constraint using RFC 2119 keywords]\n\n- [Specific rule 1]\n- [Specific rule 2]\n- [Specific rule 3]\n\n**Enforcement**:\n- [How compliance is verified]\n- [Specific commands or processes]\n\n**Testability**:\n- [Pass/fail criteria]\n- [Measurable thresholds]\n\n**Rationale**: [Why this constraint exists—what failure it prevents, what success it enables]\n```\n\n## RFC 2119 Keywords\n\nUse precise language for requirements:\n\n| Keyword | Meaning | Example |\n|---------|---------|---------|\n| **MUST** | Absolute requirement; no exceptions | \"Tests MUST pass before merge\" |\n| **MUST NOT** | Absolute prohibition | \"Secrets MUST NOT be committed\" |\n| **SHOULD** | Recommended; valid exceptions exist | \"Functions SHOULD be under 40 lines\" |\n| **SHOULD NOT** | Discouraged; valid exceptions exist | \"Magic numbers SHOULD NOT appear\" |\n| **MAY** | Optional; implementation choice | \"Teams MAY adopt additional linting rules\" |\n\nSee [RFC-2119-KEYWORDS.md](RFC-2119-KEYWORDS.md) for detailed usage.\n\n## Mandatory Constitution Sections\n\nEvery constitution MUST include these sections:\n\n### 1. SYNC IMPACT REPORT (Header)\n\nTrack changes as HTML comment at file top. This provides an audit trail of constitution evolution.\n\n```html\n<!--\nSYNC IMPACT REPORT\n==================\nVersion change: X.Y.Z → A.B.C (MAJOR|MINOR|PATCH: Brief rationale)\n\nModified principles: [List or \"None (enforcement details updated)\"]\n\nAdded sections:\n- [New section name]\n\nRemoved sections:\n- [Removed section name] (or \"None\")\n\nConfiguration changes:\n- [File/path change]: [old] → [new]\n- [Structural change description]\n\nTemplates requiring updates:\n- CLAUDE.md: [Status - updated ✅ or pending ⚠️]\n- [Other templates]: [Status]\n\nFollow-up TODOs:\n- [Any deferred items] (or \"None\")\n\nPrevious reports:\n- X.Y.Z (YYYY-MM-DD): [One-line summary of that version's changes]\n- W.X.Y (YYYY-MM-DD): [One-line summary]\n- ...\n-->\n```\n\n**Version History Best Practice**: Maintain a rolling log of previous versions in the SYNC IMPACT REPORT. This provides:\n- Quick reference for what changed when\n- Context for understanding current state\n- Audit trail for compliance reviews\n\nExample from mature constitution:\n```html\n<!--\nPrevious reports:\n  - 3.1.0 (YYYY-MM-DD): Added CLAUDE.md synchronization mandate\n  - 3.0.0 (YYYY-MM-DD): Adopted hexagonal architecture, added strategic abstraction principle\n  - 2.1.0 (YYYY-MM-DD): Added unification trigger to API consistency principle\n  - 2.0.0 (YYYY-MM-DD): Added API consistency principle\n  - 1.8.0 (YYYY-MM-DD): Added exception registry and process\n-->\n```\n\nSee [SYNC-IMPACT-FORMAT.md](SYNC-IMPACT-FORMAT.md) for complete format.\n\n### 2. Core Principles\n\nNumbered principles (I, II, III...) with Enforcement/Testability/Rationale.\n\n**Naming Conventions**:\n- Use Roman numerals (I, II, III, IV, V...)\n- Name captures the constraint domain\n- Mark non-negotiable principles explicitly: `(NON-NEGOTIABLE)`\n\n**Common Principle Categories**:\n\n| Category | Examples |\n|----------|----------|\n| **Development Process** | Test-First, Code Review, Documentation |\n| **Code Quality** | Linting, Complexity Limits, Coverage |\n| **Architecture** | Layer Rules, Dependency Flow, Module Boundaries |\n| **Security** | Auth, Secrets, Input Validation |\n| **Operations** | Observability, Error Handling, Performance |\n| **Governance** | Versioning, Dependencies, Exceptions |\n\n### 3. Technology Stack\n\nDocument mandated technology choices with rationale:\n\n```markdown\n## Technology Stack\n\n| Category | Choice | Rationale |\n|----------|--------|-----------|\n| Language | Python 3.12 | Type hints, performance, ecosystem |\n| Framework | FastAPI | Async-first, Pydantic integration |\n| Testing | pytest | Fixtures, parametrization, plugins |\n| Linting | ruff | Fast, replaces multiple tools |\n```\n\n### 4. Quality Gates\n\nDefine automated checks that block merge:\n\n```markdown\n## Quality Gates\n\n| Gate | Requirement | Measurement | Enforcement |\n|------|-------------|-------------|-------------|\n| Static Analysis | Zero errors | `ruff check .` | CI automated |\n| Type Checking | Zero errors | `pyright` | CI automated |\n| Test Suite | All pass | `pytest` | CI automated |\n| Coverage | ≥80% | `pytest --cov-fail-under=80` | CI automated |\n| Security | No vulnerabilities | `pip-audit` | CI automated |\n```\n\n### 5. Governance\n\nDefine how the constitution itself evolves:\n\n```markdown\n## Governance\n\n### Amendment Process\n1. Propose change via PR to constitution file\n2. Document rationale for change\n3. Review impact on existing code\n4. Obtain team consensus\n5. Update version per semantic versioning\n\n### Version Policy\n- **MAJOR**: Principle removal or incompatible redefinition\n- **MINOR**: New principle or significant expansion\n- **PATCH**: Clarification or wording improvement\n\n### Exception Registry\nApproved exceptions MUST be recorded in `docs/constitution-exceptions.md` with:\n- Exception ID, Principle, Scope, Justification\n- Approved By, Date, Expiry, Tracking Issue\n\n**Version**: X.Y.Z | **Ratified**: YYYY-MM-DD | **Last Amended**: YYYY-MM-DD\n```\n\n### 6. CLAUDE.md Sync Mandate\n\nDefine synchronization requirements. This is critical because AI coding assistants read CLAUDE.md as their primary instruction source.\n\n```markdown\n## CLAUDE.md Synchronization\n\nThe `CLAUDE.md` file at repository root MUST remain synchronized with this constitution.\nIt serves as the primary agent instruction file and MUST contain all information\nnecessary for AI coding assistants to operate correctly.\n\n**Mandatory Sync Artifacts**:\n\n| Constitution Section | CLAUDE.md Section | Sync Rule |\n|---------------------|-------------------|-----------|\n| Core Principles (I-X) | Principles Summary | MUST list all principles with enforcement keywords |\n| Layer Import Rules | Architecture section | MUST replicate layer rules table |\n| Technology Stack | Technical Stack | MUST match exactly |\n| Quality Gates | Quality Gates | MUST match exactly |\n| Development Workflow | Development Workflow | MUST match branch/review rules |\n| Project Management | Project Management | MUST include tool conventions |\n\n**Synchronization Process**:\n\nWhen amending this constitution:\n\n1. Update constitution version and content\n2. Update CLAUDE.md to reflect all changes in the Mandatory Sync Artifacts table\n3. Verify CLAUDE.md version matches constitution version\n4. Include both files in the same commit\n5. PR description MUST note \"Constitution sync: CLAUDE.md updated\"\n\n**Enforcement**:\n\n- Code review MUST verify CLAUDE.md is updated when constitution changes\n- CLAUDE.md MUST display the same version number as the constitution\n- Sync drift between files is a blocking issue for PRs that modify either file\n\n**Rationale**: If CLAUDE.md diverges from the constitution, agents will operate with\noutdated or incorrect guidance, undermining the governance this constitution establishes.\n```\n\nSee [syncing-claude-md skill](../syncing-claude-md/SKILL.md) for implementation.\n\n---\n\n## Related Skills\n\n- **For brownfield projects**: Use [brownfield-constitution](../brownfield-constitution/SKILL.md) which extends this skill with Essential Floor + Emergent Ceiling approach\n- **For validation**: Use [validation-constitution](../validation-constitution/SKILL.md) after authoring to verify quality"
              },
              {
                "name": "authoring-requirements",
                "description": "Write functional requirements using FR-XXX format with RFC 2119 keywords (MUST, SHOULD, MAY), success criteria (SC-XXX), and edge case identification. Use when writing requirements, specifications, success criteria, or when you see \"functional requirements\", \"FR-\", \"SC-\", \"RFC 2119\", \"MUST SHOULD MAY\", or \"edge cases\".",
                "path": "plugins/humaninloop/skills/authoring-requirements/SKILL.md",
                "frontmatter": {
                  "name": "authoring-requirements",
                  "description": "Write functional requirements using FR-XXX format with RFC 2119 keywords (MUST, SHOULD, MAY), success criteria (SC-XXX), and edge case identification. Use when writing requirements, specifications, success criteria, or when you see \"functional requirements\", \"FR-\", \"SC-\", \"RFC 2119\", \"MUST SHOULD MAY\", or \"edge cases\"."
                },
                "content": "# Authoring Requirements\n\n## Purpose\n\nWrite technology-agnostic functional requirements, identify edge cases, and define measurable success criteria. Focus on WHAT the system does and WHY, never HOW it's implemented.\n\n## Functional Requirements Format\n\nWrite requirements using the FR-XXX format with RFC 2119 keywords:\n\n```markdown\n## Functional Requirements\n\n- **FR-001**: System MUST [specific capability]\n- **FR-002**: Users MUST be able to [specific action]\n- **FR-003**: System SHOULD [recommended behavior]\n- **FR-004**: System MAY [optional capability]\n```\n\n### RFC 2119 Keywords\n\n| Keyword | Meaning |\n|---------|---------|\n| **MUST** | Absolute requirement; no exceptions |\n| **SHOULD** | Recommended; valid exceptions may exist |\n| **MAY** | Optional; implementation choice |\n\nSee [RFC-2119-KEYWORDS.md](RFC-2119-KEYWORDS.md) for detailed usage guidance.\n\n### FR Numbering Rules\n\n1. Sequential numbering: FR-001, FR-002, FR-003...\n2. No gaps in sequence\n3. Three-digit padding (001, not 1)\n4. Group related requirements together\n\n### Writing Technology-Agnostic Requirements\n\n**Good (what):**\n- \"System MUST notify users when their subscription expires\"\n- \"Users MUST be able to export their data in a portable format\"\n\n**Bad (how):**\n- \"System MUST send email via SendGrid when subscription expires\"\n- \"Users MUST be able to download a JSON export from the /api/export endpoint\"\n\n## Edge Cases\n\nIdentify 3-5 boundary conditions that need explicit handling:\n\n```markdown\n## Edge Cases\n\n1. **System limits**: What happens at maximum capacity?\n2. **Invalid input**: How are malformed requests handled?\n3. **External failures**: What if dependencies are unavailable?\n4. **Concurrent access**: How are race conditions prevented?\n5. **Permission boundaries**: What happens with unauthorized access?\n```\n\n### Edge Case Categories\n\n| Category | Examples |\n|----------|----------|\n| **System limits** | Max items, file size limits, rate limits |\n| **Invalid input** | Empty fields, wrong types, boundary values |\n| **External failures** | Network timeouts, service unavailable |\n| **Concurrency** | Simultaneous edits, duplicate submissions |\n| **Permissions** | Unauthorized access, expired tokens |\n\nSee [EDGE-CASES.md](EDGE-CASES.md) for detailed patterns.\n\n## Success Criteria Format\n\nDefine 3-5 measurable outcomes using SC-XXX format:\n\n```markdown\n## Success Criteria\n\n- **SC-001**: Users complete the task creation flow in under 2 minutes\n- **SC-002**: 95% of users successfully create their first recurring task\n- **SC-003**: Support tickets related to task scheduling decrease by 50%\n```\n\n### Success Criteria Rules\n\n1. **Technology-agnostic**: No API metrics, database stats, or code coverage\n2. **User/business focused**: Observable by stakeholders\n3. **Measurable**: Quantifiable where possible\n4. **Outcome-oriented**: What changes, not what's built\n\n**Good:**\n- \"Users complete the workflow in under 2 minutes\"\n- \"Error rate for task creation drops below 5%\"\n- \"User satisfaction score increases to 4.5/5\"\n\n**Bad:**\n- \"API responds in under 200ms\"\n- \"Database queries execute in under 50ms\"\n- \"Code coverage exceeds 80%\"\n\n## Key Entities (Optional)\n\nWhen the feature involves data, describe entities conceptually:\n\n```markdown\n## Key Entities\n\n### RecurringPattern\nRepresents the schedule for a repeating task.\n\n**Attributes:**\n- Frequency (how often: daily, weekly, monthly)\n- Interval (every N occurrences)\n- End condition (never, after N times, on date)\n\n**Relationships:**\n- Belongs to one Task\n- Generates many TaskInstances\n```\n\n### Entity Description Rules\n\n- Describe purpose, not schema\n- List attributes as concepts, not columns\n- Focus on relationships, not foreign keys\n- No data types, constraints, or indexes\n\n## Validation Script\n\nValidate requirement format with the included script:\n\n```bash\npython scripts/validate-requirements.py path/to/spec.md\n```\n\nThe script checks:\n- FR-XXX format and sequential numbering\n- RFC 2119 keywords present\n- SC-XXX format and sequential numbering\n- Technology-agnostic language\n\n## Quality Checklist\n\nBefore finalizing, verify:\n\n- [ ] All FRs use RFC 2119 keywords (MUST/SHOULD/MAY)\n- [ ] FR numbers are sequential with no gaps\n- [ ] No technology or implementation details mentioned\n- [ ] 3-5 edge cases identified\n- [ ] All SCs are measurable outcomes\n- [ ] SCs focus on user/business value\n- [ ] Entities described conceptually (if applicable)\n\n## Anti-Patterns to Avoid\n\n- **Technology leakage**: \"System MUST use PostgreSQL for storage\"\n- **Implementation details**: \"MUST implement using the Observer pattern\"\n- **Unmeasurable criteria**: \"System MUST be fast\" or \"MUST be user-friendly\"\n- **Missing keywords**: \"System will notify users\" (use MUST/SHOULD/MAY)\n- **Technical metrics**: \"API latency MUST be under 100ms\""
              },
              {
                "name": "authoring-roadmap",
                "description": "Create evolution roadmaps with prioritized gap cards for brownfield projects. Use when generating gap analysis, identifying improvement priorities, or when you see \"roadmap\", \"gap analysis\", \"evolution plan\", \"improvement priorities\", or \"brownfield gaps\".",
                "path": "plugins/humaninloop/skills/authoring-roadmap/SKILL.md",
                "frontmatter": {
                  "name": "authoring-roadmap",
                  "description": "Create evolution roadmaps with prioritized gap cards for brownfield projects. Use when generating gap analysis, identifying improvement priorities, or when you see \"roadmap\", \"gap analysis\", \"evolution plan\", \"improvement priorities\", or \"brownfield gaps\"."
                },
                "content": "# Authoring Evolution Roadmap\n\n## Purpose\n\nCreate evolution roadmaps that identify gaps between current codebase state and constitution requirements. Produces prioritized gap cards with dependencies, enabling incremental improvement without overwhelming teams.\n\n## When to Use\n\n- After brownfield codebase analysis is complete\n- After constitution is created for a brownfield project\n- When identifying what needs to change to meet constitution requirements\n- When planning incremental codebase improvements\n\n## Input Requirements\n\nTo create an evolution roadmap, you need:\n\n1. **Codebase Analysis** (`.humaninloop/memory/codebase-analysis.md`)\n   - Essential Floor Status table\n   - Inventory of existing patterns\n   - Identified inconsistencies\n\n2. **Constitution** (`.humaninloop/memory/constitution.md`)\n   - Principles with requirements\n   - Quality gates with thresholds\n   - Technology stack requirements\n\n## Gap Identification Process\n\n### Step 1: Essential Floor Gaps\n\nFor each Essential Floor category, check status from codebase analysis:\n\n| Status | Action |\n|--------|--------|\n| `present` | No gap needed |\n| `partial` | Create gap for missing aspects |\n| `absent` | Create gap for full implementation |\n\n**Example:**\n```\nCodebase Analysis shows:\n- Security: partial (has auth, missing input validation)\n- Testing: partial (has tests, coverage at 45%)\n- Error Handling: present\n- Observability: absent\n\nGaps to create:\n- GAP-001: Implement input validation (Security)\n- GAP-002: Increase test coverage to 80% (Testing)\n- GAP-003: Implement structured logging (Observability)\n- GAP-004: Add correlation IDs (Observability)\n```\n\n### Step 2: Constitution Compliance Gaps\n\nFor each constitution principle, check if codebase complies:\n\n1. Read principle requirements (MUST, SHOULD statements)\n2. Compare against codebase analysis findings\n3. Create gap if requirement not met\n\n**Example:**\n```\nConstitution Principle: \"API responses MUST include correlation IDs\"\nCodebase Analysis: \"Correlation IDs: absent\"\n→ Create GAP-005: Add correlation IDs to API responses\n```\n\n### Step 3: Prioritize Gaps\n\nAssign priority based on:\n\n| Priority | Criteria | Examples |\n|----------|----------|----------|\n| **P1** | Security issues, blocking problems, MUST violations | Auth gaps, data exposure risks |\n| **P2** | Testing/error handling, SHOULD violations | Coverage gaps, missing error handling |\n| **P3** | Observability, MAY items, nice-to-haves | Logging improvements, metrics |\n\n### Step 4: Identify Dependencies\n\nDetermine which gaps block or enable others:\n\n- **Blocks**: What this gap prevents if not addressed\n- **Enables**: What fixing this gap unlocks\n- **Depends On**: Other gaps that must be addressed first\n\n## Gap Card Format\n\nEach gap uses the hybrid format (structured header + prose body):\n\n```markdown\n### GAP-XXX: [Title]\n\n| Aspect | Value |\n|--------|-------|\n| Priority | P1/P2/P3 |\n| Category | Security/Testing/ErrorHandling/Observability/Other |\n| Blocks | [What this prevents] |\n| Enables | [What fixing unlocks] |\n| Depends On | GAP-YYY, GAP-ZZZ (or \"None\") |\n| Effort | Small/Medium/Large |\n\n**Current state**: [Factual description from codebase-analysis.md]\n\n**Target state**: [What constitution requires]\n\n**Suggested approach**: [Actionable guidance for addressing]\n\n**Related files**:\n- `path/to/relevant/file.ts`\n- `path/to/another/file.py`\n```\n\n## Roadmap Structure\n\n```markdown\n# Evolution Roadmap\n\n> Generated: [ISO timestamp]\n> Based on: codebase-analysis.md, constitution.md\n> Status: active\n\n---\n\n## Overview\n\n[1-2 sentence summary of gap analysis findings]\n\n**Total Gaps**: N\n- P1 (Critical): X\n- P2 (Important): Y\n- P3 (Nice-to-have): Z\n\n---\n\n## Gap Summary\n\n| ID | Title | Priority | Category | Depends On | Effort |\n|----|-------|----------|----------|------------|--------|\n| GAP-001 | [title] | P1 | Security | None | Medium |\n| GAP-002 | [title] | P2 | Testing | GAP-001 | Large |\n| ... | ... | ... | ... | ... | ... |\n\n---\n\n## Dependency Graph\n\n```\n[Foundation]\n    └── GAP-001: [title]\n         └── GAP-002: [title]\n              └── GAP-005: [title]\n\n[Parallel Track]\n    └── GAP-003: [title]\n         └── GAP-004: [title]\n```\n\n---\n\n## Gap Cards\n\n[Individual gap cards in priority order]\n\n---\n\n## Maintenance Protocol\n\n[Standard maintenance instructions]\n```\n\n## Priority Definitions\n\n| Priority | Trigger | Timeline Guidance |\n|----------|---------|-------------------|\n| **P1** | Security gaps, constitution MUST violations, blocking issues | Address before new feature work |\n| **P2** | Testing gaps, error handling gaps, SHOULD violations | Address in next iteration |\n| **P3** | Observability gaps, MAY items, improvements | Address when convenient |\n\n## Effort Estimates\n\n| Effort | Scope | Examples |\n|--------|-------|----------|\n| **Small** | Single file, isolated change | Add validation to one endpoint |\n| **Medium** | Multiple files, moderate scope | Implement logging across service |\n| **Large** | Architectural change, significant scope | Restructure error handling |\n\n## Dependency Graph Rules\n\n1. **Security gaps come first** - They often block other improvements\n2. **Foundation before features** - Infrastructure gaps enable feature gaps\n3. **Minimize chains** - Long dependency chains increase risk\n4. **Identify parallel tracks** - Gaps that can be addressed independently\n\n## Quality Checklist\n\nBefore finalizing roadmap:\n\n- [ ] Every Essential Floor gap identified (partial/absent → gap)\n- [ ] Every constitution MUST violation has a gap\n- [ ] All gaps have Priority assigned (P1/P2/P3)\n- [ ] All gaps have Category assigned\n- [ ] All gaps have Effort estimate\n- [ ] Dependencies identified and documented\n- [ ] Dependency graph shows clear execution order\n- [ ] No circular dependencies\n- [ ] Current state references codebase-analysis.md\n- [ ] Target state references constitution requirements\n\n## Anti-Patterns\n\n| Anti-Pattern | Problem | Fix |\n|--------------|---------|-----|\n| **Gap overload** | 50+ gaps overwhelms team | Focus on P1/P2, defer P3 |\n| **Vague gaps** | \"Improve testing\" | Specific: \"Increase coverage from 45% to 80%\" |\n| **Missing dependencies** | Gaps in wrong order | Trace what blocks what |\n| **No effort estimates** | Can't prioritize work | Add Small/Medium/Large |\n| **Stale roadmap** | Gaps addressed but not updated | Note \"Addressed: GAP-XXX\" in commits |\n\n## Integration with Later Phases\n\nWhen agents in `/plan`, `/tasks`, `/implement` address roadmap gaps:\n\n1. **Note in commits**: Include \"Addressed: GAP-XXX\"\n2. **Suggest new gaps**: If discovering issues not in roadmap, note \"Suggested gap: [description]\"\n3. **Supervisor decides**: Human reviews and approves roadmap updates\n\nAgents should read `.humaninloop/memory/evolution-roadmap.md` to:\n- Understand existing improvement priorities\n- Avoid creating work that conflicts with roadmap\n- Note when their work addresses a gap"
              },
              {
                "name": "authoring-user-stories",
                "description": "Write user stories with P1/P2/P3 priorities, Given/When/Then acceptance scenarios, and independent tests. Use when writing user stories, feature specifications, acceptance criteria, or when you see \"user story\", \"acceptance scenario\", \"Given When Then\", \"priority\", \"P1\", \"P2\", or \"P3\".",
                "path": "plugins/humaninloop/skills/authoring-user-stories/SKILL.md",
                "frontmatter": {
                  "name": "authoring-user-stories",
                  "description": "Write user stories with P1/P2/P3 priorities, Given/When/Then acceptance scenarios, and independent tests. Use when writing user stories, feature specifications, acceptance criteria, or when you see \"user story\", \"acceptance scenario\", \"Given When Then\", \"priority\", \"P1\", \"P2\", or \"P3\"."
                },
                "content": "# Authoring User Stories\n\n## Purpose\n\nTransform feature descriptions into testable user stories with clear business value, prioritized by impact. Each story should be independently testable with measurable acceptance criteria.\n\n## User Story Format\n\nGenerate 2-5 user stories per feature using this exact structure:\n\n```markdown\n### User Story N - [Brief Title] (Priority: P#)\n\n[Describe this user journey in plain language]\n\n**Why this priority**: [Explain the value and priority level]\n\n**Independent Test**: [How this can be tested standalone]\n\n**Acceptance Scenarios**:\n1. **Given** [state], **When** [action], **Then** [outcome]\n2. **Given** [state], **When** [action], **Then** [outcome]\n```\n\n## Priority Definitions\n\n| Priority | Meaning | Criteria |\n|----------|---------|----------|\n| **P1** | Core functionality | MVP requirement, blocks other features, must ship |\n| **P2** | Important | Complete experience but can ship without initially |\n| **P3** | Nice to have | Enhances experience, future consideration |\n\nSee [PRIORITY-DEFINITIONS.md](PRIORITY-DEFINITIONS.md) for detailed guidance on priority assignment.\n\n## Acceptance Scenario Guidelines\n\nEach scenario follows the Given/When/Then pattern:\n\n- **Given**: The initial state or precondition (context)\n- **When**: The action the user takes (trigger)\n- **Then**: The expected outcome (result)\n\n**Rules:**\n1. Each story needs 2-4 acceptance scenarios\n2. Cover both happy path and key edge cases\n3. Scenarios must be independently verifiable\n4. Use concrete, observable outcomes (not implementation details)\n\n**Good example:**\n```\n**Given** a user has an active subscription,\n**When** they click \"Cancel Subscription\",\n**Then** they see a confirmation dialog with the cancellation date\n```\n\n**Bad example:**\n```\n**Given** the database has the user record,\n**When** the API receives a DELETE request,\n**Then** the subscription_status column is set to \"cancelled\"\n```\n\n## Independent Test Requirement\n\nEach user story must include an **Independent Test** description that explains:\n- How QA can verify this story in isolation\n- What data or setup is required\n- What constitutes passing/failing\n\nThis enables parallel testing and clear verification.\n\n## Quality Checklist\n\nBefore finalizing, verify each user story:\n\n- [ ] Has a clear, descriptive title\n- [ ] Priority is assigned with justification\n- [ ] User journey is described in plain language\n- [ ] Independent test is specified\n- [ ] 2-4 acceptance scenarios using Given/When/Then\n- [ ] No implementation details or technology references\n- [ ] Outcomes are observable and measurable\n\n## Validation Script\n\nValidate user story format with the included script:\n\n```bash\npython scripts/validate-user-stories.py path/to/spec.md\n```\n\nThe script checks:\n- Priority markers (P1, P2, P3)\n- Given/When/Then syntax completeness\n- Independent test presence\n- Priority justification\n- Header format\n\nSee [EXAMPLES.md](EXAMPLES.md) for complete user story examples.\n\n## Anti-Patterns to Avoid\n\n- **Technical stories**: \"As a developer, I want to refactor the auth module\"\n- **Missing priority justification**: Just saying \"P1\" without explaining why\n- **Implementation in acceptance**: \"Then the React component re-renders\"\n- **Vague outcomes**: \"Then the user is happy\" or \"Then it works correctly\"\n- **Compound stories**: One story covering multiple distinct features\n- **Non-testable criteria**: \"Then the system is performant\""
              },
              {
                "name": "brownfield-constitution",
                "description": "Write constitutions for existing codebases using Essential Floor + Emergent Ceiling approach. Use when creating constitutions for brownfield projects, codifying existing patterns, or when you see \"brownfield\", \"existing codebase\", \"essential floor\", \"emergent ceiling\", or \"evolution roadmap\". Extends authoring-constitution skill.",
                "path": "plugins/humaninloop/skills/brownfield-constitution/SKILL.md",
                "frontmatter": {
                  "name": "brownfield-constitution",
                  "description": "Write constitutions for existing codebases using Essential Floor + Emergent Ceiling approach. Use when creating constitutions for brownfield projects, codifying existing patterns, or when you see \"brownfield\", \"existing codebase\", \"essential floor\", \"emergent ceiling\", or \"evolution roadmap\". Extends authoring-constitution skill."
                },
                "content": "# Brownfield Constitution Authoring\n\n## Prerequisites\n\nThis skill extends the [authoring-constitution](../authoring-constitution/SKILL.md) skill. Before using brownfield mode:\n\n1. **Understand core principles**: Read `authoring-constitution` for the Three-Part Principle Rule (Enforcement, Testability, Rationale)\n2. **Know RFC 2119 keywords**: See [authoring-constitution/RFC-2119-KEYWORDS.md](../authoring-constitution/RFC-2119-KEYWORDS.md)\n3. **Understand SYNC IMPACT format**: See [authoring-constitution/SYNC-IMPACT-FORMAT.md](../authoring-constitution/SYNC-IMPACT-FORMAT.md)\n\nBrownfield constitutions follow all rules from `authoring-constitution`, plus additional guidance for existing codebases.\n\n## Purpose\n\nWrite project constitutions for **existing codebases** using the **Essential Floor + Emergent Ceiling** approach.\n\n- **Essential Floor**: Four NON-NEGOTIABLE categories every constitution MUST address\n- **Emergent Ceiling**: Good patterns from the codebase worth codifying\n\n## Essential Floor (NON-NEGOTIABLE)\n\nEvery constitution MUST include principles for these four categories, regardless of codebase state:\n\n| Category | Minimum Requirements | Default Enforcement |\n|----------|---------------------|---------------------|\n| **Security** | Auth at boundaries, secrets via env/secret managers, input validation, secret scanning in CI | Integration tests, code review, secret scanning tools |\n| **Testing** | Automated tests exist, coverage ≥80% (configurable), ratchet rule (coverage MUST NOT decrease) | CI test gate, coverage threshold with warning/blocking levels |\n| **Error Handling** | Explicit handling, RFC 7807 Problem Details format, correlation IDs in responses | Schema validation in tests, code review |\n| **Observability** | Structured logging, correlation IDs, APM integration, no PII in logs | Config verification, log audit, APM dashboards |\n\nSee [ESSENTIAL-FLOOR.md](ESSENTIAL-FLOOR.md) for detailed requirements and example principles for each category.\n\n**Writing Essential Floor Principles:**\n\n- If codebase **has** the capability → Principle codifies existing pattern with enforcement\n- If codebase **lacks** the capability → Principle states \"MUST implement\" with roadmap gap\n\n## Emergent Ceiling (FROM CODEBASE)\n\nBeyond the essential floor, identify **existing good patterns** worth codifying:\n\n1. **Read codebase analysis** - Look for \"Strengths to Preserve\" section\n2. **Identify patterns** - Naming conventions, architecture patterns, error formats\n3. **Codify as principles** - With enforcement mechanisms\n\nSee [EMERGENT-CEILING-PATTERNS.md](EMERGENT-CEILING-PATTERNS.md) for the pattern library with examples.\n\n**Common Pattern Categories:**\n\n| Pattern Category | What to Look For |\n|------------------|------------------|\n| **Code Quality** | Documentation requirements, API annotations, deprecation handling |\n| **Architecture** | Layer rules, dependency injection, module boundaries |\n| **API Design** | Response formats, versioning, pagination |\n| **Authorization** | Role-based access, permission checks |\n| **Resilience** | Retry policies, circuit breakers, timeouts |\n| **Configuration** | Strongly-typed options, feature flags |\n| **Error Handling** | Error display guidelines, data resilience |\n| **Observability** | Log levels, context requirements, crash reporting |\n| **Product Analytics** | Event categories, naming conventions, funnel tracking |\n| **Naming Conventions** | File/class/variable naming, directory structure |\n\n## Brownfield Constitution Structure\n\n```markdown\n# [Project] Constitution\n\n<!-- SYNC IMPACT REPORT -->\n\n## Core Principles\n\n### Essential Floor Principles\nI. Security by Default\nII. Testing Discipline\nIII. Error Handling Standards\nIV. Observability Requirements\n\n### Emergent Ceiling Principles\nV. [Pattern from codebase]\nVI. [Pattern from codebase]\n...\n\n## Technology Stack\n[From codebase analysis]\n\n## Quality Gates\n[From codebase analysis + essential floor requirements]\n\n## Governance\n[Standard governance section]\n\n## Evolution Notes\n\nThis constitution was created from brownfield analysis.\n\n**Essential Floor Status** (from codebase-analysis.md):\n| Category | Status | Gap |\n|----------|--------|-----|\n| Security | partial | GAP-001 |\n| Testing | partial | GAP-002 |\n| Error Handling | present | - |\n| Observability | absent | GAP-003 |\n\nSee `.humaninloop/memory/evolution-roadmap.md` for improvement plan.\n```\n\n## Brownfield Quality Checklist\n\nAdditional checks for brownfield constitutions (beyond standard checklist):\n\n- [ ] All four essential floor categories have principles\n- [ ] Existing good patterns identified and codified\n- [ ] Gap references included where codebase lacks capability\n- [ ] Technology stack matches codebase analysis\n- [ ] Quality gates reflect current + target state\n- [ ] Evolution Notes section documents brownfield context\n\nAfter completing brownfield constitution, run validation using [validation-constitution](../validation-constitution/SKILL.md) skill.\n\n## Related Skills\n\n- [authoring-constitution](../authoring-constitution/SKILL.md) - Core authoring (prerequisite)\n- [validation-constitution](../validation-constitution/SKILL.md) - Quality validation (use after authoring)\n- [analysis-codebase](../analysis-codebase/SKILL.md) - Analyze existing codebase before writing"
              },
              {
                "name": "patterns-api-contracts",
                "description": "RESTful API design following best practices with endpoint mapping, schema definition, and error handling. Use when mapping endpoints, defining schemas, or when you see \"API\", \"endpoint\", \"REST\", \"OpenAPI\", \"schema\", \"contract\", or \"HTTP\".",
                "path": "plugins/humaninloop/skills/patterns-api-contracts/SKILL.md",
                "frontmatter": {
                  "name": "patterns-api-contracts",
                  "description": "RESTful API design following best practices with endpoint mapping, schema definition, and error handling. Use when mapping endpoints, defining schemas, or when you see \"API\", \"endpoint\", \"REST\", \"OpenAPI\", \"schema\", \"contract\", or \"HTTP\"."
                },
                "content": "# Designing API Contracts\n\n## Purpose\n\nDesign RESTful API contracts that map user actions to endpoints with complete schema definitions and comprehensive error handling. This skill covers endpoint design, request/response schemas, and OpenAPI specification.\n\n## Endpoint Mapping\n\n### User Action to Endpoint Mapping\n\n| User Action | HTTP Method | Endpoint Pattern |\n|-------------|-------------|------------------|\n| Create resource | POST | `/resources` |\n| List resources | GET | `/resources` |\n| Get single resource | GET | `/resources/{id}` |\n| Update resource | PUT/PATCH | `/resources/{id}` |\n| Delete resource | DELETE | `/resources/{id}` |\n| Perform action | POST | `/resources/{id}/{action}` |\n| Get nested resource | GET | `/resources/{id}/children` |\n\n### Method Selection\n\n| Scenario | Method | Idempotent? |\n|----------|--------|-------------|\n| Create new resource | POST | No |\n| Full replacement | PUT | Yes |\n| Partial update | PATCH | No |\n| Read resource | GET | Yes |\n| Remove resource | DELETE | Yes |\n| Trigger action | POST | Usually No |\n\n### Resource Naming Conventions\n\n- Use plural nouns: `/users`, not `/user`\n- Use kebab-case for multi-word: `/user-profiles`\n- Use path params for IDs: `/users/{userId}`\n- Use query params for filtering: `/users?role=admin`\n- Use nested paths for relationships: `/users/{userId}/tasks`\n\n## Endpoint Documentation Format\n\nDocument each endpoint with description, source requirements, request/response schemas, and error cases:\n\n```markdown\n## POST /api/auth/login\n\n**Description**: Authenticate user with email and password\n\n**Source Requirements**: FR-001, US#1\n\n### Request\n{JSON request body example}\n\n### Response (200 OK)\n{JSON response body example}\n\n### Error Responses\n| Status | Code | Description |\n|--------|------|-------------|\n| 400 | INVALID_INPUT | Missing or malformed fields |\n| 401 | INVALID_CREDENTIALS | Wrong email or password |\n```\n\n## Schema Definition\n\n### Request Schema Format\n\n```yaml\nLoginRequest:\n  type: object\n  required:\n    - email\n    - password\n  properties:\n    email:\n      type: string\n      format: email\n      description: User's email address\n    password:\n      type: string\n      minLength: 8\n      description: User's password\n```\n\n### Type Mapping from Data Model\n\n| Data Model Type | OpenAPI Type | Format |\n|-----------------|--------------|--------|\n| UUID | string | uuid |\n| Text | string | - |\n| Email | string | email |\n| URL | string | uri |\n| Integer | integer | int32/int64 |\n| Decimal | number | float/double |\n| Boolean | boolean | - |\n| Timestamp | string | date-time |\n| Date | string | date |\n| Enum[a,b,c] | string | enum: [a,b,c] |\n\n## Error Response Design\n\nUse standard error format with machine-readable codes and human-readable messages.\n\nSee [ERROR-PATTERNS.md](ERROR-PATTERNS.md) for complete HTTP status codes, error code conventions, and response formats.\n\n### Quick Reference\n\n| Status | When to Use |\n|--------|-------------|\n| 400 | Invalid input format |\n| 401 | Missing/invalid auth |\n| 403 | No permission |\n| 404 | Resource missing |\n| 409 | State conflict |\n| 422 | Business rule violation |\n| 429 | Rate limit exceeded |\n| 500 | Server error |\n\n## List Endpoints\n\nFor endpoints returning collections, implement pagination, filtering, and sorting.\n\nSee [PAGINATION-PATTERNS.md](PAGINATION-PATTERNS.md) for offset vs cursor pagination, filtering operators, and sorting patterns.\n\n### Quick Reference\n\n```\nGET /api/users?page=1&limit=20&role=admin&sort=-createdAt\n```\n\n## Brownfield Considerations\n\nWhen existing API patterns are detected, align new endpoints:\n\n| Aspect | Check For |\n|--------|-----------|\n| Base path | `/api/v1`, `/api`, etc. |\n| Auth pattern | Bearer, API key, session |\n| Error format | Existing error structure |\n| Pagination | page/limit, cursor, offset |\n\nHandle endpoint collisions:\n- REUSE existing endpoints when possible\n- RENAME to match existing patterns\n- NEW only when no existing endpoint fits\n\n## OpenAPI Structure\n\nSee [OPENAPI-TEMPLATE.yaml](OPENAPI-TEMPLATE.yaml) for a complete, copy-ready template with all sections.\n\n### Minimal Structure\n\n```yaml\nopenapi: 3.0.3\ninfo:\n  title: {Feature Name} API\n  version: 1.0.0\n\nservers:\n  - url: /api\n\npaths:\n  /resource:\n    get: ...\n    post: ...\n\ncomponents:\n  schemas: ...\n  securitySchemes:\n    bearerAuth:\n      type: http\n      scheme: bearer\n\nsecurity:\n  - bearerAuth: []\n```\n\n## Traceability\n\nTrack endpoint to requirement mapping:\n\n| Endpoint | Method | FR | US | Description |\n|----------|--------|-----|-----|-------------|\n| /auth/login | POST | FR-001 | US#1 | User login |\n| /users/me | GET | FR-004 | US#4 | Get current user |\n\n## Validation\n\nValidate OpenAPI specifications using the validation script:\n\n```bash\npython scripts/validate-openapi.py path/to/openapi.yaml\n```\n\nChecks: OpenAPI syntax, REST conventions, error responses, request bodies, operation IDs, security schemes, examples, and descriptions.\n\n## Quality Checklist\n\nBefore finalizing API contracts:\n\n- [ ] Every user action has an endpoint\n- [ ] All endpoints have request schema (if applicable)\n- [ ] All endpoints have success response schema\n- [ ] All endpoints have error responses defined\n- [ ] Naming follows REST conventions\n- [ ] Authentication requirements documented\n- [ ] Brownfield patterns matched (if applicable)\n- [ ] OpenAPI spec is valid\n- [ ] Traceability to requirements complete\n\n## Anti-Patterns\n\n| Avoid | Instead |\n|-------|---------|\n| Verb in URL (`/getUsers`) | Noun resource (`/users`) |\n| GET for actions | POST for actions (`POST /users/{id}/archive`) |\n| Missing error responses | Define all error cases |\n| Inconsistent naming | Pick one style (kebab-case recommended) |\n| Generic errors (just 400/500) | Specific error codes |\n| No examples | Include realistic examples |"
              },
              {
                "name": "patterns-entity-modeling",
                "description": "DDD-style entity modeling from requirements including extraction, attributes, relationships, and state machines. Use when extracting entities, defining attributes, modeling relationships, or when you see \"entity\", \"data model\", \"relationship\", \"cardinality\", \"domain model\", or \"state machine\".",
                "path": "plugins/humaninloop/skills/patterns-entity-modeling/SKILL.md",
                "frontmatter": {
                  "name": "patterns-entity-modeling",
                  "description": "DDD-style entity modeling from requirements including extraction, attributes, relationships, and state machines. Use when extracting entities, defining attributes, modeling relationships, or when you see \"entity\", \"data model\", \"relationship\", \"cardinality\", \"domain model\", or \"state machine\"."
                },
                "content": "# Modeling Domain Entities\n\n## Purpose\n\nExtract and model domain entities from requirements using Domain-Driven Design principles. This skill covers entity identification, attribute definition, relationship modeling, and state machine documentation.\n\n## Entity Extraction\n\n### Identification Heuristics\n\nLook for entities in:\n\n| Source | Pattern | Example |\n|--------|---------|---------|\n| **User stories** | \"As a [Role]...\" | User, Admin, Guest |\n| **Subjects** | \"The [Entity] must...\" | Task, Order, Product |\n| **Actions** | \"...create a [Entity]\" | Comment, Message, Report |\n| **Possessives** | \"[Entity]'s [attribute]\" | User's profile, Order's items |\n| **Status mentions** | \"[Entity] status\" | TaskStatus, OrderState |\n\n### Entity vs. Attribute Decision\n\n```\nIF concept has its own lifecycle → Entity\nIF concept only exists within another → Attribute\nIF concept connects two entities → Relationship (possibly join entity)\nIF concept has just one value → Attribute\n\nExamples:\n- \"user email\" → Attribute of User (just one value)\n- \"user address\" → Could be Entity (if reused) or Attribute (if embedded)\n- \"order items\" → Separate entity (has own lifecycle)\n- \"task status\" → Enum/attribute (limited values)\n```\n\n### Brownfield Entity Status\n\nWhen modeling in brownfield projects:\n\n| Status | Meaning | Action |\n|--------|---------|--------|\n| `[NEW]` | Entity doesn't exist | Create full definition |\n| `[EXTENDS EXISTING]` | Adding to existing entity | Document new fields only |\n| `[REUSES EXISTING]` | Using existing as-is | Reference only |\n| `[RENAMED]` | Avoiding collision | Document new name + reason |\n\n## Attribute Definition\n\n### Standard Attributes\n\nEvery entity typically needs:\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| id | Identifier | Yes | Primary key |\n| createdAt | Timestamp | Yes | Creation time |\n| updatedAt | Timestamp | Yes | Last modification |\n| deletedAt | Timestamp | No | Soft delete marker |\n\n### Attribute Format\n\n```markdown\n| Attribute | Type | Required | Default | Description |\n|-----------|------|----------|---------|-------------|\n| id | UUID | Yes | auto-generated | Unique identifier |\n| email | Email | Yes | - | User's email address |\n| name | Text(100) | No | null | Display name |\n| role | Enum[admin,member,guest] | Yes | member | Access level |\n| isVerified | Boolean | Yes | false | Email verified flag |\n```\n\n### Conceptual Types\n\nUse conceptual types (not database-specific):\n\n| Conceptual Type | Description |\n|-----------------|-------------|\n| `Identifier` / `UUID` | Unique identifier |\n| `Text` / `Text(N)` | String with optional max length |\n| `Email` | Email format string |\n| `URL` | URL format string |\n| `Integer` | Whole number |\n| `Decimal` / `Decimal(P,S)` | Decimal with precision |\n| `Boolean` | True/false |\n| `Timestamp` | Date and time |\n| `Date` | Date only |\n| `Enum[values]` | Fixed set of values |\n| `JSON` | Structured data |\n| `Reference(Entity)` | Foreign key reference |\n\n### PII Identification\n\nMark sensitive fields:\n\n```markdown\n| Attribute | Type | Required | PII | Description |\n|-----------|------|----------|-----|-------------|\n| email | Email | Yes | **PII** | User's email |\n| phone | Text(20) | No | **PII** | Phone number |\n| ssn | Text(11) | No | **PII-SENSITIVE** | Social security |\n```\n\n## Relationship Modeling\n\nRelationships connect entities with defined cardinality: One-to-One (1:1), One-to-Many (1:N), or Many-to-Many (N:M).\n\nSee [RELATIONSHIP-PATTERNS.md](RELATIONSHIP-PATTERNS.md) for detailed patterns, join entity examples, and documentation formats.\n\n### Relationship Diagram (Text)\n\n```markdown\n## Entity Relationships\n\n```\nUser ──1:N──▶ Task (owns)\nUser ──1:N──▶ Session (has)\nUser ◀──N:M──▶ Project (via ProjectMember)\nTask ──N:1──▶ Project (belongs to)\n```\n```\n\n## State Machine Modeling\n\nEntities with status fields need state transition documentation.\n\nSee [STATE-MACHINES.md](STATE-MACHINES.md) for patterns, diagram formats, and common workflows.\n\n### When to Model State\n\nModel state machines when:\n- Entity has a `status` or `state` field\n- Requirements mention workflow or lifecycle\n- Specific actions change entity state\n- Certain actions only valid in certain states\n\n## Validation Rules\n\nConstraints and validation rules ensure data integrity.\n\nSee [VALIDATION-RULES.md](VALIDATION-RULES.md) for constraint patterns, format validations, and business rule documentation.\n\n## data-model.md Structure\n\n```markdown\n# Data Model: {feature_id}\n\n> Entity definitions and relationships for the feature.\n> Generated by Domain Architect.\n\n---\n\n## Summary\n\n| Entity | Attributes | Relationships | Status |\n|--------|------------|---------------|--------|\n| User | 8 | 3 | [EXTENDS EXISTING] |\n| Session | 5 | 1 | [NEW] |\n| ...\n\n---\n\n## Entity: User [EXTENDS EXISTING]\n\n> Existing entity extended with authentication fields.\n\n### Attributes\n\n| Attribute | Type | Required | Default | Description |\n|-----------|------|----------|---------|-------------|\n| passwordHash | Text | Yes | - | Hashed password |\n| lastLoginAt | Timestamp | No | null | Last login time |\n\n### Existing Attributes (Not Modified)\n\n| Attribute | Type | Description |\n|-----------|------|-------------|\n| id | UUID | Existing primary key |\n| email | Email | Existing email field |\n\n---\n\n## Entity: Session [NEW]\n\n> User authentication session.\n\n### Attributes\n\n| Attribute | Type | Required | Default | Description |\n|-----------|------|----------|---------|-------------|\n| id | UUID | Yes | auto | Session identifier |\n| userId | Reference(User) | Yes | - | Owning user |\n| token | Text(255) | Yes | - | Session token |\n| expiresAt | Timestamp | Yes | - | Expiration time |\n| createdAt | Timestamp | Yes | auto | Creation time |\n\n### Relationships\n\n| Relationship | Type | Target | Description |\n|--------------|------|--------|-------------|\n| user | N:1 | User | Session belongs to user |\n\n---\n\n## Relationships\n\n[Relationship documentation]\n\n---\n\n## State Machines\n\n[State machine documentation if applicable]\n\n---\n\n## Traceability\n\n| Entity | Source Requirements |\n|--------|---------------------|\n| User | FR-001, FR-002, US#1 |\n| Session | FR-003, US#2 |\n```\n\n## Quality Checklist\n\nBefore finalizing entity model, verify:\n\n- [ ] Every noun from requirements evaluated for entity status\n- [ ] Each entity has id, createdAt, updatedAt fields\n- [ ] All attributes have type, required flag, description\n- [ ] Relationships include cardinality and direction\n- [ ] PII fields marked and documented\n- [ ] State machines documented for stateful entities\n- [ ] Brownfield status indicated for each entity\n- [ ] Traceability to requirements documented\n\n## Anti-Patterns to Avoid\n\n- **Missing entities**: Don't skip entities mentioned in requirements\n- **Anemic entities**: Entities with only ID are suspicious\n- **Implementation types**: Use conceptual types, not VARCHAR(255)\n- **Undefined relationships**: Every reference needs relationship docs\n- **Hidden state**: Status fields need state machine documentation\n- **Unmarked PII**: Always identify sensitive data\n- **Orphan entities**: Every entity needs at least one relationship"
              },
              {
                "name": "patterns-technical-decisions",
                "description": "Evaluate technology alternatives and document decisions in ADR format. Use when making technology choices, comparing options, documenting decisions, or when you see \"technology choice\", \"alternatives\", \"trade-offs\", \"decision record\", \"rationale\", \"why we chose\", or \"NEEDS CLARIFICATION\".",
                "path": "plugins/humaninloop/skills/patterns-technical-decisions/SKILL.md",
                "frontmatter": {
                  "name": "patterns-technical-decisions",
                  "description": "Evaluate technology alternatives and document decisions in ADR format. Use when making technology choices, comparing options, documenting decisions, or when you see \"technology choice\", \"alternatives\", \"trade-offs\", \"decision record\", \"rationale\", \"why we chose\", or \"NEEDS CLARIFICATION\"."
                },
                "content": "# Making Technical Decisions\n\n## Purpose\n\nProvide a complete framework for technology decisions: evaluate alternatives against consistent criteria, make informed choices, and document decisions so future maintainers understand WHY choices were made.\n\n## Decision Workflow\n\n```\n1. EVALUATE    →    2. DECIDE    →    3. DOCUMENT\n   Options           Best fit          For posterity\n```\n\n### Phase 1: Evaluate Options\n\nFor each decision point, consider 2-3 alternatives minimum.\n\n**Quick Criteria Reference:**\n\n| Criterion | Key Question |\n|-----------|--------------|\n| **Fit** | Does it solve the problem fully? |\n| **Complexity** | How hard to implement and maintain? |\n| **Team Familiarity** | Does the team know this tech? |\n| **Ecosystem** | Good docs, active community? |\n| **Scalability** | Will it grow with the project? |\n| **Security** | Good security posture? |\n| **Cost** | Total cost of ownership? |\n| **Brownfield Alignment** | Fits existing stack? |\n\nSee [EVALUATION-MATRIX.md](EVALUATION-MATRIX.md) for detailed criteria, scoring, and technology category comparisons.\n\n### Phase 2: Decide\n\nScore options against weighted criteria. Document:\n- Which option scores best\n- Why criteria were weighted as they were\n- What trade-offs are accepted\n\n**Quick Comparison Format:**\n\n| Option | Pros | Cons | Alignment | Verdict |\n|--------|------|------|-----------|---------|\n| Option A | + Fast, + Simple | - New dep | High | **Best** |\n| Option B | + Familiar | - Slow | Medium | Good |\n| Option C | + Feature-rich | - Complex | Low | Poor |\n\n### Phase 3: Document\n\nRecord decisions in ADR format for future maintainers.\n\n**Quick Decision Record:**\n\n```markdown\n## Decision: [Title]\n\n**Status**: Proposed | Accepted | Deprecated\n\n**Context**: [Why this decision is needed]\n\n**Decision**: [What we chose]\n\n**Rationale**: [Why - connect to criteria]\n\n**Trade-offs Accepted**: [What we gave up]\n```\n\nSee [DECISION-RECORD.md](DECISION-RECORD.md) for full ADR format, consequences, and dependency tracking.\n\n## research.md Output\n\nDecisions go in `research.md` with this structure:\n\n```markdown\n# Research: {feature_id}\n\n## Summary\n\n| ID | Decision | Choice | Rationale |\n|----|----------|--------|-----------|\n| D1 | Auth mechanism | JWT | Stateless, scalable |\n| D2 | Session storage | PostgreSQL | Existing stack |\n\n---\n\n## Decision 1: [Title]\n\n[Full decision record]\n\n---\n\n## Dependencies\n\n| Decision | Depends On | Impacts |\n|----------|------------|---------|\n| D2 | D1 | Session table schema |\n```\n\n## Brownfield Alignment\n\nAlways check existing stack first:\n\n| Scenario | Alignment | Action |\n|----------|-----------|--------|\n| Existing dep solves problem | High | Prefer reuse |\n| New dep, same ecosystem | Medium | Document justification |\n| New dep, different ecosystem | Low | Strong justification needed |\n| Conflicting with existing | None | Avoid or escalate |\n\n## Quality Checklist\n\nBefore finalizing:\n\n**Evaluation:**\n- [ ] At least 2-3 alternatives considered\n- [ ] Criteria weighted by project context\n- [ ] Each option has pros/cons\n- [ ] Brownfield alignment assessed\n\n**Documentation:**\n- [ ] Context explains WHY decision is needed\n- [ ] Rationale connects to specific criteria\n- [ ] Trade-offs explicitly documented\n- [ ] Constitution alignment checked\n- [ ] Dependencies between decisions mapped\n\n## Anti-Patterns\n\n| Anti-Pattern | Problem | Fix |\n|--------------|---------|-----|\n| Single option \"evaluation\" | No real choice | Always list alternatives |\n| Shiny object syndrome | New tech bias | Require strong justification |\n| Vague rationale | \"It's better\" | Connect to criteria |\n| Ignoring team skills | Hidden costs | Weight familiarity |\n| Missing consequences | Only positives | List negatives too |\n| Orphan decisions | No connections | Map dependencies |\n| Constitution blindness | Principle violations | Check alignment |"
              },
              {
                "name": "patterns-vertical-tdd",
                "description": "Structure implementation tasks using vertical slicing with TDD discipline. Use when creating task mappings, generating implementation tasks, or when you see \"vertical slice\", \"TDD\", \"test first\", \"cycle structure\", or \"testable increment\".",
                "path": "plugins/humaninloop/skills/patterns-vertical-tdd/SKILL.md",
                "frontmatter": {
                  "name": "patterns-vertical-tdd",
                  "description": "Structure implementation tasks using vertical slicing with TDD discipline. Use when creating task mappings, generating implementation tasks, or when you see \"vertical slice\", \"TDD\", \"test first\", \"cycle structure\", or \"testable increment\"."
                },
                "content": "# Vertical Slicing with TDD\n\n## Purpose\n\nTransform requirements into implementation tasks organized as vertical slices with strict TDD discipline. Each slice (called a \"cycle\") delivers observable, testable value and follows test-first principles.\n\n## Core Principles\n\n### 1. Vertical Over Horizontal\n\n**Wrong** (horizontal slicing):\n```\nPhase 1: All models\nPhase 2: All services\nPhase 3: All endpoints\nPhase 4: All tests\n```\n\n**Right** (vertical slicing):\n```\nCycle 1: User creation (model + service + endpoint + test)\nCycle 2: User authentication (model + service + endpoint + test)\nCycle 3: User profile management (model + service + endpoint + test)\n```\n\n### 2. Test-First at Task Level\n\nEvery cycle structures tasks so tests come before implementation:\n\n```\nCycle N: [Feature]\n├── Task N.1: Write failing test\n├── Task N.2: Implement to pass\n├── Task N.3: Refactor and verify\n└── Task N.4: Demo and validate\n```\n\n### 3. Foundation + Parallel\n\n```\nFoundation Cycles (sequential)\n├── C1: Core data model + basic CRUD\n├── C2: Authentication framework\n└── C3: API infrastructure\n\nFeature Cycles (parallel-eligible)\n├── C4: [P] Search functionality\n├── C5: [P] Filtering\n├── C6: [P] Export feature\n└── C7: Notifications (depends on C4)\n```\n\n### 4. Layered Testability\n\nEach cycle must be testable at multiple levels:\n- **Automated tests**: Unit, integration, and/or E2E tests\n- **Demonstrable behavior**: Observable by stakeholders\n- **Contract verification**: Meets acceptance criteria from spec\n\n## Identifying Vertical Slices\n\nSee [SLICE-IDENTIFICATION.md](SLICE-IDENTIFICATION.md) for detailed heuristics on identifying good vertical slices from requirements.\n\n### Quick Heuristics\n\nA good vertical slice:\n1. **Delivers user value**: Something a user could observe or use\n2. **Touches all layers**: Model, service, API, UI (as applicable)\n3. **Is independently testable**: Can verify it works without other slices\n4. **Is sized appropriately**: Completable in 1-3 implementation sessions\n\n### Slice Boundaries\n\n| Boundary Signal | Action |\n|-----------------|--------|\n| Distinct user action | New cycle |\n| Different acceptance scenario | May be new cycle or same cycle |\n| Shared infrastructure need | Foundation cycle |\n| Optional enhancement | Feature cycle (can parallelize) |\n\n## Cycle Structure\n\nSee [CYCLE-STRUCTURE.md](CYCLE-STRUCTURE.md) for detailed cycle formatting and examples.\n\n### Standard Cycle Format\n\n```markdown\n### Cycle N: [Vertical slice description]\n\n> Stories: US-X, US-Y\n> Dependencies: C1, C2 (or \"None\")\n> Type: Foundation | Feature [P]\n\n- [ ] **TN.1**: Write failing E2E test for [behavior] in tests/e2e/test_[name].py\n- [ ] **TN.2**: Implement [component] to pass test in src/[path]/[file].py\n- [ ] **TN.3**: Refactor and verify tests pass\n- [ ] **TN.4**: Demo [behavior], verify acceptance criteria\n\n**Checkpoint**: [What should be observable/testable after this cycle]\n```\n\n### Task Numbering\n\n- Cycle 1 tasks: T1.1, T1.2, T1.3, T1.4\n- Cycle 2 tasks: T2.1, T2.2, T2.3, T2.4\n- etc.\n\n### Markers\n\n| Marker | Meaning |\n|--------|---------|\n| `[P]` | Parallel-eligible (no dependencies blocking) |\n| `[US#]` | Maps to user story number |\n| `[EXTEND]` | Extends existing file (brownfield) |\n| `[MODIFY]` | Modifies existing code (brownfield) |\n\n## Foundation vs Feature Cycles\n\n### Foundation Cycles\n\n**Purpose**: Establish infrastructure that ALL features depend on.\n\n**Characteristics**:\n- Must complete before any feature cycle\n- Sequential (C1 before C2 before C3)\n- Typically includes: data models, auth, API framework, error handling\n\n**Identification**: Ask \"Could ANY user story start without this?\" If no, it's foundation.\n\n### Feature Cycles\n\n**Purpose**: Deliver user value incrementally.\n\n**Characteristics**:\n- Can start once foundation is complete\n- Often parallel-eligible\n- Map directly to user stories\n- Independently testable\n\n**Identification**: Ask \"Does this deliver value a user could observe?\" If yes, it's a feature.\n\n## TDD Task Sequence\n\nEach cycle follows the red-green-refactor pattern:\n\n### Task 1: Write Failing Test (Red)\n\n```markdown\n- [ ] **TN.1**: Write failing E2E test for [user action produces result] in tests/e2e/test_[feature].py\n```\n\nThe test should:\n- Express the acceptance criteria\n- Be specific about expected behavior\n- FAIL when run (nothing implemented yet)\n\n### Task 2: Implement to Pass (Green)\n\n```markdown\n- [ ] **TN.2**: Implement [component] to pass test in src/[path]/[file].py\n```\n\nImplementation should:\n- Make the test pass\n- Be minimal (just enough to pass)\n- Include all necessary layers (model, service, endpoint)\n\n### Task 3: Refactor and Verify\n\n```markdown\n- [ ] **TN.3**: Refactor and verify tests pass\n```\n\nRefactoring should:\n- Improve code quality without changing behavior\n- Ensure all tests still pass\n- Address any code review concerns\n\n### Task 4: Demo and Validate\n\n```markdown\n- [ ] **TN.4**: Demo [behavior], verify acceptance criteria\n```\n\nValidation should:\n- Demonstrate the feature to stakeholders (if applicable)\n- Verify against spec acceptance criteria\n- Confirm the slice is \"done\"\n\n## Mapping Stories to Cycles\n\n### Simple Case: Story = Cycle\n\nWhen a user story is well-scoped, it becomes one cycle:\n\n```\nUS-1: As a user, I can create a task with a title\n  → Cycle 1: Task creation\n```\n\n### Split Case: Story > Cycle\n\nWhen a story is too large, split into multiple cycles:\n\n```\nUS-2: As a user, I can manage my tasks (create, edit, delete, complete)\n  → Cycle 2: Task creation (foundation)\n  → Cycle 3: Task editing\n  → Cycle 4: Task deletion\n  → Cycle 5: Task completion\n```\n\n### Merge Case: Stories < Cycle\n\nWhen stories are too small, merge into one cycle:\n\n```\nUS-3: As a user, I can see task count\nUS-4: As a user, I can see completed count\n  → Cycle 6: Task statistics (covers US-3 and US-4)\n```\n\n## Quality Checklist\n\nBefore finalizing task mapping or task list:\n\n- [ ] Every P1/P2 story maps to at least one cycle\n- [ ] Cycles are vertical slices (not horizontal layers)\n- [ ] Foundation cycles identified and sequenced\n- [ ] Feature cycles marked [P] where appropriate\n- [ ] Each cycle has TDD structure (test first)\n- [ ] Every task has specific file path\n- [ ] Dependencies are minimal and explicit\n- [ ] Cycles are independently testable"
              },
              {
                "name": "syncing-claude-md",
                "description": "Ensure CLAUDE.md mirrors constitution sections per explicit mapping. Use when synchronizing CLAUDE.md with constitution, validating alignment, or when you see \"CLAUDE.md sync\", \"agent instructions\", or need to propagate constitution changes to CLAUDE.md.",
                "path": "plugins/humaninloop/skills/syncing-claude-md/SKILL.md",
                "frontmatter": {
                  "name": "syncing-claude-md",
                  "description": "Ensure CLAUDE.md mirrors constitution sections per explicit mapping. Use when synchronizing CLAUDE.md with constitution, validating alignment, or when you see \"CLAUDE.md sync\", \"agent instructions\", or need to propagate constitution changes to CLAUDE.md."
                },
                "content": "# Syncing CLAUDE.md\n\n## Purpose\n\nEnsure CLAUDE.md (the primary AI agent instruction file) remains synchronized with the constitution. CLAUDE.md serves a different audience (AI agents) than the constitution (human governance), so synchronization is selective—specific sections map with explicit sync rules.\n\n## Why CLAUDE.md Sync Matters\n\n```\n┌─────────────────────────────────────────────────────────────────┐\n│                    TWO AUDIENCES                                 │\n├────────────────────────────┬────────────────────────────────────┤\n│       CONSTITUTION         │           CLAUDE.MD                │\n├────────────────────────────┼────────────────────────────────────┤\n│ Audience: Humans           │ Audience: AI Agents                │\n│ Purpose: Governance        │ Purpose: Runtime Instructions      │\n│ Format: Detailed           │ Format: Actionable                 │\n│ Contains: Rationale        │ Contains: Rules + Commands         │\n│ Updated: Deliberately      │ Updated: Must track constitution   │\n└────────────────────────────┴────────────────────────────────────┘\n```\n\nIf CLAUDE.md diverges from the constitution, AI agents operate with outdated or incorrect guidance, undermining governance.\n\n## Mandatory Sync Mapping\n\nThe following sections MUST be synchronized:\n\n| Constitution Section | CLAUDE.md Section | Sync Rule |\n|---------------------|-------------------|-----------|\n| Core Principles | Principles Summary | MUST list all principles with enforcement keywords |\n| Technology Stack | Technical Stack | MUST match exactly (table format) |\n| Quality Gates | Quality Gates | MUST match exactly (table format) |\n| Governance | Development Workflow | MUST include versioning rules and commit conventions |\n| Project Structure | Project Structure | MUST match if present in constitution |\n| Layer Import Rules | Architecture | MUST replicate dependency rules |\n\n## Sync Rules\n\nTwo primary sync rules govern how content transfers:\n\n**MUST list all with enforcement**: Principles are summarized but preserve enforcement keywords, metrics, and thresholds. Rationale is omitted.\n\n**MUST match exactly**: Tables are copied directly with no summarization.\n\nSee [SECTION-TEMPLATES.md](SECTION-TEMPLATES.md) for detailed templates and examples for each sync rule.\n\n## Synchronization Process\n\nThe sync process follows six steps:\n\n1. **Read Both Files**: Load constitution and CLAUDE.md\n2. **Extract Mapped Sections**: Locate corresponding sections per mapping\n3. **Identify Gaps**: Create gap report showing drift\n4. **Generate Updates**: Prepare specific changes needed\n5. **Apply Updates**: Update CLAUDE.md with synchronized content\n6. **Validate Alignment**: Verify all mapped sections match\n\nSee [SYNC-PATTERNS.md](SYNC-PATTERNS.md) for detailed process steps, validation checklists, and conflict resolution.\n\n## CLAUDE.md Structure\n\nCLAUDE.md should include these sections for proper sync:\n\n- **Project Overview**: Brief description\n- **Principles**: Synchronized from constitution Core Principles\n- **Technical Stack**: Exact match from constitution Technology Stack\n- **Quality Gates**: Exact match from constitution Quality Gates\n- **Development Workflow**: From constitution Governance\n- **Project Structure**: If present in constitution\n- **Version Footer**: Version and last synced date\n\nSee [SECTION-TEMPLATES.md](SECTION-TEMPLATES.md) for the complete structure template.\n\n## Sync Triggers\n\nCLAUDE.md synchronization MUST occur when:\n\n1. **Constitution amended**: Any version bump requires sync check\n2. **New principle added**: MUST appear in Principles Summary\n3. **Principle removed**: MUST be removed from Principles Summary\n4. **Quality gate changed**: MUST update Quality Gates table\n5. **Tech stack changed**: MUST update Technical Stack table\n6. **Governance changed**: MUST update Development Workflow\n\n## Quick Validation\n\nBefore completing synchronization, verify:\n\n- [ ] All Core Principles listed with enforcement\n- [ ] Technology Stack table matches exactly\n- [ ] Quality Gates table matches exactly\n- [ ] Version numbers match (constitution = CLAUDE.md)\n- [ ] No contradictions between files\n\nSee [SYNC-PATTERNS.md](SYNC-PATTERNS.md) for the complete validation checklist.\n\n## Commit Convention\n\nWhen syncing, use this commit format:\n\n```\ndocs: sync CLAUDE.md with constitution vX.Y.Z\n\n- Updated Principles Summary (added Principle VII)\n- Updated Quality Gates (coverage 70% -> 80%)\n- Version aligned to X.Y.Z\n```\n\n## Anti-Patterns\n\n| Anti-Pattern | Problem |\n|--------------|---------|\n| Full duplication | CLAUDE.md becomes constitution copy |\n| Stale sync | CLAUDE.md lags behind constitution |\n| Missing version | No version tracking in CLAUDE.md |\n| Partial sync | Some sections synced, others not |\n| Summary drift | Summarization loses enforcement |\n\nSee [SYNC-PATTERNS.md](SYNC-PATTERNS.md) for detailed anti-patterns and fixes."
              },
              {
                "name": "validation-constitution",
                "description": "Validate constitution quality with checklists, anti-pattern detection, and version bump rules. Use after writing constitution content, when reviewing constitutions, or when you see \"constitution review\", \"quality check\", \"version bump\", \"anti-patterns\", or \"constitution audit\".",
                "path": "plugins/humaninloop/skills/validation-constitution/SKILL.md",
                "frontmatter": {
                  "name": "validation-constitution",
                  "description": "Validate constitution quality with checklists, anti-pattern detection, and version bump rules. Use after writing constitution content, when reviewing constitutions, or when you see \"constitution review\", \"quality check\", \"version bump\", \"anti-patterns\", or \"constitution audit\"."
                },
                "content": "# Validating Constitution\n\n## Purpose\n\nVerify constitution quality before finalization. This skill provides checklists, anti-pattern detection, and version bump guidance. Use after authoring with `authoring-constitution` or `brownfield-constitution` skills.\n\n## Quantification Requirements\n\nVague language MUST be replaced with measurable criteria:\n\n| Vague | Quantified |\n|-------|------------|\n| \"Code should be clean\" | \"Zero lint warnings from configured rules\" |\n| \"Functions should be short\" | \"Functions MUST NOT exceed 40 lines\" |\n| \"Tests should cover the code\" | \"Coverage MUST be ≥80% for new code\" |\n| \"Response should be fast\" | \"API MUST respond in <200ms p95\" |\n| \"Secure by default\" | \"All inputs MUST be validated; auth required on all endpoints\" |\n\n## Version Bump Rules\n\n| Bump | Trigger | Example |\n|------|---------|---------|\n| **MAJOR** | Principle removed | Removing \"Test-First\" principle |\n| **MAJOR** | Incompatible redefinition | Changing coverage from 80% to 50% |\n| **MINOR** | New principle added | Adding \"Observability\" principle |\n| **MINOR** | Significant expansion | Adding 5 new rules to existing principle |\n| **PATCH** | Clarification | Rewording for clarity, typo fixes |\n| **PATCH** | Non-semantic change | Formatting, comment updates |\n\n## Quality Checklist\n\nBefore finalizing a constitution, verify all items in [QUALITY-CHECKLIST.md](QUALITY-CHECKLIST.md).\n\n**Summary of checks:**\n- Principle Quality (Enforcement, Testability, Rationale present)\n- Structure Quality (all mandatory sections)\n- No Placeholders Rule (actual tools, not `[PLACEHOLDER]`)\n- Governance Quality (versioning, amendment process)\n\n## Anti-Patterns to Avoid\n\nSee [ANTI-PATTERNS.md](ANTI-PATTERNS.md) for common mistakes and fixes.\n\n**Quick reference:**\n\n| Anti-Pattern | Fix |\n|--------------|-----|\n| Vague principle | Define specific metrics |\n| Missing enforcement | Add CI check, code review rule, or audit |\n| Untestable rule | Define layer rules with import constraints |\n| Cargo-cult rule | Add rationale explaining the \"why\" |\n| Over-engineering | Start with 5-7 core principles |\n| No escape hatch | Define exception registry |\n| Placeholder syndrome | Use detected tools or industry defaults |\n| Generic thresholds | Specify numeric values |\n\n## Workflow\n\n1. **After authoring**: Run through the Quality Checklist\n2. **Review each principle**: Verify three-part rule (Enforcement/Testability/Rationale)\n3. **Check for anti-patterns**: Compare against common mistakes\n4. **Determine version bump**: Use Version Bump Rules table\n5. **Final sign-off**: All checklist items pass\n\n## Related Skills\n\n- [authoring-constitution](../authoring-constitution/SKILL.md) - Core authoring for greenfield\n- [brownfield-constitution](../brownfield-constitution/SKILL.md) - Authoring for existing codebases"
              },
              {
                "name": "validation-plan-artifacts",
                "description": "Review planning artifacts (research, data model, contracts) for quality and completeness. Use when reviewing plan phase outputs, finding gaps in design decisions, or when you see \"review research\", \"review data model\", \"review contracts\", \"plan quality\", or \"phase review\".",
                "path": "plugins/humaninloop/skills/validation-plan-artifacts/SKILL.md",
                "frontmatter": {
                  "name": "validation-plan-artifacts",
                  "description": "Review planning artifacts (research, data model, contracts) for quality and completeness. Use when reviewing plan phase outputs, finding gaps in design decisions, or when you see \"review research\", \"review data model\", \"review contracts\", \"plan quality\", or \"phase review\"."
                },
                "content": "# Reviewing Plan Artifacts\n\n## Purpose\n\nFind gaps in planning artifacts and generate issues that need resolution before proceeding to the next phase. Focus on design completeness and quality, not implementation details. This skill provides phase-specific review criteria for the Devil's Advocate.\n\n## Review Focus by Phase\n\nEach phase has specific checks to execute. The checks identify Critical, Important, and Minor issues.\n\n| Phase | Focus Area | Key Checks |\n|-------|------------|------------|\n| A0 | Codebase Discovery | Coverage, entity/endpoint detection, collision assessment |\n| B0 | Research | Marker resolution, alternatives, rationale quality |\n| B1 | Data Model | Entity coverage, relationships, PII identification |\n| B2 | Contracts | Endpoint coverage, schemas, error handling |\n| B3 | Cross-Artifact | Alignment, consistency, traceability |\n\nSee [PHASE-CHECKLISTS.md](PHASE-CHECKLISTS.md) for detailed phase-specific checklists and key questions.\n\n## Issue Classification\n\nIssues are classified by severity to determine appropriate action:\n\n| Severity | Definition | Action |\n|----------|------------|--------|\n| **Critical** | Blocks progress; must resolve | Return to responsible agent |\n| **Important** | Significant gap; should resolve | Flag for this iteration |\n| **Minor** | Polish item; can defer | Note for later |\n\nSee [ISSUE-TEMPLATES.md](ISSUE-TEMPLATES.md) for severity classification rules, issue documentation formats, and report templates.\n\n## Review Process\n\n### Step 1: Gather Context\n\nRead and understand:\n- The artifact being reviewed\n- The spec requirements it should satisfy\n- Previous artifacts (for consistency checks)\n- Constitution principles (for compliance)\n\n### Step 2: Execute Checks\n\nFor each check in the phase-specific checklist:\n1. Ask the question\n2. Look for evidence in the artifact\n3. If issue found, classify severity\n4. Document the issue\n\n### Step 3: Cross-Reference\n\n- Check traceability (can trace requirement -> artifact)\n- Check consistency (artifacts agree with each other)\n- Check completeness (nothing obviously missing)\n\n### Step 4: Generate Report\n\n- Classify verdict based on issues found\n- Document all issues with evidence\n- Provide specific, actionable suggestions\n- Acknowledge what was done well\n\n## Verdict Criteria\n\n| Verdict | Criteria |\n|---------|----------|\n| **ready** | Zero Critical, zero Important issues |\n| **needs-revision** | 1-3 Important issues, fixable in one iteration |\n| **critical-gaps** | 1+ Critical or 4+ Important issues |\n\n## Quality Checklist\n\nBefore finalizing review, verify:\n\n- [ ] All phase-specific checks executed\n- [ ] Issues properly classified by severity\n- [ ] Evidence cited for each issue\n- [ ] Suggested fixes are actionable\n- [ ] Verdict matches issue severity\n- [ ] Cross-artifact concerns noted\n- [ ] Strengths acknowledged"
              },
              {
                "name": "validation-task-artifacts",
                "description": "Review task artifacts (task-mapping, tasks.md) for quality and completeness. Use when reviewing task phase outputs, finding gaps in task planning, or when you see \"review mapping\", \"review tasks\", \"task quality\", or \"cycle review\".",
                "path": "plugins/humaninloop/skills/validation-task-artifacts/SKILL.md",
                "frontmatter": {
                  "name": "validation-task-artifacts",
                  "description": "Review task artifacts (task-mapping, tasks.md) for quality and completeness. Use when reviewing task phase outputs, finding gaps in task planning, or when you see \"review mapping\", \"review tasks\", \"task quality\", or \"cycle review\"."
                },
                "content": "# Reviewing Task Artifacts\n\n## Purpose\n\nFind gaps in task artifacts and generate issues that need resolution before proceeding to the next phase. Focus on vertical slice completeness, TDD structure, and traceability. This skill provides phase-specific review criteria for the Devil's Advocate.\n\n## Review Focus by Phase\n\nEach phase has specific checks to execute. The checks identify Critical, Important, and Minor issues.\n\n| Phase | Focus Area | Key Checks |\n|-------|------------|------------|\n| Mapping | Story coverage | All P1/P2 stories mapped to cycles |\n| Mapping | Slice quality | Cycles are true vertical slices |\n| Mapping | Dependencies | Foundation vs feature correctly identified |\n| Tasks | TDD structure | Test-first task ordering in each cycle |\n| Tasks | Coverage | All cycles have implementation tasks |\n| Tasks | Format | Task IDs, file paths, markers correct |\n| Cross | Traceability | Stories -> Cycles -> Tasks chain complete |\n\nSee [PHASE-CHECKLISTS.md](PHASE-CHECKLISTS.md) for detailed phase-specific checklists and key questions.\n\n## Issue Classification\n\nIssues are classified by severity to determine appropriate action:\n\n| Severity | Definition | Action |\n|----------|------------|--------|\n| **Critical** | Blocks progress; must resolve | Return to Task Architect |\n| **Important** | Significant gap; should resolve | Flag for this iteration |\n| **Minor** | Polish item; can defer | Note for later |\n\nSee [ISSUE-TEMPLATES.md](ISSUE-TEMPLATES.md) for severity classification rules, issue documentation formats, and report templates.\n\n## Review Process\n\n### Step 1: Gather Context\n\nRead and understand:\n- The artifact being reviewed (task-mapping.md or tasks.md)\n- The spec requirements (user stories, acceptance criteria)\n- Plan artifacts (for consistency checks)\n- Previous task artifacts (for cross-phase checks)\n\n### Step 2: Execute Checks\n\nFor each check in the phase-specific checklist:\n1. Ask the question\n2. Look for evidence in the artifact\n3. If issue found, classify severity\n4. Document the issue\n\n### Step 3: Cross-Reference\n\n- Check traceability (can trace story -> cycle -> tasks)\n- Check consistency (mapping and tasks agree)\n- Check completeness (nothing obviously missing)\n\n### Step 4: Generate Report\n\n- Classify verdict based on issues found\n- Document all issues with evidence\n- Provide specific, actionable suggestions\n- Acknowledge what was done well\n\n## Verdict Criteria\n\n| Verdict | Criteria |\n|---------|----------|\n| **ready** | Zero Critical, zero Important issues |\n| **needs-revision** | 1-3 Important issues, fixable in one iteration |\n| **critical-gaps** | 1+ Critical or 4+ Important issues |\n\n## Key Principles to Validate\n\n### Vertical Slicing\n\n- Cycles should deliver user value, not horizontal layers\n- Each cycle should be independently testable\n- Foundation cycles contain shared infrastructure\n- Feature cycles can parallelize\n\n### TDD Structure\n\n- Every cycle starts with a test task\n- Implementation follows the test\n- Refactor and demo complete the cycle\n- No implementation without tests\n\n### Traceability\n\n- Every P1/P2 story maps to at least one cycle\n- Every cycle has corresponding tasks\n- Every task has a specific file path\n- Story labels link tasks to requirements\n\n## Quality Checklist\n\nBefore finalizing review, verify:\n\n- [ ] All phase-specific checks executed\n- [ ] Issues properly classified by severity\n- [ ] Evidence cited for each issue\n- [ ] Suggested fixes are actionable\n- [ ] Verdict matches issue severity\n- [ ] Cross-artifact concerns noted\n- [ ] Strengths acknowledged"
              }
            ]
          }
        ]
      }
    }
  ]
}