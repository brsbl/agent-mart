{
  "owner": {
    "id": "shadowX4fox",
    "display_name": "Luis",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/8646740?u=7c1fa373c5f38b91aa933dcb87578ad01090e21f&v=4",
    "url": "https://github.com/shadowX4fox",
    "bio": null,
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 3,
      "total_stars": 0,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "shadowX4fox/solutions-architect-skills",
      "url": "https://github.com/shadowX4fox/solutions-architect-skills",
      "description": "Professional architecture documentation workflow for Claude Code",
      "homepage": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2025-12-31T13:49:19Z",
        "created_at": "2025-11-29T02:27:57Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 587
        },
        {
          "path": ".claude-plugin/plugin.json",
          "type": "blob",
          "size": 780
        },
        {
          "path": ".claude",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude/settings.json.example",
          "type": "blob",
          "size": 802
        },
        {
          "path": ".gitignore",
          "type": "blob",
          "size": 409
        },
        {
          "path": "CHANGELOG.md",
          "type": "blob",
          "size": 3809
        },
        {
          "path": "CLAUDE.md",
          "type": "blob",
          "size": 6703
        },
        {
          "path": "FORMAT_ENFORCEMENT_FOLLOWUP.md",
          "type": "blob",
          "size": 5711
        },
        {
          "path": "LICENSE",
          "type": "blob",
          "size": 1067
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 20078
        },
        {
          "path": "RELEASE_NOTES_v1.0.0.md",
          "type": "blob",
          "size": 9194
        },
        {
          "path": "agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "agents/MIGRATION.md",
          "type": "blob",
          "size": 12027
        },
        {
          "path": "agents/business-continuity-compliance-generator.md",
          "type": "blob",
          "size": 20590
        },
        {
          "path": "agents/cloud-compliance-generator.md",
          "type": "blob",
          "size": 20878
        },
        {
          "path": "agents/data-ai-compliance-generator.md",
          "type": "blob",
          "size": 18254
        },
        {
          "path": "agents/development-compliance-generator.md",
          "type": "blob",
          "size": 17595
        },
        {
          "path": "agents/enterprise-compliance-generator.md",
          "type": "blob",
          "size": 17901
        },
        {
          "path": "agents/integration-compliance-generator.md",
          "type": "blob",
          "size": 17985
        },
        {
          "path": "agents/platform-compliance-generator.md",
          "type": "blob",
          "size": 17603
        },
        {
          "path": "agents/process-compliance-generator.md",
          "type": "blob",
          "size": 17452
        },
        {
          "path": "agents/security-compliance-generator.md",
          "type": "blob",
          "size": 17828
        },
        {
          "path": "agents/sre-compliance-generator.md",
          "type": "blob",
          "size": 19940
        },
        {
          "path": "bun.lock",
          "type": "blob",
          "size": 14246
        },
        {
          "path": "docs",
          "type": "tree",
          "size": null
        },
        {
          "path": "docs/INSTALLATION.md",
          "type": "blob",
          "size": 15638
        },
        {
          "path": "docs/QUICK_START.md",
          "type": "blob",
          "size": 10555
        },
        {
          "path": "docs/TROUBLESHOOTING.md",
          "type": "blob",
          "size": 23743
        },
        {
          "path": "docs/WORKFLOW_GUIDE.md",
          "type": "blob",
          "size": 47372
        },
        {
          "path": "examples",
          "type": "tree",
          "size": null
        },
        {
          "path": "examples/ARCHITECTURE_example.md",
          "type": "blob",
          "size": 55817
        },
        {
          "path": "examples/PRODUCT_OWNER_SPEC_example.md",
          "type": "blob",
          "size": 38596
        },
        {
          "path": "examples/compliance-docs",
          "type": "tree",
          "size": null
        },
        {
          "path": "examples/compliance-docs/COMPLIANCE_MANIFEST.md",
          "type": "blob",
          "size": 3755
        },
        {
          "path": "examples/compliance-docs/SRE_ARCHITECTURE_JobSchedulingPlatform_2025-12-27.md",
          "type": "blob",
          "size": 26878
        },
        {
          "path": "examples/presentations",
          "type": "tree",
          "size": null
        },
        {
          "path": "examples/presentations/ARCHITECTURE_Architecture_ES.pptx",
          "type": "blob",
          "size": 39910
        },
        {
          "path": "examples/presentations/ARCHITECTURE_Business_EN.pptx",
          "type": "blob",
          "size": 37873
        },
        {
          "path": "examples/presentations/ARCHITECTURE_Compliance_EN.pptx",
          "type": "blob",
          "size": 38819
        },
        {
          "path": "examples/summaries_example.json",
          "type": "blob",
          "size": 1436
        },
        {
          "path": "package.json",
          "type": "blob",
          "size": 522
        },
        {
          "path": "release",
          "type": "tree",
          "size": null
        },
        {
          "path": "release/README.md",
          "type": "blob",
          "size": 1478
        },
        {
          "path": "release/solutions-architect-skills-v1.0.0.sha256",
          "type": "blob",
          "size": 114
        },
        {
          "path": "scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "scripts/build-release.sh",
          "type": "blob",
          "size": 3456
        },
        {
          "path": "skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/COMPLIANCE_GENERATION_GUIDE.md",
          "type": "blob",
          "size": 119482
        },
        {
          "path": "skills/architecture-compliance/INTEGRATION_EXAMPLE.md",
          "type": "blob",
          "size": 12807
        },
        {
          "path": "skills/architecture-compliance/SECTION_MAPPING_GUIDE.md",
          "type": "blob",
          "size": 114150
        },
        {
          "path": "skills/architecture-compliance/SKILL.md",
          "type": "blob",
          "size": 110088
        },
        {
          "path": "skills/architecture-compliance/SKILL.md.backup",
          "type": "blob",
          "size": 136376
        },
        {
          "path": "skills/architecture-compliance/STACK_VALIDATION_CHECKLIST.md",
          "type": "blob",
          "size": 2748
        },
        {
          "path": "skills/architecture-compliance/VALIDATION_FRAMEWORK_GUIDE.md",
          "type": "blob",
          "size": 17163
        },
        {
          "path": "skills/architecture-compliance/contracts",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/contracts/CONTRACT_TYPES_REFERENCE.md",
          "type": "blob",
          "size": 15023
        },
        {
          "path": "skills/architecture-compliance/shared",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/shared/MIGRATION_GUIDE.md",
          "type": "blob",
          "size": 12895
        },
        {
          "path": "skills/architecture-compliance/shared/README.md",
          "type": "blob",
          "size": 16289
        },
        {
          "path": "skills/architecture-compliance/shared/config",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/shared/config/business-continuity.json",
          "type": "blob",
          "size": 3211
        },
        {
          "path": "skills/architecture-compliance/shared/config/cloud-architecture.json",
          "type": "blob",
          "size": 1519
        },
        {
          "path": "skills/architecture-compliance/shared/config/data-ai-architecture.json",
          "type": "blob",
          "size": 1977
        },
        {
          "path": "skills/architecture-compliance/shared/config/development-architecture.json",
          "type": "blob",
          "size": 1889
        },
        {
          "path": "skills/architecture-compliance/shared/config/enterprise-architecture.json",
          "type": "blob",
          "size": 1740
        },
        {
          "path": "skills/architecture-compliance/shared/config/integration-architecture.json",
          "type": "blob",
          "size": 1888
        },
        {
          "path": "skills/architecture-compliance/shared/config/platform-it-infrastructure.json",
          "type": "blob",
          "size": 1675
        },
        {
          "path": "skills/architecture-compliance/shared/config/process-transformation.json",
          "type": "blob",
          "size": 1765
        },
        {
          "path": "skills/architecture-compliance/shared/config/security-architecture.json",
          "type": "blob",
          "size": 2338
        },
        {
          "path": "skills/architecture-compliance/shared/config/sre-architecture.json",
          "type": "blob",
          "size": 2517
        },
        {
          "path": "skills/architecture-compliance/shared/fragments",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/shared/fragments/compliance-score-calculation.md",
          "type": "blob",
          "size": 478
        },
        {
          "path": "skills/architecture-compliance/shared/fragments/compliance-summary-footer.md",
          "type": "blob",
          "size": 278
        },
        {
          "path": "skills/architecture-compliance/shared/fragments/status-codes.md",
          "type": "blob",
          "size": 310
        },
        {
          "path": "skills/architecture-compliance/shared/sections",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/shared/sections/change-history-template.md",
          "type": "blob",
          "size": 643
        },
        {
          "path": "skills/architecture-compliance/shared/sections/completion-guide-intro.md",
          "type": "blob",
          "size": 555
        },
        {
          "path": "skills/architecture-compliance/shared/sections/data-extracted-template.md",
          "type": "blob",
          "size": 215
        },
        {
          "path": "skills/architecture-compliance/shared/sections/document-control.md",
          "type": "blob",
          "size": 830
        },
        {
          "path": "skills/architecture-compliance/shared/sections/dynamic-field-instructions.md",
          "type": "blob",
          "size": 1541
        },
        {
          "path": "skills/architecture-compliance/shared/sections/generation-metadata.md",
          "type": "blob",
          "size": 516
        },
        {
          "path": "skills/architecture-compliance/shared/sections/missing-data-table-template.md",
          "type": "blob",
          "size": 281
        },
        {
          "path": "skills/architecture-compliance/shared/sections/not-applicable-template.md",
          "type": "blob",
          "size": 194
        },
        {
          "path": "skills/architecture-compliance/shared/sections/remediation-workflow-guide.md",
          "type": "blob",
          "size": 9485
        },
        {
          "path": "skills/architecture-compliance/shared/sections/unknown-status-table-template.md",
          "type": "blob",
          "size": 313
        },
        {
          "path": "skills/architecture-compliance/shared/sections/validation-methodology.md",
          "type": "blob",
          "size": 1480
        },
        {
          "path": "skills/architecture-compliance/templates",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_BUSINESS_CONTINUITY.md",
          "type": "blob",
          "size": 72137
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_CLOUD_ARCHITECTURE.md",
          "type": "blob",
          "size": 27121
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_DATA_AI_ARCHITECTURE.md",
          "type": "blob",
          "size": 84471
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_DEVELOPMENT_ARCHITECTURE.md",
          "type": "blob",
          "size": 38693
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_ENTERPRISE_ARCHITECTURE.md",
          "type": "blob",
          "size": 52013
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_INTEGRATION_ARCHITECTURE.md",
          "type": "blob",
          "size": 47446
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_PLATFORM_IT_INFRASTRUCTURE.md",
          "type": "blob",
          "size": 61454
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_PROCESS_TRANSFORMATION.md",
          "type": "blob",
          "size": 41905
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_SECURITY_ARCHITECTURE.md",
          "type": "blob",
          "size": 50919
        },
        {
          "path": "skills/architecture-compliance/templates/TEMPLATE_SRE_ARCHITECTURE.md",
          "type": "blob",
          "size": 81169
        },
        {
          "path": "skills/architecture-compliance/tests",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/tests/validators.test.ts",
          "type": "blob",
          "size": 20234
        },
        {
          "path": "skills/architecture-compliance/utils",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/utils/README.md",
          "type": "blob",
          "size": 16847
        },
        {
          "path": "skills/architecture-compliance/utils/error_reporter.ts",
          "type": "blob",
          "size": 12303
        },
        {
          "path": "skills/architecture-compliance/utils/field-updater-cli.ts",
          "type": "blob",
          "size": 2539
        },
        {
          "path": "skills/architecture-compliance/utils/field-updater.ts",
          "type": "blob",
          "size": 9290
        },
        {
          "path": "skills/architecture-compliance/utils/generation-helper.ts",
          "type": "blob",
          "size": 8032
        },
        {
          "path": "skills/architecture-compliance/utils/manifest-generator.ts",
          "type": "blob",
          "size": 15115
        },
        {
          "path": "skills/architecture-compliance/utils/resolve-includes.ts",
          "type": "blob",
          "size": 9582
        },
        {
          "path": "skills/architecture-compliance/utils/score-calculator-cli.ts",
          "type": "blob",
          "size": 2121
        },
        {
          "path": "skills/architecture-compliance/utils/score-calculator.ts",
          "type": "blob",
          "size": 11391
        },
        {
          "path": "skills/architecture-compliance/utils/template-prevalidator.ts",
          "type": "blob",
          "size": 11638
        },
        {
          "path": "skills/architecture-compliance/utils/validate-cli.ts",
          "type": "blob",
          "size": 6621
        },
        {
          "path": "skills/architecture-compliance/utils/validate-contract-structure.ts",
          "type": "blob",
          "size": 10362
        },
        {
          "path": "skills/architecture-compliance/utils/validate-example.ts",
          "type": "blob",
          "size": 5736
        },
        {
          "path": "skills/architecture-compliance/utils/validators.ts",
          "type": "blob",
          "size": 34434
        },
        {
          "path": "skills/architecture-compliance/validation",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-compliance/validation/README.md",
          "type": "blob",
          "size": 15323
        },
        {
          "path": "skills/architecture-compliance/validation/TEMPLATE_VALIDATION_SCHEMA.json",
          "type": "blob",
          "size": 12729
        },
        {
          "path": "skills/architecture-compliance/validation/VALIDATION_EXAMPLES.md",
          "type": "blob",
          "size": 25905
        },
        {
          "path": "skills/architecture-compliance/validation/VALIDATION_RULE_EXAMPLES.md",
          "type": "blob",
          "size": 15980
        },
        {
          "path": "skills/architecture-compliance/validation/VALIDATION_SCHEMA.json",
          "type": "blob",
          "size": 12708
        },
        {
          "path": "skills/architecture-compliance/validation/business_continuity_validation.json",
          "type": "blob",
          "size": 43625
        },
        {
          "path": "skills/architecture-compliance/validation/cloud_architecture_validation.json",
          "type": "blob",
          "size": 9555
        },
        {
          "path": "skills/architecture-compliance/validation/data_ai_architecture_validation.json",
          "type": "blob",
          "size": 8416
        },
        {
          "path": "skills/architecture-compliance/validation/development_architecture_validation.json",
          "type": "blob",
          "size": 23387
        },
        {
          "path": "skills/architecture-compliance/validation/enterprise_architecture_validation.json",
          "type": "blob",
          "size": 22130
        },
        {
          "path": "skills/architecture-compliance/validation/integration_architecture_validation.json",
          "type": "blob",
          "size": 23472
        },
        {
          "path": "skills/architecture-compliance/validation/platform_it_infrastructure_validation.json",
          "type": "blob",
          "size": 8806
        },
        {
          "path": "skills/architecture-compliance/validation/process_transformation_validation.json",
          "type": "blob",
          "size": 20024
        },
        {
          "path": "skills/architecture-compliance/validation/security_architecture_validation.json",
          "type": "blob",
          "size": 20062
        },
        {
          "path": "skills/architecture-compliance/validation/sre_architecture_validation.json",
          "type": "blob",
          "size": 54303
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_business_continuity.json",
          "type": "blob",
          "size": 3205
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_cloud_architecture.json",
          "type": "blob",
          "size": 3504
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_data_ai_architecture.json",
          "type": "blob",
          "size": 3167
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_development_architecture.json",
          "type": "blob",
          "size": 3460
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_enterprise_architecture.json",
          "type": "blob",
          "size": 3273
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_integration_architecture.json",
          "type": "blob",
          "size": 3268
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_platform_it_infrastructure.json",
          "type": "blob",
          "size": 3296
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_process_transformation.json",
          "type": "blob",
          "size": 3274
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_security_architecture.json",
          "type": "blob",
          "size": 3673
        },
        {
          "path": "skills/architecture-compliance/validation/template_validation_sre_architecture.json",
          "type": "blob",
          "size": 6177
        },
        {
          "path": "skills/architecture-docs",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-docs/ADR_GUIDE.md",
          "type": "blob",
          "size": 21341
        },
        {
          "path": "skills/architecture-docs/ARCHITECTURE_DOCUMENTATION_GUIDE.md",
          "type": "blob",
          "size": 61884
        },
        {
          "path": "skills/architecture-docs/DESIGN_DRIVER_CALCULATIONS.md",
          "type": "blob",
          "size": 18491
        },
        {
          "path": "skills/architecture-docs/MERMAID_DIAGRAMS_GUIDE.md",
          "type": "blob",
          "size": 29009
        },
        {
          "path": "skills/architecture-docs/METRIC_CALCULATIONS.md",
          "type": "blob",
          "size": 19374
        },
        {
          "path": "skills/architecture-docs/QUERY_SECTION_MAPPING.md",
          "type": "blob",
          "size": 18490
        },
        {
          "path": "skills/architecture-docs/REVIEW_AUDIT_WORKFLOW.md",
          "type": "blob",
          "size": 41004
        },
        {
          "path": "skills/architecture-docs/SKILL.md",
          "type": "blob",
          "size": 154689
        },
        {
          "path": "skills/architecture-docs/VALIDATIONS.md",
          "type": "blob",
          "size": 52300
        },
        {
          "path": "skills/architecture-docs/adr",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-docs/adr/ADR-000-template.md",
          "type": "blob",
          "size": 10675
        },
        {
          "path": "skills/architecture-docs/examples",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-docs/examples/ARCHITECTURE_example_3tier.md",
          "type": "blob",
          "size": 18580
        },
        {
          "path": "skills/architecture-docs/examples/README.md",
          "type": "blob",
          "size": 4833
        },
        {
          "path": "skills/architecture-docs/presentation",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-docs/presentation/PRESENTATION_GUIDE.md",
          "type": "blob",
          "size": 30446
        },
        {
          "path": "skills/architecture-docs/presentation/language_en.json",
          "type": "blob",
          "size": 6914
        },
        {
          "path": "skills/architecture-docs/presentation/language_es.json",
          "type": "blob",
          "size": 7515
        },
        {
          "path": "skills/architecture-docs/presentation/slide_templates_architecture.json",
          "type": "blob",
          "size": 9975
        },
        {
          "path": "skills/architecture-docs/presentation/slide_templates_business.json",
          "type": "blob",
          "size": 8704
        },
        {
          "path": "skills/architecture-docs/presentation/slide_templates_compliance.json",
          "type": "blob",
          "size": 11215
        },
        {
          "path": "skills/architecture-docs/templates",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-docs/templates/ARCHITECTURE_TYPE_SELECTOR.md",
          "type": "blob",
          "size": 12158
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_4_3TIER.md",
          "type": "blob",
          "size": 14331
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_4_BIAN.md",
          "type": "blob",
          "size": 32946
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_4_META.md",
          "type": "blob",
          "size": 20823
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_4_MICROSERVICES.md",
          "type": "blob",
          "size": 18357
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_4_NLAYER_PATTERNS.md",
          "type": "blob",
          "size": 13333
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_5_3TIER.md",
          "type": "blob",
          "size": 11045
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_5_BIAN.md",
          "type": "blob",
          "size": 38395
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_5_META.md",
          "type": "blob",
          "size": 16168
        },
        {
          "path": "skills/architecture-docs/templates/SECTION_5_MICROSERVICES.md",
          "type": "blob",
          "size": 17018
        },
        {
          "path": "skills/architecture-docs/utils",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-docs/utils/create-presentation.ts",
          "type": "blob",
          "size": 21400
        },
        {
          "path": "skills/architecture-docs/utils/presentation-generator.ts",
          "type": "blob",
          "size": 29038
        },
        {
          "path": "skills/architecture-readiness",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-readiness/PO_SPEC_SCORING_GUIDE.md",
          "type": "blob",
          "size": 25772
        },
        {
          "path": "skills/architecture-readiness/PRODUCT_OWNER_SPEC_GUIDE.md",
          "type": "blob",
          "size": 71618
        },
        {
          "path": "skills/architecture-readiness/SKILL.md",
          "type": "blob",
          "size": 7542
        },
        {
          "path": "skills/architecture-readiness/templates",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/architecture-readiness/templates/PO_SPEC_TEMPLATE.md",
          "type": "blob",
          "size": 11697
        },
        {
          "path": "tsconfig.json",
          "type": "blob",
          "size": 468
        }
      ],
      "marketplace": {
        "name": "shadowx4fox-solution-architect-marketplace",
        "version": null,
        "description": null,
        "owner_info": {
          "name": "shadowX4fox",
          "url": "https://github.com/shadowX4fox"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "solutions-architect-skills",
            "description": "Professional architecture documentation workflow: Business requirements, technical architecture, and compliance documentation (10 specialized agents)",
            "source": "./",
            "category": null,
            "version": "2.2.0",
            "author": {
              "name": "shadowX4fox"
            },
            "install_commands": [
              "/plugin marketplace add shadowX4fox/solutions-architect-skills",
              "/plugin install solutions-architect-skills@shadowx4fox-solution-architect-marketplace"
            ],
            "signals": {
              "stars": 0,
              "forks": 0,
              "pushed_at": "2025-12-31T13:49:19Z",
              "created_at": "2025-11-29T02:27:57Z",
              "license": "MIT"
            },
            "commands": [],
            "skills": [
              {
                "name": "architecture-compliance",
                "description": "Generate Compliance Contracts (Contratos de Adherencia) from ARCHITECTURE.md files",
                "path": "skills/architecture-compliance/SKILL.md",
                "frontmatter": {
                  "name": "architecture-compliance",
                  "description": "Generate Compliance Contracts (Contratos de Adherencia) from ARCHITECTURE.md files"
                },
                "content": "# Architecture Compliance Skill\n\n## When This Skill is Invoked\n\nThis skill is **manually activated** when users request compliance document generation. It is NOT automatically triggered.\n\n**Activation Triggers:**\n- \"Generate compliance documents\"\n- \"Create Compliance Contracts\"\n- \"Generate [specific contract type]\" (e.g., \"Generate SRE Architecture contract\")\n- \"Create compliance documentation\"\n- `/skill architecture-compliance`\n- \"Generate all compliance docs\"\n- \"Create security compliance\" or \"Generate risk management\"\n- \"List available contracts\"\n- \"Show contract types\"\n- \"What contracts can I generate?\"\n- \"Show me all compliance contracts\"\n- \"Generate all my compliance contracts\"\n- \"Create all compliance contracts\"\n- `/skill architecture-compliance all`\n- `/skill architecture-compliance SRE,Cloud,Security` (comma-separated list for subset)\n\n**NOT Activated For:**\n- Automatic triggers when ARCHITECTURE.md changes\n- General architecture documentation tasks (use `architecture-docs` skill)\n- Business requirements documentation (use `architecture-readiness` skill)\n\n## Purpose\n\nThis skill generates compliance documents from ARCHITECTURE.md, producing 10 separate documents:\n\n**10 Compliance Contracts:**\n1. Business Continuity\n2. SRE Architecture (Site Reliability Engineering)\n3. Cloud Architecture\n4. Data & Analytics - AI Architecture\n5. Development Architecture\n6. Process Transformation and Automation\n7. Security Architecture\n8. Platform & IT Infrastructure\n9. Enterprise Architecture\n10. Integration Architecture\n\n## Template Format Preservation Policy\n\n**CRITICAL REQUIREMENT**: Generated compliance contracts MUST preserve template format exactly.\n\n**Strict Preservation Rules:**\n1. ✅ **ONLY replace explicit `[PLACEHOLDER]` tokens** - text inside `[...]` brackets\n2. ✅ **PRESERVE ALL other text exactly** - including formatting, structure\n3. ❌ **NEVER transform template content** - no custom prose, no reformatting\n4. ✅ **EXPAND conditional structures** - replace `[If Compliant: X. If Non-Compliant: Y]` with the text matching the Status value\n5. ❌ **NEVER add extra sections** - templates have A.1-A.4 only, no A.5-A.9\n\n**Template Format Example:**\n```markdown\n**RTO**: [Value or \"Not specified\"]\n- Status: [Compliant/Non-Compliant/Not Applicable/Unknown]\n- Explanation: [If Compliant: RTO documented and meets requirements. If Non-Compliant: RTO not specified. If Not Applicable: N/A. If Unknown: RTO mentioned but value unclear]\n```\n\n**CORRECT Replacement** (Status = Compliant):\n```markdown\n**RTO**: 4 hours\n- Status: Compliant\n- Explanation: RTO documented and meets requirements\n```\n\n**INCORRECT Replacement (DO NOT DO THIS):**\n```markdown\n**RTO**: 4 hours documented in Section 11.3\n- Status: Compliant\n- Explanation: The system documents a 4-hour RTO requirement which meets organizational standards...\n```\n\n**Why This Matters:**\n- Ensures template consistency across all generated contracts\n- Maintains conditional guidance for future updates\n- Prevents LLM from \"improving\" template structure\n\n**See Phase 4, Step 4.2 for detailed placeholder replacement workflow.**\n\n---\n\n## Version History & Recent Improvements\n\n### v2.2.0 - Unified Agent-Based Workflow (2025-12-31)\n\n**Summary**: Refactored single contract generation to use specialized agents, eliminating duplicate inline generation logic and creating a consistent workflow path for all contract counts.\n\n**Changes:**\n\n1. **Routing Logic Unification**\n   - Single contracts (count == 1) now use Phase 3 (Agent Invocation) instead of Phase 2-5 (inline generation)\n   - All contract generation paths now consistently route to specialized agents\n   - Removed conditional workflow branching based on contract count\n\n2. **Code Cleanup** (~740 lines removed)\n   - Removed obsolete Phase 2.2-2.4 (Output Directory, Template Availability, Preview Option)\n   - Removed obsolete Phase 4 (Document Generation - inline logic)\n   - Removed obsolete Phase 5 (Output - inline logic)\n   - Removed Phase 2.1 Example Scenarios (6 scenarios)\n   - SKILL.md reduced from 3491 to 2830 lines\n\n3. **Phase 3.5 Enhancement**\n   - Clarified manifest generation applies to both single AND bulk contract generation\n   - Added explicit guidance for single contract invocation (create mode once)\n   - Maintained existing sequential manifest generation for bulk\n\n**Impact:**\n- **Single Source of Truth**: Agents are the only generation implementation (no duplicate logic)\n- **Consistency**: Identical workflow path regardless of contract count (1, 2-3, 4+)\n- **Maintainability**: Fixes/updates only needed in agent files, not in SKILL.md\n- **Simplicity**: SKILL.md is now ONLY an orchestrator (routing + manifest generation)\n- **Reliability**: All contracts benefit from v1.9.5 agent fixes (file writing, validation)\n\n**Files Modified:**\n- `/skills/architecture-compliance/SKILL.md` (740 lines removed, ~50 lines updated)\n- All documentation references updated to reflect unified workflow\n\n---\n\n### v2.1.0 - Enhanced Template Format Enforcement (2025-12-30)\n\n**Summary**: Implemented comprehensive template preservation mandate and pre-write validation across all 10 compliance generation agents.\n\n**Changes:**\n\n1. **PHASE 0: Template Preservation Mandate** (All agents)\n   - Establishes \"READ-ONLY TEMPLATE MODE\" as first instruction\n   - Explicitly forbids structural modifications, table conversions, section numbering\n   - Defines allowed operations (placeholder replacement ONLY)\n   - Includes violation detection warnings\n\n2. **PHASE 4.5: Comprehensive Pre-Write Validation** (All agents)\n   - 7-point validation checklist covering ALL template sections\n   - Document Control: 10 required fields, table format validation, forbidden field detection\n   - Dynamic Field Instructions, Scoring Methodology validation\n   - Compliance Summary table: 6 columns, row count verification\n   - Detailed Requirements sections structure check\n   - General structure rules enforcement (no section numbering, table formats)\n   - **Aborts contract generation if ANY validation check fails**\n\n3. **Validation Utility** (New tool)\n   - Created `validate-contract-structure.ts` for automated format verification\n   - Validates Document Control section (10 fields, table format, no extra fields)\n   - Validates Compliance Summary table (6 columns, proper structure)\n   - Detects invalid status values\n   - Detects forbidden section numbering (A.1, A.2, etc. in shared sections)\n   - Detects table-to-bold-field conversions\n   - Usage: `bun skills/architecture-compliance/utils/validate-contract-structure.ts <contract-file>`\n\n**Impact:**\n- **100% template fidelity** - Zero structural deviations allowed\n- **Deterministic output** - Same ARCHITECTURE.md → same structure every time\n- **Consistent bulk generation** - All 10 contracts follow exact template format\n- **Zero hallucinations** - No extra fields, sections, or content\n- **Automated enforcement** - Validation happens before output is written\n\n**Files Modified:**\n- All 10 agent files in `/agents/` (PHASE 0 + PHASE 4.5 added)\n- New utility: `/skills/architecture-compliance/utils/validate-contract-structure.ts`\n\n---\n\n## CRITICAL FORMAT PRESERVATION RULES\n\n**IMPORTANT**: The following format rules are MANDATORY and validated with BLOCKING severity. Violations will prevent contract generation.\n\n### 1. Shared Section Headers After A.4\n\nAfter \"### A.4 Change History\", the template includes shared sections via `@include` directives.\nThese are already expanded by `resolve-includes.ts` and appear as `## Header` (H2).\n\n**YOU MUST PRESERVE THEM AS H2 - DO NOT ADD A.5+ NUMBERING**\n\n- ❌ **WRONG**: `### A.5 Data Extracted Successfully`\n- ✅ **CORRECT**: `## Data Extracted Successfully`\n\n**Validation Rule**: `forbidden_section_numbering` will BLOCK any sections numbered A.5 or higher.\n\n### 2. Document Control Table Structure\n\nDocument Control MUST use table format: `| Field | Value |`\n\n**NEVER convert tables to bold field lists**\n\n- ❌ **WRONG**:\n  ```markdown\n  **Document ID**: VALUE\n  **Template Version**: VALUE\n  ```\n\n- ✅ **CORRECT**:\n  ```markdown\n  | Field | Value |\n  |-------|-------|\n  | Document ID | VALUE |\n  | Template Version | VALUE |\n  ```\n\n**Validation Rule**: `document_control_table` will BLOCK contracts without proper table format.\n\n### 3. ALL Template Formatting\n\n**Preserve ALL markdown structures exactly:**\n- Tables must stay as tables (with `|` separators)\n- Lists must stay as lists (with `-` or `*`)\n- Headers must preserve level (H2/H3) and numbering exactly\n- ONLY replace `[PLACEHOLDER]` tokens - nothing else\n\n**Why This Matters:**\n- Template consistency across all 10 contract types\n- Automated validation and parsing\n- Audit trail integrity\n\n**See Phase 4, Step 4.2 for detailed format preservation workflow.**\n\n---\n\n## Strict Source Traceability Policy\n\n**CRITICAL REQUIREMENT**: All compliance contracts must maintain strict source traceability to ARCHITECTURE.md.\n\n**Rules:**\n1. ✅ **ONLY extract data** that explicitly exists in ARCHITECTURE.md\n2. ✅ **ALWAYS cite** actual section numbers and line numbers\n3. ✅ **NEVER infer, derive, or guess** values not stated in ARCHITECTURE.md\n4. ❌ **NO INFERENCE** - even if industry standards suggest correlation\n5. ✅ **FORMAT ENFORCEMENT** - Compliance Summary table MUST use 6-column format (see Phase 4.3)\n\n**Allowed Extraction Methods:**\n- **Direct**: Extract exact values as-is from ARCHITECTURE.md\n- **Aggregation**: Consolidate multiple related values from different sections\n- **Transformation**: Calculate or reformat values using explicit source data with formula shown\n\n**When Data is Missing:**\n- Mark as `[PLACEHOLDER: Not specified in ARCHITECTURE.md Section X.Y]`\n- Provide optional industry standard reference (informational, not prescriptive)\n- Include guidance on which ARCHITECTURE.md section should contain the data\n\n**Example:**\n```\n**RTO**: [PLACEHOLDER: Not specified in ARCHITECTURE.md Section 11.3]\nOptional Reference: Industry standard for Tier 1 applications: 4 hours RTO (NIST SP 800-34)\nNote: Add RTO value to ARCHITECTURE.md Section 11.3 (Operational Considerations → Backup and Recovery)\n```\n\n**Audit Compliance**: This policy ensures all generated compliance documents are fully auditable with verifiable sources, meeting regulatory requirements for documentation traceability.\n\n### Contract Type Aliases and Keywords\n\nTo support flexible contract selection and validation, the following aliases and keywords are recognized:\n\n| Contract Type | Aliases | Keywords |\n|---------------|---------|----------|\n| Business Continuity | continuity, bcm, disaster recovery | business, continuity, recovery, rto, rpo, backup |\n| SRE | site reliability, sre, reliability | sre, slo, sli, error budget, monitoring, observability |\n| Cloud Architecture | cloud, infrastructure as code, iac | cloud, aws, azure, gcp, deployment, regions |\n| Data & AI Architecture | data, ai, ml, analytics, machine learning, data ai | data, ai, ml, analytics, pipeline, model, hallucination |\n| Development Architecture | development, dev, coding standards | development, coding, stack, framework, languages, tools |\n| Process Transformation | automation, process, transformation | process, automation, rpa, efficiency, workflow |\n| Security Architecture | security, infosec, cybersecurity | security, authentication, encryption, compliance, oauth |\n| IT Infrastructure | infrastructure, platforms, it | infrastructure, platform, database, compute, capacity |\n| Enterprise Architecture | enterprise, ea, strategic | enterprise, strategic, modularity, governance, alignment |\n| Integration Architecture | integration, api, middleware | integration, api, messaging, event, microservices |\n\n## Files in This Skill\n\n- **SKILL.md**: This file - activation triggers and workflows\n- **COMPLIANCE_GENERATION_GUIDE.md**: Comprehensive guide for all 10 contract types with generation methodology\n- **SECTION_MAPPING_GUIDE.md**: Detailed mapping between ARCHITECTURE.md sections and compliance documents\n- **templates/**: 10 template files (one per compliance document type)\n- **validation/**: 11 external validation configuration files (JSON format, one per contract type)\n  - **VALIDATION_SCHEMA.json**: JSON schema defining validation config structure\n  - **README.md**: Documentation for the validation system\n- **contracts/CONTRACT_TYPES_REFERENCE.md**: Reference documentation for all contract types\n- **shared/**: Reusable template content to eliminate duplication\n  - **sections/**: Complete reusable sections (Document Control, Validation Methodology, etc.)\n  - **fragments/**: Smaller reusable pieces (Status Codes, Compliance Score Calculation, etc.)\n  - **config/**: Domain-specific configuration files (JSON) with variable mappings\n  - **README.md**: Documentation for the shared content system\n\n## Shared Content System\n\n**Purpose**: Eliminate duplication across 10 compliance templates by extracting common sections into reusable files.\n\n**Directory**: `/skills/architecture-compliance/shared/`\n\n**Components**:\n- **sections/**: Complete reusable sections (Document Control, Validation Methodology, etc.)\n- **fragments/**: Smaller reusable pieces (Status Codes, Compliance Score Calculation, etc.)\n- **config/**: Domain-specific JSON configs (compliance codes, review boards, domain terms)\n- **README.md**: Comprehensive documentation and usage guide\n\n**Include Syntax**:\n- Simple include: `<!-- @include shared/sections/file.md -->`\n- Parameterized include: `<!-- @include-with-config shared/sections/file.md config=domain-name -->`\n\n**Processing**: Includes are resolved during template loading (Phase 4, Step 4.1) before placeholder replacement.\n\n**Benefits**:\n- Reduces template duplication by ~400-500 lines across all 10 templates\n- Centralizes maintenance for common sections (update once, apply to all)\n- Ensures consistency across all contract types (identical validation logic, status codes, etc.)\n- Simplifies updates and reduces maintenance burden\n\n**Example** (Business Continuity template):\n```markdown\n<!-- @include-with-config shared/sections/document-control.md config=business-continuity -->\n```\n\nResolves to the Document Control table with `{{variables}}` replaced from `shared/config/business-continuity.json`.\n\n**For detailed usage**: See `shared/README.md`\n\n## File Naming Convention\n\n**Output Directory:** `/compliance-docs/` (relative to ARCHITECTURE.md location)\n\n**File Naming Pattern:**\n```\n[CONTRACT_TYPE]_[PROJECT_NAME]_[DATE].md\n```\n\n**Examples:**\n- `SRE_ARCHITECTURE_JobScheduler_2025-11-26.md`\n- `BUSINESS_CONTINUITY_PaymentGateway_2025-11-26.md`\n- `DEVELOPMENT_ARCHITECTURE_JobScheduler_2025-11-26.md`\n\n**Regeneration Behavior:**\n- When regenerating an existing contract (same type, project, date), the file is REPLACED\n- Previous content is overwritten with newly generated contract\n- No timestamp appending - same filename is used: `[CONTRACT_TYPE]_[PROJECT_NAME]_[DATE].md`\n- To preserve old versions, manually rename/copy files before regenerating\n- Alternatively, use git for version control of generated contracts\n\n**Additional Outputs:**\n- `COMPLIANCE_MANIFEST.md`: Index of all generated compliance documents with metadata\n\n## Working with ARCHITECTURE.md - Context Optimization\n\n### Why Context Efficiency Matters\n\nLoading the entire ARCHITECTURE.md file (typically 2000+ lines) for each compliance document is inefficient. This skill uses **incremental section loading** to reduce context usage by 70-80%.\n\n### Context-Efficient Workflow\n\n**Step 1: Load Document Index (Lines 1-50)**\n```\nRead ARCHITECTURE.md lines 1-50 to get:\n- Project name\n- Document structure\n- Section locations (line ranges)\n```\n\n**Step 2: Identify Required Sections**\n```\nFor each contract type, consult SECTION_MAPPING_GUIDE.md to determine:\n- Primary sections (80%+ of content)\n- Secondary sections (15-30% of content)\n- Tertiary sections (<15% of content)\n```\n\n**Step 3: Load Sections Incrementally**\n```\nLoad only required sections with ±10 line buffer\nExample for SRE Architecture:\n- Section 10: Performance (lines 1550-1750, ~200 lines)\n- Section 11: Operational (lines 1750-1950, ~200 lines)\nTotal: ~400 lines vs 2000+ (80% reduction)\n```\n\n**Step 4: Cache Extracted Data**\n```\nExtract data once, cache for contract generation\nAvoid re-loading same sections for multiple contracts\n```\n\n### Example: SRE Architecture Contract Generation\n\n**Traditional Approach:**\n```\n1. Load entire ARCHITECTURE.md (2000+ lines)\n2. Search for relevant information\n3. Extract SRE metrics\n4. Generate contract\n```\n\n**Context-Efficient Approach:**\n```\n1. Read Document Index (50 lines)\n2. Identify required sections: 10, 11\n3. Load Section 10 (200 lines + 10 line buffer)\n4. Extract performance metrics (SLOs, latency, throughput), cache\n5. Load Section 11 (200 lines + 10 line buffer)\n6. Extract operational data (monitoring, incidents), cache\n7. Generate contract from cached data\nTotal: 460 lines vs 2000+ (77% reduction)\n```\n\n## Contract Listing Workflow\n\n### Special Command: List Contracts\n\nWhen users request a list of available contracts (e.g., \"list contracts\", \"show contract types\", \"what contracts are available\"), display the following summary:\n\n**Available Compliance Contracts (10 total):**\n\n1. **Business Continuity** - RTO/RPO objectives, disaster recovery plans, backup strategies\n2. **SRE Architecture** - SLOs, error budgets, monitoring, incident management, runbooks\n3. **Cloud Architecture** - Cloud deployment models, multi-region strategy, cloud-native services\n4. **Data & AI Architecture** - Data quality, AI governance, hallucination control, data lineage\n5. **Development Architecture** - Technology stack validation, code coverage, technical debt management\n6. **Process Transformation** - Automation ROI, efficiency gains, license optimization\n7. **Security Architecture** - API security, authentication, encryption, vulnerability management\n8. **Platform & IT Infrastructure** - Environment isolation, database capacity, naming conventions\n9. **Enterprise Architecture** - Strategic alignment, modularity, cloud-first, API-first design\n10. **Integration Architecture** - Integration catalog, API standards, selective async patterns\n\n**To generate contracts:**\n- Single contract: \"Generate [contract name]\" (e.g., \"Generate SRE Architecture\")\n- Multiple contracts: \"Generate Business Continuity and Security Architecture\"\n- All contracts: \"Generate all compliance documents\"\n\n**For more details on any contract type, see:** `/skills/architecture-compliance/contracts/CONTRACT_TYPES_REFERENCE.md`\n\n### User Interaction After Listing\n\nAfter displaying the contract list, ask:\n\n**\"Which compliance contract(s) would you like to generate?\"**\n\n**User Options:**\n- User specifies contract(s) → Proceed to normal generation workflow (Phase 1 below)\n- User says \"tell me more about [contract]\" → Show detailed info from CONTRACT_TYPES_REFERENCE.md\n- User says \"all\" → Generate all 10 contracts\n\n## Generation Workflow\n\n### Phase 1: Initialization\n\n**Step 1.1: Detect User Intent**\n\nParse user request to determine which contracts to generate:\n\n**Intent Types:**\n1. **\"all\" keyword** → Generate all 10 contracts\n   - Examples:\n     - \"Generate all compliance documents\"\n     - \"Generate all my compliance contracts\"\n     - \"/skill architecture-compliance all\"\n     - \"Create all compliance contracts\"\n   - Detection: Check for \"all\" keyword in normalized input (lowercase, trimmed)\n   - Pattern matching: \"all compliance\", \"all my compliance\", \"all contracts\", \"all docs\"\n\n2. **Comma-separated list** → Generate specific subset of contracts\n   - Examples:\n     - \"/skill architecture-compliance SRE,Cloud,Security\"\n     - \"Generate compliance contracts: SRE, Cloud, and Security\"\n     - \"Create SRE and Cloud contracts\"\n   - Detection: Split by comma, \"and\", \"or\" delimiters\n   - Parse each contract name using alias matching (see Aliases table lines 173-188)\n\n3. **Single contract name** → Generate one contract (existing workflow)\n   - Examples:\n     - \"Generate SRE Architecture contract\"\n     - \"Create Development Architecture compliance\"\n   - Detection: Single contract type identified via exact or fuzzy matching\n\n**Parsing Logic:**\n```\n1. Normalize input: lowercase, trim whitespace, remove punctuation\n2. Check for \"all\" keyword (in patterns like \"all compliance\", \"all my\", \"all contracts\")\n   - If found → selected_contracts = ALL_10_CONTRACT_TYPES\n3. Check for delimiter patterns (comma, \"and\", \"or\")\n   - If found → split input, parse each token as contract name\n   - Use alias matching for each token (see lines 173-188)\n   - selected_contracts = [matched contract types]\n4. Otherwise → single contract mode\n   - Use exact or fuzzy matching (existing logic, lines 410-431)\n   - selected_contracts = [single contract type]\n\nOutput: selected_contracts = array of 1-10 contract types\n```\n\n**Step 1.2: Locate ARCHITECTURE.md**\n```\nSearch order:\n1. Current directory\n2. Parent directory\n3. /docs subdirectory\n4. Ask user for location\n```\n\n**Step 1.3: Validate Structure**\n```\nCheck for:\n- Document Index (first 50 lines)\n- 12-section structure (standard ARCHITECTURE.md)\n- Required sections exist\n```\n\n**Step 1.4: Clarify User Intent**\n```\nIf ambiguous, ask:\n- \"Which compliance documents would you like to generate?\"\n  Options: All 11, Specific contract(s), By category (security, cloud, etc.)\n```\n\n### Phase 2: Configuration\n\n**Step 2.1: Contract Selection and Workflow Routing**\n\nBased on selected_contracts from Step 1.1:\n\n**Routing Logic:**\n```\n# ALL contract generation now uses specialized agents (v2.0+)\n# No inline generation logic in SKILL.md\n\nIF selected_contracts.length >= 1:\n  # AGENT-BASED GENERATION (All contract counts)\n  # Single contract (count == 1): Invoke one agent sequentially\n  # Multiple contracts (count >= 2): Invoke agents in parallel\n  # See Phase 3: Agent Invocation below\n  proceed_to_phase_3()\n  # Skip to Phase 3: Agent Invocation\n```\n\n**Single Contract Validation** (when selected_contracts.length == 1):\n```\nValidation Process:\n1. Normalize user input: Convert to lowercase, trim whitespace\n2. Check for exact match against contract type names and aliases (see Aliases table above)\n   - If match found → Proceed to Step 2.2\n3. If no match found:\n   - Calculate similarity scores using:\n     * Keyword matching (40% weight): Count matching words between user input and contract names/keywords\n     * Substring matching (30% weight): Check if user input is substring of contract name or vice versa\n     * Fuzzy matching (30% weight): Calculate edit distance for typo tolerance\n   - Select top 3 contract types with highest similarity scores\n   - Use AskUserQuestion to offer alternatives:\n     ```\n     The contract type \"[USER_INPUT]\" is not recognized.\n\n     Did you mean one of these?\n     - [Alternative 1 Name]: [Brief description]\n     - [Alternative 2 Name]: [Brief description]\n     - [Alternative 3 Name]: [Brief description]\n     ```\n   - If user selects alternative → Use selected contract type\n   - If user selects \"Other\" → List all 10 contract types with descriptions and let user choose\n\nOutput: Validated contract type\n```\n\n**Bulk Contracts Validation** (when selected_contracts.length > 1):\n```\n1. For each contract in selected_contracts:\n   - Validate template exists: templates/TEMPLATE_[CONTRACT_TYPE].md\n   - Validate validation config exists: validation/template_validation_[contract_type].json\n2. If any templates missing:\n   - Warn user: \"Template not found for [CONTRACT_TYPE]\"\n   - Offer options:\n     a) Skip missing contracts, generate remaining ones\n     b) Cancel entire operation\n3. Output: validated_contracts = [contracts with templates available]\n```\n\n### Phase 3: Agent Invocation (v2.0+)\n\n**IMPORTANT**: As of v2.0.0, this skill uses specialized compliance generation agents (one per contract type) instead of direct generation. This section documents the agent routing logic.\n\n**Step 3.1: Agent Selection**\n\nBased on the selected contract type(s) from Phase 2, invoke the corresponding specialized agent(s):\n\n| Contract Type | Agent Name | Subagent Type |\n|---------------|------------|---------------|\n| Business Continuity | business-continuity-compliance-generator | `solutions-architect-skills:business-continuity-compliance-generator` |\n| SRE Architecture | sre-compliance-generator | `solutions-architect-skills:sre-compliance-generator` |\n| Cloud Architecture | cloud-compliance-generator | `solutions-architect-skills:cloud-compliance-generator` |\n| Data & AI Architecture | data-ai-compliance-generator | `solutions-architect-skills:data-ai-compliance-generator` |\n| Development Architecture | development-compliance-generator | `solutions-architect-skills:development-compliance-generator` |\n| Process Transformation | process-compliance-generator | `solutions-architect-skills:process-compliance-generator` |\n| Security Architecture | security-compliance-generator | `solutions-architect-skills:security-compliance-generator` |\n| Platform & IT Infrastructure | platform-compliance-generator | `solutions-architect-skills:platform-compliance-generator` |\n| Enterprise Architecture | enterprise-compliance-generator | `solutions-architect-skills:enterprise-compliance-generator` |\n| Integration Architecture | integration-compliance-generator | `solutions-architect-skills:integration-compliance-generator` |\n\n**Agent Characteristics:**\n- Each agent is **pre-configured** with contract-specific settings:\n  - Contract type (no parameter needed)\n  - Template filename\n  - Section mappings (pre-configured for performance)\n  - Domain-specific data extraction patterns\n- Agents are **self-contained** (no shared state)\n- Agents support **parallel execution** (unique output filenames)\n- Agents **DO NOT** generate COMPLIANCE_MANIFEST.md (skill handles this)\n\n**Step 3.2: Single Contract Invocation**\n\nWhen generating a single contract (selected_contracts.length == 1):\n\n```python\n# Example: Generate Cloud Architecture contract\nTask(\n    subagent_type=\"solutions-architect-skills:cloud-compliance-generator\",\n    prompt=\"Generate Cloud Architecture compliance contract from ./ARCHITECTURE.md\",\n    description=\"Generate Cloud compliance\"\n)\n```\n\n**Agent Input:**\n- `architecture_file` path (default: ./ARCHITECTURE.md)\n\n**Agent Output:**\n- Generated compliance contract file: `/compliance-docs/[CONTRACT_TYPE]_[PROJECT]_[DATE].md`\n- Metadata (filename, project, date, score) returned to skill\n- **IMPORTANT**: Agents create ONLY the .md contract file (no .txt reports, no additional files)\n\n**Step 3.3: Bulk Contract Invocation (Parallel)**\n\nWhen generating multiple contracts (selected_contracts.length > 1):\n\n**Parallel Execution:**\n```python\n# Example: Generate all 10 contracts in parallel\n# Single message with multiple Task tool calls\n\nTask(subagent_type=\"solutions-architect-skills:business-continuity-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:sre-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:cloud-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:data-ai-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:development-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:process-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:security-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:platform-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:enterprise-compliance-generator\", ...),\nTask(subagent_type=\"solutions-architect-skills:integration-compliance-generator\", ...)\n```\n\n**Benefits:**\n- **Performance**: 10 agents in parallel ~10x faster than sequential\n- **No conflicts**: Each agent writes unique output file\n- **No shared state**: Fully independent execution\n\n**Step 3.4: Collect Agent Results**\n\nAfter all agents complete:\n\n```python\nresults = []\nfor agent in launched_agents:\n    result = agent.wait_for_completion()\n    results.append({\n        \"filename\": result.filename,\n        \"project\": result.project,\n        \"date\": result.date,\n        \"score\": result.score,  # If calculated by agent\n        \"type\": result.contract_type\n    })\n```\n\n**Step 3.4A: Detect Compliance Docs Directory**\n\nDetermine the absolute path to the compliance-docs directory:\n\n```bash\n# Get absolute path to ARCHITECTURE.md directory\nARCH_DIR=$(dirname \"$(realpath ./ARCHITECTURE.md)\")\n\n# Compliance docs are in subdirectory of ARCHITECTURE.md location\nCOMPLIANCE_DOCS_DIR=\"${ARCH_DIR}/compliance-docs\"\n```\n\nStore this path for use in manifest-generator invocations.\n\n**Why This Step**:\n- Manifest-generator.ts looks for compliance-docs at `process.cwd()/compliance-docs`\n- In plugin context, `process.cwd()` differs from ARCHITECTURE.md location\n- Passing absolute path via `--compliance-docs-dir` ensures correct directory is used\n\n**Step 3.5: Generate Compliance Manifest**\n\nAfter all agent(s) complete successfully, generate COMPLIANCE_MANIFEST.md using manifest-generator.ts.\n\n**CRITICAL: You MUST execute manifest generation after ALL contract generation (single OR bulk).**\n\n**Applies To:**\n- Single contract generation: Execute manifest-generator once (create mode)\n- Bulk contract generation: Execute manifest-generator sequentially for each contract (create for first, update for rest)\n\n**Path Resolution Note** (v1.9.3+):\n\nThe `--compliance-docs-dir` parameter is required when running from plugin context to ensure manifest-generator finds the correct directory. This parameter should be set to the absolute path of the compliance-docs directory (subdirectory of ARCHITECTURE.md location).\n\nIf the parameter is omitted, manifest-generator defaults to `./compliance-docs` relative to `process.cwd()`, which may not match the contract generation location in plugin contexts.\n\n**Command Sequence:**\n\nFor each generated contract, invoke manifest-generator.ts sequentially:\n\n1. **First Contract** (creates new manifest):\n```bash\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode create \\\n  --project \"[PROJECT_NAME]\" \\\n  --contract-type \"[CONTRACT_TYPE]\" \\\n  --filename \"[GENERATED_FILENAME]\" \\\n  --score [SCORE] \\\n  --status \"[STATUS]\" \\\n  --completeness [COMPLETENESS_PERCENTAGE] \\\n  --compliance-docs-dir \"${COMPLIANCE_DOCS_DIR}\"\n```\n\n2. **Subsequent Contracts** (update existing manifest):\n```bash\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"[PROJECT_NAME]\" \\\n  --contract-type \"[CONTRACT_TYPE]\" \\\n  --filename \"[GENERATED_FILENAME]\" \\\n  --score [SCORE] \\\n  --status \"[STATUS]\" \\\n  --completeness [COMPLETENESS_PERCENTAGE] \\\n  --compliance-docs-dir \"${COMPLIANCE_DOCS_DIR}\"\n```\n\n**Parameter Extraction:**\n- `[PROJECT_NAME]`: Extract from first H1 in ARCHITECTURE.md or contract filename\n- `[CONTRACT_TYPE]`: Type of contract (Business Continuity, SRE Architecture, etc.)\n- `[GENERATED_FILENAME]`: The .md file created by the agent\n- `[SCORE]`: Extract from contract (if available) or use \"Pending Validation\"\n- `[STATUS]`: Extract from contract (if available) or use \"Draft\"\n- `[COMPLETENESS_PERCENTAGE]`: Calculate based on filled placeholders or use 0\n\n**Example Execution Sequence:**\n```bash\n# 1. First contract (creates manifest)\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode create \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Business Continuity\" \\\n  --filename \"BUSINESS_CONTINUITY_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0 \\\n  --compliance-docs-dir \"${COMPLIANCE_DOCS_DIR}\"\n\n# 2-10. Remaining contracts (update manifest)\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"SRE Architecture\" \\\n  --filename \"SRE_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0 \\\n  --compliance-docs-dir \"${COMPLIANCE_DOCS_DIR}\"\n\n# ... repeat for all 10 contracts\n```\n\n**Error Handling:**\n- If manifest-generator.ts fails → Log error, continue with remaining contracts\n- If all contracts fail → Return error, do not create empty manifest\n- Always verify COMPLIANCE_MANIFEST.md exists after completion\n\n**Why Skill Handles Manifest:**\n- **Atomicity**: Manifest updated only after ALL contracts complete\n- **Consistency**: Single source of truth for manifest generation\n- **No Race Conditions**: Prevents conflicts when running 10 agents in parallel\n- **Traceability**: Skill aggregates all agent results before manifest creation\n\n**IMPORTANT**:\n- Individual agents DO NOT generate or update COMPLIANCE_MANIFEST.md (prevents write conflicts during parallel execution)\n- This step is NOT optional - always execute after parallel agent completion\n- Verify COMPLIANCE_MANIFEST.md exists before reporting completion to user\n\n### Phase 3 (Legacy): Data Extraction (Context-Efficient)\n\n**NOTE**: This phase is now delegated to specialized agents (v2.0+). The documentation below describes the agent's internal workflow for reference.\n\n**Legacy Phase - Now Handled by Agents:**\n\n**Step 3.1: Load Document Index**\n```\nRead ARCHITECTURE.md lines 1-50:\n- Extract project name\n- Identify section boundaries\n- Cache section line ranges\n```\n\n**Step 3.2: For Each Contract, Identify Required Sections**\n```\nConsult SECTION_MAPPING_GUIDE.md:\nExample for Business Continuity:\n- Primary: Section 11 (Operational Considerations)\n- Secondary: Section 10 (Performance Requirements)\n```\n\n**Step 3.3: Load Sections Incrementally**\n```\nFor each required section:\n- Calculate line range with ±10 buffer\n- Read specific line range from ARCHITECTURE.md\n- Extract relevant data using patterns\n- Cache extracted data\n```\n\n**Step 3.4: Extract and Validate**\n```\nFor each data point:\n- Apply extraction pattern (direct, aggregation, transformation, inference)\n- Validate extracted value\n- If missing: flag for [PLACEHOLDER]\n- Store with source reference (section, line number)\n```\n\n**Step 3.5: Automatic Validation** (All Contract Types)\n```\nFor ALL contract types:\n- Input: Cached section content from ARCHITECTURE.md\n- Process: Load and apply external validation configuration\n  1. Load validation config file from /skills/architecture-compliance/validation/\n     - Format: {contract_name}_validation.json\n     - Example: development_architecture_validation.json\n\n  2. Parse validation configuration:\n     - Scoring thresholds (auto_approve: 8.0, ready_for_review: 7.0, needs_work: 5.0)\n     - Weights (completeness, compliance, quality)\n     - Validation sections and items\n     - Approval authority\n\n  3. Evaluate validation items:\n     - PASS (10 points): Complies with requirements\n     - FAIL (0 points): Non-compliant or deprecated\n     - N/A (10 points): Not applicable\n     - UNKNOWN (0 points): Missing data in ARCHITECTURE.md\n     - EXCEPTION (10 points): Documented exception via LADES2\n\n  4. Calculate scores:\n\n     **CRITICAL: USE WEIGHTS FROM VALIDATION CONFIG, NOT DEFAULT VALUES**\n\n     Step 4a: Extract weights from loaded validation config:\n     - Let W_completeness = config.scoring.weights.completeness\n     - Let W_compliance = config.scoring.weights.compliance\n     - Let W_quality = config.scoring.weights.quality\n     - Verify weights sum to 1.0 (±0.001 tolerance), warn if not\n\n     Step 4b: Calculate component scores (0-10 scale):\n     - Completeness = (Filled required fields / Total required fields) × 10\n     - Compliance = (PASS count + N/A count + EXCEPTION count) / Total applicable items × 10\n     - Quality = (Items with valid source references / Total items) × 10\n\n     Step 4c: Calculate weighted final score:\n     - Final Score = (Completeness × W_completeness) + (Compliance × W_compliance) + (Quality × W_quality)\n     - Round to 1 decimal place\n\n     **Example Calculation**:\n     Given: Completeness=9.3, Compliance=8.6, Quality=9.0, Weights=0.35/0.55/0.10\n     Calculation: (9.3 × 0.35) + (8.6 × 0.55) + (9.0 × 0.10)\n                = 3.255 + 4.73 + 0.9\n                = 8.885\n     Final Score = 8.9/10 (rounded to 1 decimal)\n\n     **CRITICAL - N/A Scoring**: N/A items MUST be included in the compliance score numerator:\n     - N/A = \"Not applicable to this architecture\" = Fully compliant (10 points)\n     - UNKNOWN = \"Missing required data\" = Non-compliant (0 points)\n     - Example: 6 PASS + 5 N/A out of 11 items = (6+5)/11 × 10 = 10.0/10 (100%)\n\n  5. Determine outcome:\n\n     **CRITICAL: USE OUTCOME_MAPPING FROM VALIDATION CONFIG**\n\n     Step 5a: Load outcome_mapping from validation config\n     Step 5b: Apply threshold matching using INCLUSIVE lower bound, INCLUSIVE upper bound:\n\n     Algorithm:\n     1. For each range in outcome_mapping (e.g., \"8.0-10.0\"):\n        - Parse range: lower = 8.0, upper = 10.0\n        - Check if: lower <= Final Score <= upper\n        - If match found, use that tier's values\n\n     2. Extract outcome values from matched tier:\n        - document_status (e.g., \"Approved\")\n        - overall_status (e.g., \"PASS\")\n        - action (e.g., \"AUTO_APPROVE\")\n        - review_actor (e.g., \"System (Auto-Approved)\")\n\n     **Range Definitions** (from config):\n     - 8.0-10.0: AUTO_APPROVE → Status: \"Approved\", Actor: \"System (Auto-Approved)\"\n     - 7.0-7.9: MANUAL_REVIEW → Status: \"In Review\", Actor: [Approval Authority]\n     - 5.0-6.9: NEEDS_WORK → Status: \"Draft\", Actor: \"Architecture Team\"\n     - 0.0-4.9: REJECT → Status: \"Rejected\", Actor: \"N/A (Blocked)\"\n\n     **Example Mapping**:\n     Final Score = 8.9 → Check: 8.0 <= 8.9 <= 10.0? YES → Status=\"Approved\"\n     Final Score = 8.2 → Check: 8.0 <= 8.2 <= 10.0? YES → Status=\"Approved\"\n     Final Score = 7.8 → Check: 7.0 <= 7.8 <= 7.9? YES → Status=\"In Review\"\n\n  6. Collect evidence with source references (Section X.Y, line Z)\n\n- Output: ValidationResults object → cache for Phase 4\n- Overhead: ~6,000 tokens (3.5K prompt + 2.5K response)\n- Result: PASS (score ≥ 7.0) | CONDITIONAL (5.0-6.9) | FAIL (< 5.0)\n```\n\n---\n\n## BULK GENERATION WORKFLOW\n\n**This section is used ONLY when selected_contracts.length > 1 (bulk mode).**\n**For single contracts, use Phase 3: Agent Invocation above (unified workflow).**\n\n### Phase 2 Bulk: Batch Workflow Routing\n\n**Step 2B.0: Batching Decision**\n\nDetermine workflow mode based on selected_contracts.length:\n\n```\nIF selected_contracts.length >= 4:\n    # BATCHED MODE\n    batch_size = 3\n    batches = split_into_batches(selected_contracts, batch_size)\n\n    # Priority order for splitting (importance-based)\n    priority_order = [\n        'business_continuity', 'sre_architecture', 'cloud_architecture',\n        'data_ai_architecture', 'development_architecture',\n        'process_transformation', 'security_architecture',\n        'platform_it_infrastructure', 'enterprise_architecture',\n        'integration_architecture'\n    ]\n\n    # Initialize cross-batch state\n    batch_results = {\n        'successful_contracts': [],\n        'failed_contracts': [],\n        'generated_contracts': {},\n        'validation_results': [],\n        'manifest_mode': 'create'  # First batch creates, rest update\n    }\n\n    # Execute batched workflow\n    for batch_num, batch_contracts in enumerate(batches, start=1):\n        print(\"═══════════════════════════════════════════\")\n        print(f\"Processing Batch {batch_num}/{len(batches)}\")\n        print(f\"Contracts: {', '.join(batch_contracts)}\")\n        print(\"═══════════════════════════════════════════\\n\")\n\n        # Process batch (Phases 2B.1-Batched through 4B.3-Batched)\n        batch_result = process_single_batch(\n            batch_contracts,\n            batch_num,\n            batch_results['manifest_mode']\n        )\n\n        # Accumulate results\n        batch_results['successful_contracts'].extend(batch_result.successful)\n        batch_results['failed_contracts'].extend(batch_result.failed)\n        batch_results['generated_contracts'].update(batch_result.generated)\n        batch_results['validation_results'].extend(batch_result.validation)\n\n        # Update manifest mode for next batch\n        batch_results['manifest_mode'] = 'update'\n\n    # Generate aggregated summary (Phase 5B-Batched)\n    generate_batched_summary_report(batch_results)\n    EXIT  # Batched workflow complete\n\nELSE:\n    # PARALLEL MODE (2-3 contracts, no batching needed)\n    # Continue to Step 2B.1 (existing workflow below)\n```\n\n---\n\n### Phase 2C: Parallel Agent Generation (4+ Contracts)\n\n**CRITICAL**: This phase is automatically activated when `selected_contracts.length >= 4` to enable parallel agent-based generation with 10× speedup.\n\n**When to Use:**\n- User requests 4 or more compliance contracts\n- Automatically spawns Task Agents (1 per contract) in parallel\n- No user prompt required (automatic activation)\n\n**Routing Logic:**\n```\nIF selected_contracts.length === 1:\n    → Use Phase 3 (Agent Invocation - Single Contract)\nELSE IF selected_contracts.length <= 3:\n    → Use Phase 2 Bulk (Parallel Data Loading - see below)\nELSE IF selected_contracts.length >= 4:\n    → Use Phase 2C (Parallel Agent Generation - THIS SECTION)\n```\n\n**Benefits:**\n- 10× speedup (3-5 min for 10 contracts vs 50+ min sequential)\n- Parallel execution (all contracts generated simultaneously)\n- Auto-fallback on failure (graceful degradation to sequential mode)\n- Leverages existing skill infrastructure (agents invoke skill)\n\n---\n\n**Step 2C.0: Agent Configuration**\n\n1. **Determine contract list**\n   ```\n   IF user requested \"all\":\n       contracts = all 10 contract types\n   ELSE:\n       contracts = user-specified list (must be >= 4)\n   ```\n\n2. **Locate ARCHITECTURE.md**\n   ```\n   architecture_file = path to ARCHITECTURE.md\n   - Validate file exists\n   - Get absolute path for agents\n   ```\n\n3. **Get project metadata**\n   ```\n   - Read ARCHITECTURE.md lines 1-50 (Document Index)\n   - Extract project_name from Section 1\n   - Get current_date in YYYY-MM-DD format (for manifest updates)\n   ```\n\n**Contract Type List:**\n```javascript\nall_contracts = [\n  'business_continuity',      // 1. Business Continuity\n  'sre_architecture',         // 2. SRE Architecture\n  'cloud_architecture',       // 3. Cloud Architecture\n  'data_ai',                  // 4. Data & AI Architecture\n  'development',              // 5. Development Architecture\n  'process',                  // 6. Process Transformation\n  'security',                 // 7. Security Architecture\n  'platform',                 // 8. Platform & IT Infrastructure\n  'enterprise',               // 9. Enterprise Architecture\n  'integration'               // 10. Integration Architecture\n]\n```\n\n---\n\n**Step 2C.1: Spawn Task Agents in Parallel**\n\nFor each contract_type in contracts, spawn a Task Agent using the compliance-generator agent definition:\n\n```\nFor contract_type in contracts:\n  Spawn Task Agent:\n    Agent Definition: agents/compliance-generator.md  ← At plugin root\n    Parameters:\n      contract_type: [contract_type]\n      architecture_file: [architecture_file_path]\n\n    The agent will:\n      1. Invoke: /solutions-architect-skills:architecture-compliance [contract_type]\n      2. The skill automatically:\n         - Reads ARCHITECTURE.md\n         - Loads template for [contract_type]\n         - Generates and validates contract\n         - Writes to /compliance-docs/[FILENAME].md\n         - Updates COMPLIANCE_MANIFEST.md\n      3. Returns: Success or error message\n```\n\n**Example Spawn Calls (10 agents in parallel):**\n```\nTask Agent 1:  Load agents/compliance-generator.md, contract_type=business_continuity, architecture_file=[PATH]\nTask Agent 2:  Load agents/compliance-generator.md, contract_type=sre_architecture, architecture_file=[PATH]\nTask Agent 3:  Load agents/compliance-generator.md, contract_type=cloud_architecture, architecture_file=[PATH]\nTask Agent 4:  Load agents/compliance-generator.md, contract_type=data_ai, architecture_file=[PATH]\nTask Agent 5:  Load agents/compliance-generator.md, contract_type=development, architecture_file=[PATH]\nTask Agent 6:  Load agents/compliance-generator.md, contract_type=process, architecture_file=[PATH]\nTask Agent 7:  Load agents/compliance-generator.md, contract_type=security, architecture_file=[PATH]\nTask Agent 8:  Load agents/compliance-generator.md, contract_type=platform, architecture_file=[PATH]\nTask Agent 9:  Load agents/compliance-generator.md, contract_type=enterprise, architecture_file=[PATH]\nTask Agent 10: Load agents/compliance-generator.md, contract_type=integration, architecture_file=[PATH]\n```\n\n**Agent Behavior:**\n- Each agent follows compliance-generator.md workflow (simple skill invocation)\n- Agents run independently (no shared state)\n- Each agent has Write tool access via the skill\n- Timeout: 10 minutes per agent\n- **Agent location:** Plugin root `agents/` directory (Claude Code convention)\n\n---\n\n**Step 2C.2: Wait for All Task Agents**\n\n```\nWait for all spawned agents to complete\nTimeout: 10 minutes per agent\nCollect results: { agent_id, contract_type, status, output }\n```\n\n**Expected Results:**\n```javascript\nagent_results = [\n  { agent_id: 1, contract_type: 'business_continuity', status: 'success', output: '✅ Generated...' },\n  { agent_id: 2, contract_type: 'sre_architecture', status: 'success', output: '✅ Generated...' },\n  { agent_id: 3, contract_type: 'cloud_architecture', status: 'failed', output: '❌ Failed...' },\n  ...\n]\n```\n\n---\n\n**Step 2C.3: Handle Complete Failure (All Agents Failed)**\n\n```\nsuccessful_agents = agent_results.filter(r => r.status === 'success')\n\nIF successful_agents.length === 0:\n    Display:\n    ═══════════════════════════════════════════════\n    ⚠️  Parallel Agent Mode Failed\n    ═══════════════════════════════════════════════\n\n    All agents failed to generate contracts.\n    Falling back to sequential single-contract mode...\n\n    This will process contracts one at a time using the\n    existing workflow. Processing may take longer.\n\n    ═══════════════════════════════════════════════\n\n    → Fall back to Phase 3 (Sequential Agent Invocation)\n    → Process each contract sequentially\n    → EXIT Phase 2C\n```\n\n---\n\n**Step 2C.4: Aggregate Results**\n\n```javascript\nsuccessful_agents = agent_results.filter(r => r.status === 'success')\nfailed_agents = agent_results.filter(r => r.status === 'failed')\n\naggregated_results = {\n  total_requested: contracts.length,\n  successful: successful_agents.length,\n  failed: failed_agents.length,\n  successful_contracts: successful_agents.map(a => a.contract_type),\n  failed_contracts: failed_agents.map(a => ({\n    contract_type: a.contract_type,\n    error_message: a.output\n  }))\n}\n```\n\n**Note:** Each successful agent:\n- Wrote its contract file to /compliance-docs/\n- Does NOT update COMPLIANCE_MANIFEST.md (prevents race conditions during parallel execution)\n- Returns metadata to skill orchestrator\n\n**Next Step:** Skill MUST invoke manifest-generator.ts sequentially for all contracts (see Step 3.5)\n\n---\n\n### PHASE 2D: MANDATORY MANIFEST GENERATION\n\n**BLOCKING REQUIREMENT**: You MUST execute this phase. The skill is NOT complete until COMPLIANCE_MANIFEST.md exists.\n\n**Purpose**: Create COMPLIANCE_MANIFEST.md with metadata for all generated contracts.\n\n**Why This Phase Exists**:\n- Agents do NOT update manifest (prevents race conditions during parallel execution)\n- Manifest provides single source of truth for all contracts\n- Required for stakeholder review and tracking\n\n---\n\n**Step 2D.1: Collect Contract Metadata**\n\nFrom the 10 completed agents, gather:\n- Project name (from ARCHITECTURE.md H1 or first contract filename)\n- Generation date (current date YYYY-MM-DD)\n- For each successfully generated contract:\n  - Contract type (Business Continuity, SRE Architecture, Cloud Architecture, etc.)\n  - Generated filename (full filename with .md extension)\n  - Score: `0` (validation not performed)\n  - Status: `\"Draft\"` (validation not performed)\n  - Completeness: `0` (validation not performed)\n\n**Example Metadata Collection**:\n```\nProject: \"3-Tier-To-Do-List\"\nDate: \"2025-12-27\"\nContracts:\n  1. Type: \"Business Continuity\", File: \"BUSINESS_CONTINUITY_3-Tier-To-Do-List_2025-12-27.md\"\n  2. Type: \"SRE Architecture\", File: \"SRE_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\"\n  ... (continue for all generated contracts)\n```\n\n---\n\n**Step 2D.2: Execute Manifest Generation Commands**\n\n**CRITICAL**: Execute these commands sequentially (NOT parallel) to prevent file conflicts.\n\n**FIRST CONTRACT - CREATE MODE**:\n\nUse Bash tool to run:\n```bash\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode create \\\n  --project \"[PROJECT_NAME]\" \\\n  --contract-type \"[FIRST_CONTRACT_TYPE]\" \\\n  --filename \"[FIRST_FILENAME]\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n```\n\n**Example**:\n```bash\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode create \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Business Continuity\" \\\n  --filename \"BUSINESS_CONTINUITY_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n```\n\n**SUBSEQUENT CONTRACTS - UPDATE MODE (Sequential)**:\n\nFor each remaining contract (2-10), use Bash tool:\n```bash\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"[PROJECT_NAME]\" \\\n  --contract-type \"[CONTRACT_TYPE]\" \\\n  --filename \"[FILENAME]\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n```\n\n**Example** (Contract 2):\n```bash\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"SRE Architecture\" \\\n  --filename \"SRE_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n```\n\n**Repeat UPDATE mode for all remaining contracts** (Cloud, Data & AI, Development, Process, Security, Platform, Enterprise, Integration).\n\n**IMPORTANT**:\n- Use absolute path: `cd /home/shadowx4fox/solutions-architect-skills` before each command\n- Execute sequentially (not parallel) to prevent file conflicts\n- Capture and report any errors immediately\n- Do NOT proceed to Step 2D.3 until all contracts are added\n\n---\n\n**Step 2D.3: VERIFY Manifest Creation**\n\nUse Read tool to verify:\n```\nRead file: /compliance-docs/COMPLIANCE_MANIFEST.md\n```\n\n**Expected**: File exists and contains all generated contracts in the table.\n\n**If file does not exist**:\n- This is a CRITICAL ERROR - skill has FAILED\n- You MUST retry manifest generation (Step 2D.2)\n- Do NOT report skill completion\n- Report error to user with manifest-generator.ts logs\n\n**If file exists but is incomplete**:\n- Count contracts in manifest table\n- Compare with number of successful agent generations\n- If mismatch, identify missing contracts and add them using UPDATE mode\n\n---\n\n**Step 2D.4: Report Manifest Completion**\n\nOnly after COMPLIANCE_MANIFEST.md exists and contains all contracts:\n\n```\n✅ Compliance manifest generated successfully\n\nLocation: /compliance-docs/COMPLIANCE_MANIFEST.md\nContracts: [N]/[N] included\nFramework: [FRAMEWORK from ARCHITECTURE.md]\nGeneration Date: [DATE]\n```\n\n**IMPORTANT**: Do NOT report skill completion before this message is displayed\n\n---\n\n### Example: Complete Manifest Generation Workflow\n\n**Scenario**: Generated all 10 contracts for \"3-Tier-To-Do-List\" project on 2025-12-27\n\n**Complete Command Sequence**:\n\n```bash\n# Contract 1: Business Continuity (CREATE - establishes manifest)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode create \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Business Continuity\" \\\n  --filename \"BUSINESS_CONTINUITY_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 2: SRE Architecture (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"SRE Architecture\" \\\n  --filename \"SRE_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 3: Cloud Architecture (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Cloud Architecture\" \\\n  --filename \"CLOUD_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 4: Data & AI Architecture (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Data & AI Architecture\" \\\n  --filename \"DATA_AI_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 5: Development Architecture (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Development Architecture\" \\\n  --filename \"DEVELOPMENT_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 6: Process Transformation (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Process Transformation\" \\\n  --filename \"PROCESS_TRANSFORMATION_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 7: Security Architecture (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Security Architecture\" \\\n  --filename \"SECURITY_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 8: Platform & IT Infrastructure (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Platform & IT Infrastructure\" \\\n  --filename \"PLATFORM_IT_INFRASTRUCTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 9: Enterprise Architecture (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Enterprise Architecture\" \\\n  --filename \"ENTERPRISE_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Contract 10: Integration Architecture (UPDATE)\ncd /home/shadowx4fox/solutions-architect-skills\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"3-Tier-To-Do-List\" \\\n  --contract-type \"Integration Architecture\" \\\n  --filename \"INTEGRATION_ARCHITECTURE_3-Tier-To-Do-List_2025-12-27.md\" \\\n  --score 0 \\\n  --status \"Draft\" \\\n  --completeness 0\n\n# Verify manifest was created\n# Read /compliance-docs/COMPLIANCE_MANIFEST.md\n```\n\n**Expected Result**: COMPLIANCE_MANIFEST.md created with all 10 contracts in the table.\n\n**Contract Type Order**:\n1. Business Continuity\n2. SRE Architecture\n3. Cloud Architecture\n4. Data & AI Architecture\n5. Development Architecture\n6. Process Transformation\n7. Security Architecture\n8. Platform & IT Infrastructure\n9. Enterprise Architecture\n10. Integration Architecture\n\n---\n\n**Step 2C.6: Report Failures (If Any)**\n\n```\nIF failed_agents.length > 0:\n  Display:\n  ═══════════════════════════════════════════════\n  ⚠️  Partial Generation Failures\n  ═══════════════════════════════════════════════\n\n  [N] out of [TOTAL] contracts failed to generate.\n  Successful contracts have been written to /compliance-docs/\n\n  Failed Contracts:\n  [For each failed_agent:]\n    - [contract_type]: [error_message]\n\n  Recovery Options:\n  1. Fix ARCHITECTURE.md missing sections/errors\n  2. Regenerate failed contracts individually:\n     /solutions-architect-skills:architecture-compliance [contract_type]\n     /solutions-architect-skills:architecture-compliance [contract_type]\n     ...\n\n  ═══════════════════════════════════════════════\n```\n\n**Example:**\n```\n═══════════════════════════════════════════════\n⚠️  Partial Generation Failures\n═══════════════════════════════════════════════\n\n2 out of 10 contracts failed to generate.\nSuccessful contracts have been written to /compliance-docs/\n\nFailed Contracts:\n  - sre_architecture: Missing Section 10.1 (Monitoring and Observability)\n  - integration: Missing Section 5.2 (Integration Patterns)\n\nRecovery Options:\n1. Fix ARCHITECTURE.md missing sections/errors\n2. Regenerate failed contracts individually:\n   /solutions-architect-skills:architecture-compliance sre_architecture\n   /solutions-architect-skills:architecture-compliance integration\n\n═══════════════════════════════════════════════\n```\n\n---\n\n**Step 2C.7: Generate Summary Report**\n\nDisplay comprehensive summary of parallel agent generation:\n\n```\n═══════════════════════════════════════════════════════════════\nCompliance Contract Generation Summary (Parallel Agent Mode)\n═══════════════════════════════════════════════════════════════\n\nStatus: [N_SUCCESS]/[TOTAL] successful, [N_FAILED] failed\nPerformance: [N] parallel agents, ~3-5 min total (10× speedup vs sequential)\nOutput: /compliance-docs/\n\nGenerated Contracts:\n[For each successful_agent:]\n✅ [Display Name]\n[For each failed_agent:]\n❌ [Display Name] (Failed - [Error Summary])\n\nNext Steps:\n- Review contracts in /compliance-docs/\n- Check COMPLIANCE_MANIFEST.md for full audit trail\n[IF failures:]\n- Fix ARCHITECTURE.md missing sections\n- Regenerate failed contracts individually (see commands above)\n\n═══════════════════════════════════════════════════════════════\n```\n\n**Example (Partial Success - 8/10):**\n```\n═══════════════════════════════════════════════════════════════\nCompliance Contract Generation Summary (Parallel Agent Mode)\n═══════════════════════════════════════════════════════════════\n\nStatus: 8/10 successful, 2 failed\nPerformance: 10 parallel agents, ~4 min total (10× speedup vs sequential)\nOutput: /compliance-docs/\n\nGenerated Contracts:\n✅ Business Continuity\n✅ Cloud Architecture\n✅ Data & AI Architecture\n✅ Development Architecture\n✅ Process Transformation\n✅ Security Architecture\n✅ Platform & IT Infrastructure\n✅ Enterprise Architecture\n❌ SRE Architecture (Failed - Missing Section 10.1)\n❌ Integration Architecture (Failed - Missing Section 5.2)\n\nNext Steps:\n- Review contracts in /compliance-docs/\n- Check COMPLIANCE_MANIFEST.md for full audit trail\n- Fix ARCHITECTURE.md missing sections\n- Regenerate failed contracts individually (see commands above)\n\n═══════════════════════════════════════════════════════════════\n```\n\n**Example (Complete Success - 10/10):**\n```\n═══════════════════════════════════════════════════════════════\nCompliance Contract Generation Summary (Parallel Agent Mode)\n═══════════════════════════════════════════════════════════════\n\nStatus: 10/10 successful, 0 failed\nPerformance: 10 parallel agents, ~3.5 min total (10× speedup vs sequential)\nOutput: /compliance-docs/\n\nGenerated Contracts:\n✅ Business Continuity\n✅ SRE Architecture\n✅ Cloud Architecture\n✅ Data & AI Architecture\n✅ Development Architecture\n✅ Process Transformation\n✅ Security Architecture\n✅ Platform & IT Infrastructure\n✅ Enterprise Architecture\n✅ Integration Architecture\n\nNext Steps:\n- Review contracts in /compliance-docs/\n- Check COMPLIANCE_MANIFEST.md for full audit trail\n\n═══════════════════════════════════════════════════════════════\n```\n\n---\n\n**MANDATORY Completion Criteria (BLOCKING):**\n\nBefore reporting skill completion, you MUST verify:\n\n- [ ] All requested .md contract files exist in /compliance-docs/\n- [ ] COMPLIANCE_MANIFEST.md exists in /compliance-docs/\n- [ ] COMPLIANCE_MANIFEST.md contains all successfully generated contracts in the table\n- [ ] Manifest shows correct project name and generation date\n- [ ] No manifest-generator.ts errors occurred during PHASE 2D\n- [ ] Manifest completion message displayed (Step 2D.4)\n\n**CRITICAL**: If ANY item is unchecked, the skill has FAILED. You MUST fix before reporting completion.\n\n**Recovery Steps if Manifest is Missing or Incomplete**:\n\n1. Re-execute PHASE 2D manually:\n   - Collect contract metadata from agent outputs (Step 2D.1)\n   - Execute manifest-generator.ts commands sequentially (Step 2D.2)\n   - Verify manifest exists and is complete (Step 2D.3)\n   - Report manifest completion (Step 2D.4)\n2. If errors persist, report failure to user with error details\n3. Do NOT report skill completion until manifest exists and is verified\n\n---\n\n**EXIT Phase 2C** - Parallel agent generation complete.\n\n---\n\n### Phase 2 Bulk: Parallel Data Loading (Non-Batched)\n\n**NOTE**: This workflow is used when selected_contracts.length <= 3 (no batching needed).\n**For 4+ contracts, batching is automatically enabled (see Step 2B.0 above).**\n\nThis phase loads all templates and ARCHITECTURE.md sections in parallel to minimize I/O overhead.\n\n**Step 2B.1: Load Shared Context (Once)**\n\nExecute the following operations in parallel:\n\n1. **Load ARCHITECTURE.md Document Index** (lines 1-50)\n   ```\n   - Extract project name from Document Index\n   - Identify section boundaries (line ranges for sections 1-12)\n   - Cache as: document_index = { project_name, section_boundaries }\n   ```\n\n2. **Validate output directory**\n   ```\n   - Check /compliance-docs/ exists relative to ARCHITECTURE.md\n   - Create directory if needed using Bash: mkdir -p /compliance-docs\n   - Get current date for filename generation: YYYY-MM-DD format\n   ```\n\n**Step 2B.2: Parallel Template Loading**\n\nFor each contract in validated_contracts, execute Read tool calls in parallel:\n\n**Example for 3 contracts** (SRE, Cloud, Security):\n```\nRead skills/architecture-compliance/templates/TEMPLATE_SRE_ARCHITECTURE.md\nRead skills/architecture-compliance/templates/TEMPLATE_CLOUD_ARCHITECTURE.md\nRead skills/architecture-compliance/templates/TEMPLATE_SECURITY_ARCHITECTURE.md\n```\n\nCache results as: `templates[contract_type] = template_content`\n\n**Step 2B.3: Parallel Include Resolution**\n\nFor each loaded template, resolve `@include-with-config` directives in parallel:\n\n**Use resolve-includes.ts utility** (see skills/architecture-compliance/utils/resolve-includes.ts):\n\n```bash\n# Parallel Bash tool calls (one per contract)\nbun skills/architecture-compliance/utils/resolve-includes.ts \\\n  skills/architecture-compliance/templates/TEMPLATE_SRE_ARCHITECTURE.md \\\n  /tmp/expanded_sre.md\n\nbun skills/architecture-compliance/utils/resolve-includes.ts \\\n  skills/architecture-compliance/templates/TEMPLATE_CLOUD_ARCHITECTURE.md \\\n  /tmp/expanded_cloud.md\n\nbun skills/architecture-compliance/utils/resolve-includes.ts \\\n  skills/architecture-compliance/templates/TEMPLATE_SECURITY_ARCHITECTURE.md \\\n  /tmp/expanded_security.md\n```\n\nThen read expanded templates back in parallel:\n```\nRead /tmp/expanded_sre.md\nRead /tmp/expanded_cloud.md\nRead /tmp/expanded_security.md\n```\n\nCache results as: `expanded_templates[contract_type] = expanded_content`\n\n**Step 2B.4: Parallel Section Extraction**\n\nFor each contract, determine required sections from SECTION_MAPPING_GUIDE.md (see lines 1344+):\n\n**Section Requirements per Contract:**\n- Business Continuity: Section 11\n- SRE Architecture: Sections 10, 11\n- Cloud Architecture: Sections 4, 8, 11\n- Data & AI: Sections 3, 5, 6\n- Development: Sections 3, 5, 8, 12\n- Process Transformation: Sections 5, 8\n- Security: Section 9\n- Platform & IT: Sections 4, 8, 10, 11\n- Enterprise: Sections 1, 2, 3, 4\n- Integration: Section 7\n\n**Identify unique sections needed across ALL validated_contracts:**\n```\nunique_sections = set()\nfor contract in validated_contracts:\n  unique_sections.add(contract.required_sections)\n\nExample: If generating SRE (10,11), Cloud (4,8,11), Security (9)\n  → unique_sections = [4, 8, 9, 10, 11] (5 unique sections)\n```\n\n**Load all unique sections in parallel using section_boundaries from Step 2B.1:**\n\n```\n# Example: Load sections 4, 8, 9, 10, 11 in parallel\nRead ARCHITECTURE.md lines [section_4_start]:[section_4_end+10]  # ±10 buffer\nRead ARCHITECTURE.md lines [section_8_start]:[section_8_end+10]\nRead ARCHITECTURE.md lines [section_9_start]:[section_9_end+10]\nRead ARCHITECTURE.md lines [section_10_start]:[section_10_end+10]\nRead ARCHITECTURE.md lines [section_11_start]:[section_11_end+10]\n```\n\nCache results as: `sections[section_number] = section_content`\n\n**Context Efficiency:**\n- Each section loaded ONCE, shared across all contracts that need it\n- Total loaded (worst case all 10 contracts): Document Index (50 lines) + 10 templates (~500KB) + 12 sections (~100KB) = ~602KB\n\n**Fallback for Context Limits:**\n- If context approaching limits, use batched loading:\n  - Batch 1: Contracts 1-5 (load templates + sections, generate, output) ~325KB\n  - Batch 2: Contracts 6-10 (load templates + sections, generate, output) ~325KB\n\n---\n\n## BATCHED WORKFLOW (4+ Contracts)\n\n**This section describes processing ONE batch of contracts (used when batching is enabled).**\n\n### Phase 2B-Batched: Single Batch Processing\n\n**Input:**\n- `batch_contracts`: Array of 1-3 contract types for this batch\n- `batch_num`: Current batch number (1-based)\n- `manifest_mode`: 'create' for first batch, 'update' for subsequent\n\n**Step 2B.1-Batched: Load Shared Context for Batch**\n\nExecute in parallel:\n\n1. **Load ARCHITECTURE.md Document Index** (lines 1-50)\n   ```\n   - Extract project name\n   - Identify section boundaries\n   - Cache as: document_index = { project_name, section_boundaries }\n   ```\n\n2. **Validate output directory** (only if batch_num == 1)\n   ```\n   - Check /compliance-docs/ exists\n   - Create if needed: mkdir -p /compliance-docs\n   - Get current date: YYYY-MM-DD format\n   ```\n\n**Step 2B.2-Batched: Parallel Template Loading (Batch Only)**\n\nFor each contract in `batch_contracts`, execute Read in parallel:\n\n```\n# Example Batch 1 (3 contracts)\nRead skills/architecture-compliance/templates/TEMPLATE_BUSINESS_CONTINUITY.md\nRead skills/architecture-compliance/templates/TEMPLATE_SRE_ARCHITECTURE.md\nRead skills/architecture-compliance/templates/TEMPLATE_CLOUD_ARCHITECTURE.md\n```\n\nCache: `batch_templates[contract_type] = template_content`\n\n**Context Usage**: ~85 KB for 3 templates (vs ~556 KB for all 10)\n\n**Step 2B.3-Batched: Parallel Include Resolution (Batch Only)**\n\nFor each template in batch, resolve @include directives in parallel:\n\n```bash\nbun skills/architecture-compliance/utils/resolve-includes.ts \\\n  templates/TEMPLATE_BUSINESS_CONTINUITY.md /tmp/expanded_bc.md &\n\nbun skills/architecture-compliance/utils/resolve-includes.ts \\\n  templates/TEMPLATE_SRE_ARCHITECTURE.md /tmp/expanded_sre.md &\n\nbun skills/architecture-compliance/utils/resolve-includes.ts \\\n  templates/TEMPLATE_CLOUD_ARCHITECTURE.md /tmp/expanded_cloud.md &\n\nwait\n```\n\nThen read expanded templates in parallel:\n```\nRead /tmp/expanded_bc.md\nRead /tmp/expanded_sre.md\nRead /tmp/expanded_cloud.md\n```\n\nCache: `batch_expanded_templates[contract_type] = expanded_content`\n\n**Step 2B.4-Batched: Parallel Section Extraction (Batch Only)**\n\nDetermine unique sections needed for this batch:\n\n```\n# Example Batch 1:\n# - Business Continuity: Section 11\n# - SRE Architecture: Sections 10, 11\n# - Cloud Architecture: Sections 4, 8, 11\n# Unique sections: [4, 8, 10, 11] (4 sections instead of all 12)\n```\n\nLoad unique sections in parallel from ARCHITECTURE.md with ±10 line buffer.\n\nCache: `batch_sections[section_number] = section_content`\n\n**Context Efficiency**:\n- Batch 1-3 (3 contracts each): ~85 KB templates + 40 KB sections = ~125 KB\n- Batch 4 (1 contract): ~30 KB templates + 10 KB sections = ~40 KB\n\n---\n\n### Phase 3B-Batched: Sequential Generation (Batch Only)\n\n**Step 3B.1-Batched: For Each Contract in Batch**\n\nProcess each contract in `batch_contracts` using cached data only (no additional I/O):\n\n```\nfor contract_type in batch_contracts:\n    template = batch_expanded_templates[contract_type]\n    required_sections = get_required_sections_from_mapping(contract_type)\n\n    # Extract data from cached sections\n    extracted_data = extract_from_sections(batch_sections, required_sections)\n\n    # Apply data to template\n    generated = apply_data_to_template(template, extracted_data, document_index)\n\n    # Cache generated contract\n    batch_generated_contracts[contract_type] = {\n        'content': generated,\n        'filename': f\"{contract_type.upper()}_{project_name}_{date}.md\"\n    }\n```\n\n**Performance**: ~1-2 seconds per contract (in-memory processing)\n\n**Step 3B.2-Batched**: Apply placeholders (same as existing Step 3B.2)\n- Replace `[PROJECT_NAME]`, `[GENERATION_DATE]`, etc.\n- Expand conditional placeholders\n- Populate Document Control table\n- Calculate Compliance Summary\n\n**Step 3B.3-Batched**: Cache generated contracts\n\n---\n\n### Phase 4B-Batched: Batch Validation & Output\n\n**Step 4B.1-Batched: Batch Validation**\n\nUse `validateMultipleContracts()` from generation-helper.ts:\n\n```typescript\nimport { validateMultipleContracts } from './utils/generation-helper';\n\nconst validation_inputs = Object.entries(batch_generated_contracts).map(\n  ([contract_type, contract_data]) => ({\n    content: contract_data.content,\n    contractType: contract_type\n  })\n);\n\nconst validation_results = await validateMultipleContracts(validation_inputs);\n```\n\n**Step 4B.2-Batched: Parallel Output**\n\nWrite contracts that passed validation in parallel:\n\n```\n# Parallel Write calls\nWrite /compliance-docs/BUSINESS_CONTINUITY_Project_2025-12-26.md\nWrite /compliance-docs/SRE_ARCHITECTURE_Project_2025-12-26.md\nWrite /compliance-docs/CLOUD_ARCHITECTURE_Project_2025-12-26.md\n```\n\n**Step 4B.3-Batched: Sequential Manifest Updates**\n\n**CRITICAL**: First contract in Batch 1 uses `create`, all others use `update`:\n\n```bash\n# First contract (Batch 1, Contract 1 only)\nif batch_num == 1 and contract_index == 0:\n    bun utils/manifest-generator.ts --mode create \\\n      --project \"[PROJECT]\" --contract-type \"[TYPE]\" \\\n      --filename \"[FILE]\" --score [SCORE] \\\n      --status \"[STATUS]\" --completeness [COMP]\nelse:\n    # All other contracts\n    bun utils/manifest-generator.ts --mode update \\\n      --project \"[PROJECT]\" --contract-type \"[TYPE]\" \\\n      --filename \"[FILE]\" --score [SCORE] \\\n      --status \"[STATUS]\" --completeness [COMP]\n```\n\n---\n\n### Phase 5B-Batched: Aggregated Summary Report\n\n**Step 5B.1-Batched: Aggregate Results Across All Batches**\n\n```\ntotal_successful = len(batch_results['successful_contracts'])\ntotal_failed = len(batch_results['failed_contracts'])\nall_validations = batch_results['validation_results']\n\navg_score = mean([v.finalScore for v in all_validations if v.isValid])\navg_completeness = mean([v.completeness for v in all_validations if v.isValid])\n\n# Count by status\nauto_approved = count([v for v in all_validations if v.finalScore >= 8.0])\nneeds_review = count([v for v in all_validations if 7.0 <= v.finalScore < 8.0])\n```\n\n**Step 5B.2-Batched: Generate Summary Report**\n\nDisplay formatted output with batching statistics:\n\n```\n═══════════════════════════════════════════════════════════════\nCompliance Contract Generation Summary (Batched Mode)\n═══════════════════════════════════════════════════════════════\n\nGenerated Contracts: [successful]/[total_requested]\nBatches Processed: [num_batches]\n\n✅ Successful: ([successful] contracts)\n- Business Continuity: BUSINESS_CONTINUITY_Project_2025-12-26.md\n  Score: 7.2/10 | Status: In Review | Completeness: 72% | Batch: 1\n\n- SRE Architecture: SRE_ARCHITECTURE_Project_2025-12-26.md\n  Score: 8.7/10 | Status: Approved | Completeness: 89% | Batch: 1\n\n[... all successful contracts grouped by batch ...]\n\n───────────────────────────────────────────────────────────────\nOverall Statistics\n───────────────────────────────────────────────────────────────\n• Average Score: [avg_score]/10\n• Average Completeness: [avg_completeness]%\n• Auto-Approved (≥8.0): [count]\n• Needs Review (7.0-7.9): [count]\n• Needs Work (5.0-6.9): [count]\n\n───────────────────────────────────────────────────────────────\nBatching Performance\n───────────────────────────────────────────────────────────────\n• Total Batches: [num_batches]\n• Contracts per Batch: 3 (last may have fewer)\n• Est. Context per Batch: ~167 KB avg\n• Context Savings: ~70% vs parallel (556 KB → 167 KB/batch)\n\n───────────────────────────────────────────────────────────────\nOutput\n───────────────────────────────────────────────────────────────\nAll contracts saved to: /compliance-docs/\nManifest updated: /compliance-docs/COMPLIANCE_MANIFEST.md\n\nNext Steps:\n1. Review contracts with \"Needs Review\" status\n2. Complete missing data for \"Needs Work\" contracts\n3. Re-generate individual contracts if needed\n```\n\n---\n\n### Phase 3 Bulk: Sequential Generation\n\n**NOTE**: This workflow is used when selected_contracts.length <= 3 (no batching).\n**For 4+ contracts, see Phase 3B-Batched (automatic batching enabled).**\n\nThis phase processes each contract sequentially using cached data (no I/O overhead).\n\n**Step 3B.1: For Each Contract in validated_contracts**\n\nLoop through each contract type:\n\n```\nfor contract_type in validated_contracts:\n  # All data already loaded in Phase 2 Bulk - no tool calls needed\n\n  template = expanded_templates[contract_type]\n  required_sections = get_required_sections(contract_type)  # From SECTION_MAPPING_GUIDE.md\n\n  # Extract data from cached sections\n  extracted_data = {}\n  for section_num in required_sections:\n    section_content = sections[section_num]\n    extracted_data[section_num] = extract_data(section_content, contract_type)\n\n  # Generate contract (in-memory, fast)\n  generated_contract = apply_data_to_template(\n    template=template,\n    data=extracted_data,\n    project_name=document_index.project_name,\n    generation_date=current_date\n  )\n\n  # Cache for validation\n  generated_contracts[contract_type] = generated_contract\n```\n\n**Step 3B.2: Apply Placeholders**\n\nFor each contract, follow existing Phase 4, Step 4.2 logic (lines 698-889):\n\n1. **Replace standard placeholders:**\n   - `[PROJECT_NAME]` → from document_index.project_name\n   - `[GENERATION_DATE]` → current_date\n   - `[CONTRACT_TYPE]` → contract type name\n   - `[DOCUMENT_VERSION]` → \"1.0\" (initial generation)\n\n2. **Expand conditional placeholders** (lines 820-889):\n   - Pattern: `[If Compliant: X. If Non-Compliant: Y. If Not Applicable: Z. If Unknown: W]`\n   - Expand to match the Status value for each requirement\n\n3. **Populate Document Control table** (lines 784-817):\n   - Document ID, Version, Status, Classification, etc.\n\n4. **Calculate Compliance Summary** (lines 963-1088):\n   - 6-column format: Code | Requirement | Category | Status | Source Section | Responsible Role\n   - Status values: \"Compliant\", \"Non-Compliant\", \"Not Applicable\", \"Unknown\"\n\n5. **Format derived values** (lines 1090-1095):\n   - Compliance scores, completeness percentages\n\n**Step 3B.3: Cache Generated Contracts**\n\nStore all generated contracts in memory for batch validation:\n\n```\ngenerated_contracts = {\n  'sre_architecture': {\n    content: generated_content,\n    filename: 'SRE_ARCHITECTURE_Project_2025-12-26.md',\n    metadata: { score, status, completeness }\n  },\n  'cloud_architecture': {\n    content: generated_content,\n    filename: 'CLOUD_ARCHITECTURE_Project_2025-12-26.md',\n    metadata: { score, status, completeness }\n  },\n  ...\n}\n```\n\n**Performance**: This phase is fast (~1-2 seconds per contract) because all data is cached.\n\n---\n\n### Phase 4 Bulk: Batch Validation & Output\n\n**NOTE**: This workflow is used when selected_contracts.length <= 3 (no batching).\n**For 4+ contracts, see Phase 4B-Batched (automatic batching enabled).**\n\n**Step 4B.1: Batch Validation (Use Existing Utility)**\n\nUse the existing `validateMultipleContracts()` function from generation-helper.ts (lines 192-203):\n\n```typescript\nimport { validateMultipleContracts } from './utils/generation-helper';\n\nconst validation_inputs = Object.entries(generated_contracts).map(\n  ([contract_type, contract_data]) => ({\n    content: contract_data.content,\n    contractType: contract_type\n  })\n);\n\nconst validation_results = await validateMultipleContracts(validation_inputs);\n```\n\n**Process Validation Results:**\n\n```\nsuccessful_contracts = []\nfailed_contracts = []\n\nfor result in validation_results:\n  if result.isValid:\n    mark_for_output(result.contractType)\n    successful_contracts.push(result)\n  else:\n    log_error(result.contractType, result.errorReport)\n    failed_contracts.push(result)\n\n    # Graceful degradation: generate anyway as \"Draft\"\n    if result.validationResult.finalScore >= 3.0:\n      mark_for_output_as_draft(result.contractType)\n      successful_contracts.push(result)  # Include in output\n```\n\n**Step 4B.2: Parallel Output (Write Contracts)**\n\nFor all contracts that passed validation (or marked as Draft), write in parallel:\n\n```\n# Parallel Write Tool Calls\nWrite /compliance-docs/SRE_ARCHITECTURE_Project_2025-12-26.md\nWrite /compliance-docs/CLOUD_ARCHITECTURE_Project_2025-12-26.md\nWrite /compliance-docs/SECURITY_ARCHITECTURE_Project_2025-12-26.md\n... (for all successful contracts)\n```\n\n**Step 4B.3: Sequential Manifest Updates**\n\nUse manifest-generator.ts to create or update COMPLIANCE_MANIFEST.md:\n\n**First contract: create manifest**\n```bash\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode create \\\n  --project \"[PROJECT_NAME]\" \\\n  --contract-type \"SRE Architecture\" \\\n  --filename \"SRE_ARCHITECTURE_Project_2025-12-26.md\" \\\n  --score 8.7 \\\n  --status \"Approved\" \\\n  --completeness 89\n```\n\n**Subsequent contracts: update manifest (sequential, fast)**\n```bash\nbun skills/architecture-compliance/utils/manifest-generator.ts \\\n  --mode update \\\n  --project \"[PROJECT_NAME]\" \\\n  --contract-type \"Cloud Architecture\" \\\n  --filename \"CLOUD_ARCHITECTURE_Project_2025-12-26.md\" \\\n  --score 7.8 \\\n  --status \"In Review\" \\\n  --completeness 78\n\n# ... (repeat for all successful contracts)\n```\n\n**Note**: Manifest updates are sequential to prevent concurrent write conflicts.\nThis is fast (~100ms per update) and ensures data integrity.\n\n---\n\n### Phase 5 Bulk: Summary Report\n\n**NOTE**: This workflow is used when selected_contracts.length <= 3 (no batching).\n**For 4+ contracts, see Phase 5B-Batched (automatic batching enabled).**\n\n**Step 5B.1: Aggregate Results**\n\nCollect statistics from validation_results:\n\n```\nsuccessful_count = len(successful_contracts)\nfailed_count = len(failed_contracts)\ntotal_requested = len(validated_contracts)\n\navg_score = mean([r.validationResult.finalScore for r in successful_contracts])\navg_completeness = mean([r.completeness for r in successful_contracts])\n\n# Status breakdown\nauto_approved = [r for r in successful_contracts if r.validationResult.finalScore >= 8.0]\nneeds_review = [r for r in successful_contracts if 7.0 <= r.validationResult.finalScore < 8.0]\nneeds_work = [r for r in successful_contracts if 5.0 <= r.validationResult.finalScore < 7.0]\nrejected = [r for r in successful_contracts if r.validationResult.finalScore < 5.0]\n```\n\n**Step 5B.2: Generate Summary Report**\n\nOutput formatted summary to user:\n\n```\n═══════════════════════════════════════════════════════════════\nCompliance Contract Generation Summary\n═══════════════════════════════════════════════════════════════\n\nGenerated Contracts: [successful_count]/[total_requested]\n\n✅ Successful: ([successful_count] contracts)\n- SRE Architecture: SRE_ARCHITECTURE_Project_2025-12-26.md\n  Score: 8.7/10 | Status: Approved | Completeness: 89%\n\n- Cloud Architecture: CLOUD_ARCHITECTURE_Project_2025-12-26.md\n  Score: 7.8/10 | Status: In Review | Completeness: 78%\n\n- Security Architecture: SECURITY_ARCHITECTURE_Project_2025-12-26.md\n  Score: 9.2/10 | Status: Approved | Completeness: 92%\n\n[... list all successful contracts with scores, status, completeness ...]\n\n❌ Failed: ([failed_count] contracts)\n[Only if failures occurred]\n- Integration Architecture: Validation failed (score 4.2/10)\n  Reason: Missing required data in ARCHITECTURE.md Section 7\n  Missing Data:\n    • Integration catalog (Section 7.1)\n    • API standards (Section 7.2)\n    • Async patterns (Section 7.3)\n\n  Recovery Steps:\n  1. Add Section 7 to ARCHITECTURE.md with integration details\n  2. Regenerate: /skill architecture-compliance Integration\n\n  Reference: SKILL.md lines 1400+ (Integration Architecture requirements)\n\n───────────────────────────────────────────────────────────────\nOverall Statistics\n───────────────────────────────────────────────────────────────\n• Average Score: [avg_score]/10\n• Average Completeness: [avg_completeness]%\n• Auto-Approved (≥8.0): [count] contracts\n• Needs Review (7.0-7.9): [count] contracts\n• Needs Work (5.0-6.9): [count] contracts\n• Rejected (<5.0): [count] contracts\n\n───────────────────────────────────────────────────────────────\nOutput\n───────────────────────────────────────────────────────────────\nAll contracts saved to: /compliance-docs/\nManifest updated: /compliance-docs/COMPLIANCE_MANIFEST.md\n\n═══════════════════════════════════════════════════════════════\nNext Steps\n═══════════════════════════════════════════════════════════════\n1. Review contracts in /compliance-docs/\n2. Complete placeholders in contracts with score < 8.0:\n   [List specific contracts and what needs completion]\n3. Update ARCHITECTURE.md for failed contracts:\n   [List specific sections and data points to add]\n4. Regenerate improved contracts: /skill architecture-compliance [CONTRACT_TYPE]\n5. See COMPLIANCE_MANIFEST.md for detailed tracking\n```\n\n**Step 5B.3: Error Handling & Recovery**\n\nFor each failed contract, provide specific recovery instructions:\n\n```\nFailed Contract: [CONTRACT_TYPE]\n├─ Error: [SPECIFIC_ERROR_MESSAGE]\n├─ Root Cause: [MISSING_SECTION | VALIDATION_FAILURE | TEMPLATE_NOT_FOUND]\n├─ Missing Data Points:\n│  • [DATA_POINT_1] (should be in Section [X])\n│  • [DATA_POINT_2] (should be in Section [Y])\n│  • [DATA_POINT_3] (should be in Section [Z])\n├─ Recommended Actions:\n│  1. Update ARCHITECTURE.md Section [X]: Add [SPECIFIC_DATA]\n│  2. Update ARCHITECTURE.md Section [Y]: Add [SPECIFIC_DATA]\n│  3. Regenerate contract: /skill architecture-compliance [CONTRACT_TYPE]\n└─ Reference: SECTION_MAPPING_GUIDE.md for [CONTRACT_TYPE] requirements\n```\n\n**Idempotent Regeneration**:\n- User can regenerate failed contracts individually using existing single-contract workflow\n- Existing successful contracts are preserved (not regenerated)\n- Manifest tracks latest version per contract type (updates existing entry)\n- Files are REPLACED when regenerating (Write tool overwrites)\n\n---\n\n## Contract Types and Required Sections\n\n### 1. Business Continuity\n**Primary Sections:** 11 (Operational Considerations)\n**Secondary Sections:** 10 (Performance Requirements)\n**Key Extractions:** RTO, RPO, backup strategy, DR procedures\n\n### 2. SRE Architecture\n**Primary Sections:** 10 (Performance), 11 (Operational)\n**Secondary Sections:** 5 (System Components)\n**Key Extractions:** SLOs, SLIs, error budgets, monitoring, incident management\n\n### 3. Cloud Architecture\n**Primary Sections:** 4 (Deployment Architecture), 8 (Technology Stack), 11 (Operational)\n**Secondary Sections:** 9 (Security), 10 (Performance)\n**Key Extractions:** Cloud model, connectivity, security, monitoring, backup, best practices\n\n### 4. Data & Analytics - AI Architecture\n**Primary Sections:** 5 (System Components), 6 (Data Flow), 7 (Integration Points)\n**Secondary Sections:** 8 (Technology Stack), 10 (Performance)\n**Key Extractions:** Data quality, governance, AI models, compliance, scalability\n\n### 5. Development Architecture\n**Primary Sections:** 3 (Architecture Patterns), 5 (System Components), 8 (Technology Stack), 12 (ADRs)\n**Secondary Sections:** 11 (Operational)\n**Key Extractions:** Technology stack, development practices, technical debt\n**Automatic Validation:** Stack validation checklist (26 items) automatically evaluated during generation. Results: PASS (approval unblocked) or FAIL (detailed failure report with remediation guidance)\n\n### 6. Process Transformation and Automation\n**Primary Sections:** 1 (System Overview), 2 (Business Context), 6 (Data Flow)\n**Secondary Sections:** 5 (System Components), 7 (Integration Points)\n**Key Extractions:** Automation practices, process improvements, efficiency metrics\n\n### 7. Security Architecture\n**Primary Sections:** 9 (Security Considerations)\n**Secondary Sections:** 7 (Integration Points), 11 (Operational)\n**Key Extractions:** API security, authentication, encryption, communication security\n\n### 8. Platform & IT Infrastructure\n**Primary Sections:** 4 (Deployment Architecture), 8 (Technology Stack), 11 (Operational)\n**Secondary Sections:** 10 (Performance)\n**Key Extractions:** Environments, OS, databases, capacity, retention, naming\n\n### 9. Enterprise Architecture\n**Primary Sections:** 1 (System Overview), 2 (Business Context), 3 (Architecture Patterns), 4 (Deployment)\n**Secondary Sections:** 12 (ADRs)\n**Key Extractions:** Modularity, cloud-first, API-first, business alignment\n\n### 10. Integration Architecture\n**Primary Sections:** 7 (Integration Points)\n**Secondary Sections:** 5 (System Components), 6 (Data Flow), 8 (Technology Stack)\n**Key Extractions:** Integration catalog, patterns, security, standards compliance\n\n## User Interaction Points\n\n### Initialization Phase\n**When:** Skill activation\n**Question:** \"Which compliance documents would you like to generate?\"\n**Options:** All 11, Specific contract(s), By category\n\n### Configuration Phase\n**When:** Before generation\n**Question:** \"Confirm output directory?\"\n**Default:** `/compliance-docs/`\n\n### Template Missing\n**When:** Template not found\n**Question:** \"Template for [CONTRACT_TYPE] not found. How should I proceed?\"\n**Options:** Use basic placeholder structure, Skip this contract, Provide template now\n\n### Preview Phase (Optional)\n**When:** User requests preview or many placeholders expected\n**Question:** \"Would you like to preview what will be generated?\"\n**Shows:** Contracts list, expected placeholders, source sections\n\n### Missing Data Detected\n**When:** Significant gaps in ARCHITECTURE.md\n**Question:** \"ARCHITECTURE.md is missing key data for [CONTRACT_TYPE]. How should I proceed?\"\n**Options:** Generate with placeholders, Complete ARCHITECTURE.md first, Skip this contract\n\n### Completion Phase\n**When:** After generation\n**Prompt:** \"Review [X] documents in /compliance-docs/. [Y] placeholders require manual review.\"\n**Next Steps:** List sections needing completion, suggest ARCHITECTURE.md improvements\n\n## Data Extraction Strategies (Strict Source Traceability)\n\nThe skill uses ONLY three extraction strategies that reference actual ARCHITECTURE.md content:\n\n### 1. Direct Mapping (1:1)\n- Extract exact values from ARCHITECTURE.md without transformation\n- Source Reference Format: `Section X.Y, line Z`\n\n```\nARCHITECTURE.md Input:\n\"RTO: 4 hours, RPO: 1 hour\" (Section 11.3, line 1823)\n\nContract Output:\n**RTO**: 4 hours\n**RPO**: 1 hour\n**Source**: ARCHITECTURE.md Section 11.3, line 1823\n```\n\n### 2. Aggregation (Multiple Sources)\n- Collect related items from multiple locations and consolidate\n- Source Reference Format: `Sections X-Y, lines A-B` (consolidated)\n\n```\nARCHITECTURE.md Input:\nSection 7.1, line 1005: \"Integration: User Management (REST API)\"\nSection 7.2, line 1020: \"Integration: Payment Gateway (SOAP)\"\n\nContract Output:\n## Integration Catalog\n| System | Protocol | Source |\n|--------|----------|--------|\n| User Management | REST API | Section 7.1, line 1005 |\n| Payment Gateway | SOAP | Section 7.2, line 1020 |\n```\n\n### 3. Transformation (Reformatting/Calculation)\n- Convert, calculate, or reformat data from ARCHITECTURE.md\n- Source Reference Format: `Section X.Y, line Z (calculated: [formula])`\n- IMPORTANT: Transformations must show source data + calculation formula\n\n```\nARCHITECTURE.md Input:\n\"SLA: 99.99% uptime\" (Section 10.2, line 1576)\n\nContract Output:\n**Availability SLO**: 99.99%\n**Error Budget**: 43.2 minutes/month\n**Calculation**: (100% - 99.99%) × 43,200 min = 43.2 min\n**Source**: Section 10.2, line 1576 (calculated)\n```\n\n**Strict Validation Rule:**\n- If value CANNOT be found using Direct, Aggregation, or Transformation → mark as [PLACEHOLDER]\n- NO INFERENCE ALLOWED: Do not derive, guess, or infer values not explicitly stated in ARCHITECTURE.md\n- Exception: None. All data must trace back to actual ARCHITECTURE.md content.\n\n## Missing Data Handling - Strict Placeholder Format\n\n### When Data Cannot Be Extracted\n\nWhen data CANNOT be extracted using Direct, Aggregation, or Transformation strategies, use the following placeholder format:\n\n**Standard Placeholder Template:**\n```markdown\n**[Field Name]**: [PLACEHOLDER: Not specified in ARCHITECTURE.md Section X.Y]\nOptional Reference: [Industry standard or framework guidance - informational only]\nNote: Add [specific data point] to ARCHITECTURE.md Section X.Y ([Section Name] → [Subsection Name])\n```\n\n**Example 1: Missing RTO**\n```markdown\n**RTO (Recovery Time Objective)**: [PLACEHOLDER: Not specified in ARCHITECTURE.md Section 11.3]\nOptional Reference: Industry standard for Tier 1 applications: 4 hours RTO (NIST SP 800-34)\nNote: Add RTO value to ARCHITECTURE.md Section 11.3 (Operational Considerations → Backup and Recovery)\n```\n\n**Example 2: Missing Authentication Method**\n```markdown\n**Authentication Method**: [PLACEHOLDER: Not specified in ARCHITECTURE.md Section 9.1]\nOptional Reference: Common patterns: OAuth 2.0 + JWT (IETF RFC 6749), SAML 2.0, or mTLS\nNote: Add authentication approach to ARCHITECTURE.md Section 9.1 (Security Architecture → Authentication & Authorization)\n```\n\n**Example 3: Missing Encryption Standard**\n```markdown\n**Data Encryption at Rest**: [PLACEHOLDER: Not specified in ARCHITECTURE.md Section 9.2]\nOptional Reference: Industry standards: AES-256, TLS 1.3+ (FIPS 140-2 compliant)\nNote: Add encryption standards to ARCHITECTURE.md Section 9.2 (Security Architecture → Data Encryption)\n```\n\n**Placeholder Components:**\n1. **[PLACEHOLDER: ...]** - Clearly marks missing data\n2. **Section Reference** - Which ARCHITECTURE.md section should contain the data (Section X.Y)\n3. **Optional Reference** - Industry standard or framework guidance (informational, not prescriptive)\n4. **Note** - Specific guidance on where to add the data in ARCHITECTURE.md (Section → Subsection path)\n\n**Critical Rules:**\n- ❌ NEVER infer or derive values not in ARCHITECTURE.md\n- ❌ NEVER suggest specific values as if they were extracted\n- ✅ ALWAYS reference actual section locations (Section X.Y)\n- ✅ ALWAYS provide industry standards as optional reference (not requirements)\n- ✅ ALWAYS include subsection path for adding missing data\n\n### Completion Report\n\n**For Each Contract:**\n```\nContract: SRE Architecture\nCompleteness: 85% (17/20 data points)\nPlaceholders:\n1. Incident response team contacts (Section 11.2 missing)\n2. On-call rotation schedule (Section 11.2 missing)\n3. Runbook locations (Section 11.4 missing)\n\nRecommendations:\n- Add Section 11.2: Incident Management with team contacts\n- Add Section 11.4: Operational Runbooks with locations\n```\n\n## Integration with Existing Skills\n\n### With architecture-docs Skill\n\n**Dependencies:**\n- Reads ARCHITECTURE.md created by architecture-docs skill\n- Follows same 12-section structure\n- Uses same Document Index pattern (lines 1-50)\n- Respects same context-efficient loading strategies\n\n**Workflow:**\n```\n1. User creates/updates ARCHITECTURE.md (architecture-docs skill)\n2. User invokes: \"Generate compliance documents\" (architecture-compliance skill)\n3. Skill reads ARCHITECTURE.md sections incrementally\n4. Generates 10 compliance documents\n```\n\n### With architecture-readiness Skill\n\n**Dependencies:**\n- Product Owner Specifications provide business context\n- Business requirements feed into compliance contracts\n- Success criteria map to compliance requirements\n\n**Workflow:**\n```\n1. Product Owner creates PO Spec (architecture-readiness skill)\n2. Architecture team creates ARCHITECTURE.md (architecture-docs skill)\n3. Compliance team generates contracts (architecture-compliance skill)\n```\n\n### Referenced in CLAUDE.md\n\n**Project Guidelines Reference:**\n```markdown\n## Architecture Workflow\n\n1. Business Requirements (architecture-readiness skill)\n   → Creates: PRODUCT_OWNER_SPEC.md\n\n2. Technical Architecture (architecture-docs skill)\n   → Creates: ARCHITECTURE.md\n\n3. Compliance Documentation (architecture-compliance skill)\n   → Creates: 10 compliance contracts in /compliance-docs/\n```\n\n## Edge Cases and Error Handling\n\n### ARCHITECTURE.md Not Found\n```\nError: \"ARCHITECTURE.md not found in current directory, parent, or /docs.\"\nAction: Ask user for file location or suggest creating one with architecture-docs skill\n```\n\n### Invalid Structure\n```\nError: \"ARCHITECTURE.md does not follow 12-section standard structure.\"\nAction: Suggest running architecture-docs skill to validate/fix structure\n```\n\n### Template Not Found\n```\nWarning: \"Template for [CONTRACT_TYPE] not found.\"\nAction: Ask user if they want to (1) use basic structure, (2) provide template, or (3) skip\n```\n\n### Empty Section\n```\nWarning: \"Section 11 (Operational) is empty or missing.\"\nAction: Flag affected contracts, generate with placeholders, list in completion report\n```\n\n### Multiple ARCHITECTURE.md Files\n```\nQuestion: \"Multiple ARCHITECTURE.md files found. Which one?\"\nAction: Present list, ask user to select\n```\n\n### Output Directory Permissions\n```\nError: \"Cannot write to /compliance-docs/ (permission denied).\"\nAction: Ask user for alternative location or fix permissions\n```\n\n## Best Practices\n\n### Before Generation\n1. **Ensure ARCHITECTURE.md is complete** - Run architecture-docs skill first\n2. **Validate structure** - Check for 12-section standard format\n3. **Review Section 11** - Most contracts need operational data\n4. **Check for metrics** - SLOs, SLAs, RTO/RPO critical for many contracts\n\n### During Generation\n1. **Load incrementally** - Don't load entire ARCHITECTURE.md\n2. **Cache extracted data** - Reuse across multiple contracts\n3. **Preserve source references** - Track section and line numbers\n4. **Flag all gaps** - Use [PLACEHOLDER] for missing data\n\n### After Generation\n1. **Review placeholders** - Complete manual data entry\n2. **Validate accuracy** - Check extracted data against ARCHITECTURE.md\n3. **Update templates** - Refine templates based on actual organizational requirements\n4. **Iterate ARCHITECTURE.md** - Improve source document to reduce placeholders\n\n## Examples\n\n### Example 1: Generate All Compliance Documents\n\n**User Request:**\n```\nUser: \"Generate all compliance documents for this project\"\n```\n\n**Skill Actions:**\n```\n1. Locate ARCHITECTURE.md in current directory\n2. Load Document Index (lines 1-50)\n3. Validate 12-section structure ✓\n4. Confirm: \"Generate all 10 compliance contracts?\"\n5. User confirms\n6. For each of 10 contracts:\n   - Identify required sections\n   - Load sections incrementally\n   - Extract data\n   - Apply template\n   - Generate document\n7. Save to /compliance-docs/\n8. Generate COMPLIANCE_MANIFEST.md\n9. Report: \"10 contracts generated. 20 placeholders require review.\"\n```\n\n### Example 2: Generate Specific Contract\n\n**User Request:**\n```\nUser: \"Create SRE Architecture contract\"\n```\n\n**Skill Actions:**\n```\n1. Locate ARCHITECTURE.md\n2. Load Document Index (lines 1-50)\n3. Identify contract: SRE Architecture\n4. Required sections: 10, 11\n5. Load Section 10 (lines 1550-1760)\n6. Extract: SLOs (p95 < 100ms, p99 < 200ms), throughput (450 TPS)\n7. Load Section 11 (lines 1760-1950)\n8. Extract: Monitoring (Prometheus, Grafana), incidents (PagerDuty)\n9. Apply template: templates/TEMPLATE_SRE_ARCHITECTURE.md\n10. Generate: SRE_ARCHITECTURE_JobScheduler_2025-11-26.md\n11. Report: \"SRE contract generated. 2 placeholders (on-call rotation, runbooks).\"\n```\n\n### Example 3: Generate by Category\n\n**User Request:**\n```\nUser: \"Generate security compliance documentation\"\n```\n\n**Skill Actions:**\n```\n1. Locate ARCHITECTURE.md\n2. Parse category: \"security\"\n3. Map to contract: Security Architecture\n4. Confirm: \"Generate Security Architecture contract?\"\n5. User confirms\n6. Generate Security Architecture:\n   - Load Section 9 (Security Considerations)\n   - Extract: API security, authentication, encryption\n   - Apply template\n7. Save to /compliance-docs/\n8. Report: \"Security Architecture contract generated.\"\n```\n\n## Template Placeholder Conventions\n\n### Standard Placeholders\n\n**Project Information:**\n- `[PROJECT_NAME]` - Extracted from ARCHITECTURE.md title (Section 1)\n- `[GENERATION_DATE]` - Current date in YYYY-MM-DD format (use `date +%Y-%m-%d` bash command)\n- `[DOCUMENT_OWNER]` - Extracted from ARCHITECTURE.md metadata or [PLACEHOLDER]\n\n**Extracted Values:**\n- `[EXTRACTED_VALUE]` - Actual data from ARCHITECTURE.md with source reference\n- `[SOURCE_REFERENCE]` - Format: \"Section X, line Y\" or \"Sections X-Y, lines A-B\"\n\n**Calculated Values (Transformation):**\n- `[CALCULATED: formula]` - Mathematical calculation from explicit source data\n- Must show source data + calculation formula + source reference\n- Example: `[CALCULATED: (100% - 99.99%) × 43,200 min = 43.2 min/month from Section 10.2, line 1576]`\n\n**Missing Data:**\n- `[PLACEHOLDER: Not specified in ARCHITECTURE.md Section X.Y]` - Data not found, needs manual input\n- Must include: section reference + optional industry standard + note with subsection path\n\n### Example Template Excerpt\n\n```markdown\n# Compliance Contract: SRE Architecture\n\n**Project**: [PROJECT_NAME]\n**Generated**: [GENERATION_DATE]\n**Source**: ARCHITECTURE.md (Sections 10, 11)\n**Version**: 2.0\n\n---\n\n## 1. Service Level Objectives\n\n### 1.1 Availability SLO\n**Target**: [EXTRACTED_VALUE from Section 10.2, line 1576]\n**Error Budget**: [CALCULATED: (100% - 99.99%) × 43,200 min = 43.2 min/month from Section 10.2, line 1576]\n**Monitoring**: [EXTRACTED_VALUE from Section 11.1, line 1780]\n\n### 1.2 Latency SLOs\n**p95**: [EXTRACTED_VALUE from Section 10.1, line 1558]\n**p99**: [EXTRACTED_VALUE from Section 10.1, line 1559]\n\n[If missing]\n**p95**: [PLACEHOLDER: Not specified in ARCHITECTURE.md Section 10.1]\nOptional Reference: Industry standard for user-facing APIs: p95 < 100ms\nNote: Add p95 latency target to ARCHITECTURE.md Section 10.1 (Scalability & Performance → Performance Targets)\n```\n\n## External Validation System (All Contract Types)\n\n### Overview\n\nAll compliance contracts include **automatic validation** using external configuration files. This standardized validation system evaluates compliance against contract-specific criteria and generates a **0-10 score** that determines document approval status. This eliminates manual validation and provides consistent, auditable compliance assessment.\n\n### Validation Configuration Files\n\n**Location**: `/skills/architecture-compliance/validation/`\n\n**Format**: JSON configuration files (one per contract type)\n\n**Examples**:\n- `development_architecture_validation.json` (26 validation items for tech stack)\n- `security_architecture_validation.json` (security controls and compliance)\n- `cloud_architecture_validation.json` (cloud best practices)\n- `sre_architecture_validation.json` (reliability and observability)\n- ...and 7 more (10 total)\n\n**Schema**: `VALIDATION_SCHEMA.json` defines the structure for all validation configs\n\n### Validation States\n\n- **PASS (10 points)**: Item complies with requirements\n- **FAIL (0 points)**: Non-compliant, deprecated, or unapproved\n- **N/A (10 points)**: Not applicable to this architecture\n- **UNKNOWN (0 points)**: Missing data in ARCHITECTURE.md (forces completeness)\n- **EXCEPTION (10 points)**: Documented exception via LADES2 process (fully compliant)\n\n### Scoring System (0-10 Scale)\n\n**Score Calculation**:\n```\nFinal Score = (Completeness × weight) + (Compliance × weight) + (Quality × weight)\n\nWhere:\n- Completeness = (Filled required fields / Total required) × 10\n- Compliance = (PASS + N/A + EXCEPTION items / Total applicable) × 10\n- Quality = Source traceability coverage (0-10)\n- Weights = Template-specific (defined in validation config):\n  - Most templates: Completeness 40%, Compliance 50%, Quality 10%\n  - Security/SRE/Integration: Completeness 30%, Compliance 60%, Quality 10% (compliance-focused)\n  - Business Continuity: Completeness 50%, Compliance 40%, Quality 10% (completeness-focused)\n  - Cloud Architecture: Completeness 35%, Compliance 55%, Quality 10% (balanced)\n  - See individual validation config files for exact weights per template\n```\n\n**Outcome Tiers**:\n- **8.0-10.0**: AUTO_APPROVE → Status: \"Approved\", Actor: \"System (Auto-Approved)\"\n- **7.0-7.9**: MANUAL_REVIEW → Status: \"In Review\", Actor: [Approval Authority]\n- **5.0-6.9**: NEEDS_WORK → Status: \"Draft\", Actor: \"Architecture Team\"\n- **0.0-4.9**: REJECT → Status: \"Rejected\", Actor: \"N/A (Blocked)\"\n\n### Validation Process\n\n**Step 1: Load Configuration**\n- Read validation config JSON for contract type\n- Parse thresholds, weights, validation items, approval authority\n\n**Step 2: Evaluate Items**\n- For each validation item in config, evaluate against ARCHITECTURE.md data\n- Collect evidence with source references (Section X.Y, line Z)\n- Assign status: PASS, FAIL, N/A, UNKNOWN, or EXCEPTION\n\n**Step 3: Calculate Scores**\n- Item scores based on status (PASS=10, FAIL=0, etc.)\n- Section scores: weighted average of item scores\n- Completeness, Compliance, Quality scores\n- Final score using weighted formula\n\n**Step 4: Determine Outcome**\n- Map final score to outcome tier\n- Set document status, validation status, review actor\n- Generate recommendations for FAIL/UNKNOWN items\n\n**Step 5: Cache Results**\n- Store validation_results object for document generation\n- Include final score, outcome, breakdown, recommendations\n\n### Template Integration\n\nValidation results populate the Document Control section in generated compliance documents:\n\n**Document Control Table**:\n```markdown\n| Status | In Review |\n| Validation Score | 7.8/10 |\n| Validation Status | PASS |\n| Validation Date | 2025-12-07 |\n| Validation Evaluator | Claude Code (Automated Validation Engine) |\n| Review Actor | Technical Architecture Review Board |\n| Approval Authority | Technical Architecture Review Board |\n```\n\n**Validation Requirements**:\n- Validation score ≥ 7.0 MANDATORY for approval pathway\n- Score 8.0-10.0: Automatic approval (no human review required)\n- Score 7.0-7.9: Manual review by [Approval Authority] required\n- Score 5.0-6.9: Must address gaps before proceeding to review\n- Score < 5.0: Contract rejected, cannot proceed\n\n**Contract-Specific Content**:\n- Development Architecture: LADES1.6 section with detailed stack validation results\n- Security Architecture: Security controls compliance assessment\n- SRE Architecture: SLO/SLI compliance and monitoring coverage\n- Other contracts: Domain-specific validation details as defined in their configs\n\n### Benefits of External Validation\n\n1. **Maintainability**: Validation logic separated from templates and code\n2. **Consistency**: All 10 contracts use the same validation schema and scoring methodology\n3. **Transparency**: Numeric scores (0-10) provide granular feedback vs binary PASS/FAIL\n4. **Automation**: Clear thresholds for automatic approval (8.0+) vs manual review (7.0-7.9)\n5. **Extensibility**: Easy to add/modify validation items without changing templates\n6. **Auditability**: Validation configs are versioned and traceable\n7. **Flexibility**: Each contract can define custom weights while maintaining standard scoring\n\n### Performance\n\n- **Context overhead**: ~6,000 tokens per contract (3.5K prompt + 2.5K response)\n- **Leverages cached data**: Uses sections already extracted in Step 3.4\n- **No additional loading**: Validation uses cached ARCHITECTURE.md content\n- **Efficient scoring**: JSON-based config parsing is fast and deterministic\n\n### Approval Workflow\n\n- **PASS**: Contract approval unblocked, document can move to \"Approved\" status\n- **FAIL**: Contract approval blocked, document must remain \"Draft\" until remediation\n- **Remediation**: Address failures via LADES2 (exception and action plan) or update Section 8\n\n### Benefits\n\n1. **Eliminates manual work**: Automatic validation saves 30-60 minutes per document\n2. **Consistent evaluation**: Same 26 criteria applied uniformly every time\n3. **Immediate feedback**: Know stack compliance instantly when generating docs\n4. **Actionable reports**: FAIL cases include specific failures, evidence, recommendations\n5. **Audit trail**: Validation date, evaluator, results documented\n6. **Quality gate**: Non-compliant stacks cannot bypass validation\n\n---\n\n## Conclusion\n\nThis skill provides a systematic approach to generating compliance documentation from ARCHITECTURE.md, ensuring:\n\n- **Context efficiency** (70-80% reduction in loaded content)\n- **Data traceability** (all extractions reference source)\n- **Gap visibility** (all missing data clearly flagged)\n- **Automatic validation** (Development Architecture stack validation)\n- **Incremental improvement** (templates evolve with organizational requirements)\n- **Integration** (seamless workflow with architecture-docs and architecture-readiness skills)\n\nFor detailed mapping strategies and contract-specific guidance, refer to COMPLIANCE_GENERATION_GUIDE.md and SECTION_MAPPING_GUIDE.md."
              },
              {
                "name": "architecture-docs",
                "description": "Use this skill when creating, updating, or maintaining ARCHITECTURE.md files, when users ask about \"my architecture documentation\" or \"architecture\", when generating presentations/slides/PowerPoint from architecture documentation, when generating diagrams from architecture documentation, when validating/checking/auditing architecture (including BIAN alignment, META layers, standards compliance), or when answering questions about documented components, data structures, integrations, security, performance, deployment, technology stack, or architectural decisions",
                "path": "skills/architecture-docs/SKILL.md",
                "frontmatter": {
                  "name": "architecture-docs",
                  "description": "Use this skill when creating, updating, or maintaining ARCHITECTURE.md files, when users ask about \"my architecture documentation\" or \"architecture\", when generating presentations/slides/PowerPoint from architecture documentation, when generating diagrams from architecture documentation, when validating/checking/auditing architecture (including BIAN alignment, META layers, standards compliance), or when answering questions about documented components, data structures, integrations, security, performance, deployment, technology stack, or architectural decisions"
                },
                "content": "# Architecture Documentation Skill\n\nThis skill provides comprehensive guidelines for creating and maintaining ARCHITECTURE.md files using the standardized template from ARCHITECTURE_DOCUMENTATION_GUIDE.md.\n\n## When This Skill is Invoked\n\nAutomatically activate when:\n- User asks to create architecture documentation\n- User asks to update or edit ARCHITECTURE.md\n- User mentions documenting system architecture\n- User requests architecture review, audit, or analysis (triggers Design Drivers calculation prompt)\n- User explicitly asks to \"calculate design drivers\" or \"update design drivers\"\n- User asks about architecture documentation structure or best practices\n- User edits Section 1 Executive Summary Key Metrics (triggers metric consistency check)\n- User requests metric consistency check, verify metrics, or audit metrics\n- **User asks informational questions about the documented architecture** (if ARCHITECTURE.md exists)\n  - \"What is our [authentication/scaling/data flow/etc.] approach?\"\n  - \"How does [component/system/integration] work?\"\n  - \"What technologies do we use for [purpose]?\"\n  - \"Tell me about the architecture of [system]\"\n- **User asks to generate, create, or add diagrams to architecture documentation** (triggers Workflow 9)\n  - \"Generate my architecture diagrams\"\n  - \"Create Mermaid diagrams from ARCHITECTURE.md\"\n  - \"Add diagrams to my architecture\"\n\n### Query Pattern Triggers\n\nThis skill automatically activates when users ask questions about documented architecture, including:\n\n**Reference Patterns**:\n- \"According to my architecture documentation...\"\n- \"Based on the architecture...\"\n- \"What does the architecture use/require/implement for...\"\n- \"My architecture documentation shows/says...\"\n- \"The architecture specifies/defines...\"\n- \"Check/Validate/Verify the architecture [aspect]...\"\n- \"Audit the [architecture component/pattern]...\"\n\n**Technical Query Keywords**:\n- **Components**: \"components\", \"services\", \"modules\", \"microservices\", \"systems\"\n- **Data**: \"data structures\", \"data flow\", \"database\", \"schema\", \"models\", \"entities\"\n- **Integration**: \"APIs\", \"integrations\", \"external systems\", \"endpoints\", \"interfaces\"\n- **Security**: \"authentication\", \"authorization\", \"encryption\", \"security\", \"compliance\"\n- **Performance**: \"scaling\", \"performance\", \"SLA\", \"capacity\", \"throughput\", \"latency\"\n- **Deployment**: \"deployment\", \"cloud provider\", \"infrastructure\", \"environments\", \"regions\"\n- **Technology**: \"tech stack\", \"languages\", \"frameworks\", \"tools\", \"libraries\", \"versions\"\n- **Decisions**: \"why choose\", \"decision\", \"trade-offs\", \"alternatives\", \"ADR\", \"rationale\"\n- **Validation**: \"check\", \"validate\", \"verify\", \"audit\", \"alignment\", \"BIAN\", \"META\", \"service domain\", \"layer\", \"standards\", \"compliance check\"\n\n**Multi-section Queries**:\n- Questions requiring synthesis across multiple sections\n- Cross-cutting concerns (e.g., \"How does authentication work with external systems?\")\n- Implementation details spanning components, data, and deployment\n\n---\n\n## 🎯 AUTOMATIC WORKFLOW DETECTION\n\n**IMPORTANT**: Immediately upon skill invocation, analyze the user's request to detect their intent.\n\n### Detection Logic\n\nCheck the user's original message (before `/architecture-docs` was invoked) for these patterns:\n\n#### Workflow 8: Presentation Generation\n**Triggers:**\n- Keywords: \"generate\", \"create\", \"make\" + \"presentation\", \"slides\", \"PowerPoint\", \"pptx\", \"deck\"\n- Examples: \"generate presentations\", \"create slides\", \"make PowerPoint\"\n- Stakeholder mentions: \"business presentation\", \"architecture slides\", \"compliance deck\"\n- Language: \"presentación en español\", \"slides in English\"\n\n**Action when detected:**\n1. Confirm: \"I'll help you generate architecture presentations.\"\n2. Jump directly to **Workflow 8, Step 1** (Stakeholder Type Selection)\n3. Do NOT ask which workflow - proceed automatically\n\n#### Workflow 9: Diagram Generation\n**Triggers:**\n- Keywords: \"generate\", \"create\", \"add\", \"update\", \"make\" + \"diagram\", \"diagrams\", \"Mermaid diagram\", \"architecture diagram\"\n- Examples: \"generate my architecture diagrams\", \"create diagrams from ARCHITECTURE.md\", \"add diagrams to my architecture\"\n- Section-specific: \"generate diagrams for Section 4\", \"create data flow diagrams\"\n- Format mentions: \"Mermaid diagrams\", \"visual diagrams\", \"architecture diagrams\"\n\n**Action when detected:**\n1. Confirm: \"I'll help you generate architecture diagrams.\"\n2. Jump directly to **Workflow 9, Step 1** (Diagram Type Selection)\n3. Do NOT ask which workflow - proceed automatically\n\n#### Other Workflows\nIf the user's request matches other documented workflows (1-7, 9-10), follow their respective trigger patterns.\n\n### If No Pattern Matches\n\nIf the user's request doesn't match any workflow triggers:\n1. Acknowledge the skill invocation\n2. Ask which workflow they want to use\n3. Provide brief description of available workflows\n\n---\n\n## File Naming Convention\n\n**IMPORTANT**: All architecture documents MUST be named **ARCHITECTURE.md**\n\n- When creating a new architecture document, always use the filename: `ARCHITECTURE.md`\n- When updating existing architecture, work with the file: `ARCHITECTURE.md`\n- Do NOT use alternative names like: architecture.md, ARCH.md, system-architecture.md, etc.\n- Each project/system should have ONE primary ARCHITECTURE.md file\n\n### Location\n- Place ARCHITECTURE.md in the root of the project or in a `/docs` directory\n- For multi-project repositories, each project subdirectory gets its own ARCHITECTURE.md\n\n## Working with ARCHITECTURE.md - Context Optimization\n\n**IMPORTANT**: When working with ARCHITECTURE.md, optimize for context by loading sections incrementally, NOT the entire document at once.\n\n### Context-Efficient Workflow\n\n1. **Initial Assessment**\n   - Read ONLY lines 1-50 of ARCHITECTURE.md to locate the **Document Index**\n   - The Document Index provides exact line ranges for each section\n   - Use the index to plan which sections need work\n   - Identify which specific section(s) need work\n\n2. **Section-Based Editing**\n   - Use the Document Index to find exact line ranges for your target section\n   - Use the Read tool with `offset` and `limit` parameters to load ONLY the relevant section\n   - **Add context buffer**: Read ±10-20 lines beyond the section boundaries\n   - Work on one section at a time\n   - Example: Index shows Section 5 is lines 601-850, read lines 590-860 (with 10-line buffer)\n\n3. **Incremental Updates**\n   - Make edits to individual sections using the Edit tool\n   - Avoid reading the full document unless absolutely necessary\n   - For multi-section updates, work sequentially section by section\n   - Update the Document Index line ranges if section size changes significantly\n\n4. **Verification**\n   - After edits, read ONLY the modified section to verify changes\n   - Use Grep to search for specific content without loading full file\n   - Update \"Index Last Updated\" date in the Document Index after major changes\n\n### Using the Document Index\n\n**Every ARCHITECTURE.md should include a Document Index** (before Section 1) with exact line ranges.\n\n**Index Format Example:**\n```markdown\n## Document Index\n\n**Quick Navigation:**\n- [Section 1: Executive Summary](#1-executive-summary) → Lines 1-80\n- [Section 2: System Overview](#2-system-overview) → Lines 81-150\n- [Section 3: Architecture Principles](#3-architecture-principles) → Lines 151-350\n- [Section 4: Architecture Layers](#4-architecture-layers) → Lines 351-600\n- [Section 5: Component Details](#5-component-details) → Lines 601-850\n- [Section 6: Data Flow Patterns](#6-data-flow-patterns) → Lines 851-1000\n- [Section 7: Integration Points](#7-integration-points) → Lines 1001-1150\n- [Section 8: Technology Stack](#8-technology-stack) → Lines 1151-1300\n- [Section 9: Security Architecture](#9-security-architecture) → Lines 1301-1550\n- [Section 10: Scalability & Performance](#10-scalability--performance) → Lines 1551-1750\n- [Section 11: Operational Considerations](#11-operational-considerations) → Lines 1751-1950\n- [Section 12: Architecture Decision Records (ADRs)](#12-architecture-decision-records-adrs) → Lines 1951-end\n\n**Index Last Updated:** YYYY-MM-DD\n```\n\n**How to Use the Index:**\n\n1. **Find the Index**: Read lines 1-50 to locate the Document Index\n2. **Identify Target Section**: Check the index for exact line ranges\n3. **Load with Context Buffer**: Read target section ± 10-20 lines for context preservation\n4. **Example**:\n   ```\n   # To edit Section 5 (Component Details):\n   # Index shows: Lines 601-850\n   # Load with 10-line buffer:\n   Read(file_path=\"ARCHITECTURE.md\", offset=590, limit=270)\n   # This reads lines 590-860\n   ```\n\n**Context Buffer Guidelines:**\n\n| Edit Type | Buffer Size | Use Case |\n|-----------|-------------|----------|\n| **Minimal** | ±5-10 lines | Small edits (single paragraph, config value) |\n| **Standard** | ±10-20 lines | Section edits (rewriting subsection, adding components) |\n| **Extended** | ±20-50 lines | Cross-section edits (changes referencing adjacent sections) |\n\n**Maintaining the Index:**\n\nAfter significant edits:\n1. Use `grep -n \"^## [0-9]\" ARCHITECTURE.md` to find actual section line numbers\n2. Update the Document Index with current line ranges\n3. Update \"Index Last Updated\" date\n4. Verify index accuracy periodically (quarterly reviews)\n\n**Note**: The Document Index is part of the ARCHITECTURE_DOCUMENTATION_GUIDE.md template and should be included in all new ARCHITECTURE.md files.\n\n---\n\n## Architecture Type Selection Workflow\n\n**PURPOSE**: When creating a new ARCHITECTURE.md, prompt the user to select their architecture type. This determines the structure and content of Section 4 (Meta Architecture) and Section 5 (Component Details).\n\n### When to Trigger\n\n**Activate this workflow when:**\n- ✅ User asks to create a NEW ARCHITECTURE.md document\n- ✅ User explicitly requests to \"change architecture type\" or \"select architecture type\"\n- ✅ User is updating an existing ARCHITECTURE.md and mentions changing from one architecture type to another\n\n**Skip this workflow when:**\n- ❌ Editing an existing ARCHITECTURE.md (type already selected)\n- ❌ User is only updating specific sections unrelated to architecture type\n- ❌ Document type is already clear from context\n\n### Available Architecture Types\n\n1. **Microservices Architecture (Recommended)** - Cloud-native distributed systems with independent services\n2. **META Architecture** - 6-layer enterprise model (Channels → UX → Business Scenarios → Business → Domain → Core) with [BIAN V12.0](https://bian.org/servicelandscape-12-0-0/views/view_51891.html) alignment for Layer 5 Domain service domains\n3. **3-Tier Architecture** - Classic web application pattern (Presentation → Application/Business Logic → Data)\n4. **N-Layer Architecture** - Customizable patterns (DDD, Clean Architecture, Hexagonal)\n5. **BIAN Architecture** - 5-layer BIAN-compliant model (Channels → BIAN Business Scenarios → BIAN Business Capabilities → BIAN Service Domains → Core Systems) with full [BIAN V12.0](https://bian.org/servicelandscape-12-0-0/views/view_51891.html) compliance across layers 2-4\n\n**BIAN Standard for META**: BIAN V12.0 is the default and recommended version for META architecture. Use the [BIAN Service Landscape V12.0](https://bian.org/servicelandscape-12-0-0/views/view_51891.html) to identify and define service domains for Layer 5 (Domain).\n\n### Workflow Steps\n\n#### Step 1: Present Architecture Type Options\n\nWhen creating a new ARCHITECTURE.md, present the user with architecture type selection:\n\n```markdown\n📐 **Architecture Type Selection**\n\nBefore creating your ARCHITECTURE.md, please select the architecture type that best describes your system:\n\n**1. Microservices Architecture (Recommended)** (Cloud-Native Distributed)\n   - Best for: Cloud-native systems, independently deployable services, modern applications\n   - Components: API Gateway → Services → Data Stores → Event Bus\n   - Complexity: High\n   - Team Size: Large (10+)\n   - Why Recommended: Industry standard for scalable, resilient modern applications\n\n**2. META Architecture** (6-Layer Enterprise)\n   - Best for: Large enterprise systems, financial services, complex integrations\n   - Layers: Channels → UX → Business Scenarios → Integration → Domain → Core\n   - Complexity: Very High\n   - Team Size: Large (10+)\n\n**3. 3-Tier Architecture** (Classic Web Application)\n   - Best for: Web apps, REST APIs, standard CRUD systems\n   - Tiers: Presentation → Application/Business Logic → Data\n   - Complexity: Low\n   - Team Size: Small-Medium (2-8)\n\n**4. N-Layer Architecture** (Customizable Patterns)\n   - Best for: DDD, Clean Architecture, Hexagonal Architecture\n   - Patterns: 4-Layer DDD, 5-Layer Extended, Clean Architecture, Hexagonal\n   - Complexity: Medium-High\n   - Team Size: Medium (4-10)\n\n**5. BIAN Architecture** (5-Layer BIAN-Compliant)\n   - Best for: Banking systems requiring BIAN V12.0 certification, full BIAN compliance\n   - Layers: Channels → BIAN Business Scenarios → BIAN Business Capabilities → BIAN Service Domains → Core Systems\n   - Complexity: Very High\n   - Team Size: Large (10+)\n   - BIAN Compliance: Full BIAN V12.0 across layers 2-4\n\nFor detailed comparison and decision guidance, refer to: `templates/ARCHITECTURE_TYPE_SELECTOR.md`\n\n**Which architecture type best describes your system? (1-5, or type name)**\n\nNote: Option 1 (Microservices) is recommended for most modern cloud-native applications.\n```\n\n#### Step 2: Capture User Selection\n\nWait for user response (1, 2, 3, 4, or 5) or architecture type name.\n\n**Valid inputs:**\n- Numeric: `1`, `2`, `3`, `4`, `5`\n- Type names: `Microservices`, `META`, `3-Tier`, `N-Layer`, `BIAN`\n- Variations: `microservices`, `meta`, `three-tier`, `n-layer`, `bian`\n\n**If user is unsure:**\n- Offer to load `templates/ARCHITECTURE_TYPE_SELECTOR.md` decision guide\n- Provide quick decision tree questions\n- Default to **Microservices (Recommended)** for modern cloud-native systems\n- Default to **META** if user has enterprise requirements and regulatory compliance needs\n- Default to **3-Tier** if user wants maximum simplicity and minimal operational complexity\n\n#### Step 3: Load Type-Specific Templates\n\nBased on user selection, load the appropriate templates:\n\n| Selection | Section 4 Template | Section 5 Template |\n|-----------|-------------------|-------------------|\n| Microservices (1) | `templates/SECTION_4_MICROSERVICES.md` | `templates/SECTION_5_MICROSERVICES.md` |\n| META (2) | `templates/SECTION_4_META.md` | `templates/SECTION_5_META.md` |\n| 3-Tier (3) | `templates/SECTION_4_3TIER.md` | `templates/SECTION_5_3TIER.md` |\n| N-Layer (4) | `templates/SECTION_4_NLAYER_PATTERNS.md` | *(Use generic component template)* |\n| BIAN (5) | `templates/SECTION_4_BIAN.md` | `templates/SECTION_5_BIAN.md` |\n\n**Loading Process:**\n1. Read the appropriate Section 4 template file\n2. Read the appropriate Section 5 template file (if exists)\n3. Extract template content (excluding metadata comments)\n4. Prepare for insertion into ARCHITECTURE.md at correct section boundaries\n\n#### Step 4: Add Architecture Type Metadata\n\nWhen creating the ARCHITECTURE.md, add an HTML comment metadata tag at the beginning of Section 4 to track the selected architecture type:\n\n```html\n<!-- ARCHITECTURE_TYPE: META -->\n```\n\n**Valid metadata values:**\n- `<!-- ARCHITECTURE_TYPE: META -->`\n- `<!-- ARCHITECTURE_TYPE: 3-TIER -->`\n- `<!-- ARCHITECTURE_TYPE: MICROSERVICES -->`\n- `<!-- ARCHITECTURE_TYPE: N-LAYER -->`\n- `<!-- ARCHITECTURE_TYPE: BIAN -->`\n\n**Purpose:**\n- Enables type detection for future edits\n- Used by validation rules\n- Used by Design Drivers calculation\n- Used by architecture compliance skill\n\n#### Step 5: Create ARCHITECTURE.md with Type-Specific Content\n\nCreate the complete ARCHITECTURE.md using:\n- Standard sections 1-3 (same for all types)\n- Type-specific Section 4 (from loaded template)\n- Type-specific Section 5 (from loaded template)\n- Standard sections 6-12 (same for all types)\n\n**Include:**\n- Document Index (placeholder line ranges)\n- Architecture type metadata comment in Section 4\n- All template content properly formatted\n- Placeholder values for customization\n\n#### Step 6: Prompt for ADR Generation (Optional)\n\n**Trigger**: Immediately after Step 5 completes successfully (ARCHITECTURE.md created)\n\n**Objective**: Offer to generate ADR files from Section 12 table\n\n---\n\n##### Step 6.0: Present ADR Generation Prompt\n\nAfter ARCHITECTURE.md is successfully created, display the following prompt:\n\n```\n✅ ARCHITECTURE.md created successfully!\n\n═══════════════════════════════════════════════════════════\n📋 Architecture Decision Records (ADRs) Setup\n═══════════════════════════════════════════════════════════\n\nSection 12 of your ARCHITECTURE.md includes an ADR table with placeholder\nentries. I can automatically generate these ADR files using the standard\nADR template.\n\nWould you like me to generate the ADR files now?\n\nOptions:\n1. [Yes - Generate ADRs] - Create all ADR files listed in Section 12\n2. [Preview First] - Show me which ADRs will be created\n3. [No Thanks] - I'll create them manually later\n4. [Learn More] - Tell me about ADRs and the template\n\nRecommended: Option 1 (Generate ADRs) - Saves time and ensures consistency\n```\n\n**Wait for user response**: `1`, `2`, `3`, `4`, or keywords like \"yes\", \"preview\", \"no\", \"learn more\"\n\n---\n\n##### Step 6.1: Handle User Selection\n\n**If user selects Option 1 (Yes - Generate ADRs)**:\n- Proceed to Step 6.2 (Locate Section 12)\n\n**If user selects Option 2 (Preview First)**:\n- Proceed to Step 6.2 (Locate Section 12)\n- After Step 6.3 (Extract ADR List), show preview\n- Re-prompt: \"Proceed with generation? (yes/no)\"\n- If yes: Continue to Step 6.4\n- If no: Skip to Step 6.8 (Complete)\n\n**If user selects Option 3 (No Thanks)**:\n- Skip to Step 6.8 (Complete with skip message)\n\n**If user selects Option 4 (Learn More)**:\n- Show ADR information:\n\n```\nArchitecture Decision Records (ADRs) document important architectural choices,\nproviding context for future team members and explaining the \"why\" behind\ntechnical decisions.\n\n**What ADRs Document**:\n- Technology selection rationale\n- Architecture pattern choices\n- Trade-offs and alternatives considered\n- Consequences of decisions\n\n**ADR Template Structure**:\n- Context: Problem statement and requirements\n- Decision: What was decided\n- Rationale: Why this choice was made\n- Consequences: Positive/negative outcomes\n- Alternatives: Options that were considered but rejected\n\n**Template Location**: skills/architecture-docs/adr/ADR-000-template.md\n**Guide**: skills/architecture-docs/ADR_GUIDE.md\n\nWould you like me to generate the ADR files now? (yes/no)\n```\n\n- Re-prompt with Options 1-3\n- Wait for new response\n\n---\n\n##### Step 6.2: Locate Section 12\n\n**Method 1: Use Document Index** (preferred)\n\n```bash\n# Read Document Index to find Section 12 line range\ngrep -A 20 \"^## Document Index\" ARCHITECTURE.md | grep \"Section 12\"\n```\n\n**Expected output**: `- [Section 12: Architecture Decision Records (ADRs)](#12-architecture-decision-records-adrs) → Lines 1750-1800`\n\n**Parse line range**: Extract start line `1750` and end line `1800`\n\n**Method 2: Fallback - Find by Header**\n\nIf Document Index method fails:\n\n```bash\n# Find Section 12 header line number\ngrep -n \"^## 12\\. Architecture Decision Records\" ARCHITECTURE.md\n```\n\n**Expected output**: `1750:## 12. Architecture Decision Records (ADRs)`\n\n**Parse line number**: Extract `1750`\n\n**Read until**: Next section header or end of file (typically 50-100 lines)\n\n**Error Handling**: If Section 12 not found:\n\n```\n⚠️  Section 12: Architecture Decision Records not found in ARCHITECTURE.md\n\nThis is unusual - all ARCHITECTURE.md files should include Section 12.\n\nWould you like me to:\n1. [Add Section 12] - Add the section with empty ADR table\n2. [Skip ADR Generation] - Continue without generating ADRs\n3. [Manual Review] - Let me check the document structure first\n\nRecommended: Option 3 (Manual Review)\n```\n\n---\n\n##### Step 6.3: Extract ADR List from Section 12\n\n**Read Section 12 content**:\n\n```bash\n# Using Read tool with line range from Step 6.2\nRead(file_path=\"ARCHITECTURE.md\", offset=1750, limit=50)\n```\n\n**Parse ADR table rows**:\n\n```bash\n# Extract ADR table rows using grep\ngrep -E \"^\\| \\[ADR-\" ARCHITECTURE.md\n```\n\n**Expected output** (example):\n```\n| [ADR-001](adr/ADR-001.md) | [Title] | Accepted | YYYY-MM-DD | High/Medium/Low |\n| [ADR-002](adr/ADR-002-database.md) | Database Choice | Proposed | 2024-01-20 | High |\n```\n\n**Parse each row**:\n\nFor each line matching the pattern `^\\| \\[ADR-`:\n1. Extract ADR number: `001`, `002`, etc. (from `[ADR-001]`)\n2. Extract file path from link: `adr/ADR-001.md` (from `(adr/ADR-001.md)`)\n3. Extract slug (if present): `` (empty) or `database` (from `ADR-002-database.md`)\n4. Extract title: Column 2 (e.g., `[Title]` or `Database Choice`)\n5. Extract status: Column 3 (e.g., `Accepted`, `Proposed`)\n6. Extract date: Column 4 (e.g., `YYYY-MM-DD` or `2024-01-20`)\n7. Extract impact: Column 5 (e.g., `High/Medium/Low` or `High`)\n\n**Regex Pattern** for parsing:\n```regex\n^\\| \\[ADR-(\\d{3})\\]\\(adr\\/ADR-\\d{3}(-[a-z0-9-]+)?\\.md\\) \\| (.+?) \\| (.+?) \\| (.+?) \\| (.+?) \\|\n```\n\n**Capture Groups**:\n- Group 1: ADR number (e.g., `001`)\n- Group 2: Optional slug (e.g., `-database` or empty)\n- Group 3: Title\n- Group 4: Status\n- Group 5: Date\n- Group 6: Impact\n\n**Store in list**:\n```python\n# Example structure (pseudocode)\nadrs = [\n    {\n        \"number\": \"001\",\n        \"slug\": \"\",  # Empty means generate from title\n        \"title\": \"[Title]\",\n        \"status\": \"Accepted\",\n        \"date\": \"YYYY-MM-DD\",\n        \"impact\": \"High/Medium/Low\",\n        \"file_path\": \"adr/ADR-001.md\"\n    },\n    {\n        \"number\": \"002\",\n        \"slug\": \"database\",\n        \"title\": \"Database Choice\",\n        \"status\": \"Proposed\",\n        \"date\": \"2024-01-20\",\n        \"impact\": \"High\",\n        \"file_path\": \"adr/ADR-002-database.md\"\n    }\n]\n```\n\n**Error Handling**: If no ADRs found (empty table):\n\n```\nℹ️  Section 12 ADR table is empty or contains only placeholder entries.\n\nNo ADRs found to generate. This is normal for newly created ARCHITECTURE.md files.\n\nWould you like me to:\n1. [Skip ADR Generation] - Continue without creating ADR files\n2. [Learn About ADRs] - Understand when to create ADRs\n3. [Add Sample ADR] - Create one example ADR to get started\n\nRecommended: Option 1 (Skip) - Create ADRs as architectural decisions are made\n```\n\n**Validation**:\n- Check for duplicate ADR numbers (same number appears multiple times)\n- Check for malformed rows (wrong column count)\n\n**If duplicates found**:\n```\n⚠️  Duplicate ADR numbers detected in Section 12 table\n\nDuplicates found: ADR-002 (appears 2 times)\n\nThis will cause file overwrites. Please fix the table before generating ADRs.\n\nWould you like me to:\n1. [Show Duplicates] - Display the conflicting rows\n2. [Auto-Renumber] - Automatically renumber ADRs sequentially\n3. [Skip ADR Generation] - Fix manually and regenerate later\n\nRecommended: Option 1 (Show Duplicates)\n```\n\n---\n\n##### Step 6.3a: Preview ADRs (if user selected Option 2)\n\nIf user selected \"Preview First\" in Step 6.1:\n\n**Display ADR list**:\n```\nFound {count} ADRs in Section 12 table:\n\n1. ADR-001: [Title] (Status: Accepted, Impact: High/Medium/Low)\n   → Will create: adr/ADR-001-untitled.md\n   Note: Placeholder title - you can customize later\n\n2. ADR-002: Database Choice (Status: Proposed, Impact: High)\n   → Will create: adr/ADR-002-database.md\n\nProceed with generation? (yes/no)\n```\n\n**Wait for response**:\n- If `yes` or `1`: Continue to Step 6.4\n- If `no` or `2` or `skip`: Skip to Step 6.8\n\n---\n\n##### Step 6.4: Prepare ADR Generation\n\n**Get ARCHITECTURE.md directory**:\n\n```bash\n# Extract directory path from ARCHITECTURE.md location\n# If ARCHITECTURE.md is in current directory, use \".\"\n# Otherwise, extract directory from file path\nARCH_DIR=\".\"\n```\n\n**Define ADR directory path**:\n```bash\nADR_DIR=\"${ARCH_DIR}/adr\"\n# Results in: \"./adr\" relative to ARCHITECTURE.md\n```\n\n**Create ADR directory if doesn't exist**:\n```bash\nmkdir -p adr\n```\n\n**Error Handling**: If directory creation fails:\n\n```\n❌ Error: Unable to create adr/ directory\n\nReason: [Error message from mkdir]\n\nPossible causes:\n- Insufficient file permissions\n- Path does not exist\n- Disk space full\n\nWould you like me to:\n1. [Retry with Different Path] - Try creating in user home directory\n2. [Skip ADR Generation] - Continue without creating ADR files\n3. [Manual Instructions] - Show me how to create manually\n\nRecommended: Option 3 (Manual Instructions)\n```\n\n**Success message**:\n```\nGenerating ADR files in ./adr/\n```\n\n---\n\n##### Step 6.5: Load ADR Template\n\n**Template path**: `/home/shadowx4fox/solutions-architect-skills/skills/architecture-docs/adr/ADR-000-template.md`\n\n**Load template**:\n```bash\nRead(file_path=\"/home/shadowx4fox/solutions-architect-skills/skills/architecture-docs/adr/ADR-000-template.md\")\n```\n\n**Store template content** in memory for reuse across all ADR files\n\n---\n\n##### Step 6.6: Generate Each ADR File\n\nFor each ADR in the `adrs` list from Step 6.3:\n\n**Step 6.6a: Generate File Path**\n\n```python\n# Determine slug (pseudocode)\nif adr[\"slug\"] == \"\":\n    # Generate slug from title using Step 6.6b rules\n    slug = generate_slug(adr[\"title\"])\nelse:\n    # Use slug from file path in table\n    slug = adr[\"slug\"]\n\n# Construct file path\nfile_name = f\"ADR-{adr['number']}-{slug}.md\"\nfile_path = f\"adr/{file_name}\"\n```\n\n**Step 6.6b: Generate Slug from Title** (if needed)\n\n**Slug Generation Rules**:\n1. Convert title to lowercase\n2. Replace spaces with hyphens\n3. Remove special characters: `:?/*<>|\"` (keep alphanumeric and hyphens)\n4. Remove consecutive hyphens (replace `--` with `-`)\n5. Trim leading/trailing hyphens\n6. Limit to 50 characters\n7. If title is `[Title]` or placeholder, use slug `untitled`\n\n**Examples**:\n- `Technology Stack Selection` → `technology-stack-selection`\n- `REST vs. gRPC: Which API?` → `rest-vs-grpc-which-api`\n- `PostgreSQL Database Choice` → `postgresql-database-choice`\n- `[Title]` → `untitled`\n\n**Step 6.6c: Check for Existing File**\n\n```bash\n# Check if file already exists\nif [ -f \"adr/ADR-${number}-*.md\" ]; then\n    # File exists - trigger conflict handling\nfi\n```\n\n**If exists**:\n```\n⚠️  ADR file conflict detected\n\nExisting file: adr/ADR-001-old-title.md\nNew file: adr/ADR-001-technology-stack.md\n\nWould you like me to:\n1. [Skip This ADR] - Don't overwrite, keep existing file\n2. [Rename New ADR] - Create as ADR-{next_available} instead\n3. [Overwrite] - Replace existing file (destructive)\n4. [Review Existing] - Show me what's in the existing file first\n\nRecommended: Option 4 (Review Existing)\n```\n\n**Conflict Resolution**:\n- **Never auto-overwrite** existing ADRs\n- Always require user confirmation\n- Suggest next available ADR number if renaming\n\n**Step 6.6d: Populate Template**\n\n```python\n# Copy template (pseudocode)\nadr_content = template_content\n\n# Replace placeholders\nadr_content = adr_content.replace(\"ADR-XXX\", f\"ADR-{adr['number']}\")\nadr_content = adr_content.replace(\"[Short Decision Title]\", adr[\"title\"])\n\n# Replace status line (keep full line format from template)\nstatus_line_old = \"**Status**: Proposed | Accepted | Deprecated | Superseded by ADR-XXX\"\nstatus_line_new = f\"**Status**: {adr['status']}\"\nadr_content = adr_content.replace(status_line_old, status_line_new)\n\n# Replace date\nif adr[\"date\"] == \"YYYY-MM-DD\" or adr[\"date\"] == \"[Date]\":\n    # Use current date\n    current_date = datetime.now().strftime(\"%Y-%m-%d\")\n    adr_content = adr_content.replace(\"**Date**: YYYY-MM-DD\", f\"**Date**: {current_date}\")\nelse:\n    # Use date from table\n    adr_content = adr_content.replace(\"**Date**: YYYY-MM-DD\", f\"**Date**: {adr['date']}\")\n\n# Replace authors (default to Architecture Team)\nadr_content = adr_content.replace(\"**Authors**: [Author names or team name]\", \"**Authors**: Architecture Team\")\n\n# Replace related ADRs (empty by default)\nadr_content = adr_content.replace(\"**Related**: [Links to related ADRs, e.g., ADR-001, ADR-005]\", \"**Related**: []\")\n```\n\n**Special handling for placeholder titles**:\n```python\n# If title is placeholder, add TODO note\nif adr[\"title\"] in [\"[Title]\", \"[title]\", \"Title\"]:\n    # Add note about placeholder\n    note = \"\\n> **TODO**: This ADR was auto-generated with a placeholder title. Please update the title, filename, and content with your actual architectural decision.\\n\"\n    # Insert after first header (after \"# ADR-XXX: [Title]\" line)\n    lines = adr_content.split('\\n')\n    for i, line in enumerate(lines):\n        if line.startswith('# ADR-'):\n            lines.insert(i + 1, note)\n            break\n    adr_content = '\\n'.join(lines)\n```\n\n**Step 6.6e: Write ADR File**\n\n```bash\n# Write the file using Write tool\nWrite(file_path=file_path, content=adr_content)\n```\n\n**Error Handling**: If write fails:\n- Log error message\n- Mark ADR as \"failed\" in tracking\n- Continue with next ADR (don't abort entire batch)\n\n**Step 6.6f: Report Progress**\n\n```\n✅ Created: adr/ADR-001-technology-stack.md\n```\n\n**Repeat** Steps 6.6a-6.6f for all ADRs in list\n\n---\n\n##### Step 6.7: Display Summary Report\n\nAfter all ADRs processed:\n\n**Count results**:\n```python\ntotal_adrs = len(adrs)\ncreated_adrs = count(created successfully)\nskipped_adrs = count(skipped due to conflicts)\nfailed_adrs = count(failed to write)\n```\n\n**Display summary**:\n```\n═══════════════════════════════════════════════════════════\n✅ ADR Generation Complete\n═══════════════════════════════════════════════════════════\n\nSuccessfully generated {created_adrs} of {total_adrs} ADR files in ./adr/\n\nCreated ADRs:\n- adr/ADR-001-technology-stack.md\n- adr/ADR-002-database-choice.md\n- adr/ADR-003-api-protocol.md\n\n{If skipped_adrs > 0:}\nSkipped ADRs:\n- ADR-004 (file already exists: adr/ADR-004-old-title.md)\n\n{If failed_adrs > 0:}\nFailed ADRs:\n- ADR-005 (write error: permission denied)\n\nNext steps:\n1. Review and customize each ADR file\n2. Fill in Context, Decision, and Rationale sections\n3. Update placeholder titles (marked with TODO)\n4. Link related ADRs in the \"Related\" field\n5. Update status to \"Accepted\" once reviewed and approved\n\nADR Template Guide: skills/architecture-docs/ADR_GUIDE.md\n```\n\n---\n\n##### Step 6.8: Complete Workflow\n\n**If user skipped ADR generation** (Option 3 in Step 6.1):\n\n```\nℹ️  Skipped ADR generation - you can create ADR files manually later\n\nTo create ADRs manually:\n1. Update Section 12 table in ARCHITECTURE.md with your ADRs\n2. Copy template: cp skills/architecture-docs/adr/ADR-000-template.md adr/ADR-001-your-title.md\n3. Customize the ADR content\n\nFor guidance, see: skills/architecture-docs/ADR_GUIDE.md\n```\n\n**Return to main workflow**: Architecture Type Selection Workflow completes successfully\n\n---\n\n**End of Step 6**\n\n### Detecting Existing Architecture Type\n\nWhen editing an existing ARCHITECTURE.md, detect the architecture type:\n\n**Detection Method 1: Metadata Comment**\n```bash\ngrep -n \"<!-- ARCHITECTURE_TYPE:\" ARCHITECTURE.md\n```\n\nIf found, extract the type from the comment.\n\n**Detection Method 2: Section 4 Header Analysis**\n\nIf no metadata comment, infer from Section 4 headers:\n\n```bash\n# Check for BIAN indicators (check FIRST - most specific)\ngrep -E \"(Layer 2: BIAN Business Scenarios|Layer 4: BIAN Service Domains)\" ARCHITECTURE.md\n\n# Check for META indicators\ngrep -E \"(Layer 1: Channels|Layer 5: Domain|Layer 6: Core)\" ARCHITECTURE.md\n\n# Check for 3-Tier indicators\ngrep -E \"(Tier 1: Presentation|Tier 3: Data)\" ARCHITECTURE.md\n\n# Check for Microservices indicators\ngrep -E \"(API Gateway|Service Mesh|Microservices Catalog)\" ARCHITECTURE.md\n\n# Check for N-Layer indicators\ngrep -E \"(Clean Architecture|Hexagonal|Ports & Adapters)\" ARCHITECTURE.md\n```\n\n**Inference Rules (in order of specificity):**\n- Contains \"Layer 2: BIAN Business Scenarios\" OR \"Layer 4: BIAN Service Domains\" → **BIAN**\n- Contains \"Layer 1: Channels\" AND \"Layer 5: Domain\" AND \"Layer 6: Core\" → **META**\n- Contains \"Tier 1: Presentation\" OR \"Tier 3: Data\" → **3-Tier**\n- Contains \"API Gateway\" AND \"Service Mesh\" → **Microservices**\n- Contains \"Clean Architecture\" OR \"Hexagonal\" → **N-Layer**\n- Cannot determine → Ask user or default to **Microservices (Recommended)**\n\n### Changing Architecture Type (Existing Document)\n\nIf user requests to change architecture type of an existing ARCHITECTURE.md:\n\n**Warning Steps:**\n1. **Detect current type** using detection methods above\n2. **Warn user** about potential data loss:\n   ```\n   ⚠️  **Architecture Type Change Warning**\n\n   Current type: [DETECTED_TYPE]\n   Requested type: [NEW_TYPE]\n\n   Changing architecture type will:\n   - Replace Section 4 (Meta Architecture) with new structure\n   - Replace Section 5 (Component Details) with new organization\n   - Require manual component remapping\n\n   **Recommendation**: Review and backup current Sections 4 & 5 before proceeding.\n\n   Continue with architecture type change? (yes/no)\n   ```\n\n3. **If user confirms:**\n   - Load new type templates\n   - Replace Section 4 content\n   - Replace Section 5 content\n   - Update metadata comment\n   - Update Document Index\n   - Report changes to user\n\n4. **If user declines:**\n   - Cancel operation\n   - Suggest manual editing approach\n\n### Type-Specific Validation\n\nAfter selecting or detecting architecture type, apply type-specific validation rules:\n\n**BIAN Architecture:**\n- ✅ Must have all 5 layers (Channels, BIAN Business Scenarios, BIAN Business Capabilities, BIAN Service Domains, Core Systems)\n- ✅ Layer 2 must map to BIAN Business Areas (5 areas)\n- ✅ Layer 3 must map to BIAN Business Domains (30+ domains)\n- ✅ Layer 4 must implement BIAN Service Domains from [BIAN V12.0](https://bian.org/servicelandscape-12-0-0/views/view_51891.html)\n- ✅ All Layer 4 service domain names validated against official [BIAN Service Landscape V12.0](https://bian.org/servicelandscape-12-0-0/views/view_51891.html)\n- ✅ Layer 4 components must include complete BIAN metadata (Official Name, BIAN ID, Version, Business Domain, Business Area, URL)\n- ✅ Control records documented per BIAN specification for all Layer 4 service domains\n- ✅ All mandatory BIAN service operations implemented (Initiate, Update, Retrieve, Control)\n- ✅ Behavior qualifiers documented per BIAN spec\n- ✅ Functional patterns documented per BIAN spec (Managed Object, Tracked Object, etc.)\n- ✅ Full BIAN V12.0 compliance level documented\n- ✅ BIAN hierarchy traceability: Service Domain → Business Domain → Business Area\n- ✅ Layers documented in correct order\n\n**META Architecture:**\n- ✅ Must have all 6 layers (Channels, UX, Business Scenarios, Business, Domain, Core)\n- ✅ Layer 5 must include BIAN alignment section\n- ✅ Verify BIAN V12.0 is documented as the default version\n- ✅ Validate BIAN service domain **names (Capabilities)** against the official [BIAN Service Landscape V12.0](https://bian.org/servicelandscape-12-0-0/views/view_51891.html)\n- ✅ Ensure BIAN IDs (SD-XXX) are used for internal document tracking only\n- ✅ Validate Layer 5 (Domain) components include BIAN alignment subsection with official URLs\n- ✅ Layers documented in correct order\n\n**3-Tier Architecture:**\n- ✅ Must have all 3 tiers (Presentation, Application, Data)\n- ✅ No direct database access from Presentation tier\n- ✅ Application tier should be stateless\n\n**Microservices Architecture:**\n- ✅ Must document API Gateway and Service Mesh (or justify omission)\n- ✅ Database-per-service pattern followed\n- ✅ Event bus and topics documented\n- ✅ Circuit breakers configured\n\n**N-Layer Architecture:**\n- ✅ Must specify which pattern (4-Layer, 5-Layer, Clean, Hexagonal)\n- ✅ Dependency direction documented\n- ✅ Core/domain layer is framework-free (if applicable)\n\n**For detailed validation rules**, see: `VALIDATIONS.md` § Type-Aware Validation\n\n### Best Practices\n\n**DO:**\n- ✅ Always prompt for architecture type when creating new ARCHITECTURE.md\n- ✅ Add metadata comment to track architecture type\n- ✅ Load appropriate templates based on selection\n- ✅ Warn before changing architecture type of existing document\n- ✅ Apply type-specific validation rules\n\n**DON'T:**\n- ❌ Assume architecture type without asking\n- ❌ Mix templates from different architecture types\n- ❌ Change architecture type without user confirmation\n- ❌ Skip metadata comment (makes future edits harder)\n\n### Example Workflow\n\n**User:** \"Create architecture documentation for my microservices system\"\n\n**Assistant:**\n1. Detects new ARCHITECTURE.md creation\n2. Presents architecture type options (1-4)\n3. User selects \"3\" (Microservices)\n4. Loads `templates/SECTION_4_MICROSERVICES.md` and `templates/SECTION_5_MICROSERVICES.md`\n5. Creates ARCHITECTURE.md with:\n   - Standard Sections 1-3\n   - Microservices Section 4 (API Gateway, Service Mesh, Services, Event Bus)\n   - Microservices Section 5 (Service catalog format)\n   - Standard Sections 6-12\n   - Metadata comment: `<!-- ARCHITECTURE_TYPE: MICROSERVICES -->`\n6. Reports completion with architecture type confirmation\n\n---\n\n## Automatic Index Updates\n\n**CRITICAL**: After ANY edit that significantly changes section line numbers (>10 lines), automatically update the Document Index.\n\n### When to Update\n\n**Update if:**\n- ✅ Added/removed content shifting section boundaries (>10 lines)\n- ✅ Modified section headers or structure\n- ✅ User requests: \"update the index\"\n\n**Skip if:**\n- ❌ Minor edits (<10 lines)\n- ❌ Only metadata changes\n- ❌ Typo fixes\n\n### Workflow Overview\n\n**Quick Steps:**\n1. **Detect**: Run `grep -n \"^## [0-9]\" ARCHITECTURE.md` to find section boundaries\n2. **Calculate**: Parse output to determine line ranges (Section_Start to Next_Section_Start - 1)\n3. **Update**: Edit Document Index (typically lines 5-21) with new ranges\n4. **Timestamp**: Update \"Index Last Updated\" to current date\n5. **Report**: Inform user which sections changed\n\n**Example:**\n```bash\n# After adding content to Section 8, it grew from 906-980 to 912-996\ngrep -n \"^## [0-9]\" ARCHITECTURE.md\n# Parse: Section 8 now at line 912, Section 9 at 998\n# Calculate: Section 8 = 912-997, Section 9 = 998-1243\n# Update index and report to user\n```\n\n### Detailed Algorithm\n\nFor complete line range calculation algorithm, step-by-step examples, verification checklist, and edge cases:\n→ **METRIC_CALCULATIONS.md** § Automatic Index Updates\n\n### Best Practices\n\n**DO:**\n- ✅ Update after significant edits\n- ✅ Use grep for accuracy (don't guess)\n- ✅ Update timestamp\n- ✅ Report changes to user\n\n**DON'T:**\n- ❌ Update for tiny changes\n- ❌ Skip timestamp update\n- ❌ Change index format\n\n---\n\n## Metric Consistency Detection & Management\n\n**CRITICAL**: The Executive Summary (Section 1, Key Metrics subsection around lines 31-38) contains performance metrics that serve as the **Source of Truth** for system capacity, throughput, latency, and availability targets. These metrics are often duplicated across multiple sections (especially Section 6: Data Flow, Section 7: Integration Points, and Section 10: Scalability & Performance).\n\n**Problem**: When metrics are updated in the Executive Summary, duplicates in other sections can become stale, creating inconsistencies.\n\n**Solution**: This skill provides automatic metric consistency detection and review-based synchronization.\n\n### When to Trigger Metric Audit\n\n**Automatic Trigger:**\n- ✅ After editing Section 1 Executive Summary Key Metrics (typically lines 31-38)\n- ✅ When user updates any metric values in the Key Metrics subsection\n- ✅ After Edit tool completes on lines in Section 1 that contain metrics (TPS, latency, SLA, etc.)\n\n**Manual Trigger:**\n- User explicitly requests: \"Check metric consistency\", \"Verify metrics\", \"Audit metrics\", \"Sync metrics\"\n- User updates Section 10 (Scalability & Performance) and asks to verify consistency with Exec Summary\n- During quarterly documentation review or audit\n\n**Do NOT Trigger:**\n- ❌ Minor edits outside Key Metrics subsection (e.g., updating document version or date)\n- ❌ Edits to narrative text that don't change numeric metric values\n- ❌ Changes to other sections that don't involve performance metrics\n\n### Metric Audit Workflow\n\n**Step 1: Extract Executive Summary Metrics**\n\nRead ONLY lines 30-40 (Key Metrics section) using context-efficient approach:\n```bash\nRead(file_path=\"ARCHITECTURE.md\", offset=30, limit=10)\n```\n\nParse and extract all metrics with their values using these patterns:\n\n| Metric Type | Pattern | Example Match |\n|-------------|---------|---------------|\n| **Average Read TPS** | `Average\\s+Read\\s+TPS:\\s*(\\d{1,3}(?:,\\d{3})*)\\s*transactions/second` | \"Average Read TPS: 1,500 transactions/second\" |\n| **Peak Read TPS** | `Peak\\s+Read\\s+TPS:\\s*(\\d{1,3}(?:,\\d{3})*)\\s*transactions/second` | \"Peak Read TPS: 3,000 transactions/second\" |\n| **Average Processing TPS** | `Average\\s+Processing\\s+TPS:\\s*(\\d{1,3}(?:,\\d{3})*)\\s*transactions/second` | \"Average Processing TPS: 450 transactions/second\" |\n| **Peak Processing TPS** | `Peak\\s+Processing\\s+TPS:\\s*(\\d{1,3}(?:,\\d{3})*)\\s*transactions/second` | \"Peak Processing TPS: 1,000 transactions/second\" |\n| **Average Write TPS** | `Average\\s+Write\\s+TPS:\\s*(\\d{1,3}(?:,\\d{3})*)\\s*transactions/second` | \"Average Write TPS: 300 transactions/second\" |\n| **Peak Write TPS** | `Peak\\s+Write\\s+TPS:\\s*(\\d{1,3}(?:,\\d{3})*)\\s*transactions/second` | \"Peak Write TPS: 800 transactions/second\" |\n| **Measurement Period** | `Measurement\\s+Period:\\s*(.+)` | \"Measurement Period: Average over last 30 days\" |\n| **Percentile Latency** | `p(\\d{2})\\s*<\\s*(\\d+)ms` | \"p95 < 100ms\", \"p99 < 200ms\" |\n| **Availability SLA** | `(\\d{2,3}\\.\\d+)\\s*%` | \"99.99%\", \"99.9%\" |\n| **Concurrent Jobs** | `(\\d{1,3}(?:,\\d{3})*)\\+?\\s*concurrent` | \"10,000+ concurrent\", \"5000 concurrent\" |\n| **Jobs per Hour** | `\\[(\\d{1,3}(?:,\\d{3})*)\\s*jobs?/hour\\]` | \"[1,620,000 jobs/hour]\" |\n\nBuild a metrics registry from parsed data:\n```\nMETRICS_REGISTRY = [\n  {name: \"Read TPS\", value: 1500, unit: \"TPS\", category: \"Read\", stat_type: \"Average\", line: 32, measurement_period: \"Average over last 30 days in production\"},\n  {name: \"Read TPS\", value: 3000, unit: \"TPS\", category: \"Read\", stat_type: \"Peak\", line: 33, measurement_period: \"Peak observed during Black Friday 2024\"},\n  {name: \"Processing TPS\", value: 450, unit: \"TPS\", category: \"Processing\", stat_type: \"Average\", line: 35, measurement_period: \"Average over last quarter\"},\n  {name: \"Processing TPS\", value: 1000, unit: \"TPS\", category: \"Processing\", stat_type: \"Peak\", line: 36, measurement_period: \"Peak during end-of-month batch processing\"},\n  {name: \"Write TPS\", value: 300, unit: \"TPS\", category: \"Write\", stat_type: \"Average\", line: 38, measurement_period: \"Average over last month\"},\n  {name: \"Write TPS\", value: 800, unit: \"TPS\", category: \"Write\", stat_type: \"Peak\", line: 39, measurement_period: \"Peak during data migration events\"},\n  {name: \"System Availability\", value: 99.99, unit: \"%\", line: 42},\n  {name: \"Latency p95\", value: 100, unit: \"ms\", line: 43},\n  {name: \"Latency p99\", value: 200, unit: \"ms\", line: 43},\n  {name: \"Concurrent Jobs\", value: 10000, unit: \"jobs\", line: 44}\n]\n```\n\n**Step 2: Scan Document for Metric References**\n\nUse Grep to find all occurrences of each metric value (context-efficient, no full file load):\n\n```bash\n# For each metric in registry, search with appropriate pattern (new standardized TPS format)\nGrep(pattern=\"Average\\s+Read\\s+TPS:\\s*1,?500\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"Peak\\s+Read\\s+TPS:\\s*3,?000\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"Average\\s+Processing\\s+TPS:\\s*450\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"Peak\\s+Processing\\s+TPS:\\s*1,?000\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"Average\\s+Write\\s+TPS:\\s*300\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"Peak\\s+Write\\s+TPS:\\s*800\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"99\\.99%\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"p95.*100ms\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"p99.*200ms\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\nGrep(pattern=\"10,?000.*concurrent\", path=\"ARCHITECTURE.md\", output_mode=\"files_with_matches\")\n```\n\n**Note**: Use `-n` flag with grep bash command if you need line numbers, or use Grep tool with `output_mode=\"content\"`.\n\n**Step 3: Load Context for Each Match**\n\nFor each grep result, read ±5 lines for context to determine if it's a duplicate or coincidental match:\n```bash\n# If match found at line 787\nRead(file_path=\"ARCHITECTURE.md\", offset=782, limit=10)\n# Reads lines 782-792 for context\n```\n\n**Step 4: Classify Findings**\n\nCategorize each finding into one of four categories:\n\n- **✓ Exact Match**: Same value, same metric concept, already consistent with Executive Summary\n- **⚠️ Mismatch**: Same metric concept but different value (ACTION REQUIRED - user must decide)\n- **ℹ️ Derived Value**: Related but transformed metric (e.g., 450 TPS = 1,620,000 jobs/hour via 450 × 3600)\n- **? Ambiguous**: Number matches but context is unclear (flag for manual review)\n\n**Classification Logic**:\n1. Check if line is in Section 1 (skip, that's the source of truth)\n2. Read context (±5 lines) to understand what the metric represents\n3. Compare metric concept (is this the same \"Job Creation Capacity\" or different metric?)\n4. Determine relationship (exact duplicate, derived value, or unrelated)\n\n**Step 5: Generate Consistency Report**\n\nPresent findings in structured, user-friendly format:\n\n```markdown\n═══════════════════════════════════════════════════════════\n   METRIC CONSISTENCY AUDIT REPORT\n═══════════════════════════════════════════════════════════\nSource of Truth: Section 1 (Executive Summary) Lines 31-38\nTotal Metrics Audited: 10\n═══════════════════════════════════════════════════════════\n\n## ✓ Exact Matches (Consistent)\n\n| Metric | Exec Value | Location | Context | Status |\n|--------|-----------|----------|---------|--------|\n| Job Latency (p95) | < 100ms | Line 787 | Section 6: Data Flow Performance | ✓ Match |\n| Job Latency (p99) | < 200ms | Line 787 | Section 6: Data Flow Performance | ✓ Match |\n| Job Latency (p95) | < 100ms | Line 1345 | Section 10: Performance Table | ✓ Match |\n| Job Latency (p99) | < 200ms | Line 1345 | Section 10: Performance Table | ✓ Match |\n\n## ⚠️ Mismatches Found (ACTION REQUIRED)\n\n| Metric | Exec Value | Location | Current Value | Difference |\n|--------|-----------|----------|---------------|------------|\n| Peak Job Creation | 1,000 TPS | Line 1367 | 500 TPS | -500 TPS |\n\n## ℹ️ Derived Values (Informational)\n\n| Metric | Exec Value | Location | Derived Value | Relationship |\n|--------|-----------|----------|---------------|--------------|\n| Job Creation | 450 TPS | Line 32 | 1,620,000 jobs/hour | 450 × 3600 |\n\n═══════════════════════════════════════════════════════════\nSUMMARY: ✓ 4 Matches | ⚠️ 1 Mismatch | ℹ️ 1 Derived\n═══════════════════════════════════════════════════════════\n```\n\n**Step 6: Await User Decision**\n\nIf mismatches found, present options to user:\n```\nI found 1 metric mismatch. What would you like to do?\n\n1. [Review Details] - Show detailed context for the mismatch\n2. [Update Exec Summary] - Update Section 1 to match line 1367 (500 TPS)\n3. [Update Document] - Update line 1367 to match Exec Summary (1,000 TPS)\n4. [Preview Changes] - Show exactly what will change before applying\n5. [Manual Review] - I'll review and decide later\n6. [Ignore] - Keep as-is (intentional difference)\n```\n\n**Step 7: Apply Approved Changes**\n\nIf user approves updates:\n1. Show preview of all changes (exact before/after for each location)\n2. Confirm user approval\n3. Use Edit tool to update each location sequentially\n4. Update Document Index if line numbers shift significantly (>10 lines)\n5. Report completion with summary of all changes made\n\n### Common Metric Locations\n\n**Known Duplicate Locations** (for typical architecture documents):\n\n| Metric | Executive Summary | Common Duplicate Locations |\n|--------|------------------|---------------------------|\n| Job Creation Capacity (450 TPS) | Line ~32 | Section 10 Throughput Table (~line 1367) |\n| Job Execution Capacity (500 TPS) | Line ~33 | Section 10 Throughput Table (~line 1368), Section 6 Data Flow (~line 787) |\n| Peak Capacity (1,000/2,000 TPS) | Line ~34 | Section 10 Throughput Table (~lines 1367-1368) |\n| Initial Load (150/350 TPS) | Line ~35 | Section 10 Capacity Planning (~lines 1378-1379) |\n| System Availability (99.99%) | Line ~36 | Section 2 Use Case metrics (~line 115), Section 7 Integration SLA Table (~lines 829-832) |\n| Latency Targets (p95/p99) | Line ~37 | Section 6 Data Flow Performance (~line 787), Section 10 Performance Table (~line 1345) |\n| Concurrent Jobs (10,000+) | Line ~38 | Less commonly duplicated (usually only in Exec Summary) |\n\n**Note**: Line numbers are approximate and vary by document. Use grep to find exact locations.\n\n### Metric Update Best Practices\n\n**DO:**\n- ✅ Always scan full document after Exec Summary metric changes\n- ✅ Present findings before making any changes (review-only first)\n- ✅ Explain context for each mismatch (which section, what table/paragraph)\n- ✅ Offer batch update option for multiple occurrences of same metric\n- ✅ Show preview with exact before/after text for transparency\n- ✅ Update Document Index if edits shift section boundaries\n\n**DON'T:**\n- ❌ Auto-update without user approval (always review-only first)\n- ❌ Change metrics in unrelated sections without confirming intent\n- ❌ Ignore ambiguous matches (always flag for review)\n- ❌ Forget to check derived values (e.g., jobs/hour conversions from TPS)\n- ❌ Skip context loading (always read ±5 lines to understand match)\n\n### Error Handling & Edge Cases\n\n**1. Multiple Conflicting Values**\n\nScenario: Same metric has different values in multiple sections (not just Exec Summary vs. one location)\n\nExample:\n- Exec Summary (Line 32): 450 TPS\n- Section 6 (Line 787): 500 TPS\n- Section 10 (Line 1367): 400 TPS\n\n**Handling:**\n```\n⚠️ CONFLICT DETECTED: Job Execution Capacity has 3 different values\n\n| Location | Value | Context |\n|----------|-------|---------|\n| Line 32 (Exec Summary) | 450 TPS | Design Capacity |\n| Line 787 (Section 6) | 500 TPS | Data Flow Performance |\n| Line 1367 (Section 10) | 400 TPS | Throughput Table |\n\nWhich value is correct?\n1. Use Exec Summary (450 TPS) as source of truth\n2. Use most common value (if clear majority)\n3. Manual review - I need to investigate further\n\nPlease clarify which value should be used across all locations.\n```\n\n**2. Derived Value Calculation Errors**\n\nScenario: Derived value doesn't match expected conversion\n\nExample:\n- Exec Summary: 450 TPS\n- Expected derived: 1,620,000 jobs/hour (450 × 3600)\n- Found in doc: 1,650,000 jobs/hour\n\n**Handling:**\n```\nℹ️ Derived Value Mismatch Detected:\n\nMetric: Job Creation Capacity\nBase Value: 450 TPS (Line 32)\nExpected Derived: 1,620,000 jobs/hour (450 × 3600)\nActual Found: 1,650,000 jobs/hour (Line 32)\nDifference: +30,000 jobs/hour\n\nPossible causes:\n- Rounding or overhead factor applied\n- Different calculation method\n- Stale value from previous metric update\n\nWould you like to:\n1. Update to calculated value (1,620,000)\n2. Keep current value (1,650,000) - might be intentional overhead\n3. Investigate further\n```\n\n**3. Ambiguous Metric Context**\n\nScenario: Number matches but unclear if it's the same metric\n\nExample:\n- Exec Summary: Peak Capacity 1,000 TPS\n- Found at line 1367: \"System limit 1,000 TPS (theoretical max)\"\n- Found at line 1372: \"Target throughput 1,000 TPS (steady state)\"\n- Found at line 1389: \"1000 TPS limit\"\n\n**Handling:**\n```\n? AMBIGUOUS MATCH: Value \"1,000 TPS\" found in multiple contexts\n\nExec Summary Definition (Line 34):\n\"Peak Capacity: 1,000 TPS job creation, 2,000 TPS job execution (system limits)\"\n\nFound Matches:\n1. Line 1367: \"System limit 1,000 TPS\"\n   Context: Throughput table - appears to be same metric ✓\n\n2. Line 1372: \"1000 TPS (theoretical max)\"\n   Context: Throughput calculation - likely same metric ✓\n\n3. Line 1389: \"1000 TPS limit\"\n   Context: Capacity planning - likely same metric ✓\n\nAll 3 appear to reference Peak Capacity. Treat as exact matches? [Yes/No/Review Each]\n```\n\n**4. No Matches Found**\n\nScenario: Metric exists in Exec Summary but never referenced elsewhere\n\nExample:\n- Exec Summary: \"Concurrent Jobs: Support for 10,000+ concurrent scheduled jobs\"\n- Grep search: No matches found in rest of document\n\n**Handling:**\n```\nℹ️ INFORMATIONAL: Metric appears only in Executive Summary\n\nMetric: Concurrent Jobs (10,000+)\nLocation: Line 38 (Section 1)\nDocument Coverage: Not referenced in other sections\n\nThis is not necessarily an error - some high-level metrics may only appear in Exec Summary.\n\nRecommendation:\n- If this metric is important to architecture, consider adding to Section 10 (Scalability & Performance)\n- If it's a summary-only metric, no action needed\n\nWould you like to:\n1. Add this metric to Section 10\n2. Keep as-is (Exec Summary only)\n3. Ignore this finding\n```\n\n**5. Too Many Grep Results**\n\nScenario: Common number matches hundreds of unrelated contexts\n\nExample: Searching for \"100\" also matches \"100 pods\", \"section 100\", \"version 1.00\"\n\n**Handling:**\n- Use context-aware grep patterns to reduce false positives:\n  - Bad: `grep -n \"100\" ARCHITECTURE.md` (too broad)\n  - Good: `grep -n \"p95.*100ms\" ARCHITECTURE.md` (context-aware)\n  - Better: `grep -n \"p95\\s*<\\s*100ms\" ARCHITECTURE.md` (exact pattern)\n\n- If still >20 matches after context-aware patterns:\n  1. Load only first 10 matches\n  2. Present summary: \"Found 47 matches for '100' - showing first 10 most relevant\"\n  3. Ask user if they want to see all or refine search pattern\n\n### Example: Complete Metric Update Workflow\n\n**Scenario:** User updates Job Execution Capacity from 500 TPS to 700 TPS\n\n**Step-by-Step Execution:**\n\n1. **User Action**:\n   ```\n   User: \"Update the job execution capacity to 700 TPS in the Executive Summary\"\n   ```\n\n2. **Claude Applies Edit**:\n   ```\n   [Uses Edit tool to change line 33: \"500 TPS\" → \"700 TPS\"]\n   ✓ Updated line 33: Design Capacity - Job Execution: 700 TPS\n\n   Now checking for metric consistency across the document...\n   ```\n\n3. **Automatic Audit Triggered**:\n   ```\n   [Metric audit automatically triggered because Section 1 Key Metrics was edited]\n\n   Scanning document for references to old value (500 TPS)...\n   [Runs: Grep(pattern=\"500\\s*TPS\", path=\"ARCHITECTURE.md\")]\n   [Found at: Line 787, Line 1368]\n   ```\n\n4. **Load Context for Each Match**:\n   ```\n   [Reads context around each match]\n   Read(file_path=\"ARCHITECTURE.md\", offset=782, limit=10)  # Lines 782-792 for Line 787\n   Read(file_path=\"ARCHITECTURE.md\", offset=1363, limit=10) # Lines 1363-1373 for Line 1368\n   ```\n\n5. **Present Findings**:\n   ```\n   ═══════════════════════════════════════════════════════════\n   METRIC CONSISTENCY AUDIT REPORT\n   ═══════════════════════════════════════════════════════════\n   Triggered by: Executive Summary edit (Line 33)\n   Metric Changed: Job Execution Capacity (500 TPS → 700 TPS)\n   ═══════════════════════════════════════════════════════════\n\n   ## ⚠️ Outdated References Found\n\n   | Location | Section | Current Value | Should Be | Context |\n   |----------|---------|---------------|-----------|---------|\n   | Line 787 | Section 6: Data Flow Patterns | 500 TPS capacity | 700 TPS | \"Performance: p50 = 40ms, p95 = 100ms, p99 = 200ms \\| 500 TPS capacity\" |\n   | Line 1368 | Section 10: Scalability & Performance | 500 | 700 | Throughput table: \"Job Execution (TPS) \\| 500 \\| 1000 \\| 2000\" |\n\n   ═══════════════════════════════════════════════════════════\n   SUMMARY: Found 2 locations with outdated metric value\n   ═══════════════════════════════════════════════════════════\n\n   Would you like me to update both locations to 700 TPS?\n\n   Options:\n   1. [Yes - Update All] - Apply changes to both locations\n   2. [Preview Changes] - Show me exactly what will change\n   3. [Manual Selection] - Let me choose individually\n   4. [No Thanks] - I'll handle this manually\n   ```\n\n6. **User Requests Preview**:\n   ```\n   User: \"Preview changes first\"\n   ```\n\n7. **Show Preview**:\n   ```\n   Here's a preview of the changes I'll make:\n\n   ════════════════════════════════════════════════════════════\n   CHANGE 1 of 2: Line 787 (Section 6: Data Flow Patterns)\n   ════════════════════════════════════════════════════════════\n\n   Current:\n   **Performance**: p50 = 40ms, p95 = 100ms, p99 = 200ms | 500 TPS capacity\n\n   Will become:\n   **Performance**: p50 = 40ms, p95 = 100ms, p99 = 200ms | 700 TPS capacity\n\n   ════════════════════════════════════════════════════════════\n   CHANGE 2 of 2: Line 1368 (Section 10: Throughput Table)\n   ════════════════════════════════════════════════════════════\n\n   Current:\n   | Job Execution (TPS) | 500 | 1000 | 2000 | Downstream domain services |\n\n   Will become:\n   | Job Execution (TPS) | 700 | 1000 | 2000 | Downstream domain services |\n\n   ════════════════════════════════════════════════════════════\n\n   Proceed with both changes? [Yes/No/Choose Individually]\n   ```\n\n8. **User Approves**:\n   ```\n   User: \"Yes\"\n   ```\n\n9. **Apply Changes**:\n   ```\n   Applying metric consistency updates...\n\n   [Uses Edit tool on line 787]\n   ✓ Updated line 787: \"500 TPS capacity\" → \"700 TPS capacity\"\n\n   [Uses Edit tool on line 1368]\n   ✓ Updated line 1368: Throughput table \"500\" → \"700\"\n\n   Checking if Document Index needs update...\n   [Runs: grep -n \"^## [0-9]\" ARCHITECTURE.md to check section positions]\n   [Determines: No significant line shifts, index still valid]\n\n   ✓ Document Index is still accurate (no update needed)\n   ```\n\n10. **Completion Report**:\n    ```\n    ═══════════════════════════════════════════════════════════\n    METRIC CONSISTENCY UPDATE COMPLETE\n    ═══════════════════════════════════════════════════════════\n\n    Summary of Changes:\n    ✓ Executive Summary (Line 33): 500 TPS → 700 TPS\n    ✓ Section 6 Data Flow (Line 787): 500 TPS → 700 TPS\n    ✓ Section 10 Throughput Table (Line 1368): 500 → 700\n\n    Total Locations Updated: 3\n    Document Index: No update needed\n    All references to Job Execution Capacity are now consistent.\n\n    ═══════════════════════════════════════════════════════════\n    ```\n\n---\n\n## Design Drivers Impact Metrics Calculation\n\n**PURPOSE**: Automatically calculate and maintain Design Drivers impact metrics (Value Delivery, Scale, Impacts) based on data from existing architecture sections. Design Drivers provide a quantifiable assessment of the architecture's business value, customer reach, and implementation complexity.\n\n### When to Trigger Design Drivers Calculation\n\n**Automatic Prompt:**\n- ✅ User requests \"architecture review\" or \"audit\" (prompt to calculate)\n- ✅ User explicitly asks to \"calculate design drivers\" or \"update design drivers\"\n- ✅ After significant architecture changes during review process\n\n**Manual Trigger:**\n- User explicitly requests: \"Calculate design drivers\", \"Update Section 2.2.1\", \"Assess design impact\"\n- During quarterly documentation review or architecture validation\n- When preparing architecture presentations or business justifications\n\n**Do NOT Trigger:**\n- ❌ Minor edits unrelated to architecture (typos, formatting, dates)\n- ❌ Changes to sections not used in design drivers calculation (Sections 3, 4, 9, 11, 12)\n- ❌ User explicitly declines when prompted during review\n\n### Design Drivers Framework\n\nThe Design Drivers subsection (Section 2.2.1) measures three impact dimensions:\n\n#### 1. Value Delivery\n**Definition**: Effectiveness of change in customer experience\n**Threshold**: >50% = High Impact, ≤50% = Low Impact\n**Data Source**: Section 1 Executive Summary - Business Value bullets\n**Extraction Pattern**: `(\\d{1,3})%\\s*(reduction|improvement|increase|efficiency|optimization|cost\\s*savings?|faster|time\\s*savings?)`\n\n**Calculation Logic**:\n1. Read Section 1 Executive Summary (lines 25-55)\n2. Find all percentage metrics in Business Value subsection\n3. Extract maximum percentage value\n4. If ANY metric > 50% → HIGH Impact\n5. If ALL metrics ≤ 50% → LOW Impact\n6. Generate justification citing specific percentage and line number\n\n**Example**:\n- Input: \"70% cost reduction\" (Section 1, line 52)\n- Output: HIGH Impact - \"System delivers 70% cost reduction (Section 1, line 52)\"\n\n#### 2. Scale\n**Definition**: Estimated number of customers/transactions impacted\n**Threshold**: >100K = High Impact, ≤100K = Low Impact\n**Data Source**: Section 2.3 Use Cases - Success Metrics\n**Extraction Pattern**: `(\\d{1,3}(?:,\\d{3})*)\\+?\\s*(?:per\\s*day|daily|customers?|users?|transactions?|reminders?|payments?|jobs?)`\n\n**Calculation Logic**:\n1. Read Section 2.3 Use Cases (approximate lines 100-165)\n2. Find all volume metrics in Success Metrics subsections\n3. Extract maximum customer/transaction count\n4. If MAX count > 100,000 → HIGH Impact\n5. If MAX count ≤ 100,000 → LOW Impact\n6. Generate justification citing specific volume and line number\n\n**Example**:\n- Input: \"500,000+ reminders per day\" (Section 2.3, line 141)\n- Output: HIGH Impact - \"System impacts 500,000 customers/day (Section 2.3, line 141)\"\n\n#### 3. Impacts\n**Definition**: Implementation complexity (configuration, development, deployment)\n**Threshold**: >5 impacts = High Impact, ≤5 impacts = Low Impact\n**Data Sources**: Section 5 Component Architecture + Section 8 Technology Stack\n**Extraction Method**: Count subsection headers + table rows\n\n**Calculation Logic**:\n1. Read Section 5 Component Details (approximate lines 456-675)\n2. Count component subsection headers matching pattern: `^###\\s+\\d+\\.\\d+`\n3. Read Section 8 Technology Stack (approximate lines 912-998)\n4. Count technology table rows (excluding headers and separators)\n5. Total = component_count + technology_count\n6. If total > 5 → HIGH Impact\n7. If total ≤ 5 → LOW Impact\n8. Generate justification with breakdown\n\n**Example**:\n- Input: 5 components in Section 5, 3 technologies in Section 8\n- Output: HIGH Impact - \"System requires 8 components/technologies (Section 5: 5, Section 8: 3)\"\n\n### 6-Phase Calculation Workflow\n\n#### Phase 1: Detection & User Prompt\n\n**Trigger Detection**:\nWhen user request contains keywords:\n- \"architecture review\", \"audit\", \"assess architecture\"\n- \"calculate design drivers\", \"update design drivers\"\n- \"design impact\", \"impact metrics\"\n\n**User Prompt**:\n```\n═══════════════════════════════════════════════════════════\nWould you like me to calculate Design Drivers impact metrics?\n═══════════════════════════════════════════════════════════\n\nDesign Drivers provide quantifiable assessment across 3 dimensions:\n• Value Delivery: Customer experience effectiveness (from Section 1)\n• Scale: Customer/transaction volume impacted (from Section 2.3)\n• Impacts: Implementation complexity (from Sections 5 & 8)\n\nThis will analyze existing architecture data and update Section 2.2.1.\n\n[Calculate Now] [Skip] [Learn More]\n```\n\nIf user selects \"Learn More\", explain:\n```\nDesign Drivers help you:\n✓ Quantify business value of architecture decisions\n✓ Justify complexity based on scale and impact\n✓ Communicate architecture priorities to stakeholders\n✓ Validate alignment between architecture and business goals\n\nThe calculation is automatic - metrics are extracted from:\n• Section 1: Business value percentages\n• Section 2.3: Customer/transaction volumes\n• Section 5: Component count\n• Section 8: Technology count\n\nResults are presented for your review before updating the document.\n```\n\n#### Phase 2: Context-Efficient Data Loading\n\n**Sequential Loading Strategy** (minimize context usage):\n\n```bash\n# Load only required sections, NOT full document\n# Total: ~400-500 lines vs 2000+ full document (75% reduction)\n\n# Step 1: Load Document Index\nRead(file_path=\"ARCHITECTURE.md\", offset=1, limit=50)\n# Parse index to get exact line ranges for Sections 1, 2, 5, 8\n\n# Step 2: Load Section 1 Executive Summary\nRead(file_path=\"ARCHITECTURE.md\", offset=<section1_start-5>, limit=<section1_length+10>)\n# Extract Business Value bullets, look for percentage metrics\n\n# Step 3: Load Section 2.3 Use Cases\nRead(file_path=\"ARCHITECTURE.md\", offset=<section2.3_start-5>, limit=<section2.3_length+10>)\n# Extract Success Metrics from all use cases, look for volume counts\n\n# Step 4: Load Section 5 Component Details\nRead(file_path=\"ARCHITECTURE.md\", offset=<section5_start-5>, limit=<section5_length+10>)\n# Count subsection headers (### X.X Component Name)\n\n# Step 5: Load Section 8 Technology Stack\nRead(file_path=\"ARCHITECTURE.md\", offset=<section8_start-5>, limit=<section8_length+10>)\n# Count technology table rows\n```\n\n**Context Buffer Guidelines**:\n- Add ±5-10 lines buffer to each section for context preservation\n- Load sections sequentially (one at a time), not simultaneously\n- Extract metrics immediately after loading each section\n- Clear temporary data before loading next section\n\n#### Phase 3: Metric Extraction & Calculation\n\n**Algorithm 1: Value Delivery Extraction**\n\n```python\n# Pseudo-code for Value Delivery calculation\ndef extract_value_delivery(section1_text, section1_start_line):\n    # Find Business Value subsection\n    business_value_match = re.search(r'\\*\\*Business Value:\\*\\*(.+?)(?=\\n\\n|\\n\\*\\*|$)', section1_text, re.DOTALL)\n\n    if not business_value_match:\n        return {\n            'impact': 'LOW',\n            'justification': 'No quantifiable business value metrics found in Section 1',\n            'percentage': None,\n            'line': None\n        }\n\n    business_value_section = business_value_match.group(1)\n\n    # Extract all percentage metrics\n    percentage_pattern = r'(\\d{1,3})%\\s*(reduction|improvement|increase|efficiency|optimization|cost\\s*savings?|faster|time\\s*savings?)'\n    matches = re.finditer(percentage_pattern, business_value_section, re.IGNORECASE)\n\n    percentages = []\n    for match in matches:\n        percentage = int(match.group(1))\n        context = match.group(2)\n        # Calculate approximate line number within section\n        line_offset = section1_text[:match.start()].count('\\n')\n        line_number = section1_start_line + line_offset\n        percentages.append({\n            'value': percentage,\n            'context': context,\n            'line': line_number\n        })\n\n    if not percentages:\n        return {\n            'impact': 'LOW',\n            'justification': 'No percentage-based metrics found in Business Value',\n            'percentage': None,\n            'line': None\n        }\n\n    # Find maximum percentage\n    max_metric = max(percentages, key=lambda x: x['value'])\n\n    # Apply threshold\n    impact = 'HIGH' if max_metric['value'] > 50 else 'LOW'\n\n    return {\n        'impact': impact,\n        'justification': f\"System delivers {max_metric['value']}% {max_metric['context']} (Section 1, line {max_metric['line']})\",\n        'percentage': max_metric['value'],\n        'line': max_metric['line']\n    }\n```\n\n**Algorithm 2: Scale Extraction**\n\n```python\n# Pseudo-code for Scale calculation\ndef extract_scale(section2_3_text, section2_3_start_line):\n    # Extract all volume metrics from Success Metrics subsections\n    volume_pattern = r'(\\d{1,3}(?:,\\d{3})*)\\+?\\s*(?:per\\s*day|daily|customers?|users?|transactions?|reminders?|payments?|jobs?)'\n    matches = re.finditer(volume_pattern, section2_3_text, re.IGNORECASE)\n\n    volumes = []\n    for match in matches:\n        # Parse number (remove commas)\n        volume_str = match.group(1).replace(',', '')\n        volume = int(volume_str)\n        context = match.group(0)\n        # Calculate line number\n        line_offset = section2_3_text[:match.start()].count('\\n')\n        line_number = section2_3_start_line + line_offset\n        volumes.append({\n            'value': volume,\n            'context': context,\n            'line': line_number\n        })\n\n    if not volumes:\n        return {\n            'impact': 'LOW',\n            'justification': 'No volume metrics found in Use Cases success metrics',\n            'volume': None,\n            'line': None\n        }\n\n    # Find maximum volume\n    max_volume = max(volumes, key=lambda x: x['value'])\n\n    # Apply threshold\n    impact = 'HIGH' if max_volume['value'] > 100000 else 'LOW'\n\n    # Format volume with commas for readability\n    volume_formatted = f\"{max_volume['value']:,}\"\n\n    return {\n        'impact': impact,\n        'justification': f\"System impacts {volume_formatted} customers/transactions per day (Section 2.3, line {max_volume['line']})\",\n        'volume': max_volume['value'],\n        'line': max_volume['line']\n    }\n```\n\n**Algorithm 3: Impacts Calculation**\n\n```python\n# Pseudo-code for Impacts calculation\ndef calculate_impacts(section5_text, section8_text):\n    # Count component subsection headers in Section 5\n    component_pattern = r'^###\\s+\\d+\\.\\d+\\s+.+$'\n    component_matches = re.findall(component_pattern, section5_text, re.MULTILINE)\n    component_count = len(component_matches)\n\n    # Count technology table rows in Section 8\n    # Exclude header rows (contains | --- |) and empty rows\n    tech_table_pattern = r'^\\|[^|]+\\|[^|]+\\|.+\\|$'\n    separator_pattern = r'^\\|\\s*-+\\s*\\|'\n\n    tech_rows = []\n    for line in section8_text.split('\\n'):\n        if re.match(tech_table_pattern, line) and not re.match(separator_pattern, line):\n            tech_rows.append(line)\n\n    # First row is typically header, so subtract 1\n    # Count unique tables (Languages, Frameworks, Databases, etc.)\n    # Approximate: count all rows and subtract ~4-6 header rows\n    technology_count = max(0, len(tech_rows) - 5)  # Conservative estimate\n\n    # Total impacts\n    total_impacts = component_count + technology_count\n\n    # Apply threshold\n    impact = 'HIGH' if total_impacts > 5 else 'LOW'\n\n    return {\n        'impact': impact,\n        'justification': f\"System requires {total_impacts} components/technologies (Section 5: {component_count}, Section 8: {technology_count})\",\n        'component_count': component_count,\n        'technology_count': technology_count,\n        'total': total_impacts\n    }\n```\n\n#### Phase 4: Generate Calculation Report & User Review\n\n**Report Format**:\n```\n═══════════════════════════════════════════════════════════\n  DESIGN DRIVERS IMPACT METRICS CALCULATION\n═══════════════════════════════════════════════════════════\nCalculation Date: YYYY-MM-DD\nData Sources: Sections 1, 2.3, 5, 8\n═══════════════════════════════════════════════════════════\n\n## Value Delivery: [HIGH / LOW]\n**Threshold**: >50% = High Impact\n**Assessment**: [Percentage]% [context] exceeds threshold\n**Justification**: System delivers [X]% [context] (Section 1, line [N])\n**Source Data**: [Extracted percentage metric from Business Value]\n\n## Scale: [HIGH / LOW]\n**Threshold**: >100K = High Impact\n**Assessment**: [Volume] [unit] exceeds threshold\n**Justification**: System impacts [X] customers/day (Section 2.3, line [N])\n**Source Data**: [Extracted volume metric from Success Metrics]\n\n## Impacts: [HIGH / LOW]\n**Threshold**: >5 = High Impact\n**Assessment**: [Total] components/technologies exceeds threshold\n**Justification**: System requires [Total] components/technologies (Section 5: [C], Section 8: [T])\n**Breakdown**:\n  - Components (Section 5): [Component count]\n  - Technologies (Section 8): [Technology count]\n\n═══════════════════════════════════════════════════════════\nSUMMARY: [3/3 HIGH | 2/3 HIGH | 1/3 HIGH | 0/3 HIGH]\n═══════════════════════════════════════════════════════════\n\nNext Steps:\n1. [Update Section 2.2.1] - Apply these metrics to Design Drivers subsection\n2. [Preview Changes] - See exact updates before applying\n3. [Manual Override] - Adjust values or classifications manually\n4. [Export Report] - Save this report for documentation\n5. [Skip Update] - Review only, don't modify ARCHITECTURE.md\n\nPlease select an option:\n```\n\n**Interactive Review Options**:\n\n1. **Update Section 2.2.1**: Proceed with applying metrics to Design Drivers subsection\n2. **Preview Changes**: Show exact before/after of Section 2.2.1\n3. **Manual Override**: User can adjust thresholds, classifications, or justifications\n4. **Export Report**: Save calculation report to separate file\n5. **Skip Update**: Review-only mode, don't modify document\n\n#### Phase 5: Apply Changes to ARCHITECTURE.md\n\n**Insertion Logic**:\n\n1. **Check if Section 2.2.1 exists**:\n   ```bash\n   Grep(pattern=\"### Design Drivers\", path=\"ARCHITECTURE.md\")\n   # or\n   Grep(pattern=\"### 2\\.2\\.1\", path=\"ARCHITECTURE.md\")\n   ```\n\n2. **If Section 2.2.1 DOES NOT exist** (first-time insertion):\n   - Find end of Section 2.2 (Solution Overview)\n   - Insert new Design Drivers subsection after Section 2.2\n   - Update section numbering if needed (2.3 Use Cases remains 2.3)\n   - Update Document Index (Section 2 line range expands)\n\n3. **If Section 2.2.1 DOES exist** (update existing):\n   - Read Section 2.2.1 content\n   - Update only the impact assessments and justifications\n   - Preserve structure and formatting\n   - Update \"Last Calculated\" date\n   - Update \"Calculation Method\" to \"Automatic\"\n\n**Section 2.2.1 Template** (for insertion):\n```markdown\n### 2.2.1 Design Drivers\n\nThis architecture is driven by the following key factors:\n\n#### Value Delivery\n**Description**: Effectiveness of change in customer experience\n- **Threshold**: >50% = High Impact, ≤50% = Low Impact\n- **Current Assessment**: [HIGH / LOW] Impact\n- **Justification**: [Extracted justification with line reference]\n\n#### Scale\n**Description**: Estimated number of customers impacted\n- **Threshold**: >100K = High, ≤100K = Low\n- **Current Assessment**: [HIGH / LOW] Impact\n- **Justification**: [Extracted justification with line reference]\n\n#### Impacts\n**Description**: Implementation complexity across configuration, development, and applications\n- **Threshold**: >5 = High, ≤5 = Low\n- **Current Assessment**: [HIGH / LOW] Impact\n- **Justification**: [Extracted justification with component/technology counts]\n\n**Last Calculated**: [YYYY-MM-DD]\n**Calculation Method**: Automatic\n```\n\n**Update Workflow**:\n\n```bash\n# Step 1: Find insertion point\nRead(file_path=\"ARCHITECTURE.md\", offset=82, limit=20)  # Section 2.2 Solution Overview\n# Identify line number where Section 2.2 ends (before 2.3 Use Cases)\n\n# Step 2: Insert or Update Section 2.2.1\n# If new insertion:\nEdit(file_path=\"ARCHITECTURE.md\",\n     old_string=\"[End of Section 2.2 content]\\n\\n### 2.3 Primary Use Cases\",\n     new_string=\"[End of Section 2.2 content]\\n\\n### 2.2.1 Design Drivers\\n\\n[Full template with calculated values]\\n\\n### 2.3 Primary Use Cases\")\n\n# If updating existing:\nEdit(file_path=\"ARCHITECTURE.md\",\n     old_string=\"**Current Assessment**: [old value]\\n- **Justification**: [old justification]\",\n     new_string=\"**Current Assessment**: [new value]\\n- **Justification**: [new justification]\")\n\n# Step 3: Update \"Last Calculated\" date\nEdit(file_path=\"ARCHITECTURE.md\",\n     old_string=\"**Last Calculated**: YYYY-MM-DD\",\n     new_string=\"**Last Calculated**: 2025-01-26\")  # Use current date\n\n# Step 4: Update Document Index (if significant line shift)\n# Run grep to detect new section positions\ngrep -n \"^## [0-9]\" ARCHITECTURE.md\n# Update index line ranges if Section 2 grew by >10 lines\n```\n\n#### Phase 6: Completion Report & Verification\n\n**Completion Report Format**:\n```\n═══════════════════════════════════════════════════════════\n  DESIGN DRIVERS UPDATE COMPLETE\n═══════════════════════════════════════════════════════════\n\n✓ Section 2.2.1 Design Drivers updated\n✓ All three metrics calculated and applied\n✓ Document Index updated (Section 2: Lines X-Y)\n✓ Last Calculated: 2025-01-26\n\nSummary of Metrics:\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\nValue Delivery:  HIGH   (70% cost reduction)\nScale:           HIGH   (500,000 customers/day)\nImpacts:         HIGH   (8 components/technologies)\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\nOverall Design Impact: 3/3 HIGH\n\nData Sources:\n• Section 1 (Executive Summary): Business value metrics\n• Section 2.3 (Use Cases): Success metrics and volumes\n• Section 5 (Components): Component architecture details\n• Section 8 (Technology Stack): Technology inventory\n\nNext Steps:\n• Review Section 2.2.1 for accuracy\n• Use these metrics in architecture presentations\n• Recalculate after significant architecture changes\n• Include in quarterly architecture reviews\n\n═══════════════════════════════════════════════════════════\n```\n\n**Verification Steps**:\n1. Read Section 2.2.1 to confirm updates applied correctly\n2. Verify Document Index reflects new line ranges\n3. Check \"Last Calculated\" date is current\n4. Confirm all three metrics (Value Delivery, Scale, Impacts) are present\n5. Validate justifications include source line numbers\n\n### Edge Cases & Error Handling\n\n#### Edge Case 1: Missing Source Data\n\n**Scenario**: No percentage metrics found in Section 1 Business Value\n\n**Handling**:\n```\n⚠️ MISSING DATA: Value Delivery\n\nNo percentage-based metrics found in Section 1 Business Value.\n\nRecommendations:\n1. Add quantifiable business value metrics to Section 1\n2. Provide manual override for Value Delivery assessment\n3. Default to LOW impact with note: \"No quantifiable metrics found\"\n\nWould you like to:\n[Add Metrics to Section 1] [Manual Override] [Default to LOW]\n```\n\n**Default Behavior**:\n- Value Delivery: LOW Impact with justification \"No quantifiable business value metrics found in Section 1\"\n- Scale: LOW Impact with justification \"No volume metrics found in Use Cases\"\n- Impacts: Calculate based on available data (Section 5 or 8, whichever exists)\n\n#### Edge Case 2: Threshold Edge Cases (Exactly 50%, 100K, or 5)\n\n**Scenario**: Metric value exactly equals threshold\n\n**Handling**:\n```\nℹ️ THRESHOLD EDGE CASE: Scale\n\nVolume metric: Exactly 100,000 customers/day (Section 2.3, line 141)\nThreshold rule: >100K = HIGH (not ≥)\n\nAssessment: LOW Impact (100K is NOT > 100K)\nNote: Consider if this is close enough to merit HIGH classification\n\nWould you like to:\n[Use LOW (strict threshold)] [Override to HIGH] [Review Context]\n```\n\n**Default Rule**:\n- Thresholds use strict > operator (not ≥)\n- 50% exactly → LOW\n- 100,000 exactly → LOW\n- 5 exactly → LOW\n- Flag these cases for user review with note in justification\n\n#### Edge Case 3: Conflicting Metrics (Multiple Percentages)\n\n**Scenario**: Multiple different percentage metrics in Business Value\n\n**Example**:\n- 70% cost reduction\n- 45% time savings\n- 60% efficiency improvement\n\n**Handling**:\n```\nℹ️ MULTIPLE METRICS: Value Delivery\n\nFound 3 percentage metrics in Business Value:\n• 70% cost reduction (Line 52)\n• 45% time savings (Line 53)\n• 60% efficiency improvement (Line 54)\n\nUsing maximum value approach:\nSelected: 70% cost reduction → HIGH Impact\n\nAlternative: Could use average (58.3%) → still HIGH\nAlternative: Could list all metrics in justification\n\nProceed with maximum value (70%)? [Yes] [Use Average] [Custom]\n```\n\n**Default Behavior**: Use maximum percentage value\n\n#### Edge Case 4: Non-Standard Document Structure\n\n**Scenario**: Document Index missing or section numbers non-standard\n\n**Handling**:\n1. **Fallback Detection**: Use grep to find sections by header text\n   ```bash\n   grep -n \"^## .*Executive Summary\" ARCHITECTURE.md\n   grep -n \"^### .*Primary Use Cases\" ARCHITECTURE.md\n   grep -n \"^## .*Component\" ARCHITECTURE.md\n   grep -n \"^## .*Technology Stack\" ARCHITECTURE.md\n   ```\n\n2. **Prompt User**:\n   ```\n   ⚠️ NON-STANDARD STRUCTURE\n\n   Document Index not found or sections not in expected locations.\n\n   Would you like me to:\n   1. Search for sections by header text (slower but works)\n   2. Update document to standard structure first\n   3. Manually specify section line ranges\n\n   Recommended: Option 2 (standardize structure)\n   ```\n\n3. **Graceful Degradation**: Calculate what's possible, note what's missing\n\n#### Edge Case 5: Section 2.2.1 Already Exists with Manual Overrides\n\n**Scenario**: User previously set manual override values in Section 2.2.1\n\n**Detection**:\nCheck if \"Calculation Method: Manual Override\" exists in Section 2.2.1\n\n**Handling**:\n```\n⚠️ MANUAL OVERRIDE DETECTED\n\nSection 2.2.1 was previously updated with manual overrides.\n\nCurrent Values (Manual):\n• Value Delivery: HIGH (manually set)\n• Scale: LOW (manually set)\n• Impacts: HIGH (manually set)\n\nNew Calculated Values (Automatic):\n• Value Delivery: HIGH (70% cost reduction)\n• Scale: HIGH (500,000 customers/day)  ← DIFFERS\n• Impacts: HIGH (8 components/technologies)\n\nDifferences found:\n⚠️ Scale changed from LOW → HIGH (new data: 500,000/day)\n\nWould you like to:\n[Accept New Values] [Keep Manual Overrides] [Review Changes] [Merge (keep manual where unchanged)]\n```\n\n**Default Behavior**: Present comparison, require user approval before overwriting manual overrides\n\n### Manual Override Workflow\n\n**User can manually override any metric classification:**\n\n```\nManual Override: Value Delivery\n────────────────────────────────────────────────────────────\nCalculated: HIGH (70% cost reduction)\n\nOverride Options:\n1. [Keep Calculated] - Use automatic calculation (HIGH)\n2. [Change to LOW] - Override to LOW impact\n3. [Custom Percentage] - Specify different percentage\n4. [Custom Justification] - Keep HIGH but change justification\n\nIf overriding, provide reason (for documentation):\n[Text input: \"Business value is delayed until Year 2\"]\n\nMethod will be marked as: \"Manual Override (2025-01-26)\"\n```\n\n**When Manual Override Applied**:\n- Update \"Calculation Method\" to \"Manual Override\"\n- Add note in justification: \"(Manual override: [reason])\"\n- Subsequent automatic calculations will prompt before overwriting\n\n### Best Practices for Design Drivers\n\n**DO:**\n- ✅ Calculate after major architecture changes (new components, technologies)\n- ✅ Recalculate quarterly during architecture reviews\n- ✅ Use metrics in stakeholder presentations and justifications\n- ✅ Document assumptions in justifications (which metric was used, why)\n- ✅ Update source sections (1, 2.3, 5, 8) before calculating for accuracy\n- ✅ Review calculation report carefully before applying\n\n**DON'T:**\n- ❌ Auto-calculate on every minor documentation update\n- ❌ Override thresholds without documentation\n- ❌ Ignore edge cases (flag for review, don't silently default)\n- ❌ Skip user review (always present findings before updating)\n- ❌ Forget to update \"Last Calculated\" date\n- ❌ Calculate with stale data (ensure source sections are current)\n\n### Integration with Existing Workflows\n\n**Metric Consistency Workflow Integration**:\n- Design Drivers calculation runs AFTER metric consistency check\n- If Section 1 metrics are updated, first sync duplicates, then calculate drivers\n- Ensures Design Drivers use most current metric values\n\n**Document Index Integration**:\n- Design Drivers insertion may shift Section 2.3 line numbers\n- Automatically trigger Document Index update if Section 2 grows >10 lines\n- Update index before final completion report\n\n**Architecture Review Integration**:\n- When user requests \"review\", \"audit\", or \"validate\" for ARCHITECTURE.md, follow the **Two-Phase Review & Audit Workflow**\n- Workflow is documented in: **REVIEW_AUDIT_WORKFLOW.md**\n- Phase 1 (Form Validation) must pass before Phase 2 (Content Improvement) runs\n- Workflow provides prioritized feedback: HIGH → MEDIUM → LOW criticality\n\n**Two-Phase Workflow Overview**:\n  ```\n  Phase 1: Form Validation (Blocking)\n  ☐ Section structure compliance (12 required sections)\n  ☐ Architecture type validation (META/3-TIER/MICROSERVICES/N-LAYER)\n  ☐ Architecture Principles enforcement (9 required principles)\n  ☐ Markdown formatting validation\n  ☐ Metric consistency check (Section 1 vs rest of document)\n\n  If Phase 1 passes → Proceed to Phase 2\n  If Phase 1 fails → User must fix ❌ issues before Phase 2 runs\n\n  Phase 2: Content Improvement (Prioritized)\n  ☐ HIGH: Missing implementation details, dishonest trade-offs, incomplete components\n  ☐ MEDIUM: Weak justifications, outdated references, missing cross-references\n  ☐ LOW: Formatting suggestions, clarity improvements, redundancy reduction\n\n  For complete workflow details, see: REVIEW_AUDIT_WORKFLOW.md\n  ```\n\n### Example: Complete Design Drivers Calculation\n\n**Scenario**: User requests architecture review for Task Scheduling System\n\n**Step-by-Step Execution**:\n\n1. **User Request**:\n   ```\n   User: \"Review the architecture documentation\"\n   ```\n\n2. **Detection & Prompt**:\n   ```\n   [Architecture review trigger detected]\n\n   As part of the architecture review, would you like me to calculate Design Drivers impact metrics?\n\n   Design Drivers assess:\n   • Value Delivery: Business value effectiveness\n   • Scale: Customer/transaction volume\n   • Impacts: Implementation complexity\n\n   [Calculate Now] [Skip] [Learn More]\n   ```\n\n3. **User Approves**:\n   ```\n   User: \"Calculate now\"\n   ```\n\n4. **Context-Efficient Data Loading**:\n   ```\n   Loading architecture data for Design Drivers calculation...\n\n   ✓ Document Index loaded (lines 1-21)\n   ✓ Section 1 Executive Summary loaded (lines 25-54)\n   ✓ Section 2.3 Use Cases loaded (lines 99-162)\n   ✓ Section 5 Component Details loaded (lines 456-675)\n   ✓ Section 8 Technology Stack loaded (lines 912-998)\n\n   Total lines loaded: 436 / 2,000 (78% reduction)\n   ```\n\n5. **Metric Extraction**:\n   ```\n   Extracting metrics from architecture sections...\n\n   Value Delivery:\n   ✓ Found: 70% cost reduction (Section 1, line 52)\n   ✓ Found: 60% time savings (Section 1, line 53)\n   ✓ Maximum: 70% → HIGH Impact (exceeds 50% threshold)\n\n   Scale:\n   ✓ Found: 500,000+ reminders per day (Section 2.3, line 141)\n   ✓ Found: 10,000+ concurrent jobs (Section 2.3, line 38)\n   ✓ Maximum: 500,000 → HIGH Impact (exceeds 100K threshold)\n\n   Impacts:\n   ✓ Components (Section 5): 5 subsections found\n   ✓ Technologies (Section 8): 3 table rows found\n   ✓ Total: 8 → HIGH Impact (exceeds 5 threshold)\n   ```\n\n6. **Present Findings**:\n   ```\n   ═══════════════════════════════════════════════════════════\n     DESIGN DRIVERS IMPACT METRICS CALCULATION\n   ═══════════════════════════════════════════════════════════\n   Calculation Date: 2025-01-26\n   Data Sources: Sections 1, 2.3, 5, 8\n   ═══════════════════════════════════════════════════════════\n\n   ## Value Delivery: HIGH\n   **Threshold**: >50% = High Impact\n   **Assessment**: 70% exceeds threshold\n   **Justification**: System delivers 70% cost reduction (Section 1, line 52)\n\n   ## Scale: HIGH\n   **Threshold**: >100K = High Impact\n   **Assessment**: 500,000 exceeds threshold\n   **Justification**: System impacts 500,000 customers/day (Section 2.3, line 141)\n\n   ## Impacts: HIGH\n   **Threshold**: >5 = High Impact\n   **Assessment**: 8 exceeds threshold\n   **Justification**: System requires 8 components/technologies (Section 5: 5, Section 8: 3)\n\n   ═══════════════════════════════════════════════════════════\n   SUMMARY: 3/3 HIGH - Strong business justification for architecture complexity\n   ═══════════════════════════════════════════════════════════\n\n   [Update Section 2.2.1] [Preview Changes] [Manual Override] [Skip]\n   ```\n\n7. **User Selects Update**:\n   ```\n   User: \"Update Section 2.2.1\"\n   ```\n\n8. **Apply Changes**:\n   ```\n   Updating Section 2.2.1 Design Drivers...\n\n   [Checking if section exists]\n   ✓ Section 2.2.1 not found - will insert new section\n\n   [Finding insertion point]\n   ✓ Section 2.2 ends at line 97\n   ✓ Section 2.3 starts at line 99\n   ✓ Insertion point: line 98\n\n   [Inserting Design Drivers subsection]\n   ✓ Inserted 22 lines at line 98\n   ✓ Section 2.3 renumbered (now starts at line 121)\n\n   [Updating Document Index]\n   ✓ Section 2 range updated: Lines 56-154 → Lines 56-176\n   ✓ Sections 2.3-12 ranges shifted by +22 lines\n   ✓ Index Last Updated: 2025-01-26\n   ```\n\n9. **Completion Report**:\n   ```\n   ═══════════════════════════════════════════════════════════\n     DESIGN DRIVERS UPDATE COMPLETE\n   ═══════════════════════════════════════════════════════════\n\n   ✓ Section 2.2.1 Design Drivers inserted at line 98\n   ✓ All three metrics calculated and applied\n   ✓ Document Index updated (Section 2: Lines 56-176)\n   ✓ Last Calculated: 2025-01-26\n\n   Summary of Metrics:\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n   Value Delivery:  HIGH   (70% cost reduction)\n   Scale:           HIGH   (500,000 customers/day)\n   Impacts:         HIGH   (8 components/technologies)\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n   Overall Design Impact: 3/3 HIGH\n\n   This indicates strong business justification for:\n   • Architecture complexity (8 components/technologies)\n   • Investment in scalability (500K customers/day)\n   • Development resources (70% cost reduction value)\n\n   ═══════════════════════════════════════════════════════════\n   ```\n\n### Performance & Context Optimization\n\n**Context Usage Comparison**:\n\n| Approach | Lines Loaded | Percentage |\n|----------|-------------|------------|\n| Full Document Load | 2,000+ | 100% |\n| Design Drivers (Context-Efficient) | ~400-500 | 20-25% |\n| **Savings** | **~1,500-1,600** | **75-80%** |\n\n**Sequential Loading Benefits**:\n- Load one section at a time (not all simultaneously)\n- Extract metrics immediately after loading\n- Clear section data before loading next\n- Minimize context window pressure\n- Faster execution with large documents\n\n**Optimization Strategies**:\n- Use Document Index for exact line ranges (no guessing)\n- Load only ±5-10 line buffers (minimal context)\n- Use Grep for initial detection (no loading required)\n- Cache Document Index in memory (reuse across phases)\n- Batch similar operations (all regex extractions together)\n\n---\n\n### Best Practices\n\n✅ **DO**:\n- Load specific sections using `Read` with offset/limit\n- Use `Grep` to search for keywords without loading full file\n- Work incrementally on one section at a time\n- Read the table of contents or first 50 lines to orient yourself\n\n❌ **DON'T**:\n- Read the entire ARCHITECTURE.md file unless creating it from scratch\n- Load multiple sections simultaneously unless they're small\n- Use full document reads for simple section updates\n- Assume section locations without checking first\n\n### Example Workflows\n\n**Task 1**: Update the Technology Stack section\n\n1. Read lines 1-50 to confirm document structure\n2. Use Grep to find \"## Section 8: Technology Stack\"\n3. Read ONLY Section 8 (estimated lines 1001-1150)\n4. Make edits using Edit tool\n5. Read ONLY the updated section to verify\n\n**Task 2**: Update Executive Summary metrics and ensure consistency\n\n1. User edits Section 1 Key Metrics (lines 31-38)\n2. Skill detects metric change automatically\n3. Scan document using Grep for all metric values\n4. Load context for each match (Read with ±5 line buffer)\n5. Generate consistency report with findings\n6. Present findings to user for review\n7. If user approves, batch update all locations\n8. Update Document Index if needed (>10 lines shifted)\n9. Report completion summary\n\nThese approaches keep context usage minimal while maintaining full editing capability.\n\n## Documentation Structure\n\nThis project uses **ARCHITECTURE_DOCUMENTATION_GUIDE.md** as the authoritative guide for creating and maintaining architecture documentation. This guide ensures consistency across all architecture documents.\n\n## When to Use the Guide\n\n### 1. Creating New Architecture Documents\nWhen starting a new system architecture document (ARCHITECTURE.md):\n- Follow the 12-section structure defined in ARCHITECTURE_DOCUMENTATION_GUIDE.md\n- Use the templates provided for each section\n- Maintain detailed coverage for: Layers, Components, Integration Points, Tech Stack, Security, and Performance\n- Keep Executive Summary, System Overview, and Principles concise\n- Reference ADR_GUIDE.md for architectural decision documentation\n\n### 2. Documenting Existing Projects\nWhen documenting an existing system:\n- Use ARCHITECTURE_DOCUMENTATION_GUIDE.md as the structure template\n- Focus on capturing current state accurately (not ideal state)\n- Prioritize Sections 4-10 (core architecture sections)\n- Document actual technologies, versions, and configurations in use\n- Create ADRs for past decisions if context is available\n\n### 3. Maintaining Architecture Documentation\nWhen updating existing architecture docs:\n- Follow the same section structure from ARCHITECTURE_DOCUMENTATION_GUIDE.md\n- Keep core sections (Layers, Components, Security, Performance) detailed and current\n- Update version numbers and technology stack as system evolves\n- Add new ADRs for architectural changes\n- Review quarterly for accuracy\n\n## Key Principles\n\n1. **Use Templates**: Follow section templates from ARCHITECTURE_DOCUMENTATION_GUIDE.md\n2. **Stay Concise**: Keep Sections 1-3, 6, 12 brief; detail in Sections 4-5, 7-11\n3. **Separate ADRs**: Use ADR_GUIDE.md for decision records, link from main doc\n4. **Maintain Accuracy**: Document actual state, include version numbers\n5. **Context Efficiency**: Balance detail with readability for Claude Code context\n\n## Architecture Principles Enforcement (Section 3)\n\n**CRITICAL**: Section 3 must include **9 required principles** in exact order, each with Description, Implementation, and Trade-offs.\n\n### Required Principles\n\n1. Separation of Concerns\n2. High Availability\n3. Scalability First\n4. Security by Design\n5. Observability\n6. Resilience\n7. Simplicity\n8. Cloud-Native\n9. Open Standards\n10. Decouple Through Events (OPTIONAL - apply where async provides clear decoupling benefits)\n\n### Quick Validation\n\n✅ All 9 core principles present in order\n✅ Each has Description + Implementation + Trade-offs\n✅ Implementation is system-specific (not generic placeholders)\n✅ Trade-offs honestly assess costs\n✅ Decouple Through Events (#10) only where async benefits temporal decoupling\n\n### Detailed Rules\n\nFor complete principle definitions, required structure, validation checklist, common mistakes, and updating workflows:\n→ **VALIDATIONS.md** § Architecture Principles Enforcement\n→ **ARCHITECTURE_DOCUMENTATION_GUIDE.md** § Section 3: Architecture Principles\n\n## Required Section Names (Strict Enforcement)\n\n**CRITICAL**: All ARCHITECTURE.md documents MUST use these **12 exact section names** in this **exact order**.\n\n### Standard Section Names\n\n1. Executive Summary\n2. System Overview\n3. Architecture Principles\n4. Architecture Layers\n5. Component Details\n6. Data Flow Patterns (OPTIONAL - omit for simple systems, renumber 7→6, 8→7, etc.)\n7. Integration Points\n8. Technology Stack\n9. Security Architecture\n10. Scalability & Performance\n11. Operational Considerations\n12. Architecture Decision Records (ADRs)\n\n### Format Requirement\n\nUse exact format: `## [NUMBER]. [SECTION NAME]`\n\n**Examples**:\n- ✅ `## 1. Executive Summary`\n- ✅ `## 12. Architecture Decision Records (ADRs)`\n- ❌ `## Executive Summary` (missing number)\n- ❌ `## 12. ADR References` (wrong name)\n\n### Verification Command\n\n```bash\ngrep -n \"^## [0-9]\" ARCHITECTURE.md\n```\n\n### Detailed Rules\n\nFor complete section name list, common mistakes, optional sections, renumbering workflow, and validation checklist:\n→ **VALIDATIONS.md** § Section Name Enforcement\n→ **ARCHITECTURE_DOCUMENTATION_GUIDE.md** § Document Structure Overview\n\n---\n\n## Workflow 7: Informational Query (Answer Questions About Architecture)\n\n### When to Use\n\nThis workflow is activated when users ask questions about the architecture documented in ARCHITECTURE.md:\n- Understanding how the system works\n- Learning about specific architectural decisions\n- Querying technology choices, patterns, or principles\n- Understanding data flows, integrations, or components\n\n### Automatic Invocation Conditions\n\nThis workflow is **automatically invoked** when:\n1. User asks an architectural question (authentication, scaling, components, tech stack, etc.)\n2. **AND** an ARCHITECTURE.md file exists in the current project\n\nIf ARCHITECTURE.md does not exist, this workflow is NOT invoked, allowing general architectural guidance.\n\n**Detection Logic**:\n```python\n# Check if ARCHITECTURE.md exists before answering architectural questions\narchitecture_file_exists = file_exists(\"ARCHITECTURE.md\")\n\nif architecture_file_exists:\n    # Invoke Workflow 7: Use ARCHITECTURE.md as source of truth\n    load_architecture_and_answer()\nelse:\n    # Don't invoke skill - provide general guidance\n    pass\n```\n\n### Prerequisites\n\n- ARCHITECTURE.md file exists in the project\n- Document has valid structure (12 sections)\n- Document Index is present (lines 5-21 typically)\n\n### Process\n\n#### Step 1: Detect Query Intent\n\nClassify the user's question to determine which section(s) to reference:\n\n- **Authentication/Security** → Section 9 (Security Considerations)\n- **Data flow/pipelines** → Section 6 (Data Flow)\n- **Components/services** → Section 5 (Component Details)\n- **Technology stack** → Section 8 (Technology Stack)\n- **Integrations** → Section 7 (Integration Points)\n- **Scaling/performance** → Section 10 (Scalability & Performance)\n- **Deployment** → Section 4 (Architecture Layers/Deployment)\n- **Patterns/principles** → Section 3 (Architecture Principles)\n- **Problem/solution** → Section 2 (System Overview)\n- **Operations** → Section 11 (Operational Considerations)\n- **Decisions/trade-offs** → Section 12 (Architecture Decision Records)\n- **General overview** → Section 1 (Executive Summary)\n\n**See QUERY_SECTION_MAPPING.md for detailed query-to-section mapping guide.**\n\n#### Step 2: Load Document Index\n\nUse context-efficient loading to get the Document Index:\n\n```python\n# Load Document Index (lines 1-50)\nindex_content = Read(file_path=\"ARCHITECTURE.md\", offset=1, limit=50)\ndoc_index = parse_document_index(index_content)\n```\n\n**Expected Index Format**:\n```markdown\n## Document Index\n\n**Quick Navigation:**\n- [Section 1: Executive Summary](#1-executive-summary) → Lines 1-80\n- [Section 2: System Overview](#2-system-overview) → Lines 81-150\n...\n- [Section 12: Architecture Decision Records](#12-architecture-decision-records-adrs) → Lines 1951-end\n\n**Index Last Updated:** YYYY-MM-DD\n```\n\n#### Step 3: Load Relevant Section(s)\n\nUsing index-based loading for efficiency:\n\n```python\n# Get section range from Document Index\nsection_range = doc_index[section_number]\n\n# Calculate load parameters\nbuffer = 20  # Standard buffer for context\noffset = section_range[\"start\"] - buffer - 1  # -1 for zero-indexing\nlimit = (section_range[\"end\"] - section_range[\"start\"]) + (2 * buffer)\n\n# Load section\nsection_content = Read(file_path=\"ARCHITECTURE.md\", offset=offset, limit=limit)\n```\n\n**Example**:\n```python\n# User asks: \"What technologies do we use for the backend?\"\n# Detected section: Section 8 (Technology Stack)\n\n# Index shows: Section 8 → Lines 912-998\nbuffer = 20\noffset = 912 - 20 - 1 = 891\nlimit = (998 - 912) + (2 * 20) = 86 + 40 = 126\n\n# Load: Read(file_path=\"ARCHITECTURE.md\", offset=891, limit=126)\n# This reads lines 891-1017 (Section 8 with 20-line buffers)\n```\n\n**Multi-Section Queries**:\n\nFor questions requiring multiple sections:\n\n```python\n# User asks: \"How does authentication work with external systems?\"\n# Detected sections: Section 9 (Security) + Section 7 (Integrations)\n\n# Load Section 9 first\nsection_9_content = Read(file_path=\"ARCHITECTURE.md\", offset=section_9_start-20-1, limit=section_9_length+40)\n\n# Load Section 7 second\nsection_7_content = Read(file_path=\"ARCHITECTURE.md\", offset=section_7_start-20-1, limit=section_7_length+40)\n\n# Synthesize answer from both sections\n```\n\n#### Step 4: Extract Relevant Information\n\n- Search for keywords from user query within the loaded section\n- Identify specific subsections that address the question\n- Calculate line numbers for citations\n\n**Line Number Calculation**:\n```python\n# Calculate absolute line numbers for citations\nsubsection_start = section_range[\"start\"] + relative_offset\nsubsection_end = subsection_start + content_length\n\n# Example: Found answer in Section 9.2 Authentication\n# Section 9 starts at line 1301\n# Subsection 9.2 is at relative offset 42 lines into the section\n# Absolute line: 1301 + 42 = 1343\n```\n\n#### Step 5: Respond with Citations\n\n**Standard Format**: Answer first, then footer citation\n\n**Template**:\n```\n[Answer content based on ARCHITECTURE.md]\n\n**Source**: ARCHITECTURE.md Section N (Section Name), lines X-Y\n```\n\n**Single-Section Answer Example**:\n```\nUser: \"How do we handle authentication?\"\n\nResponse:\nThe system uses OAuth 2.0 for authentication with JWT tokens for API access.\nMulti-factor authentication (MFA) is required for administrative users, and\nsession tokens expire after 24 hours of inactivity.\n\n**Source**: ARCHITECTURE.md Section 9 (Security Considerations → Authentication &\nAuthorization), lines 1090-1114\n```\n\n**Multi-Section Answer Example**:\n```\nUser: \"What's the backend tech stack and how is it deployed?\"\n\nResponse:\nThe backend is built with Java 17 and Spring Boot 3.2, using PostgreSQL 15 for the\nprimary database and Redis 7.0 for caching. The system is deployed on AWS using\ncontainerized services via ECS with auto-scaling enabled for high availability.\n\n**Sources**:\n- ARCHITECTURE.md Section 8 (Technology Stack → Backend), lines 901-925\n- ARCHITECTURE.md Section 8 (Technology Stack → Data Tier), lines 960-970\n- ARCHITECTURE.md Section 4 (Architecture Layers → Cloud Infrastructure), lines 350-375\n```\n\n#### Step 6: Handle Missing Information\n\nIf the question cannot be answered from ARCHITECTURE.md:\n\n**Response Format**:\n1. Provide general architectural guidance from knowledge base\n2. Clearly tag that it's NOT from the documented architecture\n3. Recommend documenting it in the appropriate section\n\n**Example**:\n```\nUser: \"What's our disaster recovery RTO?\"\n\nResponse:\nBased on the 99.99% availability SLA documented in Section 10, a typical RTO would be\n4 hours for Tier 1 systems. Common industry practice for this availability tier includes:\n- RTO: 4 hours\n- RPO: 1 hour\n- Quarterly DR testing\n\n⚠️ **Recommendation**: This information is not currently documented in ARCHITECTURE.md.\nConsider adding disaster recovery procedures to Section 11.4 (Operational Considerations →\nDisaster Recovery) including:\n- Recovery Time Objective (RTO)\n- Recovery Point Objective (RPO)\n- Backup strategies\n- Failover procedures\n- DR testing schedule\n\nWould you like me to help document these DR procedures?\n\n**Source**: General architectural guidance (not documented in ARCHITECTURE.md)\n```\n\n**Missing Information Template**:\n```\n[General architectural answer based on industry best practices]\n\n⚠️ **Recommendation**: This information is not documented in ARCHITECTURE.md.\nConsider adding to Section N.M ([Section Name → Subsection Name]).\n\nWould you like me to help document this?\n\n**Source**: General architectural guidance (not documented in ARCHITECTURE.md)\n```\n\n### Context Efficiency Guidelines\n\n**Buffer Sizes**:\n- Standard queries: ±20 lines\n- Narrow queries (specific config): ±10 lines\n- Cross-section queries: ±20 lines per section\n\n**Loading Strategy**:\n- Load Document Index once, cache in memory\n- Load only relevant sections, not full document\n- Use sequential loading (one section at a time) for multi-section queries\n- Minimize total lines loaded (aim for <300 lines per query)\n\n**Performance Comparison**:\n\n| Approach | Lines Loaded | Context Usage |\n|----------|-------------|---------------|\n| Full Document Load | 2,000+ | 100% |\n| Workflow 7 (Single Section) | ~100-150 | 5-7.5% |\n| Workflow 7 (Multi-Section) | ~200-300 | 10-15% |\n| **Savings** | **~1,700-1,800** | **85-90%** |\n\n### Best Practices\n\n**DO:**\n- ✅ Always check if ARCHITECTURE.md exists before invoking this workflow\n- ✅ Use Document Index for exact section ranges\n- ✅ Load only relevant sections with minimal buffers\n- ✅ Include line number citations in all responses\n- ✅ Explicitly state when information is not documented\n- ✅ Offer to help update documentation when gaps are found\n- ✅ Use footer citations (answer first, source last)\n\n**DON'T:**\n- ❌ Load full document for simple queries\n- ❌ Provide answers without citations when ARCHITECTURE.md exists\n- ❌ Guess or assume content without reading the document\n- ❌ Mix documented architecture with general guidance (clearly separate)\n- ❌ Skip buffer context (always load ±10-20 lines)\n\n### Example Workflows\n\n#### Example 1: Question Fully Answered (Single Section)\n\n**User**: \"What databases do we use?\"\n\n**Process**:\n1. Detect query intent → Section 8 (Technology Stack)\n2. Load Document Index → Section 8: Lines 912-998\n3. Load Section 8 with buffer → Read(offset=891, limit=126)\n4. Extract database information → PostgreSQL 15, Redis 7.0, Elasticsearch 8.x\n5. Calculate line numbers → Lines 960-970\n\n**Response**:\n```\nThe system uses three database technologies:\n\n**Relational Database**: PostgreSQL 15 for primary transactional data\n**Caching**: Redis 7.0 for session management and query caching\n**Search**: Elasticsearch 8.x for full-text search and analytics\n\n**Source**: ARCHITECTURE.md Section 8 (Technology Stack → Data Tier), lines 960-970\n```\n\n#### Example 2: Information Missing (With Recommendation)\n\n**User**: \"What's our backup retention policy?\"\n\n**Process**:\n1. Detect query intent → Section 11 (Operational Considerations)\n2. Load Document Index → Section 11: Lines 1751-1950\n3. Load Section 11 with buffer → Read(offset=1730, limit=239)\n4. Search for backup/retention information → Not found\n5. Provide general guidance + recommendation\n\n**Response**:\n```\nBased on industry best practices for systems with 99.99% availability, typical backup\nretention policies include:\n- Daily backups: Retained for 30 days\n- Weekly backups: Retained for 90 days\n- Monthly backups: Retained for 1 year\n- Annual backups: Retained for 7 years (compliance)\n\n⚠️ **Recommendation**: This information is not currently documented in ARCHITECTURE.md.\nConsider adding backup retention policies to Section 11.3 (Operational Considerations →\nBackup & Recovery) including:\n- Backup frequency (full vs. incremental)\n- Retention periods by backup type\n- Storage location and redundancy\n- Recovery testing schedule\n\nWould you like me to help document the backup retention policy?\n\n**Source**: General architectural guidance (not documented in ARCHITECTURE.md)\n```\n\n#### Example 3: Multi-Section Query\n\n**User**: \"How does user authentication integrate with our external systems?\"\n\n**Process**:\n1. Detect query intent → Section 9 (Security) + Section 7 (Integrations)\n2. Load Document Index\n3. Load Section 9 → Read(offset=1280, limit=269)\n4. Load Section 7 → Read(offset=980, limit=189)\n5. Synthesize answer from both sections\n6. Calculate line numbers for both citations\n\n**Response**:\n```\nUser authentication uses OAuth 2.0 with JWT tokens, requiring MFA for administrative\nusers. External system integrations leverage this authentication framework through\nAPI Gateway integration.\n\nFor external systems, authentication tokens are validated at the API Gateway layer\nbefore requests are forwarded to downstream services. Integration with Salesforce\nuses OAuth 2.0 client credentials flow, while the payment gateway integration uses\nmutual TLS certificates for secure communication.\n\n**Sources**:\n- ARCHITECTURE.md Section 9 (Security Considerations → Authentication), lines 1090-1114\n- ARCHITECTURE.md Section 7 (Integration Points → External Systems), lines 1025-1048\n```\n\n### Query-to-Section Mapping Reference\n\nFor detailed query-to-section mapping, including:\n- Common question patterns for each section\n- Example queries and expected section targets\n- Multi-section query scenarios\n- Edge cases and ambiguous queries\n\n**See: QUERY_SECTION_MAPPING.md**\n\n### Example Conversations\n\n#### Example 1: Informational Query - Single Section\n\n**User**: \"What technologies do we use for the backend?\"\n\n**Skill Response**:\n\n*Step 1: Detect query intent → Section 8 (Technology Stack)*\n*Step 2: Load Document Index (lines 1-50)*\n*Step 3: Load Section 8 with buffer (lines 891-1017)*\n*Step 4: Extract backend technologies*\n\nAccording to ARCHITECTURE.md Section 8 (Technology Stack):\n\n**Backend Stack**:\n- Language: Java 17 (LTS)\n- Framework: Spring Boot 3.2\n- Build Tool: Maven 3.9\n- Testing: JUnit 5, Mockito, Spring Test\n- Code Quality: SonarQube\n\n**Data Tier**:\n- Relational Database: PostgreSQL 15\n- Caching: Redis 7.0\n- Search: Elasticsearch 8.x\n\n**Source**: ARCHITECTURE.md Section 8 (Technology Stack → Backend & Data Tier), lines 901-970\n\n---\n\n#### Example 2: Informational Query - Information Missing\n\n**User**: \"What's our disaster recovery plan?\"\n\n**Skill Response**:\n\n*Step 1: Detect query intent → Section 11 (Operational Considerations)*\n*Step 2: Load Document Index*\n*Step 3: Load Section 11 (lines 1730-1969)*\n*Step 4: Search for disaster recovery information → Not found*\n*Step 5: Provide general guidance + recommendation*\n\nBased on the 99.99% availability SLA documented in Section 10, typical disaster recovery procedures for this tier include:\n\n- **RTO (Recovery Time Objective)**: 4 hours\n- **RPO (Recovery Point Objective)**: 1 hour\n- **Backup frequency**: Continuous replication + daily snapshots\n- **Failover**: Automated multi-region failover\n- **Testing**: Quarterly DR drills\n\n⚠️ **Recommendation**: This information is not currently documented in ARCHITECTURE.md.\n\nConsider adding disaster recovery procedures to Section 11.4 (Operational Considerations → Disaster Recovery) including:\n- Recovery Time Objective (RTO)\n- Recovery Point Objective (RPO)\n- Backup strategies and retention\n- Failover procedures\n- DR testing schedule\n\nWould you like me to help document these DR procedures?\n\n**Source**: General architectural guidance (not documented in ARCHITECTURE.md)\n\n---\n\n#### Example 3: Informational Query - Multi-Section\n\n**User**: \"How does user authentication integrate with our external systems?\"\n\n**Skill Response**:\n\n*Step 1: Detect query intent → Section 9 (Security) + Section 7 (Integrations)*\n*Step 2: Load Document Index*\n*Step 3: Load Section 9 (lines 1280-1569)*\n*Step 4: Load Section 7 (lines 980-1169)*\n*Step 5: Synthesize answer from both sections*\n\nUser authentication uses OAuth 2.0 with JWT tokens for API access. Multi-factor authentication (MFA) is required for administrative users, and session tokens expire after 24 hours of inactivity.\n\nFor external system integrations:\n\n**API Gateway Integration**: Authentication tokens are validated at the API Gateway layer before requests are forwarded to downstream services. The gateway enforces token expiration and refresh policies.\n\n**Salesforce Integration**: Uses OAuth 2.0 client credentials flow for service-to-service authentication. Tokens are cached for 30 minutes to reduce authentication overhead.\n\n**Payment Gateway Integration**: Uses mutual TLS certificates for secure communication. Certificate rotation is automated and occurs every 90 days.\n\nAll external integrations log authentication events to the central security monitoring system for audit and threat detection.\n\n**Sources**:\n- ARCHITECTURE.md Section 9 (Security Architecture → Authentication & Authorization), lines 1090-1114\n- ARCHITECTURE.md Section 7 (Integration Points → External Systems), lines 1025-1075\n\n---\n\n#### Example 4: Standard Workflow - Creating Architecture Documentation\n\n**User**: \"Create architecture documentation for my microservices system\"\n\n**Skill Response**:\n\n*Detects new ARCHITECTURE.md creation → Invokes Architecture Type Selection Workflow*\n\nI'll help you create architecture documentation for your microservices system.\n\n📐 **Architecture Type Selection**\n\nBefore creating your ARCHITECTURE.md, please select the architecture type that best describes your system:\n\n**1. META Architecture** (6-Layer Enterprise)\n   - Best for: Large enterprise systems, financial services, complex integrations\n   - Layers: Channels → UX → Business Scenarios → Integration → Domain → Core\n   - Complexity: Very High\n   - Team Size: Large (10+)\n\n**2. 3-Tier Architecture** (Classic Web Application)\n   - Best for: Web apps, REST APIs, standard CRUD systems\n   - Tiers: Presentation → Application/Business Logic → Data\n   - Complexity: Low\n   - Team Size: Small-Medium (2-8)\n\n**3. Microservices Architecture** (Cloud-Native Distributed)\n   - Best for: Cloud-native systems, independently deployable services\n   - Components: API Gateway → Services → Data Stores → Event Bus\n   - Complexity: High\n   - Team Size: Large (10+)\n\n**4. N-Layer Architecture** (Customizable Patterns)\n   - Best for: DDD, Clean Architecture, Hexagonal Architecture\n   - Patterns: 4-Layer DDD, 5-Layer Extended, Clean Architecture, Hexagonal\n   - Complexity: Medium-High\n   - Team Size: Medium (4-10)\n\n**Which architecture type best describes your system? (1-4)**\n\n*User selects: \"3\" (Microservices)*\n\nPerfect! I'll create your ARCHITECTURE.md using the Microservices Architecture template.\n\n*Loads templates/SECTION_4_MICROSERVICES.md and templates/SECTION_5_MICROSERVICES.md*\n*Creates ARCHITECTURE.md with:*\n- *Standard Sections 1-3*\n- *Microservices Section 4 (API Gateway, Service Mesh, Services, Event Bus)*\n- *Microservices Section 5 (Service catalog format)*\n- *Standard Sections 6-12*\n- *Metadata comment: `<!-- ARCHITECTURE_TYPE: MICROSERVICES -->`*\n\n✓ Created ARCHITECTURE.md with Microservices Architecture structure\n\nThe document includes:\n- Document Index (lines 5-21) for context-efficient navigation\n- Section 4: Microservices architecture layers (API Gateway, Service Mesh, Services, Event Bus)\n- Section 5: Service catalog template (ready for your services)\n- Architecture type metadata for future validation\n\nNext steps:\n1. Fill in Section 1 (Executive Summary) with your system overview\n2. Document your microservices in Section 5\n3. Add your technology stack to Section 8\n4. Define integration points in Section 7\n\nWould you like help filling in any specific section?\n\n---\n\n#### Example 5: Metric Consistency Workflow\n\n**User**: \"Update the job execution capacity to 700 TPS in the Executive Summary\"\n\n**Skill Response**:\n\n*Uses Edit tool to change line 33: \"500 TPS\" → \"700 TPS\"*\n\n✓ Updated line 33: Design Capacity - Job Execution: 700 TPS\n\n*Automatic audit triggered because Section 1 Key Metrics was edited*\n\nNow checking for metric consistency across the document...\n\n*Scans document for references to old value (500 TPS)*\n*Found at: Line 787, Line 1368*\n*Loads context around each match*\n\n═══════════════════════════════════════════════════════════\n   METRIC CONSISTENCY AUDIT REPORT\n═══════════════════════════════════════════════════════════\nTriggered by: Executive Summary edit (Line 33)\nMetric Changed: Job Execution Capacity (500 TPS → 700 TPS)\n═══════════════════════════════════════════════════════════\n\n## ⚠️ Outdated References Found\n\n| Location | Section | Current Value | Should Be | Context |\n|----------|---------|---------------|-----------|---------|\n| Line 787 | Section 6: Data Flow Patterns | 500 TPS capacity | 700 TPS | \"Performance: p50 = 40ms, p95 = 100ms, p99 = 200ms \\| 500 TPS capacity\" |\n| Line 1368 | Section 10: Scalability & Performance | 500 | 700 | Throughput table: \"Job Execution (TPS) \\| 500 \\| 1000 \\| 2000\" |\n\n═══════════════════════════════════════════════════════════\nSUMMARY: Found 2 locations with outdated metric value\n═══════════════════════════════════════════════════════════\n\nWould you like me to update both locations to 700 TPS?\n\nOptions:\n1. [Yes - Update All] - Apply changes to both locations\n2. [Preview Changes] - Show me exactly what will change\n3. [Manual Selection] - Let me choose individually\n4. [No Thanks] - I'll handle this manually\n\n*User selects: \"Preview changes first\"*\n\nHere's a preview of the changes I'll make:\n\n════════════════════════════════════════════════════════════\nCHANGE 1 of 2: Line 787 (Section 6: Data Flow Patterns)\n════════════════════════════════════════════════════════════\n\nCurrent:\n**Performance**: p50 = 40ms, p95 = 100ms, p99 = 200ms | 500 TPS capacity\n\nWill become:\n**Performance**: p50 = 40ms, p95 = 100ms, p99 = 200ms | 700 TPS capacity\n\n════════════════════════════════════════════════════════════\nCHANGE 2 of 2: Line 1368 (Section 10: Throughput Table)\n════════════════════════════════════════════════════════════\n\nCurrent:\n| Job Execution (TPS) | 500 | 1000 | 2000 | Downstream domain services |\n\nWill become:\n| Job Execution (TPS) | 700 | 1000 | 2000 | Downstream domain services |\n\n════════════════════════════════════════════════════════════\n\nProceed with both changes? [Yes/No/Choose Individually]\n\n*User approves: \"Yes\"*\n\nApplying metric consistency updates...\n\n✓ Updated line 787: \"500 TPS capacity\" → \"700 TPS capacity\"\n✓ Updated line 1368: Throughput table \"500\" → \"700\"\n✓ Document Index is still accurate (no update needed)\n\n═══════════════════════════════════════════════════════════\n   METRIC CONSISTENCY UPDATE COMPLETE\n═══════════════════════════════════════════════════════════\n\nSummary of Changes:\n✓ Executive Summary (Line 33): 500 TPS → 700 TPS\n✓ Section 6 Data Flow (Line 787): 500 TPS → 700 TPS\n✓ Section 10 Throughput Table (Line 1368): 500 → 700\n\nTotal Locations Updated: 3\nDocument Index: No update needed\nAll references to Job Execution Capacity are now consistent.\n\n═══════════════════════════════════════════════════════════\n\n---\n\n## Workflow 8: Presentation Generation (Generate Architecture Presentations)\n\n**⚡ Auto-triggers**: This workflow automatically activates when presentation-related keywords are detected (see Automatic Workflow Detection section above).\n\n### When to Use\n\nThis workflow is activated when users request presentation generation from ARCHITECTURE.md:\n- \"Generate architecture presentation\"\n- \"Create PowerPoint from architecture\"\n- \"Generate presentation for [stakeholder]\"\n- \"Create slides for architecture review\"\n- User references: \"business presentation\", \"compliance review deck\", \"architecture overview slides\"\n\n### Activation Triggers\n\n**Automatic Invocation:**\n- User asks to \"generate presentation\", \"create slides\", \"make PowerPoint\", \"create pptx\"\n- User specifies stakeholder: \"business stakeholders\", \"architecture team\", \"compliance review\"\n- User specifies language: \"presentación en español\", \"presentation in English\"\n\n**Manual Invocation:**\n- User explicitly: \"Run presentation generation workflow\"\n- User references: `/workflow presentation`\n\n### Prerequisites\n\n- **ARCHITECTURE.md file exists** in the project\n- Document has **valid 12-section structure**\n- **Document Index is present** (lines 1-50 typically)\n- **Bun 1.0+** runtime installed (PowerPoint generation uses Bun/TypeScript with officegen)\n\n### Step-by-Step Process\n\n#### Step 1: Detect Request & Present Stakeholder Options\n\nWhen presentation generation is requested, present the following options:\n\n```\n📊 **Architecture Presentation Generation**\n\nI'll generate a PowerPoint presentation from your ARCHITECTURE.md file.\n\n**Step 1: Select Stakeholder Type**\n\nWho is the target audience for this presentation?\n\n1. **Business Stakeholders** - Focus on value, ROI, business metrics, use cases\n2. **Architecture Team** - Technical details, components, patterns, decisions\n3. **Compliance/Governance** - Security, operational standards, SLAs, controls\n\n**Please select: 1, 2, or 3**\n```\n\n**Stakeholder Focus Areas**:\n\n| Stakeholder | Focus | Primary Sections | Slide Count |\n|-------------|-------|------------------|-------------|\n| Business | Business value, ROI, metrics, use cases | 1, 2, 10, 11 | ~10 slides |\n| Architecture | Technical design, components, patterns | 3, 4, 5, 6, 7, 8, 12 | ~12 slides |\n| Compliance | Security, governance, standards | 7, 8, 9, 10, 11, 12 | ~11 slides |\n\n#### Step 2: Language Selection\n\nAfter stakeholder selection:\n\n```\n**Step 2: Select Language**\n\nWhich language should the presentation use?\n\n1. **English (EN)** - Default\n2. **Spanish (ES)** - Español\n\n**Please select: 1 or 2** (or type: en/es)\n```\n\n**Translation Scope**:\n- ✅ **Translate**: Slide titles, section headers, labels, UI elements\n- ❌ **Do NOT translate**: System names, component names, technologies, metrics, code snippets\n\n#### Step 3: Confirmation\n\n```\n**Step 3: Confirmation**\n\nI'll generate a presentation with these settings:\n- Stakeholder: [Business/Architecture/Compliance]\n- Language: [English/Spanish]\n- Slides: ~10-12 slides (~15 minutes)\n- Output: /presentations/ARCHITECTURE_[Type]_[Lang].pptx\n\nProceed with generation? [Yes/No]\n```\n\n#### Step 4: Load Document Index\n\n**Process**:\n1. Read lines 1-50 of ARCHITECTURE.md\n2. Parse Document Index to extract section line ranges\n3. Validate 12-section structure\n4. Extract system name from first heading\n\n**Fallback**: If Document Index not found, use default line ranges with warning\n\n#### Step 5: Load Required Sections Incrementally\n\n**Context-Efficient Loading**:\n- Load only sections required for the selected stakeholder\n- Use ±10 line buffer around each section\n- Minimize total lines loaded (50-80% reduction vs. full document)\n\n**Sections by Stakeholder**:\n- **Business**: Sections 1, 2, 10, 11 (~400 lines, 80% reduction)\n- **Architecture**: Sections 3, 4, 5, 6, 7, 8, 12 (~1000 lines, 50% reduction)\n- **Compliance**: Sections 7, 8, 9, 10, 11, 12 (~700 lines, 65% reduction)\n\n#### Step 6: Generate Summaries Using LLM (NEW - Recommended)\n\n**IMPORTANT**: Use LLM capabilities to generate slide summaries instead of regex extraction.\n\n**Process**:\n1. Load slide template for stakeholder type\n2. For each content slide in template:\n   - Identify `data_sources` from slide config (section numbers)\n   - Read those sections from ARCHITECTURE.md\n   - Generate summary using LLM based on slide type + stakeholder\n   - Format as 3-6 bullet points\n3. Save all summaries to JSON file\n\n**Summarization Prompts by Slide Type**:\n\n```\nExecutive Summary (Slide 3):\n\"Summarize the key metrics and system purpose in 3-4 bullet points for [stakeholder] stakeholders. Focus on quantifiable metrics and business value. Language: [language]\"\n\nArchitecture Principles (Slide 4):\n\"List the top 5 architecture principles from this content. For each, provide the principle name and a 1-sentence description. Language: [language]\"\n\nComponents (Slide 6):\n\"Summarize the main system components in 4-5 bullet points. Focus on component responsibilities and interactions. Language: [language]\"\n\nTechnology Stack (Slide 7):\n\"List the key technologies used, organized by category (Backend, Frontend, Data, Infrastructure). Keep it concise. Language: [language]\"\n\nData Flow (Slide 8):\n\"Describe the main data flow patterns in 3-4 bullet points. Focus on how data moves through the system. Language: [language]\"\n\nIntegration Points (Slide 9):\n\"List the main external integrations in 4-5 bullet points. Include system names and integration methods. Language: [language]\"\n\nSecurity Architecture (Slide 10):\n\"Summarize security controls in 4-5 bullet points. Cover authentication, encryption, and access controls. Language: [language]\"\n\nADRs (Slide 11):\n\"List the top 5 most important architecture decisions in format: ADR-### : [Decision title]. Language: [language]\"\n```\n\n**Output Format (JSON)**:\n```json\n{\n  \"3\": [\"Metric bullet 1\", \"Metric bullet 2\", \"Metric bullet 3\"],\n  \"4\": [\"Principle 1\", \"Principle 2\", \"Principle 3\"],\n  \"5\": [\"Layer description 1\", \"Layer description 2\"],\n  ...\n}\n```\n\n**Save to**: `/tmp/presentation_summaries_{stakeholder}_{language}.json`\n\n**Fallback**: If LLM summarization fails, presentation-generator.ts will fall back to regex extraction automatically.\n\n#### Step 7: Load Language Translations\n\n**Process**:\n1. Load appropriate language JSON file (language_en.json or language_es.json)\n2. Initialize LanguageManager with translations\n3. Prepare slide titles, labels, and UI strings in target language\n\n**Translation Files Location**:\n- `/skills/architecture-docs/presentation/language_en.json`\n- `/skills/architecture-docs/presentation/language_es.json`\n\n#### Step 8: Generate Slides Using presentation-generator.ts\n\n**Command to Execute**:\n```bash\nbun run skills/architecture-docs/utils/presentation-generator.ts ARCHITECTURE.md \\\n  --stakeholder [business|architecture|compliance] \\\n  --language [en|es] \\\n  --summaries /tmp/presentation_summaries_{stakeholder}_{language}.json\n```\n\n**Slide Generation Process**:\n1. Initialize PowerPoint presentation (10\" x 7.5\")\n2. Load slide template for stakeholder type\n3. Load LLM-generated summaries from JSON file\n4. Build slides sequentially using SlideBuilder:\n   - Title slide with system name and stakeholder subtitle\n   - Agenda slide with translated items\n   - Content slides using LLM summaries (no regex extraction)\n   - Summary & Q&A slide\n\n**Slide Primitives** (from create-presentation.ts):\n- `addTitleSlide()` - Title/cover slides\n- `addContentSlide()` - Content slides with title/subtitle\n- `addBulletText()` - Bullet points (configurable font, color)\n- `addBox()` - Colored boxes for highlights\n- Color scheme: BLUE (#1E3A8A), GREEN (#10B981), GRAY (#6B7280)\n\n**Note**: If `--summaries` parameter is not provided, presentation-generator.ts will automatically fall back to regex-based extraction.\n\n#### Step 9: Save Presentation\n\n**Output Path**: `/presentations/ARCHITECTURE_{Type}_{Lang}.pptx`\n\n**Examples**:\n- `/presentations/ARCHITECTURE_Business_EN.pptx`\n- `/presentations/ARCHITECTURE_Architecture_ES.pptx`\n- `/presentations/ARCHITECTURE_Compliance_EN.pptx`\n\n**Process**:\n1. Ensure /presentations/ directory exists (create if needed)\n2. Save PowerPoint file with naming convention\n3. Verify file creation\n\n#### Step 10: Display Success Summary\n\n**Success Message Template**:\n\n```\n═══════════════════════════════════════════════════════════\n   PRESENTATION GENERATION COMPLETE\n═══════════════════════════════════════════════════════════\n\n✓ Successfully generated presentation!\n📁 Output: /presentations/ARCHITECTURE_Business_EN.pptx\n📊 Slides: 10 slides (~15 minute presentation)\n🎯 Stakeholder: Business\n🌐 Language: English\n\nData Sources Used:\n- Section 1: Executive Summary (lines 25-65)\n- Section 2: System Overview (lines 66-120)\n- Section 10: Scalability & Performance (lines 1551-1750)\n- Section 11: Operational Considerations (lines 1751-1950)\n\nNext Steps:\n1. Review the generated presentation\n2. Customize slide content as needed\n3. Add company branding/logos if required\n\n═══════════════════════════════════════════════════════════\n```\n\n### Command-Line Usage\n\nFor direct command-line generation without interactive prompts:\n\n```bash\n# With LLM summaries (RECOMMENDED)\nbun run skills/architecture-docs/utils/presentation-generator.ts ARCHITECTURE.md \\\n  --stakeholder architecture \\\n  --language es \\\n  --summaries /tmp/presentation_summaries_architecture_es.json\n\n# Without summaries (falls back to regex extraction)\nbun run skills/architecture-docs/utils/presentation-generator.ts ARCHITECTURE.md \\\n  --stakeholder business \\\n  --language en\n\n# With custom output path\nbun run skills/architecture-docs/utils/presentation-generator.ts ARCHITECTURE.md \\\n  --stakeholder compliance \\\n  --language es \\\n  --summaries /tmp/presentation_summaries_compliance_es.json \\\n  --output /custom/path/presentation.pptx\n```\n\n**Parameters**:\n- `--stakeholder`: Target audience (business|architecture|compliance)\n- `--language`: Presentation language (en|es)\n- `--summaries`: Path to LLM-generated summaries JSON (optional - uses regex if not provided)\n- `--output`: Custom output path (optional)\n\n### Slide Templates by Stakeholder\n\n#### Business Stakeholder Template (10 slides)\n\n1. **Title Slide** - System name + \"Architecture Overview for Business Stakeholders\"\n2. **Agenda** - Table of contents\n3. **Executive Summary** - Key metrics, business value (Section 1)\n4. **Problem & Solution** - Problem statement, solution overview (Section 2.1, 2.2)\n5. **Use Cases** - Primary use cases with success metrics (Section 2.3)\n6. **Business Value** - ROI, efficiency gains, revenue impact (Section 1)\n7. **System Availability & Performance** - SLA commitments, uptime (Section 10)\n8. **Operational Support** - Monitoring, support model (Section 11)\n9. **Architecture Principles** - Top 5 principles (Section 3)\n10. **Summary & Q&A** - Key takeaways, next steps\n\n#### Architecture Stakeholder Template (12 slides)\n\n1. **Title Slide** - System name + \"Technical Architecture Deep Dive\"\n2. **Agenda** - Table of contents\n3. **Executive Summary** - System purpose, key technical metrics (Section 1)\n4. **Architecture Principles** - All 9-10 principles (Section 3)\n5. **Architecture Layers** - Layer diagram, layer descriptions (Section 4)\n6. **Component Overview** - Component catalog with key services (Section 5)\n7. **Technology Stack** - Backend, frontend, data, infrastructure (Section 8)\n8. **Data Flow Patterns** - How data moves through system (Section 6)\n9. **Integration Points** - External APIs, dependencies (Section 7)\n10. **Security Architecture** - Auth, encryption, controls (Section 9)\n11. **Key Architecture Decisions** - Top 5 ADRs (Section 12)\n12. **Summary & Q&A** - Key patterns, next steps\n\n#### Compliance Stakeholder Template (11 slides)\n\n1. **Title Slide** - System name + \"Compliance & Governance Overview\"\n2. **Agenda** - Table of contents\n3. **Executive Summary** - System purpose, availability commitment (Section 1)\n4. **Security Architecture Overview** - Security layers (Section 9)\n5. **Authentication & Authorization** - Auth mechanisms, access controls (Section 9.1)\n6. **Data Protection** - Encryption at rest/transit, data classification (Section 9.3)\n7. **Operational Excellence** - Monitoring, incident response (Section 11)\n8. **Disaster Recovery & Business Continuity** - RTO/RPO, backup strategies (Section 11.4)\n9. **Integration Security** - API security, external dependency controls (Section 7)\n10. **Technology Compliance** - Approved technologies, deprecation plan (Section 8)\n11. **Summary & Q&A** - Compliance posture, remediation items\n\n### Error Handling\n\n**Missing ARCHITECTURE.md**:\n```\n❌ Error: ARCHITECTURE.md not found at: [path]\n\nPresentation generation requires a valid ARCHITECTURE.md file.\nPlease create one using the architecture-docs skill first.\n\nTo create ARCHITECTURE.md:\n1. Use the architecture-docs skill\n2. Select architecture type (Microservices, META, 3-Tier, BIAN, N-Layer)\n3. Complete all 12 sections\n4. Ensure Document Index is present\n```\n\n**Invalid Document Index**:\n```\n⚠️ Warning: Document Index not found or incomplete.\nUsing default line ranges. Presentation may have incomplete data.\n\nRecommendation: Update Document Index in ARCHITECTURE.md\n(See Workflow 4: Automatic Index Updates)\n```\n\n**Missing Sections**:\n```\n⚠️ Warning: Section [X] not found in ARCHITECTURE.md.\nSlides requiring this section will show: \"[Not documented in Section X]\"\n\nAffected slides:\n- Slide 5: Use Cases (requires Section 2.3)\n- Slide 8: Operational Support (requires Section 11)\n\nRecommendation: Complete missing sections in ARCHITECTURE.md before regenerating.\n```\n\n**Empty Subsections**:\n- Placeholder slides added: \"[Not specified in ARCHITECTURE.md Section X.Y]\"\n- User notified of missing data in success summary\n- Recommendation to complete documentation\n\n### Context Efficiency\n\n**Context Usage Comparison**:\n\n| Approach | Lines Loaded | Context Usage | Savings |\n|----------|-------------|---------------|---------|\n| Full Document Load | 2,000-3,000 | 100% | - |\n| Business Presentation | ~400 | 15-20% | 80-85% |\n| Architecture Presentation | ~1,000 | 40-50% | 50-60% |\n| Compliance Presentation | ~700 | 25-35% | 65-75% |\n\n**Efficiency Techniques**:\n- Document Index-based section location\n- Incremental section loading with ±10 line buffers\n- Load only stakeholder-relevant sections\n- Reuse loaded sections across multiple extractions\n\n### Integration with Other Workflows\n\n**Typical Workflow Sequence**:\n1. **Workflow 1**: Create ARCHITECTURE.md (select architecture type)\n2. **Workflow 2**: Generate ADRs from Section 12\n3. **Workflow 4**: Update Document Index after edits\n4. **Workflow 5**: Verify metric consistency\n5. **→ Workflow 8**: Generate presentations for stakeholders ✓\n\n**Presentation Regeneration**:\n- Regenerate presentations after ARCHITECTURE.md updates\n- No need to recreate ARCHITECTURE.md, just regenerate presentations\n- Presentations reflect latest documented architecture\n- Version presentations by adding date suffix if needed\n\n### Best Practices\n\n**DO:**\n- ✅ Generate presentations AFTER completing ARCHITECTURE.md\n- ✅ Verify Document Index is up-to-date before generation\n- ✅ Select stakeholder type based on presentation audience\n- ✅ Regenerate presentations when architecture changes\n- ✅ Review generated slides for accuracy\n- ✅ Customize branding/logos after generation\n\n**DON'T:**\n- ❌ Generate presentations from incomplete ARCHITECTURE.md\n- ❌ Manually edit ARCHITECTURE.md after presentation generation (regenerate instead)\n- ❌ Assume all sections will be present (handle missing data gracefully)\n- ❌ Translate technical content (system names, metrics remain as-is)\n\n### Example Workflow Execution\n\n**User**: \"Generate architecture presentation for business stakeholders in Spanish\"\n\n**Skill Response**:\n\n*Step 1: Detect request → Workflow 8 (Presentation Generation)*\n*Step 2: Parse request → Stakeholder: Business, Language: Spanish*\n*Step 3: Confirm settings*\n\n📊 **Architecture Presentation Generation**\n\nI'll generate a presentation with these settings:\n- Stakeholder: Business\n- Language: Spanish\n- Slides: ~10 slides (~15 minutes)\n- Output: /presentations/ARCHITECTURE_Business_ES.pptx\n\nProceeding with generation...\n\n═══════════════════════════════════════════════════════════\n   ARCHITECTURE PRESENTATION GENERATION\n═══════════════════════════════════════════════════════════\nStakeholder: Business\nLanguage: ES\nOutput: /presentations/ARCHITECTURE_Business_ES.pptx\n═══════════════════════════════════════════════════════════\n\nStep 1/6: Loading ARCHITECTURE.md Document Index...\n  ✓ Loaded index for 12 sections\n\nStep 2/6: Loading required sections (1, 2, 10, 11)...\n  ✓ Loaded 4 sections (387 lines)\n  ✓ Context efficiency: 387/2,453 lines = 15.8%\n\nStep 3/6: Extracting data for business stakeholders...\n  ✓ Extracted 4 data categories\n\nStep 4/6: Loading language translations (Spanish)...\n  ✓ Loaded ES translations\n\nStep 5/6: Generating slides (10 slides)...\n  - Slide 1: Title Slide ✓\n  - Slide 2: Agenda ✓\n  - Slide 3: Resumen Ejecutivo ✓\n  - Slide 4: Problema y Solución ✓\n  - Slide 5: Casos de Uso ✓\n  - Slide 6: Valor de Negocio ✓\n  - Slide 7: Disponibilidad del Sistema ✓\n  - Slide 8: Soporte Operacional ✓\n  - Slide 9: Principios de Arquitectura ✓\n  - Slide 10: Resumen y Preguntas ✓\n\nStep 6/6: Saving presentation file...\n  ✓ Saved to /presentations/ARCHITECTURE_Business_ES.pptx\n\n═══════════════════════════════════════════════════════════\n   PRESENTATION GENERATION COMPLETE\n═══════════════════════════════════════════════════════════\n\n✓ Successfully generated presentation!\n📁 Output: /presentations/ARCHITECTURE_Business_ES.pptx\n📊 Slides: 10 slides (~15 minute presentation)\n🎯 Stakeholder: Business\n🌐 Language: Spanish\n\nData Sources Used:\n- Section 1: Executive Summary (lines 25-87)\n- Section 2: System Overview (lines 88-201)\n- Section 10: Scalability & Performance (lines 1678-1802)\n- Section 11: Operational Considerations (lines 1803-2015)\n\nPróximos Pasos:\n1. Review the generated presentation\n2. Customize slide content as needed\n3. Add company branding/logos if required\n\n═══════════════════════════════════════════════════════════\n\n**Your presentation is ready!** You can find it at: `/presentations/ARCHITECTURE_Business_ES.pptx`\n\n---\n\n## Workflow 9: Diagram Generation (Generate Architecture Diagrams)\n\n**⚡ Auto-triggers**: This workflow automatically activates when diagram-related keywords are detected (see Automatic Workflow Detection section above).\n\n### When to Use\n\nThis workflow is activated when users request diagram generation from ARCHITECTURE.md:\n- \"Generate architecture diagrams\"\n- \"Create Mermaid diagrams from architecture\"\n- \"Generate diagrams for my architecture\"\n- \"Add diagrams to ARCHITECTURE.md\"\n- User references: \"visual diagrams\", \"data flow diagrams\", \"component diagrams\"\n\n### Activation Triggers\n\n**Automatic Invocation:**\n- User asks to \"generate diagrams\", \"create diagrams\", \"add diagrams\", \"make diagrams\"\n- User specifies: \"Mermaid diagrams\", \"architecture diagrams\", \"visual diagrams\"\n- User references sections: \"generate diagrams for Section 4\"\n\n**Manual Invocation:**\n- User explicitly: \"Run diagram generation workflow\"\n- User references: `/workflow diagrams`\n\n### Prerequisites\n\n- **ARCHITECTURE.md file exists** in the project\n- Document has **valid 12-section structure** (or at least core sections 1-4)\n- **Document Index is present** (lines 1-50 typically)\n- **MERMAID_DIAGRAMS_GUIDE.md** available for templates (optional but recommended)\n\n### Step-by-Step Process\n\n#### Step 1: Detect Request & Present Diagram Type Options\n\nWhen diagram generation is requested, present the following options:\n\n```\n📊 **Architecture Diagram Generation**\n\nI'll generate Mermaid architecture diagrams for your ARCHITECTURE.md file.\n\n**Step 1: Select Diagram Type**\n\nWhat diagrams would you like to generate?\n\n**1. High-Level Architecture Only (Recommended)** - Single comprehensive diagram\n   - Shows Presentation → Application → Data layers (3-tier)\n   - Or shows all 6 META layers for META architectures\n   - Includes all major components and data flows\n\n**2. Default Set** - 3 core diagrams\n   - High-Level System Architecture (3-tier overview)\n   - Infrastructure & Deployment (Azure AKS setup)\n   - Component Interactions (Frontend ↔ Backend ↔ Database)\n\n**Please select: 1 or 2**\n```\n\n**High-Level Architecture Diagram Details**:\n- Single comprehensive Mermaid flowchart showing all tiers/layers\n- Includes component relationships and data flows\n- Color-coded by tier for easy visualization\n- Suitable for executive presentations and documentation\n\n**Default Set Diagram Details**:\n1. **High-Level System Architecture** → Section 4.1 (Architecture Layers)\n2. **Infrastructure & Deployment** → Section 9.2 (Deployment Architecture)\n3. **High Availability & Failover** → Section 8.3 (Availability & Reliability)\n\n#### Step 2: Target Location Selection\n\nAfter diagram type selection:\n\n```\n**Step 2: Select Target Location**\n\nWhere should the diagrams be placed?\n\n1. **Inline in ARCHITECTURE.md** - Embed diagrams directly in relevant sections (Recommended)\n2. **Separate Section 4 Subsection** - Create dedicated \"### Architecture Diagrams\" subsection\n3. **Both** - Inline for key diagrams + comprehensive set in Section 4\n\n**Please select: 1, 2, or 3**\n```\n\n**Recommended Placements**:\n- **High-Level Architecture**: Section 4.1 or Section 4 introduction\n- **Data Flow Diagrams**: Section 5.3 (Data Flow Patterns)\n- **Infrastructure Diagram**: Section 9.2 (Deployment Architecture)\n- **HA Diagram**: Section 8.3 (Availability & Reliability)\n- **Performance Diagram**: Section 8.1 (Performance Requirements)\n\n#### Step 3: Confirmation\n\n```\n**Step 3: Confirmation**\n\nI'll generate diagrams with these settings:\n- Diagram Type: [High-Level Only (1)/Default Set (3)]\n- Target Location: [Inline/Section 4 Subsection/Both]\n- Total Diagrams: 1-6 diagrams (typically 3 for Default Set)\n- Output: Mermaid code blocks embedded in ARCHITECTURE.md\n\nProceed with generation? [Yes/No]\n```\n\n#### Step 4: Load Document & Identify Architecture Type\n\n**Process**:\n1. Read lines 1-50 of ARCHITECTURE.md (Document Index)\n2. Parse Document Index to extract section line ranges\n3. Read Section 1 (Executive Summary) to identify system type\n4. Determine architecture pattern (3-Tier, Microservices, META, N-Layer)\n5. Read Section 4 (Architecture Layers) to understand component structure\n\n**Architecture Type Detection**:\n- **3-Tier**: Frontend → Backend → Database layers\n- **Microservices**: Multiple independent services with API Gateway\n- **META (6-Layer)**: Channels → UX → Business Scenarios → Service Orchestration → Atomic Services → Data\n- **N-Layer**: Custom layered architecture (N > 3)\n\n#### Step 5: Load Required Sections Incrementally\n\n**Context-Efficient Loading**:\n- Load only sections required for the selected diagram type\n- Use ±10 line buffer around each section\n- Minimize total lines loaded (similar to Workflow 8 approach)\n\n**Sections by Diagram Type**:\n- **High-Level Architecture Only (1 diagram)**: Section 4 (~150-300 lines, 85-90% reduction vs. full document)\n- **Default Set (3 diagrams)**: Sections 4, 8, 9 (~500-800 lines, 60-75% reduction vs. full document)\n- **Infrastructure Only**: Section 9 (~150-250 lines)\n- **HA/Performance**: Section 8 (~200-350 lines)\n- **Extended Set (6 diagrams)**: Sections 4, 5, 6, 8, 9 (~800-1200 lines, 40-60% reduction vs. full document)\n\n#### Step 6: Generate Diagrams Using MERMAID_DIAGRAMS_GUIDE Templates\n\n**Process**:\n1. Load MERMAID_DIAGRAMS_GUIDE.md for reference templates\n2. For each diagram to generate:\n   - Identify appropriate Mermaid diagram type (graph TB, sequenceDiagram, etc.)\n   - Extract key components, data flows, or infrastructure elements from sections\n   - Apply color scheme and styling from templates\n   - Generate complete Mermaid code block\n3. Format with proper markdown code block syntax\n\n**Mermaid Diagram Types**:\n- **High-Level Architecture**: `graph TB` (top-to-bottom flowchart)\n- **Data Flow**: `sequenceDiagram` (participant interactions)\n- **Infrastructure**: `graph TB` with subgraphs (nested component groups)\n- **HA/Performance**: `graph TB` or `graph LR` (left-to-right)\n\n**Color Scheme** (from MERMAID_DIAGRAMS_GUIDE):\n```\nclassDef presentation fill:#4A90E2,stroke:#2E5C8A,stroke-width:3px,color:#fff\nclassDef application fill:#F5A623,stroke:#B8791A,stroke-width:3px,color:#fff\nclassDef data fill:#7ED321,stroke:#5A9B18,stroke-width:3px,color:#fff\nclassDef cache fill:#BD10E0,stroke:#8A0CA3,stroke-width:3px,color:#fff\nclassDef azure fill:#0078D4,stroke:#005A9E,stroke-width:2px,color:#fff\n```\n\n#### Step 7: Insert Diagrams into ARCHITECTURE.md\n\n**Process**:\n1. For inline placement:\n   - Read target section (e.g., Section 4.1)\n   - Find appropriate insertion point (after section header or before subsection)\n   - Use Edit tool to insert diagram with proper heading\n\n2. For Section 4 subsection:\n   - Create new `### 4.X Architecture Diagrams` subsection\n   - Insert all diagrams with individual headings\n\n3. Maintain proper markdown structure:\n   ```markdown\n   #### Diagram: High-Level System Architecture\n\n   ```mermaid\n   graph TB\n       %% Diagram content here\n   ```\n\n   **Description**: This diagram shows...\n   ```\n\n#### Step 8: Verification & User Notification\n\n**Verification**:\n- ✅ All diagrams inserted successfully\n- ✅ Mermaid syntax is valid (no unclosed code blocks)\n- ✅ Proper headings and descriptions added\n- ✅ Document structure maintained\n\n**Notification**:\n```\n✅ **Diagram Generation Complete**\n\nGenerated diagrams (Default Set):\n- High-Level System Architecture (Section 4.1)\n- Infrastructure & Deployment (Section 9.2)\n- High Availability & Failover (Section 8.3)\n\n**Location**: ARCHITECTURE.md (inline in respective sections)\n\n**Rendering**:\n- GitHub/GitLab: Diagrams will render automatically\n- VS Code: Install \"Markdown Preview Mermaid Support\" extension\n- Online: Use https://mermaid.live/ to preview\n\n**Next Steps**:\n- Review diagrams in your markdown viewer\n- Verify all components are correctly represented\n- Request updates if any changes needed\n```\n\n### Error Handling\n\n**Common Issues**:\n\n| Issue | Solution |\n|-------|----------|\n| ARCHITECTURE.md not found | Prompt user to create ARCHITECTURE.md first (Workflow 1) |\n| Document Index missing | Generate index first or use default line ranges with warning |\n| Section not found | Skip that diagram type or prompt user to add section |\n| Invalid Mermaid syntax | Validate syntax using mermaid-cli or fallback to simpler diagram |\n| Insertion point conflict | Ask user for preferred location |\n\n### Integration with Other Workflows\n\n**Workflow Dependencies**:\n- **Workflow 1 (Create ARCHITECTURE.md)**: Must run first if document doesn't exist\n- **Workflow 8 (Presentation Generation)**: Can use generated diagrams in presentations\n- **Workflow 7 (Informational Query)**: Can answer questions about generated diagrams\n\n**Complementary Actions**:\n- After diagram generation, suggest running Workflow 8 to create presentation\n- Recommend adding diagram descriptions to ADRs (Workflow 2) if design decisions are visualized\n\n---\n\n## Optional Enhancements\n\n- Data Flow Patterns (for complex flows)\n- **Architecture Diagrams**: Create visual representations using Mermaid (recommended)\n  - Section 4 templates include Mermaid examples for each architecture type\n  - See MERMAID_DIAGRAMS_GUIDE.md for complete instructions\n  - Supported diagram types: Layer diagrams, service topology, data flow, sequence diagrams\n  - Benefits: Interactive, version-control friendly, renders in GitHub/GitLab\n  - Alternative formats: C4 Model, PlantUML also supported\n- Cost breakdown tables\n- Disaster recovery procedures\n- Runbooks (common operations and incident response procedures)\n\n## Reference Documents\n\nThis skill includes the following asset files:\n\n- **ARCHITECTURE_DOCUMENTATION_GUIDE.md**: Primary template and structure guide (located in skill assets)\n- **ADR_GUIDE.md**: Architectural Decision Record format and guidelines (located in skill assets)\n\nThese reference documents are bundled with this skill and will be available when the skill is active.\n\n**Note**: ARCHITECTURE_DOCUMENTATION_GUIDE.md is optimized for Claude Code context management. Load it when creating or significantly updating architecture docs."
              },
              {
                "name": "architecture-readiness",
                "description": "Use this skill to create Product Owner Specifications documenting business requirements before architecture design",
                "path": "skills/architecture-readiness/SKILL.md",
                "frontmatter": {
                  "name": "architecture-readiness",
                  "description": "Use this skill to create Product Owner Specifications documenting business requirements before architecture design"
                },
                "content": "# Architecture Readiness Skill\n\n## Description\n\nThis skill helps Product Owners document business requirements and context before architecture design begins. It provides templates and guidance for creating Product Owner Specifications that feed into technical ARCHITECTURE.md documents.\n\nThe skill includes two primary functions:\n1. **PO Spec Creation**: Templates and guidance for documenting business requirements\n2. **PO Spec Evaluation**: Scoring methodology to assess if a PO Spec is ready for architecture team handoff\n\n## When to Use This Skill\n\nInvoke this skill when:\n- User asks to create a Product Owner Specification\n- User asks about documenting business requirements for architecture\n- User mentions \"business context\", \"product requirements\", or \"requirements gathering\" in relation to architecture\n- User wants to prepare business documentation before technical architecture design\n- User asks to evaluate or score a Product Owner Specification\n- User wants to know if their PO Spec is ready for the architecture team\n\n## Files in This Skill\n\n- **PRODUCT_OWNER_SPEC_GUIDE.md**: Comprehensive guide with 8-section template, examples, and best practices\n- **templates/PO_SPEC_TEMPLATE.md**: Quick-start template for creating a new PO Specification\n- **PO_SPEC_SCORING_GUIDE.md**: Weighted scoring methodology to evaluate PO Spec readiness (0-10 scale)\n\n## How to Use This Skill\n\n### For PO Spec Creation\n\nWhen this skill is activated for document creation:\n\n1. **Read the guide**: Load PRODUCT_OWNER_SPEC_GUIDE.md to understand the 8-section structure\n2. **Understand user context**: Ask clarifying questions about their product/feature\n3. **Provide appropriate template**:\n   - For guidance and understanding: Reference PRODUCT_OWNER_SPEC_GUIDE.md\n   - For quick start: Provide templates/PO_SPEC_TEMPLATE.md\n4. **Guide document creation**: Help user fill out each section with business context\n5. **Reference mapping**: Explain how PO Spec maps to ARCHITECTURE.md (see guide Section \"Mapping to ARCHITECTURE.md\")\n\n### For PO Spec Evaluation\n\nWhen this skill is activated to evaluate a PO Spec:\n\n1. **Read the scoring guide**: Load PO_SPEC_SCORING_GUIDE.md to understand the weighted scoring methodology\n2. **Read the PO Spec**: Load the user's Product Owner Specification document\n3. **Evaluate each section**: Assess completeness of all 8 sections using the evaluation criteria\n4. **Calculate weighted score**: Apply section weights and compute total score (0-10 scale)\n5. **Provide detailed feedback**:\n   - Overall score and readiness interpretation\n   - Section-by-section breakdown showing completeness %\n   - Identify gaps in critical sections (Use Cases, Business Constraints, Business Objectives)\n   - Provide actionable recommendations for improvement\n6. **Determine readiness**: Score ≥7.5/10 indicates ready for architecture team handoff\n\n## Key Principles\n\n- **Business-focused**: No technical details or architecture decisions in PO Spec\n- **User-centric**: Emphasize user needs, personas, and pain points\n- **Measurable**: All goals and success criteria must be quantifiable\n- **Constraint-aware**: Document all business constraints (budget, timeline, compliance)\n\n## Integration with Other Skills\n\n**Relationship to architecture-docs skill:**\n- architecture-readiness (this skill) → Creates **business** requirements (PO Spec)\n- architecture-docs skill → Creates **technical** architecture (ARCHITECTURE.md)\n\n**Workflow:**\n1. Product Owner uses architecture-readiness skill → Creates PO Spec\n2. PO Spec handed off to architecture team\n3. Architecture team uses architecture-docs skill → Creates ARCHITECTURE.md\n\n## Example Invocations\n\n### Example 1: Creating a PO Spec\n\n```\nUser: \"I want to create a Product Owner Specification for a new mobile payment feature\"\n\nClaude (with architecture-readiness skill activated):\n1. Load PRODUCT_OWNER_SPEC_GUIDE.md to understand structure\n2. Ask clarifying questions:\n   - What business problem does this solve?\n   - Who are the target users?\n   - What are the business objectives and success metrics?\n   - Are there regulatory/compliance requirements?\n3. Guide user through 8 sections:\n   - Business Context\n   - Stakeholders & Users\n   - Business Objectives\n   - Use Cases\n   - User Stories\n   - User Experience Requirements\n   - Business Constraints\n   - Success Metrics & KPIs\n4. Provide template sections as needed\n5. Explain how completed PO Spec feeds into ARCHITECTURE.md\n```\n\n### Example 2: Evaluating a PO Spec\n\n```\nUser: \"Can you evaluate my Product Owner Spec and tell me if it's ready for the architecture team?\"\n\nClaude (with architecture-readiness skill activated):\n1. Load PO_SPEC_SCORING_GUIDE.md to understand scoring methodology\n2. Read the user's PRODUCT_OWNER_SPEC.md file\n3. Evaluate each section:\n   - Section 1 (Business Context): 80% complete\n   - Section 2 (Stakeholders): 60% complete\n   - Section 3 (Business Objectives): 90% complete\n   - Section 4 (Use Cases): 100% complete\n   - Section 5 (User Stories): 70% complete\n   - Section 6 (UX Requirements): 85% complete\n   - Section 7 (Business Constraints): 95% complete\n   - Section 8 (Success Metrics): 80% complete\n4. Calculate weighted score: 8.85/10\n5. Provide feedback:\n   - \"Your PO Spec scores 8.85/10 - Good, ready for architecture design\"\n   - \"Excellent: Use Cases, Business Constraints, Business Objectives\"\n   - \"Minor gaps: Stakeholders & Users section needs more detailed personas\"\n   - \"Recommendation: Proceed with architecture design; clarify user personas during kickoff\"\n```\n\n## Common User Requests\n\n**PO Spec Creation:**\n- \"Help me document business requirements\" → Use PRODUCT_OWNER_SPEC_GUIDE.md\n- \"I need a template for product specifications\" → Provide templates/PO_SPEC_TEMPLATE.md\n- \"How does this relate to the architecture document?\" → Reference \"Mapping to ARCHITECTURE.md\" section in guide\n- \"What should I include in use cases vs user stories?\" → Reference Sections 4 and 5 of guide\n\n**PO Spec Evaluation:**\n- \"Evaluate my PO Spec\" → Use PO_SPEC_SCORING_GUIDE.md to score the document\n- \"Is my PO Spec ready for the architecture team?\" → Score and assess readiness (≥7.5/10)\n- \"What's missing from my business requirements?\" → Identify gaps using evaluation criteria\n- \"How can I improve my PO Spec score?\" → Provide actionable recommendations based on section weights\n\n## Success Criteria\n\n### For PO Spec Creation\n\nA well-formed Product Owner Specification should:\n- ✅ Have all 8 sections completed\n- ✅ Include specific, measurable success criteria\n- ✅ Define user personas with real pain points\n- ✅ Document all business constraints (budget, timeline, compliance)\n- ✅ Use business language (avoid technical jargon)\n- ✅ Map clearly to ARCHITECTURE.md inputs\n- ✅ Score ≥7.5/10 on the weighted scoring methodology\n\n### For PO Spec Evaluation\n\nA quality evaluation should:\n- ✅ Assess all 8 sections using the evaluation criteria from PO_SPEC_SCORING_GUIDE.md\n- ✅ Calculate weighted score correctly (applying section weights)\n- ✅ Provide clear readiness determination (Ready ≥7.5/10, Not Ready <7.5/10)\n- ✅ Give specific, actionable feedback for each gap identified\n- ✅ Prioritize feedback on high-weight sections (Use Cases, Business Constraints, Business Objectives)\n- ✅ Explain what needs to be added/improved to reach readiness threshold"
              }
            ]
          }
        ]
      }
    }
  ]
}