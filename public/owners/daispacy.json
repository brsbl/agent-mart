{
  "owner": {
    "id": "daispacy",
    "display_name": "daispacy",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/6812096?v=4",
    "url": "https://github.com/daispacy",
    "bio": null,
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 17,
      "total_stars": 0,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "daispacy/py-claude-marketplace",
      "url": "https://github.com/daispacy/py-claude-marketplace",
      "description": "the marketplace for claude teams",
      "homepage": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-05T04:39:54Z",
        "created_at": "2025-10-31T04:51:30Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 234
        },
        {
          "path": ".claude",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude/settings.local.json",
          "type": "blob",
          "size": 427
        },
        {
          "path": ".gitattributes",
          "type": "blob",
          "size": 66
        },
        {
          "path": "available_skills.xml",
          "type": "blob",
          "size": 7939
        },
        {
          "path": "hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "hooks/install-hooks.sh",
          "type": "blob",
          "size": 1177
        },
        {
          "path": "hooks/pre-commit",
          "type": "blob",
          "size": 2454
        },
        {
          "path": "py-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 174
        },
        {
          "path": "py-plugin/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/agents/android-merge-review.md",
          "type": "blob",
          "size": 6690
        },
        {
          "path": "py-plugin/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/android-code-review",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/android-code-review/SKILL.md",
          "type": "blob",
          "size": 15351
        },
        {
          "path": "py-plugin/skills/android-code-review/examples.md",
          "type": "blob",
          "size": 25317
        },
        {
          "path": "py-plugin/skills/android-code-review/standards.md",
          "type": "blob",
          "size": 25000
        },
        {
          "path": "py-plugin/skills/clean-architecture-review",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/clean-architecture-review/SKILL.md",
          "type": "blob",
          "size": 4568
        },
        {
          "path": "py-plugin/skills/clean-architecture-review/examples.md",
          "type": "blob",
          "size": 14755
        },
        {
          "path": "py-plugin/skills/copilot-agent-builder",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/copilot-agent-builder/SKILL.md",
          "type": "blob",
          "size": 4721
        },
        {
          "path": "py-plugin/skills/copilot-agent-builder/examples.md",
          "type": "blob",
          "size": 16396
        },
        {
          "path": "py-plugin/skills/copilot-agent-builder/templates.md",
          "type": "blob",
          "size": 8685
        },
        {
          "path": "py-plugin/skills/ios-code-review",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-code-review/SKILL.md",
          "type": "blob",
          "size": 11686
        },
        {
          "path": "py-plugin/skills/ios-code-review/examples.md",
          "type": "blob",
          "size": 17346
        },
        {
          "path": "py-plugin/skills/ios-delivery-build",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-delivery-build/SKILL.md",
          "type": "blob",
          "size": 3938
        },
        {
          "path": "py-plugin/skills/ios-delivery-build/examples.md",
          "type": "blob",
          "size": 5744
        },
        {
          "path": "py-plugin/skills/ios-delivery-build/templates.md",
          "type": "blob",
          "size": 1776
        },
        {
          "path": "py-plugin/skills/ios-generate-unit-tests",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-generate-unit-tests/SKILL.md",
          "type": "blob",
          "size": 7239
        },
        {
          "path": "py-plugin/skills/ios-generate-unit-tests/examples.md",
          "type": "blob",
          "size": 13985
        },
        {
          "path": "py-plugin/skills/ios-generate-unit-tests/templates.md",
          "type": "blob",
          "size": 13291
        },
        {
          "path": "py-plugin/skills/ios-instruments-performance-cli",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-instruments-performance-cli/SKILL.md",
          "type": "blob",
          "size": 3675
        },
        {
          "path": "py-plugin/skills/ios-instruments-performance-cli/examples.md",
          "type": "blob",
          "size": 21667
        },
        {
          "path": "py-plugin/skills/ios-merchant-feature-declaration",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-merchant-feature-declaration/SKILL.md",
          "type": "blob",
          "size": 8405
        },
        {
          "path": "py-plugin/skills/ios-merchant-feature-declaration/examples.md",
          "type": "blob",
          "size": 14339
        },
        {
          "path": "py-plugin/skills/ios-merchant-feature-declaration/templates.md",
          "type": "blob",
          "size": 15064
        },
        {
          "path": "py-plugin/skills/ios-mr-workflow",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-mr-workflow/SKILL.md",
          "type": "blob",
          "size": 5150
        },
        {
          "path": "py-plugin/skills/ios-mr-workflow/examples.md",
          "type": "blob",
          "size": 8775
        },
        {
          "path": "py-plugin/skills/ios-mr-workflow/templates.md",
          "type": "blob",
          "size": 4735
        },
        {
          "path": "py-plugin/skills/ios-naming-conventions",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-naming-conventions/SKILL.md",
          "type": "blob",
          "size": 4627
        },
        {
          "path": "py-plugin/skills/ios-naming-conventions/examples.md",
          "type": "blob",
          "size": 14124
        },
        {
          "path": "py-plugin/skills/ios-reactive-list-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-reactive-list-generator/SKILL.md",
          "type": "blob",
          "size": 7783
        },
        {
          "path": "py-plugin/skills/ios-reactive-list-generator/examples.md",
          "type": "blob",
          "size": 22836
        },
        {
          "path": "py-plugin/skills/ios-reactive-list-generator/templates.md",
          "type": "blob",
          "size": 16380
        },
        {
          "path": "py-plugin/skills/ios-sdk-code-review",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/ios-sdk-code-review/SKILL.md",
          "type": "blob",
          "size": 8701
        },
        {
          "path": "py-plugin/skills/ios-sdk-code-review/examples.md",
          "type": "blob",
          "size": 11624
        },
        {
          "path": "py-plugin/skills/ios-sdk-code-review/standards.md",
          "type": "blob",
          "size": 14008
        },
        {
          "path": "py-plugin/skills/ios-sdk-code-review/templates.md",
          "type": "blob",
          "size": 7023
        },
        {
          "path": "py-plugin/skills/mcp-server-installer",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/mcp-server-installer/SKILL.md",
          "type": "blob",
          "size": 4613
        },
        {
          "path": "py-plugin/skills/mcp-server-installer/templates.md",
          "type": "blob",
          "size": 5492
        },
        {
          "path": "py-plugin/skills/mcp-tool-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/mcp-tool-generator/SKILL.md",
          "type": "blob",
          "size": 21115
        },
        {
          "path": "py-plugin/skills/mcp-tool-generator/examples.md",
          "type": "blob",
          "size": 27077
        },
        {
          "path": "py-plugin/skills/payoo-ios-code-review",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/payoo-ios-code-review/SKILL.md",
          "type": "blob",
          "size": 8758
        },
        {
          "path": "py-plugin/skills/payoo-ios-code-review/examples.md",
          "type": "blob",
          "size": 23085
        },
        {
          "path": "py-plugin/skills/payoo-ios-code-review/standards.md",
          "type": "blob",
          "size": 17029
        },
        {
          "path": "py-plugin/skills/rxswift-memory-check",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/rxswift-memory-check/SKILL.md",
          "type": "blob",
          "size": 3442
        },
        {
          "path": "py-plugin/skills/rxswift-memory-check/examples.md",
          "type": "blob",
          "size": 14296
        },
        {
          "path": "py-plugin/skills/skill-builder",
          "type": "tree",
          "size": null
        },
        {
          "path": "py-plugin/skills/skill-builder/SKILL.md",
          "type": "blob",
          "size": 10184
        }
      ],
      "marketplace": {
        "name": "py-claude-marketplace",
        "version": null,
        "description": null,
        "owner_info": {
          "name": "Dai Pham"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "py-plugin",
            "description": "A plugin stores all skills for py projects",
            "source": "./py-plugin",
            "category": null,
            "version": null,
            "author": null,
            "install_commands": [
              "/plugin marketplace add daispacy/py-claude-marketplace",
              "/plugin install py-plugin@py-claude-marketplace"
            ],
            "signals": {
              "stars": 0,
              "forks": 0,
              "pushed_at": "2026-01-05T04:39:54Z",
              "created_at": "2025-10-31T04:51:30Z",
              "license": null
            },
            "commands": [],
            "skills": [
              {
                "name": "android-code-review",
                "description": "Critical Android code review for Payoo Android app. Focuses on high-impact issues - naming conventions, memory leaks, UIState patterns, business logic placement, lifecycle management, and MVI/MVVM pattern violations. Use when reviewing Kotlin files, pull requests, or checking ViewModels, Activities, Fragments, UseCases, and Repositories.",
                "path": "py-plugin/skills/android-code-review/SKILL.md",
                "frontmatter": {
                  "name": "android-code-review",
                  "description": "Critical Android code review for Payoo Android app. Focuses on high-impact issues - naming conventions, memory leaks, UIState patterns, business logic placement, lifecycle management, and MVI/MVVM pattern violations. Use when reviewing Kotlin files, pull requests, or checking ViewModels, Activities, Fragments, UseCases, and Repositories.",
                  "allowed-tools": "Read, Grep, Glob"
                },
                "content": "# Android Code Review - Critical Issues Focus\n\nExpert Android code reviewer for Payoo Android application, focusing on CRITICAL and HIGH PRIORITY issues that impact app stability, maintainability, and architecture.\n\n## When to Activate\n\n- \"review android code\", \"check android file\", \"review android PR\"\n- Mentions Kotlin/Java files: Activity, Fragment, ViewModel, UseCase, Repository\n- \"code quality\", \"best practices\", \"check android standards\"\n- MVI/MVVM patterns, UIState, business logic, lifecycle issues\n\n## Review Process\n\n### Step 1: Identify Scope\nDetermine what to review:\n- Specific files (e.g., \"PaymentViewModel.kt\")\n- Directories (e.g., \"payment module\")\n- Git changes (recent commits, PR diff)\n- Entire module or feature\n\n### Step 2: Read and Analyze\nUse Read tool to examine files, focusing on CRITICAL and HIGH PRIORITY issues only.\n\n### Step 3: Apply Critical Standards\n\n## üéØ CRITICAL FOCUS AREAS\n\n### 1. Naming Conventions üî¥ HIGH\n**Impact**: Code readability, maintainability, team collaboration\n\n**Check for**:\n- **Types**: Must be PascalCase, descriptive (e.g., `PaymentViewModel`, not `pmtVM`)\n- **Variables/Functions**: Must be camelCase (e.g., `paymentAmount`, not `payment_amount`)\n- **Constants**: Must be UPPER_SNAKE_CASE (e.g., `MAX_RETRY_COUNT`)\n- **Booleans**: Must have `is`/`has`/`should`/`can` prefix (e.g., `isLoading`, not `loading`)\n- **UIState properties**: Clear, specific names (e.g., `isPaymentProcessing`, not `state1`)\n- **NO abbreviations** except URL, ID, API, HTTP, UI (e.g., `user`, not `usr`)\n\n**Common violations**:\n```kotlin\n// ‚ùå BAD\nvar usr: User? = null\nval loading = false\nvar state1 = \"\"\n\n// ‚úÖ GOOD\nvar user: User? = null\nval isLoading = false\nvar paymentState = \"\"\n```\n\n### 2. Memory Leaks üî¥ CRITICAL\n**Impact**: App crashes, ANR, poor performance\n\n**Check for**:\n- **ViewModel references**: NEVER hold Activity/Fragment/View references\n- **Coroutine cancellation**: All coroutines must be cancelled with lifecycle\n- **Context leaks**: Use ApplicationContext for long-lived objects\n- **Listener cleanup**: Remove listeners in onDestroy/onCleared\n- **Static references**: Avoid static references to Activities/Views\n\n**Common violations**:\n```kotlin\n// ‚ùå CRITICAL - Memory Leak\nclass PaymentViewModel : ViewModel() {\n    private var activity: Activity? = null // LEAK!\n\n    fun setActivity(act: Activity) {\n        activity = act\n    }\n}\n\n// ‚ùå CRITICAL - Coroutine not cancelled\nGlobalScope.launch { // Will leak!\n    // work\n}\n\n// ‚úÖ GOOD\nclass PaymentViewModel : ViewModel() {\n    // No Activity reference\n\n    fun doWork() {\n        viewModelScope.launch { // Cancelled when ViewModel cleared\n            // work\n        }\n    }\n}\n```\n\n### 3. UIState Pattern üî¥ HIGH\n**Impact**: State consistency, UI reliability, debugging\n\n**Check for**:\n- **Single source of truth**: Use sealed class or data class for UIState\n- **Immutable state**: Use `StateFlow<UIState>` or `State<UIState>`\n- **All UI states covered**: Loading, Success, Error, Empty\n- **No scattered state**: Don't use multiple LiveData/StateFlow for related state\n- **Type safety**: Use sealed classes for state variants\n\n**Common violations**:\n```kotlin\n// ‚ùå BAD - Scattered state\nclass PaymentViewModel : ViewModel() {\n    val isLoading = MutableStateFlow(false)\n    val errorMessage = MutableStateFlow<String?>(null)\n    val data = MutableStateFlow<Payment?>(null)\n    val isEmpty = MutableStateFlow(false)\n}\n\n// ‚úÖ GOOD - Single UIState\nsealed class PaymentUIState {\n    object Loading : PaymentUIState()\n    data class Success(val payment: Payment) : PaymentUIState()\n    data class Error(val message: String) : PaymentUIState()\n    object Empty : PaymentUIState()\n}\n\nclass PaymentViewModel : ViewModel() {\n    private val _uiState = MutableStateFlow<PaymentUIState>(PaymentUIState.Loading)\n    val uiState: StateFlow<PaymentUIState> = _uiState.asStateFlow()\n}\n```\n\n### 4. Business Logic Placement üî¥ HIGH\n**Impact**: Testability, reusability, architecture integrity\n\n**Check for**:\n- **ViewModels**: Should ONLY orchestrate, NOT contain business logic\n- **UseCases**: Must contain ALL business logic\n- **Repositories**: Data operations only, NO business decisions\n- **Activities/Fragments**: UI logic only, NO business/data logic\n- **Single Responsibility**: Each UseCase does ONE thing\n\n**Common violations**:\n```kotlin\n// ‚ùå BAD - Business logic in ViewModel\nclass PaymentViewModel(private val repository: PaymentRepository) : ViewModel() {\n    fun processPayment(amount: Double) {\n        viewModelScope.launch {\n            // ‚ùå Business logic in ViewModel!\n            if (amount <= 0) return@launch\n            val fee = amount * 0.02\n            val total = amount + fee\n            repository.savePayment(total)\n        }\n    }\n}\n\n// ‚úÖ GOOD - Business logic in UseCase\nclass ProcessPaymentUseCase(private val repository: PaymentRepository) {\n    suspend operator fun invoke(amount: Double): Result<Payment> {\n        // ‚úÖ Business logic here\n        if (amount <= 0) return Result.failure(Exception(\"Invalid amount\"))\n        val fee = amount * 0.02\n        val total = amount + fee\n        return repository.savePayment(total)\n    }\n}\n\nclass PaymentViewModel(private val processPaymentUseCase: ProcessPaymentUseCase) : ViewModel() {\n    fun processPayment(amount: Double) {\n        viewModelScope.launch {\n            // ‚úÖ ViewModel only orchestrates\n            processPaymentUseCase(amount)\n        }\n    }\n}\n```\n\n### 5. Lifecycle Management üî¥ CRITICAL\n**Impact**: Crashes, memory leaks, state loss\n\n**Check for**:\n- **Coroutine scopes**: Use `viewModelScope` or `lifecycleScope`, NEVER `GlobalScope`\n- **Fragment observers**: Must use `viewLifecycleOwner`, NOT `this`\n- **Resource cleanup**: Cleanup in `onCleared()` (ViewModel) or `onDestroy()`\n- **Configuration changes**: Handle rotation properly with ViewModel\n- **Flow collection**: Use `repeatOnLifecycle` or `flowWithLifecycle`\n\n**Common violations**:\n```kotlin\n// ‚ùå CRITICAL - Wrong lifecycle owner in Fragment\nclass PaymentFragment : Fragment() {\n    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {\n        viewModel.uiState.observe(this) { // ‚ùå Should be viewLifecycleOwner\n            // Update UI\n        }\n    }\n}\n\n// ‚ùå CRITICAL - GlobalScope leak\nGlobalScope.launch {\n    repository.getData()\n}\n\n// ‚úÖ GOOD\nclass PaymentFragment : Fragment() {\n    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {\n        viewModel.uiState.observe(viewLifecycleOwner) { // ‚úÖ Correct\n            // Update UI\n        }\n\n        viewLifecycleOwner.lifecycleScope.launch {\n            viewModel.uiState.collect { state ->\n                // Handle state\n            }\n        }\n    }\n}\n```\n\n### 6. MVI/MVVM Pattern Violations üî¥ HIGH\n**Impact**: Architecture consistency, maintainability, testability\n\n**MVVM Pattern Requirements**:\n- **ViewModel**: Holds UI state, handles user actions, calls UseCases\n- **View (Activity/Fragment)**: Observes state, renders UI, sends user events\n- **Model (UseCase + Repository)**: Business logic and data operations\n\n**MVI Pattern Requirements**:\n- **Intent**: User actions as sealed class\n- **Model/State**: Single immutable UIState\n- **View**: Renders state, sends intents\n- **ViewModel**: Processes intents, updates state\n\n**Check for**:\n- **No direct repository calls from ViewModel** (must use UseCase)\n- **ViewModel doesn't expose mutable state** (use private Mutable, public immutable)\n- **View doesn't contain business logic**\n- **Unidirectional data flow** (View ‚Üí Intent/Action ‚Üí ViewModel ‚Üí State ‚Üí View)\n\n**Common violations**:\n```kotlin\n// ‚ùå BAD - MVVM violation: ViewModel calling Repository directly\nclass PaymentViewModel(\n    private val paymentRepository: PaymentRepository // ‚ùå Should inject UseCase\n) : ViewModel() {\n    fun loadPayments() {\n        viewModelScope.launch {\n            val payments = paymentRepository.getPayments() // ‚ùå Skip UseCase layer\n        }\n    }\n}\n\n// ‚ùå BAD - Exposed mutable state\nclass PaymentViewModel : ViewModel() {\n    val uiState = MutableStateFlow<UIState>(UIState.Loading) // ‚ùå Mutable exposed!\n}\n\n// ‚ùå BAD - Business logic in View\nclass PaymentActivity : AppCompatActivity() {\n    fun onPayClick() {\n        val amount = amountEditText.text.toString().toDouble()\n        if (amount > 1000) { // ‚ùå Business logic in Activity!\n            // apply discount\n        }\n        viewModel.processPayment(amount)\n    }\n}\n\n// ‚úÖ GOOD - Proper MVVM\nclass PaymentViewModel(\n    private val getPaymentsUseCase: GetPaymentsUseCase, // ‚úÖ UseCase injected\n    private val processPaymentUseCase: ProcessPaymentUseCase\n) : ViewModel() {\n    private val _uiState = MutableStateFlow<PaymentUIState>(PaymentUIState.Loading)\n    val uiState: StateFlow<PaymentUIState> = _uiState.asStateFlow() // ‚úÖ Immutable exposed\n\n    fun loadPayments() {\n        viewModelScope.launch {\n            _uiState.value = PaymentUIState.Loading\n            when (val result = getPaymentsUseCase()) { // ‚úÖ Use UseCase\n                is Result.Success -> _uiState.value = PaymentUIState.Success(result.data)\n                is Result.Error -> _uiState.value = PaymentUIState.Error(result.message)\n            }\n        }\n    }\n}\n\nclass PaymentActivity : AppCompatActivity() {\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n\n        // ‚úÖ Only UI logic\n        lifecycleScope.launch {\n            viewModel.uiState.collect { state ->\n                when (state) {\n                    is PaymentUIState.Loading -> showLoading()\n                    is PaymentUIState.Success -> showPayments(state.payments)\n                    is PaymentUIState.Error -> showError(state.message)\n                }\n            }\n        }\n\n        payButton.setOnClickListener {\n            viewModel.processPayment(amountEditText.text.toString()) // ‚úÖ Just forward to ViewModel\n        }\n    }\n}\n```\n\n### Step 4: Generate Report\n\nFocus ONLY on CRITICAL (üî¥) and HIGH (üü†) priority issues. Skip medium and low priority findings.\n\nProvide structured output with:\n- **Summary**: Only üî¥ Critical and üü† High counts\n- **Critical Issues**: Memory leaks, lifecycle violations, crashes\n- **High Priority Issues**: Architecture violations, naming, UIState problems, business logic misplacement\n- **Code examples**: Current vs. fixed code\n- **Explanations**: Why it matters and impact\n- **Recommendations**: Prioritized actions\n\n## Severity Levels - CRITICAL & HIGH ONLY\n\nüî¥ **CRITICAL** - Fix immediately (blocks release)\n- **Memory leaks**: Activity/Context/View references in ViewModel\n- **Lifecycle violations**: GlobalScope usage, wrong lifecycle owner in Fragments\n- **Coroutine leaks**: Coroutines not cancelled with lifecycle\n- **Crash risks**: UI updates on background thread, unhandled exceptions\n- **Resource leaks**: Listeners/callbacks not cleaned up\n\nüü† **HIGH PRIORITY** - Fix before merge\n- **Naming violations**: Abbreviations, wrong case, unclear names, missing is/has prefix\n- **UIState problems**: Scattered state, no sealed class, mutable state exposed\n- **Business logic misplacement**: Logic in ViewModel/Activity instead of UseCase\n- **Architecture violations**: ViewModel calling Repository directly (skipping UseCase layer)\n- **Wrong pattern usage**: MVVM/MVI principles violated\n- **Lifecycle issues**: Not using viewLifecycleOwner, improper Flow collection\n\n## üö´ IGNORE (Out of Scope)\n- Code style and formatting (handled by linter)\n- Documentation and comments\n- Performance optimizations (unless critical)\n- Security issues (separate review)\n- Test coverage\n- Dependency injection setup\n- Medium/Low priority issues\n\n## Output Format\n\n```markdown\n# Android Code Review Report - Critical & High Priority Issues\n\n## Summary\n- üî¥ Critical: X issues (MUST fix before release)\n- üü† High Priority: X issues (MUST fix before merge)\n- ‚è≠Ô∏è Medium/Low issues: Skipped (not in scope)\n\n## üî¥ CRITICAL ISSUES\n\n### üî¥ Memory Leak - [Specific Issue]\n**File**: `path/to/file.kt:line`\n**Impact**: App crash, ANR, memory exhaustion\n\n**Current**:\n```kotlin\n// problematic code\n```\n\n**Fix**:\n```kotlin\n// corrected code\n```\n\n**Why**: [Explanation of memory leak and crash risk]\n\n---\n\n### üî¥ Lifecycle Violation - [Specific Issue]\n**File**: `path/to/file.kt:line`\n**Impact**: Resource leak, crash on configuration change\n\n**Current**:\n```kotlin\n// problematic code\n```\n\n**Fix**:\n```kotlin\n// corrected code\n```\n\n**Why**: [Explanation]\n\n---\n\n## üü† HIGH PRIORITY ISSUES\n\n### üü† Naming Convention - [Specific Issue]\n**File**: `path/to/file.kt:line`\n**Impact**: Code readability, team collaboration\n\n**Violations**:\n- Line X: `usr` should be `user`\n- Line Y: `loading` should be `isLoading`\n- Line Z: `pmtVM` should be `paymentViewModel`\n\n**Why**: [Explanation]\n\n---\n\n### üü† UIState Pattern - [Specific Issue]\n**File**: `path/to/file.kt:line`\n**Impact**: State inconsistency, hard to debug\n\n**Current**:\n```kotlin\n// scattered state\n```\n\n**Fix**:\n```kotlin\n// sealed class UIState\n```\n\n**Why**: [Explanation]\n\n---\n\n### üü† Business Logic Misplacement - [Specific Issue]\n**File**: `path/to/file.kt:line`\n**Impact**: Not testable, hard to reuse, violates Clean Architecture\n\n**Current**:\n```kotlin\n// business logic in ViewModel\n```\n\n**Fix**:\n```kotlin\n// business logic in UseCase\n```\n\n**Why**: [Explanation]\n\n---\n\n### üü† MVVM Pattern Violation - [Specific Issue]\n**File**: `path/to/file.kt:line`\n**Impact**: Architecture inconsistency, hard to maintain\n\n**Current**:\n```kotlin\n// ViewModel calling Repository directly\n```\n\n**Fix**:\n```kotlin\n// ViewModel calling UseCase\n```\n\n**Why**: [Explanation]\n\n---\n\n## ‚ö†Ô∏è MUST FIX\n\n**Before Release**:\n1. All üî¥ Critical issues (X total)\n\n**Before Merge**:\n1. All üü† High Priority issues (X total)\n\n## ‚úÖ Well Done\n[If applicable, acknowledge good patterns observed]\n```\n\n## Quick Reference\n\n**Focus**: Only report CRITICAL and HIGH priority issues:\n1. **Naming Conventions** - Abbreviations, wrong case, missing prefixes\n2. **Memory Leaks** - Activity/Context/View references in ViewModel\n3. **UIState Patterns** - Scattered state, exposed mutable state\n4. **Business Logic Placement** - Logic in wrong layers\n5. **Lifecycle Management** - GlobalScope, wrong lifecycle owner\n6. **MVI/MVVM Violations** - Repository calls from ViewModel, business logic in View\n\n**Skip**: Code style, documentation, performance (unless critical), security, tests, DI setup\n\n## Tips\n\n- **Focus on impact**: Only report issues that cause crashes, leaks, or violate core architecture\n- **Be specific**: Reference exact line numbers and variable names\n- **Show examples**: Always provide current vs. fixed code\n- **Explain why**: Impact on stability, maintainability, testability\n- **Be actionable**: Clear fix recommendations\n- **No nitpicking**: Skip style issues handled by linter"
              },
              {
                "name": "clean-architecture-review",
                "description": "Validate Clean Architecture implementation in iOS. Checks layer separation (Presentation/Domain/Data), MVVM patterns, dependency injection with Swinject, and UseCase/Repository patterns. Use when reviewing architecture, checking layer boundaries, or validating DI.",
                "path": "py-plugin/skills/clean-architecture-review/SKILL.md",
                "frontmatter": {
                  "name": "clean-architecture-review",
                  "description": "Validate Clean Architecture implementation in iOS. Checks layer separation (Presentation/Domain/Data), MVVM patterns, dependency injection with Swinject, and UseCase/Repository patterns. Use when reviewing architecture, checking layer boundaries, or validating DI.",
                  "allowed-tools": "Read, Grep, Glob"
                },
                "content": "# Clean Architecture Validator\n\nVerify Clean Architecture and MVVM implementation in iOS code following Payoo Merchant patterns.\n\n## When to Activate\n\n- \"architecture review\", \"layer separation\", \"clean architecture\"\n- \"MVVM\", \"dependency injection\", \"DI\"\n- \"use case\", \"repository pattern\"\n- Reviewing module structure or refactoring\n\n## Architecture Layers\n\n**Presentation** ‚Üí ViewControllers, ViewModels, Views\n**Domain** ‚Üí UseCases (business logic), Models, Repository protocols\n**Data** ‚Üí Repository implementations, API Services, Local Storage\n\n**Correct Flow**:\n```\nUI ‚Üí ViewController ‚Üí ViewModel ‚Üí UseCase ‚Üí Repository ‚Üí API/DB\n```\n\n## Review Process\n\n### Step 1: Map Architecture\n\nClassify files into layers:\n- Presentation: `*ViewController.swift`, `*ViewModel.swift`\n- Domain: `*UseCase.swift`, `*Repository.swift` (protocols)\n- Data: `*RepositoryImpl.swift`, `*ApiService.swift`\n\n### Step 2: Check Layer Violations\n\n**Critical Issues**:\n- üî¥ ViewModel calling API directly (bypassing UseCase)\n- üî¥ Business logic in ViewModel (should be in UseCase)\n- üî¥ UseCase calling API directly (bypassing Repository)\n- üî¥ Direct instantiation (no DI)\n\n### Step 3: Verify Patterns\n\n**BaseViewModel**:\n```swift\n‚úÖ class PaymentViewModel: BaseViewModel<PaymentState>\n‚ùå class PaymentViewModel  // Should extend BaseViewModel\n```\n\n**UseCase Pattern**:\n```swift\n‚úÖ protocol PaymentUseCase { }\n‚úÖ class PaymentUseCaseImpl: PaymentUseCase { }\n‚ùå class PaymentUseCase { }  // Should be protocol + impl\n```\n\n**Repository Pattern**:\n```swift\n‚úÖ protocol PaymentRepository { }  // In Domain\n‚úÖ class PaymentRepositoryImpl: PaymentRepository { }  // In Data\n```\n\n**Dependency Injection**:\n```swift\n‚úÖ init(paymentUC: PaymentUseCase) {  // Constructor injection\n    self.paymentUC = paymentUC\n}\n‚ùå let paymentUC = PaymentUseCaseImpl()  // Direct instantiation\n```\n\n### Step 4: Generate Report\n\nProvide:\n- Architecture compliance score\n- Layer violations by severity\n- Current vs. should-be architecture\n- Refactoring steps\n- Effort estimate\n\n## Common Violations\n\n### ‚ùå ViewModel Bypassing UseCase\n```swift\nclass PaymentViewModel {\n    private let apiService: PaymentApiService  // WRONG LAYER!\n}\n```\n**Should be**:\n```swift\nclass PaymentViewModel {\n    private let paymentUC: PaymentUseCase  // CORRECT!\n}\n```\n\n### ‚ùå Business Logic in ViewModel\n```swift\nclass PaymentViewModel {\n    func processPayment(amount: Double) {\n        // ‚ùå Validation in ViewModel\n        guard amount > 1000 else { return }\n        // ‚ùå Business rules in ViewModel\n        let fee = amount * 0.01\n    }\n}\n```\n**Should be in UseCase**:\n```swift\nclass PaymentUseCaseImpl {\n    func execute(amount: Double) -> Single<PaymentResult> {\n        // ‚úÖ Validation in UseCase\n        return validateAmount(amount)\n            .flatMap { processPayment($0) }\n    }\n}\n```\n\n## Output Format\n\n```markdown\n# Clean Architecture Review\n\n## Compliance Score: X/100\n\n## Critical Violations: X\n\n### 1. ViewModel Bypassing UseCase\n**File**: `PaymentViewModel.swift:15`\n**Current**: ViewModel ‚Üí API\n**Should be**: ViewModel ‚Üí UseCase ‚Üí Repository ‚Üí API\n\n**Fix**: [Refactoring steps]\n\n---\n\n## Dependency Graph\n\n### Current (Problematic)\nViewModel ‚Üí ApiService ‚ùå\n\n### Should Be\nViewModel ‚Üí UseCase ‚Üí Repository ‚Üí ApiService ‚úÖ\n\n## Recommendations\n1. Create missing UseCases\n2. Move business logic to Domain layer\n3. Setup DI container\n4. Add Repository layer\n\n## Effort Estimate\n- Module refactoring: X hours\n- DI setup: X hours\n- Testing: X hours\n```\n\n## Quick Checks\n\n**Layer Boundaries**:\n- [ ] ViewModels only depend on UseCases\n- [ ] UseCases contain all business logic\n- [ ] Repositories handle data access only\n- [ ] No UI code in Domain/Data layers\n\n**Dependency Injection**:\n- [ ] All dependencies via constructor\n- [ ] No direct instantiation\n- [ ] Swinject container registration\n- [ ] Protocol-based dependencies\n\n**Patterns**:\n- [ ] ViewModels extend BaseViewModel\n- [ ] UseCases follow protocol + impl\n- [ ] Repositories follow protocol + impl\n- [ ] State management via setState()\n\n## Reference\n\n**Detailed Examples**: See `examples.md` for complete architecture patterns and refactoring guides."
              },
              {
                "name": "copilot-agent-builder",
                "description": "Generate custom GitHub Copilot agents (.agent.md files) for VS Code with proper YAML frontmatter, tools configuration, and handoff workflows. Use when \"create copilot agent\", \"generate github copilot agent\", \"new copilot agent for\", \"make a copilot agent\", or \"build copilot agent\".",
                "path": "py-plugin/skills/copilot-agent-builder/SKILL.md",
                "frontmatter": {
                  "name": "copilot-agent-builder",
                  "description": "Generate custom GitHub Copilot agents (.agent.md files) for VS Code with proper YAML frontmatter, tools configuration, and handoff workflows. Use when \"create copilot agent\", \"generate github copilot agent\", \"new copilot agent for\", \"make a copilot agent\", or \"build copilot agent\".",
                  "allowed-tools": "Read, Write, Glob, Bash, AskUserQuestion"
                },
                "content": "# GitHub Copilot Agent Builder\n\nGenerate custom GitHub Copilot agents following VS Code's `.agent.md` format with proper YAML frontmatter and markdown instructions.\n\n## When to Activate\n\nTrigger this skill when user says:\n- \"create copilot agent\"\n- \"generate github copilot agent\"\n- \"new copilot agent for [purpose]\"\n- \"make a copilot agent\"\n- \"build copilot agent\"\n- \"copilot custom agent\"\n\n## Agent Creation Process\n\n### Step 1: Gather Requirements\n\nAsk user for agent configuration:\n\n1. **Agent Purpose & Name**:\n   - What should the agent do? (e.g., \"plan features\", \"review security\", \"write tests\")\n   - Suggested name: Extract from purpose (e.g., \"planner\", \"security-reviewer\", \"test-writer\")\n\n2. **Tools Selection** (multi-select):\n   - `fetch` - Retrieve web content and documentation\n   - `search` - Search codebase and files\n   - `githubRepo` - Access GitHub repository data\n   - `usages` - Find code references and usage patterns\n   - `files` - File operations\n   - Custom tools if available\n\n3. **Handoff Workflows** (optional):\n   - Should this agent hand off to another? (e.g., planner ‚Üí coder)\n   - Handoff agent name\n   - Handoff prompt text\n   - Auto-send handoff? (yes/no)\n\n4. **Additional Configuration** (optional):\n   - Specific model to use?\n   - Argument hint for users?\n\n### Step 2: Validate Directory Structure\n\n```bash\n# Ensure .github/agents directory exists\nmkdir -p .github/agents\n```\n\n### Step 3: Generate Agent File\n\nCreate `.github/agents/{agent-name}.agent.md` with:\n\n**YAML Frontmatter Structure**:\n```yaml\n---\ndescription: [Brief overview shown in chat input]\nname: [Agent identifier, lowercase with hyphens]\ntools: [Array of tool names]\nhandoffs:  # Optional\n  - label: [Button text]\n    agent: [Target agent name]\n    prompt: [Handoff message]\n    send: [true/false - auto-submit?]\nmodel: [Optional - specific model name]\nargument-hint: [Optional - user guidance text]\n---\n```\n\n**Markdown Body**:\n- Clear role definition\n- Specific instructions\n- Tool usage guidance (reference as `#tool:toolname`)\n- Output format expectations\n- Constraints and guidelines\n\n### Step 4: Validate Format\n\nEnsure generated file has:\n- ‚úì Valid YAML frontmatter with `---` delimiters\n- ‚úì All required fields (description, name)\n- ‚úì Tools array properly formatted\n- ‚úì Handoffs array if specified (with label, agent, prompt, send)\n- ‚úì Markdown instructions that are clear and actionable\n\n### Step 5: Confirm Creation\n\nShow user:\n```markdown\n‚úÖ GitHub Copilot Agent Created\n\nüìÅ Location: `.github/agents/{name}.agent.md`\nüéØ Agent: {name}\nüìù Description: {description}\nüõ†Ô∏è  Tools: {tools list}\n\nTo use:\n1. Reload VS Code window (Cmd/Ctrl + Shift + P ‚Üí \"Reload Window\")\n2. Open GitHub Copilot Chat\n3. Type `@{name}` to invoke your custom agent\n\n{If handoffs configured: \"This agent can hand off to: {handoff targets}\"}\n```\n\n## Output Format\n\nAfter creation, provide:\n\n1. **File path confirmation**\n2. **Configuration summary** (name, description, tools, handoffs)\n3. **Usage instructions** (how to reload and use)\n4. **Next steps** (testing suggestions)\n\n## Reference Documentation\n\n- Templates and structures ‚Üí `templates.md`\n- Real-world examples ‚Üí `examples.md`\n\n## Important Guidelines\n\n1. **Naming Convention**: Use lowercase with hyphens (e.g., `feature-planner`, `security-reviewer`)\n2. **Description**: Brief (1-2 sentences), shown in chat input UI\n3. **Tools**: Only include tools the agent actually needs\n4. **Handoffs**: Enable multi-step workflows (planning ‚Üí implementation ‚Üí testing)\n5. **Instructions**: Be specific about what the agent should and shouldn't do\n6. **Tool References**: Use `#tool:toolname` syntax in markdown body\n\n## Common Agent Patterns\n\n**Planning Agent**:\n- Tools: `fetch`, `search`, `githubRepo`, `usages`\n- Handoff: To implementation agent\n- Focus: Analysis and planning, no code edits\n\n**Implementation Agent**:\n- Tools: `search`, `files`, `usages`\n- Handoff: To testing agent\n- Focus: Write and modify code\n\n**Review Agent**:\n- Tools: `search`, `githubRepo`, `usages`\n- Handoff: Back to implementation for fixes\n- Focus: Quality, security, performance checks\n\n**Testing Agent**:\n- Tools: `search`, `files`\n- Handoff: Back to implementation or to review\n- Focus: Test creation and validation\n\n---\n\n**Ready to build custom GitHub Copilot agents!**"
              },
              {
                "name": "ios-code-review",
                "description": "Concise iOS code review for Payoo Merchant app. Focuses on critical/high/medium issues - RxSwift memory leaks, retain cycles, naming conventions, Clean Architecture violations, and business logic placement. Use when reviewing Swift files, pull requests, ViewModels, ViewControllers, UseCases, and Repositories.",
                "path": "py-plugin/skills/ios-code-review/SKILL.md",
                "frontmatter": {
                  "name": "ios-code-review",
                  "description": "Concise iOS code review for Payoo Merchant app. Focuses on critical/high/medium issues - RxSwift memory leaks, retain cycles, naming conventions, Clean Architecture violations, and business logic placement. Use when reviewing Swift files, pull requests, ViewModels, ViewControllers, UseCases, and Repositories.",
                  "allowed-tools": "Read, Grep, Glob"
                },
                "content": "# iOS Code Review - Priority Issues Focus\n\nExpert iOS code reviewer for Payoo Merchant application, focusing on CRITICAL, HIGH, and MEDIUM priority issues that impact app stability, maintainability, and architecture.\n\n## When to Activate\n\n- \"review code\", \"check this file\", \"review PR\"\n- Mentions Swift files: ViewController, ViewModel, UseCase, Repository\n- \"code quality\", \"best practices\", \"check standards\"\n- RxSwift memory leaks, retain cycles, Clean Architecture, MVVM patterns\n\n## Review Process\n\n### Step 1: Identify Scope\nDetermine what to review:\n- Specific files (e.g., \"PaymentViewModel.swift\")\n- Directories (e.g., \"Payment module\")\n- Git changes (recent commits, PR diff)\n- Entire module or feature\n\n### Step 2: Read and Analyze\nUse Read tool to examine files, focusing on CRITICAL, HIGH, and MEDIUM priority issues only.\n\n### Step 3: Apply Priority Standards\n\n## üéØ PRIORITY FOCUS AREAS\n\n### 1. RxSwift Memory Leaks üî¥ CRITICAL\n**Impact**: Memory leaks, app crashes, performance degradation\n\n**Check for**:\n- **Missing disposal**: Every `.subscribe()` MUST have `.disposed(by: disposeBag)`\n- **Retain cycles**: Use `[weak self]` in all closures capturing `self`\n- **DisposeBag**: Must be declared as instance variable, not local\n- **Observable chains**: No abandoned subscriptions\n\n**Common violations**:\n```swift\n// ‚ùå CRITICAL - Memory leak\nobservable\n    .subscribe(onNext: { value in\n        self.updateUI(value) // Missing disposed(by:)\n    })\n\n// ‚ùå CRITICAL - Retain cycle\nobservable\n    .subscribe(onNext: { [self] value in // Strong self!\n        self.updateUI(value)\n    })\n    .disposed(by: disposeBag)\n\n// ‚úÖ GOOD\nobservable\n    .subscribe(onNext: { [weak self] value in\n        self?.updateUI(value)\n    })\n    .disposed(by: disposeBag)\n```\n\n### 2. Naming Conventions üü† HIGH\n**Impact**: Code readability, maintainability, team collaboration\n\n**Check for**:\n- **Types**: PascalCase, descriptive (e.g., `PaymentViewModel`, not `PmtVM`)\n- **Variables**: camelCase (e.g., `paymentAmount`, not `pmt_amt`)\n- **Booleans**: Must have `is`/`has`/`should`/`can` prefix (e.g., `isLoading`, not `loading`)\n- **NO abbreviations** except URL, ID, VC (ViewController), UC (UseCase)\n- **IBOutlets**: Must include type suffix (e.g., `amountTextField`, not `amount`)\n\n**Common violations**:\n```swift\n// ‚ùå BAD\nvar usr: User?\nvar loading = false\n@IBOutlet weak var amount: UITextField!\nvar pmtVM: PaymentViewModel?\n\n// ‚úÖ GOOD\nvar user: User?\nvar isLoading = false\n@IBOutlet weak var amountTextField: UITextField!\nvar paymentViewModel: PaymentViewModel?\n```\n\n### 3. Clean Architecture Violations üü† HIGH\n**Impact**: Testability, maintainability, architecture integrity\n\n**Check for**:\n- **ViewModels**: Must extend `BaseViewModel<State>`, NO business logic\n- **ViewModel ‚Üí UseCase**: ViewModels MUST call UseCases, NEVER call Repository/API directly\n- **Business logic**: Must be in UseCases ONLY, not in ViewModel/ViewController\n- **Dependency injection**: All dependencies via constructor (Swinject)\n- **Layer separation**: ViewModel ‚Üí UseCase ‚Üí Repository ‚Üí DataSource\n\n**Common violations**:\n```swift\n// ‚ùå BAD - ViewModel calling Repository directly\nclass PaymentViewModel {\n    private let repository: PaymentRepository\n\n    func loadPayments() {\n        repository.getPayments() // ‚ùå Skip UseCase layer\n            .subscribe(onNext: { payments in\n                // ...\n            })\n            .disposed(by: disposeBag)\n    }\n}\n\n// ‚ùå BAD - Business logic in ViewModel\nclass PaymentViewModel {\n    func processPayment(amount: Double) {\n        if amount <= 0 { return } // ‚ùå Business logic!\n        let fee = amount * 0.02\n        let total = amount + fee\n        // ...\n    }\n}\n\n// ‚úÖ GOOD - Proper Clean Architecture\nclass PaymentViewModel: BaseViewModel<PaymentState> {\n    private let getPaymentsUseCase: GetPaymentsUseCase\n    private let processPaymentUseCase: ProcessPaymentUseCase\n\n    init(getPaymentsUseCase: GetPaymentsUseCase,\n         processPaymentUseCase: ProcessPaymentUseCase) {\n        self.getPaymentsUseCase = getPaymentsUseCase\n        self.processPaymentUseCase = processPaymentUseCase\n        super.init()\n    }\n\n    func loadPayments() {\n        getPaymentsUseCase.execute() // ‚úÖ Call UseCase\n            .subscribe(onNext: { [weak self] payments in\n                self?.state.accept(.success(payments))\n            })\n            .disposed(by: disposeBag)\n    }\n}\n```\n\n### 4. RxSwift Scheduler Issues üü° MEDIUM\n**Impact**: UI freezes, background thread crashes\n\n**Check for**:\n- **Background work**: Use `.subscribeOn(ConcurrentDispatchQueueScheduler(qos: .background))`\n- **UI updates**: Must use `.observeOn(MainScheduler.instance)` before UI work\n- **Never block main thread**: Network/DB operations on background scheduler\n\n**Common violations**:\n```swift\n// ‚ùå BAD - Heavy work on main thread\napiService.getData()\n    .subscribe(onNext: { data in\n        // Heavy processing on main thread\n        self.processLargeData(data)\n    })\n    .disposed(by: disposeBag)\n\n// ‚úÖ GOOD - Proper scheduler usage\napiService.getData()\n    .subscribeOn(ConcurrentDispatchQueueScheduler(qos: .background))\n    .map { data in\n        // Heavy processing on background\n        return self.processLargeData(data)\n    }\n    .observeOn(MainScheduler.instance)\n    .subscribe(onNext: { [weak self] result in\n        // UI updates on main\n        self?.updateUI(result)\n    })\n    .disposed(by: disposeBag)\n```\n\n### 5. Error Handling üü° MEDIUM\n**Impact**: App crashes, poor UX\n\n**Check for**:\n- **Observable chains**: Must handle `.onError` or use `catchError`\n- **API calls**: All network operations must have error handling\n- **User feedback**: Show error messages to user\n\n**Common violations**:\n```swift\n// ‚ùå BAD - No error handling\napiService.getData()\n    .subscribe(onNext: { data in\n        self.updateUI(data)\n    })\n    .disposed(by: disposeBag)\n\n// ‚úÖ GOOD - Proper error handling\napiService.getData()\n    .subscribe(\n        onNext: { [weak self] data in\n            self?.updateUI(data)\n        },\n        onError: { [weak self] error in\n            self?.showError(error.localizedDescription)\n        }\n    )\n    .disposed(by: disposeBag)\n\n// ‚úÖ BETTER - Using catchError\napiService.getData()\n    .catchError { error in\n        return Observable.just(defaultData)\n    }\n    .subscribe(onNext: { [weak self] data in\n        self?.updateUI(data)\n    })\n    .disposed(by: disposeBag)\n```\n\n### 6. Deprecated Patterns üü° MEDIUM\n**Impact**: Future compatibility, best practices\n\n**Check for**:\n- **Use BehaviorRelay/PublishRelay** instead of BehaviorSubject/PublishSubject\n- **Avoid Variable**: Use BehaviorRelay instead\n\n**Common violations**:\n```swift\n// ‚ùå BAD - Using deprecated BehaviorSubject\nprivate let loadingSubject = BehaviorSubject<Bool>(value: false)\n\n// ‚úÖ GOOD - Use BehaviorRelay\nprivate let loadingRelay = BehaviorRelay<Bool>(value: false)\n```\n\n### Step 4: Generate Concise Report\n\nFocus ONLY on CRITICAL (üî¥), HIGH (üü†), and MEDIUM (üü°) priority issues. Skip low priority findings.\n\nProvide concise, actionable output with:\n- **Summary**: Only üî¥/üü†/üü° counts (one line per severity)\n- **Issues**: Group by severity, concise title + file + line number\n- **Code snippets**: Only for Critical/High issues, keep minimal\n- **Quick fixes**: Brief, actionable recommendations\n\n## Severity Levels - CRITICAL/HIGH/MEDIUM ONLY\n\nüî¥ **CRITICAL** - Fix immediately (blocks release)\n- **Missing disposal**: `.subscribe()` without `.disposed(by: disposeBag)` ‚Üí Memory leak\n- **Retain cycles**: Strong `self` in closures ‚Üí Memory leak\n- **UI on background thread**: UI updates not on MainScheduler ‚Üí Crash risk\n\nüü† **HIGH PRIORITY** - Fix before merge\n- **Naming violations**: Abbreviations, wrong case, missing is/has prefix, IBOutlet without type suffix\n- **Architecture violations**: ViewModel calling Repository/API directly (skipping UseCase)\n- **Business logic misplacement**: Business logic in ViewModel/ViewController instead of UseCase\n- **Missing BaseViewModel**: ViewModel not extending `BaseViewModel<State>`\n\nüü° **MEDIUM PRIORITY** - Fix in current sprint\n- **No error handling**: Observable chains without onError or catchError\n- **Wrong schedulers**: Heavy work on main thread, missing observeOn(MainScheduler)\n- **Deprecated patterns**: Using BehaviorSubject/PublishSubject instead of Relay\n\n## üö´ IGNORE (Out of Scope)\n- Code style and formatting (handled by SwiftLint)\n- Documentation and comments\n- Accessibility (unless critical)\n- Security issues (separate review)\n- Performance optimizations (unless critical)\n- UI/UX improvements\n- Low priority issues\n\n## Output Format\n\n**KEEP IT CONCISE** - Focus on actionable findings only.\n\n```markdown\n# iOS Code Review - Priority Issues\n\n## Summary\nüî¥ Critical: X | üü† High: X | üü° Medium: X\n\n## üî¥ CRITICAL ISSUES (Fix Immediately)\n\n1. **Memory leak - Missing disposal** - `PaymentViewModel.swift:45`\n   ```swift\n   // ‚ùå observable.subscribe(onNext: { ... }) // No disposal\n   // ‚úÖ .disposed(by: disposeBag)\n   ```\n\n2. **Retain cycle - Strong self** - `TransactionViewController.swift:78`\n   - Use `[weak self]` instead of `[self]`\n\n---\n\n## üü† HIGH PRIORITY (Fix Before Merge)\n\n1. **Naming - Abbreviations** - `UserViewModel.swift:12`\n   - `usr` ‚Üí `user`, `pmtVM` ‚Üí `paymentViewModel`\n\n2. **Architecture - ViewModel calls Repository directly** - `PaymentViewModel.swift:34`\n   - Inject and call `GetPaymentsUseCase` instead of `PaymentRepository`\n\n3. **Business logic in ViewModel** - `PaymentViewModel.swift:56-60`\n   - Move fee calculation to `ProcessPaymentUseCase`\n\n---\n\n## üü° MEDIUM PRIORITY (Fix This Sprint)\n\n1. **No error handling** - `DashboardViewModel.swift:89`\n   - Add `onError` or `catchError` to API call\n\n2. **Wrong scheduler** - `TransactionListViewModel.swift:123`\n   - Add `.observeOn(MainScheduler.instance)` before UI update\n\n3. **Deprecated BehaviorSubject** - `SettingsViewModel.swift:23`\n   - Use `BehaviorRelay` instead\n\n---\n\n## ‚ö†Ô∏è Action Required\n- üî¥ **X Critical** - Block release, fix now\n- üü† **X High** - Block merge, fix today\n- üü° **X Medium** - Fix in current sprint\n\n‚úÖ **Well Done**: [If applicable, briefly acknowledge 1-2 good patterns]\n```\n\n## Quick Reference\n\n**Focus on 6 Priority Areas**:\n1. üî¥ **RxSwift Memory Leaks** - Missing disposal, retain cycles\n2. üü† **Naming Conventions** - Abbreviations, wrong case, missing prefixes\n3. üü† **Clean Architecture** - ViewModel ‚Üí UseCase ‚Üí Repository flow\n4. üü° **Schedulers** - Background work, main thread UI updates\n5. üü° **Error Handling** - onError, catchError in Observable chains\n6. üü° **Deprecated Patterns** - BehaviorRelay vs BehaviorSubject\n\n**Skip**: Code style, docs, accessibility, security, performance (unless critical), UI/UX, low priority\n\n## Tips\n\n- **Be concise**: One-line issue descriptions when possible\n- **Be specific**: Exact file paths and line numbers\n- **Be actionable**: Clear fix instructions\n- **Show code**: Only for Critical/High issues, keep minimal\n- **Group issues**: Batch similar violations (e.g., \"5 naming violations in PaymentViewModel.swift:12,34,56,78,90\")\n- **No explanations**: Skip \"Why\" unless unclear - developers know why memory leaks are bad"
              },
              {
                "name": "ios-delivery-build",
                "description": "Manage iOS delivery builds to QC testing with GitLab pipeline creation and issue management. Supports develop, delivery, bugfix, and redelivery modes. Use when \"create delivery\", \"delivery build\", \"build for qc\", \"send to testing\", or \"deliver build\".",
                "path": "py-plugin/skills/ios-delivery-build/SKILL.md",
                "frontmatter": {
                  "name": "ios-delivery-build",
                  "description": "Manage iOS delivery builds to QC testing with GitLab pipeline creation and issue management. Supports develop, delivery, bugfix, and redelivery modes. Use when \"create delivery\", \"delivery build\", \"build for qc\", \"send to testing\", or \"deliver build\".",
                  "allowed-tools": "Bash, AskUserQuestion, Read"
                },
                "content": "You are managing iOS delivery builds to QC testing with GitLab integration.\n\n## Step 1: Get Current Branch\n\nExecute immediately:\n```bash\ngit branch --show-current\n```\n\nStore result as `{current_branch}`.\n\n## Step 2: Mode Selection\n\nAsk user to select delivery mode:\n- **develop**: Create develop task and move original to testing\n- **delivery**: Close issues after delivery\n- **bugfix**: Move issues to testing status\n- **redelivery**: Create pipeline only, no issue management\n\nUse AskUserQuestion with these exact options:\n- \"develop - Create develop task and move original to testing\"\n- \"delivery - Close issues after delivery\"\n- \"bugfix - Move issues to testing status\"\n- \"redelivery - Create pipeline only\"\n\nIf invalid mode after 3 attempts, abort with error.\n\n## Step 3: Collect Form Inputs\n\nPresent form template from `templates.md` based on selected mode.\n\n**Required for ALL modes:**\n- branch (pre-filled with {current_branch})\n- scheme (default: \"Payoo Merchant Sandbox\")\n- recipient (from predefined list in templates.md)\n- description\n- reply_on_thread (default: \"none\")\n- project (default: \"rnd/ios/payoo-ios-app-merchant\")\n\n**Conditional fields:**\n- issue_numbers: Required for develop/delivery/bugfix, NOT for redelivery\n- estimates: Required for develop/delivery, NOT for bugfix/redelivery\n\nParse user input and extract all field values.\n\n## Step 4: Validate Inputs\n\nBefore proceeding, validate:\n- branch exists (check with `git branch --list`)\n- issue_numbers are numeric (skip for redelivery)\n- recipient matches format \"Name|ID\" from predefined list\n- estimates count matches issue_numbers count (for delivery/develop only)\n- reply_on_thread is \"none\" or valid URL\n- scheme and project are non-empty\n\nIf validation fails, show specific errors and request corrections.\n\n## Step 5: Create GitLab Pipeline\n\nUse MCP tool `mobile-mcp-server/gitlab-create-pipeline-for-branch`:\n```\nscheme: {scheme}\nbranchName: {branch}\nrecipient: {recipient}\nreplyOnThread: {reply_on_thread}\ndescription: {description}\nproject: {project}\n```\n\nIf pipeline creation fails, abort workflow with error.\n\n## Step 6: Plan Issue Management Actions\n\nBased on mode, plan actions (see `examples.md` for detailed workflows):\n\n**bugfix mode:**\n- For each issue in issue_numbers, plan to add label \"status::totesting\"\n\n**delivery mode:**\n- For each issue, plan to close with corresponding estimate\n\n**develop mode:**\n- Get first issue details\n- Create develop task with \"[Develop]\" suffix\n- Move original issue to testing\n- Close develop task with estimate\n\n**redelivery mode:**\n- No issue actions needed, skip to completion\n\n## Step 7: Confirmation and Execution\n\n**For redelivery mode:**\n- Display: \"Pipeline created successfully. No issue management for redelivery.\"\n- End workflow\n\n**For other modes:**\n- Display all planned actions in readable format\n- Ask: \"Do you want to proceed? (yes/no)\"\n- If \"yes\": Execute all actions sequentially, show progress\n- If \"no\": Abort with message about pipeline being created but issues not managed\n\n## Error Handling\n\n- Invalid issue IID: Skip and log warning, continue with others\n- API timeout: Retry once after 5 seconds, then fail\n- Authentication error: Abort immediately\n- Invalid branch: Abort before creating pipeline\n\nAlways provide:\n- What failed\n- Why it failed (if known)\n- What completed successfully\n- Suggested next steps\n\n## Output Format\n\nShow clear summary:\n```\n‚úÖ Pipeline Created\nBranch: {branch}\nScheme: {scheme}\nRecipient: {recipient}\nDescription: {description}\n\nüìã Issue Management:\n[List of planned/executed actions]\n\n‚úÖ Workflow Complete\n```"
              },
              {
                "name": "ios-generate-unit-tests",
                "description": "Generate comprehensive unit tests for iOS RxSwift project files (ViewModels, UseCases, Services). Creates complete test files with nested mocks, RxTest patterns, session error handling, and memory leak tests. Use when \"generate unit tests\", \"write tests for\", \"create unit tests\", \"add tests for\", or analyzing Swift files in PayooMerchant project.",
                "path": "py-plugin/skills/ios-generate-unit-tests/SKILL.md",
                "frontmatter": {
                  "name": "ios-generate-unit-tests",
                  "description": "Generate comprehensive unit tests for iOS RxSwift project files (ViewModels, UseCases, Services). Creates complete test files with nested mocks, RxTest patterns, session error handling, and memory leak tests. Use when \"generate unit tests\", \"write tests for\", \"create unit tests\", \"add tests for\", or analyzing Swift files in PayooMerchant project.",
                  "allowed-tools": "Read, Write, Glob, Grep"
                },
                "content": "# iOS RxSwift Unit Test Generator\n\nAutomatically generate comprehensive unit tests for iOS RxSwift project following Clean Architecture patterns.\n\n## When to Activate\n\n- \"generate unit tests for [file]\"\n- \"write tests for [ViewModel/UseCase/Service]\"\n- \"create unit tests for this file\"\n- \"add tests for [class name]\"\n- \"test [file path]\"\n\n## Process\n\n### 1. Identify Target File\n\n**Ask user for file to test** (if not provided):\n```\nWhich file would you like to generate tests for?\nProvide the file path or class name (e.g., BalanceInformationViewModel.swift)\n```\n\n**Read target file** and determine type:\n- ViewModel: Has `ViewModelType`, `Input`, `Output`, `transform` method\n- UseCase: Implements `*UseCaseType` protocol\n- Service: Implements service protocol\n\n### 2. Read Testing Guide\n\n**CRITICAL**: Read the comprehensive testing guide:\n```\n~/Library/Application Support/Code/User/prompts/ios-mc-generate-unit-test.prompt.md\n```\n\nThis guide contains ALL rules, patterns, and examples to follow.\n\n### 3. Analyze Target File\n\n**Extract from target file:**\n- Class name and type (ViewModel/UseCase/Service)\n- All dependencies (injected in initializer)\n- Protocol types for each dependency\n- Public methods and their signatures\n- Input/Output structure (for ViewModels)\n- Observable/Single/Completable return types\n\n**Search for protocol definitions** if needed:\n```bash\nGlob: **/*UseCaseType.swift\nGrep: \"protocol [DependencyName]\"\n```\n\n### 4. Generate Test File\n\n**Create complete test file** at:\n```\nPayooMerchantTests/[appropriate-folder]/[ClassName]Tests.swift\n```\n\n**Folder structure:**\n- ViewModels ‚Üí `PayooMerchantTests/ViewModel/`\n- UseCases ‚Üí `PayooMerchantTests/UseCase/`\n- Services ‚Üí `PayooMerchantTests/Mock/Service/`\n\n**Test file MUST include:**\n\n1. **Required imports**:\n   ```swift\n   import XCTest\n   import RxSwift\n   import RxCocoa\n   import RxTest\n   import RxBlocking\n   import Domain\n   @testable import PayooMerchant\n   ```\n\n2. **Test class with nested mocks**:\n   - ALL mocks as `private final class` nested inside test class\n   - One mock for EACH dependency\n   - Include call tracking (`callCount`, `lastParams`)\n   - Include configurable return values\n\n3. **Properties section**:\n   - `private var disposeBag: DisposeBag!`\n   - `private var scheduler: TestScheduler!`\n   - Mock instances for each dependency\n\n4. **setUp/tearDown**:\n   - Initialize disposeBag, scheduler, all mocks\n   - Clean up all properties to nil\n\n5. **Test data factories**:\n   - Helper methods to create test entities\n   - Use default parameters\n\n6. **Comprehensive test methods**:\n   - Initial load success\n   - Load error handling\n   - Empty state\n   - Loading state\n   - Session error handling (if API calls)\n   - Memory leak test (for ViewModels)\n   - Permission tests (if applicable)\n   - User action tests\n   - State transition tests\n   - Edge cases\n\n**Follow naming convention**:\n```swift\nfunc test_methodName_condition_expectedBehavior()\n```\n\n### 5. Generate Tests Based on Type\n\n#### For ViewModels:\n- Test each Input ‚Üí Output transformation\n- Use `TestScheduler` and hot observables for inputs\n- Create observers for each output driver\n- Test loading states, errors, empty states\n- Include memory leak test:\n  ```swift\n  func test_viewModel_shouldDeallocateProperly()\n  ```\n\n#### For UseCases:\n- Test each public method\n- Mock all service dependencies\n- Test success and error scenarios\n- **CRITICAL**: Test session error handling:\n  ```swift\n  func test_catchSessionError_SessionTimeoutError_shouldSetExpiredState()\n  func test_catchSessionError_ForceUpdateError_shouldSetForceUpdateState()\n  ```\n\n#### For Services:\n- Test all CRUD operations\n- Test observable streams\n- Test data persistence\n\n### 6. Validate Generated Tests\n\n**Ensure:**\n- ‚úÖ All mocks are nested `private final class`\n- ‚úÖ Proper imports included\n- ‚úÖ setUp/tearDown with cleanup\n- ‚úÖ DisposeBag and TestScheduler used\n- ‚úÖ Descriptive test names\n- ‚úÖ Descriptive assertions with messages\n- ‚úÖ All dependencies mocked\n- ‚úÖ Session error tests for API calls\n- ‚úÖ Memory leak test for ViewModels\n\n## Output Format\n\nAfter generating tests, show:\n\n```markdown\n‚úÖ Generated Unit Tests: [ClassName]Tests.swift\n\nüìÅ Location: PayooMerchantTests/[folder]/[ClassName]Tests.swift\n\nüìä Test Coverage:\n- [X] Nested mocks created: [count]\n- [X] Test methods: [count]\n- [X] Scenarios covered:\n  ‚úì Success cases\n  ‚úì Error handling\n  ‚úì Empty states\n  ‚úì Loading states\n  ‚úì Session errors (if API)\n  ‚úì Memory leak test (if ViewModel)\n  ‚úì [Other scenarios]\n\nüéØ Test Naming Pattern:\ntest_methodName_condition_expectedBehavior\n\n‚ö° Next Steps:\n1. Review generated tests\n2. Run: xcodebuild test -scheme PayooMerchantTests\n3. Or run specific plan: bundle exec fastlane run_test_plan test_plan:\"[plan-name]\"\n\nüìñ Generated following guide: ~/Library/Application Support/Code/User/prompts/ios-mc-generate-unit-test.prompt.md\n```\n\n## Key Rules (from Testing Guide)\n\n1. **ALWAYS** create mocks as nested `private final class`\n2. **ALWAYS** use TestScheduler for ViewModels\n3. **ALWAYS** include session error tests for API calls\n4. **ALWAYS** include memory leak test for ViewModels\n5. **ALWAYS** use descriptive assertions with messages\n6. **ALWAYS** follow Arrange-Act-Assert pattern\n7. **NEVER** create global/standalone mock classes\n8. **NEVER** skip setUp/tearDown cleanup\n\n## Example Test Structure\n\n```swift\nfinal class BalanceInformationViewModelTests: XCTestCase {\n    // MARK: - Mocks\n    private final class MockBalanceUseCase: BalanceUseCaseType {\n        var getBalanceResult: Single<Balance> = .never()\n        var getBalanceCallCount = 0\n        \n        func getBalance() -> Single<Balance> {\n            getBalanceCallCount += 1\n            return getBalanceResult\n        }\n    }\n    \n    // MARK: - Properties\n    private var disposeBag: DisposeBag!\n    private var scheduler: TestScheduler!\n    private var mockBalanceUC: MockBalanceUseCase!\n    \n    // MARK: - Setup & Teardown\n    override func setUp() {\n        super.setUp()\n        disposeBag = DisposeBag()\n        scheduler = TestScheduler(initialClock: 0)\n        mockBalanceUC = MockBalanceUseCase()\n    }\n    \n    override func tearDown() {\n        disposeBag = nil\n        scheduler = nil\n        mockBalanceUC = nil\n        super.tearDown()\n    }\n    \n    // MARK: - Test Data Factory\n    private func makeTestBalance() -> Balance {\n        // ...\n    }\n    \n    // MARK: - Tests\n    func test_transform_withLoadTrigger_shouldReturnBalance() {\n        // Arrange\n        // Act\n        // Assert\n    }\n}\n```\n\n---\n\n**References:**\n- Testing Guide: `~/Library/Application Support/Code/User/prompts/ios-mc-generate-unit-test.prompt.md`\n- Project Structure: `PayooMerchantTests/`\n- Existing Tests: Use as reference for patterns"
              },
              {
                "name": "ios-instruments-performance-cli",
                "description": "Use Xcode Instruments command line tools to analyze iOS app performance, detect memory leaks, optimize launch times, monitor CPU usage, and identify performance bottlenecks for the iOS project",
                "path": "py-plugin/skills/ios-instruments-performance-cli/SKILL.md",
                "frontmatter": {
                  "name": "ios-instruments-performance-cli",
                  "description": "Use Xcode Instruments command line tools to analyze iOS app performance, detect memory leaks, optimize launch times, monitor CPU usage, and identify performance bottlenecks for the iOS project",
                  "allowed-tools": "Bash, Read, Write"
                },
                "content": "# iOS Instruments Performance CLI\n\n## Instructions\n\nWhen helping with iOS app performance optimization using Instruments command line tools:\n\n### 1. Setup Analysis Environment\n\n**CRITICAL: Always use device UUID, never device names**\n\n- Get device UUID: `xcrun simctl list devices available | grep \"iPhone\"`\n- Device names like \"iPhone 17 Pro\" are ambiguous and will fail\n- Use UUID format: `F464E766-555C-4B95-B8CC-763702A70791`\n\n**Clean installation state (REQUIRED)**\n\n- Always uninstall app before profiling: `xcrun simctl uninstall $DEVICE_UUID <bundle id>`\n- Multiple app installations cause \"process is ambiguous\" errors\n- Alternative: Completely erase simulator for cleanest state\n\n**Build configuration**\n\n- Build in Release mode for accurate performance measurements\n\n### 2. Choose Appropriate Instrument Template\n\nUse `xcrun xctrace list templates` to see available templates:\n\n- **App Launch** - Essential for launch time optimization (most common)\n- **Time Profiler** - CPU performance analysis\n- **Allocations** - Memory usage tracking\n- **Leaks** - Memory leak detection\n- **Network** - API calls and network activity\n- **Animation Hitches** - UI performance issues\n\n### 3. Run Performance Analysis\n\n**Standard workflow:**\n\n```bash\nDEVICE_UUID=\"F464E766-555C-4B95-B8CC-763702A70791\" # this is sample uuid, run command line to get exist uuid\nxcrun simctl uninstall $DEVICE_UUID <bundle id>\nxcrun simctl install $DEVICE_UUID /path/to/<app name>.app\nsleep 2\nxcrun xctrace record --template \"App Launch\" --device $DEVICE_UUID \\\n  --launch -- /path/to/<app name>.app 2>&1\n```\n\n**Important notes:**\n\n- Trace files auto-generate names like `Launch_<app name>.app_2025-10-30_3.55.40 PM_39E6A410.trace`\n- `--output` parameter may be ignored; accept auto-generated names\n- Wait 2 seconds after installation before profiling\n- Use `2>&1` to capture all output\n- Recording duration: 10-30s for launch, 2-5m for other analyses\n\n### 4. Analyze Results\n\n**Finding trace files:**\n\n```bash\nls -lt *.trace | head -1  # Most recent trace\nfind . -name \"*.trace\" -type d -mmin -5  # Files from last 5 minutes\n```\n\n**Analysis approaches:**\n\n- **CLI export often fails** - \"trace is malformed\" errors are common\n- **Recommended**: Open in Instruments.app GUI for reliable analysis\n\n  ```bash\n  open -a Instruments.app Launch_<app name>*.trace\n  ```\n\n- Parse signpost markers for performance metrics\n- Identify bottlenecks in launch sequence, memory allocations, CPU hotspots\n\n### 5. Common Optimization Patterns\n\nBased on successful optimizations:\n\n- **Lazy initialization** - Defer expensive dependency resolution\n- **Background operations** - Move non-critical setup off main thread\n- **Deferred bindings** - Set up subscriptions after UI appears\n- **Font loading** - Register fonts asynchronously\n- **Method swizzling** - Only essential swizzles during launch\n\n### Critical Pitfalls to Avoid\n\n‚ùå Using device names instead of UUIDs\n‚ùå Skipping clean installation step\n‚ùå Building in Debug mode\n‚ùå Trying to export trace immediately after recording\n‚ùå Assuming --output path will be used\n‚ùå Not waiting between installation and profiling\n\n### Reference Documentation\n\nSee [examples](./examples.md) in this skill directory for:\n\n- Detailed command examples with correct syntax\n- Complete troubleshooting guide with solutions\n- Real-world lessons learned\n- Production-ready workflow scripts"
              },
              {
                "name": "ios-merchant-feature-declaration",
                "description": "Declare new iOS Feature cases by collecting details via interactive form and automatically updating all required files (Feature.swift, FeatureInfo.swift, Localizable.strings, ScreenID, Routes). Use when \"add new feature\", \"declare new feature\", \"create feature case\", \"add feature to menu\", or \"new feature declaration\".",
                "path": "py-plugin/skills/ios-merchant-feature-declaration/SKILL.md",
                "frontmatter": {
                  "name": "ios-merchant-feature-declaration",
                  "description": "Declare new iOS Feature cases by collecting details via interactive form and automatically updating all required files (Feature.swift, FeatureInfo.swift, Localizable.strings, ScreenID, Routes). Use when \"add new feature\", \"declare new feature\", \"create feature case\", \"add feature to menu\", or \"new feature declaration\".",
                  "allowed-tools": "Read, Write, Edit, Glob, Grep, AskUserQuestion"
                },
                "content": "# iOS Merchant Feature Declaration\n\nInteractively declare new Feature cases in the iOS app by collecting all necessary information via a form, then automatically updating all required files across Domain and Presentation layers.\n\n## When to Activate\n\n- \"add new feature\"\n- \"declare new feature\"\n- \"create feature case\"\n- \"add feature to menu\"\n- \"new feature declaration\"\n- \"register new feature\"\n\n## Interactive Process\n\n### Step 1: Collect Feature Details\n\nUse `AskUserQuestion` to collect all necessary information in a single form:\n\n**Required Information:**\n1. Feature name (camelCase, e.g., \"balanceHistory\")\n2. Vietnamese description (e.g., \"L·ªãch s·ª≠ s·ªë d∆∞\")\n3. English description (e.g., \"Balance History\")\n4. Permission code (optional 5-digit number from backend, or empty if no permission)\n5. Category placement (select from available categories)\n6. Has icon? (yes/no)\n\n**Conditional Information:**\n- If has icon: Icon name (kebab-case, e.g., \"balance-history-icon\")\n- Needs deep linking? (yes/no)\n- If needs deep linking: Deep link path (e.g., \"balance/history\")\n\n**Available Categories:**\n- counterService - Counter services (home screen)\n- onlineServices - Online services (home screen)\n- utilityServices - Utility services (home screen)\n- leftAccountCategories - Account section (side menu)\n- leftCounterCategories - Counter section (side menu)\n- leftOnlineCategories - Online section (side menu)\n- leftUtilityCategories - Utility section (side menu)\n- leftInstallmentConversionCategories - Installment section (side menu)\n- none - No category (internal feature)\n\n### Step 2: Validate Inputs\n\nBefore proceeding, validate:\n- Feature name is camelCase (first letter lowercase)\n- Permission code is empty OR 5-digit number\n- Category is valid\n- Icon name (if provided) is kebab-case\n- Deep link path (if provided) follows format: `[category]/[feature]`\n\nIf validation fails, show errors and ask user to correct.\n\n### Step 3: Update Domain Files\n\nUpdate these files automatically using Edit tool:\n\n#### 3.1 Feature.swift (5 locations)\n\n**File:** `Domain/Model/Others/Feature.swift`\n\n**Location 1:** Add feature case (in appropriate section with comment)\n**Location 2:** Add permission code in `code` computed property\n**Location 3:** Add FeatureInfo mapping in `getInfo()` method\n**Location 4:** Add to category array (if category specified)\n**Location 5:** Add identifier in `identifier` computed property\n\nUse templates from `templates.md`.\n\n#### 3.2 FeatureInfo.swift\n\n**File:** `Domain/Model/Others/FeatureInfo.swift`\n\nAdd static property with icon and localized title (only if has icon).\nUse template from `templates.md`.\n\n#### 3.3 Localization Files\n\n**Files:**\n- `PayooMerchant/Resources/Localization/vi.lproj/Localizable.strings`\n- `PayooMerchant/Resources/Localization/en.lproj/Localizable.strings`\n\nAdd localization keys:\n- `menu.label.[feature-name-kebab]` - For menu items\n- `home.label.feature-[feature-name-kebab]` - For home screen\n\nUse append approach to avoid breaking existing content.\n\n### Step 4: Update Deep Linking (if needed)\n\nIf deep linking is enabled:\n\n#### 4.1 ScreenID.swift\n\n**File:** `Domain/Model/Setting/ScreenID.swift`\n\nAdd screen ID case with deep link path.\n\n#### 4.2 Route.swift\n\n**File:** `PayooMerchant/Library/DeepLink/Route.swift`\n\nAdd route case and URL mapping (4 locations: enum case, init URL mapping, Equatable, getPermissionFeature).\n\nUse templates from `templates.md`.\n\n### Step 5: Update Presentation Layer Files (CRITICAL)\n\n**IMPORTANT:** These files have exhaustive switch statements and MUST be updated to avoid compilation errors.\n\n#### 5.1 DeepLinkNavigator.swift\n\n**File:** `PayooMerchant/Library/DeepLink/DeepLinkNavigator.swift`\n\nAdd case to `getViewController(from destination:)` switch statement.\n- Return placeholder (e.g., `makeHomeViewController()`) until actual controller is implemented\n- Add TODO comment for future implementation\n\n#### 5.2 Feature+Ext.swift\n\n**File:** `PayooMerchant/Models/Feature+Ext.swift`\n\nAdd to `navigationBarTitle` computed property:\n- If feature has navigation bar title: add specific case\n- If no navigation bar title: add to nil-returning cases list\n\n#### 5.3 AppDelegateViewModel.swift\n\n**File:** `PayooMerchant/AppDelegateViewModel.swift`\n\nAdd to route filtering switch (around line 171):\n- If feature requires permission check: add specific case with permission check\n- If no permission required: add to the list of cases that return `true`\n\nUse templates from `templates.md`.\n\n### Step 6: Generate Boilerplate Code\n\nGenerate code snippets for manual implementation (don't auto-update these):\n\n1. **ViewControllerFactory method** - Show code snippet\n2. **DependencyContainer registration** - Show code snippet\n3. **Navigator extension** (if deep linking) - Show code snippet\n\nUse templates from `templates.md`.\n\n### Step 7: Validation\n\nBefore presenting results, verify:\n- All files were updated successfully\n- No syntax errors introduced\n- Feature name is unique (not already declared)\n- Permission code is unique (if provided)\n\n### Step 8: Present Results\n\nShow comprehensive summary:\n\n```markdown\n‚úÖ Feature Declared: [FeatureName]\n\nüìã Collected Details:\n  - Name: [featureName]\n  - Vietnamese: [vietnameseDesc]\n  - English: [englishDesc]\n  - Permission Code: [code or \"None\"]\n  - Category: [category]\n  - Icon: [iconName or \"None\"]\n  - Deep Link: [path or \"None\"]\n\nüìÅ Files Updated:\n  ‚úÖ Domain/Model/Others/Feature.swift (5 locations)\n  ‚úÖ Domain/Model/Others/FeatureInfo.swift (if has icon)\n  ‚úÖ PayooMerchant/Resources/Base.lproj/Localizable.strings (Vietnamese)\n  ‚úÖ PayooMerchant/Resources/en.lproj/Localizable.strings (English)\n  ‚úÖ PayooMerchant/Library/DeepLink/DeepLinkNavigator.swift (CRITICAL)\n  ‚úÖ PayooMerchant/Models/Feature+Ext.swift (CRITICAL)\n  ‚úÖ PayooMerchant/AppDelegateViewModel.swift (CRITICAL)\n  [‚úÖ Domain/Model/Setting/ScreenID.swift] (if deep linking)\n  [‚úÖ PayooMerchant/Library/DeepLink/Route.swift - 4 locations] (if deep linking)\n\nüìù Manual Steps Required:\n\n1. Add Icon Assets (if has icon):\n   - Location: PayooMerchant/Resources/Assets.xcassets/\n   - Create: [iconName].imageset/\n   - Add images: 1x, 2x, 3x (24x24, 48x48, 72x72 pt)\n\n2. Add ViewControllerFactory Method:\n   [Show code snippet]\n\n3. Register in DependencyContainer:\n   [Show code snippet]\n\n4. Create ViewController and ViewModel:\n   - [FeatureName]ViewController.swift\n   - [FeatureName]ViewModel.swift\n   - Follow MVVM + RxSwift Input/Output pattern\n\n[5. Add Navigator Extension (if deep linking):\n   [Show code snippet]]\n\n‚úÖ Verification Checklist:\n  - [ ] Build project successfully\n  - [ ] Run SwiftLint (bundle exec fastlane lint)\n  - [ ] Test without permission (should hide feature)\n  - [ ] Test with permission (should show feature)\n  - [ ] Verify Vietnamese and English text\n  - [ ] Test icon displays correctly\n  - [ ] Test deep link (if applicable)\n  - [ ] Test navigation to feature\n\nüîó Next Steps:\n  1. Add icon assets to Assets.xcassets\n  2. Implement ViewController and ViewModel\n  3. Add factory method to ViewControllerFactory\n  4. Register ViewModel in DependencyContainer\n  5. Test thoroughly before committing\n\nüìö Reference: NEW_FEATURE_DECLARATION_PLAN.md\n```\n\n## Validation Rules\n\n### Feature Name\n- Must be camelCase (first letter lowercase)\n- Must start with a letter\n- Can only contain letters and numbers\n- Must be unique (check existing Feature cases)\n\n### Permission Code\n- Empty string (no permission) OR\n- Exactly 5 digits\n- Must be unique if provided\n\n### Category\n- Must be one of the predefined categories\n- Use \"none\" for internal features\n\n### Icon Name\n- Must be kebab-case (lowercase with hyphens)\n- Should end with \"-icon\" suffix\n- Example: \"balance-history-icon\"\n\n### Deep Link Path\n- Format: `[category]/[feature]` or `[category]/[feature]/[subfeature]`\n- Must be kebab-case\n- Example: \"balance/history\"\n\n---\n\nSee `templates.md` for code templates.\nSee `examples.md` for complete example."
              },
              {
                "name": "ios-mr-workflow",
                "description": "Expert iOS GitLab merge request management with two modes - Review mode for code reviews, comments, and approvals; Update mode for creating or updating MR descriptions. Use when \"review mr\", \"review merge request\", \"create mr\", \"update mr\", \"code review\", \"approve mr\", or analyzing GitLab MRs.",
                "path": "py-plugin/skills/ios-mr-workflow/SKILL.md",
                "frontmatter": {
                  "name": "ios-mr-workflow",
                  "description": "Expert iOS GitLab merge request management with two modes - Review mode for code reviews, comments, and approvals; Update mode for creating or updating MR descriptions. Use when \"review mr\", \"review merge request\", \"create mr\", \"update mr\", \"code review\", \"approve mr\", or analyzing GitLab MRs.",
                  "allowed-tools": "Bash, Read, AskUserQuestion"
                },
                "content": "You are an expert iOS development and GitLab assistant managing merge requests in two modes:\n- **Review Mode**: Conduct code reviews, post comments, make approval decisions\n- **Update Mode**: Create or update merge request descriptions\n\n## Step 1: Gather Required Information\n\nPrompt user to provide (with examples):\n- **mode**: \"review\" or \"update\"\n- **project**: GitLab project (e.g., \"rnd/ios/payoo-ios-app-merchant\")\n- **branch**: Source branch name\n- **issue_number**: GitLab issue IID (or \"none\")\n- **target_branch**: Target branch (default: \"develop\")\n\nUse AskUserQuestion to collect inputs if not provided.\n\n## Step 2: Fetch MR and Validate Mode\n\nUse MCP tool `mobile-mcp-server/gitlab-get-merge-request`:\n```\nprojectName: {project}\nbranch: {branch}\n```\n\nStore result as `{mr_iid}` if MR exists.\n\n**Mode Decision Logic:**\n- If MR does NOT exist and mode is \"review\": Force switch to \"update\" mode, inform user\n- If MR exists and mode is \"review\": Continue in Review mode\n- If mode is \"update\": Continue regardless of MR existence\n\n## Step 3: Analyze Code Changes\n\n**Get MR changes:**\nUse `mobile-mcp-server/gitlab-get-merge-request-changes`:\n```\nmrIid: {mr_iid}\nprojectName: {project}\n```\n\n**Git safety and branch switch:**\n```bash\n# Check for uncommitted changes\ngit status --porcelain\n\n# If changes exist, stash them\nif [[ -n $(git status --porcelain) ]]; then\n  git stash\nfi\n\n# Switch to source branch\ngit checkout {branch}\n\n# Restore stashed changes if any\nif git stash list | grep -q stash@{0}; then\n  git stash pop\nfi\n```\n\n**Read and analyze ALL changed files (except localization files):**\n- Use Read tool to examine each complete file\n- Understand context and interactions\n- Identify potential side effects\n- Assess architectural implications\n- Check for breaking changes\n- Review dependencies between files\n\n## Step 4: Execute Mode-Specific Actions\n\n### Review Mode Actions\n\n**4a. Generate Code Review Report** (see `templates.md` for format):\n- Summary: High-level overview\n- Critical Issues: Must fix before merge\n- Major Issues: Should be addressed\n- Minor Issues: Nice-to-have improvements\n- Positive Observations: What was done well\n- Recommendations: Best practices\n- Security Review: Security considerations\n- Testing Assessment: Test coverage evaluation\n- Performance Analysis: Performance impacts\n\nFollow guidelines in `.github/instructions/ios-merchant-code-review.instructions.md`.\n\n**4b. Post Review Comments:**\nUse `mobile-mcp-server/gitlab-review-merge-request-code` for critical, major, and minor issues only.\n\n**4c. Make Approval Decision:**\n- If all critical/major issues resolved:\n  - Use `mobile-mcp-server/gitlab-approve-merge-request`:\n    ```\n    project: {project}\n    mrIid: {mr_iid}\n    ```\n  - Output: Approval confirmation\n- If issues remain:\n  - Post detailed feedback\n  - Withhold approval\n\n**4d. Provide Review Summary** (see `templates.md` for format).\n\n### Update Mode Actions\n\n**4a. Generate MR Description** (see `templates.md` for format):\n- What: Purpose and changes\n- How: Technical implementation details\n- How to Use: Code examples (for new features only)\n- Auto-include: `/assign me` and labels\n\n**4b. Create or Update MR:**\n- If MR does NOT exist:\n  - Use `mobile-mcp-server/gitlab-create-merge-request`:\n    ```\n    projectName: {project}\n    sourceBranch: {branch}\n    targetBranch: {target_branch}\n    title: {extracted_from_branch_or_generated}\n    description: {generated_description}\n    ```\n- If MR exists:\n  - Use `mobile-mcp-server/gitlab-update-merge-request-description`:\n    ```\n    project: {project}\n    mrIid: {mr_iid}\n    newDescription: {generated_description}\n    ```\n\n**4c. Provide Update Summary:**\n- MR creation/update status\n- MR URL and IID\n- Generated description summary\n- Next steps\n\n## Step 5: Workflow Completion\n\nConfirm all mode-specific steps completed and provide final summary:\n\n**Review Mode Summary:**\n```\n‚úÖ Code Review Complete\nMR: #{mr_iid}\nCritical Issues: {count}\nMajor Issues: {count}\nMinor Issues: {count}\nStatus: [Approved ‚úÖ / Changes Requested ‚ö†Ô∏è]\n```\n\n**Update Mode Summary:**\n```\n‚úÖ MR [Created/Updated]\nMR: #{mr_iid}\nURL: {mr_url}\nTitle: {title}\nStatus: Ready for review\n```\n\n## Error Handling\n\n- **MR not found**: Check branch name and project\n- **Permission denied**: Verify GitLab access tokens\n- **Git checkout fails**: Check for conflicts or missing branch\n- **API timeout**: Retry once, then abort with error\n\nAlways provide clear next steps and recovery suggestions.\n\n## Important Notes\n\n- MUST read entire changed files, not just diffs\n- Ignore localization files in review\n- Follow iOS merchant code review guidelines\n- Post only actionable comments (critical, major, minor issues)\n- Auto-switch to update mode if MR doesn't exist in review mode"
              },
              {
                "name": "ios-naming-conventions",
                "description": "Check Swift naming conventions for iOS code. Validates class names, variables, functions, and IBOutlets against project standards. Use when reviewing code readability, checking abbreviations, or enforcing naming consistency in Swift files.",
                "path": "py-plugin/skills/ios-naming-conventions/SKILL.md",
                "frontmatter": {
                  "name": "ios-naming-conventions",
                  "description": "Check Swift naming conventions for iOS code. Validates class names, variables, functions, and IBOutlets against project standards. Use when reviewing code readability, checking abbreviations, or enforcing naming consistency in Swift files.",
                  "allowed-tools": "Read, Grep, Glob"
                },
                "content": "# iOS Naming Conventions Checker\n\nValidate Swift code naming against Payoo Merchant project standards for clarity and consistency.\n\n## When to Activate\n\n- \"check naming\", \"naming conventions\", \"code readability\"\n- \"abbreviations\", \"variable names\", \"rename\"\n- Reviewing code quality or consistency\n- Onboarding new developers\n\n## Naming Rules Summary\n\n### Types (Classes, Structs, Enums, Protocols)\n- **PascalCase**: `PaymentViewModel`, `TransactionRepository`\n- **Descriptive**: Purpose immediately clear\n- **Proper suffixes**: ViewModel, ViewController, UseCase, Repository\n\n### Variables & Properties\n- **camelCase**: `paymentAmount`, `isProcessing`\n- **Meaningful**: No abbreviations (except URL, ID, VC, UC)\n- **Booleans**: Prefix `is`, `has`, `should`, `can`\n- **Collections**: Plural names (`transactions`, `stores`)\n\n### Functions & Methods\n- **camelCase** with verb prefix\n- **Actions**: `loadTransactions()`, `processPayment()`\n- **Queries**: `getTransaction()`, `hasPermission()`\n\n### IBOutlets\n- **Type suffix**: `amountTextField`, `confirmButton`, `tableView`\n\n## Review Process\n\n### Step 1: Scan Code\n\nRead files and identify all declarations:\n- Class/struct/enum/protocol declarations\n- Variable and property declarations\n- Function declarations\n- IBOutlet declarations\n\n### Step 2: Check Against Rules\n\nFor each identifier, verify:\n\n**Classes/Types**:\n- ‚úÖ PascalCase\n- ‚úÖ Descriptive (not generic like \"Manager\")\n- ‚úÖ No abbreviations (except standard ones)\n- ‚úÖ Proper suffix (ViewModel, UseCase, etc.)\n\n**Variables**:\n- ‚úÖ camelCase\n- ‚úÖ Meaningful names\n- ‚úÖ Boolean prefixes (is/has/should/can)\n- ‚úÖ Plural for collections\n- ‚úÖ No single letters (except loop indices)\n\n**Functions**:\n- ‚úÖ Verb-based names\n- ‚úÖ Clear action or query intent\n- ‚úÖ No generic names (doSomething, handle)\n\n**IBOutlets**:\n- ‚úÖ Type suffix included\n\n### Step 3: Generate Report\n\n```markdown\n# Naming Conventions Review\n\n## Summary\n- üî¥ Critical (meaningless): X\n- üü† High (abbreviations): X\n- üü° Medium (missing prefixes): X\n- üü¢ Low (style): X\n\n## Issues by Type\n\n### Classes/Structs/Enums\n**File**: `path/to/file.swift:line`\nCurrent: `PayVC`\nShould be: `PaymentViewController`\nReason: [Explanation]\n\n### Variables/Properties\n[List with specific fixes]\n\n### Functions\n[List with specific fixes]\n\n### IBOutlets\n[List with specific fixes]\n\n## Batch Rename Suggestions\nFound `amt` in 5 locations ‚Üí Rename all to `paymentAmount`\n\n## Good Examples Found ‚úÖ\n[Acknowledge well-named elements]\n```\n\n## Common Violations\n\n### ‚ùå Abbreviations\n```swift\nclass PayVC { }        ‚Üí PaymentViewController\nlet amt: Double        ‚Üí paymentAmount\nfunc procPmt() { }     ‚Üí processPayment()\n```\n\n### ‚ùå Single Letters\n```swift\nlet x = transaction    ‚Üí currentTransaction\nlet a = amount         ‚Üí paymentAmount\n```\n\n### ‚ùå Generic/Meaningless\n```swift\nclass Manager { }      ‚Üí PaymentManager\nfunc doSomething() { } ‚Üí processRefundRequest()\nfunc handle() { }      ‚Üí handlePaymentError()\n```\n\n### ‚ùå Missing Prefixes\n```swift\nlet loading: Bool      ‚Üí isLoading: Bool\nlet valid: Bool        ‚Üí isValid: Bool\n```\n\n### ‚ùå Missing Type Suffix\n```swift\n@IBOutlet weak var amount: UITextField!  ‚Üí amountTextField\n@IBOutlet weak var btn: UIButton!       ‚Üí confirmButton\n```\n\n## Search Patterns\n\nUse Grep to find:\n- **Abbreviations**: `(let|var)\\s+[a-z]{1,3}\\s*[=:]`\n- **IBOutlets**: `@IBOutlet.*weak var`\n- **Booleans**: `(let|var)\\s+[a-z]+.*:\\s*Bool`\n\n## Output Guidelines\n\n**For each violation**:\n1. File path and line number\n2. Current name\n3. Recommended name\n4. Reason for change\n5. Impact on code clarity\n\n**Prioritize**:\n- Critical: Meaningless names (hurts maintainability)\n- High: Abbreviations (reduces clarity)\n- Medium: Missing prefixes/suffixes\n- Low: Style inconsistencies\n\n## Quick Fixes\n\n1. **Expand Abbreviation**: Use Xcode refactor tool\n2. **Add Boolean Prefix**: Rename with is/has/should/can\n3. **Add Type Suffix**: Update IBOutlet names\n\n## Common Abbreviations to Fix\n\n| ‚ùå Bad | ‚úÖ Good |\n|--------|---------|\n| amt | paymentAmount |\n| trx, tx | transaction |\n| btn | button |\n| lbl | label |\n| vc | viewController |\n| uc | useCase |\n| repo | repository |\n\n## Reference\n\n**Detailed Examples**: See `examples.md` for extensive naming patterns and scenarios."
              },
              {
                "name": "ios-reactive-list-generator",
                "description": "Generate reactive iOS list screens with RxSwift MVVM Input/Output pattern. Creates complete list features with reactive bindings, pagination (date range/page number), ViewModel, ViewController, Navigator, and tests for iOS reactive projects. Use when \"create reactive list\", \"generate reactive list\", \"new reactive list screen\", \"create rxswift list\", or \"generate list with rxswift\".",
                "path": "py-plugin/skills/ios-reactive-list-generator/SKILL.md",
                "frontmatter": {
                  "name": "ios-reactive-list-generator",
                  "description": "Generate reactive iOS list screens with RxSwift MVVM Input/Output pattern. Creates complete list features with reactive bindings, pagination (date range/page number), ViewModel, ViewController, Navigator, and tests for iOS reactive projects. Use when \"create reactive list\", \"generate reactive list\", \"new reactive list screen\", \"create rxswift list\", or \"generate list with rxswift\".",
                  "allowed-tools": "Read, Write, Edit, Glob, Grep, AskUserQuestion"
                },
                "content": "# iOS Reactive List Generator\n\nGenerates complete reactive iOS list screens using RxSwift MVVM Input/Output pattern with reactive pagination, pull-to-refresh, and infinite scroll for iOS reactive projects.\n\n## When to Activate\n\n- \"create reactive list\"\n- \"generate reactive list\"\n- \"new reactive list screen\"\n- \"create rxswift list\"\n- \"generate list with rxswift\"\n- \"new reactive table view\"\n- \"create ios reactive list\"\n- \"generate reactive list with pagination\"\n- \"new list with reactive bindings\"\n\n## Generation Process\n\n### Step 1: Collect Feature Requirements\n\nUse `AskUserQuestion` to collect configuration (present all questions at once):\n\n**Required Information:**\n1. Feature name (CamelCase, e.g., \"TransactionHistory\")\n2. Feature path (e.g., \"PayooMerchant/Controllers/Transaction/History\")\n3. Feature display title (for navigation bar)\n4. Pagination type: \"date_range\", \"page_number\", or \"none\"\n5. Primary UseCase name (e.g., \"TransactionHistoryUseCaseType\")\n6. Primary UseCase main method (e.g., \"getTransactions(fromDate:toDate:)\")\n7. Domain model item type (e.g., \"TransactionItem\")\n8. Main content cell class (e.g., \"TransactionCell\")\n\n**Optional Information:**\n- Additional UseCases (comma-separated)\n- Custom Input triggers beyond standard (load, loadMore, refresh, selectItem)\n- Custom Output drivers beyond standard (items, isLoading, shouldLoadMore, error)\n- Header cells (comma-separated class names)\n- Additional navigation destinations\n\n### Step 2: Read Reference Implementations\n\nRead these files to extract patterns:\n\n```bash\n# Core reference implementations\nPayooMerchant/Controllers/Balance/Information/BalanceInformationViewModel.swift\nPayooMerchant/Controllers/Balance/Information/BalanceInformationController.swift\nPayooMerchant/Controllers/History/BaseListTransaction/BaseListPaginateDateRangeViewModel.swift\n\n# Form template\n/Users/homac34/payoo-ios-app-merchant/PRESENTATION_LAYER_FORM.md\n```\n\n### Step 3: Generate Files\n\nGenerate these files in the specified `feature_path`:\n\n#### 1. ViewModel (`[Feature]ViewModel.swift`)\n\nFrom `templates.md` ‚Üí Template 1: ViewModel\n\n**Key components:**\n- Import Domain module\n- Struct `[Feature]Filter: FilterPaginationDateRangeProvider`\n- Class extending `BaseListPaginationDateRangeViewModel<DomainItem, Filter, Any>`\n- Input struct with all triggers\n- Output struct with all drivers\n- `transform()` method\n- Override `fetchItems(_ toDate: Date)` for pagination\n\n**Critical patterns:**\n- Use `[weak self]` in all closures\n- All subscriptions use `.disposed(by: disposeBag)`\n- API calls use `.catchSessionError(sessionUC)` (inherited from base)\n- Use `Driver` for all outputs (UI-safe)\n- Use `Observable` for all inputs\n\n#### 2. ViewController (`[Feature]Controller.swift`)\n\nFrom `templates.md` ‚Üí Template 2: ViewController\n\n**Key components:**\n- Extend `BaseViewController`\n- IBOutlet for tableView\n- PublishSubject triggers matching Input\n- `viewDidLoad()` setup\n- `setupUI()` - register cells, configure table\n- `bindViewModel()` - create Input, transform, bind Output\n\n**Critical patterns:**\n- Pull-to-refresh setup\n- Infinite scroll detection (last 3 items)\n- Cell registration with `registerCellByNib`\n- Error handling with `showError()`\n- Navigation via `navigator.navigate(to:)`\n\n#### 3. Navigator Extension (`Navigator+[Feature].swift`)\n\nFrom `templates.md` ‚Üí Template 3: Navigator\n\n**Key components:**\n- Protocol `[Feature]NavigatorType`\n- Enum `[Feature]Destination` with all navigation cases\n- Extension `Navigator: [Feature]NavigatorType`\n- Implementation using `viewControllerFactory`\n\n#### 4. Unit Tests (`[Feature]ViewModelTests.swift`)\n\nFrom `templates.md` ‚Üí Template 4: Unit Tests\n\n**Key components:**\n- RxTest with TestScheduler\n- Mock UseCases and Navigator\n- Test cases for load, loadMore, refresh, selection\n- Memory leak test (weak self verification)\n\n### Step 4: Generate DI Registration Instructions\n\nCreate markdown instructions for manual updates:\n\n**File: `DependencyContainer.swift`**\n```swift\n// Register ViewModel\ncontainer.register([Feature]ViewModel.self) { resolver in\n    [Feature]ViewModel(\n        [feature]UC: resolver.resolve([PrimaryUseCase].self)!,\n        navigator: resolver.resolve([Feature]NavigatorType.self)!\n    )\n}\n```\n\n**File: `ViewControllerFactory` extension**\n```swift\nextension ViewControllerFactory {\n    func make[Feature]Controller() -> [Feature]Controller {\n        let controller = [Feature]Controller.instantiate()\n        controller.viewModel = DependencyContainer.shared.provide([Feature]ViewModel.self)\n        return controller\n    }\n}\n```\n\n### Step 5: Validation Checklist\n\nBefore presenting results, verify:\n\n- ‚úì All generated files use correct feature name\n- ‚úì Import statements include `Domain`, `RxSwift`, `RxCocoa`\n- ‚úì ViewModel extends correct base class for pagination type\n- ‚úì All closures use `[weak self]`\n- ‚úì All subscriptions disposed with `disposeBag`\n- ‚úì Cell classes match existing cells (verify with Glob)\n- ‚úì Navigator protocol and enum follow naming conventions\n- ‚úì File paths are absolute and correct\n\n## Output Format\n\nPresent results as:\n\n```markdown\n‚úÖ iOS Feature Generated: [FeatureName]\n\nüìÅ Files Created:\n  - [feature_path]/[Feature]ViewModel.swift\n  - [feature_path]/[Feature]Controller.swift\n  - [feature_path]/Navigator+[Feature].swift\n  - PayooMerchantTests/ViewModel/[Feature]ViewModelTests.swift\n\nüìã Manual Steps Required:\n\n1. **Register in DependencyContainer.swift**\n   [Show code snippet]\n\n2. **Add factory method to ViewControllerFactory**\n   [Show code snippet]\n\n3. **Update parent Navigator** (if adding to existing flow)\n   [Show navigation destination enum case]\n\n4. **Create XIB file** (optional)\n   - File ‚Üí New ‚Üí View\n   - Name: [Feature]Controller.xib\n   - Set File's Owner to [Feature]Controller\n   - Connect tableView outlet\n\nüß™ Test the Feature:\n\n1. Build project:\n   ```bash\n   xcodebuild -workspace PayooMerchant.xcworkspace \\\n     -scheme \"Payoo Merchant Sandbox\" \\\n     -configuration \"Debug Sandbox\" \\\n     -sdk iphonesimulator \\\n     -destination 'platform=iOS Simulator,OS=17.5,name=iPhone 15,arch=x86_64' \\\n     clean build\n   ```\n\n2. Run tests:\n   ```bash\n   xcodebuild test \\\n     -workspace PayooMerchant.xcworkspace \\\n     -scheme \"PayooMerchantTests\" \\\n     -configuration \"Debug Sandbox\" \\\n     -destination 'platform=iOS Simulator,OS=17.5,name=iPhone 15,arch=x86_64' \\\n     -enableCodeCoverage YES\n   ```\n\n3. Navigate to feature: `navigator.navigate(to: .[featureName]())`\n\n‚è±Ô∏è  Estimated completion time: 15-30 minutes (manual steps)\n```\n\n## Key Patterns Reference\n\n### Date Range Pagination\n- Filter conforms to `FilterPaginationDateRangeProvider`\n- Domain item conforms to `PaginationDateRangeProvider`\n- Uses item's `createdDate` as cursor for next page\n- `toDate` becomes last item's date on load more\n\n### RxSwift Memory Safety\n- Always `[weak self]` in closures\n- Always `.disposed(by: disposeBag)`\n- Use `Driver` (never fails, main thread) for UI\n- Use `Observable` for inputs\n\n### Navigation Pattern\n- Protocol defines interface\n- Enum defines destinations with associated values\n- Navigator extension implements using factory\n\n---\n\nSee `templates.md` for complete code templates.\nSee `examples.md` for full generated feature example."
              },
              {
                "name": "ios-sdk-code-review",
                "description": "Comprehensive iOS SDK code review for Payoo iOS Frameworks. Checks Clean Architecture patterns, MVVM implementation, UseCase patterns, memory management, naming conventions, API design, and Swift best practices. Use when \"review code\", \"check code\", \"code review\", \"review PR\", or analyzing Swift files in this project.",
                "path": "py-plugin/skills/ios-sdk-code-review/SKILL.md",
                "frontmatter": {
                  "name": "ios-sdk-code-review",
                  "description": "Comprehensive iOS SDK code review for Payoo iOS Frameworks. Checks Clean Architecture patterns, MVVM implementation, UseCase patterns, memory management, naming conventions, API design, and Swift best practices. Use when \"review code\", \"check code\", \"code review\", \"review PR\", or analyzing Swift files in this project.",
                  "allowed-tools": "Read, Grep, Glob"
                },
                "content": "# iOS SDK Code Review\n\nPerform comprehensive code reviews for Payoo iOS Frameworks following Clean Architecture, MVVM, and iOS SDK best practices.\n\n## When to Activate\n\n- \"review code\", \"code review\", \"check this code\"\n- \"review PR\", \"review pull request\", \"review MR\"\n- \"check iOS code\", \"review Swift code\"\n- User asks about code quality or best practices\n- Reviewing ViewModels, ViewControllers, UseCases, or DataSources\n\n## Review Process\n\n### 1. Identify Code Context\n\nDetermine what's being reviewed:\n- **File type**: ViewModel, ViewController, UseCase, DataSource, Model, Service\n- **Framework**: PayooCore, PayooEwallet, PayooPayment, etc.\n- **Layer**: Presentation (Scenes), Domain (UseCase), Data (DataSources/Services)\n\n### 2. Architecture Review\n\n**Clean Architecture Compliance:**\n- ‚úì Proper layer separation (Presentation/Domain/Data)\n- ‚úì Dependencies point inward (Presentation ‚Üí Domain ‚Üí Data)\n- ‚úì ViewModels don't directly access Services (must use UseCases)\n- ‚úì Models in correct layer (Domain models vs Data models)\n\n**MVVM Pattern:**\n- ‚úì ViewModel has protocol definition (`{Feature}ViewModelType`)\n- ‚úì Delegate protocol exists (`{Feature}ViewModelDelegate`)\n- ‚úì ViewController implements delegate\n- ‚úì ViewModel is testable (no UIKit dependencies)\n- ‚úì View state managed through delegate callbacks\n\n**UseCase Pattern:**\n- ‚úì Business logic in UseCases, not ViewModels\n- ‚úì Single responsibility per UseCase\n- ‚úì UseCases injected into ViewModels\n- ‚úì UseCases coordinate repositories/services\n\n### 3. Memory Management Review\n\n**Retain Cycles:**\n- ‚úì Delegates marked `weak`\n- ‚úì Closures use `[weak self]` or `[unowned self]` appropriately\n- ‚úì No strong reference cycles in ViewModels\n- ‚úì Timer/observer cleanup in `deinit`\n\n**Example issues:**\n```swift\n// ‚ùå BAD: Strong delegate reference\nvar delegate: SomeDelegate?\n\n// ‚úÖ GOOD: Weak delegate reference\nweak var delegate: SomeDelegate?\n\n// ‚ùå BAD: Strong self in closure\nviewModel.loadData { data in\n    self.updateUI(data)\n}\n\n// ‚úÖ GOOD: Weak self in closure\nviewModel.loadData { [weak self] data in\n    self?.updateUI(data)\n}\n```\n\n### 4. Dependency Injection Review\n\n**Constructor Injection:**\n- ‚úì Dependencies injected via `init`\n- ‚úì All required dependencies in initializer\n- ‚úì No service locator or singletons (except context)\n- ‚úì Dependencies are protocols, not concrete types\n\n**Example:**\n```swift\n// ‚úÖ GOOD: Constructor injection\nfinal class DepositViewModel {\n    private let depositAmountUC: DepositAmountUseCase\n    private let bankAccountUC: BankAccountUseCase\n\n    init(depositAmountUC: DepositAmountUseCase,\n         bankAccountUC: BankAccountUseCase) {\n        self.depositAmountUC = depositAmountUC\n        self.bankAccountUC = bankAccountUC\n    }\n}\n\n// ‚ùå BAD: Service locator pattern\nlet service = ServiceLocator.shared.depositService\n```\n\n### 5. Naming Conventions Review\n\n**File Names:**\n- ‚úì ViewModels: `{Feature}ViewModel.swift`\n- ‚úì ViewControllers: `{Feature}ViewController.swift`\n- ‚úì UseCases: `{Feature}UseCase.swift`\n- ‚úì DataSources: `{Feature}DataSource.swift`\n- ‚úì Cells: `{Name}Cell.swift`\n\n**Class/Protocol Names:**\n- ‚úì Protocols end with `Type` for interfaces: `DepositViewModelType`\n- ‚úì Delegate protocols end with `Delegate`: `DepositViewModelDelegate`\n- ‚úì Clear, descriptive names (no abbreviations)\n- ‚úì Consistent with project conventions\n\n**Variables:**\n- ‚úì `context` for PayooEwalletContext\n- ‚úì `{name}UC` for UseCase instances: `depositAmountUC`\n- ‚úì Descriptive names, avoid single letters (except in loops)\n\n### 6. API Design Review\n\n**For SDK Public APIs:**\n- ‚úì Clear, self-documenting method names\n- ‚úì Delegate patterns for callbacks\n- ‚úì Error handling with proper Error types\n- ‚úì Thread-safe if needed\n- ‚úì No force unwrapping in public APIs\n- ‚úì Proper access control (`public`, `internal`, `private`)\n\n**Error Handling:**\n```swift\n// ‚úÖ GOOD: Proper error handling\nenum DepositError: Error, LocalizedError {\n    case outOfRange(bank: String, min: Double, max: Double)\n\n    var errorDescription: String? {\n        switch self {\n        case .outOfRange(let bank, let min, let max):\n            return \"Amount out of range for \\(bank): \\(min)-\\(max)\"\n        }\n    }\n}\n\n// ‚ùå BAD: Generic errors\nthrow NSError(domain: \"Error\", code: -1, userInfo: nil)\n```\n\n### 7. Swift Best Practices\n\n**Code Quality:**\n- ‚úì No force unwrapping (`!`) unless absolutely safe\n- ‚úì Use `guard let` for early returns\n- ‚úì Prefer `let` over `var`\n- ‚úì Access control appropriately set\n- ‚úì No commented-out code\n- ‚úì Proper use of `final` for classes not meant to be subclassed\n\n**SwiftLint Compliance:**\n- ‚úì Line length ‚â§ 120 characters\n- ‚úì File length ‚â§ 500 lines (warning), ‚â§ 1200 (error)\n- ‚úì Type body length ‚â§ 300 lines (warning), ‚â§ 400 (error)\n- ‚úì No trailing whitespace\n\n### 8. Multi-Target Configuration\n\n**Internal/External Builds:**\n- ‚úì Internal-only code wrapped in `#if INTERNAL`\n- ‚úì No internal features leaking to external builds\n- ‚úì Proper preprocessor flag usage\n\n```swift\n#if INTERNAL\n    // Internal-only features\n    func debugFunction() { }\n#endif\n```\n\n### 9. Localization Review\n\n- ‚úì All user-facing strings use `L10n.*` (SwiftGen)\n- ‚úì No hardcoded strings for UI text\n- ‚úì Proper format strings for dynamic content\n\n```swift\n// ‚úÖ GOOD: Localized strings\nlet title = L10n.Deposit.Navigation.deposit\nlet message = L10n.Message.Deposit.outOfRange(min, max, bank)\n\n// ‚ùå BAD: Hardcoded strings\nlet title = \"Deposit\"\n```\n\n## Output Format\n\nProvide review as structured report:\n\n```markdown\n## Code Review: {FileName}\n\n### ‚úÖ Strengths\n- [List what's done well]\n\n### ‚ö†Ô∏è Issues Found\n\n#### üî¥ Critical Issues\n**Issue:** [Description]\n**Location:** {File}:{Line}\n**Impact:** [Why this matters]\n**Fix:**\n\\```swift\n// Current code\n[problematic code]\n\n// Suggested fix\n[fixed code]\n\\```\n\n#### üü° Warnings\n**Issue:** [Description]\n**Location:** {File}:{Line}\n**Suggestion:** [How to improve]\n\n#### üîµ Suggestions\n**Enhancement:** [Description]\n**Benefit:** [Why this would help]\n\n### üìä Summary\n- Critical Issues: X\n- Warnings: Y\n- Suggestions: Z\n- Overall: [Pass/Needs Work/Fail]\n\n### üéØ Priority Actions\n1. [Most important fix]\n2. [Second priority]\n3. [Third priority]\n```\n\n## Review Checklists by File Type\n\n### ViewModel Review\n- [ ] Has protocol definition (`{Name}ViewModelType`)\n- [ ] Has delegate protocol (`{Name}ViewModelDelegate`)\n- [ ] Delegate marked `weak`\n- [ ] Dependencies injected via `init`\n- [ ] No UIKit imports\n- [ ] Uses UseCases for business logic\n- [ ] Closures use `[weak self]`\n- [ ] Testable (no side effects in init)\n\n### ViewController Review\n- [ ] Inherits from appropriate base class\n- [ ] Implements ViewModel delegate\n- [ ] Sets up analytics (`analyticsFeature`, `analyticsScreenName`)\n- [ ] Proper lifecycle management\n- [ ] IBOutlets are `weak`\n- [ ] Navigation setup in `viewDidLoad` or dedicated method\n- [ ] No business logic (delegated to ViewModel)\n\n### UseCase Review\n- [ ] Single responsibility\n- [ ] Injected dependencies\n- [ ] No UIKit dependencies\n- [ ] Proper error handling with typed errors\n- [ ] Testable\n\n### DataSource Review\n- [ ] Conforms to UITableView/UICollectionView protocols\n- [ ] Clean separation from ViewController\n- [ ] Reusable cell registration\n- [ ] Proper indexPath handling\n\n## Key Principles\n\n1. **Clean Architecture First**: Verify proper layer separation\n2. **Memory Safety**: Check for retain cycles, weak references\n3. **Dependency Injection**: Ensure dependencies are injected, not created\n4. **Naming Consistency**: Follow project naming conventions\n5. **SDK Quality**: Public APIs are well-designed and documented\n6. **Testability**: Code is structured for unit testing\n7. **Swift Idioms**: Use modern Swift patterns\n\n## Quick Commands\n\nIf you need to review specific patterns across the codebase:\n\n```bash\n# Find all ViewModels\ngrep -r \"class.*ViewModel\" --include=\"*.swift\" PayooEwallet/\n\n# Find potential retain cycles (strong self in closures)\ngrep -r \"{ self\\.\" --include=\"*.swift\" PayooEwallet/\n\n# Find force unwraps\ngrep -r \"!\" --include=\"*.swift\" PayooEwallet/ | grep -v \"!=\"\n\n# Find hardcoded strings\ngrep -r \"\\\"[A-Z]\" --include=\"*.swift\" PayooEwallet/ | grep -v \"L10n\"\n```"
              },
              {
                "name": "mcp-server-installer",
                "description": "Add MCP servers to Claude Code configuration at user level (~/.claude). Supports stdio, HTTP, and SSE transports with environment variable prompting. Use when \"add mcp server\", \"install mcp\", \"configure mcp server\", \"new mcp\", or \"setup mcp server\".",
                "path": "py-plugin/skills/mcp-server-installer/SKILL.md",
                "frontmatter": {
                  "name": "mcp-server-installer",
                  "description": "Add MCP servers to Claude Code configuration at user level (~/.claude). Supports stdio, HTTP, and SSE transports with environment variable prompting. Use when \"add mcp server\", \"install mcp\", \"configure mcp server\", \"new mcp\", or \"setup mcp server\".",
                  "allowed-tools": "Read, Write, Bash, AskUserQuestion"
                },
                "content": "# MCP Server Installer\n\nAutonomously add MCP (Model Context Protocol) servers to Claude Code configuration at the user level (`~/.claude/mcp.json`).\n\n## When to Activate\n\n- \"add mcp server\"\n- \"install mcp\", \"configure mcp\"\n- \"new mcp server\", \"setup mcp\"\n- \"add [server-name] mcp\"\n- User provides MCP server configuration JSON\n\n## Process\n\n### Step 1: Gather Server Information\n\nAsk user for:\n\n1. **Server name** (e.g., \"mobile-mcp-server\")\n   - Must be lowercase with hyphens\n   - Will be used as the key in mcpServers object\n\n2. **Transport type**:\n   - `stdio` - Local command execution (most common)\n   - `http` - Remote HTTP server\n   - `sse` - Server-Sent Events (deprecated but supported)\n\n3. **Based on transport type:**\n\n   **For stdio:**\n   - Command (e.g., \"npx\", \"node\", \"/usr/local/bin/server\")\n   - Arguments array (e.g., `[\"@daipham/mobile-mcp-server@latest\"]`)\n   - Environment variables (if needed)\n\n   **For http:**\n   - URL (e.g., \"https://api.example.com/mcp\")\n   - Headers (optional, e.g., `{\"Authorization\": \"Bearer ${API_KEY}\"}`)\n\n   **For sse:**\n   - URL (e.g., \"https://api.example.com/sse\")\n   - Headers (optional)\n\n### Step 2: Collect Environment Variables\n\n**Always ask user**: \"Does this MCP server require any environment variables?\"\n\nIf yes, for each variable:\n- Variable name (e.g., \"API_KEY\", \"DATABASE_URL\")\n- Description/purpose\n- Whether it's required or optional\n- Default value (if optional)\n\n**Document in output**: List all required environment variables with instructions on where to set them.\n\n### Step 3: Read Existing Configuration\n\nCheck for existing `.mcp.json` at user level:\n\n```bash\ncat ~/.claude/mcp.json\n```\n\nIf file doesn't exist, create new structure. If exists, parse and merge.\n\n### Step 4: Generate Configuration\n\nUse templates from `templates.md` to generate the server configuration based on transport type.\n\nApply environment variable syntax:\n- `${VAR}` - Required variable (will error if not set)\n- `${VAR:-default}` - Optional variable with default value\n\n### Step 5: Update Configuration File\n\n**Merge strategy:**\n- Preserve existing servers\n- Add new server to `mcpServers` object\n- Maintain JSON formatting (2-space indent)\n- Validate JSON before writing\n\nWrite to `~/.claude/mcp.json`.\n\n### Step 6: Create Environment File Reference\n\nIf environment variables are needed, inform user:\n\n```\n‚ö†Ô∏è Environment Variables Required:\n\nSet these in your shell profile (~/.zshrc or ~/.bashrc):\n\nexport VAR_NAME=\"value\"\nexport ANOTHER_VAR=\"value\"\n\nOr create a project-specific .env file and reference it:\n\"envFile\": \"${workspaceFolder}/.env\"\n```\n\n### Step 7: Validate and Test\n\nRun validation:\n\n```bash\nclaude mcp list\n```\n\nShow the newly added server in the output.\n\n## Output Format\n\n```markdown\n‚úÖ MCP Server Added: [server-name]\n\nüìÅ Configuration: ~/.claude/mcp.json\n\nüîß Transport: [stdio/http/sse]\nüì¶ Command: [command with args] (if stdio)\nüåê URL: [url] (if http/sse)\n\nüìã Configuration Added:\n```json\n{\n  \"server-name\": {\n    // configuration here\n  }\n}\n```\n\n‚ö†Ô∏è Environment Variables Required:\n- VAR_NAME: [description]\n- ANOTHER_VAR: [description]\n\nüí° Set environment variables:\n1. Add to ~/.zshrc or ~/.bashrc:\n   export VAR_NAME=\"your-value\"\n\n2. Or use project .env file:\n   \"envFile\": \"${workspaceFolder}/.env\"\n\n‚úÖ Restart Claude Code to activate the new MCP server.\n\nüß™ Test with: claude mcp list\n```\n\n## Error Handling\n\n- **Invalid JSON**: Show parsing error, ask user to verify configuration\n- **Duplicate server name**: Ask if user wants to overwrite existing server\n- **Missing required fields**: Prompt for missing information\n- **File permission errors**: Suggest checking ~/.claude directory permissions\n\n## Important Notes\n\n1. **User-level scope**: Servers added at `~/.claude/mcp.json` are available across all projects\n2. **Environment variables**: Always prompt for environment variables - many MCP servers require API keys or configuration\n3. **Restart required**: Claude Code must be restarted after adding MCP servers\n4. **Validation**: Use `claude mcp list` to verify the server was added successfully\n5. **Security**: Never log or display actual environment variable values\n\n## Reference\n\nSee `templates.md` for configuration templates for each transport type."
              },
              {
                "name": "mcp-tool-generator",
                "description": "Generate new MCP tools for GitLab operations following the project's standardized pattern. Creates complete TypeScript files with imports, registration functions, Zod schemas, error handling, and format options. Supports simple CRUD operations, complex multi-action tools, and advanced patterns like discussion management. Use when \"create mcp tool\", \"generate gitlab tool\", \"new tool for\", \"add tool to gitlab\", or building new GitLab integration features.",
                "path": "py-plugin/skills/mcp-tool-generator/SKILL.md",
                "frontmatter": {
                  "name": "mcp-tool-generator",
                  "description": "Generate new MCP tools for GitLab operations following the project's standardized pattern. Creates complete TypeScript files with imports, registration functions, Zod schemas, error handling, and format options. Supports simple CRUD operations, complex multi-action tools, and advanced patterns like discussion management. Use when \"create mcp tool\", \"generate gitlab tool\", \"new tool for\", \"add tool to gitlab\", or building new GitLab integration features.",
                  "allowed-tools": "Read, Write, Glob, Grep"
                },
                "content": "# MCP Tool Generator\n\nGenerate new MCP tools following the standardized patterns from the project. Creates complete tool files with proper imports, Zod schemas, error handling, and GitLab API integration.\n\n## Activation Triggers\n\n- \"create an mcp tool for...\"\n- \"generate a gitlab tool to...\"\n- \"I need a new tool that...\"\n- \"add a tool for [operation]\"\n- \"create tool to [action] [resource]\"\n\n## Tool Types Supported\n\n### 1. Simple CRUD Tools\nBasic get/list/create/update/delete operations with standard patterns:\n- Get single resource (issue, MR, milestone, etc.)\n- List multiple resources with filtering and pagination\n- Create new resources\n- Update existing resources\n- Delete resources\n\n**Pattern**: `gitlab-[action]-[resource]` (e.g., `gitlab-get-issue`, `gitlab-list-pipelines`)\n\n### 2. Multi-Action Tools\nComprehensive tools that handle multiple related operations in one tool:\n- Multiple actions via `action` enum parameter\n- Conditional logic based on action type\n- Structured responses with status/action/message format\n- More efficient than multiple separate tools\n\n**Pattern**: `gitlab-[resource]-[operation]` (e.g., `gitlab-manage-issue`)\n\n### 3. Complex Operation Tools\nTools with advanced logic:\n- Discussion/comment management with update detection\n- Multi-step workflows\n- Direct API calls using fetch for specific needs\n- Position-based operations (code reviews, inline comments)\n\n**Pattern**: Based on specific operation (e.g., `gitlab-review-merge-request-code`)\n\n## Autonomous Generation Process\n\n### Step 1: Analyze User Request\n\nExtract key information:\n1. **Tool Type**: Simple CRUD, multi-action, or complex?\n2. **Tool Purpose**: What GitLab operation? (e.g., \"get merge request details\", \"manage issues\", \"review code\")\n3. **Resource Type**: What GitLab entity? (issue, MR, branch, milestone, pipeline, label, etc.)\n4. **Action Type**: What operation? (get, list, create, update, delete, search, manage, review, etc.)\n5. **Required Parameters**: What inputs needed? (projectname, IID, branch name, action, etc.)\n6. **Optional Parameters**: What's optional? (format, labels, assignee, filters, etc.)\n7. **Special Features**: Multi-action? Position-based? Discussion management?\n\n### Step 2: Auto-Generate Names\n\n**Tool Name** (kebab-case):\n- Simple CRUD: `gitlab-[action]-[resource]`\n  - Examples: `gitlab-get-merge-request`, `gitlab-list-pipelines`, `gitlab-create-branch`\n- Multi-action: `gitlab-[manage|handle]-[resource]`\n  - Examples: `gitlab-manage-issue`, `gitlab-handle-milestone`\n- Complex: `gitlab-[specific-operation]`\n  - Examples: `gitlab-review-merge-request-code`, `gitlab-find-related-issues`\n\n**Function Name** (PascalCase):\n- Pattern: `register[Action][Resource]`\n- Examples:\n  - `gitlab-get-merge-request` ‚Üí `registerGetMergeRequest`\n  - `gitlab-manage-issue` ‚Üí `registerManageIssue`\n  - `gitlab-review-merge-request-code` ‚Üí `registerReviewMergeRequestCode`\n\n**File Name** (kebab-case):\n- Pattern: `gitlab-[tool-name].ts`\n- Location: `src/tools/gitlab/`\n\n### Step 3: Select Tool Pattern\n\n#### Pattern A: Simple CRUD Tool\n\n**Use when**: Single operation (get, list, create, update, delete)\n\n**Standard features**:\n- `projectname` parameter (optional, with prompt fallback)\n- `format` parameter (detailed/concise) for get/list operations\n- HTML content cleaning with `cleanGitLabHtmlContent()`\n- Project validation before API calls\n- Descriptive error messages\n- Emojis in concise format\n\n**Template structure**:\n```typescript\nimport { McpServer } from '@modelcontextprotocol/sdk/server/mcp';\nimport { z } from 'zod';\nimport { cleanGitLabHtmlContent } from '../../core/utils';\nimport { getGitLabService, getProjectNameFromUser } from './gitlab-shared';\n\nexport function register{FunctionName}(server: McpServer) {\n    server.registerTool(\n        \"{tool-name}\",\n        {\n            title: \"{Human Readable Title}\",\n            description: \"{Detailed description}\",\n            inputSchema: {\n                {param1}: z.{type}().describe(\"{description}\"),\n                projectname: z.string().optional().describe(\"GitLab project name (if not provided, you'll be prompted to select)\"),\n                format: z.enum([\"detailed\", \"concise\"]).optional().describe(\"Response format - 'detailed' includes all metadata, 'concise' includes only key information\")\n            }\n        },\n        async ({ {params}, projectname, format = \"detailed\" }) => {\n            try {\n                // Standard workflow\n            } catch (e) {\n                return { content: [{ type: \"text\", text: JSON.stringify({ type: \"error\", error: String(e) }) }] };\n            }\n        }\n    );\n}\n```\n\n#### Pattern B: Multi-Action Tool\n\n**Use when**: Multiple related operations on same resource type\n\n**Standard features**:\n- `action` parameter with enum of actions\n- Switch/case logic for each action\n- Structured responses: `{ status: \"success\"/\"failure\", action: \"...\", message: \"...\", [resource]: {...} }`\n- Direct API calls using fetch when needed\n- Conditional parameters based on action\n- No format parameter (uses structured JSON)\n\n**Template structure**:\n```typescript\nimport { McpServer } from '@modelcontextprotocol/sdk/server/mcp';\nimport fetch from 'node-fetch';\nimport { z } from 'zod';\nimport { cleanGitLabHtmlContent } from '../../core/utils';\nimport { getGitLabService, getProjectNameFromUser } from './gitlab-shared';\n\nexport function register{FunctionName}(server: McpServer) {\n    server.registerTool(\n        \"{tool-name}\",\n        {\n            title: \"{Human Readable Title}\",\n            description: \"{Comprehensive description covering all actions}\",\n            inputSchema: {\n                {resourceId}: z.number().describe(\"The ID/IID of the resource\"),\n                projectname: z.string().optional().describe(\"GitLab project name (if not provided, you'll be prompted to select)\"),\n                action: z.enum([\"action1\", \"action2\", \"action3\"]).describe(\"Action to perform\"),\n                // Conditional parameters for different actions\n                param1: z.{type}().optional().describe(\"For action1: description\"),\n                param2: z.{type}().optional().describe(\"For action2: description\")\n            }\n        },\n        async ({ {resourceId}, projectname, action, {params} }) => {\n            try {\n                // Get project and resource\n                const projectName = projectname || await getProjectNameFromUser(server, false, \"prompt\");\n                if (!projectName) {\n                    return { content: [{ type: \"text\", text: JSON.stringify({ type: \"error\", error: \"Project not found\" }) }] };\n                }\n\n                const service = await getGitLabService(server);\n                const projectId = await service.getProjectId(projectName);\n                if (!projectId) {\n                    return { content: [{ type: \"text\", text: JSON.stringify({ type: \"error\", error: `Project \"${projectName}\" not found` }) }] };\n                }\n\n                // Get resource first\n                const rawResource = await service.get{Resource}(projectId, {resourceId});\n                if (!rawResource) {\n                    return { content: [{ type: \"text\", text: JSON.stringify({ type: \"error\", error: `Resource not found` }) }] };\n                }\n\n                const resource = cleanGitLabHtmlContent(rawResource, ['description', 'title']);\n\n                // Handle actions\n                switch (action) {\n                    case \"action1\":\n                        // Implementation\n                        return { content: [{ type: \"text\", text: JSON.stringify({\n                            status: 'success',\n                            action: 'action1',\n                            message: 'Action completed',\n                            {resource}: { /* key fields */ }\n                        }, null, 2) }] };\n\n                    case \"action2\":\n                        // Implementation\n                        break;\n\n                    default:\n                        return { content: [{ type: \"text\", text: JSON.stringify({\n                            status: 'failure',\n                            error: `Unknown action \"${action}\"`\n                        }, null, 2) }] };\n                }\n            } catch (e) {\n                return { content: [{ type: \"text\", text: JSON.stringify({\n                    status: 'failure',\n                    error: String(e)\n                }, null, 2) }] };\n            }\n        }\n    );\n}\n```\n\n#### Pattern C: Complex Operation Tool\n\n**Use when**: Advanced logic like discussion management, position-based operations, multi-step workflows\n\n**Standard features**:\n- Specialized parameters (may not include projectname if using projectId directly)\n- Custom logic for specific use cases\n- May use direct API calls\n- May fetch and update existing data\n- Structured responses appropriate to operation\n\n**Template structure**: Highly variable based on specific needs\n\n### Step 4: Generate Zod Schema\n\n**Common Parameter Patterns**:\n\n```typescript\n// IDs (internal issue/MR number)\n{name}Iid: z.number().describe(\"The internal ID (IID) of the {resource} to {action}\")\n\n// Project ID (for tools that need direct ID)\nprojectId: z.number().describe(\"The project ID\")\n\n// Names/identifiers\n{name}: z.string().describe(\"{Resource} name (e.g., 'feature/user-auth')\")\n\n// Action enums (for multi-action tools)\naction: z.enum([\"action1\", \"action2\", \"action3\"]).describe(\"Action to perform on the {resource}\")\n\n// Optional filters\nstate: z.enum([\"opened\", \"closed\", \"all\"]).optional().describe(\"Filter by state (default: 'opened')\")\nlabels: z.string().optional().describe(\"Comma-separated list of label names to filter by\")\n// OR for multi-action tools:\nlabels: z.array(z.string()).optional().describe(\"For add-labels action: labels to add\")\n\n// Pagination\npage: z.number().optional().describe(\"Page number for pagination (default: 1)\")\nperPage: z.number().optional().describe(\"Number of items per page (default: 20, max: 100)\")\n\n// Dates\ndueDate: z.string().optional().describe(\"Due date in ISO 8601 format (YYYY-MM-DD)\")\n\n// Position-based parameters (for code review tools)\nbaseSha: z.string().describe(\"Base SHA for the diff\")\nstartSha: z.string().describe(\"Start SHA for the diff\")\nheadSha: z.string().describe(\"Head SHA for the diff\")\nnewPath: z.string().describe(\"Path to the file being reviewed\")\nnewLine: z.number().optional().describe(\"Line number in the new file\")\n\n// Project (standard for simple CRUD, optional for complex tools)\nprojectname: z.string().optional().describe(\"GitLab project name (if not provided, you'll be prompted to select)\")\n\n// Format (only for simple get/list operations)\nformat: z.enum([\"detailed\", \"concise\"]).optional().describe(\"Response format - 'detailed' includes all metadata, 'concise' includes only key information\")\n```\n\n**Important notes**:\n- Add `.describe()` with clear examples for all parameters\n- Use `z.array(z.string())` for arrays in multi-action tools\n- Note when square brackets `[]` are allowed in descriptions for paths/labels/markdown\n- Make parameters optional when sensible defaults exist\n\n### Step 5: Generate Response Formats\n\n#### Simple CRUD Tools (Pattern A)\n\n**Concise format** (with emojis):\n```typescript\nif (format === \"concise\") {\n    return { content: [{ type: \"text\", text:\n        `{emoji} {Resource} #{id}: {title}\\n` +\n        `üìä Status: {state}\\n` +\n        `üë§ {role}: {user}\\n` +\n        `üè∑Ô∏è Labels: {labels}\\n` +\n        `üéØ Milestone: {milestone}\\n` +\n        `üìÖ Due: {due_date}\\n` +\n        `üîó URL: {web_url}`\n    }] };\n}\n```\n\n**Detailed format** (full JSON):\n```typescript\nreturn { content: [{ type: \"text\", text: JSON.stringify({resource}, null, 2) }] };\n```\n\n**Emoji Guide**:\n- üîç - Get/View operations\n- üìã - List operations\n- ‚ú® - Create operations\n- üîÑ - Update operations\n- üóëÔ∏è - Delete operations\n- üìä - Status/State\n- üë§ - User/Assignee\n- üè∑Ô∏è - Labels\n- üéØ - Milestone\n- üìÖ - Dates\n- üîó - URLs\n- ‚úÖ - Success/Completed\n- ‚ùå - Error/Failed\n\n#### Multi-Action Tools (Pattern B)\n\n**Structured JSON format**:\n```typescript\n// Success response\n{\n    status: 'success',\n    action: 'action-name',\n    message: 'Human-readable success message',\n    {resource}: {\n        id: resource.id,\n        iid: resource.iid,\n        title: resource.title,\n        webUrl: resource.web_url,\n        // Other key fields relevant to the action\n    }\n}\n\n// Failure response\n{\n    status: 'failure',\n    action: 'action-name',\n    error: 'Detailed error message with context',\n    {resource}: {\n        id: resource.id,\n        iid: resource.iid,\n        title: resource.title,\n        webUrl: resource.web_url\n    }\n}\n```\n\n#### Complex Tools (Pattern C)\n\nCustom format based on operation needs. Examples:\n```typescript\n// Discussion update/create\n{\n    action: \"updated\" | \"created\",\n    discussion_id: \"...\",\n    note_id: \"...\",\n    updated_note: {...}\n}\n```\n\n### Step 6: Add Error Handling\n\n**Standard Error Patterns**:\n\n```typescript\n// Project not selected (for tools with projectname parameter)\nif (!projectName) {\n    return { content: [{ type: \"text\", text: JSON.stringify({\n        type: \"error\",\n        error: \"Project not found or not selected. Please provide a valid project name.\"\n    }) }] };\n}\n\n// Project not found\nif (!projectId) {\n    return { content: [{ type: \"text\", text: JSON.stringify({\n        type: \"error\",\n        error: `Could not find project \"${projectName}\". Please verify the project name is correct and you have access to it.`\n    }) }] };\n}\n\n// Resource not found\nif (!resource) {\n    return { content: [{ type: \"text\", text: JSON.stringify({\n        type: \"error\",\n        error: `{Resource} not found. Please verify the {parameters} are correct.`\n    }) }] };\n}\n\n// Missing required parameters (for multi-action tools)\nif (!requiredParam) {\n    return { content: [{ type: \"text\", text: JSON.stringify({\n        status: 'failure',\n        action: action,\n        error: \"Required parameter missing. Please specify...\",\n        {resource}: { /* minimal info */ }\n    }, null, 2) }] };\n}\n\n// API call failure (for multi-action tools using fetch)\nif (!response.ok) {\n    return { content: [{ type: \"text\", text: JSON.stringify({\n        status: 'failure',\n        action: action,\n        error: `Failed to {action}. Status: ${response.status}`,\n        {resource}: { /* minimal info */ }\n    }, null, 2) }] };\n}\n\n// General error (catch block)\ncatch (e) {\n    // For simple CRUD tools:\n    return { content: [{ type: \"text\", text: JSON.stringify({\n        type: \"error\",\n        error: `Error {operation}: ${String(e)}. Please check your GitLab connection and permissions.`\n    }) }] };\n\n    // For multi-action tools:\n    return { content: [{ type: \"text\", text: JSON.stringify({\n        status: 'failure',\n        error: `Error {operation}: ${String(e)}`\n    }, null, 2) }] };\n}\n```\n\n### Step 7: Register in gitlab-tool.ts\n\nAfter creating the tool file, add registration:\n\n```typescript\n// In src/tools/gitlab-tool.ts\n\n// Add import at top\nimport { register{FunctionName} } from './gitlab/gitlab-{tool-name}';\n\n// Add registration in registerGitlabTools function\nexport function registerGitlabTools(server: McpServer) {\n    // ... other registrations\n    register{FunctionName}(server);\n}\n```\n\n## Interactive Generation Workflow\n\n### Ask User (Only if unclear):\n\n1. **Tool Type**:\n   - \"Is this a simple CRUD operation, multi-action tool, or complex operation?\"\n   - Clarify if multiple actions should be combined in one tool\n\n2. **Tool Purpose**:\n   - \"What GitLab operation should this tool perform?\"\n   - Examples: \"Get merge request details\", \"Manage issues (get, update, close)\", \"Review code inline\"\n\n3. **Required Parameters**:\n   - \"What parameters are required?\"\n   - Examples: \"merge request IID\", \"issue IID and action type\", \"project ID and position data\"\n\n4. **Optional Parameters**:\n   - \"Any optional filters or options?\"\n   - Examples: \"state filter\", \"label filter\", \"format option\"\n\n5. **API Method** (if not obvious):\n   - \"Which GitLab service method to use?\"\n   - Check `src/services/gitlab-client.ts` for available methods\n   - Note if direct fetch API calls are needed\n\n### Generate Files:\n\n1. **Create tool file**: `src/tools/gitlab/gitlab-{tool-name}.ts`\n2. **Show registration code** for `src/tools/gitlab-tool.ts`\n3. **Provide usage examples** based on tool type\n\n## Output Format\n\nAfter generating the tool:\n\n```markdown\n‚úÖ MCP Tool Created: {tool-name}\n\nüìÅ Files Created:\n- `src/tools/gitlab/gitlab-{tool-name}.ts`\n\nüîß Type: {Simple CRUD | Multi-Action | Complex Operation}\nüîß Function: register{FunctionName}\n\nüìù Next Steps:\n1. Add registration to `src/tools/gitlab-tool.ts`:\n   ```typescript\n   import { register{FunctionName} } from './gitlab/gitlab-{tool-name}';\n   // In registerGitlabTools:\n   register{FunctionName}(server);\n   ```\n\n2. Rebuild the project:\n   ```bash\n   npm run build\n   ```\n\n3. Test the tool:\n   ```bash\n   npm run dev\n   ```\n\nüéØ Usage Examples:\n{Type-specific examples}\n\nüìñ Tool registered as: \"{tool-name}\"\n```\n\n## GitLab Service Methods Reference\n\nCommon methods available in `gitlab-client.ts`. Latest update 31/10/2025:\n\n**Issues**:\n- `getIssue(projectId, iid)`\n- `getIssues(projectId, options)`\n- `createIssue(projectId, data)`\n- `updateIssue(projectId, iid, data)`\n\n**Merge Requests**:\n- `getMergeRequest(projectId, iid)`\n- `getMergeRequests(projectId, options)`\n- `createMergeRequest(projectId, data)`\n- `updateMergeRequest(projectId, iid, data)`\n- `approveMergeRequest(projectId, iid)`\n- `getMrDiscussions(projectId, iid)`\n- `addMrComments(projectId, iid, data)`\n- `updateMrDiscussionNote(projectId, iid, discussionId, noteId, body)`\n\n**Branches**:\n- `getBranches(projectId, options)`\n- `createBranch(projectId, branchName, ref)`\n- `deleteBranch(projectId, branchName)`\n\n**Pipelines**:\n- `getPipelines(projectId, options)`\n- `getPipeline(projectId, pipelineId)`\n- `createPipeline(projectId, ref)`\n\n**Milestones**:\n- `getMilestone(projectId, milestoneId)`\n- `getMilestones(projectId, options)`\n- `createMilestone(projectId, data)`\n- `updateMilestone(projectId, milestoneId, data)`\n\n**Projects**:\n- `getProjectId(projectName)`\n- `getProject(projectId)`\n- `searchProjects(search)`\n\n**Users**:\n- `getUserIdByUsername(username)`\n\n**Direct Fetch API**:\nFor operations not covered by service methods, use direct fetch:\n```typescript\nconst response = await fetch(`${service.gitlabUrl}/api/v4/projects/${projectId}/{endpoint}`, {\n    method: 'PUT' | 'POST' | 'GET' | 'DELETE',\n    headers: service['getHeaders'](),\n    body: JSON.stringify({...})\n});\n```\n\n## Key Patterns to Follow\n\n1. **Always use appropriate tool pattern** based on operation type\n2. **Simple CRUD tools**: Include `projectname` and `format` parameters\n3. **Multi-action tools**: Use `action` enum and structured responses\n4. **Always clean HTML content** with `cleanGitLabHtmlContent()` where applicable\n5. **Always validate project exists** before API calls (if using projectname)\n6. **Always use descriptive error messages** with context\n7. **Always use emojis in concise format** for simple CRUD tools\n8. **Always follow kebab-case** for file and tool names\n9. **Always follow PascalCase** for function names\n10. **Always provide detailed Zod descriptions** with examples\n11. **Always handle null/undefined responses** gracefully\n12. **Multi-action tools**: Return structured JSON with status/action/message\n13. **Direct API calls**: Use fetch and check response.ok\n14. **Note square bracket support**: Add notes about `[]` support in descriptions where relevant (file paths, labels, markdown)\n\n## Quality Checklist\n\nBefore presenting the generated tool:\n\n- ‚úÖ File name is kebab-case\n- ‚úÖ Function name is PascalCase with \"register\" prefix\n- ‚úÖ All imports are correct\n- ‚úÖ Zod schema has detailed descriptions\n- ‚úÖ Appropriate tool pattern selected (Simple CRUD / Multi-Action / Complex)\n- ‚úÖ For simple CRUD: projectname optional, format parameter included\n- ‚úÖ For multi-action: action enum, structured responses, conditional params\n- ‚úÖ HTML content cleaned where applicable\n- ‚úÖ Error messages are descriptive and actionable\n- ‚úÖ Response format matches tool type\n- ‚úÖ Try-catch wraps the entire handler\n- ‚úÖ All responses follow `{ content: [{ type: \"text\", text: ... }] }` format\n- ‚úÖ Tool follows MCP SDK patterns\n- ‚úÖ Code matches project conventions from CLAUDE.md\n\n---\n\n**Ready to generate MCP tools!** Tell me what GitLab operation you want to create a tool for."
              },
              {
                "name": "payoo-ios-code-review",
                "description": "Comprehensive iOS code review for Payoo Merchant app. Checks Clean Architecture patterns, MVVM with RxSwift, memory management, Swinject DI, session error handling, layer separation, naming conventions, and SwiftLint compliance. Use when \"review code\", \"check code\", \"code review\", \"review PR\", \"check pull request\", or analyzing Swift files in this project.",
                "path": "py-plugin/skills/payoo-ios-code-review/SKILL.md",
                "frontmatter": {
                  "name": "payoo-ios-code-review",
                  "description": "Comprehensive iOS code review for Payoo Merchant app. Checks Clean Architecture patterns, MVVM with RxSwift, memory management, Swinject DI, session error handling, layer separation, naming conventions, and SwiftLint compliance. Use when \"review code\", \"check code\", \"code review\", \"review PR\", \"check pull request\", or analyzing Swift files in this project.",
                  "allowed-tools": "Read, Grep, Glob, Bash"
                },
                "content": "# Payoo iOS Code Review\n\nComprehensive code review for the Payoo Merchant iOS app following Clean Architecture with RxSwift and Swinject.\n\n## When to Activate\n\n- \"review code\", \"check code\", \"code review\"\n- \"review PR\", \"review pull request\", \"check pull request\"\n- \"review this file\", \"check this ViewModel\"\n- \"is this code correct\", \"any issues with this code\"\n- When analyzing Swift files in PayooMerchant, Domain, Data, or Analytics layers\n\n## Review Process\n\n### Step 1: Identify Scope\n- Single file review ‚Üí Read the file\n- Multiple files ‚Üí Use Glob to find related files\n- Pull request ‚Üí Check git diff for changed files\n- Full feature ‚Üí Grep for related ViewModels/UseCases\n\n### Step 2: Layer-Specific Checks\n\n#### For Presentation Layer (PayooMerchant/)\n1. **MVVM Pattern**\n   - ‚úì ViewModel implements `ViewModelType` protocol\n   - ‚úì Has `Input` and `Output` nested types\n   - ‚úì Has `transform(input:) -> Output` method\n   - ‚úì ViewControllers bind to Input/Output only\n   - ‚úì No business logic in ViewControllers\n\n2. **RxSwift Memory Management**\n   - ‚úì Every ViewController/ViewModel has `DisposeBag`\n   - ‚úì All subscriptions use `.disposed(by: disposeBag)`\n   - ‚úì Closures capturing self use `[weak self]` or `[unowned self]`\n   - ‚úì No retain cycles in Observable chains\n\n3. **Navigation & DI**\n   - ‚úì Navigator passed as dependency (never created directly)\n   - ‚úì UseCases injected via constructor\n   - ‚úì No direct ViewController instantiation\n   - ‚úì Uses factory methods from `ViewControllerFactory`\n\n4. **Session Error Handling**\n   - ‚úì **CRITICAL**: All API calls have `.catchSessionError(sessionUC)`\n   - ‚úó Missing `.catchSessionError()` ‚Üí Session timeout won't logout\n\n#### For Domain Layer (Domain/)\n1. **Clean Architecture Rules**\n   - ‚úì Pure Swift only (no UIKit imports)\n   - ‚úì No imports from Data or Presentation layers\n   - ‚úì Only protocols for services (no implementations)\n   - ‚úì Models are simple structs/classes\n\n2. **UseCase Pattern**\n   - ‚úì Protocol defines interface (`UseCaseType`)\n   - ‚úì Implementation injected with dependencies\n   - ‚úì Single responsibility per UseCase\n   - ‚úì Returns RxSwift Observables/Singles/Maybes\n   - ‚úì Uses `.catchSessionError(sessionUC)` for API calls\n\n3. **Service Protocols**\n   - ‚úì Defined in `Domain/Service/`\n   - ‚úì Implemented in Data layer\n   - ‚úì Injected via Swinject\n\n#### For Data Layer (Data/)\n1. **Repository Pattern**\n   - ‚úì Implements Domain service protocols\n   - ‚úì Uses Moya for network calls\n   - ‚úì Uses Realm for local storage\n   - ‚úì Converters transform DTOs ‚Üî Domain models\n\n2. **API Models**\n   - ‚úì DTOs in `Data/Model/`\n   - ‚úì Conform to `DomainConvertible` or `RealmRepresentable`\n   - ‚úì Use ObjectMapper for JSON parsing\n   - ‚úì Don't leak to Domain/Presentation layers\n\n### Step 3: Project-Wide Checks\n\n1. **SwiftLint Compliance**\n   - Run: `./Pods/SwiftLint/swiftlint lint --reporter xcode`\n   - Check: Type body length (300/400), file length (800/1200)\n   - Check: Opt-in rules (empty_count, yoda_condition, todo, etc.)\n\n2. **Common Pitfalls**\n   - [ ] Missing `.catchSessionError()` on API observables\n   - [ ] Manual ViewController instantiation (should use factory)\n   - [ ] Missing DependencyContainer registration\n   - [ ] Breaking layer boundaries (e.g., Data imported in Domain)\n   - [ ] Missing `disposed(by: disposeBag)`\n   - [ ] Strong self in closures causing retain cycles\n   - [ ] Using `.count > 0` instead of `.isEmpty` (SwiftLint)\n   - [ ] Force unwraps without justification\n   - [ ] Magic numbers without constants\n\n3. **RxSwift Best Practices**\n   - Use `Driver` for UI bindings (never fails, main thread)\n   - Use `Single` for one-time operations (network calls)\n   - Use `Observable` for streams\n   - Use `Maybe` for optional single values\n   - Prefer `.bind(to:)` over `.subscribe(onNext:)`\n\n4. **Naming Conventions**\n   - [ ] ViewModels: `[Feature]ViewModel` (e.g., `LoginViewModel`, `TransactionHistoryViewModel`)\n   - [ ] ViewControllers: `[Feature]ViewController` (e.g., `LoginViewController`)\n   - [ ] UseCases: `[Action]UseCase` (e.g., `GetProfileUseCase`, `LoginUseCase`)\n   - [ ] UseCase protocols: `[Action]UseCaseType` (e.g., `GetProfileUseCaseType`)\n   - [ ] Navigators: `[Feature]Navigator` (e.g., `LoginNavigator`, `HomeNavigator`)\n   - [ ] Navigator protocols: `[Feature]NavigatorType`\n   - [ ] Services (protocols): `[Name]Service` (e.g., `ApiService`, `LocalStorageService`)\n   - [ ] Services (impl): `Default[Name]Service` or `[Tech][Name]Service` (e.g., `DefaultApiService`, `RealmStorageService`)\n   - [ ] Protocols: `[Name]Type` suffix for main protocols\n   - [ ] Variables: camelCase, descriptive (avoid abbreviations like `usrNm`, use `username`)\n   - [ ] Constants: camelCase for local, or `k` prefix for global (e.g., `kMaxRetryCount`)\n   - [ ] IBOutlets: Descriptive names with type suffix (e.g., `loginButton`, `usernameTextField`)\n   - [ ] Avoid single letters except in loops (i, j) or common conventions (x, y)\n\n### Step 4: Generate Report\n\nFormat:\n```markdown\n## Code Review: [File/Feature Name]\n\n### üìã Summary\nFiles: X | üî¥ Critical: X | üü° Warning: X | üîµ Info: X | Status: [‚úÖ Approved / ‚ö†Ô∏è Needs fixes / ‚ùå Blocked]\n\n### ‚úÖ Strengths\n- [List good patterns found]\n\n### ‚ö†Ô∏è Issues Found\n\n#### üî¥ Critical (Must Fix)\n**[Issue]** at [file:line]\n- **Problem**: [Description]\n- **Impact**: [Why critical]\n- **Fix**:\n\\`\\`\\`swift\n// Corrected code\n\\`\\`\\`\n\n#### üü° Warning (Should Fix)\n**[Issue]** at [file:line]\n- **Problem**: [Description]\n- **Suggestion**: [How to fix]\n\n#### üîµ Info (Consider)\n**[Issue]** at [file:line]\n- **Note**: [Observation]\n- **Suggestion**: [Optional improvement]\n```\n\n## Review Categories\n\n### Critical Issues (Must Fix)\n- Missing `.catchSessionError()` on API calls\n- Retain cycles / memory leaks\n- Breaking Clean Architecture layer boundaries\n- Missing DisposeBag disposal\n- Force unwraps in unsafe contexts\n\n### Warnings (Should Fix)\n- Manual ViewController instantiation\n- Missing DependencyContainer registration\n- SwiftLint violations\n- Non-descriptive variable names\n- Large type bodies (>300 lines)\n\n### Info (Consider)\n- Potential optimizations\n- Code duplication\n- Missing unit tests\n- Outdated comments\n- TODO/FIXME comments\n\n## Quick Commands\n\nRun SwiftLint:\n```bash\n./Pods/SwiftLint/swiftlint lint --reporter xcode\n```\n\nFind files without DisposeBag:\n```bash\ngrep -L \"DisposeBag\" PayooMerchant/**/*ViewModel.swift\n```\n\nFind API calls without catchSessionError:\n```bash\ngrep -r \"apiService\\.\" --include=\"*.swift\" | grep -v \"catchSessionError\"\n```\n\n## Example Review Flow\n\n1. User: \"Review LoginViewModel\"\n2. Read `PayooMerchant/Controllers/Login/LoginViewModel.swift`\n3. Check MVVM pattern, RxSwift, DI\n4. Grep for related files (LoginViewController, LoginUseCase)\n5. Run SwiftLint on the file\n6. Generate detailed report with line numbers\n7. Provide fix recommendations\n\n## Key Architectural Rules\n\n1. **Layer Dependencies**\n   ```\n   Presentation ‚Üí Domain ‚Üê Data\n   ```\n   - Presentation can import Domain\n   - Data can import Domain\n   - Domain imports nothing (pure Swift)\n   - NEVER: Domain imports Data/Presentation\n\n2. **RxSwift Pattern**\n   ```swift\n   // ViewModel transform pattern\n   func transform(input: Input) -> Output {\n       let result = input.trigger\n           .flatMapLatest { [weak self] _ -> Observable<Data> in\n               guard let self = self else { return .empty() }\n               return self.useCase.execute()\n                   .catchSessionError(self.sessionUC) // CRITICAL!\n           }\n       return Output(result: result.asDriver(onErrorJustReturn: .empty))\n   }\n   ```\n\n3. **Memory Management**\n   ```swift\n   // CORRECT\n   .subscribe(onNext: { [weak self] value in\n       self?.updateUI(value)\n   }).disposed(by: disposeBag)\n\n   // WRONG - Retain cycle!\n   .subscribe(onNext: { value in\n       self.updateUI(value)\n   }).disposed(by: disposeBag)\n   ```\n\n## Output Format\n\nAlways provide:\n1. Clear issue categorization (Critical/Warning/Info)\n2. File paths with line numbers for clickable links\n3. Code snippets showing the problem\n4. Concrete fix recommendations\n5. Summary with metrics\n\nReference: See `standards.md` for detailed coding standards and `examples.md` for review examples."
              },
              {
                "name": "rxswift-memory-check",
                "description": "Quick RxSwift memory leak detection for iOS. Finds missing dispose bags, retain cycles, and strong self references. Use when debugging memory issues, checking Observable subscriptions, or investigating retain cycles in RxSwift code.",
                "path": "py-plugin/skills/rxswift-memory-check/SKILL.md",
                "frontmatter": {
                  "name": "rxswift-memory-check",
                  "description": "Quick RxSwift memory leak detection for iOS. Finds missing dispose bags, retain cycles, and strong self references. Use when debugging memory issues, checking Observable subscriptions, or investigating retain cycles in RxSwift code.",
                  "allowed-tools": "Read, Grep, Glob"
                },
                "content": "# RxSwift Memory Leak Detector\n\nFast, focused check for RxSwift memory management issues in iOS code.\n\n## When to Activate\n\n- \"memory leak\", \"retain cycle\", \"dispose bag\"\n- \"RxSwift memory issues\", \"check subscriptions\"\n- \"[weak self]\", \"memory management\"\n- Debugging memory problems or crashes\n\n## Quick Check Process\n\n### Step 1: Find RxSwift Subscriptions\n\nUse Grep to locate all Observable subscriptions:\n- Pattern: `\\.subscribe\\(`\n- Check surrounding code for proper disposal\n\n### Step 2: Verify Each Subscription\n\nFor every `.subscribe(`:\n1. ‚úÖ Has `.disposed(by: disposeBag)`\n2. ‚úÖ Uses `[weak self]` or `[unowned self]` in closures\n3. ‚úÖ DisposeBag is a property, not local variable\n\n### Step 3: Check Common Patterns\n\n#### üî¥ Pattern 1: Missing Disposal\n```swift\nviewModel.data\n    .subscribe(onNext: { data in })\n    // MISSING: .disposed(by: disposeBag)\n```\n\n#### üî¥ Pattern 2: Retain Cycle\n```swift\nviewModel.data\n    .subscribe(onNext: { data in\n        self.updateUI(data)  // Strong self!\n    })\n```\n\n#### üî¥ Pattern 3: Local DisposeBag\n```swift\nfunc loadData() {\n    let disposeBag = DisposeBag()  // Local variable!\n    // Cancels immediately when function ends\n}\n```\n\n### Step 4: Generate Report\n\nFocused report with:\n- Critical issues by severity\n- File locations and line numbers\n- Current vs. fixed code\n- Impact assessment\n- Recommended fixes\n\n## Search Patterns\n\n### Find subscriptions without disposal\n```\nPattern: \\.subscribe\\(\nContext: Check next 5 lines for .disposed\n```\n\n### Find strong self references\n```\nPattern: subscribe.*\\{[^[]*self\\.\nContext: -A 3 -B 1\n```\n\n### Find local DisposeBag declarations\n```\nPattern: let disposeBag = DisposeBag\\(\\)\n```\n\n## Output Format\n\n```markdown\n# RxSwift Memory Check Report\n\n## Critical Issues: X\n\n### 1. Missing Disposal - MEMORY LEAK\n**File**: `PaymentViewModel.swift:45`\n**Risk**: Memory accumulation, eventual crash\n\n**Current**:\n```swift\n// Missing disposal\n```\n\n**Fix**:\n```swift\n.disposed(by: disposeBag)\n```\n\n**Impact**: [Explanation]\n\n---\n\n## Summary\nüî¥ Critical: X (memory leaks/retain cycles)\n‚ö†Ô∏è  Warnings: X (could use weak self)\n\n## Files Status\n‚úÖ Clean files\n‚ö†Ô∏è  Files with warnings\nüî¥ Files with critical issues\n```\n\n## DisposeBag Best Practices\n\n‚úÖ **Correct**: Property-level DisposeBag\n```swift\nclass ViewModel {\n    private let disposeBag = DisposeBag()\n}\n```\n\n‚ùå **Wrong**: Local DisposeBag\n```swift\nfunc loadData() {\n    let disposeBag = DisposeBag()  // Cancels immediately!\n}\n```\n\n## When to Use `weak` vs `unowned`\n\n- **Default**: Always use `[weak self]` (safer)\n- **Rare**: Use `[unowned self]` only if 100% sure self outlives subscription\n\n## Quick Fix Guide\n\n1. **Add Missing Disposal**: `.disposed(by: disposeBag)`\n2. **Add Weak Self**: `[weak self]` in closure\n3. **Move DisposeBag**: To property level\n\n## Testing the Fix\n\nSuggest verification:\n1. Run Instruments with Leaks template\n2. Navigate to/from screens multiple times\n3. Check Debug Memory Graph for cycles\n4. Verify view controllers deallocate\n\n## Reference\n\n**Detailed Examples**: See `examples.md` for extensive code samples and scenarios."
              },
              {
                "name": "skill-builder",
                "description": "Create new Claude Code agent skills. Automatically analyzes requirements and generates complete skill with proper structure, triggers, and tools. Use when you want to \"create a skill\", \"build a new skill\", \"make a skill for\", or automate repetitive tasks.",
                "path": "py-plugin/skills/skill-builder/SKILL.md",
                "frontmatter": {
                  "name": "skill-builder",
                  "description": "Create new Claude Code agent skills. Automatically analyzes requirements and generates complete skill with proper structure, triggers, and tools. Use when you want to \"create a skill\", \"build a new skill\", \"make a skill for\", or automate repetitive tasks.",
                  "allowed-tools": "Read, Write, Glob, Bash"
                },
                "content": "# Skill Builder\n\nAutonomously create new Claude Code agent skills with intelligent analysis and generation.\n\n## When to Activate\n\n- \"create a skill for...\", \"build a new skill\"\n- \"make a skill that...\", \"I need a skill to...\"\n- \"generate a skill for...\"\n\n## Autonomous Creation Process\n\n### Step 1: Analyze User Request\n\n**Automatically infer from the request:**\n\n1. **Task Type Detection**:\n   - Review/Check ‚Üí Code Review Skill (Read, Grep, Glob)\n   - Generate/Create ‚Üí Code Generator (Read, Write, Glob)\n   - Analyze/Report ‚Üí Analyzer (Read, Grep, Glob, Bash)\n   - Refactor/Improve ‚Üí Refactoring Assistant (Read, Write, Grep, Glob)\n   - Test ‚Üí Test Assistant (Read, Write, Bash)\n   - Document ‚Üí Documentation Generator (Read, Write, Glob)\n\n2. **Skill Name Derivation**:\n   - Extract key technology/concept from request\n   - Format: `[technology]-[action]` (e.g., \"check iOS performance\" ‚Üí `ios-performance-check`)\n   - Keep lowercase with hyphens, max 64 chars\n\n3. **Trigger Keywords Extraction**:\n   - Parse user's language for natural phrases\n   - Add common variations and synonyms\n   - Include file type mentions if applicable\n\n4. **Tool Requirements**:\n   - Read-only tasks ‚Üí `Read, Grep, Glob`\n   - Generation tasks ‚Üí `Read, Write, Glob`\n   - Command/build tasks ‚Üí `Read, Write, Bash`\n   - Complex workflows ‚Üí No restrictions\n\n5. **Output Format Selection**:\n   - Review/Check ‚Üí Report with issues and fixes\n   - Generate ‚Üí File creation confirmation with examples\n   - Analyze ‚Üí Metrics report with visualizations\n   - Refactor ‚Üí Proposal with before/after\n   - Test ‚Üí Test results and coverage report\n   - Document ‚Üí Generated documentation preview\n\n### Step 2: Smart Question Strategy\n\n**Only ask if truly ambiguous:**\n- Multiple valid approaches? ‚Üí Ask which approach\n- Unclear scope? ‚Üí Ask for scope clarification\n- Critical choices? ‚Üí Ask for user preference\n\n**Never ask if inferable:**\n- Skill name ‚Üí Auto-generate from request\n- Basic tools ‚Üí Auto-select based on task type\n- Common triggers ‚Üí Auto-generate from context\n- Output format ‚Üí Auto-select based on skill type\n\n### Step 3: Auto-Generate Skill Structure\n\n**Automatically create complete skill with:**\n\n#### Auto-Generated Skill Name\nFormat: `[technology]-[action]`\nExamples:\n- \"check iOS naming\" ‚Üí `ios-naming-check`\n- \"generate React component\" ‚Üí `react-component-generator`\n- \"analyze dependencies\" ‚Üí `dependency-analyzer`\n\n#### Auto-Generated Description\nTemplate:\n```\n[Verb] [what] [context]. [Specifics]. Use when [trigger1], [trigger2], \"[quoted phrases]\", or [patterns].\n```\n\nAuto-include:\n- Specific action extracted from request\n- What it checks/generates/analyzes\n- Trigger phrases derived from user's language\n- File types if mentioned\n- Natural language variations\n\n#### Auto-Selected Tools\nBased on detected task type:\n- Review/Check ‚Üí `Read, Grep, Glob`\n- Generate ‚Üí `Read, Write, Glob`\n- Analyze with commands ‚Üí `Read, Grep, Glob, Bash`\n- Refactor ‚Üí `Read, Write, Grep, Glob`\n- Test with execution ‚Üí `Read, Write, Bash`\n\n#### Auto-Generated Content Structure\n\nSelect appropriate template based on task type (from templates.md):\n- Code Review ‚Üí Template 1\n- Code Generator ‚Üí Template 2\n- Analyzer/Reporter ‚Üí Template 3\n- Refactoring Assistant ‚Üí Template 4\n- Test Assistant ‚Üí Template 5\n- Documentation Generator ‚Üí Template 6\n\nPopulate template with:\n- Auto-generated name, description, tools\n- Task-specific process steps\n- Relevant output format\n- Examples from similar skills (from examples.md)\n\n### Step 4: Generate and Validate\n\n**Auto-create directory structure:**\n```bash\nmkdir -p .claude/skills/[auto-generated-name]\n```\n\n**Auto-generate files:**\n\n1. **`SKILL.md`** (Required, Concise)\n   - Frontmatter (name, description, allowed-tools)\n   - When to Activate (trigger phrases)\n   - Process steps (core workflow)\n   - Output format (template structure)\n   - Keep under 150 lines - core instructions only!\n\n2. **`templates.md`** (Optional, for code/structure templates)\n   - Code templates\n   - File structure templates\n   - Boilerplate examples\n   - Use when skill generates code or files\n\n3. **`examples.md`** (Optional, for detailed examples)\n   - Real-world usage examples\n   - Before/after code samples\n   - Complex scenarios\n   - Use when skill needs detailed guidance\n\n4. **`standards.md`** (Optional, for rules/guidelines)\n   - Coding standards\n   - Naming conventions\n   - Best practices\n   - Reference documentation\n   - Use when skill enforces specific rules\n\n**Separation principle:**\n- SKILL.md = Concise instructions (what to do, how to do it)\n- Separate files = Supporting details (templates, examples, references)\n\n**Auto-validate:**\n- ‚úì Valid YAML frontmatter with `---` delimiters\n- ‚úì Name lowercase with hyphens\n- ‚úì Description specific with quoted triggers\n- ‚úì Tools appropriate for task type\n- ‚úì Process steps clear and actionable\n- ‚úì SKILL.md concise (under 150 lines)\n- ‚úì Extra content moved to separate files\n\n### Step 5: Present and Test\n\n**Show user:**\n```markdown\n‚úÖ Created skill: [name]\n\nüìÅ Location: `.claude/skills/[name]/SKILL.md`\n\nüéØ Try these phrases:\n- \"[trigger phrase 1]\"\n- \"[trigger phrase 2]\"\n- \"[trigger phrase 3]\"\n\nüìñ Description: [generated description]\n```\n\n## Quick Reference: Task Types\n\n| Type | Tools | Output | Example Name |\n|------|-------|--------|--------------|\n| Review | Read, Grep, Glob | Issues report | `security-review` |\n| Generator | Read, Write, Glob | New files | `component-generator` |\n| Analyzer | Read, Grep, Glob, Bash | Metrics report | `dependency-analyzer` |\n| Refactor | Read, Write, Grep, Glob | Modified files | `extract-method` |\n| Test | Read, Write, Bash | Test results | `test-runner` |\n| Document | Read, Write, Glob | Documentation | `api-docs-generator` |\n\n## Auto-Generation Examples\n\n### Example 1: User says \"create a skill to check TODO comments\"\n**Auto-analysis:**\n- Task type: Review (check/find)\n- Name: `todo-finder`\n- Tools: `Read, Grep, Glob`\n- Triggers: \"find todos\", \"check todos\", \"show todos\", \"list fixmes\"\n- Output: Report organized by priority\n\n**Action:** Auto-generate complete skill, create files, show confirmation\n\n### Example 2: User says \"I need to generate React components\"\n**Auto-analysis:**\n- Task type: Generator (create/generate)\n- Name: `react-component-generator`\n- Tools: `Read, Write, Glob`\n- Triggers: \"create component\", \"generate component\", \"new component\"\n- Output: Component files with tests\n\n**Action:** Auto-generate complete skill, create files, show confirmation\n\n### Example 3: User says \"make a skill for iOS performance issues\"\n**Auto-analysis:**\n- Task type: Analyzer (check performance)\n- Name: `ios-performance-check`\n- Tools: `Read, Grep, Glob, Bash`\n- Triggers: \"check performance\", \"performance issues\", \"slow code\"\n- Output: Performance report with fixes\n\n**Action:** Auto-generate complete skill, create files, show confirmation\n\n## Standard Workflow\n\nWhen user requests a skill:\n\n1. **Analyze** request ‚Üí Detect task type, extract key concepts\n2. **Generate** skill name, description, triggers automatically\n3. **Select** appropriate template and tools\n4. **Create** `.claude/skills/[name]/SKILL.md` with complete content\n5. **Validate** frontmatter, structure, triggers\n6. **Present** summary with test phrases\n\n**No questions asked unless truly ambiguous!**\n\n## Creation Output Format\n\nAfter auto-generating skill, show:\n\n```markdown\n‚úÖ Skill Created: [name]\n\nüìÅ Files created:\n  - `.claude/skills/[name]/SKILL.md` (core instructions)\n  - `.claude/skills/[name]/templates.md` (if applicable)\n  - `.claude/skills/[name]/examples.md` (if applicable)\n  - `.claude/skills/[name]/standards.md` (if applicable)\n\nüîß Type: [task-type]\nüõ†Ô∏è  Tools: [tool-list]\nüìÑ Lines: [line-count] (SKILL.md is concise!)\n\nüéØ Test with these phrases:\n- \"[natural trigger 1]\"\n- \"[natural trigger 2]\"\n- \"[natural trigger 3]\"\n\nüìñ Full description:\n[Generated description with all triggers]\n\n‚úÖ Ready to use! Try one of the test phrases above.\n```\n\n## Internal References\n\nUse these for generation (don't show to user):\n- **templates.md**: 6 skill templates for different task types\n- **examples.md**: 5 complete real-world examples\n- **Official documentation**: https://code.claude.com/docs/en/skills\n\n## Key Principles\n\n1. **Be autonomous**: Infer everything possible from the user's request\n2. **Ask minimally**: Only ask if genuinely ambiguous (approach, scope, critical choices)\n3. **Generate completely**: Create full SKILL.md with all sections\n4. **Validate automatically**: Check frontmatter, structure, triggers before presenting\n5. **Present clearly**: Show what was created and how to test it\n\n## Important Rules\n\n### Auto-Generation\n- **Auto-generate** skill name from request (lowercase-with-hyphens)\n- **Auto-detect** task type to select template and tools\n- **Auto-extract** trigger phrases from user's language\n- **Auto-create** description with specific triggers in quotes\n- **Auto-select** appropriate tools based on task type\n\n### Quality Standards\n- **No generic names**: Always use specific technology/action names\n- **No vague descriptions**: Always include specific triggers and file types\n- **Valid YAML**: Always use `---` delimiters and proper frontmatter format\n  - `allowed-tools` must be comma-separated (e.g., `Read, Write, Glob`) not array format\n\n### File Organization\n- **SKILL.md must be concise**: Under 150 lines, core instructions only\n- **Separate templates**: Move code templates to `templates.md`\n- **Separate examples**: Move detailed examples to `examples.md`\n- **Separate standards**: Move rules/guidelines to `standards.md`\n- **Clear separation**: Instructions in SKILL.md, details in other files\n\n---\n\n**Ready for autonomous skill generation!** Just tell me what skill you need."
              }
            ]
          }
        ]
      }
    }
  ]
}