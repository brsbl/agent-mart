{
  "owner": {
    "id": "towns-protocol",
    "display_name": "Towns Protocol",
    "type": "Organization",
    "avatar_url": "https://avatars.githubusercontent.com/u/160541617?v=4",
    "url": "https://github.com/towns-protocol",
    "bio": "Towns Protocol is an open-source, decentralized encrypted chat protocol with an EVM L2 chain + custom chat nodes, smart contracts, and on-chain memberships.",
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 1,
      "total_stars": 0,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "towns-protocol/skills",
      "url": "https://github.com/towns-protocol/skills",
      "description": "Towns Protocol skills for AI Agents",
      "homepage": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-12T10:38:23Z",
        "created_at": "2026-01-05T20:57:26Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 254
        },
        {
          "path": ".claude-plugin/plugin.json",
          "type": "blob",
          "size": 376
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 2022
        },
        {
          "path": "skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/bots",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/bots/SKILL.md",
          "type": "blob",
          "size": 7691
        },
        {
          "path": "skills/bots/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/bots/references/BLOCKCHAIN.md",
          "type": "blob",
          "size": 2813
        },
        {
          "path": "skills/bots/references/DEBUGGING.md",
          "type": "blob",
          "size": 3441
        },
        {
          "path": "skills/bots/references/DEPLOYMENT.md",
          "type": "blob",
          "size": 2390
        },
        {
          "path": "skills/bots/references/INTERACTIVE.md",
          "type": "blob",
          "size": 2637
        },
        {
          "path": "skills/bots/references/MESSAGING.md",
          "type": "blob",
          "size": 1725
        }
      ],
      "marketplace": {
        "name": "towns-skills",
        "version": null,
        "description": null,
        "owner_info": {
          "name": "Towns Labs"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "towns",
            "description": "Comprehensive skill for creating Towns Protocol bots with @towns-protocol/bot SDK",
            "source": "./",
            "category": null,
            "version": null,
            "author": null,
            "install_commands": [
              "/plugin marketplace add towns-protocol/skills",
              "/plugin install towns@towns-skills"
            ],
            "signals": {
              "stars": 0,
              "forks": 0,
              "pushed_at": "2026-01-12T10:38:23Z",
              "created_at": "2026-01-05T20:57:26Z",
              "license": null
            },
            "commands": [],
            "skills": [
              {
                "name": "bots",
                "description": "Use when building Towns Protocol bots - covers SDK initialization, slash commands, message handlers, reactions, interactive forms, blockchain operations, and deployment. Triggers: \"towns bot\", \"makeTownsBot\", \"onSlashCommand\", \"onMessage\", \"sendInteractionRequest\", \"webhook\", \"bot deployment\", \"@towns-protocol/bot\"",
                "path": "skills/bots/SKILL.md",
                "frontmatter": {
                  "name": "bots",
                  "description": "Use when building Towns Protocol bots - covers SDK initialization, slash commands, message handlers, reactions, interactive forms, blockchain operations, and deployment. Triggers: \"towns bot\", \"makeTownsBot\", \"onSlashCommand\", \"onMessage\", \"sendInteractionRequest\", \"webhook\", \"bot deployment\", \"@towns-protocol/bot\"",
                  "license": "MIT",
                  "compatibility": "Requires Bun runtime, Base network RPC access, @towns-protocol/bot SDK",
                  "metadata": {
                    "author": "towns-protocol",
                    "version": "2.0.0"
                  }
                },
                "content": "# Towns Protocol Bot SDK Reference\n\n## Critical Rules\n\n**MUST follow these rules - violations cause silent failures:**\n\n1. **User IDs are Ethereum addresses** - Always `0x...` format, never usernames\n2. **Mentions require BOTH** - `<@{userId}>` format in text AND `mentions` array in options\n3. **Two-wallet architecture**:\n   - `bot.viem.account.address` = Gas wallet (signs & pays fees) - **MUST fund with Base ETH**\n   - `bot.appAddress` = Treasury (optional, for transfers)\n4. **Slash commands DON'T trigger onMessage** - They're exclusive handlers\n5. **Interactive forms use `type` property** - Not `case` (e.g., `type: 'form'`)\n6. **Never trust txHash alone** - Verify `receipt.status === 'success'` before granting access\n\n## Quick Reference\n\n### Key Imports\n\n```typescript\nimport { makeTownsBot, getSmartAccountFromUserId } from '@towns-protocol/bot'\nimport type { BotCommand, BotHandler } from '@towns-protocol/bot'\nimport { Permission } from '@towns-protocol/web3'\nimport { parseEther, formatEther, erc20Abi, zeroAddress } from 'viem'\nimport { readContract, waitForTransactionReceipt } from 'viem/actions'\nimport { execute } from 'viem/experimental/erc7821'\n```\n\n### Handler Methods\n\n| Method | Signature | Notes |\n|--------|-----------|-------|\n| `sendMessage` | `(channelId, text, opts?) â†’ { eventId }` | opts: `{ threadId?, replyId?, mentions?, attachments? }` |\n| `editMessage` | `(channelId, eventId, text)` | Bot's own messages only |\n| `removeEvent` | `(channelId, eventId)` | Bot's own messages only |\n| `sendReaction` | `(channelId, messageId, emoji)` | |\n| `sendInteractionRequest` | `(channelId, payload)` | Forms, transactions, signatures |\n| `hasAdminPermission` | `(userId, spaceId) â†’ boolean` | |\n| `ban` / `unban` | `(userId, spaceId)` | Needs ModifyBanning permission |\n\n### Bot Properties\n\n| Property | Description |\n|----------|-------------|\n| `bot.viem` | Viem client for blockchain |\n| `bot.viem.account.address` | Gas wallet - **MUST fund with Base ETH** |\n| `bot.appAddress` | Treasury wallet (optional) |\n| `bot.botId` | Bot identifier |\n\n**For detailed guides, see [references/](references/):**\n- [Messaging API](references/MESSAGING.md) - Mentions, threads, attachments, formatting\n- [Blockchain Operations](references/BLOCKCHAIN.md) - Read/write contracts, verify transactions\n- [Interactive Components](references/INTERACTIVE.md) - Forms, transaction requests\n- [Deployment](references/DEPLOYMENT.md) - Local dev, Render, tunnels\n- [Debugging](references/DEBUGGING.md) - Troubleshooting guide\n\n---\n\n## Bot Setup\n\n### Project Initialization\n\n```bash\nbunx towns-bot init my-bot\ncd my-bot\nbun install\n```\n\n### Environment Variables\n\n```bash\nAPP_PRIVATE_DATA=<base64_credentials>   # From app.towns.com/developer\nJWT_SECRET=<webhook_secret>              # Min 32 chars\nPORT=3000\nBASE_RPC_URL=https://base-mainnet.g.alchemy.com/v2/KEY  # Recommended\n```\n\n### Basic Bot Template\n\n```typescript\nimport { makeTownsBot } from '@towns-protocol/bot'\nimport type { BotCommand } from '@towns-protocol/bot'\n\nconst commands = [\n  { name: 'help', description: 'Show help' },\n  { name: 'ping', description: 'Check if alive' }\n] as const satisfies BotCommand[]\n\nconst bot = await makeTownsBot(\n  process.env.APP_PRIVATE_DATA!,\n  process.env.JWT_SECRET!,\n  { commands }\n)\n\nbot.onSlashCommand('ping', async (handler, event) => {\n  const latency = Date.now() - event.createdAt.getTime()\n  await handler.sendMessage(event.channelId, 'Pong! ' + latency + 'ms')\n})\n\nexport default bot.start()\n```\n\n### Config Validation\n\n```typescript\nimport { z } from 'zod'\n\nconst EnvSchema = z.object({\n  APP_PRIVATE_DATA: z.string().min(1),\n  JWT_SECRET: z.string().min(32),\n  DATABASE_URL: z.string().url().optional()\n})\n\nconst env = EnvSchema.safeParse(process.env)\nif (!env.success) {\n  console.error('Invalid config:', env.error.issues)\n  process.exit(1)\n}\n```\n\n---\n\n## Event Handlers\n\n### onMessage\n\nTriggers on regular messages (NOT slash commands).\n\n```typescript\nbot.onMessage(async (handler, event) => {\n  // event: { userId, spaceId, channelId, eventId, message, isMentioned, threadId?, replyId? }\n\n  if (event.isMentioned) {\n    await handler.sendMessage(event.channelId, 'You mentioned me!')\n  }\n})\n```\n\n### onSlashCommand\n\nTriggers on `/command`. Does NOT trigger onMessage.\n\n```typescript\nbot.onSlashCommand('weather', async (handler, { args, channelId }) => {\n  // /weather San Francisco â†’ args: ['San', 'Francisco']\n  const location = args.join(' ')\n  if (!location) {\n    await handler.sendMessage(channelId, 'Usage: /weather <location>')\n    return\n  }\n  // ... fetch weather\n})\n```\n\n### onReaction\n\n```typescript\nbot.onReaction(async (handler, event) => {\n  // event: { reaction, messageId, channelId }\n  if (event.reaction === 'ðŸ‘‹') {\n    await handler.sendMessage(event.channelId, 'I saw your wave!')\n  }\n})\n```\n\n### onTip\n\nRequires \"All Messages\" mode in Developer Portal.\n\n```typescript\nbot.onTip(async (handler, event) => {\n  // event: { senderAddress, receiverAddress, amount (bigint), currency }\n  if (event.receiverAddress === bot.appAddress) {\n    await handler.sendMessage(event.channelId,\n      'Thanks for ' + formatEther(event.amount) + ' ETH!')\n  }\n})\n```\n\n### onInteractionResponse\n\n```typescript\nbot.onInteractionResponse(async (handler, event) => {\n  switch (event.response.payload.content?.case) {\n    case 'form':\n      const form = event.response.payload.content.value\n      for (const c of form.components) {\n        if (c.component.case === 'button' && c.id === 'yes') {\n          await handler.sendMessage(event.channelId, 'You clicked Yes!')\n        }\n      }\n      break\n    case 'transaction':\n      const tx = event.response.payload.content.value\n      if (tx.txHash) {\n        // IMPORTANT: Verify on-chain before granting access\n        // See references/BLOCKCHAIN.md for full verification pattern\n        await handler.sendMessage(event.channelId,\n          'TX: https://basescan.org/tx/' + tx.txHash)\n      }\n      break\n  }\n})\n```\n\n### Event Context Validation\n\nAlways validate context before using:\n\n```typescript\nbot.onSlashCommand('cmd', async (handler, event) => {\n  if (!event.spaceId || !event.channelId) {\n    console.error('Missing context:', { userId: event.userId })\n    return\n  }\n  // Safe to proceed\n})\n```\n\n---\n\n## Common Mistakes\n\n| Mistake | Fix |\n|---------|-----|\n| `insufficient funds for gas` | Fund `bot.viem.account.address` with Base ETH |\n| Mention not highlighting | Include BOTH `<@userId>` in text AND `mentions` array |\n| Slash command not working | Add to `commands` array in makeTownsBot |\n| Handler not triggering | Check message forwarding mode in Developer Portal |\n| `writeContract` failing | Use `execute()` for external contracts |\n| Granting access on txHash | Verify `receipt.status === 'success'` first |\n| Message lines overlapping | Use `\\n\\n` (double newlines), not `\\n` |\n| Missing event context | Validate `spaceId`/`channelId` before using |\n\n---\n\n## Resources\n\n- **Developer Portal**: https://app.towns.com/developer\n- **Documentation**: https://docs.towns.com/build/bots\n- **SDK**: https://www.npmjs.com/package/@towns-protocol/bot\n- **Chain ID**: 8453 (Base Mainnet)"
              }
            ]
          }
        ]
      }
    }
  ]
}