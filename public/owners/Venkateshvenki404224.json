{
  "owner": {
    "id": "Venkateshvenki404224",
    "display_name": "Venkatesh",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/75518037?u=c52635a32b04ef6e483a127fcd24c128fff1c366&v=4",
    "url": "https://github.com/Venkateshvenki404224",
    "bio": "üöÄ Backend Engineer | üß† Open Source Contributor | ‚öôÔ∏è Frappe & ERPNext Expert | üî¨ Lab Infra Builder | üëï Founder @gemzy.in | üí° Building Dev Tools",
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 15,
      "total_skills": 15,
      "total_stars": 4,
      "total_forks": 2
    }
  },
  "repos": [
    {
      "full_name": "Venkateshvenki404224/frappe-apps-manager",
      "url": "https://github.com/Venkateshvenki404224/frappe-apps-manager",
      "description": "A comprehensive Claude Code plugin for Frappe Framework development, providing tools, commands, agents, and Skills to streamline your Frappe application development workflow.",
      "homepage": "",
      "signals": {
        "stars": 4,
        "forks": 2,
        "pushed_at": "2025-12-15T15:40:13Z",
        "created_at": "2025-12-15T14:39:32Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 642
        },
        {
          "path": ".gitignore",
          "type": "blob",
          "size": 446
        },
        {
          "path": "CHANGELOG.md",
          "type": "blob",
          "size": 5055
        },
        {
          "path": "CLAUDE.md",
          "type": "blob",
          "size": 11970
        },
        {
          "path": "INSTALLATION.md",
          "type": "blob",
          "size": 10383
        },
        {
          "path": "LICENSE",
          "type": "blob",
          "size": 1085
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 14042
        },
        {
          "path": "WHATS_NEW_V2.md",
          "type": "blob",
          "size": 9277
        },
        {
          "path": "frappe-apps-manager",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 499
        },
        {
          "path": "frappe-apps-manager/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/agents/frappe-architect.md",
          "type": "blob",
          "size": 6702
        },
        {
          "path": "frappe-apps-manager/agents/frappe-data-engineer.md",
          "type": "blob",
          "size": 10330
        },
        {
          "path": "frappe-apps-manager/agents/frappe-debugger.md",
          "type": "blob",
          "size": 4916
        },
        {
          "path": "frappe-apps-manager/agents/frappe-developer.md",
          "type": "blob",
          "size": 3562
        },
        {
          "path": "frappe-apps-manager/agents/frappe-devops.md",
          "type": "blob",
          "size": 10676
        },
        {
          "path": "frappe-apps-manager/agents/frappe-integration.md",
          "type": "blob",
          "size": 11712
        },
        {
          "path": "frappe-apps-manager/agents/frappe-performance.md",
          "type": "blob",
          "size": 10766
        },
        {
          "path": "frappe-apps-manager/agents/frappe-security.md",
          "type": "blob",
          "size": 11718
        },
        {
          "path": "frappe-apps-manager/agents/frappe-tester.md",
          "type": "blob",
          "size": 7291
        },
        {
          "path": "frappe-apps-manager/agents/frappe-ui-ux.md",
          "type": "blob",
          "size": 12112
        },
        {
          "path": "frappe-apps-manager/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/commands/frappe-backup.md",
          "type": "blob",
          "size": 1391
        },
        {
          "path": "frappe-apps-manager/commands/frappe-bench-start.md",
          "type": "blob",
          "size": 1271
        },
        {
          "path": "frappe-apps-manager/commands/frappe-cache.md",
          "type": "blob",
          "size": 8411
        },
        {
          "path": "frappe-apps-manager/commands/frappe-config.md",
          "type": "blob",
          "size": 9744
        },
        {
          "path": "frappe-apps-manager/commands/frappe-console.md",
          "type": "blob",
          "size": 8990
        },
        {
          "path": "frappe-apps-manager/commands/frappe-db-reset.md",
          "type": "blob",
          "size": 9209
        },
        {
          "path": "frappe-apps-manager/commands/frappe-deploy.md",
          "type": "blob",
          "size": 1690
        },
        {
          "path": "frappe-apps-manager/commands/frappe-install-app.md",
          "type": "blob",
          "size": 1133
        },
        {
          "path": "frappe-apps-manager/commands/frappe-logs.md",
          "type": "blob",
          "size": 10723
        },
        {
          "path": "frappe-apps-manager/commands/frappe-migrate.md",
          "type": "blob",
          "size": 1358
        },
        {
          "path": "frappe-apps-manager/commands/frappe-new-app.md",
          "type": "blob",
          "size": 1082
        },
        {
          "path": "frappe-apps-manager/commands/frappe-new-doctype.md",
          "type": "blob",
          "size": 1640
        },
        {
          "path": "frappe-apps-manager/commands/frappe-new-site.md",
          "type": "blob",
          "size": 7831
        },
        {
          "path": "frappe-apps-manager/commands/frappe-role-manager.md",
          "type": "blob",
          "size": 9787
        },
        {
          "path": "frappe-apps-manager/commands/frappe-test.md",
          "type": "blob",
          "size": 11929
        },
        {
          "path": "frappe-apps-manager/hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/hooks/hooks.json",
          "type": "blob",
          "size": 3267
        },
        {
          "path": "frappe-apps-manager/output-styles",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/output-styles/frappe-commit.md",
          "type": "blob",
          "size": 11030
        },
        {
          "path": "frappe-apps-manager/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-api-handler",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-api-handler/SKILL.md",
          "type": "blob",
          "size": 9889
        },
        {
          "path": "frappe-apps-manager/skills/frappe-client-script-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-client-script-generator/SKILL.md",
          "type": "blob",
          "size": 17650
        },
        {
          "path": "frappe-apps-manager/skills/frappe-data-migration-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-data-migration-generator/SKILL.md",
          "type": "blob",
          "size": 2945
        },
        {
          "path": "frappe-apps-manager/skills/frappe-doctype-builder",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-doctype-builder/SKILL.md",
          "type": "blob",
          "size": 5808
        },
        {
          "path": "frappe-apps-manager/skills/frappe-documentation-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-documentation-generator/SKILL.md",
          "type": "blob",
          "size": 4757
        },
        {
          "path": "frappe-apps-manager/skills/frappe-external-api-connector",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-external-api-connector/SKILL.md",
          "type": "blob",
          "size": 3950
        },
        {
          "path": "frappe-apps-manager/skills/frappe-fixture-creator",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-fixture-creator/SKILL.md",
          "type": "blob",
          "size": 2260
        },
        {
          "path": "frappe-apps-manager/skills/frappe-integration-test-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-integration-test-generator/SKILL.md",
          "type": "blob",
          "size": 3249
        },
        {
          "path": "frappe-apps-manager/skills/frappe-performance-optimizer",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-performance-optimizer/SKILL.md",
          "type": "blob",
          "size": 2898
        },
        {
          "path": "frappe-apps-manager/skills/frappe-report-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-report-generator/SKILL.md",
          "type": "blob",
          "size": 12949
        },
        {
          "path": "frappe-apps-manager/skills/frappe-state-machine-helper",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-state-machine-helper/SKILL.md",
          "type": "blob",
          "size": 2854
        },
        {
          "path": "frappe-apps-manager/skills/frappe-unit-test-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-unit-test-generator/SKILL.md",
          "type": "blob",
          "size": 20359
        },
        {
          "path": "frappe-apps-manager/skills/frappe-web-form-builder",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-web-form-builder/SKILL.md",
          "type": "blob",
          "size": 2832
        },
        {
          "path": "frappe-apps-manager/skills/frappe-webhook-manager",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-webhook-manager/SKILL.md",
          "type": "blob",
          "size": 3163
        },
        {
          "path": "frappe-apps-manager/skills/frappe-workflow-generator",
          "type": "tree",
          "size": null
        },
        {
          "path": "frappe-apps-manager/skills/frappe-workflow-generator/SKILL.md",
          "type": "blob",
          "size": 3211
        }
      ],
      "marketplace": {
        "name": "frappe-marketplace",
        "version": null,
        "description": "Official marketplace for Frappe Framework development tools and plugins",
        "owner_info": {
          "name": "Frappe Development Community"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "frappe-apps-manager",
            "description": "Comprehensive Frappe Framework development platform with 95% SDLC coverage - 15 commands, 10 agents, 15 skills for complete Frappe/ERPNext development lifecycle",
            "source": "./frappe-apps-manager",
            "category": null,
            "version": "2.0.0",
            "author": null,
            "install_commands": [
              "/plugin marketplace add Venkateshvenki404224/frappe-apps-manager",
              "/plugin install frappe-apps-manager@frappe-marketplace"
            ],
            "signals": {
              "stars": 4,
              "forks": 2,
              "pushed_at": "2025-12-15T15:40:13Z",
              "created_at": "2025-12-15T14:39:32Z",
              "license": "MIT"
            },
            "commands": [
              {
                "name": "/frappe-backup",
                "description": "Backup Frappe site data and files",
                "path": "frappe-apps-manager/commands/frappe-backup.md",
                "frontmatter": {
                  "description": "Backup Frappe site data and files"
                },
                "content": "# Frappe Backup Command\n\nCreate comprehensive backups of Frappe sites:\n\n1. **Verify bench directory**: Ensure we're in a Frappe bench\n2. **List sites**: Display all available sites\n3. **Get backup details**:\n   - Site name to backup\n   - Backup type (database only, files only, or both)\n   - Whether to include private files\n   - Whether to include public files\n   - Compression preference\n4. **Backup options**: Explain and offer:\n   - Regular backup: `bench --site <site-name> backup`\n   - With files: `bench --site <site-name> backup --with-files`\n   - Verbose output: Add `--verbose` flag\n   - Backup to specific path: `--backup-path-db` and `--backup-path-files`\n5. **Execute backup**: Run the selected backup command\n6. **Verify backup**: Check that backup files were created:\n   - Database backup (.sql.gz)\n   - Private files backup (if requested)\n   - Public files backup (if requested)\n7. **Display backup information**:\n   - Backup file locations\n   - Backup file sizes\n   - Timestamp of backup\n   - Retention policy reminder\n8. **Post-backup suggestions**:\n   - Recommend offsite backup storage\n   - Suggest automated backup scheduling\n   - Provide restore command reference\n   - Mention S3/cloud backup options\n\n**Best practices**: Remind users about the 3-2-1 backup rule and the importance of testing restore procedures."
              },
              {
                "name": "/frappe-bench-start",
                "description": "Start Frappe bench with proper configuration",
                "path": "frappe-apps-manager/commands/frappe-bench-start.md",
                "frontmatter": {
                  "description": "Start Frappe bench with proper configuration"
                },
                "content": "# Frappe Bench Start Command\n\nStart the Frappe bench development server with appropriate configuration:\n\n1. **Verify bench directory**: Ensure we're in a valid Frappe bench directory\n2. **Check for running processes**: Look for any existing bench processes and warn the user\n3. **Configuration options**: Ask the user about startup preferences:\n   - Port number (default: 8000)\n   - Whether to run in debug mode\n   - Whether to use a specific site\n   - Whether to enable auto-reload\n4. **Pre-start checks**:\n   - Verify Redis is running\n   - Check MariaDB/PostgreSQL connection\n   - Ensure all required services are available\n5. **Start bench**: Run the appropriate command:\n   - `bench start` for full stack (web, worker, socketio, schedule)\n   - `bench serve` for just the web server\n   - `bench --site <site-name> serve` for specific site\n6. **Post-start information**:\n   - Display the URL where the site is accessible\n   - Show how to access different sites\n   - Provide instructions for stopping the server\n   - Mention how to view logs\n\n**Additional tips**: Inform users about common development workflows like running background workers separately, using VS Code debugger, or accessing the desk."
              },
              {
                "name": "/frappe-cache",
                "description": "Manage Redis cache - clear, monitor, and optimize Frappe cache performance",
                "path": "frappe-apps-manager/commands/frappe-cache.md",
                "frontmatter": {
                  "description": "Manage Redis cache - clear, monitor, and optimize Frappe cache performance"
                },
                "content": "# Frappe Cache Command\n\nManage Frappe's Redis cache including clearing cache, monitoring cache statistics, and optimizing cache performance.\n\n## Steps to Execute\n\n### 1. Verify Environment\n- Check if in valid Frappe bench\n- Verify Redis is running: `redis-cli ping`\n- Check site exists\n\n### 2. Cache Operation Selection\n\nAsk user what cache operation they want:\n\n**A. Clear Cache**\n- Clear all cache\n- Clear specific doctype cache\n- Clear user-specific cache\n- Clear specific cache keys\n\n**B. View Cache Stats**\n- Cache size and memory usage\n- Hit/miss ratio\n- Key count\n- Expiration info\n\n**C. Inspect Cache**\n- List cache keys\n- View specific key values\n- Search cache keys by pattern\n\n**D. Monitor Cache**\n- Real-time cache monitoring\n- Performance metrics\n- Memory usage trends\n\n### 3. Clear Cache Operations\n\n**Clear All Cache:**\n```bash\nbench --site [site-name] clear-cache\n```\n\n**Clear Specific DocType:**\n```bash\nbench --site [site-name] console\n>>> frappe.clear_cache(doctype='Customer')\n>>> exit()\n```\n\n**Clear User Cache:**\n```bash\n# Via console\nbench --site [site-name] console\n>>> frappe.clear_cache(user='user@example.com')\n```\n\n**Clear Specific Keys:**\n```bash\n# Via Redis CLI\nredis-cli --scan --pattern \"*customer*\" | xargs redis-cli del\n```\n\n### 4. Cache Statistics\n\n**View Cache Info:**\n```bash\nredis-cli info memory\nredis-cli info stats\n```\n\nDisplay formatted output:\n```\nMemory Usage: 45.2 MB / 512 MB (8.8%)\nTotal Keys: 1,247\nHit Rate: 87.3%\nEvictions: 12\n```\n\n**Key Count by Pattern:**\n```bash\n# Count DocType cache keys\nredis-cli --scan --pattern \"*doctype*\" | wc -l\n\n# Count user cache keys\nredis-cli --scan --pattern \"*user*\" | wc -l\n```\n\n### 5. Cache Inspection\n\n**List Recent Keys:**\n```bash\nredis-cli --scan --pattern \"*\" | head -20\n```\n\n**View Key Value:**\n```bash\nredis-cli get \"cache_key_name\"\n```\n\n**Check Key TTL:**\n```bash\nredis-cli ttl \"cache_key_name\"\n```\n\n**Search Keys:**\n```bash\n# Find keys matching pattern\nredis-cli --scan --pattern \"*customer*\"\n```\n\n### 6. Cache Monitoring\n\n**Monitor in Real-time:**\n```bash\nredis-cli monitor\n```\n\n**Watch Stats:**\n```bash\nwatch -n 1 redis-cli info stats\n```\n\n**Memory Usage:**\n```bash\nredis-cli info memory | grep used_memory_human\n```\n\n### 7. Cache Optimization Suggestions\n\nAnalyze cache usage and suggest optimizations:\n\n**High Memory Usage:**\n- Review cache key patterns\n- Set appropriate TTL values\n- Identify large cached objects\n- Suggest cache eviction policies\n\n**Low Hit Rate:**\n- Identify frequently missed keys\n- Suggest pre-warming strategies\n- Review caching logic in code\n- Optimize cache key design\n\n**Too Many Keys:**\n- Identify unused patterns\n- Suggest cleanup strategies\n- Review cache key naming\n\n### 8. Frappe-Specific Cache Operations\n\n**Cache Patterns in Frappe:**\n```python\n# In bench console\nfrappe.cache().get_value('key')\nfrappe.cache().set_value('key', 'value', expires_in_sec=3600)\nfrappe.cache().delete_key('key')\nfrappe.cache().delete_keys('key*')\n```\n\n**Common Cache Keys:**\n- `doctype_meta:[DocType]` - DocType metadata\n- `user_info:[user]` - User information\n- `permission:[doctype]:[user]` - Permission cache\n- `report:[report_name]` - Report cache\n- `home_page:[user]` - User home page\n\n### 9. Cache Best Practices\n\n**When to Clear Cache:**\n- After modifying DocType JSON\n- After changing permissions\n- After code deployment\n- When seeing stale data\n- After database schema changes\n\n**Selective Clearing:**\n```python\n# Clear only what's needed (via console)\nfrappe.clear_cache(doctype='Customer')  # Specific DocType\nfrappe.clear_cache(user='user@test.com')  # Specific user\nfrappe.cache().delete_keys('custom_cache_*')  # Pattern match\n```\n\n**Automatic Cache Clearing:**\n- Frappe auto-clears cache on DocType save\n- Automatic on permission changes\n- Can configure in hooks.py\n\n### 10. Troubleshooting Cache Issues\n\n**Common Problems:**\n\n**\"Stale Data Showing\"**\n```bash\n# Clear all cache\nbench --site [site-name] clear-cache\n\n# Reload DocType\nbench --site [site-name] console\n>>> frappe.reload_doctype('Customer')\n```\n\n**\"Redis Connection Error\"**\n```bash\n# Check Redis status\nredis-cli ping\n\n# Restart Redis\nsudo systemctl restart redis-server\n\n# Check Redis config in site_config.json\ncat sites/[site-name]/site_config.json | grep redis\n```\n\n**\"High Memory Usage\"**\n```bash\n# Find large keys\nredis-cli --bigkeys\n\n# Set memory limit in redis.conf\nmaxmemory 512mb\nmaxmemory-policy allkeys-lru\n```\n\n**\"Cache Not Working\"**\n```python\n# Verify cache is enabled\nbench --site [site-name] console\n>>> frappe.cache().get_value('test_key')\n>>> frappe.cache().set_value('test_key', 'test_value')\n>>> frappe.cache().get_value('test_key')  # Should return 'test_value'\n```\n\n## References\n\n### Frappe Core Cache Implementation (Primary Reference)\n\n**Frappe Cache Module:**\n- Cache Implementation: https://github.com/frappe/frappe/blob/develop/frappe/utils/redis_wrapper.py\n- Cache Manager: https://github.com/frappe/frappe/blob/develop/frappe/cache_manager.py\n- Clear Cache Function: https://github.com/frappe/frappe/blob/develop/frappe/__init__.py\n\n**ERPNext Cache Usage Examples:**\n- Item Price Caching: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/get_item_details.py\n- Report Caching: https://github.com/frappe/erpnext/tree/develop/erpnext/accounts/report\n\n**Real Cache Patterns from Core:**\n\n1. **Cache with TTL** (from ERPNext):\n```python\n# See: erpnext/stock/get_item_details.py\ndef get_price_list_rate(args):\n    cache_key = f\"price_list_rate:{args.item_code}:{args.price_list}\"\n    cached_rate = frappe.cache().get_value(cache_key)\n\n    if cached_rate:\n        return cached_rate\n\n    # Fetch from database\n    rate = frappe.db.get_value('Item Price', filters, 'price_list_rate')\n\n    # Cache for 1 hour\n    frappe.cache().set_value(cache_key, rate, expires_in_sec=3600)\n    return rate\n```\n\n2. **Cache Invalidation** (from Frappe Core):\n```python\n# See: frappe/model/document.py\ndef save(self):\n    # ... save logic ...\n\n    # Clear cache after save\n    frappe.clear_cache(doctype=self.doctype)\n    frappe.clear_document_cache(self.doctype, self.name)\n```\n\n3. **Global Cache** (from Frappe Core):\n```python\n# See: frappe/cache_manager.py\ndef clear_global_cache():\n    frappe.cache().delete_keys('*')\n    frappe.cache().delete_keys('global:*')\n```\n\n### Official Documentation (Secondary Reference)\n\n- Caching Guide: https://frappeframework.com/docs/user/en/api/cache\n- Redis Configuration: https://frappeframework.com/docs/user/en/bench/reference/redis\n- Performance: https://frappeframework.com/docs/user/en/performance\n\n## Advanced Cache Management\n\n### Cache Key Patterns\n\n**Frappe Standard Keys:**\n```\ndoctype_meta:{doctype}\nuser_info:{user_id}\ndefaults:{user}:{key}\npermission:{doctype}:{ptype}:{user}\nglobal:{key}\ntemp:{random}\n```\n\n### Cache Configuration\n\n**Site Config (site_config.json):**\n```json\n{\n  \"redis_cache\": \"redis://localhost:13000\",\n  \"redis_queue\": \"redis://localhost:11000\",\n  \"cache_ttl\": 3600\n}\n```\n\n**Redis Config (redis.conf):**\n```\nmaxmemory 512mb\nmaxmemory-policy allkeys-lru\nsave \"\"\nappendonly no\n```\n\n### Performance Optimization\n\n**Cache Hit Rate:**\n```bash\n# Monitor hit rate\nredis-cli info stats | grep keyspace\n```\n\n**Memory Efficiency:**\n```bash\n# Find memory hogs\nredis-cli --bigkeys\n\n# Sample random keys\nredis-cli --memkeys\n```\n\n### Custom Caching\n\n**In Your App:**\n```python\nfrom frappe.utils.caching import redis_cache\n\n@redis_cache(ttl=3600)\ndef expensive_operation(param):\n    # Automatically cached for 1 hour\n    return calculate_something(param)\n```\n\n## Important Notes\n\n- Cache clearing is safe - Frappe rebuilds as needed\n- User-specific cache clears on login/logout\n- DocType meta cache clears on save\n- Global cache clear affects all users\n- Redis restart clears all cache\n- Cache is primarily for read-heavy operations\n- Write operations should clear relevant cache\n- Use cache for expensive queries only\n\n## Monitoring Best Practices\n\n1. **Regular Health Checks:** Monitor cache hit rate\n2. **Memory Limits:** Set maxmemory in Redis config\n3. **Eviction Policy:** Use allkeys-lru for LRU eviction\n4. **Key Expiration:** Set appropriate TTL values\n5. **Pattern Analysis:** Monitor which keys are accessed most\n6. **Clear Strategically:** Don't clear all cache unnecessarily\n7. **Log Cache Operations:** Track cache performance in logs"
              },
              {
                "name": "/frappe-config",
                "description": "Configure Frappe site settings - manage site_config.json and environment variables",
                "path": "frappe-apps-manager/commands/frappe-config.md",
                "frontmatter": {
                  "description": "Configure Frappe site settings - manage site_config.json and environment variables"
                },
                "content": "# Frappe Config Command\n\nManage Frappe site configuration including site_config.json settings, environment variables, and feature flags.\n\n## Steps to Execute\n\n### 1. Verify Environment\n- Check if in valid Frappe bench\n- Verify site exists\n- Check site_config.json file exists\n\n### 2. Configuration Operation Selection\n\nAsk user what they want to configure:\n\n**A. View Current Config**\n- Display site_config.json\n- Show environment variables\n- List feature flags\n\n**B. Database Settings**\n- Configure MariaDB/PostgreSQL\n- Set connection parameters\n- Configure read replicas\n\n**C. Redis Settings**\n- Configure cache Redis\n- Configure queue Redis\n- Configure socketio Redis\n\n**D. Email Settings**\n- SMTP configuration\n- Email accounts\n- Outgoing email settings\n\n**E. Developer Settings**\n- Developer mode\n- Debug mode\n- Logging levels\n\n**F. Feature Flags**\n- Enable/disable features\n- Experimental features\n- Module toggles\n\n### 3. View Configuration\n\n**Display site_config.json:**\n```bash\ncat sites/[site-name]/site_config.json | jq .\n```\n\n**Get Specific Config:**\n```bash\nbench --site [site-name] console\n>>> frappe.conf.get('db_name')\n>>> frappe.conf.get('developer_mode')\n```\n\n**List All Configs:**\n```python\nimport json\nprint(json.dumps(frappe.conf, indent=2))\n```\n\n### 4. Set Configuration Values\n\n**Set Single Value:**\n```bash\nbench --site [site-name] set-config [key] [value]\n```\n\nExamples:\n```bash\n# Enable developer mode\nbench --site [site-name] set-config developer_mode 1\n\n# Set session timeout\nbench --site [site-name] set-config session_timeout 3600\n\n# Set file size limit\nbench --site [site-name] set-config max_file_size 10485760\n```\n\n**Set Multiple Values:**\n```python\n# Via console\nconfig_updates = {\n    'developer_mode': 1,\n    'allow_tests': 1,\n    'log_queries': 1\n}\n\nfor key, value in config_updates.items():\n    frappe.db.set_value('Website Settings', None, key, value)\n\nfrappe.db.commit()\n```\n\n### 5. Database Configuration\n\n**Database Settings:**\n```json\n{\n  \"db_name\": \"site_db\",\n  \"db_host\": \"localhost\",\n  \"db_port\": 3306,\n  \"db_type\": \"mariadb\",\n  \"db_socket\": \"/var/run/mysqld/mysqld.sock\"\n}\n```\n\n**Read Replica:**\n```json\n{\n  \"read_from_replica\": 1,\n  \"replica_host\": \"replica.example.com\",\n  \"replica_port\": 3306\n}\n```\n\n### 6. Redis Configuration\n\n**Redis Connection Settings:**\n```json\n{\n  \"redis_cache\": \"redis://localhost:13000\",\n  \"redis_queue\": \"redis://localhost:11000\",\n  \"redis_socketio\": \"redis://localhost:12000\"\n}\n```\n\n**Redis with Password:**\n```json\n{\n  \"redis_cache\": \"redis://:password@localhost:13000\",\n  \"redis_queue\": \"redis://:password@localhost:11000\"\n}\n```\n\n### 7. Email Configuration\n\n**SMTP Settings:**\n```bash\nbench --site [site-name] set-config mail_server \"smtp.gmail.com\"\nbench --site [site-name] set-config mail_port 587\nbench --site [site-name] set-config use_tls 1\nbench --site [site-name] set-config mail_login \"your-email@gmail.com\"\nbench --site [site-name] set-config mail_password \"app-password\"\n```\n\n**Email Configuration:**\n```json\n{\n  \"mail_server\": \"smtp.gmail.com\",\n  \"mail_port\": 587,\n  \"use_tls\": 1,\n  \"mail_login\": \"notifications@company.com\",\n  \"mail_password\": \"app-password\",\n  \"auto_email_id\": \"notifications@company.com\",\n  \"email_sender_name\": \"Company Notifications\"\n}\n```\n\n### 8. Developer Settings\n\n**Enable Developer Mode:**\n```bash\nbench --site [site-name] set-config developer_mode 1\nbench --site [site-name] clear-cache\n```\n\n**Developer Mode Features:**\n- Edit DocTypes via desk\n- Show debug toolbar\n- Detailed error messages\n- JavaScript/CSS hot reload\n- Query logging\n\n**Debug Settings:**\n```json\n{\n  \"developer_mode\": 1,\n  \"allow_tests\": 1,\n  \"log_queries\": 1,\n  \"logging\": 2,\n  \"auto_reload\": 1\n}\n```\n\n### 9. Performance Settings\n\n**Performance Configuration:**\n```json\n{\n  \"limits\": {\n    \"page_length\": 20,\n    \"posts_per_page\": 10\n  },\n  \"background_workers\": 4,\n  \"max_file_size\": 10485760,\n  \"enable_prepared_report\": 1,\n  \"global_search_doctypes\": [\"Customer\", \"Item\", \"Sales Invoice\"]\n}\n```\n\n**Caching Settings:**\n```json\n{\n  \"cache_ttl\": 3600,\n  \"enable_rate_limit\": 1,\n  \"rate_limit\": {\n    \"limit\": 100,\n    \"window\": 3600\n  }\n}\n```\n\n### 10. Security Settings\n\n**Security Configuration:**\n```json\n{\n  \"disable_signup\": 1,\n  \"deny_multiple_sessions\": 0,\n  \"session_timeout\": 14400,\n  \"session_expiry_mobile\": 604800,\n  \"password_reset_limit\": 3,\n  \"allow_cors\": \"*\",\n  \"ignore_csrf\": 0\n}\n```\n\n**SSL/HTTPS Settings:**\n```json\n{\n  \"force_https\": 1,\n  \"host_name\": \"https://mysite.com\",\n  \"redirect_to_https\": 1\n}\n```\n\n## References\n\n### Frappe Core Config Examples (Primary Reference)\n\n**Frappe Configuration Module:**\n- Config Loader: https://github.com/frappe/frappe/blob/develop/frappe/utils/data.py\n- Site Config: https://github.com/frappe/frappe/blob/develop/frappe/installer.py\n- Default Config: https://github.com/frappe/frappe/blob/develop/frappe/utils/install.py\n\n**Common Site Config from Bench:**\n- Bench Config: https://github.com/frappe/bench/blob/develop/bench/config/site_config.py\n- Production Config: https://github.com/frappe/bench/blob/develop/bench/config/production_setup.py\n\n**Real Config Patterns:**\n\n1. **Multi-Site Config** (common_site_config.json):\n```json\n{\n  \"db_host\": \"localhost\",\n  \"db_port\": 3306,\n  \"redis_cache\": \"redis://localhost:13000\",\n  \"redis_queue\": \"redis://localhost:11000\",\n  \"redis_socketio\": \"redis://localhost:12000\",\n  \"webserver_port\": 8000,\n  \"socketio_port\": 9000,\n  \"background_workers\": 1,\n  \"gunicorn_workers\": 4\n}\n```\n\n2. **Development Site Config**:\n```json\n{\n  \"db_name\": \"dev_site\",\n  \"db_password\": \"password\",\n  \"developer_mode\": 1,\n  \"allow_tests\": 1,\n  \"logging\": 2,\n  \"log_queries\": 1,\n  \"auto_reload\": 1,\n  \"disable_website_cache\": 1\n}\n```\n\n3. **Production Site Config**:\n```json\n{\n  \"db_name\": \"prod_site\",\n  \"db_password\": \"strong_password\",\n  \"developer_mode\": 0,\n  \"logging\": 1,\n  \"host_name\": \"https://example.com\",\n  \"force_https\": 1,\n  \"deny_multiple_sessions\": 1,\n  \"session_timeout\": 14400,\n  \"enable_rate_limit\": 1\n}\n```\n\n### Official Documentation (Secondary Reference)\n\n- Site Configuration: https://frappeframework.com/docs/user/en/basics/site_config\n- Bench Config: https://frappeframework.com/docs/user/en/bench/reference/config\n- Common Site Config: https://frappeframework.com/docs/user/en/bench/reference/common-site-config\n\n## Common Configuration Scenarios\n\n### Development Environment\n```bash\nbench --site dev.local set-config developer_mode 1\nbench --site dev.local set-config allow_tests 1\nbench --site dev.local set-config log_queries 1\nbench --site dev.local set-config auto_reload 1\nbench --site dev.local clear-cache\n```\n\n### Production Environment\n```bash\nbench --site prod.example.com set-config developer_mode 0\nbench --site prod.example.com set-config logging 1\nbench --site prod.example.com set-config deny_multiple_sessions 1\nbench --site prod.example.com set-config session_timeout 14400\nbench --site prod.example.com set-config enable_rate_limit 1\n```\n\n### Email Setup (Gmail)\n```bash\nbench --site [site-name] set-config mail_server \"smtp.gmail.com\"\nbench --site [site-name] set-config mail_port 587\nbench --site [site-name] set-config use_tls 1\nbench --site [site-name] set-config mail_login \"your-email@gmail.com\"\nbench --site [site-name] set-config mail_password \"app-specific-password\"\n```\n\n### Custom Domain\n```bash\nbench --site [site-name] set-config host_name \"https://example.com\"\nbench --site [site-name] set-config force_https 1\n```\n\n## Configuration Reference\n\n### Essential Settings\n\n| Setting | Description | Default | Environment |\n|---------|-------------|---------|-------------|\n| `developer_mode` | Enable development features | 0 | Dev only |\n| `db_name` | Database name | site name | All |\n| `db_password` | Database password | - | All |\n| `redis_cache` | Redis cache URL | localhost:13000 | All |\n| `redis_queue` | Redis queue URL | localhost:11000 | All |\n| `mail_server` | SMTP server | - | All |\n| `session_timeout` | Session expiry (sec) | 3600 | All |\n| `deny_multiple_sessions` | Single session per user | 0 | Production |\n| `logging` | Log level (1-3) | 1 | All |\n| `enable_rate_limit` | API rate limiting | 0 | Production |\n\n### Developer Mode Features\n\nWhen `developer_mode: 1`:\n- Edit DocTypes from desk\n- Automatic file reload\n- Detailed error pages\n- Query logging\n- Debug toolbar\n- Skip migrations prompt\n- Allow test execution\n\n### Security Settings\n\n**Production Security Checklist:**\n```json\n{\n  \"developer_mode\": 0,\n  \"disable_signup\": 1,\n  \"deny_multiple_sessions\": 1,\n  \"session_timeout\": 14400,\n  \"password_reset_limit\": 3,\n  \"ignore_csrf\": 0,\n  \"force_https\": 1,\n  \"enable_rate_limit\": 1,\n  \"cors_headers\": [\"https://allowed-domain.com\"]\n}\n```\n\n## Important Notes\n\n- Changes require bench restart for some settings\n- Clear cache after config changes\n- Site config overrides common config\n- Environment variables can override config\n- Sensitive values (passwords) stored in config\n- Use environment variables for secrets in production\n- Back up config before major changes\n- Test config changes in dev first\n- Document custom config settings\n- Use `.gitignore` for site_config.json (contains secrets)\n\n## Troubleshooting\n\n**Config Not Taking Effect:**\n```bash\n# Restart bench\nbench restart\n\n# Clear cache\nbench --site [site-name] clear-cache\n\n# Check if config was set\ncat sites/[site-name]/site_config.json | jq .[key]\n```\n\n**Invalid JSON:**\n```bash\n# Validate JSON syntax\ncat sites/[site-name]/site_config.json | jq .\n```\n\n**Permission Denied:**\n```bash\n# Check file ownership\nls -la sites/[site-name]/site_config.json\n\n# Fix if needed\nsudo chown frappe:frappe sites/[site-name]/site_config.json\n```"
              },
              {
                "name": "/frappe-console",
                "description": "Launch interactive Frappe Python console for debugging and data queries",
                "path": "frappe-apps-manager/commands/frappe-console.md",
                "frontmatter": {
                  "description": "Launch interactive Frappe Python console for debugging and data queries"
                },
                "content": "# Frappe Console Command\n\nLaunch an interactive Python console with Frappe context loaded for debugging, data exploration, and executing Python commands.\n\n## Steps to Execute\n\n### 1. Verify Bench Environment\n- Check if current directory is a valid Frappe bench\n- Verify bench command is available\n- List available sites\n\n### 2. Select Site\nAsk user which site to use:\n- List all sites in `sites/` directory\n- Show default site (if set with `bench use`)\n- Get user selection or use default\n\n### 3. Console Type Selection\nOffer console options:\n\n**A. Standard Console (IPython)**\n- Full Python REPL with Frappe context\n- Auto-completion and syntax highlighting\n- Command history\n\n**B. One-liner Execution**\n- Execute single Python command\n- Get result and exit\n- Useful for scripts and automation\n\n**C. Script Execution**\n- Execute Python script file\n- Run with Frappe context\n- Show output\n\n### 4. Launch Console\n\n**Standard Console:**\n```bash\nbench --site [site-name] console\n```\n\n**One-liner:**\n```bash\nbench --site [site-name] console --execute \"print(frappe.db.get_all('Customer', limit=5))\"\n```\n\n**Script File:**\n```bash\nbench --site [site-name] console < script.py\n```\n\n### 5. Provide Console Snippets\n\nShow common console commands for user reference:\n\n**Get Document:**\n```python\n# Fetch a document\ndoc = frappe.get_doc('Customer', 'CUST-001')\nprint(doc.as_dict())\n```\n\n**Query Database:**\n```python\n# Get all records with filters\ncustomers = frappe.get_all('Customer',\n    filters={'customer_group': 'Commercial'},\n    fields=['name', 'customer_name'],\n    limit=10\n)\nprint(customers)\n```\n\n**Execute Queries:**\n```python\n# Raw SQL\nresult = frappe.db.sql(\"\"\"\n    SELECT name, customer_name\n    FROM `tabCustomer`\n    WHERE creation > '2025-01-01'\n    LIMIT 10\n\"\"\", as_dict=True)\n```\n\n**Create Documents:**\n```python\n# Create new document\ncustomer = frappe.get_doc({\n    'doctype': 'Customer',\n    'customer_name': 'Test Customer',\n    'customer_group': 'Commercial'\n})\ncustomer.insert()\nfrappe.db.commit()\n```\n\n**Update Documents:**\n```python\n# Update existing document\ndoc = frappe.get_doc('Customer', 'CUST-001')\ndoc.customer_name = 'Updated Name'\ndoc.save()\nfrappe.db.commit()\n```\n\n**Delete Documents:**\n```python\n# Delete document\nfrappe.delete_doc('Customer', 'CUST-001')\nfrappe.db.commit()\n```\n\n**Test Permissions:**\n```python\n# Check permissions\nfrappe.has_permission('Customer', 'write', 'CUST-001')\n\n# Set user context\nfrappe.set_user('user@example.com')\n```\n\n**Clear Cache:**\n```python\n# Clear specific doctype cache\nfrappe.clear_cache(doctype='Customer')\n\n# Clear all cache\nfrappe.clear_cache()\n```\n\n**Reload DocType:**\n```python\n# Reload DocType after JSON changes\nfrappe.reload_doctype('Customer')\n```\n\n### 6. Console Session Management\n\nProvide guidance for session:\n\n**Important Commands:**\n- `exit()` or `Ctrl+D` - Exit console\n- `Ctrl+C` - Interrupt current command\n- `help(frappe)` - Get help on frappe module\n- `dir(doc)` - List object attributes\n\n**Transaction Management:**\n```python\n# Always commit changes\nfrappe.db.commit()\n\n# Rollback if needed\nfrappe.db.rollback()\n```\n\n### 7. Debugging Support\n\n**Inspect Objects:**\n```python\n# Get all fields\ndoc = frappe.get_doc('Customer', 'CUST-001')\nprint(doc.as_dict())\n\n# Get specific field\nprint(doc.customer_name)\n\n# Check meta\nprint(doc.meta.fields)\n```\n\n**Trace Errors:**\n```python\n# Get last error\nfrappe.get_traceback()\n\n# Log error\nfrappe.log_error('Custom error message')\n```\n\n**Profile Code:**\n```python\nimport time\nstart = time.time()\n# ... your code ...\nprint(f\"Execution time: {time.time() - start}s\")\n```\n\n### 8. Data Exploration\n\n**Count Records:**\n```python\n# Count all\nfrappe.db.count('Customer')\n\n# Count with filters\nfrappe.db.count('Customer', {'customer_group': 'Commercial'})\n```\n\n**Get Distinct Values:**\n```python\n# Get all customer groups\nfrappe.db.sql_list(\"SELECT DISTINCT customer_group FROM `tabCustomer`\")\n```\n\n**Check Schema:**\n```python\n# Get DocType meta\nmeta = frappe.get_meta('Customer')\nfor field in meta.fields:\n    print(f\"{field.fieldname}: {field.fieldtype}\")\n```\n\n### 9. Bulk Operations\n\n**Bulk Update:**\n```python\n# Update multiple records\ncustomers = frappe.get_all('Customer',\n    filters={'customer_group': 'Old Group'},\n    pluck='name'\n)\n\nfor name in customers:\n    doc = frappe.get_doc('Customer', name)\n    doc.customer_group = 'New Group'\n    doc.save()\n\nfrappe.db.commit()\n```\n\n**Bulk Delete:**\n```python\n# Delete with filters\nfrappe.db.delete('Customer', {\n    'creation': ['<', '2020-01-01']\n})\nfrappe.db.commit()\n```\n\n### 10. Advanced Operations\n\n**Test API Methods:**\n```python\n# Call whitelisted method\nresult = frappe.call('my_app.api.get_customer_details',\n    customer='CUST-001'\n)\nprint(result)\n```\n\n**Run Scheduled Jobs:**\n```python\n# Execute scheduler method\nfrappe.enqueue('my_app.tasks.daily_cleanup')\n```\n\n**Inspect Queue:**\n```python\n# Check background jobs\nfrom rq import Queue\nfrom frappe.utils.background_jobs import get_redis_conn\n\nq = Queue('default', connection=get_redis_conn())\nprint(f\"Jobs in queue: {len(q)}\")\n```\n\n## References\n\n### Frappe Core Console Examples (Primary Reference)\n\n**Frappe Console Utilities:**\n- Frappe DB API: https://github.com/frappe/frappe/blob/develop/frappe/database.py\n- Document API: https://github.com/frappe/frappe/blob/develop/frappe/model/document.py\n- Utils Module: https://github.com/frappe/frappe/blob/develop/frappe/utils/__init__.py\n\n**Real Console Patterns from Core:**\n\n1. **Data Migration** (common console use):\n```python\n# Migrate data between fields\nfor doc in frappe.get_all('Item', pluck='name'):\n    item = frappe.get_doc('Item', doc)\n    item.new_field = item.old_field\n    item.save()\nfrappe.db.commit()\n```\n\n2. **Fix Data Issues** (from support scenarios):\n```python\n# Fix incorrect values\nfrappe.db.set_value('Customer', 'CUST-001',\n    'customer_group', 'Correct Group')\nfrappe.db.commit()\n```\n\n3. **Generate Reports** (quick analysis):\n```python\n# Get summary data\nresult = frappe.db.sql(\"\"\"\n    SELECT customer_group, COUNT(*) as count\n    FROM `tabCustomer`\n    GROUP BY customer_group\n\"\"\", as_dict=True)\nprint(result)\n```\n\n### Official Documentation (Secondary Reference)\n\n- Bench Console: https://frappeframework.com/docs/user/en/bench/reference/bench-cli#console\n- Frappe API: https://frappeframework.com/docs/user/en/api\n- Database API: https://frappeframework.com/docs/user/en/api/database\n\n## Safety Guidelines\n\n### Important Warnings\n\n**Production Safety:**\n- ‚ö†Ô∏è ALWAYS use test/development sites for experiments\n- ‚ö†Ô∏è NEVER run untested commands on production\n- ‚ö†Ô∏è ALWAYS backup before bulk operations\n- ‚ö†Ô∏è ALWAYS commit or rollback explicitly\n\n**Transaction Safety:**\n```python\ntry:\n    # Your operations\n    doc.save()\n    frappe.db.commit()  # Commit on success\nexcept Exception as e:\n    frappe.db.rollback()  # Rollback on error\n    print(f\"Error: {e}\")\n```\n\n**Permission Context:**\n```python\n# Bypass permissions for admin tasks\ndoc.insert(ignore_permissions=True)\ndoc.save(ignore_permissions=True)\n\n# Be careful with this - only use when necessary\n```\n\n## Common Console Use Cases\n\n### 1. Data Migration\n```python\n# Migrate from old to new structure\nfor name in frappe.get_all('Old DocType', pluck='name'):\n    old = frappe.get_doc('Old DocType', name)\n    new = frappe.get_doc({\n        'doctype': 'New DocType',\n        'field1': old.old_field1,\n        'field2': old.old_field2\n    })\n    new.insert()\nfrappe.db.commit()\n```\n\n### 2. Fix Data Issues\n```python\n# Fix duplicate entries\nduplicates = frappe.db.sql(\"\"\"\n    SELECT email, COUNT(*)\n    FROM `tabCustomer`\n    GROUP BY email\n    HAVING COUNT(*) > 1\n\"\"\", as_dict=True)\n\nfor dup in duplicates:\n    print(f\"Duplicate email: {dup.email}\")\n```\n\n### 3. Generate Reports\n```python\n# Sales summary\nresult = frappe.db.sql(\"\"\"\n    SELECT\n        MONTH(posting_date) as month,\n        SUM(grand_total) as total\n    FROM `tabSales Invoice`\n    WHERE YEAR(posting_date) = 2025\n    GROUP BY MONTH(posting_date)\n\"\"\", as_dict=True)\nprint(result)\n```\n\n### 4. User Management\n```python\n# Create user\nuser = frappe.get_doc({\n    'doctype': 'User',\n    'email': 'newuser@example.com',\n    'first_name': 'New',\n    'last_name': 'User',\n    'send_welcome_email': 0\n})\nuser.insert()\nuser.add_roles('Sales User', 'Purchase User')\nfrappe.db.commit()\n```\n\n### 5. Configuration Changes\n```python\n# Update system settings\nsettings = frappe.get_single('System Settings')\nsettings.disable_signup = 1\nsettings.save()\nfrappe.db.commit()\n```\n\n## Important Notes\n\n- Console runs with Administrator privileges by default\n- All database changes require explicit `frappe.db.commit()`\n- Use `frappe.db.rollback()` if something goes wrong\n- Console maintains state until exit\n- Great for one-off data fixes and exploration\n- Not suitable for production automation (use scheduled jobs)\n- Always test commands before running on production data"
              },
              {
                "name": "/frappe-db-reset",
                "description": "Reset Frappe database - reinstall with fresh data and fixtures for development",
                "path": "frappe-apps-manager/commands/frappe-db-reset.md",
                "frontmatter": {
                  "description": "Reset Frappe database - reinstall with fresh data and fixtures for development"
                },
                "content": "# Frappe DB Reset Command\n\nReset and reinitialize Frappe database for development purposes with automatic backup and fresh data setup.\n\n## Steps to Execute\n\n### 1. Verify Environment\n- Check if in valid Frappe bench\n- Verify site exists\n- **WARNING:** Confirm this is NOT a production site\n- Check for existing backups\n\n### 2. Safety Checks\n\n**CRITICAL WARNINGS:**\n- ‚ö†Ô∏è This operation DESTROYS ALL DATA\n- ‚ö†Ô∏è ONLY use on development/test sites\n- ‚ö†Ô∏è NEVER run on production sites\n- ‚ö†Ô∏è Always create backup first\n\nAsk user to confirm:\n1. Is this a development/test site?\n2. Do they want to backup first?\n3. Do they understand all data will be lost?\n\nRequire explicit confirmation: \"Type 'RESET' to confirm\"\n\n### 3. Pre-Reset Backup\n\n**Create Safety Backup:**\n```bash\nbench --site [site-name] backup --with-files\n```\n\nStore backup location for user:\n```\nBackup created at:\n- Database: sites/[site-name]/private/backups/[timestamp]-database.sql.gz\n- Files: sites/[site-name]/private/backups/[timestamp]-files.tar\n```\n\n### 4. Reset Options\n\nOffer reset approaches:\n\n**A. Full Reinstall (Recommended)**\n- Drops and recreates database\n- Reinstalls all apps\n- Clean slate\n\n**B. Data Reset Only**\n- Keeps app installations\n- Removes user data\n- Faster than full reinstall\n\n**C. Selective Reset**\n- Reset specific DocTypes\n- Keep master data\n- Remove transactions only\n\n### 5. Execute Full Reinstall\n\n**Full Site Reinstall:**\n```bash\n# Reinstall site (drops DB and recreates)\nbench --site [site-name] reinstall\n\n# Or with options\nbench --site [site-name] reinstall \\\n    --admin-password [password] \\\n    --mariadb-root-password [root-password] \\\n    --install-app erpnext \\\n    --verbose\n```\n\nThis will:\n1. Drop existing database\n2. Create new database\n3. Install frappe app\n4. Install additional apps (if specified)\n5. Create Administrator user\n6. Set up default roles and permissions\n\n### 6. Execute Data-Only Reset\n\n**Remove User Data:**\n```python\n# Via console\nbench --site [site-name] console\n\n# Get all DocTypes\nexclude_core = ['User', 'Role', 'DocType', 'Module Def']\n\nfor doctype in frappe.get_all('DocType', pluck='name'):\n    if doctype not in exclude_core:\n        frappe.db.delete(doctype)\n\nfrappe.db.commit()\n```\n\n### 7. Install Fixtures\n\nAfter reset, offer to install fixtures:\n\n**A. Core Fixtures:**\n```bash\nbench --site [site-name] install-app [app-name]\n```\n\n**B. Custom Fixtures:**\n```bash\n# Import fixtures from app\nbench --site [site-name] console\n>>> from frappe.core.page.data_import_tool import data_import_tool\n>>> data_import_tool.import_doc('path/to/fixtures.json')\n```\n\n**C. Demo Data:**\n```bash\n# Install with demo data\nbench --site [site-name] reinstall --install-app erpnext --with-demo-data\n```\n\n### 8. Post-Reset Setup\n\n**A. Create Test Users:**\n```python\n# Via console\nusers = [\n    {'email': 'sales@test.com', 'first_name': 'Sales', 'roles': ['Sales User']},\n    {'email': 'stock@test.com', 'first_name': 'Stock', 'roles': ['Stock User']}\n]\n\nfor user_data in users:\n    if not frappe.db.exists('User', user_data['email']):\n        user = frappe.get_doc({\n            'doctype': 'User',\n            'email': user_data['email'],\n            'first_name': user_data['first_name'],\n            'send_welcome_email': 0\n        })\n        user.insert(ignore_permissions=True)\n        user.add_roles(*user_data['roles'])\n\nfrappe.db.commit()\n```\n\n**B. Configure Site Settings:**\n```bash\nbench --site [site-name] set-config developer_mode 1\nbench --site [site-name] set-config allow_tests 1\n```\n\n**C. Run Migrations:**\n```bash\nbench --site [site-name] migrate\n```\n\n**D. Clear Cache:**\n```bash\nbench --site [site-name] clear-cache\n```\n\n### 9. Verify Reset\n\nCheck that reset was successful:\n\n**Database Check:**\n```python\n# Count records\nfrappe.db.count('Customer')  # Should be 0 or fixture count\nfrappe.db.count('User')      # Should have Administrator + test users\n```\n\n**App Installation:**\n```bash\nbench --site [site-name] list-apps\n```\n\n**Site Access:**\n```bash\nbench --site [site-name] browse\n# Or manually visit: http://localhost:8000\n```\n\n**Login Test:**\n- Username: Administrator\n- Password: [admin-password from reinstall]\n\n### 10. Restore from Backup (If Needed)\n\nIf reset went wrong, restore from backup:\n\n**Restore Database:**\n```bash\nbench --site [site-name] --force restore \\\n    sites/[site-name]/private/backups/[backup-file].sql.gz\n```\n\n**Restore Files:**\n```bash\ncd sites/[site-name]\ntar -xzf private/backups/[backup-file]-files.tar\n```\n\n**Full Restore:**\n```bash\nbench --site [site-name] restore \\\n    --with-public-files sites/[site-name]/private/backups/[timestamp]-database.sql.gz \\\n    --with-private-files sites/[site-name]/private/backups/[timestamp]-files.tar\n```\n\n## References\n\n### Frappe Core Reset/Install Patterns (Primary Reference)\n\n**Frappe Install Module:**\n- Install Functions: https://github.com/frappe/frappe/blob/develop/frappe/installer.py\n- Site Installer: https://github.com/frappe/frappe/blob/develop/frappe/install_lib.py\n- Database Setup: https://github.com/frappe/frappe/blob/develop/frappe/database.py\n\n**Bench Install Commands:**\n- Bench Reinstall: https://github.com/frappe/bench/blob/develop/bench/commands/site.py\n- New Site Logic: https://github.com/frappe/bench/blob/develop/bench/commands/make.py\n\n**Real Reset Patterns:**\n\n1. **Fixture Installation** (from ERPNext setup):\n```python\n# See: erpnext/setup/install.py\ndef install_fixtures():\n    from frappe.core.doctype.data_import.data_import import import_doc\n\n    for fixture in ['country', 'currency', 'mode_of_payment']:\n        import_doc(f'erpnext/setup/fixtures/{fixture}.json')\n\n    frappe.db.commit()\n```\n\n2. **Post-Install Configuration** (from Frappe installer):\n```python\n# See: frappe/installer.py\ndef after_install():\n    add_standard_roles()\n    install_basic_docs()\n    setup_wizard_complete()\n    frappe.db.commit()\n```\n\n### Official Documentation (Secondary Reference)\n\n- Reinstall Command: https://frappeframework.com/docs/user/en/bench/reference/bench-cli#reinstall\n- Backup/Restore: https://frappeframework.com/docs/user/en/bench/reference/bench-cli#backup\n- Site Commands: https://frappeframework.com/docs/user/en/bench/reference/sites\n\n## Advanced Reset Scenarios\n\n### Selective DocType Reset\n\n**Reset Specific DocTypes:**\n```python\n# Via console\ndoctypes_to_reset = ['Sales Invoice', 'Purchase Order', 'Stock Entry']\n\nfor doctype in doctypes_to_reset:\n    # Delete all records\n    frappe.db.delete(doctype)\n\n    # Reset naming series\n    frappe.db.sql(f\"\"\"\n        UPDATE `tabSeries`\n        SET current = 0\n        WHERE name LIKE '{doctype[:4]}%'\n    \"\"\")\n\nfrappe.db.commit()\nprint(\"Reset complete\")\n```\n\n### Keep Master Data\n\n**Reset Transactions, Keep Masters:**\n```python\n# Define master DocTypes to keep\nmaster_doctypes = ['Customer', 'Item', 'Supplier', 'Company']\n\n# Get all DocTypes\nall_doctypes = frappe.get_all('DocType',\n    filters={'istable': 0, 'issingle': 0},\n    pluck='name'\n)\n\n# Reset transaction DocTypes\nfor doctype in all_doctypes:\n    if doctype not in master_doctypes:\n        count = frappe.db.count(doctype)\n        if count > 0:\n            frappe.db.delete(doctype)\n            print(f\"Deleted {count} {doctype} records\")\n\nfrappe.db.commit()\n```\n\n### Database Cleanup\n\n**Clean Orphaned Records:**\n```python\n# Find and remove orphaned child table records\n# Run after selective reset\n\nfrappe.db.sql(\"\"\"\n    DELETE FROM `tabSales Invoice Item`\n    WHERE parent NOT IN (SELECT name FROM `tabSales Invoice`)\n\"\"\")\n\nfrappe.db.commit()\n```\n\n## Important Notes\n\n- ‚ö†Ô∏è NEVER run on production without understanding consequences\n- ‚ö†Ô∏è ALWAYS backup before reset\n- Reinstall preserves site_config.json\n- Reinstall preserves file uploads (can be cleared separately)\n- Administrator password reset to new password\n- All users except Administrator removed (can be preserved if needed)\n- Custom apps need reinstallation\n- Migrations run automatically on reinstall\n- Reset clears all reports, dashboards, customizations\n- Testing: Use dedicated test sites for resets\n\n## Safety Checklist\n\nBefore executing reset, verify:\n- [ ] This is a development/test site (NOT production)\n- [ ] Backup created and verified\n- [ ] Admin password documented\n- [ ] Apps list documented (for reinstall)\n- [ ] Important data exported (if any)\n- [ ] Team notified (if shared site)\n- [ ] Bench and Redis running\n- [ ] Sufficient disk space for reinstall\n\n## Post-Reset Checklist\n\nAfter reset, verify:\n- [ ] Can login as Administrator\n- [ ] All apps installed correctly\n- [ ] Site config intact\n- [ ] Redis working\n- [ ] Email configured (if needed)\n- [ ] Test users created\n- [ ] Permissions configured\n- [ ] Fixtures installed\n- [ ] Customizations reapplied\n\n## Alternative: Clone Instead of Reset\n\n**For testing, consider cloning:**\n```bash\n# Create copy of site for testing\nbench --site original.local backup\nbench restore new-test.local \\\n    --source sites/original.local/private/backups/[backup].sql.gz\n\n# Now reset the clone, not original\nbench --site new-test.local reinstall\n```\n\nThis preserves original site while providing clean environment."
              },
              {
                "name": "/frappe-deploy",
                "description": "Deploy Frappe apps to production environment",
                "path": "frappe-apps-manager/commands/frappe-deploy.md",
                "frontmatter": {
                  "description": "Deploy Frappe apps to production environment"
                },
                "content": "# Frappe Deploy Command\n\nGuide deployment of Frappe applications to production:\n\n1. **Pre-deployment checklist**:\n   - Verify all changes are committed to git\n   - Ensure migrations are tested\n   - Check for breaking changes\n   - Confirm backup exists\n   - Review security settings\n2. **Environment verification**:\n   - Confirm target environment (staging/production)\n   - Check SSH access to production server\n   - Verify bench directory on production\n3. **Deployment preparation**:\n   - Ask about deployment method:\n     - Git pull and migrate\n     - Full bench update\n     - Specific app update\n   - Ask about downtime window\n   - Confirm maintenance mode preference\n4. **Deployment steps**:\n   - Enable maintenance mode: `bench --site <site-name> set-maintenance-mode on`\n   - Pull latest changes: `git pull` in app directory\n   - Install dependencies: `bench setup requirements`\n   - Run migrations: `bench --site <site-name> migrate`\n   - Build assets: `bench build --app <app-name>`\n   - Clear cache: `bench --site <site-name> clear-cache`\n   - Restart services: `sudo supervisorctl restart all` or `bench restart`\n   - Disable maintenance mode: `bench --site <site-name> set-maintenance-mode off`\n5. **Post-deployment verification**:\n   - Check site is accessible\n   - Verify key functionality\n   - Check error logs\n   - Monitor performance\n6. **Rollback plan**: Provide rollback instructions if issues occur:\n   - Revert git commits\n   - Restore from backup\n   - Previous version migration\n\n**Production safety**: Emphasize testing in staging first, backing up before deployment, and having a rollback plan ready."
              },
              {
                "name": "/frappe-install-app",
                "description": "Install a Frappe app to a site",
                "path": "frappe-apps-manager/commands/frappe-install-app.md",
                "frontmatter": {
                  "description": "Install a Frappe app to a site"
                },
                "content": "# Frappe Install App Command\n\nInstall a Frappe application to a specific site:\n\n1. **Verify bench directory**: Confirm we're in a Frappe bench directory\n2. **List available apps**: Show apps that are available in the bench but may not be installed on the site\n3. **List available sites**: Display all sites in the bench\n4. **Get installation details**:\n   - App name to install\n   - Site name where the app should be installed\n5. **Pre-installation checks**:\n   - Verify the app exists in the bench\n   - Verify the site exists\n   - Check if the app is already installed (warn user)\n6. **Install the app**: Run `bench --site <site-name> install-app <app-name>`\n7. **Verify installation**:\n   - Check that the app appears in the site's installed apps\n   - Look for any error messages\n8. **Post-installation**:\n   - Suggest running migrations if needed\n   - Recommend restarting bench\n   - Provide next steps for using the app\n\n**Error handling**: Provide clear error messages if installation fails, including common issues like missing dependencies or database connection problems."
              },
              {
                "name": "/frappe-logs",
                "description": "View and analyze Frappe bench logs with filtering and search capabilities",
                "path": "frappe-apps-manager/commands/frappe-logs.md",
                "frontmatter": {
                  "description": "View and analyze Frappe bench logs with filtering and search capabilities"
                },
                "content": "# Frappe Logs Command\n\nView, filter, and analyze Frappe bench logs including web server, background workers, scheduler, and error logs.\n\n## Steps to Execute\n\n### 1. Verify Bench Environment\n- Check if current directory is a valid Frappe bench\n- Look for `logs/` directory\n- Verify log files exist\n\n### 2. Determine Log Type to View\n\nAsk user which logs to view:\n\n**A. Web Server Logs**\n- `logs/web.log` - Werkzeug development server logs\n- `logs/web.error.log` - Web server error logs\n- Shows HTTP requests, responses, errors\n\n**B. Worker Logs**\n- `logs/worker.log` - Background job worker logs\n- `logs/worker.error.log` - Worker errors\n- Shows async task execution\n\n**C. Scheduler Logs**\n- `logs/schedule.log` - Scheduled task logs\n- Shows cron job execution\n\n**D. Site-specific Logs**\n- `sites/[site-name]/logs/` - Per-site logs\n- Request logs, error logs\n\n**E. All Logs**\n- View combined logs from all sources\n\n### 3. Log Viewing Options\n\nOffer filtering and display options:\n\n**Time-based:**\n- Last N lines (default: 50)\n- Last N minutes/hours\n- Specific time range\n- Real-time tail (follow mode)\n\n**Level-based:**\n- ERROR only\n- WARNING and above\n- INFO and above\n- DEBUG (all logs)\n\n**Pattern-based:**\n- Search for specific text/pattern\n- Filter by DocType name\n- Filter by user\n- Filter by IP address\n\n### 4. Execute Log Viewing\n\nBased on user choice, execute appropriate command:\n\n**View Recent Web Logs:**\n```bash\ntail -n 50 logs/web.log\n```\n\n**View Error Logs Only:**\n```bash\ntail -n 100 logs/web.error.log\n```\n\n**Follow Logs in Real-time:**\n```bash\ntail -f logs/web.log\n```\n\n**Search for Specific Pattern:**\n```bash\ngrep \"pattern\" logs/web.log | tail -n 50\n```\n\n**View Logs with Timestamps:**\n```bash\ntail -n 50 logs/web.log | grep -E '^\\[.*\\]'\n```\n\n**Multiple Log Files:**\n```bash\ntail -n 20 logs/web.log logs/worker.log logs/schedule.log\n```\n\n### 5. Format Log Output\n\nParse and display logs in readable format:\n\n**Standard Format:**\n```\n[2025-12-15 14:30:45] ERROR: ValidationError in Document Customer\n  File: frappe/model/document.py, Line: 234\n  User: user@example.com\n  Message: Email is required\n```\n\n**Structured Display:**\n- Timestamp\n- Log level (ERROR, WARNING, INFO)\n- Module/File\n- Line number\n- User (if applicable)\n- Error message\n- Stack trace (for errors)\n\n### 6. Analyze Common Errors\n\nIdentify and highlight common error patterns:\n\n**Database Errors:**\n- Connection failures\n- Deadlocks\n- Query timeouts\n- Foreign key violations\n\n**Permission Errors:**\n- Access denied\n- Missing permissions\n- Role restrictions\n\n**Validation Errors:**\n- Required field missing\n- Invalid values\n- Duplicate entries\n\n**API Errors:**\n- 404 Not Found\n- 500 Internal Server Error\n- Authentication failures\n\n### 7. Provide Error Context\n\nFor each error found:\n- Show surrounding log lines\n- Identify related errors\n- Link to relevant code (if possible)\n- Suggest potential fixes\n\n### 8. Log Statistics\n\nGenerate summary statistics:\n\n**Error Count by Type:**\n```\nValidationError: 15\nPermissionError: 8\nDatabaseError: 3\nTimeoutError: 1\n```\n\n**Error Frequency Timeline:**\n```\n14:00-14:30: 5 errors\n14:30-15:00: 12 errors\n15:00-15:30: 2 errors\n```\n\n**Top Error Sources:**\n```\n1. frappe.model.document (10 errors)\n2. erpnext.accounts.doctype.sales_invoice (5 errors)\n3. custom_app.api (3 errors)\n```\n\n### 9. Advanced Log Analysis\n\nOffer advanced analysis:\n\n**Trace Request Flow:**\n- Follow a specific request through logs\n- Show all log entries for a request ID\n- Reconstruct request timeline\n\n**Performance Analysis:**\n- Identify slow requests (> 1 second)\n- Database query performance\n- API endpoint response times\n\n**User Activity:**\n- Filter logs by specific user\n- Show user's actions\n- Track user sessions\n\n### 10. Log Management\n\nProvide log management options:\n\n**Archive Old Logs:**\n```bash\n# Rotate logs\nbench --site [site-name] rotate-logs\n\n# Archive logs older than 30 days\nfind logs/ -name \"*.log\" -mtime +30 -exec gzip {} \\;\n```\n\n**Clear Logs:**\n```bash\n# Clear specific log\n> logs/web.log\n\n# Clear all logs (with confirmation)\nrm logs/*.log\n```\n\n**Export Logs:**\n```bash\n# Export filtered logs\ngrep \"ERROR\" logs/web.log > error_report.txt\n\n# Export with timestamp range\nawk '/2025-12-15 14:00/,/2025-12-15 15:00/' logs/web.log > incident_logs.txt\n```\n\n## Log File Reference\n\n### Core Frappe Log Files\n\n**Development Logs:**\n```\nlogs/\n‚îú‚îÄ‚îÄ web.log              # Werkzeug dev server logs\n‚îú‚îÄ‚îÄ web.error.log        # Web server errors\n‚îú‚îÄ‚îÄ worker.log           # Background worker logs\n‚îú‚îÄ‚îÄ worker.error.log     # Worker errors\n‚îú‚îÄ‚îÄ schedule.log         # Scheduled tasks\n‚îî‚îÄ‚îÄ redis_cache.log      # Redis cache operations\n```\n\n**Production Logs (with Nginx/Supervisor):**\n```\nlogs/\n‚îú‚îÄ‚îÄ nginx-access.log     # Nginx access logs\n‚îú‚îÄ‚îÄ nginx-error.log      # Nginx errors\n‚îú‚îÄ‚îÄ frappe-web.log       # Gunicorn web logs\n‚îú‚îÄ‚îÄ frappe-worker.log    # RQ worker logs\n‚îî‚îÄ‚îÄ supervisor.log       # Supervisor process logs\n```\n\n**Site-specific Logs:**\n```\nsites/[site-name]/\n‚îú‚îÄ‚îÄ logs/\n‚îÇ   ‚îú‚îÄ‚îÄ request.log      # HTTP request logs\n‚îÇ   ‚îî‚îÄ‚îÄ error.log        # Site-specific errors\n‚îî‚îÄ‚îÄ site_config.json\n```\n\n### Log Format Examples\n\n**Web Server Log Entry:**\n```\n[2025-12-15 14:30:45,123] INFO in app: 127.0.0.1 - - [15/Dec/2025 14:30:45] \"GET /api/resource/Customer/CUST-001 HTTP/1.1\" 200 -\n```\n\n**Error Log Entry:**\n```\n[2025-12-15 14:30:45] ERROR:\nTraceback (most recent call last):\n  File \"frappe/app.py\", line 82, in application\n    response = frappe.api.handle()\n  File \"frappe/api.py\", line 51, in handle\n    return frappe.handler.handle()\nValidationError: Email is required in row 1\n```\n\n**Worker Log Entry:**\n```\n[2025-12-15 14:30:45] INFO Worker rq:worker:worker-1 started\n[2025-12-15 14:30:46] INFO Job frappe.email.queue.flush queued\n[2025-12-15 14:30:47] INFO Job frappe.email.queue.flush finished\n```\n\n## Common Log Patterns\n\n### Database Connection Issues\n\n**Pattern:**\n```\nERROR: could not connect to server: Connection refused\nERROR: OperationalError: (2002, \"Can't connect to local MySQL server\")\n```\n\n**Solution:**\n- Check if MySQL/MariaDB is running\n- Verify database credentials in site_config.json\n- Check database port accessibility\n\n### Permission Denied Errors\n\n**Pattern:**\n```\nPermissionError: You need {permission} permission for {doctype}\nfrappe.exceptions.PermissionError: Insufficient Permission for Customer\n```\n\n**Solution:**\n- Check user roles: `bench --site [site] console`\n- Review permission rules in DocType\n- Add required roles to user\n\n### Import/Export Failures\n\n**Pattern:**\n```\nERROR in import: frappe.exceptions.DataImportError\nERROR: Duplicate entry 'CUST-001' for key 'PRIMARY'\n```\n\n**Solution:**\n- Check data format\n- Verify unique constraints\n- Use ignore_if_duplicate flag\n\n## References\n\n### Frappe Core Log Examples (Primary Reference)\n\n**Frappe Logging Implementation:**\n- Frappe Logger: https://github.com/frappe/frappe/blob/develop/frappe/utils/logger.py\n- Log Configuration: https://github.com/frappe/frappe/blob/develop/frappe/utils/data.py\n- Error Handler: https://github.com/frappe/frappe/blob/develop/frappe/app.py\n\n**ERPNext Logging Patterns:**\n- Sales Invoice Logging: https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/sales_invoice/sales_invoice.py\n- Stock Entry Logging: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/doctype/stock_entry/stock_entry.py\n\n**Real Logging Examples from Core:**\n\n1. **Custom Logger Usage** (from Frappe Core):\n```python\n# See: frappe/utils/logger.py\nimport frappe\nfrom frappe.utils.logger import get_logger\n\nlogger = get_logger(\"my_app\")\nlogger.info(\"Processing started\")\nlogger.error(\"Error occurred\", exc_info=True)\n```\n\n2. **Error Context Logging** (from ERPNext):\n```python\n# See: erpnext/accounts/doctype/payment_entry/payment_entry.py\ntry:\n    doc.submit()\nexcept Exception as e:\n    frappe.log_error(\n        title=\"Payment Entry Submission Failed\",\n        message=frappe.get_traceback()\n    )\n```\n\n3. **Debug Logging** (from Frappe Core):\n```python\n# See: frappe/integrations/doctype/webhook/webhook.py\nif frappe.conf.developer_mode:\n    frappe.logger().debug(f\"Webhook payload: {payload}\")\n```\n\n### Official Documentation (Secondary Reference)\n\n- Logging Guide: https://frappeframework.com/docs/user/en/debugging\n- Bench Logs: https://frappeframework.com/docs/user/en/bench/reference/logs\n- Error Handling: https://frappeframework.com/docs/user/en/api/exceptions\n\n## Advanced Log Analysis\n\n### Using Python for Log Analysis\n\n**Parse Logs with Python:**\n```python\nimport re\nfrom datetime import datetime\n\n# Parse Frappe log entries\nlog_pattern = r'\\[(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})\\] (\\w+): (.+)'\n\nwith open('logs/web.log', 'r') as f:\n    for line in f:\n        match = re.match(log_pattern, line)\n        if match:\n            timestamp, level, message = match.groups()\n            if level == 'ERROR':\n                print(f\"{timestamp}: {message}\")\n```\n\n### Real-time Log Monitoring\n\n**Monitor Multiple Logs:**\n```bash\n# Watch all error logs\nwatch -n 1 'tail -n 5 logs/*.error.log'\n\n# Monitor specific pattern\ntail -f logs/web.log | grep --line-buffered \"ERROR\"\n\n# Colored output\ntail -f logs/web.log | grep --color=always -E \"ERROR|WARNING|$\"\n```\n\n### Log Aggregation\n\n**Combine and Sort Logs:**\n```bash\n# Merge logs by timestamp\ncat logs/web.log logs/worker.log | sort\n\n# Count errors by type\ngrep \"ERROR\" logs/*.log | cut -d: -f3 | sort | uniq -c | sort -rn\n```\n\n## Performance Monitoring\n\n### Identify Slow Requests\n\n**Find Slow API Calls:**\n```bash\n# Look for requests taking > 1 second\ngrep \"completed in\" logs/web.log | awk '$NF > 1.0'\n```\n\n**Database Query Performance:**\n```bash\n# Find slow queries in logs\ngrep \"query took\" logs/web.log | sort -k4 -rn | head -20\n```\n\n### Memory and Resource Usage\n\n**Monitor Worker Memory:**\n```bash\n# Check worker logs for memory issues\ngrep -i \"memory\" logs/worker.log\n```\n\n## Important Notes\n\n- Logs rotate automatically based on size/time\n- Old logs are compressed (`.gz`) to save space\n- Production logs may be managed by logrotate\n- Sensitive data (passwords, tokens) are typically masked\n- Enable developer mode for verbose logging\n- Use log levels appropriately (DEBUG in dev, INFO+ in prod)\n\n## Troubleshooting Guide\n\n**No logs appearing:**\n- Check bench is running\n- Verify log directory permissions\n- Enable logging in site_config.json\n\n**Logs too verbose:**\n- Adjust log level in site_config.json\n- Disable developer mode\n- Use log filtering\n\n**Disk space issues:**\n- Enable log rotation\n- Archive old logs\n- Increase log rotation frequency"
              },
              {
                "name": "/frappe-migrate",
                "description": "Run database migrations for Frappe apps",
                "path": "frappe-apps-manager/commands/frappe-migrate.md",
                "frontmatter": {
                  "description": "Run database migrations for Frappe apps"
                },
                "content": "# Frappe Migrate Command\n\nExecute database migrations for Frappe applications:\n\n1. **Verify bench directory**: Confirm we're in a Frappe bench\n2. **List sites**: Show all available sites in the bench\n3. **Get migration details**:\n   - Site name (or option to migrate all sites)\n   - Specific app to migrate (optional - if empty, migrate all apps)\n4. **Pre-migration checks**:\n   - Backup database (ask user for confirmation)\n   - Check for pending patches\n   - Verify database connectivity\n5. **Show migration plan**: Display what will be migrated:\n   - Apps that have pending migrations\n   - Number of patches to be applied\n   - Schema changes if detectable\n6. **Run migration**: Execute the appropriate command:\n   - `bench --site <site-name> migrate` for specific site\n   - `bench --site all migrate` for all sites\n   - `bench --site <site-name> migrate --app <app-name>` for specific app\n7. **Post-migration**:\n   - Display migration summary\n   - Check for any errors or warnings\n   - Suggest clearing cache: `bench --site <site-name> clear-cache`\n   - Recommend rebuilding search index if needed\n8. **Rollback information**: Provide guidance on how to rollback if issues occur\n\n**Safety**: Always emphasize the importance of backups before migrations, especially in production environments."
              },
              {
                "name": "/frappe-new-app",
                "description": "Create a new Frappe application with proper structure",
                "path": "frappe-apps-manager/commands/frappe-new-app.md",
                "frontmatter": {
                  "description": "Create a new Frappe application with proper structure"
                },
                "content": "# Frappe New App Command\n\nCreate a new Frappe application following best practices:\n\n1. **Verify bench directory**: Check if the current directory is a Frappe bench or ask the user for the bench path\n2. **Ask for app details**:\n   - App name (will be converted to snake_case)\n   - App title (human-readable name)\n   - App description\n   - Publisher name\n   - Email\n3. **Create the app**: Run `bench new-app <app-name>` with the provided details\n4. **Verify structure**: Check that the app was created with proper structure:\n   - `<app-name>/__init__.py`\n   - `<app-name>/hooks.py`\n   - `<app-name>/modules.txt`\n   - `<app-name>/patches.txt`\n   - `setup.py`\n5. **Post-creation steps**:\n   - Ask if they want to install the app to a site immediately\n   - Suggest next steps: creating DocTypes, pages, or custom scripts\n   - Provide guidance on the app structure\n\n**Important**: Ensure all prompts are interactive and user-friendly. Validate app names to ensure they follow Python package naming conventions."
              },
              {
                "name": "/frappe-new-doctype",
                "description": "Create a new DocType in a Frappe app",
                "path": "frappe-apps-manager/commands/frappe-new-doctype.md",
                "frontmatter": {
                  "description": "Create a new DocType in a Frappe app"
                },
                "content": "# Frappe New DocType Command\n\nCreate a new DocType with proper configuration:\n\n1. **Verify environment**: Ensure we're in a Frappe bench directory\n2. **Get DocType details**:\n   - App name where DocType should be created\n   - DocType name (will be in Title Case)\n   - Module name (must exist in the app)\n   - Is it a single DocType? (Single/submittable/standard)\n   - Is it submittable?\n   - Is naming automatic or based on a field?\n3. **DocType configuration**:\n   - Ask about common fields to add:\n     - Naming series\n     - Status field\n     - Common fields (customer, company, etc.)\n   - Ask about permissions (which roles should have access)\n   - Track changes option\n   - Quick entry option\n4. **Create the DocType**: Use one of these approaches:\n   - Via desk: Guide user to create via UI (recommended for complex DocTypes)\n   - Via JSON: Create the JSON file directly in the app\n   - Via bench console: Use Python script to create programmatically\n5. **Add common fields**: If user wants, add standard fields:\n   - Naming Series\n   - Status (Draft, Submitted, Cancelled)\n   - Amended From (for submittable docs)\n   - Company (for multi-company setups)\n6. **Set up permissions**: Create basic permission rules\n7. **Post-creation steps**:\n   - Run `bench --site <site-name> migrate` to sync DocType\n   - Suggest creating related DocTypes (child tables, etc.)\n   - Provide guidance on adding controller methods\n   - Mention form scripts and customizations\n\n**Development tips**: Explain DocType naming conventions, field types, and best practices for controller development."
              },
              {
                "name": "/frappe-new-site",
                "description": "Create a new Frappe site with database setup and configuration",
                "path": "frappe-apps-manager/commands/frappe-new-site.md",
                "frontmatter": {
                  "description": "Create a new Frappe site with database setup and configuration"
                },
                "content": "# Frappe New Site Command\n\nCreate a new Frappe site with proper database configuration, admin user setup, and initial app installation.\n\n## Steps to Execute\n\n### 1. Verify Bench Environment\n- Check if current directory is a valid Frappe bench\n- Look for `sites/common_site_config.json` file\n- Verify bench command is available\n- If not in bench directory, ask user for bench path\n\n### 2. Gather Site Details\nAsk the user for the following information:\n- **Site name** (e.g., `mysite.local`, `dev.example.com`)\n  - Must be a valid domain format\n  - Will be used to access the site\n- **Database name** (optional, defaults to site name with special chars removed)\n- **MariaDB/PostgreSQL root password** (for database creation)\n- **Admin password** (for Administrator user)\n  - Suggest strong password or offer to generate one\n- **Install demo data?** (yes/no)\n\n### 3. Pre-creation Checks\nBefore creating the site:\n- Check if site name already exists in `sites/` directory\n- Verify database connectivity (test root password)\n- Check disk space (warn if < 1GB free)\n- Verify required services are running:\n  - MySQL/MariaDB or PostgreSQL\n  - Redis (both cache and queue)\n\n### 4. Create the Site\nExecute the site creation command with appropriate flags:\n\n```bash\nbench new-site [site-name] \\\n  --admin-password [password] \\\n  --mariadb-root-password [root-password] \\\n  [--db-name [custom-db-name]] \\\n  [--install-app erpnext] \\\n  [--verbose]\n```\n\nOptions to consider:\n- `--db-name`: Custom database name if specified\n- `--db-type postgres`: If using PostgreSQL instead of MariaDB\n- `--install-app`: Install specific apps during creation\n- `--verbose`: Show detailed output\n- `--source_sql`: Import from SQL file (for cloning)\n\n### 5. Verify Site Creation\nAfter creation, verify:\n- Site directory exists at `sites/[site-name]/`\n- Check for essential files:\n  - `sites/[site-name]/site_config.json`\n  - `sites/[site-name]/private/backups/`\n  - `sites/[site-name]/public/files/`\n- Database was created successfully\n- Administrator user exists and can login\n\nTest site accessibility:\n```bash\nbench --site [site-name] console\n```\n\n### 6. Install Additional Apps (Optional)\nAsk if user wants to install additional apps:\n- List available apps in bench with `bench --site [site-name] list-apps`\n- Offer to install common apps:\n  - ERPNext (if not already installed)\n  - Custom apps in `apps/` directory\n\nFor each app to install:\n```bash\nbench --site [site-name] install-app [app-name]\n```\n\n### 7. Configure Site Settings\nOffer to configure common settings:\n\n**Email Settings:**\n- Mail server (SMTP)\n- Email account\n- Port and encryption\n\n**Site Settings:**\n- Enable/disable signup\n- Session timeout\n- File size limits\n- Background job settings\n\n**Developer Mode:**\n- Ask if this is a development site\n- If yes, enable developer mode:\n```bash\nbench --site [site-name] set-config developer_mode 1\nbench --site [site-name] clear-cache\n```\n\n### 8. Set Default Site (Optional)\nAsk if this should be the default site:\n```bash\nbench use [site-name]\n```\n\nThis allows running bench commands without `--site` flag.\n\n### 9. Post-creation Steps\nProvide guidance on next steps:\n\n**Access the Site:**\n```bash\nbench start\n```\nThen visit: `http://[site-name]:8000` (or configured port)\n\nLogin credentials:\n- Username: `Administrator`\n- Password: `[admin-password]`\n\n**Common Operations:**\n- View site info: `bench --site [site-name] info`\n- Backup site: `bench --site [site-name] backup`\n- Reset site: `bench --site [site-name] reinstall`\n- Delete site: `bench drop-site [site-name]`\n\n**Troubleshooting:**\n- If site doesn't load, check Redis: `redis-cli ping`\n- Check database connection: `bench --site [site-name] mariadb`\n- View site config: `cat sites/[site-name]/site_config.json`\n- Check logs: `tail -f logs/web.error.log`\n\n### 10. Site Management Tips\nProvide helpful information:\n\n**Multi-tenancy:**\n- Multiple sites can run on same bench\n- Each site has separate database\n- Shared apps and Python environment\n\n**DNS/Hosts Configuration:**\nFor local development, add to `/etc/hosts`:\n```\n127.0.0.1   mysite.local\n```\n\n**Production Considerations:**\n- Use proper domain names\n- Set up SSL certificates\n- Configure DNS properly\n- Use production config (not developer mode)\n- Set up regular backups\n\n**Useful Commands:**\n- List all sites: `bench --site all list-apps`\n- Site console: `bench --site [site-name] console`\n- Migrate site: `bench --site [site-name] migrate`\n- Clear cache: `bench --site [site-name] clear-cache`\n- Set config: `bench --site [site-name] set-config [key] [value]`\n\n## Error Handling\n\n### Common Errors:\n\n**\"Could not connect to database\"**\n- Verify MariaDB/PostgreSQL is running\n- Check root password is correct\n- Ensure database user has permissions\n\n**\"Site already exists\"**\n- Choose different site name\n- Or delete existing site: `bench drop-site [site-name]`\n\n**\"Redis connection failed\"**\n- Start Redis: `sudo systemctl start redis-server`\n- Check Redis config in `common_site_config.json`\n\n**\"Permission denied\"**\n- Check directory permissions\n- May need to run as frappe user\n- Check disk space\n\n## Security Best Practices\n\n- Use strong admin passwords (16+ characters)\n- Don't use default passwords in production\n- Limit database user permissions\n- Enable SSL/HTTPS in production\n- Regular backups\n- Keep Frappe and apps updated\n\n## Important Notes\n\n- Site creation requires database root password (one-time)\n- Admin password is for the Administrator user\n- Site name should be a valid domain (use .local for dev)\n- Developer mode should only be enabled in development\n- Each site is isolated with its own database\n- Apps must be installed per-site after creation\n\n## Documentation References\n\n**Official Frappe Documentation:**\n- Site Management: https://frappeframework.com/docs/user/en/bench/reference/sites\n- Bench CLI: https://frappeframework.com/docs/user/en/bench/reference/bench-cli\n- Site Configuration: https://frappeframework.com/docs/user/en/basics/site_config\n- Multi-tenancy: https://frappeframework.com/docs/user/en/bench/guides/setup-multitenancy\n\n**Core Frappe Commands:**\n- `bench new-site`: Create new site - https://frappeframework.com/docs/user/en/bench/reference/bench-cli#new-site\n- `bench use`: Set default site - https://frappeframework.com/docs/user/en/bench/reference/bench-cli#use\n- `bench drop-site`: Delete site - https://frappeframework.com/docs/user/en/bench/reference/bench-cli#drop-site\n\n## Frappe Core Apps Reference\n\nWhen creating a new site, you may want to install these core apps:\n\n**1. frappe (Required)**\n- Automatically installed with every site\n- Provides core framework functionality\n- Repository: https://github.com/frappe/frappe\n- Includes: DocTypes, Users, Roles, Permissions, Workflows\n\n**2. erpnext (Optional)**\n- Full-featured ERP system\n- Install during site creation: `--install-app erpnext`\n- Or install later: `bench --site [site-name] install-app erpnext`\n- Repository: https://github.com/frappe/erpnext\n- Modules: Accounting, Inventory, HR, CRM, Projects, Manufacturing, etc.\n\n**3. hrms (Optional)**\n- Human Resource Management System\n- Requires ERPNext\n- Repository: https://github.com/frappe/hrms\n- Install: `bench --site [site-name] install-app hrms`\n\n**4. payments (Optional)**\n- Payment gateway integrations\n- Repository: https://github.com/frappe/payments\n- Install: `bench --site [site-name] install-app payments`\n\n**5. healthcare (Optional)**\n- Healthcare management module\n- Repository: https://github.com/frappe/healthcare\n- Install: `bench --site [site-name] install-app healthcare`\n\n**Checking Available Apps:**\n```bash\n# List all apps in bench\nls apps/\n\n# List apps installed on specific site\nbench --site [site-name] list-apps\n\n# Check app version\nbench version\n```"
              },
              {
                "name": "/frappe-role-manager",
                "description": "Manage user roles and permissions - create roles, assign permissions, manage access",
                "path": "frappe-apps-manager/commands/frappe-role-manager.md",
                "frontmatter": {
                  "description": "Manage user roles and permissions - create roles, assign permissions, manage access"
                },
                "content": "# Frappe Role Manager Command\n\nComprehensive role and permission management for Frappe applications including role creation, permission assignment, and access control.\n\n## Steps to Execute\n\n### 1. Verify Environment\n- Check if in valid Frappe bench\n- Verify site exists\n- Ensure user has System Manager role\n\n### 2. Operation Selection\n\nAsk user what they want to do:\n\n**A. Create New Role**\n- Define role name\n- Set role permissions\n- Assign to users\n\n**B. Manage Permissions**\n- View permission matrix\n- Add/remove permissions\n- Set permission levels\n\n**C. Assign Roles to Users**\n- Add roles to user\n- Remove roles from user\n- View user roles\n\n**D. Test Permissions**\n- Test user access to DocType\n- Verify permission rules\n- Debug permission issues\n\n### 3. Role Creation\n\n**Create New Role:**\n```bash\nbench --site [site-name] console\n```\n\n```python\n# Create role\nrole = frappe.get_doc({\n    'doctype': 'Role',\n    'role_name': 'Custom Role',\n    'desk_access': 1,  # Can access desk\n    'disabled': 0\n})\nrole.insert()\nfrappe.db.commit()\n```\n\n**Role Properties:**\n- `role_name`: Unique role identifier\n- `desk_access`: 1 = Can access desk, 0 = Portal only\n- `two_factor_auth`: Require 2FA for this role\n- `disabled`: 1 = Role disabled\n\n### 4. Permission Management\n\n**Add Permissions to DocType:**\n```python\n# Via console\nfrom frappe.permissions import add_permission\n\nadd_permission('Customer', 'Custom Role', perm_level=0)\n\n# Set specific permissions\nadd_permission('Customer', 'Custom Role',\n    read=1, write=1, create=1, delete=0,\n    submit=0, cancel=0, amend=0)\n\nfrappe.db.commit()\n```\n\n**View Permission Matrix:**\n```python\n# Get all permissions for DocType\npermissions = frappe.get_all('Custom DocPerm',\n    filters={'parent': 'Customer'},\n    fields=['role', 'read', 'write', 'create', 'delete', 'submit']\n)\nprint(permissions)\n```\n\n**Remove Permissions:**\n```python\nfrom frappe.permissions import remove_permission\n\nremove_permission('Customer', 'Custom Role')\nfrappe.db.commit()\n```\n\n### 5. User Role Assignment\n\n**Add Roles to User:**\n```bash\nbench --site [site-name] add-user-role user@example.com \"Custom Role\"\n```\n\nOr via console:\n```python\nuser = frappe.get_doc('User', 'user@example.com')\nuser.add_roles('Custom Role', 'Sales User')\nfrappe.db.commit()\n```\n\n**Remove Roles:**\n```python\nuser = frappe.get_doc('User', 'user@example.com')\nuser.remove_roles('Custom Role')\nfrappe.db.commit()\n```\n\n**View User Roles:**\n```python\nuser = frappe.get_doc('User', 'user@example.com')\nroles = [r.role for r in user.roles]\nprint(roles)\n```\n\n### 6. Permission Testing\n\n**Test User Access:**\n```python\n# Set user context\nfrappe.set_user('user@example.com')\n\n# Test read permission\ncan_read = frappe.has_permission('Customer', 'read')\nprint(f\"Can read: {can_read}\")\n\n# Test write permission\ncan_write = frappe.has_permission('Customer', 'write')\nprint(f\"Can write: {can_write}\")\n\n# Test specific document\ncan_access = frappe.has_permission('Customer', 'read', 'CUST-001')\nprint(f\"Can access CUST-001: {can_access}\")\n```\n\n**Debug Permission Issues:**\n```python\n# Get permission log\nfrappe.set_user('user@example.com')\ntry:\n    doc = frappe.get_doc('Customer', 'CUST-001')\nexcept frappe.PermissionError as e:\n    print(f\"Permission denied: {e}\")\n    print(frappe.get_traceback())\n```\n\n### 7. Advanced Permission Scenarios\n\n**User Permissions (Restrict Access):**\n```python\n# Limit user to specific customer\nfrom frappe.permissions import add_user_permission\n\nadd_user_permission('Customer', 'CUST-001', 'user@example.com')\nfrappe.db.commit()\n\n# User can only access CUST-001\n```\n\n**Remove User Permission:**\n```python\nfrom frappe.permissions import remove_user_permission\n\nremove_user_permission('Customer', 'CUST-001', 'user@example.com')\nfrappe.db.commit()\n```\n\n**View User Permissions:**\n```python\nperms = frappe.get_all('User Permission',\n    filters={'user': 'user@example.com'},\n    fields=['allow', 'for_value', 'applicable_for']\n)\nprint(perms)\n```\n\n### 8. Permission Rules\n\n**Set Field-Level Permissions:**\n```python\n# Make field read-only for specific role\n# Edit DocType JSON or use Property Setter\n\nfrappe.make_property_setter({\n    'doctype': 'Customer',\n    'fieldname': 'credit_limit',\n    'property': 'permlevel',\n    'value': 1\n})\n\n# Set permission for level 1\nadd_permission('Customer', 'Sales Manager',\n    perm_level=1, read=1, write=1)\n```\n\n**If Condition Permissions:**\n```python\n# Add permission with condition\n# Via DocType permission editor or console\n\nperm = frappe.get_doc({\n    'doctype': 'Custom DocPerm',\n    'parent': 'Sales Invoice',\n    'parenttype': 'DocType',\n    'role': 'Sales User',\n    'if_owner': 1,  # Only if user created the doc\n    'read': 1,\n    'write': 1\n})\nperm.insert()\nfrappe.db.commit()\n```\n\n### 9. Role Hierarchy\n\n**Standard Frappe Roles:**\n```\nSystem Manager (highest)\n‚îú‚îÄ‚îÄ Administrator\n‚îú‚îÄ‚îÄ All (all logged-in users)\n‚îú‚îÄ‚îÄ Guest (not logged in)\n‚îî‚îÄ‚îÄ Custom Roles\n    ‚îú‚îÄ‚îÄ Sales Manager\n    ‚îú‚îÄ‚îÄ Sales User\n    ‚îú‚îÄ‚îÄ Purchase Manager\n    ‚îú‚îÄ‚îÄ Purchase User\n    ‚îú‚îÄ‚îÄ Stock Manager\n    ‚îî‚îÄ‚îÄ Stock User\n```\n\n**Check Role Hierarchy:**\n```python\n# Get roles for user including inherited\nuser_roles = frappe.get_roles('user@example.com')\nprint(user_roles)\n```\n\n### 10. Permission Reports\n\n**Generate Permission Matrix:**\n```python\n# All permissions for DocType\nmatrix = frappe.db.sql(\"\"\"\n    SELECT\n        role, read, write, create, delete,\n        submit, cancel, amend\n    FROM `tabCustom DocPerm`\n    WHERE parent = %s\n    ORDER BY permlevel, role\n\"\"\", ('Customer',), as_dict=True)\n\nfor row in matrix:\n    print(f\"{row.role}: R={row.read} W={row.write} C={row.create}\")\n```\n\n**User Access Report:**\n```python\n# All DocTypes accessible by user\nfrappe.set_user('user@example.com')\naccessible = []\n\nfor doctype in frappe.get_all('DocType', pluck='name'):\n    if frappe.has_permission(doctype, 'read'):\n        accessible.append(doctype)\n\nprint(f\"Accessible DocTypes: {accessible}\")\n```\n\n## References\n\n### Frappe Core Permission Examples (Primary Reference)\n\n**Frappe Permission Module:**\n- Permissions Core: https://github.com/frappe/frappe/blob/develop/frappe/permissions.py\n- Has Permission: https://github.com/frappe/frappe/blob/develop/frappe/permissions.py#L50\n- Permission Query: https://github.com/frappe/frappe/blob/develop/frappe/permissions.py#L300\n\n**ERPNext Permission Patterns:**\n- Sales Invoice Permissions: https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/sales_invoice/sales_invoice.json\n- Item Permissions: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/doctype/item/item.json\n\n**Real Permission Patterns:**\n\n1. **Role-Based Access** (from Sales Invoice):\n```json\n{\n  \"permissions\": [\n    {\n      \"role\": \"Sales User\",\n      \"read\": 1,\n      \"write\": 1,\n      \"create\": 1\n    },\n    {\n      \"role\": \"Sales Manager\",\n      \"read\": 1,\n      \"write\": 1,\n      \"create\": 1,\n      \"delete\": 1,\n      \"submit\": 1,\n      \"cancel\": 1\n    },\n    {\n      \"role\": \"Accounts User\",\n      \"read\": 1,\n      \"submit\": 1\n    }\n  ]\n}\n```\n\n2. **Owner-Only Access**:\n```json\n{\n  \"role\": \"Sales User\",\n  \"if_owner\": 1,\n  \"read\": 1,\n  \"write\": 1,\n  \"delete\": 1\n}\n```\n\n3. **Programmatic Permission Check** (from ERPNext):\n```python\n# See: erpnext/accounts/doctype/sales_invoice/sales_invoice.py\ndef has_permission(doc, ptype, user):\n    if ptype == 'write' and doc.docstatus == 1:\n        return False  # Cannot edit submitted docs\n    return True\n```\n\n### Official Documentation (Secondary Reference)\n\n- Permission System: https://frappeframework.com/docs/user/en/basics/users-and-permissions\n- Role Permissions: https://frappeframework.com/docs/user/en/basics/users-and-permissions/role-based-permissions\n- User Permissions: https://frappeframework.com/docs/user/en/basics/users-and-permissions/user-permissions\n\n## Best Practices\n\n1. **Principle of Least Privilege:** Grant minimum required permissions\n2. **Role Hierarchy:** Use manager roles for elevated permissions\n3. **Test Thoroughly:** Always test permissions with actual users\n4. **Document Roles:** Clearly document role purposes\n5. **Regular Audits:** Review permissions periodically\n6. **User Permissions:** Use for data isolation (multi-tenant)\n7. **Field-Level:** Use permission levels for sensitive fields\n8. **If Owner:** Use for user-specific data access\n9. **Submit/Cancel:** Restrict to manager roles\n10. **Delete:** Restrict delete permissions carefully\n\n## Security Considerations\n\n- Never give delete permission to all users\n- Restrict System Manager role to admins only\n- Use User Permissions for data segregation\n- Test permissions before deploying\n- Review permission logs regularly\n- Disable unused roles\n- Set password policies\n- Enable 2FA for sensitive roles\n- Monitor permission changes\n- Document permission schema\n\n## Common Role Templates\n\n**Sales Team:**\n- Sales User: Create/read/write Sales documents\n- Sales Manager: All Sales operations + submit/cancel\n\n**Inventory Team:**\n- Stock User: Create stock transactions\n- Stock Manager: All stock operations + reports\n\n**Accounts Team:**\n- Accounts User: Create accounting entries\n- Accounts Manager: All accounting + submit invoices\n\n**Support Team:**\n- Support User: Read-only access to customer data\n- Support Manager: Create/update support tickets\n\n## Important Notes\n\n- Permissions cached - clear cache after changes\n- User Permissions restrict data access\n- Role Permissions grant capabilities\n- Combine both for fine-grained control\n- Permission check happens on every database read\n- Custom permissions via `has_permission` method\n- Test with actual users, not Administrator\n- Document your permission model"
              },
              {
                "name": "/frappe-test",
                "description": "Run unit and integration tests for Frappe apps with coverage reports",
                "path": "frappe-apps-manager/commands/frappe-test.md",
                "frontmatter": {
                  "description": "Run unit and integration tests for Frappe apps with coverage reports"
                },
                "content": "# Frappe Test Command\n\nExecute comprehensive tests for Frappe applications including unit tests, integration tests, and generate coverage reports.\n\n## Steps to Execute\n\n### 1. Verify Test Environment\n- Check if current directory is a valid Frappe bench\n- Verify bench command is available\n- Check if site exists for testing\n- Ensure test dependencies are installed:\n  ```bash\n  pip install coverage pytest\n  ```\n\n### 2. Determine Test Scope\nAsk user what they want to test:\n\n**A. Specific DocType**\n- App name\n- Module name\n- DocType name\n- Example: `test_[doctype_name].py`\n\n**B. Specific App**\n- App name only\n- Tests all modules in the app\n\n**C. All Apps**\n- Run complete test suite\n- May take significant time\n\n**D. Specific Test File/Function**\n- Full path to test file\n- Optional: specific test function name\n\n### 3. Test Execution Options\n\nOffer test configuration options:\n\n**Basic Options:**\n- `--verbose`: Show detailed test output\n- `--failfast`: Stop on first failure\n- `--profile`: Profile test execution time\n\n**Coverage Options:**\n- `--coverage`: Generate coverage report\n- `--html-coverage`: Generate HTML coverage report\n- Coverage threshold (warning if below X%)\n\n**Test Filtering:**\n- Run specific test methods\n- Skip certain tests\n- Test by markers/tags\n\n### 4. Run Tests\n\nExecute appropriate test command based on scope:\n\n**Test Specific DocType:**\n```bash\nbench --site [site-name] run-tests \\\n  --app [app-name] \\\n  --doctype \"[DocType Name]\" \\\n  [--verbose] \\\n  [--coverage]\n```\n\n**Test Specific App:**\n```bash\nbench --site [site-name] run-tests \\\n  --app [app-name] \\\n  [--module [module-name]] \\\n  [--verbose] \\\n  [--coverage]\n```\n\n**Test All Apps:**\n```bash\nbench --site [site-name] run-tests \\\n  [--verbose] \\\n  [--coverage]\n```\n\n**Test Specific File:**\n```bash\nbench --site [site-name] run-tests \\\n  --test [path/to/test_file.py] \\\n  [--verbose]\n```\n\n**Test with Coverage:**\n```bash\nbench --site [site-name] run-tests \\\n  --app [app-name] \\\n  --coverage \\\n  --coverage-report-html\n```\n\n### 5. Monitor Test Execution\n\nDisplay progress information:\n- Number of tests running\n- Current test being executed\n- Pass/fail status in real-time\n- Execution time per test (if --profile enabled)\n\n### 6. Analyze Test Results\n\nAfter test completion, show:\n\n**Test Summary:**\n- Total tests run\n- Tests passed ‚úì\n- Tests failed ‚úó\n- Tests skipped ‚äò\n- Execution time\n\n**Failed Test Details:**\nFor each failed test:\n- Test name and location\n- Failure reason/assertion\n- Stack trace\n- Error message\n\n**Coverage Report (if enabled):**\n```\nName                                    Stmts   Miss  Cover\n-----------------------------------------------------------\nmy_app/my_module/doctype/my_doctype.py    150     20    87%\nmy_app/api.py                              80     10    88%\n-----------------------------------------------------------\nTOTAL                                     230     30    87%\n```\n\n### 7. HTML Coverage Report\n\nIf HTML coverage requested, generate and show:\n```bash\n# Coverage report location\nfrappe-bench/sites/coverage_html/index.html\n\n# Open in browser (offer to open)\nxdg-open sites/coverage_html/index.html\n```\n\n### 8. Test Debugging Assistance\n\nIf tests fail, offer debugging help:\n\n**Common Issues:**\n- Missing test data/fixtures\n- Database state issues\n- Permission problems\n- Import errors\n- Timing/race conditions\n\n**Debugging Commands:**\n```bash\n# Run single test with pdb\nbench --site [site-name] run-tests --test [test-file] --pdb\n\n# Run tests with logging\nbench --site [site-name] run-tests --app [app-name] --verbose\n\n# Check test data\nbench --site [site-name] console\n```\n\n### 9. Continuous Testing Options\n\nSuggest setting up continuous testing:\n\n**Watch Mode:**\n```bash\n# Re-run tests on file changes (if using pytest-watch)\nptw -- bench --site [site-name] run-tests --app [app-name]\n```\n\n**Pre-commit Hooks:**\n```bash\n# Add to .git/hooks/pre-commit\n#!/bin/bash\nbench --site test_site run-tests --app my_app --failfast\n```\n\n### 10. Test Report Export\n\nOffer to export test results:\n\n**JUnit XML (for CI/CD):**\n```bash\nbench --site [site-name] run-tests \\\n  --app [app-name] \\\n  --junit-xml test-results.xml\n```\n\n**JSON Report:**\n```bash\nbench --site [site-name] run-tests \\\n  --app [app-name] \\\n  --json-report test-results.json\n```\n\n## Test Best Practices\n\n### Writing Good Tests\n\n**Test Structure:**\n```python\nimport frappe\nimport unittest\n\nclass TestMyDocType(unittest.TestCase):\n    def setUp(self):\n        \"\"\"Set up test fixtures\"\"\"\n        frappe.set_user(\"Administrator\")\n\n    def tearDown(self):\n        \"\"\"Clean up after test\"\"\"\n        frappe.db.rollback()\n\n    def test_creation(self):\n        \"\"\"Test DocType creation\"\"\"\n        doc = frappe.get_doc({\n            \"doctype\": \"My DocType\",\n            \"field1\": \"value1\"\n        })\n        doc.insert()\n        self.assertEqual(doc.field1, \"value1\")\n\n    def test_validation(self):\n        \"\"\"Test validation logic\"\"\"\n        doc = frappe.get_doc({\n            \"doctype\": \"My DocType\",\n            \"field1\": \"\"  # Required field\n        })\n        self.assertRaises(frappe.ValidationError, doc.insert)\n```\n\n**Test Categories:**\n- Unit tests: Test individual methods\n- Integration tests: Test DocType workflows\n- API tests: Test API endpoints\n- UI tests: Test client-side scripts\n\n### Test Data Management\n\n**Using Fixtures:**\n```python\ndef setUp(self):\n    # Load test fixtures\n    frappe.get_test_records(\"Item\")\n    frappe.get_test_records(\"Customer\")\n```\n\n**Creating Test Data:**\n```python\ndef create_test_customer(self):\n    customer = frappe.get_doc({\n        \"doctype\": \"Customer\",\n        \"customer_name\": \"Test Customer\",\n        \"customer_type\": \"Company\"\n    })\n    customer.insert(ignore_if_duplicate=True)\n    return customer\n```\n\n## Error Handling\n\n### Common Test Errors:\n\n**\"No module named 'coverage'\"**\n- Install: `pip install coverage`\n\n**\"Site does not exist\"**\n- Create test site: `bench new-site test_site`\n- Or specify existing site\n\n**\"Permission Error\"**\n- Tests run as Administrator by default\n- Check role permissions in test setup\n\n**\"Database Errors\"**\n- Ensure test database is clean\n- Use rollback in tearDown\n- Check foreign key constraints\n\n**\"Import Error\"**\n- App not installed on test site\n- Module path incorrect\n- Missing dependencies\n\n## Performance Tips\n\n### Speed Up Tests\n\n**Use Transaction Rollback:**\n```python\ndef tearDown(self):\n    frappe.db.rollback()  # Faster than deleting records\n```\n\n**Parallel Testing (Experimental):**\n```bash\nbench --site [site-name] run-tests --app [app-name] --parallel\n```\n\n**Skip Slow Tests in Development:**\n```python\n@unittest.skip(\"Slow integration test\")\ndef test_complex_workflow(self):\n    pass\n```\n\n**Use Test Markers:**\n```python\n@pytest.mark.slow\ndef test_heavy_operation(self):\n    pass\n\n# Run only fast tests\npytest -m \"not slow\"\n```\n\n## References\n\n### Frappe Core App Examples (Primary Reference)\n\n**Learn from Frappe Framework Tests:**\n- Frappe Core Tests: https://github.com/frappe/frappe/tree/develop/frappe/tests\n  - `test_db.py` - Database testing patterns\n  - `test_document.py` - DocType testing\n  - `test_permissions.py` - Permission testing\n  - `test_api.py` - API endpoint testing\n- Frappe Test Utilities: https://github.com/frappe/frappe/blob/develop/frappe/tests/utils.py\n- Frappe Test Base Class: https://github.com/frappe/frappe/blob/develop/frappe/tests/test_runner.py\n\n**ERPNext Test Examples:**\n- ERPNext Tests: https://github.com/frappe/erpnext/tree/develop/erpnext/tests\n- Accounting Tests: https://github.com/frappe/erpnext/tree/develop/erpnext/accounts/doctype\n  - `sales_invoice/test_sales_invoice.py` - Transaction testing\n  - `payment_entry/test_payment_entry.py` - Complex workflows\n- Stock Tests: https://github.com/frappe/erpnext/tree/develop/erpnext/stock/doctype\n  - `stock_entry/test_stock_entry.py` - Inventory testing\n  - `item/test_item.py` - Master data testing\n\n**Real Test Patterns from Core Apps:**\n\n1. **Transaction Testing** (from Sales Invoice):\n```python\n# See: erpnext/accounts/doctype/sales_invoice/test_sales_invoice.py\ndef test_sales_invoice_with_discount(self):\n    si = frappe.copy_doc(test_records[0])\n    si.discount_amount = 104.95\n    si.append(\"items\", {\n        \"item_code\": \"_Test Item\",\n        \"qty\": 10,\n        \"rate\": 100\n    })\n    si.insert()\n    si.submit()\n    self.assertEqual(si.total, 1000)\n    self.assertEqual(si.grand_total, 895.05)\n```\n\n2. **Permission Testing** (from Frappe Core):\n```python\n# See: frappe/tests/test_permissions.py\ndef test_user_permissions(self):\n    frappe.set_user(\"test@example.com\")\n    # Test read permission\n    doc = frappe.get_doc(\"DocType Name\", \"DOC-001\")\n    # Test write permission\n    doc.field = \"new_value\"\n    doc.save()\n```\n\n3. **API Testing** (from Frappe Core):\n```python\n# See: frappe/tests/test_api.py\ndef test_api_call(self):\n    from frappe.handler import execute_cmd\n    frappe.set_user(\"Administrator\")\n    response = execute_cmd(\"my_app.api.method_name\")\n    self.assertEqual(response[\"status\"], \"success\")\n```\n\n### Official Documentation (Secondary Reference)\n\n- Testing Guide: https://frappeframework.com/docs/user/en/testing\n- Test Runner CLI: https://frappeframework.com/docs/user/en/bench/reference/bench-cli#run-tests\n- Python unittest: https://docs.python.org/3/library/unittest.html\n\n## CI/CD Integration\n\n### GitHub Actions Example:\n```yaml\nname: Run Tests\n\non: [push, pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n      - name: Setup Bench\n        run: |\n          # Setup Frappe bench\n          bench init frappe-bench\n          cd frappe-bench\n          bench new-site test_site\n          bench --site test_site install-app my_app\n      - name: Run Tests\n        run: |\n          cd frappe-bench\n          bench --site test_site run-tests \\\n            --app my_app \\\n            --coverage \\\n            --junit-xml test-results.xml\n      - name: Publish Test Results\n        uses: EnricoMi/publish-unit-test-result-action@v1\n        if: always()\n        with:\n          files: frappe-bench/test-results.xml\n```\n\n## Advanced Testing\n\n### API Testing:\n```python\ndef test_api_endpoint(self):\n    response = frappe.get_doc({\n        \"doctype\": \"Integration Request\",\n        \"integration_type\": \"Remote\",\n        \"url\": \"/api/method/my_app.api.get_data\"\n    })\n    self.assertEqual(response.status_code, 200)\n```\n\n### Performance Testing:\n```python\ndef test_query_performance(self):\n    import time\n    start = time.time()\n\n    # Run query\n    frappe.db.get_all(\"Item\", limit=1000)\n\n    duration = time.time() - start\n    self.assertLess(duration, 1.0)  # Should complete in < 1 second\n```\n\n### Mock Testing:\n```python\nfrom unittest.mock import patch\n\ndef test_with_mock(self):\n    with patch('frappe.sendmail') as mock_email:\n        # Test email sending without actually sending\n        doc.send_notification()\n        mock_email.assert_called_once()\n```\n\n## Test Organization\n\n**Recommended Structure:**\n```\nmy_app/\n‚îú‚îÄ‚îÄ my_module/\n‚îÇ   ‚îî‚îÄ‚îÄ doctype/\n‚îÇ       ‚îî‚îÄ‚îÄ my_doctype/\n‚îÇ           ‚îú‚îÄ‚îÄ my_doctype.py\n‚îÇ           ‚îú‚îÄ‚îÄ my_doctype.json\n‚îÇ           ‚îú‚îÄ‚îÄ my_doctype.js\n‚îÇ           ‚îî‚îÄ‚îÄ test_my_doctype.py  ‚Üê Unit tests\n‚îú‚îÄ‚îÄ tests/\n‚îÇ   ‚îú‚îÄ‚îÄ __init__.py\n‚îÇ   ‚îú‚îÄ‚îÄ test_integration.py        ‚Üê Integration tests\n‚îÇ   ‚îî‚îÄ‚îÄ test_api.py                ‚Üê API tests\n‚îî‚îÄ‚îÄ fixtures/\n    ‚îî‚îÄ‚îÄ test_data.json             ‚Üê Test fixtures\n```\n\n## Important Notes\n\n- Always use a separate test site (never production!)\n- Tests should be independent and idempotent\n- Use setUp and tearDown for clean test state\n- Mock external services and APIs\n- Keep tests fast (< 1 second per test)\n- Aim for 80%+ code coverage\n- Write tests for bug fixes\n- Run tests before committing code"
              }
            ],
            "skills": [
              {
                "name": "frappe-api-handler",
                "description": "Create custom API endpoints and whitelisted methods for Frappe applications. Use when building REST APIs or custom endpoints.",
                "path": "frappe-apps-manager/skills/frappe-api-handler/SKILL.md",
                "frontmatter": {
                  "name": "frappe-api-handler",
                  "description": "Create custom API endpoints and whitelisted methods for Frappe applications. Use when building REST APIs or custom endpoints."
                },
                "content": "# Frappe API Handler Skill\n\nCreate secure, efficient custom API endpoints for Frappe applications.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to create custom API endpoints\n- User needs to whitelist Python methods for API access\n- User asks about REST API implementation\n- User wants to integrate external systems with Frappe\n- User needs help with API authentication or permissions\n\n## Capabilities\n\n### 1. Whitelisted Methods\n\nCreate Python methods accessible via API:\n\n```python\nimport frappe\nfrom frappe import _\n\n@frappe.whitelist()\ndef get_customer_details(customer_name):\n    \"\"\"Get customer details with validation\"\"\"\n    # Permission check\n    if not frappe.has_permission(\"Customer\", \"read\"):\n        frappe.throw(_(\"Not permitted\"), frappe.PermissionError)\n\n    customer = frappe.get_doc(\"Customer\", customer_name)\n\n    return {\n        \"name\": customer.name,\n        \"customer_name\": customer.customer_name,\n        \"email\": customer.email_id,\n        \"phone\": customer.mobile_no,\n        \"outstanding_amount\": customer.get_outstanding()\n    }\n```\n\n### 2. API Method Patterns\n\n**Public Methods (No Authentication):**\n```python\n@frappe.whitelist(allow_guest=True)\ndef public_api_method():\n    \"\"\"Accessible without login\"\"\"\n    return {\"message\": \"Public data\"}\n```\n\n**Authenticated Methods:**\n```python\n@frappe.whitelist()\ndef authenticated_method():\n    \"\"\"Requires valid session or API key\"\"\"\n    user = frappe.session.user\n    return {\"user\": user}\n```\n\n**Permission-based Methods:**\n```python\n@frappe.whitelist()\ndef delete_customer(customer_name):\n    \"\"\"Check permissions before action\"\"\"\n    if not frappe.has_permission(\"Customer\", \"delete\"):\n        frappe.throw(_(\"Not permitted\"))\n\n    frappe.delete_doc(\"Customer\", customer_name)\n    return {\"message\": \"Customer deleted\"}\n```\n\n### 3. REST API Endpoints\n\n**GET Request Handler:**\n```python\n@frappe.whitelist()\ndef get_items(filters=None, fields=None, limit=20):\n    \"\"\"Get list of items with filters\"\"\"\n    filters = frappe.parse_json(filters) if isinstance(filters, str) else filters or {}\n    fields = frappe.parse_json(fields) if isinstance(fields, str) else fields or [\"*\"]\n\n    items = frappe.get_all(\n        \"Item\",\n        filters=filters,\n        fields=fields,\n        limit=limit,\n        order_by=\"creation desc\"\n    )\n\n    return {\"items\": items}\n```\n\n**POST Request Handler:**\n```python\n@frappe.whitelist()\ndef create_sales_order(customer, items, delivery_date=None):\n    \"\"\"Create sales order from API\"\"\"\n    items = frappe.parse_json(items) if isinstance(items, str) else items\n\n    doc = frappe.get_doc({\n        \"doctype\": \"Sales Order\",\n        \"customer\": customer,\n        \"delivery_date\": delivery_date or frappe.utils.today(),\n        \"items\": items\n    })\n\n    doc.insert()\n    doc.submit()\n\n    return {\"name\": doc.name, \"grand_total\": doc.grand_total}\n```\n\n**PUT/UPDATE Handler:**\n```python\n@frappe.whitelist()\ndef update_customer(customer_name, data):\n    \"\"\"Update customer details\"\"\"\n    data = frappe.parse_json(data) if isinstance(data, str) else data\n\n    doc = frappe.get_doc(\"Customer\", customer_name)\n    doc.update(data)\n    doc.save()\n\n    return {\"name\": doc.name, \"message\": \"Updated successfully\"}\n```\n\n**DELETE Handler:**\n```python\n@frappe.whitelist()\ndef delete_document(doctype, name):\n    \"\"\"Delete a document\"\"\"\n    if not frappe.has_permission(doctype, \"delete\"):\n        frappe.throw(_(\"Not permitted\"))\n\n    frappe.delete_doc(doctype, name)\n    return {\"message\": f\"{doctype} {name} deleted\"}\n```\n\n### 4. Error Handling\n\n```python\n@frappe.whitelist()\ndef safe_api_method(param):\n    \"\"\"API method with proper error handling\"\"\"\n    try:\n        # Validate input\n        if not param:\n            frappe.throw(_(\"Parameter is required\"))\n\n        # Process request\n        result = process_data(param)\n\n        return {\"success\": True, \"data\": result}\n\n    except frappe.ValidationError as e:\n        frappe.log_error(frappe.get_traceback(), \"API Validation Error\")\n        return {\"success\": False, \"message\": str(e)}\n\n    except Exception as e:\n        frappe.log_error(frappe.get_traceback(), \"API Error\")\n        return {\"success\": False, \"message\": \"Internal server error\"}\n```\n\n### 5. Input Validation\n\n```python\n@frappe.whitelist()\ndef validated_method(email, phone, amount):\n    \"\"\"Validate all inputs\"\"\"\n    # Email validation\n    if not frappe.utils.validate_email_address(email):\n        frappe.throw(_(\"Invalid email address\"))\n\n    # Phone validation\n    if not phone or len(phone) < 10:\n        frappe.throw(_(\"Invalid phone number\"))\n\n    # Amount validation\n    amount = frappe.utils.flt(amount)\n    if amount <= 0:\n        frappe.throw(_(\"Amount must be greater than zero\"))\n\n    return {\"valid\": True}\n```\n\n### 6. Pagination\n\n```python\n@frappe.whitelist()\ndef paginated_list(doctype, page=1, page_size=20, filters=None):\n    \"\"\"Get paginated results\"\"\"\n    filters = frappe.parse_json(filters) if isinstance(filters, str) else filters or {}\n\n    page = frappe.utils.cint(page)\n    page_size = frappe.utils.cint(page_size)\n\n    # Get total count\n    total = frappe.db.count(doctype, filters=filters)\n\n    # Get data\n    data = frappe.get_all(\n        doctype,\n        filters=filters,\n        fields=[\"*\"],\n        start=(page - 1) * page_size,\n        page_length=page_size,\n        order_by=\"creation desc\"\n    )\n\n    return {\n        \"data\": data,\n        \"total\": total,\n        \"page\": page,\n        \"page_size\": page_size,\n        \"total_pages\": (total + page_size - 1) // page_size\n    }\n```\n\n### 7. File Upload Handling\n\n```python\n@frappe.whitelist()\ndef upload_file():\n    \"\"\"Handle file upload\"\"\"\n    from frappe.utils.file_manager import save_file\n\n    if not frappe.request.files:\n        frappe.throw(_(\"No file uploaded\"))\n\n    file = frappe.request.files['file']\n\n    # Save file\n    file_doc = save_file(\n        fname=file.filename,\n        content=file.stream.read(),\n        dt=\"Customer\",  # DocType\n        dn=\"CUST-001\",  # Document name\n        is_private=1\n    )\n\n    return {\n        \"file_url\": file_doc.file_url,\n        \"file_name\": file_doc.file_name\n    }\n```\n\n### 8. Bulk Operations\n\n```python\n@frappe.whitelist()\ndef bulk_create(doctype, records):\n    \"\"\"Create multiple documents\"\"\"\n    records = frappe.parse_json(records) if isinstance(records, str) else records\n\n    created = []\n    errors = []\n\n    for record in records:\n        try:\n            doc = frappe.get_doc(record)\n            doc.insert()\n            created.append(doc.name)\n        except Exception as e:\n            errors.append({\n                \"record\": record,\n                \"error\": str(e)\n            })\n\n    return {\n        \"created\": created,\n        \"errors\": errors,\n        \"success_count\": len(created),\n        \"error_count\": len(errors)\n    }\n```\n\n### 9. API Response Formats\n\n**Success Response:**\n```python\nreturn {\n    \"success\": True,\n    \"data\": result,\n    \"message\": \"Operation completed successfully\"\n}\n```\n\n**Error Response:**\n```python\nreturn {\n    \"success\": False,\n    \"message\": \"Error message\",\n    \"errors\": validation_errors\n}\n```\n\n**List Response:**\n```python\nreturn {\n    \"success\": True,\n    \"data\": items,\n    \"total\": total_count,\n    \"page\": current_page\n}\n```\n\n### 10. Authentication Patterns\n\n**API Key/Secret:**\n```python\n@frappe.whitelist(allow_guest=True)\ndef api_key_method():\n    \"\"\"Authenticate using API key\"\"\"\n    api_key = frappe.get_request_header(\"Authorization\")\n\n    if not api_key:\n        frappe.throw(_(\"API key required\"))\n\n    # Validate API key\n    user = frappe.db.get_value(\"User\", {\"api_key\": api_key}, \"name\")\n    if not user:\n        frappe.throw(_(\"Invalid API key\"))\n\n    frappe.set_user(user)\n\n    # Process request\n    return {\"authenticated\": True}\n```\n\n**Token-based:**\n```python\n@frappe.whitelist(allow_guest=True)\ndef token_auth():\n    \"\"\"JWT or custom token authentication\"\"\"\n    token = frappe.get_request_header(\"Authorization\", \"\").replace(\"Bearer \", \"\")\n\n    if not token:\n        frappe.throw(_(\"Token required\"))\n\n    # Validate token\n    user_data = validate_token(token)\n    frappe.set_user(user_data[\"email\"])\n\n    return {\"authenticated\": True}\n```\n\n## API Endpoint URLs\n\nMethods are accessible at:\n```\n/api/method/{app_name}.{module}.{file}.{method_name}\n```\n\nExample:\n```\nPOST /api/method/my_app.api.customer.get_customer_details\nContent-Type: application/json\n\n{\n  \"customer_name\": \"CUST-001\"\n}\n```\n\n## Best Practices\n\n1. **Always validate inputs** - Never trust user data\n2. **Check permissions** - Use `frappe.has_permission()`\n3. **Handle errors gracefully** - Return user-friendly messages\n4. **Log errors** - Use `frappe.log_error()` for debugging\n5. **Use transactions** - Wrap multiple operations in `frappe.db.commit()`\n6. **Rate limiting** - Consider implementing for public APIs\n7. **Version your APIs** - Include version in URL or headers\n8. **Document your APIs** - Provide clear documentation\n9. **Use HTTP status codes** - Return appropriate codes\n10. **Sanitize output** - Don't expose sensitive data\n\n## File Location\n\nAPI methods should be placed in:\n```\napps/<app_name>/api.py\n```\nor\n```\napps/<app_name>/<module>/api.py\n```\n\n## Testing APIs\n\nUse curl or Postman:\n```bash\n# With session\ncurl -X POST \\\n  http://localhost:8000/api/method/my_app.api.get_items \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"filters\": {\"item_group\": \"Products\"}}'\n\n# With API key\ncurl -X POST \\\n  http://localhost:8000/api/method/my_app.api.get_items \\\n  -H \"Authorization: token xxx:yyy\" \\\n  -d '{\"filters\": {\"item_group\": \"Products\"}}'\n```\n\nRemember: This skill is model-invoked. Claude will use it autonomously when detecting API development tasks."
              },
              {
                "name": "frappe-client-script-generator",
                "description": "Generate JavaScript client-side form scripts for Frappe DocTypes. Use when creating form customizations, field validations, custom buttons, or client-side logic for Frappe/ERPNext forms.",
                "path": "frappe-apps-manager/skills/frappe-client-script-generator/SKILL.md",
                "frontmatter": {
                  "name": "frappe-client-script-generator",
                  "description": "Generate JavaScript client-side form scripts for Frappe DocTypes. Use when creating form customizations, field validations, custom buttons, or client-side logic for Frappe/ERPNext forms."
                },
                "content": "# Frappe Client Script Generator\n\nGenerate production-ready JavaScript form scripts for Frappe DocTypes with proper event handlers, validations, and custom functionality.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to add client-side form customizations\n- User needs field validations or calculations\n- User requests custom buttons or actions on forms\n- User wants to filter or fetch data dynamically\n- User mentions form scripts, client scripts, or JavaScript for DocTypes\n- User wants to show/hide fields conditionally\n- User needs to set field values based on other fields\n\n## Capabilities\n\n### 1. Form Event Handlers\n\nGenerate event handlers for DocType forms following Frappe patterns from core apps.\n\n**Refresh Event** (runs when form loads):\n```javascript\n// Pattern from: erpnext/accounts/doctype/sales_invoice/sales_invoice.js\nfrappe.ui.form.on('Sales Invoice', {\n    refresh: function(frm) {\n        // Add custom buttons\n        if (frm.doc.docstatus === 1) {\n            frm.add_custom_button(__('Create Payment'), function() {\n                frm.events.make_payment_entry(frm);\n            });\n        }\n\n        // Set field properties\n        frm.set_df_property('customer', 'reqd', 1);\n\n        // Show/hide fields\n        frm.toggle_display('discount_section', frm.doc.apply_discount);\n    }\n});\n```\n\n**Setup Event** (runs once when form is created):\n```javascript\n// Pattern from: erpnext/stock/doctype/stock_entry/stock_entry.js\nfrappe.ui.form.on('Stock Entry', {\n    setup: function(frm) {\n        // Set query filters for Link fields\n        frm.set_query('item_code', 'items', function() {\n            return {\n                filters: {\n                    'is_stock_item': 1,\n                    'has_serial_no': 0\n                }\n            };\n        });\n    }\n});\n```\n\n**Onload Event** (runs on form load, before refresh):\n```javascript\n// Pattern from: erpnext/accounts/doctype/payment_entry/payment_entry.js\nfrappe.ui.form.on('Payment Entry', {\n    onload: function(frm) {\n        if (frm.is_new()) {\n            frm.set_value('posting_date', frappe.datetime.get_today());\n        }\n    }\n});\n```\n\n### 2. Field Change Handlers\n\n**Single Field Change**:\n```javascript\n// Pattern from: erpnext/selling/doctype/sales_order/sales_order.js\nfrappe.ui.form.on('Sales Order', {\n    customer: function(frm) {\n        if (frm.doc.customer) {\n            // Fetch customer details\n            frappe.db.get_value('Customer', frm.doc.customer, 'customer_group')\n                .then(r => {\n                    if (r.message) {\n                        frm.set_value('customer_group', r.message.customer_group);\n                    }\n                });\n        }\n    }\n});\n```\n\n**Multiple Field Dependencies**:\n```javascript\n// Pattern from: erpnext/accounts/doctype/sales_invoice/sales_invoice.js\nfrappe.ui.form.on('Sales Invoice', {\n    customer: function(frm) {\n        frm.events.set_dynamic_field_label(frm);\n    },\n    currency: function(frm) {\n        frm.events.set_dynamic_field_label(frm);\n    },\n    set_dynamic_field_label: function(frm) {\n        if (frm.doc.currency) {\n            frm.set_currency_labels(['total', 'grand_total'], frm.doc.currency);\n        }\n    }\n});\n```\n\n### 3. Child Table (Grid) Events\n\n**Child Table Row Events**:\n```javascript\n// Pattern from: erpnext/accounts/doctype/sales_invoice/sales_invoice_item.js\nfrappe.ui.form.on('Sales Invoice Item', {\n    item_code: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        if (row.item_code) {\n            frappe.call({\n                method: 'erpnext.stock.get_item_details.get_item_details',\n                args: {\n                    item_code: row.item_code,\n                    company: frm.doc.company\n                },\n                callback: function(r) {\n                    if (r.message) {\n                        frappe.model.set_value(cdt, cdn, 'rate', r.message.price_list_rate);\n                        frappe.model.set_value(cdt, cdn, 'uom', r.message.stock_uom);\n                    }\n                }\n            });\n        }\n    },\n\n    qty: function(frm, cdt, cdn) {\n        frm.events.calculate_totals(frm, cdt, cdn);\n    },\n\n    rate: function(frm, cdt, cdn) {\n        frm.events.calculate_totals(frm, cdt, cdn);\n    }\n});\n```\n\n**Grid Operations**:\n```javascript\n// Pattern from: erpnext/stock/doctype/stock_entry/stock_entry.js\nfrappe.ui.form.on('Stock Entry', {\n    items_add: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        row.s_warehouse = frm.doc.from_warehouse;\n        row.t_warehouse = frm.doc.to_warehouse;\n    },\n\n    items_remove: function(frm) {\n        frm.events.calculate_totals(frm);\n    }\n});\n```\n\n### 4. Custom Buttons and Actions\n\n**Standard Button Patterns**:\n```javascript\n// Pattern from: erpnext/accounts/doctype/sales_invoice/sales_invoice.js\nfrappe.ui.form.on('Sales Invoice', {\n    refresh: function(frm) {\n        if (frm.doc.docstatus === 1 && frm.doc.outstanding_amount > 0) {\n            frm.add_custom_button(__('Payment'), function() {\n                frm.events.make_payment_entry(frm);\n            }, __('Create'));\n        }\n\n        // Add custom button in toolbar\n        if (frm.doc.docstatus === 0) {\n            frm.add_custom_button(__('Get Items from Sales Order'), function() {\n                erpnext.utils.map_current_doc({\n                    method: 'erpnext.selling.doctype.sales_order.sales_order.make_sales_invoice',\n                    source_doctype: 'Sales Order',\n                    target: frm,\n                    setters: {\n                        customer: frm.doc.customer || undefined\n                    },\n                    get_query_filters: {\n                        docstatus: 1,\n                        status: ['not in', ['Closed', 'On Hold']]\n                    }\n                });\n            });\n        }\n    },\n\n    make_payment_entry: function(frm) {\n        return frappe.call({\n            method: 'erpnext.accounts.doctype.payment_entry.payment_entry.get_payment_entry',\n            args: {\n                dt: frm.doc.doctype,\n                dn: frm.doc.name\n            },\n            callback: function(r) {\n                let doc = frappe.model.sync(r.message);\n                frappe.set_route('Form', doc[0].doctype, doc[0].name);\n            }\n        });\n    }\n});\n```\n\n### 5. Data Fetching and API Calls\n\n**Fetch from Database**:\n```javascript\n// Pattern from: erpnext/stock/doctype/item/item.js\nfrappe.ui.form.on('Item', {\n    item_group: function(frm) {\n        if (frm.doc.item_group) {\n            frappe.db.get_value('Item Group', frm.doc.item_group, 'default_warehouse')\n                .then(r => {\n                    if (r.message && r.message.default_warehouse) {\n                        frm.set_value('default_warehouse', r.message.default_warehouse);\n                    }\n                });\n        }\n    }\n});\n```\n\n**Server Method Calls**:\n```javascript\n// Pattern from: erpnext/accounts/doctype/payment_entry/payment_entry.js\nfrappe.ui.form.on('Payment Entry', {\n    party: function(frm) {\n        if (frm.doc.party_type && frm.doc.party) {\n            frappe.call({\n                method: 'erpnext.accounts.party.get_party_details',\n                args: {\n                    party: frm.doc.party,\n                    party_type: frm.doc.party_type,\n                    company: frm.doc.company\n                },\n                callback: function(r) {\n                    if (r.message) {\n                        frm.set_value('party_name', r.message.party_name);\n                        frm.set_value('party_account', r.message.party_account);\n                    }\n                }\n            });\n        }\n    }\n});\n```\n\n### 6. Form Validations\n\n**Before Save Validation**:\n```javascript\n// Pattern from: erpnext/accounts/doctype/sales_invoice/sales_invoice.js\nfrappe.ui.form.on('Sales Invoice', {\n    validate: function(frm) {\n        // Validate posting date\n        if (frm.doc.posting_date > frappe.datetime.get_today()) {\n            frappe.throw(__('Posting Date cannot be future date'));\n        }\n\n        // Validate items\n        if (!frm.doc.items || frm.doc.items.length === 0) {\n            frappe.throw(__('Please add at least one item'));\n        }\n\n        // Validate total\n        if (frm.doc.grand_total <= 0) {\n            frappe.throw(__('Grand Total must be greater than 0'));\n        }\n    }\n});\n```\n\n**Before Submit Validation**:\n```javascript\n// Pattern from: erpnext/stock/doctype/stock_entry/stock_entry.js\nfrappe.ui.form.on('Stock Entry', {\n    before_submit: function(frm) {\n        let has_qty = false;\n        frm.doc.items.forEach(function(item) {\n            if (item.qty > 0) {\n                has_qty = true;\n            }\n        });\n\n        if (!has_qty) {\n            frappe.throw(__('Please enter quantity for at least one item'));\n        }\n    }\n});\n```\n\n### 7. Conditional Field Display\n\n**Show/Hide Fields**:\n```javascript\n// Pattern from: erpnext/accounts/doctype/payment_entry/payment_entry.js\nfrappe.ui.form.on('Payment Entry', {\n    payment_type: function(frm) {\n        frm.events.toggle_fields(frm);\n    },\n\n    toggle_fields: function(frm) {\n        let is_receive = (frm.doc.payment_type === 'Receive');\n        let is_pay = (frm.doc.payment_type === 'Pay');\n\n        frm.toggle_display('paid_from', is_pay);\n        frm.toggle_display('paid_to', is_receive);\n        frm.toggle_reqd('paid_from', is_pay);\n        frm.toggle_reqd('paid_to', is_receive);\n    }\n});\n```\n\n**Field Property Changes**:\n```javascript\n// Pattern from: erpnext/selling/doctype/sales_order/sales_order.js\nfrappe.ui.form.on('Sales Order', {\n    refresh: function(frm) {\n        // Make field read-only based on condition\n        frm.set_df_property('customer', 'read_only', frm.doc.docstatus === 1);\n\n        // Change field label\n        frm.set_df_property('delivery_date', 'label',\n            frm.doc.order_type === 'Sales' ? __('Delivery Date') : __('Delivery By'));\n\n        // Set field as mandatory\n        frm.toggle_reqd('delivery_date', frm.doc.order_type === 'Sales');\n    }\n});\n```\n\n### 8. Calculations and Totals\n\n**Calculate Child Table Totals**:\n```javascript\n// Pattern from: erpnext/accounts/doctype/sales_invoice/sales_invoice.js\nfrappe.ui.form.on('Sales Invoice', {\n    calculate_totals: function(frm) {\n        let total = 0;\n        frm.doc.items.forEach(function(item) {\n            item.amount = flt(item.qty) * flt(item.rate);\n            total += item.amount;\n        });\n        frm.set_value('total', total);\n\n        // Calculate tax and grand total\n        let tax_amount = flt(total * frm.doc.tax_rate / 100);\n        frm.set_value('total_taxes_and_charges', tax_amount);\n        frm.set_value('grand_total', total + tax_amount);\n    }\n});\n\nfrappe.ui.form.on('Sales Invoice Item', {\n    qty: function(frm, cdt, cdn) {\n        let item = locals[cdt][cdn];\n        frappe.model.set_value(cdt, cdn, 'amount',\n            flt(item.qty) * flt(item.rate));\n        frm.events.calculate_totals(frm);\n    },\n\n    rate: function(frm, cdt, cdn) {\n        let item = locals[cdt][cdn];\n        frappe.model.set_value(cdt, cdn, 'amount',\n            flt(item.qty) * flt(item.rate));\n        frm.events.calculate_totals(frm);\n    }\n});\n```\n\n### 9. Link Field Filters (set_query)\n\n**Filter Link Field Options**:\n```javascript\n// Pattern from: erpnext/stock/doctype/stock_entry/stock_entry.js\nfrappe.ui.form.on('Stock Entry', {\n    setup: function(frm) {\n        // Filter items based on item group\n        frm.set_query('item_code', 'items', function(doc, cdt, cdn) {\n            return {\n                filters: {\n                    'item_group': ['in', ['Raw Material', 'Sub Assemblies']],\n                    'is_stock_item': 1\n                }\n            };\n        });\n\n        // Dynamic filters based on doc values\n        frm.set_query('warehouse', function() {\n            return {\n                filters: {\n                    'company': frm.doc.company,\n                    'is_group': 0\n                }\n            };\n        });\n    }\n});\n```\n\n**Complex Query Filters**:\n```javascript\n// Pattern from: erpnext/accounts/doctype/payment_entry/payment_entry.js\nfrappe.ui.form.on('Payment Entry', {\n    setup: function(frm) {\n        frm.set_query('party', function() {\n            let party_type = frm.doc.party_type;\n            if (party_type === 'Customer') {\n                return {query: 'erpnext.controllers.queries.customer_query'};\n            } else if (party_type === 'Supplier') {\n                return {query: 'erpnext.controllers.queries.supplier_query'};\n            }\n        });\n\n        frm.set_query('reference_doctype', 'references', function() {\n            let doctypes = [];\n            if (frm.doc.party_type === 'Customer') {\n                doctypes = ['Sales Invoice', 'Sales Order'];\n            } else if (frm.doc.party_type === 'Supplier') {\n                doctypes = ['Purchase Invoice', 'Purchase Order'];\n            }\n            return {\n                filters: {\n                    'name': ['in', doctypes]\n                }\n            };\n        });\n    }\n});\n```\n\n### 10. Dialogs and Prompts\n\n**Create Custom Dialog**:\n```javascript\n// Pattern from: erpnext/stock/doctype/stock_entry/stock_entry.js\nfrappe.ui.form.on('Stock Entry', {\n    get_items: function(frm) {\n        let dialog = new frappe.ui.Dialog({\n            title: __('Get Items'),\n            fields: [\n                {\n                    fieldtype: 'Link',\n                    label: __('Warehouse'),\n                    fieldname: 'warehouse',\n                    options: 'Warehouse',\n                    reqd: 1,\n                    get_query: function() {\n                        return {\n                            filters: {\n                                'company': frm.doc.company\n                            }\n                        };\n                    }\n                },\n                {\n                    fieldtype: 'Link',\n                    label: __('Item Group'),\n                    fieldname: 'item_group',\n                    options: 'Item Group'\n                }\n            ],\n            primary_action_label: __('Get Items'),\n            primary_action: function(values) {\n                frappe.call({\n                    method: 'get_items',\n                    doc: frm.doc,\n                    args: values,\n                    callback: function(r) {\n                        dialog.hide();\n                        frm.refresh_field('items');\n                    }\n                });\n            }\n        });\n        dialog.show();\n    }\n});\n```\n\n## References\n\n### Frappe Core Client Script Examples (Primary Reference)\n\n**Learn from Frappe Framework:**\n- Frappe Form Scripts: https://github.com/frappe/frappe/tree/develop/frappe/desk/doctype\n  - `form/form.js` - Core form functionality\n  - `todo/todo.js` - Simple form script example\n- Frappe UI Components: https://github.com/frappe/frappe/tree/develop/frappe/public/js/frappe/ui\n\n**ERPNext Client Script Examples:**\n- Sales Invoice: https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/sales_invoice/sales_invoice.js\n- Purchase Order: https://github.com/frappe/erpnext/blob/develop/erpnext/buying/doctype/purchase_order/purchase_order.js\n- Stock Entry: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/doctype/stock_entry/stock_entry.js\n- Payment Entry: https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/payment_entry/payment_entry.js\n- Item: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/doctype/item/item.js\n\n### Official Documentation (Secondary Reference)\n\n- Form Scripts: https://frappeframework.com/docs/user/en/desk/scripting/form-scripts\n- Client API: https://frappeframework.com/docs/user/en/api/form\n- frappe.ui.form.on: https://frappeframework.com/docs/user/en/api/form#frappeuiformon\n\n## Best Practices\n\n1. **Event Handler Organization**: Group related handlers together\n2. **Reusable Functions**: Extract common logic into reusable methods\n3. **Null Checks**: Always validate data before using it\n4. **Async Operations**: Use callbacks for database and API calls\n5. **User Feedback**: Use `frappe.show_alert()` for success/error messages\n6. **Performance**: Debounce expensive operations in change handlers\n7. **Translation**: Use `__()` for translatable strings\n8. **Error Handling**: Wrap risky operations in try-catch\n9. **Child Tables**: Use `locals[cdt][cdn]` to access child table rows\n10. **Field Updates**: Use `frappe.model.set_value()` for child table fields\n\n## File Output Format\n\nGenerated client scripts should be saved at:\n```\napps/<app_name>/<module>/doctype/<doctype_name>/<doctype_name>.js\n```\n\nAlways include:\n- Clear comments explaining functionality\n- Proper indentation (4 spaces or tab as per project)\n- Event handler grouping\n- Error handling where appropriate\n- Translation wrappers for user-facing strings\n\n## Common Patterns Summary\n\n- **refresh**: Add buttons, set field properties\n- **setup**: One-time setup, set query filters\n- **onload**: Initialize values for new docs\n- **validate**: Pre-save validations\n- **before_submit**: Pre-submission checks\n- **field_name**: Handle field changes\n- **child_table_field**: Handle child table field changes\n- **items_add/remove**: Handle row additions/removals"
              },
              {
                "name": "frappe-data-migration-generator",
                "description": "Generate data migration scripts for Frappe. Use when migrating data from legacy systems, transforming data structures, or importing large datasets.",
                "path": "frappe-apps-manager/skills/frappe-data-migration-generator/SKILL.md",
                "frontmatter": {
                  "name": "frappe-data-migration-generator",
                  "description": "Generate data migration scripts for Frappe. Use when migrating data from legacy systems, transforming data structures, or importing large datasets."
                },
                "content": "# Frappe Data Migration Generator\n\nGenerate robust data migration scripts with validation, error handling, and progress tracking for importing data into Frappe.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to migrate data from legacy systems\n- User needs to import large CSV/Excel files\n- User mentions data migration, ETL, or data import\n- User wants to transform data structures\n- User needs bulk data operations\n\n## Capabilities\n\n### 1. CSV Import Script\n\n**Production-Ready CSV Importer:**\n```python\nimport csv\nimport frappe\nfrom frappe.utils import flt, cint, getdate\n\ndef import_customers_from_csv(file_path):\n    \"\"\"Import customers with validation and error handling\"\"\"\n    success = []\n    errors = []\n\n    with open(file_path, 'r', encoding='utf-8-sig') as f:\n        reader = csv.DictReader(f)\n\n        for idx, row in enumerate(reader, start=2):\n            try:\n                # Validate required fields\n                if not row.get('Customer Name'):\n                    raise ValueError('Customer name required')\n\n                # Transform data\n                customer = {\n                    'doctype': 'Customer',\n                    'customer_name': row['Customer Name'].strip(),\n                    'customer_group': row.get('Customer Group', 'Commercial'),\n                    'territory': row.get('Territory', 'All Territories'),\n                    'email_id': row.get('Email', '').strip(),\n                    'mobile_no': row.get('Phone', '').strip(),\n                    'credit_limit': flt(row.get('Credit Limit', 0))\n                }\n\n                # Check duplicate\n                exists = frappe.db.exists('Customer',\n                    {'customer_name': customer['customer_name']})\n\n                if exists:\n                    # Update\n                    doc = frappe.get_doc('Customer', exists)\n                    doc.update(customer)\n                    doc.save()\n                else:\n                    # Insert\n                    doc = frappe.get_doc(customer)\n                    doc.insert()\n\n                success.append(row['Customer Name'])\n\n                # Commit every 100\n                if len(success) % 100 == 0:\n                    frappe.db.commit()\n                    print(f\"Processed {len(success)} records\")\n\n            except Exception as e:\n                errors.append({'row': idx, 'data': row, 'error': str(e)})\n\n    frappe.db.commit()\n    return {'success': success, 'errors': errors}\n```\n\n## References\n\n**Frappe Data Import:**\n- Data Import: https://github.com/frappe/frappe/blob/develop/frappe/core/doctype/data_import/data_import.py\n- CSV Utils: https://github.com/frappe/frappe/blob/develop/frappe/utils/csvutils.py"
              },
              {
                "name": "frappe-doctype-builder",
                "description": "Build Frappe DocTypes with fields, permissions, and naming configurations. Use this skill when creating or modifying DocType structures.",
                "path": "frappe-apps-manager/skills/frappe-doctype-builder/SKILL.md",
                "frontmatter": {
                  "name": "frappe-doctype-builder",
                  "description": "Build Frappe DocTypes with fields, permissions, and naming configurations. Use this skill when creating or modifying DocType structures."
                },
                "content": "# Frappe DocType Builder Skill\n\nBuild complete DocType definitions with proper field types, permissions, and configurations.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to create a new DocType\n- User needs to add fields to an existing DocType\n- User asks about DocType structure or design\n- User wants to modify DocType properties\n- User needs help with DocType JSON schema\n\n## Capabilities\n\n### 1. DocType JSON Generation\nCreate complete DocType JSON files with:\n- Metadata (name, module, naming, permissions)\n- Fields with proper types and options\n- Permissions for different roles\n- Form layout and sections\n- Naming series configuration\n\n### 2. Field Type Expertise\nSupport all Frappe field types:\n- **Data**: Short text fields\n- **Text**: Long text with editor options\n- **Int**: Integer numbers\n- **Float**: Decimal numbers\n- **Currency**: Money values\n- **Date**: Date picker\n- **Datetime**: Date and time\n- **Time**: Time picker\n- **Link**: Reference to another DocType\n- **Select**: Dropdown with options\n- **Check**: Boolean checkbox\n- **Table**: Child table\n- **Attach**: File upload\n- **Attach Image**: Image upload with preview\n- **Signature**: Signature capture\n- **HTML**: Custom HTML content\n- **Markdown Editor**: Markdown content\n- **Code**: Code editor with syntax highlighting\n- **Dynamic Link**: Polymorphic references\n- **Rating**: Star rating\n- **Color**: Color picker\n- **Geolocation**: GPS coordinates\n\n### 3. DocType Patterns\n\n**Master DocType:**\n```json\n{\n  \"name\": \"Customer\",\n  \"module\": \"CRM\",\n  \"autoname\": \"naming_series:\",\n  \"naming_rule\": \"By naming series\",\n  \"track_changes\": 1,\n  \"is_submittable\": 0\n}\n```\n\n**Transaction DocType:**\n```json\n{\n  \"name\": \"Sales Order\",\n  \"module\": \"Selling\",\n  \"is_submittable\": 1,\n  \"autoname\": \"naming_series:\",\n  \"track_changes\": 1\n}\n```\n\n**Child Table:**\n```json\n{\n  \"name\": \"Sales Order Item\",\n  \"module\": \"Selling\",\n  \"istable\": 1,\n  \"editable_grid\": 1\n}\n```\n\n**Settings DocType:**\n```json\n{\n  \"name\": \"System Settings\",\n  \"module\": \"Core\",\n  \"issingle\": 1\n}\n```\n\n### 4. Common Field Patterns\n\n**Naming Series:**\n```json\n{\n  \"fieldname\": \"naming_series\",\n  \"fieldtype\": \"Select\",\n  \"label\": \"Naming Series\",\n  \"options\": \"CUST-.YYYY.-\\nCUST-\",\n  \"reqd\": 1\n}\n```\n\n**Status Field:**\n```json\n{\n  \"fieldname\": \"status\",\n  \"fieldtype\": \"Select\",\n  \"label\": \"Status\",\n  \"options\": \"Draft\\nSubmitted\\nCancelled\",\n  \"default\": \"Draft\"\n}\n```\n\n**Link Field:**\n```json\n{\n  \"fieldname\": \"customer\",\n  \"fieldtype\": \"Link\",\n  \"label\": \"Customer\",\n  \"options\": \"Customer\",\n  \"reqd\": 1\n}\n```\n\n**Child Table:**\n```json\n{\n  \"fieldname\": \"items\",\n  \"fieldtype\": \"Table\",\n  \"label\": \"Items\",\n  \"options\": \"Sales Order Item\",\n  \"reqd\": 1\n}\n```\n\n**Computed Field:**\n```json\n{\n  \"fieldname\": \"total\",\n  \"fieldtype\": \"Currency\",\n  \"label\": \"Total Amount\",\n  \"read_only\": 1\n}\n```\n\n### 5. Permission Configuration\n\n```json\n{\n  \"permissions\": [\n    {\n      \"role\": \"Sales User\",\n      \"read\": 1,\n      \"write\": 1,\n      \"create\": 1,\n      \"delete\": 0,\n      \"submit\": 0,\n      \"cancel\": 0\n    },\n    {\n      \"role\": \"Sales Manager\",\n      \"read\": 1,\n      \"write\": 1,\n      \"create\": 1,\n      \"delete\": 1,\n      \"submit\": 1,\n      \"cancel\": 1\n    }\n  ]\n}\n```\n\n### 6. Advanced Features\n\n**Dependent Fields:**\n```json\n{\n  \"fieldname\": \"customer_group\",\n  \"fieldtype\": \"Link\",\n  \"options\": \"Customer Group\",\n  \"depends_on\": \"eval:doc.customer\"\n}\n```\n\n**Mandatory Depends On:**\n```json\n{\n  \"fieldname\": \"tax_id\",\n  \"fieldtype\": \"Data\",\n  \"label\": \"Tax ID\",\n  \"mandatory_depends_on\": \"eval:doc.country=='United States'\"\n}\n```\n\n**Read Only Depends On:**\n```json\n{\n  \"fieldname\": \"posted_date\",\n  \"fieldtype\": \"Date\",\n  \"read_only_depends_on\": \"eval:doc.docstatus==1\"\n}\n```\n\n## Output Format\n\nWhen building a DocType, provide:\n1. Complete JSON structure\n2. Explanation of key fields\n3. Permission rationale\n4. Controller method suggestions (if needed)\n5. Migration instructions\n\n## Best Practices\n\n1. **Naming**: Use clear, descriptive field names in snake_case\n2. **Required Fields**: Mark essential fields as required\n3. **Defaults**: Provide sensible default values\n4. **Permissions**: Start restrictive, expand as needed\n5. **Indexing**: Add database indexes for frequently queried fields\n6. **Validation**: Use field properties for basic validation\n7. **Organization**: Group related fields with sections and column breaks\n\n## Integration with Controllers\n\nAfter creating DocType JSON, suggest controller methods:\n- `validate()` - Pre-save validation\n- `before_save()` - Modify values before saving\n- `on_submit()` - Actions when document is submitted\n- `on_cancel()` - Actions when document is cancelled\n- `on_trash()` - Actions before deletion\n\n## Example Usage Flow\n\n1. **User asks**: \"Create a Customer DocType with name, email, and phone\"\n2. **Skill generates**:\n   - Complete DocType JSON\n   - Appropriate field types\n   - Basic permissions\n   - Naming configuration\n3. **Output includes**:\n   - JSON file content\n   - Where to save it (`apps/<app>/doctype/customer/customer.json`)\n   - Migration command (`bench --site <site> migrate`)\n   - Next steps for customization\n\n## File Structure\n\nGenerated files should follow:\n```\napps/\n‚îî‚îÄ‚îÄ <app_name>/\n    ‚îî‚îÄ‚îÄ <module_name>/\n        ‚îî‚îÄ‚îÄ doctype/\n            ‚îî‚îÄ‚îÄ <doctype_name>/\n                ‚îú‚îÄ‚îÄ __init__.py\n                ‚îú‚îÄ‚îÄ <doctype_name>.json\n                ‚îú‚îÄ‚îÄ <doctype_name>.py\n                ‚îî‚îÄ‚îÄ <doctype_name>.js\n```\n\nRemember: This skill is model-invoked. Claude will use it autonomously when detecting DocType-related tasks."
              },
              {
                "name": "frappe-documentation-generator",
                "description": "Generate API documentation, user guides, and technical documentation for Frappe apps. Use when documenting APIs, creating user guides, or generating OpenAPI specs.",
                "path": "frappe-apps-manager/skills/frappe-documentation-generator/SKILL.md",
                "frontmatter": {
                  "name": "frappe-documentation-generator",
                  "description": "Generate API documentation, user guides, and technical documentation for Frappe apps. Use when documenting APIs, creating user guides, or generating OpenAPI specs."
                },
                "content": "# Frappe Documentation Generator\n\nGenerate comprehensive documentation for Frappe applications including API documentation, user guides, and OpenAPI specifications.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to document APIs\n- User needs user documentation\n- User mentions documentation, API docs, or guides\n- User wants OpenAPI/Swagger specs\n- User needs to document DocTypes or workflows\n\n## Capabilities\n\n### 1. API Documentation\n\n**Whitelisted Method Documentation:**\n```python\n@frappe.whitelist()\ndef get_customer_details(customer):\n    \"\"\"\n    Get detailed customer information\n\n    Args:\n        customer (str): Customer ID or name\n\n    Returns:\n        dict: Customer details including:\n            - name: Customer ID\n            - customer_name: Full name\n            - email_id: Email address\n            - mobile_no: Phone number\n            - credit_limit: Credit limit amount\n            - outstanding_amount: Current outstanding\n\n    Raises:\n        frappe.PermissionError: If user lacks read permission\n        frappe.DoesNotExistError: If customer not found\n\n    Example:\n        >>> get_customer_details(\"CUST-001\")\n        {\n            \"name\": \"CUST-001\",\n            \"customer_name\": \"John Doe\",\n            \"email_id\": \"john@example.com\",\n            ...\n        }\n\n    Endpoint:\n        POST /api/method/my_app.api.get_customer_details\n        {\n            \"customer\": \"CUST-001\"\n        }\n    \"\"\"\n    if not frappe.has_permission('Customer', 'read'):\n        frappe.throw(_('Not permitted'), frappe.PermissionError)\n\n    customer_doc = frappe.get_doc('Customer', customer)\n\n    return {\n        'name': customer_doc.name,\n        'customer_name': customer_doc.customer_name,\n        'email_id': customer_doc.email_id,\n        'mobile_no': customer_doc.mobile_no,\n        'credit_limit': customer_doc.credit_limit,\n        'outstanding_amount': customer_doc.get_outstanding()\n    }\n```\n\n### 2. OpenAPI Specification\n\n**Generate OpenAPI/Swagger:**\n```yaml\nopenapi: 3.0.0\ninfo:\n  title: My Frappe App API\n  version: 1.0.0\n  description: API documentation for My Frappe App\n\nservers:\n  - url: https://example.com/api\n    description: Production server\n\npaths:\n  /method/my_app.api.get_customer_details:\n    post:\n      summary: Get customer details\n      description: Retrieve detailed information for a customer\n      tags:\n        - Customers\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              type: object\n              properties:\n                customer:\n                  type: string\n                  description: Customer ID\n              required:\n                - customer\n      responses:\n        '200':\n          description: Customer details\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  name:\n                    type: string\n                  customer_name:\n                    type: string\n                  email_id:\n                    type: string\n        '403':\n          description: Permission denied\n        '404':\n          description: Customer not found\n```\n\n### 3. User Guide Generation\n\n**DocType User Guide:**\n```markdown\n# Customer Management Guide\n\n## Overview\nThe Customer DocType stores information about your customers including contact details, credit limits, and transaction history.\n\n## Creating a Customer\n\n1. Go to **Selling > Customer**\n2. Click **New Customer**\n3. Fill in required fields:\n   - Customer Name: Full name of the customer\n   - Customer Group: Classification (Individual/Company)\n   - Territory: Geographic location\n4. Optional fields:\n   - Email, Phone, Address\n   - Credit Limit and Payment Terms\n5. Click **Save**\n\n## Key Features\n\n### Credit Management\n- Set credit limits to control customer purchases\n- Monitor outstanding amounts\n- Get alerts on credit limit breach\n\n### Transaction History\nView all customer transactions:\n- Sales Invoices\n- Payment Entries\n- Delivery Notes\n\n## Workflows\n\n### Standard Flow\n1. Create Customer\n2. Create Sales Order\n3. Create Sales Invoice\n4. Receive Payment\n5. Deliver Goods\n\n## Tips\n- Use customer groups for bulk operations\n- Set default price lists per customer\n- Configure payment terms for auto-fill\n```\n\n## References\n\n**Frappe Documentation Patterns:**\n- Frappe Docs: https://github.com/frappe/frappe/tree/develop/frappe/docs\n- ERPNext Docs: https://github.com/frappe/erpnext/tree/develop/erpnext/docs"
              },
              {
                "name": "frappe-external-api-connector",
                "description": "Generate code to integrate Frappe with external REST APIs. Use when connecting to third-party services, payment gateways, or external data sources.",
                "path": "frappe-apps-manager/skills/frappe-external-api-connector/SKILL.md",
                "frontmatter": {
                  "name": "frappe-external-api-connector",
                  "description": "Generate code to integrate Frappe with external REST APIs. Use when connecting to third-party services, payment gateways, or external data sources."
                },
                "content": "# Frappe External API Connector\n\nGenerate robust API client code for integrating Frappe with external REST APIs, handling authentication, error recovery, and data transformation.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to integrate external REST APIs\n- User needs to call third-party services\n- User mentions API integration, external system connection\n- User wants to integrate payment gateways, shipping APIs, etc.\n- User needs OAuth or API key authentication\n\n## Capabilities\n\n### 1. API Client Class\n\n**REST API Client Template:**\n```python\nimport requests\nimport frappe\nfrom frappe import _\n\nclass ExternalAPIClient:\n    def __init__(self):\n        self.base_url = frappe.conf.get('external_api_url')\n        self.api_key = frappe.conf.get('external_api_key')\n        self.timeout = 30\n\n    def get_headers(self):\n        return {\n            'Authorization': f'Bearer {self.api_key}',\n            'Content-Type': 'application/json',\n            'User-Agent': 'Frappe/1.0'\n        }\n\n    def get(self, endpoint, params=None):\n        \"\"\"GET request with error handling\"\"\"\n        try:\n            response = requests.get(\n                f'{self.base_url}/{endpoint}',\n                params=params,\n                headers=self.get_headers(),\n                timeout=self.timeout\n            )\n            response.raise_for_status()\n            return response.json()\n        except requests.exceptions.Timeout:\n            frappe.throw(_('Request timeout'))\n        except requests.exceptions.HTTPError as e:\n            self._handle_http_error(e)\n        except Exception as e:\n            frappe.log_error(frappe.get_traceback(),\n                'External API Error')\n            frappe.throw(_('API request failed'))\n\n    def post(self, endpoint, data):\n        \"\"\"POST request\"\"\"\n        response = requests.post(\n            f'{self.base_url}/{endpoint}',\n            json=data,\n            headers=self.get_headers(),\n            timeout=self.timeout\n        )\n        response.raise_for_status()\n        return response.json()\n\n    def _handle_http_error(self, error):\n        \"\"\"Handle HTTP errors\"\"\"\n        status_code = error.response.status_code\n        if status_code == 401:\n            frappe.throw(_('API authentication failed'))\n        elif status_code == 404:\n            frappe.throw(_('Resource not found'))\n        elif status_code == 429:\n            frappe.throw(_('Rate limit exceeded'))\n        else:\n            frappe.throw(_(f'API error: {status_code}'))\n```\n\n### 2. OAuth Integration\n\n**OAuth 2.0 Flow:**\n```python\ndef get_oauth_token():\n    \"\"\"Get OAuth access token with refresh\"\"\"\n    # Check cache first\n    token = frappe.cache().get_value('oauth_token:provider')\n    if token:\n        return token\n\n    # Get from settings\n    settings = frappe.get_single('OAuth Settings')\n\n    response = requests.post(\n        settings.token_url,\n        data={\n            'grant_type': 'client_credentials',\n            'client_id': settings.client_id,\n            'client_secret': settings.get_password('client_secret')\n        }\n    )\n\n    if response.status_code == 200:\n        token_data = response.json()\n        access_token = token_data['access_token']\n\n        # Cache token\n        frappe.cache().set_value(\n            'oauth_token:provider',\n            access_token,\n            expires_in_sec=token_data.get('expires_in', 3600) - 60\n        )\n\n        return access_token\n\n    frappe.throw(_('OAuth authentication failed'))\n```\n\n## References\n\n**Frappe Integration Patterns:**\n- Integrations: https://github.com/frappe/frappe/tree/develop/frappe/integrations\n- ERPNext Integrations: https://github.com/frappe/erpnext/tree/develop/erpnext/erpnext_integrations"
              },
              {
                "name": "frappe-fixture-creator",
                "description": "Generate fixture files for Frappe test data and master data. Use when creating test fixtures, setup data, or master data for new sites.",
                "path": "frappe-apps-manager/skills/frappe-fixture-creator/SKILL.md",
                "frontmatter": {
                  "name": "frappe-fixture-creator",
                  "description": "Generate fixture files for Frappe test data and master data. Use when creating test fixtures, setup data, or master data for new sites."
                },
                "content": "# Frappe Fixture Creator\n\nGenerate fixture JSON files for test data, master data, and initial site configuration in Frappe applications.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to create test fixtures\n- User needs master data setup\n- User mentions fixtures, test data, or setup data\n- User wants repeatable site setup\n- User needs demo or sample data\n\n## Capabilities\n\n### 1. Test Fixture Generation\n\n**Item Fixtures:**\n```json\n[\n  {\n    \"doctype\": \"Item\",\n    \"item_code\": \"_Test Item\",\n    \"item_name\": \"Test Item\",\n    \"item_group\": \"Products\",\n    \"stock_uom\": \"Nos\",\n    \"is_stock_item\": 1,\n    \"is_purchase_item\": 1,\n    \"is_sales_item\": 1,\n    \"opening_stock\": 100,\n    \"valuation_rate\": 100,\n    \"standard_rate\": 150\n  },\n  {\n    \"doctype\": \"Item\",\n    \"item_code\": \"_Test Service Item\",\n    \"item_name\": \"Test Service\",\n    \"item_group\": \"Services\",\n    \"stock_uom\": \"Nos\",\n    \"is_stock_item\": 0,\n    \"is_sales_item\": 1,\n    \"standard_rate\": 500\n  }\n]\n```\n\n### 2. Hierarchical Fixtures\n\n**Customer Group Tree:**\n```json\n[\n  {\n    \"doctype\": \"Customer Group\",\n    \"customer_group_name\": \"All Customer Groups\",\n    \"is_group\": 1\n  },\n  {\n    \"doctype\": \"Customer Group\",\n    \"customer_group_name\": \"Commercial\",\n    \"parent_customer_group\": \"All Customer Groups\",\n    \"is_group\": 0\n  },\n  {\n    \"doctype\": \"Customer Group\",\n    \"customer_group_name\": \"Individual\",\n    \"parent_customer_group\": \"All Customer Groups\",\n    \"is_group\": 0\n  }\n]\n```\n\n### 3. Import Fixture\n\n**Load Fixture in App:**\n```python\n# In app setup\ndef before_install():\n    \"\"\"Install fixtures before site setup\"\"\"\n    from frappe.core.page.data_import_tool.data_import_tool import import_doc\n\n    import_doc('my_app/fixtures/item_groups.json')\n    import_doc('my_app/fixtures/territories.json')\n```\n\n## References\n\n**Frappe Fixture Patterns:**\n- Install Fixtures: https://github.com/frappe/frappe/blob/develop/frappe/core/page/data_import_tool/data_import_tool.py\n- ERPNext Fixtures: https://github.com/frappe/erpnext/tree/develop/erpnext/setup/fixtures"
              },
              {
                "name": "frappe-integration-test-generator",
                "description": "Generate integration tests for multi-DocType workflows in Frappe. Use when testing end-to-end workflows, state transitions, or complex business processes.",
                "path": "frappe-apps-manager/skills/frappe-integration-test-generator/SKILL.md",
                "frontmatter": {
                  "name": "frappe-integration-test-generator",
                  "description": "Generate integration tests for multi-DocType workflows in Frappe. Use when testing end-to-end workflows, state transitions, or complex business processes."
                },
                "content": "# Frappe Integration Test Generator\n\nGenerate comprehensive integration tests for multi-DocType workflows and end-to-end business processes in Frappe.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to test complete workflows\n- User needs end-to-end scenario testing\n- User mentions integration tests or workflow testing\n- User wants to test multi-DocType interactions\n- User needs to verify business process integrity\n\n## Capabilities\n\n### 1. Workflow Integration Test\n\n**Complete Sales Workflow Test:**\n```python\nfrom frappe.tests.utils import FrappeTestCase\nimport frappe\n\nclass TestSalesWorkflow(FrappeTestCase):\n    def test_complete_sales_cycle(self):\n        \"\"\"Test end-to-end sales process\"\"\"\n        # 1. Create Customer\n        customer = self._create_test_customer()\n\n        # 2. Create Sales Order\n        so = self._create_sales_order(customer.name)\n        so.submit()\n\n        # 3. Create Sales Invoice from SO\n        si = self._make_sales_invoice_from_order(so.name)\n        si.insert()\n        si.submit()\n\n        # 4. Create Payment Entry\n        pe = self._create_payment_entry(si)\n        pe.insert()\n        pe.submit()\n\n        # Verify workflow completed\n        si.reload()\n        self.assertEqual(si.status, 'Paid')\n        self.assertEqual(si.outstanding_amount, 0)\n\n    def _create_test_customer(self):\n        return frappe.get_doc({\n            'doctype': 'Customer',\n            'customer_name': '_Test Customer',\n            'customer_group': 'Commercial'\n        }).insert()\n\n    def _create_sales_order(self, customer):\n        return frappe.get_doc({\n            'doctype': 'Sales Order',\n            'customer': customer,\n            'delivery_date': frappe.utils.add_days(frappe.utils.today(), 7),\n            'items': [{\n                'item_code': '_Test Item',\n                'qty': 10,\n                'rate': 100\n            }]\n        })\n```\n\n### 2. State Transition Test\n\n**Test Document States:**\n```python\nclass TestInvoiceStates(FrappeTestCase):\n    def test_invoice_state_transitions(self):\n        \"\"\"Test all possible state transitions\"\"\"\n        si = self._get_test_invoice()\n\n        # Draft state\n        si.insert()\n        self.assertEqual(si.docstatus, 0)\n        self.assertEqual(si.status, 'Draft')\n\n        # Submit transition\n        si.submit()\n        self.assertEqual(si.docstatus, 1)\n        self.assertEqual(si.status, 'Submitted')\n\n        # Cannot edit submitted\n        si.customer = 'Different Customer'\n        with self.assertRaises(frappe.ValidationError):\n            si.save()\n\n        # Cancel transition\n        si.cancel()\n        self.assertEqual(si.docstatus, 2)\n        self.assertEqual(si.status, 'Cancelled')\n```\n\n## References\n\n**Integration Test Examples:**\n- Sales Invoice Tests: https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/sales_invoice/test_sales_invoice.py\n- Stock Entry Tests: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/doctype/stock_entry/test_stock_entry.py"
              },
              {
                "name": "frappe-performance-optimizer",
                "description": "Generate optimized queries, caching, and indexes for Frappe performance. Use when optimizing slow queries, implementing caching, or improving performance.",
                "path": "frappe-apps-manager/skills/frappe-performance-optimizer/SKILL.md",
                "frontmatter": {
                  "name": "frappe-performance-optimizer",
                  "description": "Generate optimized queries, caching, and indexes for Frappe performance. Use when optimizing slow queries, implementing caching, or improving performance."
                },
                "content": "# Frappe Performance Optimizer\n\nGenerate performance-optimized code including efficient queries, caching strategies, and database indexes for Frappe applications.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User reports slow queries or performance issues\n- User wants to add caching\n- User needs database indexing\n- User mentions performance, optimization, or slow queries\n- User wants to eliminate N+1 queries\n\n## Capabilities\n\n### 1. Query Optimization\n\n**Optimized Report Query:**\n```python\n# Efficient query with proper indexing\ndef get_sales_summary(from_date, to_date):\n    return frappe.db.sql(\"\"\"\n        SELECT\n            si.customer,\n            c.customer_name,\n            c.customer_group,\n            COUNT(si.name) as invoice_count,\n            SUM(si.grand_total) as total_amount\n        FROM `tabSales Invoice` si\n        INNER JOIN `tabCustomer` c ON c.name = si.customer\n        WHERE si.posting_date BETWEEN %s AND %s\n            AND si.docstatus = 1\n        GROUP BY si.customer\n        ORDER BY total_amount DESC\n        LIMIT 100\n    \"\"\", (from_date, to_date), as_dict=True)\n\n# Add index for performance\nfrappe.db.add_index('Sales Invoice', ['customer', 'posting_date', 'docstatus'])\n```\n\n### 2. Caching Implementation\n\n**Cache Expensive Calculations:**\n```python\ndef get_item_price(item_code, price_list, customer=None):\n    \"\"\"Get price with caching\"\"\"\n    cache_key = f\"price:{item_code}:{price_list}:{customer or 'default'}\"\n\n    # Try cache\n    cached_price = frappe.cache().get_value(cache_key)\n    if cached_price is not None:\n        return cached_price\n\n    # Calculate price (expensive)\n    price = frappe.db.get_value('Item Price',\n        filters={'item_code': item_code, 'price_list': price_list},\n        fieldname='price_list_rate'\n    )\n\n    # Cache for 1 hour\n    if price:\n        frappe.cache().set_value(cache_key, price, expires_in_sec=3600)\n\n    return price\n```\n\n### 3. Batch Operations\n\n**Bulk Update Pattern:**\n```python\ndef bulk_update_items(updates):\n    \"\"\"Update multiple items efficiently\"\"\"\n    # updates = [{'item_code': 'ITEM-001', 'is_active': 1}, ...]\n\n    # Build single query\n    item_codes = [u['item_code'] for u in updates]\n\n    frappe.db.sql(\"\"\"\n        UPDATE `tabItem`\n        SET is_active = 1,\n            modified = NOW(),\n            modified_by = %s\n        WHERE name IN %s\n    \"\"\", (frappe.session.user, tuple(item_codes)))\n\n    frappe.db.commit()\n```\n\n## References\n\n**Performance Examples:**\n- Stock Ledger: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/stock_ledger.py\n- Get Item Details: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/get_item_details.py"
              },
              {
                "name": "frappe-report-generator",
                "description": "Generate custom reports, query reports, and script reports for Frappe applications. Use when creating data analysis and reporting features.",
                "path": "frappe-apps-manager/skills/frappe-report-generator/SKILL.md",
                "frontmatter": {
                  "name": "frappe-report-generator",
                  "description": "Generate custom reports, query reports, and script reports for Frappe applications. Use when creating data analysis and reporting features."
                },
                "content": "# Frappe Report Generator Skill\n\nCreate custom reports for data analysis, dashboards, and business intelligence in Frappe.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to create custom reports\n- User needs data analysis or aggregation\n- User asks about query reports or script reports\n- User wants to build dashboards\n- User needs help with report formatting or filters\n\n## Capabilities\n\n### 1. Report Types\n\n**Query Report (SQL-based):**\n- Fast performance for large datasets\n- Direct SQL queries\n- Complex joins and aggregations\n- Limited formatting options\n\n**Script Report (Python-based):**\n- Full Python flexibility\n- Complex business logic\n- Dynamic columns and formatting\n- Access to Frappe ORM\n\n**Report Builder (No-code):**\n- User-configurable\n- No coding required\n- Basic aggregations\n- Simple use cases\n\n### 2. Query Report Structure\n\n**Basic Query Report JSON:**\n```json\n{\n  \"name\": \"Sales Analysis\",\n  \"report_name\": \"Sales Analysis\",\n  \"ref_doctype\": \"Sales Order\",\n  \"report_type\": \"Query Report\",\n  \"is_standard\": \"Yes\",\n  \"module\": \"Selling\",\n  \"disabled\": 0,\n  \"query\": \"\",\n  \"filters\": [],\n  \"columns\": []\n}\n```\n\n**Python File (sales_analysis.py):**\n```python\nimport frappe\nfrom frappe import _\n\ndef execute(filters=None):\n    columns = get_columns()\n    data = get_data(filters)\n    return columns, data\n\ndef get_columns():\n    return [\n        {\n            \"fieldname\": \"sales_order\",\n            \"label\": _(\"Sales Order\"),\n            \"fieldtype\": \"Link\",\n            \"options\": \"Sales Order\",\n            \"width\": 150\n        },\n        {\n            \"fieldname\": \"customer\",\n            \"label\": _(\"Customer\"),\n            \"fieldtype\": \"Link\",\n            \"options\": \"Customer\",\n            \"width\": 150\n        },\n        {\n            \"fieldname\": \"posting_date\",\n            \"label\": _(\"Date\"),\n            \"fieldtype\": \"Date\",\n            \"width\": 100\n        },\n        {\n            \"fieldname\": \"grand_total\",\n            \"label\": _(\"Grand Total\"),\n            \"fieldtype\": \"Currency\",\n            \"width\": 120\n        },\n        {\n            \"fieldname\": \"status\",\n            \"label\": _(\"Status\"),\n            \"fieldtype\": \"Data\",\n            \"width\": 100\n        }\n    ]\n\ndef get_data(filters):\n    conditions = get_conditions(filters)\n\n    query = f\"\"\"\n        SELECT\n            so.name as sales_order,\n            so.customer,\n            so.posting_date,\n            so.grand_total,\n            so.status\n        FROM\n            `tabSales Order` so\n        WHERE\n            so.docstatus = 1\n            {conditions}\n        ORDER BY\n            so.posting_date DESC\n    \"\"\"\n\n    return frappe.db.sql(query, filters, as_dict=1)\n\ndef get_conditions(filters):\n    conditions = []\n\n    if filters.get(\"customer\"):\n        conditions.append(\"so.customer = %(customer)s\")\n\n    if filters.get(\"from_date\"):\n        conditions.append(\"so.posting_date >= %(from_date)s\")\n\n    if filters.get(\"to_date\"):\n        conditions.append(\"so.posting_date <= %(to_date)s\")\n\n    if filters.get(\"status\"):\n        conditions.append(\"so.status = %(status)s\")\n\n    return \" AND \" + \" AND \".join(conditions) if conditions else \"\"\n```\n\n### 3. Script Report Structure\n\n**Advanced Script Report:**\n```python\nimport frappe\nfrom frappe import _\nfrom frappe.utils import flt, getdate\n\ndef execute(filters=None):\n    columns = get_columns()\n    data = get_data(filters)\n    chart = get_chart_data(data)\n    report_summary = get_report_summary(data)\n\n    return columns, data, None, chart, report_summary\n\ndef get_columns():\n    return [\n        {\n            \"fieldname\": \"customer\",\n            \"label\": _(\"Customer\"),\n            \"fieldtype\": \"Link\",\n            \"options\": \"Customer\",\n            \"width\": 150\n        },\n        {\n            \"fieldname\": \"total_orders\",\n            \"label\": _(\"Total Orders\"),\n            \"fieldtype\": \"Int\",\n            \"width\": 100\n        },\n        {\n            \"fieldname\": \"total_amount\",\n            \"label\": _(\"Total Amount\"),\n            \"fieldtype\": \"Currency\",\n            \"width\": 120\n        },\n        {\n            \"fieldname\": \"avg_order_value\",\n            \"label\": _(\"Avg Order Value\"),\n            \"fieldtype\": \"Currency\",\n            \"width\": 120\n        }\n    ]\n\ndef get_data(filters):\n    # Get sales orders\n    sales_orders = frappe.get_all(\n        \"Sales Order\",\n        filters={\n            \"docstatus\": 1,\n            \"posting_date\": [\"between\", [filters.get(\"from_date\"), filters.get(\"to_date\")]]\n        },\n        fields=[\"customer\", \"grand_total\"]\n    )\n\n    # Aggregate by customer\n    customer_data = {}\n    for order in sales_orders:\n        customer = order.customer\n        if customer not in customer_data:\n            customer_data[customer] = {\n                \"customer\": customer,\n                \"total_orders\": 0,\n                \"total_amount\": 0\n            }\n\n        customer_data[customer][\"total_orders\"] += 1\n        customer_data[customer][\"total_amount\"] += flt(order.grand_total)\n\n    # Calculate averages\n    data = []\n    for customer, values in customer_data.items():\n        data.append({\n            \"customer\": customer,\n            \"total_orders\": values[\"total_orders\"],\n            \"total_amount\": values[\"total_amount\"],\n            \"avg_order_value\": values[\"total_amount\"] / values[\"total_orders\"]\n        })\n\n    return sorted(data, key=lambda x: x[\"total_amount\"], reverse=True)\n\ndef get_chart_data(data):\n    \"\"\"Generate chart for report\"\"\"\n    if not data:\n        return None\n\n    labels = [d[\"customer\"] for d in data[:10]]  # Top 10\n    values = [d[\"total_amount\"] for d in data[:10]]\n\n    return {\n        \"data\": {\n            \"labels\": labels,\n            \"datasets\": [\n                {\n                    \"name\": \"Total Sales\",\n                    \"values\": values\n                }\n            ]\n        },\n        \"type\": \"bar\",\n        \"colors\": [\"#7cd6fd\"]\n    }\n\ndef get_report_summary(data):\n    \"\"\"Generate summary cards\"\"\"\n    if not data:\n        return []\n\n    total_customers = len(data)\n    total_revenue = sum(d[\"total_amount\"] for d in data)\n    total_orders = sum(d[\"total_orders\"] for d in data)\n    avg_order_value = total_revenue / total_orders if total_orders else 0\n\n    return [\n        {\n            \"value\": total_customers,\n            \"label\": \"Total Customers\",\n            \"datatype\": \"Int\"\n        },\n        {\n            \"value\": total_revenue,\n            \"label\": \"Total Revenue\",\n            \"datatype\": \"Currency\"\n        },\n        {\n            \"value\": total_orders,\n            \"label\": \"Total Orders\",\n            \"datatype\": \"Int\"\n        },\n        {\n            \"value\": avg_order_value,\n            \"label\": \"Avg Order Value\",\n            \"datatype\": \"Currency\"\n        }\n    ]\n```\n\n### 4. Report Filters\n\n**Filter Definition (JSON):**\n```json\n{\n  \"filters\": [\n    {\n      \"fieldname\": \"customer\",\n      \"label\": \"Customer\",\n      \"fieldtype\": \"Link\",\n      \"options\": \"Customer\"\n    },\n    {\n      \"fieldname\": \"from_date\",\n      \"label\": \"From Date\",\n      \"fieldtype\": \"Date\",\n      \"default\": \"frappe.datetime.month_start()\",\n      \"reqd\": 1\n    },\n    {\n      \"fieldname\": \"to_date\",\n      \"label\": \"To Date\",\n      \"fieldtype\": \"Date\",\n      \"default\": \"frappe.datetime.month_end()\",\n      \"reqd\": 1\n    },\n    {\n      \"fieldname\": \"status\",\n      \"label\": \"Status\",\n      \"fieldtype\": \"Select\",\n      \"options\": \"\\nDraft\\nSubmitted\\nCancelled\",\n      \"default\": \"Submitted\"\n    }\n  ]\n}\n```\n\n### 5. Advanced Query Patterns\n\n**Complex Joins:**\n```python\ndef get_data(filters):\n    query = \"\"\"\n        SELECT\n            so.name as sales_order,\n            so.customer,\n            c.customer_group,\n            c.territory,\n            so.posting_date,\n            SUM(soi.amount) as total_amount,\n            COUNT(soi.name) as total_items\n        FROM\n            `tabSales Order` so\n        INNER JOIN\n            `tabCustomer` c ON so.customer = c.name\n        INNER JOIN\n            `tabSales Order Item` soi ON soi.parent = so.name\n        WHERE\n            so.docstatus = 1\n            AND so.posting_date BETWEEN %(from_date)s AND %(to_date)s\n        GROUP BY\n            so.name\n        ORDER BY\n            total_amount DESC\n    \"\"\"\n\n    return frappe.db.sql(query, filters, as_dict=1)\n```\n\n**Aggregations:**\n```python\ndef get_summary_data(filters):\n    query = \"\"\"\n        SELECT\n            MONTH(posting_date) as month,\n            YEAR(posting_date) as year,\n            COUNT(name) as order_count,\n            SUM(grand_total) as total_sales,\n            AVG(grand_total) as avg_order_value,\n            MIN(grand_total) as min_order,\n            MAX(grand_total) as max_order\n        FROM\n            `tabSales Order`\n        WHERE\n            docstatus = 1\n            AND posting_date BETWEEN %(from_date)s AND %(to_date)s\n        GROUP BY\n            YEAR(posting_date), MONTH(posting_date)\n        ORDER BY\n            year DESC, month DESC\n    \"\"\"\n\n    return frappe.db.sql(query, filters, as_dict=1)\n```\n\n### 6. Dynamic Columns\n\n```python\ndef get_columns():\n    \"\"\"Generate columns dynamically based on data\"\"\"\n    base_columns = [\n        {\n            \"fieldname\": \"customer\",\n            \"label\": _(\"Customer\"),\n            \"fieldtype\": \"Link\",\n            \"options\": \"Customer\",\n            \"width\": 150\n        }\n    ]\n\n    # Add month columns dynamically\n    months = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n              \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"]\n\n    for month in months:\n        base_columns.append({\n            \"fieldname\": month.lower(),\n            \"label\": _(month),\n            \"fieldtype\": \"Currency\",\n            \"width\": 100\n        })\n\n    base_columns.append({\n        \"fieldname\": \"total\",\n        \"label\": _(\"Total\"),\n        \"fieldtype\": \"Currency\",\n        \"width\": 120\n    })\n\n    return base_columns\n```\n\n### 7. Report Formatting\n\n**Conditional Formatting:**\n```python\ndef get_data(filters):\n    data = # ... get data\n\n    for row in data:\n        # Add indicator\n        if row.grand_total > 100000:\n            row[\"indicator\"] = \"green\"\n        elif row.grand_total > 50000:\n            row[\"indicator\"] = \"orange\"\n        else:\n            row[\"indicator\"] = \"red\"\n\n    return data\n```\n\n### 8. Export Features\n\nReports automatically support:\n- Excel export\n- PDF export\n- CSV export\n- Print view\n\n### 9. Performance Optimization\n\n**Use Indexes:**\n```python\n# Ensure proper indexes exist\n# ALTER TABLE `tabSales Order` ADD INDEX idx_posting_date (posting_date);\n# ALTER TABLE `tabSales Order` ADD INDEX idx_customer (customer);\n```\n\n**Limit Results:**\n```python\ndef get_data(filters):\n    # Add LIMIT for large datasets\n    query = f\"\"\"\n        SELECT ...\n        FROM ...\n        WHERE ...\n        LIMIT 1000\n    \"\"\"\n    return frappe.db.sql(query, filters, as_dict=1)\n```\n\n**Use Query Caching:**\n```python\ndef get_data(filters):\n    cache_key = f\"sales_report_{filters.get('from_date')}_{filters.get('to_date')}\"\n\n    data = frappe.cache().get_value(cache_key)\n    if data:\n        return data\n\n    data = frappe.db.sql(query, filters, as_dict=1)\n    frappe.cache().set_value(cache_key, data, expires_in_sec=300)\n\n    return data\n```\n\n### 10. Report Permissions\n\n**Permission Query:**\n```python\ndef get_data(filters):\n    # Only show data user has permission to see\n    if not frappe.has_permission(\"Sales Order\", \"read\"):\n        frappe.throw(_(\"Not permitted\"))\n\n    # Filter by user permissions\n    user_customers = frappe.get_list(\n        \"Customer\",\n        filters={\"name\": [\"in\", frappe.get_roles()]},\n        pluck=\"name\"\n    )\n\n    if user_customers:\n        filters[\"customer\"] = [\"in\", user_customers]\n```\n\n## File Structure\n\nReports should be organized as:\n```\napps/<app_name>/<module>/report/<report_name>/\n‚îú‚îÄ‚îÄ __init__.py\n‚îú‚îÄ‚îÄ <report_name>.json\n‚îú‚îÄ‚îÄ <report_name>.py\n‚îî‚îÄ‚îÄ <report_name>.js (optional, for client-side customization)\n```\n\n## Best Practices\n\n1. **Optimize queries** - Use proper indexes and LIMIT\n2. **Filter early** - Apply filters in WHERE clause, not in Python\n3. **Use parameterized queries** - Prevent SQL injection\n4. **Cache when possible** - Cache expensive calculations\n5. **Validate filters** - Always validate user inputs\n6. **Handle permissions** - Check user permissions\n7. **Provide defaults** - Set sensible default filters\n8. **Document reports** - Add helpful descriptions\n9. **Test with large data** - Ensure performance at scale\n10. **Use chart/summary wisely** - Enhance user experience\n\n## Testing Reports\n\nAccess reports at:\n```\nhttp://localhost:8000/app/query-report/Sales%20Analysis\n```\n\nRemember: This skill is model-invoked. Claude will use it autonomously when detecting report development tasks."
              },
              {
                "name": "frappe-state-machine-helper",
                "description": "Generate state machine logic for Frappe DocTypes. Use when implementing complex status workflows, state transitions, or document lifecycle management.",
                "path": "frappe-apps-manager/skills/frappe-state-machine-helper/SKILL.md",
                "frontmatter": {
                  "name": "frappe-state-machine-helper",
                  "description": "Generate state machine logic for Frappe DocTypes. Use when implementing complex status workflows, state transitions, or document lifecycle management."
                },
                "content": "# Frappe State Machine Helper\n\nGenerate state machine logic for managing complex document states and transitions in Frappe DocTypes.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to implement document status management\n- User needs state transition logic\n- User mentions state machine, status workflow, or document lifecycle\n- User wants to validate state transitions\n- User needs state-dependent behavior\n\n## Capabilities\n\n### 1. State Transition Logic\n\n**Order Status State Machine:**\n```python\nclass SalesOrder(Document):\n    def validate(self):\n        self.validate_state_transition()\n\n    def validate_state_transition(self):\n        \"\"\"Validate allowed state transitions\"\"\"\n        if not self.is_new():\n            old_status = frappe.db.get_value('Sales Order', self.name, 'status')\n\n            # Define allowed transitions\n            allowed_transitions = {\n                'Draft': ['Pending', 'Cancelled'],\n                'Pending': ['Confirmed', 'Cancelled'],\n                'Confirmed': ['In Progress', 'Cancelled'],\n                'In Progress': ['Completed', 'On Hold'],\n                'On Hold': ['In Progress', 'Cancelled'],\n                'Completed': [],  # Terminal state\n                'Cancelled': []   # Terminal state\n            }\n\n            if old_status != self.status:\n                allowed = allowed_transitions.get(old_status, [])\n                if self.status not in allowed:\n                    frappe.throw(\n                        _(f'Cannot transition from {old_status} to {self.status}')\n                    )\n\n    def on_submit(self):\n        self.status = 'Confirmed'\n\n    def on_cancel(self):\n        self.status = 'Cancelled'\n```\n\n### 2. State-Dependent Actions\n\n**Actions Based on State:**\n```python\nclass PaymentEntry(Document):\n    def validate(self):\n        if self.status == 'Draft':\n            self.validate_draft_entry()\n        elif self.status == 'Submitted':\n            self.validate_submitted_entry()\n\n    def before_submit(self):\n        # Actions before state change\n        if self.payment_type == 'Pay':\n            self.validate_sufficient_balance()\n\n        self.status = 'Submitted'\n\n    def on_cancel(self):\n        # Reverse actions\n        if self.status == 'Submitted':\n            self.reverse_gl_entries()\n\n        self.status = 'Cancelled'\n```\n\n## References\n\n**State Management Examples:**\n- Sales Invoice: https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/sales_invoice/sales_invoice.py\n- Purchase Order: https://github.com/frappe/erpnext/blob/develop/erpnext/buying/doctype/purchase_order/purchase_order.py"
              },
              {
                "name": "frappe-unit-test-generator",
                "description": "Generate comprehensive unit tests for Frappe DocTypes, controllers, and API methods. Use when creating test files, writing test cases, or setting up test infrastructure for Frappe/ERPNext applications.",
                "path": "frappe-apps-manager/skills/frappe-unit-test-generator/SKILL.md",
                "frontmatter": {
                  "name": "frappe-unit-test-generator",
                  "description": "Generate comprehensive unit tests for Frappe DocTypes, controllers, and API methods. Use when creating test files, writing test cases, or setting up test infrastructure for Frappe/ERPNext applications."
                },
                "content": "# Frappe Unit Test Generator\n\nGenerate production-ready unit tests for Frappe applications following patterns from ERPNext and Frappe core.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to write unit tests for DocTypes\n- User needs to test controller methods\n- User requests API endpoint tests\n- User wants to test business logic or validations\n- User mentions testing, test cases, or test files\n- User wants to set up test fixtures or test data\n- User needs to test permissions or workflows\n\n## Capabilities\n\n### 1. DocType Test File Structure\n\nGenerate complete test files following Frappe's unittest framework.\n\n**Basic Test Structure** (from ERPNext Item):\n```python\n# Pattern from: erpnext/stock/doctype/item/test_item.py\nimport frappe\nimport unittest\nfrom frappe.tests.utils import FrappeTestCase\n\nclass TestItem(FrappeTestCase):\n    def setUp(self):\n        \"\"\"Set up test fixtures before each test\"\"\"\n        frappe.set_user(\"Administrator\")\n        self.test_item = self._create_test_item()\n\n    def tearDown(self):\n        \"\"\"Clean up after each test\"\"\"\n        frappe.db.rollback()\n\n    def test_item_creation(self):\n        \"\"\"Test basic item creation\"\"\"\n        item = frappe.get_doc({\n            \"doctype\": \"Item\",\n            \"item_code\": \"_Test Item\",\n            \"item_name\": \"Test Item\",\n            \"item_group\": \"Products\",\n            \"stock_uom\": \"Nos\"\n        })\n        item.insert()\n\n        self.assertEqual(item.item_code, \"_Test Item\")\n        self.assertEqual(item.item_group, \"Products\")\n\n        # Verify item was created\n        self.assertTrue(frappe.db.exists(\"Item\", \"_Test Item\"))\n\n    def _create_test_item(self):\n        \"\"\"Helper method to create test item\"\"\"\n        if frappe.db.exists(\"Item\", \"_Test Item\"):\n            return frappe.get_doc(\"Item\", \"_Test Item\")\n\n        item = frappe.get_doc({\n            \"doctype\": \"Item\",\n            \"item_code\": \"_Test Item\",\n            \"item_name\": \"Test Item\",\n            \"item_group\": \"Products\",\n            \"stock_uom\": \"Nos\",\n            \"is_stock_item\": 1\n        })\n        item.insert()\n        return item\n```\n\n### 2. Validation Testing\n\n**Test Controller Validations** (from Sales Invoice):\n```python\n# Pattern from: erpnext/accounts/doctype/sales_invoice/test_sales_invoice.py\nclass TestSalesInvoice(FrappeTestCase):\n    def test_posting_date_validation(self):\n        \"\"\"Test posting date cannot be future date\"\"\"\n        si = self._get_test_sales_invoice()\n        si.posting_date = frappe.utils.add_days(frappe.utils.today(), 1)\n\n        self.assertRaises(frappe.ValidationError, si.insert)\n\n    def test_items_required(self):\n        \"\"\"Test that items are required\"\"\"\n        si = frappe.get_doc({\n            \"doctype\": \"Sales Invoice\",\n            \"customer\": \"_Test Customer\",\n            \"items\": []\n        })\n\n        self.assertRaises(frappe.ValidationError, si.insert)\n\n    def test_negative_quantity(self):\n        \"\"\"Test negative quantities are not allowed\"\"\"\n        si = self._get_test_sales_invoice()\n        si.items[0].qty = -1\n\n        with self.assertRaises(frappe.ValidationError) as context:\n            si.insert()\n\n        self.assertIn(\"Quantity cannot be negative\", str(context.exception))\n\n    def test_duplicate_items(self):\n        \"\"\"Test duplicate items with same item code\"\"\"\n        si = self._get_test_sales_invoice()\n        si.append(\"items\", {\n            \"item_code\": si.items[0].item_code,\n            \"qty\": 5,\n            \"rate\": 100\n        })\n\n        # Depending on requirements, this might succeed or fail\n        # Document the expected behavior\n        si.insert()\n        self.assertEqual(len(si.items), 2)\n```\n\n### 3. Calculation Testing\n\n**Test Amount Calculations** (from Sales Invoice):\n```python\n# Pattern from: erpnext/accounts/doctype/sales_invoice/test_sales_invoice.py\nclass TestSalesInvoice(FrappeTestCase):\n    def test_total_calculation(self):\n        \"\"\"Test total amount calculation\"\"\"\n        si = frappe.get_doc({\n            \"doctype\": \"Sales Invoice\",\n            \"customer\": \"_Test Customer\",\n            \"items\": [{\n                \"item_code\": \"_Test Item\",\n                \"qty\": 10,\n                \"rate\": 100\n            }, {\n                \"item_code\": \"_Test Item 2\",\n                \"qty\": 5,\n                \"rate\": 50\n            }]\n        })\n        si.insert()\n\n        self.assertEqual(si.total, 1250)  # (10*100) + (5*50)\n\n    def test_discount_calculation(self):\n        \"\"\"Test discount application\"\"\"\n        si = self._get_test_sales_invoice()\n        si.discount_amount = 100\n        si.save()\n\n        expected_total = si.total - 100\n        self.assertEqual(si.grand_total, expected_total)\n\n    def test_tax_calculation(self):\n        \"\"\"Test tax calculation with tax template\"\"\"\n        si = self._get_test_sales_invoice()\n        si.taxes_and_charges = \"_Test Tax Template\"\n        si.save()\n\n        # Tax amount should be calculated\n        self.assertGreater(si.total_taxes_and_charges, 0)\n        self.assertEqual(\n            si.grand_total,\n            si.total + si.total_taxes_and_charges\n        )\n```\n\n### 4. Workflow and State Testing\n\n**Test Document States** (from Stock Entry):\n```python\n# Pattern from: erpnext/stock/doctype/stock_entry/test_stock_entry.py\nclass TestStockEntry(FrappeTestCase):\n    def test_submit_workflow(self):\n        \"\"\"Test document submission\"\"\"\n        se = self._get_test_stock_entry()\n        se.insert()\n\n        # Verify draft state\n        self.assertEqual(se.docstatus, 0)\n\n        # Submit and verify\n        se.submit()\n        self.assertEqual(se.docstatus, 1)\n\n        # Verify cannot edit submitted doc\n        se.purpose = \"Different Purpose\"\n        self.assertRaises(frappe.ValidationError, se.save)\n\n    def test_cancel_workflow(self):\n        \"\"\"Test document cancellation\"\"\"\n        se = self._get_test_stock_entry()\n        se.insert()\n        se.submit()\n\n        # Cancel and verify\n        se.cancel()\n        self.assertEqual(se.docstatus, 2)\n\n        # Verify cancelled doc cannot be submitted again\n        self.assertRaises(frappe.ValidationError, se.submit)\n\n    def test_amendment(self):\n        \"\"\"Test document amendment after cancellation\"\"\"\n        se = self._get_test_stock_entry()\n        se.insert()\n        se.submit()\n        se.cancel()\n\n        # Create amended document\n        amended_se = frappe.copy_doc(se)\n        amended_se.amended_from = se.name\n        amended_se.docstatus = 0\n        amended_se.insert()\n        amended_se.submit()\n\n        self.assertEqual(amended_se.amended_from, se.name)\n        self.assertEqual(amended_se.docstatus, 1)\n```\n\n### 5. Permission Testing\n\n**Test Role Permissions** (from Frappe Core):\n```python\n# Pattern from: frappe/tests/test_permissions.py\nclass TestCustomerPermissions(FrappeTestCase):\n    def setUp(self):\n        self.test_user = \"test@example.com\"\n        self._setup_test_user()\n\n    def test_read_permission(self):\n        \"\"\"Test user can read allowed documents\"\"\"\n        frappe.set_user(self.test_user)\n\n        # Should succeed\n        customer = frappe.get_doc(\"Customer\", \"_Test Customer\")\n        self.assertEqual(customer.name, \"_Test Customer\")\n\n    def test_write_permission(self):\n        \"\"\"Test user can edit allowed documents\"\"\"\n        frappe.set_user(self.test_user)\n\n        customer = frappe.get_doc(\"Customer\", \"_Test Customer\")\n        customer.customer_name = \"Updated Name\"\n        customer.save()\n\n        # Verify change persisted\n        customer.reload()\n        self.assertEqual(customer.customer_name, \"Updated Name\")\n\n    def test_create_permission(self):\n        \"\"\"Test user can create new documents\"\"\"\n        frappe.set_user(self.test_user)\n\n        customer = frappe.get_doc({\n            \"doctype\": \"Customer\",\n            \"customer_name\": \"New Customer\"\n        })\n        customer.insert()\n\n        self.assertTrue(frappe.db.exists(\"Customer\", customer.name))\n\n    def test_denied_access(self):\n        \"\"\"Test user cannot access restricted documents\"\"\"\n        frappe.set_user(self.test_user)\n\n        # Should raise PermissionError\n        self.assertRaises(\n            frappe.PermissionError,\n            frappe.get_doc,\n            \"Customer\",\n            \"_Restricted Customer\"\n        )\n\n    def _setup_test_user(self):\n        \"\"\"Create test user with specific roles\"\"\"\n        if not frappe.db.exists(\"User\", self.test_user):\n            user = frappe.get_doc({\n                \"doctype\": \"User\",\n                \"email\": self.test_user,\n                \"first_name\": \"Test\",\n                \"roles\": [{\"role\": \"Sales User\"}]\n            })\n            user.insert(ignore_permissions=True)\n```\n\n### 6. API Method Testing\n\n**Test Whitelisted Methods** (from Frappe Core):\n```python\n# Pattern from: frappe/tests/test_api.py\nclass TestCustomerAPI(FrappeTestCase):\n    def test_get_customer_details(self):\n        \"\"\"Test API method returns correct data\"\"\"\n        from my_app.api import get_customer_details\n\n        frappe.set_user(\"Administrator\")\n        result = get_customer_details(\"_Test Customer\")\n\n        self.assertIsNotNone(result)\n        self.assertEqual(result[\"name\"], \"_Test Customer\")\n        self.assertIn(\"customer_group\", result)\n\n    def test_api_authentication(self):\n        \"\"\"Test API requires authentication\"\"\"\n        frappe.set_user(\"Guest\")\n\n        from my_app.api import get_customer_details\n\n        self.assertRaises(\n            frappe.PermissionError,\n            get_customer_details,\n            \"_Test Customer\"\n        )\n\n    def test_api_validation(self):\n        \"\"\"Test API validates input parameters\"\"\"\n        from my_app.api import get_customer_details\n\n        frappe.set_user(\"Administrator\")\n\n        # Test with invalid customer\n        self.assertRaises(\n            frappe.DoesNotExistError,\n            get_customer_details,\n            \"Invalid Customer\"\n        )\n\n    def test_api_with_filters(self):\n        \"\"\"Test API method with filter parameters\"\"\"\n        from my_app.api import get_customers\n\n        frappe.set_user(\"Administrator\")\n        result = get_customers(filters={\n            \"customer_group\": \"Commercial\"\n        })\n\n        self.assertIsInstance(result, list)\n        for customer in result:\n            self.assertEqual(customer[\"customer_group\"], \"Commercial\")\n```\n\n### 7. Database Query Testing\n\n**Test Database Operations**:\n```python\n# Pattern from: frappe/tests/test_db.py\nclass TestCustomerQueries(FrappeTestCase):\n    def test_get_all_with_filters(self):\n        \"\"\"Test frappe.get_all with filters\"\"\"\n        customers = frappe.get_all(\n            \"Customer\",\n            filters={\"customer_group\": \"Commercial\"},\n            fields=[\"name\", \"customer_name\"]\n        )\n\n        self.assertIsInstance(customers, list)\n        self.assertGreater(len(customers), 0)\n\n        # Verify all results match filter\n        for customer in customers:\n            doc = frappe.get_doc(\"Customer\", customer.name)\n            self.assertEqual(doc.customer_group, \"Commercial\")\n\n    def test_get_value(self):\n        \"\"\"Test frappe.db.get_value\"\"\"\n        customer_group = frappe.db.get_value(\n            \"Customer\",\n            \"_Test Customer\",\n            \"customer_group\"\n        )\n\n        self.assertIsNotNone(customer_group)\n        self.assertIsInstance(customer_group, str)\n\n    def test_exists(self):\n        \"\"\"Test frappe.db.exists\"\"\"\n        self.assertTrue(\n            frappe.db.exists(\"Customer\", \"_Test Customer\")\n        )\n        self.assertFalse(\n            frappe.db.exists(\"Customer\", \"Non Existent Customer\")\n        )\n\n    def test_sql_query(self):\n        \"\"\"Test raw SQL queries\"\"\"\n        result = frappe.db.sql(\"\"\"\n            SELECT name, customer_name\n            FROM `tabCustomer`\n            WHERE customer_group = %s\n            LIMIT 10\n        \"\"\", (\"Commercial\",), as_dict=True)\n\n        self.assertIsInstance(result, list)\n        for row in result:\n            self.assertIn(\"name\", row)\n            self.assertIn(\"customer_name\", row)\n```\n\n### 8. Child Table Testing\n\n**Test Child Table Operations** (from Sales Invoice):\n```python\n# Pattern from: erpnext/accounts/doctype/sales_invoice/test_sales_invoice.py\nclass TestSalesInvoiceItems(FrappeTestCase):\n    def test_add_items(self):\n        \"\"\"Test adding items to child table\"\"\"\n        si = self._get_test_sales_invoice()\n        initial_count = len(si.items)\n\n        si.append(\"items\", {\n            \"item_code\": \"_Test Item 2\",\n            \"qty\": 5,\n            \"rate\": 150\n        })\n        si.save()\n\n        self.assertEqual(len(si.items), initial_count + 1)\n\n    def test_remove_items(self):\n        \"\"\"Test removing items from child table\"\"\"\n        si = self._get_test_sales_invoice()\n        initial_count = len(si.items)\n\n        si.items.pop()\n        si.save()\n\n        self.assertEqual(len(si.items), initial_count - 1)\n\n    def test_update_item_qty(self):\n        \"\"\"Test updating item quantity\"\"\"\n        si = self._get_test_sales_invoice()\n        original_total = si.total\n\n        si.items[0].qty = si.items[0].qty * 2\n        si.save()\n\n        # Total should be recalculated\n        self.assertNotEqual(si.total, original_total)\n        self.assertGreater(si.total, original_total)\n```\n\n### 9. Test Fixtures and Data\n\n**Create Reusable Test Data**:\n```python\n# Pattern from: erpnext/setup/doctype/company/test_company.py\nclass TestCompany(FrappeTestCase):\n    @classmethod\n    def setUpClass(cls):\n        \"\"\"Set up class-level fixtures\"\"\"\n        cls._create_test_data()\n\n    @classmethod\n    def tearDownClass(cls):\n        \"\"\"Clean up class-level fixtures\"\"\"\n        cls._cleanup_test_data()\n\n    @classmethod\n    def _create_test_data(cls):\n        \"\"\"Create test data used by multiple tests\"\"\"\n        # Create test company\n        if not frappe.db.exists(\"Company\", \"_Test Company\"):\n            company = frappe.get_doc({\n                \"doctype\": \"Company\",\n                \"company_name\": \"_Test Company\",\n                \"abbr\": \"_TC\",\n                \"default_currency\": \"USD\",\n                \"country\": \"United States\"\n            })\n            company.insert()\n\n        # Create test customer\n        if not frappe.db.exists(\"Customer\", \"_Test Customer\"):\n            customer = frappe.get_doc({\n                \"doctype\": \"Customer\",\n                \"customer_name\": \"_Test Customer\",\n                \"customer_group\": \"Commercial\",\n                \"territory\": \"All Territories\"\n            })\n            customer.insert()\n\n    @classmethod\n    def _cleanup_test_data(cls):\n        \"\"\"Clean up test data\"\"\"\n        for doctype, name in [\n            (\"Company\", \"_Test Company\"),\n            (\"Customer\", \"_Test Customer\")\n        ]:\n            if frappe.db.exists(doctype, name):\n                frappe.delete_doc(doctype, name, force=True)\n```\n\n### 10. Mock and Patch Testing\n\n**Mock External Dependencies**:\n```python\n# Pattern from: frappe/tests/test_email.py\nfrom unittest.mock import patch, MagicMock\n\nclass TestEmailNotification(FrappeTestCase):\n    @patch('frappe.sendmail')\n    def test_send_notification(self, mock_sendmail):\n        \"\"\"Test email notification is sent\"\"\"\n        from my_app.notifications import send_welcome_email\n\n        send_welcome_email(\"test@example.com\")\n\n        # Verify sendmail was called\n        mock_sendmail.assert_called_once()\n        args, kwargs = mock_sendmail.call_args\n        self.assertIn(\"test@example.com\", kwargs[\"recipients\"])\n\n    @patch('requests.post')\n    def test_external_api_call(self, mock_post):\n        \"\"\"Test external API integration\"\"\"\n        mock_post.return_value = MagicMock(\n            status_code=200,\n            json=lambda: {\"success\": True}\n        )\n\n        from my_app.integrations import sync_with_external_system\n\n        result = sync_with_external_system(\"_Test Customer\")\n\n        self.assertTrue(result[\"success\"])\n        mock_post.assert_called_once()\n```\n\n## Test Organization Patterns\n\n### File Structure\n\n**Standard Test File Location**:\n```\napps/my_app/\n‚îî‚îÄ‚îÄ my_module/\n    ‚îî‚îÄ‚îÄ doctype/\n        ‚îî‚îÄ‚îÄ my_doctype/\n            ‚îú‚îÄ‚îÄ my_doctype.py\n            ‚îú‚îÄ‚îÄ my_doctype.json\n            ‚îú‚îÄ‚îÄ my_doctype.js\n            ‚îî‚îÄ‚îÄ test_my_doctype.py  ‚Üê Test file here\n```\n\n### Test Naming Conventions\n\n- Test files: `test_<doctype_name>.py`\n- Test classes: `Test<DocTypeName>`\n- Test methods: `test_<description>`\n- Helper methods: `_<method_name>`\n\n### Test Method Organization\n\n```python\nclass TestMyDocType(FrappeTestCase):\n    # 1. Setup and teardown\n    def setUp(self):\n        pass\n\n    def tearDown(self):\n        pass\n\n    # 2. Creation tests\n    def test_creation(self):\n        pass\n\n    # 3. Validation tests\n    def test_validation_required_fields(self):\n        pass\n\n    # 4. Calculation tests\n    def test_total_calculation(self):\n        pass\n\n    # 5. Workflow tests\n    def test_submit_workflow(self):\n        pass\n\n    # 6. Permission tests\n    def test_user_permissions(self):\n        pass\n\n    # 7. Helper methods\n    def _create_test_doc(self):\n        pass\n```\n\n## References\n\n### Frappe Core Test Examples (Primary Reference)\n\n**Frappe Framework Tests:**\n- Test Document: https://github.com/frappe/frappe/blob/develop/frappe/tests/test_document.py\n- Test DB: https://github.com/frappe/frappe/blob/develop/frappe/tests/test_db.py\n- Test Permissions: https://github.com/frappe/frappe/blob/develop/frappe/tests/test_permissions.py\n- Test API: https://github.com/frappe/frappe/blob/develop/frappe/tests/test_api.py\n- Test Utils: https://github.com/frappe/frappe/blob/develop/frappe/tests/utils.py\n\n**ERPNext Test Examples:**\n- Sales Invoice Tests: https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/sales_invoice/test_sales_invoice.py\n- Stock Entry Tests: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/doctype/stock_entry/test_stock_entry.py\n- Payment Entry Tests: https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/payment_entry/test_payment_entry.py\n- Item Tests: https://github.com/frappe/erpnext/blob/develop/erpnext/stock/doctype/item/test_item.py\n\n### Official Documentation (Secondary Reference)\n\n- Testing Guide: https://frappeframework.com/docs/user/en/testing\n- Unit Testing: https://frappeframework.com/docs/user/en/testing/unit-testing\n- Python unittest: https://docs.python.org/3/library/unittest.html\n\n## Best Practices\n\n1. **Test Independence**: Each test should run independently\n2. **Use setUp/tearDown**: Clean state before/after each test\n3. **Use Rollback**: Call `frappe.db.rollback()` in tearDown\n4. **Test One Thing**: Each test should verify one behavior\n5. **Descriptive Names**: Test names should describe what they test\n6. **Use Assertions**: Use specific assertions (`assertEqual`, not just `assertTrue`)\n7. **Test Edge Cases**: Test boundary conditions and error cases\n8. **Mock External Calls**: Don't rely on external services in tests\n9. **Use Test Data**: Prefix test data with `_Test` for easy identification\n10. **Document Expected Behavior**: Add docstrings explaining what's tested\n\n## Common Assertions\n\n```python\n# Equality checks\nself.assertEqual(a, b)\nself.assertNotEqual(a, b)\n\n# Boolean checks\nself.assertTrue(condition)\nself.assertFalse(condition)\n\n# Existence checks\nself.assertIsNone(value)\nself.assertIsNotNone(value)\n\n# Collection checks\nself.assertIn(item, collection)\nself.assertNotIn(item, collection)\n\n# Numeric comparisons\nself.assertGreater(a, b)\nself.assertLess(a, b)\nself.assertGreaterEqual(a, b)\n\n# Exception checks\nself.assertRaises(Exception, callable, *args)\nwith self.assertRaises(Exception):\n    risky_operation()\n\n# Type checks\nself.assertIsInstance(obj, MyClass)\n```\n\n## Running Tests\n\n```bash\n# Run all tests for an app\nbench --site test_site run-tests --app my_app\n\n# Run tests for specific doctype\nbench --site test_site run-tests --doctype \"My DocType\"\n\n# Run specific test file\nbench --site test_site run-tests --test test_my_doctype\n\n# Run with coverage\nbench --site test_site run-tests --app my_app --coverage\n```"
              },
              {
                "name": "frappe-web-form-builder",
                "description": "Generate Frappe Web Forms for public-facing forms. Use when creating customer portals, registration forms, surveys, or public data collection forms.",
                "path": "frappe-apps-manager/skills/frappe-web-form-builder/SKILL.md",
                "frontmatter": {
                  "name": "frappe-web-form-builder",
                  "description": "Generate Frappe Web Forms for public-facing forms. Use when creating customer portals, registration forms, surveys, or public data collection forms."
                },
                "content": "# Frappe Web Form Builder\n\nGenerate public-facing web forms with validation, file uploads, and integration with Frappe DocTypes.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to create public forms\n- User needs customer-facing forms\n- User mentions web forms, surveys, or registration\n- User wants portal functionality\n- User needs forms without login\n\n## Capabilities\n\n### 1. Web Form JSON\n\n**Customer Registration Form:**\n```json\n{\n  \"name\": \"Customer Registration\",\n  \"route\": \"customer-registration\",\n  \"title\": \"Register as Customer\",\n  \"doc_type\": \"Customer\",\n  \"is_standard\": 0,\n  \"login_required\": 0,\n  \"allow_multiple\": 1,\n  \"show_sidebar\": 0,\n  \"success_url\": \"/thank-you\",\n  \"success_message\": \"Registration successful! We'll contact you soon.\",\n  \"introduction_text\": \"Please fill in your details to register\",\n  \"web_form_fields\": [\n    {\n      \"fieldname\": \"customer_name\",\n      \"label\": \"Full Name\",\n      \"fieldtype\": \"Data\",\n      \"reqd\": 1\n    },\n    {\n      \"fieldname\": \"email_id\",\n      \"label\": \"Email\",\n      \"fieldtype\": \"Data\",\n      \"options\": \"Email\",\n      \"reqd\": 1\n    },\n    {\n      \"fieldname\": \"mobile_no\",\n      \"label\": \"Phone\",\n      \"fieldtype\": \"Data\",\n      \"reqd\": 1\n    },\n    {\n      \"fieldname\": \"customer_group\",\n      \"label\": \"Type\",\n      \"fieldtype\": \"Select\",\n      \"options\": \"Individual\\nCompany\",\n      \"reqd\": 1\n    },\n    {\n      \"fieldname\": \"company_name\",\n      \"label\": \"Company Name\",\n      \"fieldtype\": \"Data\",\n      \"depends_on\": \"eval:doc.customer_group=='Company'\"\n    }\n  ]\n}\n```\n\n### 2. Multi-Step Form\n\n**Multi-Page Web Form:**\n```json\n{\n  \"name\": \"Job Application\",\n  \"is_multi_step\": 1,\n  \"web_form_fields\": [\n    {\n      \"fieldname\": \"step_1\",\n      \"fieldtype\": \"Section Break\",\n      \"label\": \"Personal Information\"\n    },\n    {\"fieldname\": \"full_name\", \"fieldtype\": \"Data\", \"reqd\": 1},\n    {\"fieldname\": \"email\", \"fieldtype\": \"Data\", \"options\": \"Email\", \"reqd\": 1},\n\n    {\n      \"fieldname\": \"step_2\",\n      \"fieldtype\": \"Section Break\",\n      \"label\": \"Experience\"\n    },\n    {\"fieldname\": \"years_experience\", \"fieldtype\": \"Int\"},\n    {\"fieldname\": \"current_company\", \"fieldtype\": \"Data\"},\n\n    {\n      \"fieldname\": \"step_3\",\n      \"fieldtype\": \"Section Break\",\n      \"label\": \"Documents\"\n    },\n    {\"fieldname\": \"resume\", \"fieldtype\": \"Attach\", \"reqd\": 1}\n  ]\n}\n```\n\n## References\n\n**Web Form Implementation:**\n- Web Form DocType: https://github.com/frappe/frappe/tree/develop/frappe/website/doctype/web_form\n- Web Form Controller: https://github.com/frappe/frappe/blob/develop/frappe/website/doctype/web_form/web_form.py"
              },
              {
                "name": "frappe-webhook-manager",
                "description": "Create webhook handlers for Frappe integrations. Use when implementing webhooks, event-driven integrations, or external system notifications.",
                "path": "frappe-apps-manager/skills/frappe-webhook-manager/SKILL.md",
                "frontmatter": {
                  "name": "frappe-webhook-manager",
                  "description": "Create webhook handlers for Frappe integrations. Use when implementing webhooks, event-driven integrations, or external system notifications."
                },
                "content": "# Frappe Webhook Manager\n\nGenerate secure webhook receivers and senders for Frappe integrations with external systems.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to receive webhooks from external services\n- User needs to send webhooks to external systems\n- User mentions webhook, event-driven integration, or external notifications\n- User wants to integrate payment gateways, APIs, or third-party services\n- User needs to handle real-time events from external systems\n\n## Capabilities\n\n### 1. Webhook Receiver\n\n**Secure Webhook Endpoint:**\n```python\nimport frappe\nimport hmac\nimport hashlib\n\n@frappe.whitelist(allow_guest=True)\ndef webhook_receiver():\n    \"\"\"Receive webhook from external service\"\"\"\n    # Get signature\n    signature = frappe.get_request_header('X-Webhook-Signature')\n\n    # Verify signature\n    secret = frappe.conf.get('webhook_secret')\n    expected = hmac.new(\n        secret.encode(),\n        frappe.request.data,\n        hashlib.sha256\n    ).hexdigest()\n\n    if not hmac.compare_digest(signature, expected):\n        frappe.throw(_('Invalid signature'), frappe.AuthenticationError)\n\n    # Parse payload\n    payload = frappe.parse_json(frappe.request.data)\n\n    # Process webhook\n    event = payload.get('event')\n    if event == 'payment.success':\n        handle_payment_success(payload)\n    elif event == 'customer.updated':\n        handle_customer_update(payload)\n\n    return {'status': 'success'}\n```\n\n### 2. Outgoing Webhook\n\n**Send Webhook on Document Event:**\n```python\nclass SalesInvoice(Document):\n    def on_submit(self):\n        # Send webhook on submission\n        send_webhook('invoice.submitted', self.as_dict())\n\ndef send_webhook(event, data):\n    \"\"\"Send webhook to external system\"\"\"\n    webhook_url = frappe.conf.get('external_webhook_url')\n\n    payload = {\n        'event': event,\n        'data': data,\n        'timestamp': frappe.utils.now()\n    }\n\n    # Enqueue for async processing\n    frappe.enqueue(\n        '_send_webhook',\n        webhook_url=webhook_url,\n        payload=payload,\n        queue='short'\n    )\n\ndef _send_webhook(webhook_url, payload):\n    \"\"\"Send webhook with retry logic\"\"\"\n    import requests\n\n    for attempt in range(3):\n        try:\n            response = requests.post(\n                webhook_url,\n                json=payload,\n                headers={'Content-Type': 'application/json'},\n                timeout=10\n            )\n\n            if response.status_code == 200:\n                return True\n        except Exception as e:\n            if attempt == 2:\n                frappe.log_error(frappe.get_traceback(),\n                    f\"Webhook Failed: {webhook_url}\")\n\n    return False\n```\n\n## References\n\n**Frappe Webhook Implementation:**\n- Webhook DocType: https://github.com/frappe/frappe/tree/develop/frappe/integrations/doctype/webhook\n- Integration Request: https://github.com/frappe/frappe/tree/develop/frappe/integrations/doctype/integration_request"
              },
              {
                "name": "frappe-workflow-generator",
                "description": "Generate Frappe Workflows for document state management and approvals. Use when creating approval workflows, state transitions, or multi-step document processes.",
                "path": "frappe-apps-manager/skills/frappe-workflow-generator/SKILL.md",
                "frontmatter": {
                  "name": "frappe-workflow-generator",
                  "description": "Generate Frappe Workflows for document state management and approvals. Use when creating approval workflows, state transitions, or multi-step document processes."
                },
                "content": "# Frappe Workflow Generator\n\nGenerate production-ready Frappe Workflows for document state management, approvals, and business process automation.\n\n## When to Use This Skill\n\nClaude should invoke this skill when:\n- User wants to create approval workflows\n- User needs document state transitions\n- User requests multi-step approval processes\n- User mentions workflows, approvals, or document states\n- User wants role-based approval routing\n- User needs to implement document lifecycle management\n\n## Capabilities\n\n### 1. Workflow JSON Generation\n\n**Basic Approval Workflow:**\n```json\n{\n  \"name\": \"Sales Invoice Approval\",\n  \"document_type\": \"Sales Invoice\",\n  \"is_active\": 1,\n  \"workflow_state_field\": \"workflow_state\",\n  \"states\": [\n    {\n      \"state\": \"Draft\",\n      \"doc_status\": \"0\",\n      \"allow_edit\": \"Sales User\",\n      \"update_field\": \"status\",\n      \"update_value\": \"Draft\"\n    },\n    {\n      \"state\": \"Pending Approval\",\n      \"doc_status\": \"0\",\n      \"allow_edit\": \"Sales Manager\",\n      \"update_field\": \"status\",\n      \"update_value\": \"Pending\"\n    },\n    {\n      \"state\": \"Approved\",\n      \"doc_status\": \"1\",\n      \"update_field\": \"status\",\n      \"update_value\": \"Approved\"\n    },\n    {\n      \"state\": \"Rejected\",\n      \"doc_status\": \"2\",\n      \"update_field\": \"status\",\n      \"update_value\": \"Rejected\"\n    }\n  ],\n  \"transitions\": [\n    {\n      \"state\": \"Draft\",\n      \"action\": \"Submit for Approval\",\n      \"next_state\": \"Pending Approval\",\n      \"allowed\": \"Sales User\",\n      \"allow_self_approval\": 0\n    },\n    {\n      \"state\": \"Pending Approval\",\n      \"action\": \"Approve\",\n      \"next_state\": \"Approved\",\n      \"allowed\": \"Sales Manager\"\n    },\n    {\n      \"state\": \"Pending Approval\",\n      \"action\": \"Reject\",\n      \"next_state\": \"Rejected\",\n      \"allowed\": \"Sales Manager\"\n    },\n    {\n      \"state\": \"Rejected\",\n      \"action\": \"Revise\",\n      \"next_state\": \"Draft\",\n      \"allowed\": \"Sales User\"\n    }\n  ]\n}\n```\n\n### 2. Conditional Transitions\n\n**Workflow with Amount-Based Routing:**\n```json\n{\n  \"transitions\": [\n    {\n      \"state\": \"Draft\",\n      \"action\": \"Submit\",\n      \"next_state\": \"Pending L1 Approval\",\n      \"allowed\": \"Sales User\",\n      \"condition\": \"doc.grand_total <= 10000\"\n    },\n    {\n      \"state\": \"Draft\",\n      \"action\": \"Submit\",\n      \"next_state\": \"Pending L2 Approval\",\n      \"allowed\": \"Sales User\",\n      \"condition\": \"doc.grand_total > 10000 && doc.grand_total <= 50000\"\n    },\n    {\n      \"state\": \"Draft\",\n      \"action\": \"Submit\",\n      \"next_state\": \"Pending Director Approval\",\n      \"allowed\": \"Sales User\",\n      \"condition\": \"doc.grand_total > 50000\"\n    }\n  ]\n}\n```\n\n## References\n\n**Frappe Workflow Core:**\n- Workflow: https://github.com/frappe/frappe/blob/develop/frappe/workflow/doctype/workflow/workflow.py\n- Workflow State: https://github.com/frappe/frappe/blob/develop/frappe/workflow/doctype/workflow_state/workflow_state.py\n\n**Official Documentation:**\n- Workflows: https://frappeframework.com/docs/user/en/desk/workflows"
              }
            ]
          }
        ]
      }
    }
  ]
}