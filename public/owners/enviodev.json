{
  "owner": {
    "id": "enviodev",
    "display_name": "Envio",
    "type": "Organization",
    "avatar_url": "https://avatars.githubusercontent.com/u/135992464?v=4",
    "url": "https://github.com/enviodev",
    "bio": "Envio is a modern, multi-chain EVM blockchain indexer for real-time and historical data.",
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 1,
      "total_skills": 2,
      "total_stars": 1,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "enviodev/envio-plugins",
      "url": "https://github.com/enviodev/envio-plugins",
      "description": null,
      "homepage": null,
      "signals": {
        "stars": 1,
        "forks": 0,
        "pushed_at": "2025-11-27T16:34:04Z",
        "created_at": "2025-11-27T11:40:11Z",
        "license": "NOASSERTION"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 784
        },
        {
          "path": ".gitignore",
          "type": "blob",
          "size": 168
        },
        {
          "path": "CONTRIBUTING.md",
          "type": "blob",
          "size": 2995
        },
        {
          "path": "LICENSE",
          "type": "blob",
          "size": 1236
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 2844
        },
        {
          "path": "plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 560
        },
        {
          "path": "plugins/envio-hyperindex/README.md",
          "type": "blob",
          "size": 2771
        },
        {
          "path": "plugins/envio-hyperindex/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/agents/hyperindex-helper.md",
          "type": "blob",
          "size": 4174
        },
        {
          "path": "plugins/envio-hyperindex/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/commands/init.md",
          "type": "blob",
          "size": 6561
        },
        {
          "path": "plugins/envio-hyperindex/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/SKILL.md",
          "type": "blob",
          "size": 13797
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/examples",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/examples/basic-handler.ts",
          "type": "blob",
          "size": 2472
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/examples/factory-pattern.ts",
          "type": "blob",
          "size": 5183
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/block-handlers.md",
          "type": "blob",
          "size": 3237
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/config-options.md",
          "type": "blob",
          "size": 5962
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/contract-state.md",
          "type": "blob",
          "size": 7400
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/database-indexes.md",
          "type": "blob",
          "size": 3927
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/deployment.md",
          "type": "blob",
          "size": 5278
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/effect-api.md",
          "type": "blob",
          "size": 6061
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/entity-patterns.md",
          "type": "blob",
          "size": 5974
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/graphql-querying.md",
          "type": "blob",
          "size": 6941
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/logging-debugging.md",
          "type": "blob",
          "size": 3917
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/multichain-indexing.md",
          "type": "blob",
          "size": 4334
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/preload-optimization.md",
          "type": "blob",
          "size": 5227
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/reorg-support.md",
          "type": "blob",
          "size": 5052
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/rpc-data-source.md",
          "type": "blob",
          "size": 3731
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/testing.md",
          "type": "blob",
          "size": 5689
        },
        {
          "path": "plugins/envio-hyperindex/skills/hyperindex-development/references/wildcard-indexing.md",
          "type": "blob",
          "size": 5090
        },
        {
          "path": "plugins/envio-hyperindex/skills/subgraph-migration",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/skills/subgraph-migration/SKILL.md",
          "type": "blob",
          "size": 7037
        },
        {
          "path": "plugins/envio-hyperindex/skills/subgraph-migration/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/envio-hyperindex/skills/subgraph-migration/references/common-mistakes.md",
          "type": "blob",
          "size": 8680
        },
        {
          "path": "plugins/envio-hyperindex/skills/subgraph-migration/references/migration-patterns.md",
          "type": "blob",
          "size": 14350
        }
      ],
      "marketplace": {
        "name": "envio-plugins",
        "version": null,
        "description": null,
        "owner_info": {
          "name": "Envio",
          "email": "support@envio.dev"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "envio-hyperindex",
            "description": "HyperIndex blockchain indexer development - event handlers, schema design, multichain indexing",
            "source": "./plugins/envio-hyperindex",
            "category": "blockchain",
            "version": "1.0.0",
            "author": {
              "name": "Envio"
            },
            "install_commands": [
              "/plugin marketplace add enviodev/envio-plugins",
              "/plugin install envio-hyperindex@envio-plugins"
            ],
            "signals": {
              "stars": 1,
              "forks": 0,
              "pushed_at": "2025-11-27T16:34:04Z",
              "created_at": "2025-11-27T11:40:11Z",
              "license": "NOASSERTION"
            },
            "commands": [
              {
                "name": "/init",
                "description": "Initialize a new HyperIndex indexer project with guided setup",
                "path": "plugins/envio-hyperindex/commands/init.md",
                "frontmatter": {
                  "description": "Initialize a new HyperIndex indexer project with guided setup",
                  "argument-hint": [
                    "contract-address-or-type"
                  ],
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep, AskUserQuestion, WebSearch"
                },
                "content": "Initialize a new Envio HyperIndex indexer project using `envio init` with **non-interactive CLI flags**.\n\nIMPORTANT: The interactive CLI does not work well with agents. Always use the fully-specified command-line flags to avoid interactive prompts.\n\n## Step 1: Gather Required Information\n\nCheck $ARGUMENTS for:\n- A contract address (starts with `0x`)\n- A template name (e.g., `erc20`, `greeter`)\n\n**If NO contract address or template provided:**\n1. Ask the user what protocol/contract they want to index\n2. If they provide a name (e.g., \"Uniswap V2\", \"Aave V3\"), use WebSearch to find the contract address:\n   - Search for: \"[protocol name] [network] contract address\"\n   - Example: \"Uniswap V2 Factory ethereum mainnet contract address\"\n3. Ask which network (default: `eth` for Ethereum mainnet)\n4. Ask for project directory name (default: `envio-indexer`)\n\n**If contract address IS provided:**\n- Proceed directly to Step 2\n\n## Step 2: Initialize with Contract Import (Primary Method)\n\nUse the fully non-interactive command with all flags specified:\n\n```bash\npnpx envio init contract-import explorer \\\n  -c <CONTRACT_ADDRESS> \\\n  -b <NETWORK_ID> \\\n  -n <PROJECT_NAME> \\\n  -l typescript \\\n  -d <DIRECTORY_NAME> \\\n  --single-contract \\\n  --all-events \\\n  --api-token \"\"\n```\n\n### Example - Uniswap V2 Factory on Ethereum:\n```bash\npnpx envio init contract-import explorer \\\n  -c 0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f \\\n  -b ethereum-mainnet \\\n  -n uniswap-v2-indexer \\\n  -l typescript \\\n  -d uniswap-v2-indexer \\\n  --single-contract \\\n  --all-events \\\n  --api-token \"\"\n```\n\n### CLI Flag Reference:\n| Flag | Description | Required |\n|------|-------------|----------|\n| `-c, --contract-address` | Contract address to import | Yes |\n| `-b, --blockchain` | Network ID (see network list below) | Yes |\n| `-n, --name` | Project name | Yes |\n| `-l, --language` | Handler language: `typescript`, `javascript`, `rescript` | Yes |\n| `-d, --directory` | Output directory for the project | Yes |\n| `--single-contract` | Skip prompt for additional contracts | Recommended |\n| `--all-events` | Index all events without prompting | Recommended |\n| `--api-token` | HyperSync API token (use `\"\"` for public access) | Recommended |\n\n## Step 3: Fallback - Template Initialization\n\nIf contract import fails (e.g., unverified contract, network issues), use template initialization:\n\n```bash\npnpx envio init template \\\n  -t erc20 \\\n  -n <PROJECT_NAME> \\\n  -l typescript \\\n  -d <DIRECTORY_NAME> \\\n  --api-token \"\"\n```\n\n### Available Templates:\n| Template | Description | Use Case |\n|----------|-------------|----------|\n| `erc20` | ERC20 token transfers | Token tracking, balances |\n| `greeter` | Simple example | Learning, testing |\n\nAfter template init, you'll need to manually update `config.yaml` with the actual contract address and network.\n\n## Step 4: Post-Initialization Setup\n\nAfter init completes successfully:\n\n```bash\ncd <DIRECTORY_NAME>\npnpm install\npnpm codegen\n```\n\n## Step 5: Verify Generated Files\n\nCheck that these files were created:\n- `config.yaml` - Contract addresses, networks, events\n- `schema.graphql` - GraphQL entity definitions\n- `src/EventHandlers.ts` - Event handler stubs\n\nRead and review each file to understand what was generated.\n\n## Step 6: Start Development\n\n```bash\npnpm dev\n```\n\nThis starts the indexer locally with hot reload and Hasura GraphQL console.\n\n---\n\n## Network IDs\n\nUse these values for the `-b` / `--blockchain` flag.\n\n### Mainnets\n| Network | CLI Value |\n|---------|-----------|\n| Ethereum | `ethereum-mainnet` |\n| Polygon | `polygon` |\n| Arbitrum One | `arbitrum-one` |\n| Arbitrum Nova | `arbitrum-nova` |\n| Optimism | `optimism` |\n| Base | `base` |\n| Avalanche | `avalanche` |\n| BSC | `bsc` |\n| Gnosis | `gnosis` |\n| Fantom | `fantom` |\n| Linea | `linea` |\n| Scroll | `scroll` |\n| zkSync Era | `zksync-era` |\n| Blast | `blast` |\n| Mode | `mode` |\n| Manta | `manta` |\n| Mantle | `mantle` |\n| Moonbeam | `moonbeam` |\n| Celo | `celo` |\n| Aurora | `aurora` |\n| Harmony | `harmony` |\n| Sonic | `sonic` |\n| Berachain | `berachain` |\n| Monad | `monad` |\n| Abstract | `abstract` |\n| Worldchain | `worldchain` |\n| Unichain | `unichain` |\n| Zora | `zora` |\n\n### Testnets\n| Network | CLI Value |\n|---------|-----------|\n| Sepolia | `sepolia` |\n| Holesky | `holesky` |\n| Base Sepolia | `base-sepolia` |\n| Arbitrum Sepolia | `arbitrum-sepolia` |\n| Optimism Sepolia | `optimism-sepolia` |\n| Scroll Sepolia | `scroll-sepolia` |\n| Linea Sepolia | `linea-sepolia` |\n| Blast Sepolia | `blast-sepolia` |\n| Mode Sepolia | `mode-sepolia` |\n| Monad Testnet | `monad-testnet` |\n| Polygon Amoy | `amoy` |\n\n### Full List\nRun `pnpx envio init contract-import explorer --help` to see all supported networks.\n\n## Common Contract Addresses\n\n**Ethereum Mainnet:**\n- Uniswap V2 Factory: `0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f`\n- Uniswap V3 Factory: `0x1F98431c8aD98523631AE4a59f267346ea31F984`\n- WETH: `0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2`\n- USDC: `0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48`\n- USDT: `0xdAC17F958D2ee523a2206206994597C13D831ec7`\n- DAI: `0x6B175474E89094C44Da98b954EescdeCB5BE3bE`\n\n**Polygon:**\n- Uniswap V3 Factory: `0x1F98431c8aD98523631AE4a59f267346ea31F984`\n- QuickSwap Factory: `0x5757371414417b8C6CAad45bAeF941aBc7d3Ab32`\n\n**Arbitrum:**\n- Uniswap V3 Factory: `0x1F98431c8aD98523631AE4a59f267346ea31F984`\n- GMX Vault: `0x489ee077994B6658eAfA855C308275EAd8097C4A`\n\n**Base:**\n- Uniswap V3 Factory: `0x33128a8fC17869897dcE68Ed026d694621f6FDfD`\n- Aerodrome Factory: `0x420DD381b31aEf6683db6B902084cB0FFECe40Da`\n\n**Always verify addresses** with the user or official documentation before indexing.\n\n---\n\n## Troubleshooting\n\n### Contract Import Fails\n1. Check if the contract is verified on the block explorer\n2. Try using a different block explorer or network\n3. Fall back to template init and manually add the ABI\n\n### Network Not Found\n- Check the full network list: `pnpx envio init contract-import explorer --help`\n- Use the exact CLI value from the list (e.g., `ethereum-mainnet`, `arbitrum-one`)\n\n### ABI Not Available\nUse local ABI import instead:\n```bash\npnpx envio init contract-import local \\\n  -a ./path/to/abi.json \\\n  -c <CONTRACT_ADDRESS> \\\n  -b <NETWORK_ID> \\\n  --contract-name <NAME> \\\n  -n <PROJECT_NAME> \\\n  -l typescript \\\n  -d <DIRECTORY_NAME> \\\n  --single-contract \\\n  --all-events \\\n  --api-token \"\"\n```"
              }
            ],
            "skills": [
              {
                "name": "HyperIndex Development",
                "description": "This skill should be used when the user asks to \"create an indexer\", \"build a hyperindex\", \"index blockchain events\", \"write event handlers\", \"configure config.yaml\", \"define schema.graphql\", \"use envio\", \"set up hyperindex\", \"index smart contract events\", \"create graphql schema for blockchain data\", or mentions Envio, HyperIndex, blockchain indexing, or event handler development.",
                "path": "plugins/envio-hyperindex/skills/hyperindex-development/SKILL.md",
                "frontmatter": {
                  "name": "HyperIndex Development",
                  "description": "This skill should be used when the user asks to \"create an indexer\", \"build a hyperindex\", \"index blockchain events\", \"write event handlers\", \"configure config.yaml\", \"define schema.graphql\", \"use envio\", \"set up hyperindex\", \"index smart contract events\", \"create graphql schema for blockchain data\", or mentions Envio, HyperIndex, blockchain indexing, or event handler development.",
                  "version": "1.0.0"
                },
                "content": "# HyperIndex Development\n\nHyperIndex is Envio's blazing-fast, developer-friendly multichain blockchain indexer. It transforms on-chain events into structured, queryable databases with GraphQL APIs.\n\n## Quick Start\n\nInitialize a new indexer:\n\n```bash\npnpx envio init\n```\n\nRun locally:\n\n```bash\npnpm dev\n```\n\n## Essential Files\n\nEvery HyperIndex project contains three core files:\n\n1. **`config.yaml`** - Defines networks, contracts, events to index\n2. **`schema.graphql`** - Defines GraphQL entities for indexed data\n3. **`src/EventHandlers.ts`** - Contains event processing logic\n\nAfter changes to `config.yaml` or `schema.graphql`, run:\n\n```bash\npnpm codegen\n```\n\n## Development Environment\n\n**Requirements:**\n- Node.js v20+ (v22 recommended)\n- pnpm v8+\n- Docker Desktop (for local development)\n\n**Key commands:**\n- `pnpm codegen` - Generate types after config/schema changes\n- `pnpm tsc --noEmit` - Type-check TypeScript\n- `TUI_OFF=true pnpm dev` - Run indexer with visible output\n\n## Configuration (config.yaml)\n\nBasic structure:\n\n```yaml\n# yaml-language-server: $schema=./node_modules/envio/evm.schema.json\nname: my-indexer\nnetworks:\n  - id: 1  # Ethereum mainnet\n    start_block: 0  # HyperSync is fast - start from genesis\n    contracts:\n      - name: MyContract\n        address: 0xContractAddress\n        handler: src/EventHandlers.ts\n        events:\n          - event: Transfer(address indexed from, address indexed to, uint256 value)\n```\n\n**Key options:**\n- `address` - Single or array of addresses\n- `start_block` - Block to begin indexing. **Use `0` with HyperSync** (default) - it's extremely fast and syncs millions of blocks in minutes. Only specify a later block if using RPC on unsupported networks.\n- `handler` - Path to event handler file\n- `events` - Event signatures to index\n\n**For transaction/block data access**, use `field_selection`. By default, `event.transaction` is `{}` (empty).\n\n**Per-event (recommended)** - Only fetch extra fields for events that need them. More fields = more data transfer = slower indexing:\n\n```yaml\nevents:\n  - event: Transfer(address indexed from, address indexed to, uint256 value)\n    field_selection:\n      transaction_fields:\n        - hash\n  - event: Approval(address indexed owner, address indexed spender, uint256 value)\n    # No field_selection - this event doesn't need transaction data\n```\n\n**Global** - Applies to ALL events. Use only when most/all events need the same fields:\n\n```yaml\nfield_selection:\n  transaction_fields:\n    - hash\n```\n\n**Available fields:**\n- `transaction_fields`: `hash`, `from`, `to`, `value`, `gasPrice`, `gas`, `input`, `nonce`, `transactionIndex`, `gasUsed`, `status`, etc.\n- `block_fields`: `miner`, `gasLimit`, `gasUsed`, `baseFeePerGas`, `size`, `difficulty`, etc.\n\n**For dynamic contracts** (factory pattern), omit address and use contractRegister.\n\n## Schema (schema.graphql)\n\nDefine entities without `@entity` decorator:\n\n```graphql\ntype Token {\n  id: ID!\n  name: String!\n  symbol: String!\n  decimals: BigInt!\n  totalSupply: BigInt!\n}\n\ntype Transfer {\n  id: ID!\n  from: String!\n  to: String!\n  amount: BigInt!\n  token_id: String!  # Relationship via _id suffix\n  blockNumber: BigInt!\n  timestamp: BigInt!\n}\n```\n\n**Key rules:**\n- Use `String!` instead of `Bytes!`\n- Use `_id` suffix for relationships (e.g., `token_id` not `token`)\n- Entity arrays require `@derivedFrom`: `transfers: [Transfer!]! @derivedFrom(field: \"token\")`\n- No `@entity` decorators needed\n\n## Event Handlers\n\nBasic handler pattern:\n\n```typescript\nimport { MyContract } from \"generated\";\n\nMyContract.Transfer.handler(async ({ event, context }) => {\n  const entity = {\n    id: `${event.chainId}-${event.transaction.hash}-${event.logIndex}`,\n    from: event.params.from,\n    to: event.params.to,\n    amount: event.params.amount,\n    blockNumber: BigInt(event.block.number),\n    timestamp: BigInt(event.block.timestamp),\n  };\n\n  context.Transfer.set(entity);\n});\n```\n\n**Entity updates** - Use spread operator (entities are immutable):\n\n```typescript\nconst existing = await context.Token.get(tokenId);\nif (existing) {\n  context.Token.set({\n    ...existing,\n    totalSupply: newSupply,\n  });\n}\n```\n\n**Dynamic contract registration** (factory pattern):\n\n```typescript\nFactory.PairCreated.contractRegister(({ event, context }) => {\n  context.addPair(event.params.pair);\n});\n\nFactory.PairCreated.handler(async ({ event, context }) => {\n  // Handle the event...\n});\n```\n\n## Effect API for External Calls\n\nWhen using `preload_handlers: true`, external calls MUST use the Effect API:\n\n```typescript\nimport { S, createEffect } from \"envio\";\n\nexport const getTokenMetadata = createEffect({\n  name: \"getTokenMetadata\",\n  input: S.string,\n  output: S.object({\n    name: S.string,\n    symbol: S.string,\n    decimals: S.number,\n  }),\n  cache: true,\n}, async ({ input: address }) => {\n  // Fetch token metadata via RPC\n  return { name: \"Token\", symbol: \"TKN\", decimals: 18 };\n});\n\n// In handler:\nMyContract.Event.handler(async ({ event, context }) => {\n  const metadata = await context.effect(getTokenMetadata, event.params.token);\n});\n```\n\n## Common Patterns\n\n**Multichain IDs** - Prefix with chainId:\n```typescript\nconst id = `${event.chainId}-${event.params.tokenId}`;\n```\n\n**Timestamps** - Always cast to BigInt:\n```typescript\ntimestamp: BigInt(event.block.timestamp)\n```\n\n**Address consistency** - Use lowercase:\n```typescript\nconst address = event.params.token.toLowerCase();\n```\n\n**BigDecimal precision** - Import from generated:\n```typescript\nimport { BigDecimal } from \"generated\";\nconst ZERO_BD = new BigDecimal(0);\n```\n\n## Logging & Debugging\n\n**Logging in handlers:**\n```typescript\ncontext.log.debug(\"Detailed info\");\ncontext.log.info(\"Processing transfer\", { from, to, value });\ncontext.log.warn(\"Large transfer detected\");\ncontext.log.error(\"Failed to process\", { error, txHash });\n```\n\n**Run with visible output:**\n```bash\nTUI_OFF=true pnpm dev\n```\n\n**Log levels via env vars:**\n```bash\nLOG_LEVEL=\"debug\"     # Show debug logs (default: \"info\")\nLOG_LEVEL=\"trace\"     # Most verbose\n```\n\n**Common issues checklist:**\n- Missing `await` on `context.Entity.get()`\n- Wrong field names (check generated types)\n- Missing `field_selection` for transaction data\n- Logs not appearing? They're skipped during preload phase\n\nSee `references/logging-debugging.md` for structured logging, log strategies, and troubleshooting patterns.\n\n## Block Handlers\n\nIndex data on every block (or interval) without specific events:\n\n```typescript\nimport { Ethereum } from \"generated\";\n\nEthereum.onBlock(\n  async ({ block, context }) => {\n    context.BlockStats.set({\n      id: `${block.number}`,\n      number: BigInt(block.number),\n      timestamp: BigInt(block.timestamp),\n      gasUsed: block.gasUsed,\n    });\n  },\n  { interval: 100 }  // Every 100 blocks\n);\n```\n\nSee `references/block-handlers.md` for intervals, multichain, and preset handlers.\n\n## Multichain Indexing\n\nIndex the same contract across multiple chains:\n\n```yaml\nnetworks:\n  - id: 1       # Ethereum\n    start_block: 0\n    contracts:\n      - name: MyToken\n        address: 0x...\n  - id: 137     # Polygon\n    start_block: 0\n    contracts:\n      - name: MyToken\n        address: 0x...\n```\n\n**Important:** Use chain-prefixed IDs to prevent collisions:\n```typescript\nconst id = `${event.chainId}_${event.params.tokenId}`;\n```\n\nSee `references/multichain-indexing.md` for ordered vs unordered mode.\n\n## Wildcard Indexing\n\nIndex events across all contracts (no address specified):\n\n```typescript\nERC20.Transfer.handler(\n  async ({ event, context }) => {\n    context.Transfer.set({\n      id: `${event.chainId}_${event.block.number}_${event.logIndex}`,\n      token: event.srcAddress,  // The actual contract\n      from: event.params.from,\n      to: event.params.to,\n    });\n  },\n  { wildcard: true }\n);\n```\n\nSee `references/wildcard-indexing.md` for topic filtering.\n\n## Testing\n\nUnit test handlers with MockDb:\n\n```typescript\nimport { TestHelpers } from \"generated\";\nconst { MockDb, MyContract, Addresses } = TestHelpers;\n\nit(\"creates entity on event\", async () => {\n  const mockDb = MockDb.createMockDb();\n  const event = MyContract.Transfer.createMockEvent({\n    from: Addresses.defaultAddress,\n    to: \"0x456...\",\n    value: BigInt(1000),\n  });\n\n  const updatedDb = await mockDb.processEvents([event]);\n  const transfer = updatedDb.entities.Transfer.get(\"...\");\n  assert.ok(transfer);\n});\n```\n\nSee `references/testing.md` for complete patterns.\n\n## Querying Data Locally\n\nWhen running `pnpm dev`, query indexed data via GraphQL at `http://localhost:8080/v1/graphql`.\n\n**Check indexing progress first** (always do this before assuming data is missing):\n\n```bash\ncurl -s http://localhost:8080/v1/graphql \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"{ _meta { chainId startBlock progressBlock sourceBlock eventsProcessed isReady } }\"}'\n```\n\n- `progressBlock` - Current processed block\n- `sourceBlock` - Latest block on chain (target)\n- `isReady` - `true` when fully synced\n\n**Query entities:**\n\n```bash\ncurl -s http://localhost:8080/v1/graphql \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"{ Transfer(limit: 10, order_by: {blockNumber: desc}) { id chainId from to amount blockNumber } }\"}'\n```\n\n**Filter by chain (multichain):**\n\n```bash\ncurl -s http://localhost:8080/v1/graphql \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"{ Transfer(where: {chainId: {_eq: 42161}}, limit: 10) { id from to amount } }\"}'\n```\n\n**Common filter operators:** `_eq`, `_neq`, `_gt`, `_gte`, `_lt`, `_lte`, `_in`, `_like`\n\n**Tip:** BigInt values must be quoted strings in filters: `{amount: {_gt: \"1000000000000000000\"}}`\n\nSee `references/local-querying.md` for comprehensive query patterns, pagination, and debugging tips.\n\n## Database Indexes\n\nOptimize query performance with `@index`:\n\n```graphql\ntype Transfer {\n  id: ID!\n  from: String! @index\n  to: String! @index\n  timestamp: BigInt! @index\n}\n\ntype Swap @index(fields: [\"pair\", \"timestamp\"]) {\n  id: ID!\n  pair_id: String! @index\n  timestamp: BigInt!\n}\n```\n\nSee `references/database-indexes.md` for optimization tips.\n\n## Preload Optimization\n\n> **Important:** Handlers run TWICE when `preload_handlers: true` (default since v2.27).\n\nThis flagship feature reduces database roundtrips from thousands to single digits:\n\n```typescript\n// Phase 1 (Preload): All handlers run concurrently, reads are batched\n// Phase 2 (Execution): Handlers run sequentially, reads come from cache\nMyContract.Event.handler(async ({ event, context }) => {\n  // Use Promise.all for concurrent reads\n  const [sender, receiver] = await Promise.all([\n    context.Account.get(event.params.from),\n    context.Account.get(event.params.to),\n  ]);\n\n  // Skip non-essential logic during preload\n  if (context.isPreload) return;\n\n  // Actual processing (only runs in execution phase)\n  context.Transfer.set({ ... });\n});\n```\n\n**Critical rule:** Never call `fetch()` or external APIs directly. Use the Effect API.\n\nSee `references/preload-optimization.md` for the full mental model and best practices.\n\n## Production Deployment\n\nDeploy to Envio's hosted service for production-ready infrastructure:\n\n```yaml\n# Production config\nname: my-indexer\nrollback_on_reorg: true  # Always enable for production\nnetworks:\n  - id: 1\n    start_block: 18000000\n    confirmed_block_threshold: 250  # Reorg protection\n```\n\n**Pre-deployment checklist:**\n1. `pnpm codegen` - Generate types\n2. `pnpm tsc --noEmit` - Type check\n3. `TUI_OFF=true pnpm dev` - Test locally with visible logs\n4. Push to GitHub → Auto-deploy via Envio Hosted Service\n\nSee `references/deployment.md` for hosted service setup and `references/reorg-support.md` for chain reorganization handling.\n\n## Additional Resources\n\n### Reference Files\n\nFor detailed patterns and advanced techniques, consult:\n\n**Core Concepts:**\n- **`references/config-options.md`** - Complete config.yaml options\n- **`references/effect-api.md`** - External calls and RPC patterns\n- **`references/entity-patterns.md`** - Entity relationships and updates\n- **`references/preload-optimization.md`** - How preload works, common footguns\n\n**Advanced Features:**\n- **`references/block-handlers.md`** - Block-level indexing with intervals\n- **`references/multichain-indexing.md`** - Ordered vs unordered mode\n- **`references/wildcard-indexing.md`** - Topic filtering, dynamic contracts\n- **`references/contract-state.md`** - Read on-chain state via RPC/viem\n- **`references/rpc-data-source.md`** - RPC config and fallback\n\n**Operations:**\n- **`references/logging-debugging.md`** - Logging, TUI, troubleshooting\n- **`references/graphql-querying.md`** - Query indexed data, check progress, debug\n- **`references/database-indexes.md`** - Index optimization\n- **`references/testing.md`** - MockDb and test patterns\n\n**Production:**\n- **`references/deployment.md`** - Hosted service deployment\n- **`references/reorg-support.md`** - Chain reorganization handling\n\n### Example Files\n\nWorking examples in `examples/`:\n- **`examples/basic-handler.ts`** - Simple event handler\n- **`examples/factory-pattern.ts`** - Dynamic contract registration\n\n### External Documentation\n\n- Full docs: https://docs.envio.dev/docs/HyperIndex-LLM/hyperindex-complete\n- Example indexers:\n  - Uniswap v4: https://github.com/enviodev/uniswap-v4-indexer\n  - Safe: https://github.com/enviodev/safe-analysis-indexer"
              },
              {
                "name": "Subgraph Migration",
                "description": "This skill should be used when the user asks to \"migrate from subgraph\", \"convert subgraph to hyperindex\", \"migrate from thegraph\", \"port subgraph\", \"convert subgraph handlers\", \"migrate assemblyscript to typescript\", or mentions TheGraph, subgraph migration, subgraph.yaml conversion, or converting from TheGraph to Envio. For core HyperIndex development patterns, refer to the hyperindex-development skill.",
                "path": "plugins/envio-hyperindex/skills/subgraph-migration/SKILL.md",
                "frontmatter": {
                  "name": "Subgraph Migration",
                  "description": "This skill should be used when the user asks to \"migrate from subgraph\", \"convert subgraph to hyperindex\", \"migrate from thegraph\", \"port subgraph\", \"convert subgraph handlers\", \"migrate assemblyscript to typescript\", or mentions TheGraph, subgraph migration, subgraph.yaml conversion, or converting from TheGraph to Envio. For core HyperIndex development patterns, refer to the hyperindex-development skill.",
                  "version": "1.0.0"
                },
                "content": "# Subgraph to HyperIndex Migration\n\nMigrate from TheGraph subgraphs to Envio HyperIndex. HyperIndex delivers up to 100x faster indexing with a developer-friendly TypeScript API.\n\n## Migration Overview\n\nThree major steps:\n1. `subgraph.yaml` → `config.yaml`\n2. Schema migration (near copy-paste)\n3. Event handler migration (AssemblyScript → TypeScript)\n\n## Step 1: Config Migration\n\n### subgraph.yaml → config.yaml\n\n**TheGraph:**\n```yaml\nspecVersion: 0.0.4\ndataSources:\n  - kind: ethereum/contract\n    name: Factory\n    network: mainnet\n    source:\n      address: \"0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f\"\n      startBlock: 10000835\n      abi: Factory\n    mapping:\n      eventHandlers:\n        - event: PairCreated(indexed address,indexed address,address,uint256)\n          handler: handlePairCreated\ntemplates:\n  - name: Pair\n    source:\n      abi: Pair\n```\n\n**HyperIndex:**\n```yaml\nname: my-indexer\nnetworks:\n  - id: 1\n    start_block: 10000835\n    contracts:\n      - name: Factory\n        address: 0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f\n        handler: src/factory.ts\n        events:\n          - event: PairCreated(address indexed token0, address indexed token1, address pair, uint256)\n      - name: Pair\n        handler: src/pair.ts  # No address - dynamic\n        events:\n          - event: Swap(...)\n```\n\n**Key differences:**\n- Remove `dataSources`, `templates`, `mapping` nesting\n- Use `networks` → `contracts` structure\n- Event signatures include parameter names\n- Dynamic contracts have no address field\n\n## Step 2: Schema Migration\n\n### Remove @entity decorator\n\n```graphql\n# TheGraph\ntype Token @entity {\n  id: ID!\n  symbol: String!\n}\n\n# HyperIndex\ntype Token {\n  id: ID!\n  symbol: String!\n}\n```\n\n### Convert Bytes to String\n\n```graphql\n# TheGraph\naddress: Bytes!\n\n# HyperIndex\naddress: String!\n```\n\n### Entity Relationships\n\n```graphql\n# TheGraph\ntype Transfer @entity {\n  token: Token!\n}\n\n# HyperIndex - use _id suffix\ntype Transfer {\n  token_id: String!\n}\n```\n\n### Entity Arrays MUST have @derivedFrom\n\n```graphql\n# TheGraph (sometimes implicit)\ntype Token @entity {\n  transfers: [Transfer!]!\n}\n\n# HyperIndex - REQUIRED explicit @derivedFrom\ntype Token {\n  transfers: [Transfer!]! @derivedFrom(field: \"token\")\n}\n\ntype Transfer {\n  token_id: String!  # The field referenced by @derivedFrom\n}\n```\n\n**Critical:** Arrays without `@derivedFrom` cause codegen error EE211.\n\n## Step 3: Handler Migration\n\n### Basic Pattern\n\n**TheGraph (AssemblyScript):**\n```typescript\nexport function handleTransfer(event: TransferEvent): void {\n  let entity = new Transfer(event.transaction.hash.toHexString());\n  entity.from = event.params.from;\n  entity.to = event.params.to;\n  entity.amount = event.params.value;\n  entity.save();\n}\n```\n\n**HyperIndex (TypeScript):**\n```typescript\nimport { MyContract } from \"generated\";\n\nMyContract.Transfer.handler(async ({ event, context }) => {\n  const entity = {\n    id: `${event.chainId}-${event.transaction.hash}-${event.logIndex}`,\n    from: event.params.from,\n    to: event.params.to,\n    amount: event.params.value,\n    blockNumber: BigInt(event.block.number),\n  };\n\n  context.Transfer.set(entity);\n});\n```\n\n### Entity Loading\n\n**TheGraph:**\n```typescript\nlet token = Token.load(id);\nif (token == null) {\n  token = new Token(id);\n}\n```\n\n**HyperIndex:**\n```typescript\nlet token = await context.Token.get(id);\nif (!token) {\n  token = { id, name: \"Unknown\", /* ... */ };\n}\n```\n\n### Entity Updates\n\n**TheGraph:**\n```typescript\ntoken.totalSupply = newSupply;\ntoken.save();\n```\n\n**HyperIndex (use spread - entities are immutable):**\n```typescript\ncontext.Token.set({\n  ...token,\n  totalSupply: newSupply,\n});\n```\n\n### Dynamic Contract Registration\n\n**TheGraph:**\n```typescript\nimport { Pair as PairTemplate } from \"../generated/templates\";\nPairTemplate.create(event.params.pair);\n```\n\n**HyperIndex:**\n```typescript\n// Register BEFORE handler\nFactory.PairCreated.contractRegister(({ event, context }) => {\n  context.addPair(event.params.pair);\n});\n\nFactory.PairCreated.handler(async ({ event, context }) => {\n  // Handle event...\n});\n```\n\n### Contract State (RPC Calls)\n\n**TheGraph:**\n```typescript\nlet contract = ERC20.bind(address);\nlet name = contract.name();\n```\n\n**HyperIndex (use Effect API):**\n```typescript\nimport { createEffect, S } from \"envio\";\n\nexport const getTokenName = createEffect({\n  name: \"getTokenName\",\n  input: S.string,\n  output: S.string,\n  cache: true,\n}, async ({ input: address }) => {\n  // Use viem for RPC calls\n  const name = await client.readContract({\n    address: address as `0x${string}`,\n    abi: ERC20_ABI,\n    functionName: \"name\",\n  });\n  return name;\n});\n\n// In handler\nconst name = await context.effect(getTokenName, address);\n```\n\n## Common Migration Issues\n\n### Missing async/await\n\n```typescript\n// WRONG - returns {} instead of entity\nconst token = context.Token.get(id);\n\n// CORRECT\nconst token = await context.Token.get(id);\n```\n\n### Field Selection for Transaction Data\n\n```yaml\n# Add to config.yaml for event.transaction.hash access\nevents:\n  - event: Transfer(...)\n    field_selection:\n      transaction_fields:\n        - hash\n```\n\n### Multichain ID Prefixes\n\n```typescript\n// Always prefix with chainId for multichain\nconst id = `${event.chainId}-${originalId}`;\n```\n\n### BigDecimal Precision\n\nMaintain precision from original subgraph:\n\n```typescript\nimport { BigDecimal } from \"generated\";\n\nconst ZERO_BD = new BigDecimal(0);\nconst ONE_BD = new BigDecimal(1);\n\n// Don't simplify to JavaScript numbers\n```\n\n## Migration Checklist\n\n- [ ] Convert subgraph.yaml to config.yaml\n- [ ] Remove @entity decorators from schema\n- [ ] Change Bytes! to String!\n- [ ] Use _id suffix for relationships\n- [ ] Add @derivedFrom to all entity arrays\n- [ ] Add async to all handlers\n- [ ] Add await to all context.Entity.get() calls\n- [ ] Use spread operator for entity updates\n- [ ] Replace Template.create() with contractRegister\n- [ ] Add field_selection for transaction data\n- [ ] Prefix IDs with chainId for multichain\n- [ ] Convert contract bindings to Effect API\n\n## Additional Resources\n\n### Reference Files\n\nFor detailed migration patterns:\n- **`references/migration-patterns.md`** - Complete pattern reference\n- **`references/common-mistakes.md`** - Pitfalls and solutions\n\n### External Resources\n\n- Full docs: https://docs.envio.dev/docs/HyperIndex-LLM/hyperindex-complete\n- Migration guide: https://docs.envio.dev/docs/migration-guide\n- Example indexers:\n  - Uniswap v4: https://github.com/enviodev/uniswap-v4-indexer\n  - Safe: https://github.com/enviodev/safe-analysis-indexer"
              }
            ]
          }
        ]
      }
    }
  ]
}