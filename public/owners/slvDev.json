{
  "owner": {
    "id": "slvDev",
    "display_name": "Slava S.",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/15254847?u=e843f2d73087b964653fa395c9efc992210419d2&v=4",
    "url": "https://github.com/slvDev",
    "bio": "LLM - it's just linear algebra",
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 9,
      "total_stars": 9,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "slvDev/weasel",
      "url": "https://github.com/slvDev/weasel",
      "description": "Solidity static analyzer you can talk to. MCP integration for Claude Code, Cursor, and Windsurf.",
      "homepage": null,
      "signals": {
        "stars": 9,
        "forks": 0,
        "pushed_at": "2026-01-10T11:36:26Z",
        "created_at": "2025-11-08T07:43:13Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 995
        },
        {
          "path": ".github",
          "type": "tree",
          "size": null
        },
        {
          "path": ".github/workflows",
          "type": "tree",
          "size": null
        },
        {
          "path": ".github/workflows/release.yml",
          "type": "blob",
          "size": 1991
        },
        {
          "path": ".gitignore",
          "type": "blob",
          "size": 51
        },
        {
          "path": "Cargo.lock",
          "type": "blob",
          "size": 32760
        },
        {
          "path": "Cargo.toml",
          "type": "blob",
          "size": 365
        },
        {
          "path": "LICENSE.md",
          "type": "blob",
          "size": 1063
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 8916
        },
        {
          "path": "assets",
          "type": "tree",
          "size": null
        },
        {
          "path": "assets/demo.gif",
          "type": "blob",
          "size": 340097
        },
        {
          "path": "assets/flow.png",
          "type": "blob",
          "size": 15618
        },
        {
          "path": "release.md",
          "type": "blob",
          "size": 2362
        },
        {
          "path": "src",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/cli",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/cli/detectors.rs",
          "type": "blob",
          "size": 1481
        },
        {
          "path": "src/cli/init.rs",
          "type": "blob",
          "size": 270
        },
        {
          "path": "src/cli/mcp",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/cli/mcp/add.rs",
          "type": "blob",
          "size": 4843
        },
        {
          "path": "src/cli/mcp/executors.rs",
          "type": "blob",
          "size": 8500
        },
        {
          "path": "src/cli/mcp/mod.rs",
          "type": "blob",
          "size": 876
        },
        {
          "path": "src/cli/mcp/remove.rs",
          "type": "blob",
          "size": 2414
        },
        {
          "path": "src/cli/mcp/serve.rs",
          "type": "blob",
          "size": 13066
        },
        {
          "path": "src/cli/mcp/tools.rs",
          "type": "blob",
          "size": 2371
        },
        {
          "path": "src/cli/mod.rs",
          "type": "blob",
          "size": 59
        },
        {
          "path": "src/cli/run.rs",
          "type": "blob",
          "size": 1181
        },
        {
          "path": "src/config",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/config/mod.rs",
          "type": "blob",
          "size": 4838
        },
        {
          "path": "src/core",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/core/c3_linearization.rs",
          "type": "blob",
          "size": 8355
        },
        {
          "path": "src/core/context.rs",
          "type": "blob",
          "size": 21162
        },
        {
          "path": "src/core/engine.rs",
          "type": "blob",
          "size": 26979
        },
        {
          "path": "src/core/finding_collector.rs",
          "type": "blob",
          "size": 1132
        },
        {
          "path": "src/core/import_resolver.rs",
          "type": "blob",
          "size": 6034
        },
        {
          "path": "src/core/mod.rs",
          "type": "blob",
          "size": 259
        },
        {
          "path": "src/core/processor.rs",
          "type": "blob",
          "size": 2994
        },
        {
          "path": "src/core/project_detector.rs",
          "type": "blob",
          "size": 11635
        },
        {
          "path": "src/core/registry.rs",
          "type": "blob",
          "size": 1496
        },
        {
          "path": "src/core/visitor.rs",
          "type": "blob",
          "size": 25129
        },
        {
          "path": "src/detectors",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/detectors/gas",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/detectors/gas/address_zero_check.rs",
          "type": "blob",
          "size": 6043
        },
        {
          "path": "src/detectors/gas/array_compound_assignment.rs",
          "type": "blob",
          "size": 5735
        },
        {
          "path": "src/detectors/gas/array_length_in_loop.rs",
          "type": "blob",
          "size": 4623
        },
        {
          "path": "src/detectors/gas/avoid_contract_existence_checks.rs",
          "type": "blob",
          "size": 4737
        },
        {
          "path": "src/detectors/gas/bool_storage.rs",
          "type": "blob",
          "size": 4387
        },
        {
          "path": "src/detectors/gas/boolean_comparison.rs",
          "type": "blob",
          "size": 5106
        },
        {
          "path": "src/detectors/gas/cache_state_variables.rs",
          "type": "blob",
          "size": 5272
        },
        {
          "path": "src/detectors/gas/calldata_instead_of_memory.rs",
          "type": "blob",
          "size": 9728
        },
        {
          "path": "src/detectors/gas/compound_assignment.rs",
          "type": "blob",
          "size": 5323
        },
        {
          "path": "src/detectors/gas/custom_errors_instead_of_revert_strings.rs",
          "type": "blob",
          "size": 5353
        },
        {
          "path": "src/detectors/gas/default_value_initialization.rs",
          "type": "blob",
          "size": 4748
        },
        {
          "path": "src/detectors/gas/internal_function_not_called.rs",
          "type": "blob",
          "size": 4793
        },
        {
          "path": "src/detectors/gas/long_revert_string.rs",
          "type": "blob",
          "size": 5224
        },
        {
          "path": "src/detectors/gas/mod.rs",
          "type": "blob",
          "size": 2594
        },
        {
          "path": "src/detectors/gas/msg_sender_usage.rs",
          "type": "blob",
          "size": 11572
        },
        {
          "path": "src/detectors/gas/payable_function.rs",
          "type": "blob",
          "size": 4425
        },
        {
          "path": "src/detectors/gas/post_increment.rs",
          "type": "blob",
          "size": 5213
        },
        {
          "path": "src/detectors/gas/private_constants.rs",
          "type": "blob",
          "size": 4009
        },
        {
          "path": "src/detectors/gas/shift_instead_of_mul_div.rs",
          "type": "blob",
          "size": 6036
        },
        {
          "path": "src/detectors/gas/should_be_immutable.rs",
          "type": "blob",
          "size": 8543
        },
        {
          "path": "src/detectors/gas/split_require.rs",
          "type": "blob",
          "size": 5851
        },
        {
          "path": "src/detectors/gas/superfluous_event_fields.rs",
          "type": "blob",
          "size": 4665
        },
        {
          "path": "src/detectors/gas/this_usage.rs",
          "type": "blob",
          "size": 4831
        },
        {
          "path": "src/detectors/gas/uint256_to_bool_mapping.rs",
          "type": "blob",
          "size": 3880
        },
        {
          "path": "src/detectors/gas/uint_gt_zero.rs",
          "type": "blob",
          "size": 3327
        },
        {
          "path": "src/detectors/gas/unchecked_loop_increment.rs",
          "type": "blob",
          "size": 5813
        },
        {
          "path": "src/detectors/gas/unnecessary_variable_cache.rs",
          "type": "blob",
          "size": 9083
        },
        {
          "path": "src/detectors/gas/unsafe_array_access.rs",
          "type": "blob",
          "size": 5684
        },
        {
          "path": "src/detectors/gas/use_erc721a.rs",
          "type": "blob",
          "size": 3907
        },
        {
          "path": "src/detectors/gas/weth_address_definition.rs",
          "type": "blob",
          "size": 3384
        },
        {
          "path": "src/detectors/high",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/detectors/high/comparison_without_effect.rs",
          "type": "blob",
          "size": 4910
        },
        {
          "path": "src/detectors/high/curve_spot_price_oracle.rs",
          "type": "blob",
          "size": 4613
        },
        {
          "path": "src/detectors/high/delegatecall_in_loop.rs",
          "type": "blob",
          "size": 6403
        },
        {
          "path": "src/detectors/high/mod.rs",
          "type": "blob",
          "size": 472
        },
        {
          "path": "src/detectors/high/msg_value_in_loop.rs",
          "type": "blob",
          "size": 6343
        },
        {
          "path": "src/detectors/high/wsteth_stethpertoken_usage.rs",
          "type": "blob",
          "size": 4730
        },
        {
          "path": "src/detectors/low",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/detectors/low/assembly_optimizer_bug.rs",
          "type": "blob",
          "size": 10982
        },
        {
          "path": "src/detectors/low/block_timestamp_deadline.rs",
          "type": "blob",
          "size": 4279
        },
        {
          "path": "src/detectors/low/curve_calc_token_amount.rs",
          "type": "blob",
          "size": 3853
        },
        {
          "path": "src/detectors/low/decimals_type.rs",
          "type": "blob",
          "size": 4187
        },
        {
          "path": "src/detectors/low/deprecated_abi_encoder_v2.rs",
          "type": "blob",
          "size": 3569
        },
        {
          "path": "src/detectors/low/deprecated_approve.rs",
          "type": "blob",
          "size": 3651
        },
        {
          "path": "src/detectors/low/deprecated_safe_approve.rs",
          "type": "blob",
          "size": 3993
        },
        {
          "path": "src/detectors/low/deprecated_setup_role.rs",
          "type": "blob",
          "size": 3286
        },
        {
          "path": "src/detectors/low/division_before_multiplication.rs",
          "type": "blob",
          "size": 5124
        },
        {
          "path": "src/detectors/low/division_by_zero.rs",
          "type": "blob",
          "size": 12254
        },
        {
          "path": "src/detectors/low/division_rounding.rs",
          "type": "blob",
          "size": 9254
        },
        {
          "path": "src/detectors/low/domain_separator_replay.rs",
          "type": "blob",
          "size": 6055
        },
        {
          "path": "src/detectors/low/duplicate_import.rs",
          "type": "blob",
          "size": 3218
        },
        {
          "path": "src/detectors/low/ecrecover_malleability.rs",
          "type": "blob",
          "size": 4047
        },
        {
          "path": "src/detectors/low/empty_ether_receiver.rs",
          "type": "blob",
          "size": 3894
        },
        {
          "path": "src/detectors/low/empty_function_body.rs",
          "type": "blob",
          "size": 4384
        },
        {
          "path": "src/detectors/low/erc20_decimals.rs",
          "type": "blob",
          "size": 4089
        },
        {
          "path": "src/detectors/low/erc20_symbol_not_standard.rs",
          "type": "blob",
          "size": 3762
        },
        {
          "path": "src/detectors/low/external_call_in_loop.rs",
          "type": "blob",
          "size": 4787
        },
        {
          "path": "src/detectors/low/fallback_lacking_payable.rs",
          "type": "blob",
          "size": 3149
        },
        {
          "path": "src/detectors/low/initializer_frontrun.rs",
          "type": "blob",
          "size": 4322
        },
        {
          "path": "src/detectors/low/initializer_on_internal.rs",
          "type": "blob",
          "size": 3724
        },
        {
          "path": "src/detectors/low/lack_of_slippage_check.rs",
          "type": "blob",
          "size": 3846
        },
        {
          "path": "src/detectors/low/low_level_call_gas_grief.rs",
          "type": "blob",
          "size": 5640
        },
        {
          "path": "src/detectors/low/mint_burn_address_validation.rs",
          "type": "blob",
          "size": 9615
        },
        {
          "path": "src/detectors/low/missing_gap_storage.rs",
          "type": "blob",
          "size": 3716
        },
        {
          "path": "src/detectors/low/missing_zero_address_validation.rs",
          "type": "blob",
          "size": 8933
        },
        {
          "path": "src/detectors/low/mod.rs",
          "type": "blob",
          "size": 3801
        },
        {
          "path": "src/detectors/low/nft_hard_fork.rs",
          "type": "blob",
          "size": 5687
        },
        {
          "path": "src/detectors/low/push0_opcode.rs",
          "type": "blob",
          "size": 9913
        },
        {
          "path": "src/detectors/low/renounce_while_paused.rs",
          "type": "blob",
          "size": 5297
        },
        {
          "path": "src/detectors/low/sweep_token_accounting.rs",
          "type": "blob",
          "size": 4507
        },
        {
          "path": "src/detectors/low/two_step_ownership_transfer.rs",
          "type": "blob",
          "size": 4565
        },
        {
          "path": "src/detectors/low/uninitialized_implementation.rs",
          "type": "blob",
          "size": 5051
        },
        {
          "path": "src/detectors/low/uninitialized_upgradeable.rs",
          "type": "blob",
          "size": 4310
        },
        {
          "path": "src/detectors/low/unlimited_gas_call.rs",
          "type": "blob",
          "size": 5361
        },
        {
          "path": "src/detectors/low/unsafe_abi_encode_packed.rs",
          "type": "blob",
          "size": 5320
        },
        {
          "path": "src/detectors/low/unsafe_downcast.rs",
          "type": "blob",
          "size": 10781
        },
        {
          "path": "src/detectors/low/unsafe_int_cast.rs",
          "type": "blob",
          "size": 7205
        },
        {
          "path": "src/detectors/low/unsafe_int_to_uint_cast.rs",
          "type": "blob",
          "size": 9294
        },
        {
          "path": "src/detectors/low/unspecific_pragma.rs",
          "type": "blob",
          "size": 5265
        },
        {
          "path": "src/detectors/low/year_365_days.rs",
          "type": "blob",
          "size": 4296
        },
        {
          "path": "src/detectors/low/zero_value_transfer.rs",
          "type": "blob",
          "size": 4608
        },
        {
          "path": "src/detectors/medium",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/detectors/medium/block_number_l2.rs",
          "type": "blob",
          "size": 5903
        },
        {
          "path": "src/detectors/medium/centralization_risk.rs",
          "type": "blob",
          "size": 9774
        },
        {
          "path": "src/detectors/medium/chainlink_stale_price.rs",
          "type": "blob",
          "size": 8883
        },
        {
          "path": "src/detectors/medium/deprecated_chainlink_function.rs",
          "type": "blob",
          "size": 5777
        },
        {
          "path": "src/detectors/medium/deprecated_transfer.rs",
          "type": "blob",
          "size": 5287
        },
        {
          "path": "src/detectors/medium/direct_supports_interface.rs",
          "type": "blob",
          "size": 5440
        },
        {
          "path": "src/detectors/medium/eip712_compliance.rs",
          "type": "blob",
          "size": 8469
        },
        {
          "path": "src/detectors/medium/fee_on_transfer.rs",
          "type": "blob",
          "size": 7263
        },
        {
          "path": "src/detectors/medium/l2_sequencer_check.rs",
          "type": "blob",
          "size": 6807
        },
        {
          "path": "src/detectors/medium/library_function_visibility.rs",
          "type": "blob",
          "size": 6657
        },
        {
          "path": "src/detectors/medium/mod.rs",
          "type": "blob",
          "size": 1766
        },
        {
          "path": "src/detectors/medium/nft_mint_asymmetry.rs",
          "type": "blob",
          "size": 5252
        },
        {
          "path": "src/detectors/medium/solady_safetransfer.rs",
          "type": "blob",
          "size": 6897
        },
        {
          "path": "src/detectors/medium/solmate_safetransfer.rs",
          "type": "blob",
          "size": 6926
        },
        {
          "path": "src/detectors/medium/tx_origin_usage.rs",
          "type": "blob",
          "size": 5229
        },
        {
          "path": "src/detectors/medium/unbounded_fee.rs",
          "type": "blob",
          "size": 7903
        },
        {
          "path": "src/detectors/medium/unchecked_transfer.rs",
          "type": "blob",
          "size": 5747
        },
        {
          "path": "src/detectors/medium/unsafe_approve.rs",
          "type": "blob",
          "size": 6000
        },
        {
          "path": "src/detectors/medium/unsafe_erc20_operations.rs",
          "type": "blob",
          "size": 7363
        },
        {
          "path": "src/detectors/medium/unsafe_mint.rs",
          "type": "blob",
          "size": 5228
        },
        {
          "path": "src/detectors/medium/unsafe_transferfrom.rs",
          "type": "blob",
          "size": 5665
        },
        {
          "path": "src/detectors/medium/usdt_allowance.rs",
          "type": "blob",
          "size": 5115
        },
        {
          "path": "src/detectors/mod.rs",
          "type": "blob",
          "size": 946
        },
        {
          "path": "src/detectors/nc",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/detectors/nc/abi_encode_call.rs",
          "type": "blob",
          "size": 4511
        },
        {
          "path": "src/detectors/nc/abicoder_v2.rs",
          "type": "blob",
          "size": 3980
        },
        {
          "path": "src/detectors/nc/array_indices.rs",
          "type": "blob",
          "size": 3065
        },
        {
          "path": "src/detectors/nc/console_log_import.rs",
          "type": "blob",
          "size": 3119
        },
        {
          "path": "src/detectors/nc/constant_case.rs",
          "type": "blob",
          "size": 5596
        },
        {
          "path": "src/detectors/nc/contract_layout.rs",
          "type": "blob",
          "size": 5118
        },
        {
          "path": "src/detectors/nc/control_structure_style.rs",
          "type": "blob",
          "size": 4135
        },
        {
          "path": "src/detectors/nc/custom_error_no_args.rs",
          "type": "blob",
          "size": 3541
        },
        {
          "path": "src/detectors/nc/default_visibility.rs",
          "type": "blob",
          "size": 6727
        },
        {
          "path": "src/detectors/nc/deprecated_safemath.rs",
          "type": "blob",
          "size": 4161
        },
        {
          "path": "src/detectors/nc/draft_dependency.rs",
          "type": "blob",
          "size": 3024
        },
        {
          "path": "src/detectors/nc/duplicate_require.rs",
          "type": "blob",
          "size": 5387
        },
        {
          "path": "src/detectors/nc/ecrecover_v_check.rs",
          "type": "blob",
          "size": 5706
        },
        {
          "path": "src/detectors/nc/event_args.rs",
          "type": "blob",
          "size": 3439
        },
        {
          "path": "src/detectors/nc/event_args_indexing.rs",
          "type": "blob",
          "size": 4950
        },
        {
          "path": "src/detectors/nc/explicit_num_types.rs",
          "type": "blob",
          "size": 4078
        },
        {
          "path": "src/detectors/nc/function_length.rs",
          "type": "blob",
          "size": 4208
        },
        {
          "path": "src/detectors/nc/function_order.rs",
          "type": "blob",
          "size": 5222
        },
        {
          "path": "src/detectors/nc/hardcoded_address.rs",
          "type": "blob",
          "size": 4528
        },
        {
          "path": "src/detectors/nc/interface_in_separate_file.rs",
          "type": "blob",
          "size": 3587
        },
        {
          "path": "src/detectors/nc/interface_naming.rs",
          "type": "blob",
          "size": 3097
        },
        {
          "path": "src/detectors/nc/large_literal.rs",
          "type": "blob",
          "size": 2707
        },
        {
          "path": "src/detectors/nc/line_length.rs",
          "type": "blob",
          "size": 3128
        },
        {
          "path": "src/detectors/nc/magic_numbers.rs",
          "type": "blob",
          "size": 6388
        },
        {
          "path": "src/detectors/nc/mapping_style.rs",
          "type": "blob",
          "size": 3163
        },
        {
          "path": "src/detectors/nc/missing_error_message.rs",
          "type": "blob",
          "size": 5262
        },
        {
          "path": "src/detectors/nc/missing_event_setter.rs",
          "type": "blob",
          "size": 6924
        },
        {
          "path": "src/detectors/nc/missing_spdx.rs",
          "type": "blob",
          "size": 2496
        },
        {
          "path": "src/detectors/nc/mod.rs",
          "type": "blob",
          "size": 4158
        },
        {
          "path": "src/detectors/nc/named_mappings.rs",
          "type": "blob",
          "size": 3976
        },
        {
          "path": "src/detectors/nc/nonreentrant_before_modifiers.rs",
          "type": "blob",
          "size": 4076
        },
        {
          "path": "src/detectors/nc/numeric_underscores.rs",
          "type": "blob",
          "size": 3310
        },
        {
          "path": "src/detectors/nc/prefer_concat.rs",
          "type": "blob",
          "size": 5546
        },
        {
          "path": "src/detectors/nc/prefer_modifier.rs",
          "type": "blob",
          "size": 5291
        },
        {
          "path": "src/detectors/nc/prefer_require.rs",
          "type": "blob",
          "size": 4280
        },
        {
          "path": "src/detectors/nc/public_to_external.rs",
          "type": "blob",
          "size": 4386
        },
        {
          "path": "src/detectors/nc/redundant_else.rs",
          "type": "blob",
          "size": 4985
        },
        {
          "path": "src/detectors/nc/redundant_return.rs",
          "type": "blob",
          "size": 3800
        },
        {
          "path": "src/detectors/nc/renounce_ownership.rs",
          "type": "blob",
          "size": 5687
        },
        {
          "path": "src/detectors/nc/scientific_notation.rs",
          "type": "blob",
          "size": 2795
        },
        {
          "path": "src/detectors/nc/sensitive_terms.rs",
          "type": "blob",
          "size": 4245
        },
        {
          "path": "src/detectors/nc/setter_event_old_value.rs",
          "type": "blob",
          "size": 6058
        },
        {
          "path": "src/detectors/nc/setter_no_check.rs",
          "type": "blob",
          "size": 7463
        },
        {
          "path": "src/detectors/nc/string_quotes.rs",
          "type": "blob",
          "size": 3453
        },
        {
          "path": "src/detectors/nc/time_units.rs",
          "type": "blob",
          "size": 4621
        },
        {
          "path": "src/detectors/nc/todo_left.rs",
          "type": "blob",
          "size": 3791
        },
        {
          "path": "src/detectors/nc/two_step_critical_changes.rs",
          "type": "blob",
          "size": 6869
        },
        {
          "path": "src/detectors/nc/type_max_literal.rs",
          "type": "blob",
          "size": 3841
        },
        {
          "path": "src/detectors/nc/type_max_value.rs",
          "type": "blob",
          "size": 3796
        },
        {
          "path": "src/detectors/nc/underscore_prefix.rs",
          "type": "blob",
          "size": 5767
        },
        {
          "path": "src/detectors/nc/unused_override_params.rs",
          "type": "blob",
          "size": 5267
        },
        {
          "path": "src/detectors/nc/uppercase_non_constant.rs",
          "type": "blob",
          "size": 3911
        },
        {
          "path": "src/detectors/nc/while_true_loop.rs",
          "type": "blob",
          "size": 4183
        },
        {
          "path": "src/detectors/nc/zero_initialization.rs",
          "type": "blob",
          "size": 4543
        },
        {
          "path": "src/main.rs",
          "type": "blob",
          "size": 2011
        },
        {
          "path": "src/models",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/models/finding.rs",
          "type": "blob",
          "size": 795
        },
        {
          "path": "src/models/mod.rs",
          "type": "blob",
          "size": 594
        },
        {
          "path": "src/models/report.rs",
          "type": "blob",
          "size": 2104
        },
        {
          "path": "src/models/scope.rs",
          "type": "blob",
          "size": 14978
        },
        {
          "path": "src/models/severity.rs",
          "type": "blob",
          "size": 1300
        },
        {
          "path": "src/output",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/output/mod.rs",
          "type": "blob",
          "size": 6300
        },
        {
          "path": "src/utils",
          "type": "tree",
          "size": null
        },
        {
          "path": "src/utils/ast_utils.rs",
          "type": "blob",
          "size": 59582
        },
        {
          "path": "src/utils/location.rs",
          "type": "blob",
          "size": 2249
        },
        {
          "path": "src/utils/mod.rs",
          "type": "blob",
          "size": 87
        },
        {
          "path": "src/utils/test_utils.rs",
          "type": "blob",
          "size": 3067
        },
        {
          "path": "src/utils/version.rs",
          "type": "blob",
          "size": 5380
        },
        {
          "path": "weasel",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 213
        },
        {
          "path": "weasel/.mcp.json",
          "type": "blob",
          "size": 129
        },
        {
          "path": "weasel/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-analyzer",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-analyzer/SKILL.md",
          "type": "blob",
          "size": 6431
        },
        {
          "path": "weasel/skills/weasel-explainer",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-explainer/SKILL.md",
          "type": "blob",
          "size": 1511
        },
        {
          "path": "weasel/skills/weasel-filter",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-filter/SKILL.md",
          "type": "blob",
          "size": 4754
        },
        {
          "path": "weasel/skills/weasel-gas",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-gas/SKILL.md",
          "type": "blob",
          "size": 1484
        },
        {
          "path": "weasel/skills/weasel-overview",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-overview/SKILL.md",
          "type": "blob",
          "size": 3385
        },
        {
          "path": "weasel/skills/weasel-poc",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-poc/SKILL.md",
          "type": "blob",
          "size": 2207
        },
        {
          "path": "weasel/skills/weasel-report",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-report/SKILL.md",
          "type": "blob",
          "size": 1887
        },
        {
          "path": "weasel/skills/weasel-simplify",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-simplify/SKILL.md",
          "type": "blob",
          "size": 4721
        },
        {
          "path": "weasel/skills/weasel-validate",
          "type": "tree",
          "size": null
        },
        {
          "path": "weasel/skills/weasel-validate/SKILL.md",
          "type": "blob",
          "size": 3090
        },
        {
          "path": "weaselup",
          "type": "tree",
          "size": null
        },
        {
          "path": "weaselup/install",
          "type": "blob",
          "size": 2412
        },
        {
          "path": "weaselup/weaselup",
          "type": "blob",
          "size": 4270
        }
      ],
      "marketplace": {
        "name": "weasel",
        "version": null,
        "description": "Weasel - Solidity static analyzer with AI integration",
        "owner_info": {
          "name": "slvDev"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "weasel",
            "description": "Solidity static analysis with security skills for auditing and secure development",
            "source": "./weasel",
            "category": "security",
            "version": "0.4.0",
            "author": {
              "name": "slvDev"
            },
            "install_commands": [
              "/plugin marketplace add slvDev/weasel",
              "/plugin install weasel@weasel"
            ],
            "signals": {
              "stars": 9,
              "forks": 0,
              "pushed_at": "2026-01-10T11:36:26Z",
              "created_at": "2025-11-08T07:43:13Z",
              "license": "MIT"
            },
            "commands": [],
            "skills": [
              {
                "name": "weasel-analyzer",
                "description": "Static analysis and security review for Solidity smart contracts. Triggers on weasel analyze, weasel audit, weasel scan, weasel review, or weasel check.",
                "path": "weasel/skills/weasel-analyzer/SKILL.md",
                "frontmatter": {
                  "name": "weasel-analyzer",
                  "description": "Static analysis and security review for Solidity smart contracts. Triggers on weasel analyze, weasel audit, weasel scan, weasel review, or weasel check."
                },
                "content": "# Weasel Analyzer\n\nExpert in running Weasel static analysis and performing manual security reviews with smart context management.\n\n## Analysis Modes\n\nDetect what mode user wants:\n\n### Quick Mode (Weasel Only)\n\n**Triggers:** \"run weasel\", \"quick scan\", \"static analysis\", \"automated check\"\n**Action:** Run weasel_analyze, report findings, done. No manual review.\n**Context cost:** Low (~500-2000 tokens)\n\n### Review Mode (Claude Only)\n\n**Triggers:** \"review this\", \"look at this code\", \"is this safe\", \"what do you think\", \"check this function\", \"what's wrong\", \"how secure\"\n**Action:** Read code directly, analyze with reasoning. NO weasel tools.\n**Context cost:** Medium (depends on code size)\n**Best for:** Business logic, specific functions, code understanding\n\n### Full Audit Mode (Combined) - DEFAULT for \"audit\"\n\n**Triggers:** \"audit\", \"full review\", \"thorough analysis\", \"find all vulnerabilities\"\n**Action:** Smart combination of Weasel + manual review (see below)\n**Context cost:** Higher but managed\n\n## Quick Scan Workflow\n\nUser wants: \"quick scan\", \"run weasel\", \"static analysis\"\n\n```\n1. Run weasel_analyze\n2. Show compact summary\n3. Done - no deep dive unless asked\n```\n\nOutput:\n```markdown\n## Quick Scan Results\n\n**Target:** ./src\n**Summary:** 2 High, 3 Medium, 15 Low, 8 Gas\n\n### High Severity\n- [H] reentrancy | Vault.sol:45\n- [H] delegatecall-in-loop | Proxy.sol:23\n\n### Medium Severity\n- [M] unchecked-transfer | Token.sol:89\n- [M] tx-origin | Auth.sol:12\n- [M] centralization-risk | Admin.sol:34\n\n*15 Low, 8 Gas findings omitted. Ask for details if needed.*\n```\n\n## Full Audit Workflow\n\nUser wants: \"audit\", \"full review\", \"thorough analysis\"\n\n**Step 1: Scan**\n```\nRun weasel_analyze → compact output\n```\n\n**Step 2: Triage**\n```\nHigh: 2 → Investigate ALL\nMedium: 3 → Investigate ALL\nLow: 15 → Skip (mention count)\nGas: 8 → Skip (mention count)\n```\n\n**Step 3: Deep Dive (High/Med Only)**\nFor each High/Medium:\n```\n1. weasel_finding_details(detector=\"reentrancy\")\n2. Read Vault.sol around line 45\n3. Verify: Is this a real issue?\n4. Document: Confirmed / False Positive\n```\n\n**Step 4: Manual Review (Critical!)**\nAfter Weasel, read contracts and look for things Weasel CANNOT detect:\n- Business logic issues\n- Economic vulnerabilities (flash loans, sandwich, oracle manipulation)\n- Complex access control\n- Cross-contract issues\n- State machine violations\n\n**Step 5: Report**\nCombine Weasel findings + manual findings into one report.\n\n## What Weasel Catches vs Claude Catches\n\n| Issue Type             | Weasel | Claude |\n|------------------------|--------|--------|\n| Reentrancy patterns    | Yes    | Yes    |\n| Unchecked returns      | Yes    | Yes    |\n| Common vulnerabilities | Yes    | Yes    |\n| Business logic bugs    | No     | Yes    |\n| Economic attacks       | No     | Yes    |\n| Complex access control | No     | Yes    |\n| Cross-contract issues  | No     | Yes    |\n| Oracle manipulation    | No     | Yes    |\n\n**Always do manual review for important audits!**\n\n## Response Labeling\n\nWhen reporting findings, be clear about source:\n\n- `[Weasel]` - Found by static analysis\n- `[Manual]` - Found by Claude's reasoning\n\nExamples:\n- \"[Weasel] Found reentrancy in withdraw()\"\n- \"[Manual] Potential flash loan attack vector in swap()\"\n\n## Output Format\n\n### For Quick Scan\n```markdown\n## Weasel Scan Results\n\n**Found:** 2 High, 3 Medium, 15 Low, 8 Gas\n\n### Critical (High)\n| Detector | Location | Brief |\n|----------|----------|-------|\n| reentrancy | Vault.sol:45 | External call before state update |\n\n### Important (Medium)\n| Detector | Location | Brief |\n|----------|----------|-------|\n| unchecked-transfer | Token.sol:89 | Return value ignored |\n\n---\n*20+ Low/Gas findings available. Use \"show low severity\" for details.*\n```\n\n### For Full Analysis\n```markdown\n## Security Analysis Report\n\n### Automated Scan (Weasel)\n**Summary:** 2 High, 3 Medium confirmed\n\n#### [H-01] Reentrancy in withdraw() - CONFIRMED\n**Location:** Vault.sol:45\n**Issue:** External call before balance update\n**Impact:** Fund theft possible\n**Fix:** Move state update before call\n\n#### [M-01] Unchecked Transfer - CONFIRMED\n...\n\n### Manual Review (Claude)\nIssues Weasel cannot detect:\n\n#### [H-02] Flash Loan Attack Vector\n**Location:** Swap.sol:120-150\n**Issue:** Price can be manipulated within single transaction\n...\n\n### Summary\n| Source | High | Medium | Low |\n|--------|------|--------|-----|\n| Weasel | 2 | 3 | 15 |\n| Manual | 1 | 2 | 0 |\n| **Total** | **3** | **5** | **15** |\n```\n\n## When NOT to Use Weasel\n\nIf user says:\n- \"review this function\" → Just read the function (Review Mode)\n- \"is this safe\" → Read and reason (Review Mode)\n- \"what does this do\" → Explain without scanning (→ weasel-explainer)\n\nThese don't need static analysis - just Claude's reasoning.\n\n## Context Management Rules\n\n### DO\n- Load weasel_analyze summary (compact, ~500 tokens)\n- Load details ONLY for High/Medium findings\n- Read source files as needed for verification\n- Skip Low/Gas/NC unless user specifically asks\n\n### DON'T\n- Auto-load all finding details at once\n- Dump entire weasel output with all locations\n- Load code you won't analyze\n- Request details for 50+ Low severity findings\n- Run weasel_analyze when user just wants code review\n\n## Context Budget Guide\n\n| Action | Tokens | When to Use |\n|--------|--------|-------------|\n| weasel_analyze | ~500-2000 | Always OK |\n| weasel_finding_details (per call) | ~500-1500 | High/Med only |\n| Read source file | ~1000-5000 | When verifying |\n\n**Total budget for audit:** Try to stay under 20k tokens for Weasel-related context, leaving room for code reading and manual review.\n\n## Available MCP Tools\n\n1. **weasel_analyze** - Run static analysis (COMPACT output)\n   - `path`: Directory or file (optional, defaults to current)\n   - `severity`: Filter - \"High\", \"Medium\", \"Low\", \"Gas\", \"NC\"\n   - `exclude`: Paths to exclude\n\n2. **weasel_finding_details** - Get FULL details for ONE detector\n   - Use sparingly! Each call adds context\n   - `detector`: Detector ID (e.g., \"reentrancy\")\n   - `path`: Path analyzed (for cached results)\n\n3. **weasel_detectors** - List available detectors\n   - Use if user asks what Weasel can detect\n   - `severity`: Optional filter"
              },
              {
                "name": "weasel-explainer",
                "description": "Code explanation and understanding for Solidity smart contracts. Triggers on weasel explain, weasel what does, or weasel walkthrough.",
                "path": "weasel/skills/weasel-explainer/SKILL.md",
                "frontmatter": {
                  "name": "weasel-explainer",
                  "description": "Code explanation and understanding for Solidity smart contracts. Triggers on weasel explain, weasel what does, or weasel walkthrough."
                },
                "content": "# Weasel Explainer\n\nExpert in explaining Solidity code, identifying patterns, and highlighting risks.\n\n**Note:** This skill explains code. For security analysis, use weasel-analyzer.\n\n## When to Activate\n\n- User wants to understand code\n- User asks what something does\n- User wants a walkthrough\n\n## Process\n\n1. **Read** - Get the code and surrounding context\n2. **Explain** - Overview → Step-by-step → Patterns → Risks\n3. **Offer** - \"Want me to explain more?\" or \"Check for vulnerabilities?\"\n\n## Adapt to Audience\n\nInfer from how user asks, or ask if unclear:\n- \"what is a modifier?\" → **Beginner** (use analogies, define jargon)\n- \"walk me through this\" → **Experienced** (patterns, trade-offs, edge cases)\n- \"what are the trust assumptions?\" → **Auditor** (attack surface, state changes)\n\nDefault to experienced if unclear.\n\n## Output Structure\n\n```\n## [Contract/Function Name]\n\n**Overview:** One paragraph - what does this do?\n\n**Breakdown:**\n- Lines X-Y: [what this section does]\n- Line Z: [what this does]\n\n**Patterns:** CEI, Pull-over-push, etc.\n\n**Risks:** (if any spotted during explanation)\n```\n\n## Always Note\n\nWhile explaining, flag:\n- External calls (who? trusted? failure handling?)\n- State changes (order? consistency?)\n- Access control (who can call? bypasses?)\n- Value flow (where does ETH/tokens go?)"
              },
              {
                "name": "weasel-filter",
                "description": "False positive filtering for Weasel static analysis results. Triggers on weasel filter, weasel triage, or weasel clean report.",
                "path": "weasel/skills/weasel-filter/SKILL.md",
                "frontmatter": {
                  "name": "weasel-filter",
                  "description": "False positive filtering for Weasel static analysis results. Triggers on weasel filter, weasel triage, or weasel clean report."
                },
                "content": "# Weasel Filter\n\nExpert in filtering false positives from Weasel static analysis output.\n\n**Context:** This skill filters WEASEL's output. For validating your own attack ideas, see weasel-validate.\n\n## When to Activate\n\n- After running Weasel analysis\n- User wants to filter false positives\n- User asks to triage/clean the report\n- User asks \"are these findings real?\"\n\n## Filtering Strategy\n\n### Priority Triage\n\n```\n┌─────────────────────────────────────────┐\n│  HIGH SEVERITY (typically 0-5 issues)   │\n│  → Verify ALL - these are critical      │\n├─────────────────────────────────────────┤\n│  MEDIUM SEVERITY (typically 2-10)       │\n│  → Verify ALL - these matter            │\n├─────────────────────────────────────────┤\n│  LOW SEVERITY (can be many)             │\n│  → Sample check if >10 issues           │\n│  → Check all if ≤10 issues              │\n├─────────────────────────────────────────┤\n│  GAS / NC                               │\n│  → Skip verification (not security)     │\n└─────────────────────────────────────────┘\n```\n\n## Two Workflows\n\n### Workflow A: Filter In-Memory (No Report File)\n\nWhen user just ran `weasel_analyze` via MCP:\n\n1. Get findings from weasel_analyze output\n2. For each High/Medium:\n   - Read source code at location\n   - Verify: true positive or false positive?\n3. Report confirmed findings only\n\n### Workflow B: Clean Existing Report File (Context-Efficient)\n\nWhen report file already exists (user ran weasel with output flag):\n\n1. **Don't read the full report** - it's too large\n2. Get summary via `weasel_analyze` MCP (small)\n3. For each High/Medium finding:\n   - Read SOURCE CODE (not the report)\n   - Determine: true or false positive?\n4. For false positives:\n   - Use Edit tool to DELETE that section from report.md\n   - Find section header (e.g., `## [H-01] Reentrancy...`)\n   - Delete entire section until next `## [` or end\n\n**Why Workflow B is efficient:**\n- Full report stays on disk (never in context)\n- Only load: summary (~2KB) + source code\n- Edit file directly instead of regenerating\n\n## Verification Process\n\nFor each finding to verify:\n\n1. **Read the code** - Use Read tool at the reported location\n2. **Understand context** - Check surrounding functions, modifiers\n3. **Check for guards** - Look for existing protections\n4. **Assess exploitability** - Can this actually be exploited?\n5. **Verdict** - Confirmed or False Positive\n\n## Verification Checklists\n\n### Reentrancy\n- [ ] Is there an external call?\n- [ ] Is state modified AFTER the call?\n- [ ] Is there a reentrancy guard?\n- [ ] Can the called contract be malicious?\n\n### Access Control\n- [ ] Is the function actually privileged?\n- [ ] Are there modifier checks?\n- [ ] Is the caller validated elsewhere?\n\n### Unchecked Returns\n- [ ] Is the return value actually important?\n- [ ] Is there error handling elsewhere?\n- [ ] Using SafeERC20 or similar?\n\n### Integer Issues\n- [ ] Is unchecked{} block used?\n- [ ] Is the value user-controlled?\n- [ ] Can overflow/underflow cause harm?\n\n## Common False Positive Patterns\n\n### Reentrancy\n- Read-only reentrancy (view functions)\n- Trusted contract calls (own contracts)\n- Already protected by mutex/nonReentrant\n\n### Unchecked Transfer\n- Intentional fire-and-forget\n- Using SafeERC20\n- Return value checked elsewhere\n\n### Access Control\n- Internal/private functions (not callable)\n- Checked in parent function\n- Initializer functions (one-time)\n\n## Output Format\n\nKeep output minimal - one line per finding:\n\n```\nFiltered 5 findings → 2 confirmed, 3 false positives\n\n✓ [H-01] Reentrancy in withdraw() - confirmed\n✓ [M-03] Access control missing - confirmed\n✗ [H-02] Reentrancy in deposit() - has nonReentrant\n✗ [M-01] Unchecked return - uses SafeERC20\n✗ [M-02] Integer overflow - in unchecked{} intentionally\n\nRemoved 3 sections from report.md\n```\n\n**No verbose evidence blocks** - user can ask for details on specific findings if needed.\n\n## After Filtering\n\nAsk user:\n- \"Found X confirmed issues. Want me to write reports for them?\"\n- \"Want me to add PoCs for High severity findings?\"\n- \"Should I explain any of these in more detail?\""
              },
              {
                "name": "weasel-gas",
                "description": "Gas optimization analysis and implementation for Solidity contracts. Triggers on weasel gas, weasel optimize, or weasel efficiency.",
                "path": "weasel/skills/weasel-gas/SKILL.md",
                "frontmatter": {
                  "name": "weasel-gas",
                  "description": "Gas optimization analysis and implementation for Solidity contracts. Triggers on weasel gas, weasel optimize, or weasel efficiency."
                },
                "content": "# Weasel Gas Optimizer\n\nExpert in identifying and implementing gas optimizations for Solidity smart contracts.\n\n## When to Activate\n\n- User wants to optimize gas usage\n- User asks about efficiency\n- User mentions gas costs\n\n## Workflow\n\n1. **Scan** - Run `weasel_analyze` with severity: \"Gas\"\n2. **Summarize** - Quick count by impact level\n3. **Ask** - \"Fix high impact? Medium? All? Pick specific?\"\n4. **Fix** - Implement directly in code\n5. **Verify** - Run tests\n\n## Impact Ranking\n\n**High Impact** - Fix first:\n- Storage caching (repeated SLOAD)\n- Struct packing\n- Unchecked math in loops\n- Calldata vs memory for read-only\n\n**Medium Impact:**\n- Array length caching\n- Prefix increment\n- Short-circuit reordering\n\n**Low Impact** - Usually skip:\n- Minor syntax tweaks\n- Marginal improvements\n\n## Output\n\nKeep it minimal:\n\n```\nGas analysis: 12 findings\n\nHigh (3):   storage caching (2), struct packing (1)\nMedium (5): array length (3), calldata (2)\nLow (4):    minor tweaks\n\nFix high impact issues? [yes/specific/skip]\n```\n\n## Fixing\n\nWhen user confirms:\n1. Fix one file at a time\n2. Run tests after each fix\n3. If tests fail, revert and explain why\n\n## Caveats\n\nMention when relevant:\n- Readability trade-offs for marginal gains\n- Some \"optimizations\" hurt readability for <100 gas\n- Always test after changes"
              },
              {
                "name": "weasel-overview",
                "description": "Project overview and audit preparation for smart contract security. Triggers on weasel overview, weasel scope, or weasel onboard.",
                "path": "weasel/skills/weasel-overview/SKILL.md",
                "frontmatter": {
                  "name": "weasel-overview",
                  "description": "Project overview and audit preparation for smart contract security. Triggers on weasel overview, weasel scope, or weasel onboard."
                },
                "content": "# Weasel Overview\n\nProject overview and audit scoping for security engineers starting a new audit.\n\n## When to Activate\n\n- Starting a new audit\n- User asks \"what does this project do?\"\n- User wants to scope/understand a codebase\n\n## Process\n\n### 1. Read Documentation\n- README.md - project description, architecture\n- docs/ folder if exists\n- Comments in main contracts\n\n### 2. Map Project Structure\n- List all .sol files\n- Identify: core contracts vs libraries vs interfaces\n- Map inheritance hierarchy\n- Note external dependencies (OpenZeppelin, Chainlink, etc.)\n\n### 3. Identify Entry Points\n\n**User Functions** (highest risk - untrusted input):\n- deposit(), withdraw(), swap(), transfer()...\n- Any external/public that handles value\n\n**Admin Functions** (check access control):\n- setFee(), pause(), upgrade()...\n- Note: what permissions? onlyOwner? Multisig?\n\n**Callbacks** (reentrancy risk):\n- onFlashLoan(), uniswapV3Callback()...\n- Any function called by external contracts\n\n### 4. Trace Value Flow\n- **Inbound:** How does ETH/tokens enter? (deposit, swap, mint)\n- **Outbound:** How does ETH/tokens exit? (withdraw, claim, burn)\n- **Internal:** How does value move between contracts?\n\n### 5. Map Trust Boundaries\n\n**Untrusted** - assume malicious:\n- Users, external contracts, oracles\n\n**Privileged** - trusted but verify:\n- Owner/Admin, Governance, Keepers\n\n**Internal** - trusted:\n- Protocol's own contracts, libraries\n\n### 6. Identify Focus Areas\n\n| Project Type | High-Risk Areas |\n|--------------|-----------------|\n| DeFi/Lending | Liquidation, interest calc, oracles, flash loans |\n| DEX/AMM | Price calc, slippage, LP math, fees |\n| Staking/Vaults | Deposit/withdraw, rewards, share accounting |\n| NFT/Gaming | Minting, randomness, marketplace |\n| Governance | Voting, timelock, proposal execution |\n\n## Output Structure\n\n```markdown\n# [Project Name] Overview\n\n## Summary\n[2-3 sentences: what does this project do?]\n\n## Architecture\n- Contract list with purpose\n- Key inheritance (ERC4626, Ownable, etc.)\n- External dependencies\n\n## Entry Points\n\n### User Functions (Priority: High)\n| Function | Contract | Risk |\n|----------|----------|------|\n| deposit() | Vault.sol:45 | Handles ETH |\n| withdraw() | Vault.sol:89 | Sends ETH |\n\n### Admin Functions (Check Access Control)\n| Function | Contract | Permission |\n|----------|----------|------------|\n| setFee() | Vault.sol:120 | onlyOwner |\n\n### Callbacks (Reentrancy Risk)\n- onFlashLoan() called by flash lender\n\n## Value Flow\n- **In:** ETH via deposit(), tokens via depositToken()\n- **Out:** ETH via withdraw(), rewards via claim()\n\n## Trust Model\n- **Owner:** Can pause, set fees (max X%)\n- **External:** Chainlink oracle (single price feed)\n\n## Audit Focus (Prioritized)\n1. [High] Reentrancy in withdraw() - external call before state update\n2. [High] Oracle manipulation - single feed, no TWAP\n3. [Med] Share inflation - first depositor attack?\n\n## Recommended Audit Order\n1. Vault.sol - core logic, highest risk\n2. Router.sol - entry point, input validation\n3. Token.sol - standard ERC20, lower priority\n```\n\n## After Overview\n\nOffer:\n- \"Run Weasel static analysis?\"\n- \"Deep dive into [highest risk contract]?\"\n- \"Explain specific function?\""
              },
              {
                "name": "weasel-poc",
                "description": "Proof of Concept exploit writing for Solidity vulnerabilities. Triggers on weasel poc, weasel prove, weasel exploit, or weasel demonstrate.",
                "path": "weasel/skills/weasel-poc/SKILL.md",
                "frontmatter": {
                  "name": "weasel-poc",
                  "description": "Proof of Concept exploit writing for Solidity vulnerabilities. Triggers on weasel poc, weasel prove, weasel exploit, or weasel demonstrate."
                },
                "content": "# Weasel PoC Writer\n\nExpert in creating proof-of-concept exploits for smart contract vulnerabilities.\n\n## When to Activate\n\n- User wants to prove a vulnerability exists\n- User asks for a PoC or exploit\n- User wants to demonstrate an attack\n\n## Process\n\n1. **Understand** - What's the bug? What's the attack outcome?\n2. **Find existing tests** - Look in `test/` for existing setup\n3. **Write PoC** - Add to existing test file OR create new if none exists\n4. **Run** - Execute and show result\n\n**Do NOT** run Weasel analysis - user already found the bug!\n\n## Critical Rules\n\n### File Placement\n- **Prefer existing test file** - Use dev's setup, add your test function\n- **New file only if** no corresponding test exists\n- Match project conventions (naming, directory)\n\n### Use Real Contracts\n- **NEVER** mock or simulate the vulnerable contract\n- **ALWAYS** use the actual contract with real deployment\n- Use project's existing deployment/fixture setup\n\n### Code Style\n- **Numbered steps** with comments explaining logic (not every line)\n- **No spam logs** - avoid excessive banners or celebration messages\n- Console logs should be dev-focused (balances, state changes)\n- The report tells the story, the PoC just proves it\n\n## PoC Structure\n\n```solidity\nfunction test_VulnerabilityName_PoC() public {\n    // 1. Setup attacker position\n    // ... setup code ...\n\n    // 2. Execute attack\n    // ... attack code ...\n\n    // 3. Verify impact\n    assertGt(attacker.balance, initialBalance);\n}\n```\n\n**Key elements:**\n- Descriptive test name: `test_Reentrancy_Withdraw_PoC`\n- Clear step comments (1, 2, 3...)\n- Assertions prove the impact\n\n## Framework Detection\n\n**Foundry:** Look for foundry.toml, then run forge test with match-test flag\n**Hardhat:** Look for hardhat.config.js/ts, then run npx hardhat test\n\n## Output\n\nKeep it minimal:\n\n```\nPoC written: test/Vault.t.sol::test_Reentrancy_PoC\n\nRun: forge test --match-test test_Reentrancy_PoC -vvvv\n```\n\nAfter running, report: **Confirmed** or **Could not reproduce** (with reason)."
              },
              {
                "name": "weasel-report",
                "description": "Audit report writing for smart contract vulnerabilities. Triggers on weasel report, weasel write up, or weasel document.",
                "path": "weasel/skills/weasel-report/SKILL.md",
                "frontmatter": {
                  "name": "weasel-report",
                  "description": "Audit report writing for smart contract vulnerabilities. Triggers on weasel report, weasel write up, or weasel document."
                },
                "content": "# Weasel Report Writer\n\nExpert in formatting security findings as professional audit reports.\n\n## When to Activate\n\n- User wants to document a vulnerability\n- User asks to write up a finding\n- User wants to format for submission\n\n## Process\n\n1. **Gather info** - What's the vuln? Which contract/function? Severity?\n2. **Read code** - Get exact lines and context\n3. **Format report** - Use template below\n4. **PoC decision** - Auto-include if High severity or already written\n\n**Do NOT** run Weasel analysis - user already found the bug!\n\n## Report Template\n\n```markdown\n## [SEVERITY-XX] Title That Describes The Impact\n\n### Summary\nOne sentence: what's broken and what's the impact.\n\n### Vulnerability Detail\n- What the vulnerability is\n- How it occurs\n- Why it's a problem\n\n### Impact\nWhat an attacker can achieve (fund loss, DoS, corruption).\n\n### Code Snippet\n\n`path/to/file.sol#L123-L130`\n\n\\`\\`\\`solidity\nfunction withdraw(uint256 amount) external {\n    (bool success, ) = msg.sender.call{value: amount}(\"\"); // @audit reentrancy\n    balances[msg.sender] -= amount;\n}\n\\`\\`\\`\n\n### Recommendation\n\n\\`\\`\\`solidity\nfunction withdraw(uint256 amount) external nonReentrant {\n    balances[msg.sender] -= amount;\n    (bool success, ) = msg.sender.call{value: amount}(\"\");\n}\n\\`\\`\\`\n\n### PoC (omit if none)\nSee: test/Contract.t.sol::test_VulnName_PoC\n```\n\n## Title Conventions\n\n**Good:** Specific, describes impact\n- \"Reentrancy in `withdraw()` allows draining of user funds\"\n- \"Missing access control on `setFee()` allows anyone to set 100% fee\"\n\n**Bad:** Vague\n- \"Reentrancy vulnerability\"\n- \"Access control issue\"\n\n## Multiple Findings\n\nNumber by severity: H-01, H-02, M-01, M-02, etc.\nOrder: severity first, then by location."
              },
              {
                "name": "weasel-simplify",
                "description": "Solidity code simplification and refactoring for clarity and maintainability. Triggers on weasel simplify, weasel refactor, or weasel clean up.",
                "path": "weasel/skills/weasel-simplify/SKILL.md",
                "frontmatter": {
                  "name": "weasel-simplify",
                  "description": "Solidity code simplification and refactoring for clarity and maintainability. Triggers on weasel simplify, weasel refactor, or weasel clean up."
                },
                "content": "# Weasel Simplify\n\nExpert Solidity code simplification specialist focused on enhancing code clarity, consistency, and maintainability while preserving exact functionality.\n\n## When to Activate\n\n- Developer wants to clean up code\n- User asks to simplify or refactor\n- User wants to improve readability\n- After writing new code that could be cleaner\n\n## Core Principles\n\n### 1. Preserve Functionality\nNever change what the code does - only how it's written. All features, outputs, and behaviors must remain identical.\n\n### 2. Security First\nNever simplify in a way that introduces vulnerabilities:\n- Don't remove reentrancy guards for \"simplicity\"\n- Don't combine checks in ways that could be bypassed\n- Don't remove access control for fewer lines\n- Don't reorder CEI pattern\n\n### 3. Clarity Over Brevity\nReadable code > compact code:\n- Avoid nested ternaries\n- Use meaningful variable names\n- Keep functions focused\n\n### 4. Gas Aware\nDon't \"simplify\" into more expensive code. Preserve:\n- Storage caching patterns\n- Unchecked blocks where safe\n- Calldata over memory for read-only params\n\n## Workflow\n\n1. **Scope** - What to simplify? (specific function, file, or recent changes)\n2. **Analyze** - Find complexity without touching security patterns\n3. **Simplify** - Apply transformations\n4. **Test** - Run tests to verify behavior preserved\n5. **Report** - Summarize changes made\n\n## Key Simplification Patterns\n\n### Pattern 1: Flatten Nesting → Early Returns\n\n```solidity\n// Before: Deep nesting hides logic\nfunction withdraw(uint256 amount) external {\n    if (amount > 0) {\n        if (balances[msg.sender] >= amount) {\n            if (!paused) {\n                balances[msg.sender] -= amount;\n                payable(msg.sender).transfer(amount);\n            }\n        }\n    }\n}\n\n// After: Guards at top, happy path clear\nfunction withdraw(uint256 amount) external {\n    if (amount == 0) revert ZeroAmount();\n    if (balances[msg.sender] < amount) revert InsufficientBalance();\n    if (paused) revert ContractPaused();\n\n    balances[msg.sender] -= amount;\n    payable(msg.sender).transfer(amount);\n}\n```\n\n### Pattern 2: Extract Repeated Logic → Modifiers\n\n```solidity\n// Before: Same checks in multiple functions\nfunction deposit() external payable {\n    require(msg.value > 0, \"Zero\");\n    require(!paused, \"Paused\");\n    // ...\n}\nfunction withdraw(uint256 amt) external {\n    require(amt > 0, \"Zero\");\n    require(!paused, \"Paused\");\n    // ...\n}\n\n// After: DRY with modifiers\nmodifier whenNotPaused() {\n    if (paused) revert ContractPaused();\n    _;\n}\nmodifier nonZero(uint256 value) {\n    if (value == 0) revert ZeroValue();\n    _;\n}\n\nfunction deposit() external payable whenNotPaused nonZero(msg.value) { ... }\nfunction withdraw(uint256 amt) external whenNotPaused nonZero(amt) { ... }\n```\n\n### Pattern 3: Name Complex Conditions\n\n```solidity\n// Before: Hard to read\nif (amount > 0 && amount <= max && !blocked[msg.sender] && block.timestamp >= start) { ... }\n\n// After: Self-documenting\nbool isValidAmount = amount > 0 && amount <= max;\nbool isAllowedUser = !blocked[msg.sender];\nbool hasStarted = block.timestamp >= start;\n\nif (isValidAmount && isAllowedUser && hasStarted) { ... }\n```\n\n### Other Opportunities\n- Remove dead/commented code\n- Replace require strings with custom errors (gas savings)\n- Decompose long functions\n- Improve variable/function names\n- Remove redundant initializations (`uint256 x = 0` → `uint256 x`)\n\n## What NOT to Simplify\n\n**Security patterns - preserve even if \"verbose\":**\n\n```solidity\n// KEEP: Reentrancy guard\nfunction withdraw() external nonReentrant { ... }\n\n// KEEP: CEI order (Checks-Effects-Interactions)\nuint256 amount = balances[msg.sender];\nbalances[msg.sender] = 0;           // Effect BEFORE\n(bool ok,) = msg.sender.call{value: amount}(\"\");  // Interaction\nrequire(ok);\n\n// KEEP: Explicit type casts\nuint128 small = uint128(bigNumber);  // Don't hide conversions\n\n// KEEP: Unchecked blocks\nunchecked { ++i; }  // Don't \"simplify\" to i++\n```\n\n## Output\n\nAfter simplifying, report concisely:\n\n```\nSimplified: Vault.sol\n\nChanges:\n- withdraw(): 3 nested ifs → early reverts\n- Created modifier: whenNotPaused (applied to 4 functions)\n- Replaced 8 require strings with custom errors\n- Removed 12 lines dead code\n\nPreserved: nonReentrant, CEI pattern, onlyOwner checks\n\nNext: Run tests → forge test\n```\n\n## After Simplification\n\n- **Always run tests** to verify functionality preserved\n- Offer to simplify related contracts\n- Offer gas comparison if changes were significant"
              },
              {
                "name": "weasel-validate",
                "description": "Attack hypothesis validation for smart contracts. Triggers on weasel validate, weasel check attack, or weasel verify.",
                "path": "weasel/skills/weasel-validate/SKILL.md",
                "frontmatter": {
                  "name": "weasel-validate",
                  "description": "Attack hypothesis validation for smart contracts. Triggers on weasel validate, weasel check attack, or weasel verify."
                },
                "content": "# Weasel Validate\n\nExpert in validating user's proposed attack vectors and vulnerability hypotheses.\n\n**Context:** This skill validates USER's ideas. For filtering Weasel output, see weasel-filter.\n\n## When to Activate\n\n- User proposes an attack and wants validation\n- User asks \"is this exploitable?\"\n- User wants to verify their vulnerability hypothesis\n- User found something and wants confirmation\n\n## Validation Process\n\nUser proposes an attack vector:\n```\nUser: \"I think there's reentrancy here because balance updates after\n       the call. Is this actually exploitable?\"\n```\n\n### Step 1: Understand Hypothesis\n\nExtract from user's description:\n- What vulnerability type? (reentrancy, access control, etc.)\n- Which contract/function?\n- What's the proposed attack flow?\n- What impact does user expect?\n\n### Step 2: Read the Code\n\n- Read the referenced function\n- Read surrounding context (modifiers, inherited contracts)\n- Check related functions that might affect the attack\n\n### Step 3: Trace Attack Path\n\nWalk through the proposed attack step-by-step:\n1. How does attacker enter?\n2. What state changes occur?\n3. Where is the vulnerability triggered?\n4. What's the outcome?\n\n### Step 4: Check Preconditions\n\n- Can attacker reach this code path?\n- Are required states achievable?\n- What permissions are needed?\n- Are there timing constraints?\n\n### Step 5: Check Guards\n\nLook for protections user might have missed:\n- Reentrancy guards\n- Access control modifiers\n- Input validation\n- State checks\n\n### Step 6: Verdict\n\n- **CONFIRMED** - Attack works as described\n- **PARTIAL** - Attack works but with limitations\n- **NOT EXPLOITABLE** - Protected or unreachable\n\n## Output Format\n\n```markdown\n## Attack Validation\n\n**Hypothesis:** [User's proposed attack]\n**Target:** Contract.function()\n\n### Analysis\n\n[Step-by-step trace of the attack path]\n\n**Preconditions checked:**\n- [x] Attacker can call function\n- [x] Required state is achievable\n- [ ] No reentrancy guard present\n\n### Verdict: [CONFIRMED/PARTIAL/NOT EXPLOITABLE]\n\n**Reason:** [Why it works or doesn't]\n**Evidence:** [Code references with line numbers]\n\n### Next Steps (if confirmed)\n- Severity: [High/Medium/Low]\n- Want me to write a PoC?\n- Want me to format as report?\n```\n\n## Common Attack Patterns to Check\n\n### Reentrancy\n- External call before state update?\n- No reentrancy guard?\n- Callback possible?\n\n### Access Control\n- Missing modifier?\n- Bypassable check?\n- Privilege escalation?\n\n### Flash Loan Attacks\n- Price manipulation possible?\n- Single-transaction exploit?\n- Oracle dependency?\n\n### Front-running\n- Transaction ordering matters?\n- MEV extractable?\n- Commit-reveal missing?\n\n## After Validation\n\nIf CONFIRMED:\n- Offer to write PoC (→ weasel-poc)\n- Offer to format as report (→ weasel-report)\n- Suggest severity level\n\nIf NOT EXPLOITABLE:\n- Explain why it's protected\n- Point to the guard/protection\n- Suggest what would make it exploitable"
              }
            ]
          }
        ]
      }
    }
  ]
}