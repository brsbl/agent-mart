{
  "owner": {
    "id": "cruzanstx",
    "display_name": "cruzanstx",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/2927083?v=4",
    "url": "https://github.com/cruzanstx",
    "bio": null,
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 6,
      "total_stars": 3,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "cruzanstx/daplug",
      "url": "https://github.com/cruzanstx/daplug",
      "description": null,
      "homepage": null,
      "signals": {
        "stars": 3,
        "forks": 0,
        "pushed_at": "2026-01-12T18:23:12Z",
        "created_at": "2026-01-05T17:15:54Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 439
        },
        {
          "path": ".claude-plugin/plugin.json",
          "type": "blob",
          "size": 391
        },
        {
          "path": ".gitignore",
          "type": "blob",
          "size": 232
        },
        {
          "path": "CLAUDE.md",
          "type": "blob",
          "size": 7623
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 24903
        },
        {
          "path": "agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "agents/frontend-build-optimizer.md",
          "type": "blob",
          "size": 8038
        },
        {
          "path": "agents/go-build-optimizer.md",
          "type": "blob",
          "size": 4147
        },
        {
          "path": "agents/infra-troubleshooter.md",
          "type": "blob",
          "size": 8806
        },
        {
          "path": "agents/k8s-cicd-troubleshooter.md",
          "type": "blob",
          "size": 10675
        },
        {
          "path": "agents/readonly-log-watcher.md",
          "type": "blob",
          "size": 2012
        },
        {
          "path": "commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "commands/cclimits.md",
          "type": "blob",
          "size": 1195
        },
        {
          "path": "commands/check-config.md",
          "type": "blob",
          "size": 911
        },
        {
          "path": "commands/check-updates.md",
          "type": "blob",
          "size": 1105
        },
        {
          "path": "commands/codex-cli.md",
          "type": "blob",
          "size": 4734
        },
        {
          "path": "commands/create-llms-txt.md",
          "type": "blob",
          "size": 22745
        },
        {
          "path": "commands/create-prompt.md",
          "type": "blob",
          "size": 34952
        },
        {
          "path": "commands/devstral-cli.md",
          "type": "blob",
          "size": 6089
        },
        {
          "path": "commands/gemini-cli.md",
          "type": "blob",
          "size": 6537
        },
        {
          "path": "commands/migrate-config.md",
          "type": "blob",
          "size": 1756
        },
        {
          "path": "commands/prompts.md",
          "type": "blob",
          "size": 17425
        },
        {
          "path": "commands/qwen-cli.md",
          "type": "blob",
          "size": 6009
        },
        {
          "path": "commands/run-prompt.md",
          "type": "blob",
          "size": 16030
        },
        {
          "path": "commands/uvc.md",
          "type": "blob",
          "size": 4663
        },
        {
          "path": "commands/zai-cli.md",
          "type": "blob",
          "size": 5972
        },
        {
          "path": "demos",
          "type": "tree",
          "size": null
        },
        {
          "path": "demos/create-and-run-prompt.gif",
          "type": "blob",
          "size": 287029
        },
        {
          "path": "demos/create-and-run-prompt.tape",
          "type": "blob",
          "size": 570
        },
        {
          "path": "demos/demo-shell.py",
          "type": "blob",
          "size": 10782
        },
        {
          "path": "demos/llms-txt-creation.gif",
          "type": "blob",
          "size": 77084
        },
        {
          "path": "demos/llms-txt-creation.tape",
          "type": "blob",
          "size": 367
        },
        {
          "path": "demos/multi-model-delegation.gif",
          "type": "blob",
          "size": 236018
        },
        {
          "path": "demos/multi-model-delegation.tape",
          "type": "blob",
          "size": 714
        },
        {
          "path": "demos/quota-awareness.gif",
          "type": "blob",
          "size": 128377
        },
        {
          "path": "demos/quota-awareness.tape",
          "type": "blob",
          "size": 355
        },
        {
          "path": "demos/verification-loop.gif",
          "type": "blob",
          "size": 92122
        },
        {
          "path": "demos/verification-loop.tape",
          "type": "blob",
          "size": 401
        },
        {
          "path": "demos/worktree-isolation.gif",
          "type": "blob",
          "size": 104121
        },
        {
          "path": "demos/worktree-isolation.tape",
          "type": "blob",
          "size": 384
        },
        {
          "path": "hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "hooks/example-hook.json",
          "type": "blob",
          "size": 154
        },
        {
          "path": "mcp",
          "type": "tree",
          "size": null
        },
        {
          "path": "mcp/servers.json",
          "type": "blob",
          "size": 175
        },
        {
          "path": "prompts",
          "type": "tree",
          "size": null
        },
        {
          "path": "prompts/completed",
          "type": "tree",
          "size": null
        },
        {
          "path": "prompts/completed/001-daplug-config-xml-migration.md",
          "type": "blob",
          "size": 5864
        },
        {
          "path": "prompts/completed/001-prompt-subfolder-support.md",
          "type": "blob",
          "size": 6429
        },
        {
          "path": "prompts/completed/002-readme-showcase-demos.md",
          "type": "blob",
          "size": 5455
        },
        {
          "path": "prompts/completed/003-add-gpt52-model-support.md",
          "type": "blob",
          "size": 3936
        },
        {
          "path": "scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "scripts/manage-models.py",
          "type": "blob",
          "size": 10389
        },
        {
          "path": "skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/ai-usage",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/ai-usage/SKILL.md",
          "type": "blob",
          "size": 4617
        },
        {
          "path": "skills/config-reader",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/config-reader/SKILL.md",
          "type": "blob",
          "size": 2177
        },
        {
          "path": "skills/config-reader/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/config-reader/scripts/config.py",
          "type": "blob",
          "size": 18196
        },
        {
          "path": "skills/config-reader/tests",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/config-reader/tests/test_config_reader.py",
          "type": "blob",
          "size": 2503
        },
        {
          "path": "skills/prompt-executor",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/prompt-executor/SKILL.md",
          "type": "blob",
          "size": 8702
        },
        {
          "path": "skills/prompt-executor/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/prompt-executor/scripts/executor.py",
          "type": "blob",
          "size": 58154
        },
        {
          "path": "skills/prompt-finder",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/prompt-finder/SKILL.md",
          "type": "blob",
          "size": 4493
        },
        {
          "path": "skills/prompt-manager",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/prompt-manager/SKILL.md",
          "type": "blob",
          "size": 4870
        },
        {
          "path": "skills/prompt-manager/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/prompt-manager/scripts/manager.py",
          "type": "blob",
          "size": 27861
        },
        {
          "path": "skills/tmux-manager",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/tmux-manager/SKILL.md",
          "type": "blob",
          "size": 5558
        },
        {
          "path": "skills/worktree",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/worktree/SKILL.md",
          "type": "blob",
          "size": 10413
        }
      ],
      "marketplace": {
        "name": "cruzanstx",
        "version": null,
        "description": null,
        "owner_info": {
          "name": "CruzanSTX",
          "url": "https://github.com/cruzanstx"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "daplug",
            "description": null,
            "source": "./",
            "category": "development",
            "version": null,
            "author": null,
            "install_commands": [
              "/plugin marketplace add cruzanstx/daplug",
              "/plugin install daplug@cruzanstx"
            ],
            "signals": {
              "stars": 3,
              "forks": 0,
              "pushed_at": "2026-01-12T18:23:12Z",
              "created_at": "2026-01-05T17:15:54Z",
              "license": null
            },
            "commands": [],
            "skills": [
              {
                "name": "ai-usage",
                "description": "Check AI CLI usage/quota for Claude Code, OpenAI Codex, Google Gemini CLI, and Z.AI. Use when user asks about remaining quota, usage limits, rate limits, or wants to check how much capacity is left.",
                "path": "skills/ai-usage/SKILL.md",
                "frontmatter": {
                  "name": "ai-usage",
                  "description": "Check AI CLI usage/quota for Claude Code, OpenAI Codex, Google Gemini CLI, and Z.AI. Use when user asks about remaining quota, usage limits, rate limits, or wants to check how much capacity is left.",
                  "allowed-tools": [
                    "Bash(npx cclimits:*)",
                    "Bash(cclimits:*)"
                  ]
                },
                "content": "# AI CLI Usage Checker\n\nCheck remaining quota and usage for AI coding assistants: Claude Code, OpenAI Codex, Gemini CLI, and Z.AI.\n\nUses the [cclimits](https://www.npmjs.com/package/cclimits) npm package.\n\n## When to Use This Skill\n\n- User asks \"how much quota do I have left?\"\n- User asks \"check my usage\" or \"am I rate limited?\"\n- User wants to know which AI tool has capacity\n- Before starting a large task, to verify quota availability\n- User asks about token limits or remaining requests\n\n## Running the Command\n\n```bash\n# Check all tools (detailed)\nnpx cclimits\n\n# Compact one-liner (5h window)\nnpx cclimits --oneline\n\n# Compact one-liner (7d window)\nnpx cclimits --oneline 7d\n\n# Check specific tools\nnpx cclimits --claude\nnpx cclimits --codex\nnpx cclimits --gemini\nnpx cclimits --zai\n\n# JSON output (for scripting)\nnpx cclimits --json\n```\n\n## Credential Locations\n\nCredentials are auto-discovered from these locations:\n\n| Tool | Location |\n|------|----------|\n| **Claude** | `~/.claude/.credentials.json` (Linux) or macOS Keychain |\n| **Codex** | `~/.codex/auth.json` |\n| **Gemini** | `~/.gemini/oauth_creds.json` (auto-refreshes) |\n| **Z.AI** | `$ZAI_KEY` or `$ZAI_API_KEY` environment variable |\n\n## Setup (One-Time)\n\nIf credentials are missing, run the corresponding CLI tool to authenticate:\n\n```bash\nclaude           # Login to Claude Code\ncodex login      # Login to OpenAI Codex\ngemini           # Login to Gemini CLI\nexport ZAI_KEY=your-key  # Add to ~/.zshrc\n```\n\n## Output Interpretation\n\n### Quota Windows\n\nMost tools use rolling windows:\n- **5-hour window**: Short-term rate limit\n- **7-day window**: Weekly quota limit\n\n### Percentage Used\n\n- **0-50%**: Plenty of capacity\n- **50-70%**: Moderate usage, plan accordingly\n- **70-90%**: High usage, may want to switch tools\n- **90-100%**: Near limit, expect rate limiting\n\n### Status Icons\n\n| Icon | Meaning |\n|------|---------|\n| ‚úÖ | Under 70% - plenty of capacity |\n| ‚ö†Ô∏è | 70-90% - moderate usage |\n| üî¥ | 90-100% - near limit |\n| ‚ùå | 100% or unavailable |\n\n### Gemini Tiers\n\nGemini models are grouped by quota tier (models in same tier share quota):\n\n| Tier | Models |\n|------|--------|\n| **3-Flash** | gemini-3-flash-preview |\n| **Flash** | gemini-2.5-flash, gemini-2.5-flash-lite, gemini-2.0-flash |\n| **Pro** | gemini-2.5-pro, gemini-3-pro-preview |\n\n## Example Output\n\n### Compact One-liner (--oneline)\n\n```\nClaude: 4.0% (5h) ‚úÖ | Codex: 0% (5h) ‚úÖ | Z.AI: 1% ‚úÖ | Gemini: ( 3-Flash 7% ‚úÖ | Flash 1% ‚úÖ | Pro 10% ‚úÖ )\n```\n\n### Detailed Output (default)\n\n```\nüîç AI CLI Usage Checker\n   2025-12-31 21:30:00\n\n==================================================\n  Claude Code\n==================================================\n  üîë Auth: Bearer token\n  ‚úÖ Connected\n\n  5-Hour Window:\n    Used:      15.2%\n    Remaining: 84.8%\n    Resets in: 3h 24m\n\n  7-Day Window:\n    Used:      42.0%\n    Remaining: 58.0%\n    Resets in: 4d 12h\n\n==================================================\n  OpenAI Codex\n==================================================\n  üîë Auth: OAuth (ChatGPT)\n  ‚úÖ Connected\n  üìä Plan: pro\n\n  5h Window:\n    Used:      8%\n    Remaining: 92%\n    Resets in: 2h 15m\n\n==================================================\n  Gemini CLI\n==================================================\n  üîë Auth: OAuth (Google Account)\n  ‚úÖ Connected\n  üìä Tier: standard\n\n  Quota by Tier:\n    3-Flash: 7.0% used, 93.0% remaining\n    Flash: 1.0% used, 99.0% remaining\n    Pro: 10.0% used, 90.0% remaining\n\n==================================================\n  Z.AI (GLM-4)\n==================================================\n  ‚úÖ Connected\n\n  Token Quota:\n    Used:      1%\n    Remaining: 99%\n    (10,000 / 1,000,000 tokens)\n```\n\n## Troubleshooting\n\n**\"No credentials found\"**\n- Run the CLI tool to authenticate (see Setup section)\n- For Z.AI, ensure environment variable is set\n\n**\"Token expired\"**\n- Claude: Run `claude` to re-authenticate\n- Codex: Run `codex login`\n- Gemini: Run `gemini` (or wait for auto-refresh)\n\n**API errors**\n- Check internet connectivity\n- Verify the CLI tool works directly\n- Check if the service is down\n\n## Package Info\n\n**npm package:** [cclimits](https://www.npmjs.com/package/cclimits)\n**GitHub:** [cruzanstx/cclimits](https://github.com/cruzanstx/cclimits)\n\nRequires: Node.js 16+ and Python 3.10+"
              },
              {
                "name": "config-reader",
                "description": "Read and manage daplug configuration from CLAUDE.md using <daplug_config> blocks, with legacy fallback and migration support.",
                "path": "skills/config-reader/SKILL.md",
                "frontmatter": {
                  "name": "config-reader",
                  "description": "Read and manage daplug configuration from CLAUDE.md using <daplug_config> blocks, with legacy fallback and migration support.",
                  "allowed-tools": [
                    "Bash(python3:*)",
                    "Bash(jq:*)",
                    "Read"
                  ]
                },
                "content": "# Daplug Config Reader\n\nCentralized configuration reader/migrator for daplug settings stored in `<daplug_config>` blocks inside CLAUDE.md. Provides backwards compatibility with legacy plaintext settings and safe migrations.\n\n## When to Use This Skill\n\n- Any command/skill needs daplug settings (preferred agent, worktree dir, llms_txt dir, ai usage awareness, cli logs dir)\n- Before writing to CLAUDE.md for daplug settings\n- When a user asks to migrate or audit CLAUDE.md config\n\n## Config Format\n\n```markdown\n<daplug_config>\npreferred_agent: codex\nworktree_dir: .worktrees/\nllms_txt_dir: /storage/projects/docker/llms_txt\nai_usage_awareness: enabled\ncli_logs_dir: ~/.claude/cli-logs/\n</daplug_config>\n```\n\n## Usage\n\n```bash\nPLUGIN_ROOT=$(jq -r '.plugins.\"daplug@cruzanstx\"[0].installPath' ~/.claude/plugins/installed_plugins.json)\nCONFIG_READER=\"$PLUGIN_ROOT/skills/config-reader/scripts/config.py\"\n```\n\n### Get Single Setting\n\n```bash\npython3 \"$CONFIG_READER\" get preferred_agent\n```\n\n### Dump All Settings (JSON)\n\n```bash\npython3 \"$CONFIG_READER\" dump --json\n```\n\n### Dump as ENV Vars\n\n```bash\npython3 \"$CONFIG_READER\" dump --env\n```\n\n### Status / Verification\n\n```bash\npython3 \"$CONFIG_READER\" status\npython3 \"$CONFIG_READER\" status --json\n```\n\n### Check Legacy Settings\n\n```bash\npython3 \"$CONFIG_READER\" check-legacy\n```\n\n### Migrate Legacy Settings\n\n```bash\n# Project and user\npython3 \"$CONFIG_READER\" migrate --all\n\n# Project only\npython3 \"$CONFIG_READER\" migrate --project\n\n# User only\npython3 \"$CONFIG_READER\" migrate --user\n```\n\n### Set a Setting\n\n```bash\n# Project scope\npython3 \"$CONFIG_READER\" set worktree_dir \".worktrees/\" --scope project\n\n# User scope\npython3 \"$CONFIG_READER\" set preferred_agent \"codex\" --scope user\n```\n\n## Notes\n\n- Lookup order: project CLAUDE.md (repo root) ‚Üí user ~/.claude/CLAUDE.md\n- Legacy plaintext settings are still supported but trigger warnings\n- Migrations create a timestamped backup before writing"
              },
              {
                "name": "prompt-executor",
                "description": "Execute prompts from ./prompts/ directory with various AI models. Use when user asks to run a prompt, execute a task, delegate work to an AI model, run prompts in worktrees/tmux, or run prompts with verification loops.",
                "path": "skills/prompt-executor/SKILL.md",
                "frontmatter": {
                  "name": "prompt-executor",
                  "description": "Execute prompts from ./prompts/ directory with various AI models. Use when user asks to run a prompt, execute a task, delegate work to an AI model, run prompts in worktrees/tmux, or run prompts with verification loops.",
                  "allowed-tools": [
                    "Bash(git:*)",
                    "Bash(mkdir:*)",
                    "Bash(cp:*)",
                    "Bash(rm:*)",
                    "Bash(python3 ~/.claude/plugins/cache/daplug/daplug/*/skills/prompt-executor/scripts/executor.py:*)",
                    "Bash(codex:*)",
                    "Bash(gemini:*)",
                    "Bash(tmux:*)",
                    "Bash(cat:*)",
                    "Bash(pgrep:*)",
                    "Bash(REPO_ROOT=:*)",
                    "Bash(REPO_NAME=:*)",
                    "Bash(WORKTREE_PATH=:*)",
                    "Bash(WORKTREES_DIR=:*)",
                    "Bash(BRANCH_NAME=:*)",
                    "Bash(TIMESTAMP=:*)",
                    "Bash(\\:*)",
                    "Read",
                    "Edit",
                    "Write",
                    "Task",
                    "Glob",
                    "Grep"
                  ]
                },
                "content": "# Prompt Executor\n\n## Auto-Approval Setup\n\nIf the user has to manually confirm the executor bash command, suggest they add this rule to `~/.claude/settings.json` under `permissions.allow`:\n\n```json\n\"Bash(PLUGIN_ROOT=$(jq -r '.plugins.\\\"daplug@cruzanstx\\\"[0].installPath' ~/.claude/plugins/installed_plugins.json):*)\"\n```\n\n**Quick command to add it:**\n```bash\n# Add auto-approval rule for prompt executor\njq '.permissions.allow += [\"Bash(PLUGIN_ROOT=$(jq -r '\"'\"'.plugins.\\\"daplug@cruzanstx\\\"[0].installPath'\"'\"' ~/.claude/plugins/installed_plugins.json):*)\"]' ~/.claude/settings.json > /tmp/settings.json && mv /tmp/settings.json ~/.claude/settings.json\n```\n\n---\n\nExecute prompts from `./prompts/` (including subfolders) using various AI models (Claude, Codex, Gemini, ZAI, etc).\n\n## When to Use This Skill\n\n- User says \"run prompt 123\" or \"execute prompt 123\"\n- User says \"run that prompt with codex/gemini/zai\"\n- User wants to \"run a prompt in a worktree\"\n- User wants to \"run prompts in parallel\"\n- User asks to \"delegate this to codex/gemini\"\n- User wants to \"run with verification loop\" or \"keep retrying until complete\"\n- User asks to \"check loop status\" for a running prompt\n\n## Executor Script\n\n**IMPORTANT:** Get the executor path from Claude's installed plugins manifest:\n\n```bash\nPLUGIN_ROOT=$(jq -r '.plugins.\"daplug@cruzanstx\"[0].installPath' ~/.claude/plugins/installed_plugins.json)\nEXECUTOR=\"$PLUGIN_ROOT/skills/prompt-executor/scripts/executor.py\"\npython3 \"$EXECUTOR\" [prompts...] [options]\n```\n\n**Options:**\n- `--model, -m`: claude, codex, codex-high, codex-xhigh, gpt52, gpt52-high, gpt52-xhigh, gemini, zai, local, qwen, devstral\n- `--cwd, -c`: Working directory for execution\n- `--run, -r`: Actually run the CLI (default: just return info)\n- `--info-only, -i`: Only return prompt info, no CLI details\n- `--worktree, -w`: Create isolated git worktree for execution\n- `--base-branch, -b`: Base branch for worktree (default: main)\n- `--on-conflict`: How to handle existing worktree (error|remove|reuse|increment)\n- `--loop, -l`: Enable iterative verification loop until completion\n- `--max-iterations`: Max loop iterations before giving up (default: 3)\n- `--completion-marker`: Text pattern signaling completion (default: VERIFICATION_COMPLETE)\n- `--loop-status`: Check status of an existing verification loop\n\n**Output:** JSON with prompt content, CLI command, log path, worktree info, and loop state if enabled\n\n## Execution Flows\n\n### Direct Execution (default)\n\n```bash\n# Get executor path from installed plugins manifest\nPLUGIN_ROOT=$(jq -r '.plugins.\"daplug@cruzanstx\"[0].installPath' ~/.claude/plugins/installed_plugins.json)\nEXECUTOR=\"$PLUGIN_ROOT/skills/prompt-executor/scripts/executor.py\"\n\n# Get prompt info\npython3 \"$EXECUTOR\" 123 --model codex\n\n# Folder-qualified prompt (resolves prompts/providers/011-*.md)\npython3 \"$EXECUTOR\" providers/011 --model codex\n\n# Run in current directory\npython3 \"$EXECUTOR\" 123 --model codex --run\n```\n\n### With Worktree (built-in)\n\nSingle command creates worktree, copies TASK.md, and optionally runs:\n\n```bash\n# Create worktree and get info\npython3 \"$EXECUTOR\" 123 --worktree --model codex\n\n# Create worktree and run immediately\npython3 \"$EXECUTOR\" 123 --worktree --model codex --run\n\n# Use different base branch\npython3 \"$EXECUTOR\" 123 --worktree --base-branch develop --model codex\n```\n\nThe worktree directory is read from `worktree_dir` in `<daplug_config>` within CLAUDE.md (via config-reader), or defaults to `../worktrees/`.\n\n### With tmux (use tmux-manager skill)\n\n1. Get CLI command from executor:\n```bash\npython3 \"$EXECUTOR\" 123 --model codex\n# Returns: {\"cli_command\": [\"codex\", \"exec\", \"--full-auto\"], \"content\": \"...\", \"log\": \"...\"}\n```\n\n2. Create tmux session using tmux-manager patterns:\n```bash\nSESSION_NAME=\"prompt-123-$(date +%Y%m%d-%H%M%S)\"\ntmux new-session -d -s \"$SESSION_NAME\" -c \"$WORKTREE_PATH\"\n```\n\n3. Send command to session:\n```bash\ntmux send-keys -t \"$SESSION_NAME\" \"codex exec --full-auto '...' 2>&1 | tee $LOG_FILE\" C-m\n```\n\n### With Verification Loop\n\nRun prompts with automatic retries until the task is verified complete:\n\n```bash\n# Run with verification loop (background, default 3 iterations)\npython3 \"$EXECUTOR\" 123 --model codex --run --loop\n\n# With custom max iterations\npython3 \"$EXECUTOR\" 123 --model codex --run --loop --max-iterations 5\n\n# With custom completion marker\npython3 \"$EXECUTOR\" 123 --model codex --run --loop --completion-marker \"TASK_DONE\"\n\n# Worktree + loop combo\npython3 \"$EXECUTOR\" 123 --model codex --worktree --run --loop\n```\n\n**Output includes:**\n```json\n{\n  \"execution\": {\n    \"status\": \"loop_running\",\n    \"pid\": 12345,\n    \"loop_log\": \"~/.claude/cli-logs/codex-123-loop-20251229-120000.log\",\n    \"state_file\": \"~/.claude/loop-state/123.json\",\n    \"max_iterations\": 3,\n    \"completion_marker\": \"VERIFICATION_COMPLETE\"\n  }\n}\n```\n\nLog paths follow `cli_logs_dir` from `<daplug_config>` if configured (default `~/.claude/cli-logs/`).\n\n### Check Loop Status\n\n```bash\n# Check specific prompt's loop\npython3 \"$EXECUTOR\" 123 --loop-status\n\n# List all active loops\npython3 \"$EXECUTOR\" --loop-status\n```\n\n## Model Reference\n\n| Model | CLI | Description |\n|-------|-----|-------------|\n| claude | (Task subagent) | Claude Sonnet via subagent |\n| codex | codex exec --full-auto | OpenAI Codex (gpt-5.2-codex) |\n| codex-high | codex exec --full-auto -c model_reasoning_effort=\"high\" | Codex with high reasoning |\n| codex-xhigh | codex exec --full-auto -c model_reasoning_effort=\"xhigh\" | Codex with xhigh reasoning |\n| gpt52 | codex exec --full-auto -m gpt-5.2 | GPT-5.2 for planning/research |\n| gpt52-high | codex exec --full-auto -m gpt-5.2 -c model_reasoning_effort=\"high\" | GPT-5.2 with high reasoning |\n| gpt52-xhigh | codex exec --full-auto -m gpt-5.2 -c model_reasoning_effort=\"xhigh\" | GPT-5.2 with xhigh reasoning |\n| gemini | gemini -y | Google Gemini 2.5 Pro |\n| zai | codex exec --profile zai | Z.AI GLM-4.7 |\n| local/qwen | codex exec --profile local | Local qwen model |\n| devstral | codex exec --profile local-devstral | Local devstral model |\n\n## Output Display\n\nAfter executing the prompt, display a clear summary that includes the prompt **title** from the JSON output:\n\n```markdown\n## Execution Started\n\n**Prompt 295**: Add transcript success monitoring with retry logic\n\n| Field | Value |\n|-------|-------|\n| Model | codex (gpt-5.2-codex) |\n| Status | üü¢ Running (PID 12345) |\n| Loop | Max 3 iterations |\n\nWorktree: `.worktrees/repo-prompt-295-20251229-181852/`\nBranch: `prompt/295-transcript-success-monitoring`\n```\n\n**Important**: Always include the `title` field from the executor JSON output. This tells the user what the prompt actually does, not just its number.\n\n## Monitoring Pattern\n\nAfter launching, spawn a haiku monitor subagent:\n\n```\nTask(\n  subagent_type: \"general-purpose\",\n  model: \"haiku\",\n  run_in_background: true,\n  prompt: \"\"\"\n    Monitor prompt execution:\n    - Log file: {log_path}\n    - PID: {pid}\n    - {If tmux: Session: {session}}\n    - {If worktree: Worktree: {worktree_path}}\n\n    IMPORTANT: Use Bash tool for all file operations (not Read tool):\n\n    Every 30 seconds, check status using Bash:\n    ```bash\n    # Check if process is running\n    ps -p {pid} > /dev/null 2>&1 && echo \"RUNNING\" || echo \"STOPPED\"\n\n    # Tail last 20 lines of log\n    tail -20 \"{log_path}\"\n    ```\n\n    On completion (process ended):\n    ```bash\n    # Get summary from log\n    tail -50 \"{log_path}\"\n\n    # If worktree, show git status\n    cd \"{worktree_path}\" && git log --oneline -5 && git diff --stat\n    ```\n    - Summarize what was done\n    - Report final status\n  \"\"\"\n)\n```\n\n## Cleanup\n\nFor worktree executions, after completion:\n\n```bash\n# Remove TASK.md before merge\nrm \"$WORKTREE_PATH/TASK.md\"\n\n# Merge if requested\ngit checkout main\ngit merge --no-ff \"$BRANCH_NAME\" -m \"Merge prompt: $BRANCH_NAME\"\n\n# Cleanup\ngit worktree remove \"$WORKTREE_PATH\"\ngit branch -D \"$BRANCH_NAME\"\ngit worktree prune\n```"
              },
              {
                "name": "prompt-finder",
                "description": "Find and resolve prompt files in ./prompts/ directory. Use when user asks to find a prompt, list available prompts, locate prompt by number or name, or check what prompts exist.",
                "path": "skills/prompt-finder/SKILL.md",
                "frontmatter": {
                  "name": "prompt-finder",
                  "description": "Find and resolve prompt files in ./prompts/ directory. Use when user asks to find a prompt, list available prompts, locate prompt by number or name, or check what prompts exist.",
                  "allowed-tools": [
                    "Bash(python3:*)",
                    "Bash(PLUGIN_ROOT=:*)",
                    "Bash(PROMPT_MANAGER=:*)",
                    "Read",
                    "Glob",
                    "Grep"
                  ]
                },
                "content": "# Prompt File Finder\n\nLocate and resolve prompt files using the prompt-manager skill.\n\n## Setup\n\nAll operations use prompt-manager for consistent git root detection:\n\n```bash\nPLUGIN_ROOT=$(jq -r '.plugins.\"daplug@cruzanstx\"[0].installPath' ~/.claude/plugins/installed_plugins.json)\nPROMPT_MANAGER=\"$PLUGIN_ROOT/skills/prompt-manager/scripts/manager.py\"\n```\n\n## When to Use This Skill\n\n- User asks \"find prompt 42\" or \"which prompt is about auth?\"\n- User wants to \"list available prompts\" or \"show prompts\"\n- User asks \"what's the latest prompt?\" or \"most recent prompt\"\n- Before executing a prompt, to resolve the exact file path\n- User wants to search prompts by keyword\n\n## Core Operations\n\n### List All Prompts\n\n```bash\n# List all prompts (active and completed)\npython3 \"$PROMPT_MANAGER\" list\n\n# Output:\n# [ ] 006 - backup-server\n# [ ] 007 - deploy-k8s\n# [‚úì] 001 - initial-setup\n# [‚úì] 002 - add-authentication\n\n# As JSON\npython3 \"$PROMPT_MANAGER\" list --json\n\n# Active only\npython3 \"$PROMPT_MANAGER\" list --active\n\n# Completed only\npython3 \"$PROMPT_MANAGER\" list --completed\n```\n\n### Find Prompt by Number\n\n```bash\n# Returns path to prompt file\npython3 \"$PROMPT_MANAGER\" find 42\n# Output: /path/to/repo/prompts/042-my-prompt.md\n\n# As JSON with full info\npython3 \"$PROMPT_MANAGER\" find 42 --json\n# {\n#   \"number\": \"042\",\n#   \"name\": \"my-prompt\",\n#   \"filename\": \"042-my-prompt.md\",\n#   \"path\": \"/path/to/repo/prompts/042-my-prompt.md\",\n#   \"status\": \"active\"\n# }\n```\n\n### Read Prompt Content\n\n```bash\npython3 \"$PROMPT_MANAGER\" read 42\n# Outputs the full content of the prompt\n```\n\n### Show Prompt Preview\n\n```bash\n# Read first 30 lines\npython3 \"$PROMPT_MANAGER\" read 42 | head -30\n```\n\n### Get Prompts Directory Info\n\n```bash\npython3 \"$PROMPT_MANAGER\" info\n# Repository root: /path/to/repo\n# Prompts directory: /path/to/repo/prompts\n# Completed directory: /path/to/repo/prompts/completed\n# Next number: 008\n# Active prompts: 2\n# Completed prompts: 5\n# Total prompts: 7\n\n# As JSON\npython3 \"$PROMPT_MANAGER\" info --json\n```\n\n### Find Prompt by Name/Keyword\n\n```bash\n# List all and grep for keyword\npython3 \"$PROMPT_MANAGER\" list | grep -i \"auth\"\n\n# Or use JSON and jq\npython3 \"$PROMPT_MANAGER\" list --json | jq '.[] | select(.name | contains(\"auth\"))'\n```\n\n### Search Prompt Contents\n\nFor content search, use Grep tool on the prompts directory:\n\n```bash\n# Get prompts directory\nPROMPTS_DIR=$(python3 \"$PROMPT_MANAGER\" info --json | jq -r '.prompts_dir')\n\n# Search contents\ngrep -l -i \"database\" \"$PROMPTS_DIR\"/*.md 2>/dev/null\n```\n\nOr use the Grep tool:\n```\nGrep pattern=\"database\" path=\"{prompts_dir}\" glob=\"*.md\"\n```\n\n### Archive/Complete a Prompt\n\n```bash\npython3 \"$PROMPT_MANAGER\" complete 42\n# Output: Completed: /path/to/repo/prompts/completed/042-my-prompt.md\n```\n\n## Resolution Examples\n\n```bash\n# Find prompt 6 (auto-pads to 006)\nPROMPT_PATH=$(python3 \"$PROMPT_MANAGER\" find 6)\nif [ -n \"$PROMPT_PATH\" ]; then\n    echo \"Found: $PROMPT_PATH\"\n    # Read content\n    CONTENT=$(python3 \"$PROMPT_MANAGER\" read 6)\nfi\n\n# Check if prompt exists\nif python3 \"$PROMPT_MANAGER\" find 99 >/dev/null 2>&1; then\n    echo \"Prompt 99 exists\"\nelse\n    echo \"Prompt 99 not found\"\nfi\n```\n\n## Error Handling\n\nprompt-manager returns exit code 1 and writes errors to stderr:\n\n```bash\n$ python3 \"$PROMPT_MANAGER\" find 999\nError: Prompt 999 not found\n\n$ python3 \"$PROMPT_MANAGER\" complete 6  # already completed\nError: Prompt 006 is already completed\n```\n\n## Expected Directory Structure\n\n```\n{git_root}/prompts/\n‚îú‚îÄ‚îÄ 006-backup-server.md\n‚îú‚îÄ‚îÄ 007-deploy-k8s.md\n‚îú‚îÄ‚îÄ ...\n‚îî‚îÄ‚îÄ completed/\n    ‚îú‚îÄ‚îÄ 001-initial-setup.md\n    ‚îú‚îÄ‚îÄ 002-add-authentication.md\n    ‚îî‚îÄ‚îÄ ...\n```\n\n## Naming Convention\n\nPrompts follow the pattern: `NNN-descriptive-name.md`\n- `NNN` = Zero-padded number (001, 042, 123)\n- `descriptive-name` = Kebab-case description (max 5 words)\n- `.md` = Markdown extension\n\n## Legacy Compatibility\n\nIf prompt-manager is not available, fall back to direct file operations:\n\n```bash\n# Check if prompt-manager exists\nif [ ! -f \"$PROMPT_MANAGER\" ]; then\n    # Fallback: direct file listing\n    ls -1 ./prompts/*.md 2>/dev/null\nfi\n```"
              },
              {
                "name": "tmux-manager",
                "description": "Manage tmux sessions for background tasks. Use when user asks about background processes, wants to monitor running tasks, attach to sessions, list active sessions, or kill stuck processes.",
                "path": "skills/tmux-manager/SKILL.md",
                "frontmatter": {
                  "name": "tmux-manager",
                  "description": "Manage tmux sessions for background tasks. Use when user asks about background processes, wants to monitor running tasks, attach to sessions, list active sessions, or kill stuck processes.",
                  "allowed-tools": [
                    "Bash(tmux:*)",
                    "Bash(sleep:*)",
                    "Read",
                    "Glob"
                  ]
                },
                "content": "# tmux Session Management\n\nCreate, monitor, and manage tmux sessions for background task execution.\n\n## When to Use This Skill\n\n- User asks \"what's running in the background?\"\n- User wants to \"attach to a session\" or \"check on a task\"\n- User asks to \"list sessions\" or \"kill a stuck process\"\n- User wants to run something in the background\n- After spawning parallel tasks, to monitor progress\n\n## Core Operations\n\n### List All Sessions\n\n```bash\ntmux ls\n```\n\n### List Sessions by Pattern\n\n```bash\n# Find sessions from a specific run\nRUN_ID=\"20241213-153012\"\ntmux ls 2>/dev/null | grep \"$RUN_ID\" || echo \"No sessions matching $RUN_ID\"\n\n# Find prompt-related sessions\ntmux ls 2>/dev/null | grep \"prompt-\" || echo \"No prompt sessions found\"\n\n# Find codex sessions\ntmux ls 2>/dev/null | grep \"codex-\" || echo \"No codex sessions found\"\n```\n\n### Create a Background Session\n\n```bash\nSESSION_NAME=\"my-task-$(date +%Y%m%d-%H%M%S)\"\nWORKING_DIR=\"/path/to/directory\"\n\n# Create session with specific working directory\ntmux new-session -d -s \"$SESSION_NAME\" -c \"$WORKING_DIR\"\n\n# Send commands to the session\ntmux send-keys -t \"$SESSION_NAME\" \"echo 'Starting task...'\" C-m\ntmux send-keys -t \"$SESSION_NAME\" \"your-command-here\" C-m\n\necho \"Session started: $SESSION_NAME\"\necho \"Attach with: tmux attach -t $SESSION_NAME\"\n```\n\n### Launch Claude in Background Session\n\n```bash\nSESSION_NAME=\"claude-task-$(date +%Y%m%d-%H%M%S)\"\nWORKING_DIR=\"/path/to/worktree\"\n\ntmux new-session -d -s \"$SESSION_NAME\" -c \"$WORKING_DIR\"\ntmux send-keys -t \"$SESSION_NAME\" \"claude\" C-m\nsleep 2  # Wait for directory trust prompt\ntmux send-keys -t \"$SESSION_NAME\" C-m  # Auto-approve\nsleep 2  # Wait for Claude to be ready\ntmux send-keys -t \"$SESSION_NAME\" \"Your task instructions here\" C-m\n\necho \"Claude session started: $SESSION_NAME\"\n```\n\n### Check Session Status\n\n```bash\nSESSION_NAME=\"prompt-005-20241213-153012\"\n\n# Check if session exists\nif tmux has-session -t \"$SESSION_NAME\" 2>/dev/null; then\n    echo \"Session $SESSION_NAME is running\"\n\n    # Capture recent output (last 100 lines)\n    tmux capture-pane -t \"$SESSION_NAME\" -p -S -100\nelse\n    echo \"Session $SESSION_NAME has ended\"\nfi\n```\n\n### Capture Session Output\n\n```bash\nSESSION_NAME=\"my-session\"\n\n# Capture visible pane content\ntmux capture-pane -t \"$SESSION_NAME\" -p\n\n# Capture with history (last N lines)\ntmux capture-pane -t \"$SESSION_NAME\" -p -S -500\n\n# Save to file\ntmux capture-pane -t \"$SESSION_NAME\" -p -S -1000 > session-output.txt\n```\n\n### Attach to Session\n\n```bash\n# Attach to specific session\ntmux attach -t \"$SESSION_NAME\"\n\n# Detach: Press Ctrl+B, then D\n```\n\n### Kill a Session\n\n```bash\n# Kill specific session\ntmux kill-session -t \"$SESSION_NAME\"\n\n# Kill all sessions matching pattern\nfor session in $(tmux ls -F \"#{session_name}\" 2>/dev/null | grep \"prompt-\"); do\n    tmux kill-session -t \"$session\"\n    echo \"Killed: $session\"\ndone\n```\n\n### Wait for Session to Complete\n\n```bash\nSESSION_NAME=\"my-task\"\n\necho \"Waiting for $SESSION_NAME to complete...\"\nwhile tmux has-session -t \"$SESSION_NAME\" 2>/dev/null; do\n    sleep 5\ndone\necho \"Session $SESSION_NAME has ended\"\n```\n\n### Monitor Multiple Sessions\n\n```bash\n# List all sessions with their status\necho \"Active tmux sessions:\"\ntmux ls -F \"#{session_name}: #{session_windows} windows, created #{session_created_string}\" 2>/dev/null || echo \"No active sessions\"\n\n# Check specific sessions from a run\nRUN_ID=\"20241213-153012\"\nSESSIONS=(\"prompt-005-$RUN_ID\" \"prompt-006-$RUN_ID\" \"prompt-007-$RUN_ID\")\n\nfor session in \"${SESSIONS[@]}\"; do\n    if tmux has-session -t \"$session\" 2>/dev/null; then\n        echo \"$session: RUNNING\"\n    else\n        echo \"$session: COMPLETED\"\n    fi\ndone\n```\n\n## Parallel Task Patterns\n\n### Launch Multiple Sessions\n\n```bash\ndeclare -A SESSIONS\nTASKS=(\"task1\" \"task2\" \"task3\")\nRUN_ID=\"$(date +%Y%m%d-%H%M%S)\"\n\nfor task in \"${TASKS[@]}\"; do\n    SESSION_NAME=\"${task}-${RUN_ID}\"\n    tmux new-session -d -s \"$SESSION_NAME\"\n    tmux send-keys -t \"$SESSION_NAME\" \"echo 'Running $task'\" C-m\n    SESSIONS[$task]=\"$SESSION_NAME\"\n    echo \"Started: $SESSION_NAME\"\ndone\n\necho \"\"\necho \"Monitor with: tmux ls | grep $RUN_ID\"\n```\n\n### Wait for All Sessions\n\n```bash\nSESSIONS=(\"session1\" \"session2\" \"session3\")\n\necho \"Waiting for all sessions to complete...\"\nall_done=false\nwhile [ \"$all_done\" = false ]; do\n    all_done=true\n    for session in \"${SESSIONS[@]}\"; do\n        if tmux has-session -t \"$session\" 2>/dev/null; then\n            all_done=false\n            break\n        fi\n    done\n    [ \"$all_done\" = false ] && sleep 5\ndone\necho \"All sessions completed\"\n```\n\n## Troubleshooting\n\n**tmux not installed**\n```bash\n# Check installation\nwhich tmux || echo \"tmux not installed\"\n\n# Install\nsudo apt install tmux  # Debian/Ubuntu\nbrew install tmux      # macOS\n```\n\n**Session not found**\n```bash\n# List all sessions to find correct name\ntmux ls\n\n# Check if session ended\n# (no output means session doesn't exist)\ntmux has-session -t \"session-name\" 2>/dev/null && echo \"exists\" || echo \"not found\"\n```\n\n**Can't attach (already attached elsewhere)**\n```bash\n# Detach other clients first\ntmux detach-client -t \"session-name\"\n# Then attach\ntmux attach -t \"session-name\"\n```\n\n**Session stuck/frozen**\n```bash\n# Force kill\ntmux kill-session -t \"session-name\"\n```"
              },
              {
                "name": "worktree",
                "description": "Manage git worktrees for isolated development. Use when user asks to create isolated workspaces, work on multiple branches simultaneously, set up parallel development environments, or clean up old worktrees.",
                "path": "skills/worktree/SKILL.md",
                "frontmatter": {
                  "name": "worktree",
                  "description": "Manage git worktrees for isolated development. Use when user asks to create isolated workspaces, work on multiple branches simultaneously, set up parallel development environments, or clean up old worktrees.",
                  "allowed-tools": [
                    "Bash(git:*)",
                    "Bash(git worktree:*)",
                    "Bash(git branch:*)",
                    "Bash(mkdir:*)",
                    "Bash(find:*)",
                    "Bash(realpath:*)",
                    "Bash(jq:*)",
                    "Bash(python3:*)",
                    "Bash(REPO_ROOT=:*)",
                    "Bash(REPO_NAME=:*)",
                    "Bash(WORKTREE_PATH=:*)",
                    "Bash(WORKTREES_DIR=:*)",
                    "Bash(BRANCH_NAME=:*)",
                    "Bash(CONFIGURED_DIR=:*)",
                    "Bash(TIMESTAMP=:*)",
                    "Bash(\\:*)",
                    "Read",
                    "Edit",
                    "Write",
                    "Glob",
                    "Grep"
                  ]
                },
                "content": "# Git Worktree Management\n\nCreate, list, and manage git worktrees for isolated development environments.\n\n## When to Use This Skill\n\n- User asks to \"create an isolated workspace\" or \"work on multiple branches\"\n- User wants to \"set up a worktree\" or \"parallel development\"\n- User asks to \"list worktrees\" or \"clean up worktrees\"\n- Before running parallel tasks that might conflict\n\n## Configuration\n\nWorktree directory location is configurable per-project via CLAUDE.md.\n\n### Config Format (in CLAUDE.md)\n\n```markdown\n<daplug_config>\nworktree_dir: /absolute/path/to/worktrees\n# OR\nworktree_dir: .worktrees/\n</daplug_config>\n```\n\n### Get Worktree Directory\n\n**This is the canonical way to resolve the worktree directory.** All operations should use this lookup.\n\n```bash\nREPO_ROOT=$(git rev-parse --show-toplevel)\nPLUGIN_ROOT=$(jq -r '.plugins.\"daplug@cruzanstx\"[0].installPath' ~/.claude/plugins/installed_plugins.json)\nCONFIG_READER=\"$PLUGIN_ROOT/skills/config-reader/scripts/config.py\"\n\n# 1. Check for worktree_dir in CLAUDE.md\nCONFIGURED_DIR=$(python3 \"$CONFIG_READER\" get worktree_dir --repo-root \"$REPO_ROOT\")\n\nif [ -n \"$CONFIGURED_DIR\" ]; then\n    # 2a. Expand relative paths (starts with . or no leading /)\n    if [[ \"$CONFIGURED_DIR\" == .* ]] || [[ \"$CONFIGURED_DIR\" != /* ]]; then\n        WORKTREES_DIR=$(realpath \"${REPO_ROOT}/${CONFIGURED_DIR}\")\n    else\n        WORKTREES_DIR=\"$CONFIGURED_DIR\"\n    fi\nelse\n    # 2b. No config found - STOP and prompt user (see below)\n    echo \"NO_CONFIG\"\nfi\n```\n\n**IMPORTANT: If no config exists (`CONFIGURED_DIR` is empty), you MUST prompt the user before proceeding.**\nDo NOT silently fall back to a default. Use the \"Configure Worktree Directory (Interactive)\" section below to ask the user their preference and store it.\n\n### Configure Worktree Directory (Interactive)\n\nWhen no configuration exists and user needs to set one up:\n\n1. **Ask user for preference** using AskUserQuestion:\n   - \"Sibling directory (../worktrees/)\" - default, outside repo\n   - \"Inside project (.worktrees/)\" - local, will be gitignored\n   - \"Custom path\" - let them specify absolute path\n\n2. **Store the preference** in CLAUDE.md:\n```bash\nREPO_ROOT=$(git rev-parse --show-toplevel)\nPLUGIN_ROOT=$(jq -r '.plugins.\"daplug@cruzanstx\"[0].installPath' ~/.claude/plugins/installed_plugins.json)\nCONFIG_READER=\"$PLUGIN_ROOT/skills/config-reader/scripts/config.py\"\n\n# Add config to CLAUDE.md under <daplug_config>\npython3 \"$CONFIG_READER\" set worktree_dir \"${CHOSEN_PATH}\" --scope project\n```\n\n3. **If path is inside project** (relative path chosen), ensure gitignore:\n```bash\n# Add to .gitignore if not present\nif [ -f \"${REPO_ROOT}/.gitignore\" ]; then\n    if ! grep -qxF \"${CONFIGURED_DIR}\" \"${REPO_ROOT}/.gitignore\" && \\\n       ! grep -qxF \"${CONFIGURED_DIR}/\" \"${REPO_ROOT}/.gitignore\"; then\n        echo \"\" >> \"${REPO_ROOT}/.gitignore\"\n        echo \"# Worktrees directory (local development)\" >> \"${REPO_ROOT}/.gitignore\"\n        echo \"${CONFIGURED_DIR}/\" >> \"${REPO_ROOT}/.gitignore\"\n    fi\nelse\n    echo \"# Worktrees directory (local development)\" > \"${REPO_ROOT}/.gitignore\"\n    echo \"${CONFIGURED_DIR}/\" >> \"${REPO_ROOT}/.gitignore\"\nfi\n\n# Add to .dockerignore if not present\nif [ -f \"${REPO_ROOT}/.dockerignore\" ]; then\n    if ! grep -qxF \"${CONFIGURED_DIR}\" \"${REPO_ROOT}/.dockerignore\" && \\\n       ! grep -qxF \"${CONFIGURED_DIR}/\" \"${REPO_ROOT}/.dockerignore\"; then\n        echo \"\" >> \"${REPO_ROOT}/.dockerignore\"\n        echo \"# Worktrees directory\" >> \"${REPO_ROOT}/.dockerignore\"\n        echo \"${CONFIGURED_DIR}/\" >> \"${REPO_ROOT}/.dockerignore\"\n    fi\nfi\n```\n\n4. **Update Claude permissions** for the resolved absolute path:\n   - Add `Read(/absolute/path/**)`, `Edit(/absolute/path/**)`, `Write(/absolute/path/**)`\n   - Add to `additionalDirectories`\n\n## Core Operations\n\n### Create a Worktree\n\n```bash\n# Get repo info\nREPO_ROOT=$(git rev-parse --show-toplevel)\nREPO_NAME=$(basename \"$REPO_ROOT\")\nCURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)\nPLUGIN_ROOT=$(jq -r '.plugins.\"daplug@cruzanstx\"[0].installPath' ~/.claude/plugins/installed_plugins.json)\nCONFIG_READER=\"$PLUGIN_ROOT/skills/config-reader/scripts/config.py\"\n\n# Get configured worktree directory (see Configuration section)\nCONFIGURED_DIR=$(python3 \"$CONFIG_READER\" get worktree_dir --repo-root \"$REPO_ROOT\")\nif [ -n \"$CONFIGURED_DIR\" ]; then\n    if [[ \"$CONFIGURED_DIR\" == .* ]] || [[ \"$CONFIGURED_DIR\" != /* ]]; then\n        WORKTREES_DIR=$(realpath \"${REPO_ROOT}/${CONFIGURED_DIR}\")\n    else\n        WORKTREES_DIR=\"$CONFIGURED_DIR\"\n    fi\nelse\n    WORKTREES_DIR=$(realpath \"${REPO_ROOT}/../worktrees\")\nfi\n\n# Generate unique identifier\nRUN_ID=\"$(date +%Y%m%d-%H%M%S)\"\n\n# Create worktree with new branch\nBRANCH_NAME=\"feature/${PURPOSE}-${RUN_ID}\"\nWORKTREE_PATH=\"${WORKTREES_DIR}/${REPO_NAME}-${PURPOSE}-${RUN_ID}\"\n\nmkdir -p \"$WORKTREES_DIR\"\ngit worktree add -b \"$BRANCH_NAME\" \"$WORKTREE_PATH\" \"$CURRENT_BRANCH\"\n\necho \"Created worktree:\"\necho \"  Path: $WORKTREE_PATH\"\necho \"  Branch: $BRANCH_NAME\"\necho \"  Based on: $CURRENT_BRANCH\"\n```\n\n### List Worktrees\n\n```bash\ngit worktree list\n```\n\n### Check Worktree Status\n\n```bash\n# For each worktree, show branch and commit count\nCURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)\nfor worktree in $(git worktree list --porcelain | grep \"^worktree\" | cut -d' ' -f2); do\n    branch=$(git -C \"$worktree\" rev-parse --abbrev-ref HEAD 2>/dev/null)\n    if [ \"$branch\" != \"$CURRENT_BRANCH\" ]; then\n        commits=$(git rev-list --count \"$CURRENT_BRANCH\"..\"$branch\" 2>/dev/null || echo \"0\")\n        echo \"$worktree ($branch): $commits commits ahead\"\n    fi\ndone\n```\n\n### Remove a Worktree\n\n**CRITICAL: Ensure your CWD is NOT the worktree you're deleting!**\n\nIf your shell's current working directory is the worktree being deleted, the shell will break\nand all subsequent bash commands will fail with \"No such file or directory\".\n\n```bash\n# FIRST: Ensure you're in the main repo, not the worktree\nREPO_ROOT=$(git rev-parse --show-toplevel 2>/dev/null) || REPO_ROOT=\"/path/to/main/repo\"\ncd \"$REPO_ROOT\"\n\n# Verify we're not in a worktree path\nif [[ \"$(pwd)\" == *\"/worktrees/\"* ]]; then\n    echo \"ERROR: Cannot remove worktree while inside it!\"\n    exit 1\nfi\n\n# Remove specific worktree by path (use subshell for safety)\n(cd \"$REPO_ROOT\" && git worktree remove /path/to/worktree)\n\n# Or force remove if there are changes\n(cd \"$REPO_ROOT\" && git worktree remove --force /path/to/worktree)\n\n# Clean up stale references\ngit worktree prune\n\n# Delete the branch after worktree is removed\ngit branch -D branch-name\n```\n\n### Cleanup Old Worktrees\n\n```bash\n# Get configured worktree directory (see Configuration section)\nREPO_ROOT=$(git rev-parse --show-toplevel)\nPLUGIN_ROOT=$(jq -r '.plugins.\"daplug@cruzanstx\"[0].installPath' ~/.claude/plugins/installed_plugins.json)\nCONFIG_READER=\"$PLUGIN_ROOT/skills/config-reader/scripts/config.py\"\nCONFIGURED_DIR=$(python3 \"$CONFIG_READER\" get worktree_dir --repo-root \"$REPO_ROOT\")\nif [ -n \"$CONFIGURED_DIR\" ]; then\n    if [[ \"$CONFIGURED_DIR\" == .* ]] || [[ \"$CONFIGURED_DIR\" != /* ]]; then\n        WORKTREES_DIR=$(realpath \"${REPO_ROOT}/${CONFIGURED_DIR}\")\n    else\n        WORKTREES_DIR=\"$CONFIGURED_DIR\"\n    fi\nelse\n    WORKTREES_DIR=$(realpath \"${REPO_ROOT}/../worktrees\")\nfi\n\n# Find worktrees older than 7 days\nfind \"$WORKTREES_DIR\" -maxdepth 1 -type d -mtime +7 | while read dir; do\n    echo \"Removing old worktree: $dir\"\n    git worktree remove \"$dir\" 2>/dev/null || true\ndone\ngit worktree prune\n```\n\n### Merge Worktree Branch\n\n```bash\nWORKTREE_PATH=\"/path/to/worktree\"\nBRANCH_NAME=$(git -C \"$WORKTREE_PATH\" rev-parse --abbrev-ref HEAD)\nCURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)\n\n# First, remove the worktree\ngit worktree remove \"$WORKTREE_PATH\"\n\n# Then merge the branch\ngit merge --no-ff \"$BRANCH_NAME\" -m \"Merge $BRANCH_NAME\"\n\n# Optionally delete the branch\ngit branch -d \"$BRANCH_NAME\"\n```\n\n## Permission Setup\n\nWorktrees require file permissions for the worktrees directory. Check/add to `~/.claude/settings.json`:\n\n```json\n{\n  \"permissions\": {\n    \"allow\": [\n      \"Read(/path/to/worktrees/**)\",\n      \"Edit(/path/to/worktrees/**)\",\n      \"Write(/path/to/worktrees/**)\"\n    ],\n    \"additionalDirectories\": [\n      \"/path/to/worktrees\"\n    ]\n  }\n}\n```\n\n## Best Practices\n\n1. **Use RUN_ID timestamps** - Prevents naming collisions on reruns\n2. **Track what you create** - Store paths/branches in arrays for cleanup\n3. **Configure worktree location** - Set `worktree_dir` under `<daplug_config>` in CLAUDE.md for consistency\n   - Sibling directory (`../worktrees/`) - default, avoids git conflicts\n   - Inside project (`.worktrees/`) - self-contained, must be gitignored\n4. **Prune regularly** - Run `git worktree prune` to clean stale references\n5. **Check for dirty state** - Ensure no uncommitted changes before creating worktrees\n\n## Troubleshooting\n\n**\"Branch already checked out\"**\n```bash\ngit worktree list  # Find conflicting worktree\ngit worktree remove /path/to/conflicting\n```\n\n**\"Dirty working directory\"**\n```bash\ngit stash\n# Create worktree...\ngit stash pop\n```\n\n**Stale worktree references**\n```bash\ngit worktree prune\n```\n\n**Shell breaks after deleting worktree (all bash commands fail)**\n\nThis happens when your CWD was the worktree you deleted. The shell can't resolve `.` anymore.\n\nSymptoms:\n- All bash commands return exit code 1\n- Error: \"fatal: Unable to read current working directory: No such file or directory\"\n- Even simple commands like `echo test` fail\n\nSolutions:\n1. **Start a new terminal/session** - cleanest fix\n2. **Use file tools instead of bash** - Read/Write/Glob still work\n3. **Prevention**: Always `cd` to repo root before cleanup:\n   ```bash\n   cd \"$REPO_ROOT\"  # Do this BEFORE removing worktree\n   git worktree remove /path/to/worktree\n   ```"
              }
            ]
          }
        ]
      }
    }
  ]
}