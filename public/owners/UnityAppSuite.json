{
  "owner": {
    "id": "UnityAppSuite",
    "display_name": "UnityAppSuite",
    "type": "Organization",
    "avatar_url": "https://avatars.githubusercontent.com/u/188958432?v=4",
    "url": "https://github.com/UnityAppSuite",
    "bio": null,
    "stats": {
      "total_repos": 1,
      "total_plugins": 1,
      "total_commands": 12,
      "total_skills": 5,
      "total_stars": 0,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "UnityAppSuite/frappe-claude",
      "url": "https://github.com/UnityAppSuite/frappe-claude",
      "description": null,
      "homepage": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-09T07:39:01Z",
        "created_at": "2025-12-03T10:30:54Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 416
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 2707
        },
        {
          "path": "plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 530
        },
        {
          "path": "plugins/frappe-fullstack/README.md",
          "type": "blob",
          "size": 13214
        },
        {
          "path": "plugins/frappe-fullstack/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/agents/doctype-architect.md",
          "type": "blob",
          "size": 17558
        },
        {
          "path": "plugins/frappe-fullstack/agents/erpnext-customizer.md",
          "type": "blob",
          "size": 18452
        },
        {
          "path": "plugins/frappe-fullstack/agents/frappe-backend.md",
          "type": "blob",
          "size": 20700
        },
        {
          "path": "plugins/frappe-fullstack/agents/frappe-custom-frontend.md",
          "type": "blob",
          "size": 15855
        },
        {
          "path": "plugins/frappe-fullstack/agents/frappe-debugger.md",
          "type": "blob",
          "size": 13841
        },
        {
          "path": "plugins/frappe-fullstack/agents/frappe-frontend.md",
          "type": "blob",
          "size": 18155
        },
        {
          "path": "plugins/frappe-fullstack/agents/frappe-planner.md",
          "type": "blob",
          "size": 11201
        },
        {
          "path": "plugins/frappe-fullstack/agents/github-workflow.md",
          "type": "blob",
          "size": 6561
        },
        {
          "path": "plugins/frappe-fullstack/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-app.md",
          "type": "blob",
          "size": 6895
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-backend.md",
          "type": "blob",
          "size": 3908
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-bench.md",
          "type": "blob",
          "size": 5154
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-debug.md",
          "type": "blob",
          "size": 5802
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-doctype-create.md",
          "type": "blob",
          "size": 6590
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-doctype-field.md",
          "type": "blob",
          "size": 6183
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-erpnext.md",
          "type": "blob",
          "size": 5321
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-frontend.md",
          "type": "blob",
          "size": 4859
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-fullstack.md",
          "type": "blob",
          "size": 7321
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-github.md",
          "type": "blob",
          "size": 1439
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-plan.md",
          "type": "blob",
          "size": 10601
        },
        {
          "path": "plugins/frappe-fullstack/commands/frappe-test.md",
          "type": "blob",
          "size": 7942
        },
        {
          "path": "plugins/frappe-fullstack/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/skills/bench-commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/skills/bench-commands/SKILL.md",
          "type": "blob",
          "size": 12441
        },
        {
          "path": "plugins/frappe-fullstack/skills/client-scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/skills/client-scripts/SKILL.md",
          "type": "blob",
          "size": 14841
        },
        {
          "path": "plugins/frappe-fullstack/skills/doctype-patterns",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/skills/doctype-patterns/SKILL.md",
          "type": "blob",
          "size": 13117
        },
        {
          "path": "plugins/frappe-fullstack/skills/frappe-api",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/skills/frappe-api/SKILL.md",
          "type": "blob",
          "size": 16517
        },
        {
          "path": "plugins/frappe-fullstack/skills/server-scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/frappe-fullstack/skills/server-scripts/SKILL.md",
          "type": "blob",
          "size": 14259
        }
      ],
      "marketplace": {
        "name": "frappe-claude",
        "version": null,
        "description": "Claude Code plugins for Frappe Framework and ERPNext development",
        "owner_info": {
          "name": "UnityAppSuite"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "frappe-fullstack",
            "description": "Comprehensive Frappe/ERPNext full-stack development with DocType scaffolding, bench integration, and specialized agents",
            "source": "./plugins/frappe-fullstack",
            "category": null,
            "version": null,
            "author": null,
            "install_commands": [
              "/plugin marketplace add UnityAppSuite/frappe-claude",
              "/plugin install frappe-fullstack@frappe-claude"
            ],
            "signals": {
              "stars": 0,
              "forks": 0,
              "pushed_at": "2026-01-09T07:39:01Z",
              "created_at": "2025-12-03T10:30:54Z",
              "license": null
            },
            "commands": [
              {
                "name": "/frappe-app",
                "description": "Create a new Frappe application with complete scaffolding including modules, hooks, and initial structure",
                "path": "plugins/frappe-fullstack/commands/frappe-app.md",
                "frontmatter": {
                  "description": "Create a new Frappe application with complete scaffolding including modules, hooks, and initial structure",
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep, TodoWrite",
                  "argument-hint": "<app_name> [--title <title>] [--module <module_name>]"
                },
                "content": "# Scaffold New Frappe App\n\nCreate a new Frappe application with proper structure, configuration, and initial setup.\n\n## Arguments\n\nParse the user's input: $ARGUMENTS\n\n- **app_name**: Snake_case app name (e.g., `my_custom_app`)\n- **--title**: Human-readable title (e.g., \"My Custom App\")\n- **--module**: Initial module name to create\n- **--erpnext**: Include ERPNext dependencies\n\n## Process\n\n### Step 1: Verify Environment\n\n```bash\n# Check we're in a bench directory\nif [ -f \"sites/apps.txt\" ]; then\n    echo \"Bench directory confirmed\"\nelse\n    echo \"Error: Not in a bench directory\"\n    exit 1\nfi\n\n# Check if app already exists\nif [ -d \"apps/<app_name>\" ]; then\n    echo \"Error: App already exists\"\n    exit 1\nfi\n```\n\n### Step 2: Create App with Bench\n\n```bash\nbench new-app <app_name>\n```\n\nThis will prompt for:\n- App Title\n- App Description\n- App Publisher\n- App Email\n- App Icon (default: octicon octicon-file-directory)\n- App Color (default: grey)\n- App License (default: MIT)\n\n### Step 3: Review Generated Structure\n\n```\n<app_name>/\n├── <app_name>/\n│   ├── __init__.py\n│   ├── hooks.py              # App configuration\n│   ├── modules.txt           # List of modules\n│   ├── patches.txt           # Database patches\n│   ├── templates/\n│   │   ├── __init__.py\n│   │   └── pages/\n│   ├── www/\n│   └── public/\n│       ├── css/\n│       └── js/\n├── requirements.txt          # Python dependencies\n├── setup.py                  # Package setup\n├── README.md\n├── license.txt\n└── MANIFEST.in\n```\n\n### Step 4: Configure hooks.py\n\nEnhance the generated hooks.py:\n\n```python\napp_name = \"<app_name>\"\napp_title = \"<App Title>\"\napp_publisher = \"<Publisher>\"\napp_description = \"<Description>\"\napp_email = \"<email>\"\napp_license = \"MIT\"\n\n# Required Apps\n# required_apps = [\"frappe\", \"erpnext\"]\n\n# Fixtures (for export)\n# fixtures = [\n#     {\"dt\": \"Custom Field\", \"filters\": [[\"module\", \"=\", \"<App Title>\"]]},\n#     {\"dt\": \"Property Setter\", \"filters\": [[\"module\", \"=\", \"<App Title>\"]]}\n# ]\n\n# Document Events\n# doc_events = {\n#     \"Sales Invoice\": {\n#         \"validate\": \"<app_name>.hooks.validate_sales_invoice\"\n#     }\n# }\n\n# Scheduled Tasks\n# scheduler_events = {\n#     \"daily\": [\n#         \"<app_name>.tasks.daily_task\"\n#     ]\n# }\n\n# Website\n# website_route_rules = [\n#     {\"from_route\": \"/custom-page\", \"to_route\": \"Custom Page\"}\n# ]\n\n# Desk Notifications\n# notification_config = \"<app_name>.notifications.get_notification_config\"\n\n# App includes (for desk)\n# app_include_css = \"/assets/<app_name>/css/custom.css\"\n# app_include_js = \"/assets/<app_name>/js/custom.js\"\n\n# Web includes (for website)\n# web_include_css = \"/assets/<app_name>/css/web.css\"\n# web_include_js = \"/assets/<app_name>/js/web.js\"\n```\n\n### Step 5: Create Initial Module\n\nIf `--module` specified or ask user:\n\n```bash\nmkdir -p apps/<app_name>/<app_name>/<module_name>\ntouch apps/<app_name>/<app_name>/<module_name>/__init__.py\n```\n\nUpdate modules.txt:\n```\n<Module Name>\n```\n\n### Step 6: Create README\n\n```markdown\n# <App Title>\n\n<App Description>\n\n## Installation\n\n```bash\nbench get-app <repository_url>\nbench --site <sitename> install-app <app_name>\n```\n\n## Features\n\n- Feature 1\n- Feature 2\n\n## Configuration\n\n1. Go to Settings > <App> Settings\n2. Configure options\n\n## License\n\nMIT\n```\n\n### Step 7: Install on Site\n\n```bash\nbench --site <sitename> install-app <app_name>\n```\n\n### Step 8: Initialize Git (Optional)\n\n```bash\ncd apps/<app_name>\ngit init\ngit add .\ngit commit -m \"Initial commit\"\n```\n\n## Enhanced Configurations\n\n### For ERPNext Integration\n\n```python\n# hooks.py\nrequired_apps = [\"frappe\", \"erpnext\"]\n\n# Add custom fields to ERPNext doctypes\nafter_install = \"<app_name>.install.after_install\"\nbefore_uninstall = \"<app_name>.install.before_uninstall\"\n```\n\n```python\n# install.py\nimport frappe\nfrom frappe.custom.doctype.custom_field.custom_field import create_custom_fields\n\ndef after_install():\n    create_custom_fields({\n        \"Sales Invoice\": [\n            {\n                \"fieldname\": \"custom_field\",\n                \"label\": \"Custom Field\",\n                \"fieldtype\": \"Data\",\n                \"insert_after\": \"customer\"\n            }\n        ]\n    })\n\ndef before_uninstall():\n    # Cleanup custom fields\n    pass\n```\n\n### For REST API\n\n```python\n# api.py\nimport frappe\n\n@frappe.whitelist()\ndef get_data(param):\n    \"\"\"API endpoint: /api/method/<app_name>.api.get_data\"\"\"\n    return {\"status\": \"success\", \"data\": param}\n\n@frappe.whitelist(allow_guest=True)\ndef public_endpoint():\n    \"\"\"Public API endpoint\"\"\"\n    return {\"message\": \"Hello World\"}\n```\n\n### For Scheduled Tasks\n\n```python\n# tasks.py\nimport frappe\n\ndef daily_task():\n    \"\"\"Run daily at midnight\"\"\"\n    # Your task logic\n    frappe.db.commit()\n\ndef hourly_sync():\n    \"\"\"Run every hour\"\"\"\n    # Sync logic\n    pass\n```\n\n### For Custom Pages\n\n```python\n# pages/custom_page/custom_page.py\nimport frappe\n\ndef get_context(context):\n    context.data = frappe.get_all(\"DocType\", limit=10)\n    return context\n```\n\n```html\n<!-- pages/custom_page/custom_page.html -->\n{% extends \"templates/web.html\" %}\n\n{% block page_content %}\n<div class=\"container\">\n    <h1>Custom Page</h1>\n    {% for item in data %}\n        <p>{{ item.name }}</p>\n    {% endfor %}\n</div>\n{% endblock %}\n```\n\n## File Templates\n\n### __init__.py\n```python\n__version__ = \"0.0.1\"\n```\n\n### setup.py\n```python\nfrom setuptools import setup, find_packages\n\nsetup(\n    name=\"<app_name>\",\n    version=\"0.0.1\",\n    description=\"<description>\",\n    author=\"<author>\",\n    author_email=\"<email>\",\n    packages=find_packages(),\n    zip_safe=False,\n    include_package_data=True,\n    install_requires=[]\n)\n```\n\n### requirements.txt\n```\n# Add Python dependencies here\n# requests\n# pandas\n```\n\n## Output\n\nAfter creation, provide:\n\n1. **Created Files Summary**\n   - List all files created\n   - Highlight key configuration files\n\n2. **Next Steps**\n   ```bash\n   # Install on site\n   bench --site <sitename> install-app <app_name>\n\n   # Create first DocType\n   # Use /doctype-create command\n\n   # Start development\n   bench start\n   ```\n\n3. **Useful Commands**\n   ```bash\n   # Run migrations\n   bench --site <sitename> migrate\n\n   # Build assets\n   bench build --app <app_name>\n\n   # Run tests\n   bench --site <sitename> run-tests --app <app_name>\n\n   # Export fixtures\n   bench --site <sitename> export-fixtures --app <app_name>\n   ```\n\n4. **Development Tips**\n   - Use `bench watch` for auto-rebuild\n   - Check logs: `tail -f logs/frappe.log`\n   - Clear cache after changes: `bench --site <site> clear-cache`"
              },
              {
                "name": "/frappe-backend",
                "description": "Invoke the Frappe backend agent for server-side Python development including controllers, APIs, database operations, and background jobs",
                "path": "plugins/frappe-fullstack/commands/frappe-backend.md",
                "frontmatter": {
                  "description": "Invoke the Frappe backend agent for server-side Python development including controllers, APIs, database operations, and background jobs",
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep, Task, TodoWrite",
                  "argument-hint": "<task_description>"
                },
                "content": "# Frappe Backend Development\n\nYou are invoking the specialized Frappe backend agent for server-side Python development.\n\n## Request\n\n$ARGUMENTS\n\n## Agent Invocation\n\nUse the Task tool to spawn the `frappe-fullstack:frappe-backend` agent with the following configuration:\n\n**IMPORTANT:** The agent name MUST be fully qualified: `frappe-fullstack:frappe-backend`\n\n### Agent Prompt Template\n\n```\nYou are working on a Frappe/ERPNext backend task.\n\n## Task\n{user's task description}\n\n## Context\n- Working directory: {current directory}\n- Site: {detect from sites/currentsite.txt if available}\n\n## Your Responsibilities\n\n1. **Analyze the Request**\n   - Understand what backend functionality is needed\n   - Identify which DocTypes are involved\n   - Determine if this is controller logic, API, or background job\n\n2. **Explore the Codebase**\n   - Find relevant existing code patterns\n   - Check existing controllers for conventions\n   - Identify utility functions that can be reused\n\n3. **Implement the Solution**\n   - Write clean, well-documented Python code\n   - Follow Frappe coding conventions\n   - Include proper error handling\n   - Add validation where needed\n\n4. **Provide Complete Code**\n   - Controller methods with lifecycle hooks\n   - Whitelisted APIs with proper decorators\n   - Database queries using frappe.db API\n   - Background jobs if long-running operations\n\n## Output Requirements\n- Provide complete, working code\n- Include file paths for where code should go\n- Explain any configuration needed (hooks.py, etc.)\n- List commands to run (migrate, clear-cache, etc.)\n```\n\n## Capabilities\n\nThe frappe-backend agent excels at:\n\n### Controller Development\n- Document lifecycle hooks (validate, before_save, on_submit, etc.)\n- Custom validation logic\n- Calculated fields and totals\n- Status management\n- Related document operations\n\n### Whitelisted APIs\n```python\n@frappe.whitelist()\ndef my_api_endpoint(param1, param2):\n    # API logic\n    return result\n```\n\n### Database Operations\n```python\n# Query\nresults = frappe.db.get_all(\"DocType\", filters={}, fields=[])\n\n# Update\nfrappe.db.set_value(\"DocType\", \"name\", \"field\", \"value\")\n\n# Raw SQL\nfrappe.db.sql(\"SELECT * FROM `tabDocType` WHERE condition\")\n```\n\n### Background Jobs\n```python\nfrappe.enqueue(\n    \"myapp.tasks.heavy_task\",\n    queue=\"long\",\n    timeout=600,\n    **kwargs\n)\n```\n\n### Scheduled Tasks (hooks.py)\n```python\nscheduler_events = {\n    \"daily\": [\"myapp.tasks.daily_task\"],\n    \"hourly\": [\"myapp.tasks.hourly_task\"]\n}\n```\n\n## Common Tasks\n\n1. **\"Add validation to prevent negative quantities\"**\n   → Controller validate method\n\n2. **\"Create API to fetch customer dashboard data\"**\n   → Whitelisted method with aggregation queries\n\n3. **\"Send email notification when order is approved\"**\n   → on_update hook with email logic\n\n4. **\"Sync data from external API daily\"**\n   → Scheduled background job\n\n5. **\"Calculate running totals across child table\"**\n   → Controller validate with iteration\n\n## Tools Available to Agent\n\n- **Glob**: Find Python files and patterns\n- **Grep**: Search for existing implementations\n- **Read**: Read existing code for context\n- **Write**: Create new files\n- **Edit**: Modify existing code\n- **Bash**: Run bench commands, check structure\n\n## Post-Implementation\n\nAfter the agent completes:\n\n1. **Run Migration** (if DocType changed)\n   ```bash\n   bench --site <site> migrate\n   ```\n\n2. **Clear Cache**\n   ```bash\n   bench --site <site> clear-cache\n   ```\n\n3. **Test the Code**\n   ```bash\n   bench --site <site> console\n   # Test your functions\n   ```\n\n4. **Run Tests**\n   ```bash\n   bench --site <site> run-tests --module <module>\n   ```"
              },
              {
                "name": "/frappe-bench",
                "description": "Execute Frappe Bench CLI commands safely with site awareness and common operation shortcuts",
                "path": "plugins/frappe-fullstack/commands/frappe-bench.md",
                "frontmatter": {
                  "description": "Execute Frappe Bench CLI commands safely with site awareness and common operation shortcuts",
                  "allowed-tools": "Bash, Read, Grep, Glob",
                  "argument-hint": "<command> [--site <sitename>]"
                },
                "content": "# Execute Bench Command\n\nSafely execute Frappe Bench CLI commands with proper site context and validation.\n\n## Arguments\n\nParse the user's input: $ARGUMENTS\n\nCommon commands:\n- `migrate` - Run database migrations\n- `build` - Build JavaScript/CSS assets\n- `clear-cache` - Clear Redis cache\n- `console` - Open Python console\n- `start` - Start development server\n- `update` - Update apps and migrate\n- `backup` - Backup site\n- `restore` - Restore from backup\n\n## Process\n\n### Step 1: Detect Bench Directory\n\nFind the frappe-bench directory:\n```bash\n# Check if we're in a bench directory\nif [ -f \"sites/apps.txt\" ]; then\n    echo \"Bench directory found: $(pwd)\"\nelse\n    # Try to find bench directory\n    find ~ -name \"frappe-bench\" -type d 2>/dev/null | head -3\nfi\n```\n\n### Step 2: Identify Available Sites\n\n```bash\n# List available sites\nls sites/ | grep -v \"apps.txt\\|common_site_config.json\\|assets\"\n```\n\n### Step 3: Determine Current Site\n\n```bash\n# Check default site\ncat sites/currentsite.txt 2>/dev/null || echo \"No default site set\"\n```\n\n### Step 4: Execute Command\n\nBased on the requested operation:\n\n#### Migrate\n```bash\nbench --site <sitename> migrate\n```\n\n**Safety checks:**\n- Warn about uncommitted changes in apps\n- Suggest backup before migrate\n- Check for pending patches\n\n#### Build\n```bash\n# Build all apps\nbench build\n\n# Build specific app\nbench build --app <app_name>\n\n# Build with verbose output\nbench build --verbose\n\n# Production build\nbench build --production\n```\n\n#### Clear Cache\n```bash\nbench --site <sitename> clear-cache\n```\n\n#### Console\n```bash\nbench --site <sitename> console\n\n# Example usage in console:\n# >>> doc = frappe.get_doc(\"Customer\", \"CUST-001\")\n# >>> frappe.db.sql(\"SELECT * FROM tabCustomer LIMIT 5\", as_dict=True)\n```\n\n#### Start Development Server\n```bash\nbench start\n```\n\n**Note:** This will occupy the terminal. Use Ctrl+C to stop.\n\n#### Update\n```bash\n# Full update\nbench update\n\n# Update without backup\nbench update --no-backup\n\n# Update specific apps\nbench update --apps frappe,erpnext\n\n# Update without migrations\nbench update --no-migrations\n```\n\n**Safety checks:**\n- Warn about production sites\n- Suggest backup first\n- Check for uncommitted changes\n\n#### Backup\n```bash\n# Basic backup\nbench --site <sitename> backup\n\n# With files\nbench --site <sitename> backup --with-files\n```\n\nOutput location: `sites/<sitename>/private/backups/`\n\n#### Restore\n```bash\nbench --site <sitename> restore <path_to_backup.sql.gz>\n\n# With files\nbench --site <sitename> restore <backup.sql.gz> \\\n    --with-private-files <private.tar> \\\n    --with-public-files <public.tar>\n```\n\n**Safety checks:**\n- Confirm before restore\n- Warn about data loss\n\n#### Other Common Commands\n\n```bash\n# Set admin password\nbench --site <sitename> set-admin-password <newpassword>\n\n# Add system manager\nbench --site <sitename> add-system-manager <email>\n\n# Enable/disable scheduler\nbench --site <sitename> enable-scheduler\nbench --site <sitename> disable-scheduler\n\n# Show pending jobs\nbench --site <sitename> show-pending-jobs\n\n# Doctor - check site health\nbench --site <sitename> doctor\n\n# MariaDB console\nbench --site <sitename> mariadb\n\n# Export fixtures\nbench --site <sitename> export-fixtures\n\n# Run tests\nbench --site <sitename> run-tests --app <app_name>\n```\n\n## Safety Guidelines\n\n### Destructive Commands (Require Confirmation)\n- `drop-site` - Deletes entire site\n- `reinstall` - Drops and recreates database\n- `restore` - Overwrites current data\n- `reset` - Resets to fresh install\n\n### Production Warnings\nBefore running on production:\n1. Confirm site is in maintenance mode\n2. Ensure backup exists\n3. Check for active users\n\n### Command Validation\n\nFor any command, check:\n1. Is the site name valid?\n2. Is the command recognized by bench?\n3. Are there any pending migrations?\n\n## Error Handling\n\nCommon issues:\n\n### \"Site not found\"\n```bash\n# Check available sites\nls sites/\n```\n\n### \"Module not found\"\n```bash\n# Rebuild environment\nbench setup env\npip install -e apps/frappe -e apps/erpnext\n```\n\n### \"Migration failed\"\n```bash\n# Check error logs\ntail -100 logs/frappe.log\n\n# Skip failing patches\nbench --site <sitename> migrate --skip-failing\n```\n\n### \"Build failed\"\n```bash\n# Clear node modules and rebuild\nrm -rf node_modules\nyarn install\nbench build\n```\n\n## Output\n\nAfter command execution:\n1. Show command output\n2. Report success/failure\n3. Suggest next steps if applicable\n4. Warn about any issues detected\n\n## Quick Reference\n\n| Task | Command |\n|------|---------|\n| Start dev server | `bench start` |\n| Migrate database | `bench --site <site> migrate` |\n| Clear cache | `bench --site <site> clear-cache` |\n| Build assets | `bench build` |\n| Backup site | `bench --site <site> backup` |\n| View logs | `tail -f logs/frappe.log` |\n| Python console | `bench --site <site> console` |\n| MySQL console | `bench --site <site> mariadb` |\n| Run tests | `bench --site <site> run-tests` |\n| Check health | `bench --site <site> doctor` |"
              },
              {
                "name": "/frappe-debug",
                "description": "Invoke the Frappe debugger agent for troubleshooting errors, analyzing logs, debugging permissions, and investigating performance issues",
                "path": "plugins/frappe-fullstack/commands/frappe-debug.md",
                "frontmatter": {
                  "description": "Invoke the Frappe debugger agent for troubleshooting errors, analyzing logs, debugging permissions, and investigating performance issues",
                  "allowed-tools": "Bash, Read, Grep, Glob, Task",
                  "argument-hint": "<error_or_issue_description>"
                },
                "content": "# Frappe Debug & Troubleshoot\n\nYou are invoking the specialized Frappe debugger agent for investigating and resolving issues.\n\n## Request\n\n$ARGUMENTS\n\n## Agent Invocation\n\nUse the Task tool to spawn the `frappe-fullstack:frappe-debugger` agent with the following configuration:\n\n**IMPORTANT:** The agent name MUST be fully qualified: `frappe-fullstack:frappe-debugger`\n\n### Agent Prompt Template\n\n```\nYou are debugging a Frappe/ERPNext issue.\n\n## Issue\n{user's error or issue description}\n\n## Context\n- Working directory: {current directory}\n- Check logs, database, permissions, cache\n\n## Your Responsibilities\n\n1. **Gather Information**\n   - Check error logs\n   - Identify the error type\n   - Find relevant stack traces\n   - Check recent changes\n\n2. **Analyze the Problem**\n   - Determine root cause\n   - Check for common issues\n   - Verify configuration\n   - Test hypotheses\n\n3. **Provide Solution**\n   - Step-by-step fix\n   - Commands to run\n   - Code changes if needed\n   - Prevention tips\n\n## Output Requirements\n- Clear diagnosis of the issue\n- Root cause explanation\n- Solution steps\n- Verification commands\n```\n\n## Capabilities\n\nThe frappe-debugger agent excels at:\n\n### Log Analysis\n```bash\n# Check error logs\ntail -100 logs/frappe.log | grep -i error\n\n# Check web errors\ntail -50 logs/web.error.log\n\n# Check worker errors\ntail -50 logs/worker.error.log\n\n# Site-specific logs\ntail -100 sites/<site>/logs/frappe.log\n```\n\n### Error Types\n\n| Error | Common Causes |\n|-------|---------------|\n| `ValidationError` | Failed validation in controller |\n| `PermissionError` | Missing role or user permission |\n| `LinkValidationError` | Referenced document doesn't exist |\n| `MandatoryError` | Required field is empty |\n| `DuplicateEntryError` | Unique constraint violation |\n| `TimestampMismatchError` | Concurrent edit conflict |\n\n### Permission Debugging\n```python\n# In bench console\nfrappe.session.user\nfrappe.get_roles()\nfrappe.has_permission(\"DocType\", \"write\", \"doc_name\")\n```\n\n### Database Issues\n```sql\n-- Check for orphaned records\nSELECT * FROM `tabChild`\nWHERE parent NOT IN (SELECT name FROM `tabParent`);\n\n-- Check table sizes\nSELECT table_name, ROUND(data_length/1024/1024, 2) as MB\nFROM information_schema.tables\nWHERE table_schema = DATABASE()\nORDER BY data_length DESC;\n```\n\n### Cache Issues\n```bash\n# Clear all cache\nbench --site <site> clear-cache\n\n# Clear Redis\nredis-cli FLUSHALL\n\n# Clear specific\nfrappe.cache().delete_value(\"key\")\n```\n\n### Background Job Issues\n```bash\n# Check pending jobs\nbench --site <site> show-pending-jobs\n\n# Check scheduler\nbench --site <site> show-scheduler-status\n\n# View failed jobs\nbench --site <site> console\n>>> from rq import Queue\n>>> from frappe.utils.background_jobs import get_redis_conn\n>>> q = Queue(\"failed\", connection=get_redis_conn())\n>>> for job in q.jobs: print(job.exc_info)\n```\n\n## Common Issues & Solutions\n\n### 1. \"Document not found\"\n```bash\n# Check if document exists\nbench --site <site> console\n>>> frappe.db.exists(\"DocType\", \"name\")\n```\n\n### 2. \"Permission denied\"\n```bash\n# Check user roles and permissions\nbench --site <site> console\n>>> frappe.get_roles(\"user@email.com\")\n>>> frappe.get_all(\"DocPerm\", filters={\"parent\": \"DocType\"})\n```\n\n### 3. \"Module not found\"\n```bash\n# Reinstall apps\npip install -e apps/frappe\npip install -e apps/my_app\n```\n\n### 4. \"Migration failed\"\n```bash\n# Check what's failing\nbench --site <site> migrate --skip-failing\n\n# Check patches\ncat apps/my_app/my_app/patches.txt\n```\n\n### 5. \"Assets not loading\"\n```bash\n# Rebuild assets\nbench build --force\n\n# Check for JS errors in browser console\n# Hard refresh: Ctrl+Shift+R\n```\n\n### 6. \"Slow performance\"\n```bash\n# Enable slow query log\n# In site_config.json: \"log_slow_queries\": 1\n\n# Check slow queries\ngrep \"slow_query\" logs/frappe.log\n```\n\n### 7. \"Background job stuck\"\n```bash\n# Check workers\nps aux | grep worker\n\n# Restart workers\nsudo supervisorctl restart frappe-bench-workers:*\n```\n\n### 8. \"Redis connection refused\"\n```bash\n# Check Redis\nredis-cli ping\n\n# Restart Redis\nsudo systemctl restart redis\n```\n\n## Diagnostic Commands\n\n```bash\n# Site health check\nbench --site <site> doctor\n\n# Show database size\nbench --site <site> mariadb -e \"\nSELECT table_name,\n       ROUND(data_length/1024/1024, 2) as data_mb\nFROM information_schema.tables\nWHERE table_schema = DATABASE()\nORDER BY data_length DESC\nLIMIT 10\"\n\n# Check scheduler status\nbench --site <site> show-scheduler-status\n\n# List installed apps\nbench --site <site> list-apps\n\n# Check versions\nbench version\n```\n\n## Debug Checklist\n\n1. [ ] Check logs: `tail -100 logs/frappe.log`\n2. [ ] Identify error type from traceback\n3. [ ] Check permissions if PermissionError\n4. [ ] Check document exists if LinkValidationError\n5. [ ] Clear cache: `bench --site <site> clear-cache`\n6. [ ] Check Redis is running\n7. [ ] Check background workers if job-related\n8. [ ] Verify recent code changes with git log\n9. [ ] Test in bench console\n10. [ ] Check browser console for JS errors\n\n## Tools Available to Agent\n\n- **Bash**: Run diagnostic commands, check logs\n- **Read**: Read log files, config files\n- **Grep**: Search logs and code for errors\n- **Glob**: Find relevant files\n\n**Note**: Debug agent has read-only focus to investigate without making changes. Solutions are provided for user to implement.\n\n## Output Format\n\nThe debugger will provide:\n\n1. **Diagnosis**: What's wrong and why\n2. **Root Cause**: The underlying issue\n3. **Solution**: Step-by-step fix\n4. **Verification**: How to confirm it's fixed\n5. **Prevention**: How to avoid in future"
              },
              {
                "name": "/frappe-doctype-create",
                "description": "Create a new Frappe DocType with complete scaffolding including JSON definition, Python controller, JavaScript client script, and tests",
                "path": "plugins/frappe-fullstack/commands/frappe-doctype-create.md",
                "frontmatter": {
                  "description": "Create a new Frappe DocType with complete scaffolding including JSON definition, Python controller, JavaScript client script, and tests",
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep, TodoWrite",
                  "argument-hint": "<doctype_name> [module_name] [--child] [--single] [--submittable]"
                },
                "content": "# Create Frappe DocType\n\nYou are creating a new DocType in a Frappe application. Follow this systematic process to create a complete, working DocType with all necessary files.\n\n## Arguments\n\nParse the user's input: $ARGUMENTS\n\n- **doctype_name**: Name of the DocType (e.g., \"Project Task\", \"Customer Feedback\")\n- **module_name**: (Optional) Module to create DocType in\n- **--child**: Create as child table (istable=1)\n- **--single**: Create as Single DocType (issingle=1)\n- **--submittable**: Create as submittable document (is_submittable=1)\n\n## Process\n\n### Step 1: Discover Project Structure\n\n1. Find the Frappe app in the current directory:\n   ```bash\n   find . -name \"hooks.py\" -path \"*/apps/*\" | head -5\n   ```\n\n2. Read hooks.py to understand the app structure:\n   ```bash\n   cat <app_path>/hooks.py\n   ```\n\n3. Check modules.txt for available modules:\n   ```bash\n   cat <app_path>/modules.txt\n   ```\n\n4. If module not specified, ask user which module to use\n\n### Step 2: Create Directory Structure\n\nConvert DocType name to directory name:\n- \"Project Task\" → \"project_task\"\n- Use snake_case\n\nCreate the DocType directory:\n```bash\nmkdir -p <app>/<module>/doctype/<doctype_dir>\ntouch <app>/<module>/doctype/<doctype_dir>/__init__.py\n```\n\n### Step 3: Ask About Fields\n\nAsk the user about the fields they want to add. Provide suggestions based on DocType name:\n\n- For \"Invoice\": items table, customer, amounts, dates\n- For \"Task\": title, description, status, assigned_to, dates\n- For \"Settings\": configuration fields, checkboxes\n- For child tables: item reference, qty, rate, amount\n\nCommon field patterns to suggest:\n1. **Status field**: Draft → Active → Completed\n2. **Date range**: start_date, end_date\n3. **Amount fields**: qty, rate, amount, total\n4. **References**: customer, supplier, user links\n\n### Step 4: Create DocType JSON\n\nCreate the JSON file with:\n\n```json\n{\n  \"name\": \"<DocType Name>\",\n  \"module\": \"<Module Name>\",\n  \"doctype\": \"DocType\",\n  \"engine\": \"InnoDB\",\n  \"field_order\": [],\n  \"fields\": [\n    // Fields based on user requirements\n  ],\n  \"permissions\": [\n    {\n      \"role\": \"System Manager\",\n      \"read\": 1,\n      \"write\": 1,\n      \"create\": 1,\n      \"delete\": 1\n    }\n  ],\n  \"autoname\": \"naming_series:\",\n  \"naming_rule\": \"By \\\"Naming Series\\\" field\",\n  \"is_submittable\": 0,\n  \"istable\": 0,\n  \"issingle\": 0,\n  \"track_changes\": 1,\n  \"sort_field\": \"modified\",\n  \"sort_order\": \"DESC\"\n}\n```\n\n### Step 5: Create Python Controller\n\n```python\n# <doctype>.py\nimport frappe\nfrom frappe import _\nfrom frappe.model.document import Document\n\n\nclass <ClassName>(Document):\n    def validate(self):\n        pass\n\n    def before_save(self):\n        pass\n\n    def after_insert(self):\n        pass\n\n    def on_update(self):\n        pass\n```\n\nAdd relevant hooks based on DocType type:\n- For submittable: on_submit, on_cancel\n- For documents with calculations: validate with totals\n- For documents with dates: date validation\n\n### Step 6: Create JavaScript Client Script\n\n```javascript\n// <doctype>.js\nfrappe.ui.form.on('<DocType Name>', {\n    refresh: function(frm) {\n        // Custom buttons and field toggles\n    },\n\n    validate: function(frm) {\n        // Client-side validation\n    }\n});\n```\n\nAdd field handlers for:\n- Link fields that need to fetch data\n- Numeric fields that need calculations\n- Conditional field visibility\n\n### Step 7: Create Test File\n\n```python\n# test_<doctype>.py\nimport frappe\nfrom frappe.tests.utils import FrappeTestCase\n\n\nclass Test<ClassName>(FrappeTestCase):\n    def test_create_document(self):\n        doc = frappe.get_doc({\n            \"doctype\": \"<DocType Name>\",\n            # Required fields\n        })\n        doc.insert()\n        self.assertTrue(doc.name)\n\n    def test_validate(self):\n        # Test validation logic\n        pass\n```\n\n### Step 8: Update Module Files\n\nIf this is a new module, update:\n- modules.txt (add module name)\n- Create module directory structure\n\n### Step 9: Migrate\n\nRemind user to run migration:\n```bash\nbench --site <sitename> migrate\n```\n\n## File Locations\n\n```\n<app_name>/\n└── <module_name>/\n    └── doctype/\n        └── <doctype_name>/\n            ├── __init__.py\n            ├── <doctype_name>.json      # DocType definition\n            ├── <doctype_name>.py        # Python controller\n            ├── <doctype_name>.js        # Client script\n            └── test_<doctype_name>.py   # Tests\n```\n\n## Field Type Quick Reference\n\n| Data | Field Type | Notes |\n|------|------------|-------|\n| Text (short) | Data | Max 140 chars |\n| Text (long) | Text | Unlimited |\n| Number | Int/Float | Use Float for decimals |\n| Money | Currency | Company currency aware |\n| Date | Date/Datetime | |\n| Yes/No | Check | Checkbox |\n| Dropdown | Select | Options separated by \\n |\n| Reference | Link | options = DocType name |\n| Child items | Table | options = Child DocType |\n| File | Attach | Single file |\n| Image | Attach Image | With preview |\n\n## Common Patterns\n\n### Naming Series Field\n```json\n{\n  \"fieldname\": \"naming_series\",\n  \"fieldtype\": \"Select\",\n  \"label\": \"Series\",\n  \"options\": \"NEW-.YYYY.-.####\",\n  \"default\": \"NEW-.YYYY.-.####\",\n  \"reqd\": 1\n}\n```\n\n### Status Field\n```json\n{\n  \"fieldname\": \"status\",\n  \"fieldtype\": \"Select\",\n  \"label\": \"Status\",\n  \"options\": \"\\nDraft\\nOpen\\nClosed\\nCancelled\",\n  \"default\": \"Draft\",\n  \"in_list_view\": 1,\n  \"in_standard_filter\": 1\n}\n```\n\n### Amount Calculation (in child table)\n```json\n[\n  {\"fieldname\": \"item\", \"fieldtype\": \"Link\", \"options\": \"Item\", \"in_list_view\": 1},\n  {\"fieldname\": \"qty\", \"fieldtype\": \"Float\", \"in_list_view\": 1},\n  {\"fieldname\": \"rate\", \"fieldtype\": \"Currency\", \"in_list_view\": 1},\n  {\"fieldname\": \"amount\", \"fieldtype\": \"Currency\", \"in_list_view\": 1, \"read_only\": 1}\n]\n```\n\n## Output\n\nAfter completion, provide:\n\n1. Summary of files created\n2. List of fields added\n3. Next steps:\n   - Run `bench --site <site> migrate`\n   - Customize form layout in Desk\n   - Add more fields as needed\n   - Write controller logic\n   - Create tests\n\n## Important Notes\n\n- Use the doctype-architect agent for complex data modeling\n- Use the frappe-backend agent for controller logic\n- Use the frappe-frontend agent for client scripts\n- Always follow Frappe naming conventions\n- Test the migration before proceeding"
              },
              {
                "name": "/frappe-doctype-field",
                "description": "Add, modify, or remove fields from an existing Frappe DocType with automatic JSON updates",
                "path": "plugins/frappe-fullstack/commands/frappe-doctype-field.md",
                "frontmatter": {
                  "description": "Add, modify, or remove fields from an existing Frappe DocType with automatic JSON updates",
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep",
                  "argument-hint": "<doctype_name> <action> [field_details]"
                },
                "content": "# Manage DocType Fields\n\nAdd, modify, or remove fields from an existing Frappe DocType. This command helps you update the DocType JSON file correctly.\n\n## Arguments\n\nParse the user's input: $ARGUMENTS\n\n- **doctype_name**: Name of the existing DocType\n- **action**: add, modify, remove, list\n- **field_details**: Field specifications (for add/modify)\n\n## Actions\n\n### List Fields\nShow current fields in the DocType:\n```\n/doctype-field \"Sales Order\" list\n```\n\n### Add Field\nAdd a new field to the DocType:\n```\n/doctype-field \"Sales Order\" add customer_reference Data\n/doctype-field \"Sales Order\" add priority Select \"Low\\nMedium\\nHigh\"\n/doctype-field \"Sales Order\" add items Table \"Sales Order Item\"\n```\n\n### Modify Field\nModify an existing field:\n```\n/doctype-field \"Sales Order\" modify customer_name label \"Client Name\"\n/doctype-field \"Sales Order\" modify status options \"Draft\\nActive\\nClosed\"\n```\n\n### Remove Field\nRemove a field (with confirmation):\n```\n/doctype-field \"Sales Order\" remove customer_reference\n```\n\n## Process\n\n### Step 1: Find DocType JSON\n\n```bash\n# Search for the DocType JSON file\nfind . -name \"*.json\" -path \"*/doctype/*\" | xargs grep -l '\"name\": \"<DocType Name>\"'\n```\n\nOr if you know the app:\n```bash\n# Convert DocType name to path\n# \"Sales Order\" -> sales_order\ncat apps/<app>/<module>/doctype/<doctype_dir>/<doctype_dir>.json\n```\n\n### Step 2: Read Current Structure\n\nRead and parse the DocType JSON to understand:\n- Current fields and their order\n- Field types and options\n- Existing sections and columns\n\n### Step 3: Validate Field Operation\n\nFor **add**:\n- Check field name doesn't exist\n- Validate field type\n- Suggest appropriate position\n\nFor **modify**:\n- Verify field exists\n- Validate new property values\n\nFor **remove**:\n- Check field exists\n- Warn about dependencies\n- Check if field is used in filters, reports, or code\n\n### Step 4: Apply Changes\n\nModify the JSON file maintaining proper structure:\n\n#### Adding a Field\n\nPosition options:\n- After a specific field\n- In a specific section\n- At the end\n\n```json\n{\n  \"fieldname\": \"new_field\",\n  \"fieldtype\": \"Data\",\n  \"label\": \"New Field\",\n  \"insert_after\": \"existing_field\"\n}\n```\n\n#### Modifying a Field\n\nUpdate only specified properties:\n```json\n{\n  \"fieldname\": \"existing_field\",\n  \"label\": \"New Label\",\n  \"reqd\": 1\n}\n```\n\n#### Removing a Field\n\nRemove from fields array and field_order.\n\n### Step 5: Update Related Files\n\nAfter JSON changes:\n\n1. **Client Script** - Add/remove field handlers\n2. **Controller** - Update validation/calculations\n3. **Migration Required** - Remind to run migrate\n\n## Field Type Reference\n\n### Basic Types\n| Type | Usage | Options |\n|------|-------|---------|\n| Data | Short text | - |\n| Text | Long text | - |\n| Select | Dropdown | Options separated by \\n |\n| Check | Checkbox | - |\n| Int | Integer | - |\n| Float | Decimal | - |\n| Currency | Money | - |\n| Date | Date only | - |\n| Datetime | Date + time | - |\n\n### Link Types\n| Type | Usage | Options |\n|------|-------|---------|\n| Link | Reference | DocType name |\n| Dynamic Link | Polymorphic | Field containing DocType |\n| Table | Child table | Child DocType name |\n| Table MultiSelect | Many-to-many | Link DocType |\n\n### Special Types\n| Type | Usage |\n|------|-------|\n| Attach | File upload |\n| Attach Image | Image upload |\n| Section Break | Section divider |\n| Column Break | Column divider |\n| Tab Break | Tab navigation |\n| HTML | Static content |\n\n## Field Properties\n\n### Display Properties\n```json\n{\n  \"label\": \"Field Label\",\n  \"description\": \"Help text shown below field\",\n  \"bold\": 1,\n  \"hidden\": 0,\n  \"read_only\": 0,\n  \"print_hide\": 0\n}\n```\n\n### Data Properties\n```json\n{\n  \"reqd\": 1,\n  \"unique\": 0,\n  \"default\": \"Default Value\",\n  \"options\": \"Option1\\nOption2\",\n  \"allow_on_submit\": 0,\n  \"no_copy\": 0,\n  \"translatable\": 0\n}\n```\n\n### Display Control\n```json\n{\n  \"in_list_view\": 1,\n  \"in_standard_filter\": 1,\n  \"in_global_search\": 1,\n  \"in_preview\": 1,\n  \"allow_in_quick_entry\": 1\n}\n```\n\n### Conditional Properties\n```json\n{\n  \"depends_on\": \"eval:doc.enable_feature\",\n  \"mandatory_depends_on\": \"eval:doc.status=='Active'\",\n  \"read_only_depends_on\": \"eval:doc.docstatus==1\"\n}\n```\n\n### Link Properties\n```json\n{\n  \"options\": \"Customer\",\n  \"fetch_from\": \"customer.customer_name\",\n  \"fetch_if_empty\": 1\n}\n```\n\n## Common Field Patterns\n\n### Status Field\n```json\n{\n  \"fieldname\": \"status\",\n  \"fieldtype\": \"Select\",\n  \"label\": \"Status\",\n  \"options\": \"\\nDraft\\nPending\\nApproved\\nRejected\",\n  \"default\": \"Draft\",\n  \"in_list_view\": 1,\n  \"in_standard_filter\": 1,\n  \"read_only\": 1\n}\n```\n\n### Customer with Fetch\n```json\n[\n  {\n    \"fieldname\": \"customer\",\n    \"fieldtype\": \"Link\",\n    \"label\": \"Customer\",\n    \"options\": \"Customer\",\n    \"reqd\": 1\n  },\n  {\n    \"fieldname\": \"customer_name\",\n    \"fieldtype\": \"Data\",\n    \"label\": \"Customer Name\",\n    \"fetch_from\": \"customer.customer_name\",\n    \"read_only\": 1\n  }\n]\n```\n\n### Date Range\n```json\n[\n  {\n    \"fieldname\": \"from_date\",\n    \"fieldtype\": \"Date\",\n    \"label\": \"From Date\",\n    \"reqd\": 1\n  },\n  {\n    \"fieldname\": \"to_date\",\n    \"fieldtype\": \"Date\",\n    \"label\": \"To Date\",\n    \"reqd\": 1\n  }\n]\n```\n\n### Amount Calculation\n```json\n[\n  {\"fieldname\": \"qty\", \"fieldtype\": \"Float\", \"label\": \"Qty\"},\n  {\"fieldname\": \"rate\", \"fieldtype\": \"Currency\", \"label\": \"Rate\"},\n  {\"fieldname\": \"amount\", \"fieldtype\": \"Currency\", \"label\": \"Amount\", \"read_only\": 1}\n]\n```\n\n## Post-Change Steps\n\nAfter modifying the DocType JSON:\n\n1. **Run Migration**\n   ```bash\n   bench --site <sitename> migrate\n   ```\n\n2. **Clear Cache** (if schema unchanged)\n   ```bash\n   bench --site <sitename> clear-cache\n   ```\n\n3. **Update Controller** (if logic needed)\n   - Add validation for new fields\n   - Update calculations\n\n4. **Update Client Script** (if UI logic needed)\n   - Add field change handlers\n   - Update visibility conditions\n\n## Output\n\nProvide:\n1. Summary of changes made\n2. Updated field list\n3. Migration command to run\n4. Any additional code changes needed"
              },
              {
                "name": "/frappe-erpnext",
                "description": "Invoke the ERPNext customizer agent for extending ERPNext with custom fields, hooks, fixtures, and module-specific customizations",
                "path": "plugins/frappe-fullstack/commands/frappe-erpnext.md",
                "frontmatter": {
                  "description": "Invoke the ERPNext customizer agent for extending ERPNext with custom fields, hooks, fixtures, and module-specific customizations",
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep, Task, TodoWrite",
                  "argument-hint": "<customization_description>"
                },
                "content": "# ERPNext Customization\n\nYou are invoking the specialized ERPNext customizer agent for extending and customizing ERPNext.\n\n## Request\n\n$ARGUMENTS\n\n## Agent Invocation\n\nUse the Task tool to spawn the `frappe-fullstack:erpnext-customizer` agent with the following configuration:\n\n**IMPORTANT:** The agent name MUST be fully qualified: `frappe-fullstack:erpnext-customizer`\n\n### Agent Prompt Template\n\n```\nYou are customizing ERPNext for specific business requirements.\n\n## Task\n{user's customization description}\n\n## Context\n- This is ERPNext customization (not core modification)\n- All changes should be in a custom app\n- Use hooks, custom fields, and fixtures\n\n## Your Responsibilities\n\n1. **Analyze the Customization**\n   - Which ERPNext DocTypes are affected?\n   - What custom fields are needed?\n   - What hooks/events to intercept?\n   - What workflows to implement?\n\n2. **Explore Existing Patterns**\n   - Check how ERPNext handles similar cases\n   - Find extension points in ERPNext code\n   - Identify reusable utilities\n\n3. **Implement the Customization**\n   - Create custom fields via fixtures\n   - Add hooks in hooks.py\n   - Write override functions\n   - Set up workflows if needed\n\n4. **Ensure Portability**\n   - Export as fixtures\n   - Document the customization\n   - Handle ERPNext upgrades gracefully\n\n## Output Requirements\n- Custom field definitions (fixtures)\n- hooks.py configuration\n- Override functions\n- Workflow definitions (if applicable)\n- Installation/export commands\n```\n\n## Capabilities\n\nThe erpnext-customizer agent excels at:\n\n### Custom Fields\n```python\n# In install.py\nfrom frappe.custom.doctype.custom_field.custom_field import create_custom_fields\n\ncustom_fields = {\n    \"Sales Invoice\": [\n        {\n            \"fieldname\": \"custom_channel\",\n            \"label\": \"Sales Channel\",\n            \"fieldtype\": \"Link\",\n            \"options\": \"Sales Channel\",\n            \"insert_after\": \"customer\"\n        }\n    ]\n}\ncreate_custom_fields(custom_fields)\n```\n\n### Document Hooks\n```python\n# hooks.py\ndoc_events = {\n    \"Sales Invoice\": {\n        \"validate\": \"my_app.overrides.sales_invoice.validate\",\n        \"on_submit\": \"my_app.overrides.sales_invoice.on_submit\"\n    }\n}\n```\n\n### Override Class\n```python\n# hooks.py\noverride_doctype_class = {\n    \"Sales Invoice\": \"my_app.overrides.CustomSalesInvoice\"\n}\n```\n\n### Fixtures\n```python\n# hooks.py\nfixtures = [\n    {\"dt\": \"Custom Field\", \"filters\": [[\"module\", \"=\", \"My App\"]]},\n    {\"dt\": \"Property Setter\", \"filters\": [[\"module\", \"=\", \"My App\"]]},\n    {\"dt\": \"Workflow\", \"filters\": [[\"name\", \"=\", \"My Workflow\"]]}\n]\n```\n\n### Workflows\n```python\nworkflow = {\n    \"doctype\": \"Workflow\",\n    \"name\": \"Sales Order Approval\",\n    \"document_type\": \"Sales Order\",\n    \"is_active\": 1,\n    \"states\": [...],\n    \"transitions\": [...]\n}\n```\n\n## ERPNext Modules Reference\n\n| Module | Key DocTypes |\n|--------|-------------|\n| Accounts | Sales Invoice, Purchase Invoice, Payment Entry, GL Entry |\n| Stock | Stock Entry, Delivery Note, Purchase Receipt, Item |\n| Selling | Quotation, Sales Order, Customer |\n| Buying | Purchase Order, Supplier, RFQ |\n| Manufacturing | BOM, Work Order, Job Card |\n| HR | Employee, Salary Slip, Leave Application |\n| CRM | Lead, Opportunity |\n| Projects | Project, Task, Timesheet |\n| Assets | Asset, Depreciation |\n\n## Common Customizations\n\n1. **\"Add custom field to Sales Invoice for tracking\"**\n   → Custom field definition + fixture\n\n2. **\"Validate credit limit before Sales Order submission\"**\n   → Hook on before_submit\n\n3. **\"Auto-create Task when Opportunity is won\"**\n   → Hook on on_update with status check\n\n4. **\"Custom approval workflow for Purchase Orders\"**\n   → Workflow definition + custom fields for approvers\n\n5. **\"Add custom report for sales by channel\"**\n   → Script report with custom query\n\n6. **\"Modify print format to include custom fields\"**\n   → Custom print format template\n\n## Tools Available to Agent\n\n- **Glob**: Find ERPNext and custom app files\n- **Grep**: Search ERPNext patterns\n- **Read**: Read ERPNext source for extension points\n- **Write**: Create override files\n- **Edit**: Modify hooks.py, fixtures\n- **Bash**: Export fixtures, run commands\n\n## File Locations\n\n```\nmy_app/\n├── hooks.py                    # Hook configuration\n├── fixtures/                   # Exported fixtures\n│   ├── custom_field.json\n│   └── property_setter.json\n├── install.py                  # Post-install setup\n└── my_module/\n    └── overrides/\n        ├── sales_invoice.py    # SI overrides\n        └── sales_order.py      # SO overrides\n```\n\n## Post-Implementation\n\n1. **Export Fixtures**\n   ```bash\n   bench --site <site> export-fixtures --app my_app\n   ```\n\n2. **Install/Reinstall App**\n   ```bash\n   bench --site <site> install-app my_app\n   # or\n   bench --site <site> migrate\n   ```\n\n3. **Clear Cache**\n   ```bash\n   bench --site <site> clear-cache\n   ```\n\n4. **Test Customization**\n   - Verify custom fields appear\n   - Test hook functions\n   - Validate workflow transitions"
              },
              {
                "name": "/frappe-frontend",
                "description": "Invoke the Frappe frontend agent for client-side JavaScript development including form scripts, dialogs, list views, and UI customization",
                "path": "plugins/frappe-fullstack/commands/frappe-frontend.md",
                "frontmatter": {
                  "description": "Invoke the Frappe frontend agent for client-side JavaScript development including form scripts, dialogs, list views, and UI customization",
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep, Task, TodoWrite",
                  "argument-hint": "<task_description>"
                },
                "content": "# Frappe Frontend Development\n\nYou are invoking the specialized Frappe frontend agent for client-side JavaScript development.\n\n## Request\n\n$ARGUMENTS\n\n## Agent Invocation\n\nUse the Task tool to spawn the `frappe-fullstack:frappe-frontend` agent with the following configuration:\n\n**IMPORTANT:** The agent name MUST be fully qualified: `frappe-fullstack:frappe-frontend`\n\n### Agent Prompt Template\n\n```\nYou are working on a Frappe/ERPNext frontend task.\n\n## Task\n{user's task description}\n\n## Context\n- Working directory: {current directory}\n- This is client-side JavaScript for Frappe Desk\n\n## Your Responsibilities\n\n1. **Analyze the Request**\n   - Understand what UI/UX functionality is needed\n   - Identify which DocTypes and forms are involved\n   - Determine if this is form script, dialog, or list customization\n\n2. **Explore the Codebase**\n   - Find existing client scripts for patterns\n   - Check for reusable dialog patterns\n   - Identify existing UI conventions\n\n3. **Implement the Solution**\n   - Write clean, well-documented JavaScript\n   - Follow Frappe client-side conventions\n   - Handle async operations properly\n   - Include proper error handling and user feedback\n\n4. **Provide Complete Code**\n   - Form event handlers (refresh, validate, field changes)\n   - Custom buttons and actions\n   - Dialogs and prompts\n   - frappe.call for server communication\n\n## Output Requirements\n- Provide complete, working JavaScript code\n- Include file paths (doctype.js location)\n- Explain any server-side APIs needed\n- Note if bench build is required\n```\n\n## Capabilities\n\nThe frappe-frontend agent excels at:\n\n### Form Scripts\n```javascript\nfrappe.ui.form.on('My DocType', {\n    refresh: function(frm) {\n        // Add buttons, toggle fields\n    },\n    validate: function(frm) {\n        // Client-side validation\n    },\n    field_name: function(frm) {\n        // Field change handler\n    }\n});\n```\n\n### Child Table Events\n```javascript\nfrappe.ui.form.on('My DocType Item', {\n    qty: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        row.amount = row.qty * row.rate;\n        frm.refresh_field('items');\n    }\n});\n```\n\n### Custom Buttons\n```javascript\nfrm.add_custom_button(__('Action'), function() {\n    // Button logic\n}, __('Actions'));\n```\n\n### Dialogs\n```javascript\nlet dialog = new frappe.ui.Dialog({\n    title: __('My Dialog'),\n    fields: [\n        {fieldname: 'field1', fieldtype: 'Data', label: 'Field 1'}\n    ],\n    primary_action: function(values) {\n        // Handle submission\n    }\n});\ndialog.show();\n```\n\n### Server Calls\n```javascript\nfrappe.call({\n    method: 'myapp.api.my_function',\n    args: { param: value },\n    freeze: true,\n    callback: function(r) {\n        // Handle response\n    }\n});\n```\n\n### Field Manipulation\n```javascript\n// Show/hide\nfrm.toggle_display('fieldname', condition);\n\n// Required\nfrm.toggle_reqd('fieldname', condition);\n\n// Read-only\nfrm.set_df_property('fieldname', 'read_only', 1);\n\n// Set query for Link field\nfrm.set_query('customer', function() {\n    return { filters: { status: 'Active' } };\n});\n```\n\n## Common Tasks\n\n1. **\"Add button to create follow-up task\"**\n   → Custom button with dialog for task details\n\n2. **\"Show/hide fields based on document type selection\"**\n   → Field change handler with toggle_display\n\n3. **\"Auto-calculate totals when qty or rate changes\"**\n   → Child table field events\n\n4. **\"Validate that end date is after start date\"**\n   → validate event with frappe.throw\n\n5. **\"Fetch customer details when customer is selected\"**\n   → Field change with frappe.call\n\n6. **\"Add custom filter to link field\"**\n   → set_query with dynamic filters\n\n## Tools Available to Agent\n\n- **Glob**: Find JavaScript files\n- **Grep**: Search for existing patterns\n- **Read**: Read existing client scripts\n- **Write**: Create new files\n- **Edit**: Modify existing code\n- **Bash**: Check file structure, run bench build\n\n## File Locations\n\n```\nmy_app/\n└── my_module/\n    └── doctype/\n        └── my_doctype/\n            └── my_doctype.js    # Form script\n```\n\nFor list view:\n```\nmy_app/\n└── my_module/\n    └── doctype/\n        └── my_doctype/\n            └── my_doctype_list.js    # List script\n```\n\n## Post-Implementation\n\nAfter the agent completes:\n\n1. **Build Assets** (if new files created)\n   ```bash\n   bench build --app my_app\n   ```\n\n2. **Clear Cache**\n   ```bash\n   bench --site <site> clear-cache\n   ```\n\n3. **Hard Refresh Browser**\n   - Ctrl+Shift+R to reload without cache\n\n4. **Check Browser Console**\n   - F12 → Console for JavaScript errors"
              },
              {
                "name": "/frappe-fullstack",
                "description": "Invoke multiple Frappe agents in parallel for full-stack development - coordinates backend, frontend, and architecture agents for complete feature implementation",
                "path": "plugins/frappe-fullstack/commands/frappe-fullstack.md",
                "frontmatter": {
                  "description": "Invoke multiple Frappe agents in parallel for full-stack development - coordinates backend, frontend, and architecture agents for complete feature implementation",
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep, Task, TodoWrite, AskUserQuestion",
                  "argument-hint": "<feature_description>"
                },
                "content": "# Frappe Full-Stack Development\n\nOrchestrate multiple specialized agents to build complete features across the full Frappe stack.\n\n## Request\n\n$ARGUMENTS\n\n## Orchestration Strategy\n\nThis command coordinates multiple agents working in parallel for comprehensive feature development.\n\n### Phase 1: Understanding & Planning\n\nFirst, understand the scope:\n\n1. **Analyze the Feature Request**\n   - What data needs to be stored? (DocType design)\n   - What backend logic is needed? (Controllers, APIs)\n   - What UI/UX is required? (Form scripts, dialogs)\n   - Is ERPNext integration needed? (Customizations, hooks)\n\n2. **Create Todo List**\n   Use TodoWrite to track:\n   - [ ] DocType/data model design\n   - [ ] Backend implementation\n   - [ ] Frontend implementation\n   - [ ] Integration/hooks (if needed)\n   - [ ] Testing\n\n### Phase 2: Parallel Agent Invocation\n\nLaunch agents in parallel using multiple Task tool calls in a single message.\n\n**IMPORTANT:** Agent names MUST be fully qualified with plugin prefix:\n- `frappe-fullstack:doctype-architect`\n- `frappe-fullstack:frappe-backend`\n- `frappe-fullstack:frappe-frontend`\n- `frappe-fullstack:erpnext-customizer`\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│                    PARALLEL EXECUTION                        │\n├─────────────────┬─────────────────┬─────────────────────────┤\n│ frappe-fullstack│ frappe-fullstack│ frappe-fullstack:       │\n│ :doctype-       │ :frappe-backend │ frappe-frontend         │\n│ architect       │                 │                         │\n│                 │                 │                         │\n│ • Design schema │ • Controllers   │ • Form scripts          │\n│ • Field types   │ • APIs          │ • Dialogs               │\n│ • Relationships │ • Validation    │ • Field handlers        │\n│ • Permissions   │ • Background    │ • Custom buttons        │\n└─────────────────┴─────────────────┴─────────────────────────┘\n```\n\n### Agent Prompts\n\n#### DocType Architect Agent\n```\nDesign the data model for: {feature description}\n\nRequirements:\n- Identify all entities/DocTypes needed\n- Define fields with appropriate types\n- Establish relationships (Link, Table)\n- Set up naming conventions\n- Define permissions\n\nOutput:\n- Complete DocType JSON(s)\n- Relationship diagram (text)\n- Field specifications\n```\n\n#### Backend Agent\n```\nImplement server-side logic for: {feature description}\n\nThe DocType structure is: {from architect agent or existing}\n\nRequirements:\n- Controller methods (validate, lifecycle hooks)\n- Whitelisted APIs for frontend\n- Database queries if complex\n- Background jobs if long-running\n- Email/notification logic\n\nOutput:\n- Complete Python controller\n- API functions\n- hooks.py updates if needed\n```\n\n#### Frontend Agent\n```\nImplement client-side functionality for: {feature description}\n\nThe DocType and APIs are: {from other agents or existing}\n\nRequirements:\n- Form script with event handlers\n- Custom buttons for actions\n- Dialogs for user input\n- Field visibility/requirement logic\n- frappe.call to backend APIs\n\nOutput:\n- Complete JavaScript form script\n- Any list view customizations\n- Dialog implementations\n```\n\n### Phase 3: Integration\n\nAfter parallel agents complete:\n\n1. **Merge Outputs**\n   - Combine all generated code\n   - Resolve any conflicts\n   - Ensure API names match between frontend/backend\n\n2. **Add ERPNext Integration** (if needed)\n   Spawn `frappe-fullstack:erpnext-customizer` agent for:\n   - Custom fields on stock DocTypes\n   - Hooks configuration\n   - after_migrate setup (preferred over fixtures)\n\n3. **Create Files**\n   Write all files to appropriate locations:\n   ```\n   my_app/\n   └── my_module/\n       └── doctype/\n           └── my_doctype/\n               ├── my_doctype.json    # From architect\n               ├── my_doctype.py      # From backend\n               ├── my_doctype.js      # From frontend\n               └── test_my_doctype.py # Tests\n   ```\n\n### Phase 4: Finalization\n\n1. **Update hooks.py** if needed\n2. **Run Migration**\n   ```bash\n   bench --site <site> migrate\n   ```\n3. **Build Assets**\n   ```bash\n   bench build --app <app>\n   ```\n4. **Clear Cache**\n   ```bash\n   bench --site <site> clear-cache\n   ```\n\n## Example Workflows\n\n### Example 1: \"Create a customer feedback system\"\n\n**Parallel Agents:**\n\n1. **doctype-architect**: Designs \"Customer Feedback\" DocType\n   - Fields: customer, rating, category, description, status, assigned_to\n   - Child table for follow-up actions\n\n2. **frappe-backend**: Implements\n   - Validation (rating 1-5)\n   - Auto-assign based on category\n   - Email notification on submission\n   - API to get feedback statistics\n\n3. **frappe-frontend**: Creates\n   - Star rating widget\n   - Category-based field visibility\n   - \"Resolve\" button for assigned user\n   - Dashboard statistics display\n\n### Example 2: \"Add approval workflow to purchase requests\"\n\n**Parallel Agents:**\n\n1. **doctype-architect**: Modifies/creates\n   - Approval fields (approved_by, approval_date, rejection_reason)\n   - Status field with workflow states\n\n2. **frappe-backend**: Implements\n   - Permission checks for approval\n   - Email to approver on submission\n   - Budget validation before approval\n   - API for bulk approval\n\n3. **frappe-frontend**: Creates\n   - Approve/Reject buttons (conditional)\n   - Rejection reason dialog\n   - Status indicator colors\n   - Pending approvals list filter\n\n4. **erpnext-customizer** (if extending ERPNext):\n   - Custom fields on Material Request\n   - Workflow definition\n   - Role permissions\n\n## Agent Coordination Tips\n\n1. **Share Context**: Pass DocType definitions from architect to other agents\n2. **Consistent Naming**: Ensure API method names match between frontend/backend\n3. **Handle Dependencies**: Backend APIs must exist before frontend can call them\n4. **Test Incrementally**: Verify each layer works before integrating\n\n## Tools Available\n\n| Tool | Purpose |\n|------|---------|\n| Task | Spawn specialized agents |\n| TodoWrite | Track progress |\n| Glob | Find files |\n| Grep | Search code |\n| Read | Read existing code |\n| Write | Create files |\n| Edit | Modify files |\n| Bash | Run commands |\n| AskUserQuestion | Clarify requirements |\n\n## Output Checklist\n\nAfter completion, verify:\n\n- [ ] DocType JSON created/modified\n- [ ] Python controller implemented\n- [ ] JavaScript form script implemented\n- [ ] APIs accessible from frontend\n- [ ] hooks.py updated (if needed)\n- [ ] Migration successful\n- [ ] Assets built\n- [ ] Cache cleared\n- [ ] Feature tested in browser"
              },
              {
                "name": "/frappe-github",
                "description": "Manage Git workflows - create branches, commit changes, push, and create PRs following team conventions",
                "path": "plugins/frappe-fullstack/commands/frappe-github.md",
                "frontmatter": {
                  "description": "Manage Git workflows - create branches, commit changes, push, and create PRs following team conventions"
                },
                "content": "# GitHub Workflow Command\n\nYou are helping the user with Git and GitHub operations for their Frappe/ERPNext project.\n\n## Task: $ARGUMENTS\n\nUse the `frappe-fullstack:github-workflow` agent to handle this request.\n\n**IMPORTANT:** The agent name MUST be fully qualified: `frappe-fullstack:github-workflow`\n\nThe agent will:\n\n1. **For branch creation**: Ask for task ID and description, create branch from default branch\n2. **For commits**: Stage changes and commit WITHOUT co-author or generated footers\n3. **For PRs**: Create pull request with proper format\n\n## Branch Naming Convention\nFormat: `{task-id}-{short-description}`\n- Example: `123-payment-api`, `456-fix-validation`\n\n## Commit Standards\n- No co-authored-by lines\n- No \"Generated with Claude Code\" footers\n- Clear, descriptive messages\n\n## Common Operations\n\n**Create branch:**\n```\n/frappe-github create branch\n```\n\n**Commit changes:**\n```\n/frappe-github commit\n```\n\n**Push to remote:**\n```\n/frappe-github push\n```\n\n**Create PR:**\n```\n/frappe-github create pr\n```\n\n**Full workflow:**\n```\n/frappe-github I need to create a branch, commit my changes, and create a PR\n```\n\nInvoke the `frappe-fullstack:github-workflow` agent to handle the user's request. Ask for task ID and description if creating a branch. Follow all team conventions for commits and PRs."
              },
              {
                "name": "/frappe-plan",
                "description": "Create a comprehensive implementation plan for Frappe/ERPNext features with technical design, task breakdown, and documentation. Saves plan to a markdown file.",
                "path": "plugins/frappe-fullstack/commands/frappe-plan.md",
                "frontmatter": {
                  "description": "Create a comprehensive implementation plan for Frappe/ERPNext features with technical design, task breakdown, and documentation. Saves plan to a markdown file.",
                  "allowed-tools": "Bash, Read, Write, Edit, Glob, Grep, Task, TodoWrite, AskUserQuestion, EnterPlanMode, ExitPlanMode",
                  "argument-hint": "<feature_description>"
                },
                "content": "# Frappe Feature Planning\n\nCreate a comprehensive implementation plan for a Frappe/ERPNext feature or module.\n\n## Request\n\n$ARGUMENTS\n\n## IMPORTANT: Use Claude's Plan Mode\n\nThis command should use Claude's built-in plan mode for comprehensive planning:\n\n1. **Enter Plan Mode** - Use `EnterPlanMode` tool to enter planning mode\n2. **Explore & Design** - Use Glob, Grep, Read to analyze codebase\n3. **Ask Questions** - Use AskUserQuestion for clarifications\n4. **Write Plan** - Save to feature folder using Write tool\n5. **Exit Plan Mode** - Use `ExitPlanMode` for user approval\n\n## Process\n\n### Step 1: Enter Plan Mode\n\nFirst, use the `EnterPlanMode` tool to enter Claude's planning mode. This signals to the user that you're in a planning phase and will present a plan for approval.\n\n### Step 2: Determine Plan Location\n\nAsk the user where to save the plan:\n\n```\nUse AskUserQuestion to ask:\n\"Where should I create the feature folder for this plan?\"\n\nOptions:\n1. ./features/<feature-name>/\n2. ./docs/features/<feature-name>/\n3. Custom location (let me specify)\n```\n\nIf user selects custom, ask for the path.\n\n**Feature folder structure**:\n```\n<path>/<feature-name>/\n├── plan/\n│   └── PLAN.md          # The implementation plan\n├── backend/\n├── frontend/\n├── doctype/\n└── tests/\n```\n\n### Step 3: Invoke Planner Agent\n\nUse the Task tool to spawn the `frappe-fullstack:frappe-planner` agent:\n\n**IMPORTANT:** The agent name MUST be fully qualified: `frappe-fullstack:frappe-planner`\n\n```\n## Planning Task\n\nCreate a comprehensive implementation plan for:\n{user's feature description}\n\n## Context\n- Working directory: {current directory}\n- Explore the codebase to understand existing patterns\n- Ask clarifying questions before finalizing the plan\n\n## Required Sections\n\n1. **Overview & Requirements**\n   - What is being built\n   - Business requirements\n   - User stories/workflows\n\n2. **Technical Design**\n   - Data model (DocTypes, fields, relationships)\n   - Backend architecture (controllers, APIs, jobs)\n   - Frontend design (forms, dialogs, actions)\n   - Integration points\n\n3. **Implementation Plan**\n   - Phased task breakdown\n   - Dependencies between tasks\n   - File structure\n\n4. **Testing & Deployment**\n   - Testing strategy\n   - Migration steps\n   - Configuration needed\n\n## Process\n1. First, explore the codebase for existing patterns\n2. Ask clarifying questions about requirements\n3. Design the solution\n4. Create detailed implementation tasks\n5. Return the complete plan document\n```\n\n### Step 3: Clarifying Questions\n\nThe planner agent should ask questions about:\n\n**Functional Requirements:**\n- What are the core features needed?\n- What user roles will interact with this?\n- What workflows need to be supported?\n- Are there any approval processes?\n\n**Technical Requirements:**\n- Should this integrate with existing DocTypes?\n- Are there external API integrations?\n- What reports are needed?\n- Email/notification requirements?\n\n**ERPNext Specific (if applicable):**\n- Which ERPNext modules does this relate to?\n- Should it hook into existing ERPNext workflows?\n- Are there stock DocTypes to extend?\n\n### Step 4: Codebase Analysis\n\nThe agent will explore:\n\n```bash\n# Find existing DocTypes\nfind . -name \"*.json\" -path \"*/doctype/*\" | head -20\n\n# Check hooks.py for patterns\nfind . -name \"hooks.py\" | xargs cat\n\n# Find similar features\ngrep -r \"similar_keyword\" --include=\"*.py\" --include=\"*.js\"\n\n# Check existing APIs\ngrep -r \"@frappe.whitelist\" --include=\"*.py\"\n```\n\n### Step 5: Generate Plan Document\n\nCreate a comprehensive markdown document:\n\n```markdown\n# [Feature Name] Implementation Plan\n\n> Generated: [Date]\n> Status: Draft\n> Author: Claude (Frappe Planner)\n\n## 1. Overview\n\n### 1.1 Description\n[What is being built and why]\n\n### 1.2 Goals\n- Goal 1\n- Goal 2\n\n### 1.3 Success Criteria\n- [ ] Criteria 1\n- [ ] Criteria 2\n\n---\n\n## 2. Requirements\n\n### 2.1 Functional Requirements\n| ID | Requirement | Priority |\n|----|-------------|----------|\n| FR-1 | Description | High |\n| FR-2 | Description | Medium |\n\n### 2.2 User Stories\n- As a [role], I want to [action] so that [benefit]\n\n### 2.3 Non-Functional Requirements\n- Performance: ...\n- Security: ...\n- Scalability: ...\n\n---\n\n## 3. Technical Design\n\n### 3.1 Data Model\n\n#### DocType: [Name]\n**Purpose**: [Description]\n\n| Field | Type | Options | Required | Description |\n|-------|------|---------|----------|-------------|\n| field1 | Data | - | Yes | ... |\n| field2 | Link | Customer | Yes | ... |\n\n**Relationships**:\n- Links to: [DocType]\n- Child tables: [DocType]\n\n#### DocType: [Child Table Name]\n...\n\n### 3.2 Architecture\n\n```\n┌─────────────────┐     ┌─────────────────┐\n│   Frontend      │────▶│   Backend       │\n│   (Form/Dialog) │     │   (Controller)  │\n└─────────────────┘     └────────┬────────┘\n                                 │\n                        ┌────────▼────────┐\n                        │   Database      │\n                        └─────────────────┘\n```\n\n### 3.3 Backend Components\n\n#### Controllers\n- `my_doctype.py`: Validation, calculations, events\n\n#### APIs\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `myapp.api.create_record` | Creates new record |\n| GET | `myapp.api.get_dashboard` | Dashboard data |\n\n#### Background Jobs\n- `process_daily`: Runs daily at midnight\n\n### 3.4 Frontend Components\n\n#### Form Script (`my_doctype.js`)\n- Custom buttons: [List]\n- Field handlers: [List]\n- Dialogs: [List]\n\n#### List View\n- Indicators: [Status colors]\n- Filters: [Default filters]\n\n### 3.5 ERPNext Integration (if applicable)\n- Hooks: [doc_events, etc.]\n- Custom Fields: [On which DocTypes]\n- Workflows: [If any]\n\n---\n\n## 4. Implementation Plan\n\n### Phase 1: Foundation\n**Focus**: Data model and basic structure\n\n| # | Task | Files | Dependencies |\n|---|------|-------|--------------|\n| 1.1 | Create DocType JSON | `doctype/my_doctype/my_doctype.json` | None |\n| 1.2 | Create child table | `doctype/my_child/my_child.json` | 1.1 |\n| 1.3 | Run migration | - | 1.1, 1.2 |\n\n### Phase 2: Backend Logic\n**Focus**: Controllers and APIs\n\n| # | Task | Files | Dependencies |\n|---|------|-------|--------------|\n| 2.1 | Implement controller | `doctype/my_doctype/my_doctype.py` | Phase 1 |\n| 2.2 | Create APIs | `api.py` | 2.1 |\n| 2.3 | Add background jobs | `tasks.py`, `hooks.py` | 2.1 |\n\n### Phase 3: Frontend\n**Focus**: User interface\n\n| # | Task | Files | Dependencies |\n|---|------|-------|--------------|\n| 3.1 | Create form script | `doctype/my_doctype/my_doctype.js` | Phase 2 |\n| 3.2 | Add custom dialogs | `public/js/dialogs.js` | 3.1 |\n| 3.3 | Create list view | `doctype/my_doctype/my_doctype_list.js` | 3.1 |\n\n### Phase 4: Testing & Polish\n**Focus**: Quality and documentation\n\n| # | Task | Files | Dependencies |\n|---|------|-------|--------------|\n| 4.1 | Write unit tests | `test_my_doctype.py` | Phase 2, 3 |\n| 4.2 | Integration testing | - | 4.1 |\n| 4.3 | Documentation | `README.md` | All |\n\n---\n\n## 5. File Structure\n\n```\nmy_app/\n├── my_module/\n│   ├── doctype/\n│   │   ├── my_doctype/\n│   │   │   ├── my_doctype.json\n│   │   │   ├── my_doctype.py\n│   │   │   ├── my_doctype.js\n│   │   │   └── test_my_doctype.py\n│   │   └── my_child/\n│   │       └── my_child.json\n│   └── api.py\n├── tasks.py\n├── hooks.py (updates)\n└── public/\n    └── js/\n        └── dialogs.js\n```\n\n---\n\n## 6. Testing Strategy\n\n### Unit Tests\n- [ ] Test validation rules\n- [ ] Test calculations\n- [ ] Test API responses\n\n### Integration Tests\n- [ ] Test complete workflows\n- [ ] Test with ERPNext (if applicable)\n\n### Manual Testing\n- [ ] Form submission flow\n- [ ] Error handling\n- [ ] Permission checks\n\n---\n\n## 7. Deployment\n\n### Pre-deployment\n1. Backup database\n2. Review migrations\n\n### Deployment Steps\n```bash\n# 1. Pull latest code\ngit pull\n\n# 2. Run migrations\nbench --site <site> migrate\n\n# 3. Build assets\nbench build --app my_app\n\n# 4. Clear cache\nbench --site <site> clear-cache\n\n# 5. Restart (production)\nsudo supervisorctl restart all\n```\n\n### Post-deployment\n- [ ] Verify migrations ran\n- [ ] Test core functionality\n- [ ] Monitor error logs\n\n---\n\n## 8. Open Questions\n\n- [ ] Question 1?\n- [ ] Question 2?\n\n---\n\n## 9. References\n\n- Similar feature: [Link/Path]\n- ERPNext docs: [Link]\n- Related DocTypes: [List]\n\n---\n\n## Appendix\n\n### A. Mockups/Wireframes\n[If any]\n\n### B. Sample Data\n[If any]\n\n### C. Change Log\n| Date | Change | Author |\n|------|--------|--------|\n| [Date] | Initial plan | Claude |\n```\n\n### Step 6: Save the Plan\n\nWrite the plan to the feature folder:\n\n```python\n# Use Write tool to save\nfile_path = \"<feature-folder>/plan/PLAN.md\"\n```\n\n### Step 7: Exit Plan Mode\n\n**IMPORTANT:** After writing the plan file, use `ExitPlanMode` tool to:\n1. Signal that planning is complete\n2. Present the plan to user for approval\n3. User will review and approve before implementation begins\n\n### Step 8: Summary\n\nAfter user approves the plan, provide:\n\n1. **Plan Location**: Where the file was saved\n2. **Quick Summary**: Key decisions and structure\n3. **Next Steps**: How to start implementation\n4. **Commands to Use**:\n   ```\n   /frappe-fullstack:frappe-doctype-create [DocType] [module]\n   /frappe-fullstack:frappe-backend [task]\n   /frappe-fullstack:frappe-frontend [task]\n   ```\n\n## Output\n\nThe command produces:\n\n1. **Saved Plan File**: Comprehensive markdown document in feature folder\n2. **User Approval**: Plan mode ensures user reviews and approves\n3. **Console Summary**:\n   - Plan saved to: `<feature-folder>/plan/PLAN.md`\n   - Key components identified\n   - Implementation phases overview\n   - Suggested next commands\n\n## Tips\n\n- Use `/frappe-plan` before starting any significant feature\n- Plan mode ensures user reviews before implementation\n- Review and refine the plan with stakeholders\n- Update the plan as requirements evolve\n- Reference the plan during implementation with `/frappe-fullstack`"
              },
              {
                "name": "/frappe-test",
                "description": null,
                "path": "plugins/frappe-fullstack/commands/frappe-test.md",
                "frontmatter": null,
                "content": "---\ndescription: Run Frappe tests with various options including specific DocTypes, modules, apps, and coverage reporting\nallowed-tools: Bash, Read, Grep, Glob\nargument-hint: [app_name] [--doctype <name>] [--module <name>] [--coverage]\n---\n\n# Run Frappe Tests\n\nExecute Frappe test suites with various filtering and reporting options.\n\n## Arguments\n\nParse the user's input: $ARGUMENTS\n\n- **app_name**: (Optional) App to test\n- **--doctype**: Test specific DocType\n- **--module**: Test specific module\n- **--coverage**: Generate coverage report\n- **--parallel**: Run tests in parallel\n- **--failfast**: Stop on first failure\n\n## Process\n\n### Step 1: Detect Environment\n\n```bash\n# Find site\ncat sites/currentsite.txt 2>/dev/null || echo \"No default site\"\n\n# List available apps\nls apps/\n```\n\n### Step 2: Determine Test Scope\n\nBased on arguments, determine what to test:\n- All tests (no arguments)\n- App tests (`--app erpnext`)\n- Module tests (`--module erpnext.accounts`)\n- DocType tests (`--doctype \"Sales Invoice\"`)\n\n### Step 3: Run Tests\n\n#### All Tests\n```bash\nbench --site <sitename> run-tests\n```\n\n#### App Tests\n```bash\nbench --site <sitename> run-tests --app my_app\n```\n\n#### Module Tests\n```bash\nbench --site <sitename> run-tests --module my_app.my_module.doctype.my_doctype\n```\n\n#### DocType Tests\n```bash\nbench --site <sitename> run-tests --doctype \"My DocType\"\n```\n\n#### With Coverage\n```bash\nbench --site <sitename> run-tests --app my_app --coverage\n```\n\n#### Parallel Tests\n```bash\nbench --site <sitename> run-tests --app my_app --parallel\n```\n\n#### Skip Test Data Setup\n```bash\nbench --site <sitename> run-tests --app my_app --skip-setup\n```\n\n### Step 4: Analyze Results\n\nParse test output for:\n- Passed tests\n- Failed tests\n- Errors\n- Skipped tests\n- Coverage percentage (if enabled)\n\n## Test File Structure\n\n```\nmy_app/\n└── my_module/\n    └── doctype/\n        └── my_doctype/\n            └── test_my_doctype.py\n```\n\n## Writing Tests\n\n### Basic Test\n```python\n# test_my_doctype.py\nimport frappe\nfrom frappe.tests.utils import FrappeTestCase\n\n\nclass TestMyDocType(FrappeTestCase):\n    def setUp(self):\n        \"\"\"Run before each test\"\"\"\n        self.doc = make_test_doc()\n\n    def tearDown(self):\n        \"\"\"Run after each test\"\"\"\n        frappe.db.rollback()\n\n    def test_create_document(self):\n        \"\"\"Test document creation\"\"\"\n        doc = frappe.get_doc({\n            \"doctype\": \"My DocType\",\n            \"field1\": \"value1\"\n        })\n        doc.insert()\n\n        self.assertTrue(doc.name)\n        self.assertEqual(doc.field1, \"value1\")\n\n    def test_validate_required_field(self):\n        \"\"\"Test that required field raises error\"\"\"\n        doc = frappe.get_doc({\n            \"doctype\": \"My DocType\"\n            # Missing required field\n        })\n\n        with self.assertRaises(frappe.MandatoryError):\n            doc.insert()\n\n    def test_calculation(self):\n        \"\"\"Test amount calculation\"\"\"\n        doc = frappe.get_doc({\n            \"doctype\": \"My DocType\",\n            \"qty\": 10,\n            \"rate\": 100\n        })\n        doc.insert()\n\n        self.assertEqual(doc.amount, 1000)\n```\n\n### Test with Fixtures\n```python\n# test_records.json (in same directory)\n[\n    {\n        \"doctype\": \"My DocType\",\n        \"name\": \"TEST-001\",\n        \"field1\": \"Test Value\"\n    }\n]\n```\n\n```python\n# test_my_doctype.py\nclass TestMyDocType(FrappeTestCase):\n    def test_with_fixture(self):\n        \"\"\"Test using fixture data\"\"\"\n        doc = frappe.get_doc(\"My DocType\", \"TEST-001\")\n        self.assertEqual(doc.field1, \"Test Value\")\n```\n\n### Test API Endpoints\n```python\nclass TestMyAPI(FrappeTestCase):\n    def test_whitelisted_method(self):\n        \"\"\"Test API endpoint\"\"\"\n        from my_app.api import get_data\n\n        result = get_data(\"param1\")\n\n        self.assertIsNotNone(result)\n        self.assertIn(\"key\", result)\n\n    def test_api_permissions(self):\n        \"\"\"Test API requires login\"\"\"\n        frappe.set_user(\"Guest\")\n\n        with self.assertRaises(frappe.PermissionError):\n            from my_app.api import protected_method\n            protected_method()\n\n        frappe.set_user(\"Administrator\")\n```\n\n### Test Document Events\n```python\nclass TestMyDocTypeEvents(FrappeTestCase):\n    def test_on_submit(self):\n        \"\"\"Test submit creates linked document\"\"\"\n        doc = make_test_doc()\n        doc.insert()\n        doc.submit()\n\n        # Check linked document was created\n        linked = frappe.get_all(\"Linked DocType\",\n            filters={\"reference\": doc.name})\n\n        self.assertEqual(len(linked), 1)\n\n    def test_on_cancel_reverses(self):\n        \"\"\"Test cancel reverses changes\"\"\"\n        doc = make_test_doc()\n        doc.insert()\n        doc.submit()\n\n        original_value = get_related_value()\n\n        doc.cancel()\n\n        new_value = get_related_value()\n        self.assertNotEqual(original_value, new_value)\n```\n\n## Test Utilities\n\n### Create Test Records\n```python\ndef make_test_doc(**kwargs):\n    \"\"\"Helper to create test documents\"\"\"\n    doc = frappe.get_doc({\n        \"doctype\": \"My DocType\",\n        \"field1\": kwargs.get(\"field1\", \"Default\"),\n        \"field2\": kwargs.get(\"field2\", \"Default\")\n    })\n    return doc\n\n\ndef make_test_customer():\n    \"\"\"Create test customer\"\"\"\n    if not frappe.db.exists(\"Customer\", \"_Test Customer\"):\n        doc = frappe.get_doc({\n            \"doctype\": \"Customer\",\n            \"customer_name\": \"_Test Customer\",\n            \"customer_type\": \"Company\"\n        })\n        doc.insert()\n    return frappe.get_doc(\"Customer\", \"_Test Customer\")\n```\n\n### Assertions\n```python\n# Common assertions\nself.assertEqual(a, b)\nself.assertNotEqual(a, b)\nself.assertTrue(condition)\nself.assertFalse(condition)\nself.assertIsNone(value)\nself.assertIsNotNone(value)\nself.assertIn(item, container)\nself.assertNotIn(item, container)\nself.assertRaises(ExceptionType, callable, *args)\nself.assertAlmostEqual(a, b, places=2)\n```\n\n### Test Context Managers\n```python\nfrom frappe.tests.utils import change_settings\n\nclass TestWithSettings(FrappeTestCase):\n    def test_with_changed_settings(self):\n        with change_settings(\"Selling Settings\", {\n            \"allow_negative_stock\": 1\n        }):\n            # Test with changed settings\n            pass\n        # Settings restored after context\n```\n\n## Coverage Report\n\n```bash\n# Generate coverage\nbench --site <sitename> run-tests --app my_app --coverage\n\n# View coverage report\n# HTML report in htmlcov/index.html\n```\n\n## Debugging Tests\n\n### Run with Verbose Output\n```bash\nbench --site <sitename> run-tests --app my_app -v\n```\n\n### Run Single Test\n```bash\nbench --site <sitename> run-tests \\\n    --module my_app.my_module.doctype.my_doctype.test_my_doctype \\\n    --test test_create_document\n```\n\n### Debug in Console\n```bash\nbench --site <sitename> console\n```\n\n```python\n# In console\nfrom my_app.my_module.doctype.my_doctype.test_my_doctype import TestMyDocType\n\ntest = TestMyDocType()\ntest.setUp()\ntest.test_create_document()  # Run specific test\n```\n\n## Common Test Patterns\n\n### Test Permissions\n```python\ndef test_user_cannot_access(self):\n    frappe.set_user(\"test_user@example.com\")\n\n    with self.assertRaises(frappe.PermissionError):\n        frappe.get_doc(\"Restricted DocType\", \"DOC-001\")\n\n    frappe.set_user(\"Administrator\")\n```\n\n### Test Validation\n```python\ndef test_date_validation(self):\n    doc = make_test_doc()\n    doc.start_date = \"2024-01-15\"\n    doc.end_date = \"2024-01-10\"  # Before start\n\n    with self.assertRaises(frappe.ValidationError):\n        doc.insert()\n```\n\n### Test Background Jobs\n```python\ndef test_enqueued_job(self):\n    from my_app.tasks import my_task\n\n    # Run synchronously for testing\n    result = my_task(param=\"value\")\n\n    self.assertEqual(result, expected_value)\n```\n\n## Output\n\nAfter running tests, provide:\n1. Summary: passed/failed/errors\n2. Failed test details\n3. Coverage percentage (if requested)\n4. Suggestions for fixing failures\n"
              }
            ],
            "skills": [
              {
                "name": "bench-commands",
                "description": "Frappe Bench CLI command reference for site management, app management, development, and production operations. Use when running bench commands, managing sites, migrations, builds, or deployments.",
                "path": "plugins/frappe-fullstack/skills/bench-commands/SKILL.md",
                "frontmatter": {
                  "name": "bench-commands",
                  "description": "Frappe Bench CLI command reference for site management, app management, development, and production operations. Use when running bench commands, managing sites, migrations, builds, or deployments."
                },
                "content": "# Bench CLI Commands Reference\n\nComplete reference for the Frappe Bench command-line interface for managing Frappe/ERPNext installations.\n\n## When to Use This Skill\n\n- Running bench commands for development\n- Managing Frappe sites\n- Installing and updating apps\n- Running migrations and builds\n- Setting up production environments\n- Troubleshooting common issues\n\n## Bench Directory Structure\n\n```\nfrappe-bench/\n├── apps/                   # Frappe apps\n│   ├── frappe/            # Core framework\n│   ├── erpnext/           # ERPNext (if installed)\n│   └── my_app/            # Custom apps\n├── sites/                  # Sites directory\n│   ├── common_site_config.json\n│   ├── apps.txt           # List of installed apps\n│   └── my_site.local/     # Individual site\n│       ├── site_config.json\n│       ├── private/\n│       └── public/\n├── config/                 # Configuration files\n├── logs/                   # Log files\n├── env/                    # Python virtual environment\n└── node_modules/          # Node.js dependencies\n```\n\n## Site Management\n\n### Create Site\n```bash\n# Create new site\nbench new-site mysite.local\n\n# With specific database\nbench new-site mysite.local --db-name mysite_db\n\n# With MariaDB root password\nbench new-site mysite.local --mariadb-root-password mypassword\n\n# With admin password\nbench new-site mysite.local --admin-password admin123\n\n# From SQL file\nbench new-site mysite.local --source_sql /path/to/backup.sql\n\n# Skip creating default user\nbench new-site mysite.local --no-mariadb-socket\n```\n\n### Use Site\n```bash\n# Set default site\nbench use mysite.local\n\n# Run command on specific site\nbench --site mysite.local migrate\n\n# Run on all sites\nbench --site all migrate\n```\n\n### Site Operations\n```bash\n# List all sites\nbench list-sites\n\n# Drop site (delete)\nbench drop-site mysite.local\n\n# Drop with force\nbench drop-site mysite.local --force\n\n# Set site maintenance mode\nbench --site mysite.local set-maintenance-mode on\nbench --site mysite.local set-maintenance-mode off\n\n# Disable scheduler\nbench --site mysite.local disable-scheduler\nbench --site mysite.local enable-scheduler\n```\n\n### Backup & Restore\n```bash\n# Backup site\nbench --site mysite.local backup\n\n# Backup with files\nbench --site mysite.local backup --with-files\n\n# Backup all sites\nbench --site all backup\n\n# Restore from backup\nbench --site mysite.local restore /path/to/backup.sql.gz\n\n# Restore with files\nbench --site mysite.local restore /path/to/backup.sql.gz \\\n  --with-private-files /path/to/private.tar \\\n  --with-public-files /path/to/public.tar\n```\n\n## App Management\n\n### Get Apps\n```bash\n# Get app from GitHub\nbench get-app https://github.com/frappe/erpnext\n\n# Get specific branch\nbench get-app https://github.com/frappe/erpnext --branch version-14\n\n# Get specific tag\nbench get-app https://github.com/frappe/erpnext --tag v14.0.0\n\n# Get from local path\nbench get-app /path/to/my_app\n\n# Get and install on all sites\nbench get-app erpnext --install-all\n```\n\n### Install/Uninstall Apps\n```bash\n# Install app on site\nbench --site mysite.local install-app erpnext\n\n# Install app on all sites\nbench --site all install-app my_app\n\n# Uninstall app\nbench --site mysite.local uninstall-app my_app\n\n# Uninstall with force (removes data)\nbench --site mysite.local uninstall-app my_app --yes --force\n```\n\n### Create New App\n```bash\n# Create new app\nbench new-app my_app\n\n# App will be created in apps/ directory with:\n# - my_app/my_app/\n# - hooks.py\n# - modules.txt\n# - patches.txt\n# - requirements.txt\n```\n\n### Update Apps\n```bash\n# Update all apps\nbench update\n\n# Update without migrations\nbench update --no-migrations\n\n# Update specific app\nbench update --apps erpnext\n\n# Update without pulling\nbench update --no-pull\n\n# Update without building assets\nbench update --no-build\n\n# Reset to fresh install\nbench update --reset\n```\n\n### Remove App\n```bash\n# Remove app from bench (not from sites)\nbench remove-app my_app\n\n# Remove from site first\nbench --site mysite.local uninstall-app my_app\nbench remove-app my_app\n```\n\n## Development Commands\n\n### Start Development Server\n```bash\n# Start development server (web + redis + scheduler)\nbench start\n\n# Start with specific workers\nbench start --procfile Procfile.dev\n\n# Start only web server\nbench serve\n\n# Start on specific port\nbench serve --port 8001\n```\n\n### Build Assets\n```bash\n# Build assets (JS/CSS)\nbench build\n\n# Build specific app\nbench build --app my_app\n\n# Build with verbose output\nbench build --verbose\n\n# Build production assets\nbench build --production\n\n# Build and minify\nbench build --make-copy\n\n# Watch for changes\nbench watch\n```\n\n### Migrate\n```bash\n# Run migrations\nbench --site mysite.local migrate\n\n# Migrate all sites\nbench --site all migrate\n\n# Migrate specific app\nbench --site mysite.local migrate --app my_app\n\n# Skip failing patches\nbench --site mysite.local migrate --skip-failing\n```\n\n### Clear Cache\n```bash\n# Clear cache\nbench --site mysite.local clear-cache\n\n# Clear all cache including redis\nbench --site mysite.local clear-website-cache\n\n# Clear redis cache\nbench clear-redis-cache\n```\n\n### Console\n```bash\n# Open Python console\nbench --site mysite.local console\n\n# In console:\n# >>> doc = frappe.get_doc(\"Customer\", \"CUST-001\")\n# >>> doc.customer_name\n# >>> frappe.db.sql(\"SELECT * FROM tabCustomer\")\n\n# Run Python script\nbench --site mysite.local execute myapp.scripts.my_function\n\n# Execute with arguments\nbench --site mysite.local execute myapp.scripts.my_function --args='[\"arg1\", \"arg2\"]'\n```\n\n### MariaDB Console\n```bash\n# Open MariaDB console\nbench --site mysite.local mariadb\n\n# Run SQL query\nbench --site mysite.local mariadb -e \"SELECT * FROM tabCustomer LIMIT 5\"\n```\n\n### Run Tests\n```bash\n# Run all tests\nbench --site mysite.local run-tests\n\n# Run tests for specific app\nbench --site mysite.local run-tests --app my_app\n\n# Run specific test\nbench --site mysite.local run-tests --module my_app.my_module.doctype.my_doctype.test_my_doctype\n\n# Run with coverage\nbench --site mysite.local run-tests --coverage\n\n# Run specific test class\nbench --site mysite.local run-tests --doctype \"My DocType\"\n\n# Run parallel tests\nbench --site mysite.local run-tests --parallel\n\n# Skip test setup\nbench --site mysite.local run-tests --skip-setup\n```\n\n### Translation\n```bash\n# Update translation files\nbench --site mysite.local update-translations\n\n# Export translations\nbench --site mysite.local export-translations\n\n# Import translations\nbench --site mysite.local import-translations /path/to/translations.csv\n```\n\n## Production Setup\n\n### Setup Production\n```bash\n# Setup for production (systemd, nginx, supervisor)\nsudo bench setup production frappe-user\n\n# Setup supervisor\nbench setup supervisor\n\n# Setup systemd\nbench setup systemd\n\n# Setup nginx\nbench setup nginx\n\n# Setup Redis\nbench setup redis\n\n# Setup fail2ban\nbench setup fail2ban\n```\n\n### SSL/Let's Encrypt\n```bash\n# Setup Let's Encrypt SSL\nsudo bench setup lets-encrypt mysite.local\n\n# Renew certificates\nsudo bench renew-lets-encrypt\n```\n\n### Restart Services\n```bash\n# Restart supervisor\nsudo supervisorctl restart all\n\n# Restart specific\nsudo supervisorctl restart frappe-bench-web:*\nsudo supervisorctl restart frappe-bench-workers:*\n\n# Restart systemd\nsudo systemctl restart frappe-bench-web\nsudo systemctl restart frappe-bench-schedule\n\n# Check status\nsudo supervisorctl status\n```\n\n## Scheduler & Workers\n\n### Scheduler\n```bash\n# Enable scheduler\nbench --site mysite.local enable-scheduler\n\n# Disable scheduler\nbench --site mysite.local disable-scheduler\n\n# Check scheduler status\nbench --site mysite.local show-scheduler-status\n\n# Run specific scheduled job\nbench --site mysite.local execute frappe.tasks.run_daily\n```\n\n### Background Jobs\n```bash\n# Show queued jobs\nbench --site mysite.local show-pending-jobs\n\n# Clear failed jobs\nbench --site mysite.local clear-website-cache\n\n# Run specific queue\nbench worker --queue default\nbench worker --queue short\nbench worker --queue long\n\n# Purge jobs\nbench --site mysite.local purge-jobs\n```\n\n## Configuration\n\n### Site Config\n```bash\n# Show site config\nbench --site mysite.local show-config\n\n# Set config value\nbench --site mysite.local set-config key value\n\n# Set config with JSON value\nbench --site mysite.local set-config limits '{\"users\": 10}'\n\n# Set common config (all sites)\nbench set-config key value\n\n# Remove config\nbench --site mysite.local remove-config key\n```\n\n### Common Configurations\n```python\n# site_config.json\n{\n    \"db_name\": \"mysite_db\",\n    \"db_password\": \"password\",\n    \"db_type\": \"mariadb\",\n    \"encryption_key\": \"xxxxx\",\n    \"developer_mode\": 0,\n    \"maintenance_mode\": 0,\n    \"pause_scheduler\": 0,\n    \"mail_server\": \"smtp.gmail.com\",\n    \"mail_port\": 587,\n    \"use_tls\": 1,\n    \"mail_login\": \"user@gmail.com\",\n    \"mail_password\": \"password\",\n    \"auto_email_id\": \"noreply@mysite.com\",\n    \"mute_emails\": 0,\n    \"enable_scheduler\": 1,\n    \"limits\": {\n        \"users\": 10,\n        \"emails\": 500,\n        \"space\": 5120\n    }\n}\n```\n\n### Bench Config\n```bash\n# Show bench config\nbench config list\n\n# Set bench config\nbench config set serve_port 8001\nbench config set redis_cache_port 13000\n\n# Common bench configs\nbench config set developer_mode 1\nbench config set webserver_port 8000\nbench config set background_workers 1\n```\n\n## Troubleshooting Commands\n\n### Logs\n```bash\n# View logs\ntail -f logs/frappe.log\ntail -f logs/web.error.log\ntail -f logs/worker.error.log\ntail -f logs/scheduler.error.log\n\n# Site-specific logs\ntail -f sites/mysite.local/logs/frappe.log\n```\n\n### Debug\n```bash\n# Check site health\nbench --site mysite.local doctor\n\n# Show database stats\nbench --site mysite.local show-db-size\n\n# Show table sizes\nbench --site mysite.local --db-type mariadb execute \\\n  \"SELECT table_name, data_length FROM information_schema.tables WHERE table_schema = 'mysite_db'\"\n\n# Check scheduled jobs\nbench --site mysite.local show-scheduler-status\n\n# Reset password\nbench --site mysite.local set-admin-password newpassword\n\n# Add system manager\nbench --site mysite.local add-system-manager user@example.com\n```\n\n### Fix Common Issues\n```bash\n# Rebuild search index\nbench --site mysite.local build-search-index\n\n# Reset desk customizations\nbench --site mysite.local reset-perms\n\n# Clear all locks\nbench --site mysite.local clear-locks\n\n# Reinstall\nbench --site mysite.local reinstall --yes\n\n# Partial restore\nbench --site mysite.local partial-restore /path/to/backup.sql\n```\n\n## Version Management\n\n```bash\n# Check versions\nbench version\n\n# Switch branch\nbench switch-to-branch version-14 frappe erpnext\n\n# Switch to develop\nbench switch-to-branch develop --upgrade\n\n# Set version\nbench set-bench-version 5.x\n```\n\n## Multi-Tenancy\n\n```bash\n# Setup multi-tenancy\nbench config dns_multitenant on\n\n# Add domain to site\nbench --site mysite.local add-domain newdomain.com\n\n# Remove domain\nbench --site mysite.local remove-domain newdomain.com\n\n# Setup wildcard SSL\nsudo certbot certonly --webroot -w /var/www/letsencrypt -d *.mydomain.com\n```\n\n## Common Workflows\n\n### Fresh Install\n```bash\n# Install bench\npip install frappe-bench\n\n# Initialize bench\nbench init frappe-bench\ncd frappe-bench\n\n# Get ERPNext\nbench get-app erpnext\n\n# Create site\nbench new-site mysite.local\n\n# Install ERPNext\nbench --site mysite.local install-app erpnext\n\n# Start development server\nbench start\n```\n\n### Daily Development\n```bash\n# Pull latest changes\nbench update --no-backup\n\n# Or step by step:\ncd apps/frappe && git pull\ncd apps/erpnext && git pull\nbench update --no-pull\n\n# Clear cache after code changes\nbench --site mysite.local clear-cache\n\n# Build assets\nbench build --app my_app\n```\n\n### Deploy Update\n```bash\n# On production server\ncd /home/frappe/frappe-bench\n\n# Set maintenance mode\nbench --site mysite.local set-maintenance-mode on\n\n# Backup\nbench --site mysite.local backup --with-files\n\n# Update\nbench update\n\n# Migrate\nbench --site mysite.local migrate\n\n# Build assets\nbench build --production\n\n# Clear cache\nbench --site mysite.local clear-cache\n\n# Restart\nsudo supervisorctl restart all\n\n# Disable maintenance mode\nbench --site mysite.local set-maintenance-mode off\n```"
              },
              {
                "name": "client-scripts",
                "description": "Frappe client-side JavaScript patterns for form events, field manipulation, dialogs, and UI customization. Use when writing form scripts, handling field changes, creating dialogs, or customizing the Frappe desk interface.",
                "path": "plugins/frappe-fullstack/skills/client-scripts/SKILL.md",
                "frontmatter": {
                  "name": "client-scripts",
                  "description": "Frappe client-side JavaScript patterns for form events, field manipulation, dialogs, and UI customization. Use when writing form scripts, handling field changes, creating dialogs, or customizing the Frappe desk interface."
                },
                "content": "# Frappe Client Scripts Reference\n\nComplete reference for client-side JavaScript development in Frappe Framework.\n\n## When to Use This Skill\n\n- Writing form scripts (refresh, validate, field events)\n- Manipulating form fields (show/hide, require, read-only)\n- Creating dialogs and prompts\n- Making API calls from client\n- Customizing list views\n- Adding custom buttons\n- Handling child table events\n\n## Form Script Location\n\n```\nmy_app/\n└── my_module/\n    └── doctype/\n        └── my_doctype/\n            └── my_doctype.js    # Client script\n```\n\n## Form Events\n\n### Complete Event Reference\n\n```javascript\nfrappe.ui.form.on('My DocType', {\n    // === LOAD EVENTS ===\n\n    setup: function(frm) {\n        // Called once when form is created (before data loads)\n        // Use for: setting queries, initializing variables\n        frm.set_query('customer', () => ({ filters: { status: 'Active' } }));\n    },\n\n    onload: function(frm) {\n        // Called when form data is loaded (before refresh)\n        // Use for: setting defaults for new docs\n        if (frm.is_new()) {\n            frm.set_value('posting_date', frappe.datetime.nowdate());\n        }\n    },\n\n    onload_post_render: function(frm) {\n        // Called after form is rendered\n        // Use for: DOM manipulation, focus setting\n        frm.get_field('customer').focus();\n    },\n\n    refresh: function(frm) {\n        // Called every time form refreshes\n        // Use for: custom buttons, field toggles, indicators\n        if (!frm.is_new()) {\n            frm.add_custom_button(__('Action'), () => do_action(frm));\n        }\n        frm.toggle_display('section_name', frm.doc.show_section);\n    },\n\n    // === SAVE EVENTS ===\n\n    validate: function(frm) {\n        // Called before save - return false to prevent\n        if (frm.doc.end_date < frm.doc.start_date) {\n            frappe.msgprint(__('End Date cannot be before Start Date'));\n            return false;\n        }\n    },\n\n    before_save: function(frm) {\n        // Called after validate, before server request\n        frm.doc.last_updated_by = frappe.session.user;\n    },\n\n    after_save: function(frm) {\n        // Called after successful save\n        frappe.show_alert({\n            message: __('Saved successfully'),\n            indicator: 'green'\n        });\n    },\n\n    // === WORKFLOW EVENTS ===\n\n    before_submit: function(frm) {\n        // Called before document submission\n    },\n\n    on_submit: function(frm) {\n        // Called after successful submission\n    },\n\n    before_cancel: function(frm) {\n        // Called before cancellation\n    },\n\n    after_cancel: function(frm) {\n        // Called after cancellation\n    },\n\n    // === FIELD EVENTS ===\n\n    customer: function(frm) {\n        // Called when 'customer' field changes\n        if (frm.doc.customer) {\n            fetch_customer_details(frm);\n        }\n    },\n\n    posting_date: function(frm) {\n        // Called when 'posting_date' field changes\n        calculate_due_date(frm);\n    }\n});\n```\n\n## Field Manipulation\n\n### Display Properties\n\n```javascript\n// Show/hide field\nfrm.toggle_display('fieldname', true);  // Show\nfrm.toggle_display('fieldname', false); // Hide\nfrm.toggle_display(['field1', 'field2'], condition);\n\n// Set read-only\nfrm.set_df_property('fieldname', 'read_only', 1);\nfrm.toggle_enable('fieldname', false);  // Disable\n\n// Set required\nfrm.set_df_property('fieldname', 'reqd', 1);\nfrm.toggle_reqd('fieldname', true);\nfrm.toggle_reqd(['field1', 'field2'], condition);\n\n// Set hidden\nfrm.set_df_property('fieldname', 'hidden', 1);\n\n// Change label\nfrm.set_df_property('fieldname', 'label', 'New Label');\n\n// Change description\nfrm.set_df_property('fieldname', 'description', 'Help text');\n\n// Change options (for Select)\nfrm.set_df_property('fieldname', 'options', 'Option1\\nOption2\\nOption3');\n\n// Refresh after changes\nfrm.refresh_field('fieldname');\nfrm.refresh_fields();\n```\n\n### Set Values\n\n```javascript\n// Set single value\nfrm.set_value('fieldname', value);\n\n// Set multiple values\nfrm.set_value({\n    'field1': 'value1',\n    'field2': 'value2',\n    'field3': 'value3'\n});\n\n// Set with callback\nfrm.set_value('fieldname', value).then(() => {\n    // After value is set\n});\n\n// Clear field\nfrm.set_value('fieldname', null);\nfrm.set_value('fieldname', '');\n\n// Set default value\nfrm.set_df_property('fieldname', 'default', 'default_value');\n```\n\n### Link Field Queries\n\n```javascript\n// Basic filter\nfrm.set_query('customer', function() {\n    return {\n        filters: {\n            status: 'Active',\n            customer_type: 'Company'\n        }\n    };\n});\n\n// Dynamic filter based on form values\nfrm.set_query('item_code', function() {\n    return {\n        filters: {\n            item_group: frm.doc.item_group,\n            is_stock_item: 1\n        }\n    };\n});\n\n// Filter in child table\nfrm.set_query('item_code', 'items', function(doc, cdt, cdn) {\n    let row = locals[cdt][cdn];\n    return {\n        filters: {\n            warehouse: row.warehouse || doc.default_warehouse\n        }\n    };\n});\n\n// Custom query (server method)\nfrm.set_query('supplier', function() {\n    return {\n        query: 'my_app.api.get_suppliers',\n        filters: {\n            region: frm.doc.region\n        }\n    };\n});\n\n// Clear query\nfrm.set_query('fieldname', null);\n```\n\n## Custom Buttons\n\n```javascript\nrefresh: function(frm) {\n    // Simple button\n    frm.add_custom_button(__('Do Something'), function() {\n        do_something(frm);\n    });\n\n    // Button in group/dropdown\n    frm.add_custom_button(__('Action 1'), function() {\n        action_1(frm);\n    }, __('Actions'));\n\n    frm.add_custom_button(__('Action 2'), function() {\n        action_2(frm);\n    }, __('Actions'));\n\n    // Primary button (highlighted)\n    frm.add_custom_button(__('Submit'), function() {\n        submit_doc(frm);\n    }).addClass('btn-primary');\n\n    // Button with icon\n    let btn = frm.add_custom_button(__('Print'), function() {\n        print_doc(frm);\n    });\n    btn.prepend('<i class=\"fa fa-print\"></i> ');\n\n    // Conditional buttons\n    if (frm.doc.status === 'Draft') {\n        frm.add_custom_button(__('Submit for Review'), function() {\n            submit_for_review(frm);\n        });\n    }\n\n    // Remove button\n    frm.remove_custom_button(__('Do Something'));\n    frm.remove_custom_button(__('Action 1'), __('Actions'));\n\n    // Clear all buttons\n    frm.clear_custom_buttons();\n\n    // Page actions\n    frm.page.set_primary_action(__('Save'), function() {\n        frm.save();\n    });\n\n    frm.page.set_secondary_action(__('Cancel'), function() {\n        frappe.set_route('List', 'My DocType');\n    });\n}\n```\n\n## Child Table Operations\n\n### Events\n\n```javascript\nfrappe.ui.form.on('My DocType Item', {\n    // Row added\n    items_add: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        row.warehouse = frm.doc.default_warehouse;\n        frm.refresh_field('items');\n    },\n\n    // Before row removed (can prevent)\n    before_items_remove: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        if (row.is_mandatory) {\n            frappe.throw(__('Cannot remove mandatory item'));\n        }\n    },\n\n    // Row removed\n    items_remove: function(frm, cdt, cdn) {\n        calculate_total(frm);\n    },\n\n    // Field in row changes\n    qty: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        row.amount = flt(row.qty) * flt(row.rate);\n        frm.refresh_field('items');\n        calculate_total(frm);\n    },\n\n    rate: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        row.amount = flt(row.qty) * flt(row.rate);\n        frm.refresh_field('items');\n        calculate_total(frm);\n    },\n\n    item_code: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        if (row.item_code) {\n            frappe.call({\n                method: 'my_app.api.get_item_details',\n                args: { item_code: row.item_code },\n                callback: function(r) {\n                    if (r.message) {\n                        frappe.model.set_value(cdt, cdn, {\n                            'rate': r.message.rate,\n                            'uom': r.message.uom,\n                            'description': r.message.description\n                        });\n                    }\n                }\n            });\n        }\n    }\n});\n\nfunction calculate_total(frm) {\n    let total = 0;\n    frm.doc.items.forEach(item => {\n        total += flt(item.amount);\n    });\n    frm.set_value('total', total);\n}\n```\n\n### Manipulating Rows\n\n```javascript\n// Add row\nlet row = frm.add_child('items', {\n    item_code: 'ITEM-001',\n    qty: 10,\n    rate: 100\n});\nfrm.refresh_field('items');\n\n// Get row by index\nlet first_row = frm.doc.items[0];\n\n// Get row by name\nlet row = locals['My DocType Item'][cdn];\n\n// Update row\nfrappe.model.set_value(cdt, cdn, 'fieldname', value);\nfrappe.model.set_value(cdt, cdn, {\n    'field1': 'value1',\n    'field2': 'value2'\n});\n\n// Remove row\nfrm.get_field('items').grid.grid_rows[0].remove();\nfrm.refresh_field('items');\n\n// Remove all rows\nfrm.clear_table('items');\nfrm.refresh_field('items');\n\n// Iterate rows\nfrm.doc.items.forEach((item, idx) => {\n    console.log(idx, item.item_code);\n});\n```\n\n## Dialogs\n\n### Simple Prompt\n\n```javascript\n// Single field\nfrappe.prompt(\n    {\n        fieldname: 'reason',\n        fieldtype: 'Small Text',\n        label: 'Reason',\n        reqd: 1\n    },\n    function(values) {\n        console.log(values.reason);\n    },\n    __('Enter Reason'),\n    __('Submit')\n);\n```\n\n### Multi-field Prompt\n\n```javascript\nfrappe.prompt([\n    {\n        fieldname: 'customer',\n        fieldtype: 'Link',\n        options: 'Customer',\n        label: 'Customer',\n        reqd: 1\n    },\n    {\n        fieldname: 'date',\n        fieldtype: 'Date',\n        label: 'Date',\n        default: frappe.datetime.nowdate()\n    },\n    {\n        fieldname: 'priority',\n        fieldtype: 'Select',\n        label: 'Priority',\n        options: 'Low\\nMedium\\nHigh',\n        default: 'Medium'\n    }\n], function(values) {\n    process_data(values);\n}, __('Enter Details'), __('Process'));\n```\n\n### Custom Dialog\n\n```javascript\nlet dialog = new frappe.ui.Dialog({\n    title: __('Custom Dialog'),\n    fields: [\n        {\n            fieldname: 'customer',\n            fieldtype: 'Link',\n            options: 'Customer',\n            label: __('Customer'),\n            reqd: 1,\n            get_query: function() {\n                return { filters: { status: 'Active' } };\n            },\n            change: function() {\n                // Field change handler\n                let value = dialog.get_value('customer');\n                if (value) {\n                    dialog.set_value('customer_name', 'Loading...');\n                }\n            }\n        },\n        { fieldtype: 'Column Break' },\n        {\n            fieldname: 'customer_name',\n            fieldtype: 'Data',\n            label: __('Customer Name'),\n            read_only: 1\n        },\n        { fieldtype: 'Section Break', label: 'Items' },\n        {\n            fieldname: 'items',\n            fieldtype: 'Table',\n            label: __('Items'),\n            cannot_add_rows: false,\n            in_place_edit: true,\n            fields: [\n                {\n                    fieldname: 'item',\n                    fieldtype: 'Link',\n                    options: 'Item',\n                    in_list_view: 1,\n                    label: __('Item')\n                },\n                {\n                    fieldname: 'qty',\n                    fieldtype: 'Float',\n                    in_list_view: 1,\n                    label: __('Qty')\n                }\n            ]\n        }\n    ],\n    size: 'large', // small, large, extra-large\n    primary_action_label: __('Submit'),\n    primary_action: function(values) {\n        console.log(values);\n        dialog.hide();\n        process_dialog(values);\n    },\n    secondary_action_label: __('Cancel')\n});\n\ndialog.show();\n\n// Set values\ndialog.set_value('customer', 'CUST-001');\ndialog.set_values({\n    'customer': 'CUST-001',\n    'date': frappe.datetime.nowdate()\n});\n\n// Get values\nlet values = dialog.get_values();\nlet customer = dialog.get_value('customer');\n\n// Access fields\nlet field = dialog.get_field('customer');\nfield.set_description('Select active customer');\n```\n\n### Confirmation Dialog\n\n```javascript\nfrappe.confirm(\n    __('Are you sure you want to delete this?'),\n    function() {\n        // On Yes\n        delete_record();\n    },\n    function() {\n        // On No (optional)\n    }\n);\n```\n\n## API Calls\n\n### frappe.call\n\n```javascript\n// Basic call\nfrappe.call({\n    method: 'my_app.api.get_data',\n    args: {\n        customer: frm.doc.customer\n    },\n    callback: function(r) {\n        if (r.message) {\n            frm.set_value('data', r.message);\n        }\n    }\n});\n\n// With loading indicator\nfrappe.call({\n    method: 'my_app.api.process',\n    args: { data: frm.doc },\n    freeze: true,\n    freeze_message: __('Processing...'),\n    callback: function(r) {\n        frappe.msgprint(__('Done!'));\n    },\n    error: function(r) {\n        frappe.msgprint(__('Error occurred'));\n    }\n});\n\n// Async/await\nasync function getData() {\n    const r = await frappe.call({\n        method: 'my_app.api.get_data',\n        args: { id: 123 }\n    });\n    return r.message;\n}\n\n// Promise chain\nfrappe.call({\n    method: 'my_app.api.get_data'\n}).then(r => {\n    return frappe.call({\n        method: 'my_app.api.process',\n        args: { data: r.message }\n    });\n}).then(r => {\n    console.log('Done', r.message);\n});\n```\n\n## Messages & Alerts\n\n```javascript\n// Toast alert\nfrappe.show_alert({\n    message: __('Success!'),\n    indicator: 'green'  // green, blue, orange, red\n}, 5);  // seconds\n\n// Message dialog\nfrappe.msgprint({\n    title: __('Information'),\n    message: __('This is important'),\n    indicator: 'blue'\n});\n\n// Error (stops execution)\nfrappe.throw(__('Cannot proceed'));\n\n// Confirmation required\nfrappe.validated = false;  // In validate event\n```\n\n## Utilities\n\n```javascript\n// Date/Time\nfrappe.datetime.nowdate();           // \"2024-01-15\"\nfrappe.datetime.now_datetime();      // \"2024-01-15 10:30:00\"\nfrappe.datetime.add_days(\"2024-01-15\", 7);\nfrappe.datetime.add_months(\"2024-01-15\", 1);\n\n// Formatting\nfrappe.format(1234.56, {fieldtype: 'Currency'});\nformat_currency(1234.56, 'USD');\nflt(value);  // Float\ncint(value); // Integer\n\n// Navigation\nfrappe.set_route('Form', 'Customer', 'CUST-001');\nfrappe.set_route('List', 'Customer');\nfrappe.new_doc('Customer');\n\n// Translation\n__('Translate this');\n__('Hello {0}', [name]);\n```"
              },
              {
                "name": "doctype-patterns",
                "description": "Frappe DocType creation patterns, field types, controller hooks, and data modeling best practices. Use when creating DocTypes, designing data models, adding fields, or setting up document relationships in Frappe/ERPNext.",
                "path": "plugins/frappe-fullstack/skills/doctype-patterns/SKILL.md",
                "frontmatter": {
                  "name": "doctype-patterns",
                  "description": "Frappe DocType creation patterns, field types, controller hooks, and data modeling best practices. Use when creating DocTypes, designing data models, adding fields, or setting up document relationships in Frappe/ERPNext."
                },
                "content": "# Frappe DocType Patterns\n\nComprehensive guide to creating and configuring DocTypes in Frappe Framework, the core building block for all Frappe applications.\n\n## When to Use This Skill\n\n- Creating new DocTypes\n- Adding or modifying fields on DocTypes\n- Designing data models and relationships\n- Setting up naming patterns and autoname\n- Configuring permissions and workflows\n- Creating child tables\n- Working with Virtual or Single DocTypes\n\n## DocType Directory Structure\n\nWhen you create a DocType named \"My Custom DocType\" in module \"My Module\":\n\n```\nmy_app/\n└── my_module/\n    └── doctype/\n        └── my_custom_doctype/\n            ├── my_custom_doctype.json      # DocType definition\n            ├── my_custom_doctype.py        # Python controller\n            ├── my_custom_doctype.js        # Client script\n            ├── test_my_custom_doctype.py   # Test file\n            └── __init__.py\n```\n\n## DocType JSON Structure\n\n```json\n{\n  \"name\": \"My Custom DocType\",\n  \"module\": \"My Module\",\n  \"doctype\": \"DocType\",\n  \"engine\": \"InnoDB\",\n  \"field_order\": [\"field1\", \"field2\"],\n  \"fields\": [\n    {\n      \"fieldname\": \"field1\",\n      \"fieldtype\": \"Data\",\n      \"label\": \"Field 1\",\n      \"reqd\": 1\n    }\n  ],\n  \"permissions\": [\n    {\n      \"role\": \"System Manager\",\n      \"read\": 1,\n      \"write\": 1,\n      \"create\": 1,\n      \"delete\": 1\n    }\n  ],\n  \"autoname\": \"naming_series:\",\n  \"naming_rule\": \"By \\\"Naming Series\\\" field\",\n  \"is_submittable\": 0,\n  \"istable\": 0,\n  \"issingle\": 0,\n  \"track_changes\": 1,\n  \"sort_field\": \"modified\",\n  \"sort_order\": \"DESC\"\n}\n```\n\n## Field Types Reference\n\n### Text Fields\n| Type | Description | Use Case |\n|------|-------------|----------|\n| `Data` | Single line text (140 chars) | Names, codes, short text |\n| `Small Text` | Multi-line text | Short descriptions |\n| `Text` | Multi-line text (unlimited) | Long descriptions |\n| `Text Editor` | Rich text with formatting | Content, notes |\n| `Code` | Syntax-highlighted code | Python, JS, JSON |\n| `HTML Editor` | WYSIWYG HTML | Email templates |\n| `Markdown Editor` | Markdown input | Documentation |\n| `Password` | Masked input | Secrets (stored encrypted) |\n\n### Numeric Fields\n| Type | Description | Use Case |\n|------|-------------|----------|\n| `Int` | Integer | Counts, quantities |\n| `Float` | Decimal number | Measurements |\n| `Currency` | Money with precision | Prices, amounts |\n| `Percent` | 0-100 percentage | Discounts, rates |\n| `Rating` | Star rating (0-1) | Reviews, scores |\n\n### Date/Time Fields\n| Type | Description | Use Case |\n|------|-------------|----------|\n| `Date` | Date only | Birth dates, due dates |\n| `Datetime` | Date and time | Timestamps |\n| `Time` | Time only | Schedules |\n| `Duration` | Time duration | Task duration |\n\n### Selection Fields\n| Type | Description | Use Case |\n|------|-------------|----------|\n| `Select` | Dropdown options | Status, type |\n| `Check` | Boolean checkbox | Flags, toggles |\n| `Autocomplete` | Text with suggestions | Tags |\n\n### Link Fields\n| Type | Description | Use Case |\n|------|-------------|----------|\n| `Link` | Reference to another DocType | Foreign key relationship |\n| `Dynamic Link` | Reference based on another field | Polymorphic links |\n| `Table` | Child table (1-to-many) | Line items, details |\n| `Table MultiSelect` | Many-to-many via link | Multiple selections |\n\n### Special Fields\n| Type | Description | Use Case |\n|------|-------------|----------|\n| `Attach` | Single file attachment | Documents |\n| `Attach Image` | Image with preview | Photos, logos |\n| `Image` | Display image from URL field | Gallery |\n| `Signature` | Signature pad | Approvals |\n| `Geolocation` | Map coordinates | Locations |\n| `Barcode` | Barcode/QR display | Inventory |\n| `JSON` | JSON data | Configuration |\n\n### Layout Fields\n| Type | Description | Use Case |\n|------|-------------|----------|\n| `Section Break` | Horizontal section divider | Form organization |\n| `Column Break` | Vertical column divider | Multi-column layout |\n| `Tab Break` | Tab navigation | Large forms |\n| `HTML` | Static HTML content | Instructions, headers |\n| `Heading` | Section heading | Visual separation |\n| `Button` | Clickable button | Actions |\n\n## Field Options\n\n### Common Field Properties\n```json\n{\n  \"fieldname\": \"customer\",\n  \"fieldtype\": \"Link\",\n  \"label\": \"Customer\",\n  \"options\": \"Customer\",\n  \"reqd\": 1,\n  \"unique\": 0,\n  \"in_list_view\": 1,\n  \"in_standard_filter\": 1,\n  \"in_global_search\": 1,\n  \"bold\": 1,\n  \"read_only\": 0,\n  \"hidden\": 0,\n  \"print_hide\": 0,\n  \"no_copy\": 0,\n  \"allow_in_quick_entry\": 1,\n  \"translatable\": 0,\n  \"default\": \"\",\n  \"description\": \"Select the customer\",\n  \"depends_on\": \"eval:doc.is_customer\",\n  \"mandatory_depends_on\": \"eval:doc.status=='Active'\",\n  \"read_only_depends_on\": \"eval:doc.docstatus==1\"\n}\n```\n\n### Link Field Options\n```json\n{\n  \"fieldname\": \"customer\",\n  \"fieldtype\": \"Link\",\n  \"options\": \"Customer\",\n  \"filters\": {\n    \"disabled\": 0,\n    \"customer_type\": \"Company\"\n  },\n  \"ignore_user_permissions\": 0\n}\n```\n\n### Select Field Options\n```json\n{\n  \"fieldname\": \"status\",\n  \"fieldtype\": \"Select\",\n  \"options\": \"\\nDraft\\nPending\\nApproved\\nRejected\",\n  \"default\": \"Draft\"\n}\n```\n\n### Dynamic Link\n```json\n{\n  \"fieldname\": \"party_type\",\n  \"fieldtype\": \"Link\",\n  \"options\": \"DocType\"\n},\n{\n  \"fieldname\": \"party\",\n  \"fieldtype\": \"Dynamic Link\",\n  \"options\": \"party_type\"\n}\n```\n\n## Naming Patterns (autoname)\n\n### Naming Series\n```json\n{\n  \"autoname\": \"naming_series:\",\n  \"naming_rule\": \"By \\\"Naming Series\\\" field\"\n}\n```\nAdd a naming_series field:\n```json\n{\n  \"fieldname\": \"naming_series\",\n  \"fieldtype\": \"Select\",\n  \"options\": \"INV-.YYYY.-\\nINV-.MM.-.YYYY.-\",\n  \"default\": \"INV-.YYYY.-\"\n}\n```\n\n### Field-Based Naming\n```json\n{\n  \"autoname\": \"field:customer_code\",\n  \"naming_rule\": \"By fieldname\"\n}\n```\n\n### Expression-Based\n```json\n{\n  \"autoname\": \"format:{customer_type}-{###}\",\n  \"naming_rule\": \"Expression\"\n}\n```\n\n### Hash/Random\n```json\n{\n  \"autoname\": \"hash\",\n  \"naming_rule\": \"Random\"\n}\n```\n\n### Prompt (Manual)\n```json\n{\n  \"autoname\": \"Prompt\",\n  \"naming_rule\": \"Set by user\"\n}\n```\n\n## Controller Lifecycle Hooks\n\n```python\n# my_doctype.py\nimport frappe\nfrom frappe.model.document import Document\n\nclass MyDocType(Document):\n    # ===== BEFORE DATABASE OPERATIONS =====\n\n    def autoname(self):\n        \"\"\"Set the document name before saving\"\"\"\n        self.name = f\"{self.prefix}-{frappe.generate_hash()[:8]}\"\n\n    def before_naming(self):\n        \"\"\"Called before autoname, can modify naming logic\"\"\"\n        pass\n\n    def validate(self):\n        \"\"\"Validate data before save (called on insert and update)\"\"\"\n        self.validate_dates()\n        self.calculate_totals()\n\n    def before_validate(self):\n        \"\"\"Called before validate\"\"\"\n        pass\n\n    def before_save(self):\n        \"\"\"Called before document is saved to database\"\"\"\n        self.modified_by_script = True\n\n    def before_insert(self):\n        \"\"\"Called before new document is inserted\"\"\"\n        self.set_defaults()\n\n    # ===== AFTER DATABASE OPERATIONS =====\n\n    def after_insert(self):\n        \"\"\"Called after new document is inserted\"\"\"\n        self.notify_users()\n\n    def on_update(self):\n        \"\"\"Called after document is saved (insert or update)\"\"\"\n        self.update_related_docs()\n\n    def after_save(self):\n        \"\"\"Called after on_update, always runs\"\"\"\n        pass\n\n    def on_change(self):\n        \"\"\"Called when document changes in database\"\"\"\n        pass\n\n    # ===== SUBMISSION WORKFLOW =====\n\n    def before_submit(self):\n        \"\"\"Called before document is submitted\"\"\"\n        self.validate_for_submit()\n\n    def on_submit(self):\n        \"\"\"Called after document is submitted\"\"\"\n        self.create_gl_entries()\n\n    def before_cancel(self):\n        \"\"\"Called before document is cancelled\"\"\"\n        self.validate_cancellation()\n\n    def on_cancel(self):\n        \"\"\"Called after document is cancelled\"\"\"\n        self.reverse_gl_entries()\n\n    def on_update_after_submit(self):\n        \"\"\"Called when submitted doc is updated (limited fields)\"\"\"\n        pass\n\n    # ===== DELETION =====\n\n    def before_delete(self):\n        \"\"\"Called before document is deleted\"\"\"\n        self.check_dependencies()\n\n    def after_delete(self):\n        \"\"\"Called after document is deleted\"\"\"\n        self.cleanup_attachments()\n\n    def on_trash(self):\n        \"\"\"Called when document is trashed\"\"\"\n        pass\n\n    def after_restore(self):\n        \"\"\"Called after document is restored from trash\"\"\"\n        pass\n\n    # ===== CUSTOM METHODS =====\n\n    def validate_dates(self):\n        if self.end_date and self.start_date > self.end_date:\n            frappe.throw(\"End date cannot be before start date\")\n\n    def calculate_totals(self):\n        self.total = sum(d.amount for d in self.items)\n```\n\n## Child Table (Table Field)\n\n### Parent DocType\n```json\n{\n  \"fieldname\": \"items\",\n  \"fieldtype\": \"Table\",\n  \"label\": \"Items\",\n  \"options\": \"My DocType Item\",\n  \"reqd\": 1\n}\n```\n\n### Child DocType JSON\n```json\n{\n  \"name\": \"My DocType Item\",\n  \"module\": \"My Module\",\n  \"doctype\": \"DocType\",\n  \"istable\": 1,\n  \"editable_grid\": 1,\n  \"fields\": [\n    {\n      \"fieldname\": \"item\",\n      \"fieldtype\": \"Link\",\n      \"options\": \"Item\",\n      \"in_list_view\": 1,\n      \"reqd\": 1\n    },\n    {\n      \"fieldname\": \"qty\",\n      \"fieldtype\": \"Float\",\n      \"in_list_view\": 1\n    },\n    {\n      \"fieldname\": \"rate\",\n      \"fieldtype\": \"Currency\",\n      \"in_list_view\": 1\n    },\n    {\n      \"fieldname\": \"amount\",\n      \"fieldtype\": \"Currency\",\n      \"in_list_view\": 1,\n      \"read_only\": 1\n    }\n  ]\n}\n```\n\n## Single DocType (Settings)\n\nFor application settings that have only one record:\n\n```json\n{\n  \"name\": \"My App Settings\",\n  \"module\": \"My Module\",\n  \"doctype\": \"DocType\",\n  \"issingle\": 1,\n  \"fields\": [\n    {\n      \"fieldname\": \"enable_feature\",\n      \"fieldtype\": \"Check\",\n      \"label\": \"Enable Feature\"\n    },\n    {\n      \"fieldname\": \"api_key\",\n      \"fieldtype\": \"Password\",\n      \"label\": \"API Key\"\n    }\n  ]\n}\n```\n\nAccess in code:\n```python\nsettings = frappe.get_single(\"My App Settings\")\nif settings.enable_feature:\n    do_something()\n```\n\n## Virtual DocType\n\nDocType without database table, computed on-the-fly:\n\n```json\n{\n  \"name\": \"My Virtual DocType\",\n  \"module\": \"My Module\",\n  \"doctype\": \"DocType\",\n  \"is_virtual\": 1\n}\n```\n\nController:\n```python\nclass MyVirtualDocType(Document):\n    @staticmethod\n    def get_list(args):\n        # Return list of virtual documents\n        return [{\"name\": \"doc1\", \"value\": 100}]\n\n    @staticmethod\n    def get_count(args):\n        return len(MyVirtualDocType.get_list(args))\n\n    @staticmethod\n    def get_stats(args):\n        return {}\n```\n\n## Permissions\n\n```json\n{\n  \"permissions\": [\n    {\n      \"role\": \"System Manager\",\n      \"read\": 1,\n      \"write\": 1,\n      \"create\": 1,\n      \"delete\": 1,\n      \"submit\": 1,\n      \"cancel\": 1,\n      \"amend\": 1,\n      \"report\": 1,\n      \"export\": 1,\n      \"import\": 1,\n      \"share\": 1,\n      \"print\": 1,\n      \"email\": 1\n    },\n    {\n      \"role\": \"Sales User\",\n      \"read\": 1,\n      \"write\": 1,\n      \"create\": 1,\n      \"if_owner\": 1\n    }\n  ]\n}\n```\n\n## Best Practices\n\n### Naming Conventions\n- Use singular names: \"Customer\" not \"Customers\"\n- Use Title Case with spaces: \"Sales Invoice\"\n- Fieldnames use snake_case: `customer_name`\n\n### Field Design\n- Put most important fields first\n- Use Section Breaks to organize\n- Use Tab Breaks for complex forms\n- Set `in_list_view` for key fields\n- Set `in_standard_filter` for filterable fields\n\n### Performance\n- Index frequently queried fields with `search_index: 1`\n- Use `read_only` to prevent unnecessary validation\n- Limit child table rows with `max_attachments`\n\n### Data Integrity\n- Use `unique: 1` for unique constraints\n- Set appropriate `reqd` (required) flags\n- Use `depends_on` for conditional visibility\n- Use `mandatory_depends_on` for conditional requirements\n\n## Common Patterns\n\n### Status Field Pattern\n```json\n{\n  \"fieldname\": \"status\",\n  \"fieldtype\": \"Select\",\n  \"options\": \"\\nDraft\\nPending Approval\\nApproved\\nRejected\",\n  \"default\": \"Draft\",\n  \"in_list_view\": 1,\n  \"in_standard_filter\": 1,\n  \"read_only\": 1,\n  \"allow_on_submit\": 1\n}\n```\n\n### Amount Calculation Pattern\n```json\n[\n  {\"fieldname\": \"qty\", \"fieldtype\": \"Float\"},\n  {\"fieldname\": \"rate\", \"fieldtype\": \"Currency\"},\n  {\"fieldname\": \"amount\", \"fieldtype\": \"Currency\", \"read_only\": 1}\n]\n```\nWith controller:\n```python\ndef validate(self):\n    for item in self.items:\n        item.amount = flt(item.qty) * flt(item.rate)\n    self.total = sum(item.amount for item in self.items)\n```\n\n### Linked Document Pattern\n```json\n{\n  \"fieldname\": \"customer\",\n  \"fieldtype\": \"Link\",\n  \"options\": \"Customer\",\n  \"reqd\": 1\n},\n{\n  \"fieldname\": \"customer_name\",\n  \"fieldtype\": \"Data\",\n  \"fetch_from\": \"customer.customer_name\",\n  \"read_only\": 1\n}\n```"
              },
              {
                "name": "frappe-api",
                "description": "Frappe Python and JavaScript API reference including document operations, database queries, utilities, and REST API patterns. Use when working with frappe.get_doc, frappe.db, frappe.call, or any Frappe API methods.",
                "path": "plugins/frappe-fullstack/skills/frappe-api/SKILL.md",
                "frontmatter": {
                  "name": "frappe-api",
                  "description": "Frappe Python and JavaScript API reference including document operations, database queries, utilities, and REST API patterns. Use when working with frappe.get_doc, frappe.db, frappe.call, or any Frappe API methods."
                },
                "content": "# Frappe API Reference\n\nComplete reference for Frappe's Python and JavaScript APIs for document operations, database queries, utilities, and server communication.\n\n## When to Use This Skill\n\n- Working with Document API (get_doc, new_doc, save)\n- Database operations (frappe.db.*)\n- Making API calls from client to server\n- Using Frappe utilities (date, number formatting)\n- Creating whitelisted API endpoints\n- Working with REST API\n\n## Python API\n\n### Document Operations\n\n#### Get Document\n```python\n# Get existing document\ndoc = frappe.get_doc(\"Customer\", \"CUST-001\")\n\n# Get document with filters\ndoc = frappe.get_doc(\"Customer\", {\"customer_name\": \"John\"})\n\n# Get last document\ndoc = frappe.get_last_doc(\"Customer\", filters={\"status\": \"Active\"})\n\n# Get cached document (read-only, faster)\ndoc = frappe.get_cached_doc(\"Customer\", \"CUST-001\")\n\n# Check if document exists\nif frappe.db.exists(\"Customer\", \"CUST-001\"):\n    doc = frappe.get_doc(\"Customer\", \"CUST-001\")\n```\n\n#### Create Document\n```python\n# Create new document\ndoc = frappe.new_doc(\"Customer\")\ndoc.customer_name = \"New Customer\"\ndoc.customer_type = \"Company\"\ndoc.insert()\n\n# Create with dict\ndoc = frappe.get_doc({\n    \"doctype\": \"Customer\",\n    \"customer_name\": \"New Customer\",\n    \"customer_type\": \"Company\"\n})\ndoc.insert()\n\n# Create and insert in one step\ndoc = frappe.get_doc({\n    \"doctype\": \"Customer\",\n    \"customer_name\": \"New Customer\"\n}).insert()\n\n# Insert ignoring permissions\ndoc.insert(ignore_permissions=True)\n\n# Insert ignoring mandatory fields\ndoc.insert(ignore_mandatory=True)\n```\n\n#### Update Document\n```python\n# Update and save\ndoc = frappe.get_doc(\"Customer\", \"CUST-001\")\ndoc.customer_name = \"Updated Name\"\ndoc.save()\n\n# Save ignoring permissions\ndoc.save(ignore_permissions=True)\n\n# Update single value\nfrappe.db.set_value(\"Customer\", \"CUST-001\", \"customer_name\", \"New Name\")\n\n# Update multiple values\nfrappe.db.set_value(\"Customer\", \"CUST-001\", {\n    \"customer_name\": \"New Name\",\n    \"status\": \"Active\"\n})\n\n# Bulk update\nfrappe.db.set_value(\"Customer\", {\"status\": \"Inactive\"}, \"status\", \"Active\")\n```\n\n#### Delete Document\n```python\n# Delete document\nfrappe.delete_doc(\"Customer\", \"CUST-001\")\n\n# Delete ignoring permissions\nfrappe.delete_doc(\"Customer\", \"CUST-001\", ignore_permissions=True)\n\n# Delete with linked documents\nfrappe.delete_doc(\"Customer\", \"CUST-001\", force=True)\n\n# Delete from controller\ndoc.delete()\n```\n\n### Database API (frappe.db)\n\n#### Select Queries\n```python\n# Get single value\nvalue = frappe.db.get_value(\"Customer\", \"CUST-001\", \"customer_name\")\n\n# Get multiple fields\nvalues = frappe.db.get_value(\"Customer\", \"CUST-001\",\n    [\"customer_name\", \"status\"], as_dict=True)\n\n# Get with filters\nvalue = frappe.db.get_value(\"Customer\",\n    {\"customer_type\": \"Company\"}, \"customer_name\")\n\n# Get list of values\nnames = frappe.db.get_all(\"Customer\",\n    filters={\"status\": \"Active\"},\n    fields=[\"name\", \"customer_name\"],\n    order_by=\"creation desc\",\n    limit=10\n)\n\n# Get list with pluck (single field as list)\nnames = frappe.db.get_all(\"Customer\",\n    filters={\"status\": \"Active\"},\n    pluck=\"name\"\n)\n\n# Complex filters\ndocs = frappe.db.get_all(\"Sales Invoice\",\n    filters={\n        \"status\": [\"in\", [\"Paid\", \"Unpaid\"]],\n        \"grand_total\": [\">\", 1000],\n        \"posting_date\": [\"between\", [\"2024-01-01\", \"2024-12-31\"]],\n        \"customer\": [\"like\", \"%Corp%\"]\n    },\n    fields=[\"name\", \"customer\", \"grand_total\"]\n)\n\n# Filter operators\n# =, !=, <, >, <=, >=\n# in, not in\n# like, not like\n# between\n# is, is not (for None)\n# descendants of, ancestors of (for tree doctypes)\n\n# Get count\ncount = frappe.db.count(\"Customer\", {\"status\": \"Active\"})\n\n# Check existence\nexists = frappe.db.exists(\"Customer\", \"CUST-001\")\nexists = frappe.db.exists(\"Customer\", {\"customer_name\": \"John\"})\n```\n\n#### Raw SQL\n```python\n# Execute SQL query\nresult = frappe.db.sql(\"\"\"\n    SELECT name, customer_name, grand_total\n    FROM `tabSales Invoice`\n    WHERE status = %s AND grand_total > %s\n    ORDER BY creation DESC\n    LIMIT 10\n\"\"\", (\"Paid\", 1000), as_dict=True)\n\n# Single value\ntotal = frappe.db.sql(\"\"\"\n    SELECT SUM(grand_total) FROM `tabSales Invoice`\n    WHERE status = 'Paid'\n\"\"\")[0][0]\n\n# With named parameters\nresult = frappe.db.sql(\"\"\"\n    SELECT * FROM `tabCustomer`\n    WHERE name = %(name)s\n\"\"\", {\"name\": \"CUST-001\"}, as_dict=True)\n```\n\n#### Insert/Update\n```python\n# Insert raw\nfrappe.db.sql(\"\"\"\n    INSERT INTO `tabCustomer` (name, customer_name)\n    VALUES (%s, %s)\n\"\"\", (\"CUST-002\", \"New Customer\"))\n\n# Commit transaction\nfrappe.db.commit()\n\n# Rollback\nfrappe.db.rollback()\n```\n\n### Whitelisted API\n\n```python\n# Create API endpoint\n@frappe.whitelist()\ndef get_customer_details(customer):\n    \"\"\"Get customer details\n\n    Args:\n        customer: Customer ID\n\n    Returns:\n        dict: Customer details\n    \"\"\"\n    doc = frappe.get_doc(\"Customer\", customer)\n    return {\n        \"name\": doc.name,\n        \"customer_name\": doc.customer_name,\n        \"outstanding_amount\": get_outstanding(customer)\n    }\n\n# Allow guest access (no login required)\n@frappe.whitelist(allow_guest=True)\ndef public_api():\n    return {\"status\": \"ok\"}\n\n# With specific methods\n@frappe.whitelist(methods=[\"POST\"])\ndef create_record(data):\n    doc = frappe.get_doc(data)\n    doc.insert()\n    return doc.name\n```\n\n### Utilities\n\n#### Date/Time\n```python\nfrom frappe.utils import (\n    now, nowdate, nowtime, now_datetime,\n    today, getdate, get_datetime,\n    add_days, add_months, add_years,\n    date_diff, time_diff, time_diff_in_seconds,\n    get_first_day, get_last_day,\n    formatdate, format_datetime\n)\n\n# Current date/time\ncurrent = nowdate()  # \"2024-01-15\"\ncurrent_dt = now_datetime()  # datetime object\ntimestamp = now()  # \"2024-01-15 10:30:00\"\n\n# Date arithmetic\nnext_week = add_days(nowdate(), 7)\nnext_month = add_months(nowdate(), 1)\nlast_year = add_years(nowdate(), -1)\n\n# Date difference\ndays = date_diff(end_date, start_date)\nseconds = time_diff_in_seconds(end_time, start_time)\n\n# First/last day of month\nfirst = get_first_day(nowdate())\nlast = get_last_day(nowdate())\n\n# Parse dates\ndate_obj = getdate(\"2024-01-15\")\ndt_obj = get_datetime(\"2024-01-15 10:30:00\")\n\n# Format dates\nformatted = formatdate(\"2024-01-15\", \"dd-MM-yyyy\")\n```\n\n#### Numbers\n```python\nfrom frappe.utils import (\n    flt, cint, cstr,\n    fmt_money, rounded,\n    money_in_words\n)\n\n# Type conversion with defaults\nnum = flt(value)  # float, None -> 0.0\nnum = flt(value, 2)  # with precision\ninteger = cint(value)  # int, None -> 0\nstring = cstr(value)  # string, None -> \"\"\n\n# Formatting\nformatted = fmt_money(1234.56, currency=\"USD\")  # \"$1,234.56\"\nrounded_val = rounded(1234.567, 2)  # 1234.57\nwords = money_in_words(1234.56, \"USD\")  # \"One Thousand...\"\n```\n\n#### Strings\n```python\nfrom frappe.utils import (\n    strip_html, strip_html_tags,\n    escape_html, sanitize_html,\n    scrub, unscrub\n)\n\n# HTML handling\nplain = strip_html(\"<p>Hello</p>\")  # \"Hello\"\nsafe = escape_html(\"<script>bad</script>\")\n\n# Field name conversion\nfield = scrub(\"My Field Name\")  # \"my_field_name\"\nlabel = unscrub(\"my_field_name\")  # \"My Field Name\"\n```\n\n### Messaging & Notifications\n\n```python\n# Show message (appears as toast)\nfrappe.msgprint(\"Document saved successfully\")\n\n# With indicator\nfrappe.msgprint(\"Error occurred\", indicator=\"red\", title=\"Error\")\n\n# Throw error (stops execution)\nfrappe.throw(\"Invalid data provided\")\n\n# With exception type\nfrom frappe.exceptions import ValidationError\nfrappe.throw(\"Validation failed\", exc=ValidationError)\n\n# Send email\nfrappe.sendmail(\n    recipients=[\"user@example.com\"],\n    subject=\"Hello\",\n    message=\"Email body\",\n    template=\"email_template\",\n    args={\"name\": \"John\"}\n)\n\n# Create system notification\nfrappe.publish_realtime(\n    \"msgprint\",\n    {\"message\": \"Task completed\"},\n    user=\"user@example.com\"\n)\n```\n\n### Background Jobs\n\n```python\n# Enqueue background job\nfrappe.enqueue(\n    \"myapp.tasks.heavy_task\",\n    queue=\"long\",\n    timeout=600,\n    job_name=\"Heavy Task\",\n    customer=\"CUST-001\"\n)\n\n# In tasks.py\ndef heavy_task(customer):\n    # Long running task\n    process_customer(customer)\n\n# Enqueue with callback\nfrappe.enqueue(\n    method=process_data,\n    queue=\"default\",\n    on_success=on_complete,\n    on_failure=on_error\n)\n\n# Scheduled jobs (in hooks.py)\nscheduler_events = {\n    \"daily\": [\n        \"myapp.tasks.daily_task\"\n    ],\n    \"hourly\": [\n        \"myapp.tasks.hourly_task\"\n    ],\n    \"cron\": {\n        \"0 0 * * *\": [  # Midnight\n            \"myapp.tasks.midnight_task\"\n        ]\n    }\n}\n```\n\n### Session & User\n\n```python\n# Current user\nuser = frappe.session.user\n\n# Check if logged in\nif frappe.session.user != \"Guest\":\n    pass\n\n# Check permissions\nif frappe.has_permission(\"Customer\", \"write\"):\n    pass\n\n# Get user info\nuser_doc = frappe.get_doc(\"User\", frappe.session.user)\nfull_name = frappe.utils.get_fullname(frappe.session.user)\n\n# Check roles\nif \"System Manager\" in frappe.get_roles():\n    pass\n\n# Run as different user\nfrappe.set_user(\"Administrator\")\n# ... do operations\nfrappe.set_user(original_user)\n```\n\n## JavaScript API\n\n### Document Operations\n\n```javascript\n// Get document\nfrappe.call({\n    method: 'frappe.client.get',\n    args: {\n        doctype: 'Customer',\n        name: 'CUST-001'\n    },\n    callback: function(r) {\n        console.log(r.message);\n    }\n});\n\n// Create document\nfrappe.call({\n    method: 'frappe.client.insert',\n    args: {\n        doc: {\n            doctype: 'Customer',\n            customer_name: 'New Customer'\n        }\n    },\n    callback: function(r) {\n        console.log('Created:', r.message.name);\n    }\n});\n\n// Save document\nfrappe.call({\n    method: 'frappe.client.save',\n    args: {\n        doc: cur_frm.doc\n    }\n});\n\n// Delete document\nfrappe.call({\n    method: 'frappe.client.delete',\n    args: {\n        doctype: 'Customer',\n        name: 'CUST-001'\n    }\n});\n```\n\n### frappe.call (API Calls)\n\n```javascript\n// Call whitelisted method\nfrappe.call({\n    method: 'myapp.api.get_customer_details',\n    args: {\n        customer: 'CUST-001'\n    },\n    freeze: true,\n    freeze_message: 'Loading...',\n    callback: function(r) {\n        if (r.message) {\n            console.log(r.message);\n        }\n    },\n    error: function(r) {\n        frappe.msgprint('Error occurred');\n    }\n});\n\n// Async/await pattern\nasync function getCustomer(name) {\n    const response = await frappe.call({\n        method: 'myapp.api.get_customer',\n        args: { name }\n    });\n    return response.message;\n}\n\n// Call with promise\nfrappe.call({\n    method: 'myapp.api.process',\n    args: { data: 'test' }\n}).then(r => {\n    console.log(r.message);\n});\n```\n\n### Form API (cur_frm)\n\n```javascript\nfrappe.ui.form.on('Sales Invoice', {\n    refresh: function(frm) {\n        // Add custom button\n        frm.add_custom_button('Process', function() {\n            // Button action\n        }, 'Actions');\n\n        // Set field properties\n        frm.set_df_property('field_name', 'read_only', 1);\n        frm.set_df_property('field_name', 'hidden', 1);\n        frm.set_df_property('field_name', 'reqd', 1);\n\n        // Set query for link field\n        frm.set_query('customer', function() {\n            return {\n                filters: {\n                    status: 'Active'\n                }\n            };\n        });\n\n        // Toggle fields\n        frm.toggle_display('field_name', frm.doc.show_field);\n        frm.toggle_reqd('field_name', frm.doc.is_required);\n    },\n\n    customer: function(frm) {\n        // Field change handler\n        if (frm.doc.customer) {\n            frappe.call({\n                method: 'myapp.api.get_customer_details',\n                args: { customer: frm.doc.customer },\n                callback: function(r) {\n                    frm.set_value('customer_name', r.message.name);\n                }\n            });\n        }\n    },\n\n    validate: function(frm) {\n        // Validate before save\n        if (!frm.doc.customer) {\n            frappe.throw('Customer is required');\n            return false;\n        }\n    },\n\n    before_save: function(frm) {\n        // Before save actions\n        frm.doc.modified_by_script = 1;\n    },\n\n    after_save: function(frm) {\n        // After save actions\n        frappe.show_alert('Document saved!');\n    }\n});\n\n// Child table events\nfrappe.ui.form.on('Sales Invoice Item', {\n    qty: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n        row.amount = row.qty * row.rate;\n        frm.refresh_field('items');\n    },\n\n    items_add: function(frm, cdt, cdn) {\n        // New row added\n        let row = locals[cdt][cdn];\n        row.warehouse = frm.doc.default_warehouse;\n    },\n\n    items_remove: function(frm) {\n        // Row removed - recalculate totals\n        calculate_totals(frm);\n    }\n});\n```\n\n### Dialogs\n\n```javascript\n// Simple prompt\nfrappe.prompt(\n    {fieldname: 'name', fieldtype: 'Data', label: 'Name', reqd: 1},\n    function(values) {\n        console.log(values.name);\n    },\n    'Enter Name'\n);\n\n// Multiple fields\nfrappe.prompt([\n    {fieldname: 'name', fieldtype: 'Data', label: 'Name', reqd: 1},\n    {fieldname: 'email', fieldtype: 'Data', label: 'Email', options: 'Email'},\n    {fieldname: 'date', fieldtype: 'Date', label: 'Date', default: frappe.datetime.nowdate()}\n], function(values) {\n    console.log(values);\n}, 'Enter Details', 'Submit');\n\n// Custom dialog\nlet dialog = new frappe.ui.Dialog({\n    title: 'My Dialog',\n    fields: [\n        {fieldname: 'customer', fieldtype: 'Link', options: 'Customer', label: 'Customer'},\n        {fieldname: 'amount', fieldtype: 'Currency', label: 'Amount'}\n    ],\n    primary_action_label: 'Submit',\n    primary_action: function(values) {\n        console.log(values);\n        dialog.hide();\n    }\n});\ndialog.show();\n\n// Confirmation\nfrappe.confirm(\n    'Are you sure you want to proceed?',\n    function() {\n        // Yes\n        process_action();\n    },\n    function() {\n        // No\n    }\n);\n```\n\n### Utilities\n\n```javascript\n// Messages\nfrappe.msgprint('Hello World');\nfrappe.msgprint({\n    title: 'Success',\n    message: 'Operation completed',\n    indicator: 'green'\n});\n\nfrappe.throw('Error message');  // Stops execution\n\nfrappe.show_alert('Quick notification', 5);  // 5 seconds\n\n// Date/time\nfrappe.datetime.nowdate();  // \"2024-01-15\"\nfrappe.datetime.now_datetime();  // \"2024-01-15 10:30:00\"\nfrappe.datetime.add_days('2024-01-15', 7);\nfrappe.datetime.str_to_obj('2024-01-15');\n\n// Format\nfrappe.format(1234.56, {fieldtype: 'Currency'});\nfrappe.format('2024-01-15', {fieldtype: 'Date'});\n\n// Routing\nfrappe.set_route('Form', 'Customer', 'CUST-001');\nfrappe.set_route('List', 'Customer');\nfrappe.set_route('query-report', 'Sales Report');\n\n// Current route\nlet route = frappe.get_route();\n```\n\n## REST API\n\n### Authentication\n\n```bash\n# Token-based\ncurl -X GET \"https://site.com/api/resource/Customer\" \\\n  -H \"Authorization: token api_key:api_secret\"\n\n# Session-based (login first)\ncurl -X POST \"https://site.com/api/method/login\" \\\n  -d \"usr=user&pwd=password\"\n```\n\n### CRUD Operations\n\n```bash\n# List\nGET /api/resource/Customer?filters=[[\"status\",\"=\",\"Active\"]]&fields=[\"name\",\"customer_name\"]&limit_page_length=10\n\n# Get single\nGET /api/resource/Customer/CUST-001\n\n# Create\nPOST /api/resource/Customer\nContent-Type: application/json\n{\"customer_name\": \"New Customer\", \"customer_type\": \"Company\"}\n\n# Update\nPUT /api/resource/Customer/CUST-001\nContent-Type: application/json\n{\"customer_name\": \"Updated Name\"}\n\n# Delete\nDELETE /api/resource/Customer/CUST-001\n```\n\n### Call Methods\n\n```bash\n# Call whitelisted method\nPOST /api/method/myapp.api.get_customer_details\nContent-Type: application/json\n{\"customer\": \"CUST-001\"}\n```\n\n### JavaScript Fetch\n\n```javascript\n// Using fetch API\nasync function getCustomers() {\n    const response = await fetch('/api/resource/Customer?limit_page_length=10', {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    });\n    const data = await response.json();\n    return data.data;\n}\n\n// POST request\nasync function createCustomer(customerData) {\n    const response = await fetch('/api/resource/Customer', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(customerData)\n    });\n    return response.json();\n}\n```"
              },
              {
                "name": "server-scripts",
                "description": "Frappe server-side Python patterns for controllers, document events, whitelisted APIs, background jobs, and database operations. Use when writing controller logic, creating APIs, handling document events, or processing data on the server.",
                "path": "plugins/frappe-fullstack/skills/server-scripts/SKILL.md",
                "frontmatter": {
                  "name": "server-scripts",
                  "description": "Frappe server-side Python patterns for controllers, document events, whitelisted APIs, background jobs, and database operations. Use when writing controller logic, creating APIs, handling document events, or processing data on the server."
                },
                "content": "# Frappe Server Scripts Reference\n\nComplete reference for server-side Python development in Frappe Framework.\n\n## When to Use This Skill\n\n- Writing document controllers\n- Creating whitelisted API endpoints\n- Handling document lifecycle events\n- Background job processing\n- Database operations and queries\n- Permission checks and validation\n- Email and notification handling\n\n## Controller Location\n\n```\nmy_app/\n└── my_module/\n    └── doctype/\n        └── my_doctype/\n            └── my_doctype.py    # Python controller\n```\n\n## Document Controller\n\n### Complete Controller Template\n\n```python\n# my_doctype.py\nimport frappe\nfrom frappe import _\nfrom frappe.model.document import Document\nfrom frappe.utils import nowdate, nowtime, flt, cint, getdate, add_days\n\n\nclass MyDocType(Document):\n    # ===== NAMING =====\n\n    def autoname(self):\n        \"\"\"Custom naming logic\"\"\"\n        self.name = f\"{self.prefix}-{frappe.generate_hash()[:8].upper()}\"\n\n    def before_naming(self):\n        \"\"\"Called before autoname\"\"\"\n        pass\n\n    # ===== VALIDATION =====\n\n    def before_validate(self):\n        \"\"\"Called before validate\"\"\"\n        self.set_defaults()\n\n    def validate(self):\n        \"\"\"Main validation - called on insert and update\"\"\"\n        self.validate_dates()\n        self.validate_amounts()\n        self.calculate_totals()\n        self.set_status()\n\n    def before_save(self):\n        \"\"\"Called after validate, before database write\"\"\"\n        self.update_modified_info()\n\n    # ===== INSERT =====\n\n    def before_insert(self):\n        \"\"\"Called before new document is inserted\"\"\"\n        self.set_initial_values()\n\n    def after_insert(self):\n        \"\"\"Called after new document is inserted\"\"\"\n        self.create_related_documents()\n        self.send_notification()\n\n    # ===== UPDATE =====\n\n    def on_update(self):\n        \"\"\"Called after document is saved (insert or update)\"\"\"\n        self.update_related_documents()\n        self.clear_cache()\n\n    def after_save(self):\n        \"\"\"Called after on_update, always runs\"\"\"\n        pass\n\n    def on_change(self):\n        \"\"\"Called when document changes in database\"\"\"\n        pass\n\n    # ===== SUBMISSION =====\n\n    def before_submit(self):\n        \"\"\"Called before document is submitted\"\"\"\n        self.validate_for_submit()\n\n    def on_submit(self):\n        \"\"\"Called after document is submitted\"\"\"\n        self.create_gl_entries()\n        self.update_stock()\n\n    def on_update_after_submit(self):\n        \"\"\"Called when submitted doc is updated (limited fields)\"\"\"\n        pass\n\n    # ===== CANCELLATION =====\n\n    def before_cancel(self):\n        \"\"\"Called before document is cancelled\"\"\"\n        self.validate_cancellation()\n\n    def on_cancel(self):\n        \"\"\"Called after document is cancelled\"\"\"\n        self.reverse_gl_entries()\n        self.reverse_stock()\n\n    # ===== DELETION =====\n\n    def before_delete(self):\n        \"\"\"Called before document is deleted\"\"\"\n        self.check_dependencies()\n\n    def after_delete(self):\n        \"\"\"Called after document is deleted\"\"\"\n        self.cleanup_related()\n\n    def on_trash(self):\n        \"\"\"Called when document is trashed\"\"\"\n        pass\n\n    def after_restore(self):\n        \"\"\"Called after document is restored from trash\"\"\"\n        pass\n\n    # ===== CUSTOM METHODS =====\n\n    def set_defaults(self):\n        \"\"\"Set default values\"\"\"\n        if not self.posting_date:\n            self.posting_date = nowdate()\n        if not self.company:\n            self.company = frappe.defaults.get_user_default(\"Company\")\n\n    def validate_dates(self):\n        \"\"\"Validate date fields\"\"\"\n        if self.end_date and getdate(self.start_date) > getdate(self.end_date):\n            frappe.throw(_(\"End Date cannot be before Start Date\"))\n\n        if getdate(self.posting_date) > getdate(nowdate()):\n            frappe.throw(_(\"Posting Date cannot be in the future\"))\n\n    def validate_amounts(self):\n        \"\"\"Validate amount fields\"\"\"\n        for item in self.items:\n            if flt(item.qty) <= 0:\n                frappe.throw(_(\"Row {0}: Quantity must be greater than 0\").format(item.idx))\n            if flt(item.rate) < 0:\n                frappe.throw(_(\"Row {0}: Rate cannot be negative\").format(item.idx))\n\n    def calculate_totals(self):\n        \"\"\"Calculate document totals\"\"\"\n        self.total = 0\n        for item in self.items:\n            item.amount = flt(item.qty) * flt(item.rate)\n            self.total += item.amount\n\n        self.tax_amount = flt(self.total) * flt(self.tax_rate) / 100\n        self.grand_total = flt(self.total) + flt(self.tax_amount)\n\n    def set_status(self):\n        \"\"\"Set document status based on state\"\"\"\n        if self.docstatus == 0:\n            self.status = \"Draft\"\n        elif self.docstatus == 1:\n            if self.is_completed():\n                self.status = \"Completed\"\n            else:\n                self.status = \"Submitted\"\n        elif self.docstatus == 2:\n            self.status = \"Cancelled\"\n\n    def is_completed(self):\n        \"\"\"Check if document is completed\"\"\"\n        return all(item.delivered_qty >= item.qty for item in self.items)\n```\n\n## Whitelisted APIs\n\n### Basic API\n\n```python\n@frappe.whitelist()\ndef get_customer_details(customer):\n    \"\"\"Get customer details\n\n    Args:\n        customer (str): Customer ID\n\n    Returns:\n        dict: Customer details with outstanding amount\n    \"\"\"\n    if not customer:\n        frappe.throw(_(\"Customer is required\"))\n\n    doc = frappe.get_doc(\"Customer\", customer)\n\n    return {\n        \"customer_name\": doc.customer_name,\n        \"customer_type\": doc.customer_type,\n        \"territory\": doc.territory,\n        \"credit_limit\": flt(doc.credit_limit),\n        \"outstanding\": get_customer_outstanding(customer)\n    }\n\n\n@frappe.whitelist()\ndef create_invoice(customer, items):\n    \"\"\"Create sales invoice from data\n\n    Args:\n        customer (str): Customer ID\n        items (str): JSON string of items\n\n    Returns:\n        str: Invoice name\n    \"\"\"\n    items = frappe.parse_json(items)\n\n    doc = frappe.get_doc({\n        \"doctype\": \"Sales Invoice\",\n        \"customer\": customer,\n        \"items\": [{\n            \"item_code\": item.get(\"item_code\"),\n            \"qty\": flt(item.get(\"qty\")),\n            \"rate\": flt(item.get(\"rate\"))\n        } for item in items]\n    })\n\n    doc.insert()\n    doc.submit()\n\n    return doc.name\n```\n\n### Guest API\n\n```python\n@frappe.whitelist(allow_guest=True)\ndef get_public_data():\n    \"\"\"Public API - no login required\"\"\"\n    return {\n        \"status\": \"ok\",\n        \"message\": \"This is public data\"\n    }\n```\n\n### Method-Restricted API\n\n```python\n@frappe.whitelist(methods=[\"POST\"])\ndef create_record(data):\n    \"\"\"Only accepts POST requests\"\"\"\n    data = frappe.parse_json(data)\n    doc = frappe.get_doc(data)\n    doc.insert()\n    return {\"name\": doc.name}\n\n\n@frappe.whitelist(methods=[\"GET\", \"POST\"])\ndef flexible_endpoint(**kwargs):\n    \"\"\"Accepts GET and POST\"\"\"\n    return kwargs\n```\n\n### Permission-Checked API\n\n```python\n@frappe.whitelist()\ndef sensitive_operation(doctype, name):\n    \"\"\"API with permission check\"\"\"\n    # Check permission\n    if not frappe.has_permission(doctype, \"write\", name):\n        frappe.throw(_(\"Not permitted\"), frappe.PermissionError)\n\n    # Proceed with operation\n    doc = frappe.get_doc(doctype, name)\n    # ... do something\n\n    return {\"status\": \"success\"}\n```\n\n## Database Operations\n\n### Reading Data\n\n```python\n# Get single document\ndoc = frappe.get_doc(\"Customer\", \"CUST-001\")\n\n# Get with filters\ndoc = frappe.get_doc(\"Customer\", {\"customer_name\": \"John Corp\"})\n\n# Get single value\nname = frappe.db.get_value(\"Customer\", \"CUST-001\", \"customer_name\")\n\n# Get multiple values\nvalues = frappe.db.get_value(\"Customer\", \"CUST-001\",\n    [\"customer_name\", \"territory\"], as_dict=True)\n\n# Get list\ncustomers = frappe.db.get_all(\"Customer\",\n    filters={\"status\": \"Active\"},\n    fields=[\"name\", \"customer_name\", \"territory\"],\n    order_by=\"customer_name asc\",\n    limit=10\n)\n\n# Complex filters\ninvoices = frappe.db.get_all(\"Sales Invoice\",\n    filters={\n        \"status\": [\"in\", [\"Paid\", \"Unpaid\"]],\n        \"grand_total\": [\">\", 1000],\n        \"posting_date\": [\">=\", \"2024-01-01\"],\n        \"customer\": [\"like\", \"%Corp%\"]\n    },\n    fields=[\"name\", \"customer\", \"grand_total\"]\n)\n\n# Pluck single field\nnames = frappe.db.get_all(\"Customer\",\n    filters={\"status\": \"Active\"},\n    pluck=\"name\"\n)\n\n# Count\ncount = frappe.db.count(\"Customer\", {\"status\": \"Active\"})\n\n# Exists check\nexists = frappe.db.exists(\"Customer\", \"CUST-001\")\n```\n\n### Raw SQL\n\n```python\n# Simple query\nresult = frappe.db.sql(\"\"\"\n    SELECT name, customer_name, grand_total\n    FROM `tabSales Invoice`\n    WHERE status = %s AND grand_total > %s\n    ORDER BY creation DESC\n    LIMIT 10\n\"\"\", (\"Paid\", 1000), as_dict=True)\n\n# Named parameters\nresult = frappe.db.sql(\"\"\"\n    SELECT * FROM `tabCustomer`\n    WHERE territory = %(territory)s\n    AND status = %(status)s\n\"\"\", {\"territory\": \"West\", \"status\": \"Active\"}, as_dict=True)\n\n# Aggregation\ntotal = frappe.db.sql(\"\"\"\n    SELECT SUM(grand_total) as total\n    FROM `tabSales Invoice`\n    WHERE status = 'Paid'\n\"\"\")[0][0] or 0\n```\n\n### Writing Data\n\n```python\n# Create document\ndoc = frappe.get_doc({\n    \"doctype\": \"Customer\",\n    \"customer_name\": \"New Customer\",\n    \"customer_type\": \"Company\"\n})\ndoc.insert()\n\n# Update document\ndoc = frappe.get_doc(\"Customer\", \"CUST-001\")\ndoc.customer_name = \"Updated Name\"\ndoc.save()\n\n# Quick update (bypasses controller)\nfrappe.db.set_value(\"Customer\", \"CUST-001\", \"status\", \"Inactive\")\n\n# Update multiple fields\nfrappe.db.set_value(\"Customer\", \"CUST-001\", {\n    \"status\": \"Inactive\",\n    \"disabled\": 1\n})\n\n# Delete\nfrappe.delete_doc(\"Customer\", \"CUST-001\")\n\n# Commit transaction\nfrappe.db.commit()\n\n# Rollback\nfrappe.db.rollback()\n```\n\n## Background Jobs\n\n### Enqueue Jobs\n\n```python\n# Basic enqueue\nfrappe.enqueue(\n    \"my_app.tasks.process_data\",\n    queue=\"default\",\n    customer=\"CUST-001\"\n)\n\n# With options\nfrappe.enqueue(\n    method=\"my_app.tasks.heavy_task\",\n    queue=\"long\",        # short, default, long\n    timeout=1800,        # 30 minutes\n    is_async=True,\n    job_name=\"Heavy Task\",\n    now=False,           # True to run immediately\n    enqueue_after_commit=True,\n    # Task arguments\n    document_name=\"DOC-001\",\n    data={\"key\": \"value\"}\n)\n```\n\n### Task Function\n\n```python\n# my_app/tasks.py\nimport frappe\n\ndef process_data(customer):\n    \"\"\"Background task\"\"\"\n    frappe.init(site=frappe.local.site)\n    frappe.connect()\n\n    try:\n        # Process logic\n        doc = frappe.get_doc(\"Customer\", customer)\n        doc.last_processed = frappe.utils.now()\n        doc.save()\n        frappe.db.commit()\n    except Exception:\n        frappe.log_error(title=\"Process Data Failed\")\n        raise\n    finally:\n        frappe.destroy()\n```\n\n### Scheduled Jobs (hooks.py)\n\n```python\nscheduler_events = {\n    \"all\": [\n        \"my_app.tasks.every_minute\"\n    ],\n    \"daily\": [\n        \"my_app.tasks.daily_report\"\n    ],\n    \"hourly\": [\n        \"my_app.tasks.hourly_sync\"\n    ],\n    \"cron\": {\n        \"0 9 * * 1\": [\n            \"my_app.tasks.monday_morning\"\n        ],\n        \"*/15 * * * *\": [\n            \"my_app.tasks.every_15_min\"\n        ]\n    }\n}\n```\n\n## Error Handling\n\n```python\nfrom frappe import _\nfrom frappe.exceptions import ValidationError, PermissionError\n\ndef my_function():\n    # Throw with message\n    frappe.throw(_(\"Invalid data\"))\n\n    # Throw with title\n    frappe.throw(_(\"Cannot proceed\"), title=_(\"Error\"))\n\n    # Throw with exception type\n    frappe.throw(_(\"Permission denied\"), exc=PermissionError)\n\n    # Message without stopping\n    frappe.msgprint(_(\"Warning: Check your data\"))\n\n    # Log error\n    frappe.log_error(\n        title=\"My Error\",\n        message=frappe.get_traceback()\n    )\n\n    # Try-except\n    try:\n        risky_operation()\n    except Exception:\n        frappe.log_error(\"Operation failed\")\n        frappe.throw(_(\"Something went wrong\"))\n```\n\n## Utilities\n\n```python\nfrom frappe.utils import (\n    nowdate, nowtime, now_datetime, today,\n    getdate, get_datetime,\n    add_days, add_months, add_years,\n    date_diff, time_diff_in_seconds,\n    flt, cint, cstr,\n    fmt_money, rounded,\n    strip_html, escape_html\n)\n\n# Date operations\ntoday = nowdate()  # \"2024-01-15\"\nweek_later = add_days(nowdate(), 7)\nmonth_end = frappe.utils.get_last_day(nowdate())\n\n# Number operations\namount = flt(value, 2)  # Float with precision\ncount = cint(value)     # Integer\n\n# Formatting\nmoney = fmt_money(1234.56, currency=\"USD\")\n\n# Current user\nuser = frappe.session.user\nroles = frappe.get_roles()\n```\n\n## Email & Notifications\n\n```python\n# Send email\nfrappe.sendmail(\n    recipients=[\"user@example.com\"],\n    subject=\"Subject\",\n    message=\"Email body\",\n    reference_doctype=\"Sales Invoice\",\n    reference_name=\"SINV-00001\"\n)\n\n# With template\nfrappe.sendmail(\n    recipients=[\"user@example.com\"],\n    subject=\"Order Confirmation\",\n    template=\"order_confirmation\",\n    args={\n        \"customer_name\": \"John\",\n        \"order_id\": \"ORD-001\"\n    }\n)\n\n# Real-time notification\nfrappe.publish_realtime(\n    \"msgprint\",\n    {\"message\": \"Task completed\"},\n    user=\"user@example.com\"\n)\n```\n\n## Document Events via Hooks\n\n```python\n# hooks.py\ndoc_events = {\n    \"Sales Invoice\": {\n        \"validate\": \"my_app.overrides.validate_invoice\",\n        \"on_submit\": \"my_app.overrides.on_submit_invoice\",\n        \"on_cancel\": \"my_app.overrides.on_cancel_invoice\"\n    },\n    \"*\": {\n        \"on_update\": \"my_app.overrides.log_all_changes\"\n    }\n}\n```\n\n```python\n# my_app/overrides.py\nimport frappe\n\ndef validate_invoice(doc, method):\n    \"\"\"Called during Sales Invoice validation\"\"\"\n    if doc.grand_total > 100000:\n        if not doc.manager_approval:\n            frappe.throw(_(\"Manager approval required for orders above 100,000\"))\n\ndef on_submit_invoice(doc, method):\n    \"\"\"Called when Sales Invoice is submitted\"\"\"\n    create_delivery_note(doc)\n    notify_warehouse(doc)\n```"
              }
            ]
          }
        ]
      }
    }
  ]
}