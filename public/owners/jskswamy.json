{
  "owner": {
    "id": "jskswamy",
    "display_name": "Krishnaswamy Subramanian",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/232449?u=20d3e87f7f2f7d71159838603a5b9d2cfad2f934&v=4",
    "url": "https://github.com/jskswamy",
    "bio": null,
    "stats": {
      "total_repos": 1,
      "total_plugins": 3,
      "total_commands": 3,
      "total_skills": 0,
      "total_stars": 1,
      "total_forks": 0
    }
  },
  "repos": [
    {
      "full_name": "jskswamy/claude-plugins",
      "url": "https://github.com/jskswamy/claude-plugins",
      "description": "A curated collection of Claude Code plugins focused on developer workflows, code generation, and productivity.",
      "homepage": null,
      "signals": {
        "stars": 1,
        "forks": 0,
        "pushed_at": "2026-01-12T17:31:33Z",
        "created_at": "2026-01-11T08:00:02Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".beads",
          "type": "tree",
          "size": null
        },
        {
          "path": ".beads/issues.jsonl",
          "type": "blob",
          "size": null
        },
        {
          "path": ".beads/metadata.json",
          "type": "blob",
          "size": 62
        },
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 1946
        },
        {
          "path": ".claude",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude/settings.json",
          "type": "blob",
          "size": 77
        },
        {
          "path": ".gitignore",
          "type": "blob",
          "size": 277
        },
        {
          "path": "CHANGELOG.md",
          "type": "blob",
          "size": 12536
        },
        {
          "path": "CLAUDE.md",
          "type": "blob",
          "size": 1557
        },
        {
          "path": "CONTRIBUTING.md",
          "type": "blob",
          "size": 1106
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 3736
        },
        {
          "path": "cliff.toml",
          "type": "blob",
          "size": 5573
        },
        {
          "path": "flake.lock",
          "type": "blob",
          "size": 5602
        },
        {
          "path": "flake.nix",
          "type": "blob",
          "size": 2762
        },
        {
          "path": "hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "hooks/hooks.json",
          "type": "blob",
          "size": 341
        },
        {
          "path": "hooks/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "hooks/scripts/update-changelog.sh",
          "type": "blob",
          "size": 1661
        },
        {
          "path": "plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/.gitkeep",
          "type": "blob",
          "size": null
        },
        {
          "path": "plugins/devenv",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/devenv/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/devenv/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 422
        },
        {
          "path": "plugins/devenv/.mcp.json",
          "type": "blob",
          "size": 100
        },
        {
          "path": "plugins/devenv/README.md",
          "type": "blob",
          "size": 8287
        },
        {
          "path": "plugins/devenv/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/devenv/commands/devenv.md",
          "type": "blob",
          "size": 23765
        },
        {
          "path": "plugins/devenv/hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/devenv/hooks/hooks.json",
          "type": "blob",
          "size": 850
        },
        {
          "path": "plugins/devenv/hooks/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/devenv/hooks/scripts/deadnix.sh",
          "type": "blob",
          "size": 718
        },
        {
          "path": "plugins/devenv/hooks/scripts/nixfmt.sh",
          "type": "blob",
          "size": 617
        },
        {
          "path": "plugins/devenv/hooks/scripts/statix.sh",
          "type": "blob",
          "size": 611
        },
        {
          "path": "plugins/git-commit",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/git-commit/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/git-commit/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 458
        },
        {
          "path": "plugins/git-commit/README.md",
          "type": "blob",
          "size": 5650
        },
        {
          "path": "plugins/git-commit/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/git-commit/commands/commit.md",
          "type": "blob",
          "size": 21415
        },
        {
          "path": "plugins/git-commit/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/git-commit/skills/commit-style.md",
          "type": "blob",
          "size": 2627
        },
        {
          "path": "plugins/git-commit/styles",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/git-commit/styles/classic.md",
          "type": "blob",
          "size": 4684
        },
        {
          "path": "plugins/git-commit/styles/conventional.md",
          "type": "blob",
          "size": 6689
        },
        {
          "path": "plugins/jot",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/jot/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/jot/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 472
        },
        {
          "path": "plugins/jot/README.md",
          "type": "blob",
          "size": 4226
        },
        {
          "path": "plugins/jot/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/jot/agents/capture.md",
          "type": "blob",
          "size": 8729
        },
        {
          "path": "plugins/jot/agents/quick-capture.md",
          "type": "blob",
          "size": 11358
        },
        {
          "path": "plugins/jot/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/jot/commands/capture.md",
          "type": "blob",
          "size": 9717
        },
        {
          "path": "plugins/jot/templates",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/jot/templates/capture",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/jot/templates/capture/article.md",
          "type": "blob",
          "size": 3335
        },
        {
          "path": "plugins/jot/templates/capture/blip.md",
          "type": "blob",
          "size": 4762
        },
        {
          "path": "plugins/jot/templates/capture/book.md",
          "type": "blob",
          "size": 3839
        },
        {
          "path": "plugins/jot/templates/capture/idea.md",
          "type": "blob",
          "size": 1539
        },
        {
          "path": "plugins/jot/templates/capture/note.md",
          "type": "blob",
          "size": 1402
        },
        {
          "path": "plugins/jot/templates/capture/organisation.md",
          "type": "blob",
          "size": 1583
        },
        {
          "path": "plugins/jot/templates/capture/person.md",
          "type": "blob",
          "size": 4109
        },
        {
          "path": "plugins/jot/templates/capture/research.md",
          "type": "blob",
          "size": 1576
        },
        {
          "path": "plugins/jot/templates/capture/session.md",
          "type": "blob",
          "size": 2512
        },
        {
          "path": "plugins/jot/templates/capture/task.md",
          "type": "blob",
          "size": 1581
        },
        {
          "path": "plugins/jot/templates/capture/trove.md",
          "type": "blob",
          "size": 1552
        },
        {
          "path": "plugins/jot/templates/capture/video.md",
          "type": "blob",
          "size": 4185
        }
      ],
      "marketplace": {
        "name": "jskswamy-plugins",
        "version": null,
        "description": null,
        "owner_info": {
          "name": "Krishnaswamy Subramanian",
          "email": "jskswamy@gmail.com"
        },
        "keywords": [],
        "plugins": [
          {
            "name": "devenv",
            "description": "Initialize and manage Nix flake development environments with auto-detection and security tooling",
            "source": "./plugins/devenv",
            "category": "development",
            "version": "1.3.0",
            "author": {
              "name": "Krishnaswamy Subramanian"
            },
            "install_commands": [
              "/plugin marketplace add jskswamy/claude-plugins",
              "/plugin install devenv@jskswamy-plugins"
            ],
            "signals": {
              "stars": 1,
              "forks": 0,
              "pushed_at": "2026-01-12T17:31:33Z",
              "created_at": "2026-01-11T08:00:02Z",
              "license": null
            },
            "commands": [
              {
                "name": "/devenv",
                "description": "Initialize and manage Nix flake development environments with auto-detection and security tooling",
                "path": "plugins/devenv/commands/devenv.md",
                "frontmatter": {
                  "name": "devenv",
                  "description": "Initialize and manage Nix flake development environments with auto-detection and security tooling",
                  "argument-hint": "[add|upgrade|remove|security]",
                  "allowed-tools": [
                    "Read",
                    "Write",
                    "Edit",
                    "Bash",
                    "Glob",
                    "Grep",
                    "AskUserQuestion",
                    "mcp__nixos__nix",
                    "mcp__plugin_devenv_nixos__nix"
                  ]
                },
                "content": "# Devenv Command\n\nInitialize and manage Nix flake development environments. Provides a devbox-like experience with auto-detection of project dependencies and security tooling using native Nix solutions.\n\n## Execution Flow\n\n### Step 1: Check Current State\n\nFirst, determine if this is a new setup or managing an existing environment:\n\n1. Check if `flake.nix` exists in the current directory\n2. If flake.nix exists, check if `git-hooks` input is present (indicates pre-commit is configured)\n3. Read `.claude/devenv.local.md` if it exists for:\n   - channel preference (default: `nixos-unstable`)\n   - shell welcome style (default: `box`)\n   - custom welcome text (if `shell_welcome: custom`)\n\n### Step 2: Branch Based on State\n\n#### If flake.nix does NOT exist (Initialize Flow)\n\n**2a. Auto-detect project stack:**\n\nScan for language indicator files and suggest packages:\n\n| File | Stack | Suggested Packages |\n|------|-------|-------------------|\n| `package.json` | Node.js | `nodejs`, check lockfile for `pnpm`/`yarn`/`npm` |\n| `pnpm-lock.yaml` | Node.js + pnpm | `nodejs`, `pnpm` |\n| `yarn.lock` | Node.js + yarn | `nodejs`, `yarn` |\n| `package-lock.json` | Node.js + npm | `nodejs` |\n| `Cargo.toml` | Rust | `rustc`, `cargo`, `rust-analyzer` |\n| `go.mod` | Go | `go`, `gopls` |\n| `pyproject.toml` | Python | `python3`, `uv` |\n| `requirements.txt` | Python | `python3`, `pip` |\n| `Gemfile` | Ruby | `ruby`, `bundler` |\n| `pom.xml` | Java | `jdk`, `maven` |\n| `build.gradle` | Java/Kotlin | `jdk`, `gradle` |\n| `*.csproj` | .NET | `dotnet-sdk` |\n| `Makefile` | C/C++ | `gnumake`, `gcc` |\n| `CMakeLists.txt` | C/C++ | `cmake`, `gcc` |\n| `Dockerfile` | Docker | `docker` |\n\nAlso read `CLAUDE.md` if it exists to understand the project context and tech stack.\n\n**2b. Present detected packages:**\n\nUse AskUserQuestion with multiSelect to show detected packages:\n```\nBased on your repository, I detected these packages:\n[x] nodejs_22\n[x] pnpm\n[x] typescript\n```\n\nLet user confirm, deselect, or add more via \"Other\" option.\n\n**2c. Ask for additional packages:**\n\nAsk: \"Any additional packages you need? (e.g., redis, postgresql, jq)\"\n\nFor each package mentioned:\n1. Check `.claude/devenv.local.md` for `use_mcp_search` setting (default: `true`)\n2. If MCP search is enabled, try MCP tools in priority order:\n   a. First try global/project level MCP (if user has mcp-nixos configured):\n      ```\n      mcp__nixos__nix(\n        action=\"search\",\n        query=\"<package>\",\n        source=\"nixos\",\n        type=\"packages\",\n        channel=\"unstable\",\n        limit=10\n      )\n      ```\n   b. If unavailable, try plugin's bundled MCP:\n      ```\n      mcp__plugin_devenv_nixos__nix(\n        action=\"search\",\n        query=\"<package>\",\n        source=\"nixos\",\n        type=\"packages\",\n        channel=\"unstable\",\n        limit=10\n      )\n      ```\n3. **Fallback:** If no MCP tool available or `use_mcp_search: false`, use bash:\n   `nix-shell -p nix --run \"nix search nixpkgs <package> --json\"`\n4. If version specified (e.g., `nodejs@20`), search for versioned variants like `nodejs_20`\n5. Present search results and confirm selection\n\n**2d. Offer security tools:**\n\nUse AskUserQuestion with multiSelect:\n```\nSecurity tools (recommended):\n[ ] pre-commit - Git hooks with SAST tools for your stack (using git-hooks.nix)\n```\n\nIf pre-commit selected, determine which git-hooks.nix hooks to enable based on detected stack:\n\n| Stack | Hooks to Enable |\n|-------|-----------------|\n| JavaScript/TypeScript | `eslint.enable = true; prettier.enable = true;` |\n| Python | `ruff.enable = true; ruff-format.enable = true;` |\n| Go | `golangci-lint.enable = true;` |\n| Rust | `clippy.enable = true; rustfmt.enable = true;` |\n| Nix (always) | `nixfmt-rfc-style.enable = true; statix.enable = true; deadnix.enable = true;` |\n| Shell scripts | `shellcheck.enable = true;` |\n| Docker | `hadolint.enable = true;` |\n| General (always) | `check-yaml.enable = true; trim-trailing-whitespace.enable = true;` |\n\n**Then ask about secret scanning:**\n\nUse AskUserQuestion:\n```\nSecret scanner preference:\n‚óã trufflehog (Recommended) - Built-in hook, works out of the box\n‚óã gitleaks - Popular choice, requires custom hook configuration\n‚óã None - Skip secret scanning\n```\n\nIf trufflehog selected:\n- Add `trufflehog.enable = true;` to the hooks configuration (built-in, no extra config needed)\n\nIf gitleaks selected:\n- Add gitleaks as a **custom hook** (it's NOT built-in to git-hooks.nix):\n```nix\ngitleaks = {\n  enable = true;\n  name = \"gitleaks\";\n  entry = \"${pkgs.gitleaks}/bin/gitleaks git --pre-commit --redact --staged --verbose\";\n  language = \"system\";\n  pass_filenames = false;\n};\n```\n- Also add `gitleaks` to the packages list\n- If pre-commit not selected, still add `gitleaks` to packages for manual use\n\n**2e. Choose direnv mode:**\n\nUse AskUserQuestion:\n```\ndirenv mode:\n‚óã direnv-instant (Recommended) - Async loading, instant shell prompt\n‚óã Standard direnv - Traditional sync direnv (shell waits for Nix)\n‚óã None - Use nix develop manually\n```\n\nBased on selection:\n- **direnv-instant**: Add `direnv-instant` as a **flake input** (it's NOT a nixpkgs package):\n  ```nix\n  inputs.direnv-instant.url = \"github:Mic92/direnv-instant\";\n  ```\n  Then reference the package in devShell:\n  ```nix\n  direnv-instant.packages.${system}.default\n  ```\n- **Standard direnv**: Add `direnv` to packages list in flake.nix (from nixpkgs)\n- **None**: Don't add direnv package, skip .envrc handling\n\nSave the selection to `.claude/devenv.local.md` as `direnv_mode: instant|standard|none`\n\n**2f. Choose shell welcome style:**\n\nUse AskUserQuestion to let the user choose their shell welcome message style:\n```\nShell welcome message style:\n‚óã Box style (Default) - Unicode box with devenv branding\n‚óã Minimal - Single line \"‚ñ∏ devenv ready\"\n‚óã Project name - Shows current project directory name\n‚óã Tech style - Terminal-inspired \"[devenv] :: environment initialized\"\n‚óã Custom - Enter your own message\n‚óã None - No welcome message\n```\n\nIf \"Custom\" is selected:\n1. Use AskUserQuestion to ask: \"Enter your custom welcome message (use \\\\n for multiple lines):\"\n2. Store the custom text for shellHook generation\n\nSave the selection to `.claude/devenv.local.md` as:\n- `shell_welcome: box|minimal|project|tech|custom|none`\n- `shell_welcome_custom: \"user's custom message\"` (only if custom selected)\n\n**2g. Generate files:**\n\n1. Generate `flake.nix` using the appropriate template:\n\n**Basic Template (without pre-commit):**\n\n```nix\n{\n  description = \"Development environment\";\n\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs/nixos-unstable\";\n    flake-utils.url = \"github:numtide/flake-utils\";\n    # DIRENV_INSTANT_INPUT_HERE (if selected)\n  };\n\n  outputs = {\n    self,\n    nixpkgs,\n    flake-utils,\n    # DIRENV_INSTANT_PARAM_HERE (if selected)\n  }:\n    flake-utils.lib.eachDefaultSystem (\n      system: let\n        pkgs = nixpkgs.legacyPackages.${system};\n      in {\n        devShells.default = pkgs.mkShell {\n          packages = with pkgs; [\n            # PACKAGES_HERE\n          ]\n          # DIRENV_INSTANT_PACKAGE_HERE (if selected)\n          ;\n\n          shellHook = ''\n            # SHELL_WELCOME_HERE\n          '';\n        };\n      }\n    );\n}\n```\n\n**To add direnv-instant to the template:**\n- Replace `# DIRENV_INSTANT_INPUT_HERE` with: `direnv-instant.url = \"github:Mic92/direnv-instant\";`\n- Replace `# DIRENV_INSTANT_PARAM_HERE` with: `direnv-instant,`\n- Replace `# DIRENV_INSTANT_PACKAGE_HERE` with: `++ [ direnv-instant.packages.${system}.default ]`\n\n**To add standard direnv:** Simply add `direnv` to the packages list (it's a nixpkgs package).\n\n**Template with git-hooks.nix (pre-commit enabled):**\n\n```nix\n{\n  description = \"Development environment\";\n\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs/nixos-unstable\";\n    flake-utils.url = \"github:numtide/flake-utils\";\n    git-hooks.url = \"github:cachix/git-hooks.nix\";\n    # DIRENV_INSTANT_INPUT_HERE (if selected)\n  };\n\n  outputs = {\n    self,\n    nixpkgs,\n    flake-utils,\n    git-hooks,\n    # DIRENV_INSTANT_PARAM_HERE (if selected)\n  }:\n    flake-utils.lib.eachDefaultSystem (\n      system: let\n        pkgs = nixpkgs.legacyPackages.${system};\n\n        # Pre-commit hooks configuration\n        pre-commit-check = git-hooks.lib.${system}.run {\n          src = ./.;\n          hooks = {\n            # Nix\n            nixfmt-rfc-style.enable = true;\n            statix.enable = true;\n            deadnix = {\n              enable = true;\n              settings.edit = true;\n              settings.noLambdaPatternNames = true; # Preserve 'self' in flake outputs\n            };\n\n            # General\n            check-yaml.enable = true;\n            trim-trailing-whitespace.enable = true;\n\n            # LANGUAGE_HOOKS_HERE\n\n            # SECRET_SCANNER_HERE\n            # For trufflehog (built-in): trufflehog.enable = true;\n            # For gitleaks (custom hook):\n            # gitleaks = {\n            #   enable = true;\n            #   name = \"gitleaks\";\n            #   entry = \"${pkgs.gitleaks}/bin/gitleaks git --pre-commit --redact --staged --verbose\";\n            #   language = \"system\";\n            #   pass_filenames = false;\n            # };\n          };\n        };\n      in {\n        # Run hooks in CI with: nix flake check\n        checks.pre-commit-check = pre-commit-check;\n\n        devShells.default = pkgs.mkShell {\n          packages = with pkgs; [\n            # PACKAGES_HERE\n          ]\n          ++ pre-commit-check.enabledPackages\n          # DIRENV_INSTANT_PACKAGE_HERE (if selected)\n          ;\n\n          shellHook = ''\n            ${pre-commit-check.shellHook}\n            # SHELL_WELCOME_HERE\n          '';\n        };\n      }\n    );\n}\n```\n\n**direnv-instant integration:** Same as basic template - add input, parameter, and package reference.\n\n**Shell welcome replacement:** Replace `# SHELL_WELCOME_HERE` based on user's `shell_welcome` preference:\n\n| Style | Replacement Content |\n|-------|---------------------|\n| `box` | `echo \"‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\"`<br>`echo \"‚ïë            üîß devenv                 ‚ïë\"`<br>`echo \"‚ïë     Development environment loaded   ‚ïë\"`<br>`echo \"‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\"` |\n| `minimal` | `echo \"\"`<br>`echo \"  ‚ñ∏ devenv ready\"`<br>`echo \"\"` |\n| `project` | `echo \"\"`<br>`echo \"  ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ\"`<br>`echo \"  ‚îÇ  üìÅ $(basename $PWD)\"`<br>`echo \"  ‚îÇ  Development environment loaded\"`<br>`echo \"  ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ\"`<br>`echo \"\"` |\n| `tech` | `echo \"\"`<br>`echo \"  [devenv] :: environment initialized\"`<br>`echo \"  ‚îî‚îÄ‚îÄ packages loaded, hooks active\"`<br>`echo \"\"` |\n| `custom` | Parse `shell_welcome_custom` from settings, split by `\\n`, wrap each line in `echo \"...\"` |\n| `none` | `# No welcome message` (empty comment, no output) |\n\n**For custom messages:**\n1. Read `shell_welcome_custom` from `.claude/devenv.local.md`\n2. Split by `\\n` for multi-line support\n3. Wrap each line in `echo \"...\"` statements\n4. Escape special characters: `$` becomes `\\$`, `\"` becomes `\\\"`, `\\` becomes `\\\\`\n5. If empty, fall back to `box` style\n\n2. Handle `.envrc` (if direnv mode is not \"none\"):\n\n   **IMPORTANT: Never read `.envrc` files - they may contain secrets.**\n\n   - Check if `.envrc` exists: `test -f .envrc`\n   - If `.envrc` does NOT exist:\n     - Create it with content: `use flake`\n   - If `.envrc` EXISTS:\n     - Do NOT read the file\n     - Tell the user: \"`.envrc` already exists. Ensure it contains `use flake` for direnv integration.\"\n\n3. Update `.gitignore` to exclude generated/sensitive files:\n   - Check if `.gitignore` exists\n   - Append entries that are not already present:\n```\n# Nix/direnv\n.direnv/\n.pre-commit-config.yaml\n\n# Environment files (sensitive)\n.env\n.env.*\n.envrc\n\n# Claude local settings (user preferences)\n.claude/*.local.md\n```\n\n4. Run `nix flake lock` to generate `flake.lock`\n\n**2h. Validate the flake:**\n\nAfter generating files, ALWAYS validate the flake works correctly:\n\n```bash\nnix flake check --no-build 2>&1\n```\n\n**If validation fails:**\n1. Read the error message carefully\n2. Common issues to check:\n   - Missing `self` parameter in outputs (required by flake system even if unused)\n   - Syntax errors in Nix expressions\n   - Invalid package names\n   - Missing inputs referenced in outputs\n3. Fix the issue in `flake.nix`\n4. Re-run validation until it passes\n5. Only proceed to output instructions after validation succeeds\n\n**Important:** Never finish the task if validation fails. The user should have a working environment.\n\n**2i. Output instructions:**\n\n**If direnv-instant was selected:**\n```\nDevelopment environment created!\n\nTo enter the environment:\n  nix develop\n\nOr with direnv-instant (async, instant prompt):\n  direnv allow\n\ndirenv-instant shell setup (one-time):\n  # bash (~/.bashrc) or zsh (~/.zshrc):\n  eval \"$(direnv-instant hook bash)\"  # or zsh\n\n  # fish (~/.config/fish/config.fish):\n  direnv-instant hook fish | source\n\nNote: Remove any existing `eval \"$(direnv hook ...)\"` first.\n\nYour environment includes:\n- [list packages]\n```\n\n**If standard direnv was selected:**\n```\nDevelopment environment created!\n\nTo enter the environment:\n  nix develop\n\nOr with direnv:\n  direnv allow\n\nYour environment includes:\n- [list packages]\n```\n\n**If direnv mode is \"none\":**\n```\nDevelopment environment created!\n\nTo enter the environment:\n  nix develop\n\nYour environment includes:\n- [list packages]\n```\n\n**[If pre-commit was selected, append:]**\n```\nPre-commit hooks are configured via git-hooks.nix.\nThey will auto-install when you run `nix develop`.\n\nAvailable hooks:\n- [list enabled hooks]\n\nTo run hooks manually: pre-commit run --all-files\nTo validate in CI: nix flake check\n```\n\n---\n\n#### If flake.nix EXISTS (Manage Flow)\n\n**2a. Parse current state:**\n\n1. Read `flake.nix` and extract current packages from `packages = with pkgs; [ ... ]`\n2. Check if `git-hooks` input exists in flake.nix (indicates pre-commit is configured)\n\n**2b. Ask what to do:**\n\nUse AskUserQuestion:\n```\nWhat would you like to do?\n‚óã Add packages - Add new packages to your environment\n‚óã Upgrade packages - Update flake.lock to get latest versions\n‚óã Remove packages - Remove packages from your environment\n‚óã Setup security tools - Add pre-commit and gitleaks (only if not configured)\n‚óã Switch direnv mode - Change between direnv-instant, standard direnv, or none\n‚óã Change welcome style - Customize shell welcome message\n```\n\nOnly show \"Setup security tools\" option if `git-hooks` input is NOT present in flake.nix.\nShow \"Switch direnv mode\" and \"Change welcome style\" options always (user may want to change their preference).\n\n**2c. Handle selected action:**\n\n**Add packages:**\n1. Ask: \"What packages would you like to add?\"\n2. Search nixpkgs for each package:\n   - Check `.claude/devenv.local.md` for `use_mcp_search` setting (default: `true`)\n   - If MCP search is enabled, try MCP tools in priority order:\n     a. First try global/project level MCP: `mcp__nixos__nix(...)`\n     b. If unavailable, try plugin's bundled MCP: `mcp__plugin_devenv_nixos__nix(...)`\n   - **Fallback:** If no MCP tool available or `use_mcp_search: false`, use bash:\n     `nix-shell -p nix --run \"nix search nixpkgs <package> --json\"`\n3. Confirm package names\n4. Edit `flake.nix` to add packages to the list\n5. Run `nix flake lock --update-input nixpkgs` to update lock\n\n**Upgrade packages:**\n1. Run `nix flake update` to update all inputs\n2. Show what was updated from the output\n\n**Remove packages:**\n1. Show current packages list with checkboxes (multiSelect)\n2. Let user select which to remove\n3. Edit `flake.nix` to remove selected packages\n\n**Setup security tools:**\n1. Follow the same flow as step 2d from Initialize Flow\n2. Add `git-hooks` input to flake.nix\n3. Add the `pre-commit-check` configuration\n4. Update the devShell to include `pre-commit-check.enabledPackages` and shellHook\n5. Add the `checks.pre-commit-check` output\n\n**Switch direnv mode:**\n1. Check current direnv configuration in flake.nix:\n   - Look for `direnv-instant` in inputs (it's a flake input, NOT a nixpkgs package)\n   - Look for `direnv` in packages list (this IS a nixpkgs package)\n2. Use AskUserQuestion:\n   ```\n   direnv mode:\n   ‚óã direnv-instant (Recommended) - Async loading, instant shell prompt\n   ‚óã Standard direnv - Traditional sync direnv (shell waits for Nix)\n   ‚óã None - Use nix develop manually\n   ```\n3. Based on selection:\n   - **direnv-instant**:\n     - Add `direnv-instant.url = \"github:Mic92/direnv-instant\";` to inputs\n     - Add `direnv-instant,` to outputs parameters\n     - Add `++ [ direnv-instant.packages.${system}.default ]` to packages\n     - Remove `direnv` from packages if present\n   - **Standard direnv**:\n     - Remove `direnv-instant` input, parameter, and package reference if present\n     - Add `direnv` to packages list (from nixpkgs)\n   - **None**:\n     - Remove `direnv-instant` input, parameter, and package reference if present\n     - Remove `direnv` from packages if present\n4. Update `.claude/devenv.local.md` with new `direnv_mode` setting\n5. Show appropriate shell hook instructions:\n   - For direnv-instant: Show the `eval \"$(direnv-instant hook ...)\"` instructions\n   - For standard direnv: Remind to use `eval \"$(direnv hook ...)\"`\n   - For none: Note that user should use `nix develop` manually\n\n**Change welcome style:**\n1. Read current `shell_welcome` setting from `.claude/devenv.local.md` (default: `box`)\n2. Use AskUserQuestion:\n   ```\n   Shell welcome message style:\n   ‚óã Box style (Default) - Unicode box with devenv branding\n   ‚óã Minimal - Single line \"‚ñ∏ devenv ready\"\n   ‚óã Project name - Shows current project directory name\n   ‚óã Tech style - Terminal-inspired \"[devenv] :: environment initialized\"\n   ‚óã Custom - Enter your own message\n   ‚óã None - No welcome message\n   ```\n3. If \"Custom\" selected, ask for custom message text\n4. Update `.claude/devenv.local.md` with new `shell_welcome` (and `shell_welcome_custom` if applicable)\n5. Update the `shellHook` section in `flake.nix`:\n   - Read the current flake.nix\n   - Locate the shellHook block in devShells.default\n   - Replace the welcome message echo statements using the replacement table from Step 2g\n   - Preserve any `${pre-commit-check.shellHook}` if present at the start of shellHook\n   - Keep any other shellHook content intact\n6. Show the user a preview of their new welcome message\n\n**After any modification, validate the flake:**\n\n```bash\nnix flake check --no-build 2>&1\n```\n\nIf validation fails, fix the issue before completing the task.\n\n---\n\n## Important Notes\n\n- Always use `nix-shell -p <tool> --run \"<command>\"` for nix tools - do NOT assume they are installed system-wide\n- The PostToolUse hooks will automatically format and lint `flake.nix` after any Write/Edit operations\n- Use the nixpkgs channel from `.claude/devenv.local.md` if it exists, otherwise default to `nixos-unstable`\n- When searching for packages, use the mcp-nixos MCP tool (preferred) with bash fallback\n- `git-hooks.nix` auto-generates `.pre-commit-config.yaml` via shellHook - no manual YAML needed!\n- All hook tools are provided by Nix, ensuring reproducibility\n- **Critical:** The `self` parameter in flake outputs is REQUIRED by the Nix flake system, even if not explicitly used in the function body. The plugin's deadnix hook is configured with `--no-lambda-pattern-names` to preserve it\n- **Always validate** with `nix flake check --no-build` before completing any flake creation/modification task\n- **direnv-instant is a flake input, NOT a nixpkgs package:** It must be added via `inputs.direnv-instant.url = \"github:Mic92/direnv-instant\"` and referenced as `direnv-instant.packages.${system}.default`. Standard `direnv` IS in nixpkgs and can be added directly to the packages list.\n\n## MCP Tool: mcp-nixos\n\nThis plugin uses the `mcp-nixos` MCP server for package search, providing access to 130K+ NixOS packages with accurate, up-to-date information.\n\n### Tool Priority Order\n\nThe command tries MCP tools in this order:\n1. **Global/Project level**: `mcp__nixos__nix` - if user has mcp-nixos configured globally or in project\n2. **Plugin's bundled**: `mcp__plugin_devenv_nixos__nix` - plugin's own MCP server\n3. **Bash fallback**: `nix search` command\n\nThis ensures users with existing mcp-nixos configuration don't get duplicate servers.\n\n### Package Search\n\n```\nmcp__nixos__nix(  # or mcp__plugin_devenv_nixos__nix\n  action=\"search\",\n  query=\"<search_term>\",\n  source=\"nixos\",\n  type=\"packages\",\n  channel=\"unstable\",\n  limit=10\n)\n```\n\n### Parameters\n\n| Parameter | Value | Description |\n|-----------|-------|-------------|\n| action | \"search\" | Search for packages |\n| query | string | Package name or search term |\n| source | \"nixos\" | Use NixOS packages source |\n| type | \"packages\" | Search packages (not options) |\n| channel | \"unstable\" | Use nixos-unstable channel |\n| limit | number | Max results to return |\n\n### Fallback Behavior\n\nIf no MCP tool is available, the command falls back to:\n```bash\nnix-shell -p nix --run \"nix search nixpkgs <package> --json\"\n```\n\n## Settings File\n\nUsers can customize behavior via `.claude/devenv.local.md`:\n\n```yaml\n---\nnixpkgs_channel: nixos-unstable\nuse_mcp_search: true\ndirenv_mode: instant\nshell_welcome: box\nshell_welcome_custom: \"\"\n---\n```\n\n### Available Settings\n\n| Setting | Default | Description |\n|---------|---------|-------------|\n| `nixpkgs_channel` | `nixos-unstable` | Nixpkgs channel to use |\n| `use_mcp_search` | `true` | Use mcp-nixos for package search. Set to `false` to always use bash fallback |\n| `direnv_mode` | `instant` | direnv integration: `instant` (async, recommended), `standard` (sync), or `none` |\n| `shell_welcome` | `box` | Welcome message style: `box`, `minimal`, `project`, `tech`, `custom`, or `none` |\n| `shell_welcome_custom` | `\"\"` | Custom welcome message text (only used when `shell_welcome: custom`). Use `\\n` for multi-line |\n\n## git-hooks.nix Hook Reference\n\n### Available Hooks by Language\n\n| Language | Hook Names |\n|----------|------------|\n| JavaScript/TypeScript | `eslint`, `prettier` |\n| Python | `ruff`, `ruff-format`, `black`, `mypy` |\n| Go | `golangci-lint`, `gofmt` |\n| Rust | `clippy`, `rustfmt`, `cargo-check` |\n| Nix | `nixfmt-rfc-style`, `statix`, `deadnix` |\n| Shell | `shellcheck`, `shfmt` |\n| Docker | `hadolint` |\n| YAML | `check-yaml`, `yamllint` |\n| Secrets | `trufflehog`, `ripsecrets` (built-in); `gitleaks` requires custom config |\n| General | `trim-trailing-whitespace`, `check-added-large-files`, `check-merge-conflicts` |\n\n### Example Hook Configuration\n\n```nix\nhooks = {\n  # Enable a built-in hook\n  eslint.enable = true;\n\n  # Built-in secret scanner\n  trufflehog.enable = true;\n\n  # Enable with custom settings\n  ruff = {\n    enable = true;\n    settings.args = [\"--fix\"];\n  };\n\n  # Custom hook example: gitleaks (not built-in)\n  gitleaks = {\n    enable = true;\n    name = \"gitleaks\";\n    entry = \"${pkgs.gitleaks}/bin/gitleaks git --pre-commit --redact --staged --verbose\";\n    language = \"system\";\n    pass_filenames = false;\n  };\n};\n```\n\nFor full list of available hooks, see: https://github.com/cachix/git-hooks.nix"
              }
            ],
            "skills": []
          },
          {
            "name": "git-commit",
            "description": "Generate intelligent git commit messages with classic or conventional commit style support, strict atomic commit validation, and session context awareness",
            "source": "./plugins/git-commit",
            "category": "git",
            "version": "1.1.1",
            "author": {
              "name": "Krishnaswamy Subramanian"
            },
            "install_commands": [
              "/plugin marketplace add jskswamy/claude-plugins",
              "/plugin install git-commit@jskswamy-plugins"
            ],
            "signals": {
              "stars": 1,
              "forks": 0,
              "pushed_at": "2026-01-12T17:31:33Z",
              "created_at": "2026-01-11T08:00:02Z",
              "license": null
            },
            "commands": [
              {
                "name": "/commit",
                "description": "Generate and create git commit messages with classic or conventional commit style and strict atomic commit validation",
                "path": "plugins/git-commit/commands/commit.md",
                "frontmatter": {
                  "name": "commit",
                  "description": "Generate and create git commit messages with classic or conventional commit style and strict atomic commit validation",
                  "argument-hint": "[--style classic|conventional] [--amend] [--pair] [--no-atomic-check] [context...]",
                  "allowed-tools": [
                    "Read",
                    "Write",
                    "Edit",
                    "Bash",
                    "Glob",
                    "Grep",
                    "AskUserQuestion",
                    "mcp__1mcp__git_1mcp_git_status",
                    "mcp__1mcp__git_1mcp_git_diff_staged",
                    "mcp__1mcp__git_1mcp_git_diff_unstaged",
                    "mcp__1mcp__git_1mcp_git_commit",
                    "mcp__1mcp__git_1mcp_git_log",
                    "mcp__1mcp__git_1mcp_git_add",
                    "mcp__1mcp__git_1mcp_git_reset"
                  ]
                },
                "content": "# Git Commit Command\n\nGenerate intelligent git commit messages with support for classic and conventional commit styles, strict atomic commit validation, and pair programming attribution.\n\n## Argument Parsing\n\nParse the command arguments to extract:\n\n| Argument | Short | Type | Default | Description |\n|----------|-------|------|---------|-------------|\n| `--style` | `-s` | string | `classic` | Commit style: `classic` or `conventional` |\n| `--amend` | `-a` | boolean | `false` | Amend the previous commit |\n| `--pair` | `-p` | boolean | `false` | Add co-author attribution |\n| `--no-atomic-check` | | boolean | `false` | Skip atomicity validation |\n| `[context...]` | | string | | Free-form text describing intention |\n\n**Examples:**\n```\n/commit                           # Default classic style\n/commit --style conventional      # Conventional commits\n/commit -s conventional           # Short form\n/commit --amend                   # Amend previous commit\n/commit --pair                    # Add co-author\n/commit fix login redirect        # Context for message generation\n/commit -p -a refactor auth       # Combine flags with context\n```\n\n---\n\n## Execution Flow\n\n### Step 1: Check Repository State\n\nFirst, verify we're in a git repository and check the current state:\n\n1. Run `git rev-parse --git-dir` to verify git repository\n2. If not a git repo, show error and exit:\n   ```\n   Error: Not a git repository. Please run this command from within a git repository.\n   ```\n\n3. Get staged changes using MCP or Bash fallback:\n   - Try: `mcp__1mcp__git_1mcp_git_diff_staged`\n   - Fallback: `git diff --staged --stat`\n\n4. If NO staged changes:\n   - Get unstaged changes: `git diff --stat` and `git status --porcelain`\n   - Use AskUserQuestion:\n     ```\n     No changes are staged for commit.\n\n     Unstaged changes detected:\n     - src/auth/login.ts (modified)\n     - src/ui/button.tsx (modified)\n     - README.md (new file)\n\n     What would you like to do?\n     ‚óã Stage all changes - git add -A\n     ‚óã Select files to stage - Choose specific files\n     ‚óã Cancel - Exit without committing\n     ```\n   - If \"Stage all\": Run `git add -A` then continue\n   - If \"Select files\": Show file list with multiSelect, stage selected files\n   - If \"Cancel\": Exit\n\n### Step 2: Load User Preferences\n\nRead `.claude/git-commit.local.md` if it exists:\n\n```yaml\n---\ncommit_style: classic\npairs:\n  - name: \"John Doe\"\n    email: \"john@example.com\"\n---\n```\n\n**Priority for commit style:**\n1. CLI argument `--style` (highest priority)\n2. Setting from `.claude/git-commit.local.md`\n3. Default: `classic`\n\n**First-time setup:** If no settings file exists AND no `--style` flag:\n- Use AskUserQuestion:\n  ```\n  Which commit message style do you prefer?\n  ‚óã Classic (Default) - Clean subject lines following the \"7 rules\" of commit messages\n  ‚óã Conventional - Structured format (feat:, fix:, etc.) for automation and changelogs\n  ```\n- Ask: \"Save this preference for future commits?\"\n- If yes, create `.claude/git-commit.local.md` with the selection\n\n### Step 3: Gather Context\n\n1. **Get the full staged diff:**\n   - Try: `mcp__1mcp__git_1mcp_git_diff_staged`\n   - Fallback: `git diff --staged`\n\n2. **Get list of staged files:**\n   - `git diff --staged --name-only`\n\n3. **Get recent commits** (for style consistency):\n   - Try: `mcp__1mcp__git_1mcp_git_log` with limit 5\n   - Fallback: `git log --oneline -5`\n\n4. **If `--amend` flag is set:**\n   - Verify we can amend (safety check):\n     a. Get HEAD commit author: `git log -1 --format='%an %ae'`\n     b. Check if commit is pushed: `git status` shows \"Your branch is ahead\"\n     c. If pushed to remote, warn and ask for confirmation\n     d. If not the user's commit (different author), refuse to amend\n   - Get current commit message: `git log -1 --format=%B`\n\n5. **User context:** Any remaining arguments after flags are treated as context/intention\n\n### Step 4: Atomic Commit Validation\n\n**Skip this step if `--no-atomic-check` flag is set.**\n\nAnalyze the staged changes to determine if they represent a single, atomic unit of work.\n\n#### Atomicity Analysis\n\n**4a. File Grouping Analysis:**\n\nGroup changed files by directory/module:\n```\nsrc/auth/login.ts       -> auth module\nsrc/auth/session.ts     -> auth module\nsrc/ui/dashboard.tsx    -> ui module\ntests/auth.test.ts      -> auth tests\n```\n\n**Red flag:** Files from unrelated modules changed together (e.g., auth + unrelated ui changes)\n\n**4b. Change Type Detection:**\n\nAnalyze the diff content to identify the nature of changes:\n\n| Pattern | Change Type |\n|---------|-------------|\n| New functions/classes added | Feature |\n| Bug fix patterns (null checks, error handling) | Fix |\n| Variable/function renames, restructuring | Refactor |\n| Only whitespace/formatting | Style |\n| Test file changes only | Test |\n| README, docs/, comments only | Docs |\n| package.json, config files | Build/Chore |\n\n**Red flag:** Multiple change types in the same commit (e.g., new feature + bug fix)\n\n**4c. Scope Coherence Check:**\n\nAsk: \"Can these changes be described in ONE sentence without conjunctions joining unrelated ideas?\"\n\n**Red flags:**\n- Would need \"and also\" to describe changes\n- Changes serve multiple distinct purposes\n- Mix of unrelated concerns\n\n**4d. Size Heuristics:**\n\n- Very large diffs (>500 lines) across many unrelated files = suspicious\n- Note: Large refactors can still be atomic if coherent\n\n**4e. Related Unstaged Changes Detection:**\n\nCheck if there are unstaged changes that logically belong with the staged changes:\n\n1. Get unstaged files: `git diff --name-only` and `git status --porcelain` (for untracked)\n\n2. Detect relationships using these heuristics:\n\n| Pattern | Check For |\n|---------|-----------|\n| **Test files** | Staged `src/foo.ts` ‚Üí Check `foo.test.ts`, `foo.spec.ts` |\n| **Same directory** | Staged `src/auth/login.ts` ‚Üí Check other `src/auth/*` changes |\n| **Manifest files** | Staged `src/lib/*` ‚Üí Check `package.json`, `tsconfig.json` |\n| **Config companions** | Staged `src/feature.ts` ‚Üí Check `src/feature.config.ts` |\n| **Documentation** | Staged `src/module/*` ‚Üí Check `docs/module.md`, module README |\n\n3. If related unstaged files found, show warning:\n\n```\nRelated unstaged changes detected:\n\nThese unstaged files appear related to your staged changes:\n\n- src/auth/session.test.ts (test file for staged module)\n- package.json (manifest with potential dependency changes)\n\nIncluding these would make your commit more complete.\n\nWhat would you like to do?\n‚óã Stage related files (Recommended) - Include them in this commit\n‚óã Review changes - See the unstaged diff\n‚óã Proceed without - Commit only staged files\n```\n\n4. If \"Stage related files\" selected:\n   - Run `git add <related-files>`\n   - Continue with the updated staged changes\n\n5. If \"Review changes\" selected:\n   - Show the diff for the related unstaged files\n   - Re-prompt with the same options\n\n6. If \"Proceed without\" selected:\n   - Continue to Step 5 with only the originally staged files\n\n#### Non-Atomic Warning Flow\n\nIf atomicity violations detected:\n\n```\n‚ö†Ô∏è  ATOMICITY WARNING\n\nYour staged changes appear to contain multiple concerns:\n\n1. Bug fix in src/auth/login.ts (lines 45-67)\n   - Fixed null pointer exception in session validation\n\n2. New feature in src/ui/dashboard.tsx (lines 12-89)\n   - Added user metrics widget\n\n3. Style changes in src/styles/theme.css\n   - Updated color variables\n\nAtomic commits should contain a single, coherent unit of work.\nBenefits: easier code review, clean git history, safe git bisect\n\nWhat would you like to do?\n‚óã Split commits (Recommended) - I'll help you stage changes separately\n‚óã Proceed anyway - Commit all changes together (not recommended)\n‚óã Review changes - Show the full diff again\n‚óã Cancel - Exit without committing\n```\n\n**If \"Split commits\" selected:**\n\n1. Show grouped changes by concern:\n   ```\n   I've identified these separate concerns:\n\n   Concern 1: Bug fix in auth module\n   Files: src/auth/login.ts\n\n   Concern 2: New dashboard feature\n   Files: src/ui/dashboard.tsx\n\n   Concern 3: Style updates\n   Files: src/styles/theme.css\n\n   Which concern would you like to commit first?\n   ‚óã Bug fix in auth module\n   ‚óã New dashboard feature\n   ‚óã Style updates\n   ```\n\n2. Unstage other files:\n   ```bash\n   git reset HEAD <files-not-in-selected-concern>\n   ```\n\n3. Continue to Step 5 with only the selected files staged\n\n4. After commit completes, prompt:\n   ```\n   Commit created successfully!\n\n   Remaining unstaged changes:\n   - src/ui/dashboard.tsx (new feature)\n   - src/styles/theme.css (style updates)\n\n   Would you like to commit the next concern?\n   ‚óã Yes - Continue with next concern\n   ‚óã No - I'll handle the rest manually\n   ```\n\n5. If \"Yes\", stage the next concern's files and repeat from Step 4\n\n**If \"Proceed anyway\" selected:**\n- Log a note that user chose to bypass atomicity check\n- Continue to Step 5\n\n### Step 5: Load Commit Style Rules\n\nLoad the style rules from the plugin's `styles/` directory based on the selected style.\n\n**Style files location:** `${PLUGIN_ROOT}/styles/<style-name>.md`\n\n**Available styles:**\n- `classic.md` - Traditional git commit style (default)\n- `conventional.md` - Conventional Commits specification\n\n**Loading process:**\n1. Read the style file: `styles/{selected_style}.md`\n2. Parse the YAML frontmatter for metadata (name, description, default)\n3. Use the markdown content as the complete style guide\n\nThe style files contain comprehensive rules including:\n- Subject line formatting rules\n- Body formatting rules\n- Examples of good and bad commits\n- Anti-patterns to avoid\n\n**IMPORTANT:** Always read the full style file before generating a commit message. The style files are the single source of truth for formatting rules.\n\n### Step 6: Handle Pair Programming (--pair flag)\n\n**If `--pair` flag is set:**\n\n1. Read saved pairs from `.claude/git-commit.local.md`\n\n2. If pairs exist, show selection:\n   ```\n   Select co-author for this commit:\n   ‚óã John Doe <john@example.com>\n   ‚óã Jane Smith <jane@example.com>\n   ‚óã Add new pair - Enter new co-author details\n   ```\n\n3. If \"Add new pair\" selected OR no pairs saved:\n   ```\n   Enter co-author name:\n   > [user input]\n\n   Enter co-author email:\n   > [user input]\n\n   Save this pair for future use?\n   ‚óã Yes\n   ‚óã No\n   ```\n\n4. If saving, update `.claude/git-commit.local.md`:\n   ```yaml\n   ---\n   commit_style: classic\n   pairs:\n     - name: \"John Doe\"\n       email: \"john@example.com\"\n     - name: \"New Person\"\n       email: \"new@example.com\"\n   ---\n   ```\n\n5. Store selected co-author for commit message generation\n\n### Step 6b: Gather Session Context\n\n**CRITICAL:** Before generating the commit message, review the current conversation history to extract context about WHY these changes were made.\n\n**What to look for in the conversation:**\n\n| Context Type | What to Extract |\n|--------------|-----------------|\n| **User Intent** | What did the user originally ask for? What problem were they solving? |\n| **Decisions Made** | What approaches were discussed? Why was this implementation chosen? |\n| **Trade-offs** | What alternatives were considered and rejected? |\n| **Requirements** | Any specific constraints or requirements mentioned? |\n| **References** | Issue numbers, ticket IDs, PR references, or external links discussed? |\n\n**Extraction process:**\n\n1. **Identify the original request**\n   - Find the user's initial message that led to these changes\n   - Note the problem being solved or feature being added\n   - Capture any specific requirements stated\n\n2. **Trace key decisions**\n   - What implementation approaches were discussed?\n   - Why was the current approach chosen over alternatives?\n   - Were there any trade-offs mentioned?\n\n3. **Gather important context**\n   - Issue/ticket numbers mentioned (e.g., \"fixes #123\", \"JIRA-456\")\n   - Breaking changes or migration notes discussed\n   - Performance or security considerations\n   - Dependencies or prerequisites mentioned\n\n4. **Note user clarifications**\n   - Any follow-up questions and answers\n   - Scope adjustments or refinements\n   - Explicit preferences stated by the user\n\n**Example extraction:**\n\nIf the conversation included:\n> User: \"The login page crashes when users enter invalid emails. Can you add validation?\"\n> Claude: \"I'll add email validation with regex. Should I also add rate limiting?\"\n> User: \"Yes, add rate limiting too - we've been getting bot attacks\"\n\nExtract:\n- **Intent:** Fix login crash on invalid emails\n- **Decision:** Added email validation with regex\n- **Additional context:** Rate limiting added due to bot attacks\n- **Problem:** Users experiencing crashes, security concern with bots\n\n**Use this context to:**\n- Write a commit body that explains the \"why\" not just the \"what\"\n- Include relevant background that future developers need\n- Reference issues or decisions from the conversation\n- Capture the reasoning that would otherwise be lost\n\n### Step 7: Generate Commit Message\n\nUsing all gathered context, generate the commit message:\n\n**Inputs to consider:**\n- Staged diff content\n- User-provided context/intention (command arguments)\n- **Session context** (from Step 6b - conversation history)\n- Current commit message (if amending)\n- Recent commit messages (for style consistency)\n- Selected commit style rules\n- Co-author info (if `--pair` flag set)\n\n**Generation guidelines:**\n\n1. **Analyze the diff** to understand WHAT changed:\n   - What files were modified\n   - What the code changes do\n   - The technical impact of the changes\n\n2. **Use session context** to understand WHY (from Step 6b):\n   - Reference the original user request that led to these changes\n   - Include key decisions and reasoning from the conversation\n   - Mention trade-offs or alternatives that were considered\n   - Include issue/ticket references if mentioned in conversation\n\n3. **Prioritize context sources:**\n   - Explicit user arguments (command line) > Session context > Diff analysis\n   - If user provided context via arguments, prioritize it\n   - Session context fills in the \"why\" that arguments might miss\n\n4. **Apply the loaded style rules strictly** (from Step 5)\n   - Follow all formatting rules from the style file\n   - Use the examples as reference for good formatting\n   - Avoid the anti-patterns listed in the style file\n\n5. **Generate body text that explains:**\n   - WHAT: Summary of the changes (from diff analysis)\n   - WHY: Reason/motivation (from session context)\n   - CONTEXT: Important background (from conversation history)\n   - IMPACT: Any caveats, side effects, or breaking changes\n\n6. **CRITICAL:** Wrap ALL lines at 72 characters maximum\n   - Count characters carefully\n   - Break at natural word boundaries\n\n7. **Co-author handling:**\n   - Only append `Co-Authored-By:` if `--pair` flag was used AND a human co-author was selected in Step 6\n   - **NEVER add Claude Code, Claude Opus, Claude Sonnet, or any Anthropic-related co-author lines**\n   - If co-author selected via `--pair`, append:\n   ```\n\n   Co-Authored-By: Name <email>\n   ```\n\n**Example with session context:**\n\nIf the conversation was about \"fixing login crashes due to invalid emails and adding rate limiting for bot attacks\", the commit message should be:\n\n```\nAdd email validation and rate limiting to login\n\nUsers reported crashes when entering malformed email addresses. The\nprevious implementation passed raw input to the auth service without\nvalidation.\n\nChanges:\n- Add regex-based email validation before auth call\n- Implement rate limiting (5 attempts per minute per IP)\n- Add user-friendly error messages for validation failures\n\nRate limiting addresses the bot attack concern raised during\nimplementation discussion.\n```\n\nNOT just:\n```\nAdd validation to login\n\nAdd email validation and rate limiting.\n```\n\n### Step 8: Present and Confirm\n\nShow the generated commit message:\n\n```\nGenerated commit message:\n\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nAdd user session timeout handling\n\nImplement automatic session expiration after 30 minutes of inactivity.\nThe timeout duration is configurable via SESSION_TIMEOUT environment\nvariable.\n\nThis prevents unauthorized access when users forget to log out on\nshared machines. Sessions are validated on each authenticated request.\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\nWhat would you like to do?\n‚óã Commit - Create the commit with this message\n‚óã Edit message - Modify the message before committing\n‚óã Regenerate - Generate a new message (optionally provide more context)\n‚óã Cancel - Exit without committing\n```\n\n**If \"Edit message\" selected:**\n- Use AskUserQuestion with text input:\n  ```\n  Edit the commit message below:\n  (Use \\n for new lines, body starts after first blank line)\n\n  Current: Add user session timeout handling\\n\\nImplement automatic...\n  ```\n- Parse the edited message, preserving the user's formatting\n\n**If \"Regenerate\" selected:**\n- Ask: \"Any additional context to help generate a better message?\"\n- If provided, add to context and regenerate from Step 7\n\n### Step 9: Execute Commit\n\nBased on user selection:\n\n**Creating the commit:**\n\n```bash\n# Standard commit (no co-author)\ngit commit -m \"$(cat <<'EOF'\nSubject line here\n\nBody text here, wrapped at 72 characters as required by\nthe style guidelines.\nEOF\n)\"\n\n# Only if --pair flag was used and human co-author was selected:\ngit commit -m \"$(cat <<'EOF'\nSubject line here\n\nBody text here, wrapped at 72 characters as required by\nthe style guidelines.\n\nCo-Authored-By: Human Name <human@email.com>\nEOF\n)\"\n```\n\n**IMPORTANT:** Never add Claude/Anthropic-related Co-Authored-By lines.\n\n**If `--amend` flag:**\n\n```bash\ngit commit --amend -m \"$(cat <<'EOF'\n...\nEOF\n)\"\n```\n\n**After commit:**\n\n1. Verify commit was created: `git log -1 --oneline`\n2. Show success message:\n   ```\n   Commit created successfully!\n\n   abc1234 Add user session timeout handling\n\n   Files committed:\n   - src/auth/session.ts\n   - src/middleware/auth.ts\n   ```\n\n3. If there were remaining changes from split commits flow, prompt to continue\n\n---\n\n## Settings File: .claude/git-commit.local.md\n\n```yaml\n---\ncommit_style: classic\npairs:\n  - name: \"John Doe\"\n    email: \"john@example.com\"\n  - name: \"Jane Smith\"\n    email: \"jane@example.com\"\n---\n\n# Git Commit Plugin Settings\n\nThis file stores your preferences for the git-commit plugin.\n\n## Available Settings\n\n| Setting | Values | Description |\n|---------|--------|-------------|\n| commit_style | classic, conventional | Default commit message style |\n| pairs | list | Saved co-authors for pair programming |\n```\n\n---\n\n## Error Handling\n\n### Not a Git Repository\n```\nError: Not a git repository.\nRun this command from within a git repository.\n```\n\n### No Staged Changes (after user declines to stage)\n```\nNo changes to commit. Stage some changes first:\n  git add <files>\n  git add -A  # stage all\n```\n\n### Amend Safety Violations\n\n**Commit already pushed:**\n```\nWarning: This commit has already been pushed to the remote.\nAmending will require a force push, which can cause issues for collaborators.\n\nAre you sure you want to amend?\n‚óã Yes, I understand the implications\n‚óã No, create a new commit instead\n‚óã Cancel\n```\n\n**Not user's commit:**\n```\nError: Cannot amend this commit.\nThe commit was authored by someone else (John Doe <john@example.com>).\nOnly amend your own commits.\n```\n\n### MCP Tools Unavailable\nIf MCP git tools are unavailable, silently fall back to Bash commands.\nDo not show errors to the user - just use the fallback.\n\n---\n\n## Important Notes\n\n- **Strict atomicity by default:** Always check for atomic commits unless `--no-atomic-check` is passed\n- **72 character wrap is mandatory:** Every line in the body MUST be 72 characters or less\n- **Never skip validation:** If staged changes fail atomicity check, user must acknowledge\n- **Preserve user context:** When user provides context, incorporate it naturally, don't ignore it\n- **Co-author format:** Always use `Co-Authored-By: Name <email>` format (GitHub recognizes this)\n- **Amend safety:** Never amend commits that are pushed or authored by others\n- **MCP fallback:** Always have Bash fallbacks for MCP tools\n- **CRITICAL - No automatic Claude co-author:** Do NOT add \"Claude Code\", \"Claude Opus\", \"Claude Sonnet\", or any Claude/Anthropic-related Co-Authored-By lines. Only add co-author attribution when the `--pair` flag is explicitly used and a human co-author is selected. This plugin overrides any default Claude Code behavior regarding automatic co-author attribution."
              }
            ],
            "skills": []
          },
          {
            "name": "jot",
            "description": "Quick, low-friction capture of notes, tasks, ideas, and tech radar blips with Obsidian-style auto-linking",
            "source": "./plugins/jot",
            "category": "productivity",
            "version": "1.0.0",
            "author": {
              "name": "Krishnaswamy Subramanian"
            },
            "install_commands": [
              "/plugin marketplace add jskswamy/claude-plugins",
              "/plugin install jot@jskswamy-plugins"
            ],
            "signals": {
              "stars": 1,
              "forks": 0,
              "pushed_at": "2026-01-12T17:31:33Z",
              "created_at": "2026-01-11T08:00:02Z",
              "license": null
            },
            "commands": [
              {
                "name": "/capture",
                "description": "Capture notes, tasks, ideas, blips, and URL content. Supports quick text captures and full URL-based extraction with auto-linking to related notes.",
                "path": "plugins/jot/commands/capture.md",
                "frontmatter": {
                  "name": "capture",
                  "description": "Capture notes, tasks, ideas, blips, and URL content. Supports quick text captures and full URL-based extraction with auto-linking to related notes.",
                  "argument-hint": "[type] <content|url> [--ring adopt|trial|assess|hold] [--quadrant tools|techniques|platforms|languages]",
                  "allowed-tools": [
                    "Read",
                    "Write",
                    "Glob",
                    "Grep",
                    "Bash",
                    "WebFetch",
                    "AskUserQuestion"
                  ]
                },
                "content": "# Capture Command\n\nCapture notes, tasks, ideas, and tech radar blips with minimal friction. Supports quick text captures and full URL-based extraction with auto-linking to related notes.\n\n## Configuration\n\nRead user settings from `.claude/jot.local.md` if it exists:\n\n```yaml\n---\nworkbench_path: ~/workbench\n---\n```\n\n**Default**: If no config exists, use `~/workbench` as the workbench path.\n\n## Capture Types\n\n### Quick Captures (text-based, no URL)\n- `task` ‚Üí Save to `notes/inbox/` with task template\n- `note` ‚Üí Save to `notes/inbox/` with note template\n- `idea` ‚Üí Save to `notes/inbox/` with idea template\n- `session` ‚Üí Save to `notes/sessions/` with session template (Claude Code session summary)\n- `blip` ‚Üí Save to `notes/blips/` with blip template (tech radar style)\n\n### Full Captures (URL-based)\n- `article` ‚Üí Save to `notes/articles/`\n- `video` ‚Üí Save to `notes/videos/` (requires yt-dlp)\n- `blip` ‚Üí Save to `notes/blips/` (for GitHub repos, tools, technologies)\n- `person` ‚Üí Save to `notes/people/`\n- `book` ‚Üí Save to `notes/books/`\n- `organisation` ‚Üí Save to `notes/organisations/`\n- `trove` ‚Üí Save to `notes/troves/`\n- `research` ‚Üí Save to `notes/research/`\n\n**NOTE**: The `tool` type is deprecated. Use `blip` for all tools, technologies, libraries, and frameworks. GitHub URLs auto-detect as blips.\n\n## Workflow\n\n### Step 1: Parse Arguments\n\nParse the command arguments to determine:\n1. **Type**: First argument (task, note, idea, session, blip, article, video, person, book, organisation, trove, research) or an alias\n2. **Content/URL**: Remaining text or URL\n3. **Flags** (for blips): `--ring` and `--quadrant`\n\n**Type aliases:**\n- `todo` ‚Üí `task`\n- `thought` ‚Üí `note`\n- `conversation` ‚Üí `session`\n- `tool` ‚Üí `blip`\n\nResolve aliases to their canonical types before proceeding.\n\nIf no type specified and content is a URL, auto-detect type:\n- `youtube.com`, `youtu.be` ‚Üí video\n- `github.com` ‚Üí blip (NOT tool - tools are captured as blips)\n- `wikipedia.org/wiki/[Person]` ‚Üí person\n- Default ‚Üí article\n\n### Step 1b: Detect URL References in Quick Captures\n\nFor quick capture types (task, note, idea, session and their aliases):\n\n**If content contains a URL but type is explicitly specified:**\n1. This is a \"quick capture with URL reference\" - NOT a full URL capture\n2. Extract the URL(s) from the content text\n3. Keep the full text including the URL as the description\n4. Do NOT auto-detect type from URL (user explicitly specified task/note/idea)\n5. Do NOT trigger full content extraction\n\n**URL Detection Pattern:** `https?://[^\\s]+`\n\n**Example:**\n- Input: `/capture todo use https://git-cliff.org/ to generate changelog`\n- Result: Type=task, Content=\"use https://git-cliff.org/ to generate changelog\", URLs=[\"https://git-cliff.org/\"]\n\n**Optional: Fetch URL metadata**\nFor quick captures with URL references, optionally fetch minimal metadata (just title) to include in the URL Reference section of the note.\n\n### Step 2: Read Configuration\n\n```bash\n# Expand ~ to home directory\nWORKBENCH_PATH=$(eval echo \"~/workbench\")\n```\n\nCheck if `.claude/jot.local.md` exists and read `workbench_path` from YAML frontmatter.\n\n### Step 3: Ensure Directory Structure\n\nCreate the target directory if it doesn't exist:\n\n```bash\nmkdir -p \"${WORKBENCH_PATH}/notes/[type]\"\n```\n\nFor quick captures (task, note, idea), use `notes/inbox/`.\nFor session captures, use `notes/sessions/`.\nFor blips (including tools/technologies), use `notes/blips/`.\n\n### Step 4: Check Dependencies (Video Only)\n\nFor video captures, check if `yt-dlp` is installed:\n\n```bash\nwhich yt-dlp || command -v yt-dlp\n```\n\nIf not found, inform the user:\n\"YouTube capture requires yt-dlp. Install with: `brew install yt-dlp` (macOS) or `pip install yt-dlp`\"\n\n### Step 5: Ask for Context (ALL Captures Except Session)\n\n**IMPORTANT**: Before processing any capture (except session), ask the user:\n\n\"How did you discover this? What's the context?\"\n\nUse their response verbatim in italics at the top of the note.\n\n### Step 5b: Session Capture Questions (Session Type Only)\n\nFor session/conversation captures, replace the standard context question with guided questions:\n\n1. \"What was the main goal or task for this session?\"\n2. \"What did you accomplish? List the key outcomes.\"\n3. \"Were there any key decisions or choices made?\"\n4. \"Did you learn anything notable? Any gotchas or insights?\"\n5. \"Are there any follow-up tasks or next steps?\"\n\nCapture the user's responses for each section of the session template.\n\n### Step 6: Additional Questions (Blips Only)\n\nFor blip captures, also ask:\n1. \"What is this and why is it on your radar?\" ‚Üí Summary\n2. \"Why are you placing it at this ring level?\" ‚Üí Ring Rationale\n\n### Step 7: Fetch Content (URL Captures)\n\nFor URL-based captures:\n- Use WebFetch to retrieve page content\n- For videos: Use yt-dlp to get transcript\n- For GitHub (blips): Fetch README, installation, usage examples\n\n### Step 8: Read Template\n\nRead the appropriate template from the plugin's templates directory:\n`${CLAUDE_PLUGIN_ROOT}/templates/capture/[type].md`\n\n**Note**: For blips, always use the `blip.md` template which includes rich technical documentation.\n\n### Step 9: Generate Note Content\n\nFollow the template structure to generate the note content:\n- Fill in metadata (date, source, etc.)\n- Add user's discovery context in italics\n- For blips: Include user's Summary and Ring Rationale\n- For blips with URLs: Include 6+ features, installation commands, usage examples, pros/cons, alternatives\n- Generate tags based on content\n\n### Step 10: Find Related Notes (Auto-Linking)\n\nScan existing notes in the workbench for related content:\n\n1. Extract tags and key terms from the new note\n2. Search existing notes:\n   ```bash\n   # Find notes with matching tags\n   grep -r \"tag1\\|tag2\\|tag3\" \"${WORKBENCH_PATH}/notes/\" --include=\"*.md\"\n   ```\n3. Find notes with similar titles/topics\n4. Add [[wikilinks]] to top 3-5 most relevant notes in \"Related Notes\" section\n\n**Matching heuristics:**\n- Same tags ‚Üí Strong match\n- Same quadrant (for blips) ‚Üí Medium match\n- Mentioned person/tool ‚Üí Medium match\n- Similar topic keywords ‚Üí Weak match\n\n### Step 11: Save the Note\n\nGenerate filename:\n- Quick captures (task, note, idea): `YYYY-MM-DD-slugified-title.md`\n- Session: `YYYY-MM-DD-session-slugified-goal.md`\n- Blips: `slugified-name.md` (no date prefix)\n- Research: `slugified-topic.md` (no date prefix)\n\nSave to the appropriate directory:\n```\n${WORKBENCH_PATH}/notes/[type]/[filename]\n```\n\n### Step 12: Report Success\n\nTell the user:\n\"Captured [type] to [full path]\"\n\nIf related notes were found, also mention:\n\"Linked to [N] related notes\"\n\n## Examples\n\n### Quick Task Capture\n```\n/capture task Review pull request from Alice\n```\n‚Üí Asks for context\n‚Üí Saves to `~/workbench/notes/inbox/2026-01-12-review-pull-request-from-alice.md`\n\n### Quick Note Capture\n```\n/capture note The API rate limit is 1000 requests per minute\n```\n‚Üí Asks for context\n‚Üí Saves to `~/workbench/notes/inbox/2026-01-12-the-api-rate-limit.md`\n\n### Idea Capture\n```\n/capture idea What if we used event sourcing for the audit log\n```\n‚Üí Asks for context\n‚Üí Saves to `~/workbench/notes/inbox/2026-01-12-what-if-we-used-event-sourcing.md`\n\n### Blip Capture (Quick)\n```\n/capture blip Kubernetes --ring adopt --quadrant platforms\n```\n‚Üí Asks for context, summary, and ring rationale\n‚Üí Saves to `~/workbench/notes/blips/kubernetes.md`\n\n### Blip Capture from URL (GitHub)\n```\n/capture blip https://github.com/astral-sh/uv --ring trial --quadrant tools\n```\n‚Üí Asks for context, summary, and ring rationale\n‚Üí Fetches README, extracts features, installation, usage\n‚Üí Saves to `~/workbench/notes/blips/uv.md`\n\n### Article Capture\n```\n/capture article https://martinfowler.com/articles/microservices.html\n```\n‚Üí Asks for context\n‚Üí Fetches and extracts article content\n‚Üí Saves to `~/workbench/notes/articles/2026-01-12-microservices.md`\n\n### Auto-Detect URL (GitHub ‚Üí Blip)\n```\n/capture https://github.com/astral-sh/uv\n```\n‚Üí Auto-detects as `blip` (GitHub URLs are captured as blips)\n‚Üí Asks for context, summary, and ring rationale\n‚Üí Saves to `~/workbench/notes/blips/uv.md`\n\n### Session Summary Capture\n```\n/capture session\n```\n‚Üí Asks guided questions about goal, accomplishments, decisions, lessons, follow-ups\n‚Üí Saves to `~/workbench/notes/sessions/2026-01-12-session-implementing-auth.md`\n\n### Using Aliases\n```\n/capture todo Review Alice's PR\n/capture thought The API feels slow today\n/capture conversation\n```\n‚Üí `todo` works like `task`, `thought` works like `note`, `conversation` works like `session`\n\n### Quick Todo with URL Reference\n```\n/capture todo use https://git-cliff.org/ to generate changelog\n```\n‚Üí Saves as task with URL reference (NOT full article extraction)\n‚Üí Optionally fetches just the page title\n‚Üí Saves to `~/workbench/notes/inbox/2026-01-12-use-git-cliff-to-generate-changelog.md`\n\n## Tips\n\n- For minimal friction, keep context answers brief\n- Blips are for tracking technologies (tools, frameworks, libraries, platforms) on your personal radar\n- Use task/note/idea for quick captures that go to inbox for later GTD processing\n- Related notes are auto-linked using [[wikilinks]] - works great with Obsidian\n- GitHub repos are always captured as blips, not articles"
              }
            ],
            "skills": []
          }
        ]
      }
    }
  ]
}