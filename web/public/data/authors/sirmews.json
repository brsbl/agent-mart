{
  "author": {
    "id": "sirmews",
    "display_name": "Navishkar Rao",
    "avatar_url": "https://avatars.githubusercontent.com/u/7651718?u=f5d2627169df0a4985287a6a1542ebca60d27cd2&v=4"
  },
  "marketplaces": [
    {
      "name": "claude-hook-advisor-marketplace",
      "version": "1.0.0",
      "description": "Official marketplace for Claude Hook Advisor plugin - intelligent command history tracking with automatic failure detection",
      "repo_full_name": "sirmews/claude-hook-advisor",
      "repo_url": "https://github.com/sirmews/claude-hook-advisor",
      "repo_description": "Suggest alternatives based on matching keywords so Claude stops doing dumb things.",
      "signals": {
        "stars": 17,
        "forks": 2,
        "pushed_at": "2025-11-30T06:34:41Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"claude-hook-advisor-marketplace\",\n  \"description\": \"Official marketplace for Claude Hook Advisor plugin - intelligent command history tracking with automatic failure detection\",\n  \"version\": \"1.0.0\",\n  \"owner\": {\n    \"name\": \"sirmews\",\n    \"url\": \"https://github.com/sirmews\"\n  },\n  \"pluginRoot\": \"./plugin\",\n  \"plugins\": [\n    {\n      \"name\": \"claude-hook-advisor\",\n      \"description\": \"Intelligent command history tracking with automatic failure detection. Tracks all bash commands Claude runs (successful and failed) with semantic directory aliasing and command mapping.\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"sirmews\",\n        \"url\": \"https://github.com/sirmews/claude-hook-advisor\"\n      },\n      \"homepage\": \"https://github.com/sirmews/claude-hook-advisor\",\n      \"repository\": {\n        \"type\": \"git\",\n        \"url\": \"https://github.com/sirmews/claude-hook-advisor\"\n      },\n      \"license\": \"MIT\",\n      \"keywords\": [\n        \"bash\",\n        \"history\",\n        \"command-tracking\",\n        \"debugging\",\n        \"hooks\",\n        \"automation\",\n        \"failure-detection\"\n      ],\n      \"category\": \"developer-tools\",\n      \"source\": \"./plugin\"\n    }\n  ]\n}\n",
        "README.md": "# Claude Hook Advisor\n\nA Rust CLI tool that integrates with Claude Code using hooks to provide intelligent command suggestions, semantic directory aliasing, command history tracking, and security pattern detection.\n\n## Features\n\n- **üéØ Command Intelligence** - Automatically map commands to your preferred alternatives (npm ‚Üí bun, curl ‚Üí wget)\n- **üìÅ Directory Aliasing** - Use natural language like \"docs\" or \"project_docs\" instead of typing full paths\n- **üìä Command History** - Track all commands Claude runs in a SQLite database with session tracking\n- **üîí Security Patterns** - 27 built-in patterns detect dangerous code across 10+ languages\n- **‚ö° Fast & Lightweight** - Rust-based with ~1-5ms hook response time\n\n### Quick Example\n\n**You:** *\"What files are in my docs?\"*\n**Claude:** *\"I'll check your docs directory at /Users/you/Documents/Documentation\"*\n\n**Claude tries:** `npm install`\n**Tool suggests:** `bun install`\n**Claude runs:** `bun install` automatically\n\n**Claude tries to write:** `eval(userInput)`\n**Tool warns:** Security risk detected\n**Claude:** Finds a safer alternative\n\n## Installation\n\n### Option 1: Plugin Marketplace (Recommended)\n\n```bash\n/plugin marketplace add sirmews/claude-hook-advisor\n/plugin install claude-hook-advisor@sirmews\n```\n\nIncludes automatic hook setup and slash commands (`/history`, `/history-failures`, `/history-search`).\n\n### Option 2: From crates.io\n\n```bash\ncargo install claude-hook-advisor\nclaude-hook-advisor --install-hooks\n```\n\n### Option 3: From Source\n\n```bash\ngit clone https://github.com/sirmews/claude-hook-advisor.git\ncd claude-hook-advisor\nmake install\n```\n\n## Quick Start\n\n1. Install via plugin marketplace (recommended) or cargo\n2. Create `.claude-hook-advisor.toml` in your project root:\n\n```toml\n# Command mappings - map any command to your preferred tool\n[commands]\nnpm = \"bun\"\nyarn = \"bun\"\ncurl = \"wget --verbose\"\n\n# Directory aliases - use natural language in conversations\n[semantic_directories]\n\"project docs\" = \"~/Documents/my-project/docs\"\n\"test data\" = \"~/Documents/test-data\"\n```\n\nThat's it! Start a Claude Code conversation and the hooks work automatically. Security patterns are enabled by default with no configuration needed.\n\n<details>\n<summary><b>üìù Optional: Enable Command History Tracking</b></summary>\n\nAdd to your `.claude-hook-advisor.toml`:\n\n```toml\n[command_history]\nenabled = true\nlog_file = \"~/.claude-hook-advisor/bash-history.db\"\n```\n\nView history:\n```bash\nclaude-hook-advisor --history               # Recent commands\nclaude-hook-advisor --history --failures    # Only failed commands\nclaude-hook-advisor --history --pattern git # Filter by pattern\n```\n\n</details>\n\n<details>\n<summary><b>üîí Optional: Disable Noisy Security Patterns</b></summary>\n\nSecurity patterns are enabled by default. To disable specific patterns:\n\n```toml\n[security_pattern_overrides]\nswift_force_unwrap = false      # Common in Swift code\neval_injection = false          # If working on a REPL\nrust_unsafe_block = false       # For systems programming\n```\n\n</details>\n\n## Configuration\n\nRun `claude-hook-advisor --install-hooks` to automatically configure hooks, or manually add to `.claude/settings.json`:\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": { \"Bash\": \"claude-hook-advisor --hook\" },\n    \"UserPromptSubmit\": { \".*\": \"claude-hook-advisor --hook\" },\n    \"PostToolUse\": { \"Bash\": \"claude-hook-advisor --hook\" }\n  }\n}\n```\n\n---\n\n## üìö Documentation\n\n<details>\n<summary><b>How It Works</b></summary>\n\n### Triple-Hook Architecture\n\nThree hooks work together to provide comprehensive functionality:\n\n#### 1. PreToolUse Hook - Command Intelligence üö¶\n\n**The Flow:**\n1. **Command Detection**: When Claude Code tries to run a Bash command, the hook receives JSON input\n2. **Configuration Loading**: The tool loads `.claude-hook-advisor.toml` from the current directory\n3. **Pattern Matching**: Matches only the primary command at the start of the line\n4. **Suggestion Generation**: If a match is found, returns a blocking response with the suggested replacement\n5. **Claude Integration**: Claude receives the suggestion and automatically retries with the correct command\n\n**Smart Matching:**\n- Start-of-line matching ensures only primary commands are replaced\n- `npm install` ‚Üí `bun install` ‚úÖ\n- `npx npm` stays unchanged (npm is not the primary command) ‚úÖ\n- `npm-check` stays unchanged (different command) ‚úÖ\n- Preserves command arguments: `npm install --save` ‚Üí `bun install --save` ‚úÖ\n\n#### 2. UserPromptSubmit Hook - Directory Aliasing üìÅ\n\n**The Flow:**\n1. **Text Analysis**: Scans user prompts for semantic directory references (e.g., \"docs\", \"project_docs\")\n2. **Pattern Recognition**: Uses regex to detect directory aliases in natural language\n3. **Path Expansion**: Expands tilde (~) to user home directory\n4. **Path Resolution**: Converts semantic references to canonical filesystem paths\n5. **Security Validation**: Performs path canonicalization to prevent traversal attacks\n\n**Security Features:**\n- Path canonicalization prevents `../../../etc/passwd` attacks\n- Only resolves to configured directories\n- Validates paths exist before resolution\n\n#### 3. PostToolUse Hook - Analytics & History üìä\n\n**The Flow:**\n1. **Execution Tracking**: Receives command results with success/failure data\n2. **Database Logging**: Stores commands in SQLite with full metadata\n3. **Session Tracking**: Links commands to Claude Code sessions\n\n**Failure Detection:**\nUses a clever two-hook approach:\n- **PreToolUse**: Logs every command Claude *attempts* with status=\"pending\"\n- **PostToolUse**: Updates status to \"success\" when commands complete\n- Commands remaining \"pending\" = failed (PostToolUse never fired)\n\nThis workaround handles the limitation where Claude Code doesn't send PostToolUse events for failed commands.\n\n</details>\n\n<details>\n<summary><b>Command History Tracking - Detailed Guide</b></summary>\n\n### Setup\n\nEnable in your `.claude-hook-advisor.toml`:\n\n```toml\n[command_history]\nenabled = true\nlog_file = \"~/.claude-hook-advisor/bash-history.db\"\n```\n\nThe PostToolUse hook (installed via `--install-hooks`) will automatically start logging. No restart needed!\n\n### Viewing History\n\n```bash\n# Show recent commands\nclaude-hook-advisor --history\n\n# Show last 50 commands\nclaude-hook-advisor --history --limit 50\n\n# Show only failed commands\nclaude-hook-advisor --history --failures\n\n# Show git commands only\nclaude-hook-advisor --history --pattern git\n\n# Show commands from a specific session\nclaude-hook-advisor --history --session abc123\n```\n\n### What Gets Logged\n\nEach command record includes:\n- **Timestamp**: When the command was executed\n- **Command**: The exact command that ran\n- **Status**: Success (‚úì) or Failed (‚úó) - automatically tracked\n- **Exit code**: Success (0) or failure code\n- **Working directory**: Where the command was executed\n- **Session ID**: Link commands to Claude Code sessions\n\n### Example Output\n\n```\nCommand History (5 records)\n================================================================================\n\n2025-11-10T14:30:22Z  ‚úì\n  Command: git status\n  CWD:     /home/user/my-project\n  Session: abc123-def456\n\n2025-11-10T14:30:25Z  ‚úì\n  Command: cargo test\n  CWD:     /home/user/my-project\n  Session: abc123-def456\n\n2025-11-10T14:30:30Z  ‚úó FAILED\n  Command: npm test\n  CWD:     /home/user/my-project\n  Session: abc123-def456\n```\n\n### Use Cases\n\n- **Track failures**: Automatically identify which commands failed\n- **Debugging**: \"Which commands failed in this session?\" - `--history --failures`\n- **Retrieve commands**: \"What was that complex curl command Claude ran yesterday?\"\n- **Audit trail**: Track all command attempts for compliance\n- **Learning**: See what commands Claude tries and which ones work\n\n</details>\n\n<details>\n<summary><b>Security Pattern Detection - Complete Reference</b></summary>\n\n### Overview\n\n**27 built-in security patterns** automatically detect dangerous code patterns when Claude edits files using `Edit`, `Write`, or `MultiEdit` tools. **Enabled by default** with no configuration needed.\n\n### How It Works\n\nWhen Claude tries to edit a file, the PreToolUse hook:\n1. **Checks the file path** against glob patterns (e.g., `.github/workflows/*.yml`)\n2. **Scans the content** for dangerous substrings (e.g., `eval(`, `dangerouslySetInnerHTML`)\n3. **Blocks the operation** if a pattern matches and shows a security warning\n4. **Tracks warnings per-session** so each warning is only shown once\n\nClaude sees the warning and either finds a safer alternative, asks for your guidance, or explains why the risky operation is needed.\n\n### Built-in Security Patterns\n\n#### JavaScript / TypeScript (7 patterns)\n- **`eval_injection`**: Detects `eval()` usage that can execute arbitrary code\n- **`new_function_injection`**: Detects `new Function()` code injection risks\n- **`innerHTML_xss`**: Detects `innerHTML` XSS vulnerabilities\n- **`react_dangerously_set_html`**: Detects React `dangerouslySetInnerHTML` XSS risks\n- **`document_write_xss`**: Detects `document.write()` XSS attacks\n- **`child_process_exec`**: Detects command injection via `exec()`/`execSync()`\n\n#### Python (4 patterns)\n- **`python_eval`**: Detects `eval()` arbitrary code execution\n- **`python_exec`**: Detects `exec()` arbitrary code execution\n- **`pickle_deserialization`**: Detects unsafe `pickle.load()` usage\n- **`os_system_injection`**: Detects command injection via `os.system()`\n\n#### SQL (2 patterns)\n- **`sql_injection`**: Detects SQL injection via string interpolation\n- **`sql_string_format`**: Detects SQL injection via format strings\n\n#### Rust (2 patterns)\n- **`rust_unsafe_block`**: Detects `unsafe {}` blocks that bypass safety\n- **`rust_command_injection`**: Detects shell command usage that could allow injection\n\n#### Go (2 patterns)\n- **`go_command_injection`**: Detects shell command injection risks\n- **`go_sql_injection`**: Detects SQL injection via `fmt.Sprintf`\n\n#### Swift (3 patterns)\n- **`swift_force_unwrap`**: Detects force unwrap `!` that can cause crashes\n- **`swift_unsafe_operations`**: Detects unsafe pointer operations\n- **`swift_nspredicate_format`**: Detects NSPredicate injection vulnerabilities\n\n#### Java (2 patterns)\n- **`java_runtime_exec`**: Detects command injection via `Runtime.exec()`\n- **`java_deserialization`**: Detects unsafe deserialization\n\n#### PHP (2 patterns)\n- **`php_eval`**: Detects `eval()` arbitrary code execution\n- **`php_unserialize`**: Detects object injection via `unserialize()`\n\n#### Ruby (2 patterns)\n- **`ruby_eval`**: Detects `eval()` variants (eval, instance_eval, class_eval)\n- **`ruby_yaml_load`**: Detects arbitrary code execution via `YAML.load`\n\n#### GitHub Actions (2 patterns)\n- **`github_actions_workflow`**: Detects workflow injection in `.yml` files\n- **`github_actions_workflow_yaml`**: Detects workflow injection in `.yaml` files\n\n### Example Security Warning\n\nWhen Claude tries to write code with `eval()`:\n\n```\n‚ö†Ô∏è Security Warning: eval() executes arbitrary code and is a major security risk.\n\nConsider using JSON.parse() for data parsing or alternative design patterns that\ndon't require code evaluation. Only use eval() if you truly need to evaluate\narbitrary code.\n```\n\n### Disabling Patterns\n\nAll patterns are enabled by default. To disable specific patterns:\n\n```toml\n[security_pattern_overrides]\nswift_force_unwrap = false      # Common in Swift code\neval_injection = false          # If working on a REPL\npython_eval = false\nrust_unsafe_block = false       # For systems programming\n```\n\n**All pattern names:**\n```\ngithub_actions_workflow          github_actions_workflow_yaml\neval_injection                   new_function_injection\nreact_dangerously_set_html       document_write_xss\ninnerHTML_xss                    child_process_exec\npickle_deserialization           os_system_injection\npython_eval                      python_exec\nsql_injection                    sql_string_format\nrust_unsafe_block                rust_command_injection\ngo_command_injection             go_sql_injection\nswift_force_unwrap               swift_unsafe_operations\nswift_nspredicate_format         java_runtime_exec\njava_deserialization             php_eval\nphp_unserialize                  ruby_eval\nruby_yaml_load\n```\n\n</details>\n\n<details>\n<summary><b>Configuration Examples & Use Cases</b></summary>\n\n### Example Configurations\n\n**Node.js project (prefer bun):**\n```toml\n[commands]\nnpm = \"bun\"\nyarn = \"bun\"\nnpx = \"bunx\"\n```\n\n**Python project (prefer uv):**\n```toml\n[commands]\npip = \"uv pip\"\n\"pip install\" = \"uv add\"\n```\n\n**General tool preferences:**\n```toml\n[commands]\ncurl = \"wget --verbose\"\ncat = \"bat\"\nls = \"eza\"\n```\n\n**Comprehensive project setup:**\n```toml\n# Command mappings\n[commands]\nnpm = \"bun\"\nyarn = \"bun\"\nnpx = \"bunx\"\n\n# Semantic directory aliases\n[semantic_directories]\n\"project docs\" = \"~/Documents/Documentation/my-project\"\n\"central docs\" = \"~/Documents/Documentation\"\n\"test data\" = \"~/Documents/test-data\"\n\n# Command history\n[command_history]\nenabled = true\nlog_file = \"~/.claude-hook-advisor/bash-history.db\"\n\n# Disable noisy security patterns for this project\n[security_pattern_overrides]\nswift_force_unwrap = false\n```\n\n### Use Cases\n\n#### Command Intelligence\n- **Package Manager Consistency**: Enforce use of `bun` instead of `npm`/`yarn`\n- **Tool Preferences**: Replace `curl` with `wget`, `cat` with `bat`, etc.\n- **Project Standards**: Ensure consistent tooling across team members\n- **Legacy Migration**: Gradually move from old tools to new ones\n\n#### Directory Aliasing\n- **Documentation Management**: Use \"docs\" instead of typing full paths\n- **Project Organization**: Reference \"project_docs\", \"central_docs\" naturally\n- **Team Collaboration**: Shared semantic directory references across team members\n- **Workflow Automation**: Natural language directory references in Claude conversations\n\n### Configuration File Lookup\n\nThe tool looks for configuration files in this order:\n1. Custom path specified with `-c/--config` flag\n2. `.claude-hook-advisor.toml` in current directory\n3. If no config found, allows all commands (no mappings)\n\n</details>\n\n<details>\n<summary><b>Testing & Development</b></summary>\n\n### Testing Hooks Directly\n\nTest hooks without Claude Code:\n\n```bash\n# Test directory resolution\necho '{\"session_id\":\"test\",\"hook_event_name\":\"UserPromptSubmit\",\"prompt\":\"check docs\"}' | claude-hook-advisor --hook\n\n# Test command mapping\necho '{\"session_id\":\"test\",\"hook_event_name\":\"PreToolUse\",\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"npm install\"}}' | claude-hook-advisor --hook\n\n# Test PostToolUse hook\necho '{\"session_id\":\"test\",\"hook_event_name\":\"PostToolUse\",\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"bun install\"},\"tool_response\":{\"exit_code\":0}}' | claude-hook-advisor --hook\n```\n\n### Development Commands\n\n```bash\nmake test          # Run unit tests\nmake build         # Build in debug mode\nmake release       # Build in release mode\nmake lint          # Run clippy linting\nmake fmt           # Format code with rustfmt\nmake clean         # Clean build artifacts\nmake help          # Show all available targets\n```\n\n### Manual Testing Examples\n\n```bash\n# Run unit tests\nmake test\n\n# Test with example npm command\nmake run-example\n\n# Manual testing - Command mapping (PreToolUse)\necho '{\"session_id\":\"test\",\"transcript_path\":\"\",\"cwd\":\"\",\"hook_event_name\":\"PreToolUse\",\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"yarn start\"}}' | ./target/debug/claude-hook-advisor --hook\n\n# Manual testing - Directory detection (UserPromptSubmit)\necho '{\"session_id\":\"test\",\"hook_event_name\":\"UserPromptSubmit\",\"prompt\":\"check the docs directory\"}' | ./target/debug/claude-hook-advisor --hook\n```\n\n### Performance Notes\n\n- **Startup time**: ~1-5ms per hook call\n- **Memory usage**: ~2-3MB per process\n- **File watching**: Configuration is loaded on each hook call (no caching)\n- **Path resolution**: Uses filesystem canonicalization for security\n\n</details>\n\n<details>\n<summary><b>Troubleshooting Guide</b></summary>\n\n### Enable Debug Mode\n\nAdd `RUST_LOG=debug` to your Claude Code settings for detailed logging:\n\n```json\n{\n  \"hooks\": {\n    \"UserPromptSubmit\": { \".*\": \"RUST_LOG=debug claude-hook-advisor --hook\" },\n    \"PreToolUse\": { \"Bash\": \"RUST_LOG=debug claude-hook-advisor --hook\" },\n    \"PostToolUse\": { \"Bash\": \"RUST_LOG=debug claude-hook-advisor --hook\" }\n  }\n}\n```\n\n**Debug output shows:**\n- Configuration file loading\n- Pattern matching details\n- Path resolution steps\n- Variable substitution\n- Security validation\n\n### Common Issues\n\n#### üö´ Hooks Not Triggering\n**Problem:** No hook messages appear in Claude Code conversations\n\n**Solutions:**\n1. Verify hook installation: Check `.claude/settings.json` or `.claude/settings.local.json`\n2. Ensure binary is in PATH: `which claude-hook-advisor`\n3. Test manually:\n   ```bash\n   echo '{\"session_id\":\"test\",\"hook_event_name\":\"UserPromptSubmit\",\"prompt\":\"check docs\"}' | claude-hook-advisor --hook\n   ```\n4. Verify hooks are configured:\n   ```json\n   {\n     \"hooks\": {\n       \"UserPromptSubmit\": { \".*\": \"claude-hook-advisor --hook\" }\n     }\n   }\n   ```\n\n#### üìÅ Directory Not Resolved\n**Problem:** Directory aliases don't resolve to expected paths\n\n**Solutions:**\n1. Check configuration file exists: `ls .claude-hook-advisor.toml`\n2. Verify alias configuration:\n   ```toml\n   [semantic_directories]\n   docs = \"~/Documents/Documentation\"\n   ```\n3. Test resolution:\n   ```bash\n   echo '{\"session_id\":\"test\",\"hook_event_name\":\"UserPromptSubmit\",\"prompt\":\"check docs\"}' | claude-hook-advisor --hook\n   ```\n4. Ensure path exists on filesystem\n5. Check file permissions: `ls -la .claude-hook-advisor.toml`\n\n#### ‚öôÔ∏è Commands Not Being Mapped\n**Problem:** Commands still run with original tool instead of mapped replacement\n\n**Solutions:**\n1. Verify command mapping in config:\n   ```toml\n   [commands]\n   npm = \"bun\"\n   ```\n2. Test mapping:\n   ```bash\n   echo '{\"session_id\":\"test\",\"hook_event_name\":\"PreToolUse\",\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"npm install\"}}' | claude-hook-advisor --hook\n   ```\n3. Remember: Commands only match at the start of the line (by design):\n   - ‚úÖ `npm install` ‚Üí `bun install`\n   - ‚ùå `npx npm` stays unchanged (npm is not the primary command)\n   - ‚ùå `npm-check` stays unchanged (different command)\n\n#### üîí Permission Issues\n**Problem:** Hook fails with permission errors\n\n**Solutions:**\n1. Make binary executable: `chmod +x ~/.cargo/bin/claude-hook-advisor`\n2. Check file ownership: `ls -la ~/.cargo/bin/claude-hook-advisor`\n3. Verify PATH includes `~/.cargo/bin`: `echo $PATH`\n\n#### üìä Command History Not Logging\n**Problem:** Commands aren't being saved to the database\n\n**Solutions:**\n1. Verify command history is enabled in config:\n   ```toml\n   [command_history]\n   enabled = true\n   log_file = \"~/.claude-hook-advisor/bash-history.db\"\n   ```\n2. Check PostToolUse hook is installed\n3. Verify log file location is writable\n4. Check database file permissions\n\n### Understanding Hook Messages\n\nWhen working correctly, you'll see these messages in Claude Code:\n\n**Directory Resolution:**\n```\n<user-prompt-submit-hook>Directory reference 'docs' resolved to: /Users/you/Documents/Documentation</user-prompt-submit-hook>\n```\n\n**Command Suggestions:**\n```\n<pre-tool-use-hook>Command 'npm' mapped to 'bun'. Suggested: bun install</pre-tool-use-hook>\n```\n\n**Execution Tracking:**\n```\n<post-tool-use-hook>Command 'bun install' completed successfully (exit code: 0)</post-tool-use-hook>\n```\n\n</details>\n\n## Support\n\nIf you find this tool useful, consider supporting its development:\n\n[![ko-fi](https://ko-fi.com/img/githubbutton_sm.svg)](https://ko-fi.com/A0A01HT0RG)\n\n## Inspiration\n\nThe security pattern detection feature was inspired by Claude Code itself. While building this tool, I noticed how Claude Code implements its own security checks and validation patterns to protect users from dangerous operations. This inspired me to bring similar protective capabilities to custom hooks, allowing the community to extend Claude Code's safety mechanisms in their own workflows.\n",
        "plugin/README.md": "# Claude Hook Advisor Plugin\n\nA Claude Code plugin that provides intelligent command history tracking with automatic failure detection.\n\n## Features\n\n### üéØ Automatic Command Tracking\n- **All commands captured**: Both successful and failed bash commands\n- **Failure detection**: Automatically identifies failed commands (no manual checking needed)\n- **Rich metadata**: Timestamps, exit codes, working directories, session IDs\n\n### üìä Slash Commands for Easy Access\n- `/history` - View recent command history (last 20 commands)\n- `/history-failures` - Show only failed commands with AI analysis\n- `/history-search <pattern>` - Search for specific commands (e.g., `/history-search git`)\n- `/history-session <id>` - View all commands from a specific session\n\n### üîß Smart Hooks\n- **PreToolUse**: Logs every command attempt as \"pending\"\n- **PostToolUse**: Updates status to \"success\" when complete\n- **UserPromptSubmit**: Enables semantic directory aliasing\n\n### üé® Additional Capabilities\n- **Command mapping**: Replace commands automatically (npm ‚Üí bun)\n- **Directory aliasing**: Use natural language for paths (\"docs\" ‚Üí ~/Documents/Documentation)\n\n## Prerequisites\n\n**Install the claude-hook-advisor binary first:**\n\n```bash\n# From crates.io (recommended)\ncargo install claude-hook-advisor\n\n# Or from source\ngit clone https://github.com/sirmews/claude-hook-advisor.git\ncd claude-hook-advisor\ncargo install --path .\n```\n\n**Verify installation:**\n```bash\nwhich claude-hook-advisor\n# Should output: ~/.cargo/bin/claude-hook-advisor\n```\n\n## Installation\n\n### Option 1: Local Plugin Installation\n\n1. **Copy the plugin directory** to your project:\n   ```bash\n   cp -r plugin ~/.claude/plugins/claude-hook-advisor\n   ```\n\n2. **Enable the plugin** in your `.claude/settings.json`:\n   ```json\n   {\n     \"plugins\": [\n       \"~/.claude/plugins/claude-hook-advisor\"\n     ]\n   }\n   ```\n\n3. **Create configuration file** in your project root:\n   ```bash\n   cat > .claude-hook-advisor.toml << 'EOF'\n   [commands]\n   # Add your command mappings here\n   # npm = \"bun\"\n\n   [semantic_directories]\n   # Add your directory aliases here\n   # docs = \"~/Documents/Documentation\"\n\n   [command_history]\n   enabled = true\n   log_file = \"~/.claude-hook-advisor/bash-history.db\"\n   EOF\n   ```\n\n4. **Restart Claude Code** to activate the plugin\n\n### Option 2: Project-Specific Installation\n\nPlace the plugin directory in your project's `.claude/plugins/` folder:\n\n```bash\nmkdir -p .claude/plugins\ncp -r plugin .claude/plugins/claude-hook-advisor\n```\n\nAdd to `.claude/settings.local.json`:\n```json\n{\n  \"plugins\": [\n    \"./.claude/plugins/claude-hook-advisor\"\n  ]\n}\n```\n\n## Usage\n\n### View Command History\n\nSimply type:\n```\n/history\n```\n\nYou'll see:\n```\nCommand History (5 records)\n================================================================================\n\n2025-11-12T14:30:35Z  ‚úó FAILED\n  Command: npm test\n  CWD:     /home/user/my-project\n  Session: abc123-def456\n\n2025-11-12T14:30:30Z  ‚úì\n  Command: git status\n  CWD:     /home/user/my-project\n  Session: abc123-def456\n```\n\n### Debug Failed Commands\n\n```\n/history-failures\n```\n\nClaude will automatically:\n- Show all failed commands\n- Analyze why they failed\n- Suggest fixes\n\n### Search for Specific Commands\n\n```\n/history-search git\n```\n\nFinds all commands containing \"git\" in the history.\n\n### Review a Specific Session\n\n```\n/history-session abc123-def456\n```\n\nShows complete timeline of a session's commands.\n\n## How It Works\n\n### Automatic Failure Detection\n\nThe plugin uses a clever two-hook approach:\n\n1. **PreToolUse Hook**: Logs every command Claude attempts with status=\"pending\"\n2. **PostToolUse Hook**: Updates status to \"success\" when commands complete\n\n**Key Insight**: Claude Code only fires PostToolUse for successful commands. Any command that remains \"pending\" means it failed!\n\nThis workaround solves the limitation where Claude Code doesn't send PostToolUse events for failed commands.\n\n### Database Storage\n\nAll commands are stored in SQLite at `~/.claude-hook-advisor/bash-history.db` (configurable).\n\nEach record includes:\n- Timestamp (ISO 8601)\n- Command text\n- Status (success/pending)\n- Exit code\n- Working directory\n- Session ID\n\n## Configuration\n\nEdit `.claude-hook-advisor.toml` in your project root:\n\n```toml\n[commands]\nnpm = \"bun\"              # Replace npm with bun\nyarn = \"bun\"             # Replace yarn with bun\ncurl = \"wget --verbose\"  # Use wget instead of curl\n\n[semantic_directories]\ndocs = \"~/Documents/Documentation\"\nproject_docs = \"~/Documents/my-project\"\n\n[command_history]\nenabled = true\nlog_file = \"~/.claude-hook-advisor/bash-history.db\"\n```\n\n## Troubleshooting\n\n### Plugin Not Loading\n\n1. **Check binary installation**:\n   ```bash\n   which claude-hook-advisor\n   ```\n   Should return `~/.cargo/bin/claude-hook-advisor`\n\n2. **Verify plugin path** in settings.json is correct\n\n3. **Check logs** in Claude Code for errors\n\n4. **Restart Claude Code** after installation\n\n### History Not Recording\n\n1. **Verify config file exists** at `.claude-hook-advisor.toml`\n\n2. **Check history is enabled**:\n   ```toml\n   [command_history]\n   enabled = true\n   ```\n\n3. **Test manually**:\n   ```bash\n   claude-hook-advisor --history\n   ```\n\n### Hooks Not Firing\n\n1. **Restart Claude Code** (hooks load at session start)\n\n2. **Check hooks.json** is in `plugin/hooks/hooks.json`\n\n3. **Verify permissions**:\n   ```bash\n   chmod +x ~/.cargo/bin/claude-hook-advisor\n   ```\n\n## Advanced Usage\n\n### Query History Directly\n\nYou can use the CLI directly for advanced queries:\n\n```bash\n# Last 50 commands\nclaude-hook-advisor --history --limit 50\n\n# Only failures\nclaude-hook-advisor --history --failures\n\n# Search pattern\nclaude-hook-advisor --history --pattern \"npm\"\n\n# Specific session\nclaude-hook-advisor --history --session abc123\n```\n\n### Combine with Other Tools\n\nThe command history is stored in SQLite, so you can query it directly:\n\n```bash\n# View schema\nsqlite3 ~/.claude-hook-advisor/bash-history.db \".schema\"\n\n# Custom queries\nsqlite3 ~/.claude-hook-advisor/bash-history.db \\\n  \"SELECT command, status FROM commands WHERE status='pending' LIMIT 10\"\n```\n\n## Use Cases\n\n- **Debugging**: \"What commands failed in my last session?\"\n- **Learning**: \"Show me all git commands Claude used\"\n- **Auditing**: Track all command attempts for compliance\n- **Optimization**: Find commands that frequently fail\n- **Recovery**: \"What was that curl command that worked yesterday?\"\n\n## Support\n\n- **GitHub**: https://github.com/sirmews/claude-hook-advisor\n- **Issues**: https://github.com/sirmews/claude-hook-advisor/issues\n- **Docs**: https://github.com/sirmews/claude-hook-advisor#readme\n\n## License\n\nSame as claude-hook-advisor main project.\n\n## Credits\n\nCreated by [sirmews](https://github.com/sirmews) as part of the claude-hook-advisor project.\n"
      },
      "plugins": [
        {
          "name": "claude-hook-advisor",
          "description": "Intelligent command history tracking with automatic failure detection. Tracks all bash commands Claude runs (successful and failed) with semantic directory aliasing and command mapping.",
          "version": "1.0.0",
          "author": {
            "name": "sirmews",
            "url": "https://github.com/sirmews/claude-hook-advisor"
          },
          "homepage": "https://github.com/sirmews/claude-hook-advisor",
          "repository": {
            "type": "git",
            "url": "https://github.com/sirmews/claude-hook-advisor"
          },
          "license": "MIT",
          "keywords": [
            "bash",
            "history",
            "command-tracking",
            "debugging",
            "hooks",
            "automation",
            "failure-detection"
          ],
          "category": "developer-tools",
          "source": "./plugin",
          "categories": [
            "automation",
            "bash",
            "command-tracking",
            "debugging",
            "developer-tools",
            "failure-detection",
            "history",
            "hooks"
          ],
          "install_commands": [
            "/plugin marketplace add sirmews/claude-hook-advisor",
            "/plugin install claude-hook-advisor@claude-hook-advisor-marketplace"
          ]
        }
      ]
    }
  ]
}