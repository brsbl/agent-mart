{
  "author": {
    "id": "koriym",
    "display_name": "Akihito Koriyama",
    "avatar_url": "https://avatars.githubusercontent.com/u/529021?u=2a4508c430e9f163eba4f64f0c181aa8e0083c5d&v=4"
  },
  "marketplaces": [
    {
      "name": "sql-quality",
      "version": null,
      "description": "Claude Skills for SQL quality analysis and optimization",
      "repo_full_name": "koriym/Koriym.SqlQuality",
      "repo_url": "https://github.com/koriym/Koriym.SqlQuality",
      "repo_description": "MySQL query analyzer that detects potential performance issues in SQL files.",
      "signals": {
        "stars": 3,
        "forks": 2,
        "pushed_at": "2026-01-30T22:34:23Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"sql-quality\",\n  \"owner\": {\n    \"name\": \"Akihito Koriyama\",\n    \"email\": \"akihito.koriyama@gmail.com\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"sql-quality\",\n      \"source\": \"./\",\n      \"description\": \"Claude Skills for SQL quality analysis and optimization\",\n      \"version\": \"1.0.0\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"sql-quality\",\n  \"description\": \"Claude Skills for SQL quality analysis and optimization. Includes performance checking, automated fixes, and parameter generation.\",\n  \"version\": \"1.0.0\",\n  \"author\": {\n    \"name\": \"Akihito Koriyama\",\n    \"email\": \"akihito.koriyama@gmail.com\"\n  },\n  \"homepage\": \"https://github.com/koriym/Koriym.SqlQuality\",\n  \"repository\": \"https://github.com/koriym/Koriym.SqlQuality\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"sql\", \"mysql\", \"performance\", \"optimization\", \"database\"],\n  \"skills\": \"./skills/\"\n}\n",
        "README.md": "# Koriym.SqlQuality\n\n[![Continuous Integration](https://github.com/koriym/Koriym.SqlQuality/actions/workflows/continuous-integration.yml/badge.svg)](https://github.com/koriym/Koriym.SqlQuality/actions/workflows/continuous-integration.yml)\n[![Coding Standards](https://github.com/koriym/Koriym.SqlQuality/actions/workflows/coding-standards.yml/badge.svg)](https://github.com/koriym/Koriym.SqlQuality/actions/workflows/coding-standards.yml)\n\n[Japanese](README.ja.md)\n\nA powerful MySQL query analyzer that helps detect potential performance issues in SQL files and provides AI-powered optimization recommendations.\n\n## Features\n\n- Detects common performance issues (full table scans, inefficient JOINs, etc.)\n- Provides AI-powered optimization recommendations\n- Supports multiple output languages\n- Generates detailed analysis reports in Markdown format\n\n## Requirements\n\n- PHP 8.1+\n- MySQL 5.7+ or MariaDB 10.2+\n- PDO MySQL extension\n\n## Installation\n\n```bash\ncomposer require koriym/sql-quality\n```\n\n## Usage\n\n```php\n<?php\n\nnamespace Koriym\\SqlQuality;\n\nuse PDO;\nuse function dirname;\n\nrequire dirname(__DIR__) . '/vendor/autoload.php';\n\n$pdo = new PDO('mysql:host=127.0.0.1;dbname=test', 'root', '', [\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION\n]);\n\n$sqlParams = require 'path/to/sql_params.php';\n\n//return [\n//    '1_full_table_scan.sql' => ['min_views' => 1000],\n//    '2_filesort.sql' => ['status' => 'published', 'limit' => 10]\n//];\n\n$analyzer = new SqlFileAnalyzer(\n    $pdo,\n    new ExplainAnalyzer(),\n    'path/to/sql_dir',\n    new AIQueryAdvisor('‰ª•‰∏ä„ÅÆÂàÜÊûê„ÇíÊó•Êú¨Ë™û„ÅßË®òËø∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ')\n);\n\n// Output to build/sql-quality\n$analyzer->analyzeSqlDirectory($sqlParams, __DIR__ . '/build/sql-quality');\n```\n\n## CLI Usage\n\n```bash\nsql-quality analyze --sql-dir=sql/ --params=params.php --format=json\nsql-quality analyze --sql-dir=sql/ --params=params.php --format=markdown --output=build/sql-quality\nsql-quality analyze --sql-dir=sql/ --params=params.php --dsn=\"mysql:host=localhost;dbname=mydb\" --user=root --password=secret\nsql-quality analyze --sql-dir=sql/ --params=params.php --lang=ja\n```\n\n### Options\n\n| Option | Description | Default |\n|--------|-------------|---------|\n| `--sql-dir=DIR` | Directory containing SQL files (required) | |\n| `--params=FILE` | PHP file returning SQL parameters array (required) | |\n| `--dsn=DSN` | Database DSN | `mysql:host=127.0.0.1;dbname=test` |\n| `--user=USER` | Database user | `root` |\n| `--password=PASS` | Database password | (empty) |\n| `--format=FORMAT` | Output format: `json` or `markdown` | `json` |\n| `--output=DIR` | Output directory for markdown reports | |\n| `--lang=LANG` | Language for messages: `en` or `ja` | `en` |\n\n## Claude Code Skills\n\nFor [Claude Code](https://claude.ai/code) users, automated SQL optimization skills are available:\n\n### Installation\n\n**From Marketplace:**\n```bash\n# Add marketplace\n/plugin marketplace add koriym/Koriym.SqlQuality\n\n# Install plugin (includes all 3 skills)\n/plugin install sql-quality@sql-quality\n```\n\n**For Project Developers:**\nWhen you trust this project folder, Claude Code will automatically prompt you to add the marketplace and enable the plugins (configured in `.claude/settings.json`).\n\n### Usage\n\n```bash\n# Analyze SQL files (CI-friendly)\n/sql-quality-check tests/sql tests/params/sql_params.php\n\n# Auto-fix issues with step-by-step measurement\n/sql-quality-fix tests/sql tests/params/sql_params.php\n\n# Generate parameter bindings from SQL files\n/sql-params-generate tests/sql\n```\n\n### Features\n\nThese AI-powered skills:\n- Detect performance issues (FullTableScan, IneffectiveJoin, etc.)\n- Rewrite problematic SQL patterns (functions on columns, implicit conversions)\n- Create indexes and measure their impact in real-time\n- Roll back ineffective indexes automatically\n- Generate detailed improvement reports with cost reductions\n\nSee `skills/*/SKILL.md` for detailed documentation.\n\n## Analysis Reports\n\nExample:\n\n* [SQL Analysis Summary](demo/build/sql-quality/summary_report.md)\n\nThe analyzer generates two types of analysis reports in the specified output directory (e.g., `build/sql-quality`).\n\n### 1. Query Analysis List\n\nShows the overall analysis of each SQL query:\n\n| Column | Description |\n|--------|-------------|\n| SQL File | Name of the SQL file |\n| Cost | Estimated query cost |\n| Level | Performance level based on statistical analysis (Œº = mean, œÉ = standard deviation) |\n| Issues | Detected performance issues |\n| Report | Link to detailed analysis |\n\nExample:\n\n| SQL File | Cost | Exec Time (ms) | Level | Issues | Report |\n|----------|------|----------------|-------|---------|--------|\n| 1\\_full\\_table\\_scan.sql | 497.95 | 5.92 | Medium (Œº ¬± œÉ) | FullTableScan | [Details](1\\_full\\_table\\_scan.md) |\n\n### 2. Queries with Optimizer Impact\n\nThe MySQL Query Optimizer is a crucial component that automatically optimizes query execution plans. Even when SQL and index design are not optimal, the optimizer attempts to improve performance at runtime.\n\n| Column | Description |\n|--------|-------------|\n| SQL File | Name of the SQL file |\n| Base Access | Access method, row count, and scan percentage with optimizer disabled |\n| Optimized Access | Access method, row count, and scan percentage with optimizer enabled |\n| Cost Impact | Cost reduction percentage by optimizer (negative values indicate improvement) |\n| Base Issues | Issues detected when optimizer is disabled |\n| Plan Changes | Detailed execution plan changes (filtering ratio, cost changes, etc.) |\n\n#### Example Interpretation\n\nLet's look at this example:\n\n| SQL File | Base Access | Optimized Access | Cost Impact | Base Issues | Plan Changes |\n|:----------|:------------|:----------------|:------------|:------------|:-------------|\n| 11\\_nested\\_loop.sql | ALL, 4897 rows, 100.0% | ALL, 1000 rows, 10.0% ‚Üí ref, using idx\\_posts\\_user\\_id, 4 rows, 100.0% | -44.9% | FullTableScan | - |\n\nIn this example, without the optimizer, the query performs a full table scan processing 4,897 rows. With the optimizer enabled, it uses an index to access only 4 rows. The cost reduction of -44.9% indicates a significant improvement through optimizer intervention.\n\n### Understanding Optimizer Impact\n\nWhile the optimizer improves performance, relying on it may mask potential underlying issues. Additionally, there are risks of unstable performance as data volume grows or statistics change. This feature aims to detect such issues early and guide appropriate solutions by comparing execution plans and performance with and without the optimizer.\n\n## Project Statistics\n\nThe summary report also includes overall project statistics:\n\n- Total SQL queries analyzed\n- Average query cost\n- Standard deviation of costs\n\n## Multilingual Support\n\nSQL query analysis results support multilingual output in both `ExplainAnalyzer` and `AIQueryAdvisor`.\n\n### Language Customization in ExplainAnalyzer\n\nWhile English is the default language, you can customize error messages in `ExplainAnalyzer` constructor for other languages:\n\n```php\n// Japanese error messages\n$analyzer = new ExplainAnalyzer([\n    'FullTableScan' => '„Éï„É´„ÉÜ„Éº„Éñ„É´„Çπ„Ç≠„É£„É≥„ÅåÊ§úÂá∫„Åï„Çå„Åæ„Åó„Åü„ÄÇ',\n    'IneffectiveJoin' => 'ÈùûÂäπÁéáÁöÑ„Å™ÁµêÂêà„ÅåÊ§úÂá∫„Åï„Çå„Åæ„Åó„Åü„ÄÇ',\n    'FunctionInvalidatesIndex' => 'Èñ¢Êï∞„ÅÆ‰ΩøÁî®„Å´„Çà„Çä„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅåÁÑ°ÂäπÂåñ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ',\n    // ... other messages\n]);\n\n// Combined with AI Advisor for complete Japanese output\n$analyzer = new SqlFileAnalyzer(\n    $pdo,\n    $analyzer,\n    $sqlDirectory,\n    new AIQueryAdvisor('‰ª•‰∏ä„ÅÆÂàÜÊûê„ÇíÊó•Êú¨Ë™û„ÅßË®òËø∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ')\n);\n```\n\nThis allows you to generate the entire analysis report in your preferred language. Both error messages and AI analysis results will be output in the specified language.\n"
      },
      "plugins": [
        {
          "name": "sql-quality",
          "source": "./",
          "description": "Claude Skills for SQL quality analysis and optimization",
          "version": "1.0.0",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add koriym/Koriym.SqlQuality",
            "/plugin install sql-quality@sql-quality"
          ]
        }
      ]
    },
    {
      "name": "pasta-lunch",
      "version": null,
      "description": "Detect spaghetti code using PHPMD metrics. Measures CBO, CC, NPath to identify refactoring targets.",
      "repo_full_name": "koriym/pasta-lunch",
      "repo_url": "https://github.com/koriym/pasta-lunch",
      "repo_description": "Detect spaghetti code using PHPMD metrics",
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-21T14:49:24Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"pasta-lunch\",\n  \"owner\": {\n    \"name\": \"Akihito Koriyama\",\n    \"email\": \"akihito.koriyama@gmail.com\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"pasta-lunch\",\n      \"source\": \"./\",\n      \"description\": \"Detect spaghetti code using PHPMD metrics. Measures CBO, CC, NPath to identify refactoring targets.\",\n      \"version\": \"1.0.0\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"pasta-lunch\",\n  \"description\": \"Detect spaghetti code using PHPMD metrics. Measures CBO, CC, NPath to identify refactoring targets.\",\n  \"version\": \"1.0.0\",\n  \"author\": {\n    \"name\": \"Akihito Koriyama\",\n    \"email\": \"akihito.koriyama@gmail.com\"\n  },\n  \"homepage\": \"https://koriym.github.io/pasta-lunch/\",\n  \"repository\": \"https://github.com/koriym/pasta-lunch\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"php\", \"phpmd\", \"spaghetti\", \"code-quality\", \"complexity\", \"refactoring\"],\n  \"skills\": \"./skills/\"\n}\n",
        "README.md": "# PASTA Lunch üçù\n\n**P**HP **A**lert for **S**paghetti **T**wisted **A**rchitecture\n\n> Order your code quality check - from Piccolo to Mamma Mia!\n\nDetect spaghetti code using PHPMD metrics.\n\nPASTA focuses on **tangled, complex code** - the kind that's hard to test, hard to change, and hard to understand. These issues aren't caught by type checkers like PHPStan or Psalm, yet they're often what kills project sustainability over time.\n\nUnlike general code quality tools, it specifically targets metrics that indicate code entanglement: cyclomatic complexity, coupling, and structural bloat.\n\n## Requirements\n\n- PHP 8.1+\n\n## Installation\n\n### As Claude Code Plugin\n\n```text\n/plugin marketplace add koriym/pasta-lunch\n/plugin install pasta-lunch@pasta-lunch\n```\n\n### Via Composer\n\n```bash\ncomposer require --dev koriym/pasta-lunch\n```\n\n## Usage\n\n```bash\n# Via composer script (default target: src)\ncomposer pasta\ncomposer pasta:html > report.html\n\n# Direct execution\n./vendor/bin/pasta\n./vendor/bin/pasta --format=md > report.md\n./vendor/bin/pasta --format=html > report.html\n\n# Custom exclude patterns (default: *Module.php)\n./vendor/bin/pasta src --exclude=\"*Module.php,*Test.php\"\n\n# No exclusions\n./vendor/bin/pasta src --no-exclude\n```\n\n## Composer Scripts\n\nAdd to your project's `composer.json`:\n\n```json\n{\n    \"scripts\": {\n        \"pasta\": \"bin/pasta src\",\n        \"pasta:html\": \"bin/pasta src --format=html\"\n    }\n}\n```\n\nUsage:\n\n```bash\ncomposer pasta\ncomposer pasta:html > report.html\n```\n\n## Spaghetti Levels\n\n| | Level | Meaning |\n|---|-------|---------|\n| üçù | Piccolo | Clean code |\n| üçùüçù | Medio | Acceptable |\n| üçùüçùüçù | Grande | Refactoring required |\n| üçùüçùüçùüçù | Mamma Mia! | Unmaintainable |\n\n## Demo\n\nSee [Sample Report](https://koriym.github.io/pasta-lunch/demo/report.html) for an example HTML output.\n\n## Metrics\n\n| Metric | Piccolo | Medio | Grande | Mamma Mia! |\n|--------|---------|-------|--------|------------|\n| CyclomaticComplexity (CC) | ‚â§10 | 11-15 | 16-20 | 21+ |\n| NPathComplexity | ‚â§100 | 101-200 | 201-500 | 501+ |\n| CouplingBetweenObjects (CBO) | ‚â§10 | 11-15 | 16-20 | 21+ |\n| ExcessiveClassComplexity (ECC) | ‚â§50 | 51-80 | 81-120 | 121+ |\n| ExcessiveMethodLength | ‚â§50 | 51-100 | 101-150 | 151+ |\n| ExcessiveParameterList | ‚â§5 | 6-10 | 11-15 | 16+ |\n| TooManyFields | ‚â§10 | 11-15 | 16-20 | 21+ |\n| TooManyPublicMethods | ‚â§10 | 11-15 | 16-20 | 21+ |\n\nSee [Issue Types](https://koriym.github.io/pasta-lunch/) for detailed documentation.\n\n### Why these thresholds?\n\nPASTA thresholds are designed around **clean code ideals**, not just \"acceptable\" levels. PHPMD defaults represent the point where \"measures should be taken\" - meaning code at those thresholds already needs attention.\n\n| Metric | PHPMD Default | PASTA Piccolo | Rationale |\n|--------|---------------|---------------------|-----------|\n| NPath | 200 | ‚â§100 | 200 paths exceeds human cognitive capacity |\n| CBO | 13 | ‚â§10 | Proper DI keeps coupling under 10 |\n| MethodLength | 100 | ‚â§50 | Modern standards favor 30-50 lines |\n\n- **Piccolo** = Clean, maintainable code\n- **Medio** = Approaching PHPMD thresholds\n- **Grande** = At or beyond PHPMD \"action required\" level\n- **Mamma Mia!** = Critical, immediate refactoring needed\n\n## License\n\n[MIT](LICENSE)\n"
      },
      "plugins": [
        {
          "name": "pasta-lunch",
          "source": "./",
          "description": "Detect spaghetti code using PHPMD metrics. Measures CBO, CC, NPath to identify refactoring targets.",
          "version": "1.0.0",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add koriym/pasta-lunch",
            "/plugin install pasta-lunch@pasta-lunch"
          ]
        }
      ]
    }
  ]
}