{
  "author": {
    "id": "petekp",
    "display_name": "Pete Petrash",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/950779?u=5a9c6ab47383f67a46c0a09597e6bb866d11292e&v=4",
    "url": "https://github.com/petekp",
    "bio": "software designer",
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 19,
      "total_commands": 0,
      "total_skills": 23,
      "total_stars": 1,
      "total_forks": 0
    }
  },
  "marketplaces": [
    {
      "name": "petekp-agent-skills",
      "version": null,
      "description": "Agent skills for UI development, parameter tuning, and design iteration",
      "owner_info": {
        "name": "Pete Petrash",
        "email": "petekp@users.noreply.github.com"
      },
      "keywords": [],
      "repo_full_name": "petekp/agent-skills",
      "repo_url": "https://github.com/petekp/agent-skills",
      "repo_description": "Agent skills for UI development, parameter tuning, and design iteration",
      "homepage": null,
      "signals": {
        "stars": 1,
        "forks": 0,
        "pushed_at": "2026-01-29T20:19:18Z",
        "created_at": "2026-01-20T18:19:22Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 5877
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 1551
        },
        {
          "path": "process-hunter",
          "type": "tree",
          "size": null
        },
        {
          "path": "process-hunter/SKILL.md",
          "type": "blob",
          "size": 5885
        },
        {
          "path": "skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/agent-changelog",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/agent-changelog/SKILL.md",
          "type": "blob",
          "size": 4865
        },
        {
          "path": "skills/agentic-docs",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/agentic-docs/SKILL.md",
          "type": "blob",
          "size": 6951
        },
        {
          "path": "skills/agentic-docs/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/agentic-docs/references/language-examples.md",
          "type": "blob",
          "size": 10837
        },
        {
          "path": "skills/autonomous-agent-readiness",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/autonomous-agent-readiness/SKILL.md",
          "type": "blob",
          "size": 7264
        },
        {
          "path": "skills/autonomous-agent-readiness/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/autonomous-agent-readiness/references/assessment-criteria.md",
          "type": "blob",
          "size": 16463
        },
        {
          "path": "skills/capture-learning",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/capture-learning/SKILL.md",
          "type": "blob",
          "size": 10608
        },
        {
          "path": "skills/capture-learning/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/capture-learning/references/section-templates.md",
          "type": "blob",
          "size": 3706
        },
        {
          "path": "skills/checkpoint",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/checkpoint/SKILL.md",
          "type": "blob",
          "size": 5126
        },
        {
          "path": "skills/dev-server",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/dev-server/SKILL.md",
          "type": "blob",
          "size": 2502
        },
        {
          "path": "skills/exhaustive-systems-analysis",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/exhaustive-systems-analysis/SKILL.md",
          "type": "blob",
          "size": 9264
        },
        {
          "path": "skills/hierarchical-matching-systems",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/hierarchical-matching-systems/SKILL.md",
          "type": "blob",
          "size": 14415
        },
        {
          "path": "skills/hierarchical-matching-systems/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/hierarchical-matching-systems/references/algorithms.md",
          "type": "blob",
          "size": 4916
        },
        {
          "path": "skills/hierarchical-matching-systems/references/decision-guide.md",
          "type": "blob",
          "size": 8526
        },
        {
          "path": "skills/interaction-design",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/interaction-design/SKILL.md",
          "type": "blob",
          "size": 13545
        },
        {
          "path": "skills/interaction-design/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/interaction-design/references/accessibility-patterns.md",
          "type": "blob",
          "size": 19655
        },
        {
          "path": "skills/interaction-design/references/animation-timing.md",
          "type": "blob",
          "size": 13259
        },
        {
          "path": "skills/interaction-design/references/cognitive-foundations.md",
          "type": "blob",
          "size": 12852
        },
        {
          "path": "skills/interaction-design/references/component-patterns.md",
          "type": "blob",
          "size": 16080
        },
        {
          "path": "skills/interaction-design/references/direct-manipulation.md",
          "type": "blob",
          "size": 27727
        },
        {
          "path": "skills/interaction-design/references/goals-and-context.md",
          "type": "blob",
          "size": 10909
        },
        {
          "path": "skills/interaction-design/references/input-and-physicality.md",
          "type": "blob",
          "size": 12636
        },
        {
          "path": "skills/interaction-design/references/instrumental-interaction.md",
          "type": "blob",
          "size": 34968
        },
        {
          "path": "skills/macos-app-design",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/macos-app-design/SKILL.md",
          "type": "blob",
          "size": 3166
        },
        {
          "path": "skills/macos-app-design/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/macos-app-design/references/macos-design-guide.md",
          "type": "blob",
          "size": 11628
        },
        {
          "path": "skills/manual-testing",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/manual-testing/SKILL.md",
          "type": "blob",
          "size": 4373
        },
        {
          "path": "skills/model-first-reasoning",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/model-first-reasoning/SKILL.md",
          "type": "blob",
          "size": 8171
        },
        {
          "path": "skills/optimize-agent-docs",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/optimize-agent-docs/SKILL.md",
          "type": "blob",
          "size": 7417
        },
        {
          "path": "skills/orchestrate-swarms",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/orchestrate-swarms/SKILL.md",
          "type": "blob",
          "size": 50346
        },
        {
          "path": "skills/process-hunter",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/process-hunter/SKILL.md",
          "type": "blob",
          "size": 2398
        },
        {
          "path": "skills/proposal-review",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/proposal-review/SKILL.md",
          "type": "blob",
          "size": 7395
        },
        {
          "path": "skills/record-todos",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/record-todos/SKILL.md",
          "type": "blob",
          "size": 4837
        },
        {
          "path": "skills/rust",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/rust/SKILL.md",
          "type": "blob",
          "size": 6214
        },
        {
          "path": "skills/rust/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/rust/references/data-modeling.md",
          "type": "blob",
          "size": 5847
        },
        {
          "path": "skills/rust/references/file-io.md",
          "type": "blob",
          "size": 4997
        },
        {
          "path": "skills/rust/references/process-integration.md",
          "type": "blob",
          "size": 7713
        },
        {
          "path": "skills/rust/references/testing.md",
          "type": "blob",
          "size": 7650
        },
        {
          "path": "skills/rust/references/text-and-parsing.md",
          "type": "blob",
          "size": 10501
        },
        {
          "path": "skills/transparent-ui",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/transparent-ui/SKILL.md",
          "type": "blob",
          "size": 6905
        },
        {
          "path": "skills/transparent-ui/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/transparent-ui/references/patterns.md",
          "type": "blob",
          "size": 18098
        },
        {
          "path": "skills/tuning-panel",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/tuning-panel/SKILL.md",
          "type": "blob",
          "size": 4702
        },
        {
          "path": "skills/tuning-panel/examples",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/tuning-panel/examples/export-format.md",
          "type": "blob",
          "size": 4098
        },
        {
          "path": "skills/tuning-panel/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/tuning-panel/references/parameter-categories.md",
          "type": "blob",
          "size": 14016
        },
        {
          "path": "skills/tuning-panel/references/react-leva.md",
          "type": "blob",
          "size": 7436
        },
        {
          "path": "skills/tuning-panel/references/swiftui.md",
          "type": "blob",
          "size": 6984
        },
        {
          "path": "skills/tuning-panel/references/vanilla-js.md",
          "type": "blob",
          "size": 7585
        },
        {
          "path": "skills/typography",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/typography/SKILL.md",
          "type": "blob",
          "size": 11449
        },
        {
          "path": "skills/typography/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/typography/references/fluid-typography.md",
          "type": "blob",
          "size": 10030
        },
        {
          "path": "skills/typography/references/font-loading.md",
          "type": "blob",
          "size": 9314
        },
        {
          "path": "skills/typography/references/internationalization.md",
          "type": "blob",
          "size": 10541
        },
        {
          "path": "skills/typography/references/masters.md",
          "type": "blob",
          "size": 16235
        },
        {
          "path": "skills/typography/references/opentype-features.md",
          "type": "blob",
          "size": 9141
        },
        {
          "path": "skills/typography/references/tailwind-integration.md",
          "type": "blob",
          "size": 10842
        },
        {
          "path": "skills/typography/references/variable-fonts.md",
          "type": "blob",
          "size": 7238
        },
        {
          "path": "skills/unix-macos-engineer",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/unix-macos-engineer/SKILL.md",
          "type": "blob",
          "size": 3307
        },
        {
          "path": "skills/unix-macos-engineer/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/unix-macos-engineer/references/launchd-patterns.md",
          "type": "blob",
          "size": 4921
        },
        {
          "path": "skills/unix-macos-engineer/references/macos-commands.md",
          "type": "blob",
          "size": 6260
        },
        {
          "path": "skills/unix-macos-engineer/references/shell-patterns.md",
          "type": "blob",
          "size": 4594
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"petekp-agent-skills\",\n  \"owner\": {\n    \"name\": \"Pete Petrash\",\n    \"email\": \"petekp@users.noreply.github.com\"\n  },\n  \"metadata\": {\n    \"description\": \"Agent skills for UI development, parameter tuning, and design iteration\",\n    \"version\": \"0.1.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"rust\",\n      \"description\": \"Robust Rust patterns for file-backed data, parsing, persistence, FFI boundaries, and system integration\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/rust\"\n      ]\n    },\n    {\n      \"name\": \"tuning-panel\",\n      \"description\": \"Create bespoke parameter tuning panels for iterating on animations, layouts, colors, typography, physics, or any visual parameters\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/tuning-panel\"\n      ]\n    },\n    {\n      \"name\": \"unix-macos-engineer\",\n      \"description\": \"Expert Unix and macOS systems engineer for shell scripting, system administration, command-line tools, launchd, Homebrew, networking, and low-level system tasks\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/unix-macos-engineer\"\n      ]\n    },\n    {\n      \"name\": \"model-first-reasoning\",\n      \"description\": \"Apply Model-First Reasoning (MFR) to code generation tasks with formal modeling before implementation\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/model-first-reasoning\"\n      ]\n    },\n    {\n      \"name\": \"macos-app-design\",\n      \"description\": \"Design and build native macOS applications with SwiftUI or AppKit following Apple's design guidelines and Liquid Glass design system\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/macos-app-design\"\n      ]\n    },\n    {\n      \"name\": \"interaction-design\",\n      \"description\": \"Apply interaction design principles for intuitive, responsive interfaces including micro-interactions, loading states, transitions, and accessibility patterns\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/interaction-design\"\n      ]\n    },\n    {\n      \"name\": \"capture-learning\",\n      \"description\": \"Capture learnings from sessions to project knowledge files or skills for cross-project reuse\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/capture-learning\"\n      ]\n    },\n    {\n      \"name\": \"dev-server\",\n      \"description\": \"Start development servers with intelligent port management, conflict resolution, and automatic browser opening\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/dev-server\"\n      ]\n    },\n    {\n      \"name\": \"typography\",\n      \"description\": \"Apply professional typography principles for readable, hierarchical, and aesthetically refined interfaces\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/typography\"\n      ]\n    },\n    {\n      \"name\": \"autonomous-agent-readiness\",\n      \"description\": \"Assess a codebase's readiness for autonomous agent development and provide tailored recommendations\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/autonomous-agent-readiness\"\n      ]\n    },\n    {\n      \"name\": \"agentic-docs\",\n      \"description\": \"Write clear, plain-spoken code comments and documentation optimized for both human readers and AI coding assistants\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/agentic-docs\"\n      ]\n    },\n    {\n      \"name\": \"manual-testing\",\n      \"description\": \"Guide users step-by-step through manually testing current work with selectable outcome options\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/manual-testing\"\n      ]\n    },\n    {\n      \"name\": \"agent-changelog\",\n      \"description\": \"Compile agent-optimized changelog by cross-referencing git history with plans and documentation to identify key decisions and stale information\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/agent-changelog\"\n      ]\n    },\n    {\n      \"name\": \"record-todos\",\n      \"description\": \"Enter todo recording mode to capture ideas without acting on them, then organize and prioritize on exit\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/record-todos\"\n      ]\n    },\n    {\n      \"name\": \"proposal-review\",\n      \"description\": \"Facilitate methodical review of proposals by chunking content, predicting reviewer reactions, and producing feedback adapted to the proposal's format\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/proposal-review\"\n      ]\n    },\n    {\n      \"name\": \"optimize-agent-docs\",\n      \"description\": \"Evaluate and optimize agent documentation in dotfiles (.claude, .codex, .cursor, .aider) for better discoverability and retrieval efficiency\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/optimize-agent-docs\"\n      ]\n    },\n    {\n      \"name\": \"exhaustive-systems-analysis\",\n      \"description\": \"|\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/exhaustive-systems-analysis\"\n      ]\n    },\n    {\n      \"name\": \"checkpoint\",\n      \"description\": \"Meta-cognitive decision support that analyzes context and surfaces intelligent next-step options via AskUserQuestion with recommendations\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/checkpoint\"\n      ]\n    },\n    {\n      \"name\": \"process-hunter\",\n      \"description\": \"CAVEMAN HUNT BAD PROCESS! Me find greedy creature eating fire (CPU) and rocks (memory). Me bonk them. Lightning rock (battery) happy. Tribe proud.\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/process-hunter\"\n      ]\n    }\n  ]\n}\n",
        "README.md": "# pete's agent skills\n\n[Agent Skills](https://agentskills.io) for UI development, parameter tuning, and design iteration.\n\n## Installation\n\n```bash\n# Install all skills\nnpx add-skill petekp/agent-skills\n\n# Or install individually via Claude Code\n/plugin install petekp/agent-skills\n```\n\n## Available Skills\n\n### tuning-panel\n\nCreate bespoke parameter tuning panels for iterating on animations, layouts, colors, typography, physics, or any visual parameters.\n\n**Trigger phrases:**\n- \"create a tuning panel\"\n- \"add parameter controls\"\n- \"tweak parameters visually\"\n- \"fine-tune values\"\n\n**Supports:** leva (React), tweakpane (vanilla JS), dat.GUI, SwiftUI native controls\n\n### rust\n\nRobust Rust patterns for file-backed data, parsing, persistence, FFI boundaries, and system integration.\n\n**Trigger phrases:**\n- \"write Rust for file handling\"\n- \"Rust subprocess integration\"\n- \"Serde serialization patterns\"\n- \"UniFFI boundaries\"\n\n**Covers:** UTF-8 safety, atomic writes, state machines, defensive error handling\n\n### swiftui\n\nBuild world-class SwiftUI interfaces for iOS, iPadOS, macOS, and visionOS.\n\n**Trigger phrases:**\n- \"build SwiftUI interface\"\n- \"Liquid Glass adoption\"\n- \"SwiftUI animations\"\n- \"Apple-level UI quality\"\n\n**Covers:** Layout patterns, state management, design tokens, performance, accessibility\n\n## Structure\n\n```\npetekp/agent-skills/\nâ”œâ”€â”€ .claude-plugin/\nâ”‚   â””â”€â”€ marketplace.json\nâ”œâ”€â”€ skills/\nâ”‚   â”œâ”€â”€ tuning-panel/\nâ”‚   â”œâ”€â”€ rust/\nâ”‚   â””â”€â”€ swiftui/\nâ””â”€â”€ README.md\n```\n\n## License\n\nMIT\n",
        "process-hunter/SKILL.md": "---\nname: process-hunter\ndescription: >\n  CAVEMAN HUNT BAD PROCESS! Me find greedy creature eating fire and rocks.\n  Me bonk them good. Use when tribe say \"kill processes\", \"clean up servers\",\n  \"save battery\", \"find resource hogs\", \"bonk next.js\", or \"hunt processes\".\n  Me bonk known bad creature automatic. Me ask before bonk mystery creature.\n---\n\n# ðŸ¦£ CAVEMAN PROCESS HUNTER ðŸ¦£\n\nMe find greedy process eating all fire (CPU) and hoarding rocks (memory).\nMe bonk them. Lightning rock (battery) happy. Tribe proud.\n\n## How Hunt Work\n\n**IMPORTANT:** Always show hunt report after bonking! Tribe need see victory!\n\n1. **Remember before-time** (so can compare later):\n   ```bash\n   python scripts/measure_power.py before\n   ```\n\n2. **Find greedy creature**:\n   ```bash\n   python scripts/hunt_processes.py\n   ```\n\n3. **BONK!** (track how many bonk and how much rock freed)\n\n4. **Show big victory report** - ALWAYS do this after hunt:\n   ```bash\n   python scripts/measure_power.py report <bonk_count> <rocks_freed_mb>\n   ```\n\n## Cave Tools\n\n### hunt_processes.py - Find Bad Creature\n\n```bash\npython scripts/hunt_processes.py [--cpu-threshold 10] [--mem-threshold 500]\n```\n\nMe sort creature into pile:\n- **ðŸ¦´ BONK NOW**: Me know these bad. Safe smash.\n- **ðŸ¤” ME NOT SURE**: Mystery creature. Ask human first.\n\n### terminate_process.py - BONK Tool\n\n```bash\npython scripts/terminate_process.py <pid> [--force]\n```\n\nMe try gentle tap first. If creature no listen, ME USE BIG CLUB.\nUse `--force` to skip gentle tap. Go straight to BIG CLUB.\n\n### measure_power.py - Lightning Rock Checker\n\n```bash\npython scripts/measure_power.py before    # Remember this moment\npython scripts/measure_power.py report    # Show hunt victory\npython scripts/measure_power.py status    # Quick peek at juice\n```\n\n## Creature Me Know Safe To Bonk\n\nThese greedy. These eat much fire. BONK:\n- Next.js fire-eater (`next-server`)\n- Webpack bundle-beast\n- Vite speed-demon\n- Turbo thunder-lizard\n- npm/yarn/pnpm run-run things\n- React Native bridge troll\n- Claude brain-in-box (when too many clone)\n- TypeScript watcher-eye\n- esbuild fast-maker\n\n## When Ask Human First\n\nUse AskUserQuestion before bonk:\n- Mystery creature me not recognize\n- Human app (browser, picture-maker, code-cave)\n- Anything not in bonk-safe list\n\n## Example Hunt\n\n```\n    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\n    â”ƒ  ðŸ¦£ CAVEMAN PROCESS HUNTER ðŸ¦£                    â”ƒ\n    â”ƒ  á•¦(Ã²_Ã³Ë‡)á•¤  Me find greedy process!              â”ƒ\n    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\n\n    ðŸ¦´ BONK NOW! (me know these bad)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      PID  61331 â”‚ Fire: 121.9% ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥\n                  â”‚ Rock: 2886.5MB ðŸª¨ðŸª¨ðŸª¨ðŸª¨ðŸª¨\n                  â”‚ What: Next.js fire-eater\n                  â”‚ Name: next-server\n```\n\n## Victory Report\n\nAfter hunt, always show:\n\n```\n    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n    â•‘     ðŸ¦£ CAVEMAN HUNT REPORT ðŸ¦£                          â•‘\n    â•‘     á•¦(Ã²_Ã³Ë‡)á•¤  Me show what happen!                     â•‘\n    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\n    â”ƒ                    ðŸ’€ðŸ’€ðŸ’€ðŸ’€ðŸ’€                    â”ƒ\n    â”ƒ                    ðŸðŸðŸðŸðŸ                    â”ƒ\n    â”ƒ                                             â”ƒ\n    â”ƒ   Creatures Bonked:   5                      â”ƒ\n    â”ƒ   Cave Space Free: ~7.8 big rocks            â”ƒ\n    â”ƒ                                             â”ƒ\n    â”ƒ   OOGA BOOGA! GOOD HUNT!                    â”ƒ\n    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\n\n    â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®\n    â”‚  ðŸ¦£ MAMMOTH-SIZE VICTORY! ðŸ¦£                â”‚\n    â”‚                                            â”‚\n    â”‚     BEFORE           AFTER                 â”‚\n    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”               â”‚\n    â”‚    â”‚ 135  â”‚  >>>   â”‚ 212  â”‚   +77 sun     â”‚\n    â”‚    â””â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”˜               â”‚\n    â”‚                                            â”‚\n    â”‚  âœ¨ Lightning rock VERY happy! âœ¨          â”‚\n    â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯\n\n     â•”â•â•â•â•â•â•â•â•â•â•â•â•â•—â”\n     â•‘  58%  âš¡  â•‘â”‚\n     â•‘ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘] â•‘â”‚\n     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â”˜\n\n    â±ï¸  Sun-moves remaining: 3:32\n\n    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    ðŸŒ¿ Magic lightning box breathe easy now!\n    ðŸ¦´ Caveman did good. Tribe proud.\n```\n\n## Caveman Wisdom\n\n- Fire = CPU (how much thinking)\n- Rock = Memory (how much cave space)\n- Sun-moves = Minutes (time before lightning rock sleep)\n- Lightning rock = Battery\n- Bonk = Terminate process\n- Big club = SIGKILL (force)\n- Gentle tap = SIGTERM (nice ask)\n",
        "skills/agent-changelog/SKILL.md": "---\nname: agent-changelog\ndescription: Compile an agent-optimized changelog by cross-referencing git history with plans and documentation. Use when asked to \"update changelog\", \"compile history\", \"document project evolution\", or proactively after major milestones, architectural changes, or when stale/deprecated information is detected that could confuse coding agents.\n---\n\n# Agent Changelog\n\nCompile a chronological record of key decisions, architectural changes, and project evolution optimized for coding agent context-building.\n\n## Output\n\nWrite to `AGENT_CHANGELOG.md` in the project root. This file helps agents:\n- Understand key decisions and their rationale\n- Identify deprecated patterns/approaches to avoid\n- Grasp the trajectory from past to present to likely future\n- Detect stale documentation that contradicts current reality\n\n## Workflow\n\n### 1. Gather Sources\n\nCollect information from these sources in parallel:\n\n**Git history:**\n```bash\ngit log --oneline --since=\"6 months ago\" | head -100\ngit log --all --oneline --grep=\"BREAKING\" --grep=\"deprecate\" --grep=\"remove\" --grep=\"migrate\" -i\ngit tag -l --sort=-creatordate | head -20\n```\n\n**Documentation:**\n- `.claude/plans/` - implementation plans and decisions\n- `CLAUDE.md` - project instructions\n- `README.md` - project overview\n- `docs/` or similar documentation directories\n- `CHANGELOG.md` if exists (traditional changelog)\n\n**Code signals:**\n- `@deprecated` annotations\n- `TODO`, `FIXME`, `HACK` comments with dates\n- Migration files, upgrade scripts\n\n### 2. Identify Key Events\n\nExtract events that matter for agent understanding:\n\n**Always include:**\n- Architectural decisions (new patterns, removed patterns)\n- Breaking changes and migrations\n- Deprecated features/approaches\n- Major dependency changes\n- Directory structure changes\n- API changes (internal or external)\n\n**Include if significant:**\n- New features that change how agents should work\n- Bug fixes that reveal incorrect assumptions\n- Performance changes that affect approach recommendations\n\n**Skip:**\n- Minor bug fixes\n- Cosmetic changes\n- Routine dependency updates\n- Individual feature additions (unless architectural)\n\n### 3. Cross-Reference for Contradictions\n\nFor each significant event, check if existing documentation contradicts it:\n\n```\nEvent: \"Migrated from Redux to Zustand\" (commit abc123, 2024-03)\n\nCheck: Does any documentation still reference Redux patterns?\n- README.md mentions Redux? â†’ Flag as STALE\n- CLAUDE.md suggests Redux approach? â†’ Flag as STALE\n- Old tutorials in docs/? â†’ Flag as STALE\n```\n\nTrack contradictions in a \"Stale Information Detected\" section.\n\n### 4. Write the Changelog\n\nStructure the output file:\n\n```markdown\n# Agent Changelog\n\n> This file helps coding agents understand project evolution, key decisions,\n> and deprecated patterns. Updated: [DATE]\n\n## Current State Summary\n\n[2-3 sentences on where the project is NOW - the authoritative current architecture]\n\n## Stale Information Detected\n\n[List any documentation that contradicts current reality - agents should ignore these until fixed]\n\n| Location | States | Reality | Since |\n|----------|--------|---------|-------|\n| docs/auth.md | \"Uses JWT tokens\" | Migrated to sessions | 2024-06 |\n\n## Timeline\n\n### [YEAR-MONTH] - [Brief Title]\n\n**What changed:** [Factual description]\n\n**Why:** [Decision rationale if known from plans/commits]\n\n**Agent impact:** [How this affects how agents should work in the codebase]\n\n**Deprecated:** [What approaches/patterns should agents avoid]\n\n---\n\n[Repeat for each significant event, reverse chronological]\n\n## Deprecated Patterns\n\n[Consolidated list of things agents should NOT do, with what to do instead]\n\n| Don't | Do Instead | Deprecated Since |\n|-------|------------|------------------|\n| Use `OldService` | Use `NewService` | 2024-08 |\n\n## Trajectory\n\n[Brief note on where the project appears to be heading based on recent changes and plans]\n```\n\n### 5. Validate and Update\n\nAfter writing:\n- Read existing `AGENT_CHANGELOG.md` if present and merge, don't duplicate\n- Verify dates against git history\n- Ensure \"Stale Information Detected\" section is actionable\n\n## When to Proactively Run\n\nSuggest running this skill when:\n- A major refactor or migration just completed\n- Plans in `.claude/plans/` were recently executed\n- Multiple architectural decisions happened in quick succession\n- Detected documentation that seems to contradict code reality\n- Starting work on a codebase after a long gap\n- Onboarding to an unfamiliar codebase\n\n## Guidelines\n\n- Prioritize accuracy over completenessâ€”wrong history is worse than incomplete\n- Include rationale when available (commit messages, plan docs)\n- Be specific about what agents should avoid, not just what changed\n- Keep entries conciseâ€”this is reference material, not storytelling\n- Date everything to help agents judge relevance\n",
        "skills/agentic-docs/SKILL.md": "---\nname: agentic-docs\ndescription: Write clear, plain-spoken code comments and documentation that lives alongside the code. Use when writing or reviewing code that needs inline documentation like file headers, function docs, architectural decisions, or explanatory comments. Works well for both human readers and AI coding assistants who see one file at a time.\n---\n\n# Agentic Docs\n\nWrite documentation that lives with the code it describes. Plain language. No jargon. Explain the *why*, not the *what*.\n\n## Core Philosophy\n\n**Co-location wins.** Documentation in separate files drifts out of sync. Comments next to code stay accurate because they're updated together.\n\n**Write for three audiences:**\n1. Future you, six months from now\n2. Teammates reading unfamiliar code\n3. AI assistants (Claude, Copilot) who see one file at a time\n\n**The \"why\" test:** Before writing a comment, ask: \"Does this explain *why* this code exists or *why* it works this way?\" If it only restates *what* the code does, skip it.\n\n## Documentation Levels\n\n### File Headers\n\nEvery file should open with a brief explanation of its purpose and how it fits into the larger system.\n\n```typescript\n// UserAuthContext.tsx\n//\n// Manages authentication state across the app. Wraps the root component\n// to provide login status, user info, and auth methods to any child.\n//\n// Why a context instead of Redux: Auth state is read-heavy and rarely\n// changes mid-session. Context avoids the ceremony of actions/reducers\n// for something this simple.\n```\n\n```swift\n// NetworkRetryPolicy.swift\n//\n// Handles automatic retry logic for failed network requests.\n// Uses exponential backoff with jitter to avoid thundering herd\n// when the server comes back online after an outage.\n//\n// Used by: APIClient, BackgroundSyncManager\n// See also: NetworkError.swift for error classification\n```\n\n**Include:**\n- What this file/module is responsible for\n- Why it exists (if not obvious from the name)\n- Relationships to other parts of the codebase\n- Any non-obvious design decisions\n\n### Function & Method Documentation\n\nDocument the contract, not the implementation.\n\n```typescript\n/**\n * Calculates shipping cost based on weight and destination.\n *\n * Uses tiered pricing: under 1lb ships flat rate, 1-5lb uses\n * regional rates, over 5lb triggers freight calculation.\n *\n * Returns $0 for destinations we don't ship to rather than\n * throwing. Caller should check `canShipTo()` first if they\n * need to distinguish \"free shipping\" from \"can't ship.\"\n */\nfunction calculateShipping(weightLbs: number, zipCode: string): number\n```\n\n```python\ndef sync_user_preferences(user_id: str, prefs: dict) -> SyncResult:\n    \"\"\"\n    Pushes local preference changes to the server and pulls remote changes.\n\n    Conflict resolution: server wins for security settings, local wins\n    for UI preferences. See PREFERENCES.md for the full conflict matrix.\n\n    Called automatically on app foreground. Can also be triggered manually\n    from Settings > Sync Now.\n    \"\"\"\n```\n\n**Include:**\n- What the function accomplishes (not how)\n- Non-obvious parameter constraints or edge cases\n- What the return value means, especially for ambiguous cases\n- Side effects (network calls, file writes, state mutations)\n\n**Skip for:** Simple getters, obvious one-liners, private helpers with descriptive names.\n\n### Inline Comments\n\nUse sparingly. When you need them, explain the reasoning.\n\n```typescript\n// Debounce search by 300ms to avoid hammering the API on every keystroke.\n// 300ms feels responsive while cutting API calls by ~80% in user testing.\nconst debouncedSearch = useMemo(\n  () => debounce(executeSearch, 300),\n  [executeSearch]\n);\n```\n\n```swift\n// Force unwrap is safe here: viewDidLoad guarantees the storyboard\n// connected this outlet. If it's nil, we want to crash immediately\n// rather than fail silently later.\nlet tableView = tableView!\n```\n\n```python\n# Process oldest items first. Newer items are more likely to be\n# modified again, so processing them last reduces wasted work.\nqueue.sort(key=lambda x: x.created_at)\n```\n\n### Architectural Comments\n\nFor code that embodies important design decisions, explain the tradeoffs.\n\n```typescript\n// ARCHITECTURE NOTE: Event Sourcing for Cart\n//\n// Cart state is rebuilt from events (add, remove, update quantity)\n// rather than stored directly. This lets us:\n// - Show complete cart history to users\n// - Replay events for debugging\n// - Retroactively apply promotions to past actions\n//\n// Tradeoff: Reading current cart state requires replaying all events.\n// We cache the computed state in Redis with 5min TTL to keep reads fast.\n// Cache invalidation happens in CartEventHandler.\n```\n\n```swift\n// WHY COORDINATOR PATTERN\n//\n// Navigation logic lives here instead of in view controllers because:\n// 1. VCs don't need to know about each other (loose coupling)\n// 2. Deep linking becomes straightforward; just call coordinator methods\n// 3. Navigation is testable without instantiating UI\n//\n// The tradeoff is more files and indirection. Worth it for apps with\n// 10+ screens; overkill for simple apps.\n```\n\n### TODO Comments\n\nMake them actionable and traceable.\n\n```typescript\n// TODO(pete): Extract to shared util once mobile team needs this too.\n// Blocked on: Mobile API parity (see MOBILE-123)\n\n// HACK: Workaround for Safari flexbox bug. Remove after dropping Safari 14.\n// Bug report: https://bugs.webkit.org/show_bug.cgi?id=XXXXX\n\n// FIXME: Race condition when user rapidly toggles. Need to cancel\n// in-flight requests. Reproduced in issue #892.\n```\n\n## Language-Specific Patterns\n\nSee [references/language-examples.md](references/language-examples.md) for detailed examples in:\n- TypeScript/JavaScript (JSDoc, TSDoc patterns)\n- Swift (documentation comments, MARK pragmas)\n- Python (docstrings, type hint documentation)\n- React/Next.js (component documentation patterns)\n\n## Writing Style\n\n**Plain language.** Write like you're explaining to a smart colleague who doesn't have context.\n\n**Active voice.** \"This function validates...\" not \"Validation is performed...\"\n\n**Be specific.** \"Retries 3 times with 1s backoff\" not \"Handles retries.\"\n\n**Skip the obvious.** If the code says `user.isAdmin`, don't comment \"checks if user is admin.\"\n\n**Date things that expire.** Workarounds, version-specific code, and temporary solutions should note when they can be removed.\n\n**Reference constants, don't duplicate values.** When a behavior is controlled by a constant, reference it by name. Don't restate its value in the comment.\n\n```rust\n// Bad: duplicates the value, will drift when constant changes\n/// Returns true if stale (not updated in last 5 minutes)\npub fn is_stale(&self) -> bool { ... }\n\n// Good: references the constant\n/// Returns true if stale (not updated within [`STALE_THRESHOLD_SECS`])\npub fn is_stale(&self) -> bool { ... }\n```\n\nUnit translations for magic numbers are fine (`1048576 // 1MB`) since they add clarity, not duplication.\n",
        "skills/agentic-docs/references/language-examples.md": "# Language-Specific Documentation Patterns\n\nConcrete examples for each language you work with.\n\n## TypeScript / JavaScript\n\n### File Header\n\n```typescript\n// api/users.ts\n//\n// User CRUD operations against the backend API.\n// All functions return typed responses and throw ApiError on failure.\n//\n// Authentication: Requires valid JWT in AuthContext. These functions\n// read the token automaticallyâ€”callers don't pass it explicitly.\n//\n// Rate limiting: Backend limits to 100 req/min per user. The functions\n// here don't handle rate limiting; see useRateLimitedQuery for that.\n```\n\n### TSDoc for Exported Functions\n\n```typescript\n/**\n * Fetches paginated user list with optional filters.\n *\n * @param options.page - 1-indexed page number (default: 1)\n * @param options.limit - Results per page, max 100 (default: 20)\n * @param options.role - Filter by role, omit for all roles\n * @returns Paginated response with users and total count\n *\n * @example\n * // Get first page of admins\n * const admins = await getUsers({ role: 'admin' });\n *\n * @throws {ApiError} 401 if not authenticated\n * @throws {ApiError} 403 if caller lacks user:read permission\n */\nexport async function getUsers(options: GetUsersOptions): Promise<PaginatedUsers>\n```\n\n### React Component Documentation\n\n```tsx\n// components/UserAvatar.tsx\n//\n// Displays user profile picture with fallback to initials.\n// Handles loading states, broken image URLs, and missing users gracefully.\n//\n// Sizes: 'sm' (24px), 'md' (40px), 'lg' (64px), 'xl' (96px)\n// Uses Next.js Image for automatic optimization on non-fallback images.\n\ninterface UserAvatarProps {\n  /** User object, or null for anonymous/loading state */\n  user: User | null;\n  /** Display size - affects both dimensions and font size */\n  size?: 'sm' | 'md' | 'lg' | 'xl';\n  /** Show online indicator dot */\n  showStatus?: boolean;\n  /** Called when avatar is clicked, omit to disable click behavior */\n  onClick?: () => void;\n}\n\nexport function UserAvatar({ user, size = 'md', showStatus, onClick }: UserAvatarProps) {\n  // Fallback chain: profile pic â†’ initials â†’ generic icon\n  // This handles: new users without pics, broken S3 URLs, deleted accounts\n```\n\n### Hook Documentation\n\n```typescript\n// hooks/useDebounce.ts\n//\n// Debounces a value, returning the latest value after the specified delay\n// with no intermediate updates. Useful for search inputs, form validation,\n// and anything that triggers expensive operations on change.\n//\n// Unlike lodash debounce, this is reactiveâ€”works with React state.\n\n/**\n * @param value - Value to debounce\n * @param delay - Milliseconds to wait after last change (default: 300)\n * @returns The debounced value\n *\n * @example\n * const [search, setSearch] = useState('');\n * const debouncedSearch = useDebounce(search, 500);\n *\n * // API call only fires 500ms after user stops typing\n * useEffect(() => {\n *   if (debouncedSearch) fetchResults(debouncedSearch);\n * }, [debouncedSearch]);\n */\nexport function useDebounce<T>(value: T, delay = 300): T\n```\n\n---\n\n## Swift\n\n### File Header with MARK Sections\n\n```swift\n// UserProfileViewController.swift\n//\n// Main profile screen showing user info, stats, and settings access.\n// Manages its own data loadingâ€”doesn't require data to be passed in.\n//\n// Navigation: Presented modally from anywhere via UserProfileCoordinator.\n// Deep link: myapp://profile/{userId}\n\nimport UIKit\n\n// MARK: - UserProfileViewController\n\nfinal class UserProfileViewController: UIViewController {\n\n    // MARK: - Properties\n\n    private let userId: String\n    private let apiClient: APIClient\n\n    // Lazy because we need self for the data source\n    private lazy var tableView: UITableView = {\n        let table = UITableView(frame: .zero, style: .insetGrouped)\n        table.dataSource = self\n        table.delegate = self\n        return table\n    }()\n\n    // MARK: - Initialization\n\n    /// Creates a profile view for the specified user.\n    /// - Parameters:\n    ///   - userId: User ID to display. Pass current user's ID for \"my profile\" mode.\n    ///   - apiClient: API client for fetching profile data. Defaults to shared instance.\n    init(userId: String, apiClient: APIClient = .shared) {\n        self.userId = userId\n        self.apiClient = apiClient\n        super.init(nibName: nil, bundle: nil)\n    }\n```\n\n### Method Documentation\n\n```swift\n/// Submits the current form data to create a new post.\n///\n/// Validates all fields before submission. If validation fails, highlights\n/// the first invalid field and scrolls it into view.\n///\n/// - Returns: The created post on success\n/// - Throws: `ValidationError` if form data is invalid\n/// - Throws: `APIError` if the network request fails\n///\n/// - Note: This method is throttledâ€”rapid calls within 2 seconds are ignored\n///   to prevent duplicate posts from double-taps.\nfunc submitPost() async throws -> Post {\n```\n\n### Property Documentation\n\n```swift\n/// Maximum retry attempts for failed network requests.\n///\n/// After this many failures, the request fails permanently and surfaces\n/// an error to the user. Set lower for user-initiated actions (they can retry)\n/// and higher for background sync (no user to retry).\nprivate let maxRetryAttempts = 3\n\n/// Cache for computed layout measurements.\n///\n/// Cleared on trait collection changes (rotation, dynamic type).\n/// Keys are IndexPaths; values are cell heights.\nprivate var heightCache: [IndexPath: CGFloat] = [:]\n```\n\n---\n\n## Python\n\n### Module Docstring\n\n```python\n\"\"\"\nuser_sync.py - Bidirectional sync between local DB and external identity provider.\n\nRuns on a schedule (see celery_config.py) and can be triggered manually via\nthe admin panel. Handles conflicts by preferring the most recently modified\nrecord, except for security-sensitive fields which always come from the IdP.\n\nExternal dependencies:\n- OKTA_API_KEY env var for IdP authentication\n- Redis for distributed locking (prevents concurrent syncs)\n\nUsage:\n    # Full sync (typically nightly)\n    sync_all_users()\n\n    # Single user sync (on-demand)\n    sync_user(user_id=\"abc123\")\n\"\"\"\n```\n\n### Function Docstring (Google Style)\n\n```python\ndef calculate_subscription_price(\n    plan: Plan,\n    billing_cycle: BillingCycle,\n    coupon_code: str | None = None,\n) -> PriceBreakdown:\n    \"\"\"\n    Calculate final price for a subscription including discounts and taxes.\n\n    Applies coupon if valid, calculates regional tax based on the user's\n    billing address, and determines any applicable volume discounts.\n\n    Args:\n        plan: The subscription plan to price.\n        billing_cycle: Monthly or annual billing. Annual gets 2 months free.\n        coupon_code: Optional promotional code. Invalid codes are silently\n            ignored (returns full price).\n\n    Returns:\n        PriceBreakdown with subtotal, discount, tax, and total fields.\n        All amounts in cents (USD).\n\n    Raises:\n        PlanNotAvailableError: If the plan is archived or region-restricted.\n\n    Example:\n        >>> breakdown = calculate_subscription_price(\n        ...     plan=Plan.PRO,\n        ...     billing_cycle=BillingCycle.ANNUAL,\n        ...     coupon_code=\"SAVE20\"\n        ... )\n        >>> print(f\"Total: ${breakdown.total / 100:.2f}\")\n        Total: $191.20\n    \"\"\"\n```\n\n### Class Docstring\n\n```python\nclass RateLimiter:\n    \"\"\"\n    Token bucket rate limiter with Redis backend for distributed limiting.\n\n    Each key (typically user ID or IP) gets its own bucket. Tokens refill\n    continuously at the specified rate. Requests consume tokens; when the\n    bucket is empty, requests are rejected until tokens refill.\n\n    Thread-safe and works across multiple server instances via Redis.\n\n    Attributes:\n        capacity: Maximum tokens per bucket.\n        refill_rate: Tokens added per second.\n        redis: Redis client for distributed state.\n\n    Example:\n        limiter = RateLimiter(capacity=100, refill_rate=10)\n\n        if limiter.allow(user_id):\n            process_request()\n        else:\n            raise TooManyRequestsError()\n    \"\"\"\n```\n\n---\n\n## React / Next.js Specific\n\n### Page Component\n\n```tsx\n// app/dashboard/page.tsx\n//\n// Main dashboard showing user's projects, recent activity, and quick actions.\n// Server component that fetches initial data, with client islands for interactivity.\n//\n// Auth: Requires login. Middleware redirects to /login if unauthenticated.\n// Data: Fetches from /api/dashboard, cached for 60s (see revalidate below).\n\nimport { Suspense } from 'react';\nimport { getDashboardData } from '@/lib/api';\nimport { ProjectList } from '@/components/ProjectList';\nimport { ActivityFeed } from '@/components/ActivityFeed';\n\nexport const revalidate = 60; // ISR: regenerate every 60 seconds\n\nexport default async function DashboardPage() {\n  // Parallel fetch for independent data\n  const [projects, activity] = await Promise.all([\n    getDashboardData.projects(),\n    getDashboardData.recentActivity(),\n  ]);\n```\n\n### Context Provider\n\n```tsx\n// contexts/ThemeContext.tsx\n//\n// Provides theme state (light/dark/system) to the component tree.\n// Persists preference to localStorage and syncs with system preference.\n//\n// Usage: Wrap app root with <ThemeProvider>, then use useTheme() in components.\n// The provider handles SSR hydration mismatch by defaulting to system theme\n// on first render, then applying stored preference after hydration.\n\n'use client';\n\nimport { createContext, useContext, useEffect, useState, ReactNode } from 'react';\n\ntype Theme = 'light' | 'dark' | 'system';\n\ninterface ThemeContextValue {\n  /** Current theme setting (what user chose) */\n  theme: Theme;\n  /** Resolved theme (what's actually displayedâ€”never 'system') */\n  resolvedTheme: 'light' | 'dark';\n  /** Update theme preference */\n  setTheme: (theme: Theme) => void;\n}\n```\n\n### API Route\n\n```typescript\n// app/api/webhooks/stripe/route.ts\n//\n// Handles Stripe webhook events for subscription lifecycle.\n// Verifies webhook signature before processingâ€”rejects unsigned requests.\n//\n// Events handled:\n// - checkout.session.completed: Provision access\n// - customer.subscription.updated: Sync plan changes\n// - customer.subscription.deleted: Revoke access\n// - invoice.payment_failed: Trigger dunning flow\n//\n// Idempotency: Events are deduplicated by event ID in Redis (24h TTL).\n// Failed processing retries automatically via Stripe's retry logic.\n\nimport { headers } from 'next/headers';\nimport { NextResponse } from 'next/server';\nimport Stripe from 'stripe';\nimport { handleSubscriptionChange, handlePaymentFailure } from '@/lib/billing';\n\nexport async function POST(request: Request) {\n  // Signature verification happens firstâ€”reject unsigned requests immediately\n  const signature = headers().get('stripe-signature');\n  if (!signature) {\n    return NextResponse.json({ error: 'Missing signature' }, { status: 400 });\n  }\n```\n",
        "skills/autonomous-agent-readiness/SKILL.md": "---\nname: autonomous-agent-readiness\ndescription: Assess a codebase's readiness for autonomous agent development and provide tailored recommendations. Use when asked to evaluate how well a project supports unattended agent execution, assess development practices for agent autonomy, audit infrastructure for agent reliability, or improve a codebase for autonomous agent workflows. Triggers on requests like \"assess this project for agent readiness\", \"how autonomous-ready is this codebase\", \"evaluate agent infrastructure\", or \"improve development practices for agents\".\n---\n\n# Autonomous Agent Readiness Assessment\n\nEvaluate a codebase against proven patterns for autonomous agent execution and provide tailored recommendations.\n\n## Core Philosophy\n\nMost agent failures are system design failures, not model failures. An agent that requires human approval at every step or depends on a developer's laptop being open is not autonomous. Autonomy is an infrastructure decision.\n\n## Assessment Workflow\n\n### Phase 1: Discovery\n\nGather information about the project's current state:\n\n1. **Examine project structure**\n   - Look for CI/CD configuration (`.github/workflows/`, `Jenkinsfile`, `.gitlab-ci.yml`)\n   - Check for containerization (`Dockerfile`, `docker-compose.yml`, `devcontainer.json`)\n   - Identify test infrastructure (`tests/`, `__tests__/`, test config files)\n   - Find environment management (`.env.example`, `requirements.txt`, `package.json`)\n\n2. **Review development workflow**\n   - Read contributing guidelines, README, or developer docs\n   - Check for sandbox/isolation patterns\n   - Look for database setup scripts or fixtures\n   - Identify how dependencies are managed\n\n3. **Assess current automation**\n   - Review existing CI/CD pipelines\n   - Check for automated testing patterns\n   - Look for environment provisioning scripts\n   - Identify cleanup/teardown procedures\n\n### Phase 2: Evaluate Against Principles\n\nScore the project (0-3) on each dimension. See `references/assessment-criteria.md` for detailed rubrics.\n\n| Dimension | What to Look For |\n|-----------|------------------|\n| Sandbox Isolation | Ephemeral environments, container support, clean state per run |\n| Database Independence | Local DB setup, migrations in code, no external DB dependencies |\n| Environment Reproducibility | Explicit dependencies, no hidden state, deterministic setup |\n| Session Independence | Remote execution capability, no user session dependencies |\n| Outcome-Oriented Design | Clear acceptance criteria, minimal procedural coupling |\n| Direct Interfaces | CLI-first tools, OS primitives, minimal abstraction layers |\n| Minimal Framework Overhead | Simple interfaces, no heavy orchestration, composable CLI tools |\n| Explicit State | Workspace directories, file-based artifacts, inspectable logs |\n| Benchmarking | Measurable quality criteria, automated verification |\n| Cost Awareness | Resource limits, usage tracking, explicit provisioning |\n| Verifiable Output | Automated validation, deterministic results, clear exit codes |\n| Infrastructure-Bounded Permissions | System-enforced constraints, least-privilege, no runtime prompts |\n\n### Phase 3: Generate Recommendations\n\nFor each dimension scoring below 2, provide:\n\n1. **Current state**: What exists today\n2. **Gap**: What's missing for autonomous execution\n3. **Recommendation**: Specific, actionable improvement\n4. **Priority**: High/Medium/Low based on impact and effort\n\nTailor recommendations to the project's:\n- Technology stack\n- Team size and workflow\n- Existing infrastructure\n- Deployment targets\n\n## Output Format\n\n```markdown\n# Autonomous Agent Readiness Assessment\n\n## Project: [name]\n## Assessment Date: [date]\n\n## Executive Summary\n\n[1-2 paragraphs summarizing overall readiness and top priorities]\n\n**Overall Readiness Score: X/36** (sum of dimension scores)\n\n## Dimension Scores\n\n| Dimension | Score | Status |\n|-----------|-------|--------|\n| Sandbox Isolation | X/3 | [emoji] |\n| Database Independence | X/3 | [emoji] |\n| ... | ... | ... |\n\nStatus: 0-1 = needs work, 2 = adequate, 3 = strong\n\n## Detailed Findings\n\n### [Dimension Name] (X/3)\n\n**Current State:**\n[What exists]\n\n**Gap:**\n[What's missing]\n\n**Recommendation:**\n[Specific action]\n\n**Priority:** [High/Medium/Low]\n\n[Repeat for each dimension]\n\n## Prioritized Action Plan\n\n### Immediate (This Week)\n1. [Highest impact, lowest effort items]\n\n### Short-term (This Month)\n1. [Important foundational changes]\n\n### Medium-term (This Quarter)\n1. [Larger infrastructure investments]\n\n## Quick Wins\n\n[2-3 changes that can be made today with minimal effort]\n```\n\n## Key Principles Reference\n\n### Sandbox Everything\nEvery agent run executes in its own ephemeral, isolated, disposable environment. Clean environment, writable filesystem, command execution, scoped network access. Environment destroyed after verified output.\n\n### No External Databases\nAgents create their own databases inside the sandbox. Install packages on demand, spin up DBs locally, run migrations, seed data explicitly, tear down at end. Reproducible runs without shared state.\n\n### Environment Garbage Is Real\nLong-lived environments accumulate stray files, half-installed packages, cached state, orphaned processes. Fresh environments surface correctness; persistent environments obscure it.\n\n### Run Independently of User Sessions\nAgent loop decoupled from browser tabs, terminal sessions, developer machines. Start task, close laptop, return to completed artifacts. Control via wall-clock limits, resource limits, automatic cleanup.\n\n### Define Outcomes, Not Procedures\nAvoid step-by-step plans and tool-level micromanagement. Define desired outcome, acceptance criteria, constraints. Planning and execution belong to the agent.\n\n### Direct, Low-Level Interfaces\nDirect access to command execution, persistent files, network requests. OS primitives over abstraction layers. CLI-first systems are easier to debug and more capable than they look.\n\n### Persist State Explicitly\nWritable workspace directory for intermediate results, logs, partial outputs, planning artifacts. Files are inspectable, deterministic, and enable post-run analysis.\n\n### Benchmarks Early\nIntroduce benchmarks as early as possible. Representative and repeatable metrics for quality. Even crude benchmarks beat none.\n\n### Minimal Framework Overhead\nMost real-world agent workflows reduce to running commands, reading/writing files, and making network calls. CLI-first systems are easier to reason about, debug, and more capable than they look. When an abstraction layer is more complex than the task, it becomes the bottleneck.\n\n### Plan for Cost\nProvision token usage, allocate compute explicitly, enforce limits by system. Autonomy shifts where costs appear, doesn't remove them.\n\n### Verifiable Output\nOutput must be verifiable without human review. Automated validation, deterministic results, clear success/failure exit codes. If quality cannot be measured, it cannot be trusted in autonomous operation.\n\n### Infrastructure-Bounded Permissions\nPermissions are constrained by the environment, not by prompts or runtime decisions. Explicit capability grants, sandbox restrictions on dangerous operations, least-privilege by default. No runtime permission prompts required.\n",
        "skills/autonomous-agent-readiness/references/assessment-criteria.md": "# Assessment Criteria\n\nDetailed scoring rubrics for each dimension of autonomous agent readiness.\n\n## Scoring Guide\n\n- **0**: Not present or actively harmful to autonomy\n- **1**: Minimal support, significant gaps\n- **2**: Adequate support, room for improvement\n- **3**: Strong support, follows best practices\n\n---\n\n## 1. Sandbox Isolation\n\n**What it means:** Every agent run executes in its own ephemeral, isolated, disposable environment.\n\n### Score 0\n- No containerization or isolation\n- Agents run directly on shared developer machines\n- No environment cleanup between runs\n- Shared mutable state across runs\n\n### Score 1\n- Basic Docker support exists but not used for agent runs\n- Manual environment setup required\n- Some cleanup scripts but inconsistent use\n- Partial isolation (e.g., virtualenv but shared filesystem)\n\n### Score 2\n- Containerized execution available\n- Automated environment provisioning\n- Cleanup happens but not always complete\n- Network access exists but not scoped\n\n### Score 3\n- Every run gets fresh container/VM\n- Writable filesystem isolated per run\n- Scoped network access (allowlist-based)\n- Automatic teardown after verification\n- No persistent state between runs\n\n### What to look for\n- `Dockerfile`, `docker-compose.yml`\n- `devcontainer.json`\n- VM provisioning scripts (Vagrant, Terraform)\n- CI isolation configuration\n- Network policies, firewall rules\n\n### Common patterns by stack\n\n**Node.js:**\n```dockerfile\nFROM node:20-alpine\nWORKDIR /workspace\nCOPY package*.json ./\nRUN npm ci\nCOPY . .\n```\n\n**Python:**\n```dockerfile\nFROM python:3.11-slim\nWORKDIR /workspace\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY . .\n```\n\n---\n\n## 2. Database Independence\n\n**What it means:** Agents create their own databases inside the sandbox. No shared or external database dependencies.\n\n### Score 0\n- Hardcoded connections to external databases\n- No local database option\n- Shared staging/dev databases\n- No migration scripts\n\n### Score 1\n- Local database possible but not default\n- Migrations exist but require manual setup\n- Some seed data but incomplete\n- External DB used for most testing\n\n### Score 2\n- Local database setup documented\n- Migrations run automatically\n- Seed data available\n- External DB only for integration tests\n\n### Score 3\n- Database spins up as part of environment\n- Migrations run on every fresh start\n- Explicit seed data for all scenarios\n- Complete teardown after runs\n- Zero external database dependencies for agent work\n\n### What to look for\n- `docker-compose.yml` with database services\n- Migration scripts (`migrations/`, `db/migrate/`)\n- Seed files (`seeds/`, `fixtures/`)\n- Database initialization in CI\n- Connection string configuration\n\n### Red flags\n- `.env` files with production/staging URLs\n- Connection pooling to shared instances\n- Missing `DATABASE_URL` override options\n- No test database configuration\n\n---\n\n## 3. Environment Reproducibility\n\n**What it means:** Explicit dependencies, no hidden state, deterministic setup.\n\n### Score 0\n- Dependencies not pinned\n- Setup requires tribal knowledge\n- Different behavior on different machines\n- Hidden dependencies on system packages\n\n### Score 1\n- Some dependencies pinned\n- README documents setup but incomplete\n- Occasional \"works on my machine\" issues\n- Some system dependencies documented\n\n### Score 2\n- All direct dependencies pinned\n- Setup mostly automated\n- CI environment matches local (mostly)\n- System dependencies documented\n\n### Score 3\n- All dependencies pinned with lockfiles\n- Single command setup\n- CI and local environments identical\n- System dependencies containerized\n- Deterministic builds verified\n\n### What to look for\n- Lockfiles (`package-lock.json`, `yarn.lock`, `poetry.lock`, `Gemfile.lock`)\n- Dependency pinning in requirements\n- Setup scripts (`setup.sh`, `make dev`)\n- `.tool-versions`, `.nvmrc`, `.python-version`\n- CI configuration matching local\n\n### Environment garbage indicators\n- `node_modules/` not in `.gitignore` (or checked in)\n- Global package installations required\n- Manual PATH modifications\n- Undocumented environment variables\n- Cache directories affecting behavior\n\n---\n\n## 4. Session Independence\n\n**What it means:** Agent loop decoupled from browser tabs, terminal sessions, developer machines.\n\n### Score 0\n- Requires active terminal session\n- Progress lost on disconnect\n- No background execution option\n- Results only visible in real-time\n\n### Score 1\n- Can run in background (nohup, screen)\n- Some result persistence\n- No proper job management\n- Manual recovery after disconnect\n\n### Score 2\n- Background job support\n- Results persist to files\n- Basic timeout handling\n- Can reconnect to view progress\n\n### Score 3\n- Remote execution by default\n- Full result persistence\n- Wall-clock limits enforced\n- Automatic cleanup on timeout\n- Client disconnect doesn't interrupt\n- Job status queryable\n\n### What to look for\n- Job queue systems (Celery, Bull, Sidekiq)\n- Background worker configuration\n- Result storage (S3, local files, database)\n- Timeout configuration\n- Process management (systemd, supervisord)\n\n### Architecture patterns\n\n**Good:**\n```\nClient â†’ API â†’ Job Queue â†’ Worker â†’ Results Storage\n              â†“\n         Client polls for status\n```\n\n**Bad:**\n```\nClient â†’ Long-running request â†’ Results\n         (breaks on disconnect)\n```\n\n---\n\n## 5. Outcome-Oriented Design\n\n**What it means:** Define desired outcomes and constraints, not step-by-step procedures.\n\n### Score 0\n- All operations require explicit steps\n- No concept of goals or acceptance criteria\n- Agent cannot make decisions\n- Micromanaged tool usage\n\n### Score 1\n- Some operations goal-based\n- Partial acceptance criteria\n- Limited agent autonomy\n- Mix of procedural and outcome-based\n\n### Score 2\n- Most operations goal-based\n- Clear acceptance criteria for common tasks\n- Agent has meaningful autonomy\n- Constraints documented\n\n### Score 3\n- Operations defined by outcomes\n- Verifiable acceptance criteria\n- Agent owns planning and execution\n- Constraints enforce boundaries without dictating steps\n\n### What to look for\n- Task definitions (issues, tickets, specs)\n- Test suites as acceptance criteria\n- Constraint documentation\n- Agent decision logs\n- Outcome verification scripts\n\n### Good vs bad task definitions\n\n**Bad (procedural):**\n```\n1. Open file X\n2. Find function Y\n3. Add parameter Z\n4. Update tests\n5. Run linter\n```\n\n**Good (outcome-based):**\n```\nGoal: Function Y should accept parameter Z\nConstraints: Must pass all tests, linter clean\nAcceptance: Unit test for new parameter exists and passes\n```\n\n---\n\n## 6. Direct Interfaces\n\n**What it means:** Direct access to command execution, persistent files, network requests. OS primitives over abstraction layers.\n\n### Score 0\n- Heavy abstraction layers\n- No CLI access\n- Custom protocols for everything\n- Framework-locked operations\n\n### Score 1\n- Some CLI tools available\n- Abstraction layers common\n- Mixed direct and indirect access\n- Some operations require framework\n\n### Score 2\n- CLI-first for most operations\n- Minimal abstraction\n- Direct file access\n- Standard protocols (HTTP, SSH)\n\n### Score 3\n- All operations CLI-accessible\n- OS primitives preferred\n- No unnecessary abstraction\n- Composable commands\n- Standard Unix patterns\n\n### What to look for\n- CLI entrypoints (`bin/`, `scripts/`)\n- Makefile or similar task runners\n- Direct file operations vs ORM-only\n- Standard protocols vs custom\n- Shell script availability\n\n### Abstraction anti-patterns\n- Custom RPC when HTTP works\n- Framework-specific task runners only\n- No way to run operations outside the app\n- Plugins required for basic operations\n\n---\n\n## 7. Minimal Framework Overhead\n\n**What it means:** Most agent workflows reduce to running commands, reading/writing files, and making network calls. When abstraction is more complex than the task, it becomes the bottleneck.\n\n### Score 0\n- Heavy agent frameworks required for basic operations\n- Complex orchestration layers\n- Custom protocols for everything\n- Cannot run operations without framework\n\n### Score 1\n- Some framework overhead present\n- Basic operations possible without framework\n- Orchestration used inconsistently\n- Mix of simple and complex patterns\n\n### Score 2\n- Most operations work without orchestration\n- Framework optional, not required\n- CLI alternatives available\n- Some unnecessary abstraction remains\n\n### Score 3\n- Operations reduce to shell commands\n- No orchestration framework required\n- CLI-first design throughout\n- Composable, pipeable commands\n- OS primitives preferred over abstractions\n\n### What to look for\n- `bin/` scripts that work standalone\n- Makefile with simple targets\n- No heavy MCP dependencies for basic tasks\n- Shell-scriptable operations\n- Direct HTTP instead of custom RPC\n\n### Anti-patterns\n- Framework more complex than the task\n- Custom agent protocols\n- Required orchestration for simple operations\n- Plugin systems for basic functionality\n- Coordination layers that add no value\n\n---\n\n## 8. Explicit State\n\n**What it means:** Writable workspace directory for intermediate results, logs, partial outputs, planning artifacts.\n\n### Score 0\n- State only in memory\n- No logging\n- Results lost on failure\n- No intermediate checkpoints\n\n### Score 1\n- Basic logging exists\n- Some file output\n- Inconsistent state management\n- Partial checkpoint support\n\n### Score 2\n- Structured logging\n- Results written to files\n- Workspace directories used\n- Checkpoints for long operations\n\n### Score 3\n- All state in inspectable files\n- Structured logs with levels\n- Intermediate results persisted\n- Planning artifacts saved\n- Post-run analysis possible\n- Clear workspace directory structure\n\n### What to look for\n- Logging configuration\n- Output directory conventions\n- Checkpoint/resume support\n- Artifact storage patterns\n- Log aggregation setup\n\n### Workspace structure example\n```\nworkspace/\nâ”œâ”€â”€ logs/\nâ”‚   â”œâ”€â”€ agent.log\nâ”‚   â””â”€â”€ commands.log\nâ”œâ”€â”€ artifacts/\nâ”‚   â”œâ”€â”€ plan.json\nâ”‚   â””â”€â”€ results.json\nâ”œâ”€â”€ intermediate/\nâ”‚   â””â”€â”€ step_1_output.json\nâ””â”€â”€ final/\n    â””â”€â”€ deliverable.zip\n```\n\n---\n\n## 9. Benchmarking\n\n**What it means:** Measurable quality criteria, automated verification. Benchmarks exist early, not as a finishing step.\n\n### Score 0\n- No quality metrics\n- Manual verification only\n- No baseline comparisons\n- Quality is subjective\n\n### Score 1\n- Some tests exist\n- Basic pass/fail metrics\n- No performance baselines\n- Occasional quality checks\n\n### Score 2\n- Test coverage tracked\n- Performance benchmarks exist\n- Quality gates in CI\n- Some automated verification\n\n### Score 3\n- Comprehensive quality metrics\n- Automated benchmarks on every run\n- Performance regression detection\n- Quality comparisons across versions\n- Representative and repeatable metrics\n\n### What to look for\n- Test coverage reports\n- Performance benchmark suites\n- Quality gates in CI\n- Metric tracking over time\n- A/B comparison infrastructure\n\n### Benchmark types\n- **Correctness:** Test suite pass rate\n- **Performance:** Execution time, memory usage\n- **Quality:** Output quality scores (if applicable)\n- **Cost:** Token usage, API calls, compute time\n\n---\n\n## 10. Cost Awareness\n\n**What it means:** Token usage provisioned, compute allocated explicitly, limits enforced by system.\n\n### Score 0\n- No cost tracking\n- Unlimited resource usage\n- No budget awareness\n- Costs discovered after the fact\n\n### Score 1\n- Basic monitoring exists\n- Some manual limits\n- Cost visible but not controlled\n- Post-hoc cost analysis\n\n### Score 2\n- Resource limits in place\n- Usage tracking per task\n- Budget alerts configured\n- Some cost optimization\n\n### Score 3\n- Explicit resource provisioning\n- Per-task cost tracking\n- System-enforced limits\n- Cost as operational input\n- Automatic scaling within budget\n\n### What to look for\n- Resource limits in container configs\n- Token/API usage tracking\n- Budget configuration\n- Cost dashboards\n- Automatic cutoffs\n\n### Resource limit examples\n\n**Docker:**\n```yaml\nservices:\n  agent:\n    deploy:\n      resources:\n        limits:\n          cpus: '2'\n          memory: 4G\n        reservations:\n          cpus: '1'\n          memory: 2G\n```\n\n**Kubernetes:**\n```yaml\nresources:\n  requests:\n    memory: \"2Gi\"\n    cpu: \"1\"\n  limits:\n    memory: \"4Gi\"\n    cpu: \"2\"\n```\n\n---\n\n## 11. Verifiable Output\n\n**What it means:** Output must be verifiable without human review. Automated validation, deterministic results, clear success/failure signals.\n\n### Score 0\n- Output requires human judgment\n- No automated validation\n- Ambiguous completion states\n- Results not inspectable\n\n### Score 1\n- Basic pass/fail signals\n- Some automated checks\n- Output mostly verifiable\n- Manual verification still common\n\n### Score 2\n- Most output automatically validated\n- Clear exit codes\n- Deterministic for most cases\n- Validation pipeline exists\n\n### Score 3\n- All output automatically verifiable\n- Deterministic results\n- Clear success/failure exit codes\n- Validation integrated into workflow\n- No human review required for correctness\n\n### What to look for\n- Exit code conventions\n- Output validation scripts\n- Assertion-based tests\n- Result integrity checks\n- Automated acceptance testing\n\n### Verification patterns\n- Schema validation for structured output\n- Checksum/hash verification for files\n- Integration tests as acceptance criteria\n- Regression test suites\n- Golden file comparisons\n\n---\n\n## 12. Infrastructure-Bounded Permissions\n\n**What it means:** Permissions are constrained by the environment, not by prompts or runtime decisions. System-enforced limits, least-privilege defaults.\n\n### Score 0\n- All-or-nothing permissions\n- Runtime permission prompts\n- Agent self-manages permissions\n- No infrastructure constraints\n\n### Score 1\n- Some permission scoping\n- Mix of runtime and infrastructure controls\n- Basic capability restrictions\n- Inconsistent enforcement\n\n### Score 2\n- Most permissions infrastructure-defined\n- Capability grants explicit\n- Sandbox restrictions in place\n- Some runtime decisions remain\n\n### Score 3\n- All permissions defined at infrastructure level\n- Explicit capability grants only\n- Sandbox restricts dangerous operations\n- No runtime permission decisions\n- Least-privilege by default\n- Permissions auditable\n\n### What to look for\n- IAM/RBAC configurations\n- Container security policies\n- Filesystem permission restrictions\n- Network access controls\n- API key scoping\n\n### Permission patterns\n\n**Good (infrastructure-bounded):**\n```yaml\n# Sandbox policy\ncapabilities:\n  allow:\n    - read_files: [\"./workspace/**\"]\n    - write_files: [\"./workspace/**\"]\n    - network: [\"api.example.com:443\"]\n  deny:\n    - execute_arbitrary\n    - access_secrets\n```\n\n**Bad (runtime decisions):**\n```\nAgent: \"Should I access the production database?\"\nHuman: \"Yes, go ahead\"\n```\n\n---\n\n## Stack-Specific Indicators\n\n### Node.js/TypeScript\n- `package-lock.json` or `yarn.lock` present\n- `npm ci` used instead of `npm install`\n- `.nvmrc` or `engines` field in package.json\n- No global package requirements\n\n### Python\n- `requirements.txt` with pinned versions or `poetry.lock`\n- `pyproject.toml` for modern projects\n- `.python-version` file\n- Virtual environment in setup instructions\n\n### Ruby\n- `Gemfile.lock` committed\n- `.ruby-version` file\n- Bundler used consistently\n\n### Go\n- `go.mod` and `go.sum` committed\n- No vendor directory issues\n- Clear build instructions\n\n### Rust\n- `Cargo.lock` committed (for applications)\n- Clear build profile documentation\n\n---\n\n## Quick Assessment Checklist\n\nRun through these questions for a rapid assessment:\n\n1. Can I run the full test suite in a fresh container? (Sandbox)\n2. Does the test suite work without any external services? (Database)\n3. Is there a single command to set up the development environment? (Reproducibility)\n4. Can I start a task and disconnect without losing progress? (Session)\n5. Are tasks defined by what to achieve, not how to achieve it? (Outcomes)\n6. Can I do everything from the command line? (Interfaces)\n7. Do operations work without heavy frameworks or orchestration? (Framework)\n8. Are intermediate results saved to files I can inspect? (State)\n9. Is there a way to measure if output quality improved? (Benchmarks)\n10. Are there resource limits configured? (Cost)\n11. Can output correctness be checked automatically? (Verification)\n12. Are permissions enforced by infrastructure, not prompts? (Permissions)\n",
        "skills/capture-learning/SKILL.md": "---\nname: capture-learning\ndescription: Analyze recent conversation context and capture learnings to project knowledge files (for project-specific insights) or skills/commands/subagents (for cross-project patterns). Use when the user asks to \"capture this learning\", \"update the docs with this\", \"remember this for next time\", \"document this issue\", \"add this to CLAUDE.md\", \"save this knowledge\", or \"update project knowledge\". Also triggers after resolving build/setup issues, discovering non-obvious patterns, or completing debugging sessions with valuable insights.\n---\n\n# Capture Learning\n\nAnalyze recent conversation context and capture learningsâ€”either to project knowledge files or to skills/commands/subagents for cross-project reuse.\n\n## Core Workflow\n\n### Step 1: Analyze Recent Context\n\nReview the current conversation to identify:\n\n1. **Problem encountered** - What went wrong or was confusing?\n2. **Root cause** - Why did it happen?\n3. **Solution** - How was it resolved?\n4. **Prevention** - How to avoid this in the future?\n\nExtract concrete, actionable insightsâ€”not vague summaries.\n\n**Good learning:**\n```\nWhen running `npm install` on Node 20+, the `--legacy-peer-deps` flag\nis required due to React 18 peer dependency conflicts.\n```\n\n**Bad learning:**\n```\nHad some issues with npm install, fixed it eventually.\n```\n\n### Step 2: Determine Learning Scope\n\nBefore deciding where to capture, ask: **Is this learning project-specific or general?**\n\n| Scope | Characteristics | Capture Target |\n|-------|-----------------|----------------|\n| **Project-specific** | Involves this codebase's architecture, conventions, dependencies, or local setup | Project knowledge files (`.claude/CLAUDE.md`, `.claude/docs/`) |\n| **General** | Applies across all projectsâ€”language patterns, framework best practices, tool usage, API quirks | Skills, commands, or subagents |\n\n**Decision questions:**\n1. Would this help in *other* projects using the same language/framework?\n2. Is this a general technique vs. this repo's specific implementation?\n3. Does an existing skill already cover this domain?\n\n**Examples:**\n\n| Learning | Scope | Target |\n|----------|-------|--------|\n| \"This repo uses `ApiError` class for error handling\" | Project-specific | `.claude/CLAUDE.md` |\n| \"SwiftUI `matchedGeometryEffect` should only apply to background shapes, not content\" | General | `swiftui-excellence` skill |\n| \"Run `npm install --legacy-peer-deps` for this project\" | Project-specific | `.claude/CLAUDE.md` |\n| \"React Server Components can't use `useState`\" | General | `react-component-dev` skill or similar |\n| \"The CI pipeline requires `NODE_ENV=test`\" | Project-specific | `.claude/docs/setup.md` |\n| \"Playwright's `page.waitForSelector` times out silently without proper error handling\" | General | `playwright-qa-tester` agent or new skill |\n\n**If general:** Navigate to the appropriate skill/command/subagent file and update it following its existing structure. Then confirm with user before saving.\n\n**If project-specific:** Continue to Step 3.\n\n### Step 3: Scan for Knowledge Files (Project-Specific Learnings)\n\nDetect existing knowledge files in the project's `.claude/` directory:\n\n```bash\n# Primary targets (most common)\n.claude/CLAUDE.md          # Main project instructions\n./CLAUDE.md                # Root-level alternative\n\n# Secondary targets\n.claude/docs/*.md          # Reference documentation\n.claude/docs/**/*.md       # Nested docs\n\n# Tertiary (check but don't modify without explicit request)\n.claude/plans/*.md         # Planning docs (usually ephemeral)\n```\n\n**Priority order for updates:**\n1. `CLAUDE.md` (project root or `.claude/`) - General learnings, setup issues\n2. `.claude/docs/troubleshooting.md` - If exists, for debugging insights\n3. `.claude/docs/setup.md` - If exists, for environment/build issues\n4. Create new file only if user requests it\n\n### Step 4: Categorize the Learning\n\nDetermine which section the learning belongs in:\n\n| Learning Type | Target Section | Example |\n|--------------|----------------|---------|\n| Build/dependency issues | `## Build & Setup` or `## Troubleshooting` | npm flags, version requirements |\n| Environment setup | `## Environment` or `## Prerequisites` | env vars, tool versions |\n| Code patterns | `## Patterns` or `## Conventions` | naming, architecture decisions |\n| Known issues | `## Known Issues` or `## Gotchas` | quirks, workarounds |\n| Debugging insights | `## Debugging` | how to diagnose specific problems |\n\nIf the target section doesn't exist, propose creating it in a logical location.\n\n### Step 5: Draft the Update\n\nFormat the learning for documentation:\n\n**Structure for issue-based learnings:**\n```markdown\n### [Short descriptive title]\n\n**Problem:** [What went wrong]\n**Cause:** [Why it happened]\n**Solution:** [How to fix/prevent]\n```\n\n**Structure for pattern/convention learnings:**\n```markdown\n### [Pattern name]\n\n[Brief description of when/why to use this pattern]\n\n```code\n[Example if applicable]\n```\n```\n\n**Structure for quick tips:**\n```markdown\n- [Concise actionable tip]\n```\n\nKeep entries:\n- **Scannable** - Use headers, bullets, code blocks\n- **Actionable** - Provide concrete steps or commands\n- **Contextual** - Explain *why*, not just *what*\n\n### Step 6: Present Changes for Confirmation\n\nBefore modifying any file, show the user:\n\n1. **Target file** - Which file will be updated\n2. **Location** - Which section (existing or new)\n3. **Proposed content** - Exact text to be added\n4. **Diff preview** - Show context around insertion point\n\nExample confirmation prompt:\n```\nI'll add this to `.claude/CLAUDE.md` under \"## Troubleshooting\":\n\n### Node 20 Peer Dependency Fix\n\n**Problem:** `npm install` fails with peer dependency conflicts\n**Cause:** React 18 has strict peer deps incompatible with some packages\n**Solution:** Run `npm install --legacy-peer-deps`\n\nShould I apply this update?\n```\n\nWait for explicit user approval before writing.\n\n### Step 7: Apply the Update\n\nAfter confirmation:\n\n1. Read the target file\n2. Find the appropriate insertion point\n3. Add the new content with proper formatting\n4. Write the updated file\n5. Confirm the update was applied\n\nIf creating a new section, place it logically:\n- Setup/build sections near the top\n- Troubleshooting sections near the bottom\n- Patterns/conventions in the middle\n\n## File Detection Details\n\n### Scanning Strategy\n\n```bash\n# Check for .claude directory\nls -la .claude/ 2>/dev/null\n\n# Find all markdown files in .claude\nfind .claude -name \"*.md\" -type f 2>/dev/null\n\n# Check root for CLAUDE.md\nls CLAUDE.md 2>/dev/null\n```\n\n### File Purpose Recognition\n\nInfer file purpose from:\n1. **Filename** - `troubleshooting.md`, `setup.md`, `patterns.md`\n2. **Location** - `.claude/docs/` for references, `.claude/plans/` for planning\n3. **Content** - Existing section headers indicate file's scope\n4. **CLAUDE.md special handling** - Always a valid target for general learnings\n\n### When No Suitable File Exists\n\nIf `.claude/CLAUDE.md` doesn't exist:\n\n1. Check for `./CLAUDE.md` in project root\n2. If neither exists, ask user:\n   - Create `.claude/CLAUDE.md`?\n   - Create a specific doc file (e.g., `.claude/docs/troubleshooting.md`)?\n   - Skip capturing this time?\n\n## Learning Extraction Patterns\n\n### Build/Setup Issues\n\nLook for conversation patterns:\n- Error messages followed by resolution\n- \"Fixed by...\" or \"The solution was...\"\n- Version-specific workarounds\n- Missing dependencies or configuration\n\nExtract: The error, root cause, and fix command/steps.\n\n### Code Patterns\n\nLook for:\n- \"This codebase uses...\" discoveries\n- Architecture decisions explained\n- Naming conventions identified\n- Framework-specific patterns\n\nExtract: Pattern description and rationale.\n\n### Debugging Insights\n\nLook for:\n- Multi-step debugging processes\n- Non-obvious root causes\n- Diagnostic commands or techniques\n- \"The issue was actually...\"\n\nExtract: Symptoms, investigation steps, root cause.\n\n## Examples\n\n### Example 1: Build Issue\n\n**Context:** Session involved fixing a failing build due to TypeScript version mismatch.\n\n**Captured learning:**\n```markdown\n### TypeScript Version Requirement\n\n**Problem:** Build fails with \"Cannot find module 'typescript'\"\n**Cause:** Project requires TypeScript 5.3+ but system has 5.0\n**Solution:**\n```bash\nnpm install typescript@^5.3.0 --save-dev\n```\n```\n\n### Example 2: Environment Setup\n\n**Context:** Session discovered required environment variables.\n\n**Captured learning:**\n```markdown\n### Required Environment Variables\n\nThe following must be set in `.env.local`:\n- `DATABASE_URL` - PostgreSQL connection string\n- `NEXTAUTH_SECRET` - Generate with `openssl rand -base64 32`\n- `NEXTAUTH_URL` - Set to `http://localhost:3000` for development\n```\n\n### Example 3: Code Pattern\n\n**Context:** Session uncovered project's error handling convention.\n\n**Captured learning:**\n```markdown\n### Error Handling Pattern\n\nAll API routes use the `ApiError` class for consistent error responses:\n```typescript\nthrow new ApiError(404, \"Resource not found\");\n```\nThe error handler middleware converts these to JSON responses.\n```\n\n## Edge Cases\n\n### Multiple Learnings\n\nIf the session contains multiple distinct learnings:\n1. List them for the user\n2. Ask which to capture (or all)\n3. Process each separately with confirmation\n\n### Conflicting Information\n\nIf new learning contradicts existing documentation:\n1. Show both versions\n2. Ask user which is correct\n3. Update or replace as directed\n\n### Sensitive Information\n\nNever capture:\n- API keys, tokens, or secrets\n- Passwords or credentials\n- Personal information\n- Internal URLs that shouldn't be documented\n\nIf a learning involves secrets, document the *pattern* without the actual values.\n\n## Quick Reference\n\n**Trigger phrases:** \"capture this\", \"remember this\", \"update docs\", \"document this\", \"add to CLAUDE.md\", \"save this knowledge\"\n\n**First question:** Is this project-specific or general?\n\n**Project-specific targets:** `.claude/CLAUDE.md` (primary), `.claude/docs/*.md` (secondary)\n\n**General targets:** Skills (`~/.claude/skills/`), commands (`~/.claude/commands/`), subagents (plugin agents)\n\n**Always confirm:** Show exact changes before writing\n\n**Format:** Problem â†’ Cause â†’ Solution (for issues), Description â†’ Example (for patterns)\n\n## Additional Resources\n\n### Reference Files\n\n- **[references/section-templates.md](references/section-templates.md)** - Complete templates for common documentation sections (Troubleshooting, Build & Setup, Environment, Patterns, Known Issues, Debugging). Consult when creating new sections or structuring complex learnings.\n",
        "skills/capture-learning/references/section-templates.md": "# Section Templates for Knowledge Files\n\nReference templates for common documentation sections. Use these when creating new sections or structuring learnings.\n\n## CLAUDE.md Section Templates\n\n### Troubleshooting Section\n\n```markdown\n## Troubleshooting\n\n### [Issue Title]\n\n**Symptoms:** [What you observe]\n**Cause:** [Root cause]\n**Solution:**\n```bash\n[fix command]\n```\n\n### [Another Issue]\n...\n```\n\n### Build & Setup Section\n\n```markdown\n## Build & Setup\n\n### Prerequisites\n\n- Node.js 18+ (`node --version`)\n- pnpm 8+ (`pnpm --version`)\n\n### First-Time Setup\n\n```bash\npnpm install\ncp .env.example .env.local\n# Edit .env.local with your values\npnpm dev\n```\n\n### Common Build Issues\n\n[Issue entries here]\n```\n\n### Environment Section\n\n```markdown\n## Environment\n\n### Required Variables\n\n| Variable | Description | Example |\n|----------|-------------|---------|\n| `DATABASE_URL` | Database connection | `postgresql://...` |\n| `API_KEY` | External API key | Get from dashboard |\n\n### Optional Variables\n\n| Variable | Description | Default |\n|----------|-------------|---------|\n| `LOG_LEVEL` | Logging verbosity | `info` |\n```\n\n### Patterns & Conventions Section\n\n```markdown\n## Patterns & Conventions\n\n### [Pattern Name]\n\n**When to use:** [Situation]\n**How to implement:**\n```typescript\n[code example]\n```\n**Why:** [Rationale]\n\n### Naming Conventions\n\n- Components: PascalCase (`UserProfile.tsx`)\n- Hooks: camelCase with `use` prefix (`useAuth.ts`)\n- Utils: camelCase (`formatDate.ts`)\n```\n\n### Known Issues Section\n\n```markdown\n## Known Issues\n\n### [Issue Title]\n\n**Status:** [Open/Workaround available/Won't fix]\n**Description:** [What happens]\n**Workaround:**\n```bash\n[workaround steps]\n```\n**Tracking:** [Link to issue if applicable]\n```\n\n### Debugging Section\n\n```markdown\n## Debugging\n\n### [Problem Category]\n\n**Symptoms:** [What you see]\n**Diagnostic steps:**\n1. Check [thing]\n2. Run `[command]`\n3. Look for [pattern]\n\n**Common causes:**\n- [Cause 1]: [Fix]\n- [Cause 2]: [Fix]\n```\n\n## Standalone Doc Templates\n\n### troubleshooting.md\n\n```markdown\n# Troubleshooting Guide\n\nCommon issues and their solutions.\n\n## Build Issues\n\n### [Issue]\n...\n\n## Runtime Issues\n\n### [Issue]\n...\n\n## Environment Issues\n\n### [Issue]\n...\n```\n\n### setup.md\n\n```markdown\n# Setup Guide\n\n## Prerequisites\n\n[List requirements]\n\n## Installation\n\n[Step-by-step]\n\n## Configuration\n\n[Environment variables, config files]\n\n## Verification\n\n[How to test setup worked]\n\n## Common Setup Issues\n\n[Issues specific to setup]\n```\n\n### patterns.md\n\n```markdown\n# Code Patterns\n\nDocumented patterns and conventions for this codebase.\n\n## Architecture\n\n[High-level patterns]\n\n## Component Patterns\n\n[UI/component patterns]\n\n## Data Patterns\n\n[Data fetching, state management]\n\n## Error Handling\n\n[Error handling patterns]\n```\n\n## Inline Learning Formats\n\n### Quick Tip (single line)\n\n```markdown\n- Run `pnpm typecheck` before committing to catch type errors early.\n```\n\n### Short Note (2-3 lines)\n\n```markdown\n**Note:** The `dev` script uses Turbopack. For webpack behavior, use `dev:webpack`.\n```\n\n### Detailed Entry (structured)\n\n```markdown\n### [Title]\n\n**Problem:** [Description]\n**Cause:** [Why it happens]\n**Solution:** [How to fix]\n**Prevention:** [How to avoid in future]\n```\n\n## Placement Guidelines\n\n| Learning Type | Preferred Section | File Priority |\n|--------------|-------------------|---------------|\n| Build failure fix | Troubleshooting | CLAUDE.md |\n| Environment var | Environment | CLAUDE.md > setup.md |\n| Code convention | Patterns | CLAUDE.md > patterns.md |\n| Workaround | Known Issues | CLAUDE.md |\n| Debug technique | Debugging | CLAUDE.md > troubleshooting.md |\n| Setup step | Build & Setup | CLAUDE.md > setup.md |\n",
        "skills/checkpoint/SKILL.md": "---\nname: checkpoint\ndescription: |\n  Meta-cognitive decision support that analyzes current context and surfaces intelligent next-step options to the user. Use this skill when: (1) User explicitly invokes /checkpoint, (2) Significant work has been completed and a checkpoint is valuable, (3) Uncertainty or ambiguity exists about requirements or approach, (4) Task complexity has expanded beyond initial scope, (5) Before finalizing or committing to ensure nothing is missed. This skill pauses execution, assesses the situation holistically, and presents 2-5 contextually-appropriate options via AskUserQuestion, with a recommended option and rationale.\n---\n\n# Checkpoint\n\nPause, assess, and surface intelligent next-step options to the user.\n\n## When to Trigger Proactively\n\nSuggest this skill (without being asked) when detecting:\n\n- **Completion signal**: A feature, fix, or milestone just finished\n- **Uncertainty signal**: Requirements unclear, multiple valid paths, or low confidence in current direction\n- **Complexity signal**: Scope expanded, unexpected dependencies emerged, or task is taking longer than expected\n- **Drift signal**: Work may have diverged from user's original intent\n- **Quality signal**: Code works but may benefit from review, testing, or refactoring\n\n## Workflow\n\n### 1. Context Assessment\n\nSilently evaluate the current state across these dimensions (do not output this analysis):\n\n- **Progress**: What has been accomplished? What remains?\n- **Quality**: Is the work solid, or are there rough edges?\n- **Alignment**: Does recent work match what the user actually wants?\n- **Uncertainty**: What assumptions were made? What's unclear?\n- **Risk**: What could go wrong? What hasn't been tested?\n- **Efficiency**: Is there a better path forward?\n\n### 2. Generate Options\n\nBased on assessment, generate 2-5 contextually-appropriate options. Draw from (but don't limit to) these archetypes:\n\n| Archetype | When Relevant |\n|-----------|---------------|\n| **Commit progress** | Meaningful progress made, good stopping point |\n| **Systems audit** | Complex changes, potential for bugs or regressions |\n| **Prioritize/plan** | Multiple pending tasks, unclear what matters most |\n| **Re-evaluate decisions** | Low confidence in recent choices, new information available |\n| **Clarify with user** | Assumptions made, requirements ambiguous |\n| **Test/verify** | Code works but edge cases untested |\n| **Refactor/clean up** | Code functional but messy |\n| **Document** | Complex logic that needs explanation |\n| **Step back** | May be overcomplicating or missing simpler solution |\n| **Continue current path** | Clear next step, no reason to pause |\n\n**Option generation principles:**\n- Options should be meaningfully different, not variations of the same thing\n- Include at least one \"continue forward\" option when momentum is valuable\n- Include at least one \"pause and verify\" option when risk is present\n- Avoid analysis paralysis - fewer sharp options beat many vague ones\n\n### 3. Select Recommendation\n\nChoose one option as recommended. The recommendation should reflect:\n\n- What would a thoughtful senior engineer do here?\n- What reduces risk of wasted effort or rework?\n- What serves the user's underlying goals (not just stated requests)?\n\n### 4. Present via AskUserQuestion\n\nUse AskUserQuestion with this structure:\n\n```\nQuestion: \"What would you like to do next?\"\nHeader: \"Next step\" (or contextually appropriate 1-2 words)\nOptions: [generated options with descriptions]\n```\n\n**Option format:**\n- `label`: Action verb phrase (e.g., \"Commit current progress\", \"Run systems audit\")\n- `description`: 1 sentence explaining what this involves and why it might be valuable\n\n**Recommendation:**\n- Place recommended option FIRST in the list\n- Append \"(Recommended)\" to its label\n- Include rationale in the description\n\n### Example Output\n\nFor a scenario where a feature was just implemented but with some shortcuts:\n\n```\nAskUserQuestion:\n  question: \"Feature implementation complete. What would you like to do next?\"\n  header: \"Next step\"\n  options:\n    - label: \"Review and refactor (Recommended)\"\n      description: \"Clean up the shortcuts taken during implementation before they become technical debt. The core logic works but could be more maintainable.\"\n    - label: \"Add test coverage\"\n      description: \"Write tests for the new feature to catch edge cases and prevent regressions.\"\n    - label: \"Commit and move on\"\n      description: \"The feature works - commit it and tackle the next task. Can refactor later if needed.\"\n    - label: \"Walk me through what was built\"\n      description: \"Explain the implementation so you can verify it matches your expectations before proceeding.\"\n```\n\n## Anti-Patterns\n\n- **Don't overthink**: This skill should take seconds, not minutes\n- **Don't list every possible option**: Curate the most valuable 2-5\n- **Don't recommend \"ask user\" when the situation is clear**: Have a point of view\n- **Don't trigger too frequently**: Reserve for genuine decision points, not every minor step\n- **Don't explain the assessment process**: Just present the options naturally\n",
        "skills/dev-server/SKILL.md": "---\nname: dev-server\ndescription: Start development servers with intelligent port management. Use when asked to \"start the dev server\", \"run dev\", \"start development\", \"launch the server\", \"spin up the app\", \"get this running\", \"boot the frontend\", or any request to run a local development server. Handles port conflicts, detects project type, cleans up stale processes, and opens the browser automatically.\nlicense: MIT\nmetadata:\n  author: petekp\n  version: \"0.1.0\"\n---\n\n# Dev Server\n\n## Workflow\n\n1. **Check ports** - Run `scripts/check_ports.sh` to scan common dev ports\n2. **Resolve conflicts**:\n   - **Same project**: Use `--kill-if-same` to kill without asking\n   - **Different project**: Ask user before killing or use alternate port\n3. **Detect environment** - Check for docker-compose.yml, monorepo structure, or package.json\n4. **Start server** - Use detected package manager with `--open` flag; add `--port <n>` if needed\n\n## Port Script\n\n```bash\nscripts/check_ports.sh                   # Scan ports, show which project each belongs to\nscripts/check_ports.sh 3000              # Check specific port with project info\nscripts/check_ports.sh --find 3000       # Find first available port\nscripts/check_ports.sh --kill-if-same 3000   # Kill only if same project (safe)\nscripts/check_ports.sh --kill 3000       # Force kill (ask user first if different project)\n```\n\nThe script detects project ownership by comparing the process's working directory to the current directory. \"Same project\" means the process was started from this directory or a parent/child of it.\n\n## Environment Detection\n\n**Docker projects**: If `docker-compose.yml` exists with a web/app service, suggest `docker compose up` instead.\n\n**Monorepos**: Check if current directory has package.json with `dev` script. If not, look for:\n- `apps/web/package.json` or `packages/app/package.json` (Turborepo/Nx pattern)\n- Root package.json with workspace `dev` script that delegates\n\n**Package manager**: Detect from lockfile (bun.lockb â†’ bun, pnpm-lock.yaml â†’ pnpm, yarn.lock â†’ yarn, otherwise npm).\n\n## Framework Notes\n\nMost frameworks support `--open` and `--port` flags. Exceptions:\n\n| Framework | Default Port | Notes |\n|-----------|--------------|-------|\n| Create React App | 3000 | Uses `PORT=3001` env var instead of `--port` |\n| Gatsby | 8000 | Uses `-p` instead of `--port` |\n| Remix | 3000 | `--port` works in dev mode |\n\nWhen `--open` doesn't work, fall back to `open http://localhost:PORT` after server starts.\n",
        "skills/exhaustive-systems-analysis/SKILL.md": "---\nname: exhaustive-systems-analysis\ndescription: |\n  Perform comprehensive, deep analysis of a system and its subsystems to identify bugs, race conditions, stale documentation, dead code, and correctness issues. Use when asked to \"audit this system\", \"exhaustive analysis of X\", \"analyze for correctness\", \"root out issues in...\", \"deep dive into...\", \"verify this code is correct\", \"find bugs in...\", or when reviewing agent-written code for production readiness. Automatically decomposes systems into subsystems, applies appropriate analysis checklists, and produces structured findings with severity classification.\n---\n\n# Exhaustive Systems Analysis\n\nSystematic audit methodology for rooting out latent issues in codebases, particularly agent-written code that needs verification before production use.\n\n## Core Principles\n\n1. **Subsystem isolation** â€” Analyze each subsystem separately to prevent context pollution\n2. **Evidence-based findings** â€” Every issue must cite specific code locations\n3. **Severity-driven prioritization** â€” Critical issues first, cosmetic issues last\n4. **Assume all issues will be fixed** â€” Don't hedge; be direct about what's wrong\n\n## Workflow\n\n### Phase 1: System Decomposition\n\nBefore analysis, map the system's subsystems. Auto-discover by:\n\n1. **Read project structure** â€” Identify major modules, packages, or directories\n2. **Trace data flow** â€” Follow how data enters, transforms, and exits\n3. **Identify side effects** â€” File I/O, network, database, IPC, state mutations\n4. **Map dependencies** â€” Which subsystems depend on which\n\nOutput a subsystem table:\n\n```markdown\n| # | Subsystem | Files | Side Effects | Priority |\n|---|-----------|-------|--------------|----------|\n| 1 | Lock System | lock.rs | FS: mkdir, rm | High |\n| 2 | API Layer | api/*.rs | Network, DB | High |\n| 3 | Config Parser | config.rs | FS: read | Medium |\n```\n\n**Priority heuristics:**\n- **High**: Side effects, state management, security, concurrency\n- **Medium**: Business logic, data transformation, validation\n- **Low**: Pure utilities, formatting, logging\n\n### Phase 2: Sequential Analysis\n\nAnalyze subsystems in priority order. For large codebases (>5 subsystems or >3000 LOC per subsystem), prefer clearing context between subsystems to prevent analysis drift.\n\nFor each subsystem, apply the appropriate checklist based on subsystem type.\n\n### Phase 3: Consolidation\n\nAfter all subsystems analyzed:\n1. Deduplicate cross-cutting findings\n2. Rank all issues by severity\n3. Produce final report with recommended action order\n\n---\n\n## Analysis Checklists\n\nSelect checklist based on subsystem characteristics. Apply multiple if applicable.\n\n### Stateful Systems (files, databases, caches, locks)\n\n| Check | Question |\n|-------|----------|\n| **Correctness** | Does code do what documentation claims? |\n| **Atomicity** | Can partial writes corrupt state? |\n| **Race conditions** | Can concurrent access cause inconsistency? |\n| **Cleanup** | Are resources released on all exit paths (success, error, panic)? |\n| **Error recovery** | Do failures leave the system in a valid state? |\n| **Stale documentation** | Do comments match actual behavior? |\n| **Dead code** | Are there unused code paths that could confuse maintainers? |\n\n### APIs & Network (HTTP, gRPC, WebSocket, IPC)\n\n| Check | Question |\n|-------|----------|\n| **Input validation** | Are all inputs validated before use? |\n| **Error responses** | Do errors leak internal details? |\n| **Timeout handling** | Are network operations bounded? |\n| **Retry safety** | Are operations idempotent or properly guarded? |\n| **Authentication** | Are auth checks applied consistently? |\n| **Rate limiting** | Can the API be abused? |\n| **Serialization** | Can malformed payloads cause panics? |\n\n### Concurrency (threads, async, channels, locks)\n\n| Check | Question |\n|-------|----------|\n| **Deadlock potential** | Can lock acquisition order cause deadlock? |\n| **Data races** | Is shared mutable state properly synchronized? |\n| **Starvation** | Can any task be indefinitely blocked? |\n| **Cancellation** | Are cancellation/shutdown paths clean? |\n| **Resource leaks** | Are spawned tasks/threads joined or detached properly? |\n| **Panic propagation** | Do panics in tasks crash the whole system? |\n\n### UI & Presentation (views, components, templates)\n\n| Check | Question |\n|-------|----------|\n| **State consistency** | Can UI show stale or inconsistent state? |\n| **Error states** | Are all error conditions rendered appropriately? |\n| **Loading states** | Are async operations properly indicated? |\n| **Accessibility** | Are interactions keyboard/screen-reader accessible? |\n| **Memory leaks** | Are subscriptions/observers cleaned up? |\n| **Re-render efficiency** | Are unnecessary re-renders avoided? |\n\n### Data Processing (parsers, transformers, validators)\n\n| Check | Question |\n|-------|----------|\n| **Edge cases** | Are empty, null, and boundary values handled? |\n| **Type coercion** | Are implicit conversions safe? |\n| **Overflow/underflow** | Are numeric operations bounded? |\n| **Encoding** | Is text encoding handled consistently (UTF-8)? |\n| **Injection** | Can untrusted input escape its context? |\n| **Invariants** | Are data invariants enforced and documented? |\n\n### Configuration & Setup (config files, environment, initialization)\n\n| Check | Question |\n|-------|----------|\n| **Defaults** | Are defaults safe and documented? |\n| **Validation** | Are invalid configs rejected early with clear errors? |\n| **Secrets** | Are secrets handled securely (not logged, not in VCS)? |\n| **Hot reload** | If supported, is reload atomic and safe? |\n| **Compatibility** | Are breaking changes versioned or migrated? |\n\n---\n\n## Severity Classification\n\nClassify every finding. Assume user will fix all issues soon.\n\n| Severity | Criteria | Examples |\n|----------|----------|----------|\n| **Critical** | Data loss, security vulnerability, crash in production | Unhandled panic, SQL injection, file corruption |\n| **High** | Incorrect behavior users will notice | Wrong calculation, race causing wrong UI state, timeout too short |\n| **Medium** | Technical debt that causes confusion or future bugs | Stale docs, misleading names, redundant code paths |\n| **Low** | Cosmetic or minor improvements | Unused parameter, suboptimal algorithm (works correctly) |\n\n---\n\n## Finding Format\n\nEvery finding must follow this structure:\n\n```markdown\n### [SUBSYSTEM] Finding N: Brief Title\n\n**Severity:** Critical | High | Medium | Low\n**Type:** Bug | Race condition | Security | Stale docs | Dead code | Design flaw\n**Location:** `file.rs:line_range` or `file.rs:function_name`\n\n**Problem:**\nWhat's wrong and why it matters. Be specific.\n\n**Evidence:**\nCode snippet or reasoning demonstrating the issue.\n\n**Recommendation:**\nSpecific fix. Include code if helpful.\n```\n\n---\n\n## Output Structure\n\nAdapt output to project organization. Common patterns:\n\n### Pattern A: Audit Directory (recommended for 5+ subsystems)\n\n```\n.claude/docs/audit/\nâ”œâ”€â”€ 00-analysis-plan.md      # Subsystem table, priorities, methodology\nâ”œâ”€â”€ 01-subsystem-name.md     # Individual analysis\nâ”œâ”€â”€ 02-another-subsystem.md\nâ””â”€â”€ SUMMARY.md               # Consolidated findings, action items\n```\n\n### Pattern B: Single Document (for smaller systems)\n\n```\n.claude/docs/audit/system-name-audit.md\n# Contains: plan, all findings, summary\n```\n\n### Pattern C: Inline with Existing Docs\n\nIf project has existing `docs/` or similar, place audit artifacts there.\n\n**Always create a summary** with:\n- Total findings by severity\n- Top 5 most critical issues\n- Recommended fix order\n\n---\n\n## Session Management\n\nFor thorough analysis:\n\n- **Small systems (<1000 LOC, <3 subsystems)**: Single session acceptable\n- **Medium systems (1000-5000 LOC, 3-7 subsystems)**: Clear context between phases\n- **Large systems (>5000 LOC, >7 subsystems)**: Separate sessions per subsystem\n\nWhen clearing context, document progress in the analysis plan file so the next session can continue.\n\n---\n\n## Pre-Analysis: Known Issues Sweep\n\nBefore deep analysis, scan for documented issues:\n\n1. **Check CLAUDE.md / README** for \"gotchas\" or \"known issues\"\n2. **Search for TODO/FIXME/HACK** comments\n3. **Review recent commits** for bug fixes (may indicate fragile areas)\n4. **Check issue tracker** if accessible\n\nAdd these as starting hypothesesâ€”verify or refute during analysis.\n\n---\n\n## Anti-Patterns to Avoid\n\n| Anti-Pattern | Why It's Bad | Instead |\n|--------------|--------------|---------|\n| Skimming code | Misses subtle bugs | Read every line in scope |\n| Assuming correctness | Agent code often has edge case bugs | Verify each code path |\n| Vague findings | \"This looks wrong\" isn't actionable | Cite specific lines, explain why |\n| Over-scoping | Analysis paralysis | Strict subsystem boundaries |\n| Ignoring tests | Tests reveal assumptions | Read tests to understand intent |\n\n---\n\n## Completion Criteria\n\nAnalysis is complete when:\n\n1. âœ… All high-priority subsystems analyzed\n2. âœ… Every finding has severity, location, and recommendation\n3. âœ… Summary document exists with prioritized action items\n4. âœ… No \"TBD\" or \"needs investigation\" items remain\n5. âœ… Cross-references between related findings added\n",
        "skills/hierarchical-matching-systems/SKILL.md": "---\nname: hierarchical-matching-systems\ndescription: >\n  Expertise in architecting, implementing, reviewing, and debugging hierarchical matching systems.\n  Use when working with: (1) Two-sided matching (Gale-Shapley, hospital-resident, student-school),\n  (2) Assignment/optimization problems (Hungarian algorithm, bipartite matching),\n  (3) Multi-level hierarchy matching (org charts, taxonomies, nested categories),\n  (4) Entity resolution and record linkage across hierarchies.\n  Triggers: debugging match quality issues, reviewing matching algorithms, translating business\n  requirements into constraints, validating match correctness, architecting new matching systems,\n  fixing unstable matches, resolving constraint violations, diagnosing preference misalignment.\n---\n\n# Hierarchical Matching Systems\n\nThis skill provides rigid diagnostic and architectural procedures for hierarchical matching systems. Follow checklists exactlyâ€”matching bugs often hide in skipped steps.\n\n## Quick Reference\n\n- **Algorithm selection**: See [references/decision-guide.md](references/decision-guide.md)\n- **Algorithm details**: See [references/algorithms.md](references/algorithms.md)\n\n---\n\n## 1. Problem Classification Checklist\n\nBefore any work, classify the problem. Check ALL that apply:\n\n```\nâ–¡ TWO-SIDED: Both sides have preferences (studentsâ†”schools, workersâ†”jobs)\nâ–¡ ONE-SIDED: Only one side has preferences (tasksâ†’workers, itemsâ†’bins)\nâ–¡ HIERARCHICAL: Entities exist at multiple levels (orgâ†’deptâ†’teamâ†’person)\nâ–¡ WEIGHTED: Matches have costs/scores to optimize\nâ–¡ CONSTRAINED: Hard limits exist (capacity, exclusions, required pairings)\nâ–¡ STABLE: Solution must resist defection (no blocking pairs)\nâ–¡ OPTIMAL: Solution must minimize/maximize objective function\nâ–¡ FUZZY: Entities may partially match (entity resolution, deduplication)\n```\n\nClassification determines algorithm family. Proceed to Section 2 for architecture or Section 3 for debugging.\n\n---\n\n## 2. Architecture Procedure\n\nFollow these phases in order when designing a new matching system.\n\n### Phase 2.1: Requirements Translation\n\nConvert each business requirement into formal constraints:\n\n| Business Requirement | Constraint Type | Formal Expression |\n|---------------------|-----------------|-------------------|\n| \"Each student gets one school\" | Capacity | `|matches(s)| = 1 âˆ€ student s` |\n| \"Schools have seat limits\" | Capacity | `|matches(school)| â‰¤ capacity` |\n| \"Siblings must be together\" | Coupling | `school(s1) = school(s2) if siblings(s1,s2)` |\n| \"Student X cannot attend Y\" | Exclusion | `(X, Y) âˆ‰ matches` |\n| \"Priority for residents\" | Preference ordering | `rank(resident) < rank(non-resident)` |\n\n**Checklist:**\n```\nâ–¡ List ALL business requirements\nâ–¡ Classify each as: capacity | coupling | exclusion | ordering | soft preference\nâ–¡ Identify conflicts between requirements (document tradeoffs)\nâ–¡ Distinguish HARD constraints (must satisfy) from SOFT (optimize toward)\nâ–¡ Validate translations with stakeholder examples\n```\n\n### Phase 2.2: Algorithm Selection\n\nUse [references/decision-guide.md](references/decision-guide.md) to select algorithm. Verify:\n\n```\nâ–¡ Algorithm handles all HARD constraints\nâ–¡ Algorithm can optimize SOFT constraints (or document gaps)\nâ–¡ Complexity acceptable for data size (see references/algorithms.md)\nâ–¡ Stability requirements met (if two-sided)\nâ–¡ Optimality requirements met (if weighted)\n```\n\n### Phase 2.3: Data Model Design\n\nDefine entities, relationships, and preference representation:\n\n```\nâ–¡ Entity schema for each side (attributes, identifiers)\nâ–¡ Preference representation (ranked list | score matrix | pairwise comparisons)\nâ–¡ Constraint encoding (how exclusions/couplings are stored)\nâ–¡ Hierarchy representation (if multi-level: tree | DAG | adjacency list)\nâ–¡ Tie-breaking rules (deterministic ordering for equal preferences)\n```\n\n### Phase 2.4: Interface Contracts\n\nSpecify inputs, outputs, and invariants:\n\n**Input Contract:**\n```\nâ–¡ Preference format and validation rules\nâ–¡ Constraint format and validation rules\nâ–¡ Required vs optional fields\nâ–¡ How missing preferences are handled (reject | default rank | exclude)\n```\n\n**Output Contract:**\n```\nâ–¡ Match format (pairs | assignment map | ranked list)\nâ–¡ Unmatched entity handling (explicit list | null matches | error)\nâ–¡ Match metadata (scores, stability proof, constraint satisfaction report)\n```\n\n**Invariants:**\n```\nâ–¡ Determinism: same input â†’ same output (document randomness if any)\nâ–¡ Completeness: all entities matched OR explicitly unmatched\nâ–¡ Validity: all matches satisfy hard constraints\n```\n\n### Phase 2.5: Testing Strategy\n\nDefine validation before implementation:\n\n```\nâ–¡ Unit tests for preference parsing and constraint validation\nâ–¡ Property tests: stability, optimality, constraint satisfaction\nâ–¡ Edge cases: empty inputs, single entity, all tied preferences\nâ–¡ Regression tests from known-good examples\nâ–¡ Performance benchmarks at target scale\n```\n\n---\n\n## 3. Debugging Procedure\n\nFollow this diagnostic sequence for any matching issue. Do not skip steps.\n\n### Phase 3.1: Symptom Classification\n\nIdentify the symptom category:\n\n| Symptom | Category | Go To |\n|---------|----------|-------|\n| Same inputs, different outputs | INSTABILITY | 3.2 |\n| Matches violate business rules | CONSTRAINT VIOLATION | 3.3 |\n| Matches technically valid but \"wrong\" | PREFERENCE MISALIGNMENT | 3.4 |\n| Errors with nested/hierarchical data | HIERARCHY BUG | 3.5 |\n| Poor performance at scale | PERFORMANCE | 3.6 |\n\n### Phase 3.2: Instability Diagnosis\n\n**Root causes of non-deterministic matches:**\n\n```\nâ–¡ RANDOMNESS: Check for unseeded RNG in tie-breaking\n   â†’ Fix: Use deterministic tie-breaker (lexicographic ID, timestamp)\n\nâ–¡ FLOATING POINT: Check score comparisons for floating point issues\n   â†’ Fix: Use epsilon comparison or integer scores\n\nâ–¡ HASH ORDERING: Check if iteration order depends on hash maps\n   â†’ Fix: Sort keys before iteration\n\nâ–¡ PARALLEL RACE: Check for concurrent modifications\n   â†’ Fix: Synchronize or use sequential processing\n\nâ–¡ INPUT ORDERING: Check if algorithm is order-sensitive\n   â†’ Fix: Canonicalize input order (sort by ID)\n```\n\n**Verification:**\n```\nâ–¡ Run matching 10x with identical inputs\nâ–¡ Diff all outputs\nâ–¡ If any differ, add logging to identify divergence point\n```\n\n### Phase 3.3: Constraint Violation Diagnosis\n\n**Diagnostic sequence:**\n\n```\n1. â–¡ IDENTIFY: Which specific constraint is violated?\n   â†’ List the violated constraint and the violating match\n\n2. â–¡ TRACE: Where should constraint be enforced?\n   â†’ Map constraint to code location (filter | validation | algorithm step)\n\n3. â–¡ VERIFY ENCODING: Is constraint correctly represented?\n   â†’ Print constraint data structure, verify against requirement\n\n4. â–¡ VERIFY ENFORCEMENT: Is constraint checked at right time?\n   â†’ Add logging before/after enforcement point\n\n5. â–¡ CHECK ORDERING: Is constraint checked before conflicting decisions?\n   â†’ Trace decision sequence, verify constraint checked first\n\n6. â–¡ CHECK COMPLETENESS: Are all instances covered?\n   â†’ Enumerate all entities that should be constrained\n```\n\n**Common failure patterns:**\n\n| Pattern | Symptom | Fix |\n|---------|---------|-----|\n| Late enforcement | Valid intermediate state, invalid final | Move check earlier |\n| Partial coverage | Some entities constrained, others not | Enumerate all cases |\n| Soft vs hard confusion | Constraint violated for \"better\" match | Reclassify as hard |\n| Stale data | Constraint on outdated values | Refresh before check |\n\n### Phase 3.4: Preference Misalignment Diagnosis\n\nWhen matches are valid but don't reflect intended priorities:\n\n```\n1. â–¡ EXTRACT: Get the actual preference data used\n   â†’ Log/print the exact preference structure at match time\n\n2. â–¡ COMPARE: Check against expected preferences\n   â†’ Side-by-side diff with business-stated priorities\n\n3. â–¡ TRACE TRANSFORMATION: Follow preference from input to algorithm\n   â†’ Log at each transformation step (parsing, normalization, scoring)\n\n4. â–¡ CHECK SCORING: Verify score calculation\n   â†’ Manual calculation for 2-3 example cases\n\n5. â–¡ CHECK AGGREGATION: If multi-criteria, verify combination\n   â†’ Test each criterion independently, then combined\n\n6. â–¡ CHECK NORMALIZATION: Verify scale/range handling\n   â†’ Check for min/max, z-score, or rank normalization bugs\n```\n\n**Scoring function checklist:**\n\n```\nâ–¡ Direction correct (higher = better or lower = better, consistently)\nâ–¡ Scale appropriate (no single factor dominating)\nâ–¡ Missing values handled (null â†’ 0? â†’ excluded? â†’ default?)\nâ–¡ Ties handled explicitly (not left to floating point chance)\nâ–¡ Edge cases: extreme values, all same values, single candidate\n```\n\n### Phase 3.5: Hierarchy Traversal Diagnosis\n\nFor multi-level matching issues:\n\n```\n1. â–¡ VISUALIZE: Draw the hierarchy with the problematic match\n   â†’ Tree diagram showing all levels and the match path\n\n2. â–¡ CHECK INHERITANCE: Do child constraints inherit from parent?\n   â†’ Verify constraint propagation rules\n\n3. â–¡ CHECK AGGREGATION: How do child preferences roll up?\n   â†’ Verify aggregation function (sum | max | weighted | majority)\n\n4. â–¡ CHECK LEVEL INTERACTION: Can matches cross levels?\n   â†’ Document allowed/forbidden cross-level matches\n\n5. â–¡ CHECK TRAVERSAL ORDER: Top-down or bottom-up?\n   â†’ Verify algorithm processes levels in intended order\n\n6. â–¡ CHECK PARTIAL MATCHES: Can a parent match without all children?\n   â†’ Document completeness requirements per level\n```\n\n**Common hierarchy bugs:**\n\n| Bug | Symptom | Fix |\n|-----|---------|-----|\n| Missing propagation | Child ignores parent constraint | Add inheritance logic |\n| Double counting | Same entity weighted multiple times | Deduplicate in aggregation |\n| Level skipping | Match at wrong level | Add level validation |\n| Orphan handling | Unattached children cause errors | Define orphan policy |\n\n### Phase 3.6: Performance Diagnosis\n\nFor scale and speed issues:\n\n```\n1. â–¡ PROFILE: Identify the slow component\n   â†’ Time each phase: input parsing, preference building, matching, output\n\n2. â–¡ COMPLEXITY CHECK: Verify actual vs expected complexity\n   â†’ Log iteration counts, compare to theoretical O(n)\n\n3. â–¡ MEMORY CHECK: Profile memory usage\n   â†’ Watch for preference matrix explosion (nÂ² space)\n\n4. â–¡ ALGORITHM FIT: Verify algorithm appropriate for scale\n   â†’ See references/algorithms.md for complexity comparison\n\n5. â–¡ CACHING: Check for redundant computation\n   â†’ Log cache hits/misses for preference lookups\n\n6. â–¡ BATCH VS STREAMING: Check processing model\n   â†’ Full recomputation vs incremental updates\n```\n\n---\n\n## 4. Testing & Validation Procedure\n\n### 4.1: Correctness Properties\n\nTest these properties for every matching system:\n\n```\nâ–¡ DETERMINISM: run(input) = run(input) (10 trials minimum)\nâ–¡ COMPLETENESS: all entities either matched or explicitly unmatched\nâ–¡ VALIDITY: all matches satisfy all hard constraints\nâ–¡ STABILITY (if applicable): no blocking pairs exist\nâ–¡ OPTIMALITY (if applicable): objective function at expected value\n```\n\n### 4.2: Stability Verification (Two-Sided Matching)\n\nFor stable matching, verify no blocking pairs:\n\n```python\n# Pseudocode - verify no blocking pair exists\nfor each unmatched_pair (a, b):\n    if a prefers b over current_match(a):\n        if b prefers a over current_match(b):\n            FAIL: blocking pair found (a, b)\n```\n\n```\nâ–¡ Enumerate all non-matched pairs\nâ–¡ Check mutual preference for each\nâ–¡ Report any blocking pairs found\nâ–¡ For large instances, sample-check (document coverage)\n```\n\n### 4.3: Constraint Satisfaction Verification\n\n```\nâ–¡ List all hard constraints\nâ–¡ For each match, verify against each constraint\nâ–¡ Generate constraint satisfaction report\nâ–¡ Flag any violations with specific match and constraint\n```\n\n### 4.4: Edge Case Test Suite\n\nMandatory test cases:\n\n```\nâ–¡ Empty input (no entities on one or both sides)\nâ–¡ Single entity (one-to-one degenerate case)\nâ–¡ All identical preferences (maximum tie scenario)\nâ–¡ Mutually exclusive preferences (everyone wants same thing)\nâ–¡ Impossible constraints (unsatisfiable, should error clearly)\nâ–¡ Maximum capacity (all slots exactly filled)\nâ–¡ Minimum capacity (barely enough slots)\nâ–¡ Self-referential (can entity match itself? test boundary)\nâ–¡ Circular preferences (Aâ†’Bâ†’Câ†’A)\n```\n\n### 4.5: Regression Test Maintenance\n\n```\nâ–¡ Capture real production cases that revealed bugs\nâ–¡ Minimize to smallest reproducing example\nâ–¡ Document expected behavior explicitly\nâ–¡ Run on every change to matching logic\n```\n\n---\n\n## 5. Review Checklist\n\nWhen reviewing matching system code or design:\n\n### 5.1: Design Review\n\n```\nâ–¡ Problem correctly classified (Section 1)\nâ–¡ Algorithm appropriate for problem class (references/decision-guide.md)\nâ–¡ All business requirements mapped to constraints (Section 2.1)\nâ–¡ Hard vs soft constraints clearly distinguished\nâ–¡ Tie-breaking is deterministic and documented\nâ–¡ Hierarchy semantics defined (if applicable)\n```\n\n### 5.2: Implementation Review\n\n```\nâ–¡ Preference representation matches algorithm requirements\nâ–¡ Constraints enforced at correct point in algorithm\nâ–¡ No hidden randomness (unseeded RNG, hash iteration)\nâ–¡ Floating point comparison handled correctly\nâ–¡ Edge cases handled (empty, single, ties)\nâ–¡ Error messages identify specific constraint violations\n```\n\n### 5.3: Testing Review\n\n```\nâ–¡ All properties from 4.1 tested\nâ–¡ Edge cases from 4.4 covered\nâ–¡ Performance benchmarked at realistic scale\nâ–¡ Regression tests exist for past bugs\n```\n\n---\n\n## Appendix: Common Anti-Patterns\n\n| Anti-Pattern | Problem | Solution |\n|--------------|---------|----------|\n| Greedy first-come | Order-dependent, non-optimal | Use proper algorithm |\n| Score = sum(all factors) | One factor dominates | Normalize scales |\n| Retry until valid | Non-deterministic, slow | Fix constraint order |\n| Global preference cache | Stale across updates | Invalidate on change |\n| String matching for entities | Case/whitespace bugs | Use canonical IDs |\n| Float equality for ties | Non-deterministic | Use epsilon or integer |\n| Recursive hierarchy walk | Stack overflow risk | Use iterative with explicit stack |\n| NÂ² preference matrix | Memory explosion | Use sparse representation |\n",
        "skills/hierarchical-matching-systems/references/algorithms.md": "# Algorithm Reference\n\nConcise summaries of core matching algorithms. Use with [decision-guide.md](decision-guide.md) for selection.\n\n---\n\n## Two-Sided Stable Matching\n\n### Gale-Shapley (Deferred Acceptance)\n\n**Problem**: Match two groups where both sides have preferences. Find stable matching (no blocking pairs).\n\n**Complexity**: O(nÂ²) time, O(n) space\n\n**Mechanism**:\n```\nwhile unmatched proposers exist:\n    proposer proposes to highest-ranked unproposed receiver\n    receiver tentatively accepts if:\n        - unmatched, OR\n        - prefers proposer over current match\n    rejected proposers continue to next choice\n```\n\n**Properties**:\n- Proposer-optimal: proposers get best stable partner\n- Receiver-pessimal: receivers get worst stable partner\n- Strategy-proof for proposers (not receivers)\n\n**Variants**:\n| Variant | Use Case |\n|---------|----------|\n| Hospital-Resident | Many-to-one (capacity > 1 on one side) |\n| College Admissions | Hospital-Resident with quotas |\n| Stable Roommates | One-sided (everyone can match anyone) |\n\n**Pitfalls**:\n- Tie-breaking affects outcomeâ€”document method\n- Incomplete preferences need explicit handling\n- Proposer/receiver role assignment matters\n\n---\n\n## Assignment/Optimization\n\n### Hungarian Algorithm (Kuhn-Munkres)\n\n**Problem**: Bipartite weighted matching. Minimize total cost (or maximize total value).\n\n**Complexity**: O(nÂ³) time, O(nÂ²) space\n\n**Mechanism**:\n```\n1. Subtract row minima, then column minima\n2. Cover all zeros with minimum lines\n3. If lines < n: adjust matrix, repeat\n4. If lines = n: find perfect matching through zeros\n```\n\n**Properties**:\n- Finds globally optimal assignment\n- Works with any real-valued weights\n- Handles maximization by negating weights\n\n**Pitfalls**:\n- Requires complete bipartite graph (add dummy nodes if needed)\n- Equal-sized partitions (pad smaller side)\n- O(nÂ³) may be slow for n > 10,000\n\n### Auction Algorithm\n\n**Problem**: Same as Hungarian, but better for sparse graphs.\n\n**Complexity**: O(nm log(nC)) where C = max weight, m = edges\n\n**When to prefer over Hungarian**:\n- Sparse preference graphs\n- Parallel/distributed implementation needed\n- Approximate solution acceptable (with early stopping)\n\n---\n\n## Maximum Matching (Unweighted)\n\n### Hopcroft-Karp\n\n**Problem**: Maximum cardinality bipartite matching (most pairs, no weights).\n\n**Complexity**: O(EâˆšV) time\n\n**Use when**: Only care about match count, not quality/cost.\n\n### Blossom Algorithm (Edmonds)\n\n**Problem**: Maximum matching in general (non-bipartite) graphs.\n\n**Complexity**: O(VÂ²E) time\n\n**Use when**: Entities can match any other entity (not strictly two-sided).\n\n---\n\n## Multi-Level / Hierarchical\n\n### Top-Down Propagation\n\n**Mechanism**:\n```\nfor each level from root to leaf:\n    match at current level\n    propagate constraints to children\n    children inherit parent assignments\n```\n\n**Use when**: Parent decisions constrain children.\n\n### Bottom-Up Aggregation\n\n**Mechanism**:\n```\nfor each level from leaf to root:\n    compute preferences at current level\n    aggregate to parent level\n    match at root, then assign downward\n```\n\n**Use when**: Leaf-level preferences determine parent matching.\n\n### Hierarchical Stable Matching\n\n**Extension of Gale-Shapley for nested structures**:\n- Match at each level respecting parent constraints\n- Children can only match within parent's match scope\n- Requires clear inheritance rules\n\n---\n\n## Entity Resolution\n\n### Blocking + Scoring Pipeline\n\n**Mechanism**:\n```\n1. BLOCKING: Reduce comparison space\n   - Group by key attributes (name prefix, zip code)\n   - Compare only within blocks\n\n2. SCORING: Compute similarity\n   - String similarity (Jaro-Winkler, Levenshtein)\n   - Attribute-weighted combination\n\n3. CLUSTERING: Group matches\n   - Threshold-based pairing\n   - Transitive closure for groups\n```\n\n**Complexity**: O(b Ã— nÂ²/b) = O(nÂ²/b) where b = block count\n\n### Fellegi-Sunter Model\n\n**Probabilistic record linkage**:\n- Model match vs non-match probability per attribute\n- Compute likelihood ratio\n- Classify: match / non-match / review\n\n**Use when**: Training data available for probability estimation.\n\n---\n\n## Complexity Comparison\n\n| Algorithm | Time | Space | Best For |\n|-----------|------|-------|----------|\n| Gale-Shapley | O(nÂ²) | O(n) | Two-sided stability |\n| Hungarian | O(nÂ³) | O(nÂ²) | Optimal weighted assignment |\n| Auction | O(nm log nC) | O(n+m) | Sparse weighted |\n| Hopcroft-Karp | O(EâˆšV) | O(V+E) | Max cardinality |\n| Blossom | O(VÂ²E) | O(V+E) | Non-bipartite |\n\n---\n\n## Implementation Checklist\n\nFor any algorithm implementation:\n\n```\nâ–¡ Tie-breaking documented and deterministic\nâ–¡ Incomplete preferences handled (reject/default/exclude)\nâ–¡ Input validation before algorithm runs\nâ–¡ Intermediate state inspectable for debugging\nâ–¡ Output includes match metadata (scores, iterations, unmatched)\nâ–¡ Edge cases tested (empty, single, all-tied)\n```\n",
        "skills/hierarchical-matching-systems/references/decision-guide.md": "# Algorithm Decision Guide\n\nUse this flowchart to select the appropriate matching algorithm. Answer each question in order.\n\n---\n\n## Decision Flowchart\n\n```\nSTART\n  â”‚\n  â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q1: Do BOTH sides have preferences? â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º YES â”€â”€â–º Q2 (Two-Sided)\n  â”‚\n  â””â”€â–º NO â”€â”€â”€â–º Q5 (One-Sided)\n\n\nTWO-SIDED PATH\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q2: Is STABILITY required?             â”‚\nâ”‚ (No pair should prefer each other      â”‚\nâ”‚  over their assigned matches)          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º YES â”€â”€â–º Q3 (Stable Matching)\n  â”‚\n  â””â”€â–º NO â”€â”€â”€â–º Q4 (Optimization)\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q3: One-to-one or many-to-one?         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º ONE-TO-ONE â”€â”€â–º GALE-SHAPLEY\n  â”‚\n  â””â”€â–º MANY-TO-ONE â”€â–º HOSPITAL-RESIDENT (Gale-Shapley variant)\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q4: Do matches have weights/costs?     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º YES â”€â”€â–º Q6 (Weighted)\n  â”‚\n  â””â”€â–º NO â”€â”€â”€â–º HOPCROFT-KARP (maximum cardinality)\n\n\nONE-SIDED PATH\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q5: Can ANY entity match ANY other?    â”‚\nâ”‚ (Non-bipartite graph)                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º YES â”€â”€â–º BLOSSOM ALGORITHM\n  â”‚\n  â””â”€â–º NO â”€â”€â”€â–º Q4 (Optimization)\n\n\nWEIGHTED PATH\nâ•â•â•â•â•â•â•â•â•â•â•â•â•\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q6: Is the preference graph sparse?    â”‚\nâ”‚ (Each entity prefers << n others)      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º YES (sparse) â”€â”€â–º AUCTION ALGORITHM\n  â”‚\n  â””â”€â–º NO (dense) â”€â”€â”€â”€â–º HUNGARIAN ALGORITHM\n\n\nHIERARCHY PATH (applies to any above)\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q7: Is matching hierarchical/nested?   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º YES â”€â”€â–º Q8\n  â”‚\n  â””â”€â–º NO â”€â”€â”€â–º Use algorithm from above directly\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q8: Do parent decisions constrain      â”‚\nâ”‚     children, or do children inform    â”‚\nâ”‚     parent decisions?                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º PARENT CONSTRAINS CHILDREN â”€â”€â–º TOP-DOWN + chosen algorithm per level\n  â”‚\n  â””â”€â–º CHILDREN INFORM PARENT â”€â”€â”€â”€â”€â”€â–º BOTTOM-UP aggregation + match at root\n\n\nENTITY RESOLUTION PATH\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Q9: Is this fuzzy/probabilistic        â”‚\nâ”‚     matching (entity resolution)?      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  â”‚\n  â”œâ”€â–º YES â”€â”€â–º BLOCKING + SCORING pipeline\n  â”‚           (optionally Fellegi-Sunter for probabilistic)\n  â”‚\n  â””â”€â–º NO â”€â”€â”€â–º Use decision tree above\n```\n\n---\n\n## Quick Reference Table\n\n| Requirement | Algorithm | Notes |\n|-------------|-----------|-------|\n| Two-sided, stable, 1:1 | Gale-Shapley | Proposer-optimal |\n| Two-sided, stable, n:1 | Hospital-Resident | Capacity on one side |\n| Weighted, optimal | Hungarian | O(nÂ³), exact |\n| Weighted, sparse | Auction | Better for sparse graphs |\n| Max pairs, no weights | Hopcroft-Karp | Cardinality only |\n| Non-bipartite | Blossom | General graphs |\n| Fuzzy/probabilistic | Blocking + Scoring | Entity resolution |\n| Hierarchical | Wrap any above | Add level traversal |\n\n---\n\n## Constraint Compatibility Matrix\n\nCheck that your constraints are compatible with the chosen algorithm:\n\n| Constraint Type | Gale-Shapley | Hungarian | Hopcroft-Karp | Auction |\n|-----------------|--------------|-----------|---------------|---------|\n| Capacity (n:1) | âœ“ (variant) | âœ“ (expand) | âœ“ (expand) | âœ“ |\n| Exclusions | âœ“ (remove from list) | âœ“ (âˆž cost) | âœ“ (remove edge) | âœ“ |\n| Required pairs | PartialÂ¹ | âœ“ (pre-assign) | âœ“ (pre-assign) | âœ“ |\n| Coupling | ManualÂ² | âœ“ (composite) | ManualÂ² | ManualÂ² |\n| Soft preferences | âœ— | âœ“ (weights) | âœ— | âœ“ |\n\nÂ¹ Can force by truncating preference lists, but may cause instability\nÂ² Requires creating composite entities or post-processing\n\n---\n\n## Decision Examples\n\n### Example 1: School Choice\n\n> Students rank schools, schools have capacities, want stable assignment\n\n- Q1: Both sides have preferences? **YES**\n- Q2: Stability required? **YES** (no student-school pair should want to deviate)\n- Q3: One-to-one or many-to-one? **MANY-TO-ONE** (schools take multiple students)\n\n**â†’ HOSPITAL-RESIDENT (student-proposing Gale-Shapley)**\n\n### Example 2: Task Assignment\n\n> Assign tasks to workers to minimize total cost, workers have capacity\n\n- Q1: Both sides have preferences? **NO** (tasks don't prefer workers)\n- Q5: Non-bipartite? **NO** (workers and tasks are distinct sets)\n- Q4: Weighted? **YES** (minimizing cost)\n- Q6: Sparse? **NO** (any worker can do any task)\n\n**â†’ HUNGARIAN ALGORITHM** (expand workers to capacity)\n\n### Example 3: Org Restructuring\n\n> Match employees to new positions across department hierarchy\n\n- Q7: Hierarchical? **YES** (org â†’ dept â†’ team â†’ position)\n- Q8: Direction? **PARENT CONSTRAINS** (dept capacity limits teams)\n- Q1: Both sides have preferences? **YES** (employees rank positions, managers rank employees)\n- Q2: Stability required? **YES**\n\n**â†’ TOP-DOWN hierarchical Gale-Shapley**\n\n### Example 4: Customer Deduplication\n\n> Identify same customer across databases with fuzzy name/address matching\n\n- Q9: Entity resolution? **YES**\n\n**â†’ BLOCKING (by zip + name prefix) + SCORING (Jaro-Winkler on names) + threshold clustering**\n\n---\n\n## Red Flags: Wrong Algorithm Indicators\n\n| Symptom | Likely Problem | Correct Choice |\n|---------|----------------|----------------|\n| \"Optimal\" but pairs defect | Used optimization when needed stability | Gale-Shapley family |\n| Slow at scale (n > 5000) | Hungarian O(nÂ³) too slow | Auction or Hopcroft-Karp |\n| Matches feel \"random\" | Using max cardinality when need weights | Hungarian/Auction |\n| Can't express preference strength | Using stable matching when need optimization | Hungarian/Auction |\n| Blocking pairs exist | Wrong proposer side or incomplete lists | Check Gale-Shapley setup |\n\n---\n\n## Algorithm Selection Checklist\n\nBefore finalizing choice:\n\n```\nâ–¡ Algorithm handles all HARD constraints\nâ–¡ Algorithm complexity acceptable for data size\nâ–¡ Stability vs optimality tradeoff understood\nâ–¡ Hierarchy traversal direction determined (if applicable)\nâ–¡ Tie-breaking strategy compatible with algorithm\nâ–¡ Edge cases documented (what happens with empty/single/tied?)\n```\n",
        "skills/interaction-design/SKILL.md": "---\nname: interaction-design\ndescription: Design intuitive, meaningful interactions grounded in user goals and cognitive principles. Use when designing component behaviors, user flows, feedback systems, error handling, loading states, transitions, accessibility, keyboard navigation, touch/gesture interactions, or when evaluating interaction quality. Also use for modal vs modeless decisions, direct manipulation patterns, input device considerations, emotional/dramatic aspects of UX, or when asked about making interfaces feel responsive, humane, and goal-directed.\n---\n\n# Interaction Design\n\nDesign interactions that help real people accomplish real goals with minimum friction and maximum meaning.\n\n## The Fundamental Question\n\nBefore any pattern or timing value, ask: **What is the user trying to accomplish, and how does this interaction help or hinder that goal?**\n\nInteraction design is not about mechanisms. It is about helping specific people achieve specific purposes while respecting their time, attention, and humanity.\n\n## Output Contracts\n\n### Interaction Specification\n\n```markdown\n## Interaction Spec: [Component Name]\n\n### User Goal\nWhat is the user trying to accomplish? What are the stakes?\n\n### Conceptual Model\nHow should users understand this interaction? What mental model should they form?\n\n### States & Transitions\n| State | Appearance | Transition | Emotional Tone |\n|-------|------------|------------|----------------|\n| Default | [appearance] | â€” | [calm/ready/inviting] |\n| Hover | [changes] | 150ms ease-out | [responsive/acknowledged] |\n| Active | [pressed] | 50ms | [committed/engaged] |\n| Loading | [feedback] | â€” | [progressing/patient] |\n| Success | [confirmation] | 200ms | [accomplished/closure] |\n| Error | [clear indication] | â€” | [recoverable/guided] |\n\n### Keyboard & Input\n- Tab: [focus behavior]\n- Enter/Space: [activation]\n- Escape: [reversal/dismissal]\n- Touch: [gesture, target size]\n\n### Error Prevention & Recovery\n- How does design prevent errors?\n- What happens when errors occur?\n- How does user recover?\n\n### Accessibility\n- Screen reader announcement\n- Focus management\n- Reduced motion behavior\n```\n\n### Flow Analysis\n\n```markdown\n## Flow Analysis: [Journey Name]\n\n### User Goal & Stakes\nWhat does success mean? What does failure cost?\n\n### Dramatic Arc\n- Setup: How does user enter this flow?\n- Rising action: What builds toward the goal?\n- Climax: The moment of commitment/completion\n- Resolution: Confirmation and next steps\n\n### Steps\n1. [Step] â†’ [Interaction] â†’ [User feeling]\n\n### Friction Analysis\n- Necessary friction (builds engagement/prevents errors)\n- Excise to eliminate (work that doesn't serve the goal)\n\n### Error Paths\n- [Error scenario]: [Prevention] â†’ [Recovery]\n```\n\n## Core Principles\n\n### 1. Goal-Directed Design\n\nUsers are not \"operators\" triggering state changes. They are people with purposes.\n\n**Ask first:**\n- Who is using this? (Not abstract \"users\"â€”specific archetypes)\n- What are they trying to accomplish?\n- What excise can we eliminate? (Work that doesn't serve their goal)\n- How should they feel during and after?\n\n**The perpetual intermediate:** Most users are neither novices learning nor experts optimizing. They learned enough to work and won't learn more. Design for themâ€”make the common path fast while keeping advanced options discoverable but unobtrusive.\n\n### 2. Conceptual Models\n\nUsers must form accurate mental models of how the system works. The gap between the designer's model and the user's model is where confusion lives.\n\n**The system image** (what users see and interact with) must accurately convey the designer's model. When users are confused, the system image has failedâ€”not the user.\n\n**Signifiers** communicate where action is possible and how to perform it. A drag handle icon is a signifier; the ability to drag is the affordance. Design signifiers that make affordances discoverable.\n\n### 3. Direct Manipulation\n\nMake the computer disappear so users concentrate on their task.\n\n**Core properties:**\n- Visible objects of interest, always accessible\n- Rapid, incremental, reversible actions\n- Immediate feedbackâ€”action and result visibly connected\n- Operations in the problem domain, not command syntax\n\n**The syntactic/semantic insight:** Direct manipulation works because it operates at the semantic level (the problem domain) rather than requiring translation into syntactic commands. This reduces cognitive load by eliminating the translation step.\n\n**When direct manipulation is inappropriate:**\n- Precise specification (typing \"24pt\" may be better than dragging)\n- Batch operations across many objects\n- Abstract operations without spatial metaphor\n- Expert users who prefer keyboard efficiency\n\n### 4. Reversibility Enables Exploration\n\nReversibility is not a featureâ€”it is a psychological safety mechanism that transforms a system from intimidating to inviting.\n\n- **Undo depth:** Support multi-step undo, not just single-step\n- **Congruent inverses:** If Cmd+B bolds, Cmd+B unbolds (same action reverses)\n- **State visibility:** Show that undo is available\n- **Graceful degradation:** When true undo isn't possible, confirm before destructive actions\n\n### 5. Error Prevention Over Error Handling\n\nErrors are usually design failures, not user failures.\n\n**Slips** (execution errors): User intends correctly but acts wrong\n- Prevent with constraints, defaults, confirmation for destructive actions\n\n**Mistakes** (intention errors): User forms wrong goal or plan\n- Prevent with clear conceptual models, visible system state\n\n**Design forcing functions:**\n- Interlocks: Require prerequisite actions\n- Lockins: Prevent stopping mid-action when dangerous\n- Lockouts: Prevent entering dangerous states\n\nSee [references/cognitive-foundations.md](references/cognitive-foundations.md) for error psychology and prevention patterns.\n\n### 6. Feedback & System Status\n\nEvery action deserves acknowledgment. Users should never wonder \"Did that work?\"\n\n| Response Time | Perception | Design Response |\n|---------------|------------|-----------------|\n| <100ms | Instant | Direct result, no indicator |\n| 100msâ€“1s | Brief delay | Subtle state change (cursor, opacity) |\n| 1â€“10s | Noticeable wait | Spinner or determinate progress |\n| >10s | Long operation | Progress bar, estimate, allow cancel |\n\n**Optimistic UI:** Update immediately, reconcile errors gracefully. But be honestâ€”don't show success before confirming it for important actions.\n\n### 7. Modality: A Necessary Evil\n\nModes cause errors when users forget which mode they're in. But modes also isolate cognitive scope and can reduce errors when users would otherwise forget context.\n\n**Use modeless design** (inspectors, inline editing) when:\n- User needs to see results while adjusting\n- Trial-and-error is expected\n- Context switching is frequent\n\n**Accept modality** when:\n- Isolating scope reduces errors (complex multi-step wizards)\n- Action is destructive and confirmation prevents accidents\n- System needs exclusive attention (authentication)\n\n**If you must use modes:**\n- Make current mode highly visible (not just status bar)\n- Ensure mode indicators are near the locus of attention\n- Provide quick escape (Escape key, clear exit path)\n\n### 8. Meaning and Emotional Design\n\nInteractions are not just efficient or inefficientâ€”they carry meaning.\n\n**Visceral level:** Immediate emotional response to appearance\n**Behavioral level:** Pleasure or frustration from use\n**Reflective level:** What the experience means, how it's remembered\n\nA loading state that builds anticipation differs from one that frustratesâ€”same mechanism, different meaning. Consider:\n- What should the user feel during this interaction?\n- What story does this interaction tell?\n- How does completing this action transform the user's situation?\n\nSee [references/goals-and-context.md](references/goals-and-context.md) for dramatic structure and emotional design.\n\n## Decision Frameworks\n\n### Activation Type\n\n| Use Frequency | Recommended Activation | Rationale |\n|---------------|------------------------|-----------|\n| Constant | Always visible (spatial) | Zero activation cost |\n| Frequent | Keyboard shortcut + visible control | Fast for regulars, discoverable for others |\n| Occasional | Menu or command palette | Saves space, still findable |\n| Rare/Dangerous | Menu only, possibly nested | Prevents accidents |\n\n### When to Animate\n\nAnimation serves purposesâ€”it is not decoration.\n\n**Animate when:**\n- Maintaining object constancy during transitions\n- Communicating causality (this caused that)\n- Reducing change blindness\n- Conveying emotional tone appropriate to context\n\n**Don't animate when:**\n- User performs action habitually (animation becomes excise)\n- Speed is critical (expert workflows)\n- User has indicated reduced motion preference\n- Animation would obscure rather than clarify\n\nSee [references/animation-timing.md](references/animation-timing.md) for timing, curves, and emotional qualities.\n\n### Friction: Eliminate or Leverage?\n\nNot all friction is bad. Distinguish:\n\n**Excise (eliminate):** Work that doesn't serve user's goal\n- Navigating to buried menus\n- Re-entering information the system knows\n- Waiting for unnecessary animations\n- Confirming non-destructive actions\n\n**Productive friction (consider keeping):**\n- Confirmation before irreversible actions\n- Deliberate pacing that prevents rushed errors\n- Moments that build anticipation or mark significance\n- Resistance that indicates \"this matters\"\n\n## Input & Physicality\n\nThe device shapes the interaction. A finger on glass is not a stylus is not a mouse.\n\n### Touch Targets\n| Platform | Minimum | Comfortable |\n|----------|---------|-------------|\n| iOS | 44Ã—44pt | 48pt+ |\n| Android | 48Ã—48dp | 56dp+ |\n| Web (touch) | 44Ã—44px | 48px+ |\n\n### Gesture Vocabulary\n| Gesture | Use | Considerations |\n|---------|-----|----------------|\n| Tap | Primary action | Clear affordance required |\n| Long-press | Secondary/context | Needs discoverability hint |\n| Swipe | Reveal, delete, navigate | Always provide undo; don't hide primary actions |\n| Pinch | Zoom | Maintain focus under fingers |\n\n### Two-Handed Interaction\n\nWhen designing for tablets or considering desktop power users:\n- Non-dominant hand: coarse positioning, context setting\n- Dominant hand: fine manipulation, action\n- Consider: Can both hands be usefully engaged?\n\nSee [references/input-and-physicality.md](references/input-and-physicality.md) for device-specific patterns and haptics.\n\n## Platform Considerations\n\n### Web\n- Focus management in SPAs (trap in modals, restore on close)\n- Respect `prefers-reduced-motion`\n- Design for touch AND mouseâ€”avoid hover-only interactions\n- Keyboard navigation for all interactive elements\n\n### iOS\n- Respect system gestures and scroll physics\n- Support Dynamic Type (test at largest sizes)\n- Haptic feedback for significant moments\n- VoiceOver with proper traits\n\n### Android\n- Material motion principles\n- Predictive back gesture (Android 14+)\n- Edge-to-edge with proper insets\n- TalkBack support\n\n### Desktop\n- Keyboard shortcuts with discoverability\n- Multi-window state management\n- Trackpad gestures where appropriate\n- High information density options for power users\n\n## Anti-Patterns\n\n### Breaking Direct Manipulation\nâŒ Modal dialog with Preview button\nâœ“ Live preview as user adjusts\n\nâŒ Must click Apply to see changes\nâœ“ Changes visible immediately, undo available\n\n### Hidden State\nâŒ Current mode only in status bar\nâœ“ Mode visible at locus of attention\n\nâŒ Unsaved changes with no indicator\nâœ“ Clear dirty state (title, dot, changed button)\n\n### Excise Accumulation\nâŒ Confirmation for every action\nâœ“ Undo support; confirm only destructive/irreversible\n\nâŒ Animation that user must wait through\nâœ“ Animation user can interrupt or that doesn't block\n\n### Cognitive Overload\nâŒ All options visible at once\nâœ“ Progressive disclosure based on task stage\n\nâŒ Error messages that blame user\nâœ“ Clear explanation + recovery path\n\n## Reference Files\n\nLoad these as needed for detailed guidance:\n\n- **[references/goals-and-context.md](references/goals-and-context.md)** â€” User goals, personas, dramatic structure, emotional design\n- **[references/cognitive-foundations.md](references/cognitive-foundations.md)** â€” Mental models, error psychology, measurement approaches\n- **[references/input-and-physicality.md](references/input-and-physicality.md)** â€” Input devices, haptics, two-handed interaction, sketching\n- **[references/component-patterns.md](references/component-patterns.md)** â€” Detailed patterns for forms, modals, menus, etc.\n- **[references/animation-timing.md](references/animation-timing.md)** â€” Timing, easing, springs, emotional qualities\n- **[references/accessibility-patterns.md](references/accessibility-patterns.md)** â€” ARIA, focus management, screen readers\n\n## Theoretical Foundations\n\n- **Direct Manipulation** (Shneiderman): Visibility, reversibility, immediate feedback. See [references/direct-manipulation.md](references/direct-manipulation.md)\n- **Instrumental Interaction** (Beaudouin-Lafon): Tools mediating user-object relationship; degrees of indirection, integration, compatibility. See [references/instrumental-interaction.md](references/instrumental-interaction.md)\n- **Goal-Directed Design** (Cooper): Personas, perpetual intermediates, eliminating excise\n- **Emotional Design** (Norman): Visceral, behavioral, reflective levels\n- **Computers as Theatre** (Laurel): Dramatic structure, meaning, engagement\n",
        "skills/interaction-design/references/accessibility-patterns.md": "# Inclusive Design Patterns\n\nDesigning interactions that work for all usersâ€”not as compliance, but as design philosophy.\n\n## Table of Contents\n- [Inclusive Design Philosophy](#inclusive-design-philosophy)\n- [Perceivability: Making Information Available](#perceivability-making-information-available)\n- [Operability: Supporting All Input Methods](#operability-supporting-all-input-methods)\n- [Understandability: Reducing Cognitive Load](#understandability-reducing-cognitive-load)\n- [Robustness: Working Across Contexts](#robustness-working-across-contexts)\n- [Testing as Design Practice](#testing-as-design-practice)\n\n---\n\n## Inclusive Design Philosophy\n\n### The Mindset Shift\n\n**Accessibility is not:**\n- A checklist to complete at the end\n- A separate \"accessible version\"\n- A minimum compliance bar\n- Extra work for edge cases\n\n**Accessibility is:**\n- Designing for the full range of human ability\n- Understanding that disability is contextual and situational\n- Making interactions robust enough to work across contexts\n- Good design that benefits everyone\n\n### The Spectrum of Ability\n\nDisability is not binaryâ€”it exists on a spectrum, and everyone moves along that spectrum throughout their lives and even throughout a single day.\n\n| Permanent | Temporary | Situational |\n|-----------|-----------|-------------|\n| One arm | Arm in cast | Holding a baby |\n| Blind | Eye infection | Looking at screen in sunlight |\n| Deaf | Ear infection | In a loud environment |\n| Non-verbal | Laryngitis | Heavy accent on phone |\n| Cognitive impairment | Concussion | Sleep-deprived, stressed |\n\n**Design implication:** When you design for someone with permanent blindness, you also help the person checking their phone in bright sunlight. When you design for someone with motor impairment, you also help the person using their device on a bumpy bus.\n\n### The Curb Cut Effect\n\nFeatures designed for accessibility often become preferred by everyone:\n- Curb cuts â†’ wheeled luggage, strollers, delivery carts\n- Closed captions â†’ watching in loud bars, learning languages\n- Voice interfaces â†’ hands-busy contexts\n- Large touch targets â†’ faster interaction for all\n\n**Design principle:** Don't design for \"normal users\" and then adapt for \"special needs.\" Design for the extremes, and the middle benefits.\n\n### Integrating Accessibility into Design\n\nAccessibility should be considered at the same moment as any other design decision:\n\n| Design Decision | Accessibility Dimension |\n|-----------------|------------------------|\n| Choosing a color | Does it have sufficient contrast? |\n| Adding animation | What's the reduced-motion alternative? |\n| Creating a modal | How does it trap and restore focus? |\n| Designing a form | How are errors perceived and announced? |\n| Adding interaction | Is there a keyboard-only path? |\n| Showing feedback | Is it conveyed through multiple channels? |\n\n---\n\n## Perceivability: Making Information Available\n\nUsers perceive information through different channels. Robust design doesn't assume which channel is available.\n\n### Multi-Channel Communication\n\nEvery piece of meaningful information should be available through multiple channels:\n\n| Information | Visual | Auditory | Tactile | Textual |\n|-------------|--------|----------|---------|---------|\n| Error state | Red border, icon | Error sound | Vibration | \"Invalid email\" message |\n| Success | Green check | Confirmation chime | Haptic tap | \"Saved successfully\" |\n| Progress | Progress bar | â€” | Pulsing haptic | \"3 of 5 complete\" |\n| Alert | Modal overlay | Alert sound | Strong vibration | Alert text content |\n\n**Why multiple channels?** Not redundancy for its own sakeâ€”different users need different channels, and even the same user may need different channels in different contexts.\n\n### Text Alternatives\n\nEvery non-text element needs a text equivalentâ€”not as compliance, but because text is the most portable format.\n\n**Images: Describe Function, Not Appearance**\n\n| Context | Poor Alt | Good Alt |\n|---------|----------|----------|\n| Photo of CEO | \"Photo of person\" | \"Sarah Chen, CEO\" |\n| Icon button | \"Arrow icon\" | \"Next slide\" |\n| Chart | \"Bar chart\" | \"Sales grew 40% from Q1 to Q4\" |\n| Decorative | [no alt, not empty] | alt=\"\" (empty, intentionally) |\n\n**The equivalence test:** If you removed the image and only the alt text remained, would the user get equivalent information?\n\n**Icons: The Dual Responsibility**\n\nIcons need both visual clarity and text alternatives:\n\n```html\n<!-- Icon-only button: aria-label provides accessible name -->\n<button aria-label=\"Close\">\n  <svg aria-hidden=\"true\">...</svg>\n</button>\n\n<!-- Icon with visible text: icon is decorative -->\n<button>\n  <svg aria-hidden=\"true\">...</svg>\n  Save\n</button>\n```\n\n### Color Independence\n\nColor is a powerful visual signal, but it cannot be the *only* signal.\n\n**The question to ask:** If this were displayed in grayscale, would users still understand it?\n\n| Information | Color Alone (Fragile) | Color + Redundant Cue (Robust) |\n|-------------|----------------------|-------------------------------|\n| Required field | Red border | Red border + asterisk + \"Required\" |\n| Error state | Red text | Red text + error icon + descriptive message |\n| Link | Different color | Different color + underline |\n| Chart data | Different colors | Different colors + patterns + legend |\n| Status | Green/red | Green/red + text label + icon |\n\n### Contrast as Legibility\n\nContrast ratios aren't arbitrary numbersâ€”they represent the difference at which most humans can reliably distinguish figure from ground.\n\n| Element | Minimum Ratio | Why This Number |\n|---------|---------------|-----------------|\n| Body text | 4.5:1 | Readable at normal viewing distance |\n| Large text (â‰¥18pt) | 3:1 | Size compensates for lower contrast |\n| UI components | 3:1 | Must be distinguishable from background |\n| Focus indicators | 3:1 | Must be visible to direct attention |\n\n**Design implication:** Test in poor conditionsâ€”low screen brightness, ambient light, aging monitors. If it works there, it works everywhere.\n\n### Adapting to User Preferences\n\nModern systems expose user preferences. Respecting them is respecting the user.\n\n**Contrast Preferences**\n```css\n@media (prefers-contrast: more) {\n  /* Increase contrast beyond minimums */\n  --border-color: black;\n  --text-color: black;\n  --bg-color: white;\n}\n```\n\n**Color Scheme Preferences**\n```css\n@media (prefers-color-scheme: dark) {\n  /* Adapt palette while maintaining contrast */\n}\n```\n\n---\n\n## Operability: Supporting All Input Methods\n\nUsers operate interfaces through different input methods. Robust design doesn't assume which method is available.\n\n### Input Method Equality\n\n| User's Method | Why They Use It |\n|---------------|-----------------|\n| Mouse/trackpad | Preference, familiarity |\n| Keyboard only | Motor impairment, efficiency, preference |\n| Touch | Mobile context, preference |\n| Switch device | Severe motor impairment |\n| Eye tracking | Cannot use hands |\n| Voice | Hands-busy, motor impairment |\n\n**Design principle:** Every interaction should be achievable through multiple input methods. The goal is *equivalence*, not identical paths.\n\n### Keyboard as Foundation\n\nKeyboard operability is the foundation because it's the most portable:\n- Screen readers operate via keyboard\n- Switch devices emulate keyboard\n- Voice control often maps to keyboard commands\n- Power users prefer keyboard for speed\n\n**The Tab Flow**\n```\n1. Every interactive element must be reachable via Tab\n2. Focus order must match visual and logical order\n3. Focus must never get \"lost\" or trapped (except in modals)\n4. Focus indicator must be clearly visible\n```\n\n**The Interaction Patterns**\n```\nTab/Shift+Tab    Navigate between components\nEnter/Space      Activate (with subtle differences)\nArrow keys       Navigate within composite components\nEscape           Close, cancel, exit\nHome/End         Jump to extremes\n```\n\n### Focus Management as UX\n\nFocus is the keyboard user's \"cursor.\" Managing it well is managing their experience.\n\n**Focus Visibility**\n\nThe focus indicator is not decorationâ€”it's wayfinding. Make it unmistakable:\n\n```css\n:focus-visible {\n  outline: 2px solid #005fcc;\n  outline-offset: 2px;\n}\n\n/* Enhanced for high-contrast preference */\n@media (prefers-contrast: more) {\n  :focus-visible {\n    outline: 3px solid currentColor;\n    outline-offset: 3px;\n  }\n}\n```\n\n**Focus and Mental Models**\n\nFocus management directly impacts the user's mental model of the interface:\n\n| Scenario | Poor Focus Management | Good Focus Management |\n|----------|----------------------|----------------------|\n| Modal opens | Focus stays on trigger (user lost) | Focus moves to modal (user oriented) |\n| Modal closes | Focus stays in void (user lost) | Focus returns to trigger (continuity) |\n| Content loads | Focus resets to top (disorienting) | Focus stays in place (stability) |\n| Item deleted | Focus lost (confusing) | Focus moves to next item (flow continues) |\n\n**Focus Trapping for Context Isolation**\n\nWhen a modal demands attention, focus trapping creates a clear boundary:\n\n```\n1. On open: store current focus, move to first element in modal\n2. Tab at last element â†’ first element (cycle within)\n3. Shift+Tab at first element â†’ last element (cycle within)\n4. Escape: close modal, restore stored focus\n5. On close: return focus to trigger element\n```\n\nThis is the same \"context isolation\" principle that makes modals useful for sighted usersâ€”they can't accidentally interact with background content. Focus trapping provides the same isolation for keyboard users.\n\n### Roving Tabindex for Composite Components\n\nFor components that behave as a unit (tabs, menus, toolbars), use roving tabindex:\n\n```\nTab into component â†’ lands on one element (tabindex=\"0\")\nArrow keys â†’ move within component, update which has tabindex=\"0\"\nTab out â†’ leaves component as a unit\n```\n\nThis matches the mental model: a tab list is *one thing*, not five separate buttons.\n\n### Touch as Direct Manipulation\n\nTouch provides the most direct interaction but has its own constraints.\n\n**Target Size as Error Prevention**\n\nLarger targets prevent slips. Minimum sizes exist because fingers have physical size:\n\n| Guideline | Size | Context |\n|-----------|------|---------|\n| WCAG AAA | 44Ã—44px | Sufficient for most users |\n| WCAG AA | 24Ã—24px | Minimum acceptable |\n| Apple/Google | 44-48px | Platform recommendations |\n\n**Spacing as Error Prevention**\n\nAdjacent targets need breathing room to prevent mis-taps:\n- Minimum 8px between adjacent targets\n- Consider the most error-prone scenarios: moving vehicle, one-handed use, gloves\n\n**Gesture Alternatives**\n\nGestures are efficient but invisible. Always provide a visible alternative:\n\n| Gesture | Alternative |\n|---------|-------------|\n| Swipe to delete | Visible delete button |\n| Long press for menu | Visible overflow (â‹®) button |\n| Pinch to zoom | Zoom buttons (+/âˆ’) |\n| Pull to refresh | Visible refresh button |\n\n**Pointer Cancellation**\n\nUsers should be able to recover from mistaken touches:\n- Trigger action on up-event, not down-event\n- Allow moving finger off target to cancel\n- This matches how physical buttons work\n\n### Timing and Pacing\n\nNot everyone interacts at the same pace.\n\n**Problems with time limits:**\n- Reading speed varies\n- Motor control affects input speed\n- Cognitive processing varies\n\n**Solutions:**\n- Warn before time expires\n- Allow extending time limits\n- Auto-save progress\n- Don't time out on important tasks\n\n---\n\n## Understandability: Reducing Cognitive Load\n\nAccessibility isn't just about perception and motor controlâ€”it's about cognitive accessibility too.\n\n### Clear Language\n\n| Instead of | Use |\n|------------|-----|\n| \"Invalid input detected\" | \"Please enter a valid email address\" |\n| \"Error 403\" | \"You don't have permission to edit this file\" |\n| \"Form submission failure\" | \"We couldn't submit your form. Please check the highlighted fields.\" |\n\n**The empathy test:** Would this message help someone who's stressed, rushed, or unfamiliar with technical terms?\n\n### Consistent Patterns\n\nConsistency reduces cognitive load by allowing pattern recognition:\n\n- Same action, same location (don't move the save button)\n- Same word, same meaning (don't use \"save\" and \"submit\" interchangeably)\n- Same appearance, same function (don't style different things identically)\n\nThis connects directly to error prevention: inconsistency creates capture errors when users apply a learned pattern that no longer works.\n\n### Error Prevention and Recovery\n\nDesign to prevent errors; when errors occur, design for recovery:\n\n**Prevention:**\n- Disable unavailable options (don't let users make invalid selections)\n- Show constraints before input (password requirements, character limits)\n- Provide format hints (MM/DD/YYYY)\n- Auto-correct where unambiguous (add area code, normalize case)\n\n**Recovery:**\n- Keep focus on the problem (scroll to error, focus error field)\n- Explain what's wrong in plain language\n- Explain how to fix it\n- Don't clear fields on error (preserve user's work)\n\n**Error Message Pattern**\n```html\n<input\n  type=\"email\"\n  id=\"email\"\n  aria-invalid=\"true\"\n  aria-describedby=\"email-error\"\n>\n<span id=\"email-error\" role=\"alert\">\n  Please enter a valid email address (example: name@domain.com)\n</span>\n```\n\nThis connects the error message to the field both visually and programmatically, so screen readers announce it.\n\n### Orientation and Wayfinding\n\nUsers need to know where they are and how to get where they're going.\n\n**Landmarks for Page Structure**\n```html\n<header>...</header>         <!-- Site branding, navigation -->\n<nav>...</nav>               <!-- Primary navigation -->\n<main>...</main>             <!-- Page content -->\n<aside>...</aside>           <!-- Related content -->\n<footer>...</footer>         <!-- Site footer -->\n```\n\nScreen reader users navigate by landmarks the way sighted users scan page layout.\n\n**Breadcrumbs for Location**\n```\nHome > Products > Electronics > Headphones\n```\nCurrent page should not be a linkâ€”it's a \"you are here\" marker.\n\n**Skip Links for Efficiency**\n```html\n<a href=\"#main\" class=\"skip-link\">Skip to main content</a>\n```\nKeyboard users shouldn't have to Tab through navigation on every page.\n\n---\n\n## Robustness: Working Across Contexts\n\nRobust designs work even when technology varies, fails partially, or is used in unexpected ways.\n\n### Semantic HTML as Foundation\n\nSemantic HTML provides built-in accessibility:\n\n| Instead of | Use | Why |\n|------------|-----|-----|\n| `<div onclick=\"...\">` | `<button>` | Keyboard accessible, announced correctly |\n| `<span>Title</span>` | `<h2>Title</h2>` | Creates navigable structure |\n| `<div role=\"navigation\">` | `<nav>` | Semantic element is cleaner |\n| Custom dropdown | `<select>` | Native behavior for free |\n\n**The rule:** Use the most specific semantic element that matches the function. Add ARIA only when semantic HTML isn't available or sufficient.\n\n### ARIA: Last Resort, Not First Choice\n\nARIA adds accessibility information, but:\n1. It doesn't add behaviorâ€”you must implement keyboard handling\n2. It can make things worse if used incorrectly\n3. It's a bridge to semantic HTML, not a replacement\n\n**When ARIA is Necessary**\n\nFor custom components that have no HTML equivalent:\n\n```html\n<!-- Tab list (no native element) -->\n<div role=\"tablist\" aria-label=\"Settings\">\n  <button role=\"tab\" aria-selected=\"true\" aria-controls=\"panel1\">General</button>\n  <button role=\"tab\" aria-selected=\"false\" aria-controls=\"panel2\" tabindex=\"-1\">Privacy</button>\n</div>\n\n<div role=\"tabpanel\" id=\"panel1\" aria-labelledby=\"tab1\">...</div>\n<div role=\"tabpanel\" id=\"panel2\" aria-labelledby=\"tab2\" hidden>...</div>\n```\n\n### Live Regions for Dynamic Content\n\nScreen readers read static content. For dynamic updates, you need live regions:\n\n```html\n<!-- Status updates (non-urgent) -->\n<div role=\"status\" aria-live=\"polite\">5 items in cart</div>\n\n<!-- Alerts (urgent) -->\n<div role=\"alert\" aria-live=\"assertive\">Session expiring in 2 minutes</div>\n```\n\n**Use sparingly:** Every live region announcement interrupts the user. Use `polite` for non-urgent updates; reserve `assertive` for true alerts.\n\n### Animation with Escape Hatches\n\nAnimation can cause vestibular discomfort or seizures. Always provide alternatives:\n\n**Reduced Motion Alternative**\n```css\n@media (prefers-reduced-motion: reduce) {\n  *,\n  *::before,\n  *::after {\n    animation-duration: 0.01ms !important;\n    transition-duration: 0.01ms !important;\n  }\n}\n```\n\n**What's Safe Even with Reduced Motion:**\n- Opacity fades (fast, < 150ms)\n- Color changes\n- Static progress indicators\n- User-initiated animations with pause control\n\n**What Triggers Problems:**\n- Large-scale motion (parallax)\n- Spinning or rotating animations\n- Rapid flashing (> 3 times/second is a seizure risk)\n- Auto-playing motion\n\nConnect this to animation design: the question isn't just \"what timing feels good?\" but also \"what's the reduced-motion alternative?\"\n\n---\n\n## Testing as Design Practice\n\nTesting isn't quality assurance at the endâ€”it's a design tool throughout.\n\n### The Multi-Modal Check\n\nFor every component, verify these paths work:\n\n| Path | How to Test |\n|------|-------------|\n| Mouse/touch | Use normally |\n| Keyboard only | Unplug mouse, use only Tab, Enter, Space, arrows, Escape |\n| Screen reader | Turn on VoiceOver/NVDA, close your eyes |\n| Zoom | Set browser to 200%, then 400% |\n| Reduced motion | Enable prefers-reduced-motion in system settings |\n| High contrast | Enable high contrast mode |\n\n### The Narrative Test\n\nWith a screen reader:\n1. Navigate the page by headings. Do they tell the story of the page?\n2. Navigate by landmarks. Can you jump to main sections?\n3. Tab through forms. Is the purpose of each field clear?\n4. Trigger dynamic content. Is the change announced?\n\n### Automated Testing (Necessary but Insufficient)\n\nAutomated tools catch:\n- Missing alt text\n- Insufficient contrast\n- Missing form labels\n- Invalid ARIA\n\nAutomated tools miss:\n- Whether alt text is meaningful\n- Whether tab order is logical\n- Whether error messages are helpful\n- Whether the experience is good\n\n**Use both:** Automated testing catches ~30% of accessibility issues. Manual testing and real user feedback catch the rest.\n\n### Testing Tools\n\n**Automated**\n- axe DevTools (browser extension)\n- Lighthouse accessibility audit\n- WAVE evaluation tool\n\n**Screen Readers**\n- VoiceOver (macOS/iOS, built-in)\n- NVDA (Windows, free)\n- JAWS (Windows, commercial)\n- TalkBack (Android, built-in)\n\n**Manual Checks**\n- Keyboard-only navigation\n- Browser zoom (200%, 400%)\n- High contrast mode\n- Reduced motion preference\n\n### The Empathy Exercise\n\nRegularly use your interface with constraints:\n- Keyboard only for a full task flow\n- Screen reader for navigation\n- One hand only (mobile)\n- In challenging light conditions\n\nThis builds intuition that checklists cannot provide.\n\n---\n\n## Connecting to Design Principles\n\nInclusive design reinforces, rather than conflicts with, good interaction design:\n\n| Interaction Principle | Inclusive Dimension |\n|----------------------|---------------------|\n| Direct manipulation | Works for any input method? |\n| Visibility of state | Perceivable through multiple channels? |\n| Reversibility | Accessible undo path? |\n| Feedback | Announced, not just displayed? |\n| Error prevention | Works for users of all abilities? |\n| Consistency | Reduces cognitive load for all? |\n| Progressive disclosure | Doesn't hide accessibility? |\n\nWhen you find yourself making trade-offs between \"usability\" and \"accessibility,\" reconsiderâ€”they are usually the same thing.\n",
        "skills/interaction-design/references/animation-timing.md": "# Animation Timing Reference\n\nAnimation as a design tool: when to use it, when to avoid it, what it communicates, and how to implement it.\n\n## Table of Contents\n- [Animation Philosophy](#animation-philosophy)\n- [When to Animate](#when-to-animate)\n- [When NOT to Animate](#when-not-to-animate)\n- [Emotional Qualities](#emotional-qualities)\n- [Duration Guidelines](#duration-guidelines)\n- [Easing Functions](#easing-functions)\n- [Spring Physics](#spring-physics)\n- [Animation Patterns by Component](#animation-patterns-by-component)\n- [Choreography & Sequencing](#choreography--sequencing)\n- [Reduced Motion](#reduced-motion)\n- [Discovering the Right Animation](#discovering-the-right-animation)\n\n---\n\n## Animation Philosophy\n\nAnimation is not decoration. It is communication.\n\nEvery animation should answer: **What purpose does this serve?** If you cannot articulate the purpose, the animation may be exciseâ€”wasted time and attention.\n\n### What Animation Can Communicate\n\n| Purpose | How Animation Helps |\n|---------|---------------------|\n| **Object constancy** | Show that A transformed into B, not that A disappeared and B appeared |\n| **Causality** | This action caused that result |\n| **Spatial relationship** | This came from there, went to here |\n| **State change** | Something is different now |\n| **Feedback** | Your action was received |\n| **Attention direction** | Look here, this is important |\n| **Pacing** | This moment deserves weight |\n| **Personality** | This system is [playful/serious/calm/energetic] |\n\n### Animation as Excise\n\nAnimation becomes excise when:\n- User must wait through it repeatedly\n- It doesn't communicate anything the user needs\n- It delays feedback they're waiting for\n- It prioritizes aesthetics over task completion\n- Expert users can't skip or accelerate it\n\n**The habituation test:** After performing this action 100 times, will the animation still serve a purpose, or will it just be delay?\n\n---\n\n## When to Animate\n\n### Animate for These Purposes\n\n**Maintaining object constancy**\nWhen an object transforms, animation shows continuity. Without it: \"Where did that go? What is this?\"\n- Opening a folder â†’ items emerge from folder\n- Expanding an accordion â†’ content reveals from header\n- Modal opening â†’ grows from trigger button\n\n**Communicating causality**\nAnimation shows cause and effect, reinforcing the user's mental model.\n- Drag an item â†’ it follows the cursor â†’ lands where released\n- Press button â†’ button depresses â†’ action occurs\n- Swipe to delete â†’ item slides away â†’ slot closes\n\n**Reducing change blindness**\nWithout animation, users may miss changes. Animation draws attention.\n- New notification â†’ slides in from edge\n- Content update â†’ brief highlight/pulse\n- Error appears â†’ field shakes or error fades in\n\n**Providing feedback**\nAnimation confirms actions were received, especially before results are visible.\n- Button press â†’ immediate visual response (scale, color)\n- Form submit â†’ button shows loading state\n- Save â†’ brief checkmark or pulse\n\n**Conveying emotional tone**\nAnimation expresses personality and sets expectations.\n- Playful app â†’ bouncy springs, overshoots\n- Professional tool â†’ crisp, minimal transitions\n- Calming experience â†’ slow, gentle easing\n\n### The Quick Test\n\nBefore adding animation, ask:\n1. What does this animation *communicate*?\n2. Will users need this communication on the 100th use?\n3. Is this animation faster than the alternative (instant change)?\n4. Does this animation serve the user's goal or mine?\n\n---\n\n## When NOT to Animate\n\n### Don't Animate These Situations\n\n**Habitual actions**\nExpert users performing routine tasks don't need animationâ€”they've already moved on mentally.\n- Rapid keyboard shortcuts\n- Frequent toggles\n- Repeated actions in a workflow\n\n**When speed is critical**\nAnimation that blocks task completion is excise.\n- Browsing many items quickly\n- Data entry workflows\n- Comparison shopping\n\n**When users indicate reduced motion**\nRespect `prefers-reduced-motion`. Some users experience motion sickness, distraction, or have vestibular disorders.\n\n**When animation would obscure**\nSometimes instant changes are clearer than animated ones.\n- Small text changes\n- Number updates (often clearer to just change)\n- Rapid state cycling\n\n**When it's purely aesthetic**\nIf the animation serves no cognitive or communicative purpose, question whether it's needed.\n\n### Alternatives to Animation\n\n| Instead of... | Consider... |\n|---------------|-------------|\n| Slow fade transitions | Instant change with subtle highlight |\n| Sliding panels | Cut with clear spatial layout |\n| Progress animation | Static progress bar |\n| Loading spinner | Skeleton screen (no animation) |\n| Bouncy micro-interactions | Crisp state changes |\n\n---\n\n## Emotional Qualities\n\nAnimation isn't just timingâ€”it carries emotional meaning.\n\n### Spring Characteristics and Personality\n\n| Spring Type | Personality | Use For |\n|-------------|-------------|---------|\n| **Stiff, fast** | Precise, professional, efficient | Business apps, productivity tools |\n| **Gentle, slow** | Calm, comfortable, trustworthy | Healthcare, finance, meditation |\n| **Bouncy** | Playful, young, energetic | Games, social apps, celebrations |\n| **Snappy** | Responsive, modern, confident | Interactive tools, creative apps |\n\n### Easing and Meaning\n\n| Easing | Emotional Quality |\n|--------|-------------------|\n| **Ease-out (decelerate)** | Welcoming, arriving, settling in |\n| **Ease-in (accelerate)** | Departing, dismissing, decisive exit |\n| **Linear** | Mechanical, neutral, continuous process |\n| **Ease-in-out** | Natural, breathing, cyclical |\n| **Overshoot** | Energetic, playful, attention-grabbing |\n\n### Matching Animation to Context\n\n| Context | Appropriate Animation |\n|---------|----------------------|\n| Error recovery | Fast, minimal (don't delay) |\n| Celebration | Bouncy, extended (mark the moment) |\n| Navigation | Quick, directional (maintain orientation) |\n| Loading | Calm, rhythmic (patience) |\n| Confirmation | Brief, satisfying (closure) |\n| Danger/warning | Sharp, attention-grabbing (urgency) |\n\n---\n\n## Duration Guidelines\n\n### By Interaction Scale\n\n| Scale | Duration | Use Cases | User Perception |\n|-------|----------|-----------|-----------------|\n| Micro | 50-150ms | Button press, toggle | Instant feedback |\n| Small | 150-250ms | Tooltip, dropdown | Brief, responsive |\n| Medium | 250-400ms | Modal, sidebar | Noticeable, smooth |\n| Large | 400-600ms | Page transition | Deliberate, weighty |\n\n### The Cognitive Thresholds\n\n- **< 100ms**: Perceived as instant. No easing needed.\n- **100-300ms**: Motion is perceptible but feels responsive.\n- **300-500ms**: Animation is noticed as animation.\n- **> 500ms**: Animation demands attention, feels slow unless serving a purpose.\n\n### Entry vs Exit\n\nExit animations should be faster than entry:\n- **Entry**: 250-350ms â€” Welcoming, gives time to perceive\n- **Exit**: 150-250ms â€” Decisive, gets out of the way\n\n**Why?** Users trigger exits intentionally; they're ready to move on. Entries surprise users; they need time to orient.\n\n### By Distance\n\n| Distance | Duration | Rationale |\n|----------|----------|-----------|\n| < 100px | 150-200ms | Close movements should be quick |\n| 100-300px | 200-350ms | Medium travel, medium time |\n| 300-500px | 300-450ms | Longer journeys need time |\n| > 500px | 400-600ms | Very long movements need tracking time |\n\n---\n\n## Easing Functions\n\n### CSS Cubic Bezier Reference\n\n```\nease:        cubic-bezier(0.25, 0.1, 0.25, 1.0)\nease-in:     cubic-bezier(0.42, 0, 1.0, 1.0)\nease-out:    cubic-bezier(0, 0, 0.58, 1.0)\nease-in-out: cubic-bezier(0.42, 0, 0.58, 1.0)\nlinear:      cubic-bezier(0, 0, 1, 1)\n```\n\n### Recommended Curves\n\n**Standard (ease-out)** â€” Default for most UI animations\n```\ncubic-bezier(0.2, 0, 0, 1)\n```\n\n**Decelerate** â€” Elements entering from offscreen\n```\ncubic-bezier(0, 0, 0.2, 1)\n```\n\n**Accelerate** â€” Elements leaving the screen\n```\ncubic-bezier(0.4, 0, 1, 1)\n```\n\n**Sharp** â€” Size/shape changes\n```\ncubic-bezier(0.4, 0, 0.6, 1)\n```\n\n**Overshoot** â€” Playful bounce (use sparingly)\n```\ncubic-bezier(0.34, 1.56, 0.64, 1)\n```\n\n### Choosing Easing\n\n| Scenario | Easing | Rationale |\n|----------|--------|-----------|\n| Element appearing | ease-out | Arrives with energy, settles smoothly |\n| Element disappearing | ease-in | Accelerates away decisively |\n| Element responding to user | ease-out | Immediate response, smooth result |\n| Looping animation | ease-in-out | Natural, breathing rhythm |\n| Background/passive | linear | Doesn't draw attention |\n| Celebratory moment | overshoot | Playful, attention-grabbing |\n\n---\n\n## Spring Physics\n\nSprings feel natural because they model physical behavior. Use springs when direct manipulation feeling is important.\n\n### Spring Parameters\n\n| Parameter | Effect | Range |\n|-----------|--------|-------|\n| **Stiffness** (tension) | How snappy/rigid | 100-500 |\n| **Damping** (friction) | How quickly it settles | 10-40 |\n| **Mass** | Weight/inertia | 0.5-2 |\n\n### Common Presets\n\n**Gentle** â€” Smooth, flowing\n```\nstiffness: 120, damping: 14\n```\nUse for: Large panels, page transitions, calming interfaces\n\n**Snappy** â€” Responsive, modern\n```\nstiffness: 300, damping: 20\n```\nUse for: Buttons, toggles, interactive elements\n\n**Bouncy** â€” Playful, energetic\n```\nstiffness: 200, damping: 10\n```\nUse for: Celebrations, gamified elements, youthful brands\n\n**Stiff** â€” Precise, minimal oscillation\n```\nstiffness: 400, damping: 30\n```\nUse for: Professional tools, precise controls\n\n### Library Syntax\n\n**Framer Motion (React)**\n```jsx\ntransition={{ type: \"spring\", stiffness: 300, damping: 20 }}\n```\n\n**React Spring**\n```jsx\nconfig: { tension: 300, friction: 20 }\n```\n\n**SwiftUI**\n```swift\n.animation(.spring(response: 0.5, dampingFraction: 0.7))\n```\n\n---\n\n## Animation Patterns by Component\n\n### Buttons\n\n| State | Animation | Duration/Spring |\n|-------|-----------|-----------------|\n| Hover | Background/shadow change | 150ms ease-out |\n| Press | Scale to 0.95-0.98 | 50-100ms ease-out |\n| Release | Return to normal | 150ms ease-out |\n| Loading | Spinner (if needed) | Continuous |\n\n### Modals\n\n**Open**\n- Backdrop: opacity 0â†’1, 200ms ease-out\n- Modal: scale 0.95â†’1, opacity 0â†’1, 250ms ease-out\n\n**Close**\n- Modal: opacity 1â†’0, 150ms ease-in\n- Backdrop: opacity 1â†’0, 200ms ease-in\n\n### Dropdowns/Menus\n\n**Open**\n- opacity 0â†’1, translateY(-8px)â†’0, 150-200ms ease-out\n\n**Close**\n- opacity 1â†’0, 100-150ms ease-in\n\n### Toasts/Notifications\n\n**Enter**\n- Slide from edge + fade, 250ms ease-out\n\n**Exit**\n- Fade + slide out, 150ms ease-in\n\n### Cards/List Items\n\n**Hover lift**\n- translateY(0â†’-4px), shadow increase, 200ms ease-out\n\n**Selection**\n- Background/border change, 150ms ease-out\n\n---\n\n## Choreography & Sequencing\n\n### Stagger Pattern\n\nDelay each element progressively for a wave effect.\n\n```\nBase delay: 30-50ms per item\nMax total delay: 300-500ms (cap for long lists)\n```\n\n**Example (5 items, 40ms stagger):**\n- Item 1: 0ms\n- Item 2: 40ms\n- Item 3: 80ms\n- Item 4: 120ms\n- Item 5: 160ms\n\n### Orchestration Principles\n\n1. **Container before content**: Shell appears, then fills\n2. **Important elements last**: CTAs appear after supporting content\n3. **Group related elements**: Animate together or with minimal stagger\n4. **Maintain rhythm**: Consistent intervals feel intentional\n\n---\n\n## Reduced Motion\n\n### Detection\n\n**CSS**\n```css\n@media (prefers-reduced-motion: reduce) {\n  *, *::before, *::after {\n    animation-duration: 0.01ms !important;\n    transition-duration: 0.01ms !important;\n  }\n}\n```\n\n**JavaScript**\n```js\nconst prefersReducedMotion = window.matchMedia(\n  '(prefers-reduced-motion: reduce)'\n).matches;\n```\n\n### Graceful Alternatives\n\n| Full Motion | Reduced Motion Alternative |\n|-------------|---------------------------|\n| Slide in | Instant appear or quick fade |\n| Bounce | Direct position, no overshoot |\n| Parallax | Static positioning |\n| Auto-play video | Paused with play button |\n| Complex choreography | Simple fade |\n\n### What to Keep\n\nEven with reduced motion:\n- Fast opacity changes (< 150ms)\n- Color/state changes\n- Focus indicators (instant)\n- Static progress indicators\n\n---\n\n## Discovering the Right Animation\n\n### Don't Start with Specifications\n\nAnimation timing should emerge from exploration, not be dictated upfront.\n\n**Sketch first:**\n1. Draw key frames on paper\n2. Act out the motion with your hands\n3. Video prototype with rough timing\n4. Adjust based on feel\n\n### Finding the Right Duration\n\n1. Start with a rough guess\n2. Make it 2x faster â€” does it feel abrupt?\n3. Make it 2x slower â€” does it feel sluggish?\n4. Narrow in on the sweet spot\n5. Test with users; watch for impatience or confusion\n\n### Finding the Right Easing\n\n1. Start with ease-out (almost always works)\n2. Try ease-in-out â€” does it feel more natural?\n3. Try spring â€” does it feel more physical?\n4. Match to emotional context\n\n### Questions for Review\n\n- Is this animation communicating something essential?\n- Would a user performing this 100 times want this animation?\n- Does it respect users who prefer reduced motion?\n- Does the timing feel responsive, not sluggish?\n- Does the easing match the emotional context?\n",
        "skills/interaction-design/references/cognitive-foundations.md": "# Cognitive Foundations\n\nMental models, error psychology, attention, and measurement approaches for interaction design.\n\n## Table of Contents\n- [Mental Models and Conceptual Design](#mental-models-and-conceptual-design)\n- [The Seven Stages of Action](#the-seven-stages-of-action)\n- [Error Psychology](#error-psychology)\n- [Attention and Cognitive Load](#attention-and-cognitive-load)\n- [Measurement Approaches](#measurement-approaches)\n- [The Syntactic/Semantic Model](#the-syntacticsemantic-model)\n\n---\n\n## Mental Models and Conceptual Design\n\n### The Three Models\n\n**Designer's model:** How the designer thinks the system works. Complete, technically accurate, often complex.\n\n**System image:** What the user perceivesâ€”the interface, documentation, feedback, behavior. The only access users have to the designer's model.\n\n**User's model:** How the user thinks the system works. Built from experience with the system image plus prior knowledge.\n\n```\nDesigner's Model  â†’  System Image  â†’  User's Model\n     (truth)          (artifact)       (belief)\n```\n\n**The gap problem:** Users form their mental model from the system image, not the designer's model. If the system image is unclear, incomplete, or misleading, users form incorrect mental modelsâ€”and blame themselves when things go wrong.\n\n### Designing the System Image\n\nThe system image must communicate:\n\n1. **What can I do?** (Affordances via signifiers)\n2. **What is the current state?** (Visible status)\n3. **What just happened?** (Feedback)\n4. **What will happen if I do X?** (Predictability via consistency)\n5. **How do I undo/recover?** (Reversibility)\n\n**Red flags in your design:**\n- Users ask \"Did that work?\"\n- Users develop superstitions (\"I always click twice\")\n- Users are surprised by outcomes\n- Users describe the system incorrectly but functionally\n\n### Affordances and Signifiers\n\n**Affordance:** A relationship between object and agentâ€”what actions are possible. A button affords pressing. A handle affords pulling.\n\n**Signifier:** A perceptible signal indicating where action is possible and how to perform it. The raised appearance of a button signifies \"press me.\" The position of a handle signifies \"grasp here.\"\n\n**Design principle:** Affordances may exist without signifiers (a flat region that responds to touch), and signifiers may exist without affordances (a decorative button that doesn't do anything). Good design ensures signifiers accurately indicate real affordances.\n\n| Element | Signifier Type | What It Communicates |\n|---------|----------------|----------------------|\n| Raised button | Visual depth | \"I can be pressed\" |\n| Underlined text | Convention | \"I'm a link\" |\n| Grab handle (â‹®â‹®) | Icon metaphor | \"Drag me\" |\n| Cursor change | System feedback | \"This is interactive\" |\n| Text placeholder | Position | \"Type here\" |\n\n---\n\n## The Seven Stages of Action\n\nEvery interaction involves seven psychological stages:\n\n### The Execution Side (Planning â†’ Doing)\n\n1. **Goal:** Form the goal (What do I want to accomplish?)\n2. **Plan:** Form the intention (What action will achieve my goal?)\n3. **Specify:** Specify the action sequence (What exact steps?)\n4. **Perform:** Execute the action (Do it)\n\n### The Evaluation Side (Perceiving â†’ Understanding)\n\n5. **Perceive:** Perceive the state of the world (What happened?)\n6. **Interpret:** Interpret the perception (What does this mean?)\n7. **Compare:** Compare outcome to goal (Did I succeed?)\n\n### Design Implications\n\n**Gulf of Execution:** Distance between user's goal and available actions\n- Reduce by: Clear affordances, visible actions, minimal steps\n\n**Gulf of Evaluation:** Distance between system state and user's understanding\n- Reduce by: Visible feedback, clear status, interpretable responses\n\n| Stage | Gulf | Design Question |\n|-------|------|-----------------|\n| Goal | â€” | Is the user's goal achievable here? |\n| Plan | Execution | Can user figure out what to do? |\n| Specify | Execution | Can user determine exact actions? |\n| Perform | Execution | Can user physically execute? |\n| Perceive | Evaluation | Is feedback visible/audible? |\n| Interpret | Evaluation | Is feedback understandable? |\n| Compare | Evaluation | Can user tell if goal is achieved? |\n\n---\n\n## Error Psychology\n\n### Two Types of Errors\n\n**Slips:** User intended correctly, but executed incorrectly\n- Cause: Attention failure, motor error, habit intrusion\n- Example: Clicking the wrong button in a familiar position\n\n**Mistakes:** User formed an incorrect goal or plan\n- Cause: Incomplete knowledge, incorrect mental model\n- Example: Using \"Save As\" when trying to rename a file\n\n### Types of Slips\n\n| Slip Type | Cause | Design Prevention |\n|-----------|-------|-------------------|\n| **Capture** | Habit overrides intention | Don't put dangerous actions where safe ones usually are |\n| **Description** | Similar objects confused | Make different things look different |\n| **Data-driven** | External trigger overrides intention | Remove misleading environmental cues |\n| **Associative** | Memory triggers wrong response | Consistent mapping across the interface |\n| **Loss-of-activation** | Forgot intention mid-action | Show progress, maintain context |\n| **Mode** | Forgot current mode | Make modes visible, minimize modes |\n\n### Types of Mistakes\n\n| Mistake Type | Cause | Design Prevention |\n|--------------|-------|-------------------|\n| **Rule-based** | Applied wrong rule | Clear feedback on rule application |\n| **Knowledge-based** | Incomplete mental model | Improve system image, provide guidance |\n| **Memory-lapse** | Forgot goal or step | Visible state, breadcrumbs, history |\n\n### Forcing Functions\n\nConstraints that make errors impossible or immediately visible:\n\n**Interlocks:** Prevent operation until prerequisites met\n- Example: Can't start car without brake pedal pressed\n- Example: Can't submit form until required fields filled\n\n**Lockins:** Prevent stopping mid-operation when dangerous\n- Example: Warning before closing unsaved document\n- Example: Requiring confirmation before abandoning wizard\n\n**Lockouts:** Prevent entering dangerous states\n- Example: Graying out unavailable options\n- Example: Rate limiting on destructive actions\n\n### Error Messages That Help\n\n**Bad error message:**\n```\nError 403: Access Denied\n```\n\n**Good error message:**\n```\nYou don't have permission to edit this file.\n\nThis file belongs to Sarah Chen. You can:\nâ€¢ Request edit access from Sarah\nâ€¢ Make a copy you can edit\nâ€¢ View in read-only mode\n```\n\n**Error message checklist:**\n- [ ] What happened (briefly)\n- [ ] Why it happened (if knowable and useful)\n- [ ] What user can do to recover\n- [ ] Tone: helpful, not blaming\n\n---\n\n## Attention and Cognitive Load\n\n### The Locus of Attention\n\nUsers can only focus on one thing at a time. Everything else is peripheral.\n\n**Design implications:**\n- Feedback must appear at or near the locus of attention\n- Controls for an object should be near that object (spatial offset)\n- Mode indicators far from work area will be missed\n- Notifications compete for attentionâ€”use judiciously\n\n### Working Memory Limits\n\nUsers can hold roughly 4Â±1 chunks in working memory.\n\n**Design implications:**\n- Don't require remembering information across screens\n- Visible state beats remembered state\n- Group related items into chunks\n- Recognition beats recall\n\n### Cognitive Load Types\n\n**Intrinsic load:** Inherent complexity of the task\n- Can't reduce without simplifying the task itself\n- Can distribute across time (progressive disclosure)\n\n**Extraneous load:** Load imposed by poor design\n- Reduce: clearer language, visible state, consistent patterns\n- This is the load interaction design can eliminate\n\n**Germane load:** Load from learning and schema formation\n- Support: clear conceptual model, meaningful feedback\n- This is productive loadâ€”don't eliminate it\n\n### Attention Design Principles\n\n| Principle | Application |\n|-----------|-------------|\n| Proximity | Related controls near related content |\n| Change blindness | Animate changes to draw attention |\n| Inattentional blindness | Don't rely on noticing unexpected elements |\n| Cognitive tunneling | Stressed users miss peripheral information |\n| Habituation | Familiar patterns need less attention |\n\n---\n\n## Measurement Approaches\n\n### When to Measure\n\nMeasurement is valuable but not always necessary. Consider:\n\n- **High-frequency interactions:** Worth optimizing (measure)\n- **Infrequent interactions:** Discoverability matters more than speed\n- **Critical interactions:** Error rate more important than speed\n- **Playful interactions:** Enjoyment may trade off against efficiency\n\n### GOMS (Goals, Operators, Methods, Selection)\n\nPredictive model for expert performance time.\n\n**Components:**\n- **Goals:** What user wants to accomplish\n- **Operators:** Elementary actions (keystroke, mouse move, mental operation)\n- **Methods:** Sequences of operators to accomplish goals\n- **Selection rules:** How users choose between methods\n\n**Use when:**\n- Comparing alternative designs for same task\n- Estimating expert performance time\n- Identifying bottlenecks in workflows\n\n**Limitation:** Assumes error-free expert performance. Doesn't model learning, errors, or satisfaction.\n\n### Keystroke-Level Model (KLM)\n\nSimplified GOMS for quick estimates.\n\n| Operator | Symbol | Time |\n|----------|--------|------|\n| Keystroke | K | 0.2s |\n| Point with mouse | P | 1.1s |\n| Home hands | H | 0.4s |\n| Mental preparation | M | 1.35s |\n| System response | R | varies |\n| Button press | B | 0.1s |\n\n**Example:** Click a button, type 5 characters, click OK\n```\nP + B + M + 5K + P + B = 1.1 + 0.1 + 1.35 + 1.0 + 1.1 + 0.1 = 4.75s\n```\n\n### Fitts's Law\n\nTime to acquire a target is a function of distance and size.\n\n```\nMovement Time = a + b Ã— logâ‚‚(2D/W)\n```\n\nWhere D = distance to target, W = width of target.\n\n**Design implications:**\n- Make frequent targets larger\n- Put frequent targets closer (or at screen edges where distance is \"infinite\" but acquisition is easy)\n- For touch, increase target size for error reduction\n\n### Hick's Law\n\nTime to decide increases with number of choices.\n\n```\nDecision Time = a + b Ã— logâ‚‚(n)\n```\n\nWhere n = number of choices.\n\n**Design implications:**\n- Reduce choices through progressive disclosure\n- Group choices into categories\n- Provide defaults and recommendations\n\n### What to Actually Measure\n\n| Metric | What It Shows | When to Use |\n|--------|---------------|-------------|\n| Task completion rate | Can users succeed? | Critical workflows |\n| Time on task | Efficiency | Frequent tasks |\n| Error rate | Quality of outcome | Error-prone areas |\n| Learnability | Time to first success | New features |\n| Satisfaction (SUS, etc.) | Subjective experience | Overall assessment |\n| Attention shifts | Cognitive load | Complex interfaces |\n\n---\n\n## The Syntactic/Semantic Model\n\n### Why Direct Manipulation Works\n\nShneiderman's key insight explains why direct manipulation feels natural:\n\n**Semantic knowledge:** Understanding of the problem domain\n- What files are, what editing means, what a document is\n- Stable, transferable across systems\n- Learned through explanation and analogy\n\n**Syntactic knowledge:** Arbitrary details of command syntax\n- Specific keystrokes, menu locations, command names\n- Volatile, system-specific\n- Learned through memorization and practice\n\n**Direct manipulation works because it operates at the semantic level.** Users think \"move this file there\" and directly enact that intention. They don't translate the intention into syntactic commands like `mv /source/file.txt /dest/`.\n\n### Cognitive Cost of Syntax\n\nWith command languages:\n```\nGoal â†’ Semantic decomposition â†’ Syntactic specification â†’ Execution\n```\n\nWith direct manipulation:\n```\nGoal â†’ Direct enactment â†’ Execution\n```\n\nThe syntactic specification step is eliminated, reducing cognitive load and error opportunity.\n\n### Design Implications\n\n| Approach | Cognitive Load | Error Rate | Expert Speed |\n|----------|----------------|------------|--------------|\n| Direct manipulation | Low | Low | Moderate |\n| Command language | High (initially) | Higher | Fast (if memorized) |\n| Hybrid (WIMP + shortcuts) | Medium | Medium | Adaptive |\n\n**Best practice:** Default to direct manipulation; provide command/keyboard paths for power users who will invest in learning syntax for speed gains.\n\n### When Syntax Wins\n\nDirect manipulation isn't always superior:\n\n- **Batch operations:** \"Rename all .txt to .md\" is easier to type than to drag\n- **Precise specification:** \"Move 100px right\" is easier to type than to judge\n- **Repetition:** Recorded macros beat repeated direct actions\n- **Remote/deferred operations:** Scripting can run without supervision\n\n**Design principle:** Support both semantic directness AND syntactic power for different user archetypes and tasks.\n",
        "skills/interaction-design/references/component-patterns.md": "# Component Interaction Patterns\n\nDetailed interaction patterns for common UI components, with attention to user goals, meaning, and error prevention.\n\n## Table of Contents\n- [Pattern Philosophy](#pattern-philosophy)\n- [Forms & Inputs](#forms--inputs)\n- [Modals & Dialogs](#modals--dialogs)\n- [Dropdowns & Menus](#dropdowns--menus)\n- [Drag & Drop](#drag--drop)\n- [Lists & Tables](#lists--tables)\n- [Navigation](#navigation)\n- [Search](#search)\n- [Notifications & Toasts](#notifications--toasts)\n- [Tooltips & Popovers](#tooltips--popovers)\n- [Sliders & Range Inputs](#sliders--range-inputs)\n- [Date & Time Pickers](#date--time-pickers)\n\n---\n\n## Pattern Philosophy\n\nBefore implementing any pattern, ask:\n1. **What is the user's goal?** Not \"use this component\" but \"accomplish this task\"\n2. **Is this component necessary?** Could we eliminate it entirely?\n3. **What errors might occur?** How do we prevent or recover from them?\n4. **What should the user feel?** Confidence? Delight? Relief?\n\nComponents are means, not ends. The best component is often no component at all.\n\n---\n\n## Forms & Inputs\n\n### User Goal Context\n\nUsers filling forms rarely want to \"fill a form.\" They want to:\n- Complete a purchase\n- Submit an application\n- Update their settings\n- Send a message\n\nEvery field is friction. Eliminate fields that don't directly serve the goal.\n\n### Text Inputs\n\n**States & Meaning**\n| State | Appearance | Emotional Tone |\n|-------|------------|----------------|\n| Empty | Placeholder, subtle border | Ready, inviting |\n| Focused | Ring/outline, cursor | Engaged, active |\n| Filled | Value visible | Progressing |\n| Error | Red indicator, message below | Recoverable, guided |\n| Disabled | Reduced opacity | Unavailable (explain why) |\n| Valid | Green check (optional) | Confidence, progress |\n\n**Error Prevention**\n- Use input constraints (type=\"email\", maxlength)\n- Auto-format as user types (phone numbers, credit cards)\n- Show format hints before errors occur\n- Validate on blur, re-validate on change after error\n- Never clear user input on error\n\n**Label Patterns**\n- Always use visible labels (not placeholder-only)\n- Float label: compact, modern feel\n- Static label: clearest, most accessible\n- Associate labels with inputs (`for`/`id`) for screen readers\n\n**Keyboard**\n- Tab: next field\n- Shift+Tab: previous field\n- Enter: submit (single-line) or next field\n- Escape: blur, optionally revert\n\n### Textareas\n\n- Auto-grow height as content grows (with max-height)\n- Character count for limited fields (shows remaining, not error at limit)\n- Resize handle if appropriate\n\n### Checkboxes & Radio Buttons\n\n**Goal context:** Selection is a micro-commitment. Make the commitment clear.\n\n**Checkbox States**\n- Unchecked â†’ Checked â†’ (Indeterminate for mixed children)\n- Click anywhere on label to toggle\n- Focus ring on control, not label\n\n**Radio Groups**\n- Arrow keys navigate between options\n- Only one radio receives Tab focus\n- Selection can follow focus (faster) or require explicit activation (safer for consequential choices)\n\n### Form Layout\n\n**Single Column** (default)\n- Labels above inputs for easy scanning\n- Group related fields with spacing or dividers\n- Primary action left-aligned (right in RTL)\n\n**Progressive Disclosure**\n- Show only required fields initially\n- Reveal optional/advanced fields on demand\n- Don't overwhelm; respect the user's attention\n\n**Error Summary**\n- On submit failure, summarize errors at top\n- Link each error to its field\n- Focus the summary or first error\n\n---\n\n## Modals & Dialogs\n\n### When to Use Modals\n\n**Use modals when:**\n- User must make a decision before continuing\n- Action is destructive and needs confirmation\n- Context isolation reduces errors (complex wizards)\n- System requires exclusive attention (authentication)\n\n**Avoid modals when:**\n- User needs to reference content behind the modal\n- Trial-and-error adjustment is needed (use inline/inspector)\n- Action can easily be undone (use undo, not confirmation)\n- You're using a modal because it's \"easy\" to implement\n\n### Modal Types & User Goals\n\n| Type | User Goal | Design Priorities |\n|------|-----------|-------------------|\n| Alert | Understand a situation | Clear message, single action |\n| Confirm | Make a consequential decision | Clear stakes, distinct options |\n| Prompt | Provide a single piece of info | Fast completion, clear purpose |\n| Form | Complete a multi-step task | Progress visibility, save state |\n| Drawer | Access details/settings | Easy dismiss, no obstruction |\n\n### Opening\n\n- Animate from trigger element (connection) or center (focus)\n- Duration: 200-300ms ease-out\n- Focus first interactive element or close button\n- Prevent background scroll\n\n### Focus Management (Critical)\n\n```\n1. Store previous focus location\n2. Move focus into modal (first focusable element)\n3. Trap focus within modal (Tab cycles through)\n4. On close, restore focus to trigger element\n```\n\n### Closing\n\n- Close button (X) always visible\n- Escape key closes (unless destructive action in progress)\n- Backdrop click closes (configurableâ€”disable for critical confirmations)\n- Warn on unsaved changes: \"You have unsaved changes. Discard?\"\n\n### Error Handling in Modals\n\n- If form submission fails, keep modal open\n- Show errors inline within the modal\n- Don't close on errorâ€”user loses context\n\n### Stacking Modals\n\n**Avoid when possible.** Stacking modals indicates a flow design problem.\n\nIf truly necessary:\n- Each modal gets its own backdrop layer\n- Escape closes topmost only\n- Focus trapped in topmost\n- Consider: should this be a multi-step wizard instead?\n\n---\n\n## Dropdowns & Menus\n\n### User Goal Context\n\nDropdowns present choices. The goal is to make the right choice quickly and confidently.\n\n### Activation\n\n- Click to open (not hoverâ€”accessibility requirement)\n- Enter/Space opens when trigger focused\n- Arrow Down opens and selects first item\n\n### Keyboard Navigation\n\n| Key | Action |\n|-----|--------|\n| â†“ | Next item |\n| â†‘ | Previous item |\n| Home | First item |\n| End | Last item |\n| Enter/Space | Select current item |\n| Escape | Close, return focus to trigger |\n| Type character | Jump to item starting with that character |\n\n### Positioning\n\n- Default: below trigger\n- Flip if insufficient space\n- Maintain 8px from viewport edges\n\n### Menu Item Design\n\n| State | Appearance | Notes |\n|-------|------------|-------|\n| Default | Normal text | â€” |\n| Hover/Focus | Background highlight | â€” |\n| Selected | Checkmark | For current value |\n| Disabled | Reduced opacity | Skip in keyboard nav |\n| Destructive | Red text | delete, remove |\n\n### Error Prevention\n\n- Disable unavailable options (don't hide themâ€”explain why)\n- For long lists, add search/filter\n- Group related items with headers\n- Show selected value in trigger (never unclear state)\n\n### Nested Menus\n\n- Open on hover with 200ms delay\n- Arrow Right opens submenu\n- Arrow Left closes submenu\n- Safe triangle for diagonal mouse movement\n\n---\n\n## Drag & Drop\n\n### User Goal Context\n\nDrag and drop enables direct manipulationâ€”physically moving objects. The goal is natural, intuitive rearrangement.\n\n### Signifiers (Affordances Made Visible)\n\n- Drag handle: grip icon (â‹®â‹®) or entire item\n- Cursor: `grab` on hover, `grabbing` during drag\n- Lift effect on drag start (shadow + slight scale)\n\n### During Drag\n\n**Visual Feedback**\n- Ghost/preview following cursor (semi-transparent)\n- Placeholder in original position\n- Valid drop zones highlighted\n- Invalid zones dimmed or unchanged\n- Insertion indicator (line) shows where item will land\n\n**Auto-Scroll**\n- Scroll container when dragging near edges\n- Accelerate near very edge\n\n### Drop Feedback\n\n- Animate item into new position (200-300ms)\n- Remove ghost immediately\n- Brief highlight on dropped item (confirmation)\n\n### Keyboard Alternative (Required)\n\n- Space: select item for move\n- Arrow keys: navigate through positions\n- Space/Enter: drop at current position\n- Escape: cancel move, return to original\n\n### Multi-Item Drag\n\n- Badge showing count (\"3 items\")\n- Visual stack of selected items\n- All items move as unit\n\n### Error Recovery\n\n- Undo for accidental drops\n- Escape cancels during drag\n- Clear visual state if drop fails\n\n---\n\n## Lists & Tables\n\n### User Goal Context\n\nLists and tables help users find, compare, and act on items. Goals include:\n- Find a specific item\n- Compare items to make a choice\n- Perform actions on one or multiple items\n- Understand patterns across data\n\n### Selection\n\n**Single Select**\n- Click to select\n- Arrow keys move selection\n- Enter activates selected item\n\n**Multi-Select**\n- Click toggles individual selection\n- Shift+Click for range\n- Cmd/Ctrl+Click for non-contiguous\n- Checkbox column for explicit multi-select\n\n### Sorting\n\n- Click column header to sort\n- Click again to reverse\n- Visual indicator (arrow) shows sort state\n- Remember sort preference (if appropriate)\n\n### Filtering\n\n- Filter controls above list\n- Instant filtering (debounce 150-300ms)\n- Show count: \"23 of 156 items\"\n- Clear all filters button when active\n- Preserve filters across sessions (if appropriate)\n\n### Empty States (Dramatic Moments)\n\n| State | Narrative | Design |\n|-------|-----------|--------|\n| Initial empty | \"Your story hasn't begun\" | Invitation, clear CTA to add first item |\n| No results (filter) | \"Nothing matches\" | Suggestion to adjust filters, link to clear |\n| Error | \"Something went wrong\" | Empathy, retry button, explain if possible |\n| Cleared/Complete | \"All done!\" | Celebration if appropriate, next steps |\n\n### Row Actions\n\n- Hover actions: appear on row hover\n- Context menu: right-click or overflow (â‹®)\n- Swipe actions: mobile (always provide undo)\n- Inline edit: click cell to edit\n\n### Infinite Scroll / Virtualization\n\n- Load more 2-3 screens before bottom\n- Show loading indicator during fetch\n- Maintain scroll position on data updates\n- Virtualize for performance (render only visible)\n\n---\n\n## Navigation\n\n### User Goal Context\n\nNavigation helps users understand where they are and how to get where they want to go. The goal is orientation and confidence.\n\n### Tab Navigation\n\n- Tabs as `role=\"tablist\"` with `role=\"tab\"` children\n- Arrow keys move between tabs\n- Tab/Shift+Tab exits tablist\n- Active tab: `aria-selected=\"true\"`, clear visual indicator\n\n### Breadcrumbs\n\n**What they communicate:** \"You are here, and here's how you got here.\"\n\n- Current page: text only (not a link)\n- Separator between items (/ or >)\n- Truncate middle items with \"...\" for long paths\n- Click any ancestor to navigate up\n\n### Pagination\n\n- Show current page and total\n- Previous/Next buttons (disabled at bounds)\n- Direct page input for large page counts\n- Consider: is pagination better than infinite scroll for this use case?\n\n### Sidebar Navigation\n\n- Collapsible: icon-only or full labels\n- Nested items: expand/collapse with disclosure\n- Current item: strong visual indicator\n- Keyboard: Arrow keys navigate, Enter activates\n\n---\n\n## Search\n\n### User Goal Context\n\nSearch users have a target in mind. Help them find it quickly, or learn it doesn't exist.\n\n### Search Input\n\n- Magnifying glass icon (left, signifies purpose)\n- Clear button (right, appears when filled)\n- Escape clears and closes results\n- Placeholder suggests what can be searched\n\n### Instant Search\n\n- Debounce input (150-300ms)\n- Show loading state in results area\n- Minimum characters (2-3) before searching\n- Highlight matching text in results\n\n### Search Results\n\n- Show count: \"12 results for 'widget'\"\n- Group by type if mixed content\n- No results: helpful suggestions, check spelling\n- Recent searches when input empty\n\n### Command Palette\n\n- Open: Cmd/Ctrl+K\n- Fuzzy matching on command names\n- Recent commands at top\n- Category headers\n- Keyboard-first: arrows + Enter\n\n---\n\n## Notifications & Toasts\n\n### User Goal Context\n\nNotifications inform users of events they didn't directly trigger. The goal is awareness without disruption.\n\n### When to Notify\n\n**Notify for:**\n- Completion of background tasks\n- Important state changes\n- Errors requiring attention\n- Time-sensitive information\n\n**Don't notify for:**\n- Every action the user just performed (use inline feedback)\n- Low-importance information\n- Marketing messages (unless explicitly opted in)\n\n### Positioning\n\n- Top-right or bottom-right (most common)\n- Top-center for critical alerts\n- Stack vertically with 8-12px gap\n- New notifications push others\n\n### Auto-Dismiss Timing\n\n| Type | Duration | Auto-dismiss? | Rationale |\n|------|----------|---------------|-----------|\n| Success | 3-5s | Yes | Confirmation, low urgency |\n| Info | 5-7s | Yes | Awareness, low urgency |\n| Warning | 7-10s | Optional | May need action |\n| Error | Persistent | No | Requires attention |\n\n### Interaction\n\n- Hover pauses auto-dismiss\n- Close button always visible\n- Action button: \"Undo\", \"View\", \"Retry\"\n- Swipe to dismiss (mobile)\n\n### Animation\n\n- Enter: slide + fade (200-300ms)\n- Exit: fade + slide (150-200ms)\n- Stack reflow: animate position changes\n\n---\n\n## Tooltips & Popovers\n\n### Tooltips\n\n**Purpose:** Provide helpful context for ambiguous elements.\n\n**When to use:**\n- Icon-only buttons needing labels\n- Truncated text needing full display\n- Form fields needing clarification\n\n**When NOT to use:**\n- Critical information (use visible labels)\n- Mobile-primary interfaces (hover-triggered)\n- Lengthy content (use popovers)\n\n**Behavior:**\n- Show on hover after 300-500ms delay\n- Hide immediately on mouse leave\n- Show on focus for keyboard users\n- Position: above by default, flip if clipped\n- Content: text only, 1-2 lines max\n\n### Popovers\n\n**Purpose:** Provide interactive content in context.\n\n- Trigger: click (not hover)\n- Can contain interactive elements\n- Dismiss: click outside, Escape, explicit close\n- Arrow pointing to trigger\n- Focus trap if contains form elements\n\n---\n\n## Sliders & Range Inputs\n\n### User Goal Context\n\nSliders let users explore a value space. The goal is finding the right value through direct manipulation.\n\n### When Sliders Excel\n\n- Imprecise values where \"about right\" suffices\n- Exploring a range to see effects\n- Values that benefit from relative positioning\n\n### When Text Input is Better\n\n- Precise values needed (type \"24px\" vs. drag to 24)\n- Very large ranges\n- Values with specific meaningful numbers\n\n### Single Value Slider\n\n- Thumb: 20-24px minimum (44px for touch)\n- Track: filled portion shows progress to value\n- Value label: above thumb or in tooltip during drag\n- Tick marks for discrete/meaningful values\n\n### Range Slider\n\n- Two thumbs, independently draggable\n- Thumbs cannot cross\n- Filled track between thumbs\n\n### Keyboard (Required)\n\n- â† / â†’: decrease/increase by step\n- Page Up/Down: larger jumps\n- Home/End: min/max values\n\n### Accessibility\n\n- `role=\"slider\"` with `aria-valuemin`, `aria-valuemax`, `aria-valuenow`\n- `aria-valuetext` for human-readable: \"50%\" or \"$500\"\n- Announce value changes\n\n---\n\n## Date & Time Pickers\n\n### User Goal Context\n\nUsers selecting dates are usually scheduling something or filtering by time. The goal is choosing the right date quickly and confidently.\n\n### Date Picker\n\n**Input States**\n- Text input with format hint (MM/DD/YYYY or locale-appropriate)\n- Calendar icon triggers picker\n- Support manual typing for power users\n\n**Calendar View**\n- Month/year header with navigation\n- Day grid with weekday headers\n- Today: highlighted (subtle)\n- Selected: filled/prominent\n- Disabled: dimmed (past dates, unavailable slots)\n\n**Keyboard**\n- Arrow keys navigate days\n- Page Up/Down: months\n- Home/End: first/last of month\n- Enter: select and close\n\n### Date Range Picker\n\n- Two inputs or single with separator\n- Visual range highlight in calendar\n- Click start, then end\n- Presets: \"Last 7 days\", \"This month\"\n\n### Time Picker\n\n- Input with format hint\n- Dropdown with intervals (15-30 min)\n- Allow manual entry for precise times\n\n### Error Prevention\n\n- Disable unavailable dates (don't let users select then show error)\n- Clear format hints\n- Accept multiple input formats, normalize display\n- Show timezone clearly when relevant\n",
        "skills/interaction-design/references/direct-manipulation.md": "Direct Manipulation: A Step Beyond Programming Languages\n\nBen Shneiderman, University of Maryland\n\nDirect manipulation systems offer the satisfying experience of operating on visible objects. The computer becomes transparent, and users can concentrate on their tasks.\n\nLeibniz sought to make the form of a symbol reflect its content. â€œIn signs,â€ he wrote, â€œone sees an advantage for discovery that is greatest when they express the exact nature of a thing briefly and, as it were, picture it; then, indeed, the labor of thought is wonderfully diminished.â€\nâ€” Frederick Kreiling, â€œLeibniz,â€ Scientific American, May 1968\n\nCertain interactive systems generate glowing enthusiasm among usersâ€”in marked contrast with the more common reaction of grudging acceptance or outright hostility. The enthusiastic usersâ€™ reports are filled with positive feelings regarding:\n\n- Mastery of the system: A sense of control and fluency in operation.\n\n- Competence in the task: Effective performance on their goals.\n\n- Ease of learning: Accessibility for initial use and for advanced features.\n\n- Retention over time: Confidence in sustained mastery.\n\n- Enjoyment in use: Pleasure derived from interaction.\n\n- Social pride: Eagerness to demonstrate to novices.\n\n- Exploratory desire: Motivation to discover more powerful aspects.\n\nThese feelings are not universal, but they convey the image of the truly pleased user. From interviews and system examinations, a model of the features producing such delight emerges: visibility of the object of interest; rapid, reversible, incremental actions; and replacement of complex command language syntax by direct manipulation of the object of interestâ€”hence â€œdirect manipulation.â€\n\nExamples of Direct Manipulation Systems\n\nNo single system has all the attributes or design features that merit admiration, but those below have enough to win enthusiastic support.\n\nDisplay Editors\n\nâ€œOnce youâ€™ve used a display editor, youâ€™ll never want to go back to a line editor. Youâ€™ll be spoiled.â€ Full-page display editors attract strong advocacy versus line-oriented editors; similar sentiments appear among users of stand-alone word processors (e.g., Wang) and display editors such as EMACS on the MIT/Honeywell Multics system or â€œviâ€ on Unix. A beaming advocate called EMACS â€œthe one true editor.â€\n\nRoberts found overall performance time of display editors to be about half that of line-oriented editors; display editors also reduce training time. Office automation evaluations consistently favor full-page display editors for secretarial and executive use.\n\nAdvantages include:\n\n- Full display context: 24 to 66 lines visible, enabling contextual reading and scanning. One-line-at-a-time is like viewing through a narrow cardboard tube.\n\n- WYSIWYG form: Eliminates formatting command clutter; tables, lists, page breaks, headings, centered text, and figures appear as printed; formatting errors become immediately apparent.\n\n- Visible cursor: A clear focus of attention via arrow/underscore/blinking box.\n\n- Intuitive motion: Arrow keys or mouse/joystick/graphics tablet map natural physical actions; contrast with cryptic commands like UP 6.\n\n- Labeled buttons: INSERT, DELETE, CENTER, UNDERLINE, SUPERSCRIPT, BOLD, LOCATE act as persistent menu reminders, obviate memorization; gateway buttons expose advanced features via on-screen menus.\n\n- Immediate feedback: Operations (move, center, delete, insert) display instantly; line editors require extra display/print commands.\n\n- Speed: High display rates (e.g., 120 cps/1200 baud, full page in a second at 9600 baud) and short response times yield a thrilling sense of power; reduces command burden and learning time. Line editors at ~30 cps with multi-second latency seem sluggish.\n\n- Easy reversibility: Backspace/overstrike corrections; congruent inverse operations ease learning (Carroll). UNDO cancels prior command sequences, lowers anxiety about mistakes or file destruction.\n\nCompetition in display editors accelerates evolutionary refinements. The excerpt below illustrates contemporary IBM display editor capabilities.// EDIT --- SPFDEMO.MYLIB.PLI(COINS) - 01.04 ------------------- COLUMNS 001 072\n\n// COMMAND INPUT => SCROLL ===> HALF\n\n// \\*X\\***\\* ********\\*\\*\\***********~**\\*\\*** TOP OF DATA \\*\n\n// 000100 COINS:\n\n// 000200 PROCEDURE OPTIONS (MAIN);\n\n// 000300 DECLARE\n\n// 000400 COUNT FIXED BINARY (31) AUTOMATIC INIT (1),\n\n// 000500 HALVES FIXED BINARY (31),\n\n// 000600 QUARTERS FIXED BINARY (31),\n\n// 000700 DIMES FIXED BINARY (31),\n\n// 000800 NICKELS FIXED BINARY (31),\n\n// 000900 SYSPRINT FILE STREAM OUTPUT PRINT;\n\n// 001000 DO HALVES = 100 TO 0 BY -50;\n\n// 001100 DO QUARTERS = (100 - HALVES) TO 0 BY -25;\n\n// 001200 DO DIMES = ((100 - HALVES - QUARTERS)/10)\\*10 TO 0 BY -10;\n\n// 001300 NICKELS = 100 - HALVES - QUARTERS - DIMES;\n\n// 001400 PUT FILE(SYSPRINT) DATA(COUNT,HALVES,QUARTERS,DIMES,NICKELS);\n\n// 001500 COUNT = COUNT + 1;\n\n// 001600 END;\n\n// 001700 END;\n\n// 001800 END;\n\n// 001900 END COINS;\n\n// **\\*\\*** BOTTOM OF DATA **\\*\\*** **\\*\\*\\*\\*** \\*\n\n// EDIT --- SPFDEMO.MYLIB.PLI(COINS) - 01.04 ------------------- COLUMNS 001 072\n\n// COMMAND INPUT = SCROLL = HALF\n\n// **\\*** ********\\********* ****\\*\\***** TOP OF DATA **\\*** ******\\*\\*******\n\n// 000100 COINS:\n\n// 000200 PROCEDURE OPTIONS (MAIN);\n\n// 000300 DECLARE\n\n// 000400 COUNT FIXED BINARY (31) AUTOMATIC INIT (1),\n\n// 000500 HALVES FIXED BINARY (31),\n\n// 000600 QUARTERS FIXED BINARY (31),\n\n// 000700 DIMES FIXED BINARY (31),\n\n// 000800 NICKELS FIXED BINARY (31),\n\n// 000900 SYSPRINT FILE STREAM OUTPUT PRINT;\n\n// 001000 DO HALVES = 100 TO 0 BY -50;\n\n// 001100 DO QUARTERS = (100 - HALVES) TO 0 BY -25;\n\n// 001200 DO DIMES = ((100 - HALVES - QUARTERS)/10)\\*10 TO 0 BY -10;\n\n// 001300 NICKELS = 100 - HALVES - QUARTERS - DIMES;\n\n// 001500 COUNT = COUNT + 1;\n\n// 001600 END;\n\n// 001700 END;\n\n// 001800 END;\n\n// 001900 END COINS;\n\n// **\\*\\*** ************\\*\\*\\************* BOTTOM OF DATA **\\* **\\***** **\\***\n\nVisicalc\n\nVisicorpâ€™s innovative financial forecasting program, Visicalc, emerged from a Harvard MBA studentâ€™s frustration with course calculations. An â€œinstantly calculating electronic worksheetâ€ over 254 rows Ã— 63 columns, it discards procedural control structures. Positional declarations can define that column 4 equals the sum of columns 1â€“3; changes propagate automatically.\n\nComplex dependencies (manufacturing costs, distribution, revenue, commissions, profits) across districts and months become immediately visible. Novices comprehend it because it simulates an accountantâ€™s worksheet; display of 20 rows and up to nine columns (with multiple windows) supports scanning and exploration. The command language for setup can be tricky for novices/infrequent users, but most users need only basic commands. Distributors note â€œIt jumpsâ€: the visible propagation of changes explains its appeal.\n\nVisicalc screenshots (home budget example, cursor in C2, windowed row sums) present formulas and immediate dependencies.\n\nSpatial Data Management\n\nPrototype spatial data management systems, attributed to Nicholas Negroponte, present zoomable, navigable â€œinformation spaces.â€ A user zooms from a world map to Pacific convoys, to silhouettes, to structural details, to full-color captain pictures. Icons can represent corporate dimensionsâ€”personnel, organization, travel, production, schedulesâ€”where joystick zooms traverse floors, rooms, details. Errors carry minimal cost: back out and try another path.\n\nSuccess depends on designer skill in choosing icons, graphical representations, and layouts that are natural and easily understood. Even anxious users enjoy zooming/gliding with a joystick and rapidly demand more power and data.\n\nVideo Games\n\nVideo games exemplify direct manipulation at scale. Early Pong required rotating a knob to move a white rectangle to hit a ricocheting white ball. Novices become competent after watching for 30 seconds; mastery requires hours. Later titles (Missile Command, Donkey Kong, Pac-Man, Tempest, Tron, Centipede, Space Invaders) layered sophisticated rules, color graphics, and sound.\n\nCentipede uses a trackball and one button; Defender has five buttons plus joystickâ€”novices often abandon due to complexity. Designers seek controls that are easy to use and hard to destroy.\n\nGame fields of action are abstractions of reality; learning by analogy is straightforward. Auto-demo loops convey rules; watching a knowledgeable player accelerates understanding. There remains ample complexity to entice experts. Commands are physical (presses, motions, rotations); results appear immediately. There is no syntaxâ€”and no syntax errors. Inverse operations are natural (move left too far â†’ move right). Continuous scoring supports progress tracking and competition; high scorers store initials for displayâ€”positive reinforcement encouraging mastery.\n\nMaloneâ€™s studies with schoolchildren, and Shneidermanâ€™s own, show continuous display of scores is valuable. Machine value judgments (â€œVery goodâ€, â€œYouâ€™re doing greatâ€) are inferior; users prefer self-judgment, and may perceive generic praise as annoying/deceptive.\n\nAnalogies between games and applications are productive (Carroll and Thomas), but differ: game users seek entertainment and mastery challenge; application users focus on tasks and may resent forced learning. Random events challenge gamers; predictable system behavior is preferable in non-game designs. Gamers compete with systems; application users prefer strong internal locus of control.\n\nCAD/CAM and Process Control\n\nComputer-aided design systems (automobile, electronics, architecture, aircraft, newspaper layout) apply direct manipulation. Operators see schematics, using lightpens/cursors to move components; systems compute currents, voltages, fabrication costs, and consistency warnings. Layout artists and designers iterate rapidly, recording promising alternatives.\n\nProcess control systems (e.g., Honeywell) provide colored plant schematics across multiple displays; red lines indicate out-of-range sensors. Single numbered buttons drill into components; further presses traverse to sensors or reset valves/circuitsâ€”no commands to memorize in rare emergencies. The schematic enables problem-solving by analogy; screen representations map closely to real-world pressures/temperatures.\n\nFamiliar Direct Manipulation\n\nDriving is a canonical example: visible scene through the windshield, actions (steering/braking) are cultural skills; turning left by rotating the wheel left gives immediate feedback via changing scene. Contrast: issuing LEFT 30 DEGREES and then a position checkâ€”akin to many office automation tools.\n\nIndustrial robot programming by demonstration is direct manipulation: the operator guides the robotâ€™s hand through tasks (spray painting, welding) while the computer records; then repeats automatically.\n\nQuery-by-Example (QBE) derives much success from direct representation of relations on screen; users move a cursor through relational columns and enter examples for desired results. Minimal keywords supplement the style, though complex Booleans/maths still require syntax knowledge. Novices learn basics quickly; ample power remains for experts. Direct cursor manipulation across relational skeletons is straightforward; linking variables via examples is intuitively clear to tabular-data literate users. Zloof extended QBE to Office-by-Example, integrating database search, word processing, electronic mail, business graphics, and menu creation.\n\nAdvanced office automation designs apply direct manipulation: Xerox Star (sophisticated text formatting, graphics, multiple fonts, high-resolution cursor-based UI), icon drag-and-drop (document icon into printer icon), Apple Lisa (many principles elegantly applied). IBMâ€™s Pictureworld proposed future office systems with graphic icons for file cabinets, mailboxes, notebooks, phone messages; distribution/filing via icon menu selection. Yedwab et al. described a generalized â€œautomated desk.â€\n\nComputer-assisted instruction (CDC Plato) employed direct manipulation: tracing inherited characteristics by breeding drosophila, performing medical procedures in emergencies, finger-drawn/moved shapes, chemistry lab projects, and games.\n\nExplanations of Direct Manipulation\n\nâ€œWhat you see is what you getâ€ (Don Hatfield, IBM) describes the general approach; Harold Thimbleby extends: â€œWhat you see is what you have gotâ€â€”displays should reflect complete status, errors, and appropriate actions. Ted Nelsonâ€™s â€œvirtualityâ€ highlights manipulable representations of reality. Rutkowskiâ€™s â€œtransparencyâ€ posits the tool disappears while intellect applies directly to the task. MacDonaldâ€™s â€œvisual programmingâ€ proposes accelerating system construction and enabling end-user-generated or modified applications.\n\nProblem-Solving and Learning Research\n\nPsychology literature underscores the primacy of representation in solving and learning. Polya advocates pictures for mathematical problems; Montessori used physical objects (beads/wooden sticks) to convey arithmetic and comparisons; Bruner extended physical representations to polynomial factoring and other principles. Carroll, Thomas, and Malhotra found spatial representations yielded faster, more successful problem solving than isomorphic temporal ones.\n\nPhysical/spatial/visual representations are easier to retain and manipulate. Wertheimer showed that subjects given structural explanations (e.g., cutting and relocating a triangle for parallelogram area) retained and transferred knowledge better than those memorizing formulas (A = h Ã— b). Spatial representations facilitate theorem discovery more than axiomatic formulations. Algebra students are often encouraged to draw representations for word problems.\n\nPapertâ€™s Logo creates a mathematical microworld rendering geometric principles visible: an electronic turtle draws lines per user programs. This environment provides rapid feedback, easy diagnosis and repair of errors, and creative satisfaction.\n\nProblems with Direct Manipulation\n\nGraphic representations can aid professional programming tasks (flowcharts, record structures, schema diagrams), but learning the rules of representation takes effort. Graphics help when multiple relationships exist among objects and when representations are more compact than detailed objects; selectively screening detail to present useful abstractions can facilitate performance.\n\nHowever, spatial/graphic representations do not automatically improve performance. In experiments, subjects given detailed flowcharts did no better at comprehension, debugging, or modification than those given only code. In program comprehension, control-flow or data-structure graphics did not outperform textual descriptions; however, data-structure documentation consistently outperformed control-flow documentationâ€”content selection is critical. Wrong or cluttered information increases confusion.\n\nSecond, users must learn icon semantics; designer-meaningful icons can require as much or more learning than words. Airports serving multilingual communities use icons extensively, but meanings can be opaque; international terminals with icons may be unclear.\n\nThird, graphics can mislead; users rapidly grasp analogies but infer incorrect permissible operations. Designers must be cautious in representation and operation choices; ample user testing is required to refine representations and minimize side effects.\n\nFourth, graphics can consume excessive display space. Experienced users may prefer compact tabular textual displays (e.g., 50 filenames) over 10 abbreviated icon labels. Icons should be evaluated for static informational density and relational display power, then for dynamic utility in selection/movement/deletion.\n\nChoosing suitable representations and operations is nontrivial. Simple metaphors/analogies/models with minimal concept sets are preferable. Mixing metaphors adds complexity and confusion; emotional tone should be inviting rather than distasteful/inappropriate (e.g., sewage disposal metaphors are inappropriate for electronic messaging). Since users may not share designer metaphors, ample testing is essential.\n\nThe Syntactic/Semantic Model\n\nUser attraction to direct manipulation correlates with a cognitive model distinguishing syntactic from semantic knowledge.\n\n- Syntactic knowledge: Arbitrary details of command syntax (delimiters, precise sequences for insertions/deletions, keystrokes like delete/CONTROLâ€‘H/ESCAPE). Acquired by rote, volatile unless rehearsed; system-dependent, with limited overlap.\n\n- Semantic knowledge: Hierarchical concepts/functionality from low-level operations (cursor movement, insertion/deletion, changes, copy, centering, indentation) to mid-level procedures (correct a misspelling: display, position, change/overstrike) to high-level tasks (move a sentence across paragraphs via marking, copying to buffers, cleanup, paste, check, clear buffer). Expert users decompose problem-domain tasks top-down into lower-level program-domain operations. Semantic knowledge is system-independent; text-editing functions are widely available though syntax varies. Acquired through explanation/analogy/example; anchors to familiar concepts and is stable.\n\nCommand formulation proceeds from perceived high-level task, to decomposition into low-level semantic operations, to conversion into commands. At the syntax level, users must recall spacing rules, function key availability, abbreviations.\n\nFrequent use of multiple editors makes clear the commonality of problem-solving thought and diversity of syntactic forms. Syntactic clashes are especially annoying (special character placement differences; multiple backspace approachesâ€”key/cursor-control/mouse; differing meanings of â€œKâ€ for keeping vs. killing a file).\n\nImplications:\n\n- Novices tightly bind syntax to semantics; command names cue semantic recall; novices evaluate commands for applicability to tasks; they struggle to move a sentence even if they understand commands. Editors with â€œCHANGE old/newâ€ require instruction to repurpose for delete/insert operations.\n\n- Manuals should be organized from problem-domain viewpoints, with section titles describing user operations; then present command details; finally syntax. Alphabetized command-centric manuals impede novice anchoring to familiar concepts.\n\n- Direct manipulation displays the object of interest and acts in the problem domain, minimizing decomposition into multiple syntactic commands. Each command produces immediate, comprehensible problem-domain action; proximity to problem domain lowers problem-solving load and stress.\n\nActions and visual skills precede language in human development. Spatial relationships and actions are grasped more quickly via visual representations than linguistic ones. Suitable visual representations promote intuition and discovery in formal systems.\n\nPiagetâ€™s stages: sensorimotor (birthâ€“~2), preoperational (2â€“7), concrete operational (7â€“11), formal operations (~11+). Physical actions on objects are comprehensible during concrete operations; children acquire conservation/invariance. Symbol manipulation for representing actions arises at formal operations. Mathematics and programming are abstract, difficult for children; effort is needed to link symbols to objects. Direct manipulation attempts to ground activity at the concrete or even preoperational stage, easing tasks for children and adults.\n\nDirect manipulation suits cases with small object sets and simple commands; it can also scale, as display editors show. Limits will be determined by designer imagination and skill. With more examples and experience, researchers can test competing metaphors/analogies; familiar visual analogies may aid early learning, while abstract models may better support regular use.\n\nThe syntactic/semantic model is a simple cognitive model requiring refinement; empirical tests and careful measurements across systems will validate improvements. Cognitive models of user behavior and mental models/system images are expanding research areas in computer science and psychology.\n\nPotential Applications of Direct Manipulation\n\nThe central design challenge is finding appropriate representations/models of reality. Visual language can first feel unnatural, then indispensable.\n\n- Personal address list (Rolodex-like): Display cards; joystick forward rotates through cards faster as pushed farther; reverse to go backward; in-place edits via cursor and typing; delete by blanking fields; blank cards at top auto-place alphabetically when filled; find by typing into a field and entering â€œ?â€.\n\n- Checkbook maintenance: Display a register with labeled columns; joystick scans earlier entries; in-place changes; new entries at first blank line; checkmark for reconciliation; searches by filling a payee field and â€œ?â€.\n\n- Bibliographic search: Wall of labeled catalog index drawers; cursor shaped as hand selects â€œAuthor Indexâ€ â†’ â€œFâ€“Lâ€ drawer; open reveals finer tabs; select produces cards; copying a card moves to userâ€™s on-screen notebook; edits produce printed bibliographies; combine entries for set operations; distribute via electronic mail; multiple alternate approaches require careful design/testing.\n\n- Job control language: Continuous file directory display with computer component representations; create files by typing names into free directory spots; delete by blanking; copy by dragging names to tape/printer icons; hierarchical directories via ZOOM to reveal deeper tree levels; UNZOOM to back out. Dirtree on Perq builds directories left-to-right via puck selections; lower-level details appear; items are selected by moving a cursor; current item shown in inverse video.\n\n- Airline reservations: Map to select departing/arriving cities; calendar for date; clock for time; plane seating plan with diagonal lines for reserved seats to select a seat.\n\n- Warehouse inventory: Visual aisles with boxes on shelves; combine videodisc and computer graphics for medical supply inventory displays.\n\n- Polynomial education: Bend curves; watch coefficient changes; see roots (x-axis intersections) and derivative reaction.\n\nDirect manipulation attracts users because it is comprehensible, natural, rapid, and enjoyable. With simple actions, ensured reversibility, and easy retention, anxiety recedes and satisfaction flows.\n\nInterest in interactive system design is growing across research communities and commercial products. Researchers apply controlled psychological experimentation to deepen understanding and generate practical guidelines; commercial designers increasingly use pilot studies and acceptance tests.\n\nInteractive systems that display the object of interest and permit rapid, incremental, reversible operations via physical actions rather than syntax attract enthusiastic users. Immediate visibility of operation results and layered/spiral learning approaches contribute to attraction. Each feature requires research to refine contributions and limitations; meanwhile, astute designers can explore direct manipulation approaches.\n\nThe future is promising: tasks once accessible only via tedious command/programming languages may soon be handled through lively, enjoyable interactive systems that reduce learning time, speed performance, and increase satisfaction.\n\nAcknowledgments\n\nPartial support from Control Data Corporation (grant 80M15) and computer resources from the University of Maryland Computer Science Center are gratefully acknowledged. The author thanks Gordon Braudaway, Jim Foley, John Gannon, Roger Knights, John Lovgren, Harlan Mills, Phyllis Reisner, Sherry Weinberg, and Mark Weiser for constructive comments on drafts; Gio Wiederhold, Stephen Yau, and reviewers provided useful guidance shaping the final article.\n\nReferences\n\n1. Teresa L. Roberts, â€œEvaluation of Computer Text Editors,â€ PhD dissertation, Stanford University, 1980. University Microfilms, Ann Arbor, Michigan, order number AAD 80â€‘11699.\n\n2. John M. Carroll, â€œLearning, Using and Designing Command Paradigms,â€ Human Learning, Vol. 1, No. 1, 1982, pp. 31â€“62.\n\n3. Christopher F. Herot, â€œSpatial Management of Data,â€ ACM Trans. Database Systems, Vol. 5, No. 4, Dec. 1980, pp. 493â€“513.\n\n4. Thomas W. Malone, â€œWhat Makes Computer Games Fun?â€ Byte, Vol. 6, No. 12, Dec. 1981, pp. 258â€“277.\n\n5. John M. Carroll and John C. Thomas, â€œMetaphor and the Cognitive Representation of Computing Systems,â€ IEEE Trans. Systems, Man, and Cybernetics, Vol. SMCâ€‘12, No. 2, Mar./Apr. 1982, pp. 107â€“116.\n\n6. Moshe M. Zloof, â€œQueryâ€‘byâ€‘Example,â€ AFIPS Conf. Proc., Vol. 44, 1975 NCC, AFIPS Press, Montvale, N.J., 1975.\n\n7. Moshe M. Zloof, â€œOfficeâ€‘byâ€‘Example: A Business Language that Unifies Data and Word Processing and Electronic Mail,â€ IBM Sys. J., Vol. 21, No. 3, 1982, pp. 272â€“304.\n\n8. Cranfield Smith et al., â€œDesigning the Star User Interface,â€ Byte, Vol. 7, No. 4, Apr. 1982, pp. 242â€“282.\n\n9. Laura Yedwab, Christopher F. Herot, and Ronni L. Rosenberg, â€œThe Automated Desk,â€ Sigsmall Newsletter, Vol. 7, No. 2, Oct. 1981, pp. 102â€“108.\n\n10. Ted Nelson, â€œInteractive Systems and the Design of Virtuality,â€ Creative Computing, Vol. 6, No. 11, Nov. 1980, pp. 56 ff.; and Vol. 6, No. 12, Dec. 1980, pp. 94 ff.\n\n11. Chris Rutkowski, â€œAn Introduction to the Human Applications Standard Computer Interface, Part 1: Theory and Principles,â€ Byte, Vol. 7, No. 11, Oct. 1982, pp. 291â€“310.\n\n12. Alan MacDonald, â€œVisual Programming,â€ Datamation, Vol. 28, No. 11, Oct. 1982, pp. 132â€“140.\n\n13. George Polya, How to Solve It, Doubleday, New York, 1957.\n\n14. Maria Montessori, The Montessori Method, Schocken, New York, 1964.\n\n15. James Bruner, Toward a Theory of Instruction, Harvard University Press, Cambridge, Mass., 1966.\n\n16. John M. Carroll, J. C. Thomas, and A. Malhotra, â€œPresentation and Representation in Design Problemâ€‘Solving,â€ British J. Psych., Vol. 71, 1980, pp. 143â€“153.\n\n17. Rudolf Arnheim, Visual Thinking, University of California Press, Berkeley, Calif., 1972.\n\n18. Robert H. McKim, Experiences in Visual Thinking, Brooks/Cole Publishing Co., Monterey, Calif., 1972.\n\n19. Max Wertheimer, Productive Thinking, Harper and Row, New York, 1959.\n\n20. Seymour Papert, Mindstorms: Children, Computers, and Powerful Ideas, Basic Books, Inc., New York, 1980.\n\n21. Ben Shneiderman, R. Mayer, D. McKay, and P. Heller, â€œExperimental Investigations of the Utility of Detailed Flowcharts in Programming,â€ Comm. ACM, Vol. 20, No. 6, June 1977, pp. 373â€“381.\n\n22. Ben Shneiderman, â€œControl Flow and Data Structure Documentation: Two Experiments,â€ Comm. ACM, Vol. 25, No. 1, Jan. 1982, pp. 55â€“63.\n\n23. Michael L. Schneider, â€œModels for the Design of Static Software User Assistance,â€ in Directions in Humanâ€‘Computer Interaction, Albert Badre and Ben Shneiderman, eds., Ablex Publishing Co., Norwood, N.J., 1982.\n\n24. Ben Shneiderman and Richard Mayer, â€œSyntactic/Semantic Interactions in Programmer Behavior: A Model and Experimental Results,â€ Intâ€™l J. Computer and Information Sciences, Vol. 8, No. 3, 1979, pp. 219â€“239.\n\n25. Ben Shneiderman, Software Psychology: Human Factors in Computer and Information Systems, Little, Brown and Co., Boston, Mass., 1980.\n\n26. Ben Shneiderman, â€œA Note on Human Factors Issues of Natural Language Interaction with Database Systems,â€ Information Systems, Vol. 6, No. 2, Feb. 1981, pp. 125â€“129.\n\n27. D. P. Ausubel, Educational Psychology: A Cognitive Approach, Holt, Rinehart and Winston, New York\n",
        "skills/interaction-design/references/goals-and-context.md": "# Goals, Context, and Meaning\n\nUser goals, personas, dramatic structure, and emotional design in interaction.\n\n## Table of Contents\n- [Goal-Directed Design](#goal-directed-design)\n- [User Archetypes](#user-archetypes)\n- [Dramatic Structure](#dramatic-structure)\n- [Emotional Design](#emotional-design)\n- [Designing for Transformation](#designing-for-transformation)\n\n---\n\n## Goal-Directed Design\n\n### The Fundamental Shift\n\nTraditional interaction design asks: \"How should this button behave?\"\nGoal-directed design asks: \"What is the user trying to accomplish, and should there be a button at all?\"\n\n### Identifying User Goals\n\n**Life goals:** Fundamental motivations (feel competent, be respected, have fun)\n**Experience goals:** How users want to feel (confident, in control, not stupid)\n**End goals:** What users want to accomplish (send the message, find the file, complete the purchase)\n\nDesign primarily for end goals, but never violate experience goals. Life goals inform tone and positioning.\n\n### The Goal Hierarchy\n\n```\nLife goal: Feel competent and respected\n    â†“\nExperience goal: Feel confident, not confused\n    â†“\nEnd goal: Submit expense report\n    â†“\nTasks: Photograph receipt, enter amount, select category, submit\n    â†“\nActions: Tap camera, position phone, tap shutter...\n```\n\nMost interaction design focuses on actions and tasks. But tasks are negotiableâ€”the goal is not. If users could submit expenses without photographing receipts, they would. Every task is potential excise.\n\n### Excise Analysis\n\n**Excise:** Work the user must do that doesn't directly accomplish their goal.\n\n| Type | Example | Remedy |\n|------|---------|--------|\n| Navigation excise | Digging through menus | Surface frequent actions, command palette |\n| Data entry excise | Re-typing known information | Auto-fill, smart defaults |\n| Cognitive excise | Remembering across screens | Persistent context, visible state |\n| Confirmation excise | Approving obvious actions | Undo instead of confirm |\n| Waiting excise | Watching progress bars | Optimistic UI, background processing |\n\n**For every interaction, ask:** Does this step directly serve the user's end goal, or is it serving the system's needs?\n\n---\n\n## User Archetypes\n\n### The Perpetual Intermediate\n\nMost users are neither novices nor experts. They are **perpetual intermediates** who:\n\n- Learned enough to accomplish their tasks\n- Will not invest time learning advanced features\n- Use a small, stable subset of functionality\n- Forget features they use rarely\n- Develop personal workarounds\n\n**Design implications:**\n- The common path must be fast and obvious\n- Advanced features should be discoverable but not intrusive\n- Don't assume users will learn keyboard shortcuts\n- Don't assume users read documentation\n- Recognize that \"intuitive\" means \"matches existing mental models\"\n\n### Archetype Spectrum\n\n| Archetype | Characteristics | Design Priority |\n|-----------|-----------------|-----------------|\n| **First-timer** | No mental model, cautious, needs orientation | Progressive disclosure, clear signifiers, forgiveness |\n| **Casual user** | Infrequent use, forgets between sessions | Recognition over recall, sensible defaults, clear labels |\n| **Perpetual intermediate** | Stable workflow, won't learn more | Fast common path, don't require learning |\n| **Power user** | Optimizes workflow, learns shortcuts | Keyboard efficiency, customization, density options |\n| **Expert** | Pushes system limits, knows internals | Extensibility, scripting, raw access |\n\n**Key insight:** Design for the perpetual intermediate as the default, with graceful paths to novice (simpler) and expert (more powerful) experiences.\n\n### Creating Lightweight Personas\n\nFor interaction design, full personas aren't always necessary. Instead, consider:\n\n**The archetype question:** Is this user a first-timer, casual, intermediate, power user, or expert?\n\n**The context question:** Where are they? What device? How much time? What's their emotional state?\n\n**The goal question:** What end goal brought them here? What experience goal must we not violate?\n\n---\n\n## Dramatic Structure\n\n### Interaction as Drama\n\nEvery interaction has a beginning, middle, and end. Every interaction is a scene in a larger performance.\n\n**Aristotle's structure applied:**\n- **Setup:** User enters the interactionâ€”what state are they in? What do they expect?\n- **Rising action:** Building toward the goalâ€”each step should feel like progress\n- **Climax:** The moment of commitmentâ€”pressing Submit, confirming Delete, completing Purchase\n- **Resolution:** Confirmation of outcomeâ€”what just happened? What comes next?\n\n### Dramatic Tension\n\nTension is not always bad. Appropriate tension creates engagement.\n\n**Tension that engages:**\n- Anticipation before revealing results\n- The weight of an important decision\n- The satisfaction of overcoming a challenge\n- The relief of successful completion\n\n**Tension that frustrates:**\n- Uncertainty about whether action was received\n- Fear of irreversible mistakes without recourse\n- Confusion about current state\n- Waiting without progress indication\n\n**Design principle:** Don't eliminate all tensionâ€”channel it appropriately.\n\n### The Emotional Arc\n\n| Story Beat | User Experience | Design Response |\n|------------|-----------------|-----------------|\n| Call to adventure | User has a goal | Clear entry point, inviting UI |\n| Crossing threshold | Beginning the task | Orientation, visible first step |\n| Tests and challenges | Working through task | Progress feedback, error recovery |\n| Ordeal | Moment of commitment | Appropriate weight, confirmation |\n| Reward | Goal accomplished | Clear success, celebration if warranted |\n| Return | Moving on | Next steps, graceful exit |\n\n### Empty States as Dramatic Moments\n\nAn empty state is not just \"no data\"â€”it's a narrative moment.\n\n| Empty State | Narrative | Design |\n|-------------|-----------|--------|\n| Initial empty | \"Your story hasn't begun\" | Invitation, possibility, clear CTA |\n| Cleared empty | \"You've completed everything\" | Celebration, accomplishment |\n| No results | \"We couldn't find that\" | Guidance, alternatives |\n| Error empty | \"Something went wrong\" | Empathy, clear recovery path |\n\nAn empty inbox says \"You are free.\" An empty document says \"The page awaits.\" These require different treatments.\n\n---\n\n## Emotional Design\n\n### The Three Levels\n\n**Visceral (immediate):**\nWhat does the user feel upon first seeing this?\n- First impressions\n- Aesthetic response\n- Gut reaction: attractive, scary, trustworthy?\n\n**Behavioral (during use):**\nWhat does the user feel while interacting?\n- Sense of control\n- Pleasure or frustration\n- Flow state or interruption\n- Competence or confusion\n\n**Reflective (after):**\nWhat does the user feel about the experience?\n- Did I accomplish my goal?\n- Would I use this again?\n- Would I recommend this?\n- What story do I tell about this experience?\n\n### Emotional Qualities in Interaction\n\n| Interaction | Can convey... |\n|-------------|---------------|\n| **Speed** | Efficiency (fast) or thoughtfulness (deliberate) |\n| **Weight** | Importance (heavy) or ease (light) |\n| **Sound** | Confirmation (click), completion (chime), error (buzz) |\n| **Animation** | Playfulness (bounce), precision (snap), calm (ease) |\n| **Language** | Formality, personality, empathy |\n| **Spacing** | Breathing room, density, focus |\n\n### Designing for Specific Emotions\n\n**Confidence:**\n- Clear affordancesâ€”never wonder \"can I click this?\"\n- Visible system stateâ€”never wonder \"what mode am I in?\"\n- Predictable responsesâ€”same action, same result\n- Visible recoveryâ€”undo available, changes reversible\n\n**Accomplishment:**\n- Clear progress toward goal\n- Meaningful completion markers\n- Appropriate celebration (not excessive)\n- Smooth transition to \"what's next\"\n\n**Trust:**\n- Honest feedbackâ€”never false success messages\n- Transparent processâ€”show what's happening\n- Respectful data handlingâ€”no dark patterns\n- Graceful error handlingâ€”no blame\n\n**Delight (use sparingly):**\n- Unexpected micro-moments of pleasure\n- Personality in transitions\n- Easter eggs for those who find them\n- Polish in the details\n\n---\n\n## Designing for Transformation\n\n### The User's Journey\n\nUsers don't just complete tasksâ€”they become different through interaction.\n\n**Before:** User doesn't know X / can't do Y / hasn't decided Z\n**After:** User knows X / can do Y / has committed to Z\n\n**Design question:** How does completing this interaction change the user's situation? Their capabilities? Their relationship with the system?\n\n### Onboarding as Transformation\n\nNew user onboarding isn't just \"showing features\"â€”it's transforming a stranger into a competent user.\n\n**Transformation stages:**\n1. **Stranger:** Doesn't know what this is or why they should care\n2. **Visitor:** Curious but uncommitted, easily lost\n3. **Beginner:** Committed but needs guidance at every step\n4. **Regular:** Knows enough to accomplish goals\n5. **Advocate:** Invested, may help others\n\n**Design for transition points:**\n- Stranger â†’ Visitor: Clear value proposition\n- Visitor â†’ Beginner: Low-commitment first success\n- Beginner â†’ Regular: Repeated successes, building confidence\n- Regular â†’ Advocate: Investment, personalization, mastery\n\n### Marking Moments\n\nSome moments deserve emphasis:\n\n**First-time moments:**\n- First successful [action]\n- First completed [workflow]\n- First [milestone]\n\n**Completion moments:**\n- Finishing a sequence\n- Achieving a goal\n- Reaching a threshold\n\n**Commitment moments:**\n- Making a choice\n- Spending money\n- Sharing with others\n\n**Design principle:** Mark these moments appropriately. A first purchase deserves more ceremony than a search query. But don't over-celebrate trivial accomplishmentsâ€”it feels patronizing.\n\n---\n\n## Applying This Perspective\n\n### Before Designing Any Interaction\n\n1. **What is the user's end goal?** (Not what they're doing, but why)\n2. **What archetype are they?** (First-timer to expert spectrum)\n3. **What is the emotional context?** (Rushed? Anxious? Playful?)\n4. **What is the dramatic moment?** (Beginning? Climax? Resolution?)\n5. **How are they transformed?** (What's different after?)\n\n### Questions to Challenge Your Design\n\n- Does every step serve the user's goal, or are some serving the system?\n- Could a perpetual intermediate complete this without learning anything new?\n- Where is the climax of this interaction? Is it weighted appropriately?\n- What emotion should the user feel at each stage?\n- If this interaction were a scene in a play, what story is it telling?\n\n### Warning Signs\n\n- You're designing a feature without knowing who uses it\n- Every user gets the same experience regardless of expertise\n- The interaction ends without clear resolution\n- You can't articulate what emotion the user should feel\n- Tasks exist because \"the system needs\" rather than \"the user wants\"\n",
        "skills/interaction-design/references/input-and-physicality.md": "# Input and Physicality\n\nInput devices, two-handed interaction, haptics, and the physical act of interaction.\n\n## Table of Contents\n- [Input Devices Matter](#input-devices-matter)\n- [Two-Handed Interaction](#two-handed-interaction)\n- [Haptic Design](#haptic-design)\n- [Sketching and Prototyping](#sketching-and-prototyping)\n- [Post-WIMP Alternatives](#post-wimp-alternatives)\n- [Emerging Modalities](#emerging-modalities)\n\n---\n\n## Input Devices Matter\n\nThe device in the user's hand shapes what interactions are possible and natural.\n\n### Device Characteristics\n\n| Device | DOF | Precision | Speed | Fatigue | Best For |\n|--------|-----|-----------|-------|---------|----------|\n| Mouse | 2D + buttons | High | Fast | Low | Precise pointing, extended use |\n| Trackpad | 2D + gestures | Medium | Medium | Low | Multi-touch gestures, laptop use |\n| Touch (finger) | 2D + multitouch | Low | Fast | Medium | Direct manipulation, casual use |\n| Stylus/Pen | 2D + pressure + tilt | Very high | Medium | Medium | Drawing, writing, precise selection |\n| Trackball | 2D + buttons | High | Medium | Very low | Precision without arm movement |\n| Scroll wheel | 1D | Medium | Fast | Very low | Vertical navigation, value adjustment |\n| Keyboard | Discrete | Exact | Fast | Low | Text, commands, shortcuts |\n\n### Matching Input to Task\n\n| Task | Best Input | Why |\n|------|------------|-----|\n| Precise positioning | Pen > Mouse > Touch | Control and accuracy |\n| Quick selection | Touch > Mouse > Pen | Speed and directness |\n| Extended work | Mouse/Trackball > Touch | Fatigue reduction |\n| Drawing/writing | Pen with pressure | Natural expression |\n| Text entry | Keyboard > Voice > Touch | Speed and accuracy |\n| 3D navigation | 6-DOF controller > Mouse | Degree of freedom match |\n| Audio mixing | Physical faders > Sliders | Tactile feedback, multiple channels |\n\n### Degree of Integration Revisited\n\n**Degree of integration = Input DOF / Output DOF**\n\n| Interaction | Input DOF | Output DOF | Integration | Improvement |\n|-------------|-----------|------------|-------------|-------------|\n| Scrollbar for 2D pan | 1 | 2 | 0.5 | Use 2D panning gesture |\n| 3 sliders for color | 1+1+1 | 3 | 1.0 (but sequential) | Color picker with 2D + slider |\n| Mouse for 3D rotation | 2 | 3 | 0.67 | Virtual trackball, or 3D mouse |\n| Text field for angle | ~0 (symbolic) | 1 | ~0 | Rotation dial or drag |\n\n**Design principle:** When input DOF is lower than output DOF, users must perform multiple sequential operations for what could be one integrated action.\n\n### Physical Controllers\n\nBeyond mouse and keyboard, consider:\n\n**Dedicated knobs/dials:**\n- Infinite rotation with detents for precision\n- Direct tactile feedback\n- Can control without looking\n- Example: Volume knob, scroll wheel, jog dial\n\n**Sliders/faders:**\n- Linear movement maps to linear values\n- Can see/feel current position without feedback\n- Multiple faders for multiple channels\n- Example: Audio mixer, brightness control\n\n**Buttons with states:**\n- Toggle switches, pressure-sensitive buttons\n- Physical state matches digital state\n- Example: Mute buttons with LED, piano keys\n\n**When to consider physical controls:**\n- Professional/frequent use justifies hardware investment\n- Multiple simultaneous adjustments needed\n- Eyes-free operation valuable\n- Tactile feedback important for task\n\n---\n\n## Two-Handed Interaction\n\nHumans naturally use two hands. Most interfaces only engage one.\n\n### Guiard's Kinematic Chain Model\n\n**Non-dominant hand:**\n- Sets frame of reference\n- Coarse positioning\n- Lower frequency movements\n- Leads in time\n\n**Dominant hand:**\n- Fine manipulation within frame\n- Precise actions\n- Higher frequency movements\n- Follows non-dominant\n\n**Example:** Writing\n- Non-dominant: Holds and positions paper\n- Dominant: Writes\n\n### Two-Handed Patterns in UI\n\n| Pattern | Non-Dominant | Dominant | Benefit |\n|---------|--------------|----------|---------|\n| **Toolglass** | Positions translucent palette | Clicks through to act | Reduces mode switching |\n| **Pan-zoom-draw** | Pan/zoom canvas | Draw/select | Continuous context + action |\n| **Keyboard + mouse** | Modifier keys, shortcuts | Pointing, clicking | Speeds expert interaction |\n| **Tablet + stylus** | Touch for gestures | Pen for precision | Best of both inputs |\n\n### Designing for Two Hands\n\n**For touch tablets:**\n- Consider split-screen controls (left thumb, right thumb)\n- Palm rejection when one hand rests on screen\n- Gestures that use both hands (pinch to zoom)\n\n**For desktop:**\n- Keyboard shortcuts that complement mouse actions\n- Consider non-dominant-hand devices (scroll wheel, trackpad alongside mouse)\n- Modifier keys transform mouse actions\n\n**Questions to ask:**\n- Can both hands be productively engaged simultaneously?\n- Does the non-dominant hand have meaningful work?\n- Are we forcing sequential interaction that could be parallel?\n\n---\n\n## Haptic Design\n\nTouch is a sense we largely ignore in digital interaction.\n\n### Haptic Modalities\n\n**Vibrotactile:** Vibrations felt through skin\n- Most common in phones, game controllers\n- Can convey: confirmation, alerts, texture, rhythm\n\n**Force feedback:** Resistance to movement\n- Gaming controllers, some styluses\n- Can convey: weight, boundaries, magnetic snapping\n\n**Surface haptics:** Variable friction on touchscreens\n- Emerging technology\n- Can convey: texture, edges, buttons\n\n### Haptic Design Patterns\n\n| Purpose | Haptic Response | Platform Example |\n|---------|-----------------|------------------|\n| **Confirmation** | Single short tap | iOS button press |\n| **Success** | Double tap or pulse | Transaction complete |\n| **Warning** | Triple tap or buzz | Battery low |\n| **Selection** | Light tick | Picker wheel detent |\n| **Error** | Sharp buzz | Rejected action |\n| **Progress** | Rhythmic pulse | Countdown, progress |\n| **Boundary** | Resistance/edge | Scroll limit, snap points |\n\n### Haptic Design Principles\n\n**Match expectation:**\n- Physical buttons should feel like pressing\n- Sliders should feel like sliding\n- Boundaries should feel like edges\n\n**Don't overuse:**\n- Every haptic event competes for attention\n- Reserve strong haptics for important moments\n- Users will disable excessive haptics\n\n**Coordinate with audio/visual:**\n- Haptic + sound + visual = strongest feedback\n- Haptic alone can work eyes-free\n- Timing must be synchronized (<50ms difference)\n\n**Consider context:**\n- Haptics audible in quiet rooms\n- Haptics can be felt by adjacent people (shared surfaces)\n- Some users disable haptics (respect preference)\n\n### Audio-Haptic Coupling\n\nThe satisfying \"click\" of a keyboard is audio-haptic.\n\n**Design for the combination:**\n- Key press: tactile snap + audible click\n- Button: tactile depression + subtle sound\n- Notification: vibration + chime\n\n**The uncanny valley:** Haptics without sound (or vice versa) can feel wrong. Either commit to the full sensory experience or keep it subtle.\n\n---\n\n## Sketching and Prototyping\n\nDesign doesn't begin with specificationsâ€”it begins with exploration.\n\n### The Role of Sketching\n\n**Sketching is thinking.** The act of drawing externalizes thought, reveals assumptions, and enables critique.\n\n**Sketches are not prototypes:**\n\n| Sketch | Prototype |\n|--------|-----------|\n| Quick, disposable | Invested, refined |\n| Explores many ideas | Tests one idea |\n| Ambiguous, evocative | Specific, testable |\n| Invites interpretation | Answers questions |\n| \"What if...?\" | \"Does this work?\" |\n\n### What to Sketch\n\n**Before specifying timing, sketch the interaction:**\n- Paper frames showing state changes\n- Sticky notes for flow steps\n- Whiteboard diagrams of user paths\n- Video scenarios with paper cutouts\n\n**Before specifying gestures, act them out:**\n- How does this feel in the hand?\n- What would you naturally try?\n- Where do your eyes go?\n\n### Prototyping Fidelity\n\n| Fidelity | Tools | Tests | When |\n|----------|-------|-------|------|\n| **Paper** | Paper, markers, scissors | Flow, layout, concept | Early exploration |\n| **Wireframe** | Figma, Sketch (static) | Information hierarchy | Structure validation |\n| **Click-through** | Figma, InVision | Navigation, basic flow | Flow validation |\n| **Animated** | Principle, Framer | Timing, transitions | Motion design |\n| **Coded** | HTML/CSS, SwiftUI | Real interaction | Final validation |\n\n**Key principle:** Use the lowest fidelity that can answer your question. High fidelity takes more time and creates attachment that resists change.\n\n### Wizard of Oz Testing\n\nSimulate intelligence/complexity with a human behind the curtain:\n- Test voice interfaces by typing responses\n- Test AI features with human judgment\n- Test complex backends with manual data\n\n**When to use:** The technology doesn't exist yet, or building it is expensive, but you need to validate the interaction concept.\n\n---\n\n## Post-WIMP Alternatives\n\nWindows, Icons, Menus, Pointing (WIMP) is not the only paradigm.\n\n### Zoomable User Interfaces (ZUI)\n\n**Concept:** All content exists on an infinite canvas; navigation is zoom and pan.\n\n**Benefits:**\n- No mode for \"opening\" filesâ€”just zoom in\n- Spatial memory for location\n- Continuous context (see overview and detail)\n- Natural for maps, timelines, canvases\n\n**Examples:** Miro, Figma canvas, Google Maps, Prezi\n\n**Design considerations:**\n- Need clear landmarks for navigation\n- Performance at scale\n- Search/jump for known targets\n\n### Marking Menus\n\n**Concept:** Gesture-based menu selection where direction indicates choice.\n\n**How it works:**\n- Hold to reveal pie menu (novice)\n- Or stroke in direction without waiting (expert)\n- Direction encodes selection: up = cut, right = copy, down = paste\n\n**Benefits:**\n- Muscle memory develops quickly\n- Expert mode is faster than any visible menu\n- 8 items per level, can nest for 64+ commands\n\n**Design considerations:**\n- 8-direction limit per level\n- Must be discoverable initially\n- Works best with pen/touch\n\n### Toolglasses and Magic Lenses\n\n**Toolglass:** Translucent palette held by non-dominant hand, clicked through with dominant hand.\n\n**Magic lens:** A filter you move over content to see/modify it differently (e.g., magnifier, X-ray view, color filter).\n\n**Benefits:**\n- Eliminates mode switching\n- Tool and target selected simultaneously\n- Two-handed efficiency\n\n**Design considerations:**\n- Requires two input points (multitouch, two devices)\n- Visual clutter of overlay\n- Discoverability\n\n### Gestural Shortcuts\n\nBeyond pointing: shapes drawn in space that trigger commands.\n\n**Examples:**\n- Pigtail gesture for undo\n- Check mark for approve\n- X for delete\n- Circle to select region\n\n**Benefits:**\n- Fast once learned\n- No visible UI needed\n- Can combine with speech\n\n**Design considerations:**\n- Discoverability problem\n- Recognition accuracy\n- Cultural variation in gesture meaning\n\n---\n\n## Emerging Modalities\n\n### Eye Tracking\n\n**Capabilities:**\n- Know where user is looking\n- Gaze as pointing (dwell to select)\n- Attention analytics\n\n**Design considerations:**\n- \"Midas touch\" problem: looking isn't the same as intending\n- Need explicit confirmation for action\n- Privacy implications\n\n**Current use:** Accessibility (eye gaze interfaces), attention research, VR foveated rendering\n\n### Voice\n\n**Capabilities:**\n- Natural language commands\n- Hands-free operation\n- Conversational interaction\n\n**Design considerations:**\n- Social acceptability (not in public/quiet spaces)\n- Discoverability (what can I say?)\n- Error recovery (misrecognition)\n- Privacy (always listening?)\n\n**Best combined with:** Visual feedback showing interpretation, touch for correction\n\n### Spatial Computing (VR/AR)\n\n**Capabilities:**\n- 3D spatial manipulation\n- Gaze + hand tracking\n- Room-scale interaction\n- Environmental awareness\n\n**Design considerations:**\n- Fatigue from extended arm use (\"gorilla arm\")\n- Lack of haptic feedback in air\n- Locomotion in virtual space\n- Text input remains challenging\n\n**Emerging patterns:**\n- Pinch gestures for selection\n- Gaze for pointing, hand for action\n- Spatial UI attached to surfaces/objects\n- Eye tracking for foveated rendering and intent\n\n### Multi-Modal Integration\n\nThe future is not replacing modalities but combining them:\n\n| Modalities | Combined Use |\n|------------|--------------|\n| Voice + gaze | \"Delete that\" (gaze targets, voice commands) |\n| Voice + gesture | \"Move this here\" (gesture indicates this/here) |\n| Touch + pen | Finger for gestures, pen for precision |\n| Touch + gaze | Look to preview, touch to select |\n\n**Design principle:** Each modality contributes what it does best. Voice for commands, gaze for targeting, hands for manipulation, haptics for feedback.\n",
        "skills/interaction-design/references/instrumental-interaction.md": "Instrumental Interaction: An Interaction Model for Designing Post-WIMP User Interfaces\n\nMichel Beaudouin-Lafon\nDepartment of Computer Science\nUniversity of Aarhus\nAabogade 34\nDK-8200 Aarhus N â€” Denmark\nmbl@dai.mi.au.dk\n\nOpen Access support provided by Aarhus University\n\nConference: CHI â€™00: Proceedings of the SIGCHI Conference on Human Factors in Computing Systems, The Hague, The Netherlands, April 1â€“6, 2000\nSponsors: SIGCHI\nPublished: 01 April 2000\nISBN: 1581132166\nDOI: https://doi.org/10.1145/332040.332473 (https://doi.org/10.1145/332040.332473)\nPDF: 332040.332473.pdf\nTotal Citations: 382\nTotal Downloads: 6917\n\nPermission notice:\nPermission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. To copy otherwise, to republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee.\nCHI â€™2000 The Hague, Amsterdam\nCopyright ACM 2000 1-58113-216-6/00/04â€¦$5.00\n\nAbstract\n\nThis article introduces a new interaction model called Instrumental Interaction that extends and generalizes the principles of direct manipulation. It covers existing interaction styles, including traditional WIMP interfaces, as well as new interaction styles such as two-handed input and augmented reality. It defines a design space for new interaction techniques and a set of properties for comparing them. Instrumental Interaction describes graphical user interfaces in terms of domain objects and interaction instruments. Interaction between users and domain objects is mediated by interaction instruments, similar to the tools and instruments we use in the real world to interact with physical objects. The article presents the model, applies it to describe and compare a number of interaction techniques, and shows how it was used to create a new interface for searching and replacing text.\n\nKeywords\n\nInteraction model, WIMP interfaces, direct manipulation, post-WIMP interfaces, instrumental interaction\n\nIntroduction\n\nIn the early eighties, the Xerox Star user interface [27] and the principles of direct manipulation [26] led to a powerful graphical user interface model, referred to as WIMP (Windows, Icons, Menus and Pointing). WIMP interfaces revolutionized computing, making computers accessible to a broad audience for a variety of applications.\n\nIn the last decade, HCI researchers have introduced numerous new interaction techniques, such as toolglasses [5] and zoomable user interfaces [3]. Although some have been shown to be more efficient than traditional techniques, e.g., marking menus [19], few have been incorporated into commercial systems. A likely reason is that integrating new interaction techniques into an interface is challenging for both designers and developers. Designers find it faster and easier to stick with a small set of well-understood techniques. Similarly, developers find it more efficient to take advantage of the extensive support for WIMP interaction provided by current development tools.\n\nThe leap from WIMP to newer â€œpost-WIMPâ€ graphical interfaces, which take advantage of novel interaction techniques, requires both new interaction models and corresponding tools to facilitate development. This paper focuses on the first issue by introducing a new interaction model, called Instrumental Interaction, that extends and generalizes the principles of direct manipulation to also encompass a wide range of graphical interaction techniques.\n\nThe Instrumental Interaction model has the following goals:\n\n- Cover the state-of-the-art in graphical interaction techniques.\n\n- Provide qualitative and quantitative ways to compare interaction techniques, to give designers the basis for an informed choice when selecting a given technique to address a particular interface problem.\n\n- Define a design space in which unexplored areas can be identified and lead to new interaction techniques.\n\n- Open the way to a new generation of user interface development tools that make it easy to integrate the latest interaction techniques in interactive applications.\n\nAfter a review of related work, this paper analyzes the limits of current WIMP interfaces. The Instrumental Interaction model is introduced and applied to several existing interaction techniques as well as to the design of a new interface for searching and replacing text. Finally the paper concludes with suggestions for future work.\n\nRelated Work\n\nIn this paper, an interaction model is defined as follows:\nAn interaction model is a set of principles, rules and properties that guide the design of an interface. It describes how to combine interaction techniques in a meaningful and consistent way and defines the â€œlook and feelâ€ of the interaction from the userâ€™s perspective. Properties of the interaction model can be used to evaluate specific interaction designs.\n\nDirect Manipulation [26] is a generic interaction model, while style guides, e.g., Appleâ€™s guidelines [2], describe more precise and specific models. Took introduced a model called Surface Interaction [29] and Holland & Oppenheim a model called Direct Combination [15].\n\nAn interaction model differs from the architectural model of an interface, which describes the functional elements in the implementation of the interface and their relationships (see [12] for a review). User interface development environments have generated a variety of implementation models for developing interfaces (see [24] for a review), e.g. the widget model of the X/Motif toolkit [14] or Garnetâ€™s Interactors model [23]. MVC [18] is a well-known model that was created to support the Xerox Star user interface and has influenced many other architectural and implementation models. Whereas architectural models are aimed at interface development, an interaction model is aimed at interface design.\n\nThe model-based approach and its associated tools [28] help bridge the gap between interaction and architectural models by offering a higher-level approach to the design of interactive systems.\n\nDevice-level models such as logical input devices [11] or Card et al.â€™s taxonomy [7] operate at a lower level of abstraction than interaction models. Understanding the role of the physical devices in interaction tasks is a critical component of the definition of the Instrumental Interaction model.\n\nAt the theoretical level, Activity Theory [6] provides a relevant framework for analyzing interaction as a mediation process between users and objects of interest.\n\nFinally, Instrumental Interaction is grounded in the large (and growing) number of graphical interaction techniques that have been developed in recent years, some of which are referenced in the rest of this article.\n\nFrom WIMP to Post-WIMP Interfaces\n\nThe WIMP interaction model can be outlined as follows:\n\n- Application objects are displayed in document windows.\n\n- Objects can be selected and sometimes dragged and dropped between different windows.\n\n- Commands are invoked through menus or toolbars, often bringing up a dialog box that must be filled in before the commandâ€™s effect on the object is visible.\n\nThis section uses Shneidermanâ€™s principles of direct manipulation [26] to analyze WIMP interfaces:\n\n1. Continuous representation of objects of interest\n\nObjects of interest are central to direct manipulation. They are the objects that the user is interested in to achieve a given task, such as the text and drawings of a document or the formulae and values in a spreadsheet. Principle 1 asserts that objects of interest should be present at all times. Since objects of interest are often larger than the screen or window in which they are displayed, WIMP interfaces makes them accessible at all times through scrolling, panning or zooming. This accessibility is hindered by the growing number of interface objects that are not objects of interest such as toolbars, floating palettes and menu bars. These use increasing amounts of screen real-estate, forcing the user to shrink the windows displaying objects of interest. Dialog boxes also often occlude significant parts of the screen, making the rest of the interface inaccessible to the user.\n\nFinally, there are more objects of interest than meet the eye: in many applications users must manipulate secondary objects to achieve their tasks, such as style sheets in Microsoft Word, graphical layers in Adobe Photoshop or Deneba Canvas, or paint brushes in MetaCreations Painter. Once the user is familiar with the application, these objects become part of his or her mental model and may acquire the status of object of interest. Unfortunately, these are rarely implemented as first-class objects. Thus, for example, Wordâ€™s styles are editable only via transient dialog boxes that must be closed before returning to the text editing task.\n\n2. Physical actions on objects vs. complex syntax\n\nMost computers have only a mouse and keyboard as input devices limiting the set of user actions to: typing text or â€œspecialâ€ keys (e.g. function keys, keyboard shortcuts and modifiers), pointing, clicking, and dragging. Given the mismatch between this small vocabulary of actions and the large vocabulary of commands, WIMP interfaces must rely on additional interface elements, usually menus and dialog boxes, to specify commands. The typical sequence of actions to carry out a command is:\n\n- Select the object of interest by clicking it.\n\n- Select a command from a menu or keyboard shortcut.\n\n- Fill in the fields of a dialog box.\n\n- Click the OK button to see the result.\n\nThis is conceptually no different from typing a command in a command-line interface: The user must type a command name, file name (the object of interest), arguments (the fields in the dialog box) and return key (the OK button). In both cases the syntax is complex and cannot be considered direct manipulation of the objects of interest. In fact, WIMP interfaces directly violate principle 2 and often use indirect manipulation of the objects of interest, through (direct) manipulation of interface elements such as menus and dialog boxes.\n\n3. Fast, incremental and reversible operations with an immediately-apparent effect on the objects of interest\n\nThe heavy graphical syntax imposed on the user results in commands that are neither fast nor incremental. Specifying a command is not fast because of the amount of time used for non-semantic actions such as displacing windows and flipping through tabs in a tabbed dialog. Inputting parameter values for a command is often inefficient because of the small set of interactors, such as when numeric values are entered as text. Finally, the specification is not incremental: users must explicitly commit to a command that uses a dialog box before seeing the result. If the result does not match the userâ€™s expectations, the whole cycle of command activation must be started over again. This is especially cumbersome when trial-and-error is an integral part of the task, as when a graphics designer selects a font size: specifying the point size numerically is annoying when the goal is to see the visual result on the page.\n\n4. Layered or spiral approach to learning\n\nThe small number of interaction techniques used by WIMP interfaces makes it easy to learn the basics of any new application. However, interaction shortcuts, such as combining keyboard modifiers with mouse buttons to activate the frequent commands, are concealed and inconsistent across applications and make the transition from novice to power user more difficult.\n\nTowards a new interaction model\n\nSome commercial applications, especially those dedicated to creative tasks such as painting, graphic design or music, extend the basic WIMP model to address some of the shortcomings identified above. For example, some painting programs make brushes first class objects that can be edited and saved into files. Some text editors have inspector windows that display the state of the current selection and update it when the user enters relevant values. Techniques such as the HotBox [21] were designed to access larger numbers of commands.\n\nThese new interaction techniques illustrate the transition from WIMP to post-WIMP interaction: Windows are not used in zoomable interfaces, icons and text are replaced by richer representations in interactive visualization, menus are complemented by more powerful interaction widgets such as toolglasses, pointing and dragging are superseded by bimanual input and gesture input. Designing post-WIMP interfaces that are more faithful to the principles of direct manipulation and that take advantage of novel interaction techniques requires new interaction models. To guide interface designers, these models should be:\n\n- Descriptive, incorporating both existing and new applications.\n\n- Comparative, providing metrics for comparing alternative designs (as opposed to prescriptive, deciding a priori what is good and what is bad).\n\n- Generative, facilitating creation of new interaction techniques.\n\nInstrumental Interaction\n\nAs shown in the previous analysis, WIMP interfaces do not follow the principles of direct manipulation. Instead, they introduce interface elements such as menus, dialog boxes and scrollbars that act as mediators between users and the objects of interest. Users have a (limited) sense of engagement, as advocated by direct manipulation, because they manipulate these intermediate objects directly. This matches our experiences in the physical world: We rarely fingerpaint, but often use pens and pencils to write. We cook with pots and pans, hang pictures with hammers and power drills, open doors with handles and turn off lights with switches. Our interaction with the physical world is governed by our use of tools. Direct manipulation of physical objects of interest occurs when we bring them into our current context of operation, before we manipulate them with the appropriate tools, usually with two hands [13].\n\nThe Instrumental Interaction model is based on how we naturally use tools (or instruments) to manipulate objects of interest in the physical world. Objects of interest are called domain objects, and are manipulated with computer artifacts called interaction instruments.\n\nDomain objects\n\nIn computer systems, applications operate on data that represent phenomena or objects. For computer users, this data is the primary focus of their actions. For example, when creating a text document, the focus of the user is on the text of the document. Everything else on the screen is there to support the userâ€™s task of editing the text document.\n\nDomain objects form the set of potential objects of interest for the user of a given application. Domain objects have attributes that describe their characteristics. Attributes can be simple values or more complex objects. For example, in a 3D modeller, the position and size of a sphere are simple values (integer or real numbers), while the material of the sphere is a complex entity (color, texture, transparency, etc.). The user may shift the object of interest, concentrating on the material as the focus of the interaction. Similarly, text styles that describe the formatting attributes of text also may also obtain the status of objects of interest. Materials and styles are therefore also domain objects in their respective interfaces.\n\nIn summary, domain objects form the basis of the interaction as well as its purpose: Users operate on domain objects by editing their attributes. They also manipulate them as a whole, e.g. to create, move and delete them.\n\nInteraction instruments\n\nAn interaction instrument is a mediator or two-way transducer between the user and domain objects. The user acts on the instrument, which transforms the userâ€™s actions into commands affecting relevant target domain objects. Instruments have reactions enabling users to control their actions on the instrument, and provide feedback as the command is carried out on target objects (Figure 1).\n\nA scrollbar is a good example of an interaction instrument. It operates on a whole document by changing the part that is currently visible. When the user clicks on one of the arrows of the scrollbar, the scrollbar sends the document a scrolling command. Note that the transduction here consists of sending scrolling commands as long as the user presses the arrow. The reaction of the scrollbar consists of highlighting the arrow being pressed. The feedback consists of updating the thumb to reflect the new position of the document. In addition, the object also responds to the instrument by updating its view in the window.\n\nAnother example is an instrument that creates rectangles in a drawing editor. As the user clicks and drags the mouse, the instrument provides a reaction in the form of a rubber-band rectangle. When the user releases the button, the creation operation is actually carried out and a new domain object is created. The feedback of this operation consists in displaying the new object.\n\nAn instrument decomposes interaction into two layers: the interaction between the user and the instrument, defined as the physical action of the user on the instrument and the reaction of the instrument; and the interaction between the instrument and the domain object, defined as the command sent to the object and the response of the object, which the instrument may transform into feedback to the user. The instrument is composed of a physical part, the input device, and a logical part, the representation of the instrument in software and on the screen.\n\nFigure 1: Interaction instrument mediating the interaction between a user and a domain object.\n\nActivating instruments\n\nAt any one time, an interface provides a potentially large number of instruments. However the user can manipulate only a few of them at the same time, usually only one, because of the limited number of input devices. In the most common case of a keyboard and mouse, a single input device (the mouse) must be multiplexed between a potentially large number of instruments, i.e. a single physical part may be associated with different logical parts.\n\nAn instrument is said to be activated when it is under the userâ€™s control, i.e. when the physical part has been associated with the logical part. In the case of the scrollbar, the user activates the instrument by pointing at it and it remains active as long as the pointer is within the scrollbar. When creating a rectangle, the user activates the instrument by clicking a button in a tool palette and it remains active until another instrument is activated.\n\nThese two types of activation are quite different. The activation of the scrollbar is spatial because it is caused by moving the mouse (and cursor) inside the area of the scrollbar. The activation of the rectangle creation instrument is temporal because it is caused by a former action and remains in effect until the activation of another instrument. (This is traditionally called a mode). Each type of activation has an associated cost: Spatial activation requires the instrument to be visible on the screen, taking up screen real-estate and requiring the user to point at it and potentially dividing the userâ€™s attention. Temporal activation requires an explicit action to trigger the activation, making it slower and less direct.\n\nInterface designers often face a design trade-off between temporal and spatial multiplexing of instruments because the activation costs become significant when the user must frequently change instruments. Using extra input devices can reduce these costs. For example, the thumbwheel on Microsoftâ€™s Intellimouse is a scrolling instrument that is always active. An extreme example is an audio mixing console, which may contain several hundred potentiometers and switches, each corresponding to a single function. This permits very fast access to all functions, which is crucial for sound engineers working in real-time and cannot afford the cost of activating each function indirectly. A large design space lies between a single mouse and hundreds of potentiometers, posing design challenges to maximally exploit physical devices and reduce activation costs.\n\nReification and meta-instruments\n\nReification is a process for turning concepts into objects. In user interfaces, the resulting objects can be represented explicitly on the screen and operated upon. For example, a style in a text editor is the reification of a collection of text attributes; the notion of material in a 3D modeller is the reification of a set of rendering properties. This type of reification generates new domain objects such as styles and materials that complement the â€œprimaryâ€ domain objects of the application domain.\n\nInstrumental Interaction introduces a second type of reification: an interaction instrument is the reification of one or more commands. For example, a scrollbar is the reification of the command that scrolls a document. This link between the traditional notion of command and the notion of instrument makes it easy to analyze existing interfaces with the Instrumental Interaction model. It is also a useful guideline to identify instruments when designing a new interface. In the last part of this paper, this rule is used to reify the traditional search-and-replace command of a text editor into a search instrument.\n\nThe result of this reification rule is that instruments are themselves potential objects of interest. This is indeed the case in real life, when the focus of attention shifts from the object being manipulated to the tool used to manipulate it. For example a pencil is a writing instrument and the domain object is the text being written. When the lead breaks, the focus shifts to a new instrument, a pencil sharpener, which operates on the shifted domain object, the pencil lead. The focus may even shift to the pen sharpener, if we need a screwdriver to fix it. Such â€œmeta-instrumentsâ€ (instruments that operate on instruments) are not only useful for â€œfixingâ€ instruments, but can also be used to organize instruments in the workspace, e.g. a toolbox, or to tailor instruments to particular tasks, e.g. turning a power drill into a power saw. In graphical user interfaces, common meta-instruments include menus and tool palettes used to select commands and tools, i.e. to activate instruments.\n\nProperties of instruments\n\nAn important role of an interaction model is to provide properties to evaluate and compare alternative designs. This can help interface designers who face difficult choices when selecting the interaction techniques for a particular application. The goal of defining properties of instruments is not to decide which instruments are good and which are bad, but to evaluate them so that designers can make an informed choice and so that researchers can identify and explore areas of the design space that are not mapped by existing instruments.\n\nThe literature on user interface evaluation techniques is considerable. Here, we use a particular type of evaluation based on properties. This is a common approach in software engineering and has also proved valid and useful for evaluating interactive systems [12]. The rest of this section introduces three properties of interaction instruments.\n\nDegree of indirection\n\nThe degree of indirection is a 2D measure of the spatial and temporal offsets generated by an instrument. The spatial offset is the distance on the screen between the logical part of the instrument and the object it operates on. Some instruments, such as the selection handles used in graphical editors, have a very small spatial offset since they are next to or on top of the object they control. Other instruments, such as dialog boxes, can be arbitrarily far away from the object they operate on and therefore have a large spatial offset. A large spatial offset is not necessarily undesirable. For example, placing a light switch far from the light bulb it controls makes it easier to turn on the light. Similar examples can be found in user interfaces.\n\nThe temporal offset is the time difference between the physical action on the instrument and the response of the object. In some cases, the object responds to the userâ€™s action in real-time. For example, clicking an arrow in a scrollbar scrolls the document while the mouse button is depressed. In other cases, the object responds to the userâ€™s action only when the action reaches closure. For example, the arguments specified in a dialog box are taken into account only when the OK or Apply button is activated. In general, short temporal offsets are desirable because they exploit the human perceptionâ€“action loop and give a sense of causality [22].\n\nFigure 2: Degree of indirection â€” spatial vs temporal offsets across instruments; continuum between direct and indirect manipulation.\n\nDegree of integration\n\nThe degree of integration measures the ratio between the number of degrees of freedom (DOF) provided by the logical part of the instrument and the number of DOFs captured by the input device. This term comes from the notion of integral tasks [17]: some tasks are performed more efficiently when the various DOFs are controlled simultaneously with a single device. A scrollbar is a 1D instrument controlled by a 2D mouse, therefore its degree of integration is 1/2. The degree of integration can be larger than 1: controlling 3 rotation angles with a 2D mouse [16] has a degree of integration of 3/2. This property can be used to compare instruments that perform similar operations.\n\nFor example, panning over a document can be achieved with two scrollbars or a 2D panner. The latter has a degree of integration of 1 and is therefore more efficient than two scrollbars, which have a degree of integration of 1/2 and incur additional activation costs.\n\nDegree of compatibility\n\nThe degree of compatibility measures the similarity between the physical actions of the users on the instrument and the response of the object. Dragging an object has a high degree of compatibility since the object follows the movements of the mouse. Scrolling with a scrollbar has a low degree of compatibility because moving the thumb downwards moves the document upwards. Using text input fields to specify numerical values in a dialog box, e.g. the point size of a font, has a very low degree of compatibility because the input data type is different from the output data type. Similarly, specifying the margin in a text document by entering a number in a text field has a lower degree of compatibility than dragging a tab in a ruler.\n\nApplying the Model\n\nThis section uses the Instrumental Interaction model to analyze existing interaction techniques, both from WIMP interfaces and from more recent research. It demonstrates the descriptive power of the model. The generative power of the model is then illustrated by the design of a new instrument for searching and replacing text.\n\nAnalyzing WIMP interfaces\n\nThe primary components of WIMP interfaces can be easily mapped to instruments and compared:\n\n- Menus and toolbars are meta-instruments used to select the command or tool to activate. This use of meta-instruments slows down interaction and generates shifts of attention between the object of interest, the meta-instrument and the instrument. Contextual menus have a small spatial offset and are therefore more efficient than toolbars and menu bars. Toolbars, which can be moved next to their context of use, have a better spatial offset than menu bars.\n\n- Dialog boxes are used for complex commands. They have a high degree of spatial and temporal indirection. They often use a small set of standard interactors such as text fields for numeric values, resulting in a low degree of compatibility.\n\n- Inspectors and property boxes are an alternative to dialog boxes that have a lower degree of temporal indirection. Since they can stay open, they can be activated with pointing (positional activation) rather than selection in a menu (temporal activation).\n\n- Handles are used for graphical editing and provide a very direct interaction: low degree of indirection, high degree of compatibility and good degree of integration.\n\n- Window titles and borders are instruments activated positionally to manipulate the window (move, resize, iconify, zoom, close). Scrollbars control the content of the window. Because of their low degree of integration, they are not optimal, especially for panning documents in 2D. Also, their spatial offset generates a division of attention, especially since they are activated positionally: the user must be sure to point at the right part of the scrollbar.\n\n- Keyboard shortcuts and accelerator keys are meta-instruments, used to quickly switch between instruments and save the activation costs of menus and toolbars. Some accelerator keys affect the way the current instrument works. For example, on the Macintosh, the Shift key constrains the move tool to horizontal and vertical moves and the resize tool to maintain the current aspect ratio.\n\n- Drag and drop is a generic instrument for transferring or copying information. Compared to traditional cut/copy/paste commands that use a hidden clipboard, it has a smaller degree of indirection. There is no spatial offset because the objects are manipulated directly and the temporal offset is low because there is feedback about potential drop-zones as the user drags the object.\n\nOver the past few years, interaction techniques such as inspectors, property boxes, drag and drop and contextual menus have become more common in commercial applications. The above analysis explains why these techniques are more efficient than their WIMP counterparts, demonstrating a useful contribution of the Instrumental Interaction model.\n\nAnalyzing post-WIMP interaction techniques\n\nInteractive visualization helps users explore large quantities of visual data and make sense of it through filtering and displaying it to exhibit patterns [8]. These systems use two categories of instruments:\n\n- Navigation instruments specify which part of the data to visualize and how.\n\n- Filtering instruments specify queries and display results.\n\nA key aspect of these systems is a strong coupling between user actions and system response. In other words, these instruments must have a small temporal offset ; any parameter change updates visualization immediately, often with smooth animations that preserve perceptual continuity.\n\nZoomable user interfaces (e.g., infinite canvases) require pan/zoom instruments that are temporally activated and available anywhere, yielding high compatibility and integration versus positional scrollbars. Droppable local tools collocate instruments with content, removing metaâ€‘instrument overhead. Bimanual paradigms (toolglasses) keep a metaâ€‘instrument under the nonâ€‘dominant hand while the dominant hand acts through it on domain objects, enabling concurrent navigation and editing. Graspable/AR interfaces externalize instrument logic into physical artifacts, maximizing compatibility and integration by operating in the real world.\n\nDesigning a Text Search InstrumentÂ ï¿¼\n\nThe conventional modal dialog enforces serial, systemâ€‘prompted decisions with high temporal offset. The proposed nonâ€‘modal instrument provides:\n\n- Immediate highlighting of all matches in text and as tick marks on the scrollbar.\n\n- Clickâ€‘toâ€‘replace with instant feedback; perâ€‘occurrence arbitrary undo via reâ€‘click.\n\n- Replaceâ€‘string edits that propagate to all replaced occurrences.\n\n- Continuous recomputation of matches as the document changes.\n\n- Scrollbar rate control: vertical pointer distance modulates speed/direction; reduces attention division and raises integration/compatibility.\n\nVariants: multiple simultaneous search instruments with distinct highlight colors; multiâ€‘string queries and regex replacements for workflows like indexing, leveraging global visibility to avoid nearâ€‘duplicate inclusions.\n\nProperty effects: reduced spatial offset (no Next/Previous/Replace buttons), reduced temporal offset (immediate visualization and effects), increased integration (rate control uses continuous DOF), increased compatibility (joystickâ€‘like mapping).\n\nConclusion and Future WorkÂ ï¿¼\n\nInstrumental Interaction generalizes Direct Manipulation by treating commands as reified instruments acting on firstâ€‘class domain objects, supplying comparative properties (indirection, integration, compatibility) that describe a continuum from indirect to direct manipulation and a generative design space. Future work: deeper analyses of graphical techniques, additional evaluative properties, taxonomies of instruments, exploration of the design space, and principles for instrument creation/integration. A toolkit grounded in the model would aid developers in adopting novel techniques and accelerate the shift from WIMP to postâ€‘WIMP interfaces.\n\nReferencesÂ ï¿¼\n\n1. Ahlberg et al., Dynamic Queries for Information Exploration, CHI â€™92.\n\n2. Apple Computer, Macintosh Human Interface Guidelines, 1992.\n\n3. Bederson & Hollan, Pad++: A Zooming Graphical Interface, UIST â€™94.\n\n4. Bederson et al., Local Tools: an Alternative to Tool Palettes, UIST â€™94.\n\n5. Bier et al., Toolglass and Magic Lenses, SIGGRAPH â€™93.\n\n6. BÃ¸dker, Through the Interface, 1991.\n\n7. Card et al., Morphological Analysis of Input Devices, TOIS 1991.\n\n8. Card et al., Readings in Information Visualization, 1998.\n\n9. Card et al., The Information Visualizer, CHI â€™91.\n\n10. Fitzmaurice et al., Graspable User Interfaces, CHI â€™95.\n\n11. Foley et al., Human Factors of Graphics Interaction Techniques, 1984.\n\n12. Gram & Cockton, Design Principles for Interactive Software, 1996.\n\n13. Guiard, Asymmetric division of labor in bimanual action, 1987.\n\n14. Heller et al., Motif Programming Manual, 1994.\n\n15. Holland & Oppenheim, Direct Combination, CHI â€™99.\n\n16. Jacob & Oliver, Specifying 3D Rotations with a 2D Device, HCI â€™95.\n\n17. Jacob et al., Integrability and Separability of Input Devices, TOCHI 1994.\n\n18. Krasner & Pope, MVC paradigm in Smalltalkâ€‘80, JOOP 1988.\n\n19. Kurtenbach & Buxton, Marking Menus, CHI â€™94.\n\n20. Kurtenbach et al., GUI paradigm with tablets/twoâ€‘hands/transparency, CHI â€™97.\n\n21. Kurtenbach et al., The Hotbox, CHI â€™99.\n\n22. Michotte, La perception de la causalitÃ©, 1946.\n\n23. Myers, A New Model for Handling Input, TOIS 1990.\n\n24. Myers, User Interface Software Tools, TOCHI 1995.\n\n25. Robertson & Mackinlay, The Document Lens, UIST â€™93.\n\n26. Shneiderman, Direct Manipulation, IEEE Computer 1983.\n\n27. Smith et al., Designing the Star User Interface, Byte 1982.\n\n28. Szekely et al., Modelâ€‘Based Interface Tools, INTERCHI â€™93.\n\n29. Took, Surface Interaction, CHI â€™90.\n\n30. Wellner et al., Computerâ€‘Augmented Environments, CACM.\n",
        "skills/macos-app-design/SKILL.md": "---\nname: macos-app-design\ndescription: Use when designing or building native macOS applications with SwiftUI or AppKit. Triggers on menu bar structure, keyboard shortcuts, multi-window behavior, Liquid Glass design system, macOS Tahoe/Sequoia, sidebar navigation, toolbar design, app icons, SF Symbols, or making an app feel like a \"good Mac citizen.\"\n---\n\n# macOS App Design & Development\n\nGuide for designing and implementing native-feeling, \"good Mac citizen\" apps: fast, elegant, accessible, and deeply integrated with macOS workflows.\n\n## Two Rules That Beat Everything Else\n\n1. **Prefer system components and conventions** over bespoke UIâ€”fastest path to \"feels right on Mac\"\n2. **If you customize bars, backgrounds, borders, or control chrome**: stop and justify it\n\n## Quick Reference: Mac Citizen Checklist\n\n| Area | Requirement |\n|------|-------------|\n| **Menu Bar** | Standard layout (App/File/Edit/View/Window/Help), âŒ˜, for Settings |\n| **Keyboard** | Every primary command reachable via keyboard, standard shortcuts work |\n| **Windows** | Resize fluidly, support multiple windows, respect fullscreen/minimize |\n| **Sidebars** | Top-level navigation, scannable items, content extends behind |\n| **Toolbars** | Group by function/frequency, demote secondary to \"more\" menu |\n| **Text** | Use system text components, standard editing behaviors |\n| **Accessibility** | VoiceOver labels, full keyboard navigation, Reduced Motion support |\n\n## Liquid Glass Quick Rules\n\n**Do:**\n- Use for navigation/controls layer (toolbars, sidebars, bars)\n- Let system components provide built-in behaviors\n\n**Don't:**\n- Apply to content layer (tables, lists, document content)\n- Stack \"glass on glass\"\n\n## App Archetypes\n\nIdentify your app type first:\n- **Document-based**: Files as primary units (open/save/duplicate)\n- **Library + editor**: Sidebar lists items, detail in main area\n- **Utility**: Single window, optional menu bar\n- **Menu-bar app**: Lives in menu bar, minimal UI\n- **Pro tool**: Dense, power-user workflows\n\n## Deliverables Before Building\n\n1. **App archetype** identified\n2. **Information architecture** (sidebar structure, navigation, window model)\n3. **Command map** (menus + keyboard shortcuts for every major feature)\n4. **State + data model** (persistence, undo/redo, concurrency)\n5. **Accessibility plan** (VoiceOver, keyboard, contrast, reduce motion)\n\n## Full Reference\n\nFor complete design system details, Icon Composer workflow, SF Symbols guidance, evaluation rubrics, and Definition of Done checklist:\n\nSee: [references/macos-design-guide.md](references/macos-design-guide.md)\n\n## Common Mistakes\n\n| Mistake | Fix |\n|---------|-----|\n| Missing menu bar commands | Every feature in menus with keyboard shortcuts |\n| Settings outside App menu | Always âŒ˜, opening from App menu |\n| Custom text components | Use system text for Mac editing ecosystem |\n| Toolbar overload | Demote secondary actions, group by function |\n| Glass on content | Reserve Liquid Glass for navigation layer only |\n| Breaking standard shortcuts | Never override âŒ˜C, âŒ˜V, âŒ˜Z, etc. |\n| Single-window only | Support multiple windows when it benefits workflows |\n",
        "skills/macos-app-design/references/macos-design-guide.md": "# World-Class macOS App Design & Build Guide\n\nComplete reference for designing and implementing native macOS apps.\n\n## 1) Quality Bar: What \"World-Class\" Means\n\n### \"Good Mac Citizen\" Test\n\nMac excellence is less about toolkit and more about embracing Mac conventions:\n- Menus and keyboard shortcuts\n- Window management and services\n- Text behaviors and preferences\n\n### Performance is Non-Negotiable\n\n**Practical sanity test:** Open a large document, scroll hard, resizeâ€”must stay fast and responsive (\"Moby Dick\" test).\n\n### Apple Design Awards Rubric\n\nUse these categories for evaluation:\n- **Delight and Fun**: Satisfying micro-interactions\n- **Inclusivity**: VoiceOver, keyboard-only, reduced motion\n- **Innovation**: Platform tech for meaningful improvement\n- **Interaction**: Effortless, tailored to macOS workflows\n- **Visuals and Graphics**: Cohesive iconography/typography\n- **Social Impact**: Accessibility, broad user benefit\n\n---\n\n## 2) Liquid Glass Design System (macOS Tahoe 26+)\n\nApple's visual refresh built on **Liquid Glass**â€”translucent, dynamic material that reflects/refracts surroundings.\n\n### What Liquid Glass Is\n\nA \"digital meta-material\" that dynamically bends light and behaves fluidly. Reserved primarily for the **navigation/controls layer** floating above content.\n\n### Where to Use Liquid Glass\n\n**Do:**\n- Navigation/controls (toolbars, sidebars, bars, key UI chrome)\n- Let system components provide built-in behaviors (focus changes, shadowing, interaction glow)\n\n**Don't:**\n- Content layer (tables, lists, documents)â€”muddies hierarchy\n- \"Glass on glass\" stackingâ€”gets cluttered\n\n### Accessibility Adaptations\n\nLiquid Glass automatically adapts to:\n- **Reduced Transparency**\n- **Increased Contrast**\n- **Reduced Motion**\n\nYour app must remain usable with these settings enabled.\n\n### New Design System Rules\n\n- **Remove decorative backgrounds/borders** you added for emphasis\n- Express hierarchy via **layout and grouping**, not decoration\n- **Crowded toolbar** = signal to remove or demote actions\n- Group bar items **by function and frequency**\n- Avoid grouping text button + icon button (reads as one control)\n\n---\n\n## 3) macOS-Native IA & UI Patterns\n\n### 3.1 Menu Bar: Your Command Center\n\n**Required baseline:**\n- Standard menu layout: **App / File / Edit / View / Window / Help** (+ Format if relevant)\n- **Settingsâ€¦** in App menu with **âŒ˜,** behavior\n- Menu items enable/disable based on focus/selection\n\n**SwiftUI implementation:**\n- Use `commands` in App, add via `CommandMenu` / `CommandGroup`\n- Keyboard shortcuts and discoverability come \"for free\"\n\n**World-class touches:**\n- Help menu with real help content\n- Menu organization reflecting user workflows\n- Primary tasks near top, destructive tasks grouped and labeled\n\n### 3.2 Keyboard Shortcuts and Full Keyboard Workflows\n\n**Non-negotiable:**\n- Every primary command reachable via keyboard\n- Standard shortcuts behave normally (âŒ˜C, âŒ˜V, âŒ˜Z, âŒ˜F, âŒ˜N, âŒ˜O)\n\n**World-class:**\n- Proper tabbing and focus rings on custom controls\n- Command palette *in addition* to menus (not instead)\n\n### 3.3 Windows: Multi-Window Platform\n\n**Choose window model for archetype:**\n- **Document-based**: Files as primary units, open/save/duplicate/revert\n- **Library + detail**: Sidebar lists items, detail/editor in main area\n- **Utility**: Lightweight single window, optional menu bar\n\n**Required:**\n- Window resizing as first-class interactionâ€”layouts fluidly adapt\n- Responsive under resize\n\n**World-class:**\n- Multiple windows showing different content (or views of same)\n- Respect close/minimize/zoom/toolbar/titlebar, tabbing, fullscreen\n\n### 3.4 Sidebars: Structure, Navigation, Context\n\nmacOS sidebars refract/reflect content behind them while maintaining context.\n\n**Do:**\n- Top-level navigation with clear hierarchy\n- Scannable, stable items (users build muscle memory)\n- Let content extend beneath/behind sidebars\n\n**Don't:**\n- Overload with dense controlsâ€”use inspectors/toolbars for actions\n\n### 3.5 Toolbars and Bar Content\n\n**New system encourages:**\n- Remove custom backgrounds/borders\n- Group by function/frequency\n- Demote secondary actions to \"more\" menu\n- Primary action visually distinct (often tinted)\n\n### 3.6 Text System Behavior\n\n**Users expect:**\n- Standard text shortcuts and behaviors\n- Correct selection rules\n- Undo/redo\n- Services menu integration\n- Context menu items\n\n**Practical rule:** Use system text components to inherit Mac editing ecosystem.\n\n### 3.7 Services, Share, System Integrations\n\nA \"Mac citizen\" participates in:\n- **Services menu** integrations\n- Standard share flows\n- Drag & drop, copy/paste\n- Quick Look previews (document/media apps)\n\n---\n\n## 4) Visual Language\n\n### 4.1 Typography and Layout\n\n- Prefer system text styles and default spacing\n- Adjust only for hierarchy and readability\n- Design for large displays, resizable windows, dense information, long sessions\n\n### 4.2 Color and Materials\n\nUse system colors/materials for automatic adaptation to:\n- Light/dark environments\n- User customization (accent colors, increased contrast)\n\nBrand through content, iconography, subtle accentsâ€”not by replacing system structure.\n\n### 4.3 App Icons: Modern, Layered, Multi-Appearance\n\nNew look includes multi-layer Liquid Glass-crafted icons with personalization (light/dark, tints, \"clear\" look).\n\n#### Icon Composer Workflow\n\n**Tool requirements:** macOS Sequoia 15.3+\n\n**Canvas sizes:**\n- macOS/iPhone/iPad: 1024px\n- Watch: 1088px (optically larger)\n\n**Workflow:**\n1. Design as layersâ€”keep source art flat and controllable\n2. Add dynamic glass properties in Icon Composer (not baked in)\n3. Export vectors as **SVG**, complex assets as **PNG**\n4. Convert text to outlines if needed\n5. Don't export enclosure mask (system applies cropping)\n\n**Layer groups:** Up to **4 groups/layers** of glass complexity (intentional limit)\n\n**Appearances supported:**\n- Default, Dark\n- Clear (light/dark)\n- Tinted (light/dark)\n\n**Mono legibility:** Set at least one key element to white, tune conversion for contrast.\n\n**Pitfalls:**\n- Highly translucent art becomes unclear in monochrome\n- Watch blur/gradients and detail at small sizes\n\n### 4.4 SF Symbols\n\n**SF Symbols 7:**\n- 6,900+ symbols aligned with San Francisco typeface\n- Multiple weights/scales\n- Draw animations and annotation tools\n- Variable rendering, gradients, Magic Replace\n- Requires macOS Sonoma+ to run app\n\n**Guideline:** Use SF Symbols for system concepts. Only design custom symbols when domain requiresâ€”keep them SF-like and accessible.\n\n### 4.5 Motion and Micro-Interactions\n\nMotion communicates hierarchy and responsiveness:\n- Clarify state change, focus, hierarchy, transitions\n- Respect Reduced Motion (system adapts Liquid Glass; your custom animations must too)\n- Subtle, high-quality over flashy\n\n---\n\n## 5) Accessibility and Inclusive Design\n\n**Design in, not added later.**\n\n### Baseline Requirements\n\n| Area | Requirement |\n|------|-------------|\n| **VoiceOver** | Meaningful labels/values/hints for every interactive element |\n| **Keyboard** | Everything operable without mouse/trackpad |\n| **Contrast** | Readable in light/dark and increased contrast modes |\n| **Reduce Motion** | UI usable and understandable with setting enabled |\n| **Reduce Transparency** | UI remains functional |\n| **Localization** | Layouts handle longer strings, different writing systems |\n\n### Inclusive Craft Moves\n\n- Don't encode meaning by color alone\n- Redundancy: icon + label, shape + color, text + sound\n- Reduce cognitive load: clear IA, consistent terminology, predictable controls\n\n---\n\n## 6) Engineering for Excellence\n\n### 6.1 Architecture\n\n- Clear separation between **domain model** and **UI state**\n- Concurrency keeping UI responsive (avoid blocking main thread)\n- Deliberate **undo/redo** strategy, document/versioning, autosave\n\n**Pattern:** Define internal \"app intents\" (command model) so UI, menus, shortcuts, toolbar all invoke same code paths.\n\n### 6.2 SwiftUI vs AppKit\n\n**Prefer SwiftUI** for new appsâ€”faster iteration, modern patterns.\n\n**Drop to AppKit when:**\n- Advanced text editing matching macOS standards\n- Deep window customization unavailable in SwiftUI\n- Certain pro-workflow integrations\n\n**Rule:** If using AppKit, keep bridging layer thin and well-tested.\n\n### 6.3 Performance Discipline\n\nRepeatable checklist:\n- Large-file open, scroll, resize test\n- Memory sanity: no unbounded caches, retain cycles; windows close cleanly\n- Smooth interaction: scrolling/resizing responsive\n\n### 6.4 Fit and Finish Features\n\nWorld-class apps include:\n- Fully functional menu structure + shortcuts\n- Native-feeling Settings (âŒ˜,)\n- Window tabbing support and multi-window\n- Help content\n- Scriptability/automation hooks\n- Respect for user preferences (appearance, accent colors)\n\n---\n\n## 7) ADA-Inspired Evaluation Rubric\n\nUse as release gate:\n\n### Delight and Fun\n- [ ] Satisfying micro-interactions enhancing understanding?\n- [ ] Feels \"alive\" in restrained, high-quality way?\n\n### Inclusivity\n- [ ] VoiceOver user can complete core workflow?\n- [ ] Keyboard-only user can do everything?\n- [ ] Reduced motion/transparency preserves usability?\n\n### Interaction\n- [ ] Control effortless and tailored to macOS workflows?\n\n### Visuals and Graphics\n- [ ] UI cohesive with consistent iconography/typography?\n- [ ] SF Symbols used appropriately, custom symbols match system?\n\n### Innovation (Differentiating)\n- [ ] Leveraging platform tech for meaningfully better experience?\n\n---\n\n## 8) Definition of Done Checklist\n\n### Mac Citizen Essentials\n\n- [ ] Standard menu bar structure; key commands discoverable\n- [ ] Settings opens via âŒ˜, with native Mac feel\n- [ ] Undo/redo works reliably\n- [ ] Copy/paste/selection behave normally in text surfaces\n- [ ] Multi-window behavior sensible; resizing robust and fast\n\n### Liquid Glass Readiness\n\n- [ ] Custom bars/backgrounds removed unless strongly justified\n- [ ] Liquid Glass for functional/navigation layers; content clear\n- [ ] \"Glass on glass\" stacking avoided\n\n### Icon + Branding\n\n- [ ] App icon modern and layered (Icon Composer), tested across appearances\n- [ ] SF Symbols for standard concepts; custom symbols SF-consistent and accessible\n\n### Accessibility\n\n- [ ] VoiceOver labels/hints for all interactive elements\n- [ ] Full keyboard navigation supported\n- [ ] Reduced motion/transparency/increased contrast tested\n\n### Performance & Stability\n\n- [ ] Large-document / heavy-data scenarios responsive\n- [ ] No major UI hitches while scrolling/resizing\n\n---\n\n## 9) Source References\n\n**Apple Official:**\n- [Apple Newsroom - Design Update](https://www.apple.com/newsroom/2025/06/apple-introduces-a-delightful-and-elegant-new-software-design/)\n- [WWDC25: Meet Liquid Glass](https://developer.apple.com/videos/play/wwdc2025/219/)\n- [WWDC25: Get to know the new design system](https://developer.apple.com/videos/play/wwdc2025/356/)\n- [WWDC25: New look of app icons](https://developer.apple.com/videos/play/wwdc2025/220/)\n- [WWDC25: Create icons with Icon Composer](https://developer.apple.com/videos/play/wwdc2025/361/)\n- [SF Symbols](https://developer.apple.com/sf-symbols/)\n- [Icon Composer](https://developer.apple.com/icon-composer/)\n- [Apple Design Resources](https://developer.apple.com/design/resources/)\n- [Apple Design Awards](https://developer.apple.com/design/awards/)\n\n**Community:**\n- [App Feel on Mac](https://coyotetracks.org/blog/app-feel-on-mac/)\n- [Best in Class macOS App](https://swiftjectivec.com/What-does-a-best-in-class-macOS-app-look-like/)\n- [The macOS App Icon Book](https://flarup.shop/products/the-macos-app-icon-book)\n",
        "skills/manual-testing/SKILL.md": "---\nname: manual-testing\ndescription: Guide users step-by-step through manually testing whatever is currently being worked on. Use when asked to \"test this\", \"verify it works\", \"let's test\", \"manual testing\", \"QA this\", \"check if it works\", or after implementing a feature that needs verification before proceeding.\n---\n\n# Manual Testing\n\nVerify current work through automated testing first, falling back to user verification only when necessary.\n\n## Core Principle\n\n**Automate everything possible.** Only ask the user to manually verify what Claude cannot verify through tools.\n\n## Workflow\n\n### 1. Analyze Current Context\n\nExamine recent work to identify what needs testing:\n- Review recent file changes and conversation history\n- Identify the feature, fix, or change to verify\n- Determine testable behaviors and expected outcomes\n\n### 2. Classify Each Verification Step\n\nFor each thing to verify, determine if Claude can test it automatically:\n\n**Claude CAN verify (do these automatically):**\n- Code compiles/builds: `npm run build`, `cargo build`, `go build`, etc.\n- Tests pass: `npm test`, `pytest`, `cargo test`, etc.\n- Linting/type checking: `eslint`, `tsc --noEmit`, `mypy`, etc.\n- API responses: `curl`, `httpie`, or scripted requests\n- File contents: Read files, grep for expected patterns\n- CLI tool output: Run commands and check output\n- Server starts: Start server, check for errors, verify endpoints respond\n- Database state: Query databases, check records exist\n- Log output: Tail logs, grep for expected/unexpected messages\n- Process behavior: Check exit codes, stdout/stderr content\n- File existence/permissions: `ls`, `stat`, `test -f`\n- JSON/config validity: Parse and validate structure\n- Port availability: `lsof`, `netstat`, curl localhost\n- Git state: Check diffs, commits, branch state\n\n**Claude CANNOT verify (ask user):**\n- Visual appearance (colors, layout, spacing, alignment)\n- Animations and transitions\n- User experience feel (responsiveness, intuition)\n- Cross-browser rendering\n- Mobile device behavior\n- Physical hardware interaction\n- Third-party service UIs (OAuth flows, payment forms)\n- Accessibility with actual screen readers\n- Performance perception (feels fast/slow)\n\n### 3. Execute Automated Verifications\n\nRun all automatable checks first. Be thorough:\n\n```bash\n# Example: Testing a web feature\nnpm run build          # Compiles?\nnpm run lint           # No lint errors?\nnpm test               # Tests pass?\nnpm run dev &          # Server starts?\nsleep 3\ncurl localhost:3000/api/endpoint  # API responds correctly?\n```\n\nReport results as you go. If automated tests fail, stop and address before asking user to verify anything.\n\n### 4. User Verification (Only When Necessary)\n\nFor steps Claude cannot automate, present them sequentially with selectable outcomes:\n\n```\nStep N of M: [Brief description]\n\n**Action:** [Specific instruction - what to do]\n\n**Expected:** [What should happen if working correctly]\n```\n\nThen use AskUserQuestion with predicted outcomes:\n- 2-4 most likely outcomes as selectable options\n- First option: expected/success outcome\n- Remaining options: common failure modes\n- Free-text \"Other\" option is provided automatically\n\n**Example:**\n```json\n{\n  \"questions\": [{\n    \"question\": \"How does the button look?\",\n    \"header\": \"Visual check\",\n    \"options\": [\n      {\"label\": \"Looks correct\", \"description\": \"Blue button, proper spacing, readable text\"},\n      {\"label\": \"Wrong color/style\", \"description\": \"Button exists but styling is off\"},\n      {\"label\": \"Layout broken\", \"description\": \"Elements overlapping or misaligned\"},\n      {\"label\": \"Not visible\", \"description\": \"Button missing or hidden\"}\n    ],\n    \"multiSelect\": false\n  }]\n}\n```\n\n### 5. Handle Results\n\n**Automated test fails:** Stop and fix before proceeding.\n\n**User reports issue:** Note it, ask if they want to investigate now or continue testing.\n\n### 6. Summarize\n\nAfter all steps complete:\n- List what was verified automatically (with pass/fail)\n- List what user verified (with results)\n- Summarize any issues found\n- Recommend next actions\n\n## Guidelines\n\n- Run automated checks in parallel when possible\n- Be creative with verificationâ€”most things can be tested programmatically\n- If unsure whether something can be automated, try it first\n- Keep user verification steps minimal and focused on truly visual/experiential checks\n",
        "skills/model-first-reasoning/SKILL.md": "---\nname: model-first-reasoning\ndescription: Apply Model-First Reasoning (MFR) to code generation tasks. Use when the user requests \"model-first\", \"MFR\", \"formal modeling before coding\", \"model then implement\", or when tasks involve complex logic, state machines, constraint systems, or any implementation requiring formal correctness guarantees. Enforces strict separation between modeling and implementation phases.\n---\n\n# Model-First Reasoning (MFR)\n\nA rigorous methodology that REQUIRES constructing an explicit problem MODEL before any reasoning or implementation. The model becomes a frozen contract that governs all downstream work.\n\n> Based on Kumar & Rana (2025), \"Model-First Reasoning LLM Agents: Reducing Hallucinations through Explicit Problem Modeling\" (arXiv:2512.14474)\n\n## Why MFR Works\n\n**Hallucination is not merely the generation of false statementsâ€”it is a symptom of reasoning performed without a clearly defined model of the problem space.**\n\nReasoning does not create structure; it operates on structure. When that structure is implicit or unstable, reasoning becomes unreliable. MFR provides \"soft symbolic grounding\"â€”enough structure to stabilize reasoning without imposing rigid formalism.\n\n## Core Principle\n\n**Phase 1 produces the MODEL. Phase 2 reasons/implements ONLY within the model.**\n\nThis prevents the common failure mode where reasoning introduces ad-hoc decisions, missing constraints, or invented behavior not grounded in the problem definition.\n\n## Non-Negotiable Rules\n\n1. **Phase 1 (Model)** produces NO code, no solution stepsâ€”only the formal model\n2. **Phase 2 (Implement)** may NOT introduce new entities, state, actions, or constraints\n3. If you need something not in the model: output exactly `MODEL INCOMPLETE` + what to add, then STOP\n4. No invented APIs or dependencies. If not provided, either ask (unknowns) or create a stub clearly marked `STUB`\n\n## The Model as Contract\n\nAfter creating the model, run a **MODEL AUDIT** before coding:\n\n### Audit Checks\n\n| Check | Description |\n|-------|-------------|\n| **Coverage** | Every user requirement is represented in exactly one of: a constraint, the goal/acceptance criteria, or an action precondition/effect |\n| **Operability** | Every operation your plan would require is present as an action |\n| **Consistency** | Constraints don't contradict each other; action effects don't violate invariants |\n| **Testability** | Every constraint has â‰¥1 test oracle |\n\nIf any audit check fails, revise the model (still Phase 1) until it passes.\n\n## Freeze Rule\n\nOnce the audit passes, treat the model as **read-only source of truth**.\n\nIf later you discover missing info during implementation:\n1. Emit a `MODEL PATCH` (minimal change)\n2. Restart Phase 2 from scratch using the updated model\n\n## Validation\n\nAfter creating the model, write it to `model.json` and run the validator:\n\n```bash\npython scripts/validate-model.py model.json\n```\n\nExit codes:\n- `0` = Valid, ready for Phase 2\n- `1` = Invalid structure (fix and retry)\n- `2` = Valid but has unknowns (STOP after Phase 1)\n\n## Output Format\n\n### Phase 1: MODEL\n\nThe model may be expressed in natural language, semi-structured text, or JSON. Flexibility improves complianceâ€”what matters is that the representation is **explicit, inspectable, and stable**.\n\nFor code generation tasks, the structured format below is recommended. Use [MODEL_TEMPLATE.json](MODEL_TEMPLATE.json) as a reference:\n\n```json\n{\n  \"deliverable\": {\n    \"description\": \"What we're building\",\n    \"files_expected\": [\"path/to/file.ts\", ...]\n  },\n  \"entities\": [\n    {\"name\": \"EntityName\", \"description\": \"...\", \"properties\": [...]}\n  ],\n  \"state_variables\": [\n    {\"name\": \"varName\", \"type\": \"...\", \"initial\": \"...\", \"description\": \"...\"}\n  ],\n  \"actions\": [\n    {\n      \"name\": \"actionName\",\n      \"description\": \"...\",\n      \"preconditions\": [\"...\"],\n      \"effects\": [\"...\"],\n      \"parameters\": [...]\n    }\n  ],\n  \"constraints\": [\n    {\"id\": \"C1\", \"statement\": \"...\", \"type\": \"invariant|precondition|postcondition\"}\n  ],\n  \"initial_state\": [\"description of starting conditions\"],\n  \"goal\": [\"acceptance criteria\"],\n  \"assumptions\": [\"things we assume to be true\"],\n  \"unknowns\": [\"questions that must be answered before proceeding\"],\n  \"requirement_trace\": [\n    {\n      \"requirement\": \"<verbatim from user>\",\n      \"represented_as\": \"goal|constraint|action\",\n      \"ref\": \"C1|action_name|goal_item\"\n    }\n  ],\n  \"test_oracles\": [\n    {\"id\": \"T1\", \"maps_to\": [\"C1\"], \"description\": \"how to verify constraint\"}\n  ]\n}\n```\n\n**Critical**: If `unknowns` is non-empty, STOP after Phase 1. Do not implement until unknowns are resolved.\n\n### Phase 1.5: MODEL AUDIT\n\nReturn:\n\n```json\n{\n  \"audit_pass\": true|false,\n  \"issues\": [\n    {\"type\": \"coverage|operability|consistency|testability\", \"detail\": \"...\"}\n  ]\n}\n```\n\nIf `audit_pass` is false, STOP and return to Phase 1 to revise the model.\n\n### Phase 2: IMPLEMENTATION\n\nUsing ONLY the frozen model:\n\n#### A) PLAN\n\nNumbered steps where each step must be an instance of a defined action:\n\n```\nStep 1: [action_name]\n  - Preconditions check: [list which preconditions are satisfied]\n  - Effects applied: [what state changes]\n  - Constraints check: [C1, C2, ...]\n```\n\n#### B) CODE\n\nCreate all files in `deliverable.files_expected`:\n\n| Model Element | Code Translation |\n|---------------|------------------|\n| entities / state_variables | Types, interfaces, data models |\n| actions | Functions/modules with validation + explicit failure modes |\n| constraints | Runtime checks, defensive parsing, invariants |\n\n#### C) TESTS\n\nImplement all `test_oracles`. Every constraint must be covered by â‰¥1 test.\n\n#### D) VERIFICATION MAP\n\nFor each constraint, document:\n- Where it is enforced in code (file:line)\n- Which tests cover it\n\n## When to Use MFR\n\nMFR is most valuable for:\n\n- **Complex state machines** â€” where transitions must be valid\n- **Business logic with invariants** â€” rules that must never be violated\n- **Data transformations** â€” where input/output contracts matter\n- **Multi-step workflows** â€” with dependencies between steps\n- **Safety-critical features** â€” where bugs have high cost\n- **Collaborative specifications** â€” where the model serves as documentation\n\n**When NOT to use:** Simple, single-step tasks where the overhead of explicit modeling exceeds its benefit.\n\n## Relationship to Other Reasoning Strategies\n\nMFR is **complementary**, not competing:\n\n- **With Chain-of-Thought**: Use CoT within Phase 2 for step-by-step reasoning over the model\n- **With ReAct**: Treat the model as persistent state that actions operate on\n- **With planning agents**: The model provides the domain specification that planners reason over\n\nMFR provides a foundational layer that improves robustness of any reasoning strategy in constraint-heavy domains.\n\n## Example Workflow\n\n```\nUser: Build a shopping cart that enforces: max 10 items, no duplicate SKUs,\n      total can't exceed $1000\n\nYou: [PHASE 1: MODEL]\n{\n  \"entities\": [\n    {\"name\": \"CartItem\", \"properties\": [\"sku\", \"price\", \"quantity\"]}\n  ],\n  \"constraints\": [\n    {\"id\": \"C1\", \"statement\": \"cart.items.length <= 10\", \"type\": \"invariant\"},\n    {\"id\": \"C2\", \"statement\": \"all SKUs in cart are unique\", \"type\": \"invariant\"},\n    {\"id\": \"C3\", \"statement\": \"sum(items.price * items.quantity) <= 1000\", \"type\": \"invariant\"}\n  ],\n  \"actions\": [\n    {\n      \"name\": \"addItem\",\n      \"preconditions\": [\"cart.items.length < 10\", \"sku not in cart\", \"new total <= 1000\"],\n      \"effects\": [\"item added to cart\"]\n    }\n  ],\n  ...\n}\n\n[PHASE 1.5: MODEL AUDIT]\n{\n  \"audit_pass\": true,\n  \"issues\": []\n}\n\n[PHASE 2: IMPLEMENTATION]\n// Now implementing strictly from the model...\n```\n\n## Remember\n\nThe model is not overheadâ€”it IS the specification. Most failures in complex reasoning are **representational, not inferential**: the reasoning was fine, but it operated on an incomplete or unstable understanding of the problem.\n\nBy externalizing the model, we make assumptions inspectable, constraints enforceable, and errors diagnosable. The model becomes the contract between intent and implementation.\n\n**Model first. Then reason. Never invert this.**\n",
        "skills/optimize-agent-docs/SKILL.md": "---\nname: optimize-agent-docs\ndescription: Build a retrieval-optimized knowledge layer over agent documentation in dotfiles (.claude, .codex, .cursor, .aider). Use when asked to \"optimize docs\", \"improve agent knowledge\", \"make docs more efficient\", or when documentation has accumulated and retrieval feels inefficient. Generates a manifest mapping task-contexts to knowledge chunks, optimizes information density, and creates compiled artifacts for efficient agent consumption.\n---\n\n# Agent Knowledge Optimizer\n\nTransform accumulated documentation into a retrieval-optimized knowledge system.\n\n## Core Principle\n\nFile organization is a human concern. Agents don't browseâ€”they search and load. Optimize for:\n- **Discovery**: What knowledge exists?\n- **Relevance**: Is it needed for this task?\n- **Efficiency**: What's the minimum to load?\n\n## Workflow\n\n### Phase 1: Knowledge Extraction\n\nInventory all agent documentation:\n\n```bash\n# Find all agent doc sources\nfind . -maxdepth 2 -name \"*.md\" -path \"*/.claude/*\" -o \\\n       -name \"*.md\" -path \"*/.codex/*\" -o \\\n       -name \"*.md\" -path \"*/.cursor/*\" -o \\\n       -name \"CLAUDE.md\" -o -name \"AGENTS.md\" -o -name \"INSTRUCTIONS.md\"\n```\n\nFor each file, extract:\n- Discrete facts (single pieces of actionable information)\n- Instructions (procedures, rules, constraints)\n- Context triggers (when is this knowledge needed?)\n\n### Phase 2: Chunk Analysis\n\nBreak content into **retrieval units**â€”the smallest self-contained piece of information that makes sense alone.\n\nGood chunk:\n```\n## Adding API Endpoints\n1. Create handler in src/handlers/\n2. Register route in src/routes.rs\n3. Add OpenAPI spec to docs/api.yaml\n```\n\nBad chunk (too coupled):\n```\nSee the API section for endpoint patterns, but first read the auth docs,\nwhich reference the middleware guide...\n```\n\nScore each chunk:\n- **Self-contained?** Can agent act on this without loading more?\n- **Task-specific?** Clear when this is needed?\n- **Information-dense?** High signal per token?\n\n### Phase 3: Build Knowledge Manifest\n\nGenerate `.claude/KNOWLEDGE.md`â€”a lightweight index the agent reads first:\n\n```markdown\n# Knowledge Manifest\n\n## Task â†’ Knowledge Map\n\n| When working on... | Load | Key terms |\n|-------------------|------|-----------|\n| API endpoints | references/api.md | route, handler, endpoint |\n| Authentication | references/auth.md | token, session, login |\n| Database changes | references/schema.md | migration, model, query |\n| Testing | references/testing.md | spec, fixture, mock |\n| Deployment | references/deploy.md | release, staging, prod |\n\n## Quick Reference\n\n### Build Commands\n- `npm run dev` â€” Start dev server (port 3000)\n- `npm test` â€” Run test suite\n- `npm run build` â€” Production build\n\n### Key Paths\n- Handlers: `src/handlers/`\n- Routes: `src/routes.ts`\n- Tests: `tests/`\n\n### Critical Rules\n- Never commit .env files\n- All PRs require tests\n- Use conventional commits\n```\n\nThe manifest contains:\n1. **Taskâ†’Knowledge map**: What to load for what context\n2. **Quick reference**: High-frequency facts (no file loading needed)\n3. **Critical rules**: Must-know constraints (always relevant)\n\n### Phase 4: Compile Optimized Artifacts\n\nTransform verbose source docs into dense, agent-optimized versions.\n\n**Compression techniques:**\n\n| Source (verbose) | Compiled (dense) |\n|-----------------|------------------|\n| \"When you want to add a new endpoint, you should first create a handler function...\" | `New endpoint: handler â†’ route â†’ spec` |\n| Long prose paragraphs | Structured tables |\n| Repeated information | Single source of truth |\n| Examples with explanation | Just the pattern |\n\n**Output structure:**\n\n```\n.claude/\nâ”œâ”€â”€ CLAUDE.md              # Human-readable, can stay verbose\nâ”œâ”€â”€ KNOWLEDGE.md           # Agent manifest (generated)\nâ””â”€â”€ compiled/              # Agent-optimized versions (generated)\n    â”œâ”€â”€ api.md             # Dense API reference\n    â”œâ”€â”€ patterns.md        # Code patterns as templates\n    â””â”€â”€ rules.md           # All constraints in one place\n```\n\n### Phase 5: Generate Retrieval Hints\n\nAdd grep-friendly markers throughout compiled docs:\n\n```markdown\n<!-- @task:new-endpoint @load:api,routes -->\n## Adding Endpoints\n\n<!-- @task:fix-auth @load:auth,middleware -->\n## Authentication Flow\n\n<!-- @task:write-test @load:testing -->\n## Test Patterns\n```\n\nThese markers enable:\n```bash\n# Find relevant sections for a task\ngrep -l \"@task:new-endpoint\" .claude/compiled/*.md\n```\n\n### Phase 6: Validation\n\nTest the optimized system:\n\n1. **Coverage check**: Every fact from source exists in compiled output\n2. **Retrieval test**: Can common tasks be served with minimal loading?\n3. **Density check**: Compiled versions smaller than sources?\n\n```bash\n# Compare sizes\nwc -l .claude/references/*.md    # Source\nwc -l .claude/compiled/*.md       # Compiled (should be smaller)\n```\n\n## Manifest Format\n\nThe `KNOWLEDGE.md` manifest follows this structure:\n\n```markdown\n# Knowledge Manifest\n<!-- Auto-generated. Source: .claude/references/, CLAUDE.md -->\n\n## Task Context Map\n<!-- What to load based on current work -->\n\n| Context | Load | Search |\n|---------|------|--------|\n| [task description] | [file path] | [grep terms] |\n\n## Always-Loaded Facts\n<!-- High-frequency, never needs file lookup -->\n\n### Commands\n[Most-used commands as a table]\n\n### Paths\n[Key directories and their purposes]\n\n### Rules\n[Critical constraints that always apply]\n\n## Chunk Index\n<!-- What exists and where -->\n\n| Topic | Location | Lines | Summary |\n|-------|----------|-------|---------|\n| [topic] | [file:line-range] | [count] | [one-line summary] |\n```\n\n## Information Density Principles\n\n### Convert Prose to Structure\n\nBefore:\n> \"The authentication system uses JWT tokens stored in httpOnly cookies.\n> When a user logs in, the server validates credentials against the database,\n> generates a token with a 24-hour expiry, and sets it as a cookie...\"\n\nAfter:\n```\n## Auth Flow\n- Method: JWT in httpOnly cookie\n- Expiry: 24h\n- Flow: credentials â†’ DB validate â†’ token â†’ cookie\n```\n\n### Eliminate Redundancy\n\nIf the same information appears in multiple places, create one canonical source and reference it:\n\n```markdown\n## Token Handling\nSee: [Auth Flow](#auth-flow) â€” tokens section\n```\n\n### Prefer Tables Over Lists\n\nBefore:\n```markdown\n- The API endpoint for users is /api/users\n- The API endpoint for posts is /api/posts\n- The API endpoint for comments is /api/comments\n```\n\nAfter:\n```markdown\n| Resource | Endpoint |\n|----------|----------|\n| Users | /api/users |\n| Posts | /api/posts |\n| Comments | /api/comments |\n```\n\n### Use Patterns Over Examples\n\nBefore:\n```markdown\nTo create a user handler:\n```javascript\nexport async function createUser(req, res) {\n  const { name, email } = req.body;\n  const user = await db.users.create({ name, email });\n  res.json(user);\n}\n```\n\nAfter:\n```markdown\nHandler pattern: `export async function {action}{Resource}(req, res)`\nBody: Extract params â†’ DB operation â†’ Return result\n```\n\n## Output Checklist\n\nAfter optimization, verify:\n\n- [ ] `KNOWLEDGE.md` exists and is under 100 lines\n- [ ] Taskâ†’knowledge mappings cover common workflows\n- [ ] Quick reference has most-used facts\n- [ ] Compiled docs are denser than sources\n- [ ] No orphaned knowledge (everything indexed)\n- [ ] Retrieval hints enable grep-based discovery\n- [ ] Original source docs untouched (human reference)\n",
        "skills/orchestrate-swarms/SKILL.md": "---\nname: orchestrating-swarms\ndescription: Master multi-agent orchestration using Claude Code's TeammateTool and Task system. Use when coordinating multiple agents, running parallel code reviews, creating pipeline workflows with dependencies, building self-organizing task queues, or any task benefiting from divide-and-conquer patterns.\n---\n\n# Claude Code Swarm Orchestration\n\nMaster multi-agent orchestration using Claude Code's TeammateTool and Task system.\n\n---\n\n## Primitives\n\n| Primitive    | What It Is                                                                                                                                                                           | File Location                                 |\n| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------- |\n| **Agent**    | A Claude instance that can use tools. You are an agent. Subagents are agents you spawn.                                                                                              | N/A (process)                                 |\n| **Team**     | A named group of agents working together. One leader, multiple teammates.                                                                                                            | `~/.claude/teams/{name}/config.json`          |\n| **Teammate** | An agent that joined a team. Has a name, color, inbox. Spawned via Task with `team_name` + `name`.                                                                                   | Listed in team config                         |\n| **Leader**   | The agent that created the team. Receives teammate messages, approves plans/shutdowns.                                                                                               | First member in config                        |\n| **Task**     | A work item with subject, description, status, owner, and dependencies.                                                                                                              | `~/.claude/tasks/{team}/N.json`               |\n| **Inbox**    | JSON file where an agent receives messages from teammates.                                                                                                                           | `~/.claude/teams/{name}/inboxes/{agent}.json` |\n| **Message**  | A JSON object sent between agents. Can be text or structured (shutdown_request, idle_notification, etc).                                                                             | Stored in inbox files                         |\n| **Backend**  | How teammates run. Auto-detected: `in-process` (same Node.js, invisible), `tmux` (separate panes, visible), `iterm2` (split panes in iTerm2). See [Spawn Backends](#spawn-backends). | Auto-detected based on environment            |\n\n### How They Connect\n\n```mermaid\nflowchart TB\n    subgraph TEAM[TEAM]\n        Leader[Leader - you]\n        T1[Teammate 1]\n        T2[Teammate 2]\n\n        Leader <-->|messages via inbox| T1\n        Leader <-->|messages via inbox| T2\n        T1 <-.->|can message| T2\n    end\n\n    subgraph TASKS[TASK LIST]\n        Task1[\"#1 completed: Research<br/>owner: teammate1\"]\n        Task2[\"#2 in_progress: Implement<br/>owner: teammate2\"]\n        Task3[\"#3 pending: Test<br/>blocked by #2\"]\n    end\n\n    T1 --> Task1\n    T2 --> Task2\n    Task2 -.->|unblocks| Task3\n```\n\n### Lifecycle\n\n```mermaid\nflowchart LR\n    A[1. Create Team] --> B[2. Create Tasks]\n    B --> C[3. Spawn Teammates]\n    C --> D[4. Work]\n    D --> E[5. Coordinate]\n    E --> F[6. Shutdown]\n    F --> G[7. Cleanup]\n```\n\n### Message Flow\n\n```mermaid\nsequenceDiagram\n    participant L as Leader\n    participant T1 as Teammate 1\n    participant T2 as Teammate 2\n    participant Tasks as Task List\n\n    L->>Tasks: TaskCreate (3 tasks)\n    L->>T1: spawn with prompt\n    L->>T2: spawn with prompt\n\n    T1->>Tasks: claim task #1\n    T2->>Tasks: claim task #2\n\n    T1->>Tasks: complete #1\n    T1->>L: send findings (inbox)\n\n    Note over Tasks: #3 auto-unblocks\n\n    T2->>Tasks: complete #2\n    T2->>L: send findings (inbox)\n\n    L->>T1: requestShutdown\n    T1->>L: approveShutdown\n    L->>T2: requestShutdown\n    T2->>L: approveShutdown\n\n    L->>L: cleanup\n```\n\n---\n\n## Table of Contents\n\n1. [Core Architecture](#core-architecture)\n2. [Two Ways to Spawn Agents](#two-ways-to-spawn-agents)\n3. [Built-in Agent Types](#built-in-agent-types)\n4. [Plugin Agent Types](#plugin-agent-types)\n5. [TeammateTool Operations](#teammatetool-operations)\n6. [Task System Integration](#task-system-integration)\n7. [Message Formats](#message-formats)\n8. [Orchestration Patterns](#orchestration-patterns)\n9. [Environment Variables](#environment-variables)\n10. [Spawn Backends](#spawn-backends)\n11. [Error Handling](#error-handling)\n12. [Complete Workflows](#complete-workflows)\n\n---\n\n## Core Architecture\n\n### How Swarms Work\n\nA swarm consists of:\n\n- **Leader** (you) - Creates team, spawns workers, coordinates work\n- **Teammates** (spawned agents) - Execute tasks, report back\n- **Task List** - Shared work queue with dependencies\n- **Inboxes** - JSON files for inter-agent messaging\n\n### File Structure\n\n```\n~/.claude/teams/{team-name}/\nâ”œâ”€â”€ config.json              # Team metadata and member list\nâ””â”€â”€ inboxes/\n    â”œâ”€â”€ team-lead.json       # Leader's inbox\n    â”œâ”€â”€ worker-1.json        # Worker 1's inbox\n    â””â”€â”€ worker-2.json        # Worker 2's inbox\n\n~/.claude/tasks/{team-name}/\nâ”œâ”€â”€ 1.json                   # Task #1\nâ”œâ”€â”€ 2.json                   # Task #2\nâ””â”€â”€ 3.json                   # Task #3\n```\n\n### Team Config Structure\n\n```json\n{\n  \"name\": \"my-project\",\n  \"description\": \"Working on feature X\",\n  \"leadAgentId\": \"team-lead@my-project\",\n  \"createdAt\": 1706000000000,\n  \"members\": [\n    {\n      \"agentId\": \"team-lead@my-project\",\n      \"name\": \"team-lead\",\n      \"agentType\": \"team-lead\",\n      \"color\": \"#4A90D9\",\n      \"joinedAt\": 1706000000000,\n      \"backendType\": \"in-process\"\n    },\n    {\n      \"agentId\": \"worker-1@my-project\",\n      \"name\": \"worker-1\",\n      \"agentType\": \"Explore\",\n      \"model\": \"haiku\",\n      \"prompt\": \"Analyze the codebase structure...\",\n      \"color\": \"#D94A4A\",\n      \"planModeRequired\": false,\n      \"joinedAt\": 1706000001000,\n      \"tmuxPaneId\": \"in-process\",\n      \"cwd\": \"/Users/me/project\",\n      \"backendType\": \"in-process\"\n    }\n  ]\n}\n```\n\n---\n\n## Two Ways to Spawn Agents\n\n### Method 1: Task Tool (Subagents)\n\nUse Task for **short-lived, focused work** that returns a result:\n\n```javascript\nTask({\n  subagent_type: \"Explore\",\n  description: \"Find auth files\",\n  prompt: \"Find all authentication-related files in this codebase\",\n  model: \"haiku\", // Optional: haiku, sonnet, opus\n});\n```\n\n**Characteristics:**\n\n- Runs synchronously (blocks until complete) or async with `run_in_background: true`\n- Returns result directly to you\n- No team membership required\n- Best for: searches, analysis, focused research\n\n### Method 2: Task Tool + team_name + name (Teammates)\n\nUse Task with `team_name` and `name` to **spawn persistent teammates**:\n\n```javascript\n// First create a team\nTeammate({ operation: \"spawnTeam\", team_name: \"my-project\" });\n\n// Then spawn a teammate into that team\nTask({\n  team_name: \"my-project\", // Required: which team to join\n  name: \"security-reviewer\", // Required: teammate's name\n  subagent_type: \"security-sentinel\",\n  prompt:\n    \"Review all authentication code for vulnerabilities. Send findings to team-lead via Teammate write.\",\n  run_in_background: true, // Teammates usually run in background\n});\n```\n\n**Characteristics:**\n\n- Joins team, appears in `config.json`\n- Communicates via inbox messages\n- Can claim tasks from shared task list\n- Persists until shutdown\n- Best for: parallel work, ongoing collaboration, pipeline stages\n\n### Key Difference\n\n| Aspect          | Task (subagent)     | Task + team_name + name (teammate) |\n| --------------- | ------------------- | ---------------------------------- |\n| Lifespan        | Until task complete | Until shutdown requested           |\n| Communication   | Return value        | Inbox messages                     |\n| Task access     | None                | Shared task list                   |\n| Team membership | No                  | Yes                                |\n| Coordination    | One-off             | Ongoing                            |\n\n---\n\n## Built-in Agent Types\n\nThese are always available without plugins:\n\n### Bash\n\n```javascript\nTask({\n  subagent_type: \"Bash\",\n  description: \"Run git commands\",\n  prompt: \"Check git status and show recent commits\",\n});\n```\n\n- **Tools:** Bash only\n- **Model:** Inherits from parent\n- **Best for:** Git operations, command execution, system tasks\n\n### Explore\n\n```javascript\nTask({\n  subagent_type: \"Explore\",\n  description: \"Find API endpoints\",\n  prompt: \"Find all API endpoints in this codebase. Be very thorough.\",\n  model: \"haiku\", // Fast and cheap\n});\n```\n\n- **Tools:** All read-only tools (no Edit, Write, NotebookEdit, Task)\n- **Model:** Haiku (optimized for speed)\n- **Best for:** Codebase exploration, file searches, code understanding\n- **Thoroughness levels:** \"quick\", \"medium\", \"very thorough\"\n\n### Plan\n\n```javascript\nTask({\n  subagent_type: \"Plan\",\n  description: \"Design auth system\",\n  prompt: \"Create an implementation plan for adding OAuth2 authentication\",\n});\n```\n\n- **Tools:** All read-only tools\n- **Model:** Inherits from parent\n- **Best for:** Architecture planning, implementation strategies\n\n### general-purpose\n\n```javascript\nTask({\n  subagent_type: \"general-purpose\",\n  description: \"Research and implement\",\n  prompt:\n    \"Research React Query best practices and implement caching for the user API\",\n});\n```\n\n- **Tools:** All tools (\\*)\n- **Model:** Inherits from parent\n- **Best for:** Multi-step tasks, research + action combinations\n\n### claude-code-guide\n\n```javascript\nTask({\n  subagent_type: \"claude-code-guide\",\n  description: \"Help with Claude Code\",\n  prompt: \"How do I configure MCP servers?\",\n});\n```\n\n- **Tools:** Read-only + WebFetch + WebSearch\n- **Best for:** Questions about Claude Code, Agent SDK, Anthropic API\n\n### statusline-setup\n\n```javascript\nTask({\n  subagent_type: \"statusline-setup\",\n  description: \"Configure status line\",\n  prompt: \"Set up a status line showing git branch and node version\",\n});\n```\n\n- **Tools:** Read, Edit only\n- **Model:** Sonnet\n- **Best for:** Configuring Claude Code status line\n\n---\n\n## Plugin Agent Types\n\nFrom the `compound-engineering` plugin (examples):\n\n### Review Agents\n\n```javascript\n// Security review\nTask({\n  subagent_type: \"compound-engineering:review:security-sentinel\",\n  description: \"Security audit\",\n  prompt: \"Audit this PR for security vulnerabilities\",\n});\n\n// Performance review\nTask({\n  subagent_type: \"compound-engineering:review:performance-oracle\",\n  description: \"Performance check\",\n  prompt: \"Analyze this code for performance bottlenecks\",\n});\n\n// Rails code review\nTask({\n  subagent_type: \"compound-engineering:review:kieran-rails-reviewer\",\n  description: \"Rails review\",\n  prompt: \"Review this Rails code for best practices\",\n});\n\n// Architecture review\nTask({\n  subagent_type: \"compound-engineering:review:architecture-strategist\",\n  description: \"Architecture review\",\n  prompt: \"Review the system architecture of the authentication module\",\n});\n\n// Code simplicity\nTask({\n  subagent_type: \"compound-engineering:review:code-simplicity-reviewer\",\n  description: \"Simplicity check\",\n  prompt: \"Check if this implementation can be simplified\",\n});\n```\n\n**All review agents from compound-engineering:**\n\n- `agent-native-reviewer` - Ensures features work for agents too\n- `architecture-strategist` - Architectural compliance\n- `code-simplicity-reviewer` - YAGNI and minimalism\n- `data-integrity-guardian` - Database and data safety\n- `data-migration-expert` - Migration validation\n- `deployment-verification-agent` - Pre-deploy checklists\n- `dhh-rails-reviewer` - DHH/37signals Rails style\n- `julik-frontend-races-reviewer` - JavaScript race conditions\n- `kieran-python-reviewer` - Python best practices\n- `kieran-rails-reviewer` - Rails best practices\n- `kieran-typescript-reviewer` - TypeScript best practices\n- `pattern-recognition-specialist` - Design patterns and anti-patterns\n- `performance-oracle` - Performance analysis\n- `security-sentinel` - Security vulnerabilities\n\n### Research Agents\n\n```javascript\n// Best practices research\nTask({\n  subagent_type: \"compound-engineering:research:best-practices-researcher\",\n  description: \"Research auth best practices\",\n  prompt:\n    \"Research current best practices for JWT authentication in Rails 2024-2026\",\n});\n\n// Framework documentation\nTask({\n  subagent_type: \"compound-engineering:research:framework-docs-researcher\",\n  description: \"Research Active Storage\",\n  prompt:\n    \"Gather comprehensive documentation about Active Storage file uploads\",\n});\n\n// Git history analysis\nTask({\n  subagent_type: \"compound-engineering:research:git-history-analyzer\",\n  description: \"Analyze auth history\",\n  prompt:\n    \"Analyze the git history of the authentication module to understand its evolution\",\n});\n```\n\n**All research agents:**\n\n- `best-practices-researcher` - External best practices\n- `framework-docs-researcher` - Framework documentation\n- `git-history-analyzer` - Code archaeology\n- `learnings-researcher` - Search docs/solutions/\n- `repo-research-analyst` - Repository patterns\n\n### Design Agents\n\n```javascript\nTask({\n  subagent_type: \"compound-engineering:design:figma-design-sync\",\n  description: \"Sync with Figma\",\n  prompt: \"Compare implementation with Figma design at [URL]\",\n});\n```\n\n### Workflow Agents\n\n```javascript\nTask({\n  subagent_type: \"compound-engineering:workflow:bug-reproduction-validator\",\n  description: \"Validate bug\",\n  prompt: \"Reproduce and validate this reported bug: [description]\",\n});\n```\n\n---\n\n## TeammateTool Operations\n\n### 1. spawnTeam - Create a Team\n\n```javascript\nTeammate({\n  operation: \"spawnTeam\",\n  team_name: \"feature-auth\",\n  description: \"Implementing OAuth2 authentication\",\n});\n```\n\n**Creates:**\n\n- `~/.claude/teams/feature-auth/config.json`\n- `~/.claude/tasks/feature-auth/` directory\n- You become the team leader\n\n### 2. discoverTeams - List Available Teams\n\n```javascript\nTeammate({ operation: \"discoverTeams\" });\n```\n\n**Returns:** List of teams you can join (not already a member of)\n\n### 3. requestJoin - Request to Join Team\n\n```javascript\nTeammate({\n  operation: \"requestJoin\",\n  team_name: \"feature-auth\",\n  proposed_name: \"helper\",\n  capabilities: \"I can help with code review and testing\",\n});\n```\n\n### 4. approveJoin - Accept Join Request (Leader Only)\n\nWhen you receive a `join_request` message:\n\n```json\n{\"type\": \"join_request\", \"proposedName\": \"helper\", \"requestId\": \"join-123\", ...}\n```\n\nApprove it:\n\n```javascript\nTeammate({\n  operation: \"approveJoin\",\n  target_agent_id: \"helper\",\n  request_id: \"join-123\",\n});\n```\n\n### 5. rejectJoin - Decline Join Request (Leader Only)\n\n```javascript\nTeammate({\n  operation: \"rejectJoin\",\n  target_agent_id: \"helper\",\n  request_id: \"join-123\",\n  reason: \"Team is at capacity\",\n});\n```\n\n### 6. write - Message One Teammate\n\n```javascript\nTeammate({\n  operation: \"write\",\n  target_agent_id: \"security-reviewer\",\n  value:\n    \"Please prioritize the authentication module. The deadline is tomorrow.\",\n});\n```\n\n**Important for teammates:** Your text output is NOT visible to the team. You MUST use `write` to communicate.\n\n### 7. broadcast - Message ALL Teammates\n\n```javascript\nTeammate({\n  operation: \"broadcast\",\n  name: \"team-lead\", // Your name\n  value: \"Status check: Please report your progress\",\n});\n```\n\n**WARNING:** Broadcasting is expensive - sends N separate messages for N teammates. Prefer `write` to specific teammates.\n\n**When to broadcast:**\n\n- Critical issues requiring immediate attention\n- Major announcements affecting everyone\n\n**When NOT to broadcast:**\n\n- Responding to one teammate\n- Normal back-and-forth\n- Information relevant to only some teammates\n\n### 8. requestShutdown - Ask Teammate to Exit (Leader Only)\n\n```javascript\nTeammate({\n  operation: \"requestShutdown\",\n  target_agent_id: \"security-reviewer\",\n  reason: \"All tasks complete, wrapping up\",\n});\n```\n\n### 9. approveShutdown - Accept Shutdown (Teammate Only)\n\nWhen you receive a `shutdown_request` message:\n\n```json\n{\n  \"type\": \"shutdown_request\",\n  \"requestId\": \"shutdown-123\",\n  \"from\": \"team-lead\",\n  \"reason\": \"Done\"\n}\n```\n\n**MUST** call:\n\n```javascript\nTeammate({\n  operation: \"approveShutdown\",\n  request_id: \"shutdown-123\",\n});\n```\n\nThis sends confirmation and terminates your process.\n\n### 10. rejectShutdown - Decline Shutdown (Teammate Only)\n\n```javascript\nTeammate({\n  operation: \"rejectShutdown\",\n  request_id: \"shutdown-123\",\n  reason: \"Still working on task #3, need 5 more minutes\",\n});\n```\n\n### 11. approvePlan - Approve Teammate's Plan (Leader Only)\n\nWhen teammate with `plan_mode_required` sends a plan:\n\n```json\n{\"type\": \"plan_approval_request\", \"from\": \"architect\", \"requestId\": \"plan-456\", ...}\n```\n\nApprove:\n\n```javascript\nTeammate({\n  operation: \"approvePlan\",\n  target_agent_id: \"architect\",\n  request_id: \"plan-456\",\n});\n```\n\n### 12. rejectPlan - Reject Plan with Feedback (Leader Only)\n\n```javascript\nTeammate({\n  operation: \"rejectPlan\",\n  target_agent_id: \"architect\",\n  request_id: \"plan-456\",\n  feedback:\n    \"Please add error handling for the API calls and consider rate limiting\",\n});\n```\n\n### 13. cleanup - Remove Team Resources\n\n```javascript\nTeammate({ operation: \"cleanup\" });\n```\n\n**Removes:**\n\n- `~/.claude/teams/{team-name}/` directory\n- `~/.claude/tasks/{team-name}/` directory\n\n**IMPORTANT:** Will fail if teammates are still active. Use `requestShutdown` first.\n\n---\n\n## Task System Integration\n\n### TaskCreate - Create Work Items\n\n```javascript\nTaskCreate({\n  subject: \"Review authentication module\",\n  description:\n    \"Review all files in app/services/auth/ for security vulnerabilities\",\n  activeForm: \"Reviewing auth module...\", // Shown in spinner when in_progress\n});\n```\n\n### TaskList - See All Tasks\n\n```javascript\nTaskList();\n```\n\nReturns:\n\n```\n#1 [completed] Analyze codebase structure\n#2 [in_progress] Review authentication module (owner: security-reviewer)\n#3 [pending] Generate summary report [blocked by #2]\n```\n\n### TaskGet - Get Task Details\n\n```javascript\nTaskGet({ taskId: \"2\" });\n```\n\nReturns full task with description, status, blockedBy, etc.\n\n### TaskUpdate - Update Task Status\n\n```javascript\n// Claim a task\nTaskUpdate({ taskId: \"2\", owner: \"security-reviewer\" });\n\n// Start working\nTaskUpdate({ taskId: \"2\", status: \"in_progress\" });\n\n// Mark complete\nTaskUpdate({ taskId: \"2\", status: \"completed\" });\n\n// Set up dependencies\nTaskUpdate({ taskId: \"3\", addBlockedBy: [\"1\", \"2\"] });\n```\n\n### Task Dependencies\n\nWhen a blocking task is completed, blocked tasks are automatically unblocked:\n\n```javascript\n// Create pipeline\nTaskCreate({ subject: \"Step 1: Research\" }); // #1\nTaskCreate({ subject: \"Step 2: Implement\" }); // #2\nTaskCreate({ subject: \"Step 3: Test\" }); // #3\nTaskCreate({ subject: \"Step 4: Deploy\" }); // #4\n\n// Set up dependencies\nTaskUpdate({ taskId: \"2\", addBlockedBy: [\"1\"] }); // #2 waits for #1\nTaskUpdate({ taskId: \"3\", addBlockedBy: [\"2\"] }); // #3 waits for #2\nTaskUpdate({ taskId: \"4\", addBlockedBy: [\"3\"] }); // #4 waits for #3\n\n// When #1 completes, #2 auto-unblocks\n// When #2 completes, #3 auto-unblocks\n// etc.\n```\n\n### Task File Structure\n\n`~/.claude/tasks/{team-name}/1.json`:\n\n```json\n{\n  \"id\": \"1\",\n  \"subject\": \"Review authentication module\",\n  \"description\": \"Review all files in app/services/auth/...\",\n  \"status\": \"in_progress\",\n  \"owner\": \"security-reviewer\",\n  \"activeForm\": \"Reviewing auth module...\",\n  \"blockedBy\": [],\n  \"blocks\": [\"3\"],\n  \"createdAt\": 1706000000000,\n  \"updatedAt\": 1706000001000\n}\n```\n\n---\n\n## Message Formats\n\n### Regular Message\n\n```json\n{\n  \"from\": \"team-lead\",\n  \"text\": \"Please prioritize the auth module\",\n  \"timestamp\": \"2026-01-25T23:38:32.588Z\",\n  \"read\": false\n}\n```\n\n### Structured Messages (JSON in text field)\n\n#### Shutdown Request\n\n```json\n{\n  \"type\": \"shutdown_request\",\n  \"requestId\": \"shutdown-abc123@worker-1\",\n  \"from\": \"team-lead\",\n  \"reason\": \"All tasks complete\",\n  \"timestamp\": \"2026-01-25T23:38:32.588Z\"\n}\n```\n\n#### Shutdown Approved\n\n```json\n{\n  \"type\": \"shutdown_approved\",\n  \"requestId\": \"shutdown-abc123@worker-1\",\n  \"from\": \"worker-1\",\n  \"paneId\": \"%5\",\n  \"backendType\": \"in-process\",\n  \"timestamp\": \"2026-01-25T23:39:00.000Z\"\n}\n```\n\n#### Idle Notification (auto-sent when teammate stops)\n\n```json\n{\n  \"type\": \"idle_notification\",\n  \"from\": \"worker-1\",\n  \"timestamp\": \"2026-01-25T23:40:00.000Z\",\n  \"completedTaskId\": \"2\",\n  \"completedStatus\": \"completed\"\n}\n```\n\n#### Task Completed\n\n```json\n{\n  \"type\": \"task_completed\",\n  \"from\": \"worker-1\",\n  \"taskId\": \"2\",\n  \"taskSubject\": \"Review authentication module\",\n  \"timestamp\": \"2026-01-25T23:40:00.000Z\"\n}\n```\n\n#### Plan Approval Request\n\n```json\n{\n  \"type\": \"plan_approval_request\",\n  \"from\": \"architect\",\n  \"requestId\": \"plan-xyz789\",\n  \"planContent\": \"# Implementation Plan\\n\\n1. ...\",\n  \"timestamp\": \"2026-01-25T23:41:00.000Z\"\n}\n```\n\n#### Join Request\n\n```json\n{\n  \"type\": \"join_request\",\n  \"proposedName\": \"helper\",\n  \"requestId\": \"join-abc123\",\n  \"capabilities\": \"Code review and testing\",\n  \"timestamp\": \"2026-01-25T23:42:00.000Z\"\n}\n```\n\n#### Permission Request (for sandbox/tool permissions)\n\n```json\n{\n  \"type\": \"permission_request\",\n  \"requestId\": \"perm-123\",\n  \"workerId\": \"worker-1@my-project\",\n  \"workerName\": \"worker-1\",\n  \"workerColor\": \"#4A90D9\",\n  \"toolName\": \"Bash\",\n  \"toolUseId\": \"toolu_abc123\",\n  \"description\": \"Run npm install\",\n  \"input\": { \"command\": \"npm install\" },\n  \"permissionSuggestions\": [\"Bash(npm *)\"],\n  \"createdAt\": 1706000000000\n}\n```\n\n---\n\n## Orchestration Patterns\n\n### Pattern 1: Parallel Specialists (Leader Pattern)\n\nMultiple specialists review code simultaneously:\n\n```javascript\n// 1. Create team\nTeammate({ operation: \"spawnTeam\", team_name: \"code-review\" });\n\n// 2. Spawn specialists in parallel (single message, multiple Task calls)\nTask({\n  team_name: \"code-review\",\n  name: \"security\",\n  subagent_type: \"compound-engineering:review:security-sentinel\",\n  prompt:\n    \"Review the PR for security vulnerabilities. Focus on: SQL injection, XSS, auth bypass. Send findings to team-lead.\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"code-review\",\n  name: \"performance\",\n  subagent_type: \"compound-engineering:review:performance-oracle\",\n  prompt:\n    \"Review the PR for performance issues. Focus on: N+1 queries, memory leaks, slow algorithms. Send findings to team-lead.\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"code-review\",\n  name: \"simplicity\",\n  subagent_type: \"compound-engineering:review:code-simplicity-reviewer\",\n  prompt:\n    \"Review the PR for unnecessary complexity. Focus on: over-engineering, premature abstraction, YAGNI violations. Send findings to team-lead.\",\n  run_in_background: true,\n});\n\n// 3. Wait for results (check inbox)\n// cat ~/.claude/teams/code-review/inboxes/team-lead.json\n\n// 4. Synthesize findings and cleanup\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"security\" });\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"performance\" });\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"simplicity\" });\n// Wait for approvals...\nTeammate({ operation: \"cleanup\" });\n```\n\n### Pattern 2: Pipeline (Sequential Dependencies)\n\nEach stage depends on the previous:\n\n```javascript\n// 1. Create team and task pipeline\nTeammate({ operation: \"spawnTeam\", team_name: \"feature-pipeline\" });\n\nTaskCreate({\n  subject: \"Research\",\n  description: \"Research best practices for the feature\",\n  activeForm: \"Researching...\",\n});\nTaskCreate({\n  subject: \"Plan\",\n  description: \"Create implementation plan based on research\",\n  activeForm: \"Planning...\",\n});\nTaskCreate({\n  subject: \"Implement\",\n  description: \"Implement the feature according to plan\",\n  activeForm: \"Implementing...\",\n});\nTaskCreate({\n  subject: \"Test\",\n  description: \"Write and run tests for the implementation\",\n  activeForm: \"Testing...\",\n});\nTaskCreate({\n  subject: \"Review\",\n  description: \"Final code review before merge\",\n  activeForm: \"Reviewing...\",\n});\n\n// Set up sequential dependencies\nTaskUpdate({ taskId: \"2\", addBlockedBy: [\"1\"] });\nTaskUpdate({ taskId: \"3\", addBlockedBy: [\"2\"] });\nTaskUpdate({ taskId: \"4\", addBlockedBy: [\"3\"] });\nTaskUpdate({ taskId: \"5\", addBlockedBy: [\"4\"] });\n\n// 2. Spawn workers that claim and complete tasks\nTask({\n  team_name: \"feature-pipeline\",\n  name: \"researcher\",\n  subagent_type: \"compound-engineering:research:best-practices-researcher\",\n  prompt:\n    \"Claim task #1, research best practices, complete it, send findings to team-lead. Then check for more work.\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"feature-pipeline\",\n  name: \"implementer\",\n  subagent_type: \"general-purpose\",\n  prompt:\n    \"Poll TaskList every 30 seconds. When task #3 unblocks, claim it and implement. Then complete and notify team-lead.\",\n  run_in_background: true,\n});\n\n// Tasks auto-unblock as dependencies complete\n```\n\n### Pattern 3: Swarm (Self-Organizing)\n\nWorkers grab available tasks from a pool:\n\n```javascript\n// 1. Create team and task pool\nTeammate({ operation: \"spawnTeam\", team_name: \"file-review-swarm\" });\n\n// Create many independent tasks (no dependencies)\nfor (const file of [\"auth.rb\", \"user.rb\", \"api_controller.rb\", \"payment.rb\"]) {\n  TaskCreate({\n    subject: `Review ${file}`,\n    description: `Review ${file} for security and code quality issues`,\n    activeForm: `Reviewing ${file}...`,\n  });\n}\n\n// 2. Spawn worker swarm\nTask({\n  team_name: \"file-review-swarm\",\n  name: \"worker-1\",\n  subagent_type: \"general-purpose\",\n  prompt: `\n    You are a swarm worker. Your job:\n    1. Call TaskList to see available tasks\n    2. Find a task with status 'pending' and no owner\n    3. Claim it with TaskUpdate (set owner to your name)\n    4. Do the work\n    5. Mark it completed with TaskUpdate\n    6. Send findings to team-lead via Teammate write\n    7. Repeat until no tasks remain\n  `,\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"file-review-swarm\",\n  name: \"worker-2\",\n  subagent_type: \"general-purpose\",\n  prompt: `[Same prompt as worker-1]`,\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"file-review-swarm\",\n  name: \"worker-3\",\n  subagent_type: \"general-purpose\",\n  prompt: `[Same prompt as worker-1]`,\n  run_in_background: true,\n});\n\n// Workers race to claim tasks, naturally load-balance\n```\n\n### Pattern 4: Research + Implementation\n\nResearch first, then implement:\n\n```javascript\n// 1. Research phase (synchronous, returns results)\nconst research = await Task({\n  subagent_type: \"compound-engineering:research:best-practices-researcher\",\n  description: \"Research caching patterns\",\n  prompt:\n    \"Research best practices for implementing caching in Rails APIs. Include: cache invalidation strategies, Redis vs Memcached, cache key design.\",\n});\n\n// 2. Use research to guide implementation\nTask({\n  subagent_type: \"general-purpose\",\n  description: \"Implement caching\",\n  prompt: `\n    Implement API caching based on this research:\n\n    ${research.content}\n\n    Focus on the user_controller.rb endpoints.\n  `,\n});\n```\n\n### Pattern 5: Plan Approval Workflow\n\nRequire plan approval before implementation:\n\n```javascript\n// 1. Create team\nTeammate({ operation: \"spawnTeam\", team_name: \"careful-work\" });\n\n// 2. Spawn architect with plan_mode_required\nTask({\n  team_name: \"careful-work\",\n  name: \"architect\",\n  subagent_type: \"Plan\",\n  prompt: \"Design an implementation plan for adding OAuth2 authentication\",\n  mode: \"plan\", // Requires plan approval\n  run_in_background: true,\n});\n\n// 3. Wait for plan approval request\n// You'll receive: {\"type\": \"plan_approval_request\", \"from\": \"architect\", \"requestId\": \"plan-xxx\", ...}\n\n// 4. Review and approve/reject\nTeammate({\n  operation: \"approvePlan\",\n  target_agent_id: \"architect\",\n  request_id: \"plan-xxx\",\n});\n// OR\nTeammate({\n  operation: \"rejectPlan\",\n  target_agent_id: \"architect\",\n  request_id: \"plan-xxx\",\n  feedback: \"Please add rate limiting considerations\",\n});\n```\n\n### Pattern 6: Coordinated Multi-File Refactoring\n\n```javascript\n// 1. Create team for coordinated refactoring\nTeammate({ operation: \"spawnTeam\", team_name: \"refactor-auth\" });\n\n// 2. Create tasks with clear file boundaries\nTaskCreate({\n  subject: \"Refactor User model\",\n  description: \"Extract authentication methods to AuthenticatableUser concern\",\n  activeForm: \"Refactoring User model...\",\n});\n\nTaskCreate({\n  subject: \"Refactor Session controller\",\n  description: \"Update to use new AuthenticatableUser concern\",\n  activeForm: \"Refactoring Sessions...\",\n});\n\nTaskCreate({\n  subject: \"Update specs\",\n  description: \"Update all authentication specs for new structure\",\n  activeForm: \"Updating specs...\",\n});\n\n// Dependencies: specs depend on both refactors completing\nTaskUpdate({ taskId: \"3\", addBlockedBy: [\"1\", \"2\"] });\n\n// 3. Spawn workers for each task\nTask({\n  team_name: \"refactor-auth\",\n  name: \"model-worker\",\n  subagent_type: \"general-purpose\",\n  prompt: \"Claim task #1, refactor the User model, complete when done\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"refactor-auth\",\n  name: \"controller-worker\",\n  subagent_type: \"general-purpose\",\n  prompt: \"Claim task #2, refactor the Session controller, complete when done\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"refactor-auth\",\n  name: \"spec-worker\",\n  subagent_type: \"general-purpose\",\n  prompt:\n    \"Wait for task #3 to unblock (when #1 and #2 complete), then update specs\",\n  run_in_background: true,\n});\n```\n\n---\n\n## Environment Variables\n\nSpawned teammates automatically receive these:\n\n```bash\nCLAUDE_CODE_TEAM_NAME=\"my-project\"\nCLAUDE_CODE_AGENT_ID=\"worker-1@my-project\"\nCLAUDE_CODE_AGENT_NAME=\"worker-1\"\nCLAUDE_CODE_AGENT_TYPE=\"Explore\"\nCLAUDE_CODE_AGENT_COLOR=\"#4A90D9\"\nCLAUDE_CODE_PLAN_MODE_REQUIRED=\"false\"\nCLAUDE_CODE_PARENT_SESSION_ID=\"session-xyz\"\n```\n\n**Using in prompts:**\n\n```javascript\nTask({\n  team_name: \"my-project\",\n  name: \"worker\",\n  subagent_type: \"general-purpose\",\n  prompt:\n    \"Your name is $CLAUDE_CODE_AGENT_NAME. Use it when sending messages to team-lead.\",\n});\n```\n\n---\n\n## Spawn Backends\n\nA **backend** determines how teammate Claude instances actually run. Claude Code supports three backends, and **auto-detects** the best one based on your environment.\n\n### Backend Comparison\n\n| Backend        | How It Works                      | Visibility           | Persistence          | Speed   |\n| -------------- | --------------------------------- | -------------------- | -------------------- | ------- |\n| **in-process** | Same Node.js process as leader    | Hidden (background)  | Dies with leader     | Fastest |\n| **tmux**       | Separate terminal in tmux session | Visible in tmux      | Survives leader exit | Medium  |\n| **iterm2**     | Split panes in iTerm2 window      | Visible side-by-side | Dies with window     | Medium  |\n\n### Auto-Detection Logic\n\nClaude Code automatically selects a backend using this decision tree:\n\n```mermaid\nflowchart TD\n    A[Start] --> B{Running inside tmux?}\n    B -->|Yes| C[Use tmux backend]\n    B -->|No| D{Running in iTerm2?}\n    D -->|No| E{tmux available?}\n    E -->|Yes| F[Use tmux - external session]\n    E -->|No| G[Use in-process]\n    D -->|Yes| H{it2 CLI installed?}\n    H -->|Yes| I[Use iterm2 backend]\n    H -->|No| J{tmux available?}\n    J -->|Yes| K[Use tmux - prompt to install it2]\n    J -->|No| L[Error: Install tmux or it2]\n```\n\n**Detection checks:**\n\n1. `$TMUX` environment variable â†’ inside tmux\n2. `$TERM_PROGRAM === \"iTerm.app\"` or `$ITERM_SESSION_ID` â†’ in iTerm2\n3. `which tmux` â†’ tmux available\n4. `which it2` â†’ it2 CLI installed\n\n### in-process (Default for non-tmux)\n\nTeammates run as async tasks within the same Node.js process.\n\n**How it works:**\n\n- No new process spawned\n- Teammates share the same Node.js event loop\n- Communication via in-memory queues (fast)\n- You don't see teammate output directly\n\n**When it's used:**\n\n- Not running inside tmux session\n- Non-interactive mode (CI, scripts)\n- Explicitly set via `CLAUDE_CODE_SPAWN_BACKEND=in-process`\n\n**Characteristics:**\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚           Node.js Process               â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\nâ”‚  â”‚ Leader  â”‚  â”‚Worker 1 â”‚  â”‚Worker 2 â”‚ â”‚\nâ”‚  â”‚ (main)  â”‚  â”‚ (async) â”‚  â”‚ (async) â”‚ â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Pros:**\n\n- Fastest startup (no process spawn)\n- Lowest overhead\n- Works everywhere\n\n**Cons:**\n\n- Can't see teammate output in real-time\n- All die if leader dies\n- Harder to debug\n\n```javascript\n// in-process is automatic when not in tmux\nTask({\n  team_name: \"my-project\",\n  name: \"worker\",\n  subagent_type: \"general-purpose\",\n  prompt: \"...\",\n  run_in_background: true,\n});\n\n// Force in-process explicitly\n// export CLAUDE_CODE_SPAWN_BACKEND=in-process\n```\n\n### tmux\n\nTeammates run as separate Claude instances in tmux panes/windows.\n\n**How it works:**\n\n- Each teammate gets its own tmux pane\n- Separate process per teammate\n- You can switch panes to see teammate output\n- Communication via inbox files\n\n**When it's used:**\n\n- Running inside a tmux session (`$TMUX` is set)\n- tmux available and not in iTerm2\n- Explicitly set via `CLAUDE_CODE_SPAWN_BACKEND=tmux`\n\n**Layout modes:**\n\n1. **Inside tmux (native):** Splits your current window\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                 â”‚    Worker 1     â”‚\nâ”‚     Leader      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚   (your pane)   â”‚    Worker 2     â”‚\nâ”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                 â”‚    Worker 3     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n2. **Outside tmux (external session):** Creates a new tmux session called `claude-swarm`\n\n```bash\n# Your terminal stays as-is\n# Workers run in separate tmux session\n\n# View workers:\ntmux attach -t claude-swarm\n```\n\n**Pros:**\n\n- See teammate output in real-time\n- Teammates survive leader exit\n- Can attach/detach sessions\n- Works in CI/headless environments\n\n**Cons:**\n\n- Slower startup (process spawn)\n- Requires tmux installed\n- More resource usage\n\n```bash\n# Start tmux session first\ntmux new-session -s claude\n\n# Or force tmux backend\nexport CLAUDE_CODE_SPAWN_BACKEND=tmux\n```\n\n**Useful tmux commands:**\n\n```bash\n# List all panes in current window\ntmux list-panes\n\n# Switch to pane by number\ntmux select-pane -t 1\n\n# Kill a specific pane\ntmux kill-pane -t %5\n\n# View swarm session (if external)\ntmux attach -t claude-swarm\n\n# Rebalance pane layout\ntmux select-layout tiled\n```\n\n### iterm2 (macOS only)\n\nTeammates run as split panes within your iTerm2 window.\n\n**How it works:**\n\n- Uses iTerm2's Python API via `it2` CLI\n- Splits your current window into panes\n- Each teammate visible side-by-side\n- Communication via inbox files\n\n**When it's used:**\n\n- Running in iTerm2 (`$TERM_PROGRAM === \"iTerm.app\"`)\n- `it2` CLI is installed and working\n- Python API enabled in iTerm2 preferences\n\n**Layout:**\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                 â”‚    Worker 1     â”‚\nâ”‚     Leader      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚   (your pane)   â”‚    Worker 2     â”‚\nâ”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                 â”‚    Worker 3     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Pros:**\n\n- Visual debugging - see all teammates\n- Native macOS experience\n- No tmux needed\n- Automatic pane management\n\n**Cons:**\n\n- macOS + iTerm2 only\n- Requires setup (it2 CLI + Python API)\n- Panes die with window\n\n**Setup:**\n\n```bash\n# 1. Install it2 CLI\nuv tool install it2\n# OR\npipx install it2\n# OR\npip install --user it2\n\n# 2. Enable Python API in iTerm2\n# iTerm2 â†’ Settings â†’ General â†’ Magic â†’ Enable Python API\n\n# 3. Restart iTerm2\n\n# 4. Verify\nit2 --version\nit2 session list\n```\n\n**If setup fails:**\nClaude Code will prompt you to set up it2 when you first spawn a teammate. You can choose to:\n\n1. Install it2 now (guided setup)\n2. Use tmux instead\n3. Cancel\n\n### Forcing a Backend\n\n```bash\n# Force in-process (fastest, no visibility)\nexport CLAUDE_CODE_SPAWN_BACKEND=in-process\n\n# Force tmux (visible panes, persistent)\nexport CLAUDE_CODE_SPAWN_BACKEND=tmux\n\n# Auto-detect (default)\nunset CLAUDE_CODE_SPAWN_BACKEND\n```\n\n### Backend in Team Config\n\nThe backend type is recorded per-teammate in `config.json`:\n\n```json\n{\n  \"members\": [\n    {\n      \"name\": \"worker-1\",\n      \"backendType\": \"in-process\",\n      \"tmuxPaneId\": \"in-process\"\n    },\n    {\n      \"name\": \"worker-2\",\n      \"backendType\": \"tmux\",\n      \"tmuxPaneId\": \"%5\"\n    }\n  ]\n}\n```\n\n### Troubleshooting Backends\n\n| Issue                       | Cause                             | Solution                                    |\n| --------------------------- | --------------------------------- | ------------------------------------------- |\n| \"No pane backend available\" | Neither tmux nor iTerm2 available | Install tmux: `brew install tmux`           |\n| \"it2 CLI not installed\"     | In iTerm2 but missing it2         | Run `uv tool install it2`                   |\n| \"Python API not enabled\"    | it2 can't communicate with iTerm2 | Enable in iTerm2 Settings â†’ General â†’ Magic |\n| Workers not visible         | Using in-process backend          | Start inside tmux or iTerm2                 |\n| Workers dying unexpectedly  | Outside tmux, leader exited       | Use tmux for persistence                    |\n\n### Checking Current Backend\n\n```bash\n# See what backend was detected\ncat ~/.claude/teams/{team}/config.json | jq '.members[].backendType'\n\n# Check if inside tmux\necho $TMUX\n\n# Check if in iTerm2\necho $TERM_PROGRAM\n\n# Check tmux availability\nwhich tmux\n\n# Check it2 availability\nwhich it2\n```\n\n---\n\n## Error Handling\n\n### Common Errors\n\n| Error                                | Cause                   | Solution                                                 |\n| ------------------------------------ | ----------------------- | -------------------------------------------------------- |\n| \"Cannot cleanup with active members\" | Teammates still running | `requestShutdown` all teammates first, wait for approval |\n| \"Already leading a team\"             | Team already exists     | `cleanup` first, or use different team name              |\n| \"Agent not found\"                    | Wrong teammate name     | Check `config.json` for actual names                     |\n| \"Team does not exist\"                | No team created         | Call `spawnTeam` first                                   |\n| \"team_name is required\"              | Missing team context    | Provide `team_name` parameter                            |\n| \"Agent type not found\"               | Invalid subagent_type   | Check available agents with proper prefix                |\n\n### Graceful Shutdown Sequence\n\n**Always follow this sequence:**\n\n```javascript\n// 1. Request shutdown for all teammates\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"worker-1\" });\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"worker-2\" });\n\n// 2. Wait for shutdown approvals\n// Check for {\"type\": \"shutdown_approved\", ...} messages\n\n// 3. Verify no active members\n// Read ~/.claude/teams/{team}/config.json\n\n// 4. Only then cleanup\nTeammate({ operation: \"cleanup\" });\n```\n\n### Handling Crashed Teammates\n\nTeammates have a 5-minute heartbeat timeout. If a teammate crashes:\n\n1. They'll be automatically marked as inactive after timeout\n2. Their tasks remain in the task list\n3. Another teammate can claim their tasks\n4. Cleanup will work after timeout expires\n\n### Debugging\n\n```bash\n# Check team config\ncat ~/.claude/teams/{team}/config.json | jq '.members[] | {name, agentType, backendType}'\n\n# Check teammate inboxes\ncat ~/.claude/teams/{team}/inboxes/{agent}.json | jq '.'\n\n# List all teams\nls ~/.claude/teams/\n\n# Check task states\ncat ~/.claude/tasks/{team}/*.json | jq '{id, subject, status, owner, blockedBy}'\n\n# Watch for new messages\ntail -f ~/.claude/teams/{team}/inboxes/team-lead.json\n```\n\n---\n\n## Complete Workflows\n\n### Workflow 1: Full Code Review with Parallel Specialists\n\n```javascript\n// === STEP 1: Setup ===\nTeammate({\n  operation: \"spawnTeam\",\n  team_name: \"pr-review-123\",\n  description: \"Reviewing PR #123\",\n});\n\n// === STEP 2: Spawn reviewers in parallel ===\n// (Send all these in a single message for parallel execution)\nTask({\n  team_name: \"pr-review-123\",\n  name: \"security\",\n  subagent_type: \"compound-engineering:review:security-sentinel\",\n  prompt: `Review PR #123 for security vulnerabilities.\n\n  Focus on:\n  - SQL injection\n  - XSS vulnerabilities\n  - Authentication/authorization bypass\n  - Sensitive data exposure\n\n  When done, send your findings to team-lead using:\n  Teammate({ operation: \"write\", target_agent_id: \"team-lead\", value: \"Your findings here\" })`,\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"pr-review-123\",\n  name: \"perf\",\n  subagent_type: \"compound-engineering:review:performance-oracle\",\n  prompt: `Review PR #123 for performance issues.\n\n  Focus on:\n  - N+1 queries\n  - Missing indexes\n  - Memory leaks\n  - Inefficient algorithms\n\n  Send findings to team-lead when done.`,\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"pr-review-123\",\n  name: \"arch\",\n  subagent_type: \"compound-engineering:review:architecture-strategist\",\n  prompt: `Review PR #123 for architectural concerns.\n\n  Focus on:\n  - Design pattern adherence\n  - SOLID principles\n  - Separation of concerns\n  - Testability\n\n  Send findings to team-lead when done.`,\n  run_in_background: true,\n});\n\n// === STEP 3: Monitor and collect results ===\n// Poll inbox or wait for idle notifications\n// cat ~/.claude/teams/pr-review-123/inboxes/team-lead.json\n\n// === STEP 4: Synthesize findings ===\n// Combine all reviewer findings into a cohesive report\n\n// === STEP 5: Cleanup ===\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"security\" });\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"perf\" });\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"arch\" });\n// Wait for approvals...\nTeammate({ operation: \"cleanup\" });\n```\n\n### Workflow 2: Research â†’ Plan â†’ Implement â†’ Test Pipeline\n\n```javascript\n// === SETUP ===\nTeammate({ operation: \"spawnTeam\", team_name: \"feature-oauth\" });\n\n// === CREATE PIPELINE ===\nTaskCreate({\n  subject: \"Research OAuth providers\",\n  description:\n    \"Research OAuth2 best practices and compare providers (Google, GitHub, Auth0)\",\n  activeForm: \"Researching OAuth...\",\n});\nTaskCreate({\n  subject: \"Create implementation plan\",\n  description: \"Design OAuth implementation based on research findings\",\n  activeForm: \"Planning...\",\n});\nTaskCreate({\n  subject: \"Implement OAuth\",\n  description: \"Implement OAuth2 authentication according to plan\",\n  activeForm: \"Implementing OAuth...\",\n});\nTaskCreate({\n  subject: \"Write tests\",\n  description: \"Write comprehensive tests for OAuth implementation\",\n  activeForm: \"Writing tests...\",\n});\nTaskCreate({\n  subject: \"Final review\",\n  description: \"Review complete implementation for security and quality\",\n  activeForm: \"Final review...\",\n});\n\n// Set dependencies\nTaskUpdate({ taskId: \"2\", addBlockedBy: [\"1\"] });\nTaskUpdate({ taskId: \"3\", addBlockedBy: [\"2\"] });\nTaskUpdate({ taskId: \"4\", addBlockedBy: [\"3\"] });\nTaskUpdate({ taskId: \"5\", addBlockedBy: [\"4\"] });\n\n// === SPAWN SPECIALIZED WORKERS ===\nTask({\n  team_name: \"feature-oauth\",\n  name: \"researcher\",\n  subagent_type: \"compound-engineering:research:best-practices-researcher\",\n  prompt:\n    \"Claim task #1. Research OAuth2 best practices, compare providers, document findings. Mark task complete and send summary to team-lead.\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"feature-oauth\",\n  name: \"planner\",\n  subagent_type: \"Plan\",\n  prompt:\n    \"Wait for task #2 to unblock. Read research from task #1. Create detailed implementation plan. Mark complete and send plan to team-lead.\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"feature-oauth\",\n  name: \"implementer\",\n  subagent_type: \"general-purpose\",\n  prompt:\n    \"Wait for task #3 to unblock. Read plan from task #2. Implement OAuth2 authentication. Mark complete when done.\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"feature-oauth\",\n  name: \"tester\",\n  subagent_type: \"general-purpose\",\n  prompt:\n    \"Wait for task #4 to unblock. Write comprehensive tests for the OAuth implementation. Run tests. Mark complete with results.\",\n  run_in_background: true,\n});\n\nTask({\n  team_name: \"feature-oauth\",\n  name: \"reviewer\",\n  subagent_type: \"compound-engineering:review:security-sentinel\",\n  prompt:\n    \"Wait for task #5 to unblock. Review the complete OAuth implementation for security. Send final assessment to team-lead.\",\n  run_in_background: true,\n});\n\n// Pipeline auto-progresses as each stage completes\n```\n\n### Workflow 3: Self-Organizing Code Review Swarm\n\n```javascript\n// === SETUP ===\nTeammate({ operation: \"spawnTeam\", team_name: \"codebase-review\" });\n\n// === CREATE TASK POOL (all independent, no dependencies) ===\nconst filesToReview = [\n  \"app/models/user.rb\",\n  \"app/models/payment.rb\",\n  \"app/controllers/api/v1/users_controller.rb\",\n  \"app/controllers/api/v1/payments_controller.rb\",\n  \"app/services/payment_processor.rb\",\n  \"app/services/notification_service.rb\",\n  \"lib/encryption_helper.rb\",\n];\n\nfor (const file of filesToReview) {\n  TaskCreate({\n    subject: `Review ${file}`,\n    description: `Review ${file} for security vulnerabilities, code quality, and performance issues`,\n    activeForm: `Reviewing ${file}...`,\n  });\n}\n\n// === SPAWN WORKER SWARM ===\nconst swarmPrompt = `\nYou are a swarm worker. Your job is to continuously process available tasks.\n\nLOOP:\n1. Call TaskList() to see available tasks\n2. Find a task that is:\n   - status: 'pending'\n   - no owner\n   - not blocked\n3. If found:\n   - Claim it: TaskUpdate({ taskId: \"X\", owner: \"YOUR_NAME\" })\n   - Start it: TaskUpdate({ taskId: \"X\", status: \"in_progress\" })\n   - Do the review work\n   - Complete it: TaskUpdate({ taskId: \"X\", status: \"completed\" })\n   - Send findings to team-lead via Teammate write\n   - Go back to step 1\n4. If no tasks available:\n   - Send idle notification to team-lead\n   - Wait 30 seconds\n   - Try again (up to 3 times)\n   - If still no tasks, exit\n\nReplace YOUR_NAME with your actual agent name from $CLAUDE_CODE_AGENT_NAME.\n`;\n\n// Spawn 3 workers\nTask({\n  team_name: \"codebase-review\",\n  name: \"worker-1\",\n  subagent_type: \"general-purpose\",\n  prompt: swarmPrompt,\n  run_in_background: true,\n});\nTask({\n  team_name: \"codebase-review\",\n  name: \"worker-2\",\n  subagent_type: \"general-purpose\",\n  prompt: swarmPrompt,\n  run_in_background: true,\n});\nTask({\n  team_name: \"codebase-review\",\n  name: \"worker-3\",\n  subagent_type: \"general-purpose\",\n  prompt: swarmPrompt,\n  run_in_background: true,\n});\n\n// Workers self-organize: race to claim tasks, naturally load-balance\n// Monitor progress with TaskList() or by reading inbox\n```\n\n---\n\n## Best Practices\n\n### 1. Always Cleanup\n\nDon't leave orphaned teams. Always call `cleanup` when done.\n\n### 2. Use Meaningful Names\n\n```javascript\n// Good\nname: \"security-reviewer\";\nname: \"oauth-implementer\";\nname: \"test-writer\";\n\n// Bad\nname: \"worker-1\";\nname: \"agent-2\";\n```\n\n### 3. Write Clear Prompts\n\nTell workers exactly what to do:\n\n```javascript\n// Good\nprompt: `\n  1. Review app/models/user.rb for N+1 queries\n  2. Check all ActiveRecord associations have proper includes\n  3. Document any issues found\n  4. Send findings to team-lead via Teammate write\n`;\n\n// Bad\nprompt: \"Review the code\";\n```\n\n### 4. Use Task Dependencies\n\nLet the system manage unblocking:\n\n```javascript\n// Good: Auto-unblocking\nTaskUpdate({ taskId: \"2\", addBlockedBy: [\"1\"] });\n\n// Bad: Manual polling\n(\"Wait until task #1 is done, check every 30 seconds...\");\n```\n\n### 5. Check Inboxes for Results\n\nWorkers send results to your inbox. Check it:\n\n```bash\ncat ~/.claude/teams/{team}/inboxes/team-lead.json | jq '.'\n```\n\n### 6. Handle Worker Failures\n\n- Workers have 5-minute heartbeat timeout\n- Tasks of crashed workers can be reclaimed\n- Build retry logic into worker prompts\n\n### 7. Prefer write Over broadcast\n\n`broadcast` sends N messages for N teammates. Use `write` for targeted communication.\n\n### 8. Match Agent Type to Task\n\n- **Explore** for searching/reading\n- **Plan** for architecture design\n- **general-purpose** for implementation\n- **Specialized reviewers** for specific review types\n\n---\n\n## Quick Reference\n\n### Spawn Subagent (No Team)\n\n```javascript\nTask({ subagent_type: \"Explore\", description: \"Find files\", prompt: \"...\" });\n```\n\n### Spawn Teammate (With Team)\n\n```javascript\nTeammate({ operation: \"spawnTeam\", team_name: \"my-team\" });\nTask({\n  team_name: \"my-team\",\n  name: \"worker\",\n  subagent_type: \"general-purpose\",\n  prompt: \"...\",\n  run_in_background: true,\n});\n```\n\n### Message Teammate\n\n```javascript\nTeammate({ operation: \"write\", target_agent_id: \"worker-1\", value: \"...\" });\n```\n\n### Create Task Pipeline\n\n```javascript\nTaskCreate({ subject: \"Step 1\", description: \"...\" });\nTaskCreate({ subject: \"Step 2\", description: \"...\" });\nTaskUpdate({ taskId: \"2\", addBlockedBy: [\"1\"] });\n```\n\n### Shutdown Team\n\n```javascript\nTeammate({ operation: \"requestShutdown\", target_agent_id: \"worker-1\" });\n// Wait for approval...\nTeammate({ operation: \"cleanup\" });\n```\n",
        "skills/process-hunter/SKILL.md": "---\nname: process-hunter\ndescription: >\n  Find and terminate resource-hungry processes to save battery. Use when asked to\n  \"kill processes\", \"clean up dev servers\", \"save battery\", \"find resource hogs\",\n  \"stop next.js servers\", \"terminate claude sessions\", or \"hunt processes\".\n  Auto-terminates known safe targets (dev servers, duplicate Claude sessions).\n  Asks before killing unknown processes.\n---\n\n# Process Hunter\n\nFind processes consuming excessive CPU/memory and terminate them to preserve battery life.\n\n## Workflow\n\n1. Run `scripts/hunt_processes.py` to scan for resource hogs\n2. Review the categorized output:\n   - **AUTO-KILL**: Safe to terminate (dev servers, duplicate Claude sessions)\n   - **NEEDS CONFIRMATION**: Ask user before terminating\n3. Terminate processes using `scripts/terminate_process.py`\n\n## Usage\n\n### Scan for processes\n\n```bash\npython scripts/hunt_processes.py\n```\n\nOptions:\n- `--cpu-threshold PCT` - CPU threshold (default: 10%)\n- `--mem-threshold MB` - Memory threshold (default: 500MB)\n- `--json` - Output as JSON for programmatic use\n\n### Terminate a process\n\n```bash\npython scripts/terminate_process.py <pid>\n```\n\nOptions:\n- `--force` - Skip graceful shutdown, force kill immediately\n\n## Auto-Kill Targets\n\nThese are automatically categorized as safe to terminate:\n- Next.js dev servers (`next-server`, `next dev`)\n- Vite/Webpack dev servers\n- npm/yarn/pnpm dev scripts\n- React Native / Expo bundlers\n- Claude Code sessions (suggest killing duplicates)\n- TypeScript watch processes\n- esbuild/Rollup bundlers\n\n## When to Ask\n\nAlways ask user confirmation for:\n- Unknown high-resource processes\n- System-adjacent processes (even if not in ignore list)\n- Any process the user might have intentionally started\n\n## Example Session\n\n```\n$ python scripts/hunt_processes.py\n\nðŸŽ¯ AUTO-KILL (safe to terminate):\n------------------------------------------------------------\n  PID  61331 | CPU 121.9% | MEM 2886.5MB\n           | Next.js server: next-server\n  PID  73528 | CPU  30.6% | MEM  572.7MB\n           | Claude Code session: claude\n\nâ“ NEEDS CONFIRMATION:\n------------------------------------------------------------\n  PID  50706 | CPU   3.8% | MEM  834.5MB\n           | /Applications/Dia.app/Contents/MacOS/Dia\n```\n\nFor AUTO-KILL processes, terminate without asking (unless user wants to review).\nFor NEEDS CONFIRMATION, use AskUserQuestion before terminating.\n",
        "skills/proposal-review/SKILL.md": "---\nname: proposal-review\ndescription: Facilitate methodical review of proposals (technical designs, product specs, feature requests). Use when asked to \"review this proposal\", \"give feedback on this doc\", \"help me review this RFC\", or when presented with a document that needs structured feedback. Handles markdown files, GitHub gists/issues/PRs, and other text formats. Chunks proposals intelligently, predicts reviewer reactions, and produces feedback adapted to the proposal's format.\n---\n\n# Proposal Review\n\nMethodically review proposals by chunking content, predicting feedback, and producing actionable output for the proposer.\n\n## Workflow\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  1. INTAKE: Read entire proposal, identify source format    â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  2. CHUNK: Split into reviewable sections (smart hybrid)    â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  3. REVIEW LOOP: For each chunk:                            â”‚\nâ”‚     â€¢ Present chunk content                                 â”‚\nâ”‚     â€¢ Predict 3-4 likely reactions                          â”‚\nâ”‚     â€¢ Use AskUserQuestion for feedback                      â”‚\nâ”‚     â€¢ Record response                                       â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  4. SYNTHESIZE: Compile feedback, infer overall sentiment   â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  5. OUTPUT: Generate feedback document matching source      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Phase 1: Intake\n\nRead the entire proposal. Identify:\n\n- **Source format**: Local file, GitHub PR/issue/gist, Google Doc export, etc.\n- **Structure**: Headers, sections, numbered lists, or flowing prose\n- **Length**: Estimate chunk count (aim for 3-8 chunks for typical proposals)\n\nDo not summarize or share initial impressions. Proceed directly to chunking.\n\n## Phase 2: Chunking Strategy\n\nUse smart hybrid chunking:\n\n| Proposal Structure | Chunking Approach |\n|-------------------|-------------------|\n| Clear headers/sections | One chunk per major section |\n| Large section (>500 words) | Split at natural paragraph breaks |\n| Small adjacent sections (<100 words each) | Merge into single chunk |\n| Numbered lists of items | Group 3-5 related items per chunk |\n| Flowing prose without structure | Split at topic transitions (~300-400 words) |\n\n**Chunk ordering**: Present in document order unless there's a clear dependency (e.g., \"Alternatives\" before \"Proposed Solution\" if alternatives inform the solution review).\n\n## Phase 3: Review Loop\n\nFor each chunk:\n\n### 3.1 Present the Chunk\n\nQuote or summarize the chunk content. For longer chunks, quote key sentences and summarize the rest. Use a clear header like:\n\n```\n### Chunk 2 of 5: Technical Architecture\n```\n\n### 3.2 Predict Reactions\n\nGenerate 3-4 predicted reactions spanning these categories:\n\n| Category | Example Predictions |\n|----------|-------------------|\n| **Clarification** | \"This is unclearâ€”what does X mean?\", \"How does this interact with Y?\" |\n| **Concern** | \"This scope seems too large\", \"Have you considered Z risk?\" |\n| **Approval** | \"This approach makes sense\", \"Good tradeoff analysis\" |\n| **Suggestion** | \"Consider alternative A\", \"This needs more detail on B\" |\n\nSelect predictions that feel most relevant to this specific chunk. Not every chunk needs all categories.\n\n### 3.3 Collect Feedback\n\nUse AskUserQuestion with:\n- Predicted reactions as options (2-4 most likely)\n- User can select one OR provide custom feedback via \"Other\"\n- Keep option labels concise (under 10 words), use description for detail\n\nExample:\n\n```\nquestion: \"What's your reaction to this technical architecture section?\"\nheader: \"Architecture\"\noptions:\n  - label: \"Looks good\"\n    description: \"The proposed architecture is sound and well-reasoned\"\n  - label: \"Scope concern\"\n    description: \"This feels too ambitious for the timeline\"\n  - label: \"Need clarification\"\n    description: \"Some technical details are unclear or missing\"\n  - label: \"Consider alternative\"\n    description: \"There may be a simpler or better approach\"\n```\n\n### 3.4 Record Response\n\nStore each response with:\n- Chunk identifier (number + title)\n- Selected option or custom text\n- Any quoted content the feedback references\n\n## Phase 4: Synthesis\n\nAfter all chunks reviewed:\n\n1. **Group feedback by theme**: Consolidate similar concerns across chunks\n2. **Infer overall sentiment**: Based on feedback distribution:\n   - Mostly approvals â†’ Positive with minor suggestions\n   - Mixed â†’ Conditional support, needs revisions\n   - Mostly concerns â†’ Significant issues to address\n3. **Identify patterns**: Note if same concern appears multiple times\n\nThen ask:\n\n```\nquestion: \"Would you like me to include suggested next steps for the proposer?\"\nheader: \"Next Steps\"\noptions:\n  - label: \"Yes, include action items\"\n    description: \"Generate concrete next steps based on feedback\"\n  - label: \"No, just the feedback\"\n    description: \"Keep output to observations and reactions only\"\n```\n\n## Phase 5: Output Generation\n\nAdapt output format to source:\n\n| Source | Output Format |\n|--------|--------------|\n| GitHub PR | PR review comment with quoted lines and threaded feedback |\n| GitHub Issue | Comment with sections matching issue structure |\n| Markdown file | Companion `*-feedback.md` with inline references |\n| Google Doc | Structured comment list with section references |\n| Generic/unknown | Structured markdown with clear sections |\n\n### Output Structure\n\n```markdown\n## Feedback Summary\n\n**Overall**: [Inferred sentiment - 1 sentence]\n\n## Section-by-Section Feedback\n\n### [Section Name]\n[Feedback with quotes where relevant]\n\n### [Section Name]\n...\n\n## Key Themes\n- [Theme 1]: [Consolidated feedback]\n- [Theme 2]: ...\n\n## Next Steps (if requested)\n- [ ] [Action item 1]\n- [ ] [Action item 2]\n```\n\n### Tone Guidelines\n\n- Direct but constructive\n- Quote specific text when critiquing\n- Frame concerns as questions when possible (\"Have you considered...\" vs \"This won't work\")\n- Acknowledge what works, not just what doesn't\n\n## Edge Cases\n\n**Very short proposals (<300 words)**: Skip chunking, review as single unit with 4-5 predicted reactions.\n\n**Very long proposals (>3000 words)**: Cap at 8-10 chunks. Merge aggressively or offer to focus on specific sections.\n\n**Unclear structure**: Ask user which sections matter most before chunking.\n\n**Multiple proposals**: Review one at a time. Ask user for order preference if not obvious.\n",
        "skills/record-todos/SKILL.md": "---\nname: record-todos\ndescription: Enter todo recording mode to capture ideas without acting on them. Use when the user says \"record todos\", \"let's capture some todos\", \"brainstorm mode\", or wants to dump ideas without immediate execution. Captures thoughts to .claude/todos/, then organizes and prioritizes on exit.\n---\n\n# Todo Recording Mode\n\nCapture user's thoughts and ideas as todos without acting on them.\n\n## File Locations\n\nAll todo files live in `.claude/todos/`:\n- `.claude/todos/active.md` â€” Current todos\n- `.claude/todos/done.md` â€” Completed items\n- `.claude/todos/archive/done-{YYYY-MM}.md` â€” Archived completed items\n\n## During Recording\n\nWhen the user mentions something that should be done:\n\n1. **Acknowledge briefly** â€” \"Noted.\" or \"Got it.\"\n2. **Append to `.claude/todos/active.md`** as a raw item:\n   ```\n   - <what the user said, paraphrased if needed>\n   ```\n3. **Do NOT**:\n   - Start implementing\n   - Ask clarifying questions unless completely unclear\n   - Suggest solutions or alternatives\n   - Reorganize the file yet\n\n**Critical**: Any statement about what *should* happen is a todo to recordâ€”not an instruction to execute. This includes \"make X do Y\", \"add Z to W\", \"fix the layout\", etc.\n\nOnly perform immediate actions for administrative tasks unrelated to code changes (e.g., \"read this file\", \"explain how X works\").\n\nIf `.claude/todos/active.md` doesn't exist, create it with the structure from \"Rewrite active.md\" section.\n\n## Exit Triggers\n\nExit recording mode when user signals completion:\n- \"ok all done\", \"done recording\", \"that's all\", \"let's review\", \"end recording\"\n\n## On Exit: Summarize, Prioritize, Archive\n\n### 1. Archive Completed Items\n\n**Before reorganizing**, check for completed items:\n\n#### Move completed items to done.md\n\nScan for items marked `[x]`:\n1. Create/update `.claude/todos/done.md`\n2. Move completed items under dated section (e.g., `## January 2026`)\n3. Remove `[x]` checkboxâ€”use plain bullets in done.md\n4. Remove from active.md\n\n#### Archive if too large\n\nIf done.md exceeds 50 items or 500 lines:\n1. Create `.claude/todos/archive/done-{YYYY-MM}.md`\n2. Move older items (keep last 2 weeks in done.md)\n3. Add note: `*Older items archived in .claude/todos/archive/done-{date}.md*`\n\n**done.md structure:**\n```markdown\n# Completed Work\n\nArchive of completed features. See `.claude/todos/active.md` for active work.\n\n---\n\n## {Month Year}\n\n### {Category}\n- Description of what was done\n\n---\n\n*Older items archived in .claude/todos/archive/done-2025-12.md*\n```\n\n### 2. Find Project Goals\n\nSearch in order:\n1. **CLAUDE.md** â€” \"Goals\", \"Product Vision\", \"Objectives\" sections\n2. **.claude/todos/active.md** â€” Goals section at top\n\nIf no goals found:\n- Tell user: \"I couldn't find documented project goals. Before prioritizing, let's define what success looks like.\"\n- Establish 3-5 high-level goals\n- Record in active.md Goals section\n- Then proceed\n\n### 3. Summarize\n\nBrief conversational summary:\n- How many items captured\n- Themes or clusters noticed\n- Related items that could combine\n- Items complex enough for a spec document\n\n### 4. Prioritize Against Goals\n\nEvaluate each todo:\n- **ðŸŽ¯ Active** â€” Work on RIGHT NOW (1-3 max)\n- **ðŸ“‹ Next** â€” Ready to start when Active is done\n- **ðŸ’¡ Backlog** â€” Lower priority, needs scoping\n- **âš ï¸ Not Recommended** â€” Decided against (include rationale)\n\nFor complex features, suggest creating `.claude/docs/feature-{name}.md` spec.\n\n### 5. Rewrite active.md\n\nReplace raw items with organized structure:\n\n```markdown\n# TODO\n\n## Goals\n\n- <goal 1>\n- <goal 2>\n- <goal 3>\n\n---\n\n## ðŸŽ¯ Active\n\n*Currently in progress. Limit to 1-3 items.*\n\n- [ ] <highest priority item>\n\n---\n\n## ðŸ“‹ Next\n\n*Researched, scoped, ready to start.*\n\n### {Category if helpful}\n- [ ] <item>\n\n---\n\n## ðŸ’¡ Backlog\n\n*Ideas and lower priority items.*\n\n### {Category}\n- [ ] <item>\n\n### {Complex Feature}\n**Spec:** `.claude/docs/feature-{name}.md`\n- Brief description\n\n---\n\n## ðŸ“š Specs & Reference\n\n| Document | Description |\n|----------|-------------|\n| `.claude/docs/feature-x.md` | Spec for feature X |\n\n---\n\n## âš ï¸ Not Recommended\n\n### {Rejected idea}\n<Brief rationale>\n\n---\n\n*Completed work archived in `.claude/todos/done.md`*\n```\n\n**Adapt as needed:**\n- Skip empty sections\n- Items needing >3 lines â†’ spec document\n- Keep under ~100 lines of active content\n\n### 6. Confirm\n\nAfter rewriting:\n- Items per priority tier\n- Items moved to done.md\n- Specs to create for complex features\n- Ask if prioritization makes sense\n\n## Principles\n\n1. **active.md is for WHAT** â€” Scannable, action-oriented\n2. **Specs are for HOW** â€” `.claude/docs/` for detailed plans\n3. **done.md is for history** â€” Archive, don't delete\n4. **Link, don't embed** â€” Reference specs\n5. **Keep under 100 lines** â€” Move to spec or done.md if long\n",
        "skills/rust/SKILL.md": "---\nname: rust\ndescription: Robust Rust patterns for file-backed data, parsing, persistence, FFI boundaries, and system integration. Use when writing Rust that handles file formats, subprocess integration, PID/process management, Serde serialization, or UniFFI boundaries. Covers UTF-8 safety, atomic writes, state machines, and defensive error handling.\n---\n\n# Rust Engineering Guide\n\nPatterns for building reliable Rust systems that handle file-backed data, external process integration, and cross-language boundaries.\n\n## Core Philosophy\n\n**Conservative by Default**: Inputs from files, subprocesses, and external systems are untrusted.\n\n- Prefer false negatives over false positives\n- Same input â†’ same output (deterministic)\n- Never panic on user machines due to bad input\n\n**Canonical Model Ownership**: When Rust is the source of truth, maintain separate representations:\n\n| Layer | Purpose | Characteristics |\n|-------|---------|-----------------|\n| Internal domain | Business logic | Expressive enums, rich types |\n| FFI DTOs | Cross-language boundary | Flat, stable, `String`-heavy |\n| File format | Persistence | Versioned, round-trippable |\n| External input | Validation boundary | Strictly validated, never trusted |\n\n**Safe Rust Only**: None of these patterns require `unsafe`. Use ecosystem crates for safe abstractions.\n\n---\n\n## Reference Guides\n\nLoad the relevant reference when working in that domain:\n\n| Domain | Reference | When to Load |\n|--------|-----------|--------------|\n| **Data Modeling** | [references/data-modeling.md](references/data-modeling.md) | Serde patterns, UniFFI, strong types, versioned schemas |\n| **File I/O** | [references/file-io.md](references/file-io.md) | Atomic writes, concurrency control, file watching |\n| **Process Integration** | [references/process-integration.md](references/process-integration.md) | PID verification, subprocess handling, timestamps |\n| **Text & Parsing** | [references/text-and-parsing.md](references/text-and-parsing.md) | UTF-8 safety, path normalization, state machines |\n| **Testing** | [references/testing.md](references/testing.md) | Round-trip tests, fuzz testing, Clippy lints |\n\n---\n\n## Error Handling\n\n### Library vs Application Errors\n\n**Libraries** (public API): Use `thiserror` with granular error types per operation:\n\n```rust\n// File operations have their own error type\n#[derive(thiserror::Error, Debug)]\npub enum ReadError {\n    #[error(\"failed to read {path}\")]\n    Io { path: PathBuf, #[source] source: std::io::Error },\n\n    #[error(\"parse error at line {line}: {message}\")]\n    Parse { line: usize, message: String },\n}\n\n// Subprocess operations have their own error type\n#[derive(thiserror::Error, Debug)]\npub enum SubprocessError {\n    #[error(\"failed to spawn process\")]\n    Spawn(#[source] std::io::Error),\n\n    #[error(\"process exited with {code:?}: {stderr}\")]\n    NonZeroExit { code: Option<i32>, stderr: String },\n\n    #[error(\"output not valid UTF-8\")]\n    InvalidUtf8(#[source] std::str::Utf8Error),\n\n    #[error(\"timed out after {0:?}\")]\n    Timeout(std::time::Duration),\n}\n```\n\n**Applications** (internal/binary): Use `anyhow` for context-rich errors:\n\n```rust\nuse anyhow::{Context, Result};\n\nfn load_config(path: &Path) -> Result<Config> {\n    let content = std::fs::read_to_string(path)\n        .with_context(|| format!(\"failed to read config from {}\", path.display()))?;\n    // ...\n}\n```\n\n### Graceful Degradation\n\nErrors degrade functionality, not crash. But *log* when being lenient:\n\n```rust\nmatch parse_metadata(&line) {\n    Ok(meta) => entries.push(meta),\n    Err(e) => {\n        tracing::warn!(\"skipping malformed entry at line {}: {}\", line_num, e);\n        // Continue processing other entries\n    }\n}\n```\n\n---\n\n## Quick Reference\n\n### Do\n\n- Use `std::sync::LazyLock` for static regex (Rust 1.80+)\n- Hold locks across entire read-modify-write cycles\n- Add `#[serde(deny_unknown_fields)]` for strict external input\n- Truncate strings with `.chars()` or graphemes, not byte slicing\n- Write files atomically with `sync_all()` before rename\n- Verify PID identity with process start time\n- Use `saturating_sub` for time arithmetic\n- Run `cargo clippy -- -D warnings` and `cargo fmt` before commit\n\n### Don't\n\n- Use `#[from]` without adding context (loses *which* file failed)\n- Create monolithic error enums spanning unrelated operations\n- Silently ignore errors without logging\n- Slice strings with `&s[..N]` (panics on char boundaries)\n- Assume directory iteration order is stable\n- Trust subprocess output without validation\n- Use `unsafe` (not needed for these patterns)\n\n---\n\n## Bugs This Guide Prevents\n\n| Bug | Pattern | Reference |\n|-----|---------|-----------|\n| PID reuse \"ghost sessions\" | Store + verify process start time | [process-integration.md](references/process-integration.md) |\n| Timestamp unit mismatch (sec vs ms) | Normalize on read | [process-integration.md](references/process-integration.md) |\n| UTF-8 panic on truncation | Use `.chars().take(n)` | [text-and-parsing.md](references/text-and-parsing.md) |\n| Lost updates under concurrency | Lock spans full read-modify-write | [file-io.md](references/file-io.md) |\n| Corrupt file on power loss | `sync_all()` before rename | [file-io.md](references/file-io.md) |\n| Silent metadata corruption | Anchor updates to heading lines | [text-and-parsing.md](references/text-and-parsing.md) |\n| Old data breaks new code | `#[serde(default)]` + `alias` | [data-modeling.md](references/data-modeling.md) |\n\n---\n\n## Change Checklist\n\nWhen modifying these systems, verify:\n\n**Schema / Serde**\n- [ ] New fields use `Option` + `#[serde(default)]`\n- [ ] Old field names supported via `alias` (read) or `rename` (write)\n- [ ] External input uses `#[serde(deny_unknown_fields)]`\n\n**Concurrency**\n- [ ] Mutex held across entire read-modify-write cycle\n- [ ] Shared state uses `Mutex<T>`, not `thread_local!`\n- [ ] File locking documents platform caveats if used\n\n**Robustness**\n- [ ] No panics on file I/O or parse errors\n- [ ] Errors logged before being ignored\n- [ ] Subprocesses have timeouts\n\n**Quality**\n- [ ] `cargo clippy -- -D warnings` passes\n- [ ] `cargo fmt --check` passes\n- [ ] No `unsafe` blocks (unless justified and audited)\n",
        "skills/rust/references/data-modeling.md": "# Data Modeling\n\nPatterns for Serde serialization, FFI boundaries, and type safety.\n\n## Table of Contents\n\n- [Strong Types Over Strings](#strong-types-over-strings)\n- [Serde Patterns](#serde-patterns)\n- [UniFFI Boundaries](#uniffi-boundaries)\n- [Lookup by Primary Key](#lookup-by-primary-key)\n\n---\n\n## Strong Types Over Strings\n\nStrings for status/effort/triage lead to case-mismatch bugs. Use enums:\n\n```rust\n#[derive(Clone, Debug, Serialize, Deserialize, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum Status { Open, InProgress, Done, Dismissed }\n\n#[derive(Clone, Debug, Serialize, Deserialize, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum Priority { P0, P1, P2, P3 }\n```\n\n**Naming convention**: `rename_all = \"snake_case\"` serializes `InProgress` as `\"in_progress\"`. For JSON APIs expecting camelCase, use `rename_all = \"camelCase\"`.\n\n---\n\n## Serde Patterns\n\n### Versioned Data\n\nWhen adding fields to serialized structures, old data won't have them:\n\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct LockInfo {\n    pub pid: u32,\n    pub path: String,\n\n    #[serde(default)]\n    pub proc_started: Option<u64>,  // New field - absent in old data\n\n    #[serde(default, alias = \"started\")]\n    pub created: Option<u64>,       // Supports old field name\n}\n```\n\n**Key patterns**:\n\n| Attribute | Purpose | Read/Write |\n|-----------|---------|------------|\n| `#[serde(default)]` | Missing fields deserialize as `Default::default()` | Read |\n| `#[serde(alias = \"old\")]` | Accept old field name | Read only |\n| `#[serde(rename = \"new\")]` | Write as different name | Write |\n| `#[serde(skip_serializing_if = \"Option::is_none\")]` | Omit `None` values | Write |\n\n**Important**: `alias` is **read-only**. If writing data that old code will read, use `rename`:\n\n```rust\n// Old code expects \"started\", new code uses \"created\"\n#[serde(default, rename = \"started\")]  // Writes as \"started\"\npub created: Option<u64>,\n\n// Or be explicit about asymmetry\n#[serde(default, alias = \"started\", rename = \"created\")]\npub created: Option<u64>,  // Reads both, writes as \"created\"\n```\n\n### Strict External Input\n\nFor data from untrusted sources, use `deny_unknown_fields` to catch typos:\n\n```rust\n#[derive(Debug, Deserialize)]\n#[serde(deny_unknown_fields)]\npub struct ExternalConfig {\n    pub api_key: String,\n    pub endpoint: String,\n    // Typo like \"endpont\" will error instead of silently using default\n}\n```\n\n### Sentinel Values\n\nIf spec uses sentinel strings (e.g., `Related: None`) but your type is `Option<String>`:\n\n```rust\nfn parse_optional_field(raw: &str) -> Option<String> {\n    let t = raw.trim();\n    if t.is_empty() || t.eq_ignore_ascii_case(\"none\") {\n        None\n    } else {\n        Some(t.to_string())\n    }\n}\n```\n\nFor serde integration, use a custom deserializer:\n\n```rust\nfn deserialize_optional_sentinel<'de, D>(deserializer: D) -> Result<Option<String>, D::Error>\nwhere\n    D: serde::Deserializer<'de>,\n{\n    let s: Option<String> = Option::deserialize(deserializer)?;\n    Ok(s.and_then(|v| {\n        let t = v.trim();\n        if t.is_empty() || t.eq_ignore_ascii_case(\"none\") {\n            None\n        } else {\n            Some(t.to_string())\n        }\n    }))\n}\n```\n\n---\n\n## UniFFI Boundaries\n\nUniFFI works best with flat, stable types. Keep DTOs separate from domain models.\n\n### Basic DTO Pattern\n\n```rust\n// Internal domain model (expressive)\npub struct Idea {\n    pub id: Uuid,\n    pub created_at: DateTime<Utc>,\n    pub status: Status,\n    pub priority: Option<Priority>,\n}\n\n// FFI DTO (flat, stable)\n#[derive(Clone, Debug, uniffi::Record)]\npub struct IdeaDto {\n    pub id: String,           // Uuid â†’ String at boundary\n    pub created_at_ms: i64,   // DateTime â†’ epoch ms\n    pub status: String,       // Or use uniffi::Enum\n    pub priority: Option<String>,\n}\n\nimpl From<Idea> for IdeaDto {\n    fn from(idea: Idea) -> Self {\n        Self {\n            id: idea.id.to_string(),\n            created_at_ms: idea.created_at.timestamp_millis(),\n            status: format!(\"{:?}\", idea.status).to_lowercase(),\n            priority: idea.priority.map(|p| format!(\"{:?}\", p).to_lowercase()),\n        }\n    }\n}\n```\n\n### Enums vs Strings\n\n**Use `uniffi::Enum`** for closed sets where type safety matters:\n\n```rust\n#[derive(Clone, Debug, uniffi::Enum)]\npub enum StatusDto {\n    Open,\n    InProgress,\n    Done,\n    Dismissed,\n    #[uniffi(default)]\n    Unknown { value: String },  // Forward-compatible\n}\n```\n\nThe `#[uniffi(default)]` variant handles unknown values gracefullyâ€”foreign code receives `Unknown` instead of crashing on new variants.\n\n**Use strings** when:\n- The set is truly open-ended\n- You can't regenerate bindings when adding variants\n- Stability trumps type safety\n\n### What to Avoid in FFI\n\n| Avoid | Why | Use Instead |\n|-------|-----|-------------|\n| `Uuid` | Not FFI-friendly | `String` |\n| `DateTime<Utc>` | Complex type | `i64` (epoch ms) |\n| Enums with data | Limited support | Flat enums or separate fields |\n| Nested structs | Harder to maintain | Flatten or separate calls |\n| `HashMap` | Limited in some targets | `Vec<(K, V)>` |\n\n---\n\n## Lookup by Primary Key\n\nUse the resolved record's **primary key** for subsequent lookups, not secondary attributes:\n\n```rust\n// BAD: Secondary lookup could return different record\nlet resolved = resolve_state(&store, project_path)?;\nlet record = store.find_by_cwd(&resolved.cwd);  // Could match Session B!\n\n// GOOD: Use the resolved session_id\nlet resolved = resolve_state(&store, project_path)?;\nlet record = resolved.session_id\n    .as_deref()\n    .and_then(|id| store.get_by_session_id(id));\n```\n\n**Why this matters**: Secondary attributes (like `cwd`) can match multiple records. After resolving to a specific record, always use its unique identifier for subsequent operations to avoid TOCTOU (time-of-check-to-time-of-use) bugs.\n",
        "skills/rust/references/file-io.md": "# File I/O & Persistence\n\nPatterns for durable writes, concurrency, and file watching.\n\n## Table of Contents\n\n- [Atomic Writes](#atomic-writes)\n- [Concurrency Control](#concurrency-control)\n- [File Watching](#file-watching)\n- [When NOT to Use Atomic Writes](#when-not-to-use-atomic-writes)\n\n---\n\n## Atomic Writes\n\nWrite to temp file, sync to disk, then rename:\n\n```rust\nuse std::{io::Write, path::Path};\nuse tempfile::NamedTempFile;\n\nfn atomic_write(path: &Path, contents: &str) -> std::io::Result<()> {\n    // Create temp file in SAME directory as target.\n    // Why: rename() fails across filesystem boundaries.\n    let dir = path.parent().unwrap_or_else(|| Path::new(\".\"));\n    let mut tmp = NamedTempFile::new_in(dir)?;\n\n    tmp.write_all(contents.as_bytes())?;\n    tmp.flush()?;\n\n    // Critical: ensure OS flushes to disk BEFORE rename.\n    // Without this, power loss after rename could leave truncated file.\n    tmp.as_file().sync_all()?;\n\n    tmp.persist(path).map(|_| ()).map_err(|e| e.error)\n}\n```\n\n**Durable-First Invariant**: Never gate persistence on validation or subprocess output:\n\n1. Write raw data to storage (e.g., `status: pending`)\n2. Return control immediately\n3. Async enrichment updates later (or not at all)\n\n---\n\n## Concurrency Control\n\n### In-Process: Mutex Across Full Operation\n\nA `Mutex` protects the in-memory state, but the lock must span the **entire** read-modify-write cycle:\n\n```rust\nuse std::sync::Mutex;\nuse std::path::Path;\n\nstruct FileState {\n    data: MyData,\n}\n\nstatic STATE: Mutex<FileState> = Mutex::new(FileState { data: MyData::default() });\n\nfn update_file(path: &Path, change: Change) -> std::io::Result<()> {\n    // Lock held from read through write\n    let mut state = STATE.lock().unwrap();\n\n    // Re-read file to get latest (another process may have changed it)\n    let current = std::fs::read_to_string(path)?;\n    let mut data: MyData = serde_json::from_str(&current)?;\n\n    // Apply change\n    data.apply(change);\n\n    // Write back atomically\n    atomic_write(path, &serde_json::to_string_pretty(&data)?)?;\n\n    // Update in-memory state\n    state.data = data;\n\n    Ok(())\n    // Lock released here\n}\n```\n\n**Bug this prevents**: Without holding the lock across the full operation:\n\n1. Thread A reads file, releases lock\n2. Thread B reads file, releases lock\n3. Thread A writes changes\n4. Thread B writes changes â†’ **Thread A's changes lost**\n\n### Out-of-Process: Advisory Locking\n\nFor coordination between separate processes, use advisory locks via `fs2`:\n\n```rust\nuse fs2::FileExt;\nuse std::fs::File;\n\nfn with_file_lock<T>(path: &Path, f: impl FnOnce() -> T) -> std::io::Result<T> {\n    let lock_file = File::create(path.with_extension(\"lock\"))?;\n    lock_file.lock_exclusive()?;  // Blocks until lock acquired\n\n    let result = f();\n\n    lock_file.unlock()?;\n    Ok(result)\n}\n```\n\n**Platform caveats** (document if using advisory locks):\n\n| Platform | Caveat |\n|----------|--------|\n| NFS | Advisory locks unreliable or unsupported depending on configuration |\n| macOS | `flock` locks are per-process, not per-file-descriptor |\n| Windows | Different locking semantics; consider `LockFileEx` |\n\nIf advisory locking is too complex, prefer merge-friendly designs:\n\n1. Re-read file immediately before write\n2. Apply patch to latest parsed model\n3. Write back atomically\n4. Accept that last-writer-wins on conflicts\n\n---\n\n## File Watching\n\nUse debounced file watchers for external edit detection:\n\n```rust\nuse notify::{Watcher, RecursiveMode, watcher};\nuse std::sync::mpsc::channel;\nuse std::time::Duration;\n\nfn watch_file(path: &Path) -> notify::Result<()> {\n    let (tx, rx) = channel();\n\n    // Debounce: editors save via multiple quick writes (temp + rename)\n    let mut watcher = watcher(tx, Duration::from_millis(200))?;\n    watcher.watch(path, RecursiveMode::NonRecursive)?;\n\n    loop {\n        match rx.recv() {\n            Ok(event) => {\n                // Re-parse file and compute diff\n                // Send \"data changed\" notification (avoid huge payloads)\n            }\n            Err(e) => break,\n        }\n    }\n    Ok(())\n}\n```\n\n**Threading model**: The watcher thread should only push events. A separate model thread owns the data and processes events via channel. This avoids shared mutable state.\n\n---\n\n## When NOT to Use Atomic Writes\n\nAtomic writes aren't always the right choice:\n\n| Scenario | Better Approach |\n|----------|-----------------|\n| Append-only logs | Direct append with `fsync` |\n| Large files, small updates | In-place modification with record locking |\n| Write-ahead logs | Append + checkpoint |\n| Streaming data | Buffered writes with periodic sync |\n\nFor append-only patterns:\n\n```rust\nuse std::fs::OpenOptions;\nuse std::io::Write;\n\nfn append_log(path: &Path, entry: &str) -> std::io::Result<()> {\n    let mut file = OpenOptions::new()\n        .create(true)\n        .append(true)\n        .open(path)?;\n\n    writeln!(file, \"{}\", entry)?;\n    file.sync_all()?;  // Ensure durability\n    Ok(())\n}\n```\n",
        "skills/rust/references/process-integration.md": "# Process & System Integration\n\nPatterns for PID verification, subprocess handling, and timestamps.\n\n## Table of Contents\n\n- [PID Liveness vs Identity](#pid-liveness-vs-identity)\n- [Process Start Time](#process-start-time)\n- [Subprocess Integration](#subprocess-integration)\n- [Timestamp Handling](#timestamp-handling)\n- [Async Considerations](#async-considerations)\n\n---\n\n## PID Liveness vs Identity\n\n`kill(pid, 0)` checks if a PID exists, **not** if it's the same process. PID reuse creates \"ghost\" sessions where you think you're talking to process A but the PID was recycled to process B.\n\n**Solution**: Store and verify process start time alongside PID:\n\n```rust\npub fn is_pid_alive_verified(pid: u32, expected_start: Option<u64>) -> bool {\n    let Some(expected) = expected_start else {\n        // Legacy data without start timeâ€”use fallback\n        return is_pid_alive_legacy(pid);\n    };\n\n    match get_process_start_time(pid) {\n        Some(actual) => actual == expected,\n        None => false,  // Process doesn't exist\n    }\n}\n\nfn is_pid_alive_legacy(pid: u32) -> bool {\n    // Fallback: existence check only (prone to PID reuse bugs)\n    unsafe { libc::kill(pid as i32, 0) == 0 }\n}\n```\n\n### Legacy Mitigation\n\nFor legacy data without `proc_started`, use defense-in-depth:\n\n1. **Existence check**: `kill(pid, 0)` as baseline\n2. **Identity heuristic**: Process name contains expected string (e.g., \"claude\")\n3. **Age expiry**: Expire unverified entries after 24h\n\n```rust\nfn is_legacy_pid_valid(pid: u32, expected_name: &str, max_age: Duration, created_at: u64) -> bool {\n    if !is_pid_alive_legacy(pid) {\n        return false;\n    }\n\n    // Check process name matches expected\n    if let Some(name) = get_process_name(pid) {\n        if !name.to_lowercase().contains(&expected_name.to_lowercase()) {\n            return false;\n        }\n    }\n\n    // Expire old entries\n    let age = SystemTime::now()\n        .duration_since(UNIX_EPOCH)\n        .unwrap()\n        .as_secs()\n        .saturating_sub(created_at);\n\n    age < max_age.as_secs()\n}\n```\n\n---\n\n## Process Start Time\n\nCache `sysinfo::System` to avoid repeated expensive allocations. Use shared state, not thread-local:\n\n```rust\nuse std::sync::{LazyLock, Mutex};\nuse sysinfo::{Pid, ProcessRefreshKind, RefreshKind, System};\n\nstatic SYSTEM_CACHE: LazyLock<Mutex<System>> = LazyLock::new(|| {\n    Mutex::new(System::new_with_specifics(\n        RefreshKind::new().with_processes(ProcessRefreshKind::new()),\n    ))\n});\n\npub fn get_process_start_time(pid: u32) -> Option<u64> {\n    let mut sys = SYSTEM_CACHE.lock().unwrap();\n    sys.refresh_processes_specifics(ProcessRefreshKind::new());\n    sys.process(Pid::from(pid as usize)).map(|p| p.start_time())\n}\n\npub fn get_process_name(pid: u32) -> Option<String> {\n    let mut sys = SYSTEM_CACHE.lock().unwrap();\n    sys.refresh_processes_specifics(ProcessRefreshKind::new());\n    sys.process(Pid::from(pid as usize)).map(|p| p.name().to_string_lossy().into_owned())\n}\n```\n\n**Note**: The cache accumulates process data that never clears. For long-running daemons processing many PIDs, consider periodic `sys.refresh_all()` or dropping/recreating the System.\n\n---\n\n## Subprocess Integration\n\nTreat subprocess output as **hostile input**. Always:\n\n1. Set timeouts\n2. Handle non-UTF-8 output\n3. Capture stderr for error context\n\n### With Timeout (using wait-timeout crate)\n\n```rust\nuse std::process::{Command, Stdio, Child};\nuse std::io::Write;\nuse std::time::Duration;\nuse wait_timeout::ChildExt;\n\n#[derive(thiserror::Error, Debug)]\npub enum SubprocessError {\n    #[error(\"failed to spawn: {0}\")]\n    Spawn(#[source] std::io::Error),\n\n    #[error(\"failed to write stdin: {0}\")]\n    Stdin(#[source] std::io::Error),\n\n    #[error(\"timed out after {0:?}\")]\n    Timeout(Duration),\n\n    #[error(\"exited with {code:?}: {stderr}\")]\n    NonZeroExit { code: Option<i32>, stderr: String },\n\n    #[error(\"output not valid UTF-8\")]\n    InvalidUtf8(#[source] std::str::Utf8Error),\n}\n\npub fn run_subprocess(\n    cmd: &str,\n    args: &[&str],\n    stdin_payload: &str,\n    timeout: Duration,\n) -> Result<String, SubprocessError> {\n    let mut child = Command::new(cmd)\n        .args(args)\n        .stdin(Stdio::piped())\n        .stdout(Stdio::piped())\n        .stderr(Stdio::piped())\n        .spawn()\n        .map_err(SubprocessError::Spawn)?;\n\n    // Write stdin and close it\n    if let Some(mut stdin) = child.stdin.take() {\n        stdin.write_all(stdin_payload.as_bytes())\n            .map_err(SubprocessError::Stdin)?;\n    }\n\n    // Wait with timeout\n    match child.wait_timeout(timeout).map_err(SubprocessError::Spawn)? {\n        Some(status) => {\n            let output = child.wait_with_output().map_err(SubprocessError::Spawn)?;\n\n            if !status.success() {\n                return Err(SubprocessError::NonZeroExit {\n                    code: status.code(),\n                    stderr: String::from_utf8_lossy(&output.stderr).into_owned(),\n                });\n            }\n\n            String::from_utf8(output.stdout)\n                .map_err(|e| SubprocessError::InvalidUtf8(e.utf8_error()))\n        }\n        None => {\n            // Timed outâ€”kill the process\n            let _ = child.kill();\n            Err(SubprocessError::Timeout(timeout))\n        }\n    }\n}\n```\n\n### Handling Non-UTF-8 Output\n\nIf the subprocess might emit non-UTF-8 (binary data, different encoding):\n\n```rust\n// Lossy: replace invalid sequences with replacement character\nlet output = String::from_utf8_lossy(&output.stdout).into_owned();\n\n// Strict with context\nlet output = String::from_utf8(output.stdout)\n    .map_err(|e| SubprocessError::InvalidUtf8(e.utf8_error()))?;\n```\n\n---\n\n## Timestamp Handling\n\nThe #1 timestamp bug: **unit mismatch** (seconds vs milliseconds).\n\n### Normalization\n\n```rust\nconst MS_THRESHOLD: u64 = 1_000_000_000_000;  // ~31,688 years in ms\n\nfn normalize_epoch_to_secs(v: u64) -> u64 {\n    if v >= MS_THRESHOLD { v / 1000 } else { v }\n}\n\nfn normalize_epoch_to_ms(v: u64) -> u64 {\n    if v < MS_THRESHOLD { v * 1000 } else { v }\n}\n```\n\n### Safe Arithmetic\n\nUse `saturating_sub` to prevent underflow:\n\n```rust\nlet now = SystemTime::now()\n    .duration_since(UNIX_EPOCH)\n    .unwrap()\n    .as_secs();\n\nlet age_secs = now.saturating_sub(created_at);\n```\n\n### ISO Timestamp Parsing\n\nFor legacy data with string timestamps:\n\n```rust\nfn parse_rfc3339_to_secs(s: &str) -> Option<u64> {\n    chrono::DateTime::parse_from_rfc3339(s)\n        .ok()\n        .map(|dt| dt.timestamp() as u64)\n}\n```\n\n---\n\n## Async Considerations\n\nThis guide focuses on **synchronous** patterns. For async subprocess handling:\n\n- Use `tokio::process::Command` instead of `std::process::Command`\n- Timeout via `tokio::time::timeout`\n- Consider `async-process` crate for async-std\n\nExample with tokio:\n\n```rust\nuse tokio::process::Command;\nuse tokio::time::{timeout, Duration};\n\nasync fn run_subprocess_async(\n    cmd: &str,\n    args: &[&str],\n    timeout_duration: Duration,\n) -> Result<String, SubprocessError> {\n    let output = timeout(\n        timeout_duration,\n        Command::new(cmd)\n            .args(args)\n            .output()\n    )\n    .await\n    .map_err(|_| SubprocessError::Timeout(timeout_duration))?\n    .map_err(SubprocessError::Spawn)?;\n\n    if !output.status.success() {\n        return Err(SubprocessError::NonZeroExit {\n            code: output.status.code(),\n            stderr: String::from_utf8_lossy(&output.stderr).into_owned(),\n        });\n    }\n\n    String::from_utf8(output.stdout)\n        .map_err(|e| SubprocessError::InvalidUtf8(e.utf8_error()))\n}\n```\n\nFor async file I/O, see [tokio::fs](https://docs.rs/tokio/latest/tokio/fs/) or [async-std::fs](https://docs.rs/async-std/latest/async_std/fs/).\n",
        "skills/rust/references/testing.md": "# Testing & Quality\n\nTesting strategies and quality tooling for robust Rust systems.\n\n## Table of Contents\n\n- [Unit Tests](#unit-tests)\n- [Property and Fuzz Testing](#property-and-fuzz-testing)\n- [Integration Tests](#integration-tests)\n- [Essential Test Cases](#essential-test-cases)\n- [Quality Tools](#quality-tools)\n\n---\n\n## Unit Tests\n\n### Round-Trip Tests\n\nVerify parse â†’ serialize â†’ parse produces identical data:\n\n```rust\n#[test]\nfn round_trip_preserves_data() {\n    let original = MyData {\n        id: \"abc123\".to_string(),\n        value: 42,\n        optional: Some(\"test\".to_string()),\n    };\n\n    let serialized = serde_json::to_string(&original).unwrap();\n    let deserialized: MyData = serde_json::from_str(&serialized).unwrap();\n\n    assert_eq!(original, deserialized);\n}\n```\n\n### Mutation Tests\n\nVerify updates only touch intended fields:\n\n```rust\n#[test]\nfn update_preserves_other_fields() {\n    let mut data = create_test_data();\n    let original_id = data.id.clone();\n    let original_created = data.created_at;\n\n    data.update_status(Status::Done);\n\n    assert_eq!(data.id, original_id, \"ID should not change\");\n    assert_eq!(data.created_at, original_created, \"created_at should not change\");\n    assert_eq!(data.status, Status::Done, \"status should update\");\n}\n```\n\n### Normalization Tests\n\nVerify case-insensitive values parse equivalently:\n\n```rust\n#[test]\nfn status_parsing_case_insensitive() {\n    assert_eq!(parse_status(\"open\"), parse_status(\"OPEN\"));\n    assert_eq!(parse_status(\"in_progress\"), parse_status(\"In_Progress\"));\n}\n```\n\n---\n\n## Property and Fuzz Testing\n\n### Property Tests with proptest\n\nGenerate random inputs and verify invariants:\n\n```rust\nuse proptest::prelude::*;\n\nproptest! {\n    #[test]\n    fn parser_never_panics(s in \"\\\\PC*\") {\n        // Parser should handle any input without panicking\n        let _ = parse_document(&s);\n    }\n\n    #[test]\n    fn ids_preserved_through_round_trip(id in \"[a-zA-Z0-9]{1,26}\") {\n        let doc = format!(\"### [#idea-{id}] Test\\nStatus: open\\n---\\n\");\n        let parsed = parse_document(&doc).unwrap();\n        assert!(parsed.blocks.iter().any(|b| b.id == id));\n    }\n}\n```\n\n### Fuzz Testing\n\nFor deeper coverage of parser edge cases:\n\n```bash\ncargo install cargo-fuzz\ncargo fuzz init\ncargo fuzz run parse_fuzz_target\n```\n\nA fuzz target:\n\n```rust\n#![no_main]\nuse libfuzzer_sys::fuzz_target;\n\nfuzz_target!(|data: &[u8]| {\n    if let Ok(s) = std::str::from_utf8(data) {\n        // Should never panic\n        let _ = my_crate::parse(s);\n    }\n});\n```\n\nFuzz testing finds edge cases proptest may missâ€”particularly valuable for parsers and string processing.\n\n---\n\n## Integration Tests\n\n### Golden Files\n\nStore expected outputs in `tests/fixtures/`:\n\n```rust\n#[test]\nfn transform_matches_golden() {\n    let input = include_str!(\"fixtures/input.md\");\n    let expected = include_str!(\"fixtures/expected_output.md\");\n\n    let actual = transform(input);\n\n    assert_eq!(actual, expected);\n}\n```\n\n### Contract Tests\n\nCreate fixtures representing real-world scenarios:\n\n```\ntests/fixtures/\nâ”œâ”€â”€ valid_complete.json      # All fields present\nâ”œâ”€â”€ legacy_old_names.json    # Uses old field names (alias)\nâ”œâ”€â”€ missing_timestamps.json  # Optional fields absent\nâ”œâ”€â”€ corrupted.json           # Invalid JSON\nâ””â”€â”€ unit_mismatch.json       # Timestamps in ms instead of sec\n```\n\n### Subprocess Tests\n\nDon't depend on real external processes in CI:\n\n```rust\n#[test]\nfn handles_subprocess_timeout() {\n    // Create a fake executable that sleeps forever\n    let fake_cmd = create_fake_command(\"sleep\", \"999\");\n\n    let result = run_subprocess(&fake_cmd, &[], \"\", Duration::from_millis(100));\n\n    assert!(matches!(result, Err(SubprocessError::Timeout(_))));\n}\n\n#[test]\nfn handles_subprocess_failure() {\n    let fake_cmd = create_fake_command(\"exit\", \"1\");\n\n    let result = run_subprocess(&fake_cmd, &[], \"\", Duration::from_secs(5));\n\n    assert!(matches!(result, Err(SubprocessError::NonZeroExit { .. })));\n}\n```\n\n---\n\n## Essential Test Cases\n\nEach test case maps to a specific bug this guide prevents:\n\n| Test Case | Bug Prevented | Related Pattern |\n|-----------|---------------|-----------------|\n| Version marker missing â†’ error | Silent format mismatch | [text-and-parsing.md](text-and-parsing.md) |\n| Empty file initializes properly | Crash on empty input | Graceful degradation |\n| Metadata in body stays in body | Silent corruption | [Anchored updates](text-and-parsing.md#anchored-updates) |\n| Update affects only target block | Wrong block modified | [State machine parsing](text-and-parsing.md#state-machine-parsing) |\n| Duplicate IDs handled deterministically | Undefined behavior | [Duplicate ID handling](text-and-parsing.md#duplicate-id-handling) |\n| Mismatched PID rejected | Ghost sessions | [PID verification](process-integration.md#pid-liveness-vs-identity) |\n| Timestamp unit mismatch normalized | Age calculation bugs | [Timestamp handling](process-integration.md#timestamp-handling) |\n| Old field names still work | Breaking old data | [Versioned data](data-modeling.md#versioned-data) |\n| Concurrent updates don't lose data | Lost updates | [Mutex across operation](file-io.md#in-process-mutex-across-full-operation) |\n\n### Example Test Suite\n\n```rust\n#[cfg(test)]\nmod essential_tests {\n    use super::*;\n\n    #[test]\n    fn rejects_missing_version_marker() {\n        let content = \"### [#idea-ABC] No version marker\\nStatus: open\\n---\\n\";\n        let result = parse_document(content);\n        assert!(matches!(result, Err(ParseError::UnsupportedFormat { .. })));\n    }\n\n    #[test]\n    fn empty_file_returns_empty_result() {\n        let result = parse_document(\"\").unwrap();\n        assert!(result.blocks.is_empty());\n    }\n\n    #[test]\n    fn metadata_in_body_not_parsed_as_field() {\n        let content = r#\"\n### [#idea-ABC] Test\nStatus: open\n---\nThis body mentions Status: done but it's not metadata\n\"#;\n        let parsed = parse_document(content).unwrap();\n        let block = &parsed.blocks[0];\n\n        assert_eq!(block.get_field(\"Status\"), Some(\"open\"));\n        assert!(block.body.contains(\"Status: done\"));\n    }\n\n    #[test]\n    fn update_only_affects_target_block() {\n        let content = r#\"\n### [#idea-AAA] First\nStatus: open\n---\n\n### [#idea-BBB] Second\nStatus: open\n---\n\"#;\n        let updated = update_block_field(content, \"AAA\", \"Status\", \"done\");\n        let parsed = parse_document(&updated).unwrap();\n\n        assert_eq!(parsed.blocks[0].get_field(\"Status\"), Some(\"done\"));\n        assert_eq!(parsed.blocks[1].get_field(\"Status\"), Some(\"open\"));\n    }\n}\n```\n\n---\n\n## Quality Tools\n\n### Pre-Commit Checks\n\nAll code should pass before commit:\n\n```bash\ncargo fmt --check\ncargo clippy -- -D warnings\ncargo test\n```\n\n### Strict Clippy Lints\n\nFor library code, add to `Cargo.toml`:\n\n```toml\n[lints.clippy]\nunwrap_used = \"warn\"\nexpect_used = \"warn\"\npanic = \"warn\"\nindexing_slicing = \"warn\"\n```\n\n**Note**: `unwrap_used` will warn on `Regex::new(...).unwrap()`. Use `#[allow(clippy::unwrap_used)]` locally for known-good cases, or use `.expect(\"reason\")`:\n\n```rust\nuse std::sync::LazyLock;\nuse regex::Regex;\n\nstatic HEADING_RE: LazyLock<Regex> = LazyLock::new(|| {\n    #[allow(clippy::unwrap_used)]  // Regex is compile-time constant\n    Regex::new(r\"^### \\[#idea-([0-9A-Z]+)\\]\").unwrap()\n});\n```\n\n### Test Edge Cases\n\nParsers and string processing should be tested with:\n\n- Empty strings\n- Strings that are all whitespace\n- Very long lines (> 10KB)\n- Mixed line endings (`\\n`, `\\r\\n`, `\\r`)\n- UTF-8 edge cases (emoji, combining characters, RTL text)\n- Embedded NUL bytes (if accepting `&[u8]`)\n- BOM at start of file\n",
        "skills/rust/references/text-and-parsing.md": "# Text & Parsing\n\nPatterns for UTF-8 safety, path normalization, state machine parsing, and round-trip preservation.\n\n## Table of Contents\n\n- [UTF-8 Safe Truncation](#utf-8-safe-truncation)\n- [Path Normalization](#path-normalization)\n- [Case Normalization](#case-normalization)\n- [State Machine Parsing](#state-machine-parsing)\n- [Anchored Updates](#anchored-updates)\n- [Round-Trip Preservation](#round-trip-preservation)\n- [Line Endings and BOM](#line-endings-and-bom)\n\n---\n\n## UTF-8 Safe Truncation\n\nIndexing with byte offsets (`&s[..60]`) **panics** if the index isn't on a character boundary.\n\n### When to Use Each Approach\n\n| Use Case | Method | Example |\n|----------|--------|---------|\n| Display width limits | Grapheme clusters | UI truncation, terminal output |\n| User-facing \"character count\" | Grapheme clusters | Twitter-like limits |\n| Internal indexing | Byte offsets with snap-to-boundary | Text editors, search |\n| Simple ASCII-heavy text | Characters (`.chars()`) | Config files, identifiers |\n\n### By Characters (efficient)\n\n```rust\nfn truncate_chars(s: &str, max_chars: usize) -> String {\n    let mut chars = s.chars();\n    let truncated: String = chars.by_ref().take(max_chars).collect();\n\n    // Check if there's more content (single iteration, not two)\n    if chars.next().is_some() {\n        format!(\"{truncated}...\")\n    } else {\n        truncated\n    }\n}\n```\n\n### By Grapheme Clusters (emoji-safe)\n\n```rust\nuse unicode_segmentation::UnicodeSegmentation;\n\nfn truncate_graphemes(s: &str, max_graphemes: usize) -> String {\n    let mut graphemes = s.graphemes(true);\n    let truncated: String = graphemes.by_ref().take(max_graphemes).collect();\n\n    if graphemes.next().is_some() {\n        format!(\"{truncated}...\")\n    } else {\n        s.to_string()\n    }\n}\n```\n\n**Note**: For terminal display width, neither chars nor graphemes is fully correctâ€”you need East Asian width handling. Consider the `unicode-width` crate.\n\n---\n\n## Path Normalization\n\nUse a single normalizer for all comparisons and hashing:\n\n```rust\nuse std::path::{Path, PathBuf};\n\nfn normalize_path(path: &str) -> String {\n    let mut result = path.trim_end_matches(['/', '\\\\']).to_string();\n\n    // Collapse consecutive slashes\n    while result.contains(\"//\") {\n        result = result.replace(\"//\", \"/\");\n    }\n\n    // Handle empty â†’ root distinction\n    if result.is_empty() {\n        return \"/\".to_string();\n    }\n\n    result\n}\n\nfn child_prefix(query: &str) -> String {\n    let q = normalize_path(query);\n    if q == \"/\" { \"/\".to_string() } else { format!(\"{q}/\") }\n}\n```\n\n### Platform Considerations\n\n| Platform | Issue | Solution |\n|----------|-------|----------|\n| Windows | Backslashes, drive letters | Normalize `\\` â†’ `/`, handle `C:` vs `C:\\` |\n| macOS (HFS+/APFS) | NFD Unicode normalization | Use `unicode-normalization` crate |\n| Cross-platform | `\\\\?\\` prefix on Windows | Use `dunce` crate for canonicalization |\n\nFor robust cross-platform paths, prefer `std::path::Path` and accept platform differences, or explicitly document which platform behavior you're targeting.\n\n---\n\n## Case Normalization\n\n`to_ascii_lowercase()` handles only A-Z. For Unicode case folding, use `str::to_lowercase()` or the `unicode-casemapping` crate.\n\n```rust\n// ASCII-only (suitable for most config/spec keys)\nfn norm_key(k: &str) -> String { k.trim().to_ascii_lowercase() }\n\n// Unicode-aware (for user-facing text)\nfn norm_key_unicode(k: &str) -> String { k.trim().to_lowercase() }\n```\n\n**Whitespace**: `trim()` uses Unicode whitespace. If your spec defines whitespace differently:\n\n```rust\nfn trim_spec(s: &str) -> &str {\n    s.trim_matches(|c| c == ' ' || c == '\\t')  // Only ASCII space/tab\n}\n```\n\n---\n\n## State Machine Parsing\n\nFor markdown-like formats, a state machine beats fragile regex.\n\n```rust\nuse std::sync::LazyLock;\nuse regex::Regex;\n\n// ULID character set (Crockford's Base32, excluding I, L, O, U)\nstatic HEADING_RE: LazyLock<Regex> = LazyLock::new(|| {\n    // (?m) enables multiline mode: ^ matches start of line, not just string\n    Regex::new(r\"(?m)^### \\[#idea-([0-9A-HJKMNP-TV-Z]{26})\\]\\s*(.*)$\")\n        .expect(\"heading regex is valid\")\n});\n\n#[derive(Debug, Clone, PartialEq)]\nenum ParseState {\n    OutsideBlock,\n    InHeader { id: String },\n    InMetadata { id: String },\n    InBody { id: String },\n}\n\n#[derive(Debug)]\nenum ParseEvent {\n    BlockStart { id: String, title: String },\n    MetadataField { key: String, value: String },\n    BodyLine(String),\n    BlockEnd,\n}\n\nfn parse_line(state: &mut ParseState, line: &str) -> Option<ParseEvent> {\n    match state {\n        ParseState::OutsideBlock => {\n            if let Some(caps) = HEADING_RE.captures(line) {\n                let id = caps.get(1).unwrap().as_str().to_string();\n                let title = caps.get(2).map(|m| m.as_str()).unwrap_or(\"\").to_string();\n                *state = ParseState::InHeader { id: id.clone() };\n                return Some(ParseEvent::BlockStart { id, title });\n            }\n            None\n        }\n\n        ParseState::InHeader { id } => {\n            // Transition to metadata on first non-empty line\n            if line.trim().is_empty() {\n                return None;\n            }\n            let id = id.clone();\n            *state = ParseState::InMetadata { id };\n            parse_line(state, line)  // Re-process as metadata\n        }\n\n        ParseState::InMetadata { id } => {\n            // Delimiter ends metadata, starts body\n            if line.trim() == \"---\" {\n                *state = ParseState::InBody { id: id.clone() };\n                return None;\n            }\n            // New heading ends block\n            if HEADING_RE.is_match(line) {\n                let event = ParseEvent::BlockEnd;\n                *state = ParseState::OutsideBlock;\n                return Some(event);\n            }\n            // Parse \"Key: Value\" lines\n            if let Some((key, value)) = line.split_once(':') {\n                return Some(ParseEvent::MetadataField {\n                    key: key.trim().to_string(),\n                    value: value.trim().to_string(),\n                });\n            }\n            None\n        }\n\n        ParseState::InBody { id } => {\n            // New heading ends block\n            if HEADING_RE.is_match(line) {\n                let event = ParseEvent::BlockEnd;\n                *state = ParseState::OutsideBlock;\n                return Some(event);\n            }\n            Some(ParseEvent::BodyLine(line.to_string()))\n        }\n    }\n}\n```\n\n---\n\n## Anchored Updates\n\n**Problem**: `line.contains(\"[#idea-123]\")` matches references in body text, causing silent corruption.\n\n**Solution**: Only match headings at line start:\n\n```rust\nfn update_block_field(content: &str, target_id: &str, key: &str, new_value: &str) -> String {\n    let mut result = Vec::new();\n    let mut in_target_block = false;\n    let mut in_metadata = false;\n    let mut field_updated = false;\n\n    for line in content.lines() {\n        if let Some(caps) = HEADING_RE.captures(line) {\n            let id = caps.get(1).unwrap().as_str();\n            in_target_block = id == target_id;\n            in_metadata = in_target_block;\n            field_updated = false;\n        }\n\n        if in_target_block && in_metadata {\n            if line.trim() == \"---\" {\n                // End of metadataâ€”insert field if not updated\n                if !field_updated {\n                    result.push(format!(\"{key}: {new_value}\"));\n                }\n                in_metadata = false;\n            } else if let Some((k, _)) = line.split_once(':') {\n                if k.trim().eq_ignore_ascii_case(key) {\n                    result.push(format!(\"{key}: {new_value}\"));\n                    field_updated = true;\n                    continue;\n                }\n            }\n        }\n\n        result.push(line.to_string());\n    }\n\n    result.join(\"\\n\")\n}\n```\n\n---\n\n## Round-Trip Preservation\n\nParse into an AST that preserves formatting for lossless round-trips:\n\n```rust\n#[derive(Debug)]\npub struct ParsedFile {\n    pub format_version: u32,\n    pub blocks: Vec<Block>,\n    pub trailing_text: String,\n}\n\n#[derive(Debug)]\npub struct Block {\n    pub id: String,\n    pub header_line: String,        // Preserve original formatting\n    pub header_span: Span,          // Byte offsets for error reporting\n    pub fields: Vec<Field>,\n    pub body: String,\n    pub body_span: Span,\n    pub separator: String,          // e.g., \"\\n---\\n\"\n}\n\n#[derive(Debug)]\npub struct Field {\n    pub key: String,\n    pub value: String,\n    pub span: Span,\n}\n\n#[derive(Debug, Clone, Copy)]\npub struct Span {\n    pub start: usize,  // Byte offset\n    pub end: usize,\n}\n```\n\n**Why spans matter**: For error reporting with line/column numbers, and for incremental re-parsing after edits.\n\n---\n\n## Line Endings and BOM\n\n### Line Endings\n\nPreserve original line endings for round-trip fidelity:\n\n```rust\n#[derive(Debug, Clone, Copy, PartialEq)]\nenum LineEnding {\n    Lf,      // Unix: \\n\n    CrLf,    // Windows: \\r\\n\n    Cr,      // Classic Mac: \\r (rare)\n}\n\nfn detect_line_ending(content: &str) -> LineEnding {\n    if content.contains(\"\\r\\n\") {\n        LineEnding::CrLf\n    } else if content.contains('\\r') {\n        LineEnding::Cr\n    } else {\n        LineEnding::Lf\n    }\n}\n```\n\nIf normalizing instead of preserving, document the choice explicitly.\n\n### BOM Handling\n\nUTF-8 files sometimes have a BOM (U+FEFF, encoded as `EF BB BF`):\n\n```rust\nfn strip_bom(content: &str) -> &str {\n    content.strip_prefix('\\u{FEFF}').unwrap_or(content)\n}\n\nfn preserve_bom(original: &str, new_content: &str) -> String {\n    if original.starts_with('\\u{FEFF}') {\n        format!(\"\\u{FEFF}{new_content}\")\n    } else {\n        new_content.to_string()\n    }\n}\n```\n\n---\n\n## Duplicate ID Handling\n\nExternal edits can create duplicate IDs. Use a deterministic policy (first-wins or error):\n\n```rust\nuse std::collections::HashSet;\n\nfn dedupe_by_id<T: HasId>(items: Vec<T>) -> Vec<T> {\n    let mut seen = HashSet::new();\n    items.into_iter()\n        .filter(|item| seen.insert(item.id().to_string()))\n        .collect()\n}\n```\n\nFor error reporting instead of silent dedupe:\n\n```rust\nfn validate_unique_ids<T: HasId>(items: &[T]) -> Result<(), Vec<String>> {\n    let mut seen = HashSet::new();\n    let duplicates: Vec<_> = items.iter()\n        .filter(|item| !seen.insert(item.id()))\n        .map(|item| item.id().to_string())\n        .collect();\n\n    if duplicates.is_empty() {\n        Ok(())\n    } else {\n        Err(duplicates)\n    }\n}\n```\n",
        "skills/transparent-ui/SKILL.md": "---\nname: transparent-ui\ndescription: Create standalone debugging interfaces that reveal the internal workings of complex systems through interactive visualization. Use when the user wants to understand how something works, debug internal state, visualize data flow, see what happens when they interact with the system, or build a debug panel for any complex mechanism. Triggers on requests like \"I don't understand how this works\", \"show me what's happening\", \"visualize the state machine\", \"build a debug view for this\", \"help me see the data flow\", \"make this transparent\", or any request to understand, debug, or visualize internal system behavior. Applies to state machines, rendering systems, event flows, algorithms, animations, data pipelines, CSS calculations, database queries, or any system with non-obvious internal workings.\n---\n\n# Transparent UI\n\nBuild temporary debugging interfaces that make invisible system behavior visible. These are development-only routes/pages that reveal internal state, transitions, and data flow through interactive visualization.\n\n## Core Principles\n\n**Make the invisible visible.** Show state that normally exists only in memory. Reveal transitions that happen too fast to observe. Surface the \"why\" behind system behavior.\n\n**Temporary by design.** These are debugging tools, not production features. Keep changes isolated for easy removal. Use dev-only routes and environment checks.\n\n**Use existing components.** Build with the project's component library and design system. The visualization should feel native to the codebase, not like a foreign debugging tool.\n\n**Match instrumentation to context.** Sometimes minimal logging is enough; sometimes a full observable wrapper is needed. Choose the lightest approach that captures the necessary information.\n\n## Workflow\n\n### Step 1: Identify What to Make Transparent\n\nAnalyze the system and identify:\n\n1. **State**: What values change over time? What's the shape of the data?\n2. **Transitions**: What events trigger state changes? What's the sequence?\n3. **Relationships**: How do components/modules communicate? What depends on what?\n4. **Hidden logic**: What conditions, thresholds, or rules govern behavior?\n\nAsk the user clarifying questions if the system boundary is unclear.\n\n### Step 2: Choose Visualization Approach\n\nSelect based on the system's nature. See [references/patterns.md](references/patterns.md) for domain-specific guidance.\n\n| System Type | Primary Visualization | Key Elements |\n|-------------|----------------------|--------------|\n| State machines | Node-edge graph | States as nodes, transitions as edges, current state highlighted |\n| Data flow | Directed graph or Sankey | Sources, transformations, sinks with data flowing between |\n| Event systems | Timeline or sequence diagram | Events on time axis, handlers, propagation paths |\n| Algorithms | Step-by-step animation | Data structure state at each step, highlighting active elements |\n| Render/update cycles | Tree with diff overlay | Component tree, what re-rendered, why |\n| Animations | Timeline scrubber | Keyframes, easing curves, current progress |\n| CSS/Layout | Box model overlay | Computed values, constraint sources |\n\n### Step 3: Design Interactivity Level\n\nLayer interactivity based on debugging needs:\n\n**Level 1 - Observation**: Real-time display of current state and recent changes. Always include this.\n\n**Level 2 - Inspection**: Click/hover to see details. Expand nodes, view full payloads, trace data origins.\n\n**Level 3 - Manipulation**: Trigger events, modify state, inject test data. Useful for reproducing edge cases.\n\n**Level 4 - Time travel**: Record history, scrub through past states, replay sequences. Essential for race conditions and timing bugs.\n\nStart with Level 1-2. Add 3-4 when the user needs them.\n\n### Step 4: Instrument the System\n\nChoose instrumentation strategy based on invasiveness tolerance:\n\n**Minimal (prefer when possible)**:\n- Add event emitters at key points\n- Wrap state setters to broadcast changes\n- Use existing debug/logging hooks if available\n\n**Wrapper/Proxy approach**:\n- Create observable wrappers around the system\n- Intercept calls without modifying core code\n- Useful for third-party code or when core modifications are undesirable\n\n**Implementation patterns**:\n\n```typescript\n// Event emitter pattern - add to existing code\nconst debugEmitter = new EventEmitter();\nfunction transition(from: State, to: State, event: string) {\n  debugEmitter.emit('transition', { from, to, event, timestamp: Date.now() });\n  // ... existing logic\n}\n\n// Proxy pattern - wrap without modifying\nfunction createObservableStore<T>(store: T): T & { subscribe: (fn: Listener) => void } {\n  const listeners: Listener[] = [];\n  return new Proxy(store, {\n    set(target, prop, value) {\n      const oldValue = target[prop];\n      target[prop] = value;\n      listeners.forEach(fn => fn({ prop, oldValue, newValue: value }));\n      return true;\n    }\n  });\n}\n```\n\n### Step 5: Build the Debug Route\n\nCreate a development-only route that:\n\n1. **Guards against production**: Check `process.env.NODE_ENV === 'development'`\n2. **Connects to instrumentation**: Subscribe to events/state changes\n3. **Renders visualization**: Use the project's components where possible\n4. **Provides controls**: Play/pause, speed, filters, time scrubbing as needed\n\n**Route structure** (Next.js example):\n\n```\napp/\n  __dev/\n    transparent/\n      [system]/\n        page.tsx    # Dynamic route for different systems\n```\n\nOr simpler:\n```\napp/\n  __dev/\n    state-machine/\n      page.tsx\n```\n\n**Recommended libraries** (install only if not already in project):\n- **react-flow** or **reactflow**: Node-edge graphs for state machines, data flow\n- **framer-motion**: Smooth transitions in visualization itself\n- **Existing charting library**: If project already has one, use it\n\n### Step 6: Document Removal Path\n\nAt the top of every file created, add:\n\n```typescript\n/**\n * TRANSPARENT-UI DEBUG TOOL\n *\n * Temporary debugging visualization. Remove when no longer needed:\n * 1. Delete this file: app/__dev/[name]/page.tsx\n * 2. Delete instrumentation: src/lib/[system]-debug.ts\n * 3. Remove debug hooks from: src/lib/[system].ts (lines XX-YY)\n *\n * Created for: [description of what this helps debug]\n */\n```\n\n## Cleanup\n\nWhen the user asks to remove the transparent UI or is done debugging:\n\n1. **Delete debug route**: Remove the `__dev/` page(s)\n2. **Remove instrumentation**: Delete event emitters, proxies, debug hooks\n3. **Uninstall unused deps**: If visualization libraries were added solely for this\n4. **Verify no remnants**: Search for `debugEmitter`, `TRANSPARENT-UI`, or similar markers\n\nProvide a summary of removed files and modified lines.\n\n## Domain-Specific Patterns\n\nFor detailed visualization patterns, layouts, and code examples organized by system type, see [references/patterns.md](references/patterns.md).\n",
        "skills/transparent-ui/references/patterns.md": "# Visualization Patterns by Domain\n\nDetailed patterns for making different system types transparent. Each section includes:\n- What to capture\n- Visualization layout\n- Key interactive features\n- Example code snippets\n\n---\n\n## State Machines\n\n**What to capture**:\n- All possible states (as nodes)\n- All transitions (as directed edges)\n- Current state\n- Transition history with timestamps\n- Event that triggered each transition\n- Guard conditions that blocked transitions\n\n**Visualization layout**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  [State Graph]                    [History Panel]   â”‚\nâ”‚                                                     â”‚\nâ”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”    click    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚\nâ”‚    â”‚ idle  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚ loading â”‚               â”‚\nâ”‚    â””â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚\nâ”‚        â–²                      â”‚                     â”‚\nâ”‚        â”‚ reset           success                    â”‚\nâ”‚        â”‚                      â–¼                     â”‚\nâ”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚\nâ”‚    â”‚ error â”‚ â—€â”€â”€ fail â”€â”€ â”‚  ready  â”‚  â— current   â”‚\nâ”‚    â””â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚\nâ”‚                                                     â”‚\nâ”‚  [Event Trigger Buttons]     [State Inspector]     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Interactive features**:\n- Click state to see its definition and possible exits\n- Click edge to see transition conditions/actions\n- Trigger buttons to fire events manually\n- History shows transition log with replay capability\n\n**Instrumentation**:\n```typescript\ntype TransitionRecord = {\n  from: string;\n  to: string;\n  event: string;\n  timestamp: number;\n  context?: unknown;\n};\n\nconst history: TransitionRecord[] = [];\n\nfunction instrumentStateMachine(machine) {\n  return {\n    ...machine,\n    transition(state, event) {\n      const next = machine.transition(state, event);\n      history.push({ from: state, to: next, event, timestamp: Date.now() });\n      window.dispatchEvent(new CustomEvent('sm:transition', { detail: history.at(-1) }));\n      return next;\n    }\n  };\n}\n```\n\n---\n\n## React Rendering / Update Cycles\n\n**What to capture**:\n- Component tree structure\n- Which components re-rendered\n- Why they re-rendered (props changed, state changed, parent rendered)\n- Render timing/duration\n- Props diff between renders\n\n**Visualization layout**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  [Component Tree]                 [Render Log]      â”‚\nâ”‚                                                     â”‚\nâ”‚  App                              14:32:01.234      â”‚\nâ”‚  â”œâ”€ Header                        UserList rendered â”‚\nâ”‚  â”œâ”€ UserList â— (just rendered)    - props.filter   â”‚\nâ”‚  â”‚  â”œâ”€ UserCard                     changed         â”‚\nâ”‚  â”‚  â”œâ”€ UserCard â—                                   â”‚\nâ”‚  â”‚  â””â”€ UserCard                   14:32:01.189      â”‚\nâ”‚  â””â”€ Footer                        UserCard rendered â”‚\nâ”‚                                   - parent rendered â”‚\nâ”‚                                                     â”‚\nâ”‚  [Prop Inspector]                [Render Flame]    â”‚\nâ”‚  UserList props:                  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 12ms    â”‚\nâ”‚  - filter: \"active\" (changed!)    â–ˆâ–ˆâ–ˆ 3ms          â”‚\nâ”‚  - users: [...] (same ref)                         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Interactive features**:\n- Click component to inspect current props/state\n- Highlight renders with color intensity based on frequency\n- Show prop diffs on hover\n- Filter to show only re-rendered components\n\n**Instrumentation**:\n```typescript\nconst RenderTracker = createContext<{\n  log: (component: string, reason: string) => void;\n}>({ log: () => {} });\n\nfunction useTrackRender(name: string, props: Record<string, unknown>) {\n  const prevProps = useRef(props);\n  const { log } = useContext(RenderTracker);\n\n  useEffect(() => {\n    const changes = Object.keys(props).filter(\n      k => !Object.is(props[k], prevProps.current[k])\n    );\n    log(name, changes.length ? `props changed: ${changes.join(', ')}` : 'parent rendered');\n    prevProps.current = props;\n  });\n}\n```\n\n---\n\n## Data Flow / Pipelines\n\n**What to capture**:\n- Data sources (API calls, user input, stores)\n- Transformation steps\n- Current data at each stage\n- Data shape/type at each node\n- Timing of data propagation\n\n**Visualization layout**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  [Pipeline Graph]                                   â”‚\nâ”‚                                                     â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\nâ”‚  â”‚ API Call â”‚ â”€â”€â–¶ â”‚ Transform â”‚ â”€â”€â–¶ â”‚  Filter  â”‚  â”‚\nâ”‚  â”‚ /users   â”‚     â”‚ normalize â”‚     â”‚ isActive â”‚  â”‚\nâ”‚  â”‚ 127 itemsâ”‚     â”‚ 127 items â”‚     â”‚ 43 items â”‚  â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\nâ”‚       â”‚                                    â”‚        â”‚\nâ”‚       â–¼                                    â–¼        â”‚\nâ”‚  [Raw Data]                         [Final Data]   â”‚\nâ”‚  { data: [...] }                   [UserCard x43]  â”‚\nâ”‚                                                     â”‚\nâ”‚  [Inject Test Data]          [Step Through Mode]   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Interactive features**:\n- Click node to see full data payload\n- Inject data at any point to test downstream\n- Step-through mode to watch data propagate\n- Show data shape/schema at each stage\n\n---\n\n## Event Systems (Pub/Sub, Message Queues)\n\n**What to capture**:\n- Event types and their payloads\n- Publishers (who emits)\n- Subscribers (who listens)\n- Event propagation path\n- Timing between emit and handle\n\n**Visualization layout**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  [Event Timeline]                                   â”‚\nâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ t  â”‚\nâ”‚  â”‚    â”‚         â”‚              â”‚                    â”‚\nâ”‚  click         hover         submit                 â”‚\nâ”‚  Button        Card          Form                   â”‚\nâ”‚    â”‚             â”‚              â”‚                   â”‚\nâ”‚    â–¼             â–¼              â–¼                   â”‚\nâ”‚  [Analytics] [Tooltip]    [Validator, API]         â”‚\nâ”‚                                                     â”‚\nâ”‚  [Event Inspector]              [Fire Custom Event] â”‚\nâ”‚  submit @ 14:32:01              Type: [________]   â”‚\nâ”‚  From: Form                     Payload: {...}     â”‚\nâ”‚  To: Validator (2ms), API (3ms) [Fire]             â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Interactive features**:\n- Hover event to see full payload\n- Click to see all handlers and their execution time\n- Fire custom events with arbitrary payloads\n- Filter by event type or source\n\n---\n\n## Algorithms (Sorting, Pathfinding, Search)\n\n**What to capture**:\n- Data structure state at each step\n- Currently active/comparing elements\n- Decision points and choices made\n- Iteration count, comparisons, swaps\n- Final result path\n\n**Visualization layout**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  [Data Structure View]         [Stats]              â”‚\nâ”‚                                                     â”‚\nâ”‚  [3] [7] [1] [9] [2] [5]       Step: 4/12          â”‚\nâ”‚       â–²   â–²                    Comparisons: 7       â”‚\nâ”‚       â”‚   â””â”€â”€ comparing        Swaps: 3            â”‚\nâ”‚       â””â”€â”€â”€â”€â”€â”€ pivot                                 â”‚\nâ”‚                                                     â”‚\nâ”‚  [Step Controls]               [Speed]              â”‚\nâ”‚  â—€â—€  â—€  â–¶  â–¶â–¶  [Reset]        â—â”€â”€â”€â”€â”€â”€â”€â—‹ slowâ†’fast â”‚\nâ”‚                                                     â”‚\nâ”‚  [Step Log]                                        â”‚\nâ”‚  4. Compare 7 > 1: swap                            â”‚\nâ”‚  3. Compare 3 > 7: no swap                         â”‚\nâ”‚  2. Set pivot = 3                                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Interactive features**:\n- Step forward/backward through algorithm\n- Adjustable speed for continuous play\n- Highlight active elements\n- Show decision rationale at each step\n\n**Instrumentation pattern**:\n```typescript\nfunction* quickSort(arr: number[]): Generator<AlgorithmStep> {\n  // Yield state at each step for visualization\n  yield { type: 'start', data: [...arr] };\n\n  function* partition(low: number, high: number) {\n    const pivot = arr[high];\n    yield { type: 'pivot', index: high, value: pivot };\n\n    let i = low - 1;\n    for (let j = low; j < high; j++) {\n      yield { type: 'compare', indices: [j, high] };\n      if (arr[j] < pivot) {\n        i++;\n        [arr[i], arr[j]] = [arr[j], arr[i]];\n        yield { type: 'swap', indices: [i, j], data: [...arr] };\n      }\n    }\n    // ...\n  }\n  // ...\n}\n```\n\n---\n\n## Animation Systems\n\n**What to capture**:\n- Animation timeline with keyframes\n- Current progress (0-1)\n- Easing curve visualization\n- Active animations and their targets\n- Animation state (playing, paused, finished)\n\n**Visualization layout**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  [Timeline Scrubber]                                â”‚\nâ”‚  0%â”â”â”â”â”â”â”â”â”â—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”100%  â”‚\nâ”‚            42%                                      â”‚\nâ”‚                                                     â”‚\nâ”‚  [Easing Curve]        [Active Animations]          â”‚\nâ”‚    â•­â”€â”€â”€â”€â”€â”€â•®           opacity: 0.42 â†’ 1.0          â”‚\nâ”‚   â•±        â•²          x: 120px â†’ 0px               â”‚\nâ”‚  â•±          â”€â”€        scale: 0.8 â†’ 1.0             â”‚\nâ”‚  ease-out-cubic                                     â”‚\nâ”‚                                                     â”‚\nâ”‚  [Keyframes]                                        â”‚\nâ”‚  0%    25%    50%    75%    100%                   â”‚\nâ”‚  â—â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â—                      â”‚\nâ”‚                                                     â”‚\nâ”‚  [Controls]  â—€â—€  â—€  â–¶  â–¶â–¶  [0.5x] [1x] [2x]       â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Interactive features**:\n- Drag scrubber to any point in animation\n- Visualize easing curve\n- Speed controls\n- Trigger animation restart\n\n---\n\n## CSS / Layout Calculations\n\n**What to capture**:\n- Computed styles vs declared styles\n- Box model values (margin, border, padding, content)\n- Flexbox/Grid resolution (how space is distributed)\n- Constraint sources (what rule set each value)\n- Cascade order for conflicting rules\n\n**Visualization layout**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  [Element Selector]                                 â”‚\nâ”‚  <div class=\"card flex-1 p-4\">                     â”‚\nâ”‚                                                     â”‚\nâ”‚  [Box Model]                   [Flex Distribution]  â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€margin: 0â”€â”€â”€â”€â”€â”€â”€â”   Container: 800px    â”‚\nâ”‚  â”‚ â”Œâ”€â”€â”€border: 1pxâ”€â”€â”€â”€â”€â”€â”€â” â”‚   â”œâ”€ item-1: 200px   â”‚\nâ”‚  â”‚ â”‚ â”Œâ”€â”€padding: 16pxâ”€â”€â” â”‚ â”‚   â”œâ”€ item-2: 400px   â”‚\nâ”‚  â”‚ â”‚ â”‚                 â”‚ â”‚ â”‚   â””â”€ item-3: 200px   â”‚\nâ”‚  â”‚ â”‚ â”‚  content: 280px â”‚ â”‚ â”‚                       â”‚\nâ”‚  â”‚ â”‚ â”‚                 â”‚ â”‚ â”‚   flex-1 = 200px      â”‚\nâ”‚  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   (basis:0 + 1*200)   â”‚\nâ”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                       â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚\nâ”‚                                                     â”‚\nâ”‚  [Style Source]                                     â”‚\nâ”‚  width: 280px â† .card { width: 280px } (card.css:12)â”‚\nâ”‚  padding: 16px â† .p-4 (Tailwind)                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Interactive features**:\n- Click any element to inspect\n- Hover style to see source rule\n- Toggle styles on/off to see effect\n- Visualize flex/grid space distribution\n\n---\n\n## Database Queries / ORM Operations\n\n**What to capture**:\n- Query being executed (SQL or ORM method)\n- Parameters and their values\n- Execution time\n- Result count and sample data\n- Query plan (if available)\n\n**Visualization layout**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  [Query Log]                                        â”‚\nâ”‚                                                     â”‚\nâ”‚  14:32:01 SELECT * FROM users WHERE active = $1    â”‚\nâ”‚           params: [true]                            â”‚\nâ”‚           â†’ 43 rows, 12ms                          â”‚\nâ”‚                                                     â”‚\nâ”‚  14:32:00 SELECT * FROM posts WHERE user_id = $1   â”‚\nâ”‚           params: [123]                             â”‚\nâ”‚           â†’ 5 rows, 3ms                            â”‚\nâ”‚                                                     â”‚\nâ”‚  [Query Inspector]             [N+1 Detector]       â”‚\nâ”‚  Expand query to see:          âš ï¸ Similar query     â”‚\nâ”‚  - Full SQL                    executed 15 times    â”‚\nâ”‚  - Query plan                  in 200ms window      â”‚\nâ”‚  - Sample results                                   â”‚\nâ”‚                                                     â”‚\nâ”‚  [Run Custom Query]                                 â”‚\nâ”‚  SELECT _______________  [Execute]                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**Interactive features**:\n- Expand query to see full SQL and results\n- Detect N+1 query patterns\n- Run custom queries for testing\n- Show query plan visualization\n\n---\n\n## General Implementation Notes\n\n**Connecting visualization to live system**:\n```typescript\n// In debug route\nconst [history, setHistory] = useState<Event[]>([]);\n\nuseEffect(() => {\n  const handler = (e: CustomEvent) => {\n    setHistory(prev => [...prev, e.detail]);\n  };\n  window.addEventListener('debug:event', handler);\n  return () => window.removeEventListener('debug:event', handler);\n}, []);\n```\n\n**Time-travel implementation**:\n```typescript\nfunction useTimeTravel<T>(history: T[]) {\n  const [index, setIndex] = useState(history.length - 1);\n\n  return {\n    current: history[index],\n    canGoBack: index > 0,\n    canGoForward: index < history.length - 1,\n    goBack: () => setIndex(i => Math.max(0, i - 1)),\n    goForward: () => setIndex(i => Math.min(history.length - 1, i + 1)),\n    goTo: (i: number) => setIndex(Math.max(0, Math.min(history.length - 1, i))),\n    scrub: (progress: number) => setIndex(Math.floor(progress * (history.length - 1))),\n  };\n}\n```\n\n**Recommended React Flow setup for graphs**:\n```tsx\nimport ReactFlow, { Background, Controls } from 'reactflow';\nimport 'reactflow/dist/style.css';\n\nfunction StateGraph({ states, transitions, current }) {\n  const nodes = states.map(s => ({\n    id: s.id,\n    data: { label: s.name },\n    position: s.position, // or use auto-layout\n    style: s.id === current ? { border: '2px solid blue' } : {},\n  }));\n\n  const edges = transitions.map(t => ({\n    id: `${t.from}-${t.to}`,\n    source: t.from,\n    target: t.to,\n    label: t.event,\n    animated: t.from === current,\n  }));\n\n  return (\n    <ReactFlow nodes={nodes} edges={edges} fitView>\n      <Background />\n      <Controls />\n    </ReactFlow>\n  );\n}\n```\n",
        "skills/tuning-panel/SKILL.md": "---\nname: tuning-panel\ndescription: Create visual parameter tuning panels for iterative adjustment of animations, layouts, colors, typography, physics, or any numeric/visual values. Use when the user asks to \"create a tuning panel\", \"add parameter controls\", \"build a debug panel\", \"tweak parameters visually\", \"fine-tune values\", \"dial in the settings\", or \"adjust parameters interactively\". Also triggers on mentions of \"leva\", \"dat.GUI\", or \"tweakpane\".\n---\n\n# Tuning Panel Skill\n\nCreate bespoke parameter tuning panels that give users visual control over values they're iterating on. These panels surface all relevant parameters for the current task, enable real-time adjustment, and export tuned values in an LLM-friendly format.\n\n## Core Philosophy\n\n**Err on the side of exhaustive.** When a user is tuning something, surface every parameter that could reasonably affect the outcome. Missing a parameter forces context-switching; having \"too many\" parameters costs only scroll distance.\n\n**Debug-mode only.** Tuning panels should never appear in production. Use environment checks, build flags, or URL parameters.\n\n**Export changed values only.** LLM exports should show only what was tuned, not all 100+ parameters.\n\n## Platform Selection\n\n| Platform | Library | Reference |\n|----------|---------|-----------|\n| **React** | Leva (recommended) | [references/react-leva.md](references/react-leva.md) |\n| **SwiftUI** | Native controls | [references/swiftui.md](references/swiftui.md) |\n| **Vanilla JS** | Tweakpane or dat.GUI | [references/vanilla-js.md](references/vanilla-js.md) |\n\n## Implementation Workflow\n\n### Step 1: Identify All Tunable Parameters\n\nAnalyze the code being tuned and extract every parameter that affects the output. See [references/parameter-categories.md](references/parameter-categories.md) for exhaustive lists by domain.\n\n**Common categories:**\n- **Animation**: duration, delay, easing, spring physics (stiffness, damping, mass)\n- **Layout**: padding, margin, gap, width, height, position\n- **Visual**: colors, opacity, shadows, borders, transforms\n- **Typography**: font size, line height, letter spacing, weight\n\n**Discovery strategies:**\n1. Search for magic numbers (any hardcoded numeric value)\n2. Look for style objects (CSS-in-JS, inline styles, theme values)\n3. Find animation definitions (Framer Motion, CSS transitions, SwiftUI animations)\n4. Identify color values (hex, RGB, HSL anywhere in the file)\n5. Check component props with numeric or color defaults\n6. Examine CSS custom properties (`--var-name` declarations)\n\n### Step 2: Create Debug-Mode Panel\n\nWrap the tuning panel so it only appears in development:\n\n- **React**: `process.env.NODE_ENV === 'development'`\n- **SwiftUI**: `#if DEBUG`\n- **Vanilla JS**: URL parameter `?debug` or environment check\n\nSee platform-specific references for code patterns.\n\n### Step 3: Implement Controls\n\nFollow these principles:\n\n1. **Group related parameters** using folders/sections\n2. **Use appropriate control types**: sliders for numbers, color pickers for colors, dropdowns for enums\n3. **Set sensible min/max/step values** based on the parameter domain\n4. **Include presets** for common configurations\n5. **Add reset buttons** to return to defaults\n\n### Step 4: Add LLM Export\n\n**Critical requirements:**\n\n1. **Store defaults** at initialization for comparison\n2. **Use tolerance for floats** (e.g., `Math.abs(a - b) > 0.001`)\n3. **Filter to changed values only** - don't show unchanged parameters\n4. **Format for readability** - group by category, use human-readable names\n\n**Export format:**\n\n```markdown\n## Tuned Parameters for [ComponentName]\n\n### Changed Values\n- Duration: 300 â†’ 450\n- Spring Damping: 0.80 â†’ 0.65\n- Corner Radius: 12 â†’ 16\n\n### Apply These Values\nUpdate the component at `src/components/Card.tsx:42` with the values above.\n```\n\n**Why this matters:**\n- A panel might expose 100+ parameters\n- Exporting all values wastes tokens and obscures what changed\n- The `default â†’ current` format makes diffs scannable\n\n## Additional Resources\n\n### Reference Files\n- **[references/react-leva.md](references/react-leva.md)** - Complete React/Leva implementation guide\n- **[references/swiftui.md](references/swiftui.md)** - SwiftUI native controls and export patterns\n- **[references/vanilla-js.md](references/vanilla-js.md)** - Tweakpane and dat.GUI for plain JS\n- **[references/parameter-categories.md](references/parameter-categories.md)** - Exhaustive parameter lists by domain\n\n### Example Files\n- **[examples/react-leva-animation.tsx](examples/react-leva-animation.tsx)** - Complete animation tuning panel\n- **[examples/export-format.md](examples/export-format.md)** - Full LLM export template\n",
        "skills/tuning-panel/examples/export-format.md": "# LLM Export Format Template\n\nThis template shows the ideal format for exporting tuned parameters so another Claude instance can immediately apply them.\n\n---\n\n## Example Export Output\n\n```markdown\n## Tuned Parameters for CardHoverAnimation\n\nI've dialed in these values for the hover animation on the product card:\n\n### Final Configuration\n\n```typescript\n// Spring physics - tuned for premium feel\nconst springConfig = {\n  type: 'spring',\n  stiffness: 220,      // Slightly snappy\n  damping: 28,         // Minimal overshoot\n  mass: 0.8,           // Light, responsive\n};\n\n// Hover transform - subtle but noticeable\nconst hoverAnimation = {\n  scale: 1.02,\n  y: -6,\n  rotate: 0,\n  boxShadow: '0 12px 32px rgba(0,0,0,0.12)',\n};\n\n// Layout values\nconst layout = {\n  padding: 20,\n  borderRadius: 16,\n  gap: 12,\n};\n\n// Color palette\nconst colors = {\n  background: '#fafafa',\n  accent: '#4f46e5',\n  text: '#18181b',\n};\n```\n\n### Changes from Defaults\n\n| Parameter | Default | Tuned | Rationale |\n|-----------|---------|-------|-----------|\n| stiffness | 180 | 220 | Faster initial response |\n| damping | 20 | 28 | Reduces oscillation for cleaner settle |\n| mass | 1 | 0.8 | Lighter feel, more immediate |\n| y | -4 | -6 | More pronounced lift effect |\n| shadowBlur | 24px | 32px | Softer, more diffuse shadow |\n| borderRadius | 12px | 16px | Rounder corners match design system |\n\n### Tuning Rationale\n\nThe goal was a \"premium\" hover feel:\n- **Quick response** (high stiffness) makes the UI feel responsive\n- **Low overshoot** (high damping) avoids playful/bouncy feel\n- **Subtle scale** (1.02) gives depth without distraction\n- **Pronounced lift** (-6px y) combined with larger shadow creates elevation\n\n### Apply These Values\n\nUpdate `src/components/ProductCard.tsx` lines 45-62 with the configuration above.\n\nAlternatively, extract to a shared animation config:\n\n```typescript\n// src/config/animations.ts\nexport const cardHover = {\n  spring: { type: 'spring', stiffness: 220, damping: 28, mass: 0.8 },\n  hover: { scale: 1.02, y: -6 },\n  shadow: { rest: '0 4px 12px rgba(0,0,0,0.08)', hover: '0 12px 32px rgba(0,0,0,0.12)' },\n};\n```\n```\n\n---\n\n## Export Format Requirements\n\n### Required Sections\n\n1. **Title** - What was tuned and where\n2. **Final Configuration** - Code-ready values\n3. **Changes from Defaults** - What was modified\n4. **Apply Instructions** - Where to put the values\n\n### Optional Sections\n\n- **Tuning Rationale** - Why these values work\n- **Alternative Approaches** - Other configs tried\n- **Presets** - Named configurations for different feels\n\n---\n\n## Format by Platform\n\n### React (Leva/Framer Motion)\n\n```typescript\nconst config = {\n  spring: { stiffness: 180, damping: 20 },\n  values: { scale: 1.05, y: -4 },\n};\n```\n\n### Swift (SwiftUI)\n\n```swift\nlet animation = Animation.spring(\n    response: 0.4,\n    dampingFraction: 0.7,\n    blendDuration: 0\n)\n```\n\n### CSS\n\n```css\n.element {\n  transition: transform 400ms cubic-bezier(0.32, 0.72, 0, 1);\n}\n.element:hover {\n  transform: scale(1.02) translateY(-4px);\n}\n```\n\n### Tailwind\n\n```html\n<div class=\"transition-transform duration-400 ease-out hover:scale-102 hover:-translate-y-1\">\n```\n\n---\n\n## Implementation Notes\n\n### Clipboard Copy Function\n\n```typescript\nfunction exportForLLM(currentValues: Values, defaults: Values, context: string) {\n  const changes = Object.entries(currentValues)\n    .filter(([key, val]) => val !== defaults[key])\n    .map(([key, val]) => ({\n      param: key,\n      from: defaults[key],\n      to: val,\n    }));\n\n  const markdown = `## Tuned Parameters for ${context}\n\n### Final Values\n\\`\\`\\`typescript\n${JSON.stringify(currentValues, null, 2)}\n\\`\\`\\`\n\n### Changes from Defaults\n${changes.map(c => `- **${c.param}**: \\`${c.from}\\` â†’ \\`${c.to}\\``).join('\\n')}\n`;\n\n  navigator.clipboard.writeText(markdown);\n}\n```\n\n### Toast/Alert Feedback\n\nAlways confirm the copy action:\n```typescript\n// Simple\nalert('Copied to clipboard!');\n\n// Better (with toast library)\ntoast.success('Tuning values copied! Paste into Claude.');\n\n// Best (inline feedback)\nsetCopied(true);\nsetTimeout(() => setCopied(false), 2000);\n```\n",
        "skills/tuning-panel/references/parameter-categories.md": "# Parameter Categories Reference\n\nExhaustive lists of parameters to surface for different tuning domains. When in doubt, include the parameterâ€”visibility costs little, missing parameters break flow.\n\n## Animation Parameters\n\n### Timing\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| duration | number | 0-2000ms | Total animation time |\n| delay | number | 0-1000ms | Before animation starts |\n| iterationCount | number/infinite | 1-10 | Loop count |\n| direction | enum | normal, reverse, alternate | Playback direction |\n| fillMode | enum | none, forwards, backwards, both | End state behavior |\n\n### Easing\n| Parameter | Type | Options | Notes |\n|-----------|------|---------|-------|\n| easing | enum | linear, ease, ease-in, ease-out, ease-in-out | Preset curves |\n| cubicBezier | [n,n,n,n] | 0-1 for each | Custom curve |\n| steps | number | 1-60 | Step-based animation |\n| stepsPosition | enum | start, end | Where step occurs |\n\n### Spring Physics\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| stiffness | number | 50-500 | Spring tension |\n| damping | number | 1-50 | Oscillation reduction |\n| mass | number | 0.1-10 | Affects momentum |\n| velocity | number | -100-100 | Initial velocity |\n| restSpeed | number | 0.001-1 | Stop threshold |\n| restDelta | number | 0.001-1 | Position threshold |\n\n### Keyframes\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| keyframeTimes | number[] | Progress points (0-1) |\n| keyframeValues | any[] | Values at each keyframe |\n| keyframeEasings | string[] | Easing between keyframes |\n\n---\n\n## Layout Parameters\n\n### Spacing (All Support Per-Side)\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| padding | number | 0-64px | Inner spacing |\n| paddingTop/Right/Bottom/Left | number | 0-64px | Per-side padding |\n| paddingX/Y | number | 0-64px | Horizontal/vertical |\n| margin | number | 0-64px | Outer spacing |\n| marginTop/Right/Bottom/Left | number | 0-64px | Per-side margin |\n| gap | number | 0-32px | Flex/grid gap |\n| rowGap | number | 0-32px | Grid row spacing |\n| columnGap | number | 0-32px | Grid column spacing |\n\n### Sizing\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| width | number/string | 0-1000px, auto, 100% | Element width |\n| height | number/string | 0-1000px, auto, 100% | Element height |\n| minWidth | number | 0-500px | Minimum constraint |\n| maxWidth | number | 100-2000px | Maximum constraint |\n| minHeight | number | 0-500px | Minimum constraint |\n| maxHeight | number | 100-2000px | Maximum constraint |\n| aspectRatio | number | 0.25-4 | Width/height ratio |\n\n### Flexbox\n| Parameter | Type | Options | Notes |\n|-----------|------|---------|-------|\n| flexDirection | enum | row, column, row-reverse, column-reverse | Main axis |\n| justifyContent | enum | start, center, end, space-between, space-around, space-evenly | Main axis alignment |\n| alignItems | enum | start, center, end, stretch, baseline | Cross axis alignment |\n| alignContent | enum | start, center, end, space-between, space-around, stretch | Multi-line alignment |\n| flexWrap | enum | nowrap, wrap, wrap-reverse | Line wrapping |\n| flexGrow | number | 0-5 | Growth factor |\n| flexShrink | number | 0-5 | Shrink factor |\n| flexBasis | number/string | 0-500px, auto | Initial size |\n\n### Grid\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| gridTemplateColumns | string | Column definitions |\n| gridTemplateRows | string | Row definitions |\n| gridColumn | string | Column placement |\n| gridRow | string | Row placement |\n| justifyItems | enum | Item horizontal alignment |\n| alignSelf | enum | Override cross-axis |\n\n### Position\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| position | enum | static, relative, absolute, fixed, sticky | Position type |\n| top | number | -100-500px | Top offset |\n| right | number | -100-500px | Right offset |\n| bottom | number | -100-500px | Bottom offset |\n| left | number | -100-500px | Left offset |\n| zIndex | number | -10-100 | Stacking order |\n\n---\n\n## Visual Parameters\n\n### Colors\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| color | color | Text color |\n| backgroundColor | color | Background fill |\n| borderColor | color | Border stroke |\n| outlineColor | color | Focus outline |\n| accentColor | color | Interactive elements |\n| caretColor | color | Text cursor |\n| textDecorationColor | color | Underline/strike |\n\n### Opacity & Blend\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| opacity | number | 0-1 | Element transparency |\n| mixBlendMode | enum | normal, multiply, screen, overlay, darken, lighten | Layer blending |\n| backgroundBlendMode | enum | Same as mixBlendMode | Background blending |\n\n### Borders\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| borderWidth | number | 0-8px | Stroke width |\n| borderStyle | enum | solid, dashed, dotted, double, none | Stroke style |\n| borderRadius | number | 0-32px | Corner rounding |\n| borderTopLeftRadius | number | 0-32px | Per-corner |\n| borderTopRightRadius | number | 0-32px | Per-corner |\n| borderBottomLeftRadius | number | 0-32px | Per-corner |\n| borderBottomRightRadius | number | 0-32px | Per-corner |\n\n### Shadows\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| shadowOffsetX | number | -50-50px | Horizontal offset |\n| shadowOffsetY | number | -50-50px | Vertical offset |\n| shadowBlur | number | 0-50px | Blur radius |\n| shadowSpread | number | -20-50px | Size adjustment |\n| shadowColor | color | With alpha | Shadow color |\n| shadowInset | boolean | - | Inner shadow |\n\n### Effects\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| blur | number | 0-20px | Gaussian blur |\n| brightness | number | 0-2 | 1 = normal |\n| contrast | number | 0-2 | 1 = normal |\n| saturate | number | 0-2 | 1 = normal |\n| hueRotate | number | 0-360deg | Color shift |\n| grayscale | number | 0-1 | Desaturation |\n| sepia | number | 0-1 | Sepia tone |\n| invert | number | 0-1 | Color inversion |\n\n### Backdrop Effects\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| backdropBlur | number | 0-30px | Behind-element blur |\n| backdropBrightness | number | 0-2 | Behind-element brightness |\n| backdropSaturate | number | 0-2 | Behind-element saturation |\n\n---\n\n## Typography Parameters\n\n### Font\n| Parameter | Type | Options/Range | Notes |\n|-----------|------|---------------|-------|\n| fontFamily | string | System fonts, web fonts | Font face |\n| fontSize | number | 10-72px | Text size |\n| fontWeight | number | 100-900 | Boldness (use slider) |\n| fontStyle | enum | normal, italic, oblique | Slant style |\n| fontStretch | enum | condensed, normal, expanded | Width variant |\n\n### Spacing\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| lineHeight | number | 1-2.5 | Line spacing (unitless) |\n| letterSpacing | number | -0.1-0.5em | Character spacing |\n| wordSpacing | number | -0.2-1em | Word spacing |\n| textIndent | number | 0-48px | First line indent |\n\n### Alignment & Transform\n| Parameter | Type | Options | Notes |\n|-----------|------|---------|-------|\n| textAlign | enum | left, center, right, justify | Horizontal alignment |\n| verticalAlign | enum | baseline, top, middle, bottom | Vertical alignment |\n| textTransform | enum | none, uppercase, lowercase, capitalize | Case transform |\n\n### Decoration\n| Parameter | Type | Options | Notes |\n|-----------|------|---------|-------|\n| textDecoration | enum | none, underline, overline, line-through | Line decoration |\n| textDecorationStyle | enum | solid, dashed, dotted, wavy | Decoration style |\n| textDecorationThickness | number | 1-4px | Decoration weight |\n| textUnderlineOffset | number | 0-8px | Underline distance |\n\n### Advanced\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| textShadow | composite | X, Y, blur, color |\n| textOverflow | enum | clip, ellipsis |\n| whiteSpace | enum | normal, nowrap, pre, pre-wrap |\n| wordBreak | enum | normal, break-all, break-word |\n\n---\n\n## Transform Parameters\n\n### 2D Transforms\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| translateX | number | -500-500px | Horizontal shift |\n| translateY | number | -500-500px | Vertical shift |\n| rotate | number | -360-360deg | Rotation angle |\n| scaleX | number | 0-3 | Horizontal scale |\n| scaleY | number | 0-3 | Vertical scale |\n| scale | number | 0-3 | Uniform scale |\n| skewX | number | -45-45deg | Horizontal skew |\n| skewY | number | -45-45deg | Vertical skew |\n\n### 3D Transforms\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| translateZ | number | -500-500px | Depth shift |\n| rotateX | number | -180-180deg | X-axis rotation |\n| rotateY | number | -180-180deg | Y-axis rotation |\n| rotateZ | number | -360-360deg | Z-axis rotation |\n| perspective | number | 100-2000px | 3D perspective |\n| perspectiveOrigin | string | Center point |\n\n### Transform Origin\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| transformOriginX | number/string | 0-100%, px, left/center/right |\n| transformOriginY | number/string | 0-100%, px, top/center/bottom |\n| transformOriginZ | number | Depth origin |\n\n---\n\n## Physics Simulation Parameters\n\n### Gravity & Forces\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| gravity | number | 0-20 | Downward force |\n| gravityX | number | -10-10 | Horizontal gravity |\n| gravityY | number | -10-10 | Vertical gravity |\n| wind | number | -5-5 | Constant force |\n| drag | number | 0-1 | Air resistance |\n\n### Collision\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| restitution | number | 0-1 | Bounciness |\n| friction | number | 0-1 | Surface friction |\n| density | number | 0.1-10 | Mass per area |\n| frictionStatic | number | 0-1 | Static friction |\n| frictionAir | number | 0-0.1 | Air friction |\n\n### Constraints\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| stiffness | number | Constraint rigidity |\n| damping | number | Constraint damping |\n| length | number | Rest length |\n\n---\n\n## 3D/WebGL Parameters\n\n### Camera\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| fov | number | 30-120deg | Field of view |\n| near | number | 0.01-10 | Near clipping |\n| far | number | 100-10000 | Far clipping |\n| zoom | number | 0.1-10 | Camera zoom |\n\n### Lighting\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| intensity | number | Light brightness |\n| distance | number | Falloff distance |\n| decay | number | Falloff rate |\n| angle | number | Spotlight cone |\n| penumbra | number | Edge softness |\n| castShadow | boolean | Shadow casting |\n\n### Material\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| roughness | number | Surface roughness (0-1) |\n| metalness | number | Metal appearance (0-1) |\n| emissive | color | Self-illumination |\n| emissiveIntensity | number | Emission strength |\n| clearcoat | number | Clear coating (0-1) |\n| transmission | number | Transparency (0-1) |\n| ior | number | Index of refraction |\n\n---\n\n## Audio Parameters\n\n### Playback\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| volume | number | 0-1 | Loudness |\n| playbackRate | number | 0.25-4 | Speed |\n| pan | number | -1-1 | Left/right balance |\n| muted | boolean | - | Silent |\n\n### Effects\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| reverbMix | number | Wet/dry mix |\n| reverbDecay | number | Decay time |\n| delayTime | number | Echo delay |\n| delayFeedback | number | Echo repeats |\n| lowpassFreq | number | Filter cutoff |\n| highpassFreq | number | Filter cutoff |\n\n### Envelope (ADSR)\n| Parameter | Type | Typical Range | Notes |\n|-----------|------|---------------|-------|\n| attack | number | 0-2s | Rise time |\n| decay | number | 0-2s | Fall to sustain |\n| sustain | number | 0-1 | Hold level |\n| release | number | 0-5s | Fade out |\n\n---\n\n## Responsive/Adaptive Parameters\n\n### Breakpoints\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| mobileValue | any | Value at mobile breakpoint |\n| tabletValue | any | Value at tablet breakpoint |\n| desktopValue | any | Value at desktop breakpoint |\n\n### Motion Preferences\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| reducedMotionValue | any | Value when prefers-reduced-motion |\n| fullMotionValue | any | Standard value |\n\n---\n\n## Interaction Parameters\n\n### Hover/Active States\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| hoverScale | number | Scale on hover |\n| hoverOpacity | number | Opacity on hover |\n| hoverY | number | Y offset on hover |\n| activeScale | number | Scale when pressed |\n| focusRingWidth | number | Focus outline size |\n| focusRingOffset | number | Focus outline gap |\n\n### Gestures\n| Parameter | Type | Notes |\n|-----------|------|-------|\n| dragElastic | number | Drag overshoot (0-1) |\n| dragMomentum | boolean | Momentum after release |\n| dragConstraints | object | Drag boundaries |\n| swipeThreshold | number | Swipe trigger distance |\n| swipeVelocity | number | Swipe trigger speed |\n\n---\n\n## Selection Guidelines\n\n### Always Include\n- Any hardcoded numeric value in the target code\n- All timing values (duration, delay)\n- All spacing values (padding, margin, gap)\n- All color values\n- All sizing constraints\n\n### Include When Relevant\n- Easing/spring physics for any animation\n- Typography params when tuning text\n- Transform params when tuning motion\n- Filter params when tuning visual effects\n\n### Group Logically\n1. Primary values (most impact) at top\n2. Secondary values in collapsed folders\n3. Actions (export, reset) at bottom\n",
        "skills/tuning-panel/references/react-leva.md": "# React Tuning Panels with Leva\n\nComplete guide for building parameter tuning panels in React using Leva.\n\n## Installation\n\n```bash\nnpm install leva\n# or\npnpm add leva\n```\n\n## Basic Setup\n\n```tsx\nimport { useControls } from 'leva';\n\nfunction Component() {\n  const { opacity, scale } = useControls({\n    opacity: { value: 1, min: 0, max: 1, step: 0.01 },\n    scale: { value: 1, min: 0.1, max: 3, step: 0.1 },\n  });\n\n  return <div style={{ opacity, transform: `scale(${scale})` }} />;\n}\n```\n\n## Control Types\n\n### Number (Slider)\n```tsx\nconst { value } = useControls({\n  value: { value: 50, min: 0, max: 100, step: 1 },\n});\n```\n\n### Number (Scrubber)\n```tsx\nconst { value } = useControls({\n  value: 50, // Scrubber when no constraints\n});\n```\n\n### Range (Two-Handle Slider)\n```tsx\nconst { range } = useControls({\n  range: { value: [25, 75], min: 0, max: 100 },\n});\n```\n\n### Color\n```tsx\nconst { color } = useControls({\n  color: '#ff0000',\n  colorRgb: { r: 255, g: 0, b: 0 },\n  colorRgba: { r: 255, g: 0, b: 0, a: 0.5 },\n});\n```\n\n### Select/Dropdown\n```tsx\nconst { easing } = useControls({\n  easing: { value: 'easeOut', options: ['linear', 'easeIn', 'easeOut', 'easeInOut'] },\n});\n\n// With labeled options\nconst { easing } = useControls({\n  easing: {\n    value: 'ease-out',\n    options: {\n      'Linear': 'linear',\n      'Ease In': 'ease-in',\n      'Ease Out': 'ease-out',\n    },\n  },\n});\n```\n\n### Boolean\n```tsx\nconst { enabled } = useControls({\n  enabled: true,\n});\n```\n\n### Vector2/Vector3\n```tsx\nconst { position } = useControls({\n  position: { value: { x: 0, y: 0 }, step: 1 },\n});\n\nconst { position3d } = useControls({\n  position3d: { value: { x: 0, y: 0, z: 0 }, step: 1 },\n});\n```\n\n## Organization\n\n### Folders (Collapsible Groups)\n```tsx\nimport { useControls, folder } from 'leva';\n\nconst values = useControls({\n  animation: folder({\n    duration: { value: 300, min: 0, max: 2000 },\n    easing: { value: 'easeOut', options: ['linear', 'easeIn', 'easeOut'] },\n  }),\n\n  layout: folder({\n    padding: { value: 16, min: 0, max: 64 },\n    gap: { value: 8, min: 0, max: 32 },\n  }, { collapsed: true }), // Start collapsed\n});\n```\n\n### Buttons\n```tsx\nimport { useControls, button } from 'leva';\n\nconst values = useControls({\n  // ... other controls\n  'Reset': button(() => resetValues()),\n  'Export': button(() => exportForLLM()),\n});\n```\n\n### Panel Positioning\n```tsx\nimport { Leva } from 'leva';\n\n<Leva\n  collapsed={false}\n  oneLineLabels={false}\n  flat={false}\n  theme={{\n    sizes: { rootWidth: '320px' },\n    colors: { accent1: '#6366f1' },\n  }}\n/>\n```\n\n### Conditional Rendering\n```tsx\nconst { type } = useControls({ type: { value: 'A', options: ['A', 'B'] } });\n\nconst typeAControls = useControls(\n  'Type A Options',\n  { specific: 100 },\n  { render: (get) => get('type') === 'A' }\n);\n```\n\n## Debug Mode Patterns\n\n### Environment Variable\n```tsx\nconst DevTools = lazy(() => import('./TuningPanel'));\n\nfunction App() {\n  return (\n    <>\n      <MainContent />\n      {process.env.NODE_ENV === 'development' && (\n        <Suspense fallback={null}>\n          <DevTools />\n        </Suspense>\n      )}\n    </>\n  );\n}\n```\n\n### Keyboard Shortcut (âŒ˜â‡§D)\n```tsx\nconst [showPanel, setShowPanel] = useState(false);\n\nuseEffect(() => {\n  const handler = (e: KeyboardEvent) => {\n    if (e.metaKey && e.shiftKey && e.key === 'D') {\n      setShowPanel(prev => !prev);\n    }\n  };\n  window.addEventListener('keydown', handler);\n  return () => window.removeEventListener('keydown', handler);\n}, []);\n```\n\n### URL Parameter\n```tsx\nconst showDevTools = new URLSearchParams(window.location.search).has('debug');\n```\n\n## LLM Export Implementation\n\n**CRITICAL:** Track defaults and filter to show only changed values.\n\n```tsx\nexport default function TunableComponent() {\n  // CRITICAL: Store defaults at component level for comparison\n  const defaults = {\n    duration: 300,\n    delay: 0,\n    stiffness: 100,\n    damping: 10,\n    opacity: 1.0,\n  };\n\n  const config = useControls({\n    animation: folder({\n      duration: { value: 300, min: 0, max: 2000, step: 10 },\n      delay: { value: 0, min: 0, max: 1000, step: 10 },\n    }),\n    physics: folder({\n      stiffness: { value: 100, min: 0, max: 300, step: 1 },\n      damping: { value: 10, min: 0, max: 100, step: 1 },\n    }),\n    visual: folder({\n      opacity: { value: 1.0, min: 0, max: 1, step: 0.01 },\n    }),\n\n    'Export for LLM': button(() => {\n      const formatted = `## Tuned Parameters\n\nApply these values to the component:\n\n\\`\\`\\`typescript\nconst config = {\n${Object.entries(config)\n  .filter(([key]) => key !== 'Export for LLM')\n  .map(([key, val]) => `  ${key}: ${JSON.stringify(val)},`)\n  .join('\\n')}\n};\n\\`\\`\\`\n\n### Changes from Defaults\n${Object.entries(config)\n  .filter(([key, val]) => {\n    const defaultVal = defaults[key as keyof typeof defaults];\n    if (defaultVal === undefined) return false;\n    const numVal = Number(val);\n    const numDefault = Number(defaultVal);\n    if (!isNaN(numVal) && !isNaN(numDefault)) {\n      return Math.abs(numVal - numDefault) > 0.001;\n    }\n    return val !== defaultVal;\n  })\n  .map(([key, val]) => {\n    const defaultVal = defaults[key as keyof typeof defaults];\n    const displayKey = key.replace(/([A-Z])/g, ' $1')\n      .replace(/^./, str => str.toUpperCase());\n    const formattedDefault = typeof defaultVal === 'number'\n      ? defaultVal.toFixed(2) : defaultVal;\n    const formattedVal = typeof val === 'number'\n      ? val.toFixed(2) : val;\n    return `- ${displayKey}: ${formattedDefault} â†’ ${formattedVal}`;\n  })\n  .join('\\n') || '(No changes from defaults)'}\n`;\n      navigator.clipboard.writeText(formatted);\n      alert('Tuned parameters copied to clipboard!');\n    }),\n  });\n\n  return <Component {...config} />;\n}\n```\n\n## Common Mistakes\n\nâŒ **DON'T hardcode defaults in the export string:**\n```tsx\n// BAD - Shows \"Default: 300 â†’ ${config.duration}\" even if unchanged\n`- Duration: 300 â†’ ${config.duration}`\n```\n\nâŒ **DON'T use strict equality for numbers:**\n```tsx\n// BAD - Floating point comparison may fail\n.filter(([key, val]) => val !== defaults[key])\n```\n\nâŒ **DON'T forget to store defaults:**\n```tsx\n// BAD - No defaults object to compare against\nconst config = useControls({\n  duration: { value: 300, min: 0, max: 2000 },\n});\n```\n\nâœ… **DO store defaults and filter properly:**\n```tsx\n// GOOD - Proper defaults tracking and comparison\nconst defaults = { duration: 300, delay: 0 };\nconst config = useControls({ /* ... */ });\nconst changed = Object.entries(config).filter(([k, v]) =>\n  Math.abs(Number(v) - Number(defaults[k])) > 0.001\n);\n```\n\n## Persistence Patterns\n\n### localStorage\n```tsx\nuseEffect(() => {\n  localStorage.setItem('tuning-values', JSON.stringify(values));\n}, [values]);\n\nconst initialValues = JSON.parse(localStorage.getItem('tuning-values') || '{}');\n```\n\n### URL Sharing\n```tsx\nconst shareUrl = () => {\n  const params = new URLSearchParams();\n  Object.entries(values).forEach(([k, v]) => params.set(k, String(v)));\n  return `${location.origin}${location.pathname}?${params}`;\n};\n```\n\n### Presets\n```tsx\nconst PRESETS = {\n  snappy: { duration: 150, easing: 'easeOut', stiffness: 400 },\n  smooth: { duration: 400, easing: 'easeInOut', stiffness: 180 },\n  bouncy: { duration: 600, easing: 'easeOut', stiffness: 120, damping: 8 },\n};\n\nconst { preset } = useControls({\n  preset: {\n    value: 'smooth',\n    options: Object.keys(PRESETS),\n    onChange: (p) => applyPreset(PRESETS[p]),\n  },\n});\n```\n",
        "skills/tuning-panel/references/swiftui.md": "# SwiftUI Tuning Panels\n\nNative parameter tuning panels for SwiftUI using built-in controls and state bindings.\n\n## Basic Panel\n\n```swift\n#if DEBUG\nstruct TuningPanel: View {\n    @Binding var duration: Double\n    @Binding var damping: Double\n    @Binding var stiffness: Double\n    @Binding var accentColor: Color\n\n    var body: some View {\n        Form {\n            Section(\"Animation\") {\n                Slider(value: $duration, in: 0...2) {\n                    Text(\"Duration: \\(duration, specifier: \"%.2f\")s\")\n                }\n\n                Slider(value: $damping, in: 0...50) {\n                    Text(\"Damping: \\(damping, specifier: \"%.1f\")\")\n                }\n\n                Slider(value: $stiffness, in: 0...500) {\n                    Text(\"Stiffness: \\(stiffness, specifier: \"%.0f\")\")\n                }\n            }\n\n            Section(\"Colors\") {\n                ColorPicker(\"Accent\", selection: $accentColor)\n            }\n\n            Section {\n                Button(\"Copy for LLM\") {\n                    copyExportToClipboard()\n                }\n            }\n        }\n        .frame(width: 300)\n    }\n}\n#endif\n```\n\n## Control Types\n\n### Slider (Numbers)\n```swift\nSlider(value: $value, in: 0...100, step: 1) {\n    Text(\"Value: \\(value, specifier: \"%.0f\")\")\n}\n```\n\n### Stepper\n```swift\nStepper(\"Count: \\(count)\", value: $count, in: 0...10)\n```\n\n### Toggle (Boolean)\n```swift\nToggle(\"Enabled\", isOn: $isEnabled)\n```\n\n### Picker (Enum/Options)\n```swift\nPicker(\"Easing\", selection: $easing) {\n    Text(\"Linear\").tag(Easing.linear)\n    Text(\"Ease In\").tag(Easing.easeIn)\n    Text(\"Ease Out\").tag(Easing.easeOut)\n}\n```\n\n### ColorPicker\n```swift\nColorPicker(\"Accent Color\", selection: $color)\nColorPicker(\"With Opacity\", selection: $color, supportsOpacity: true)\n```\n\n### TextField (Strings)\n```swift\nTextField(\"Label\", text: $label)\n```\n\n## Organization\n\n### Sections\n```swift\nForm {\n    Section(\"Animation\") {\n        // animation controls\n    }\n\n    Section(\"Layout\") {\n        // layout controls\n    }\n\n    Section(\"Colors\") {\n        // color controls\n    }\n}\n```\n\n### Disclosure Groups (Collapsible)\n```swift\nDisclosureGroup(\"Advanced Options\") {\n    Slider(value: $advancedValue, in: 0...100)\n}\n```\n\n## Presentation Methods\n\n### Sheet\n```swift\n.sheet(isPresented: $showTuning) {\n    TuningPanel(duration: $duration, ...)\n}\n```\n\n### Popover\n```swift\n.popover(isPresented: $showTuning) {\n    TuningPanel(duration: $duration, ...)\n}\n```\n\n### Inspector (macOS)\n```swift\n.inspector(isPresented: $showTuning) {\n    TuningPanel(duration: $duration, ...)\n}\n```\n\n### Overlay\n```swift\n.overlay(alignment: .trailing) {\n    if showTuning {\n        TuningPanel(duration: $duration, ...)\n    }\n}\n```\n\n## Debug Mode Patterns\n\n### Build Flag\n```swift\n#if DEBUG\n@State private var showTuningPanel = false\n\nvar body: some View {\n    content\n        .sheet(isPresented: $showTuningPanel) {\n            TuningPanel(values: $animationValues)\n        }\n}\n#endif\n```\n\n### Keyboard Shortcut (macOS)\n```swift\nButton(\"Show Tuning\") {\n    showTuning.toggle()\n}\n.keyboardShortcut(\"d\", modifiers: [.command, .shift])\n```\n\n### Shake Gesture (iOS)\n```swift\n.onShake {\n    showTuningPanel.toggle()\n}\n```\n\n## LLM Export Implementation\n\nUse a tuple array to track defaults alongside current values:\n\n```swift\nfunc exportForLLM() -> String {\n    // Tuple: (category, paramName, defaultValue, currentValue)\n    let allParams: [(String, String, Double, Double)] = [\n        (\"Animation\", \"duration\", 0.3, duration),\n        (\"Animation\", \"springResponse\", 0.2, springResponse),\n        (\"Animation\", \"springDamping\", 0.8, springDamping),\n        (\"Visual\", \"opacity\", 1.0, opacity),\n        (\"Visual\", \"cornerRadius\", 12.0, cornerRadius),\n    ]\n\n    // Filter to only changed values (with floating-point tolerance)\n    let changed = allParams.filter { abs($0.2 - $0.3) > 0.001 }\n\n    if changed.isEmpty {\n        return \"## Parameters\\n\\nNo changes from defaults.\"\n    }\n\n    // Group by category for readable output\n    var grouped: [String: [(String, Double, Double)]] = [:]\n    for (category, name, defaultVal, currentVal) in changed {\n        grouped[category, default: []].append((name, defaultVal, currentVal))\n    }\n\n    var output = \"## Parameters\\n\\n### Changed Values\\n```swift\\n\"\n    for category in grouped.keys.sorted() {\n        output += \"// \\(category)\\n\"\n        for (name, defaultVal, currentVal) in grouped[category]! {\n            output += \"\\(name): \\(String(format: \"%.2f\", defaultVal)) â†’ \\(String(format: \"%.2f\", currentVal))\\n\"\n        }\n    }\n    output += \"```\"\n    return output\n}\n```\n\n### Copy to Clipboard (macOS)\n```swift\nfunc copyExportToClipboard() {\n    let export = exportForLLM()\n    NSPasteboard.general.clearContents()\n    NSPasteboard.general.setString(export, forType: .string)\n}\n```\n\n### Copy to Clipboard (iOS)\n```swift\nfunc copyExportToClipboard() {\n    let export = exportForLLM()\n    UIPasteboard.general.string = export\n}\n```\n\n## Benefits of Tuple Array Approach\n\n- **Single source of truth** for defaults (no separate dictionary)\n- **Category grouping** built into the data structure\n- **Easy to add/remove** parameters\n- **Works well** with Swift's strong typing\n\n## Complete Panel Example\n\n```swift\n#if DEBUG\nstruct AnimationTuningPanel: View {\n    @Binding var duration: Double\n    @Binding var springResponse: Double\n    @Binding var springDamping: Double\n    @Binding var opacity: Double\n    @Binding var cornerRadius: Double\n\n    var body: some View {\n        Form {\n            Section(\"Animation\") {\n                LabeledSlider(\"Duration\", value: $duration, range: 0...2, format: \"%.2f s\")\n                LabeledSlider(\"Response\", value: $springResponse, range: 0...1, format: \"%.2f\")\n                LabeledSlider(\"Damping\", value: $springDamping, range: 0...1, format: \"%.2f\")\n            }\n\n            Section(\"Visual\") {\n                LabeledSlider(\"Opacity\", value: $opacity, range: 0...1, format: \"%.2f\")\n                LabeledSlider(\"Corner Radius\", value: $cornerRadius, range: 0...32, format: \"%.0f\")\n            }\n\n            Section {\n                Button(\"Copy for LLM\") {\n                    copyExportToClipboard()\n                }\n                .buttonStyle(.borderedProminent)\n\n                Button(\"Reset to Defaults\") {\n                    resetToDefaults()\n                }\n            }\n        }\n        .formStyle(.grouped)\n        .frame(minWidth: 300)\n    }\n\n    func resetToDefaults() {\n        duration = 0.3\n        springResponse = 0.2\n        springDamping = 0.8\n        opacity = 1.0\n        cornerRadius = 12.0\n    }\n}\n\nstruct LabeledSlider: View {\n    let label: String\n    @Binding var value: Double\n    let range: ClosedRange<Double>\n    let format: String\n\n    var body: some View {\n        VStack(alignment: .leading) {\n            Text(\"\\(label): \\(String(format: format, value))\")\n                .font(.caption)\n            Slider(value: $value, in: range)\n        }\n    }\n}\n#endif\n```\n",
        "skills/tuning-panel/references/vanilla-js.md": "# Vanilla JS Tuning Panels\n\nParameter tuning panels for plain JavaScript using Tweakpane or dat.GUI.\n\n## Tweakpane (Recommended)\n\nModern, TypeScript-first, highly customizable.\n\n### Installation\n```bash\nnpm install tweakpane\n```\n\n### Basic Setup\n```typescript\nimport { Pane } from 'tweakpane';\n\nconst PARAMS = {\n  duration: 300,\n  easing: 'easeOut',\n  color: '#6366f1',\n};\n\nconst pane = new Pane({ title: 'Animation Tuning' });\n\npane.addBinding(PARAMS, 'duration', { min: 0, max: 2000, step: 10 });\npane.addBinding(PARAMS, 'easing', {\n  options: { Linear: 'linear', 'Ease Out': 'easeOut' }\n});\npane.addBinding(PARAMS, 'color');\n```\n\n### Control Types\n\n#### Number (Slider)\n```typescript\npane.addBinding(PARAMS, 'value', { min: 0, max: 100, step: 1 });\n```\n\n#### Select/Dropdown\n```typescript\npane.addBinding(PARAMS, 'easing', {\n  options: {\n    'Linear': 'linear',\n    'Ease In': 'ease-in',\n    'Ease Out': 'ease-out',\n  },\n});\n```\n\n#### Color\n```typescript\npane.addBinding(PARAMS, 'color'); // Hex string\n```\n\n#### Boolean\n```typescript\npane.addBinding(PARAMS, 'enabled'); // true/false\n```\n\n#### Point/Vector\n```typescript\npane.addBinding(PARAMS, 'position', {\n  x: { min: -100, max: 100 },\n  y: { min: -100, max: 100 },\n});\n```\n\n### Organization\n\n#### Folders\n```typescript\nconst animFolder = pane.addFolder({ title: 'Animation' });\nanimFolder.addBinding(PARAMS, 'duration');\n\nconst layoutFolder = pane.addFolder({ title: 'Layout', expanded: false });\nlayoutFolder.addBinding(PARAMS, 'padding');\n```\n\n#### Tabs\n```typescript\nconst tab = pane.addTab({\n  pages: [\n    { title: 'Animation' },\n    { title: 'Layout' },\n    { title: 'Colors' },\n  ],\n});\n\ntab.pages[0].addBinding(PARAMS, 'duration');\ntab.pages[1].addBinding(PARAMS, 'padding');\ntab.pages[2].addBinding(PARAMS, 'color');\n```\n\n#### Buttons\n```typescript\npane.addButton({ title: 'Export for LLM' }).on('click', () => {\n  exportForLLM();\n});\n\npane.addButton({ title: 'Reset' }).on('click', () => {\n  resetToDefaults();\n});\n```\n\n#### Read-Only Display\n```typescript\npane.addBinding(PARAMS, 'fps', { readonly: true });\n```\n\n### Change Listeners\n```typescript\npane.addBinding(PARAMS, 'duration').on('change', (ev) => {\n  console.log('Duration changed:', ev.value);\n  updateAnimation();\n});\n```\n\n---\n\n## dat.GUI (Alternative)\n\nClassic library with wide browser support.\n\n### Installation\n```bash\nnpm install dat.gui\n```\n\n### Basic Setup\n```javascript\nimport * as dat from 'dat.gui';\n\nconst params = {\n  duration: 300,\n  easing: 'easeOut',\n  color: '#6366f1',\n};\n\nconst gui = new dat.GUI();\ngui.add(params, 'duration', 0, 2000).step(10);\ngui.add(params, 'easing', ['linear', 'easeIn', 'easeOut']);\ngui.addColor(params, 'color');\n```\n\n### Folders\n```javascript\nconst animFolder = gui.addFolder('Animation');\nanimFolder.add(params, 'duration', 0, 2000);\nanimFolder.open();\n\nconst layoutFolder = gui.addFolder('Layout');\nlayoutFolder.add(params, 'padding', 0, 64);\n```\n\n### Change Listeners\n```javascript\ngui.add(params, 'duration', 0, 2000).onChange((value) => {\n  updateAnimation();\n});\n```\n\n---\n\n## Debug Mode Patterns\n\n### URL Parameter\n```typescript\nconst showDevTools = new URLSearchParams(window.location.search).has('debug');\n\nif (showDevTools) {\n  const pane = new Pane({ title: 'Tuning' });\n  // ... add controls\n}\n```\n\n### Keyboard Shortcut\n```typescript\nlet pane: Pane | null = null;\n\ndocument.addEventListener('keydown', (e) => {\n  if (e.metaKey && e.shiftKey && e.key === 'd') {\n    if (pane) {\n      pane.dispose();\n      pane = null;\n    } else {\n      pane = new Pane({ title: 'Tuning' });\n      setupControls(pane);\n    }\n  }\n});\n```\n\n### Development Environment Check\n```typescript\nif (process.env.NODE_ENV === 'development') {\n  const pane = new Pane({ title: 'Tuning' });\n  // ... add controls\n}\n```\n\n---\n\n## LLM Export Implementation\n\n```typescript\nconst DEFAULTS = {\n  duration: 300,\n  delay: 0,\n  stiffness: 100,\n  damping: 10,\n  opacity: 1.0,\n};\n\nconst PARAMS = { ...DEFAULTS };\n\nfunction exportForLLM() {\n  const changed = Object.entries(PARAMS)\n    .filter(([key, val]) => {\n      const defaultVal = DEFAULTS[key];\n      if (typeof val === 'number' && typeof defaultVal === 'number') {\n        return Math.abs(val - defaultVal) > 0.001;\n      }\n      return val !== defaultVal;\n    });\n\n  if (changed.length === 0) {\n    return '## Parameters\\n\\nNo changes from defaults.';\n  }\n\n  const lines = changed.map(([key, val]) => {\n    const defaultVal = DEFAULTS[key];\n    const displayKey = key.replace(/([A-Z])/g, ' $1')\n      .replace(/^./, (s) => s.toUpperCase());\n    return `- ${displayKey}: ${defaultVal} â†’ ${val}`;\n  });\n\n  return `## Tuned Parameters\n\n### Changed Values\n${lines.join('\\n')}\n\n### Full Config\n\\`\\`\\`javascript\nconst config = ${JSON.stringify(PARAMS, null, 2)};\n\\`\\`\\``;\n}\n\n// Add export button\npane.addButton({ title: 'Export for LLM' }).on('click', () => {\n  const output = exportForLLM();\n  navigator.clipboard.writeText(output);\n  alert('Copied to clipboard!');\n});\n```\n\n---\n\n## Persistence Patterns\n\n### localStorage\n```typescript\n// Save on change\npane.on('change', () => {\n  localStorage.setItem('tuning-values', JSON.stringify(PARAMS));\n});\n\n// Load on init\nconst saved = localStorage.getItem('tuning-values');\nif (saved) {\n  Object.assign(PARAMS, JSON.parse(saved));\n}\n```\n\n### URL Sharing\n```typescript\nfunction getShareUrl() {\n  const params = new URLSearchParams();\n  Object.entries(PARAMS).forEach(([k, v]) => params.set(k, String(v)));\n  return `${location.origin}${location.pathname}?${params}`;\n}\n\nfunction loadFromUrl() {\n  const urlParams = new URLSearchParams(location.search);\n  for (const [key, value] of urlParams) {\n    if (key in DEFAULTS) {\n      PARAMS[key] = typeof DEFAULTS[key] === 'number'\n        ? Number(value)\n        : value;\n    }\n  }\n}\n```\n\n### Presets\n```typescript\nconst PRESETS = {\n  snappy: { duration: 150, easing: 'easeOut', stiffness: 400 },\n  smooth: { duration: 400, easing: 'easeInOut', stiffness: 180 },\n  bouncy: { duration: 600, easing: 'easeOut', stiffness: 120, damping: 8 },\n};\n\npane.addBinding({ preset: 'smooth' }, 'preset', {\n  options: Object.keys(PRESETS).reduce((acc, k) => ({ ...acc, [k]: k }), {}),\n}).on('change', (ev) => {\n  Object.assign(PARAMS, PRESETS[ev.value]);\n  pane.refresh();\n});\n```\n\n---\n\n## Complete Example\n\n```typescript\nimport { Pane } from 'tweakpane';\n\nconst DEFAULTS = {\n  duration: 300,\n  delay: 0,\n  easing: 'easeOut',\n  opacity: 1.0,\n  scale: 1.0,\n  color: '#6366f1',\n};\n\nconst PARAMS = { ...DEFAULTS };\n\n// Only create in debug mode\nif (new URLSearchParams(location.search).has('debug')) {\n  const pane = new Pane({ title: 'Animation Tuning' });\n\n  const animFolder = pane.addFolder({ title: 'Timing' });\n  animFolder.addBinding(PARAMS, 'duration', { min: 0, max: 2000, step: 10 });\n  animFolder.addBinding(PARAMS, 'delay', { min: 0, max: 1000, step: 10 });\n  animFolder.addBinding(PARAMS, 'easing', {\n    options: { Linear: 'linear', 'Ease Out': 'easeOut', 'Ease In Out': 'easeInOut' },\n  });\n\n  const visualFolder = pane.addFolder({ title: 'Visual' });\n  visualFolder.addBinding(PARAMS, 'opacity', { min: 0, max: 1, step: 0.01 });\n  visualFolder.addBinding(PARAMS, 'scale', { min: 0.1, max: 2, step: 0.1 });\n  visualFolder.addBinding(PARAMS, 'color');\n\n  pane.addButton({ title: 'Export for LLM' }).on('click', () => {\n    navigator.clipboard.writeText(exportForLLM());\n    alert('Copied!');\n  });\n\n  pane.addButton({ title: 'Reset' }).on('click', () => {\n    Object.assign(PARAMS, DEFAULTS);\n    pane.refresh();\n  });\n\n  // Apply changes\n  pane.on('change', () => {\n    applyAnimation();\n  });\n}\n```\n",
        "skills/typography/SKILL.md": "---\nname: typography\ndescription: Apply professional typography principles to create readable, hierarchical, and aesthetically refined interfaces. Use when setting type scales, choosing fonts, adjusting spacing, designing text-heavy layouts, implementing dark mode typography, or when asked about readability, font pairing, line height, measure, typographic hierarchy, variable fonts, font loading, or OpenType features.\n---\n\n# Typography\n\nProfessional typography for user interfaces, grounded in principles from the masters.\n\n> \"Typography exists to honor content.\" â€” Robert Bringhurst\n\n## Reference Files\n\nFor detailed guidance on specific topics, consult these references:\n\n| Topic | When to Read |\n|-------|--------------|\n| [masters.md](references/masters.md) | Seeking authoritative backing, making nuanced judgments, understanding \"why\" |\n| [variable-fonts.md](references/variable-fonts.md) | Using variable fonts, fluid weight, performance optimization |\n| [font-loading.md](references/font-loading.md) | FOIT/FOUT issues, preloading, Core Web Vitals, self-hosting |\n| [opentype-features.md](references/opentype-features.md) | Ligatures, tabular numbers, stylistic sets, slashed zero |\n| [fluid-typography.md](references/fluid-typography.md) | clamp(), text-wrap, truncation, vertical rhythm, font smoothing |\n| [tailwind-integration.md](references/tailwind-integration.md) | Tailwind typography utilities, prose plugin, customization |\n| [internationalization.md](references/internationalization.md) | RTL languages, Arabic/Hebrew, CJK, bidirectional text |\n\n## Output Formats\n\n### Type System Recommendations\n\n```markdown\n## Type System\n\n### Scale\n- Base: [size, e.g., 16px]\n- Ratio: [e.g., Minor Third 1.200]\n- Rationale: [why this ratio]\n\n### Hierarchy\n| Level | Size | Weight | Line Height | Letter Spacing | Use |\n|-------|------|--------|-------------|----------------|-----|\n| Display | ... | ... | ... | ... | Hero, marketing |\n| H1 | ... | ... | ... | ... | Page titles |\n| H2 | ... | ... | ... | ... | Section heads |\n| Body | ... | ... | ... | ... | Paragraphs |\n| Small | ... | ... | ... | ... | Captions, labels |\n\n### Fonts\n- Primary: [font] â€” [rationale]\n- Secondary: [font, if applicable]\n- Mono: [font, if applicable]\n\n### Implementation\n[Ready-to-use CSS/Tailwind]\n```\n\n### Typography Audits\n\n```markdown\n## Typography Audit\n\n### Issues\n| Element | Problem | Recommendation |\n|---------|---------|----------------|\n| ... | ... | ... |\n\n### Quick Wins\n- [Immediate improvement 1]\n- [Immediate improvement 2]\n```\n\n---\n\n## Core Principles\n\n### The Four Fundamentals (Bringhurst)\n\nThe most important typographic considerations for body text:\n\n1. **Point size** â€” 16px minimum for body; 14px absolute floor for secondary text\n2. **Line spacing** â€” 1.5-1.7 for body; 1.1-1.3 for headings\n3. **Line length** â€” 45-75 characters (66 ideal); use `max-w-prose` (~65ch)\n4. **Font choice** â€” Match typeface to content and context\n\n### Hierarchy Through Contrast\n\nEstablish hierarchy using multiple dimensions:\n\n| Dimension | Low Contrast | High Contrast |\n|-----------|--------------|---------------|\n| Size | 14px â†’ 16px | 16px â†’ 48px |\n| Weight | 400 â†’ 500 | 400 â†’ 700 |\n| Color | Gray-600 â†’ Gray-900 | Gray-400 â†’ Black |\n| Case | Normal | UPPERCASE |\n\n> \"Use one typeface per design. Avoid italics and boldâ€”rely on gradations of scale instead.\" â€” Massimo Vignelli\n\n### Restraint\n\n- **1-2 font families maximum** â€” One serif, one sans if pairing\n- **3-4 heading levels in practice** â€” Deeper nesting usually signals structure problems\n- **Stick to your type scale** â€” Resist arbitrary sizes\n- **Let whitespace work** â€” Don't fill every gap\n\n> \"In the new computer age, the proliferation of typefaces represents a new level of visual pollution.\" â€” Massimo Vignelli\n\n---\n\n## Type Scales\n\n### Modular Scale Ratios\n\n| Name | Ratio | Character |\n|------|-------|-----------|\n| Minor Second | 1.067 | Subtle, conservative |\n| Major Second | 1.125 | Gentle, professional |\n| Minor Third | 1.200 | Balanced, versatile |\n| Major Third | 1.250 | Bold, impactful |\n| Perfect Fourth | 1.333 | Strong hierarchy |\n| Golden Ratio | 1.618 | Dramatic, editorial |\n\n### Practical Scale (Minor Third @ 16px)\n\n```css\n--text-xs:   12px;  /* 0.75rem */\n--text-sm:   14px;  /* 0.875rem */\n--text-base: 16px;  /* 1rem */\n--text-lg:   18px;  /* 1.125rem â€” not in pure scale */\n--text-xl:   20px;  /* 1.25rem */\n--text-2xl:  24px;  /* 1.5rem */\n--text-3xl:  30px;  /* 1.875rem */\n--text-4xl:  36px;  /* 2.25rem */\n--text-5xl:  48px;  /* 3rem */\n```\n\n### When to Deviate\n\n- **Marketing/hero:** Larger jumps allowed\n- **Dense data interfaces:** Tighter scale\n- **Mobile:** Slightly larger base (17-18px)\n\n---\n\n## Spacing Guidelines\n\n### Line Height by Context\n\n| Context | Line Height | Rationale |\n|---------|-------------|-----------|\n| Body text | 1.5-1.7 | Generous for readability |\n| Headings | 1.1-1.3 | Tighter, especially large sizes |\n| UI labels | 1.2-1.4 | Compact but legible |\n| Buttons | 1.0-1.25 | Single line, tight |\n\n> \"The eye does not read letters, but the space between them.\" â€” Adrian Frutiger\n\n### Letter Spacing\n\n| Context | Tracking | CSS |\n|---------|----------|-----|\n| Body text | Default or +0.01em | `tracking-normal` |\n| All caps | +0.05em to +0.1em | `tracking-wide` / `tracking-wider` |\n| Large headings | -0.01em to -0.02em | `tracking-tight` |\n| Small text (<14px) | +0.01em to +0.02em | `tracking-wide` |\n\n**All-caps rule:** Always add tracking. Keep short (1-3 words).\n\n### Paragraph Spacing\n\n- **Between paragraphs:** 1em to 1.5em (equal to or slightly more than line-height)\n- **After headings:** Reduced top margin on first paragraph\n- **Between sections:** 2-3Ã— paragraph spacing\n\n---\n\n## Font Selection\n\n### System Font Stacks\n\n```css\n/* Sans-serif (modern) */\nfont-family: ui-sans-serif, system-ui, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\";\n\n/* Serif */\nfont-family: ui-serif, Georgia, Cambria, \"Times New Roman\", serif;\n\n/* Monospace */\nfont-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;\n```\n\n### Safe Web Font Recommendations\n\n| Category | Fonts | Use Case |\n|----------|-------|----------|\n| Sans-serif | Inter, Source Sans 3, Work Sans, DM Sans | UI, body text |\n| Serif | Source Serif 4, Lora, Merriweather, Literata | Editorial, long-form |\n| Monospace | JetBrains Mono, Fira Code, Source Code Pro | Code, data |\n| Display | Fraunces, Epilogue, Outfit | Headlines |\n\n### Pairing Principles\n\n- **Pair by contrast** â€” Serif + sans-serif\n- **Match x-height** â€” For visual harmony when mixed\n- **Ensure weight availability** â€” Both need needed weights/styles\n\n> \"A father should not have a favorite among his daughters.\" â€” Hermann Zapf (on his typefaces)\n\n---\n\n## Modern CSS Typography\n\n### Text Wrapping\n\n```css\n/* Balanced line lengths for headings (â‰¤6 lines) */\nh1, h2, h3, blockquote, figcaption {\n  text-wrap: balance;\n}\n\n/* Prevent orphans in body text */\np, li {\n  text-wrap: pretty;\n}\n```\n\n**Caveat:** Don't use `balance` inside bordered containersâ€”creates visual imbalance.\n\n### Fluid Typography\n\n```css\n/* Font scales smoothly between breakpoints */\nh1 {\n  font-size: clamp(2rem, 1rem + 4vw, 4rem);\n  line-height: clamp(1.1, 1.3 - 0.1vw, 1.3);\n}\n\nbody {\n  font-size: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);\n}\n```\n\nSee [fluid-typography.md](references/fluid-typography.md) for complete scale.\n\n### Text Truncation\n\n```css\n/* Single line */\n.truncate {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* Multi-line (2 lines) */\n.line-clamp-2 {\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n```\n\n---\n\n## Dark Mode Typography\n\n### Weight Adjustment\n\nText appears heavier on dark backgrounds. Reduce weight slightly:\n\n```css\n@media (prefers-color-scheme: dark) {\n  body {\n    font-weight: 350; /* Instead of 400 */\n  }\n  h1, h2, h3 {\n    font-weight: 600; /* Instead of 700 */\n  }\n}\n```\n\n### Font Smoothing\n\nApply antialiasing on dark backgrounds to counter perceived boldness:\n\n```css\n.dark-bg {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n```\n\n### Color Contrast\n\n- Avoid pure white (#fff) on pure black (#000)â€”too harsh\n- Use off-white (#f5f5f5) and near-black (#1a1a1a)\n- Aim for 10:1 to 15:1 contrast in dark mode\n\n---\n\n## Typographic Details\n\n### Quotation Marks\n\nUse curly quotes, not straight:\n- Correct: \"Hello\" and 'world'\n- Incorrect: \"Hello\" and 'world'\n\n### Dashes\n\n| Type | Character | Use |\n|------|-----------|-----|\n| Hyphen | - | Word breaks, compounds |\n| En dash | â€“ | Ranges (2020â€“2024), relationships |\n| Em dash | â€” | Parenthetical statements |\n\n### Numbers\n\n| Type | Use Case | CSS |\n|------|----------|-----|\n| Tabular | Tables, prices, alignment | `font-variant-numeric: tabular-nums` |\n| Proportional | Body text | `font-variant-numeric: proportional-nums` |\n| Old-style | Editorial content | `font-variant-numeric: oldstyle-nums` |\n| Slashed zero | Code, data | `font-feature-settings: \"zero\" 1` |\n\nSee [opentype-features.md](references/opentype-features.md) for complete reference.\n\n---\n\n## Accessibility\n\n### Minimums\n\n| Element | Minimum | Preferred |\n|---------|---------|-----------|\n| Body text | 16px | 16-18px |\n| Secondary text | 14px | 14-16px |\n| Legal/caption | 12px | 12px + increased tracking |\n| Contrast ratio | 4.5:1 | 7:1 |\n\n### User Preferences\n\n```css\n/* Use relative units so users can scale */\nbody {\n  font-size: 1rem; /* Not 16px */\n}\n\n/* Respect reduced motion */\n@media (prefers-reduced-motion: reduce) {\n  * {\n    transition: none !important;\n  }\n}\n```\n\n### Dyslexia Considerations\n\n- Avoid justified text\n- Prefer sans-serif with distinct letterforms (a vs Î±, l vs 1 vs I)\n- Generous line height and paragraph spacing\n- Consider offering OpenDyslexic as option\n\n---\n\n## Common Mistakes\n\n### Avoid\n\n- All-caps body text or long headings\n- Centered body paragraphs\n- Line length over 80 characters\n- Insufficient contrast for \"aesthetic\" reasons\n- Mixing too many font families (>2)\n- Decorative fonts for UI text\n- Justified text on the web\n- Tiny gray text on white backgrounds\n- Letter-spacing on Arabic text\n\n### Watch For\n\n- Orphans and widows in prominent text\n- Inconsistent heading hierarchy\n- Missing font fallbacks\n- Layout shift from web font loading\n- Underlined text that isn't a link\n\n---\n\n## Quick Implementation\n\n### Minimal Professional Setup\n\n```css\n:root {\n  --font-sans: Inter, ui-sans-serif, system-ui, sans-serif;\n  --font-mono: 'JetBrains Mono', ui-monospace, monospace;\n}\n\nbody {\n  font-family: var(--font-sans);\n  font-size: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);\n  line-height: 1.6;\n  font-feature-settings: \"kern\" 1, \"liga\" 1, \"calt\" 1;\n}\n\nh1, h2, h3 {\n  line-height: 1.2;\n  text-wrap: balance;\n  letter-spacing: -0.02em;\n}\n\np {\n  text-wrap: pretty;\n  max-width: 65ch;\n}\n\ncode {\n  font-family: var(--font-mono);\n  font-variant-numeric: tabular-nums slashed-zero;\n}\n\n@media (prefers-color-scheme: dark) {\n  body {\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n}\n```\n\n### Tailwind Quick Start\n\n```html\n<article class=\"\n  prose prose-gray lg:prose-lg\n  prose-headings:text-balance\n  prose-p:text-pretty\n  dark:prose-invert\n  max-w-prose mx-auto\n\">\n  <!-- Content -->\n</article>\n```\n\nSee [tailwind-integration.md](references/tailwind-integration.md) for complete patterns.\n",
        "skills/typography/references/fluid-typography.md": "# Fluid Typography & Modern CSS\n\nResponsive typography that scales smoothly across viewports, plus modern CSS text features.\n\n## Table of Contents\n\n- [Fluid Type with clamp()](#fluid-type-with-clamp)\n- [Building a Fluid Type Scale](#building-a-fluid-type-scale)\n- [Text Wrapping: balance and pretty](#text-wrapping-balance-and-pretty)\n- [Text Truncation](#text-truncation)\n- [Vertical Rhythm](#vertical-rhythm)\n- [Font Smoothing](#font-smoothing)\n- [Optical Adjustments](#optical-adjustments)\n\n---\n\n## Fluid Type with clamp()\n\n`clamp(min, preferred, max)` creates font sizes that scale smoothly between breakpoints.\n\n### Basic Syntax\n\n```css\n/* Font scales from 1rem to 1.5rem based on viewport */\nh1 {\n  font-size: clamp(1rem, 0.5rem + 2vw, 1.5rem);\n}\n```\n\n**How it works:**\n- Below ~320px: Uses minimum (1rem)\n- Above ~768px: Uses maximum (1.5rem)\n- Between: Scales linearly with viewport\n\n### The Formula\n\n```\nclamp(min, preferred, max)\n\npreferred = base + (viewport-unit * multiplier)\n```\n\n**Calculating the preferred value:**\n\n```\npreferred = min + (max - min) * ((100vw - min-viewport) / (max-viewport - min-viewport))\n```\n\nSimplified to:\n```css\n/* For 1rem at 320px to 2rem at 1200px */\nfont-size: clamp(1rem, 0.636rem + 1.82vw, 2rem);\n```\n\n### Practical Examples\n\n```css\n/* Body text: 16px â†’ 18px */\nbody {\n  font-size: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);\n}\n\n/* H1: 32px â†’ 64px */\nh1 {\n  font-size: clamp(2rem, 1rem + 4vw, 4rem);\n}\n\n/* H2: 24px â†’ 40px */\nh2 {\n  font-size: clamp(1.5rem, 1rem + 2vw, 2.5rem);\n}\n\n/* Small text: 14px â†’ 16px */\n.small {\n  font-size: clamp(0.875rem, 0.825rem + 0.25vw, 1rem);\n}\n```\n\n### Line Height That Scales\n\n```css\nh1 {\n  font-size: clamp(2rem, 1rem + 4vw, 4rem);\n  /* Tighter line-height at larger sizes */\n  line-height: clamp(1.1, 1.3 - 0.1vw, 1.3);\n}\n```\n\n---\n\n## Building a Fluid Type Scale\n\n### CSS Custom Properties Approach\n\n```css\n:root {\n  /* Fluid scale based on Minor Third (1.2) */\n  --text-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);\n  --text-sm: clamp(0.875rem, 0.825rem + 0.25vw, 1rem);\n  --text-base: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);\n  --text-lg: clamp(1.125rem, 1rem + 0.5vw, 1.25rem);\n  --text-xl: clamp(1.25rem, 1rem + 1vw, 1.5rem);\n  --text-2xl: clamp(1.5rem, 1rem + 2vw, 2rem);\n  --text-3xl: clamp(1.875rem, 1rem + 3vw, 2.5rem);\n  --text-4xl: clamp(2.25rem, 1rem + 4vw, 3rem);\n  --text-5xl: clamp(3rem, 1rem + 5vw, 4rem);\n}\n\n/* Usage */\nbody { font-size: var(--text-base); }\nh1 { font-size: var(--text-4xl); }\nh2 { font-size: var(--text-3xl); }\nh3 { font-size: var(--text-2xl); }\n.caption { font-size: var(--text-sm); }\n```\n\n### Tools for Generating Scales\n\n- **[Utopia](https://utopia.fyi/type/calculator)** â€” Fluid type scale generator\n- **[Fluid Type Scale](https://www.fluid-type-scale.com/)** â€” CSS clamp generator\n- **[Type Scale](https://typescale.com/)** â€” Visual scale builder\n\n### Fluid Spacing to Match\n\n```css\n:root {\n  /* Fluid spacing that matches type scale rhythm */\n  --space-xs: clamp(0.25rem, 0.2rem + 0.25vw, 0.5rem);\n  --space-sm: clamp(0.5rem, 0.4rem + 0.5vw, 0.75rem);\n  --space-md: clamp(1rem, 0.8rem + 1vw, 1.5rem);\n  --space-lg: clamp(1.5rem, 1rem + 2vw, 2.5rem);\n  --space-xl: clamp(2rem, 1rem + 4vw, 4rem);\n}\n```\n\n---\n\n## Text Wrapping: balance and pretty\n\nModern CSS properties for better text layout.\n\n### text-wrap: balance\n\nBalances line lengths for short text blocks (headings, captions).\n\n```css\nh1, h2, h3, blockquote {\n  text-wrap: balance;\n}\n```\n\n**Before:**\n```\nThis is a really long headline that\nwraps\n```\n\n**After:**\n```\nThis is a really long\nheadline that wraps\n```\n\n**Limitations:**\n- Only works on blocks â‰¤6 lines (Chrome) or â‰¤10 lines (Firefox)\n- Computationally expensive â€” don't use on body text\n- May create awkward layouts in cards/containers with borders\n\n**When NOT to use:**\n- Inside bordered containers (creates visual imbalance with container)\n- On body paragraphs (performance)\n- When text should fill available width\n\n### text-wrap: pretty\n\nPrevents orphans (single words on last line) in paragraphs.\n\n```css\np {\n  text-wrap: pretty;\n}\n```\n\n**Before:**\n```\nThis is a paragraph with some text that ends with a single\nword.\n```\n\n**After:**\n```\nThis is a paragraph with some text that\nends with a single word.\n```\n\n**When to use:**\n- Body paragraphs\n- Any multi-line text where orphans look bad\n- Safe for all text (minimal performance impact)\n\n### Combined Usage\n\n```css\n/* Headings: balance */\nh1, h2, h3, h4, h5, h6,\nblockquote,\nfigcaption {\n  text-wrap: balance;\n}\n\n/* Body text: prevent orphans */\np, li {\n  text-wrap: pretty;\n}\n```\n\n### Browser Support\n\n- `text-wrap: balance` â€” Chrome 114+, Firefox 121+, Safari 17.4+\n- `text-wrap: pretty` â€” Chrome 117+, Firefox 125+, Safari TP\n\nBoth are progressive enhancements â€” safe to use without fallbacks.\n\n---\n\n## Text Truncation\n\n### Single Line\n\n```css\n.truncate {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n```\n\n### Multi-Line (Line Clamping)\n\n```css\n.line-clamp-2 {\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.line-clamp-3 {\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n```\n\n### Tailwind Classes\n\n```html\n<p class=\"truncate\">Single line truncation...</p>\n<p class=\"line-clamp-2\">Multi-line truncation...</p>\n<p class=\"line-clamp-3\">Three line truncation...</p>\n```\n\n### Accessibility Consideration\n\nTruncated text hides information. Consider:\n- Providing full text on hover/focus (tooltip)\n- Using `aria-label` with full content\n- \"Read more\" links for important content\n\n```css\n.truncate {\n  /* Truncation styles */\n}\n\n.truncate:hover,\n.truncate:focus {\n  white-space: normal;\n  -webkit-line-clamp: unset;\n}\n```\n\n---\n\n## Vertical Rhythm\n\nConsistent spacing based on a baseline unit.\n\n### Basic Vertical Rhythm\n\n```css\n:root {\n  --baseline: 1.5rem; /* 24px at 16px base */\n}\n\nbody {\n  line-height: var(--baseline);\n}\n\nh1, h2, h3, h4, h5, h6, p, ul, ol {\n  margin-top: 0;\n  margin-bottom: var(--baseline);\n}\n\nh1 { margin-bottom: calc(var(--baseline) * 2); }\nsection { margin-bottom: calc(var(--baseline) * 3); }\n```\n\n### Modern Approach with cap Unit\n\nThe `cap` unit equals the cap height of the first available font:\n\n```css\n/* Align text to baseline using cap height */\nh1 {\n  margin-top: 1cap;\n  margin-bottom: 0.5cap;\n}\n```\n\n**Browser support:** Chrome 87+, Firefox 97+, Safari 17+\n\n### Practical Rhythm System\n\n```css\n:root {\n  --rhythm: 0.5rem; /* 8px base unit */\n}\n\n/* Everything is a multiple of 8px */\n.space-1 { margin-bottom: var(--rhythm); }       /* 8px */\n.space-2 { margin-bottom: calc(var(--rhythm) * 2); } /* 16px */\n.space-3 { margin-bottom: calc(var(--rhythm) * 3); } /* 24px */\n.space-4 { margin-bottom: calc(var(--rhythm) * 4); } /* 32px */\n.space-6 { margin-bottom: calc(var(--rhythm) * 6); } /* 48px */\n.space-8 { margin-bottom: calc(var(--rhythm) * 8); } /* 64px */\n```\n\n---\n\n## Font Smoothing\n\nControl text rendering, especially on macOS.\n\n### The Properties\n\n```css\n.smoothed {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n```\n\n### What It Does\n\n- **Default (subpixel):** Uses RGB subpixels for sharper text\n- **Antialiased/grayscale:** Uses whole pixels; text appears lighter\n\n### When to Use\n\n**Apply smoothing on dark backgrounds:**\n\n```css\n/* Text appears too bold on dark backgrounds without smoothing */\n.dark-bg {\n  background: #1a1a1a;\n  color: #f5f5f5;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n```\n\n**Consider for entire dark mode:**\n\n```css\n@media (prefers-color-scheme: dark) {\n  body {\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n}\n```\n\n### Caution\n\n- Only affects macOS (Chrome/Safari use -webkit, Firefox uses -moz)\n- Windows/Linux ignore these properties\n- Don't apply globally on light backgrounds â€” reduces clarity\n\n---\n\n## Optical Adjustments\n\nManual tweaks for visual harmony.\n\n### Optical Centering\n\nMathematical center â‰  visual center. Text often needs to move up:\n\n```css\n.button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  /* Nudge text up slightly for optical centering */\n  padding-top: 0;\n  padding-bottom: 2px;\n}\n```\n\n### Kerning Adjustments\n\nMost fonts have good built-in kerning, but headlines may need tweaks:\n\n```css\n/* Tighten large headlines */\nh1 {\n  font-size: 4rem;\n  letter-spacing: -0.02em;\n}\n\n/* Loosen all-caps */\n.label {\n  text-transform: uppercase;\n  letter-spacing: 0.1em;\n}\n```\n\n### Problematic Letter Pairs\n\nThese often need manual kerning:\n- AV, AW, AT, AY\n- To, Tr, Ta, Te\n- LT, LV, LW, LY\n- VA, Vo, Vu\n- Yo, Ya\n\n### Overshoot Understanding\n\nRound and pointed letters extend slightly beyond baseline/cap-height to appear equal:\n\n- O, C, G, Q â€” extend above and below\n- A, V, W â€” points extend above/below\n- This is intentional â€” don't \"fix\" it\n\n### Leading Adjustments by Size\n\n```css\n/* Tighter leading for larger text */\nh1 { font-size: 4rem; line-height: 1.1; }\nh2 { font-size: 2.5rem; line-height: 1.2; }\nh3 { font-size: 1.5rem; line-height: 1.3; }\nbody { font-size: 1rem; line-height: 1.6; }\n```\n\n---\n\n## Quick Reference\n\n### Complete Fluid Typography Setup\n\n```css\n:root {\n  /* Fluid type scale */\n  --text-sm: clamp(0.875rem, 0.8rem + 0.25vw, 1rem);\n  --text-base: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);\n  --text-lg: clamp(1.25rem, 1rem + 1vw, 1.5rem);\n  --text-xl: clamp(1.5rem, 1rem + 2vw, 2rem);\n  --text-2xl: clamp(2rem, 1rem + 3vw, 3rem);\n  --text-3xl: clamp(2.5rem, 1rem + 4vw, 4rem);\n}\n\nbody {\n  font-size: var(--text-base);\n  line-height: 1.6;\n}\n\nh1 { font-size: var(--text-3xl); line-height: 1.1; text-wrap: balance; }\nh2 { font-size: var(--text-2xl); line-height: 1.2; text-wrap: balance; }\nh3 { font-size: var(--text-xl); line-height: 1.3; text-wrap: balance; }\n\np { text-wrap: pretty; }\n\n@media (prefers-color-scheme: dark) {\n  body {\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n}\n```\n",
        "skills/typography/references/font-loading.md": "# Font Loading & Performance\n\nStrategies for loading web fonts without compromising performance or user experience.\n\n## Table of Contents\n\n- [Understanding FOIT and FOUT](#understanding-foit-and-fout)\n- [The font-display Property](#the-font-display-property)\n- [Preloading Fonts](#preloading-fonts)\n- [Optimal Loading Strategies](#optimal-loading-strategies)\n- [Core Web Vitals Impact](#core-web-vitals-impact)\n- [Self-Hosting vs CDN](#self-hosting-vs-cdn)\n- [Font Subsetting](#font-subsetting)\n\n---\n\n## Understanding FOIT and FOUT\n\n### FOIT (Flash of Invisible Text)\n\nBrowser hides text completely until the custom font loads.\n\n**Behavior:** Blank space where text should be â†’ text appears\n**Problem:** Users see nothing; content is inaccessible during load\n**Default in:** Older browsers, `font-display: block`\n\n### FOUT (Flash of Unstyled Text)\n\nBrowser shows fallback font immediately, then swaps to custom font.\n\n**Behavior:** System font visible â†’ swap to custom font\n**Problem:** Visual shift when fonts swap; can cause layout shifts\n**Default in:** Modern browsers with `font-display: swap`\n\n### Which is Better?\n\n**FOUT is generally preferred** because:\n- Content is immediately accessible\n- Users can start reading right away\n- Better for Core Web Vitals (LCP, CLS with mitigation)\n\n---\n\n## The font-display Property\n\nControls how fonts render during loading.\n\n```css\n@font-face {\n  font-family: 'MyFont';\n  src: url('/fonts/myfont.woff2') format('woff2');\n  font-display: swap; /* or block, fallback, optional, auto */\n}\n```\n\n### Values Explained\n\n| Value | Block Period | Swap Period | Best For |\n|-------|-------------|-------------|----------|\n| `auto` | Browser decides | Browser decides | Letting browser optimize |\n| `block` | 3s | Infinite | Critical branding fonts |\n| `swap` | ~100ms | Infinite | Most use cases |\n| `fallback` | ~100ms | ~3s | Balance of speed and design |\n| `optional` | ~100ms | None | Performance-critical sites |\n\n### Recommended Defaults\n\n```css\n/* For most fonts */\nfont-display: swap;\n\n/* For critical above-the-fold fonts with preload */\nfont-display: optional;\n\n/* For icon fonts (must not show fallback) */\nfont-display: block;\n```\n\n### Detailed Behavior\n\n**`swap`**\n- Shows fallback immediately\n- Swaps to custom font whenever it loads\n- Best for body text and most headings\n\n**`optional`**\n- Shows fallback immediately\n- Only swaps if font loads very quickly (~100ms)\n- If font misses window, fallback used for entire page visit\n- Font cached for next visit\n- Best with preloading for zero layout shift\n\n**`fallback`**\n- Brief invisible period (~100ms)\n- Swaps only if font loads within ~3s\n- Good middle ground\n\n---\n\n## Preloading Fonts\n\nTell the browser to fetch fonts early, before CSS is parsed.\n\n### Basic Preload\n\n```html\n<head>\n  <!-- Preload critical fonts -->\n  <link\n    rel=\"preload\"\n    href=\"/fonts/inter-var.woff2\"\n    as=\"font\"\n    type=\"font/woff2\"\n    crossorigin\n  >\n\n  <!-- Then load CSS -->\n  <link rel=\"stylesheet\" href=\"/styles.css\">\n</head>\n```\n\n### Critical Points\n\n**Always include `crossorigin`** â€” Even for same-origin fonts. Fonts are fetched with CORS, and omitting this causes double-fetching.\n\n**Only preload critical fonts:**\n- Above-the-fold fonts\n- Primary body font\n- 1-2 fonts maximum\n\n**Don't preload:**\n- Fonts used only below the fold\n- Fonts for rare UI states\n- More than 2-3 fonts\n\n### Preload + font-display: optional\n\nThe most performant combination:\n\n```html\n<link rel=\"preload\" href=\"/fonts/inter.woff2\" as=\"font\" type=\"font/woff2\" crossorigin>\n```\n\n```css\n@font-face {\n  font-family: 'Inter';\n  src: url('/fonts/inter.woff2') format('woff2');\n  font-display: optional;\n}\n```\n\n**Result:** Zero layout shift. Font either loads in time or fallback used for entire session.\n\n---\n\n## Optimal Loading Strategies\n\n### Strategy 1: Simple Swap (Most Common)\n\nBest for: Most websites\n\n```css\n@font-face {\n  font-family: 'Inter';\n  src: url('/fonts/inter-var.woff2') format('woff2');\n  font-display: swap;\n}\n```\n\nPros: Simple, content always visible\nCons: Layout shift when font loads\n\n### Strategy 2: Preload + Optional (Zero Layout Shift)\n\nBest for: Performance-critical sites\n\n```html\n<link rel=\"preload\" href=\"/fonts/inter.woff2\" as=\"font\" type=\"font/woff2\" crossorigin>\n```\n\n```css\n@font-face {\n  font-family: 'Inter';\n  src: url('/fonts/inter.woff2') format('woff2');\n  font-display: optional;\n}\n```\n\nPros: No layout shift, great LCP\nCons: Users may see fallback on slow connections\n\n### Strategy 3: FOUT with Class (Full Control)\n\nBest for: Sites needing precise control\n\n```html\n<script>\n  // Check if fonts are cached\n  if (sessionStorage.fontsLoaded) {\n    document.documentElement.classList.add('fonts-loaded');\n  }\n</script>\n```\n\n```css\n/* Fallback styles */\nbody {\n  font-family: system-ui, sans-serif;\n}\n\n/* Enhanced styles when fonts load */\n.fonts-loaded body {\n  font-family: 'Inter', system-ui, sans-serif;\n}\n```\n\n```javascript\n// Load fonts and add class\nif ('fonts' in document) {\n  Promise.all([\n    document.fonts.load('400 1em Inter'),\n    document.fonts.load('700 1em Inter')\n  ]).then(() => {\n    document.documentElement.classList.add('fonts-loaded');\n    sessionStorage.fontsLoaded = true;\n  });\n}\n```\n\nPros: Complete control, can optimize fallback matching\nCons: More complex, requires JavaScript\n\n### Strategy 4: Critical FOFT (Two-Stage Loading)\n\nBest for: Large font families\n\nLoad a subset first (roman only), then full family:\n\n```css\n/* Stage 1: Critical subset */\n@font-face {\n  font-family: 'Inter';\n  src: url('/fonts/inter-roman-subset.woff2') format('woff2');\n  font-display: swap;\n  unicode-range: U+0000-00FF; /* Basic Latin */\n}\n\n/* Stage 2: Full font (loaded async) */\n@font-face {\n  font-family: 'Inter Full';\n  src: url('/fonts/inter-full.woff2') format('woff2');\n  font-display: swap;\n}\n```\n\n---\n\n## Core Web Vitals Impact\n\n### LCP (Largest Contentful Paint)\n\nFonts affect LCP when text is the largest element.\n\n**Improve LCP:**\n- Preload critical fonts\n- Use `font-display: optional` or `swap`\n- Self-host to reduce DNS/connection overhead\n\n### CLS (Cumulative Layout Shift)\n\nFont swapping causes layout shifts.\n\n**Reduce CLS:**\n- Use `font-display: optional` with preload\n- Match fallback font metrics to custom font\n- Use `size-adjust` in @font-face\n\n### Fallback Font Matching\n\n```css\n@font-face {\n  font-family: 'Inter Fallback';\n  src: local('Arial');\n  ascent-override: 90%;\n  descent-override: 22%;\n  line-gap-override: 0%;\n  size-adjust: 107%;\n}\n\nbody {\n  font-family: 'Inter', 'Inter Fallback', sans-serif;\n}\n```\n\n**Tools for calculating overrides:**\n- [Fallback Font Generator](https://screenspan.net/fallback)\n- [fontpie](https://github.com/nickshanks/fontpie)\n\n---\n\n## Self-Hosting vs CDN\n\n### Self-Hosting\n\n**Pros:**\n- Full control over caching\n- No third-party requests\n- Privacy (no Google/Adobe tracking)\n- Consistent availability\n\n**Cons:**\n- You manage updates\n- Initial setup effort\n\n**Best for:** Production sites, privacy-focused projects\n\n### Google Fonts / Adobe Fonts\n\n**Pros:**\n- Easy setup\n- Automatic updates\n- Wide font selection\n\n**Cons:**\n- Third-party dependency\n- Privacy concerns (GDPR)\n- Cross-origin requests add latency\n- Cache partitioning reduces benefits\n\n**Best for:** Prototypes, quick projects\n\n### Modern Recommendation\n\n**Self-host for production.** Cache partitioning in modern browsers means the \"shared cache\" benefit of CDNs no longer applies.\n\n```bash\n# Download Google Fonts for self-hosting\n# Use google-webfonts-helper: https://gwfh.mranftl.com/fonts\n```\n\n---\n\n## Font Subsetting\n\nRemove unused characters to reduce file size.\n\n### Common Subsets\n\n| Subset | Characters | Use Case |\n|--------|------------|----------|\n| Latin | ~200 glyphs | English-only sites |\n| Latin Extended | ~500 glyphs | European languages |\n| Full | 1000+ glyphs | Multilingual |\n\n### Tools\n\n**glyphanger** (Node.js):\n```bash\nnpm install -g glyphanger\nglyphanger --whitelist=\"US_ASCII\" --subset=font.woff2\n```\n\n**pyftsubset** (Python):\n```bash\npip install fonttools\npyftsubset font.ttf --unicodes=\"U+0000-00FF\" --output-file=font-subset.woff2\n```\n\n### Unicode Range in CSS\n\nOnly download fonts for characters actually used:\n\n```css\n/* Latin subset */\n@font-face {\n  font-family: 'Inter';\n  src: url('/fonts/inter-latin.woff2') format('woff2');\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153;\n}\n\n/* Cyrillic subset (only loaded if needed) */\n@font-face {\n  font-family: 'Inter';\n  src: url('/fonts/inter-cyrillic.woff2') format('woff2');\n  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1;\n}\n```\n\n---\n\n## Quick Checklist\n\n### Minimum Viable Font Loading\n\n```html\n<!-- 1. Preload critical font -->\n<link rel=\"preload\" href=\"/fonts/main.woff2\" as=\"font\" type=\"font/woff2\" crossorigin>\n```\n\n```css\n/* 2. Define with swap */\n@font-face {\n  font-family: 'MainFont';\n  src: url('/fonts/main.woff2') format('woff2');\n  font-display: swap;\n}\n\n/* 3. Use with fallback stack */\nbody {\n  font-family: 'MainFont', system-ui, -apple-system, sans-serif;\n}\n```\n\n### Performance Audit Checklist\n\n- [ ] Using WOFF2 format?\n- [ ] Only loading needed weights?\n- [ ] Preloading above-the-fold fonts?\n- [ ] Using appropriate font-display value?\n- [ ] Self-hosting for production?\n- [ ] Subsetting to remove unused characters?\n- [ ] Fallback font metrics matched?\n",
        "skills/typography/references/internationalization.md": "# Internationalization & RTL Typography\n\nTypography considerations for multilingual content and right-to-left languages.\n\n## Table of Contents\n\n- [RTL Fundamentals](#rtl-fundamentals)\n- [CSS Logical Properties](#css-logical-properties)\n- [Font Selection for Multilingual](#font-selection-for-multilingual)\n- [Arabic Typography](#arabic-typography)\n- [Hebrew Typography](#hebrew-typography)\n- [CJK Typography](#cjk-typography)\n- [Bidirectional Text](#bidirectional-text)\n\n---\n\n## RTL Fundamentals\n\nRight-to-left (RTL) languages include Arabic, Hebrew, Persian (Farsi), and Urdu. They affect layout direction, not just text direction.\n\n### Basic Setup\n\n```html\n<!-- Set direction on html element -->\n<html lang=\"ar\" dir=\"rtl\">\n\n<!-- Or on specific sections -->\n<div dir=\"rtl\" lang=\"ar\">\n  Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù‡Ù†Ø§\n</div>\n```\n\n### Always Use Both\n\n**HTML `dir` attribute** â€” Affects browser behavior (form controls, tables, lists)\n**CSS direction** â€” Affects layout and styling\n\n```css\n[dir=\"rtl\"] {\n  direction: rtl;\n}\n```\n\n### What Changes in RTL\n\n| LTR | RTL |\n|-----|-----|\n| Left-aligned text | Right-aligned text |\n| Left sidebar | Right sidebar |\n| Forward arrow â†’ | Forward arrow â† |\n| Horizontal scroll left-to-right | Horizontal scroll right-to-left |\n| Progress bars fill left-to-right | Progress bars fill right-to-left |\n\n### What Stays the Same\n\n- Images (unless they convey direction)\n- Icons indicating physical direction (phone handset, etc.)\n- Brand logos\n- Numeric digits within numbers\n- Timestamps and dates (may need locale formatting)\n\n---\n\n## CSS Logical Properties\n\nLogical properties adapt automatically to text direction.\n\n### Margin and Padding\n\n| Physical | Logical |\n|----------|---------|\n| `margin-left` | `margin-inline-start` |\n| `margin-right` | `margin-inline-end` |\n| `margin-top` | `margin-block-start` |\n| `margin-bottom` | `margin-block-end` |\n| `padding-left` | `padding-inline-start` |\n| `padding-right` | `padding-inline-end` |\n\n```css\n/* Instead of this */\n.card {\n  margin-left: 1rem;\n  padding-right: 2rem;\n}\n\n/* Use this */\n.card {\n  margin-inline-start: 1rem;\n  padding-inline-end: 2rem;\n}\n```\n\n### Position\n\n| Physical | Logical |\n|----------|---------|\n| `left` | `inset-inline-start` |\n| `right` | `inset-inline-end` |\n| `top` | `inset-block-start` |\n| `bottom` | `inset-block-end` |\n\n```css\n.tooltip {\n  position: absolute;\n  inset-inline-start: 100%;\n  inset-block-start: 0;\n}\n```\n\n### Border\n\n| Physical | Logical |\n|----------|---------|\n| `border-left` | `border-inline-start` |\n| `border-right` | `border-inline-end` |\n| `border-top-left-radius` | `border-start-start-radius` |\n| `border-top-right-radius` | `border-start-end-radius` |\n\n```css\n.sidebar {\n  border-inline-end: 1px solid #ccc;\n}\n```\n\n### Text Alignment\n\n```css\n/* Instead of */\n.text { text-align: left; }\n\n/* Use */\n.text { text-align: start; }\n```\n\n| Physical | Logical |\n|----------|---------|\n| `text-align: left` | `text-align: start` |\n| `text-align: right` | `text-align: end` |\n\n### Flexbox and Grid\n\n```css\n/* Physical (doesn't flip) */\n.flex { justify-content: flex-start; }\n\n/* Already logical â€” works correctly */\n.flex { justify-content: start; }\n```\n\n### Tailwind Logical Classes\n\nTailwind v3.3+ includes logical property utilities:\n\n```html\n<div class=\"ms-4\">margin-inline-start: 1rem</div>\n<div class=\"me-4\">margin-inline-end: 1rem</div>\n<div class=\"ps-4\">padding-inline-start: 1rem</div>\n<div class=\"pe-4\">padding-inline-end: 1rem</div>\n<div class=\"start-0\">inset-inline-start: 0</div>\n<div class=\"end-0\">inset-inline-end: 0</div>\n<div class=\"text-start\">text-align: start</div>\n<div class=\"text-end\">text-align: end</div>\n```\n\n---\n\n## Font Selection for Multilingual\n\n### System Font Stacks by Script\n\n```css\n/* Arabic */\n.arabic {\n  font-family: 'Noto Naskh Arabic', 'Geeza Pro', 'Traditional Arabic', serif;\n}\n\n/* Hebrew */\n.hebrew {\n  font-family: 'Noto Sans Hebrew', 'Arial Hebrew', 'Lucida Grande', sans-serif;\n}\n\n/* Chinese (Simplified) */\n.chinese-simplified {\n  font-family: 'Noto Sans SC', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\n}\n\n/* Chinese (Traditional) */\n.chinese-traditional {\n  font-family: 'Noto Sans TC', 'PingFang TC', 'Microsoft JhengHei', sans-serif;\n}\n\n/* Japanese */\n.japanese {\n  font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic Pro', 'Yu Gothic', 'Meiryo', sans-serif;\n}\n\n/* Korean */\n.korean {\n  font-family: 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;\n}\n```\n\n### Recommended Multilingual Fonts\n\n**Google Noto Family:**\n- Covers all Unicode scripts\n- Consistent design across languages\n- Free and open source\n\n```css\n/* Universal fallback */\nbody {\n  font-family:\n    'Inter',           /* Latin primary */\n    'Noto Sans',       /* Latin fallback */\n    'Noto Sans Arabic',\n    'Noto Sans Hebrew',\n    'Noto Sans SC',    /* Chinese Simplified */\n    'Noto Sans JP',    /* Japanese */\n    'Noto Sans KR',    /* Korean */\n    system-ui,\n    sans-serif;\n}\n```\n\n### Font Features by Script\n\nNot all scripts support the same OpenType features:\n\n| Feature | Latin | Arabic | Hebrew | CJK |\n|---------|-------|--------|--------|-----|\n| Ligatures | âœ“ | âœ“ (required) | âœ“ | â€” |\n| Kerning | âœ“ | â€” | âœ“ | â€” |\n| Small caps | âœ“ | â€” | â€” | â€” |\n| Tabular nums | âœ“ | âœ“ | âœ“ | âœ“ |\n\n---\n\n## Arabic Typography\n\nArabic has unique requirements due to its cursive nature.\n\n### Essential Requirements\n\n**Contextual forms:** Letters change shape based on position (initial, medial, final, isolated).\n\n```\nØ¨ (isolated) â†’ Ø¨Ù€ (initial) â†’ Ù€Ø¨Ù€ (medial) â†’ Ù€Ø¨ (final)\n```\n\n**Ligatures:** Common letter combinations must ligate:\n- Ù„Ø§ (lam-alef)\n- Ù„Ù„Ù‡ (allah)\n\n**Diacritical marks:** Vowel marks (harakat) must be supported.\n\n### CSS Considerations\n\n**Never use letter-spacing:**\n\n```css\n/* âŒ Wrong â€” breaks Arabic connections */\n.arabic {\n  letter-spacing: 0.05em;\n}\n\n/* âœ“ Correct â€” reset letter-spacing */\n[lang=\"ar\"], [dir=\"rtl\"] {\n  letter-spacing: 0;\n}\n```\n\n**Line height:** Arabic text often needs more vertical space for diacritics:\n\n```css\n[lang=\"ar\"] {\n  line-height: 1.8; /* vs 1.5 for Latin */\n}\n```\n\n**Font size:** Arabic is often more complex visually; consider slightly larger sizes:\n\n```css\n[lang=\"ar\"] {\n  font-size: 1.1em; /* Relative increase */\n}\n```\n\n### Recommended Arabic Fonts\n\n| Font | Style | Use Case |\n|------|-------|----------|\n| Noto Naskh Arabic | Serif/Naskh | Body text, formal |\n| Noto Sans Arabic | Sans-serif | UI, modern |\n| Amiri | Serif/Naskh | Editorial, books |\n| Cairo | Sans-serif | Headlines, modern |\n| Scheherazade New | Serif/Naskh | Traditional, religious |\n\n---\n\n## Hebrew Typography\n\nHebrew shares RTL direction with Arabic but has different characteristics.\n\n### Key Differences from Arabic\n\n- Letters don't connect (non-cursive)\n- Simpler letter forms\n- Vowel points (niqqud) used mainly in religious/educational texts\n\n### CSS Considerations\n\n```css\n[lang=\"he\"] {\n  direction: rtl;\n  text-align: start;\n  /* Letter-spacing is acceptable in Hebrew */\n  letter-spacing: normal;\n}\n```\n\n### Recommended Hebrew Fonts\n\n| Font | Style | Use Case |\n|------|-------|----------|\n| Noto Sans Hebrew | Sans-serif | UI, general |\n| Noto Serif Hebrew | Serif | Editorial |\n| Frank Ruhl Libre | Serif | Traditional |\n| Heebo | Sans-serif | Modern UI |\n| Assistant | Sans-serif | Clean UI |\n\n---\n\n## CJK Typography\n\nChinese, Japanese, and Korean have unique typographic needs.\n\n### Character Spacing\n\nCJK characters are monospaced by design â€” don't add letter-spacing:\n\n```css\n.cjk {\n  letter-spacing: 0;\n}\n```\n\n### Line Breaking\n\nCJK text can break anywhere (no word boundaries):\n\n```css\n.cjk {\n  word-break: normal;\n  overflow-wrap: anywhere;\n}\n```\n\n### Punctuation\n\nCJK punctuation is full-width. Avoid mixing with half-width:\n\n```\nã€‚ã€ã€Œã€ï¼ˆï¼‰  /* Full-width â€” correct */\n.,\"\"()       /* Half-width â€” avoid in CJK */\n```\n\n### Vertical Text\n\nTraditional CJK can be written vertically:\n\n```css\n.vertical-text {\n  writing-mode: vertical-rl; /* Right to left columns */\n  text-orientation: mixed;\n}\n```\n\n### Font Size\n\nCJK characters are visually complex â€” may need larger sizes:\n\n```css\n[lang=\"zh\"], [lang=\"ja\"], [lang=\"ko\"] {\n  font-size: 1.05em;\n  line-height: 1.7;\n}\n```\n\n---\n\n## Bidirectional Text\n\nWhen RTL and LTR content mix within the same text.\n\n### Automatic Handling\n\nUnicode's bidirectional algorithm handles most cases automatically:\n\n```html\n<p dir=\"rtl\">\n  Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ with English words ÙŠØ¹ÙˆØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©\n</p>\n```\n\nResult: Arabic flows RTL, English words display LTR within the flow.\n\n### Manual Control\n\nUse `dir=\"auto\"` for user-generated content:\n\n```html\n<input type=\"text\" dir=\"auto\">\n```\n\nFor explicit control within mixed content:\n\n```html\n<p dir=\"rtl\">\n  Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ <span dir=\"ltr\">https://example.com</span> ÙŠØ¹ÙˆØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©\n</p>\n```\n\n### CSS Override\n\n```css\n/* Force LTR for code blocks regardless of page direction */\ncode, pre {\n  direction: ltr;\n  unicode-bidi: embed;\n}\n```\n\n### Numbers in RTL\n\nNumbers are always LTR, even in RTL text:\n\n```html\n<p dir=\"rtl\">Ø§Ù„Ø³Ø¹Ø±: $1,234.56</p>\n<!-- Displays correctly: 1,234.56$ :Ø§Ù„Ø³Ø¹Ø± -->\n```\n\nFor phone numbers and codes:\n\n```html\n<p dir=\"rtl\">\n  Ø§Ù„Ù‡Ø§ØªÙ: <span dir=\"ltr\">+1 (555) 123-4567</span>\n</p>\n```\n\n---\n\n## Quick Reference\n\n### RTL Checklist\n\n- [ ] `dir=\"rtl\"` on html or container\n- [ ] `lang` attribute set correctly\n- [ ] Using logical properties (not left/right)\n- [ ] Letter-spacing reset for Arabic\n- [ ] Appropriate line-height for script\n- [ ] Correct font family with script support\n- [ ] Icons/arrows mirrored if directional\n- [ ] Bidirectional content handled\n\n### Essential CSS for Multilingual\n\n```css\n/* Base RTL support */\n[dir=\"rtl\"] {\n  direction: rtl;\n}\n\n/* Arabic-specific */\n[lang=\"ar\"] {\n  font-family: 'Noto Sans Arabic', sans-serif;\n  letter-spacing: 0;\n  line-height: 1.8;\n}\n\n/* Hebrew-specific */\n[lang=\"he\"] {\n  font-family: 'Noto Sans Hebrew', sans-serif;\n}\n\n/* CJK-specific */\n[lang=\"zh\"], [lang=\"ja\"], [lang=\"ko\"] {\n  font-family: 'Noto Sans SC', 'Noto Sans JP', 'Noto Sans KR', sans-serif;\n  letter-spacing: 0;\n  line-height: 1.7;\n}\n\n/* Force LTR for code */\ncode, pre, .code {\n  direction: ltr;\n  unicode-bidi: embed;\n  text-align: left;\n}\n```\n\n### Tailwind RTL Setup\n\n```html\n<!-- Root element -->\n<html lang=\"ar\" dir=\"rtl\" class=\"rtl\">\n\n<!-- Components using logical classes -->\n<div class=\"ms-4 ps-2 border-e text-start\">\n  RTL-aware component\n</div>\n```\n",
        "skills/typography/references/masters.md": "# Typography Masters\n\nCurated wisdom from the most influential typography practitioners and educators. Reference this when seeking authoritative backing for principles or when making nuanced judgments.\n\n## Table of Contents\n\n- [Robert Bringhurst](#robert-bringhurst)\n- [Erik Spiekermann](#erik-spiekermann)\n- [Jan Tschichold](#jan-tschichold)\n- [Massimo Vignelli](#massimo-vignelli)\n- [Ellen Lupton](#ellen-lupton)\n- [Josef MÃ¼ller-Brockmann](#josef-mÃ¼ller-brockmann)\n- [Emil Ruder](#emil-ruder)\n- [Beatrice Warde](#beatrice-warde)\n- [Hermann Zapf](#hermann-zapf)\n- [Adrian Frutiger](#adrian-frutiger)\n- [Hoefler & Frere-Jones](#hoefler--frere-jones)\n- [Matthew Butterick](#matthew-butterick)\n- [Synthesis: When Masters Disagree](#synthesis-when-masters-disagree)\n\n---\n\n## Robert Bringhurst\n\n**The Elements of Typographic Style** (1992) â€” Called \"the typographer's bible\" by Hermann Zapf.\n\n### Core Philosophy\n\n> \"Typography exists to honor content.\"\n\n### Key Principles\n\n**The four fundamentals of body text:**\n1. Point size (10-12pt print, 15-25px web)\n2. Line spacing\n3. Line length\n4. Font choice\n\n**On rhythm and proportion:**\n- Typography should achieve rhythm, proportion, and harmony\n- Design with the correct typeface for the content\n- There are principles of good typography that transcend substrates and technologies\n\n**On details:**\n- Proper kerning and type adjustments improve legibility\n- Special characters, punctuation, and diacritical marks matter\n- Multilingual typography requires specific considerations\n\n### When to Apply\n\nReference Bringhurst when:\n- Establishing foundational type systems\n- Justifying classical proportions\n- Working with multilingual content\n- Defending attention to typographic detail\n\n---\n\n## Erik Spiekermann\n\nGerman typographer, founder of FontShop, creator of **FF Meta**. One of the most influential living type designers.\n\n### Core Philosophy\n\n> \"There is no bad type, only bad typography.\"\n\n### Key Principles\n\n**On rules:**\n> \"A few hundred years of type and typography have established rules that only a fool would ignore. (Or a graphic designer keen to impress his peers.)\"\n\n**On spacing:**\n- Letters need \"breathing room\" to avoid visual clutter\n- Smaller fonts require *more* spacing, not less\n- Set optimum wordspace to 80% or less in unjustified text\n- Increase tracking by at least 2 units for sizes under 12pt\n\n**On constraints:**\n> \"If you have fewer choices, it doesn't necessarily make your life more difficult. It often makes it easier.\"\n\n**On the designer's role:**\n> \"Designers are not artists. We employ artistic methods to visualize thinking and process, but unlike artists, we work to solve a client's problem, not present our own view of the world.\"\n\n### Practical Rules\n\n```css\n/* Spiekermann's small text adjustment */\n.small-text {\n  font-size: 11px;\n  letter-spacing: 0.02em; /* Increase tracking for small sizes */\n}\n```\n\n### When to Apply\n\nReference Spiekermann when:\n- Defending traditional typographic rules\n- Adjusting spacing for small text\n- Arguing for restraint in font choices\n- Balancing aesthetics with function\n\n---\n\n## Jan Tschichold\n\nAuthor of **Die neue Typographie** (1928), pioneer of modernist typography.\n\n### Core Philosophy\n\n> \"Asymmetry is the rhythmic expression of functional design.\"\n\n### Key Principles\n\n**On asymmetry:**\n- Asymmetry gives unlimited scope for variation\n- Central-axis typography does not allow such variety\n- Asymmetry expresses the diversity of modern life\n\n**On clarity:**\n- The purpose of all typography is communication\n- Functional design means abolishing unnecessary ornamentation\n- Sans-serif is the typeface of the modern age\n\n### Later Reconsideration\n\nTschichold later recognized that asymmetric was not *always* best:\n\n> \"There are two approaches to design problems and asymmetric is not necessarily the best.\"\n\nAfter escaping Nazi Germany, he sensed an element of fascism in the \"purifying order\" of strict modernism. His later work embraced classical typography alongside modern principles.\n\n### When to Apply\n\nReference early Tschichold when:\n- Advocating for asymmetric layouts\n- Removing unnecessary decoration\n- Choosing sans-serif for modern contexts\n\nReference later Tschichold when:\n- Defending classical/centered approaches\n- Arguing that context determines the right approach\n- Avoiding dogmatic adherence to any single style\n\n---\n\n## Massimo Vignelli\n\nItalian modernist designer, famous for NYC subway map. Author of **The Vignelli Canon**.\n\n### Core Philosophy\n\n> \"If you can design one thing, you can design everything.\"\n\n### On Grids\n\n> \"A grid is like underwear, you wear it but it's not to be exposed.\"\n\n> \"Don't be governed by the grid, govern the grid. A grid is like a lion cageâ€”if the trainer stays too long it gets eaten up.\"\n\n> \"A successful grid is one that allows a designer to achieve a great variety of compositions within a consistent structure.\"\n\n### On Typography\n\n> \"In the new computer age, the proliferation of typefaces and type manipulations represents a new level of visual pollution threatening our culture. Out of thousands of typefaces, all we need are a few basic ones, and trash the rest.\"\n\n**Vignelli's preferred typefaces:** Helvetica, Bodoni, Century Expanded, Garamond, Times Roman, Futura.\n\n**On hierarchy:** Use one typeface per design. Avoid italics and boldâ€”rely on gradations of scale instead.\n\n### On Timelessness\n\n> \"You can reach timelessness if you look for the essence of things and not the appearance. The appearance is transitoryâ€”the appearance is fashion, the appearance is trendinessâ€”but the essence is timeless.\"\n\n> \"Good design is a matter of discipline. It starts by looking at the problem and collecting all the available information about it. If you understand the problem, you have the solution. It's really more about logic than imagination.\"\n\n### When to Apply\n\nReference Vignelli when:\n- Advocating for extreme restraint\n- Defending limited typeface palettes\n- Establishing grid-based systems\n- Pursuing timeless over trendy design\n\n---\n\n## Ellen Lupton\n\nDesign educator at MICA, author of **Thinking with Type** (3rd ed. 2024).\n\n### Core Philosophy\n\nTypography education through three pillars: **Letter, Text, and Grid**.\n\n### Key Principles\n\n**On structure:**\n- Clear guidance on alignment, spacing, ordering, and shaping\n- Visual balance and Gestalt grouping principles\n- Historical context combined with practical application\n\n**On learning:**\n> \"Learn the rules and how to break them.\"\n\n**On accessibility:**\n- Variable fonts and optical sizes for modern contexts\n- Tips for readability, legibility, and accessibility\n- Demonstrations of basic design principles including responsive layout\n\n### When to Apply\n\nReference Lupton when:\n- Teaching or explaining typography concepts\n- Structuring type systems (letter â†’ text â†’ grid)\n- Balancing historical context with modern practice\n- Considering accessibility in type choices\n\n---\n\n## Josef MÃ¼ller-Brockmann\n\nSwiss designer, father of the grid system. Author of **Grid Systems in Graphic Design**.\n\n### Core Philosophy\n\nClarity through systematic organization.\n\n### On Grids\n\n- Grids provide meaningful, logical, and consistent organization\n- Modular systems from 8 to 32 grid fields\n- The grid is a tool, not a prison\n\n**Favorite typeface:** Akzidenz-Grotesk\n\n### Key Principles\n\n- Visual scale, rhythm, and repetition create harmony\n- Simplicity of design with subtle use of typography, form, and color\n- Influenced by Constructivism, De Stijl, Suprematism, and Bauhaus\n\n### When to Apply\n\nReference MÃ¼ller-Brockmann when:\n- Establishing grid systems\n- Creating systematic design approaches\n- Balancing flexibility with structure\n- Working on information-dense layouts\n\n---\n\n## Emil Ruder\n\nSwiss typography pioneer, Basel School of Design faculty. Author of **Typographie: A Manual of Design** (1967).\n\n### Core Philosophy\n\nPrecision, proportions, and legibility above all.\n\n### The Fundamentals (Wesentliches)\n\nFour foundational concepts from his 1957-1959 articles:\n1. **The Plane** â€” The surface and its divisions\n2. **The Line** â€” Linear elements and their rhythm\n3. **The Word** â€” The building block of meaning\n4. **Rhythm** â€” The pulse of typographic composition\n\n### Key Principles\n\n**On approach:**\n- Holistic methodology combining philosophy, theory, and practice\n- High importance on counters (interior shapes) and negative space\n- Asymmetric layouts with flush left, ragged right text\n\n**On typefaces:**\n- Sans-serif for clarity\n- Typography's purpose is to communicate ideas through writing\n\n### When to Apply\n\nReference Ruder when:\n- Teaching typography fundamentals\n- Emphasizing negative space and counters\n- Working with Swiss Style principles\n- Balancing philosophical and practical concerns\n\n---\n\n## Beatrice Warde\n\nTypography scholar, marketing manager at British Monotype. Author of **\"The Crystal Goblet\"** (1930).\n\n### Core Philosophy\n\n> \"Printing should be invisible.\"\n\n### The Crystal Goblet Metaphor\n\nChoose between two wine glasses:\n- **Golden goblet:** Ornate, expensive, draws attention to itself\n- **Crystal glass:** Clear, reveals the wine within\n\n> \"If you are a member of that vanishing tribe, the amateurs of fine vintages, you will choose the crystal, because everything about it is calculated to reveal rather than to hide the beautiful thing which it was meant to contain.\"\n\n### Key Argument\n\n> \"The most important thing about printing is that it conveys thought, ideas, images, from one mind to other minds.\"\n\nType well used is invisible as typeâ€”the reader should see through it to the content.\n\n### Counterpoint\n\nMatthew Butterick's rebuttal: \"It's poorly reasoned, contradicts common sense, and like all faulty analogies, leads to faulty conclusions. Typography isn't invisible. By embracing that fact rather than denying it, we can create better typography.\"\n\n### When to Apply\n\nReference Warde when:\n- Prioritizing content over decoration\n- Advocating for restraint and clarity\n- Designing for long-form reading\n\nReference Butterick's counterpoint when:\n- Typography *should* be noticed (branding, headlines)\n- Arguing that all design choices are visible choices\n\n---\n\n## Hermann Zapf\n\nGerman master calligrapher (1918-2015). Created 200+ fonts including **Palatino**, **Optima**, and **Zapf Dingbats**.\n\n### Core Philosophy\n\n> \"To create beautiful letters.\"\n\n### Key Typefaces\n\n**Palatino (1948):** Warm, organic design inspired by Renaissance calligraphy. Named after 16th-century Italian writing master Giambattista Palatino.\n\n**Optima (1952-58):** Bridge between serif and sans-serif. Proportions based on the Golden Section (lowercase x-height = minor, ascenders/descenders = major). Used on the Vietnam Veterans Memorial and 9/11 Memorial.\n\n### On His Work\n\n> \"A father should not have a favorite among his daughters.\"\n\nYet he admitted a preference for Optima.\n\n### Key Principles\n\n- Balance and precision in letterforms\n- Calligraphic roots inform type design\n- Beauty and function are inseparable\n\n### When to Apply\n\nReference Zapf when:\n- Choosing humanist typefaces\n- Balancing serif and sans-serif qualities\n- Applying calligraphic principles to type\n\n---\n\n## Adrian Frutiger\n\nSwiss type designer (1928-2015). Created **Univers**, **Frutiger**, and **Avenir**.\n\n### Core Philosophy\n\n> \"The eye does not read letters, but the space between them.\"\n\n### Key Principles\n\n**On clarity:**\n> \"What was important was total clarityâ€”I would even call it nudityâ€”an absence of any kind of artistic addition.\"\n\n**On legibility:**\n> \"Legibility and beauty stand close together and type design, in its restraint, should be only felt but not perceived by the reader.\"\n\n### Univers Innovation\n\nUnivers (1957) was revolutionary:\n- First systematic type family designed as coherent matrix\n- 21 weights and widths from the start\n- Open counters for easier letter discrimination\n- Numbered system (Univers 55, 65, 75...) instead of names\n\n### When to Apply\n\nReference Frutiger when:\n- Designing systematic type families\n- Emphasizing counter spaces and openness\n- Prioritizing legibility in signage/wayfinding\n- Choosing between neogrotesque, humanist, and geometric sans\n\n---\n\n## Hoefler & Frere-Jones\n\nAmerican type designers. Created **Gotham**, **Mercury**, **Whitney**. AIGA Medal recipients.\n\n### Core Philosophy\n\n> \"Typefaces are not toys. They're tools. They're designed to solve problems.\"\n\n### Three Fundamentals of Type Design\n\n1. **Overshoot:** Curved letters must extend slightly beyond baseline/cap height to appear equal\n2. **Balance:** Both halves of 'B' should be different sizes to *feel* the same\n3. **Contrast:** Vertical strokes thicker than horizontal (anisotropic contrast)\n\n### On Process\n\n> \"Start with H and Oâ€”straight and round letterforms contain the DNA of the entire typeface.\"\n\n> \"The overwhelming importance of accuracy: painstaking accuracy in the extreme. Type design is about mathematical precision.\"\n\n> \"We conceal evidence of any kind of struggle. Technical refinements tend to go unseen by the user, but sometimes the most impressive things aren't immediately obvious.\"\n\n### When to Apply\n\nReference Hoefler & Frere-Jones when:\n- Making optical adjustments\n- Understanding why \"equal\" measurements look unequal\n- Evaluating typeface quality\n- Appreciating hidden craftsmanship\n\n---\n\n## Matthew Butterick\n\nTypographer, lawyer, programmer. Author of **Practical Typography** (online) and **Typography for Lawyers**.\n\n### Core Philosophy\n\n> \"Typography matters because it helps conserve the most valuable resource you have as a writerâ€”reader attention.\"\n\n### Key Rules\n\n**Five rules that make you better than most:**\n1. Body text: 10-12pt print, 15-25px web\n2. Line spacing: 120-145% of point size\n3. Line length: 45-90 characters\n4. Font: Use a professional font (not system defaults)\n5. Don't justify text on the web\n\n### On the Crystal Goblet\n\nButterick rejects Warde's \"invisible typography\" thesis:\n\n> \"Typography isn't invisible. By embracing that fact rather than denying it, we can create better typography.\"\n\n### Practical Details\n\n- Use curly quotes, not straight\n- One space between sentences, not two\n- Proper dashes: hyphen (-), en dash (â€“), em dash (â€”)\n- Use real ellipsis (â€¦) not three periods\n\n### When to Apply\n\nReference Butterick when:\n- Setting up practical typography rules\n- Fixing common amateur mistakes\n- Making arguments about reader attention\n- Applying typography in professional documents\n\n---\n\n## Synthesis: When Masters Disagree\n\n### Restraint vs. Expression\n\n| Position | Masters |\n|----------|---------|\n| Extreme restraint | Vignelli (\"few basic typefaces\"), MÃ¼ller-Brockmann |\n| Functional clarity | Frutiger, Ruder, Warde |\n| Contextual flexibility | Late Tschichold, Lupton, Butterick |\n\n**Resolution:** Context determines restraint level. Marketing/branding allows expression; long-form reading demands invisibility.\n\n### Rules vs. Breaking Rules\n\n| Position | Masters |\n|----------|---------|\n| Follow established rules | Spiekermann, Bringhurst |\n| Learn rules, then break them | Lupton, Vignelli (\"govern the grid\") |\n| Rigid rules are dangerous | Late Tschichold |\n\n**Resolution:** Master the rules first. Break them intentionally, not ignorantly.\n\n### Invisible vs. Visible Typography\n\n| Position | Masters |\n|----------|---------|\n| Typography should be invisible | Warde, Frutiger |\n| Typography is always visible | Butterick |\n| Typography should honor content | Bringhurst |\n\n**Resolution:** \"Invisible\" means the reader isn't *distracted* by typeâ€”not that type doesn't exist. All typography makes visible choices; the question is whether those choices serve or compete with content.\n\n### Applying the Masters\n\nWhen making typography decisions:\n\n1. **For body text/long reading:** Lean toward Warde, Frutiger, Bringhurst (clarity, legibility, honor content)\n2. **For branding/headlines:** Lean toward Vignelli, Zapf (essence, beauty, restraint)\n3. **For systematic design:** Lean toward MÃ¼ller-Brockmann, Frutiger (grids, coherent families)\n4. **For practical implementation:** Lean toward Butterick, Spiekermann (specific rules, measurements)\n5. **For teaching/explaining:** Lean toward Lupton, Ruder (structured frameworks)\n",
        "skills/typography/references/opentype-features.md": "# OpenType Features\n\nOpenType features enable advanced typography: ligatures, alternate characters, numeric formatting, and more.\n\n## Table of Contents\n\n- [What Are OpenType Features](#what-are-opentype-features)\n- [Common Features Reference](#common-features-reference)\n- [CSS Implementation](#css-implementation)\n- [Numeric Features](#numeric-features)\n- [Stylistic Features](#stylistic-features)\n- [Feature Support by Font](#feature-support-by-font)\n- [Debugging & Discovery](#debugging--discovery)\n\n---\n\n## What Are OpenType Features\n\nOpenType features are optional typographic enhancements built into fonts. They're identified by four-letter tags and can be enabled via CSS.\n\n**Examples of what features do:**\n- Convert \"fi\" to a proper ligature (liga)\n- Adjust punctuation based on surrounding letters (calt)\n- Use old-style figures in running text (onum)\n- Access alternate character designs (ss01, cv01)\n\n---\n\n## Common Features Reference\n\n### Enabled by Default\n\n| Tag | Name | Description |\n|-----|------|-------------|\n| `kern` | Kerning | Adjusts spacing between specific letter pairs |\n| `liga` | Standard Ligatures | Common ligatures like fi, fl, ff |\n| `calt` | Contextual Alternates | Context-aware glyph substitution |\n| `locl` | Localized Forms | Language-specific glyph variants |\n\n### Commonly Used\n\n| Tag | Name | Description |\n|-----|------|-------------|\n| `tnum` | Tabular Figures | Fixed-width numbers for alignment |\n| `pnum` | Proportional Figures | Variable-width numbers for prose |\n| `lnum` | Lining Figures | Numbers aligned to cap height |\n| `onum` | Old-style Figures | Numbers with ascenders/descenders |\n| `zero` | Slashed Zero | Distinguishes 0 from O |\n| `frac` | Fractions | Converts 1/2 to proper fraction |\n| `case` | Case-Sensitive Forms | Adjusts punctuation for all-caps |\n| `smcp` | Small Caps | Lowercase as small capitals |\n| `c2sc` | Caps to Small Caps | Converts capitals to small caps |\n\n### Stylistic Features\n\n| Tag | Name | Description |\n|-----|------|-------------|\n| `ss01`â€“`ss20` | Stylistic Sets | Predefined alternate style groups |\n| `cv01`â€“`cv99` | Character Variants | Alternates for specific characters |\n| `salt` | Stylistic Alternates | Access all available alternates |\n| `swsh` | Swash | Decorative flourishes |\n| `dlig` | Discretionary Ligatures | Optional/decorative ligatures |\n\n---\n\n## CSS Implementation\n\n### Modern Approach: font-variant-*\n\n```css\n/* Ligatures */\n.ligatures-all {\n  font-variant-ligatures: common-ligatures discretionary-ligatures;\n}\n\n.ligatures-none {\n  font-variant-ligatures: none;\n}\n\n/* Numeric features */\n.tabular-nums {\n  font-variant-numeric: tabular-nums;\n}\n\n.oldstyle-nums {\n  font-variant-numeric: oldstyle-nums;\n}\n\n.fractions {\n  font-variant-numeric: diagonal-fractions;\n}\n\n/* Caps */\n.small-caps {\n  font-variant-caps: small-caps;\n}\n\n.all-small-caps {\n  font-variant-caps: all-small-caps;\n}\n```\n\n### Low-Level: font-feature-settings\n\nUse for features not covered by font-variant-*:\n\n```css\n/* Enable slashed zero */\n.code {\n  font-feature-settings: \"zero\" 1;\n}\n\n/* Enable stylistic set 1 */\n.alternate-style {\n  font-feature-settings: \"ss01\" 1;\n}\n\n/* Multiple features */\n.enhanced {\n  font-feature-settings:\n    \"kern\" 1,\n    \"liga\" 1,\n    \"calt\" 1,\n    \"tnum\" 1,\n    \"zero\" 1;\n}\n\n/* Disable a default feature */\n.no-ligatures {\n  font-feature-settings: \"liga\" 0;\n}\n```\n\n### Inheritance Gotcha\n\n`font-feature-settings` replaces (doesn't merge) when overridden:\n\n```css\n/* Parent */\n.parent {\n  font-feature-settings: \"kern\" 1, \"liga\" 1;\n}\n\n/* Child - this REPLACES parent, doesn't add to it */\n.child {\n  font-feature-settings: \"tnum\" 1;\n  /* kern and liga are now OFF */\n}\n\n/* Correct: include all needed features */\n.child-correct {\n  font-feature-settings: \"kern\" 1, \"liga\" 1, \"tnum\" 1;\n}\n```\n\n**Prefer font-variant-* when possible** â€” it cascades properly.\n\n---\n\n## Numeric Features\n\n### Tabular vs Proportional\n\n| Type | Tag | Use Case |\n|------|-----|----------|\n| Tabular | `tnum` | Tables, prices, anything that should align |\n| Proportional | `pnum` | Running text, body copy |\n\n```css\n/* Tables with aligned numbers */\ntable {\n  font-variant-numeric: tabular-nums;\n}\n\n/* Or */\ntable {\n  font-feature-settings: \"tnum\" 1;\n}\n```\n\n### Lining vs Old-Style\n\n| Type | Tag | Appearance | Use Case |\n|------|-----|------------|----------|\n| Lining | `lnum` | 0123456789 (cap height) | Headings, UI, tables |\n| Old-style | `onum` | Varies (with descenders) | Body text, editorial |\n\n```css\n/* Old-style figures for prose */\n.prose {\n  font-variant-numeric: oldstyle-nums;\n}\n\n/* Lining figures for UI */\n.ui-numbers {\n  font-variant-numeric: lining-nums;\n}\n```\n\n### Slashed Zero\n\nDistinguishes zero from the letter O â€” essential for code and data:\n\n```css\n.code, .data {\n  font-feature-settings: \"zero\" 1;\n}\n```\n\n### Fractions\n\n```css\n.fractions {\n  font-variant-numeric: diagonal-fractions;\n}\n\n/* 1/2 becomes Â½, 3/4 becomes Â¾ */\n```\n\n### Combined Numeric Styles\n\n```css\n/* Financial data: lining + tabular */\n.financial {\n  font-variant-numeric: lining-nums tabular-nums;\n}\n\n/* Editorial: old-style + proportional */\n.editorial {\n  font-variant-numeric: oldstyle-nums proportional-nums;\n}\n\n/* Code/data: tabular + slashed zero */\n.code {\n  font-variant-numeric: tabular-nums slashed-zero;\n}\n```\n\n---\n\n## Stylistic Features\n\n### Stylistic Sets (ss01â€“ss20)\n\nPredefined groups of alternate glyphs. Each font defines differently:\n\n**Inter's stylistic sets:**\n- `ss01`: Alternate digits\n- `ss02`: Disambiguation (different l and 1)\n- `ss03`: Curved r\n\n```css\n/* Enable Inter's disambiguation set */\n.disambiguation {\n  font-feature-settings: \"ss02\" 1;\n}\n```\n\n### Character Variants (cv01â€“cv99)\n\nAlternates for specific characters:\n\n**Inter's character variants:**\n- `cv01`: Alternate 1\n- `cv02`: Alternate 4\n- `cv03`: Alternate 6\n- `cv04`: Alternate 9\n- `cv05`: Lowercase L with tail\n- `cv06`: Lowercase L with serif\n\n```css\n/* Use Inter's alternate lowercase L */\n.code {\n  font-feature-settings: \"cv05\" 1; /* L with tail */\n}\n```\n\n### Case-Sensitive Forms\n\nAdjusts punctuation for all-caps text:\n\n```css\n.all-caps {\n  text-transform: uppercase;\n  font-feature-settings: \"case\" 1;\n}\n```\n\n**What it does:** Raises hyphens, brackets, and other punctuation to optically center with capitals.\n\n---\n\n## Feature Support by Font\n\n### Inter\n\n```css\n.inter-recommended {\n  font-feature-settings:\n    \"kern\" 1,   /* Kerning */\n    \"liga\" 1,   /* Ligatures */\n    \"calt\" 1,   /* Contextual alternates: arrows, emoticons */\n    \"ss02\" 1;   /* Disambiguation: distinct l, 1, I */\n}\n\n.inter-code {\n  font-feature-settings:\n    \"kern\" 1,\n    \"calt\" 1,\n    \"tnum\" 1,   /* Tabular numbers */\n    \"zero\" 1,   /* Slashed zero */\n    \"cv05\" 1;   /* L with tail */\n}\n```\n\n### Source Sans / Source Serif\n\n```css\n.source-serif-editorial {\n  font-feature-settings:\n    \"kern\" 1,\n    \"liga\" 1,\n    \"onum\" 1,   /* Old-style figures */\n    \"pnum\" 1;   /* Proportional figures */\n}\n```\n\n### JetBrains Mono\n\n```css\n.jetbrains-mono {\n  font-feature-settings:\n    \"kern\" 1,\n    \"liga\" 1,   /* Coding ligatures: ->, =>, != */\n    \"calt\" 1,\n    \"zero\" 1;   /* Slashed zero */\n}\n```\n\n### Checking What's Available\n\nUse these tools to discover font features:\n\n- **[Wakamai Fondue](https://wakamaifondue.com/)** â€” Drag and drop font file\n- **[Axis-Praxis](https://www.axis-praxis.org/)** â€” Variable font playground\n- **Font specimen pages** â€” e.g., rsms.me/inter\n\n---\n\n## Debugging & Discovery\n\n### Browser DevTools\n\n1. Select text element\n2. In computed styles, look for `font-feature-settings`\n3. Toggle features to see effect\n\n### CSS for Testing\n\n```css\n/* Test all common features */\n.test-features {\n  font-feature-settings:\n    \"kern\" 1,\n    \"liga\" 1,\n    \"calt\" 1,\n    \"dlig\" 1,\n    \"ss01\" 1,\n    \"ss02\" 1,\n    \"tnum\" 1,\n    \"onum\" 1,\n    \"zero\" 1,\n    \"frac\" 1,\n    \"case\" 1,\n    \"smcp\" 1;\n}\n```\n\n### Test Strings\n\n```\nLigatures: fi fl ff ffi ffl\nContextual: -> --> => ==> :: != !==\nNumbers: 0123456789 / 0O Il1\nFractions: 1/2 3/4 1/3 2/3\nCaps test: (HELLO) [WORLD] {TEST}\n```\n\n---\n\n## Quick Reference\n\n### Recommended Defaults\n\n```css\nbody {\n  /* Enable standard features */\n  font-feature-settings: \"kern\" 1, \"liga\" 1, \"calt\" 1;\n\n  /* Or use higher-level properties */\n  font-kerning: normal;\n  font-variant-ligatures: common-ligatures contextual;\n}\n\n/* Tables and data */\ntable, .data {\n  font-variant-numeric: tabular-nums lining-nums;\n}\n\n/* Code blocks */\ncode, pre {\n  font-feature-settings: \"kern\" 1, \"liga\" 1, \"calt\" 1, \"zero\" 1;\n  font-variant-numeric: tabular-nums slashed-zero;\n}\n\n/* All-caps labels */\n.label {\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n  font-feature-settings: \"case\" 1;\n}\n```\n\n### Tailwind CSS\n\n```html\n<!-- Tabular numbers -->\n<span class=\"tabular-nums\">$1,234.56</span>\n\n<!-- Old-style numbers -->\n<span class=\"oldstyle-nums\">1234</span>\n\n<!-- Proportional numbers -->\n<span class=\"proportional-nums\">1234</span>\n\n<!-- Lining numbers -->\n<span class=\"lining-nums\">1234</span>\n\n<!-- Slashed zero -->\n<span class=\"slashed-zero\">0O</span>\n\n<!-- Fractions -->\n<span class=\"diagonal-fractions\">1/2</span>\n```\n",
        "skills/typography/references/tailwind-integration.md": "# Tailwind CSS Typography\n\nUsing Tailwind's typography utilities and the @tailwindcss/typography prose plugin.\n\n## Table of Contents\n\n- [Core Typography Utilities](#core-typography-utilities)\n- [Typography Plugin (Prose)](#typography-plugin-prose)\n- [Customizing Prose](#customizing-prose)\n- [Building Type Systems](#building-type-systems)\n- [Common Patterns](#common-patterns)\n\n---\n\n## Core Typography Utilities\n\n### Font Size\n\n```html\n<p class=\"text-xs\">0.75rem / 12px</p>\n<p class=\"text-sm\">0.875rem / 14px</p>\n<p class=\"text-base\">1rem / 16px</p>\n<p class=\"text-lg\">1.125rem / 18px</p>\n<p class=\"text-xl\">1.25rem / 20px</p>\n<p class=\"text-2xl\">1.5rem / 24px</p>\n<p class=\"text-3xl\">1.875rem / 30px</p>\n<p class=\"text-4xl\">2.25rem / 36px</p>\n<p class=\"text-5xl\">3rem / 48px</p>\n<p class=\"text-6xl\">3.75rem / 60px</p>\n<p class=\"text-7xl\">4.5rem / 72px</p>\n<p class=\"text-8xl\">6rem / 96px</p>\n<p class=\"text-9xl\">8rem / 128px</p>\n```\n\n### Font Weight\n\n```html\n<p class=\"font-thin\">100</p>\n<p class=\"font-extralight\">200</p>\n<p class=\"font-light\">300</p>\n<p class=\"font-normal\">400</p>\n<p class=\"font-medium\">500</p>\n<p class=\"font-semibold\">600</p>\n<p class=\"font-bold\">700</p>\n<p class=\"font-extrabold\">800</p>\n<p class=\"font-black\">900</p>\n```\n\n### Line Height\n\n```html\n<p class=\"leading-none\">1</p>\n<p class=\"leading-tight\">1.25</p>\n<p class=\"leading-snug\">1.375</p>\n<p class=\"leading-normal\">1.5</p>\n<p class=\"leading-relaxed\">1.625</p>\n<p class=\"leading-loose\">2</p>\n\n<!-- Fixed line heights -->\n<p class=\"leading-3\">0.75rem</p>\n<p class=\"leading-4\">1rem</p>\n<p class=\"leading-5\">1.25rem</p>\n<p class=\"leading-6\">1.5rem</p>\n<p class=\"leading-7\">1.75rem</p>\n<p class=\"leading-8\">2rem</p>\n```\n\n### Letter Spacing\n\n```html\n<p class=\"tracking-tighter\">-0.05em</p>\n<p class=\"tracking-tight\">-0.025em</p>\n<p class=\"tracking-normal\">0</p>\n<p class=\"tracking-wide\">0.025em</p>\n<p class=\"tracking-wider\">0.05em</p>\n<p class=\"tracking-widest\">0.1em</p>\n```\n\n### Text Wrapping\n\n```html\n<h1 class=\"text-balance\">Balanced heading text</h1>\n<p class=\"text-pretty\">Paragraph without orphans</p>\n<p class=\"text-nowrap\">No wrapping</p>\n<p class=\"text-wrap\">Normal wrapping</p>\n```\n\n### Font Features\n\n```html\n<!-- Numeric variants -->\n<span class=\"tabular-nums\">1,234,567</span>\n<span class=\"proportional-nums\">1234</span>\n<span class=\"lining-nums\">1234</span>\n<span class=\"oldstyle-nums\">1234</span>\n<span class=\"slashed-zero\">0</span>\n<span class=\"diagonal-fractions\">1/2</span>\n<span class=\"stacked-fractions\">1/2</span>\n\n<!-- Normal (reset) -->\n<span class=\"normal-nums\">1234</span>\n```\n\n### Font Smoothing\n\n```html\n<p class=\"antialiased\">Antialiased text (for dark backgrounds)</p>\n<p class=\"subpixel-antialiased\">Subpixel antialiased (default)</p>\n```\n\n---\n\n## Typography Plugin (Prose)\n\nThe `@tailwindcss/typography` plugin provides beautiful defaults for vanilla HTML.\n\n### Installation\n\n**Tailwind v4:**\n```css\n/* In your CSS file */\n@import \"tailwindcss\";\n@plugin \"@tailwindcss/typography\";\n```\n\n**Tailwind v3:**\n```javascript\n// tailwind.config.js\nmodule.exports = {\n  plugins: [\n    require('@tailwindcss/typography'),\n  ],\n}\n```\n\n### Basic Usage\n\n```html\n<article class=\"prose\">\n  <h1>Article Title</h1>\n  <p>This paragraph gets beautiful typography automatically.</p>\n  <ul>\n    <li>List items are styled</li>\n    <li>With proper spacing</li>\n  </ul>\n  <blockquote>Quotes look great too.</blockquote>\n</article>\n```\n\n### Size Modifiers\n\n```html\n<article class=\"prose prose-sm\">Small prose</article>\n<article class=\"prose prose-base\">Base prose (default)</article>\n<article class=\"prose prose-lg\">Large prose</article>\n<article class=\"prose prose-xl\">Extra large prose</article>\n<article class=\"prose prose-2xl\">2XL prose</article>\n```\n\n### Responsive Sizing\n\n```html\n<article class=\"prose prose-sm md:prose-base lg:prose-lg xl:prose-xl\">\n  Responsive article sizing\n</article>\n```\n\n### Color Themes\n\n```html\n<article class=\"prose prose-slate\">Slate gray theme</article>\n<article class=\"prose prose-gray\">Gray theme (default)</article>\n<article class=\"prose prose-zinc\">Zinc theme</article>\n<article class=\"prose prose-neutral\">Neutral theme</article>\n<article class=\"prose prose-stone\">Stone theme</article>\n```\n\n### Dark Mode\n\n```html\n<article class=\"prose dark:prose-invert\">\n  Inverted colors in dark mode\n</article>\n\n<!-- With color theme -->\n<article class=\"prose prose-slate dark:prose-invert\">\n  Slate theme with dark mode\n</article>\n```\n\n---\n\n## Customizing Prose\n\n### Element Modifiers\n\nOverride specific elements within prose:\n\n```html\n<article class=\"prose\n  prose-headings:text-blue-600\n  prose-a:text-blue-500\n  prose-a:no-underline\n  prose-a:hover:underline\n  prose-strong:text-gray-900\n  prose-code:text-pink-500\n  prose-code:before:content-none\n  prose-code:after:content-none\n  prose-img:rounded-xl\n  prose-img:shadow-lg\n  prose-blockquote:border-blue-500\n  prose-blockquote:italic\n  prose-li:marker:text-blue-500\n\">\n  <!-- Content -->\n</article>\n```\n\n### Available Element Modifiers\n\n| Modifier | Targets |\n|----------|---------|\n| `prose-headings:` | h1, h2, h3, h4, th |\n| `prose-h1:` | h1 |\n| `prose-h2:` | h2 |\n| `prose-h3:` | h3 |\n| `prose-h4:` | h4 |\n| `prose-p:` | p |\n| `prose-a:` | a |\n| `prose-blockquote:` | blockquote |\n| `prose-figure:` | figure |\n| `prose-figcaption:` | figcaption |\n| `prose-strong:` | strong |\n| `prose-em:` | em |\n| `prose-code:` | code |\n| `prose-pre:` | pre |\n| `prose-ol:` | ol |\n| `prose-ul:` | ul |\n| `prose-li:` | li |\n| `prose-table:` | table |\n| `prose-thead:` | thead |\n| `prose-tr:` | tr |\n| `prose-th:` | th |\n| `prose-td:` | td |\n| `prose-img:` | img |\n| `prose-video:` | video |\n| `prose-hr:` | hr |\n| `prose-lead:` | [class~=\"lead\"] |\n\n### Removing Max Width\n\nProse includes `max-width: 65ch` by default. Remove it:\n\n```html\n<article class=\"prose max-w-none\">\n  Full-width prose content\n</article>\n```\n\n### Excluding Elements (not-prose)\n\nExclude sections from prose styling:\n\n```html\n<article class=\"prose\">\n  <h1>Article Title</h1>\n  <p>Styled paragraph.</p>\n\n  <div class=\"not-prose\">\n    <!-- This section won't have prose styles -->\n    <div class=\"my-custom-widget\">...</div>\n  </div>\n\n  <p>Back to prose styles.</p>\n</article>\n```\n\n### Custom Configuration (v3)\n\n```javascript\n// tailwind.config.js\nmodule.exports = {\n  theme: {\n    extend: {\n      typography: {\n        DEFAULT: {\n          css: {\n            color: '#333',\n            a: {\n              color: '#3182ce',\n              '&:hover': {\n                color: '#2c5282',\n              },\n            },\n            h1: {\n              fontWeight: '800',\n            },\n            'code::before': {\n              content: '\"\"',\n            },\n            'code::after': {\n              content: '\"\"',\n            },\n          },\n        },\n      },\n    },\n  },\n}\n```\n\n---\n\n## Building Type Systems\n\n### Custom Font Family\n\n```html\n<!-- Using Tailwind's font utilities -->\n<p class=\"font-sans\">System sans-serif</p>\n<p class=\"font-serif\">System serif</p>\n<p class=\"font-mono\">System monospace</p>\n```\n\n**Extend in config:**\n```javascript\n// tailwind.config.js\nmodule.exports = {\n  theme: {\n    extend: {\n      fontFamily: {\n        sans: ['Inter', 'system-ui', 'sans-serif'],\n        serif: ['Source Serif Pro', 'Georgia', 'serif'],\n        mono: ['JetBrains Mono', 'monospace'],\n        display: ['Fraunces', 'serif'],\n      },\n    },\n  },\n}\n```\n\n```html\n<h1 class=\"font-display\">Display heading</h1>\n<p class=\"font-sans\">Body text</p>\n<code class=\"font-mono\">Code</code>\n```\n\n### Type Scale Component\n\n```html\n<!-- Heading hierarchy -->\n<h1 class=\"text-4xl font-bold leading-tight tracking-tight md:text-5xl lg:text-6xl\">\n  Page Title\n</h1>\n\n<h2 class=\"text-2xl font-semibold leading-snug tracking-tight md:text-3xl\">\n  Section Title\n</h2>\n\n<h3 class=\"text-xl font-semibold leading-snug md:text-2xl\">\n  Subsection\n</h3>\n\n<p class=\"text-base leading-relaxed text-gray-700\">\n  Body paragraph with comfortable reading line height.\n</p>\n\n<p class=\"text-sm leading-normal text-gray-500\">\n  Caption or secondary text.\n</p>\n```\n\n### Responsive Type Scale\n\n```html\n<h1 class=\"\n  text-2xl leading-tight\n  sm:text-3xl\n  md:text-4xl\n  lg:text-5xl lg:leading-none\n  xl:text-6xl\n\">\n  Responsive Heading\n</h1>\n```\n\n---\n\n## Common Patterns\n\n### All-Caps Labels\n\n```html\n<span class=\"text-xs font-semibold uppercase tracking-widest text-gray-500\">\n  Category\n</span>\n```\n\n### Article Header\n\n```html\n<header class=\"mb-8\">\n  <span class=\"text-sm font-medium uppercase tracking-wider text-blue-600\">\n    Technology\n  </span>\n  <h1 class=\"mt-2 text-3xl font-bold leading-tight text-gray-900 text-balance md:text-4xl\">\n    The Future of Web Typography\n  </h1>\n  <p class=\"mt-4 text-lg text-gray-600\">\n    Exploring modern CSS features for better reading experiences.\n  </p>\n</header>\n```\n\n### Card Title\n\n```html\n<h3 class=\"text-lg font-semibold leading-snug text-gray-900 line-clamp-2\">\n  Long card title that might need to be truncated after two lines\n</h3>\n```\n\n### Price Display\n\n```html\n<span class=\"text-3xl font-bold tabular-nums\">\n  $1,234<span class=\"text-lg font-normal text-gray-500\">.99</span>\n</span>\n```\n\n### Data Table\n\n```html\n<td class=\"text-sm tabular-nums text-right\">\n  1,234,567\n</td>\n```\n\n### Dark Mode Typography\n\n```html\n<article class=\"\n  prose prose-gray\n  dark:prose-invert\n  dark:prose-p:text-gray-300\n  dark:prose-headings:text-white\n  dark:prose-a:text-blue-400\n\">\n  <!-- Content -->\n</article>\n```\n\n### Blog Post Layout\n\n```html\n<article class=\"\n  prose prose-lg\n  prose-headings:font-display\n  prose-headings:text-gray-900\n  prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline\n  prose-blockquote:border-l-blue-500 prose-blockquote:text-gray-700\n  prose-code:rounded prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5\n  prose-pre:bg-gray-900\n  prose-img:rounded-lg prose-img:shadow-md\n  max-w-prose mx-auto\n  dark:prose-invert\n\">\n  <!-- Markdown rendered content -->\n</article>\n```\n\n---\n\n## Quick Reference\n\n### Essential Prose Setup\n\n```html\n<!-- Minimal -->\n<article class=\"prose\">...</article>\n\n<!-- Recommended -->\n<article class=\"prose prose-gray lg:prose-lg dark:prose-invert max-w-prose mx-auto\">\n  ...\n</article>\n\n<!-- Full-featured -->\n<article class=\"\n  prose prose-gray\n  prose-sm md:prose-base lg:prose-lg\n  dark:prose-invert\n  prose-headings:text-balance\n  prose-p:text-pretty\n  prose-a:text-blue-600\n  max-w-prose mx-auto px-4\n\">\n  ...\n</article>\n```\n\n### Typography Checklist\n\n- [ ] `prose` class on article content\n- [ ] Size modifier for responsive (`prose-sm md:prose-base lg:prose-lg`)\n- [ ] Color theme matching site (`prose-slate`, `prose-gray`, etc.)\n- [ ] Dark mode support (`dark:prose-invert`)\n- [ ] `text-balance` on headings\n- [ ] `text-pretty` on paragraphs\n- [ ] `tabular-nums` on data/prices\n- [ ] `max-w-prose` or `max-w-none` as needed\n",
        "skills/typography/references/variable-fonts.md": "# Variable Fonts\n\nVariable fonts pack multiple styles into a single file, enabling fluid typography and reducing HTTP requests.\n\n## Table of Contents\n\n- [What Are Variable Fonts](#what-are-variable-fonts)\n- [Common Axes](#common-axes)\n- [CSS Implementation](#css-implementation)\n- [Fluid Typography with Variable Fonts](#fluid-typography-with-variable-fonts)\n- [Performance Benefits](#performance-benefits)\n- [Recommended Variable Fonts](#recommended-variable-fonts)\n- [Browser Support](#browser-support)\n\n---\n\n## What Are Variable Fonts\n\nA variable font is a single font file containing multiple styles, weights, and variations. Instead of loading separate files for regular, bold, italic, etc., one file provides infinite variations along defined axes.\n\n**Traditional approach:**\n```\ninter-regular.woff2      (95KB)\ninter-medium.woff2       (96KB)\ninter-semibold.woff2     (97KB)\ninter-bold.woff2         (98KB)\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nTotal: 386KB, 4 HTTP requests\n```\n\n**Variable font approach:**\n```\ninter-variable.woff2     (310KB)\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nTotal: 310KB, 1 HTTP request\n+ infinite weight variations\n```\n\n---\n\n## Common Axes\n\n### Registered Axes (Standardized)\n\n| Axis | Tag | Description | Typical Range |\n|------|-----|-------------|---------------|\n| Weight | `wght` | Thin to Black | 100â€“900 |\n| Width | `wdth` | Condensed to Extended | 75â€“125 |\n| Slant | `slnt` | Upright to oblique | -12â€“0 |\n| Italic | `ital` | Roman to italic | 0â€“1 |\n| Optical Size | `opsz` | Caption to display | 8â€“144 |\n\n### Custom Axes\n\nFont designers can define custom axes:\n- `GRAD` â€” Grade (weight without width change)\n- `XHGT` â€” x-height\n- `CASL` â€” Casual (in Recursive)\n- `CRSV` â€” Cursive\n- `MONO` â€” Monospace\n\n---\n\n## CSS Implementation\n\n### Basic Usage with font-weight\n\n```css\n/* Variable fonts respond to any weight value */\n.light { font-weight: 300; }\n.regular { font-weight: 400; }\n.medium { font-weight: 500; }\n.semibold { font-weight: 600; }\n.bold { font-weight: 700; }\n\n/* Non-standard weights work too */\n.custom { font-weight: 450; }\n```\n\n### Using font-variation-settings\n\nFor axes beyond weight:\n\n```css\n.text {\n  font-variation-settings:\n    \"wght\" 400,\n    \"wdth\" 100,\n    \"slnt\" 0;\n}\n\n/* Optical sizing for small text */\n.caption {\n  font-size: 12px;\n  font-variation-settings: \"opsz\" 12;\n}\n\n/* Optical sizing for display text */\n.display {\n  font-size: 72px;\n  font-variation-settings: \"opsz\" 72;\n}\n```\n\n### Automatic Optical Sizing\n\n```css\n/* Enable automatic optical sizing */\nbody {\n  font-optical-sizing: auto;\n}\n```\n\n### @font-face Declaration\n\n```css\n@font-face {\n  font-family: 'Inter';\n  src: url('/fonts/Inter-Variable.woff2') format('woff2-variations');\n  font-weight: 100 900; /* Declare weight range */\n  font-style: normal;\n  font-display: swap;\n}\n\n/* For variable fonts with italic axis */\n@font-face {\n  font-family: 'Source Sans';\n  src: url('/fonts/SourceSans-Variable.woff2') format('woff2-variations');\n  font-weight: 200 900;\n  font-style: oblique 0deg 12deg; /* Slant range */\n  font-display: swap;\n}\n```\n\n---\n\n## Fluid Typography with Variable Fonts\n\n### Weight Tied to Viewport\n\n```css\n/* Weight increases smoothly from 400 to 700 as viewport grows */\n.fluid-weight {\n  font-weight: calc(400 + (700 - 400) * ((100vw - 320px) / (1200 - 320)));\n}\n\n/* Clamped version */\n.fluid-weight-clamped {\n  --min-weight: 400;\n  --max-weight: 700;\n  font-weight: clamp(\n    var(--min-weight),\n    calc(var(--min-weight) + (var(--max-weight) - var(--min-weight)) * ((100vw - 320px) / (1200 - 320))),\n    var(--max-weight)\n  );\n}\n```\n\n### Width for Responsive Layouts\n\n```css\n/* Condense text on narrow viewports */\n.responsive-width {\n  font-variation-settings: \"wdth\" clamp(85, 75 + 10vw, 100);\n}\n```\n\n### Animation\n\n```css\n.animated-weight {\n  transition: font-weight 0.3s ease;\n}\n\n.animated-weight:hover {\n  font-weight: 700;\n}\n\n/* Keyframe animation */\n@keyframes breathe {\n  0%, 100% { font-weight: 300; }\n  50% { font-weight: 600; }\n}\n```\n\n---\n\n## Performance Benefits\n\n### File Size Comparison\n\n| Family | Static Files | Variable File | Savings |\n|--------|-------------|---------------|---------|\n| Inter (4 weights) | ~380KB | ~310KB | 18% |\n| Source Sans (6 weights) | ~450KB | ~280KB | 38% |\n| Roboto Flex (full) | ~1.2MB | ~450KB | 62% |\n\n### Optimization Techniques\n\n**Subsetting:** Remove unused characters:\n```bash\n# Using glyphhanger\nglyphhanger --whitelist=\"US_ASCII\" --subset=Inter-Variable.woff2\n```\n\n**Range limiting:** Only include needed weight range:\n```css\n/* If only using 400-700, subset to that range */\n@font-face {\n  font-family: 'Inter';\n  src: url('/fonts/Inter-subset.woff2') format('woff2-variations');\n  font-weight: 400 700;\n}\n```\n\n---\n\n## Recommended Variable Fonts\n\n### Sans-Serif\n\n| Font | Axes | Best For |\n|------|------|----------|\n| **Inter** | wght, slnt, opsz | UI, apps, general purpose |\n| **Source Sans 3** | wght, ital | Long-form reading, documents |\n| **Roboto Flex** | wght, wdth, slnt, opsz, GRAD | Material Design, flexibility |\n| **Work Sans** | wght | Headings, modern UI |\n| **DM Sans** | wght, ital, opsz | Clean geometric look |\n\n### Serif\n\n| Font | Axes | Best For |\n|------|------|----------|\n| **Source Serif 4** | wght, ital, opsz | Editorial, long-form |\n| **Fraunces** | wght, opsz, SOFT, WONK | Expressive headings |\n| **Literata** | wght, ital, opsz | Ebook readers |\n| **Newsreader** | wght, ital, opsz | News, editorial |\n\n### Monospace\n\n| Font | Axes | Best For |\n|------|------|----------|\n| **JetBrains Mono** | wght | Code editors |\n| **Fira Code** | wght | Code with ligatures |\n| **Source Code Pro** | wght | Documentation |\n| **Recursive** | wght, slnt, CASL, MONO | Code + UI (versatile) |\n\n### Display\n\n| Font | Axes | Best For |\n|------|------|----------|\n| **Anybody** | wght, wdth, ital | Bold headlines |\n| **Epilogue** | wght | Modern display |\n| **Outfit** | wght | Geometric headlines |\n\n---\n\n## Browser Support\n\nVariable fonts have excellent support (95%+ global):\n\n| Browser | Support |\n|---------|---------|\n| Chrome | 66+ |\n| Firefox | 62+ |\n| Safari | 11+ |\n| Edge | 17+ |\n\n### Fallback Strategy\n\n```css\n/* Provide static fallback for very old browsers */\n@supports not (font-variation-settings: normal) {\n  body {\n    font-family: 'Inter', system-ui, sans-serif;\n    /* Static weights loaded separately */\n  }\n}\n\n@supports (font-variation-settings: normal) {\n  body {\n    font-family: 'Inter Variable', system-ui, sans-serif;\n  }\n}\n```\n\n---\n\n## Quick Reference\n\n### Weight Guidelines\n\n| Weight | Name | Use Case |\n|--------|------|----------|\n| 300 | Light | Avoid for body text <16px |\n| 400 | Regular | Body text |\n| 500 | Medium | UI labels, emphasis |\n| 600 | Semibold | Subheadings |\n| 700 | Bold | Headings, strong emphasis |\n| 800-900 | Black | Display only |\n\n### Dark Mode Adjustments\n\nReduce weight slightly in dark mode (text appears heavier on dark backgrounds):\n\n```css\n@media (prefers-color-scheme: dark) {\n  body {\n    font-weight: 350; /* Instead of 400 */\n  }\n\n  h1, h2, h3 {\n    font-weight: 600; /* Instead of 700 */\n  }\n}\n```\n",
        "skills/unix-macos-engineer/SKILL.md": "---\nname: unix-macos-engineer\ndescription: Expert Unix and macOS systems engineer for shell scripting, system administration, command-line tools, launchd, Homebrew, networking, and low-level system tasks. Use when the user asks about Unix commands, shell scripts, macOS system configuration, process management, or troubleshooting system issues.\n---\n\n# Expert Unix and macOS Engineer\n\nDeep expertise in Unix systems and macOS-specific administration.\n\n## Core Expertise\n\n- **Shell Scripting**: Bash, Zsh, POSIX sh - robust scripts with proper error handling\n- **macOS System Administration**: launchd, plists, defaults, security frameworks\n- **Command-Line Mastery**: sed, awk, grep, find, xargs, jq, curl\n- **Process Management**: signals, job control, daemons, resource limits\n- **Networking**: curl, ssh, tunneling, DNS, firewall rules\n- **File Systems**: permissions, ACLs, extended attributes, APFS\n- **Homebrew**: packages, taps, casks, services\n- **Security**: Keychain, codesigning, notarization, Gatekeeper, TCC\n\n## Approach\n\n1. **Understand the environment first** - Check macOS version, shell, and relevant system state\n2. **Prefer built-in tools** - Use native utilities before third-party alternatives\n3. **Write defensive scripts** - Use `set -euo pipefail`, proper quoting, handle edge cases\n4. **Explain the why** - Clarify what commands do and why they're the right choice\n5. **Consider portability** - Note when something is macOS-specific vs. POSIX-compatible\n\n## Quick Patterns\n\n### Shell Script Essentials\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\n# Always quote variables\necho \"$variable\"\n\n# Check command existence\ncommand -v git &>/dev/null || { echo \"git not found\"; exit 1; }\n\n# Use [[ ]] for conditionals in Bash\n[[ -f \"$file\" ]] && echo \"exists\"\n```\n\n### macOS Quick Commands\n\n```bash\n# Read/write preferences\ndefaults read com.apple.finder AppleShowAllFiles\ndefaults write com.apple.dock autohide -bool true\n\n# Spotlight search\nmdfind -name \"file.txt\"\nmdfind \"search term\" -onlyin ~/Documents\n\n# Clipboard\necho \"text\" | pbcopy\npbpaste\n\n# Open files/URLs\nopen https://example.com\nopen -a \"Visual Studio Code\" file.txt\n```\n\n### Service Management (launchd)\n\n```bash\n# Load/unload agents\nlaunchctl load ~/Library/LaunchAgents/com.example.agent.plist\nlaunchctl unload ~/Library/LaunchAgents/com.example.agent.plist\n\n# Check plist syntax\nplutil -lint com.example.agent.plist\n```\n\n## Response Style\n\n- Provide working, tested commands\n- Include error handling where appropriate\n- Warn about potentially destructive operations\n- Suggest safer alternatives when risky commands are requested\n- Note when `sudo` or SIP disable is required\n- Distinguish macOS-specific from POSIX-portable solutions\n\n## Reference Guides\n\nLoad the relevant reference when working in that domain:\n\n| Domain | Reference | Contents |\n|--------|-----------|----------|\n| **launchd** | [references/launchd-patterns.md](references/launchd-patterns.md) | Plist templates, scheduling, file watchers, keep-alive services |\n| **Shell Scripts** | [references/shell-patterns.md](references/shell-patterns.md) | Argument parsing, error handling, loops, temp files, logging |\n| **macOS Commands** | [references/macos-commands.md](references/macos-commands.md) | defaults, mdfind, open, pbcopy, security, Homebrew |\n",
        "skills/unix-macos-engineer/references/launchd-patterns.md": "# launchd Patterns\n\nCommon patterns for macOS service management with launchd.\n\n## Plist Locations\n\n| Location | Purpose | Runs As |\n|----------|---------|---------|\n| `~/Library/LaunchAgents/` | User agents | Current user |\n| `/Library/LaunchAgents/` | System-wide user agents | Current user |\n| `/Library/LaunchDaemons/` | System daemons | root |\n\n## Basic Agent Template\n\nRun a script when the user logs in:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>Label</key>\n    <string>com.example.myagent</string>\n    <key>ProgramArguments</key>\n    <array>\n        <string>/usr/local/bin/myscript.sh</string>\n    </array>\n    <key>RunAtLoad</key>\n    <true/>\n</dict>\n</plist>\n```\n\n## Scheduled Task (cron replacement)\n\nRun daily at 3 AM:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>Label</key>\n    <string>com.example.daily-backup</string>\n    <key>ProgramArguments</key>\n    <array>\n        <string>/usr/local/bin/backup.sh</string>\n    </array>\n    <key>StartCalendarInterval</key>\n    <dict>\n        <key>Hour</key>\n        <integer>3</integer>\n        <key>Minute</key>\n        <integer>0</integer>\n    </dict>\n</dict>\n</plist>\n```\n\n## Interval-Based Execution\n\nRun every 5 minutes:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>Label</key>\n    <string>com.example.periodic</string>\n    <key>ProgramArguments</key>\n    <array>\n        <string>/usr/local/bin/check-status.sh</string>\n    </array>\n    <key>StartInterval</key>\n    <integer>300</integer>\n</dict>\n</plist>\n```\n\n## File Watcher\n\nRun when a file/directory changes:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>Label</key>\n    <string>com.example.filewatcher</string>\n    <key>ProgramArguments</key>\n    <array>\n        <string>/usr/local/bin/on-change.sh</string>\n    </array>\n    <key>WatchPaths</key>\n    <array>\n        <string>/path/to/watch</string>\n    </array>\n</dict>\n</plist>\n```\n\n## Keep-Alive Service\n\nRestart if process exits:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>Label</key>\n    <string>com.example.server</string>\n    <key>ProgramArguments</key>\n    <array>\n        <string>/usr/local/bin/server</string>\n    </array>\n    <key>KeepAlive</key>\n    <true/>\n    <key>RunAtLoad</key>\n    <true/>\n    <key>StandardOutPath</key>\n    <string>/var/log/myserver.log</string>\n    <key>StandardErrorPath</key>\n    <string>/var/log/myserver.error.log</string>\n</dict>\n</plist>\n```\n\n## Environment Variables\n\nSet environment for the job:\n\n```xml\n<key>EnvironmentVariables</key>\n<dict>\n    <key>PATH</key>\n    <string>/usr/local/bin:/usr/bin:/bin</string>\n    <key>MY_CONFIG</key>\n    <string>/etc/myapp/config.json</string>\n</dict>\n```\n\n## Working Directory\n\n```xml\n<key>WorkingDirectory</key>\n<string>/var/myapp</string>\n```\n\n## Resource Limits\n\n```xml\n<key>SoftResourceLimits</key>\n<dict>\n    <key>NumberOfFiles</key>\n    <integer>1024</integer>\n</dict>\n<key>HardResourceLimits</key>\n<dict>\n    <key>NumberOfFiles</key>\n    <integer>2048</integer>\n</dict>\n```\n\n## Common Commands\n\n```bash\n# Load agent (start it)\nlaunchctl load ~/Library/LaunchAgents/com.example.myagent.plist\n\n# Unload agent (stop it)\nlaunchctl unload ~/Library/LaunchAgents/com.example.myagent.plist\n\n# Bootstrap (modern alternative to load)\nlaunchctl bootstrap gui/$(id -u) ~/Library/LaunchAgents/com.example.myagent.plist\n\n# Bootout (modern alternative to unload)\nlaunchctl bootout gui/$(id -u)/com.example.myagent\n\n# Check if running\nlaunchctl list | grep com.example\n\n# Start immediately (without waiting for trigger)\nlaunchctl start com.example.myagent\n\n# Stop\nlaunchctl stop com.example.myagent\n\n# Validate plist syntax\nplutil -lint com.example.myagent.plist\n```\n\n## Debugging\n\n```bash\n# View logs (if using StandardOutPath/StandardErrorPath)\ntail -f /var/log/myserver.log\n\n# View system log for launch errors\nlog show --predicate 'subsystem == \"com.apple.launchd\"' --last 5m\n\n# Check job status\nlaunchctl print gui/$(id -u)/com.example.myagent\n```\n\n## Common Pitfalls\n\n- **Plist must be owned by root:wheel** for LaunchDaemons\n- **Scripts must be executable** (`chmod +x`)\n- **Use absolute paths** in ProgramArguments\n- **Label must match filename** (com.example.myagent.plist â†’ Label: com.example.myagent)\n- **Changes require unload/load** to take effect\n",
        "skills/unix-macos-engineer/references/macos-commands.md": "# macOS-Specific Commands\n\nQuick reference for macOS system commands and utilities.\n\n## System Information\n\n```bash\n# macOS version\nsw_vers\n\n# Hardware info\nsystem_profiler SPHardwareDataType\n\n# CPU info\nsysctl -n machdep.cpu.brand_string\n\n# Memory\nsysctl hw.memsize\n\n# Disk space\ndf -h\n\n# System uptime\nuptime\n```\n\n## defaults (Preferences)\n\nRead and write user defaults (preferences):\n\n```bash\n# Read a preference\ndefaults read com.apple.finder AppleShowAllFiles\n\n# Write a preference\ndefaults write com.apple.finder AppleShowAllFiles -bool true\n\n# Delete a preference (reset to default)\ndefaults delete com.apple.finder AppleShowAllFiles\n\n# List all preferences for an app\ndefaults read com.apple.finder\n\n# Find preferences (search)\ndefaults read | grep -i \"keyword\"\n\n# Write different types\ndefaults write com.example.app setting -string \"value\"\ndefaults write com.example.app setting -int 42\ndefaults write com.example.app setting -float 3.14\ndefaults write com.example.app setting -bool true\ndefaults write com.example.app setting -array \"a\" \"b\" \"c\"\n```\n\n### Common Finder Settings\n\n```bash\n# Show hidden files\ndefaults write com.apple.finder AppleShowAllFiles -bool true\n\n# Show file extensions\ndefaults write NSGlobalDomain AppleShowAllExtensions -bool true\n\n# Show path bar\ndefaults write com.apple.finder ShowPathbar -bool true\n\n# Show status bar\ndefaults write com.apple.finder ShowStatusBar -bool true\n\n# Restart Finder to apply\nkillall Finder\n```\n\n### Common Dock Settings\n\n```bash\n# Auto-hide dock\ndefaults write com.apple.dock autohide -bool true\n\n# Set dock size\ndefaults write com.apple.dock tilesize -int 48\n\n# Minimize to application icon\ndefaults write com.apple.dock minimize-to-application -bool true\n\n# Restart Dock to apply\nkillall Dock\n```\n\n## Spotlight (mdfind)\n\n```bash\n# Search by name\nmdfind -name \"document.pdf\"\n\n# Search by content\nmdfind \"search term\"\n\n# Limit to directory\nmdfind -onlyin ~/Documents \"search term\"\n\n# Search by file type\nmdfind \"kMDItemContentType == 'public.jpeg'\"\n\n# Search by date\nmdfind \"kMDItemFSCreationDate > \\$time.today(-7)\"\n\n# Rebuild Spotlight index\nsudo mdutil -E /\n```\n\n## Clipboard (pbcopy/pbpaste)\n\n```bash\n# Copy to clipboard\necho \"text\" | pbcopy\ncat file.txt | pbcopy\n\n# Paste from clipboard\npbpaste\npbpaste > file.txt\n\n# Copy file contents\npbcopy < file.txt\n```\n\n## open Command\n\n```bash\n# Open file with default app\nopen document.pdf\n\n# Open with specific app\nopen -a \"Visual Studio Code\" file.txt\n\n# Open URL\nopen https://example.com\n\n# Open directory in Finder\nopen .\nopen ~/Documents\n\n# Reveal file in Finder\nopen -R file.txt\n\n# Open new instance of app\nopen -n -a \"Safari\"\n```\n\n## Process Management\n\n```bash\n# List all processes\nps aux\n\n# Find process by name\npgrep -l \"Safari\"\n\n# Kill by name\npkill \"Safari\"\n\n# Force quit app\nkillall \"Safari\"\n\n# Activity Monitor data\ntop -l 1 -s 0\n\n# Per-process CPU/memory\nps -eo pid,pcpu,pmem,comm | head -20\n```\n\n## Disk Utilities\n\n```bash\n# List disks\ndiskutil list\n\n# Disk info\ndiskutil info /dev/disk0\n\n# Eject disk\ndiskutil eject /dev/disk2\n\n# Mount/unmount\ndiskutil mount /dev/disk2s1\ndiskutil unmount /dev/disk2s1\n\n# Repair permissions (legacy, now automatic)\ndiskutil verifyPermissions /\n\n# APFS snapshots\ntmutil listlocalsnapshots /\n```\n\n## Network\n\n```bash\n# Current network\nnetworksetup -getairportnetwork en0\n\n# List Wi-Fi networks\n/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -s\n\n# DNS servers\nscutil --dns\n\n# Flush DNS cache\nsudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder\n\n# Network interfaces\nifconfig\n\n# Active connections\nnetstat -an | grep ESTABLISHED\n\n# Test connectivity\nping -c 3 google.com\n\n# Trace route\ntraceroute google.com\n```\n\n## Security\n\n```bash\n# Keychain access (read password)\nsecurity find-generic-password -s \"service-name\" -w\n\n# Add to keychain\nsecurity add-generic-password -s \"service-name\" -a \"account\" -w \"password\"\n\n# List keychains\nsecurity list-keychains\n\n# Code signing info\ncodesign -dv --verbose=4 /Applications/App.app\n\n# Verify code signature\ncodesign --verify --verbose /Applications/App.app\n\n# Gatekeeper check\nspctl --assess --verbose /Applications/App.app\n```\n\n## Power Management\n\n```bash\n# Prevent sleep\ncaffeinate -d  # Display sleep\ncaffeinate -i  # Idle sleep\ncaffeinate -s  # System sleep\n\n# Prevent sleep for duration\ncaffeinate -t 3600  # 1 hour\n\n# Prevent sleep while command runs\ncaffeinate -i long_running_command\n\n# Battery info\npmset -g batt\n\n# Sleep settings\npmset -g\n\n# Schedule shutdown\nsudo shutdown -h +60  # In 60 minutes\n```\n\n## Screenshots\n\n```bash\n# Screenshot entire screen\nscreencapture screen.png\n\n# Screenshot selection\nscreencapture -i selection.png\n\n# Screenshot window\nscreencapture -w window.png\n\n# Screenshot to clipboard\nscreencapture -c\n\n# Screenshot with delay\nscreencapture -T 5 delayed.png\n\n# Screenshot specific display\nscreencapture -D 1 display1.png\n```\n\n## Text-to-Speech\n\n```bash\n# Speak text\nsay \"Hello, world\"\n\n# List voices\nsay -v '?'\n\n# Use specific voice\nsay -v \"Samantha\" \"Hello\"\n\n# Save to file\nsay -o output.aiff \"Hello, world\"\n\n# Read file\nsay -f input.txt\n```\n\n## Notifications\n\n```bash\n# Display notification (requires terminal-notifier or osascript)\nosascript -e 'display notification \"Message\" with title \"Title\"'\n\n# With sound\nosascript -e 'display notification \"Message\" with title \"Title\" sound name \"Ping\"'\n```\n\n## AppleScript Bridge\n\n```bash\n# Run AppleScript\nosascript -e 'tell application \"Finder\" to get name of front window'\n\n# Multi-line\nosascript <<EOF\ntell application \"Safari\"\n    activate\n    open location \"https://example.com\"\nend tell\nEOF\n```\n\n## SIP (System Integrity Protection)\n\n```bash\n# Check SIP status\ncsrutil status\n\n# Disable (requires Recovery Mode)\n# Boot to Recovery â†’ Terminal â†’ csrutil disable\n\n# Enable (requires Recovery Mode)\n# Boot to Recovery â†’ Terminal â†’ csrutil enable\n```\n\n## Homebrew Integration\n\n```bash\n# Install package\nbrew install package-name\n\n# Install GUI app\nbrew install --cask app-name\n\n# Update all\nbrew update && brew upgrade\n\n# List installed\nbrew list\nbrew list --cask\n\n# Services (launchd wrapper)\nbrew services list\nbrew services start service-name\nbrew services stop service-name\nbrew services restart service-name\n```\n",
        "skills/unix-macos-engineer/references/shell-patterns.md": "# Shell Script Patterns\n\nRobust patterns for Bash/Zsh scripts.\n\n## Script Header\n\nAlways start scripts with:\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\n# -e: Exit on error\n# -u: Error on undefined variables\n# -o pipefail: Pipeline fails if any command fails\n```\n\n## Argument Parsing\n\n### Simple positional args\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nif [[ $# -lt 1 ]]; then\n    echo \"Usage: $0 <filename>\" >&2\n    exit 1\nfi\n\nfilename=\"$1\"\n```\n\n### Named arguments with getopts\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nusage() {\n    echo \"Usage: $0 [-v] [-o output] <input>\" >&2\n    exit 1\n}\n\nverbose=false\noutput=\"\"\n\nwhile getopts \":vo:\" opt; do\n    case $opt in\n        v) verbose=true ;;\n        o) output=\"$OPTARG\" ;;\n        \\?) echo \"Invalid option: -$OPTARG\" >&2; usage ;;\n        :) echo \"Option -$OPTARG requires an argument\" >&2; usage ;;\n    esac\ndone\nshift $((OPTIND - 1))\n\n[[ $# -lt 1 ]] && usage\ninput=\"$1\"\n```\n\n## Defensive Checks\n\n### Command existence\n\n```bash\ncommand -v git &>/dev/null || {\n    echo \"Error: git is not installed\" >&2\n    exit 1\n}\n```\n\n### File/directory checks\n\n```bash\n[[ -f \"$file\" ]] || { echo \"File not found: $file\" >&2; exit 1; }\n[[ -d \"$dir\" ]] || { echo \"Directory not found: $dir\" >&2; exit 1; }\n[[ -r \"$file\" ]] || { echo \"File not readable: $file\" >&2; exit 1; }\n[[ -w \"$file\" ]] || { echo \"File not writable: $file\" >&2; exit 1; }\n[[ -x \"$file\" ]] || { echo \"File not executable: $file\" >&2; exit 1; }\n```\n\n### Running as root\n\n```bash\n# Require root\n[[ $EUID -eq 0 ]] || { echo \"Must run as root\" >&2; exit 1; }\n\n# Prevent running as root\n[[ $EUID -ne 0 ]] || { echo \"Do not run as root\" >&2; exit 1; }\n```\n\n## Variable Defaults\n\n```bash\n# Default value if unset\nname=\"${NAME:-default_value}\"\n\n# Default value if unset or empty\nname=\"${NAME:-default_value}\"\n\n# Error if unset\nname=\"${NAME:?NAME environment variable required}\"\n```\n\n## String Operations\n\n```bash\n# Check if string is empty\n[[ -z \"$str\" ]] && echo \"Empty\"\n\n# Check if string is non-empty\n[[ -n \"$str\" ]] && echo \"Not empty\"\n\n# String comparison\n[[ \"$str\" == \"value\" ]]\n[[ \"$str\" != \"value\" ]]\n\n# Pattern matching (glob)\n[[ \"$str\" == *.txt ]]\n\n# Regex matching\n[[ \"$str\" =~ ^[0-9]+$ ]]\n\n# Case-insensitive comparison\n[[ \"${str,,}\" == \"value\" ]]  # Bash 4+\n```\n\n## Arrays\n\n```bash\n# Define array\nfiles=(\"one.txt\" \"two.txt\" \"three.txt\")\n\n# Add element\nfiles+=(\"four.txt\")\n\n# Iterate\nfor file in \"${files[@]}\"; do\n    echo \"$file\"\ndone\n\n# Length\necho \"${#files[@]}\"\n\n# Index access\necho \"${files[0]}\"\n```\n\n## Loops\n\n### Process lines from file\n\n```bash\nwhile IFS= read -r line; do\n    echo \"$line\"\ndone < \"$file\"\n```\n\n### Process command output\n\n```bash\nwhile IFS= read -r line; do\n    echo \"$line\"\ndone < <(some_command)\n```\n\n### Process find results safely\n\n```bash\nwhile IFS= read -r -d '' file; do\n    echo \"$file\"\ndone < <(find . -name \"*.txt\" -print0)\n```\n\n## Temporary Files\n\n```bash\n# Create temp file\ntmpfile=$(mktemp)\ntrap 'rm -f \"$tmpfile\"' EXIT\n\n# Create temp directory\ntmpdir=$(mktemp -d)\ntrap 'rm -rf \"$tmpdir\"' EXIT\n```\n\n## Error Handling\n\n### Trap on exit\n\n```bash\ncleanup() {\n    rm -f \"$tmpfile\"\n    echo \"Cleanup complete\"\n}\ntrap cleanup EXIT\n```\n\n### Trap on error\n\n```bash\non_error() {\n    echo \"Error on line $1\" >&2\n}\ntrap 'on_error $LINENO' ERR\n```\n\n## Logging\n\n```bash\nlog() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $*\"\n}\n\nerror() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] ERROR: $*\" >&2\n}\n\nlog \"Starting script\"\nerror \"Something went wrong\"\n```\n\n## User Interaction\n\n### Confirm before proceeding\n\n```bash\nread -rp \"Continue? [y/N] \" response\n[[ \"$response\" =~ ^[Yy]$ ]] || exit 0\n```\n\n### Prompt with default\n\n```bash\nread -rp \"Enter name [default]: \" name\nname=\"${name:-default}\"\n```\n\n## Path Manipulation\n\n```bash\n# Get directory of script\nscript_dir=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\n\n# Get filename from path\nfilename=\"${path##*/}\"\n\n# Get directory from path\ndirname=\"${path%/*}\"\n\n# Get extension\next=\"${filename##*.}\"\n\n# Remove extension\nbasename=\"${filename%.*}\"\n```\n\n## Process Management\n\n```bash\n# Run in background\nlong_running_command &\npid=$!\n\n# Wait for completion\nwait \"$pid\"\n\n# Check if process exists\nkill -0 \"$pid\" 2>/dev/null && echo \"Running\"\n\n# Kill process group\nkill -- -\"$pid\"\n```\n\n## Common Pitfalls\n\n- **Always quote variables**: `\"$var\"` not `$var`\n- **Use `[[` not `[`**: `[[` is more powerful and safer\n- **Avoid parsing `ls`**: Use glob patterns or `find`\n- **Don't use `cat file | grep`**: Use `grep pattern file`\n- **Check exit codes**: `if command; then ...` or `command || handle_error`\n"
      },
      "plugins": [
        {
          "name": "rust",
          "description": "Robust Rust patterns for file-backed data, parsing, persistence, FFI boundaries, and system integration",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/rust"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install rust@petekp-agent-skills"
          ]
        },
        {
          "name": "tuning-panel",
          "description": "Create bespoke parameter tuning panels for iterating on animations, layouts, colors, typography, physics, or any visual parameters",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/tuning-panel"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install tuning-panel@petekp-agent-skills"
          ]
        },
        {
          "name": "unix-macos-engineer",
          "description": "Expert Unix and macOS systems engineer for shell scripting, system administration, command-line tools, launchd, Homebrew, networking, and low-level system tasks",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/unix-macos-engineer"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install unix-macos-engineer@petekp-agent-skills"
          ]
        },
        {
          "name": "model-first-reasoning",
          "description": "Apply Model-First Reasoning (MFR) to code generation tasks with formal modeling before implementation",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/model-first-reasoning"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install model-first-reasoning@petekp-agent-skills"
          ]
        },
        {
          "name": "macos-app-design",
          "description": "Design and build native macOS applications with SwiftUI or AppKit following Apple's design guidelines and Liquid Glass design system",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/macos-app-design"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install macos-app-design@petekp-agent-skills"
          ]
        },
        {
          "name": "interaction-design",
          "description": "Apply interaction design principles for intuitive, responsive interfaces including micro-interactions, loading states, transitions, and accessibility patterns",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/interaction-design"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install interaction-design@petekp-agent-skills"
          ]
        },
        {
          "name": "capture-learning",
          "description": "Capture learnings from sessions to project knowledge files or skills for cross-project reuse",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/capture-learning"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install capture-learning@petekp-agent-skills"
          ]
        },
        {
          "name": "dev-server",
          "description": "Start development servers with intelligent port management, conflict resolution, and automatic browser opening",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/dev-server"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install dev-server@petekp-agent-skills"
          ]
        },
        {
          "name": "typography",
          "description": "Apply professional typography principles for readable, hierarchical, and aesthetically refined interfaces",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/typography"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install typography@petekp-agent-skills"
          ]
        },
        {
          "name": "autonomous-agent-readiness",
          "description": "Assess a codebase's readiness for autonomous agent development and provide tailored recommendations",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/autonomous-agent-readiness"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install autonomous-agent-readiness@petekp-agent-skills"
          ]
        },
        {
          "name": "agentic-docs",
          "description": "Write clear, plain-spoken code comments and documentation optimized for both human readers and AI coding assistants",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/agentic-docs"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install agentic-docs@petekp-agent-skills"
          ]
        },
        {
          "name": "manual-testing",
          "description": "Guide users step-by-step through manually testing current work with selectable outcome options",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/manual-testing"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install manual-testing@petekp-agent-skills"
          ]
        },
        {
          "name": "agent-changelog",
          "description": "Compile agent-optimized changelog by cross-referencing git history with plans and documentation to identify key decisions and stale information",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/agent-changelog"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install agent-changelog@petekp-agent-skills"
          ]
        },
        {
          "name": "record-todos",
          "description": "Enter todo recording mode to capture ideas without acting on them, then organize and prioritize on exit",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/record-todos"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install record-todos@petekp-agent-skills"
          ]
        },
        {
          "name": "proposal-review",
          "description": "Facilitate methodical review of proposals by chunking content, predicting reviewer reactions, and producing feedback adapted to the proposal's format",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/proposal-review"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install proposal-review@petekp-agent-skills"
          ]
        },
        {
          "name": "optimize-agent-docs",
          "description": "Evaluate and optimize agent documentation in dotfiles (.claude, .codex, .cursor, .aider) for better discoverability and retrieval efficiency",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/optimize-agent-docs"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install optimize-agent-docs@petekp-agent-skills"
          ]
        },
        {
          "name": "exhaustive-systems-analysis",
          "description": "|",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/exhaustive-systems-analysis"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install exhaustive-systems-analysis@petekp-agent-skills"
          ]
        },
        {
          "name": "checkpoint",
          "description": "Meta-cognitive decision support that analyzes context and surfaces intelligent next-step options via AskUserQuestion with recommendations",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/checkpoint"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install checkpoint@petekp-agent-skills"
          ]
        },
        {
          "name": "process-hunter",
          "description": "CAVEMAN HUNT BAD PROCESS! Me find greedy creature eating fire (CPU) and rocks (memory). Me bonk them. Lightning rock (battery) happy. Tribe proud.",
          "source": "./",
          "strict": false,
          "skills": [
            "./skills/process-hunter"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add petekp/agent-skills",
            "/plugin install process-hunter@petekp-agent-skills"
          ]
        }
      ]
    }
  ]
}