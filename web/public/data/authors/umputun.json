{
  "author": {
    "id": "umputun",
    "display_name": "Umputun",
    "avatar_url": "https://avatars.githubusercontent.com/u/535880?v=4"
  },
  "marketplaces": [
    {
      "name": "ralphex",
      "version": null,
      "description": "Autonomous plan execution with Claude Code - task execution, monitoring, and plan creation",
      "repo_full_name": "umputun/ralphex",
      "repo_url": "https://github.com/umputun/ralphex",
      "repo_description": "Extended Ralph loop for autonomous AI-driven plan execution",
      "signals": {
        "stars": 435,
        "forks": 28,
        "pushed_at": "2026-02-16T17:30:18Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"ralphex\",\n  \"owner\": {\n    \"name\": \"umputun\",\n    \"email\": \"umputun@gmail.com\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"ralphex\",\n      \"source\": \"./\",\n      \"description\": \"Autonomous plan execution with Claude Code - task execution, monitoring, and plan creation\",\n      \"version\": \"0.12.0\",\n      \"author\": {\n        \"name\": \"umputun\"\n      }\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"ralphex\",\n  \"version\": \"0.12.0\",\n  \"description\": \"Autonomous plan execution with Claude Code - task execution, monitoring, and plan creation\",\n  \"author\": {\n    \"name\": \"umputun\",\n    \"email\": \"umputun@gmail.com\"\n  },\n  \"homepage\": \"https://ralphex.com\",\n  \"repository\": \"https://github.com/umputun/ralphex\",\n  \"license\": \"MIT\",\n  \"keywords\": [\n    \"automation\",\n    \"planning\",\n    \"code-review\",\n    \"task-execution\"\n  ],\n  \"skills\": \"./assets/claude/skills/\"\n}\n",
        "README.md": "<p align=\"center\">\n  <img src=\"assets/ralphex-wordmark-split.png\" alt=\"ralphex\" width=\"400\">\n</p>\n\n<p align=\"center\">\n  <a href=\"https://github.com/umputun/ralphex/actions/workflows/ci.yml\"><img src=\"https://github.com/umputun/ralphex/actions/workflows/ci.yml/badge.svg\" alt=\"build\"></a>\n  <a href=\"https://coveralls.io/github/umputun/ralphex?branch=master\"><img src=\"https://coveralls.io/repos/github/umputun/ralphex/badge.svg?branch=master\" alt=\"Coverage Status\"></a>\n  <a href=\"https://goreportcard.com/report/github.com/umputun/ralphex\"><img src=\"https://goreportcard.com/badge/github.com/umputun/ralphex?v=2\" alt=\"Go Report Card\"></a>\n</p>\n\n<h2 align=\"center\">Autonomous plan execution with Claude Code</h2>\n\n*ralphex is a standalone CLI tool that runs in your terminal from the root of a git repository. It orchestrates Claude Code to execute implementation plans autonomously - no IDE plugins or cloud services required, just Claude Code and a single binary.*\n\nClaude Code is powerful but interactive - it requires you to watch, approve, and guide each step. For complex features spanning multiple tasks, this means hours of babysitting. Worse, as context fills up during long sessions, the model's quality degrades - it starts making mistakes, forgetting earlier decisions, and producing worse code.\n\nralphex solves both problems. Each task executes in a fresh Claude Code session with minimal context, keeping the model sharp throughout the entire plan. Write a plan with tasks and validation commands, start ralphex, and walk away. Come back to find your feature implemented, reviewed, and committed - or check the progress log to see what it's doing.\n\n<details markdown>\n<summary>Task Execution Screenshot</summary>\n\n![ralphex tasks](assets/ralphex-tasks.png)\n\n</details>\n\n<details markdown>\n<summary>Review Mode Screenshot</summary>\n\n![ralphex review](assets/ralphex-review.png)\n\n</details>\n\n<details markdown>\n<summary>Web Dashboard Screenshot</summary>\n\n![ralphex web dashboard](assets/ralphex-web.png)\n\n</details>\n\n## Features\n\n- **Zero setup** - works out of the box with sensible defaults, no configuration required\n- **Autonomous task execution** - executes plan tasks one at a time with automatic retry\n- **Interactive plan creation** - create plans through dialogue with Claude via `--plan` flag\n- **Multi-phase code review** - 5 agents → codex → 2 agents review pipeline\n- **Custom review agents** - configurable agents with `{{agent:name}}` template system and user defined prompts\n- **Automatic branch creation** - creates git branch from plan filename\n- **Plan completion tracking** - moves completed plans to `completed/` folder\n- **Automatic commits** - commits after each task and review fix\n- **Real-time monitoring** - streaming output with timestamps, colors, and detailed logs\n- **Web dashboard** - browser-based real-time view with `--serve` flag\n- **Docker support** - run in isolated container for safer autonomous execution\n- **Notifications** - optional alerts on completion/failure via Telegram, Email, Slack, Webhook, or custom script\n- **Multiple modes** - full execution, tasks-only, review-only, external-only, or plan creation\n\n## Quick Start\n\nMake sure ralphex is [installed](#installation) and your project is a git repository. You need a plan file in `docs/plans/`, for example:\n\n```markdown\n# Plan: My Feature\n\n## Validation Commands\n- `go test ./...`\n\n### Task 1: Implement feature\n- [ ] Add the new functionality\n- [ ] Add tests\n```\n\nThen run:\n\n```bash\nralphex docs/plans/my-feature.md\n```\n\nralphex will create a branch, execute tasks, commit results, run multi-phase reviews, and move the plan to `completed/` when done.\n\n## How It Works\n\nralphex executes plans in four phases with automated code reviews, plus an optional finalize step.\n\n<details markdown>\n<summary>Execution Flow Diagram</summary>\n\n![ralphex flow](assets/ralphex-flow.png)\n\n</details>\n\n### Phase 1: Task Execution\n\n1. Reads plan file and finds first incomplete task (`### Task N:` with `- [ ]` checkboxes)\n2. Sends task to Claude Code for execution\n3. Runs validation commands (tests, linters) after each task\n4. Marks checkboxes as done `[x]`, commits changes\n5. Repeats until all tasks complete or max iterations reached\n\n### Phase 2: First Code Review\n\nLaunches 5 review agents **in parallel** via Claude Code Task tool:\n\n| Agent | Purpose |\n|-------|---------|\n| `quality` | bugs, security issues, race conditions |\n| `implementation` | verifies code achieves stated goals |\n| `testing` | test coverage and quality |\n| `simplification` | detects over-engineering |\n| `documentation` | checks if docs need updates |\n\nClaude verifies findings, fixes confirmed issues, and commits.\n\n*[Default agents](https://github.com/umputun/ralphex/tree/master/pkg/config/defaults/agents) provide common, language-agnostic review steps. They can be customized and tuned for your specific needs, languages, and workflows. See [Customization](#customization) for details.*\n\n### Phase 3: External Review (optional)\n\n1. Runs external review tool (codex by default, or custom script)\n2. Claude evaluates findings, fixes valid issues\n3. Iterates until no open issues\n\nSupported tools:\n- **codex** (default): OpenAI Codex for independent code review\n- **custom**: Your own script wrapping any AI (OpenRouter, local LLM, etc.)\n- **none**: Skip external review entirely\n\nSee [Custom External Review](#custom-external-review) for details on using custom scripts.\n\n### Phase 4: Second Code Review\n\n1. Launches 2 agents (`quality` + `implementation`) for final review\n2. Focuses on critical/major issues only\n3. Iterates until no issues found\n4. Moves plan to `completed/` folder on success\n\n*Second review agents are configurable via `prompts/review_second.txt`.*\n\n### Finalize Step (optional)\n\nAfter all review phases complete successfully, ralphex can run an optional finalize step. Disabled by default.\n\n**What it does:** runs a single Claude Code session with a customizable prompt. The default `finalize.txt` prompt rebases commits onto the default branch and optionally squashes related commits into logical groups.\n\n**How to enable:**\n\nSet `finalize_enabled = true` in `~/.config/ralphex/config` or `.ralphex/config`.\n\n**Behavior:**\n- Runs once (no iteration loop)\n- Best-effort — failures are logged but don't block success\n- Triggers on modes with review pipeline: full, review-only, external-only\n- Uses task color (green) for output\n\n**Customization:**\n\nEdit `~/.config/ralphex/prompts/finalize.txt` (or `.ralphex/prompts/finalize.txt`) to change what happens after reviews. Examples: push to remote, send notifications, run deployment scripts, or any post-completion automation. Template variables like `{{DEFAULT_BRANCH}}` are available.\n\n### Review-Only Mode\n\nReview-only mode (`--review`) runs the full review pipeline (Phase 2 → Phase 3 → Phase 4) on changes already present on the current branch. This is useful when changes were made outside ralphex — via Claude Code's built-in plan mode, manual edits, other AI agents, or any other workflow.\n\n**Workflow:**\n\n1. Make changes on a feature branch (using any tool or workflow)\n2. Commit the changes\n3. Run `ralphex --review`\n\nralphex compares the branch against the default branch (`git diff master...HEAD`), launches multi-agent reviews, and iterates fixes until all agents report clean. No plan file is required — if provided, it gives reviewers additional context about the intended changes.\n\n```bash\n# switch to feature branch with existing changes\ngit checkout feature-auth\n\n# run review pipeline on those changes\nralphex --review\n\n# optionally pass a plan file for context\nralphex --review docs/plans/add-auth.md\n```\n\n### Plan Creation\n\nPlans can be created in several ways:\n- **[Claude Code](#claude-code-integration-optional)** - use slash commands like `/ralphex-plan` or your own planning workflows\n- **Manually** - write markdown files directly in `docs/plans/`\n- **`--plan` flag** - integrated option that handles the entire flow\n- **Auto-detection** - running `ralphex` without arguments on master/main prompts for plan creation if no plans exist\n\nThe `--plan` flag provides a simpler integrated experience:\n\n```bash\nralphex --plan \"add health check endpoint\"\n```\n\nClaude explores your codebase, asks clarifying questions via a terminal picker (fzf or numbered fallback), and generates a complete plan file in `docs/plans/`. When reviewing the draft, you can accept, revise with text feedback, open it in `$EDITOR` for interactive annotation, or reject it.\n\n**Example session:**\n```\n$ ralphex --plan \"add caching for API responses\"\n[10:30:05] analyzing codebase structure...\n[10:30:12] found existing store layer in pkg/store/\n\nQUESTION: Which cache backend?\n  > Redis\n    In-memory\n    File-based\n    Other (type your own answer)\n\n[10:30:45] ANSWER: Redis\n[10:31:00] continuing plan creation...\n[10:32:05] plan written to docs/plans/add-api-caching.md\n\nContinue with plan implementation?\n  > Yes, execute plan\n    No, exit\n```\n\nAfter plan creation, you can choose to continue with immediate execution or exit to run ralphex later. Progress is logged to `.ralphex/progress/progress-plan-<name>.txt`.\n\n## Installation\n\n### From source\n\n```bash\ngo install github.com/umputun/ralphex/cmd/ralphex@latest\n```\n\n### Using Homebrew\n\n```bash\nbrew install umputun/apps/ralphex\n```\n\n### From releases\n\nDownload the appropriate binary from [releases](https://github.com/umputun/ralphex/releases).\n\n### Using Docker\n\nDownload the wrapper script and install to PATH:\n\n```bash\ncurl -sL https://raw.githubusercontent.com/umputun/ralphex/master/scripts/ralphex-dk.sh -o /usr/local/bin/ralphex\nchmod +x /usr/local/bin/ralphex\n```\n\nThe script defaults to the Go image (`ralphex-go`). For other languages, build a custom image from the base with your toolchain installed (see [Available images](#available-images) for examples), then point the wrapper at it:\n```bash\nexport RALPHEX_IMAGE=my-ralphex\n```\n\nThen use `ralphex` as usual - it runs in a container with Claude Code and Codex pre-installed. The script shows which image it's using at startup.\n\n**Why use Docker?** ralphex runs Claude Code with `--dangerously-skip-permissions`, giving it full access to execute commands and modify files. Running in a container provides isolation - Claude can only access the mounted project directory, not your entire system. This makes autonomous execution significantly safer.\n\n<details markdown>\n<summary>Isolation details</summary>\n\n**Container CAN access (read-write):**\n- Project directory mounted at `/workspace` - full access to create, modify, delete files\n- Git operations within the project (branch, commit, etc.)\n\n**Container CAN access (read-only):**\n- `~/.claude/` - credentials and settings (copied at startup, not modified)\n- `~/.codex/` - codex credentials if present\n- `~/.config/ralphex/` - user-level ralphex configuration\n- `~/.gitconfig` - git identity for commits\n- `.ralphex/` - project-level configuration if present\n\n**Container CANNOT access:**\n- Host filesystem outside mounted directories\n- Other projects or repositories\n- SSH keys, AWS credentials, or other secrets in `~/.ssh`, `~/.aws`, etc.\n- System files, binaries, or configurations\n- Other running processes or containers\n\n**Network:** Full network access (required for Claude API calls)\n\n**Privileges:** Runs as non-root user with no elevated capabilities\n\n</details>\n\n**Volume mounts:**\n- **Read-only**: `~/.claude` and `~/.codex` mounted to `/mnt/`, copied at startup to preserve isolation\n- **Read-write**: project directory (`/workspace`) - where ralphex creates branches, edits code, and commits\n\n**Requirements:**\n- Python 3.9+ (for the wrapper script)\n- Docker installed and running\n- Claude Code credentials in `~/.claude/` (or in `$CLAUDE_CONFIG_DIR` when set)\n- Codex credentials in `~/.codex/` (optional, for codex review phase)\n- Git config in `~/.gitconfig` (for commits)\n\n**Environment variables:**\n- `RALPHEX_IMAGE` - Docker image to use (default: `ghcr.io/umputun/ralphex-go:latest`)\n- `RALPHEX_PORT` - Port for web dashboard when using `--serve` (default: `8080`)\n- `RALPHEX_CONFIG_DIR` - Custom config directory (default: `~/.config/ralphex`). Overrides global config location for prompts, agents, and settings\n- `CLAUDE_CONFIG_DIR` - Claude config directory (default: `~/.claude`). Use for alternate Claude installations (e.g., `~/.claude2`). Works both with Docker wrapper (volume mounts and keychain derivation) and non-Docker usage (passed through to Claude Code directly). Keychain service name is derived automatically from the path.\n\n**Updating:**\n```bash\nralphex --update         # pull latest docker image\nralphex --update-script  # update the wrapper script itself\n```\n\n<details markdown>\n<summary>Available images</summary>\n\nTwo images are published:\n\n| Image | Description |\n|-------|-------------|\n| `ghcr.io/umputun/ralphex:latest` | Base image with Claude Code, Codex, and core tools |\n| `ghcr.io/umputun/ralphex-go:latest` | Go development (extends base with Go toolchain) |\n\n**Base image includes:**\n\n| Tool | Version | Purpose |\n|------|---------|---------|\n| Claude Code | latest | AI coding assistant |\n| Codex | latest | External code review |\n| Node.js/npm | 24.x | Required for Claude Code |\n| Python/pip | 3.x | Scripts and automation |\n| git | 2.x | Version control |\n| make | 4.x | Build automation |\n| gcc, musl-dev | - | C compiler for native extensions |\n| bash | 5.x | Shell |\n| fzf | - | Fuzzy finder for plan selection |\n| ripgrep | - | Fast search (used by Claude Code) |\n\n**Go image adds:**\n\n| Tool | Version | Purpose |\n|------|---------|---------|\n| Go | 1.26.0 | Go compiler and runtime |\n| golangci-lint | latest | Go linter |\n| moq | latest | Mock generator |\n| goimports | latest | Import formatter |\n\n**For Go projects**, use the `-go` image:\n```bash\nRALPHEX_IMAGE=ghcr.io/umputun/ralphex-go:latest ralphex docs/plans/feature.md\n```\n\n**For other languages**, create a custom image by extending the base with your language toolchain. The Go image (`Dockerfile-go`) shows the pattern:\n\n```dockerfile\nFROM ghcr.io/umputun/ralphex:latest\n\n# install go from official distribution\nARG GO_VERSION=1.26.0\nRUN ARCH=$(uname -m | sed 's/x86_64/amd64/;s/aarch64/arm64/') && \\\n    wget -qO- \"https://go.dev/dl/go${GO_VERSION}.linux-${ARCH}.tar.gz\" | tar -xz -C /usr/local\n\nENV GOROOT=/usr/local/go\nENV GOPATH=/home/app/go\nENV PATH=\"${PATH}:${GOROOT}/bin:${GOPATH}/bin\"\n\n# install go tools\nRUN wget -qO- https://raw.githubusercontent.com/golangci/golangci-lint/HEAD/install.sh | sh -s -- -b /usr/local/bin && \\\n    GOBIN=/usr/local/bin go install github.com/matryer/moq@latest && \\\n    GOBIN=/usr/local/bin go install golang.org/x/tools/cmd/goimports@latest\n```\n\nSame approach for Rust, Java, or any other language:\n```dockerfile\nFROM ghcr.io/umputun/ralphex:latest\n\n# rust\nRUN apk add --no-cache rust cargo\nENV CARGO_HOME=/home/app/.cargo PATH=\"${PATH}:${CARGO_HOME}/bin\"\n\n# java\nRUN apk add --no-cache openjdk21-jdk\nENV JAVA_HOME=/usr/lib/jvm/java-21-openjdk PATH=\"${PATH}:${JAVA_HOME}/bin\"\n```\n\nBuild and use:\n```bash\ndocker build -t my-ralphex -f Dockerfile.python .\nRALPHEX_IMAGE=my-ralphex ralphex docs/plans/feature.md\n```\n\n</details>\n\nExample with custom port:\n```bash\nRALPHEX_PORT=3000 ralphex --serve --port 3000 docs/plans/feature.md\n```\n\n## Usage\n\n**Note:** ralphex must be run from the repository root directory (where `.git` is located).\n\n```bash\n# execute plan with task loop + reviews\nralphex docs/plans/feature.md\n\n# select plan with fzf, or create one interactively if none exist\nralphex\n\n# review-only mode (skip task execution)\nralphex --review docs/plans/feature.md\n\n# external-only mode (skip tasks and first review, run only external review loop)\nralphex --external-only\n\n# tasks-only mode (run only task phase, skip all reviews)\nralphex --tasks-only docs/plans/feature.md\n\n# interactive plan creation\nralphex --plan \"add user authentication\"\n\n# with custom max iterations\nralphex --max-iterations=100 docs/plans/feature.md\n\n# with web dashboard\nralphex --serve docs/plans/feature.md\n\n# web dashboard on custom port\nralphex --serve --port 3000 docs/plans/feature.md\n```\n\n### Options\n\n| Flag | Description | Default |\n|------|-------------|---------|\n| `-m, --max-iterations` | Maximum task iterations | 50 |\n| `-r, --review` | Skip task execution, run full review pipeline | false |\n| `-e, --external-only` | Skip tasks and first review, run only external review loop | false |\n| `-c, --codex-only` | Alias for `--external-only` (deprecated) | false |\n| `-t, --tasks-only` | Run only task phase, skip all reviews | false |\n| `--plan` | Create plan interactively (provide description) | - |\n| `-s, --serve` | Start web dashboard for real-time streaming | false |\n| `-p, --port` | Web dashboard port (used with `--serve`) | 8080 |\n| `-w, --watch` | Directories to watch for progress files (repeatable) | - |\n| `-d, --debug` | Enable debug logging | false |\n| `--no-color` | Disable color output | false |\n| `--reset` | Interactively reset global config to embedded defaults | - |\n| `--dump-defaults` | Extract raw embedded defaults to specified directory | - |\n| `--config-dir` | Custom config directory (env: `RALPHEX_CONFIG_DIR`) | `~/.config/ralphex` |\n\n## Plan File Format\n\nPlans are markdown files with task sections. Each task has checkboxes that claude marks complete.\n\n```markdown\n# Plan: Add User Authentication\n\n## Overview\nAdd JWT-based authentication to the API.\n\n## Validation Commands\n- `go test ./...`\n- `golangci-lint run`\n\n### Task 1: Add auth middleware\n- [ ] Create JWT validation middleware\n- [ ] Add to router for protected routes\n- [ ] Add tests\n- [ ] Mark completed\n\n### Task 2: Add login endpoint\n- [ ] Create /api/login handler\n- [ ] Return JWT on successful auth\n- [ ] Add tests\n- [ ] Mark completed\n```\n\n**Requirements:**\n- Task headers must use `### Task N:` or `### Iteration N:` format\n- Checkboxes: `- [ ]` (incomplete) or `- [x]` (completed)\n- Include `## Validation Commands` section with test/lint commands\n- Place plans in `docs/plans/` directory (configurable via `plans_dir`)\n\n## Review Agents\n\nThe review pipeline is fully customizable. ralphex ships with sensible defaults that work for any language, but you can modify agents, add new ones, or replace prompts entirely to match your specific workflow.\n\n### Default Agents\n\nThese 5 agents cover common review concerns and work well out of the box. Customize or replace them based on your needs:\n\n| Agent | Phase | Purpose |\n|-------|-------|---------|\n| `quality` | 1st & 2nd | bugs, security issues, race conditions |\n| `implementation` | 1st & 2nd | verifies code achieves stated goals |\n| `testing` | 1st only | test coverage and quality |\n| `simplification` | 1st only | detects over-engineering |\n| `documentation` | 1st only | checks if docs need updates |\n\n### Agent Options (Frontmatter)\n\nAgent files support optional YAML frontmatter for per-agent configuration:\n\n```txt\n---\nmodel: haiku\nagent: code-reviewer\n---\nReview the code for quality issues...\n```\n\n| Option | Values | Description |\n|--------|--------|-------------|\n| `model` | `haiku`, `sonnet`, `opus` | Claude model for this agent |\n| `agent` | any string | Claude Code Task tool subagent type |\n\nBoth options are optional. Without frontmatter, agents use default model and `general-purpose` subagent type. Full model IDs (e.g. `claude-sonnet-4-5-20250929`) are normalized to short keywords (`sonnet`) since Claude Code only accepts `haiku`, `sonnet`, `opus`. Invalid model values are dropped with a warning.\n\n### Template Syntax\n\nCustom prompt files support variable expansion. All variables use the `{{VARIABLE}}` syntax.\n\n**Available variables:**\n\n| Variable | Description | Example value |\n|----------|-------------|---------------|\n| `{{PLAN_FILE}}` | Path to the plan file being executed | `docs/plans/feature.md` |\n| `{{PROGRESS_FILE}}` | Path to the progress log file | `.ralphex/progress/progress-feature.txt` |\n| `{{GOAL}}` | Human-readable goal description | `implementation of plan at docs/plans/feature.md` |\n| `{{DEFAULT_BRANCH}}` | Default branch name (detected from repo) | `main`, `master`, `origin/main` |\n| `{{agent:name}}` | Expands to Task tool instructions for the named agent | (see below) |\n\n**Agent references:**\n\nReference agents in prompt files using `{{agent:name}}` syntax:\n\n```\nLaunch the following review agents in parallel:\n{{agent:quality}}\n{{agent:implementation}}\n{{agent:testing}}\n```\n\nEach `{{agent:name}}` expands to Task tool instructions that tell Claude Code to run that agent. Variables inside agent content are also expanded, so agents can use `{{DEFAULT_BRANCH}}` or other variables.\n\n### Customization\n\nThe entire system is designed for customization - both task execution and reviews:\n\n**Agent files** (`~/.config/ralphex/agents/`):\n- Edit existing files to modify agent behavior\n- Add new `.txt` files to create custom agents\n- Run `ralphex --reset` to interactively restore defaults, or delete all files manually\n- Run `ralphex --dump-defaults <dir>` to extract raw defaults for comparison\n- Use the `/ralphex-update` Claude Code skill to smart-merge updated defaults into customized files\n- Alternatively, reference agents already installed in your Claude Code directly in prompt files (see example below)\n\n**Prompt files** (`~/.config/ralphex/prompts/`):\n- `task.txt` - task execution prompt\n- `review_first.txt` - comprehensive review (default: 5 language-agnostic agents - quality, implementation, testing, simplification, documentation; customizable)\n- `codex.txt` - codex review prompt\n- `review_second.txt` - final review, critical/major issues only (default: 2 agents - quality, implementation; customizable)\n- `finalize.txt` - optional finalize step prompt (disabled by default)\n\n**Comment lines and markdown headers:**\nA leading block of 2+ contiguous comment lines (starting with `#`) at the top of a file is treated as a meta-comment and stripped when loading. A single `# Title` at the top is preserved (treated as a markdown header). Comment lines appearing later in the file body are always preserved:\n\n```txt\n# This single title line is preserved as a markdown header\ncheck for SQL injection\n# this mid-body comment is also preserved\ncheck for XSS\n```\n\nFiles containing *only* comment lines (every line starts with `#`) are treated as unmodified templates and fall back to embedded defaults. This is how commented-out default files work — once you add any non-comment content, the file is used as-is.\n\nNote: Inline comments are not supported (`text # comment` keeps the entire line).\n\n**Examples:**\n- Add a security-focused agent for fintech projects\n- Remove `simplification` agent if over-engineering isn't a concern\n- Create language-specific agents (Python linting, TypeScript types)\n- Modify prompts to change how many agents run per phase\n\n**Using Claude Code agents directly:**\n\nInstead of creating agent files, you can reference agents installed in your Claude Code directly in prompt files:\n\n```txt\n# in review_first.txt - just list agent names with their prompts\nAgents to launch:\n1. qa-expert - \"Review for bugs and security issues\"\n2. go-test-expert - \"Review test coverage and quality\"\n3. go-smells-expert - \"Review for code smells\"\n```\n\n## Requirements\n\n- `claude` - Claude Code CLI\n- `fzf` - for plan selection (optional)\n- `codex` - for external review (optional)\n\n## Configuration\n\nralphex uses a configuration directory at `~/.config/ralphex/` (override with `--config-dir` or `RALPHEX_CONFIG_DIR`) with the following structure:\n\n```\n~/.config/ralphex/\n├── config              # main configuration file (INI format)\n├── prompts/            # custom prompt templates\n│   ├── task.txt\n│   ├── review_first.txt\n│   ├── review_second.txt\n│   └── codex.txt\n└── agents/             # custom review agents (*.txt files)\n```\n\nOn first run, ralphex creates this directory with default configuration.\n\n**Commented templates:**\n- Config files are installed with all content commented out (`# ` prefix)\n- Uncomment only the settings you want to customize\n- Files that remain all-commented receive automatic updates with new defaults\n- Once you uncomment any setting, the file is preserved and won't be overwritten\n\n### Local Project Config\n\nProjects can override global settings with a `.ralphex/` directory in the project root:\n\n```\nproject/\n├── .ralphex/           # optional, project-local config\n│   ├── config          # overrides specific settings\n│   ├── prompts/        # custom prompts for this project\n│   └── agents/         # custom agents for this project\n```\n\n**Priority:** CLI flags > local `.ralphex/` > global `~/.config/ralphex/` > embedded defaults\n\nUse `--config-dir` or `RALPHEX_CONFIG_DIR` to override the global config location. This is useful for maintaining separate agent/prompt sets for different workflows.\n\n**Merge behavior:**\n- **Config file**: per-field override (local values override global, missing fields fall back)\n- **Prompts**: per-file fallback (local → global → embedded for each prompt file)\n- **Agents**: replace entirely (if local `agents/` has `.txt` files, use ONLY local agents)\n\n### Configuration options\n\n| Option | Description | Default |\n|--------|-------------|---------|\n| `claude_command` | Claude CLI command | `claude` |\n| `claude_args` | Claude CLI arguments | `--dangerously-skip-permissions --output-format stream-json --verbose` |\n| `codex_enabled` | Enable codex review phase | `true` |\n| `codex_command` | Codex CLI command | `codex` |\n| `codex_model` | Codex model ID | `gpt-5.3-codex` |\n| `codex_reasoning_effort` | Reasoning effort level | `xhigh` |\n| `codex_timeout_ms` | Codex timeout in ms | `3600000` |\n| `codex_sandbox` | Sandbox mode | `read-only` |\n| `external_review_tool` | External review tool (`codex`, `custom`, `none`) | `codex` |\n| `custom_review_script` | Path to custom review script (when `external_review_tool = custom`) | - |\n| `iteration_delay_ms` | Delay between iterations | `2000` |\n| `task_retry_count` | Task retry attempts | `1` |\n| `finalize_enabled` | Enable finalize step after reviews | `false` |\n| `plans_dir` | Plans directory | `docs/plans` |\n| `default_branch` | Override auto-detected default branch for review diffs | auto-detect |\n| `color_task` | Task execution phase color (hex) | `#00ff00` |\n| `color_review` | Review phase color (hex) | `#00ffff` |\n| `color_codex` | Codex review color (hex) | `#ff00ff` |\n| `color_claude_eval` | Claude evaluation color (hex) | `#64c8ff` |\n| `color_warn` | Warning messages color (hex) | `#ffff00` |\n| `color_error` | Error messages color (hex) | `#ff0000` |\n| `color_signal` | Completion/failure signals color (hex) | `#ff6464` |\n| `color_timestamp` | Timestamp prefix color (hex) | `#8a8a8a` |\n| `color_info` | Informational messages color (hex) | `#b4b4b4` |\n| `claude_error_patterns` | Patterns to detect in claude output (comma-separated) | `You've hit your limit` |\n| `codex_error_patterns` | Patterns to detect in codex output (comma-separated) | `Rate limit,quota exceeded` |\n\nColors use 24-bit RGB (true color), supported natively by all modern terminals (iTerm2, Kitty, Terminal.app, Windows Terminal, GNOME Terminal, Alacritty, Zed, VS Code, etc). Older terminals will degrade gracefully. Use `--no-color` to disable colors entirely.\n\nError patterns use case-insensitive substring matching. When a pattern is detected in claude or codex output, ralphex exits gracefully with an informative message suggesting how to check usage/status. Multiple patterns are separated by commas, with whitespace trimmed from each pattern.\n\n### Custom prompts\n\nPlace custom prompt files in `~/.config/ralphex/prompts/` to override the built-in prompts. Missing files fall back to embedded defaults. See [Review Agents](#review-agents) section for agent customization.\n\n### Custom External Review\n\nUse your own AI tool for external code review instead of codex. This allows integration with OpenRouter, local LLMs, or any custom pipeline.\n\n**Configuration:**\n\n```ini\n# in ~/.config/ralphex/config\nexternal_review_tool = custom\ncustom_review_script = ~/.config/ralphex/scripts/my-review.sh\n```\n\n**Script interface:**\n\nYour script receives a single argument: path to a prompt file containing review instructions. The script outputs findings to stdout - ralphex passes them to Claude for evaluation and fixing.\n\n```bash\n#!/bin/bash\n# example: ~/.config/ralphex/scripts/my-review.sh\nprompt_file=\"$1\"\n\n# read the prompt (contains diff instructions, goal, review focus)\nprompt=$(cat \"$prompt_file\")\n\n# call your AI tool (OpenRouter, local LLM, etc.)\n# example with curl to OpenRouter:\ncurl -s https://openrouter.ai/api/v1/chat/completions \\\n  -H \"Authorization: Bearer $OPENROUTER_API_KEY\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"{\n    \\\"model\\\": \\\"anthropic/claude-3.5-sonnet\\\",\n    \\\"messages\\\": [{\\\"role\\\": \\\"user\\\", \\\"content\\\": $(echo \"$prompt\" | jq -Rs .)}]\n  }\" | jq -r '.choices[0].message.content'\n```\n\n**Expected output format:**\n\n- Write findings to stdout as a structured list\n- Use format: `file:line - description of issue`\n- Output `NO ISSUES FOUND` when there are no problems\n\n**Iteration behavior:**\n\nThe prompt's `{{DIFF_INSTRUCTION}}` variable adapts per iteration:\n- **First iteration**: `git diff main...HEAD` (all changes in feature branch)\n- **Subsequent iterations**: `git diff` (only uncommitted changes from previous fixes)\n\nThis lets the review tool focus on remaining issues after fixes.\n\n### Notifications\n\nralphex can send notifications when execution completes or fails. Notifications are optional, disabled by default, and best-effort - failures are logged but never affect the exit code.\n\n```ini\n# in ~/.config/ralphex/config or .ralphex/config\nnotify_channels = telegram, webhook\nnotify_telegram_token = 123456:ABC-DEF\nnotify_telegram_chat = -1001234567890\nnotify_webhook_urls = https://hooks.example.com/notify\n```\n\nSupported channels: `telegram`, `email`, `slack`, `webhook`, `custom` (script). Misconfigured channels are detected at startup.\n\nSee [docs/notifications.md](docs/notifications.md) for setup guides, message format examples, and custom script integration.\n\n**Prompt customization:**\n\nCustomize `~/.config/ralphex/prompts/custom_review.txt` to modify the prompt sent to your script. Available variables:\n- `{{DIFF_INSTRUCTION}}` - git diff command appropriate for current iteration\n- `{{GOAL}}` - human-readable description of what's being implemented\n- `{{PLAN_FILE}}` - path to the plan file\n- `{{DEFAULT_BRANCH}}` - detected default branch (main, master, etc.)\n\nCustomize `~/.config/ralphex/prompts/custom_eval.txt` to modify how Claude evaluates your tool's output.\n\n**Docker considerations:**\n\nWhen running ralphex in Docker, your script must be accessible inside the container:\n- Mount your scripts directory: `-v ~/.config/ralphex/scripts:/home/app/.config/ralphex/scripts:ro`\n- Ensure script dependencies are available (curl, jq, etc. are included in base image)\n- Environment variables (API keys) must be passed to container: `-e OPENROUTER_API_KEY`\n\n<details markdown>\n<summary><b>FAQ</b></summary>\n\n**I installed ralphex, what do I do next?**\n\nCreate a plan file in `docs/plans/` (see [Quick Start](#quick-start) for format), then run `ralphex docs/plans/your-plan.md`. ralphex will create a branch, execute tasks, and run reviews automatically.\n\n**Why are there two review phases?**\n\nFirst review is comprehensive (5 agents by default), second is a final check focusing on critical/major issues only (2 agents). See [How It Works](#how-it-works).\n\n**How do I use my own Claude Code agents?**\n\nReference them directly in prompt files by name, e.g., `qa-expert - \"Review for bugs\"`. See [Customization](#customization).\n\n**What if codex isn't installed?**\n\nCodex is optional. If not installed, the codex review phase is skipped automatically.\n\n**Can I run just reviews without task execution?**\n\nYes, use `--review` flag to run the full review pipeline (Phase 2 → Phase 3 → Phase 4) on changes already on the current branch. This works for changes made by any tool — Claude Code's built-in mode, manual edits, other agents, etc. Switch to the feature branch, commit your changes, and run `ralphex --review`. See [Review-Only Mode](#review-only-mode) for details.\n\n**Can I run ralphex in a non-git directory?**\n\nNo. Git is required for branch management, automatic commits, and diff-based code reviews.\n\n**What if my repository has no commits?**\n\nralphex prompts to create an initial commit when the repository is empty. This is required because ralphex needs branches for feature isolation. Answer \"y\" to let ralphex stage all files and create an initial commit, or create one manually first with `git add . && git commit -m \"initial commit\"`.\n\n**Should I run ralphex on master or a feature branch?**\n\nFor full mode, start on master - ralphex creates a branch automatically from the plan filename. For `--review` mode, switch to your feature branch first - reviews compare against master using `git diff master...HEAD`.\n\n**How do I restore default agents after customizing?**\n\nRun `ralphex --reset` to interactively reset global config. Select which components to reset (config, prompts, agents). Alternatively, delete all `.txt` files from `~/.config/ralphex/agents/` manually. To smart-merge updated defaults into customized files (preserving your changes), use the `/ralphex-update` Claude Code skill or `ralphex --dump-defaults <dir>` to extract defaults for manual comparison.\n\n**How does local .ralphex/ config interact with global config?**\n\nPriority: CLI flags > local `.ralphex/config` > global `~/.config/ralphex/config` > embedded defaults. Each local setting overrides the corresponding global one—no need to duplicate the entire file. For agents: if local `agents/` has any `.txt` files, it replaces global agents entirely.\n\n**What happens to uncommitted changes if ralphex fails?**\n\nRalphex commits after each completed task. If execution fails, completed tasks are already committed to the feature branch. Uncommitted changes from the failed task remain in the working directory for manual inspection.\n\n**What if ralphex is interrupted mid-execution?**\n\nCompleted tasks are already committed to the feature branch. To resume, re-run `ralphex docs/plans/<plan>.md`. Ralphex detects completed tasks via `[x]` checkboxes in the plan and continues from the first incomplete task. For review sessions, simply restart. Reviews re-run from iteration 1, but fixes from previous iterations remain in the codebase.\n\n**Can I adjust the plan or change direction while ralphex is running?**\n\nYes, two approaches depending on the situation:\n\n1. **Edit CLAUDE.md** — for behavioral changes (coding style, libraries, constraints). Each task runs in a fresh Claude Code session that reads CLAUDE.md at startup, so changes take effect on the next task or iteration automatically. No need to stop ralphex.\n\n2. **Stop, edit plan, re-run** — for structural changes (reorder tasks, add/remove tasks, change requirements). Press Ctrl+C to stop, edit the plan file (uncheck `[x]` → `[ ]` to redo tasks, add new tasks, modify descriptions), then re-run `ralphex docs/plans/<plan>.md`. Ralphex picks up from the first incomplete task and adapts to the updated plan.\n\n**What's the difference between progress file and plan file?**\n\nProgress file (`.ralphex/progress/progress-*.txt`) is a real-time execution log—tail it to monitor. Plan file tracks task state (`[ ]` vs `[x]`). To resume, re-run ralphex on the plan file; it finds incomplete tasks automatically.\n\n**Do I need to commit changes before running ralphex?**\n\nIt depends. If the plan file is the only uncommitted change, ralphex auto-commits it after creating the feature branch and continues execution. If other files have uncommitted changes, ralphex shows a helpful error with options: stash temporarily (`git stash`), commit first (`git commit -am \"wip\"`), or use review-only mode (`ralphex --review`).\n\n**What's the difference between agents/ and prompts/?**\n\nAgents define *what* to check (review instructions). Prompts define *how* the workflow runs (execution steps, signal handling).\n\n**Can I use Cursor CLI instead of Claude Code?**\n\nYes. [Cursor CLI](https://cursor.com/cli) is community-tested as a drop-in alternative. Configure in `~/.config/ralphex/config`:\n\n```ini\nclaude_command = agent\nclaude_args = --force --output-format stream-json\n```\n\nKey differences: `agent` command (not `claude`), `--force` flag (not `--dangerously-skip-permissions`). Stream format and signals are compatible. *Note: this is community-tested, not officially supported. Compatibility depends on Cursor maintaining Claude Code compatibility.*\n\n**How do I use multiple Claude accounts?**\n\nSet the `CLAUDE_CONFIG_DIR` environment variable to point to the alternate Claude config directory:\n\n```bash\nCLAUDE_CONFIG_DIR=~/.claude2 ralphex docs/plans/feature.md\n```\n\nThis is the same env var Claude Code itself uses. With Docker, the wrapper script mounts the specified directory and derives the correct macOS Keychain service name from the path. Without Docker, the env var passes through to the child Claude Code process directly. Each Claude installation stores credentials under a unique Keychain entry based on its config directory. No additional configuration is needed — just point `CLAUDE_CONFIG_DIR` to the right directory.\n\n**Can I run something after all phases complete (notifications, rebase commits, etc.)?**\n\nYes. Enable the finalize step with `finalize_enabled = true` in config. It runs once after successful review phases (best-effort—failures are logged but don't block success). The default `finalize.txt` prompt rebases onto the default branch and optionally squashes commits into logical groups. Customize `~/.config/ralphex/prompts/finalize.txt` for other actions like sending notifications, pushing to remote, or running custom scripts.\n\n</details>\n\n## Web Dashboard\n\nThe `--serve` flag starts a browser-based dashboard for real-time monitoring of plan execution.\n\n```bash\nralphex --serve docs/plans/feature.md\n# web dashboard: http://localhost:8080\n```\n\n### Features\n\n- **Real-time streaming** - SSE connection for live output updates\n- **Phase navigation** - filter by All/Task/Review/Codex phases\n- **Collapsible sections** - organized output with expand/collapse\n- **Text search** - find text with highlighting (keyboard: `/` to focus, `Escape` to clear)\n- **Auto-scroll** - follows output, click to disable\n- **Late-join support** - new clients receive full history\n\nThe dashboard uses a dark theme with phase-specific colors matching terminal output. All file and stdout logging continues unchanged when using `--serve`.\n\n### Multi-Session Mode\n\nThe `--watch` flag enables monitoring multiple ralphex sessions simultaneously:\n\n```bash\n# watch specific directories for progress files\nralphex --serve --watch ~/projects/frontend --watch ~/projects/backend\n\n# configure watch directories in config file\n# watch_dirs = /home/user/projects, /var/log/ralphex\n```\n\nMulti-session features:\n- **Session sidebar** - lists all discovered sessions, click to switch (keyboard: `S` to toggle)\n- **Active detection** - pulsing indicator for running sessions via file locking\n- **Auto-discovery** - new sessions appear automatically as they start\n\n## Claude Code Integration (Optional)\n\nralphex works standalone from the terminal. Optionally, you can add slash commands to Claude Code for a more integrated experience.\n\n### Available Commands\n\n| Command | Description |\n|---------|-------------|\n| `/ralphex` | Launch and monitor ralphex execution with interactive mode/plan selection |\n| `/ralphex-plan` | Create structured implementation plans with guided context gathering |\n| `/ralphex-update` | Smart-merge updated embedded defaults into customized prompts/agents |\n\n### Installation\n\nThe ralphex CLI is the primary interface. Claude Code skills (`/ralphex`, `/ralphex-plan`, and `/ralphex-update`) are optional convenience commands.\n\n**Via Plugin Marketplace (Recommended)**\n\n```bash\n# Add ralphex marketplace\n/plugin marketplace add umputun/ralphex\n\n# Install the plugin\n/plugin install ralphex@umputun-ralphex\n```\n\nBenefits: Auto-updates when marketplace refreshes (at Claude Code startup).\n\n**Manual Installation (Alternative)**\n\nThe slash command definitions are hosted at:\n- [`/ralphex`](https://ralphex.com/assets/claude/ralphex.md)\n- [`/ralphex-plan`](https://ralphex.com/assets/claude/ralphex-plan.md)\n- [`/ralphex-update`](https://ralphex.com/assets/claude/ralphex-update.md)\n\nTo install, ask Claude Code to \"install ralphex slash commands\" or manually copy the files to `~/.claude/commands/`.\n\n### Usage\n\nOnce installed:\n\n```\n# in Claude Code conversation\n/ralphex-plan add user authentication    # creates plan interactively\n/ralphex docs/plans/auth.md              # launches execution\n\"check ralphex\"                          # gets status update\n```\n\nThe `/ralphex` command runs ralphex in the background and provides status updates on request. The `/ralphex-plan` command guides you through creating well-structured plans with context discovery and approach selection.\n\n## For LLMs\n\nSee [llms.txt](llms.txt) for LLM-optimized documentation.\n\n## License\n\nMIT License - see [LICENSE](LICENSE) file.\n"
      },
      "plugins": [
        {
          "name": "ralphex",
          "source": "./",
          "description": "Autonomous plan execution with Claude Code - task execution, monitoring, and plan creation",
          "version": "0.12.0",
          "author": {
            "name": "umputun"
          },
          "categories": [],
          "install_commands": [
            "/plugin marketplace add umputun/ralphex",
            "/plugin install ralphex@ralphex"
          ]
        }
      ]
    }
  ]
}