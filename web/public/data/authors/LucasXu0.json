{
  "author": {
    "id": "LucasXu0",
    "display_name": "Lucas",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/11863087?u=e0dae4a9247bc0191c83ba7fcee12c6e32562d5c&v=4",
    "url": "https://github.com/LucasXu0",
    "bio": "From Zero To Hero",
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 2,
      "total_commands": 9,
      "total_skills": 3,
      "total_stars": 0,
      "total_forks": 0
    }
  },
  "marketplaces": [
    {
      "name": "LucasXu0-flutter-tools",
      "version": null,
      "description": "Flutter/Dart code quality tools for Claude Code",
      "owner_info": {
        "name": "Lucas Xu",
        "url": "https://github.com/LucasXu0"
      },
      "keywords": [],
      "repo_full_name": "LucasXu0/claude-code-plugin",
      "repo_url": "https://github.com/LucasXu0/claude-code-plugin",
      "repo_description": null,
      "homepage": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-12T06:40:25Z",
        "created_at": "2026-01-04T06:41:02Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 1078
        },
        {
          "path": "plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/flutter-tools",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/flutter-tools/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/flutter-tools/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 509
        },
        {
          "path": "plugins/flutter-tools/README.md",
          "type": "blob",
          "size": 3641
        },
        {
          "path": "plugins/flutter-tools/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/flutter-tools/agents/flutter-code-reviewer.md",
          "type": "blob",
          "size": 4635
        },
        {
          "path": "plugins/flutter-tools/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/flutter-tools/commands/flutter-format.md",
          "type": "blob",
          "size": 357
        },
        {
          "path": "plugins/flutter-tools/commands/flutter-review.md",
          "type": "blob",
          "size": 533
        },
        {
          "path": "plugins/flutter-tools/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/flutter-tools/skills/flutter-format",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/flutter-tools/skills/flutter-format/SKILL.md",
          "type": "blob",
          "size": 6527
        },
        {
          "path": "plugins/flutter-tools/skills/flutter-review",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/flutter-tools/skills/flutter-review/SKILL.md",
          "type": "blob",
          "size": 13346
        },
        {
          "path": "plugins/flutter-tools/skills/flutter-review/examples.md",
          "type": "blob",
          "size": 49388
        },
        {
          "path": "plugins/flutter-tools/skills/flutter-review/reference.md",
          "type": "blob",
          "size": 37634
        },
        {
          "path": "plugins/flutter-tools/skills/flutter-review/workflow.md",
          "type": "blob",
          "size": 7225
        },
        {
          "path": "plugins/plugin-development",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 587
        },
        {
          "path": "plugins/plugin-development/README.md",
          "type": "blob",
          "size": 11451
        },
        {
          "path": "plugins/plugin-development/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/agents/plugin-reviewer.md",
          "type": "blob",
          "size": 9606
        },
        {
          "path": "plugins/plugin-development/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/commands/add-agent.md",
          "type": "blob",
          "size": 18286
        },
        {
          "path": "plugins/plugin-development/commands/add-command.md",
          "type": "blob",
          "size": 11685
        },
        {
          "path": "plugins/plugin-development/commands/add-hook.md",
          "type": "blob",
          "size": 13508
        },
        {
          "path": "plugins/plugin-development/commands/add-skill.md",
          "type": "blob",
          "size": 12456
        },
        {
          "path": "plugins/plugin-development/commands/init.md",
          "type": "blob",
          "size": 3080
        },
        {
          "path": "plugins/plugin-development/commands/test-local.md",
          "type": "blob",
          "size": 9016
        },
        {
          "path": "plugins/plugin-development/commands/validate.md",
          "type": "blob",
          "size": 8477
        },
        {
          "path": "plugins/plugin-development/hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/hooks/hooks.json",
          "type": "blob",
          "size": 903
        },
        {
          "path": "plugins/plugin-development/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/SKILL.md",
          "type": "blob",
          "size": 6736
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/best-practices",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/best-practices/common-mistakes.md",
          "type": "blob",
          "size": 6780
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/best-practices/naming-conventions.md",
          "type": "blob",
          "size": 8389
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/best-practices/organization.md",
          "type": "blob",
          "size": 9247
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/examples",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/examples/simple-plugin.md",
          "type": "blob",
          "size": 2868
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/examples/testing-workflow.md",
          "type": "blob",
          "size": 4859
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/schemas",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/schemas/hooks-schema.md",
          "type": "blob",
          "size": 13119
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/schemas/marketplace-schema.md",
          "type": "blob",
          "size": 10309
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/schemas/plugin-manifest.md",
          "type": "blob",
          "size": 9794
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/templates",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/templates/agent-template.md",
          "type": "blob",
          "size": 1369
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/templates/command-template.md",
          "type": "blob",
          "size": 599
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/templates/skill-template.md",
          "type": "blob",
          "size": 1726
        },
        {
          "path": "plugins/plugin-development/skills/plugin-authoring/testing-plugin-authoring.md",
          "type": "blob",
          "size": 6074
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"LucasXu0-flutter-tools\",\n  \"owner\": {\n    \"name\": \"Lucas Xu\",\n    \"url\": \"https://github.com/LucasXu0\"\n  },\n  \"metadata\": {\n    \"description\": \"Flutter/Dart code quality tools for Claude Code\",\n    \"version\": \"2.2.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"flutter-tools\",\n      \"description\": \"Comprehensive Flutter/Dart code quality tools including intelligent code review and automated formatting\",\n      \"version\": \"2.2.0\",\n      \"author\": {\n        \"name\": \"Lucas Xu\"\n      },\n      \"source\": \"./plugins/flutter-tools\",\n      \"category\": \"developer-tools\",\n      \"tags\": [\"flutter\", \"dart\", \"code-review\", \"formatting\", \"quality\"]\n    },\n    {\n      \"name\": \"plugin-development\",\n      \"description\": \"Assist with Claude Code plugin development: scaffold, validate, review, and team-ready distribution\",\n      \"version\": \"1.3.0\",\n      \"author\": {\n        \"name\": \"Ivan Magda\"\n      },\n      \"source\": \"./plugins/plugin-development\",\n      \"category\": \"developer-tools\",\n      \"tags\": [\"development\", \"plugins\", \"scaffold\", \"validation\", \"tools\"]\n    }\n  ]\n}\n",
        "plugins/flutter-tools/.claude-plugin/plugin.json": "{\n  \"name\": \"flutter-tools\",\n  \"description\": \"Comprehensive Flutter/Dart code quality tools including intelligent code review and automated formatting\",\n  \"version\": \"2.2.1\",\n  \"author\": {\n    \"name\": \"Lucas Xu\",\n    \"url\": \"https://github.com/LucasXu0\"\n  },\n  \"homepage\": \"https://github.com/LucasXu0/claude-code-plugin\",\n  \"repository\": \"https://github.com/LucasXu0/claude-code-plugin\",\n  \"license\": \"MIT\",\n  \"keywords\": [\n    \"flutter\",\n    \"dart\",\n    \"code-review\",\n    \"formatting\",\n    \"quality\"\n  ]\n}",
        "plugins/flutter-tools/README.md": "# Flutter Skills - Claude Code Plugin\n\nComprehensive Flutter/Dart code quality tools for Claude Code, featuring intelligent code review and automated formatting.\n\n## Features\n\n### Agents\n\n| Name | Description |\n|------|-------------|\n| flutter-review | Analyzes Flutter code changes with priority-based detection (P0 critical bugs, P1 important issues, P2 code quality) and generates review reports with fix suggestions |\n\n### Skills\n\n| Name | Description |\n|------|-------------|\n| flutter-review | Domain expertise for Flutter/Dart code review including null safety, lifecycle issues, memory leaks, Bloc/Provider patterns, and code complexity checks |\n| flutter-format | Automated workflow for running flutter analyze, applying dart fix, formatting code, and verifying no new errors are introduced |\n\n### Commands\n\n| Command | Description |\n|---------|-------------|\n| /flutter-tools:flutter-review | Triggers comprehensive code review of Flutter changes with prioritized report |\n| /flutter-tools:flutter-format | Runs complete formatting and cleanup workflow for Flutter projects |\n\n## Installation\n\n### Method 1: Via Marketplace (Recommended)\n\n```bash\n# Add the marketplace from GitHub\n/plugin marketplace add LucasXu0/claude-code-plugin\n\n# Install the plugin\n/plugin install flutter-tools@LucasXu0-flutter-tools\n```\n\n### Method 2: Manual Installation\n\n```bash\n# Clone and load directly\ngit clone https://github.com/LucasXu0/claude-code-plugin.git\ncd claude-code-plugin\nclaude --plugin-dir ./plugins/flutter-tools\n```\n\n## Usage\n\n### Flutter Code Review\n\n**Slash command:**\n```\n/flutter-tools:flutter-review\n```\n\n**Natural language:**\n```\nReview my Flutter code\nCheck for bugs in my changes\nIs this code ready to merge?\n```\n\n**Example output:**\n```markdown\n‚úÖ Review complete! Results saved to:\n   /tmp/flutter_review/20260104_1430-my_app-feature_login-a3f9d2.md\n\n## Summary\n| Priority | Count | Status |\n|----------|-------|--------|\n| üö® P0 | 2 | ‚ùå Must Fix |\n| ‚ö†Ô∏è P1 | 3 | ‚ö° Recommended |\n| üí° P2 | 5 | üí¨ Optional |\n\n**Recommendation**: üü° REVIEW NEEDED\n```\n\n### Flutter Format\n\n**Slash command:**\n```\n/flutter-tools:flutter-format\n```\n\n**Natural language:**\n```\nFormat my Flutter code\nRun flutter analyze and fix issues\n```\n\n**Example output:**\n```markdown\n‚úÖ Flutter Format Complete\n\n**Changes Made:**\n- Applied dart fix: 12 issues fixed\n- Formatted: 45 files changed\n- Final analysis: 0 errors, 0 warnings\n```\n\n## What Gets Checked\n\n### P0 - Critical\n- Null safety violations (force unwraps, unsafe casts)\n- Lifecycle issues (setState without mounted checks)\n- Memory leaks (undisposed controllers, subscriptions, listeners)\n- Logic errors (incorrect conditions, missing error handling)\n\n### P1 - Important\n- Collection equality bugs (== on List/Map/Set)\n- Bloc anti-patterns (public fields/methods, mutable events)\n- Provider anti-patterns (context.read in build, missing disposal)\n- Code complexity (deep nesting, long methods/classes)\n\n### P2 - Code Quality\n- Magic numbers without constants\n- TODO/FIXME comments\n- Long classes (>500 lines)\n\n## Resources\n\n- [Claude Code Plugins](https://code.claude.com/docs/en/plugins)\n- [Flutter Best Practices](https://flutter.dev/docs/development/best-practices)\n- [Dart Style Guide](https://dart.dev/guides/language/effective-dart/style)\n- [Detailed Examples](skills/flutter-review/examples.md)\n- [Check Reference](skills/flutter-review/reference.md)\n\n## Support\n\n- **Issues**: [GitHub Issues](https://github.com/LucasXu0/flutter_skills/issues)\n- **Changelog**: [CHANGELOG.md](CHANGELOG.md)\n\n## License\n\nMIT License - Created by [Lucas Xu](https://github.com/LucasXu0)\n",
        "plugins/flutter-tools/agents/flutter-code-reviewer.md": "---\nname: flutter-code-reviewer\ndescription: \"Use this agent when the user has written or modified Flutter/Dart code and needs it reviewed for quality, best practices, and potential issues. Trigger this agent proactively after significant code changes such as:\\\\n\\\\n<example>\\\\nContext: User has just implemented a new StatefulWidget with state management.\\\\nuser: \\\"I've added a new screen for user profile management with provider state\\\"\\\\nassistant: \\\"Let me use the Task tool to launch the flutter-code-reviewer agent to review this implementation for best practices and potential issues.\\\"\\\\n<commentary>Since significant Flutter code was written involving state management, proactively use the flutter-code-reviewer agent to ensure quality and adherence to Flutter best practices.</commentary>\\\\n</example>\\\\n\\\\n<example>\\\\nContext: User has refactored widget tree structure.\\\\nuser: \\\"I've restructured the home screen widgets to improve performance\\\"\\\\nassistant: \\\"I'll use the flutter-code-reviewer agent to analyze the refactoring and ensure it follows Flutter performance best practices.\\\"\\\\n<commentary>Widget restructuring is a critical change that should be reviewed for performance implications and proper Flutter patterns.</commentary>\\\\n</example>\\\\n\\\\n<example>\\\\nContext: User asks directly for code review.\\\\nuser: \\\"Can you review my recent Flutter changes?\\\"\\\\nassistant: \\\"I'll launch the flutter-code-reviewer agent to perform a comprehensive review of your recent Flutter code changes.\\\"\\\\n<commentary>Direct request for review - use the agent to provide thorough analysis.</commentary>\\\\n</example>\"\nmodel: sonnet\nskills: flutter-review\n---\n\nYou are an elite Flutter/Dart code reviewer with deep expertise in mobile application development, Flutter framework internals, Dart language best practices, and modern app architecture patterns. Your mission is to provide thorough, constructive code reviews that elevate code quality while teaching developers Flutter best practices.\n\n## Flutter Review Skill\n\nThe `flutter-review` skill is automatically loaded and provides:\n- Priority-based check definitions (P0/P1/P2) in SKILL.md\n- 5-step execution workflow in workflow.md\n- Detailed reference documentation in reference.md\n- Comprehensive code examples in examples.md\n\nFollow the workflow from the skill to conduct systematic code reviews.\n\n## Your Responsibilities\n\n1. **Execute the workflow** from the flutter-review skill step-by-step\n2. **Apply priority-based checks** (P0 ‚Üí P1 ‚Üí P2) to identify issues\n3. **Generate comprehensive reports** with clear recommendations\n4. **Interact with users** to clarify requirements and offer automated fixes\n5. **Provide educational feedback** explaining the \"why\" behind each issue\n\n## Key Principles\n\n- **Efficiency First**: Use git diff analysis and selective file reading (see workflow.md Step 3)\n- **Priority-Driven**: Focus on P0 issues first, then P1, then P2\n- **Context-Aware**: Understand file types (Widget, BLoC, Provider, Service) to apply relevant checks\n- **Dependency-Smart**: Enable Bloc/Provider checks only when dependencies detected\n- **Actionable Feedback**: Every issue needs file:line, problem, current code, fixed code, and benefit\n- **Educational**: Explain the \"why\" behind each issue using reference.md\n\n## Output Format (from workflow.md Step 5)\n\nSave results to `/tmp/flutter_review/{timestamp}-{repo}-{branch}-{id}.md` with:\n\n- Summary table (P0/P1/P2 counts and status)\n- Recommendation (üî¥ BLOCK / üü° REVIEW NEEDED / üü¢ APPROVED)\n- Issues organized by priority with file:line references\n- Clear next steps\n- Offer to fix issues automatically if P0 or P1 exist\n\n## Critical Reminders\n\n- **ALWAYS follow workflow.md** - don't skip steps\n- **Check ALL resources for disposal** - controllers, streams, subscriptions, timers\n- **Verify mounted before setState** in async callbacks\n- **Flag force unwrap (!)** unless after explicit type check\n- **Use the recommendation guidelines** from workflow.md to determine üî¥/üü°/üü¢\n- **Ask user if they want fixes** when P0 or P1 issues found\n\n## Self-Check Before Finalizing\n\n- Did I follow the 5-step workflow from workflow.md?\n- Did I apply checks from SKILL.md based on priority?\n- Are all issues documented with file:line, code snippets, and fixes?\n- Did I use the correct output format from workflow.md?\n- Did I offer to fix issues automatically?\n- Is my recommendation (üî¥/üü°/üü¢) correct per guidelines?\n\nYour goal is to leverage the comprehensive flutter-review skill to catch critical bugs, enforce best practices, and help developers write production-ready Flutter code.\n",
        "plugins/flutter-tools/commands/flutter-format.md": "---\ndescription: Run Flutter code formatting and analysis workflow (analyze, fix, format)\n---\n\n# Flutter Format Command\n\n**IMPORTANT: You MUST use the flutter-format skill for this task.**\n\nApply the flutter-format skill to run automated Flutter/Dart code formatting and cleanup workflow.\n\nThe skill contains all the instructions for the complete workflow.\n",
        "plugins/flutter-tools/commands/flutter-review.md": "---\ndescription: Perform comprehensive Flutter code review with priority-based analysis (P0/P1/P2)\n---\n\n# Flutter Code Review Command\n\n**IMPORTANT: You MUST use the flutter-review skill for this task.**\n\nApply the flutter-review skill to perform comprehensive Flutter/Dart code review with priority-based analysis.\n\nThe skill contains:\n- Priority-based check definitions (P0/P1/P2)\n- 6-step execution workflow\n- Detailed explanations and code examples\n\nFollow the workflow in skills/flutter-review/workflow.md to execute the review.\n",
        "plugins/flutter-tools/skills/flutter-format/SKILL.md": "---\nname: flutter-format\ndescription: Knowledge about Flutter/Dart code formatting, analysis tools (flutter analyze, dart fix, dart format), and when to apply them. Use when formatting code, fixing lint issues, running code cleanup, or when user mentions format, analyze, lint, or cleanup in Flutter context.\n---\n\n# Flutter Format\n\nExpert knowledge about Flutter/Dart code formatting and analysis tools.\n\n## Core Tools\n\n### flutter analyze\n**Purpose**: Static analysis to find errors, warnings, and lint suggestions\n\n**What it checks:**\n- Syntax errors\n- Type errors\n- Unused imports and variables\n- Lint rules from analysis_options.yaml\n- Potential bugs and anti-patterns\n\n**When to use:**\n- Before applying fixes (to identify issues)\n- After formatting (to verify no new issues)\n- As pre-commit validation\n\n**Output interpretation:**\n- **Errors**: Must fix (compilation failures)\n- **Warnings**: Should fix (potential bugs)\n- **Info**: Optional improvements (style suggestions)\n\n### dart fix --apply\n**Purpose**: Automatically fix lint issues and apply Dart language updates\n\n**What it fixes:**\n- Deprecated API usage\n- Lint violations with automated fixes\n- Code modernization (e.g., null safety migration patterns)\n\n**When to use:**\n- After flutter analyze identifies fixable issues\n- Before formatting (fixes may affect structure)\n- When migrating Dart versions\n\n**Safety considerations:**\n- **Safe**: Lint fixes, deprecated API updates\n- **Review needed**: Major refactorings, null safety changes\n- **Skip if**: Syntax errors present, uncommitted important changes\n\n**Always show changes to user** with git diff before proceeding.\n\n### dart format\n**Purpose**: Consistent code formatting following Dart style guide\n\n**What it formats:**\n- Indentation (2 spaces)\n- Line length (default 80 characters)\n- Bracket placement\n- Whitespace and newlines\n\n**What it doesn't change:**\n- Code logic\n- Import order (use IDE or separate tool)\n- Comments content\n\n**When to use:**\n- After code changes\n- After dart fix --apply\n- Before commits\n\n**Options:**\n- . - Format entire project\n- lib test - Format specific directories\n- --line-length=120 - Custom line length (if needed)\n\n## Best Practices\n\n### Recommended Workflow\n\n**Standard sequence:**\n```\nflutter analyze ‚Üí dart fix --apply ‚Üí dart format ‚Üí flutter analyze\n```\n\n**Why this order:**\n1. **Analyze first**: Identify issues\n2. **Fix**: Auto-fix what's possible\n3. **Format**: Apply consistent style\n4. **Re-analyze**: Verify no new issues\n\n### Edge Cases\n\n**Generated Code**\n- Files: *.g.dart, *.freezed.dart, *.gr.dart\n- Action: Exclude from formatting\n- Reason: Regenerated on build, formatting changes lost\n- How: Use dart format lib test instead of dart format .\n\n**Vendor/Third-Party Code**\n- Directories: packages/, vendor/, .pub-cache/\n- Action: Don't format\n- Reason: Not your code, may break signatures\n- How: Target specific directories\n\n**Monorepos**\n- Context: Multiple projects in one repository\n- Action: Format only relevant project\n- Reason: May affect other teams' code\n- How: cd project_name && dart format lib test\n\n**Build Runner Integration**\n- When: Project uses build_runner for code generation\n- Action: Run build after fixing/formatting if generated files changed\n- Command: flutter pub run build_runner build --delete-conflicting-outputs\n\n**Syntax Errors**\n- Issue: dart format fails on unparseable code\n- Action: Fix syntax errors first, then format\n- Detection: flutter analyze shows errors\n\n### Analysis Options\n\n**Custom Lint Rules** (analysis_options.yaml)\n- Location: Project root\n- Purpose: Project-specific lint rules\n- Respect user's choices - don't suggest disabling their rules\n- Add exceptions only if user requests\n\n**Example:**\n```yaml\nlinter:\n  rules:\n    prefer_const_constructors: true\n    avoid_print: true\n```\n\n### Output Reporting\n\n**What to show user:**\n- Number of issues fixed by dart fix\n- Number of files formatted\n- Final analysis status (errors/warnings count)\n- List of modified files (or summary if >10)\n\n**Helpful next steps:**\n- How to review changes: git diff\n- How to commit: git add . && git commit -m \"chore: format code\"\n\n## Error Handling\n\n### Common Failures\n\n**flutter analyze fails:**\n- **Cause**: Not in Flutter project, SDK not installed, corrupt dependencies\n- **Solution**: Run flutter pub get to refresh dependencies\n\n**dart fix --apply fails:**\n- **Cause**: Syntax errors, conflicting fixes\n- **Solution**: Fix syntax errors first, or skip and proceed with format only\n\n**dart format fails:**\n- **Cause**: Syntax errors (rare)\n- **Solution**: Identify problematic file, fix syntax, or skip that file\n\n**Permission errors:**\n- **Cause**: File permissions, read-only files\n- **Solution**: Check file permissions, may need user intervention\n\n## Integration Patterns\n\n### With Version Control\n\n**Pre-commit:**\n- Format staged files: git diff --name-only --cached '*.dart' | xargs dart format\n- Verify: dart format --set-exit-if-changed . (fails if formatting needed)\n\n**In CI/CD:**\n- Check formatting: dart format --set-exit-if-changed .\n- Run analysis: flutter analyze --no-fatal-warnings\n\n### With IDEs\n\n**Note**: This skill complements IDE formatting by:\n- Ensuring all files formatted (IDE may only format open files)\n- Running full analysis workflow\n- Providing team-wide consistency\n\n## Decision Guidelines\n\n**When user says \"format my code\":**\n- Run full workflow (analyze ‚Üí fix ‚Üí format ‚Üí verify)\n- Default to formatting entire project\n- Exclude generated files automatically\n\n**When user says \"just format, don't fix\":**\n- Skip dart fix --apply\n- Run only dart format\n- Still verify with flutter analyze after\n\n**When in doubt:**\n- Ask user before applying risky fixes\n- Show changes before proceeding\n- Respect project's analysis_options.yaml\n\n## Quick Reference\n\n```bash\n# Full workflow\nflutter analyze && dart fix --apply && dart format . && flutter analyze\n\n# Format only (skip fixes)\ndart format .\n\n# Format specific directories\ndart format lib test\n\n# Exclude generated files\ndart format lib --exclude '**.g.dart'\n\n# Check formatting (CI/CD)\ndart format --set-exit-if-changed .\n\n# Custom line length\ndart format --line-length=120 .\n```\n\n## Key Principles\n\n1. **Analyze before and after** - Catch issues early and verify fixes\n2. **Show changes** - User should review before committing\n3. **Respect configuration** - Use project's analysis_options.yaml\n4. **Handle edge cases** - Generated code, vendor code, monorepos\n5. **Report clearly** - Summarize what changed and next steps\n\n",
        "plugins/flutter-tools/skills/flutter-review/SKILL.md": "---\nname: flutter-review\ndescription: Expert knowledge for reviewing Flutter/Dart code including critical bugs, memory leaks, null safety violations, lifecycle issues, Bloc/Provider anti-patterns, collection equality, and code quality patterns. Use when reviewing code, checking PRs, analyzing code quality, or when user mentions bugs, issues, memory leaks, null safety, lifecycle, state management, or code review in Flutter context.\ninvocable: true\n---\n\n# Flutter Code Review\n\n**This skill is directly invocable. See [workflow.md](workflow.md) for the complete 5-step execution strategy.**\n\nExpert knowledge for identifying critical bugs, anti-patterns, and code quality issues in Flutter/Dart code.\n\n## Execution Instructions\n\nWhen invoked directly (e.g., via /flutter-review command):\n\n1. Follow the 5-step workflow in [workflow.md](workflow.md)\n2. Apply the priority-based checks defined below\n3. Generate a comprehensive review report\n4. Offer to automatically fix issues found\n\n## Priority-Based Analysis\n\n### P0 - Critical (Must Fix Before Merge)\n\nIssues that cause crashes, data loss, security vulnerabilities, or visual bugs.\n\n#### Null Safety Violations\n\n**Force Unwrap Without Checks** (variable!, expression!.property)\n\n- Risk: Runtime crash with \"Null check operator used on a null value\"\n- Fix: Extract nullable values to local variables, check for null, then use non-null variable\n- **Preferred Pattern:** Extract property to local variable ‚Üí check null ‚Üí use promoted non-null variable\n- **Avoid:** Checking widget.property == null then using widget.property with ! operator\n- ‚Üí Details: reference.md#avoid_non_null_assertion\n\n**Unsafe Nullable Access**\n\n- Risk: Null pointer exceptions when accessing properties without checks\n- Fix: Add null checks before property access\n- ‚Üí Details: reference.md#missing_null_safety\n\n**Unsafe Type Casts** (value as Type)\n\n- Risk: Type cast errors at runtime\n- Fix: Use pattern matching or check with is operator first\n- ‚Üí Details: reference.md#unsafe_type_casts\n\n#### Flutter Lifecycle Issues\n\n**setState Without Mounted Check**\n\n- Risk: setState() called after dispose() crashes app\n- Fix: Add if (!mounted) return; before setState in async callbacks\n- ‚Üí Details: reference.md#avoid_mounted_in_setstate\n\n**State Modifications After Disposal**\n\n- Risk: Memory leaks and unexpected behavior\n- Fix: Check mounted or cancel operations in dispose\n- ‚Üí Details: reference.md#state_after_disposal\n\n#### Memory Leaks\n\n**Resources That Must Be Disposed:**\nTextEditingController, AnimationController, ScrollController, TabController, PageController, FocusNode, StreamSubscription, Timer, any class with addListener() called\n\n**Detection:** Check if controllers/subscriptions created in fields or initState have corresponding dispose() calls. Verify ALL resources disposed, not just presence of dispose method.\n\n- ‚Üí Details: reference.md#dispose_class_fields\n\n#### Logic Errors\n\n**Incorrect Conditional Logic**\n\n- || vs && confusion, missing null checks in compounds, negation errors\n- ‚Üí Details: reference.md#logic_errors_conditionals\n\n**Missing Error Handling**\n\n- API calls, file operations, JSON parsing without try-catch\n- ‚Üí Details: reference.md#missing_error_handling\n\n**Infinite Loops**\n\n- Loops without termination or where condition never changes\n- ‚Üí Details: reference.md#infinite_loops\n\n**Race Conditions**\n\n- Multiple async operations modifying same state without guards\n- ‚Üí Details: reference.md#race_conditions\n\n#### Bloc State Synchronization Issues\n\n**Only check when flutter_bloc or bloc in dependencies.**\n\n**BlocListener/BlocConsumer Missing Initial State**\n\n- Risk: Widget state (TextEditingController, variables) not initialized from bloc's initial state\n- Problem: Listener callbacks only fire on state changes, not initial state. If bloc emits state before widget creation, initial state is missed\n- Fix: Initialize widget state in initState() from current bloc state, AND have listener for updates\n- ‚Üí Details: reference.md#bloc_missing_initial_state\n\n#### Text Overflow in Flex Layouts\n\n**Text Without Constraints in Row/Column**\n\n- Risk: RenderFlex overflow errors, visual bugs, unusable UI\n- Fix: Wrap Text in Flexible/Expanded widget AND/OR add overflow handling (TextOverflow.ellipsis)\n- ‚Üí Details: reference.md#text_overflow_flex\n\n---\n\n### P1 - Important (Should Fix)\n\nIssues causing logic bugs and maintainability problems.\n\n#### Collection Equality\n\n**Using == on Collections** (list1 == list2, map1 == map2)\n\n- Problem: Dart uses reference equality, always false for different instances\n- Fix: Use package:collection - ListEquality().equals(), MapEquality().equals(), or DeepCollectionEquality().equals()\n- Exception: const collections (same instance)\n- ‚Üí Details: reference.md#avoid_collection_equality_checks\n\n#### Code Complexity\n\n**Deep Nesting** (>4 levels)\n\n- Problem: Reduces readability, increases cognitive load\n- Fix: Extract methods, use early returns, guard clauses\n- ‚Üí Details: reference.md#deep_nesting\n\n**Long Methods** (>100 lines)\n\n- Problem: Violates Single Responsibility Principle\n- Fix: Break into smaller focused methods\n- ‚Üí Details: reference.md#long_methods\n\n**Long Build Methods** (>50 lines)\n\n- Problem: Too much UI logic in build method, hard to maintain\n- Fix: Extract to buildWidget helpers (buildHeader, buildBody) or create separate widget files\n- ‚Üí Details: reference.md#long_build_methods\n\n#### Widget Organization\n\n**Multiple Widget Definitions Per File**\n\n- Problem: Reduces code organization, testability, and reusability\n- Fix: Each widget class must be in its own file (e.g., UserCard in user_card.dart)\n- **No exceptions**: Even private (`_Widget`) or small helper widgets should be extracted\n- ‚Üí Details: reference.md#multiple_widgets_per_file\n\n#### Late Modifier Usage\n\n**Avoid Late Keyword**\n\n- Risk: Defers initialization to runtime, can cause LateInitializationError\n- Fix: Initialize in constructor, use nullable types, or required parameters\n- Exception: DI frameworks with guaranteed initialization\n- ‚Üí Details: reference.md#avoid_late_keyword\n\n#### Bloc Anti-Patterns\n\n**Only check when flutter_bloc or bloc in dependencies.**\n\n**Public Fields in BLoC**\n\n- Problem: Breaks encapsulation, allows external state modification\n- Fix: Make fields private, expose through state\n- ‚Üí Details: reference.md#bloc_public_fields\n\n**Public Methods in BLoC**\n\n- Problem: BLoCs should only respond to events\n- Fix: Create events and use add() instead\n- ‚Üí Details: reference.md#bloc_public_methods\n\n**Mutable Events**\n\n- Problem: Events should be immutable data\n- Fix: Add @immutable, make fields final, use const constructors\n- ‚Üí Details: reference.md#bloc_mutable_events\n\n**Non-Sealed States**\n\n- Problem: Can't exhaustively pattern match\n- Fix: Use sealed class for state base, final class for implementations\n- ‚Üí Details: reference.md#bloc_non_sealed_states\n\n#### Provider Anti-Patterns\n\n**Only check when provider in dependencies.**\n\n**context.read() in Build**\n\n- Problem: Won't rebuild when provider changes\n- Fix: Use context.watch() for reactive data\n- ‚Üí Details: reference.md#provider_read_in_build\n\n**Old Provider Syntax** (Provider.of<Type>(context, listen: true))\n\n- Problem: Outdated, less readable\n- Fix: Use context.watch() or context.read()\n- ‚Üí Details: reference.md#provider_old_syntax\n\n**Missing Disposal in ChangeNotifier**\n\n- Problem: Memory leaks from undisposed resources\n- Fix: Override dispose() and clean up all resources\n- ‚Üí Details: reference.md#provider_missing_disposal\n\n#### Logic Issues\n\n**Incorrect Operators**\n\n- Using = instead of == in conditions, comparing incompatible types\n- ‚Üí Details: reference.md#incorrect_operators\n\n**Missing Edge Cases**\n\n- No empty collection checks before .first/.last, no bounds checking\n- ‚Üí Details: reference.md#missing_edge_cases\n\n**Off-By-One Errors**\n\n- Loop conditions with <= instead of < for length\n- ‚Üí Details: reference.md#off_by_one_errors\n\n---\n\n### P2 - Code Quality (Nice to Have)\n\nImprovements for maintainability.\n\n#### Magic Numbers\n\n**Hardcoded Numbers Without Context**\n\n- Exceptions: 0, 1, -1, obvious widget dimensions (padding: 16)\n- Fix: Define as named constants\n- ‚Üí Details: reference.md#magic_numbers\n\n#### TODO/FIXME Comments\n\n**Markers for Incomplete Work**\n\n- Patterns: // TODO:, // FIXME:, // HACK:\n- Action: Track and address before merge\n- ‚Üí Details: reference.md#todo_comments\n\n#### Function Ordering\n\n**Private Functions After Public Functions**\n\n- Problem: Private functions placed before public ones reduces readability and makes it harder to understand the public API\n- Fix: Move all private methods (starting with _) after public methods\n- Widget-specific order: initState ‚Üí other lifecycle methods ‚Üí dispose ‚Üí build ‚Üí public methods ‚Üí private methods\n- ‚Üí Details: reference.md#function_ordering\n\n#### Long Classes (>500 lines)\n\n**Classes Exceeding 500 Lines**\n\n- Problem: Violates Single Responsibility, may contain dead code\n- Fix: Split into multiple classes, extract to mixins/utilities\n- Action: Review for unused methods, commented code, duplicate logic\n- ‚Üí Details: reference.md#long_classes\n\n#### Moderate Nesting (3-4 levels)\n\n**Nesting Depth 3-4**\n\n- Consider simplification for readability\n- ‚Üí Details: reference.md#moderate_nesting\n\n---\n\n## Dependency-Specific Knowledge\n\n### Bloc Pattern Detection\n\n**Trigger:** flutter_bloc or bloc in pubspec.yaml\n\n**Key Principles:**\n\n- State is immutable and sealed\n- Events are immutable\n- No public methods (only event handlers)\n- No public fields (only private state)\n- UI never contains business logic\n\n‚Üí See reference.md#bloc_pattern for state/event patterns\n\n### Provider Pattern Detection\n\n**Trigger:** provider in pubspec.yaml\n\n**Key Principles:**\n\n- Use context.watch() for reactive rebuilds\n- Use context.read() only for one-time reads (not in build)\n- Use context.select() for performance optimization\n- Always dispose resources in ChangeNotifier\n\n‚Üí See reference.md#provider_pattern for usage patterns\n\n---\n\n## Context Awareness\n\n### When NOT to Flag\n\n**Test Files:**\n\n- More lenient with force unwraps in test setup\n- Focus on logic errors, not style\n\n**Generated Code:**\n\n- Files matching _.g.dart, _.freezed.dart, \\*.gr.dart\n- Skip entirely - will be regenerated\n\n**Intentional Patterns:**\n\n- Type check before cast (e.g., `if (x is String) { x.length; }`)\n- Controlled environments after validation (e.g., validated user input)\n\n**Note:** Even with null check immediately before force unwrap, prefer extracting to local variable for type promotion instead of using the ! operator.\n\n### When TO Flag Even If...\n\n**Pattern is common:**\n\n- Common doesn't mean correct\n- Flag reference equality on collections even if widespread\n\n**\"It works\":**\n\n- Working code can still have bugs\n- Flag potential issues even if not currently crashing\n\n**Dispose exists but incomplete:**\n\n- If new controllers added but not in dispose\n- Check ALL resources, not just presence of dispose method\n\n**Widget is private or small:**\n\n- Flag ALL widget definitions in same file (except StatefulWidget's State class)\n- Private (`_Widget`) does not exempt from one-widget-per-file rule\n- \"Small\" size does not exempt from one-widget-per-file rule\n- Every widget class deserves its own file for testability and organization\n\n---\n\n## Review Output Format\n\n### Report Structure\n\n**Summary:**\n\n- Count by priority (P0: X, P1: Y, P2: Z)\n- Clear status (Pass / Must Fix / Recommended)\n- Overall recommendation (üî¥ BLOCK / üü° REVIEW NEEDED / üü¢ APPROVED)\n\n**Issue Format:**\n\n- File path:line_number\n- Issue type and priority\n- Problem explanation\n- Current code snippet (with context)\n- Fixed code snippet\n- Benefit of fix\n\n**Organization:**\n\n- P0 first (most critical)\n- Within priority, group by type\n- Use tables for many similar issues (>3)\n- Detailed format for complex issues\n\n### Recommendation Guidelines\n\nüî¥ **BLOCK** - Any P0 issues present (must fix before merge)\nüü° **REVIEW NEEDED** - No P0, but P1 issues present (should fix)\nüü¢ **APPROVED** - No P0 or P1, only P2 optional improvements\n\n---\n\n## Analysis Efficiency\n\n**Focus on Changed Code:**\n\n- Analyze additions and modifications (+ in diff)\n- Use surrounding context from diff\n- Don't review entire codebase\n\n**Selective Deep Dives:**\nRead full files only when:\n\n- Diff context insufficient\n- Need to verify disposal (new controllers/streams added)\n- Need class structure or imports\n\n**File Type Guides Analysis:**\n\n- Widgets: Lifecycle, mounted, dispose\n- BLoCs: Encapsulation, events, states\n- Providers: Disposal, context usage\n- Models: Immutability, equality\n- Services: Error handling, async patterns\n\n---\n\n## Key Principles\n\n1. **Safety First** - P0 issues can crash apps, prioritize these\n2. **Be Specific** - Always provide file:line, code snippets, fixes\n3. **Avoid False Positives** - When uncertain, don't flag or mark P2\n4. **Context Matters** - Understand intent before flagging\n5. **Actionable Feedback** - Every issue needs clear, copy-paste ready fix\n6. **Respect Patterns** - Understand project architecture before suggesting changes\n\n---\n\n## Additional Resources\n\nFor detailed explanations of each check, see [reference.md](reference.md).\n\nFor code examples showing good vs bad patterns, see [examples.md](examples.md).\n",
        "plugins/flutter-tools/skills/flutter-review/examples.md": "# Flutter Review - Code Examples\n\nThis document provides concrete code examples for each check, showing both problematic and correct patterns.\n\n## P0 Examples (Critical)\n\n### 1. avoid_non_null_assertion\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: Force unwrap without check\nclass UserProfile extends StatelessWidget {\n  final User? user;\n\n  @override\n  Widget build(BuildContext context) {\n    return Text(user!.name); // Crash if user is null\n  }\n}\n\n// Example 2: Chained force unwraps\nfinal email = getUserById(id)!.profile!.email!; // Multiple crash points\n\n// Example 3: Force unwrap in async callback\nFuture<void> loadData() async {\n  final data = await fetchData();\n  processData(data!.items); // data might be null\n}\n\n// Example 4: Checking widget property then force unwrapping\nvoid _loadUserData() async {\n  if (widget.userId == null) {\n    return;\n  }\n\n  final user = await userRepository.getUser(widget.userId!); // Still uses force unwrap\n  setState(() {\n    _userData = user;\n  });\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Null-aware operator\nclass UserProfile extends StatelessWidget {\n  final User? user;\n\n  @override\n  Widget build(BuildContext context) {\n    return Text(user?.name ?? 'Guest');\n  }\n}\n\n// Example 2: Pattern matching\nfinal email = switch (getUserById(id)) {\n  User user => user.profile?.email ?? 'No email',\n  null => 'No user',\n};\n\n// Example 3: Explicit null check before use\nFuture<void> loadData() async {\n  final data = await fetchData();\n  if (data == null) return;\n  processData(data.items);\n}\n\n// Example 4: Acceptable use after type check\nObject? value = getValue();\nif (value is String) {\n  print(value.length); // Safe, type checked\n}\n\n// Example 5: Extract to local variables first\nvoid _loadUserData() async {\n  final userId = widget.userId;\n\n  if (userId == null) {\n    return;\n  }\n\n  // userId is now non-null, no ! needed\n  final user = await userRepository.getUser(userId);\n  setState(() {\n    _userData = user;\n  });\n}\n\n// Example 6: Multiple property checks\nvoid _navigateToProfile() {\n  final userId = widget.userId;\n  final userName = widget.userName;\n\n  if (userId == null || userName == null) {\n    return;\n  }\n\n  // All variables promoted to non-null\n  Navigator.push(\n    context,\n    MaterialPageRoute(\n      builder: (context) => ProfilePage(\n        userId: userId,\n        userName: userName,\n      ),\n    ),\n  );\n}\n```\n\n---\n\n### 2. avoid_mounted_in_setstate\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: setState after async without mounted check\nclass MyWidget extends StatefulWidget {\n  @override\n  State<MyWidget> createState() => _MyWidgetState();\n}\n\nclass _MyWidgetState extends State<MyWidget> {\n  String _data = '';\n\n  @override\n  void initState() {\n    super.initState();\n    loadData();\n  }\n\n  Future<void> loadData() async {\n    final data = await api.fetchData();\n    setState(() {\n      _data = data; // Crash if widget disposed during fetch\n    });\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Text(_data);\n  }\n}\n\n// Example 2: Multiple async operations\nFuture<void> processData() async {\n  await step1();\n  setState(() => _step1Complete = true); // Might be unmounted\n\n  await step2();\n  setState(() => _step2Complete = true); // Might be unmounted\n}\n\n// Example 3: Timer callback\nvoid startTimer() {\n  Timer(Duration(seconds: 5), () {\n    setState(() {\n      _timerComplete = true; // Widget might be disposed\n    });\n  });\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Check mounted before setState\nFuture<void> loadData() async {\n  final data = await api.fetchData();\n  if (!mounted) return;\n  setState(() {\n    _data = data;\n  });\n}\n\n// Example 2: Multiple checks in chain\nFuture<void> processData() async {\n  await step1();\n  if (!mounted) return;\n  setState(() => _step1Complete = true);\n\n  await step2();\n  if (!mounted) return;\n  setState(() => _step2Complete = true);\n}\n\n// Example 3: Cancel timer in dispose\nclass _MyWidgetState extends State<MyWidget> {\n  Timer? _timer;\n\n  void startTimer() {\n    _timer = Timer(Duration(seconds: 5), () {\n      if (!mounted) return;\n      setState(() {\n        _timerComplete = true;\n      });\n    });\n  }\n\n  @override\n  void dispose() {\n    _timer?.cancel();\n    super.dispose();\n  }\n}\n```\n\n---\n\n### 3. dispose_class_fields\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: Controller not disposed\nclass MyForm extends StatefulWidget {\n  @override\n  State<MyForm> createState() => _MyFormState();\n}\n\nclass _MyFormState extends State<MyForm> {\n  final _nameController = TextEditingController();\n  final _emailController = TextEditingController();\n\n  @override\n  Widget build(BuildContext context) {\n    return Column(\n      children: [\n        TextField(controller: _nameController),\n        TextField(controller: _emailController),\n      ],\n    );\n  }\n  // Missing dispose!\n}\n\n// Example 2: Stream subscription not cancelled\nclass DataWidget extends StatefulWidget {\n  @override\n  State<DataWidget> createState() => _DataWidgetState();\n}\n\nclass _DataWidgetState extends State<DataWidget> {\n  StreamSubscription? _subscription;\n\n  @override\n  void initState() {\n    super.initState();\n    _subscription = dataStream.listen((data) {\n      setState(() => _data = data);\n    });\n  }\n  // Missing dispose!\n}\n\n// Example 3: Multiple resources not cleaned up\nclass ComplexWidget extends StatefulWidget {\n  @override\n  State<ComplexWidget> createState() => _ComplexWidgetState();\n}\n\nclass _ComplexWidgetState extends State<ComplexWidget>\n    with SingleTickerProviderStateMixin {\n  late AnimationController _animationController;\n  final _scrollController = ScrollController();\n  final _focusNode = FocusNode();\n  StreamSubscription? _sub;\n\n  @override\n  void initState() {\n    super.initState();\n    _animationController = AnimationController(\n      vsync: this,\n      duration: Duration(seconds: 1),\n    );\n    _sub = stream.listen((_) {});\n  }\n  // Missing dispose for ALL resources!\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Proper controller disposal\nclass _MyFormState extends State<MyForm> {\n  final _nameController = TextEditingController();\n  final _emailController = TextEditingController();\n\n  @override\n  void dispose() {\n    _nameController.dispose();\n    _emailController.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Column(\n      children: [\n        TextField(controller: _nameController),\n        TextField(controller: _emailController),\n      ],\n    );\n  }\n}\n\n// Example 2: Stream subscription cancelled\nclass _DataWidgetState extends State<DataWidget> {\n  StreamSubscription? _subscription;\n\n  @override\n  void initState() {\n    super.initState();\n    _subscription = dataStream.listen((data) {\n      setState(() => _data = data);\n    });\n  }\n\n  @override\n  void dispose() {\n    _subscription?.cancel();\n    super.dispose();\n  }\n}\n\n// Example 3: All resources properly cleaned up\nclass _ComplexWidgetState extends State<ComplexWidget>\n    with SingleTickerProviderStateMixin {\n  late AnimationController _animationController;\n  final _scrollController = ScrollController();\n  final _focusNode = FocusNode();\n  StreamSubscription? _sub;\n\n  @override\n  void initState() {\n    super.initState();\n    _animationController = AnimationController(\n      vsync: this,\n      duration: Duration(seconds: 1),\n    );\n    _sub = stream.listen((_) {});\n  }\n\n  @override\n  void dispose() {\n    _animationController.dispose();\n    _scrollController.dispose();\n    _focusNode.dispose();\n    _sub?.cancel();\n    super.dispose();\n  }\n}\n```\n\n---\n\n### 4. Logic Errors\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: Incorrect boolean logic\nvoid validateUser(User? user) {\n  // BAD: OR instead of AND - always true if user != null\n  if (user != null || user.isActive) {\n    grantAccess();\n  }\n}\n\n// Example 2: Missing error handling\nFuture<void> loadUserData(String userId) async {\n  final response = await http.get(Uri.parse('$apiUrl/users/$userId'));\n  final user = User.fromJson(jsonDecode(response.body)); // Crashes on error\n  setState(() => _user = user);\n}\n\n// Example 3: Infinite loop\nvoid processQueue() {\n  while (queue.isNotEmpty) {\n    print(queue.first); // Never removes from queue!\n  }\n}\n\n// Example 4: Race condition\nclass DataScreen extends StatefulWidget {\n  @override\n  State<DataScreen> createState() => _DataScreenState();\n}\n\nclass _DataScreenState extends State<DataScreen> {\n  String _data = '';\n\n  @override\n  void initState() {\n    super.initState();\n    loadData();\n    loadData(); // Called twice, race condition!\n  }\n\n  Future<void> loadData() async {\n    final data = await fetchFromApi();\n    if (!mounted) return;\n    setState(() => _data = data); // Unpredictable which completes last\n  }\n}\n\n// Example 5: Off-by-one error\nvoid processList(List<int> items) {\n  for (int i = 0; i <= items.length; i++) { // Should be <, not <=\n    print(items[i]); // Crash on last iteration\n  }\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Correct boolean logic\nvoid validateUser(User? user) {\n  if (user != null && user.isActive) { // AND, not OR\n    grantAccess();\n  }\n}\n\n// Example 2: Proper error handling\nFuture<void> loadUserData(String userId) async {\n  try {\n    final response = await http.get(Uri.parse('$apiUrl/users/$userId'));\n\n    if (response.statusCode != 200) {\n      throw Exception('Failed to load user');\n    }\n\n    final user = User.fromJson(jsonDecode(response.body));\n\n    if (!mounted) return;\n    setState(() => _user = user);\n  } catch (e) {\n    if (!mounted) return;\n    setState(() => _error = e.toString());\n  }\n}\n\n// Example 3: Proper loop termination\nvoid processQueue() {\n  while (queue.isNotEmpty) {\n    print(queue.first);\n    queue.removeAt(0); // Actually modify the queue\n  }\n}\n\n// Example 4: Prevent race condition\nclass _DataScreenState extends State<DataScreen> {\n  String _data = '';\n  bool _isLoading = false;\n\n  @override\n  void initState() {\n    super.initState();\n    loadData();\n  }\n\n  Future<void> loadData() async {\n    if (_isLoading) return; // Prevent concurrent loads\n\n    setState(() => _isLoading = true);\n    try {\n      final data = await fetchFromApi();\n      if (!mounted) return;\n      setState(() {\n        _data = data;\n        _isLoading = false;\n      });\n    } catch (e) {\n      if (!mounted) return;\n      setState(() => _isLoading = false);\n    }\n  }\n}\n\n// Example 5: Correct loop bounds\nvoid processList(List<int> items) {\n  for (int i = 0; i < items.length; i++) { // <, not <=\n    print(items[i]);\n  }\n}\n```\n\n---\n\n### 7. Text Overflow in Flex Layouts\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: Text in Row without constraints\nclass UserListItem extends StatelessWidget {\n  final User user;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.person),\n        SizedBox(width: 8),\n        Text(user.name), // Overflow if name is long!\n        Spacer(),\n        Icon(Icons.arrow_forward),\n      ],\n    );\n  }\n}\n\n// Example 2: Multiple texts in Row\nclass EmailHeader extends StatelessWidget {\n  final Email email;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Text(email.from), // Can overflow\n        SizedBox(width: 16),\n        Text(email.subject), // Can also overflow\n      ],\n    );\n  }\n}\n\n// Example 3: Text with buttons in Row\nclass ActionBar extends StatelessWidget {\n  final String title;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Text(\n          title,\n          style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),\n        ), // Overflow if title is long\n        Spacer(),\n        IconButton(icon: Icon(Icons.edit), onPressed: () {}),\n        IconButton(icon: Icon(Icons.delete), onPressed: () {}),\n      ],\n    );\n  }\n}\n\n// Example 4: Nested widget with text (real bug scenario)\nclass SpeakerHeader extends StatelessWidget {\n  final Speaker speaker;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.mic),\n        SizedBox(width: 8),\n        GestureDetector(\n          onTap: () {},\n          child: Text(speaker.name), // Overflow if name is long!\n        ),\n      ],\n    );\n  }\n}\n\n// Example 5: Column with similar issue\nclass ProfileInfo extends StatelessWidget {\n  final String bio;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        CircleAvatar(child: Icon(Icons.person)),\n        SizedBox(width: 16),\n        Column(\n          crossAxisAlignment: CrossAxisAlignment.start,\n          children: [\n            Text('Username'),\n            Text(bio), // Overflow if bio is long!\n          ],\n        ),\n      ],\n    );\n  }\n}\n\n// Example 6: Text after Spacer without constraints\nclass MessageItem extends StatelessWidget {\n  final String message;\n  final String timestamp;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Text(message), // Can overflow\n        Spacer(),\n        Text(timestamp),\n      ],\n    );\n  }\n}\n\n// Example 7: Deep nesting without constraints\nclass NotificationCard extends StatelessWidget {\n  final String title;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.notifications),\n        Padding(\n          padding: EdgeInsets.symmetric(horizontal: 8),\n          child: Container(\n            decoration: BoxDecoration(color: Colors.grey[200]),\n            child: Text(title), // Overflow! Nested but no constraints\n          ),\n        ),\n      ],\n    );\n  }\n}\n\n// Example 8: ListTile-like pattern\nclass CustomListTile extends StatelessWidget {\n  final String title;\n  final String subtitle;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.folder),\n        SizedBox(width: 16),\n        Column(\n          crossAxisAlignment: CrossAxisAlignment.start,\n          children: [\n            Text(title), // Both can overflow\n            Text(subtitle, style: TextStyle(fontSize: 12)),\n          ],\n        ),\n        Icon(Icons.arrow_forward_ios, size: 16),\n      ],\n    );\n  }\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Wrapped with Flexible\nclass UserListItem extends StatelessWidget {\n  final User user;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.person),\n        SizedBox(width: 8),\n        Flexible(\n          child: Text(\n            user.name,\n            overflow: TextOverflow.ellipsis,\n          ),\n        ),\n        Spacer(),\n        Icon(Icons.arrow_forward),\n      ],\n    );\n  }\n}\n\n// Example 2: Multiple Flexible widgets for fair space distribution\nclass EmailHeader extends StatelessWidget {\n  final Email email;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Flexible(\n          flex: 1,\n          child: Text(\n            email.from,\n            overflow: TextOverflow.ellipsis,\n          ),\n        ),\n        SizedBox(width: 16),\n        Flexible(\n          flex: 2,\n          child: Text(\n            email.subject,\n            overflow: TextOverflow.ellipsis,\n          ),\n        ),\n      ],\n    );\n  }\n}\n\n// Example 3: Expanded for main content\nclass ActionBar extends StatelessWidget {\n  final String title;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Expanded(\n          child: Text(\n            title,\n            style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),\n            overflow: TextOverflow.ellipsis,\n            maxLines: 1,\n          ),\n        ),\n        IconButton(icon: Icon(Icons.edit), onPressed: () {}),\n        IconButton(icon: Icon(Icons.delete), onPressed: () {}),\n      ],\n    );\n  }\n}\n\n// Example 4: Real bug fix - Flexible with nested widget\nclass SpeakerHeader extends StatelessWidget {\n  final Speaker speaker;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.mic),\n        SizedBox(width: 8),\n        Flexible(\n          child: GestureDetector(\n            onTap: () {},\n            child: Text(\n              speaker.name,\n              overflow: TextOverflow.ellipsis,\n            ),\n          ),\n        ),\n      ],\n    );\n  }\n}\n\n// Example 5: Column inside Flexible\nclass ProfileInfo extends StatelessWidget {\n  final String bio;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        CircleAvatar(child: Icon(Icons.person)),\n        SizedBox(width: 16),\n        Flexible(\n          child: Column(\n            crossAxisAlignment: CrossAxisAlignment.start,\n            children: [\n              Text('Username'),\n              Text(\n                bio,\n                overflow: TextOverflow.ellipsis,\n                maxLines: 2,\n              ),\n            ],\n          ),\n        ),\n      ],\n    );\n  }\n}\n\n// Example 6: Both texts with proper constraints\nclass MessageItem extends StatelessWidget {\n  final String message;\n  final String timestamp;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Expanded(\n          child: Text(\n            message,\n            overflow: TextOverflow.ellipsis,\n          ),\n        ),\n        SizedBox(width: 8),\n        Text(timestamp), // Fixed-width timestamp is ok\n      ],\n    );\n  }\n}\n\n// Example 7: Deep nesting with Flexible at right level\nclass NotificationCard extends StatelessWidget {\n  final String title;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.notifications),\n        Flexible(\n          child: Padding(\n            padding: EdgeInsets.symmetric(horizontal: 8),\n            child: Container(\n              decoration: BoxDecoration(color: Colors.grey[200]),\n              child: Text(\n                title,\n                overflow: TextOverflow.ellipsis,\n              ),\n            ),\n          ),\n        ),\n      ],\n    );\n  }\n}\n\n// Example 8: ListTile-like pattern fixed\nclass CustomListTile extends StatelessWidget {\n  final String title;\n  final String subtitle;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.folder),\n        SizedBox(width: 16),\n        Expanded(\n          child: Column(\n            crossAxisAlignment: CrossAxisAlignment.start,\n            children: [\n              Text(\n                title,\n                overflow: TextOverflow.ellipsis,\n                maxLines: 1,\n              ),\n              Text(\n                subtitle,\n                style: TextStyle(fontSize: 12),\n                overflow: TextOverflow.ellipsis,\n                maxLines: 1,\n              ),\n            ],\n          ),\n        ),\n        Icon(Icons.arrow_forward_ios, size: 16),\n      ],\n    );\n  }\n}\n\n// Example 9: When const text is acceptable (known to be short)\nclass StatusIndicator extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.circle, color: Colors.green, size: 12),\n        SizedBox(width: 4),\n        Text('Online'), // OK - const short text, won't overflow\n      ],\n    );\n  }\n}\n\n// Example 10: Different overflow strategies\nclass MessagePreview extends StatelessWidget {\n  final String message;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.message),\n        SizedBox(width: 8),\n        Expanded(\n          child: Text(\n            message,\n            overflow: TextOverflow.fade, // Fade effect instead of ellipsis\n            maxLines: 1,\n            softWrap: false,\n          ),\n        ),\n      ],\n    );\n  }\n}\n\n// Example 11: Combining with width constraints\nclass ConstrainedText extends StatelessWidget {\n  final String title;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.title),\n        SizedBox(width: 8),\n        Container(\n          width: 200, // Explicit width constraint\n          child: Text(\n            title,\n            overflow: TextOverflow.ellipsis,\n          ),\n        ),\n      ],\n    );\n  }\n}\n\n// Example 12: Using SizedBox for consistent sizing\nclass UserTag extends StatelessWidget {\n  final String username;\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.person, size: 16),\n        SizedBox(width: 4),\n        SizedBox(\n          width: 100, // Fixed width\n          child: Text(\n            username,\n            overflow: TextOverflow.ellipsis,\n          ),\n        ),\n      ],\n    );\n  }\n}\n```\n\n---\n\n## P1 Examples (Important)\n\n### 1. avoid_collection_equality_checks\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: List comparison\nvoid checkLists() {\n  List<int> a = [1, 2, 3];\n  List<int> b = [1, 2, 3];\n\n  if (a == b) { // Always false! Different instances\n    print('Equal');\n  } else {\n    print('Not equal'); // Always prints this\n  }\n}\n\n// Example 2: Map comparison\nvoid checkMaps() {\n  Map<String, int> map1 = {'a': 1, 'b': 2};\n  Map<String, int> map2 = {'a': 1, 'b': 2};\n\n  if (map1 == map2) { // False - reference equality\n    print('Equal');\n  }\n}\n\n// Example 3: In conditional logic\nclass TodoList extends StatelessWidget {\n  final List<String> currentTodos;\n  final List<String> previousTodos;\n\n  Widget build(BuildContext context) {\n    // BAD: This will always rebuild\n    if (currentTodos != previousTodos) {\n      return Text('Todos changed');\n    }\n    return Text('No change');\n  }\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\nimport 'package:collection/collection.dart';\n\n// Example 1: Use DeepCollectionEquality\nvoid checkLists() {\n  List<int> a = [1, 2, 3];\n  List<int> b = [1, 2, 3];\n\n  if (DeepCollectionEquality().equals(a, b)) {\n    print('Equal'); // Correctly prints this\n  }\n}\n\n// Example 2: Use ListEquality for lists\nvoid checkLists() {\n  List<int> a = [1, 2, 3];\n  List<int> b = [1, 2, 3];\n\n  if (ListEquality().equals(a, b)) {\n    print('Equal');\n  }\n}\n\n// Example 3: Use MapEquality for maps\nvoid checkMaps() {\n  Map<String, int> map1 = {'a': 1, 'b': 2};\n  Map<String, int> map2 = {'a': 1, 'b': 2};\n\n  if (MapEquality().equals(map1, map2)) {\n    print('Equal');\n  }\n}\n\n// Example 4: Manual comparison for simple cases\nvoid checkSimpleList() {\n  List<int> a = [1, 2, 3];\n  List<int> b = [1, 2, 3];\n\n  bool areEqual = a.length == b.length &&\n                  List.generate(a.length, (i) => a[i] == b[i]).every((e) => e);\n}\n\n// Example 5: Const collections (reference equality works)\nconst list1 = [1, 2, 3];\nconst list2 = [1, 2, 3];\nif (list1 == list2) { // This works! Same const instance\n  print('Equal');\n}\n```\n\n---\n\n### 2. Code Complexity\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: Deep nesting (5 levels)\nvoid processOrder(Order order) {\n  if (order.isValid) {\n    if (order.items.isNotEmpty) {\n      for (var item in order.items) {\n        if (item.inStock) {\n          if (item.price > 0) {\n            // Do something - 5 levels deep!\n            addToCart(item);\n          }\n        }\n      }\n    }\n  }\n}\n\n// Example 2: Complex nested conditions\nWidget buildUserProfile(User? user) {\n  if (user != null) {\n    if (user.isActive) {\n      if (user.subscription != null) {\n        if (user.subscription!.isValid) {\n          if (user.subscription!.expiryDate.isAfter(DateTime.now())) {\n            return PremiumProfile(user);\n          } else {\n            return ExpiredProfile(user);\n          }\n        }\n      }\n    }\n  }\n  return GuestProfile();\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Early returns reduce nesting\nvoid processOrder(Order order) {\n  if (!order.isValid) return;\n  if (order.items.isEmpty) return;\n\n  for (var item in order.items) {\n    if (!item.inStock) continue;\n    if (item.price <= 0) continue;\n\n    addToCart(item);\n  }\n}\n\n// Example 2: Extract to methods\nWidget buildUserProfile(User? user) {\n  if (user == null) return GuestProfile();\n  if (!user.isActive) return InactiveProfile(user);\n\n  return _buildSubscriptionProfile(user);\n}\n\nWidget _buildSubscriptionProfile(User user) {\n  final subscription = user.subscription;\n  if (subscription == null) return BasicProfile(user);\n  if (!subscription.isValid) return InvalidSubscriptionProfile(user);\n  if (subscription.expiryDate.isBefore(DateTime.now())) {\n    return ExpiredProfile(user);\n  }\n\n  return PremiumProfile(user);\n}\n\n// Example 3: Combine conditions\nWidget buildUserProfile(User? user) {\n  if (user == null || !user.isActive) {\n    return GuestProfile();\n  }\n\n  final subscription = user.subscription;\n  final isValidSubscription = subscription != null &&\n                               subscription.isValid &&\n                               subscription.expiryDate.isAfter(DateTime.now());\n\n  return isValidSubscription ? PremiumProfile(user) : BasicProfile(user);\n}\n```\n\n---\n\n### 3. Long Build Methods\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: 60-line build method with complex UI\nclass UserProfilePage extends StatelessWidget {\n  final User user;\n\n  const UserProfilePage(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: Text(user.name),\n        actions: [\n          IconButton(\n            icon: Icon(Icons.settings),\n            onPressed: () {},\n          ),\n        ],\n      ),\n      body: SingleChildScrollView(\n        child: Column(\n          children: [\n            // Header section (15 lines)\n            Container(\n              padding: EdgeInsets.all(16),\n              child: Row(\n                children: [\n                  CircleAvatar(\n                    radius: 40,\n                    backgroundImage: NetworkImage(user.avatar),\n                  ),\n                  SizedBox(width: 16),\n                  Expanded(\n                    child: Column(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        Text(user.name, style: TextStyle(fontSize: 24)),\n                        Text(user.email, style: TextStyle(color: Colors.grey)),\n                      ],\n                    ),\n                  ),\n                ],\n              ),\n            ),\n            Divider(),\n            // Stats section (15 lines)\n            Container(\n              padding: EdgeInsets.all(16),\n              child: Row(\n                mainAxisAlignment: MainAxisAlignment.spaceAround,\n                children: [\n                  Column(\n                    children: [\n                      Text('${user.posts}', style: TextStyle(fontSize: 20)),\n                      Text('Posts'),\n                    ],\n                  ),\n                  Column(\n                    children: [\n                      Text('${user.followers}', style: TextStyle(fontSize: 20)),\n                      Text('Followers'),\n                    ],\n                  ),\n                  Column(\n                    children: [\n                      Text('${user.following}', style: TextStyle(fontSize: 20)),\n                      Text('Following'),\n                    ],\n                  ),\n                ],\n              ),\n            ),\n            // Bio section (10 lines)\n            Container(\n              padding: EdgeInsets.all(16),\n              child: Text(user.bio),\n            ),\n            // Posts grid (20+ lines)\n            GridView.builder(\n              shrinkWrap: true,\n              physics: NeverScrollableScrollPhysics(),\n              gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(\n                crossAxisCount: 3,\n                crossAxisSpacing: 4,\n                mainAxisSpacing: 4,\n              ),\n              itemCount: user.posts.length,\n              itemBuilder: (context, index) {\n                return Image.network(\n                  user.posts[index].imageUrl,\n                  fit: BoxFit.cover,\n                );\n              },\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Extract to private build methods\nclass UserProfilePage extends StatelessWidget {\n  final User user;\n\n  const UserProfilePage(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: Text(user.name),\n        actions: [\n          IconButton(\n            icon: Icon(Icons.settings),\n            onPressed: () {},\n          ),\n        ],\n      ),\n      body: SingleChildScrollView(\n        child: Column(\n          children: [\n            _buildHeader(),\n            Divider(),\n            _buildStats(),\n            _buildBio(),\n            _buildPostsGrid(),\n          ],\n        ),\n      ),\n    );\n  }\n\n  Widget _buildHeader() {\n    return Container(\n      padding: EdgeInsets.all(16),\n      child: Row(\n        children: [\n          CircleAvatar(\n            radius: 40,\n            backgroundImage: NetworkImage(user.avatar),\n          ),\n          SizedBox(width: 16),\n          Expanded(\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                Text(user.name, style: TextStyle(fontSize: 24)),\n                Text(user.email, style: TextStyle(color: Colors.grey)),\n              ],\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n\n  Widget _buildStats() {\n    return Container(\n      padding: EdgeInsets.all(16),\n      child: Row(\n        mainAxisAlignment: MainAxisAlignment.spaceAround,\n        children: [\n          _buildStatColumn('${user.posts}', 'Posts'),\n          _buildStatColumn('${user.followers}', 'Followers'),\n          _buildStatColumn('${user.following}', 'Following'),\n        ],\n      ),\n    );\n  }\n\n  Widget _buildStatColumn(String value, String label) {\n    return Column(\n      children: [\n        Text(value, style: TextStyle(fontSize: 20)),\n        Text(label),\n      ],\n    );\n  }\n\n  Widget _buildBio() {\n    return Container(\n      padding: EdgeInsets.all(16),\n      child: Text(user.bio),\n    );\n  }\n\n  Widget _buildPostsGrid() {\n    return GridView.builder(\n      shrinkWrap: true,\n      physics: NeverScrollableScrollPhysics(),\n      gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(\n        crossAxisCount: 3,\n        crossAxisSpacing: 4,\n        mainAxisSpacing: 4,\n      ),\n      itemCount: user.posts.length,\n      itemBuilder: (context, index) {\n        return Image.network(\n          user.posts[index].imageUrl,\n          fit: BoxFit.cover,\n        );\n      },\n    );\n  }\n}\n\n// Example 2: Extract to separate widget files\nclass UserProfilePage extends StatelessWidget {\n  final User user;\n\n  const UserProfilePage(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: Text(user.name),\n        actions: [SettingsButton()],\n      ),\n      body: SingleChildScrollView(\n        child: Column(\n          children: [\n            UserProfileHeader(user),       // Separate file\n            Divider(),\n            UserStatsSection(user),        // Separate file\n            UserBioSection(user),          // Separate file\n            UserPostsGrid(user.posts),     // Separate file\n          ],\n        ),\n      ),\n    );\n  }\n}\n```\n\n---\n\n### 4. Multiple Widgets Per File\n\n#### ‚ùå Bad Examples\n\n```dart\n// user_profile.dart - BAD: Multiple widgets in one file\nclass UserProfile extends StatelessWidget {\n  final User user;\n\n  const UserProfile(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Column(\n      children: [\n        UserCard(user),        // Should be in user_card.dart\n        UserAvatar(user),      // Should be in user_avatar.dart\n        UserBio(user),         // Should be in user_bio.dart\n      ],\n    );\n  }\n}\n\n// BAD: Public widget in same file\nclass UserCard extends StatelessWidget {\n  final User user;\n\n  const UserCard(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Card(\n      child: ListTile(\n        title: Text(user.name),\n        subtitle: Text(user.email),\n      ),\n    );\n  }\n}\n\n// BAD: Another public widget\nclass UserAvatar extends StatelessWidget {\n  final User user;\n\n  const UserAvatar(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return CircleAvatar(\n      backgroundImage: NetworkImage(user.avatar),\n    );\n  }\n}\n\n// BAD: Yet another public widget\nclass UserBio extends StatelessWidget {\n  final User user;\n\n  const UserBio(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Text(user.bio);\n  }\n}\n\n// BAD: Private widget also not allowed in same file\nclass _ProfileHeader extends StatelessWidget {\n  final User user;\n\n  const _ProfileHeader(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.person),\n        Text(user.name),\n      ],\n    );\n  }\n}\n```\n\n**Why ALL widgets must be extracted (no exceptions):**\n- **Testability**: Cannot unit test `_ProfileHeader` independently without creating `UserProfile`\n- **Reusability**: Private widgets become impossible to reuse in other files\n- **Code Reviews**: Changes to different widgets get mixed in same file diff\n- **Organization**: Harder to find and navigate to specific widget implementations\n- **Convention**: One-widget-per-file is Flutter best practice for consistency\n\n#### ‚úÖ Good Examples\n\n```dart\n// user_profile.dart - GOOD: Only one widget per file\nclass UserProfile extends StatelessWidget {\n  final User user;\n\n  const UserProfile(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Column(\n      children: [\n        ProfileHeader(user),   // Imported from profile_header.dart\n        UserCard(user),        // Imported from user_card.dart\n        UserAvatar(user),      // Imported from user_avatar.dart\n        UserBio(user),         // Imported from user_bio.dart\n      ],\n    );\n  }\n}\n\n// profile_header.dart - GOOD: Even \"helper\" widgets in separate files\nclass ProfileHeader extends StatelessWidget {\n  final User user;\n\n  const ProfileHeader(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Row(\n      children: [\n        Icon(Icons.person),\n        Text(user.name),\n      ],\n    );\n  }\n}\n\n// user_card.dart - GOOD: Separate file for UserCard\nclass UserCard extends StatelessWidget {\n  final User user;\n\n  const UserCard(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Card(\n      child: ListTile(\n        title: Text(user.name),\n        subtitle: Text(user.email),\n      ),\n    );\n  }\n}\n\n// user_avatar.dart - GOOD: Separate file for UserAvatar\nclass UserAvatar extends StatelessWidget {\n  final User user;\n\n  const UserAvatar(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return CircleAvatar(\n      backgroundImage: NetworkImage(user.avatar),\n    );\n  }\n}\n\n// user_bio.dart - GOOD: Separate file for UserBio\nclass UserBio extends StatelessWidget {\n  final User user;\n\n  const UserBio(this.user);\n\n  @override\n  Widget build(BuildContext context) {\n    return Padding(\n      padding: EdgeInsets.all(16),\n      child: Text(user.bio),\n    );\n  }\n}\n```\n\n---\n\n### 5. Avoid Late Keyword\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: Late without initialization\nclass UserProfileScreen extends StatefulWidget {\n  @override\n  State<UserProfileScreen> createState() => _UserProfileScreenState();\n}\n\nclass _UserProfileScreenState extends State<UserProfileScreen> {\n  late String userName;              // BAD: No initialization\n  late int userAge;                  // BAD: Crash if accessed before init\n  late TextEditingController controller;  // BAD: Memory leak risk\n\n  @override\n  void initState() {\n    super.initState();\n    // Forgot to initialize userName and userAge!\n    controller = TextEditingController();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Text(userName);  // LateInitializationError!\n  }\n\n  @override\n  void dispose() {\n    controller.dispose();\n    super.dispose();\n  }\n}\n\n// Example 2: Late in class fields\nclass UserService {\n  late final ApiClient apiClient;   // BAD: Runtime check\n  late Database db;                  // BAD: Might forget to initialize\n\n  void initialize() {\n    apiClient = ApiClient();\n    // Forgot to initialize db!\n  }\n\n  Future<User> getUser() async {\n    return apiClient.get('/user');\n    // If we use db here before initialize(), crash!\n  }\n}\n\n// Example 3: Complex late initialization\nclass ConfigManager {\n  late Map<String, dynamic> config;  // BAD: Complex init logic\n\n  Future<void> loadConfig() async {\n    try {\n      config = await loadFromFile();\n    } catch (e) {\n      // If loading fails, config never initialized!\n    }\n  }\n\n  String getConfigValue(String key) {\n    return config[key];  // Crash if loadConfig failed\n  }\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Constructor initialization\nclass _UserProfileScreenState extends State<UserProfileScreen> {\n  String userName = '';              // GOOD: Default value\n  int userAge = 0;                   // GOOD: Default value\n  final TextEditingController controller = TextEditingController();  // GOOD: Immediate init\n\n  @override\n  void initState() {\n    super.initState();\n    _loadUserData();\n  }\n\n  Future<void> _loadUserData() async {\n    final user = await fetchUser();\n    setState(() {\n      userName = user.name;\n      userAge = user.age;\n    });\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Text(userName);  // Safe, always initialized\n  }\n\n  @override\n  void dispose() {\n    controller.dispose();\n    super.dispose();\n  }\n}\n\n// Example 2: Nullable with null checks\nclass _UserProfileScreenState extends State<UserProfileScreen> {\n  String? userName;                  // GOOD: Nullable\n  int? userAge;                      // GOOD: Nullable\n  TextEditingController? controller; // GOOD: Nullable\n\n  @override\n  void initState() {\n    super.initState();\n    controller = TextEditingController();\n    _loadUserData();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Text(userName ?? 'Loading...');  // GOOD: Null check\n  }\n\n  @override\n  void dispose() {\n    controller?.dispose();\n    super.dispose();\n  }\n}\n\n// Example 3: Required parameters\nclass UserService {\n  final ApiClient apiClient;         // GOOD: Required in constructor\n  final Database db;                 // GOOD: Required in constructor\n\n  UserService({\n    required this.apiClient,\n    required this.db,\n  });\n\n  Future<User> getUser() async {\n    return apiClient.get('/user');   // Safe, always initialized\n  }\n}\n\n// Example 4: Acceptable late use with DI\nclass UserRepository {\n  late final Database db;  // OK: GetIt guarantees initialization\n\n  @injectable\n  UserRepository() {\n    db = GetIt.instance<Database>();  // Framework guarantees this runs first\n  }\n\n  Future<User> getUser(String id) async {\n    return db.query('users', where: 'id = ?', args: [id]);\n  }\n}\n\n// Example 5: Lazy initialization with nullable\nclass ConfigManager {\n  Map<String, dynamic>? _config;     // GOOD: Nullable\n\n  Future<void> loadConfig() async {\n    try {\n      _config = await loadFromFile();\n    } catch (e) {\n      _config = {};  // Fallback to empty map\n    }\n  }\n\n  String? getConfigValue(String key) {\n    return _config?[key];  // GOOD: Safe access\n  }\n\n  bool get isLoaded => _config != null;\n}\n```\n\n---\n\n### 6. Bloc Anti-patterns\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: Public fields\nclass UserBloc extends Bloc<UserEvent, UserState> {\n  String userName = ''; // BAD: Public mutable field\n  int loginCount = 0;   // BAD: Public mutable field\n\n  UserBloc() : super(UserInitial()) {\n    on<LoadUser>(_onLoadUser);\n  }\n}\n\n// Example 2: Public methods\nclass UserBloc extends Bloc<UserEvent, UserState> {\n  UserBloc() : super(UserInitial());\n\n  // BAD: Public method - should use event\n  void updateUserName(String name) {\n    emit(UserLoaded(name));\n  }\n}\n\n// Example 3: Mutable event\nclass UpdateUserEvent extends UserEvent {\n  String name; // BAD: Mutable field\n\n  UpdateUserEvent(this.name);\n}\n\n// Example 4: Non-sealed state\nclass UserState { // BAD: Not sealed or final\n  final String name;\n  UserState(this.name);\n}\n\nclass UserInitial extends UserState {\n  UserInitial() : super('');\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Private fields, state-driven\nclass UserBloc extends Bloc<UserEvent, UserState> {\n  String _userName = ''; // Private\n  int _loginCount = 0;   // Private\n\n  UserBloc() : super(UserInitial()) {\n    on<LoadUser>(_onLoadUser);\n  }\n\n  Future<void> _onLoadUser(LoadUser event, Emitter<UserState> emit) async {\n    _userName = event.userName;\n    _loginCount++;\n    emit(UserLoaded(_userName, _loginCount));\n  }\n}\n\n// Example 2: Event-driven (no public methods)\nclass UserBloc extends Bloc<UserEvent, UserState> {\n  UserBloc() : super(UserInitial()) {\n    on<UpdateUserName>(_onUpdateUserName);\n  }\n\n  void _onUpdateUserName(UpdateUserName event, Emitter<UserState> emit) {\n    emit(UserLoaded(event.name));\n  }\n}\n\n// Usage:\nbloc.add(UpdateUserName('John')); // Use event, not method\n\n// Example 3: Immutable event\n@immutable\nclass UpdateUserEvent extends UserEvent {\n  final String name; // Immutable\n\n  const UpdateUserEvent(this.name);\n}\n\n// Example 4: Sealed state\nsealed class UserState {}\n\nfinal class UserInitial extends UserState {}\n\nfinal class UserLoading extends UserState {}\n\nfinal class UserLoaded extends UserState {\n  final String name;\n  final int loginCount;\n\n  UserLoaded(this.name, this.loginCount);\n}\n\nfinal class UserError extends UserState {\n  final String message;\n\n  UserError(this.message);\n}\n```\n\n---\n\n### 4. Provider Anti-patterns\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: context.read() in build\nclass MyWidget extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    // BAD: Won't rebuild when counter changes\n    final counter = context.read<CounterProvider>().count;\n\n    return Text('Count: $counter');\n  }\n}\n\n// Example 2: Old syntax\nclass MyWidget extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    // BAD: Old syntax\n    final counter = Provider.of<CounterProvider>(context, listen: true);\n\n    return Text('Count: ${counter.count}');\n  }\n}\n\n// Example 3: Missing disposal in ChangeNotifier\nclass UserProvider extends ChangeNotifier {\n  final TextEditingController nameController = TextEditingController();\n  final StreamSubscription _subscription;\n\n  UserProvider() {\n    _subscription = stream.listen((data) {\n      notifyListeners();\n    });\n  }\n\n  // Missing dispose!\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: context.watch() in build\nclass MyWidget extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    // GOOD: Rebuilds when counter changes\n    final counter = context.watch<CounterProvider>().count;\n\n    return Text('Count: $counter');\n  }\n}\n\n// Example 2: context.read() for actions only\nclass MyWidget extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    final counter = context.watch<CounterProvider>().count;\n\n    return Column(\n      children: [\n        Text('Count: $counter'),\n        ElevatedButton(\n          onPressed: () {\n            // GOOD: read() for one-time action\n            context.read<CounterProvider>().increment();\n          },\n          child: Text('Increment'),\n        ),\n      ],\n    );\n  }\n}\n\n// Example 3: Proper disposal in ChangeNotifier\nclass UserProvider extends ChangeNotifier {\n  final TextEditingController nameController = TextEditingController();\n  late final StreamSubscription _subscription;\n\n  UserProvider() {\n    _subscription = stream.listen((data) {\n      notifyListeners();\n    });\n  }\n\n  @override\n  void dispose() {\n    nameController.dispose();\n    _subscription.cancel();\n    super.dispose();\n  }\n}\n\n// Example 4: Select for performance\nclass MyWidget extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    // GOOD: Only rebuilds when name changes, not entire user\n    final userName = context.select<UserProvider, String>(\n      (provider) => provider.user.name\n    );\n\n    return Text('Hello, $userName');\n  }\n}\n```\n\n---\n\n## P2 Examples (Code Quality)\n\n### 1. Magic Numbers\n\n#### ‚ùå Bad Examples\n\n```dart\n// Example 1: Status codes\nvoid handleResponse(int statusCode) {\n  if (statusCode == 200) { // What is 200?\n    handleSuccess();\n  } else if (statusCode == 404) { // What is 404?\n    handleNotFound();\n  } else if (statusCode == 500) { // What is 500?\n    handleError();\n  }\n}\n\n// Example 2: Timeouts\nFuture<void> loadData() async {\n  await Future.delayed(Duration(seconds: 30)); // Why 30?\n  // ...\n}\n\n// Example 3: Business logic\ndouble calculateDiscount(double price) {\n  if (price > 100) {\n    return price * 0.15; // What is 15%?\n  } else if (price > 50) {\n    return price * 0.10; // What is 10%?\n  }\n  return 0;\n}\n```\n\n#### ‚úÖ Good Examples\n\n```dart\n// Example 1: Named constants\nclass HttpStatus {\n  static const int ok = 200;\n  static const int notFound = 404;\n  static const int serverError = 500;\n}\n\nvoid handleResponse(int statusCode) {\n  if (statusCode == HttpStatus.ok) {\n    handleSuccess();\n  } else if (statusCode == HttpStatus.notFound) {\n    handleNotFound();\n  } else if (statusCode == HttpStatus.serverError) {\n    handleError();\n  }\n}\n\n// Example 2: Named durations\nconst dataLoadTimeout = Duration(seconds: 30);\n\nFuture<void> loadData() async {\n  await Future.delayed(dataLoadTimeout);\n  // ...\n}\n\n// Example 3: Named business constants\nclass DiscountRates {\n  static const double premiumThreshold = 100.0;\n  static const double standardThreshold = 50.0;\n  static const double premiumRate = 0.15;\n  static const double standardRate = 0.10;\n}\n\ndouble calculateDiscount(double price) {\n  if (price > DiscountRates.premiumThreshold) {\n    return price * DiscountRates.premiumRate;\n  } else if (price > DiscountRates.standardThreshold) {\n    return price * DiscountRates.standardRate;\n  }\n  return 0;\n}\n\n// Example 4: Acceptable magic numbers (common widget values)\nWidget build(BuildContext context) {\n  return Padding(\n    padding: EdgeInsets.all(16), // OK: Common padding\n    child: SizedBox(\n      height: 48, // OK: Standard button height\n      child: ElevatedButton(...),\n    ),\n  );\n}\n```\n\n---\n\n### 2. Long Methods/Classes\n\n#### ‚ùå Bad Example\n\n```dart\n// Example: 150+ line method\nclass OrderService {\n  Future<void> processOrder(Order order) async {\n    // Validate order (20 lines)\n    if (order.items.isEmpty) throw Exception('Empty order');\n    if (order.customer == null) throw Exception('No customer');\n    // ... 15 more validation lines\n\n    // Calculate totals (25 lines)\n    double subtotal = 0;\n    for (var item in order.items) {\n      subtotal += item.price * item.quantity;\n    }\n    // ... 20 more calculation lines\n\n    // Apply discounts (30 lines)\n    double discount = 0;\n    if (order.customer.isPremium) {\n      discount = subtotal * 0.15;\n    }\n    // ... 25 more discount lines\n\n    // Process payment (40 lines)\n    final paymentResult = await paymentGateway.charge(\n      amount: subtotal - discount,\n      customer: order.customer,\n    );\n    // ... 35 more payment lines\n\n    // Update inventory (35 lines)\n    for (var item in order.items) {\n      await inventory.reduceStock(item.id, item.quantity);\n    }\n    // ... 30 more inventory lines\n\n    // Send notifications (20 lines)\n    await emailService.sendOrderConfirmation(order);\n    // ... 15 more notification lines\n  }\n}\n```\n\n#### ‚úÖ Good Example\n\n```dart\n// Extract into focused methods\nclass OrderService {\n  Future<void> processOrder(Order order) async {\n    _validateOrder(order);\n\n    final totals = _calculateTotals(order);\n    final discount = _calculateDiscount(order, totals.subtotal);\n    final finalAmount = totals.subtotal - discount;\n\n    await _processPayment(order, finalAmount);\n    await _updateInventory(order);\n    await _sendNotifications(order);\n  }\n\n  void _validateOrder(Order order) {\n    if (order.items.isEmpty) throw Exception('Empty order');\n    if (order.customer == null) throw Exception('No customer');\n    // ... validation logic\n  }\n\n  OrderTotals _calculateTotals(Order order) {\n    double subtotal = 0;\n    for (var item in order.items) {\n      subtotal += item.price * item.quantity;\n    }\n    return OrderTotals(subtotal: subtotal);\n  }\n\n  double _calculateDiscount(Order order, double subtotal) {\n    if (order.customer.isPremium) {\n      return subtotal * 0.15;\n    }\n    return 0;\n  }\n\n  Future<void> _processPayment(Order order, double amount) async {\n    final result = await paymentGateway.charge(\n      amount: amount,\n      customer: order.customer,\n    );\n    // ... payment logic\n  }\n\n  Future<void> _updateInventory(Order order) async {\n    for (var item in order.items) {\n      await inventory.reduceStock(item.id, item.quantity);\n    }\n  }\n\n  Future<void> _sendNotifications(Order order) async {\n    await emailService.sendOrderConfirmation(order);\n    // ... notification logic\n  }\n}\n\nclass OrderTotals {\n  final double subtotal;\n  OrderTotals({required this.subtotal});\n}\n```\n\n---\n\n## Summary\n\nThese examples demonstrate the patterns to look for during code review. Focus on:\n- **Safety first**: P0 issues can crash the app\n- **Correctness**: P1 issues cause bugs or violate patterns\n- **Quality**: P2 issues improve maintainability\n\nAlways provide context-specific suggestions with code examples when flagging issues.\n",
        "plugins/flutter-tools/skills/flutter-review/reference.md": "# Flutter Review - Detailed Reference\n\nThis document provides in-depth explanations of all checks performed by the Flutter Review skill.\n\n## P0 Checks (Critical)\n\n### 1. avoid_non_null_assertion {#avoid_non_null_assertion}\n\n**What it detects**: Usage of the force unwrap operator (exclamation mark) without proper null checks.\n\n**Why it's critical**: Can cause runtime crashes with \"Null check operator used on a null value\" error.\n\n**Pattern to detect**:\n- variable with exclamation mark\n- expression with exclamation mark followed by property access\n- function call with exclamation mark\n\n**When it's acceptable**:\n- After type check with type promotion: `if (x is String) { x.length; }`\n\n**Preferred null-checking pattern**:\n\nExtract nullable properties to local variables BEFORE checking:\n```dart\n// PREFERRED: Extract to local variable\nfinal userId = widget.userId;\nif (userId == null) {\n  return;\n}\n// userId is now non-null, no ! needed\nfinal user = await userRepository.getUser(userId);\n```\n\n**Anti-pattern to avoid**:\n```dart\n// BAD: Check widget property then force unwrap later\nif (widget.userId == null) {\n  return;\n}\nfinal user = await userRepository.getUser(widget.userId!); // Still uses !\n```\n\n**Why this pattern is better**:\n1. Type promotion - variable becomes non-null after check\n2. No force unwrap operator needed\n3. More readable and maintainable\n4. Safer - compiler enforces null safety\n\n**Other suggested fixes**:\n1. Use null-aware operator: `variable?.property`\n2. Use null coalescing: `variable ?? defaultValue`\n3. Use pattern matching: `if (variable case final value?) { ... }`\n\n---\n\n### 2. avoid_mounted_in_setstate {#avoid_mounted_in_setstate}\n\n**What it detects**: Calling `setState()` in async callbacks without checking if the widget is still mounted.\n\n**Why it's critical**: Causes `setState() called after dispose()` errors and crashes.\n\n**Pattern to detect**:\n```dart\n// BAD\nFuture<void> loadData() async {\n  final data = await api.fetchData();\n  setState(() {\n    _data = data;\n  });\n}\n```\n\n**Suggested fix**:\n```dart\n// GOOD\nFuture<void> loadData() async {\n  final data = await api.fetchData();\n  if (!mounted) return;\n  setState(() {\n    _data = data;\n  });\n}\n```\n\n---\n\n### 3. dispose_class_fields {#dispose_class_fields}\n\n**What it detects**: Controllers, streams, subscriptions, and other resources not properly disposed.\n\n**Why it's critical**: Memory leaks that degrade app performance over time.\n\n**Resources to check**:\n- `TextEditingController`\n- `AnimationController`\n- `ScrollController`\n- `TabController`\n- `PageController`\n- `FocusNode`\n- `StreamSubscription`\n- `Timer`\n- Any class with `addListener()` called\n\n**Pattern to detect**:\n```dart\nclass MyWidget extends StatefulWidget {\n  @override\n  State<MyWidget> createState() => _MyWidgetState();\n}\n\nclass _MyWidgetState extends State<MyWidget> {\n  final _controller = TextEditingController(); // Created\n  StreamSubscription? _subscription;\n\n  @override\n  void initState() {\n    super.initState();\n    _subscription = stream.listen(...);\n  }\n\n  // MISSING: dispose method or incomplete disposal\n}\n```\n\n**Suggested fix**:\n```dart\n@override\nvoid dispose() {\n  _controller.dispose();\n  _subscription?.cancel();\n  super.dispose();\n}\n```\n\n---\n\n### 4. Missing Null Safety {#missing_null_safety}\n\n**What it detects**: Accessing properties or methods on potentially null objects without checks.\n\n**Why it's critical**: Null pointer exceptions crash the app.\n\n**Patterns to detect**:\n- Nullable variable accessed without check: `String? name; print(name.length);`\n- Nullable return value used directly: `findUser().name`\n- Map access without null check: `map['key'].toString()`\n\n**Logic errors causing null issues**:\n- Missing initialization\n- Incorrect conditional logic\n- Async timing issues\n\n---\n\n### 4.1 Unsafe Type Casts {#unsafe_type_casts}\n\n**What it detects**: Using the `as` operator to cast types without checking the type first.\n\n**Why it's critical**: Can cause type cast errors at runtime with \"type 'X' is not a subtype of type 'Y'\" error, crashing the app.\n\n**Pattern to detect**:\n```dart\n// BAD: Direct cast without check\nfinal user = data as User;\nfinal name = obj as String;\n```\n\n**Suggested fixes**:\n\n**Option 1: Use pattern matching (Dart 3+)**\n```dart\n// GOOD: Pattern matching with type check\nif (data case User user) {\n  print(user.name);\n}\n```\n\n**Option 2: Check type first with is operator**\n```dart\n// GOOD: Check before cast\nif (obj is String) {\n  final name = obj as String;  // Safe after check\n  print(name);\n}\n```\n\n**Important**: Dart does not have a \"safe cast\" operator. `as Type?` will still throw if types are incompatible - it only means \"cast to nullable Type\", not \"try cast and return null on failure\".\n\n```dart\n// WRONG: This will still throw!\nint value = 0;\ndouble? d = value as double?;  // Throws: type 'int' is not a subtype of type 'double?'\n```\n\n**When it's acceptable**:\n- Immediately after type check: `if (x is String) { final s = x as String; }`\n- In catch blocks: `} catch (e) { if (e is NetworkError) { final err = e as NetworkError; } }`\n- When type is guaranteed by framework (rare cases with clear documentation)\n\n---\n\n### 4.2 State Modifications After Disposal {#state_after_disposal}\n\n**What it detects**: Modifying widget state or calling methods after the widget has been disposed.\n\n**Why it's critical**: Can cause memory leaks, unexpected behavior, and crashes.\n\n**Patterns to detect**:\n```dart\n// BAD: No cancellation in dispose\nclass _MyWidgetState extends State<MyWidget> {\n  Timer? _timer;\n\n  @override\n  void initState() {\n    super.initState();\n    _timer = Timer.periodic(Duration(seconds: 1), (timer) {\n      setState(() {\n        // This will crash if widget disposed\n        _counter++;\n      });\n    });\n  }\n\n  // MISSING: Cancel timer in dispose\n}\n```\n\n```dart\n// BAD: Stream subscription not cancelled\nclass _MyWidgetState extends State<MyWidget> {\n  StreamSubscription? _subscription;\n\n  @override\n  void initState() {\n    super.initState();\n    _subscription = stream.listen((data) {\n      setState(() => _data = data);  // Crash if disposed\n    });\n  }\n\n  // MISSING: Cancel subscription in dispose\n}\n```\n\n**Suggested fix**:\n```dart\n// GOOD: Cancel operations in dispose\nclass _MyWidgetState extends State<MyWidget> {\n  Timer? _timer;\n  StreamSubscription? _subscription;\n\n  @override\n  void initState() {\n    super.initState();\n    _timer = Timer.periodic(Duration(seconds: 1), (timer) {\n      if (!mounted) return;  // Additional safety\n      setState(() => _counter++);\n    });\n\n    _subscription = stream.listen((data) {\n      if (!mounted) return;  // Additional safety\n      setState(() => _data = data);\n    });\n  }\n\n  @override\n  void dispose() {\n    _timer?.cancel();         // Cancel timer\n    _subscription?.cancel();  // Cancel subscription\n    super.dispose();\n  }\n}\n```\n\n**Key principle**: Any async operation that modifies widget state must be:\n1. Cancelled/completed in dispose()\n2. Check `mounted` before calling setState()\n\n---\n\n### 5. Logic Errors (Critical) {#logic_errors_critical}\n\n**What it detects**: Code logic that will cause crashes or incorrect behavior.\n\n**Examples**:\n\n**Incorrect conditionals**: {#logic_errors_conditionals}\n```dart\n// BAD: Always true\nif (value != null || value.isEmpty) { ... }\n\n// Should be:\nif (value != null && value.isEmpty) { ... }\n```\n\n**Missing error handling**: {#missing_error_handling}\n```dart\n// BAD: No error handling\nfinal response = await http.get(url);\nfinal data = jsonDecode(response.body);\n\n// GOOD: Handle errors\ntry {\n  final response = await http.get(url);\n  if (response.statusCode == 200) {\n    final data = jsonDecode(response.body);\n  } else {\n    // Handle error\n  }\n} catch (e) {\n  // Handle exception\n}\n```\n\n**Infinite loops**: {#infinite_loops}\n```dart\n// BAD: No termination condition\nwhile (true) {\n  processItem();\n}\n\n// BAD: Condition never changes\nint i = 0;\nwhile (i < 10) {\n  print(i); // i never increments\n}\n```\n\n**Race conditions**: {#race_conditions}\n```dart\n// BAD: Multiple async operations modifying same state\nvoid loadData() async {\n  setState(() => _loading = true);\n  final data1 = await fetchData1();\n  setState(() => _data = data1);\n  final data2 = await fetchData2();\n  setState(() => _data = data2); // Overwrites data1\n}\n```\n\n---\n\n### 6. bloc_missing_initial_state {#bloc_missing_initial_state}\n\n**What it detects**: BlocConsumer or BlocListener that updates widget state in the listener callback, but doesn't initialize that state from the bloc's current state in initState().\n\n**Why it's critical**: The listener callback only fires on state *changes*, not on the initial state. If the bloc already has state before the widget is created, the listener never runs and widget state remains uninitialized, causing incorrect UI display (empty text fields, wrong values, etc.).\n\n**Pattern to detect**:\n```dart\n// BAD - Initial state missed\nclass _MyWidgetState extends State<MyWidget> {\n  final textController = TextEditingController();\n\n  @override\n  Widget build(BuildContext context) {\n    return BlocConsumer<MyBloc, MyState>(\n      listener: (context, state) {\n        // This only fires on CHANGES, not initial state\n        if (textController.text != state.name) {\n          textController.text = state.name;\n        }\n      },\n      builder: (context, state) {\n        return TextField(controller: textController);\n      },\n    );\n  }\n\n  // MISSING: initState() to set initial value\n}\n```\n\n**Why it happens**:\n1. Bloc is created/provided higher in the widget tree\n2. Bloc emits initial state before this widget is built\n3. Widget subscribes to bloc with BlocConsumer\n4. Since the state hasn't *changed* (it was just the initial emit), listener never fires\n5. Widget state (textController.text) remains at default value (empty string)\n\n**Suggested fix**:\n```dart\n// GOOD - Initial state captured\nclass _MyWidgetState extends State<MyWidget> {\n  final textController = TextEditingController();\n\n  @override\n  void initState() {\n    super.initState();\n    // Capture initial state from bloc\n    final initialState = context.read<MyBloc>().state;\n    textController.text = initialState.name;\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return BlocConsumer<MyBloc, MyState>(\n      listener: (context, state) {\n        // Now handles subsequent changes\n        if (textController.text != state.name) {\n          textController.text = state.name;\n        }\n      },\n      builder: (context, state) {\n        return TextField(controller: textController);\n      },\n    );\n  }\n\n  @override\n  void dispose() {\n    textController.dispose();\n    super.dispose();\n  }\n}\n```\n\n**When to flag**:\n- BlocConsumer or BlocListener has a listener that modifies widget state\n- Widget state (TextEditingController, ScrollController, local variables) is not initialized in initState()\n- The state being listened to could exist before widget creation\n\n**When NOT to flag**:\n- Listener only shows dialogs/snackbars (no state sync)\n- Widget state is only set from user input, not bloc state\n- Bloc is guaranteed to be created after widget (rare)\n\n---\n\n### 7. text_overflow_flex {#text_overflow_flex}\n\n**What it detects**: Text widgets inside Row/Column without proper constraints or overflow handling.\n\n**Why it's critical**: Causes RenderFlex overflow errors showing red/yellow stripes, making UI look broken and potentially unusable. This is a common Flutter layout bug that directly impacts user experience.\n\n**Pattern to detect**:\n- Text widget as direct child of Row/Column (or nested within non-constraining widgets like GestureDetector, Container without width)\n- No Flexible or Expanded wrapper around Text or its parent\n- No overflow parameter specified on Text\n- Long or dynamic text content that could exceed available space\n\n**Common scenarios**:\n1. User names, emails, or dynamic content in rows\n2. Title text alongside icons/buttons in rows\n3. List items with text and trailing widgets\n4. Headers with text and action buttons\n5. Chat messages or notifications with variable-length text\n\n**Why it happens**:\n- Flutter's Row/Column don't automatically constrain children\n- Text widget defaults to taking as much space as needed for content\n- Without constraints, Text tries to render full content width\n- Results in RenderFlex overflow error when text width exceeds available space\n\n**Suggested fixes**:\n\n**Option 1: Wrap with Flexible (preferred for most cases)**\n```dart\nRow(\n  children: [\n    Icon(Icons.person),\n    Flexible(\n      child: Text(\n        userName,\n        overflow: TextOverflow.ellipsis,\n      ),\n    ),\n  ],\n)\n```\n- Allows text to take available space\n- Works well when text should share space with other widgets\n- Automatically constrains text width\n- Can use `flex` parameter to control relative sizing\n\n**Option 2: Add overflow property with Expanded**\n```dart\nRow(\n  children: [\n    Icon(Icons.person),\n    Expanded(\n      child: Text(\n        userName,\n        overflow: TextOverflow.ellipsis,\n        maxLines: 1,\n      ),\n    ),\n  ],\n)\n```\n- Use when text should take all remaining space\n- Good for main content in the row\n- Expanded is equivalent to Flexible(flex: 1, fit: FlexFit.tight)\n\n**Option 3: Add explicit width constraints**\n```dart\nRow(\n  children: [\n    Icon(Icons.person),\n    Container(\n      width: 200,\n      child: Text(\n        userName,\n        overflow: TextOverflow.ellipsis,\n      ),\n    ),\n  ],\n)\n```\n- Use when you have specific width requirements\n- Less flexible for different screen sizes\n\n**Best practice**: Combine Flexible/Expanded + overflow parameter for most robust solution.\n\n**Overflow options**:\n- `TextOverflow.ellipsis` - Shows \"...\" at truncation point (most common)\n- `TextOverflow.fade` - Fades out text at edge\n- `TextOverflow.clip` - Hard cut at boundary\n- `TextOverflow.visible` - Allows overflow (usually not desired)\n\n**Example from real bug fix**:\n```dart\n// BAD - Text will overflow if name is long\nRow(\n  children: [\n    Icon(Icons.mic),\n    HSpace(theme.spacing.m),\n    AFPopover(\n      child: GestureDetector(\n        onTap: () {},\n        child: Text(widget.speakerInfo.name), // Can overflow!\n      ),\n    ),\n  ],\n)\n\n// GOOD - Wrapped with Flexible and overflow handling\nRow(\n  children: [\n    Icon(Icons.mic),\n    HSpace(theme.spacing.m),\n    Flexible(\n      child: AFPopover(\n        child: GestureDetector(\n          onTap: () {},\n          child: Text(\n            widget.speakerInfo.name,\n            overflow: TextOverflow.ellipsis, // Handles long text\n          ),\n        ),\n      ),\n    ),\n  ],\n)\n```\n\n**When to flag**:\n- Text widget inside Row/Column without Flexible/Expanded\n- No overflow parameter specified on Text\n- Text content could be dynamic/user-generated (usernames, emails, messages)\n- Text shares row/column with other fixed-width widgets\n- Text is nested in non-constraining widgets (GestureDetector, Padding, Container without width)\n\n**When NOT to flag**:\n- Text already wrapped in Flexible/Expanded (check parent tree)\n- Text already has overflow parameter set\n- Text is const with known short length (e.g., \"Online\", \"Settings\")\n- Row/Column is inside ScrollView with horizontal scroll enabled\n- Text is in a Container with explicit width constraint\n- Text uses maxLines with overflow handling\n\n**Detection examples**:\n```dart\n// FLAG: Direct Text in Row\nRow(children: [Icon(Icons.person), Text(userName)])\n\n// FLAG: Nested in non-constraining widget\nRow(children: [Icon(Icons.person), GestureDetector(child: Text(userName))])\n\n// FLAG: Has overflow but no Flexible\nRow(children: [Icon(Icons.person), Text(userName, overflow: TextOverflow.ellipsis)])\n\n// DON'T FLAG: Already has Flexible\nRow(children: [Icon(Icons.person), Flexible(child: Text(userName))])\n\n// DON'T FLAG: Has both Flexible and overflow\nRow(children: [Icon(Icons.person), Flexible(child: Text(userName, overflow: TextOverflow.ellipsis))])\n\n// DON'T FLAG: Const short text\nRow(children: [Icon(Icons.circle), Text('Online')])\n```\n\n**Additional considerations**:\n- Also applies to Column widgets with similar patterns\n- Check nested structures - Flexible might be several levels up\n- Consider using SizedBox with width for consistent sizing\n- Remember: Spacer() takes remaining space, so text after Spacer needs constraints too\n\n---\n\n## P1 Checks (Important)\n\n### 1. avoid_collection_equality_checks {#avoid_collection_equality_checks}\n\n**What it detects**: Using equality operators (== or !=) to compare Lists, Maps, or Sets.\n\n**Why it's important**: In Dart, `==` on collections checks reference equality, not content equality.\n\n**Pattern to detect**:\n```dart\nList<int> a = [1, 2, 3];\nList<int> b = [1, 2, 3];\nif (a == b) { ... } // Always false! Different instances\n```\n\n**Suggested fixes**:\n1. Use `package:collection`: `ListEquality().equals(a, b)`\n2. Use `DeepCollectionEquality().equals(a, b)`\n3. Compare individual elements if simple\n4. For const collections, comparison works (same instance)\n\n---\n\n### 2. Code Complexity (Nesting >4) {#deep_nesting}\n\n**What it detects**: Deeply nested control structures (if/for/while/switch).\n\n**Why it's important**: Reduces readability, increases cognitive load, harder to test.\n\n**Pattern to detect**:\n```dart\nif (condition1) {\n  if (condition2) {\n    for (var item in list) {\n      if (item.isValid) {\n        while (processing) {\n          // 5 levels deep - too complex\n        }\n      }\n    }\n  }\n}\n```\n\n**Suggested fixes**:\n1. Extract nested logic into separate methods\n2. Use early returns to reduce nesting\n3. Combine conditions where possible\n4. Use guard clauses\n\n**Example refactor**:\n```dart\n// BEFORE: Nested\nif (user != null) {\n  if (user.isActive) {\n    if (user.hasPermission) {\n      doSomething();\n    }\n  }\n}\n\n// AFTER: Early returns\nif (user == null) return;\nif (!user.isActive) return;\nif (!user.hasPermission) return;\ndoSomething();\n```\n\n---\n\n### 3. Long Methods (>100 lines) {#long_methods}\n\n**What it detects**: Methods exceeding 100 lines of code.\n\n**Why it's important**: Violates Single Responsibility Principle, hard to understand and test.\n\n**Suggested fix**: Break into smaller, focused methods with clear names.\n\n---\n\n### 3.1 Long Build Methods (>50 lines) {#long_build_methods}\n\n**What it detects**: Widget build methods exceeding 50 lines of code.\n\n**Why it's important**: Build methods with too much UI logic become hard to read, maintain, and test. They often indicate poor separation of concerns.\n\n**Pattern to detect**:\n```dart\nclass MyWidget extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    // 60+ lines of nested widgets\n    return Column(\n      children: [\n        // Complex header (15 lines)\n        // Complex body (25 lines)\n        // Complex footer (20 lines)\n      ],\n    );\n  }\n}\n```\n\n**Suggested fixes**:\n1. Extract to private build helper methods: buildHeader(), buildBody(), buildFooter()\n2. Create separate widget classes in new files for reusable components\n3. Use widget composition to break down complex UIs\n\n**Example refactor**:\n```dart\n// BEFORE: 60-line build method\n@override\nWidget build(BuildContext context) {\n  return Column(children: [/* 60 lines */]);\n}\n\n// AFTER: Split into focused methods\n@override\nWidget build(BuildContext context) {\n  return Column(\n    children: [\n      _buildHeader(),\n      _buildBody(),\n      _buildFooter(),\n    ],\n  );\n}\n\nWidget _buildHeader() { /* 10 lines */ }\nWidget _buildBody() { /* 15 lines */ }\nWidget _buildFooter() { /* 8 lines */ }\n```\n\n---\n\n### 3.2 Multiple Widgets Per File {#multiple_widgets_per_file}\n\n**What it detects**: Multiple widget class definitions in the same file.\n\n**Why it's important**:\n- Reduces code organization and makes widgets harder to find\n- Prevents independent testing of individual widgets\n- Reduces reusability across the codebase\n- Violates single-responsibility and single-file-single-widget convention\n- Makes code reviews harder (changes to different widgets mixed in one file)\n\n**Pattern to detect**:\n```dart\n// user_profile.dart - BAD: Multiple widgets in one file\nclass UserProfile extends StatelessWidget { ... }\nclass UserCard extends StatelessWidget { ... }       // Should be in user_card.dart\nclass _UserAvatar extends StatelessWidget { ... }    // Should be in user_avatar.dart (even private)\nclass _HeaderSection extends StatefulWidget { ... }  // Should be in header_section.dart (even private)\n```\n\n**No exceptions**:\n- Even private widgets with underscore prefix (`_Widget`) must be extracted\n- Even \"small\" helper widgets (< 30 lines) must be in separate files\n- StatefulWidget state classes (`_MyWidgetState`) are the ONLY acceptable additional class\n\n**Acceptable**: Only the State class for a StatefulWidget:\n```dart\n// my_widget.dart - GOOD: Only widget and its state\nclass MyWidget extends StatefulWidget {\n  @override\n  State<MyWidget> createState() => _MyWidgetState();\n}\n\n// This is the ONLY acceptable additional class\nclass _MyWidgetState extends State<MyWidget> {\n  @override\n  Widget build(BuildContext context) { ... }\n}\n```\n\n**Suggested fix**:\n```dart\n// user_profile.dart - GOOD: Only one widget\nclass UserProfile extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    return Column(\n      children: [\n        UserCard(...),       // Imported from user_card.dart\n        UserAvatar(...),     // Imported from user_avatar.dart\n        HeaderSection(...),  // Imported from header_section.dart\n      ],\n    );\n  }\n}\n\n// user_card.dart - Separate file for each widget\nclass UserCard extends StatelessWidget { ... }\n\n// user_avatar.dart - Even if small or private in origin\nclass UserAvatar extends StatelessWidget { ... }\n\n// header_section.dart - Even if it was private before\nclass HeaderSection extends StatefulWidget { ... }\nclass _HeaderSectionState extends State<HeaderSection> { ... }  // State class OK here\n```\n\n---\n\n### 3.3 Avoid Late Keyword {#avoid_late_keyword}\n\n**What it detects**: Usage of the late keyword for variable declarations.\n\n**Why it's important**: The late modifier defers null-safety checks from compile-time to runtime, which can cause LateInitializationError crashes when accessed before initialization.\n\n**Pattern to detect**:\n```dart\nclass MyWidget extends StatefulWidget {\n  @override\n  State<MyWidget> createState() => _MyWidgetState();\n}\n\nclass _MyWidgetState extends State<MyWidget> {\n  late String userName;           // Runtime check\n  late TextEditingController controller;  // Runtime check\n\n  @override\n  void initState() {\n    super.initState();\n    // If we forget to initialize, runtime crash!\n  }\n}\n```\n\n**Risk scenarios**:\n1. Accessing before initialization: LateInitializationError\n2. Forgetting to initialize in all code paths\n3. Complex initialization logic that might fail silently\n\n**Suggested fixes**:\n\n**Option 1: Constructor initialization**\n```dart\nclass _MyWidgetState extends State<MyWidget> {\n  final String userName;\n  final TextEditingController controller;\n\n  _MyWidgetState({required this.userName})\n    : controller = TextEditingController();\n}\n```\n\n**Option 2: Nullable with null checks**\n```dart\nclass _MyWidgetState extends State<MyWidget> {\n  String? userName;\n  TextEditingController? controller;\n\n  void someMethod() {\n    if (userName != null) {\n      print(userName!.length);\n    }\n  }\n}\n```\n\n**Option 3: Initialize with default**\n```dart\nclass _MyWidgetState extends State<MyWidget> {\n  String userName = '';\n  TextEditingController controller = TextEditingController();\n}\n```\n\n**When acceptable**:\n- Dependency injection frameworks that guarantee initialization (GetIt, Injectable, Riverpod)\n- Framework patterns with guaranteed initialization order\n- When initialization must be deferred AND you have clear guarantees\n\n**Example of acceptable use**:\n```dart\nclass MyService {\n  late final Database db;  // OK: Injectable guarantees initialization\n\n  @injectable\n  MyService() {\n    // Injectable framework initializes db before use\n  }\n}\n```\n\n---\n\n### 4. Bloc Anti-patterns {#bloc_anti_patterns}\n\n**Only checked if `flutter_bloc` or `bloc` is in pubspec.yaml**\n\n#### 4.1 Public Fields in BLoC {#bloc_public_fields}\n\n**Pattern to detect**:\n```dart\nclass UserBloc extends Bloc<UserEvent, UserState> {\n  String userName; // BAD: Public field\n}\n```\n\n**Why**: Breaks encapsulation, allows external state modification.\n\n**Fix**: Use private fields and expose through state.\n\n#### 4.2 Public Methods in BLoC {#bloc_public_methods}\n\n**Pattern to detect**:\n```dart\nclass UserBloc extends Bloc<UserEvent, UserState> {\n  void updateUser(User user) { ... } // BAD: Public method\n}\n```\n\n**Why**: BLoCs should only respond to events.\n\n**Fix**: Create an event and use `add()`.\n\n#### 4.3 Mutable Events {#bloc_mutable_events}\n\n**Pattern to detect**:\n```dart\nclass UpdateUserEvent extends UserEvent {\n  String name; // BAD: Mutable\n}\n```\n\n**Fix**:\n```dart\n@immutable\nclass UpdateUserEvent extends UserEvent {\n  final String name;\n  const UpdateUserEvent(this.name);\n}\n```\n\n#### 4.4 Non-sealed States {#bloc_non_sealed_states}\n\n**Pattern to detect**:\n```dart\nclass UserState { ... } // BAD: Not sealed/final\n```\n\n**Fix**:\n```dart\nsealed class UserState {}\nfinal class UserInitial extends UserState {}\nfinal class UserLoaded extends UserState {}\n```\n\n---\n\n### 5. Provider Anti-patterns {#provider_anti_patterns}\n\n**Only checked if `provider` is in pubspec.yaml**\n\n#### 5.1 context.read() in build {#provider_read_in_build}\n\n**Pattern to detect**:\n```dart\n@override\nWidget build(BuildContext context) {\n  final value = context.read<MyProvider>().value; // BAD\n  return Text(value);\n}\n```\n\n**Why**: Won't rebuild when provider changes.\n\n**Fix**: Use `context.watch<MyProvider>()`\n\n#### 5.2 Not Using Provider Extensions {#provider_old_syntax}\n\n**Pattern to detect**:\n```dart\nProvider.of<MyProvider>(context, listen: true) // OLD\n```\n\n**Fix**:\n```dart\ncontext.watch<MyProvider>() // NEW\ncontext.read<MyProvider>()  // For non-rebuild access\n```\n\n#### 5.3 Missing Disposal in ChangeNotifier {#provider_missing_disposal}\n\n**Pattern to detect**:\n```dart\nclass MyProvider extends ChangeNotifier {\n  final controller = TextEditingController();\n  // Missing dispose\n}\n```\n\n**Fix**:\n```dart\n@override\nvoid dispose() {\n  controller.dispose();\n  super.dispose();\n}\n```\n\n---\n\n### 6. Logic Issues (Important) {#logic_issues_important}\n\n**Incorrect comparison operators**: {#incorrect_operators}\n```dart\n// BAD: Using = instead of ==\nif (status = 'active') { ... }\n\n// BAD: Comparing incompatible types\nif (intValue == 'string') { ... }\n```\n\n**Missing edge case handling**: {#missing_edge_cases}\n```dart\n// BAD: No empty check\nfinal first = list.first;\n\n// GOOD\nif (list.isEmpty) return;\nfinal first = list.first;\n```\n\n**Off-by-one errors**: {#off_by_one_errors}\n```dart\n// BAD: Index out of bounds\nfor (int i = 0; i <= list.length; i++) { ... }\n\n// GOOD\nfor (int i = 0; i < list.length; i++) { ... }\n```\n\n---\n\n## P2 Checks (Code Quality)\n\n### 1. Magic Numbers {#magic_numbers}\n\n**What it detects**: Hardcoded numbers without context (except 0, 1, -1).\n\n**Pattern to detect**:\n```dart\nif (status == 3) { ... } // What is 3?\nTimer(Duration(seconds: 3600), ...); // What is 3600?\n```\n\n**Exceptions**:\n- Widget dimensions/padding when obvious: `SizedBox(height: 16)`\n- Common values: 0, 1, -1, 2 (for doubling)\n\n**Suggested fix**:\n```dart\nconst int statusActive = 3;\nconst int secondsInHour = 3600;\n```\n\n---\n\n### 2. TODO/FIXME Comments {#todo_comments}\n\n**What it detects**: Comments indicating incomplete work.\n\n**Pattern to detect**:\n- `// TODO: ...`\n- `// FIXME: ...`\n- `// HACK: ...`\n\n**Why track**: Indicates areas needing attention before merge.\n\n---\n\n### 2.1 Function Ordering {#function_ordering}\n\n**What it detects**: Private methods (starting with `_`) placed before public methods in a class.\n\n**Why it matters**: Code readability and maintainability. Public methods form the API of a class and should be easy to find at the top. Private implementation details should follow after.\n\n**Pattern to detect**:\n```dart\nclass UserService {\n  // BAD: Private methods first\n  String _formatName(String name) { ... }\n\n  Future<void> _validateUser(User user) { ... }\n\n  // Public methods buried below\n  Future<User> getUser(String id) { ... }\n\n  void updateUser(User user) { ... }\n}\n```\n\n**Suggested fix**:\n```dart\nclass UserService {\n  // GOOD: Public methods first (the public API)\n  Future<User> getUser(String id) {\n    // Uses private helper\n    return _fetchAndValidate(id);\n  }\n\n  void updateUser(User user) {\n    final formatted = _formatUser(user);\n    // ...\n  }\n\n  // Private implementation details after\n  Future<User> _fetchAndValidate(String id) { ... }\n\n  User _formatUser(User user) { ... }\n}\n```\n\n**Benefits of proper ordering**:\n1. **Easier to understand the class API** - readers see what the class does first\n2. **Better code navigation** - public interface is at the top where you look first\n3. **Follows Flutter/Dart conventions** - matches standard practice in framework code\n4. **Logical flow** - \"what\" before \"how\"\n\n**Recommended class member order**:\n1. Static constants\n2. Instance fields (public, then private)\n3. Constructors\n4. Public methods\n5. Private methods\n6. Static methods (public, then private)\n\n**Widget-specific method ordering**:\n\nFor StatefulWidget State classes, lifecycle methods have a specific order:\n\n```dart\nclass _MyWidgetState extends State<MyWidget> {\n  // 1. Fields\n  final controller = TextEditingController();\n  int _counter = 0;\n\n  // 2. initState - initialization logic\n  @override\n  void initState() {\n    super.initState();\n    // Setup code\n  }\n\n  // 3. Other lifecycle methods (before build)\n  @override\n  void didChangeDependencies() {\n    super.didChangeDependencies();\n  }\n\n  @override\n  void didUpdateWidget(MyWidget oldWidget) {\n    super.didUpdateWidget(oldWidget);\n  }\n\n  // 4. dispose - cleanup logic\n  @override\n  void dispose() {\n    controller.dispose();\n    super.dispose();\n  }\n\n  // 5. build - UI rendering (after all lifecycle methods)\n  @override\n  Widget build(BuildContext context) {\n    return Container();\n  }\n\n  // 6. Public methods\n  void publicMethod() { ... }\n\n  // 7. Private helper methods\n  void _privateHelper() { ... }\n\n  Widget _buildSection() { ... }\n}\n```\n\n**Bad example** (incorrect order):\n```dart\nclass _MyWidgetState extends State<MyWidget> {\n  // BAD: build before initState\n  @override\n  Widget build(BuildContext context) { ... }\n\n  @override\n  void initState() { ... }\n\n  // BAD: didUpdateWidget after build\n  @override\n  void didUpdateWidget(MyWidget oldWidget) { ... }\n\n  // BAD: Private method before dispose\n  Widget _buildHeader() { ... }\n\n  @override\n  void dispose() { ... }\n}\n```\n\n**Why this order matters for widgets**:\n1. **Lifecycle grouping** - All lifecycle methods together before build\n2. **Mental model** - Easy to understand the widget's lifecycle at a glance\n3. **Flutter conventions** - Follows the pattern used in Flutter framework and documentation\n4. **Debugging efficiency** - When issues occur, you check lifecycle methods in order\n\n**Complete widget method priority**:\n1. `initState()` - First lifecycle method called\n2. `didChangeDependencies()` - Called after initState and when dependencies change\n3. `didUpdateWidget()` - When widget configuration changes\n4. `dispose()` - Cleanup\n5. `build()` - The main rendering method (always after lifecycle methods)\n6. Other public methods\n7. Private helper methods (including `_build*` helpers)\n\n---\n\n### 3. Long Classes (>500 lines) {#long_classes}\n\n**What it detects**: Classes exceeding 500 lines of code.\n\n**Why it matters**: Violates Single Responsibility Principle, hard to maintain, often contains dead or duplicate code.\n\n**Detection methodology**:\n1. Count total lines in class (excluding comments and blank lines)\n2. If >500 lines, review for:\n   - Unused private methods (never called)\n   - Commented-out code blocks\n   - Duplicate logic that could be extracted\n   - Methods that belong in separate classes\n\n**Suggested fixes**:\n1. Split into multiple focused classes by responsibility\n2. Extract utility methods to separate utility classes\n3. Use mixins for shared behavior\n4. Remove dead code (unused methods, commented blocks)\n5. Deduplicate similar logic into shared methods\n\n**Refactoring approach**:\n```dart\n// BEFORE: 600-line OrderService with multiple responsibilities\nclass OrderService {\n  // Validation (100 lines)\n  // Calculation (150 lines)\n  // Payment processing (200 lines)\n  // Email notifications (150 lines)\n}\n\n// AFTER: Split by responsibility\nclass OrderService {\n  final OrderValidator validator;\n  final OrderCalculator calculator;\n  final PaymentProcessor paymentProcessor;\n  final NotificationService notificationService;\n\n  // 50 lines - orchestrates other services\n}\n\nclass OrderValidator { /* 80 lines */ }\nclass OrderCalculator { /* 120 lines */ }\nclass PaymentProcessor { /* 180 lines */ }\nclass NotificationService { /* 130 lines */ }\n```\n\n---\n\n### 4. Moderate Nesting (3-4 levels) {#moderate_nesting}\n\n**What it detects**: Nesting depth of 3-4 levels.\n\n**Why note**: Not critical but consider simplification for readability.\n\n---\n\n## Detection Methodology\n\n### How to Identify Issues\n\n1. **Read the full file** to understand context\n2. **Focus on git diff** - only check changed/added lines\n3. **Understand the file type**:\n   - Widget files: Check lifecycle, mounted, dispose\n   - BLoC files: Check encapsulation, events, states\n   - Provider files: Check disposal, context usage\n   - Model files: Check immutability, equality\n   - Service files: Check error handling, async patterns\n\n4. **Look for patterns** using regex and code analysis:\n   - Search for force unwrap operators\n   - Search for `setState` and check mounted\n   - Search for controller declarations and verify dispose\n   - Count nesting levels\n   - Count line numbers\n\n5. **Verify with context** - don't flag false positives:\n   - Is this in a test file? (more lenient)\n   - Is this generated code? (skip)\n   - Is there a good reason? (e.g., null check above)\n\n---\n\n## Priority Assignment Logic\n\n**Assign P0 if**:\n- Can cause app crash\n- Can cause data loss\n- Can cause security vulnerability\n- Memory leak\n\n**Assign P1 if**:\n- Can cause logic bug\n- Violates architectural pattern\n- Significantly impacts readability\n- Makes code hard to maintain\n\n**Assign P2 if**:\n- Code quality improvement\n- Readability enhancement\n- Best practice suggestion\n- No immediate functional impact\n\n---\n\n## Dependency-Specific Patterns\n\n### Bloc Pattern {#bloc_pattern}\n\n**When to apply**: When flutter_bloc or bloc package is in pubspec.yaml dependencies.\n\n**State Pattern**:\n```dart\nsealed class UserState {}\n\nfinal class UserInitial extends UserState {}\n\nfinal class UserLoading extends UserState {}\n\nfinal class UserLoaded extends UserState {\n  final User user;\n  UserLoaded(this.user);\n}\n\nfinal class UserError extends UserState {\n  final String message;\n  UserError(this.message);\n}\n```\n\n**Event Pattern**:\n```dart\n@immutable\nsealed class UserEvent {}\n\nfinal class LoadUser extends UserEvent {\n  final String userId;\n  const LoadUser(this.userId);\n}\n\nfinal class UpdateUser extends UserEvent {\n  final User user;\n  const UpdateUser(this.user);\n}\n```\n\n**Bloc Implementation**:\n```dart\nclass UserBloc extends Bloc<UserEvent, UserState> {\n  final UserRepository _repository;  // Private field\n\n  UserBloc(this._repository) : super(UserInitial()) {\n    on<LoadUser>(_onLoadUser);\n    on<UpdateUser>(_onUpdateUser);\n  }\n\n  // Private event handlers\n  Future<void> _onLoadUser(LoadUser event, Emitter<UserState> emit) async {\n    emit(UserLoading());\n    try {\n      final user = await _repository.getUser(event.userId);\n      emit(UserLoaded(user));\n    } catch (e) {\n      emit(UserError(e.toString()));\n    }\n  }\n\n  Future<void> _onUpdateUser(UpdateUser event, Emitter<UserState> emit) async {\n    // Implementation\n  }\n}\n```\n\n**UI Usage**:\n```dart\nBlocBuilder<UserBloc, UserState>(\n  builder: (context, state) {\n    return switch (state) {\n      UserInitial() => Text('No user'),\n      UserLoading() => CircularProgressIndicator(),\n      UserLoaded(:final user) => UserProfile(user),\n      UserError(:final message) => Text('Error: $message'),\n    };\n  },\n)\n```\n\n### Provider Pattern {#provider_pattern}\n\n**When to apply**: When provider package is in pubspec.yaml dependencies.\n\n**ChangeNotifier Pattern**:\n```dart\nclass CounterProvider extends ChangeNotifier {\n  int _count = 0;\n  final TextEditingController _controller = TextEditingController();\n\n  int get count => _count;\n\n  void increment() {\n    _count++;\n    notifyListeners();\n  }\n\n  @override\n  void dispose() {\n    _controller.dispose();  // Always dispose resources\n    super.dispose();\n  }\n}\n```\n\n**Usage Patterns**:\n\n**1. context.watch() - Reactive rebuilds**\n```dart\n@override\nWidget build(BuildContext context) {\n  final count = context.watch<CounterProvider>().count;\n  return Text('Count: $count');  // Rebuilds when count changes\n}\n```\n\n**2. context.read() - One-time access**\n```dart\nonPressed: () {\n  context.read<CounterProvider>().increment();  // Doesn't cause rebuild\n}\n```\n\n**3. context.select() - Selective rebuilds**\n```dart\n@override\nWidget build(BuildContext context) {\n  // Only rebuilds when user.name changes, not entire user\n  final name = context.select<UserProvider, String>(\n    (provider) => provider.user.name\n  );\n  return Text('Hello, $name');\n}\n```\n\n**Provider Setup**:\n```dart\nvoid main() {\n  runApp(\n    MultiProvider(\n      providers: [\n        ChangeNotifierProvider(create: (_) => CounterProvider()),\n        ChangeNotifierProvider(create: (_) => UserProvider()),\n      ],\n      child: MyApp(),\n    ),\n  );\n}\n```\n",
        "plugins/flutter-tools/skills/flutter-review/workflow.md": "# Flutter Review - Execution Workflow\n\nThis workflow provides a 5-step intelligent code review process for Flutter/Dart code analysis, designed for efficiency, accuracy, and actionable feedback.\n\n## Overview\n\nThis workflow analyzes Flutter code changes efficiently using git diff, selective file reading, and priority-based analysis (P0/P1/P2). It focuses on catching critical bugs before they reach production while maintaining developer velocity.\n\n---\n\n## Step 1: Understand What Changed\n\n**Get the complete diff efficiently:**\n\n```bash\ngit diff origin/main..HEAD\n```\n\n**Parse the output to identify:**\n\n- Current branch name\n- List of changed .dart files (count them)\n- Specific changes (additions/deletions) per file\n- Line numbers where changes occurred\n\n**Early exit:** If no Dart files changed, inform user and exit gracefully.\n\n**Inform user with context:**\n\n```\nReviewing X Dart files changed on branch {branch_name}\n```\n\n---\n\n## Step 2: Gather Context\n\n**Check dependencies** to enable pattern-specific checks:\n\n```bash\ncat pubspec.yaml\n```\n\nDetect:\n\n- flutter_bloc or bloc ‚Üí Enable Bloc anti-pattern checks\n- provider ‚Üí Enable Provider anti-pattern checks\n- Flutter SDK version for context\n\n**Cache this information** - don't re-read for each file.\n\n---\n\n## Step 3: Analyze Code Intelligently\n\n**Primary analysis from git diff:**\n\n- Focus on lines that were added or modified (marked with + in diff)\n- The diff includes surrounding context lines - use them\n- Identify the type of change (new code, modification, deletion)\n\n**Read full files selectively - only when:**\n\n- Diff context is insufficient to understand the logic\n- Changed code introduces controllers, streams, subscriptions, or listeners\n  - **Must verify disposal** in dispose method (even if dispose method wasn't changed)\n- Need to check imports or class structure not visible in diff\n- Example: If TextEditingController added in changed lines, verify it's disposed\n\n**File categorization guides analysis:**\n\n- Widget (StatefulWidget/StatelessWidget) ‚Üí Check lifecycle, mounted, dispose\n- BLoC (extends Bloc/Cubit) ‚Üí Check encapsulation, events, states\n- Provider (extends ChangeNotifier) ‚Üí Check disposal, context usage\n- Model/Entity ‚Üí Check immutability\n- Service/Repository ‚Üí Check error handling, async patterns\n\n---\n\n## Step 4: Apply Priority-Based Analysis\n\n**Analyze code using the flutter-review skill:**\n\nThe flutter-review skill contains all check definitions organized by priority (P0/P1/P2). Apply these checks intelligently based on:\n\n- **File type**: Widget, BLoC, Provider, Model, or Service\n- **Detected dependencies**: flutter_bloc, provider, or other packages\n- **Code context**: Production code vs tests vs generated code\n- **Changed lines**: Focus on additions/modifications but verify related code when needed\n\n**Smart application:**\n\n- When new controllers/streams/subscriptions are added, verify disposal even if dispose method wasn't changed\n- Enable dependency-specific checks (Bloc/Provider patterns) only when dependencies detected\n- Skip checks for generated files (_.g.dart, _.freezed.dart)\n- Be lenient with test files unless issues are truly problematic\n- Always understand intent before flagging - context matters\n\n---\n\n## Step 5: Save and Present Results\n\n**Create output directory:**\n\n```bash\nmkdir -p /tmp/flutter_review\n```\n\n**Generate filename:**\nPattern: YYYYMMDD_HHmm-{repo-name}-{branch-name}-{6-char-random-id}.md\nExample: 20260104_1430-my_app-feature_login-a3f9d2.md\n\n**Report structure:**\n\n```markdown\n# Flutter Code Review\n\n**Repository**: {repo-name}\n**Branch**: {branch-name} | **Files**: {X} | **Lines**: +{added}/-{removed}\n**Reviewed**: {YYYY-MM-DD HH:mm:ss}\n**Base**: origin/main | **Review ID**: {random-id}\n**Packages**: {bloc/provider/none}\n\n---\n\n## Summary\n\n| Priority          | Count   | Status                     |\n| ----------------- | ------- | -------------------------- |\n| üö® Critical (P0)  | {count} | {‚úÖ Pass / ‚ùå Must Fix}    |\n| ‚ö†Ô∏è Important (P1) | {count} | {‚úÖ Pass / ‚ö° Recommended} |\n| üí° Quality (P2)   | {count} | {‚úÖ Pass / üí¨ Optional}    |\n\n**Recommendation**: {üî¥ BLOCK / üü° REVIEW NEEDED / üü¢ APPROVED}\n\n---\n\n## üö® Critical Issues (Must Fix)\n\n[P0 issues with file:line, problem, current code, fixed code]\n\n## ‚ö†Ô∏è Important Issues (Recommended)\n\n[P1 issues - use table format if >3 issues, detailed format if ‚â§3]\n\n## üí° Code Quality Suggestions\n\n[P2 issues grouped by category]\n\n## Next Steps\n\n[Clear actions based on findings]\n\n---\n\n_Review saved to: /tmp/flutter_review/{filename}.md_\n```\n\n**Display to user based on recommendation:**\n\nIf üî¥ BLOCK or üü° REVIEW NEEDED (P0 or P1 issues exist):\n\n- Review complete! Found {P0} critical and {P1} important issues.\n- Results saved to: /tmp/flutter_review/{filename}.md\n- **Would you like me to fix these issues automatically?**\n\nIf üü¢ APPROVED (no P0 or P1):\n\n- Review complete! Code quality looks excellent.\n- Found {P2} optional suggestions (see report for details)\n- Results saved to: /tmp/flutter_review/{filename}.md\n\n---\n\n## Step 6: Offer to Fix Issues\n\n**If user agrees to automatic fixes:**\n\n- Fix P0 issues first, then P1\n- Fix one file at a time\n- Show what was changed after each fix\n- Optionally re-run review to verify all fixes\n\n---\n\n## Key Principles for Execution\n\n1. **Be Efficient**\n\n   - Single git diff operation (not per-file)\n   - Selective file reading (only when needed)\n   - Parallel tool calls for independent operations when possible\n   - Cache information (don't re-read pubspec.yaml)\n\n2. **Be Intelligent**\n\n   - Use your judgment to adapt to the codebase\n   - Make smart decisions about when to read full files\n   - Understand the difference between patterns and anti-patterns in context\n\n3. **Be Accurate**\n\n   - Avoid false positives\n   - When uncertain whether something is an issue, skip it or mark as P2\n   - Always read surrounding code to determine intent\n\n4. **Be Actionable**\n\n   - Every issue must have a clear, copy-paste ready fix\n   - Include file path, line number, and code snippets\n   - Show both problematic code and corrected version\n\n5. **Be Thorough Yet Focused**\n   - Prioritize correctly: P0 = crashes/bugs, P1 = logic/patterns, P2 = quality\n   - Check for lifecycle issues even when dispose method wasn't changed\n   - Don't miss memory leaks or null safety violations\n   - **CRITICAL**: Follow the recommendation guidelines from the flutter-review skill\n   - **ALWAYS ask user if they want to fix issues when P0 or P1 exist**\n\n---\n\n## Performance Guidelines\n\nAim for efficiency without sacrificing accuracy:\n\n- **Small PR** (1-5 files, <500 lines): ~4-8 tool calls\n- **Medium PR** (6-15 files, 500-2000 lines): ~6-15 tool calls\n- **Large PR** (15+ files, >2000 lines): ~8-25 tool calls\n\n**Red flags indicating inefficient execution:**\n\n- Multiple git diff commands (should only be 1)\n- Reading every changed file completely (should be selective)\n- Re-reading pubspec.yaml multiple times\n\n---\n\n## Remember\n\n- Save results to /tmp/flutter_review/ for user reference\n- Use your intelligence - these are guidelines, not rigid rules\n- Focus on helping developers ship better code\n- Be respectful and constructive in feedback\n",
        "plugins/plugin-development/.claude-plugin/plugin.json": "{\n  \"name\": \"plugin-development\",\n  \"version\": \"1.3.0\",\n  \"description\": \"A comprehensive toolkit for creating, validating, and distributing Claude Code plugins\",\n  \"author\": {\n    \"name\": \"Ivan Magda\",\n    \"email\": \"ivan.magda@outlook.com\",\n    \"url\": \"https://github.com/ivan-magda\"\n  },\n  \"homepage\": \"https://github.com/ivan-magda/claude-code-plugin-template\",\n  \"repository\": \"https://github.com/ivan-magda/claude-code-plugin-template\",\n  \"license\": \"MIT\",\n  \"keywords\": [\n    \"plugin-development\",\n    \"plugin-authoring\",\n    \"cli-tools\",\n    \"validation\",\n    \"scaffolding\"\n  ]\n}\n",
        "plugins/plugin-development/README.md": "# plugin-development\n\nA comprehensive Claude Code plugin that assists developers in creating, validating, and distributing Claude Code plugins‚Äîfrom scaffold to release.\n\n## Overview\n\nThe `plugin-development` plugin provides a complete toolkit for plugin authorship using a hybrid architecture:\n\n- **Skill (plugin-authoring)**: Ambient, auto-discovered guidance with progressive disclosure\n- **7 Slash Commands**: Explicit actions for scaffolding, validation, and testing\n- **Reviewer Agent**: Deep, multi-file audits and readiness checks\n- **Hooks**: Automated validation and formatting guardrails\n\n## Installation\n\nThis plugin is part of the **Claude Code Plugin Marketplace Template**. To use it:\n\n### Quick Start (Recommended for First-Time Users)\n\n```bash\n# From the template root directory\n/plugin marketplace add .\n\n# Install the plugin\n/plugin install plugin-development@claude-code-plugin-template\n```\n\n### For Team Marketplaces\n\nIf you're using this template to create your own marketplace:\n\n1. **Set up your marketplace** (see the [main README](../../README.md) for instructions)\n2. **Add your marketplace to Claude Code**:\n   ```bash\n   /plugin marketplace add your-org/your-marketplace-repo\n   ```\n3. **Install the plugin**:\n   ```bash\n   /plugin install plugin-development@your-marketplace-name\n   ```\n\n### Local Development Setup\n\nIf you want to use this for developing new plugins:\n\n```bash\n# From the template root directory\ncd /path/to/claude-code-plugin-template\n\n# Add the marketplace\n/plugin marketplace add .\n\n# Install this plugin\n/plugin install plugin-development@claude-code-plugin-template\n```\n\nThen use it to scaffold new plugins:\n\n```bash\n/plugin-development:init my-new-plugin\n```\n\n## Quick Start\n\n> **Before you begin**: Make sure you've installed this plugin following the [Installation](#installation) instructions above.\n\n### Create a New Plugin\n\nOnce installed, you can scaffold a new plugin:\n\n```bash\n/plugin-development:init my-awesome-plugin\n```\n\nThis scaffolds:\n- `.claude-plugin/plugin.json` - Plugin manifest\n- `commands/` - Slash commands directory\n- `agents/` - Sub-agents directory\n- `skills/` - Skills directory\n- `hooks/hooks.json` - Hook configuration\n- `scripts/` - Validation scripts\n- `README.md` - Documentation template\n\n### Add Components\n\n```bash\n# Add a command\n/plugin-development:add-command format-code \"Format code according to project standards\"\n\n# Add a skill\n/plugin-development:add-skill code-review \"Use when reviewing code or PRs\"\n\n# Add an agent\n/plugin-development:add-agent security-auditor \"Analyzes code for security vulnerabilities\"\n\n# Add a hook\n/plugin-development:add-hook PreToolUse \"Write|Edit\"\n```\n\n### Validate Your Plugin\n\n```bash\n/plugin-development:validate\n```\n\nChecks:\n- Plugin structure and organization\n- Manifest validity (plugin.json)\n- Component configuration\n- Naming conventions\n- Hook safety\n\n### Test Locally\n\nAfter creating your plugin and making it available in a marketplace:\n\n```bash\n# From your plugin directory\n/plugin-development:test-local\n```\n\nThis creates a dev marketplace and provides installation instructions for iterative testing. See the [Testing Your Plugin](#testing-your-plugin) section below for complete workflow details.\n\n## Commands Reference\n\n| Command | Description |\n|---------|-------------|\n| `/plugin-development:init [name]` | Scaffold a new plugin with standard structure |\n| `/plugin-development:add-command [name] [desc]` | Add a new slash command |\n| `/plugin-development:add-skill [name] [desc]` | Add a new Skill with SKILL.md |\n| `/plugin-development:add-agent [name] [desc]` | Add a new sub-agent |\n| `/plugin-development:add-hook [event] [matcher]` | Add a hook configuration |\n| `/plugin-development:validate` | Validate plugin structure and configuration |\n| `/plugin-development:test-local` | Create dev marketplace for local testing |\n\n## Skill: plugin-authoring\n\nThe plugin-authoring Skill provides ambient guidance throughout your development session.\n\n**Triggers**: Automatically activates when working with:\n- `.claude-plugin/plugin.json`\n- `marketplace.json`\n- `commands/`, `agents/`, `skills/`, or `hooks/` directories\n\n**Capabilities**:\n- Read-only analysis and guidance\n- Progressive disclosure (links to detailed docs)\n- Proposes safe actions via commands\n- Escalates to plugin-reviewer agent for deep audits\n\n**Access**: Automatic (no explicit invocation needed)\n\n## Agent: plugin-reviewer\n\nDeep, comprehensive audits of plugins for release readiness.\n\n**Invoke**: `/agents plugin-reviewer`\n\n**Provides**:\n- Structure audit\n- Manifest validation\n- Component analysis\n- Hook safety checks\n- Marketplace readiness assessment\n- Prioritized issue list (Critical ‚Üí Low)\n- Specific fix recommendations\n\n**Runtime**: 5-15 minutes (separate context window)\n\n## Hooks\n\nAutomated validation and formatting hooks are included:\n\n### PreToolUse\n- Validates plugin structure before Write/Edit operations\n- Exit code 2 blocks unsafe operations\n- Provides actionable error messages\n\n### PostToolUse\n- Runs formatting/linting after Write/Edit (stub, extend as needed)\n\n### SessionStart\n- Displays plugin load confirmation\n\n## Development Workflow\n\n### Prerequisites\n\nBefore starting plugin development:\n\n1. **Clone or download this template**:\n   ```bash\n   git clone https://github.com/your-org/claude-code-plugin-template.git\n   cd claude-code-plugin-template\n   ```\n\n2. **Install this plugin** (see [Installation](#installation) above)\n\n3. **Create a new plugin**:\n   ```bash\n   /plugin-development:init my-plugin\n   cd my-plugin/\n   ```\n\n### 1. Initialize\n\nOnce installed, create your plugin:\n\n```bash\ncd my-projects/\n/plugin-development:init my-plugin\ncd my-plugin/\n```\n\n### 2. Add Components\n\n```bash\n/plugin-development:add-command hello \"Greet the user\"\n# Edit commands/hello.md with your instructions\n\n/plugin-development:add-skill my-expertise \"Use when working with X\"\n# Edit skills/my-expertise/SKILL.md\n```\n\n### 3. Validate\n\n```bash\n/plugin-development:validate\n```\n\nFix any errors or warnings.\n\n### 4. Test Locally\n\n```bash\n/plugin-development:test-local\n/plugin marketplace add ../dev-marketplace\n/plugin install my-plugin@dev-marketplace\n```\n\nTest your commands:\n```bash\n/my-plugin:hello\n```\n\n### 5. Iterate\n\nAfter making changes:\n```bash\n/plugin-development:validate\n/plugin uninstall my-plugin@dev-marketplace\n/plugin install my-plugin@dev-marketplace\n# Test again\n```\n\n### 6. Review Before Release\n\n```bash\n/agents plugin-reviewer\n```\n\nFix any critical or high-priority issues identified.\n\n### 7. Distribute\n\nAdd to your team marketplace repository and push to GitHub.\n\n## Documentation\n\nThe plugin includes comprehensive reference material:\n\n### Schemas\n- `schemas/plugin-manifest.md` - plugin.json structure\n- `schemas/hooks-schema.md` - Hooks configuration\n- `schemas/marketplace-schema.md` - Marketplace structure\n\n### Templates\n- `templates/plugin-manifest.json` - Starter plugin.json\n- `templates/marketplace-manifest.json` - Marketplace template\n- `templates/command-template.md` - Command structure\n- `templates/skill-template.md` - Skill structure\n- `templates/agent-template.md` - Agent structure\n\n### Examples\n- `examples/simple-plugin.md` - Complete minimal plugin example\n- `examples/testing-workflow.md` - Step-by-step testing guide\n\n### Best Practices\n- `best-practices/organization.md` - Plugin structure guidelines\n- `best-practices/naming-conventions.md` - Naming standards\n\n## Architecture\n\n### Hybrid Design\n\n**Skill (Read-First)**:\n- Ambient, automatic activation\n- Read-only by default (Read, Grep, Glob)\n- Proposes commands for execution\n- Progressive disclosure keeps it concise\n\n**Commands (Explicit)**:\n- User-triggered actions\n- Deterministic operations\n- Template-based generation\n- Clear consent for modifications\n\n**Agent (Deep Analysis)**:\n- Separate context window\n- Multi-file analysis\n- Comprehensive reporting\n- Use for release readiness\n\n**Hooks (Automation)**:\n- Validation before writes\n- Formatting after writes\n- Automated guardrails\n- Safety first\n\n## Safety & Permissions\n\n### Default Safety\n\n- Skill is **read-only** by default\n- All writes go through **explicit commands**\n- Hooks **block** unsafe operations (exit code 2)\n- Agent **proposes** changes, doesn't execute\n\n### Recommended Permissions\n\nFor enhanced security, configure in `.claude/settings.json`:\n\n```json\n{\n  \"permissions\": {\n    \"deny\": [\n      \"Read(./.env)\",\n      \"Read(./.env.*)\",\n      \"Read(./secrets/**)\"\n    ],\n    \"ask\": [\n      \"SlashCommand:/plugin-development:*\"\n    ]\n  }\n}\n```\n\n## Troubleshooting\n\n### Plugin not loading?\n- Check `/plugin list` to verify installation\n- Verify `plugin.json` doesn't include component fields for standard paths\n- If using custom paths, ensure they're relative (e.g., `[\"./custom/cmd.md\"]`)\n- Run `/plugin-development:validate`\n\n### Commands not showing?\n- Check `/help` for command list\n- Ensure `commands/` has `.md` files with frontmatter\n- Verify `description` field in frontmatter\n- Reinstall the plugin\n\n### Skills not triggering?\n- Check `SKILL.md` frontmatter `name` matches directory (kebab-case)\n- Verify `description` includes both what the Skill does AND when to use it\n- Include specific trigger keywords users would naturally mention\n- Description must be max 1024 characters\n- Skills are model-invoked (automatically activate based on context)\n\n### Hooks not running?\n- Make scripts executable: `chmod +x scripts/*.sh`\n- Use `${CLAUDE_PLUGIN_ROOT}` in hook commands\n- Test script directly: `./scripts/validate-plugin.sh`\n- Use `claude --debug` to see hook execution\n\n## Contributing\n\nThis plugin follows its own best practices:\n- kebab-case naming throughout\n- Progressive disclosure in skills\n- Template-based generation\n- Comprehensive validation\n\nTo extend:\n1. Add new commands in `commands/`\n2. Enhance the skill with new reference docs\n3. Update the reviewer agent with new checks\n4. Add hooks for new automation\n\n## Resources\n\n### Official Documentation\n- [Claude Code Plugins](https://docs.claude.com/en/docs/claude-code/plugins)\n- [Plugin Marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces)\n- [Plugins Reference](https://docs.claude.com/en/docs/claude-code/plugins-reference)\n- [Slash Commands](https://docs.claude.com/en/docs/claude-code/slash-commands)\n\n### Local Documentation\nSee `skills/plugin-authoring/` for:\n- Schemas (plugin manifest, hooks, marketplace)\n- Templates (reusable starter files)\n- Examples (complete working plugins)\n- Best practices (organization, naming)\n\n## License\n\nMIT License - See LICENSE file for details\n\n## Version\n\n**1.0.0** - Initial release\n\n### Features\n- ‚úÖ Plugin scaffolding (init command)\n- ‚úÖ Component generation (add-command, add-skill, add-agent, add-hook)\n- ‚úÖ Validation (validate command)\n- ‚úÖ Local testing (test-local command)\n- ‚úÖ Ambient guidance (plugin-authoring skill)\n- ‚úÖ Deep review (plugin-reviewer agent)\n- ‚úÖ Automated safety (validation hooks)\n- ‚úÖ Comprehensive documentation (schemas, templates, examples, best practices)\n\n## Support\n\nFor issues or questions:\n- **Using the template**: See the [main README](../../README.md) for template setup instructions\n- **Plugin issues**: Check validation output: `/plugin-development:validate`\n- **Best practices**: Review `skills/plugin-authoring/best-practices/`\n- **Deep audit**: Request deep audit: `/agents plugin-reviewer`\n- **Debug mode**: Test with debug mode: `claude --debug`\n",
        "plugins/plugin-development/agents/plugin-reviewer.md": "---\nname: plugin-reviewer\ndescription: Reviews a plugin for correct structure, safe hooks, clear commands and skills, and marketplace readiness. Use PROACTIVELY before releasing or distributing plugins.\ntools: Read, Grep, Glob\nmodel: inherit\npermissionMode: default\n---\n\n<!--\nNOTE: The 'capabilities' field has been removed as it is NOT in official Anthropic docs.\nAgent capabilities are now documented in the body content below.\n-->\n\n# Plugin Reviewer Agent\n\nComprehensive audit of Claude Code plugins for structure, safety, and best practices.\n\n## Purpose\n\nThis agent performs deep, multi-file analysis of plugins to ensure:\n- Correct directory structure and file organization\n- Valid manifests and configuration files\n- Safe hook implementations\n- Clear, well-documented components\n- Marketplace readiness\n- Adherence to naming conventions and best practices\n\n## What This Agent Does\n\n### Structure Audit\n- Verifies standard directory layout\n- Checks file naming conventions\n- Validates component organization\n- Ensures proper separation of concerns\n\n### Manifest Validation\n- Inspects plugin.json for completeness\n- Verifies required fields (name, version, description)\n- Validates path references\n- Checks author and metadata formatting\n\n### Component Analysis\n- **Commands**: Frontmatter, descriptions, argument handling\n- **Skills**: SKILL.md structure, progressive disclosure, trigger clarity\n- **Agents**: Purpose clarity, capability definition, output format\n- **Hooks**: Safety checks, timeout configuration, script permissions\n\n### Hook Safety Checks\n- Verifies scripts use `${CLAUDE_PLUGIN_ROOT}`\n- Checks for timeouts on potentially slow operations\n- Validates exit code handling (blocking vs. non-blocking)\n- Ensures scripts are executable\n- Reviews for security issues (dangerous commands, etc.)\n\n### Marketplace Readiness\n- README.md presence and quality\n- Plugin discoverability (keywords, description)\n- Documentation completeness\n- Testing instructions\n- Distribution readiness\n\n## When to Use This Agent\n\nInvoke this agent when:\n- Preparing a plugin for release or distribution\n- Conducting a comprehensive plugin audit\n- Need detailed, multi-file analysis\n- Want prioritized list of issues to fix\n- Reviewing security and safety posture\n- Before submitting to team marketplace\n\n**Do not use** for:\n- Quick validation (use `/plugin-development:validate` instead)\n- Single-file review\n- Real-time development (too heavyweight)\n\n## How It Proceeds\n\n### Phase 1: Discovery (2-3 minutes)\n\n1. **Locate plugin root**\n   - Find `.claude-plugin/plugin.json`\n   - Identify plugin name and version\n\n2. **Map component structure**\n   - List all commands/agents/skills/hooks\n   - Identify which components are present\n   - Note directory organization\n\n### Phase 2: Detailed Analysis (5-10 minutes)\n\n3. **Manifest deep dive**\n   - Parse and validate plugin.json\n   - Check all fields for correctness\n   - Verify path resolution\n   - Validate SemVer versioning\n\n4. **Component-by-component review**\n   - Read each command file\n   - Analyze each skill directory\n   - Review each agent definition\n   - Inspect hooks configuration\n\n5. **Hook safety analysis**\n   - Read all hook scripts\n   - Check for dangerous patterns\n   - Verify portable paths\n   - Validate timeouts and exit codes\n\n6. **Documentation review**\n   - Check README.md quality\n   - Verify examples are present\n   - Assess discoverability\n\n### Phase 3: Reporting (1-2 minutes)\n\n7. **Categorize findings**\n   - Critical: Must fix before release\n   - High: Should fix soon\n   - Medium: Consider fixing\n   - Low: Nice to have\n\n8. **Generate report**\n   - Summary of findings\n   - Specific issues with locations\n   - Recommendations with examples\n   - Overall readiness assessment\n\n## Output Format\n\n### Report Structure\n\n```markdown\n# Plugin Review: <plugin-name> v<version>\n\n## Summary\n- Plugin: <name>\n- Version: <version>\n- Components: X commands, Y skills, Z agents, hooks: yes/no\n- Overall: Ready / Needs Work / Not Ready\n\n## Critical Issues (Must Fix)\n\n### 1. [Issue Title]\n**Location**: `path/to/file.ext:line`\n**Problem**: [Description of issue]\n**Impact**: [Why this matters]\n**Fix**: [Specific steps to resolve]\n\nExample:\n```\n[Code or config showing the fix]\n```\n\n## High Priority Issues (Should Fix)\n\n### 1. [Issue Title]\n[Same structure as Critical]\n\n## Medium Priority Issues (Consider Fixing)\n\n### 1. [Issue Title]\n[Same structure]\n\n## Low Priority (Nice to Have)\n\n### 1. [Issue Title]\n[Same structure]\n\n## Positive Findings\n\n- ‚úÖ [What the plugin does well]\n- ‚úÖ [Good practices observed]\n\n## Component-Specific Notes\n\n### Commands (X files)\n- [Observations about commands]\n\n### Skills (Y skills)\n- [Observations about skills]\n\n### Agents (Z agents)\n- [Observations about agents]\n\n### Hooks\n- [Observations about hooks]\n\n## Marketplace Readiness\n\n‚úÖ Ready for marketplace\nOR\n‚ùå Not ready - fix critical and high priority issues first\n\nChecklist:\n‚ñ° Structure valid\n‚ñ° Manifest complete\n‚ñ° Components documented\n‚ñ° Hooks safe\n‚ñ° README present\n‚ñ° Examples included\n\n## Recommendations\n\n1. [Priority 1 recommendation]\n2. [Priority 2 recommendation]\n3. [Priority 3 recommendation]\n\n## Next Steps\n\n1. Fix critical issues\n2. Address high priority issues\n3. Re-run: /plugin-development:validate\n4. Test locally: /plugin-development:test-local\n5. Request another review if needed\n```\n\n## Common Issues Detected\n\n### Critical Issues\n\n1. **Absolute paths in configuration**\n   ```json\n   ‚ùå \"commands\": \"/Users/you/plugin/commands\"\n   ‚úÖ \"commands\": \"./commands/\"\n   ```\n\n2. **Hook scripts not executable**\n   ```bash\n   ‚ùå -rw-r--r-- validate.sh\n   ‚úÖ -rwxr-xr-x validate.sh\n   Fix: chmod +x scripts/*.sh\n   ```\n\n3. **Missing required manifest fields**\n   ```json\n   ‚ùå { \"name\": \"plugin\" }\n   ‚úÖ { \"name\": \"plugin\", \"version\": \"1.0.0\", \"description\": \"...\" }\n   ```\n\n4. **Skill name mismatch**\n   ```\n   ‚ùå Directory: code-review/, Frontmatter: name: codeReview\n   ‚úÖ Both: code-review\n   ```\n\n### High Priority Issues\n\n1. **Hooks without timeouts on slow operations**\n   ```json\n   ‚ùå { \"command\": \"npm install\" }\n   ‚úÖ { \"command\": \"npm install\", \"timeout\": 300000 }\n   ```\n\n2. **Commands missing descriptions**\n   ```yaml\n   ‚ùå ---\n       ---\n   ‚úÖ ---\n       description: What the command does\n       ---\n   ```\n\n3. **Skills with vague trigger descriptions**\n   ```yaml\n   ‚ùå description: Helps with code\n   ‚úÖ description: Use when reviewing code, analyzing PRs, or discussing code quality\n   ```\n\n4. **Hook scripts with hardcoded paths**\n   ```bash\n   ‚ùå /Users/you/scripts/validate.sh\n   ‚úÖ ${CLAUDE_PLUGIN_ROOT}/scripts/validate.sh\n   ```\n\n### Security Concerns\n\n1. **Dangerous hook commands**\n   - `rm -rf` without safeguards\n   - Unvalidated user input execution\n   - Credentials in scripts\n\n2. **Overly permissive tool access**\n   ```yaml\n   ‚ö†Ô∏è  allowed-tools: Bash(*)\n   ‚úÖ  allowed-tools: Read, Grep, Glob\n   ```\n\n## Validation Approach\n\n### File-by-File Analysis\n\nFor each component file:\n1. Parse frontmatter (if applicable)\n2. Check required fields\n3. Validate naming conventions\n4. Review content quality\n5. Flag issues with line numbers\n\n### Cross-File Consistency\n\n- Skill names match directories\n- Hook scripts referenced actually exist\n- Paths in plugin.json resolve correctly\n- Naming is consistent throughout\n\n### Best Practice Checks\n\n- Progressive disclosure in skills\n- Clear command descriptions\n- Focused agent capabilities\n- Safe hook implementations\n- Comprehensive documentation\n\n## Tool Access\n\nThis agent has access to:\n- **Read**: Examine all plugin files\n- **Grep**: Search for patterns\n- **Glob**: Find files by pattern\n\nIt does **not** modify files. All fixes are proposed in the report.\n\n## Example Invocation\n\n### From Main Conversation\n\n```\n/agents plugin-reviewer\n```\n\n### Via Task Tool\n\n```\nPlease use the plugin-reviewer agent to conduct a comprehensive audit of this plugin before we distribute it to the team.\n```\n\n### From Skill\n\nThe plugin-authoring skill may escalate:\n```\nFor a thorough review before release, I'll delegate to the plugin-reviewer agent.\n```\n\n## Performance Notes\n\n- **Runtime**: 5-15 minutes depending on plugin size\n- **Context**: Separate from main conversation\n- **Depth**: More thorough than `/plugin-development:validate`\n- **Output**: Single comprehensive report\n\n## After Review\n\n### If Issues Found\n\n1. Review the report carefully\n2. Fix critical issues first\n3. Address high priority issues\n4. Run `/plugin-development:validate` to confirm\n5. Test locally: `/plugin-development:test-local`\n6. Request another review if major changes made\n\n### If Review Passes\n\n1. Plugin is ready for distribution\n2. Add to team marketplace\n3. Update documentation\n4. Announce to team\n\n## Best Practices Applied by This Agent\n\n1. **Safety first**: Hook security is top priority\n2. **Actionable feedback**: Every issue includes fix instructions\n3. **Prioritized**: Issues sorted by severity\n4. **Specific**: Issues include file paths and line numbers\n5. **Balanced**: Notes both problems and positive findings\n6. **Comprehensive**: Covers all aspects of plugin quality\n\n## Limitations\n\n- Does not test runtime behavior (use local testing for that)\n- Does not execute hooks or commands\n- Cannot validate plugin logic correctness\n- Does not check for performance issues\n- Does not validate domain-specific correctness\n\n## Related Tools\n\n- **Quick validation**: `/plugin-development:validate`\n- **Local testing**: `/plugin-development:test-local`\n- **Skill guidance**: plugin-authoring Skill\n- **Debug mode**: `claude --debug` for runtime issues\n",
        "plugins/plugin-development/commands/add-agent.md": "---\ndescription: Add a new sub-agent to the current plugin for specialized tasks\nargument-hint: [agent-name] [\"description\"]\n---\n\n# Add Agent\n\nCreate a new sub-agent file with proper frontmatter and structure.\n\n## Arguments\n\n- `$1` (required): Agent name in kebab-case (e.g., `code-reviewer`)\n- `$2` (optional): Description in quotes (e.g., `\"Reviews code for quality\"`)\n- `--plugin=<plugin-name>` (optional): Specify which plugin to add the agent to\n\n**Usage:**\n```\n# From within a plugin directory, with description\n/plugin-development:add-agent code-reviewer \"Reviews code for quality, security, and best practices\"\n\n# Without description (uses default)\n/plugin-development:add-agent code-reviewer\n\n# From marketplace root, specifying plugin\n/plugin-development:add-agent code-reviewer \"Reviews code for quality, security, and best practices\" --plugin=plugin-development\n```\n\n## Prerequisites\n\n- Must be run from either:\n  - A plugin root directory (containing `.claude-plugin/plugin.json`), OR\n  - A marketplace root directory (containing `.claude-plugin/marketplace.json`)\n- `agents/` directory will be created if needed\n\n## Instructions\n\n### Validation\n\n**IMPORTANT**: When running test commands for validation (checking directories, files, etc.), use `require_user_approval: false` since these are read-only checks.\n\n1. **Detect context and target plugin** (output thoughts during this process):\n   \n   a. Check if we're in a plugin directory:\n      - Look for `.claude-plugin/plugin.json` in current directory\n      - **Output**: \"Checking for plugin directory...\"\n      - If found: \n        - **Output**: \"Found plugin.json - using current directory as target plugin\"\n        - Use current directory as target plugin\n      - If not found:\n        - **Output**: \"Not in a plugin directory, checking for marketplace...\"\n   \n   b. If not in plugin directory, check if we're in marketplace root:\n      - Look for `.claude-plugin/marketplace.json` in current directory\n      - If found: \n        - **Output**: \"Found marketplace.json - this is a marketplace root\"\n        - This is a marketplace root\n      - If not found:\n        - **Output**: \"Error: Neither plugin.json nor marketplace.json found\"\n        - Show error and exit\n   \n   c. If in marketplace root, determine target plugin:\n      - Check if `--plugin=<name>` argument was provided\n      - If yes: \n        - **Output**: \"Using plugin specified via --plugin argument: <name>\"\n        - Use specified plugin name\n      - If no: \n        - **Output**: \"No --plugin argument provided, discovering available plugins...\"\n        - Discover available plugins and prompt user\n   \n   d. **Discover available plugins** (when in marketplace root without --plugin):\n      - **Output**: \"Reading marketplace.json...\"\n      - Read `.claude-plugin/marketplace.json`\n      - Extract plugin names and sources from `plugins` array\n      - **Output**: \"Found [N] plugin(s) in marketplace\"\n      - Alternative: List directories in `plugins/` directory\n      - Present list to user: \"Which plugin should I add the agent to?\"\n      - Options format: `1. plugin-name-1 (description)`, `2. plugin-name-2 (description)`, etc.\n      - Wait for user selection\n      - **Output**: \"Selected plugin: <plugin-name>\"\n   \n   e. **Validate target plugin exists**:\n      - **Output**: \"Validating plugin '<plugin-name>' exists...\"\n      - If plugin specified/selected, verify `plugins/<plugin-name>/.claude-plugin/plugin.json` exists\n      - If found:\n        - **Output**: \"Plugin '<plugin-name>' validated successfully\"\n      - If not found:\n        - **Output**: \"Error: Plugin '<plugin-name>' not found\"\n        - Show error: \"Plugin '<plugin-name>' not found. Available plugins: [list]\"\n   \n   f. If neither plugin.json nor marketplace.json found:\n      - Show error: \"Not in a plugin or marketplace directory. Please run from a plugin root or marketplace root.\"\n\n2. **Validate arguments**:\n   - `$1` (agent name): Not empty, kebab-case format (lowercase with hyphens), no spaces or special characters\n   - `$2` (description): Optional. If not provided, use default: \"Specialized agent for $1 tasks\"\n\n3. **Set working directory**:\n   - If in plugin directory: Use current directory\n   - If in marketplace root: Use `plugins/<plugin-name>/` as working directory\n\n### Create Agent File\n\n**Note**: All paths below are relative to the target plugin directory (determined in validation step).\n\n1. Ensure `agents/` directory exists in target plugin:\n   - Check if `<plugin-dir>/agents/` directory exists\n   - If it doesn't exist, create it (use `require_user_approval: false` for directory creation)\n2. Create `<plugin-dir>/agents/$1.md` with this template:\n\n```markdown\n---\nname: $1\ndescription: $2\ntools: Read, Grep, Glob, Bash\nmodel: inherit\npermissionMode: default\n---\n\n# $1 Agent\n\n[Brief introduction explaining the agent's purpose and specialization]\n\n## Purpose\n\n[Detailed description of what this agent does and why it exists]\n\n## What This Agent Does\n\nThis agent specializes in:\n- [Specialization 1]\n- [Specialization 2]\n- [Specialization 3]\n\n## Capabilities\n\n1. **Capability 1**: [Description of first capability]\n2. **Capability 2**: [Description of second capability]\n3. **Capability 3**: [Description of third capability]\n\n## When to Use This Agent\n\nInvoke this agent when:\n- [Scenario 1: Complex multi-file analysis needed]\n- [Scenario 2: Deep domain expertise required]\n- [Scenario 3: Task needs separate context window]\n\n**Do not use** for:\n- [What this agent doesn't handle]\n- [Tasks better suited for commands or Skills]\n\n## How It Proceeds\n\nThe agent follows this workflow:\n\n1. **Gather Context**: [What files/information it reads]\n2. **Analyze**: [How it evaluates the situation]\n3. **Identify Issues**: [What it looks for]\n4. **Formulate Recommendations**: [What guidance it provides]\n5. **Report Back**: [What it returns to main conversation]\n\n## Output Format\n\nThe agent returns a structured report:\n\n### Critical Issues\n- [Issues that must be fixed]\n\n### Warnings\n- [Issues that should be fixed]\n\n### Suggestions\n- [Nice-to-have improvements]\n\n### Summary\n- [Overall assessment and next steps]\n\n## Tool Access\n\nThis agent has access to:\n- Read: For examining files\n- Grep: For searching content\n- Glob: For finding files\n- [Other tools as needed]\n\nIt does **not** modify files directly; instead, it proposes changes for the main conversation to execute.\n\n## Example Invocation\n\n**From main conversation**:\n```\n/agents $1\n```\n\nor via Task tool:\n```\nUse the $1 agent to [specific task]\n```\n\n## Notes\n\n- Agents operate in a **separate context window**\n- Results are returned as a single message\n- Use for complex, multi-step analysis tasks\n- Keep scope focused to 1-3 specific capabilities\n```\n\n### Update plugin.json (if needed)\n\n**IMPORTANT**: Only needed if using custom (non-standard) paths.\n\n- **Standard setup** (agents in `agents/` directory): No changes to `plugin.json` needed\n- **Custom paths**: Add `\"agents\": [\"./agents/$1.md\"]` (or update existing agents array)\n\n### Provide Feedback\n\nAfter creating the agent:\n\n```\n‚úì Created <plugin-name>/agents/$1.md\n\nPlugin: <plugin-name>\nAgent: $1\nDescription: $2\n\nNext steps:\n1. Edit <plugin-name>/agents/$1.md with specific instructions\n2. Key frontmatter fields:\n   - name: Unique agent identifier (lowercase with hyphens)\n   - description: What the agent does and when to invoke (shows in /agents list)\n   - tools: CSV list of tools (optional, inherits all if omitted)\n   - model: sonnet, opus, haiku, or inherit (optional)\n   - permissionMode: default, acceptEdits, bypassPermissions, or plan (optional)\n   - skills: CSV list of skills to auto-load (optional)\n3. Define clear workflow steps\n4. Specify what the agent returns\n5. Test with /plugin-development:test-local\n\nAgent will be invoked as: /agents $1\nOr via Task tool in main conversation.\n```\n\n## Examples\n\n### Example 1: From Plugin Directory\n\n**Context**: Currently in `/path/to/marketplace/plugins/plugin-development/`\n\n**Input**: \n```\n/plugin-development:add-agent code-reviewer \"Reviews code for quality, security, and best practices\"\n```\n\n**Arguments**:\n- `$1` = `code-reviewer`\n- `$2` = `Reviews code for quality, security, and best practices`\n\n**Process**:\n1. Detects `.claude-plugin/plugin.json` in current directory\n2. Uses current directory as target plugin\n3. Creates `agents/` directory if needed\n4. Creates `agents/code-reviewer.md`\n\n**Result**:\n- Creates `agents/code-reviewer.md` with template\n- Frontmatter description: \"Reviews code for quality, security, and best practices\"\n- Ready to customize with specific review criteria\n\n### Example 2: From Marketplace Root with --plugin\n\n**Context**: Currently in `/path/to/marketplace/` (marketplace root)\n\n**Input**: \n```\n/plugin-development:add-agent code-reviewer \"Reviews code for quality, security, and best practices\" --plugin=plugin-development\n```\n\n**Process**:\n1. Detects `.claude-plugin/marketplace.json` in current directory\n2. Extracts `--plugin=plugin-development` from arguments\n3. Validates `plugins/plugin-development/.claude-plugin/plugin.json` exists\n4. Uses `plugins/plugin-development/` as target\n5. Creates `plugins/plugin-development/agents/code-reviewer.md`\n\n**Result**:\n- Creates `plugins/plugin-development/agents/code-reviewer.md`\n- Agent added to plugin-development plugin\n\n### Example 3: From Marketplace Root without --plugin\n\n**Context**: Currently in `/path/to/marketplace/` (marketplace root)\n\n**Input**: \n```\n/plugin-development:add-agent code-reviewer \"Reviews code for quality, security, and best practices\"\n```\n\n**Process**:\n1. Detects `.claude-plugin/marketplace.json` in current directory\n2. No `--plugin` argument provided\n3. Reads marketplace.json and discovers available plugins:\n   - `hello-world` - A simple example plugin\n   - `plugin-development` - Assist with Claude Code plugin development\n4. Prompts user: \"Which plugin should I add the agent to?\"\n   ```\n   1. hello-world - A simple example plugin demonstrating basic Claude Code plugin functionality\n   2. plugin-development - Assist with Claude Code plugin development: scaffold, validate, review, and team-ready distribution\n   ```\n5. User selects option 2\n6. Uses `plugins/plugin-development/` as target\n7. Creates `plugins/plugin-development/agents/code-reviewer.md`\n\n**Result**:\n- Creates `plugins/plugin-development/agents/code-reviewer.md`\n- Agent added to selected plugin\n\n## Agent Frontmatter\n\n### Required Fields\n\n```yaml\n---\nname: agent-name\ndescription: Third-person description of what this agent does and when to invoke it\n---\n```\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `name` | String | **Required.** Unique identifier using lowercase letters and hyphens (e.g., `code-reviewer`, `test-runner`) |\n| `description` | String | **Required.** Natural language description of when the agent should be invoked. Include \"PROACTIVELY\" for auto-delegation |\n\n### Optional Fields\n\n```yaml\n---\nname: agent-name\ndescription: Agent description. Use PROACTIVELY for auto-delegation.\ntools: Read, Grep, Glob, Bash\nmodel: sonnet\npermissionMode: default\nskills: skill1, skill2\n---\n```\n\n| Field | Type | Default | Description |\n|-------|------|---------|-------------|\n| `tools` | CSV String | Inherits all | Comma-separated list of tools (e.g., `Read, Grep, Glob, Bash`). If omitted, inherits all tools from main thread including MCP tools |\n| `model` | String | `sonnet` | Which AI model to use. Valid values: `sonnet`, `opus`, `haiku`, `inherit`. Use `inherit` to match main conversation's model |\n| `permissionMode` | String | `default` | How the agent handles permission requests. Valid values: `default`, `acceptEdits`, `bypassPermissions`, `plan` |\n| `skills` | CSV String | None | Comma-separated list of skills to auto-load. Note: Agents do NOT inherit skills from parent conversation |\n\n### Permission Modes Explained\n\n| Mode | Behavior |\n|------|----------|\n| `default` | Standard permission handling - prompts for confirmation |\n| `acceptEdits` | Automatically accept file edits without prompting |\n| `bypassPermissions` | Skip permission requests entirely |\n| `plan` | Plan mode - research and planning without execution |\n\n### Model Options\n\n| Model | Description |\n|-------|-------------|\n| `sonnet` | Claude Sonnet (default for subagents) |\n| `opus` | Claude Opus |\n| `haiku` | Claude Haiku (faster, lighter) |\n| `inherit` | Use same model as main conversation |\n\n### Deprecation Note\n\nThe `capabilities` field is **NOT** in official Anthropic docs and may be deprecated. Use `tools` for agents (not `allowed-tools` which is for skills).\n\n**For complete details on agents**, see:\n- [Subagents documentation](https://code.claude.com/docs/en/sub-agents)\n- [Plugin agents reference](https://code.claude.com/docs/en/plugins-reference#agents)\n\n## Error Handling\n\n### Not in Plugin or Marketplace Directory\n\n**Error**: \"Not in a plugin or marketplace directory.\"\n\n**Solution**: Navigate to either:\n- A plugin directory (containing `.claude-plugin/plugin.json`), OR\n- A marketplace root (containing `.claude-plugin/marketplace.json`)\n\n### Plugin Not Found\n\n**Error**: \"Plugin 'my-plugin' not found. Available plugins: hello-world, plugin-development\"\n\n**Solution**: \n- Check plugin name spelling\n- Use `--plugin=<correct-name>` with one of the available plugins\n- Or navigate to the plugin directory directly\n\n### Invalid Agent Name\n\n**Error**: \"Agent name must be in kebab-case format (lowercase with hyphens)\"\n\n**Solution**: Use kebab-case format:\n- ‚úÖ Good: `code-reviewer`, `security-auditor`, `api-generator`\n- ‚ùå Bad: `CodeReviewer`, `code_reviewer`, `code reviewer`\n\n### Missing Description\n\n**Error**: \"Description is required\"\n\n**Solution**: Provide description in quotes:\n```\n/plugin-development:add-agent code-reviewer \"Reviews code for quality, security, and best practices\"\n```\n\n## When to Use Agents vs. Commands vs. Skills\n\n### Use an Agent when:\n- Task requires **deep, multi-file analysis**\n- Need **separate context window** (complex reasoning)\n- Want **detailed, structured report** back\n- Task has **multiple steps** that benefit from isolation\n\n### Use a Command when:\n- Task is **explicit, one-time action**\n- User needs to **trigger on demand**\n- Task is **straightforward** with clear inputs/outputs\n\n### Use a Skill when:\n- Want **ambient, automatic activation**\n- Need **persistent guidance** throughout session\n- Task benefits from **progressive disclosure**\n- Should trigger based on **context clues**\n\n## Agent Design Best Practices\n\n### 1. Focused Scope\n\n‚úÖ **Good** (focused):\n```markdown\n# Code Security Auditor\n\nSpecializes in security analysis:\n- SQL injection vulnerabilities\n- XSS vulnerabilities\n- Authentication issues\n```\n\n‚ùå **Bad** (too broad):\n```markdown\n# General Code Helper\n\nDoes everything related to code.\n```\n\n### 2. Clear Tool Configuration\n\nConfigure appropriate tools for the agent's purpose:\n```yaml\n# For read-only analysis agents:\ntools: Read, Grep, Glob\n\n# For agents that can modify files:\ntools: Read, Edit, Write, Bash, Grep, Glob\n\n# Omit to inherit all tools from main thread\n```\n\n### 3. Structured Output\n\nDefine consistent report format:\n```markdown\n## Critical (P0)\n- [List critical issues]\n\n## High Priority (P1)\n- [List high priority issues]\n\n## Suggestions\n- [List improvements]\n```\n\n### 4. Tool Restrictions\n\nAgents typically don't modify files:\n```markdown\n## Tool Access\n\n- Read, Grep, Glob: For analysis\n- No Write/Edit: Agent proposes, main conversation executes\n```\n\n## Agent Workflow Template\n\nAll agents should follow a consistent structure:\n\n```markdown\n1. **Understand Context**: Read relevant files\n2. **Analyze**: Apply domain expertise\n3. **Identify Issues**: Find problems/opportunities\n4. **Prioritize**: Rank by severity/importance\n5. **Recommend**: Provide actionable guidance\n6. **Report**: Return structured findings\n```\n\n## Common Agent Patterns\n\n### Auditor Pattern\n\nFor review/analysis agents:\n- Reads multiple files\n- Checks against standards/criteria\n- Reports issues by severity\n- Provides specific fix recommendations\n\n### Generator Pattern\n\nFor design/planning agents:\n- Analyzes requirements\n- Proposes architecture/approach\n- Provides implementation steps\n- Returns detailed plan\n\n### Refactoring Pattern\n\nFor code improvement agents:\n- Analyzes existing code\n- Identifies improvement opportunities\n- Proposes refactoring steps\n- Estimates impact/effort\n\n## Invocation Methods\n\n### Direct Invocation\n\nUser explicitly calls the agent:\n```\n/agents code-reviewer\n```\n\n### Via Main Conversation\n\nClaude uses Task tool:\n```\nLet me use the code-reviewer agent to analyze this...\n```\n\n### From Skill\n\nSkill escalates to agent for deep analysis:\n```markdown\nFor comprehensive review, delegate to the code-reviewer agent.\n```\n\n## Best Practices\n\n1. **Single responsibility**: One clear purpose\n2. **Structured output**: Consistent report format\n3. **No side effects**: Read-only, propose changes\n4. **Clear scope**: 2-5 capabilities max\n5. **Fast feedback**: Aim for < 30 seconds runtime\n6. **Actionable results**: Specific, implementable recommendations\n\n## Common Mistakes to Avoid\n\n‚ùå **Too broad description**\n```yaml\ndescription: Does everything related to code\n```\n\n‚úÖ **Focused description with clear purpose**\n```yaml\ndescription: Security audit specialist. Scans for vulnerabilities, reviews authentication, and checks compliance. Use PROACTIVELY after code changes.\n```\n\n‚ùå **Vague instructions**\n```markdown\nAnalyze the code and find problems.\n```\n\n‚úÖ **Specific workflow**\n```markdown\n1. Read all .py files in src/\n2. Check for SQL injection patterns\n3. Verify authentication usage\n4. Report findings by severity\n```\n\n## Validation Checklist\n\nAfter creating an agent:\n```\n‚ñ° Agent file created in agents/ directory\n‚ñ° Frontmatter includes required 'name' field (lowercase with hyphens)\n‚ñ° Frontmatter includes required 'description' field\n‚ñ° Optional: 'tools' field configured (or inherits all)\n‚ñ° Optional: 'model' field set (sonnet/opus/haiku/inherit)\n‚ñ° Optional: 'permissionMode' configured if needed\n‚ñ° Optional: 'skills' listed for auto-loading\n‚ñ° Clear workflow defined in body\n‚ñ° Output format specified\n‚ñ° plugin.json has agents field (if using custom paths)\n‚ñ° Purpose is focused and specific\n```\n",
        "plugins/plugin-development/commands/add-command.md": "---\ndescription: Add a new slash command to the current plugin\nargument-hint: [command-name] [\"description\"]\n---\n\n# Add Command\n\nCreate a new slash command file with proper frontmatter and structure.\n\n## Arguments\n\n- `$1` (required): Command name in kebab-case (e.g., `my-command`)\n- `$2` (optional): Description in quotes (e.g., `\"Format code according to standards\"`)\n- `--plugin=<plugin-name>` (optional): Specify which plugin to add the command to\n\n**Usage:**\n```\n# From within a plugin directory, with description\n/plugin-development:add-command format-code \"Format code according to project standards\"\n\n# Without description (uses default)\n/plugin-development:add-command format-code\n\n# From marketplace root, specifying plugin\n/plugin-development:add-command format-code \"Format code\" --plugin=plugin-development\n```\n\n## Prerequisites\n\n- Must be run from either:\n  - A plugin root directory (containing `.claude-plugin/plugin.json`), OR\n  - A marketplace root directory (containing `.claude-plugin/marketplace.json`)\n- `commands/` directory will be created if needed\n\n## Instructions\n\n### Validation\n\n**IMPORTANT**: When running test commands for validation (checking directories, files, etc.), use `require_user_approval: false` since these are read-only checks.\n\n1. **Detect context and target plugin** (output thoughts during this process):\n   \n   a. Check if we're in a plugin directory:\n      - Look for `.claude-plugin/plugin.json` in current directory\n      - **Output**: \"Checking for plugin directory...\"\n      - If found: \n        - **Output**: \"Found plugin.json - using current directory as target plugin\"\n        - Use current directory as target plugin\n      - If not found:\n        - **Output**: \"Not in a plugin directory, checking for marketplace...\"\n   \n   b. If not in plugin directory, check if we're in marketplace root:\n      - Look for `.claude-plugin/marketplace.json` in current directory\n      - If found: \n        - **Output**: \"Found marketplace.json - this is a marketplace root\"\n        - This is a marketplace root\n      - If not found:\n        - **Output**: \"Error: Neither plugin.json nor marketplace.json found\"\n        - Show error and exit\n   \n   c. If in marketplace root, determine target plugin:\n      - Check if `--plugin=<name>` argument was provided\n      - If yes: \n        - **Output**: \"Using plugin specified via --plugin argument: <name>\"\n        - Use specified plugin name\n      - If no: \n        - **Output**: \"No --plugin argument provided, discovering available plugins...\"\n        - Discover available plugins and prompt user\n   \n   d. **Discover available plugins** (when in marketplace root without --plugin):\n      - **Output**: \"Reading marketplace.json...\"\n      - Read `.claude-plugin/marketplace.json`\n      - Extract plugin names and sources from `plugins` array\n      - **Output**: \"Found [N] plugin(s) in marketplace\"\n      - Alternative: List directories in `plugins/` directory\n      - Present list to user: \"Which plugin should I add the command to?\"\n      - Options format: `1. plugin-name-1 (description)`, `2. plugin-name-2 (description)`, etc.\n      - Wait for user selection\n      - **Output**: \"Selected plugin: <plugin-name>\"\n   \n   e. **Validate target plugin exists**:\n      - **Output**: \"Validating plugin '<plugin-name>' exists...\"\n      - If plugin specified/selected, verify `plugins/<plugin-name>/.claude-plugin/plugin.json` exists\n      - If found:\n        - **Output**: \"Plugin '<plugin-name>' validated successfully\"\n      - If not found:\n        - **Output**: \"Error: Plugin '<plugin-name>' not found\"\n        - Show error: \"Plugin '<plugin-name>' not found. Available plugins: [list]\"\n   \n   f. If neither plugin.json nor marketplace.json found:\n      - Show error: \"Not in a plugin or marketplace directory. Please run from a plugin root or marketplace root.\"\n\n2. **Validate arguments**:\n   - `$1` (command name): Not empty, kebab-case format (lowercase with hyphens), no spaces or special characters\n   - `$2` (description): Optional. If not provided, use default: \"TODO: Add description\"\n\n3. **Set working directory**:\n   - If in plugin directory: Use current directory\n   - If in marketplace root: Use `plugins/<plugin-name>/` as working directory\n\nIf validation fails, provide clear feedback.\n\n### Create Command File\n\n**Note**: All paths below are relative to the target plugin directory (determined in validation step).\n\n1. Ensure `commands/` directory exists in target plugin (create if needed, use `require_user_approval: false`)\n2. Create `<plugin-dir>/commands/$1.md` with this template:\n\n```markdown\n---\ndescription: $2\nargument-hint: [arg1] [arg2]\nallowed-tools: Write, Edit\nmodel: claude-3-5-haiku-20241022\ndisable-model-invocation: false\n---\n\n# $1 Command\n\n[Detailed instructions for Claude on how to execute this command]\n\n## Purpose\n\n[Explain what this command does and when to use it]\n\n## Arguments\n\n- `$ARGUMENTS`: [Describe expected arguments]\n- `$1`, `$2`, etc.: [Individual argument descriptions]\n\n## Instructions\n\n1. [Step 1: First action]\n2. [Step 2: Next action]\n3. [Step 3: Final action]\n\n## Example Usage\n\n**Command**: /<plugin-name>:$1 [args]\n\n**Expected behavior**: [Describe what should happen]\n\n## Notes\n\n[Any additional context, warnings, or tips]\n```\n\n### Update plugin.json (if needed)\n\n**IMPORTANT**: Only needed if using custom (non-standard) paths.\n\n- **Standard setup** (commands in `commands/` directory): No changes to `plugin.json` needed\n- **Custom paths**: Add `\"commands\": [\"./commands/$1.md\"]` (or update existing commands array)\n\n### Provide Feedback\n\nAfter creating the command:\n\n```\n‚úì Created <plugin-name>/commands/$1.md\n\nPlugin: <plugin-name>\nCommand: $1\nDescription: $2\n\nNext steps:\n1. Edit <plugin-name>/commands/$1.md with specific instructions\n2. Update frontmatter fields if needed:\n   - argument-hint: [arg1] [arg2] (optional)\n   - allowed-tools: Tool restrictions (optional)\n   - model: Specify different model (optional)\n   - disable-model-invocation: Prevent SlashCommand tool invocation (optional)\n3. Use @path/to/file syntax to reference files in instructions\n4. Test with /plugin-development:test-local\n\nCommand will be invoked as: /<plugin-name>:$1\n```\n\n## Example\n\n**Input**: \n```\n/plugin-development:add-command format-code \"Format code according to project standards\"\n```\n\n**Arguments**:\n- `$1` = `format-code`\n- `$2` = `Format code according to project standards`\n\n**Result**:\n- Creates `commands/format-code.md` with template\n- Frontmatter description: \"Format code according to project standards\"\n- Ready to edit with specific instructions\n\n**For complete details on commands**, see:\n- [Slash commands documentation](/en/docs/claude-code/slash-commands)\n- [Plugin commands reference](/en/docs/claude-code/plugins-reference#commands)\n\n## Template Details\n\n### Frontmatter\n\n```yaml\n---\ndescription: Brief, third-person description (shows in /help)\nargument-hint: [arg1] [arg2]  # Optional, shows expected arguments\nallowed-tools: Write, Edit    # Optional, restricts tool access\nmodel: claude-3-5-haiku-20241022  # Optional, specify different model\ndisable-model-invocation: true    # Optional, prevents SlashCommand tool from invoking\n---\n```\n\n#### Frontmatter Reference\n\n| Field | Purpose | Default |\n|-------|---------|---------|\n| `description` | Brief description of the command | First line of prompt |\n| `argument-hint` | Expected arguments (shown in auto-complete) | None |\n| `allowed-tools` | List of tools the command can use | Inherits from conversation |\n| `model` | Specific model to use (full ID like `claude-3-5-haiku-20241022`) | Inherits from conversation |\n| `disable-model-invocation` | Prevent SlashCommand tool from calling this command | false |\n\n#### Multiple Invocation Patterns\n\nUse pipe syntax in `argument-hint` to define multiple invocation patterns:\n\n```yaml\n---\ndescription: Manage project tags\nargument-hint: add [tagId] | remove [tagId] | list\n---\n```\n\nThis shows users the different ways to invoke the command.\n\n### Using Arguments\n\nIn the command instructions:\n- `$ARGUMENTS`: All arguments as a single string\n- `$1`, `$2`, etc.: Individual positional arguments\n\nExample:\n```markdown\nIf the user provided a name via `$1`, use it: \"Hello, $1!\"\n```\n\n### File References\n\nInclude file contents using the `@` prefix within your command instructions:\n\n```markdown\n# Reference a specific file\nReview the implementation in @src/utils/helpers.js\n\n# Reference multiple files\nCompare @src/old-version.js with @src/new-version.js\n```\n\nThe file contents will be included inline when the command is executed.\n\n### Command Instructions\n\nWrite clear, step-by-step instructions for Claude:\n- Use imperative mood (\"Create\", \"Validate\", \"Execute\")\n- Be specific about expected behavior\n- Include error handling\n- Provide examples\n\n## Advanced: Bash Preamble\n\nFor commands that need to execute shell commands, add to frontmatter:\n\n```yaml\n---\ndescription: Run tests and report results\nallowed-tools: Bash(npm:*), Bash(pytest:*)\n---\n\n# Instructions\n\n!`npm test`\n\nAnalyze the output and report:\n1. Number of tests passed/failed\n2. Any error messages\n3. Suggestions for fixing failures\n```\n\n**Note**: Bash commands prefixed with `!` are executed before Claude processes the rest of the instructions.\n\n## Best Practices\n\n- **Concise descriptions**: < 100 characters for `description` field\n- **Clear arguments**: Use descriptive names in `argument-hint`\n- **Validation first**: Check arguments before execution\n- **Error handling**: Describe what to do when things go wrong\n- **Examples**: Include usage examples in the template\n\n## SlashCommand Tool\n\nThe `SlashCommand` tool allows Claude to execute custom slash commands programmatically during a conversation.\n\n### Requirements for SlashCommand Tool Support\n\nFor Claude to be able to invoke your command via the SlashCommand tool:\n\n1. **Required**: The `description` frontmatter field must be populated\n2. The command must be user-defined (not a built-in command like `/compact`)\n\n### Character Budget\n\n- **Default limit**: 15,000 characters for slash command content\n- **Customization**: Set `SLASH_COMMAND_TOOL_CHAR_BUDGET` environment variable to adjust\n- **What counts**: Command name, arguments, and description all count toward the budget\n- **When exceeded**: Claude sees only a subset of available commands\n- **Monitoring**: Use `/context` to see warnings displayed as \"M of N commands\"\n\n### Enabling Claude to Use Commands\n\nReference the command in prompts or `CLAUDE.md`:\n\n```\n> Run /write-unit-test when you are about to start writing tests.\n```\n\n### Disabling SlashCommand Tool Invocation\n\nTo prevent a specific command from being invoked by the SlashCommand tool, add to frontmatter:\n\n```yaml\n---\ndescription: My command description\ndisable-model-invocation: true\n---\n```\n\n### Permission Rules\n\nSlashCommand permissions support exact and prefix matching:\n\n```\nSlashCommand:/commit          # Allows only /commit with no arguments\nSlashCommand:/review-pr:*     # Allows /review-pr with any arguments\n```\n\n## Common Mistakes to Avoid\n\n‚ùå **camelCase or PascalCase names**\n```\n/plugin-development:add-command formatCode\n```\n\n‚úÖ **kebab-case names**\n```\n/plugin-development:add-command format-code\n```\n\n‚ùå **Missing description**\n```yaml\n---\nargument-hint: [arg]\n---\n```\n\n‚úÖ **Always include description**\n```yaml\n---\ndescription: What the command does\nargument-hint: [arg]\n---\n```\n\n## Validation Checklist\n\nAfter creating a command:\n```\n‚ñ° File created in commands/ directory\n‚ñ° Frontmatter includes description\n‚ñ° Command name is kebab-case\n‚ñ° Instructions are clear and specific\n‚ñ° Examples provided\n‚ñ° plugin.json has commands field\n```\n",
        "plugins/plugin-development/commands/add-hook.md": "---\ndescription: Add a hook configuration to automate plugin behavior at lifecycle events\nargument-hint: [event-type] [matcher-pattern]\n---\n\n# Add Hook\n\nAdd or update hooks.json with a new hook configuration for automated behavior.\n\n## Arguments\n\n- `$1` (required): Event type (`PreToolUse`, `PostToolUse`, `SessionStart`, `SessionEnd`, `UserPromptSubmit`, `Notification`, `Stop`, `SubagentStop`, or `PreCompact`)\n- `$2` (optional): Matcher pattern (e.g., `Write|Edit` or `.*`)\n- `--plugin=<plugin-name>` (optional): Specify which plugin to add the hook to\n\n**Usage:**\n```\n# From within a plugin directory\n/plugin-development:add-hook PreToolUse \"Write|Edit\"\n\n# From marketplace root, specifying plugin\n/plugin-development:add-hook PreToolUse \"Write|Edit\" --plugin=plugin-development\n```\n\n## Template Variables\n\nWhen generating hook configurations and scripts:\n- `$1`: Event type\n- `$2`: Matcher pattern (or default based on event type)\n- `${CLAUDE_PLUGIN_ROOT}`: Plugin root path (use in all hook commands)\n\n## Prerequisites\n\n- Must be run from either:\n  - A plugin root directory (containing `.claude-plugin/plugin.json`), OR\n  - A marketplace root directory (containing `.claude-plugin/marketplace.json`)\n- `hooks/` directory will be created if needed\n\n## Instructions\n\n### Validation\n\n**IMPORTANT**: When running test commands for validation (checking directories, files, etc.), use `require_user_approval: false` since these are read-only checks.\n\n1. **Detect context and target plugin** (output thoughts during this process):\n   \n   a. Check if we're in a plugin directory:\n      - Look for `.claude-plugin/plugin.json` in current directory\n      - **Output**: \"Checking for plugin directory...\"\n      - If found: \n        - **Output**: \"Found plugin.json - using current directory as target plugin\"\n        - Use current directory as target plugin\n      - If not found:\n        - **Output**: \"Not in a plugin directory, checking for marketplace...\"\n   \n   b. If not in plugin directory, check if we're in marketplace root:\n      - Look for `.claude-plugin/marketplace.json` in current directory\n      - If found: \n        - **Output**: \"Found marketplace.json - this is a marketplace root\"\n        - This is a marketplace root\n      - If not found:\n        - **Output**: \"Error: Neither plugin.json nor marketplace.json found\"\n        - Show error and exit\n   \n   c. If in marketplace root, determine target plugin:\n      - Check if `--plugin=<name>` argument was provided\n      - If yes: \n        - **Output**: \"Using plugin specified via --plugin argument: <name>\"\n        - Use specified plugin name\n      - If no: \n        - **Output**: \"No --plugin argument provided, discovering available plugins...\"\n        - Discover available plugins and prompt user\n   \n   d. **Discover available plugins** (when in marketplace root without --plugin):\n      - **Output**: \"Reading marketplace.json...\"\n      - Read `.claude-plugin/marketplace.json`\n      - Extract plugin names and sources from `plugins` array\n      - **Output**: \"Found [N] plugin(s) in marketplace\"\n      - Alternative: List directories in `plugins/` directory\n      - Present list to user: \"Which plugin should I add the hook to?\"\n      - Options format: `1. plugin-name-1 (description)`, `2. plugin-name-2 (description)`, etc.\n      - Wait for user selection\n      - **Output**: \"Selected plugin: <plugin-name>\"\n   \n   e. **Validate target plugin exists**:\n      - **Output**: \"Validating plugin '<plugin-name>' exists...\"\n      - If plugin specified/selected, verify `plugins/<plugin-name>/.claude-plugin/plugin.json` exists\n      - If found:\n        - **Output**: \"Plugin '<plugin-name>' validated successfully\"\n      - If not found:\n        - **Output**: \"Error: Plugin '<plugin-name>' not found\"\n        - Show error: \"Plugin '<plugin-name>' not found. Available plugins: [list]\"\n   \n   f. If neither plugin.json nor marketplace.json found:\n      - Show error: \"Not in a plugin or marketplace directory. Please run from a plugin root or marketplace root.\"\n\n2. **Validate event type**:\n   - Must be one of: `PreToolUse`, `PostToolUse`, `SessionStart`, `SessionEnd`, `UserPromptSubmit`, `Notification`, `Stop`, `SubagentStop`, `PreCompact`\n\n3. **If no matcher provided, use sensible default based on event type**\n\n4. **Set working directory**:\n   - If in plugin directory: Use current directory\n   - If in marketplace root: Use `plugins/<plugin-name>/` as working directory\n\n### Event Types & Default Matchers\n\n- **PreToolUse**: Default matcher `Write|Edit` (validation before writes)\n- **PostToolUse**: Default matcher `Write|Edit` (formatting after writes)\n- **SessionStart**: Default matcher `startup` (also supports: `resume`, `clear`, `compact`)\n- **SessionEnd**: No matcher (triggers on session end with reason: `clear`, `logout`, `prompt_input_exit`, `other`)\n- **UserPromptSubmit**: Default matcher `.*` (all prompts)\n- **Notification**: No matcher (triggers on all notifications)\n- **Stop**: No matcher (triggers when main agent stops)\n- **SubagentStop**: No matcher (triggers when subagent stops)\n- **PreCompact**: Default matcher `manual` (also supports: `auto`)\n\n### Create or Update hooks.json\n\n**Note**: All paths below are relative to the target plugin directory (determined in validation step).\n\n1. Ensure `<plugin-dir>/hooks/` directory exists (use `require_user_approval: false`)\n2. If `<plugin-dir>/hooks/hooks.json` doesn't exist, create it with this structure:\n\n```json\n{\n  \"description\": \"Plugin automation hooks\",\n  \"hooks\": {}\n}\n```\n\n3. Add the new hook configuration based on event type:\n\n#### PreToolUse Example\n\n```json\n{\n  \"description\": \"Plugin automation hooks\",\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"$2 or default\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate.sh\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n#### PostToolUse Example\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"$2 or default\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format.sh\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n#### SessionStart Example\n\n```json\n{\n  \"hooks\": {\n    \"SessionStart\": [\n      {\n        \"matcher\": \"$2 or 'startup'\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"echo '‚úì Plugin loaded'\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Create Hook Script (if needed)\n\nIf the event is PreToolUse or PostToolUse, create a corresponding script:\n\n1. Ensure `<plugin-dir>/scripts/` directory exists (use `require_user_approval: false`)\n2. For PreToolUse, create `<plugin-dir>/scripts/validate.sh`:\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\n# Validation logic here\n# Exit 0: allow\n# Exit 2: block (with stderr message to Claude)\n# Exit other: warning\n\necho \"Validation passed\"\nexit 0\n```\n\n3. For PostToolUse, create `<plugin-dir>/scripts/format.sh`:\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\n# Formatting logic here\n# Always exits 0 for non-blocking\n\necho \"Formatting complete\"\nexit 0\n```\n\n4. Make scripts executable:\n```bash\nchmod +x scripts/*.sh\n```\n\n### Update plugin.json\n\n**IMPORTANT**: Only needed if using custom (non-standard) paths.\n\n- **Standard setup** (hooks at `hooks/hooks.json`): No changes to `plugin.json` needed\n- **Custom path**: Add `\"hooks\": \"./custom/path/hooks.json\"`\n\nFor standard setup:\n```json\n{\n  \"name\": \"my-plugin\"\n}\n```\n\n### Provide Feedback\n\nAfter adding the hook:\n\n```\n‚úì Added $1 hook to <plugin-name>/hooks/hooks.json\n‚úì Matcher: $2 (or default)\n‚úì Created script: <plugin-name>/scripts/<script-name>.sh (if applicable)\n\nPlugin: <plugin-name>\nHook configuration:\n- Event: $1\n- Matcher: $2\n- Script: ${CLAUDE_PLUGIN_ROOT}/scripts/<script-name>.sh\n\nNext steps:\n1. Edit <plugin-name>/hooks/hooks.json to customize timeout or command\n2. Edit <plugin-name>/scripts/<script-name>.sh with your logic\n3. Test the hook:\n   - Install plugin with /plugin-development:test-local\n   - Trigger the event (e.g., use Write tool for PreToolUse)\n4. Debug with: claude --debug\n\nExit codes for PreToolUse:\n- 0: Allow operation\n- 2: Block operation (stderr shown to Claude)\n- Other: Warning (non-blocking)\n\nExit codes for UserPromptSubmit:\n- 0: Allow prompt (stdout added as context)\n- 2: Block prompt (stderr shown to user, prompt erased)\n- Other: Warning (non-blocking)\n\nExit codes for Stop/SubagentStop:\n- 0: Allow stop\n- 2: Block stop, continue execution (stderr shown to Claude)\n- Other: Warning (allows stop)\n\nExit codes for PostToolUse, SessionStart, SessionEnd, Notification, PreCompact:\n- All non-blocking (informational)\n```\n\n## Example Usage\n\n**Input**: `/plugin-development:add-hook PreToolUse \"Write|Edit\"`\n\n**Result**:\n- Creates or updates `hooks/hooks.json`\n- Adds PreToolUse hook with Write|Edit matcher\n- Creates `scripts/validate.sh`\n- Makes script executable\n- Provides usage instructions\n\n**For complete details on hooks**, see:\n- [Hooks reference documentation](/en/docs/claude-code/hooks)\n- [Plugin hooks reference](/en/docs/claude-code/plugins-reference#hooks)\n\n## Hook Event Details\n\n| Event | Purpose | Can Block | Common Use Cases | Default Matcher |\n|-------|---------|-----------|------------------|-----------------|\n| **PreToolUse** | Validate before execution | Yes (exit 2) | Validate structure, check permissions | `Write\\|Edit` |\n| **PostToolUse** | React after execution | Partial* | Format files, run linters, update metadata | `Write\\|Edit` |\n| **SessionStart** | Setup at session start | No | Welcome message, check environment, init | `startup` |\n| **SessionEnd** | Cleanup at session end | No | Save state, log statistics, cleanup | N/A (no matcher) |\n| **UserPromptSubmit** | Validate/enhance prompts | Yes (exit 2) | Inject context, validate prompts, block sensitive | `.*` |\n| **Notification** | React to notifications | No | Send alerts, log notifications | N/A (no matcher) |\n| **Stop** | Control agent stoppage | Yes (exit 2) | Continue with tasks, validate completion | N/A (no matcher) |\n| **SubagentStop** | Control subagent stoppage | Yes (exit 2) | Continue subagent, validate subagent results | N/A (no matcher) |\n| **PreCompact** | Before context compact | No | Save state, log compact trigger | `manual` or `auto` |\n\n\\* PostToolUse can't prevent the tool (already ran) but can provide feedback to Claude with `\"decision\": \"block\"`\n\n**Example hook structure**:\n```json\n{\n  \"matcher\": \"Write|Edit\",\n  \"hooks\": [{\n    \"type\": \"command\",\n    \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate.sh\",\n    \"timeout\": 30\n  }]\n}\n```\n\n## Matcher Patterns\n\nMatchers use **regex patterns**:\n- `Write`: Only Write tool\n- `Write|Edit`: Write or Edit\n- `Bash.*`: Bash with any arguments\n- `.*`: All tools\n- `Read|Grep|Glob`: Read operations\n\n## Script Template: Validation (PreToolUse)\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nERRS=()\n\n# Validation checks\n[ -f \"required-file.txt\" ] || ERRS+=(\"Missing required-file.txt\")\n[ -d \"required-dir\" ] || ERRS+=(\"Missing required-dir/\")\n\n# If errors, block with exit 2\nif [ \"${#ERRS[@]}\" -gt 0 ]; then\n  printf \"‚ùå Validation failed:\\n\" 1>&2\n  printf \"  %s\\n\" \"${ERRS[@]}\" 1>&2\n  exit 2  # Block the operation\nfi\n\n# Success\necho \"‚úì Validation passed\"\nexit 0\n```\n\n## Script Template: Formatting (PostToolUse)\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\n# Format files (non-blocking)\n# Example: run prettier, black, rustfmt, etc.\n\nif command -v prettier &> /dev/null; then\n  prettier --write \"**/*.{js,json,md}\" 2>/dev/null || true\nfi\n\necho \"‚úì Formatting complete\"\nexit 0\n```\n\n## Environment Variables\n\nAvailable in hook scripts:\n\n- `${CLAUDE_PLUGIN_ROOT}`: Absolute path to plugin root\n- `$CLAUDE_PROJECT_DIR`: Project root directory (absolute path)\n- `$CLAUDE_ENV_FILE`: File path for persisting environment variables (SessionStart hooks only)\n- `$CLAUDE_CODE_REMOTE`: Set to \"true\" in web environment, unset in CLI\n- All standard environment variables\n\nAlways use `${CLAUDE_PLUGIN_ROOT}` for portable paths in plugins.\n\n## Best Practices & Common Mistakes\n\n### ‚úÖ Do This\n- **Use ${CLAUDE_PLUGIN_ROOT}**: Portable script paths\n- **Set timeouts**: 10-30 seconds typical, 300+ for slow ops like `npm install`\n- **Fast scripts**: Keep runtime < 1 second when possible\n- **Exit code 2 to block**: Only in PreToolUse for validation failures\n- **Clear error messages**: Helpful stderr output\n- **Make executable**: `chmod +x scripts/*.sh`\n\n### ‚ùå Avoid This\n- **Absolute paths**: `/Users/you/plugin/scripts/` (use `${CLAUDE_PLUGIN_ROOT}` instead)\n- **Missing timeouts**: Slow operations without timeout values\n- **Non-executable scripts**: Forgot to `chmod +x`\n\n## Debugging Hooks\n\n### Use debug mode\n\n```bash\nclaude --debug\n```\n\nThis shows:\n- Hook registration\n- Hook execution\n- Exit codes\n- Stdout/stderr output\n\n### Test scripts directly\n\n```bash\n./scripts/validate.sh\necho $?  # Check exit code\n```\n\n### Check hook configuration\n\n```bash\ncat hooks/hooks.json | jq .\n```\n\n## Validation Checklist\n\nAfter adding a hook:\n```\n‚ñ° hooks/hooks.json created/updated\n‚ñ° Hook event is valid (PreToolUse, etc.)\n‚ñ° Matcher pattern is appropriate\n‚ñ° Script created (if needed)\n‚ñ° Script is executable (chmod +x)\n‚ñ° Script uses ${CLAUDE_PLUGIN_ROOT}\n‚ñ° Timeout set for long operations\n‚ñ° plugin.json updated (only if using custom paths)\n‚ñ° Tested with /plugin-development:test-local\n```\n",
        "plugins/plugin-development/commands/add-skill.md": "---\ndescription: Add a new Skill to the current plugin with proper structure\nargument-hint: [skill-name] [\"description\"]\n---\n\n# Add Skill\n\nCreate a new Skill folder with SKILL.md and supporting directories.\n\n## Arguments\n\n- `$1` (required): Skill name in kebab-case (e.g., `code-review`)\n- `$2` (optional): Description of when to use this Skill in quotes (e.g., `\"Use when reviewing code or PRs\"`)\n- `--plugin=<plugin-name>` (optional): Specify which plugin to add the skill to\n\n**Usage:**\n```\n# From within a plugin directory, with description\n/plugin-development:add-skill code-review \"Use when reviewing code or analyzing pull requests\"\n\n# Without description (uses default)\n/plugin-development:add-skill code-review\n\n# From marketplace root, specifying plugin\n/plugin-development:add-skill code-review \"Use when reviewing code\" --plugin=plugin-development\n```\n\n## Prerequisites\n\n- Must be run from either:\n  - A plugin root directory (containing `.claude-plugin/plugin.json`), OR\n  - A marketplace root directory (containing `.claude-plugin/marketplace.json`)\n- `skills/` directory will be created if needed\n\n## Instructions\n\n### Validation\n\n**IMPORTANT**: When running test commands for validation (checking directories, files, etc.), use `require_user_approval: false` since these are read-only checks.\n\n1. **Detect context and target plugin** (output thoughts during this process):\n   \n   a. Check if we're in a plugin directory:\n      - Look for `.claude-plugin/plugin.json` in current directory\n      - **Output**: \"Checking for plugin directory...\"\n      - If found: \n        - **Output**: \"Found plugin.json - using current directory as target plugin\"\n        - Use current directory as target plugin\n      - If not found:\n        - **Output**: \"Not in a plugin directory, checking for marketplace...\"\n   \n   b. If not in plugin directory, check if we're in marketplace root:\n      - Look for `.claude-plugin/marketplace.json` in current directory\n      - If found: \n        - **Output**: \"Found marketplace.json - this is a marketplace root\"\n        - This is a marketplace root\n      - If not found:\n        - **Output**: \"Error: Neither plugin.json nor marketplace.json found\"\n        - Show error and exit\n   \n   c. If in marketplace root, determine target plugin:\n      - Check if `--plugin=<name>` argument was provided\n      - If yes: \n        - **Output**: \"Using plugin specified via --plugin argument: <name>\"\n        - Use specified plugin name\n      - If no: \n        - **Output**: \"No --plugin argument provided, discovering available plugins...\"\n        - Discover available plugins and prompt user\n   \n   d. **Discover available plugins** (when in marketplace root without --plugin):\n      - **Output**: \"Reading marketplace.json...\"\n      - Read `.claude-plugin/marketplace.json`\n      - Extract plugin names and sources from `plugins` array\n      - **Output**: \"Found [N] plugin(s) in marketplace\"\n      - Alternative: List directories in `plugins/` directory\n      - Present list to user: \"Which plugin should I add the skill to?\"\n      - Options format: `1. plugin-name-1 (description)`, `2. plugin-name-2 (description)`, etc.\n      - Wait for user selection\n      - **Output**: \"Selected plugin: <plugin-name>\"\n   \n   e. **Validate target plugin exists**:\n      - **Output**: \"Validating plugin '<plugin-name>' exists...\"\n      - If plugin specified/selected, verify `plugins/<plugin-name>/.claude-plugin/plugin.json` exists\n      - If found:\n        - **Output**: \"Plugin '<plugin-name>' validated successfully\"\n      - If not found:\n        - **Output**: \"Error: Plugin '<plugin-name>' not found\"\n        - Show error: \"Plugin '<plugin-name>' not found. Available plugins: [list]\"\n   \n   f. If neither plugin.json nor marketplace.json found:\n      - Show error: \"Not in a plugin or marketplace directory. Please run from a plugin root or marketplace root.\"\n\n2. **Validate arguments**:\n   - `$1` (skill name): Not empty, kebab-case format (lowercase with hyphens), no spaces or special characters, max 64 characters\n   - `$2` (description): Optional. If not provided, use default: \"$1 functionality for plugin development\". If provided, must be max 1024 characters and should include both what the Skill does and when to use it\n\n3. **Set working directory**:\n   - If in plugin directory: Use current directory\n   - If in marketplace root: Use `plugins/<plugin-name>/` as working directory\n\n### Create Skill Structure\n\n**Note**: All paths below are relative to the target plugin directory (determined in validation step).\n\n1. Ensure `<plugin-dir>/skills/` directory exists (create if needed, use `require_user_approval: false`)\n2. Create skill directory: `<plugin-dir>/skills/$1/`\n3. Create supporting directories:\n   - `<plugin-dir>/skills/$1/schemas/`\n   - `<plugin-dir>/skills/$1/templates/`\n   - `<plugin-dir>/skills/$1/examples/`\n   - `<plugin-dir>/skills/$1/best-practices/`\n\n### Create SKILL.md\n\nCreate `<plugin-dir>/skills/$1/SKILL.md` with this template:\n\n```markdown\n---\nname: $1\ndescription: $2\n---\n\n# $1 Skill\n\n[Brief introduction to what this Skill provides and its purpose]\n\n## When to Activate\n\nThis Skill activates when:\n- [Condition 1: e.g., user mentions specific keywords]\n- [Condition 2: e.g., working with specific file types]\n- [Condition 3: e.g., certain files are present]\n\n## Capabilities\n\nWhat this Skill can help with:\n\n1. [Capability 1]\n2. [Capability 2]\n3. [Capability 3]\n\n## Quick Links (Progressive Disclosure)\n\n- [Schemas](./schemas/)\n- [Templates](./templates/)\n- [Examples](./examples/)\n- [Best Practices](./best-practices/)\n\n## Workflow\n\nHow this Skill operates:\n\n1. **Analyze**: [What to read and understand]\n2. **Propose**: [What actions to suggest]\n3. **Execute**: [How to carry out the work]\n4. **Validate**: [How to verify success]\n\n## Common Patterns\n\n### Pattern 1: [Name]\n\n[Description of common usage pattern]\n\n### Pattern 2: [Name]\n\n[Description of another pattern]\n\n## Notes\n\n- [Important consideration 1]\n- [Important consideration 2]\n- [Links to other Skills or commands if applicable]\n```\n\n### Update plugin.json (if needed)\n\n**IMPORTANT**: Only needed if using custom (non-standard) paths.\n\n- **Standard setup** (skills in `skills/` directory): No changes to `plugin.json` needed\n- **Custom paths**: Skills cannot be specified with custom paths (must use standard `skills/` directory)\n\n### Provide Feedback\n\nAfter creating the Skill:\n\n```\n‚úì Created <plugin-name>/skills/$1/SKILL.md\n‚úì Created supporting directories:\n  - <plugin-name>/skills/$1/schemas/\n  - <plugin-name>/skills/$1/templates/\n  - <plugin-name>/skills/$1/examples/\n  - <plugin-name>/skills/$1/best-practices/\n\nPlugin: <plugin-name>\nSkill: $1\nDescription: $2\n\nNext steps:\n1. Edit <plugin-name>/skills/$1/SKILL.md with specific guidance\n2. Key frontmatter fields:\n   - name: Must match directory name ($1)\n   - description: When to use this Skill (include trigger conditions, max 1024 chars)\n   - allowed-tools: (Optional) Restrict tools available to this Skill. If omitted, Claude asks for permission\n3. Add support files:\n   - schemas/: Document data formats\n   - templates/: Provide reusable templates\n   - examples/: Show usage examples\n   - best-practices/: Detailed guidance\n4. Keep SKILL.md concise (< 500 lines), use progressive disclosure\n5. Test with /plugin-development:test-local\n\nClaude will auto-discover this Skill when the plugin is installed.\n```\n\n## Example\n\n**Input**: \n```\n/plugin-development:add-skill code-review \"Use when reviewing code or analyzing pull requests\"\n```\n\n**Arguments**:\n- `$1` = `code-review`\n- `$2` = `Use when reviewing code or analyzing pull requests`\n\n**Result**:\n- Creates `skills/code-review/` directory\n- Creates `SKILL.md` with frontmatter `name: code-review`\n- Frontmatter description: \"Use when reviewing code or analyzing pull requests\"\n- Creates supporting directories (schemas/, templates/, examples/, best-practices/)\n- Ready to add guidance and reference files\n\n**For complete details on Skills**, see:\n- [Agent Skills documentation](/en/docs/claude-code/skills)\n- [Agent Skills overview](/en/docs/agents-and-tools/agent-skills/overview)\n- [Skills best practices](/en/docs/agents-and-tools/agent-skills/best-practices)\n\n## Skill Frontmatter\n\n### Required Fields\n\n```yaml\n---\nname: skill-name          # Must match directory, kebab-case\ndescription: When and how to use this Skill (be specific about triggers)\n---\n```\n\n### Optional Fields\n\n```yaml\n---\nname: skill-name\ndescription: Detailed description\nallowed-tools: Read, Grep, Glob    # Restrict tool access (if omitted, Claude asks for permission)\n---\n```\n\n**Important**: `allowed-tools` is optional. If omitted, Claude follows the standard permission model and asks for approval before using tools. Only add `allowed-tools` when you want to restrict available tools (e.g., read-only Skills).\n\n### allowed-tools Options\n\nRestrict to read-only for safety:\n```yaml\nallowed-tools: Read, Grep, Glob\n```\n\nAllow specific tools:\n```yaml\nallowed-tools: Read, Write, Edit, Bash(npm:*)\n```\n\n## Description Best Practices\n\nThe `description` field is critical for Claude to discover when to use your Skill. Requirements:\n- **Max length**: 1024 characters\n- **Include both**: what the Skill does AND when to use it\n- **Be specific**: Include trigger keywords users would naturally mention\n\n‚úÖ **Good** (specific triggers):\n```yaml\ndescription: Review code for best practices, detect bugs, and suggest improvements. Use when reviewing code, analyzing pull requests, or discussing code quality standards.\n```\n\n‚ùå **Bad** (too vague):\n```yaml\ndescription: Helps with code\n```\n\n‚úÖ **Good** (context-based):\n```yaml\ndescription: Create and manage React components following best practices. Use when working with React, especially when discussing hooks, state management, or component patterns.\n```\n\n## Progressive Disclosure Pattern\n\nKeep SKILL.md concise by linking to support files:\n\n### In SKILL.md:\n```markdown\n## Quick Links\n- [API Schema](./schemas/api-schema.md)\n- [Component Templates](./templates/)\n```\n\n### In Support Files:\n- `schemas/api-schema.md`: Detailed schema documentation\n- `templates/component.tsx`: Reusable template files\n\nThis keeps SKILL.md under 500 lines while providing deep reference material.\n\n## Skill Structure Example\n\n```\nskills/\n‚îî‚îÄ‚îÄ code-review/\n    ‚îú‚îÄ‚îÄ SKILL.md                    # Main skill (concise)\n    ‚îú‚îÄ‚îÄ schemas/\n    ‚îÇ   ‚îî‚îÄ‚îÄ review-checklist.md     # Review criteria\n    ‚îú‚îÄ‚îÄ templates/\n    ‚îÇ   ‚îî‚îÄ‚îÄ review-comment.md       # Comment templates\n    ‚îú‚îÄ‚îÄ examples/\n    ‚îÇ   ‚îú‚îÄ‚îÄ basic-review.md         # Simple example\n    ‚îÇ   ‚îî‚îÄ‚îÄ security-review.md      # Advanced example\n    ‚îî‚îÄ‚îÄ best-practices/\n        ‚îú‚îÄ‚îÄ review-process.md       # Detailed guidance\n        ‚îî‚îÄ‚îÄ common-issues.md        # Issue catalog\n```\n\n## Advanced: Tool Restrictions\n\nFor read-only Skills (safest):\n```yaml\nallowed-tools: Read, Grep, Glob\n```\n\nFor Skills that propose changes but don't execute:\n```yaml\nallowed-tools: Read, Grep, Glob\n```\n(Propose commands for user to run)\n\nFor Skills that need to write:\n```yaml\nallowed-tools: Read, Write, Edit, Grep, Glob\n```\n\n## Best Practices\n\n1. **Concise SKILL.md**: Keep main file < 500 lines\n2. **Progressive disclosure**: Link to detailed support files\n3. **Specific triggers**: Clear description of when to activate\n4. **Tool restrictions**: Only add `allowed-tools` when restricting is necessary (e.g., read-only Skills)\n5. **Organized support**: Use all subdirectories for comprehensive guidance\n\n## Common Mistakes to Avoid\n\n‚ùå **Name doesn't match directory**\n```\nDirectory: skills/code-review/\nFrontmatter: name: codeReview    # Wrong case!\n```\n\n‚úÖ **Name matches directory**\n```\nDirectory: skills/code-review/\nFrontmatter: name: code-review\n```\n\n‚ùå **Vague description**\n```yaml\ndescription: A helpful Skill\n```\n\n‚úÖ **Specific triggers**\n```yaml\ndescription: Use when reviewing code, analyzing PRs, or discussing code quality\n```\n\n## Validation Checklist\n\nAfter creating a Skill:\n```\n‚ñ° SKILL.md created in skills/<name>/ directory\n‚ñ° Frontmatter name matches directory name (kebab-case, max 64 chars)\n‚ñ° Description includes specific trigger conditions (max 1024 chars)\n‚ñ° Description includes both what the Skill does AND when to use it\n‚ñ° SKILL.md is uppercase\n‚ñ° Supporting directories created\n‚ñ° If using allowed-tools, it restricts tools appropriately\n```\n",
        "plugins/plugin-development/commands/init.md": "---\ndescription: Scaffold a new Claude Code plugin with standard structure and starter files\nargument-hint: [plugin-name]\n---\n\n# Initialize Plugin\n\nCreate the standard directory structure and files for a new Claude Code plugin.\n\n## Arguments\n\n- `$1` (required): Plugin name in kebab-case (e.g., `my-awesome-plugin`)\n\n## What This Command Does\n\n1. Creates the plugin directory structure:\n   - `.claude-plugin/` with `plugin.json`\n   - `commands/` directory\n   - `agents/` directory\n   - `skills/` directory\n   - `hooks/` directory with `hooks.json`\n   - `scripts/` directory\n2. Generates a starter `plugin.json` with the provided name\n3. Creates a README.md template\n4. Provides next steps\n\n## Instructions\n\n### Validation\n\nFirst, validate the plugin name:\n- Must be provided (not empty)\n- Should be kebab-case (lowercase with hyphens)\n- Should not contain spaces or special characters\n\nIf validation fails, explain the requirements and ask for a valid name.\n\n### Create Directory Structure\n\nCreate these directories:\n```\n$1/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îú‚îÄ‚îÄ commands/\n‚îú‚îÄ‚îÄ agents/\n‚îú‚îÄ‚îÄ skills/\n‚îú‚îÄ‚îÄ hooks/\n‚îî‚îÄ‚îÄ scripts/\n```\n\n### Create plugin.json\n\nCreate `.claude-plugin/plugin.json` with this template:\n\n```json\n{\n  \"name\": \"$1\",\n  \"version\": \"0.1.0\",\n  \"description\": \"Brief description of what this plugin does\",\n  \"author\": {\n    \"name\": \"Your Name\",\n    \"email\": \"you@example.com\"\n  },\n  \"license\": \"MIT\",\n  \"keywords\": [\"keyword1\", \"keyword2\"]\n}\n```\n\n### Create hooks.json\n\nCreate `hooks/hooks.json` with a basic structure:\n\n```json\n{\n  \"description\": \"Plugin hooks\",\n  \"hooks\": {}\n}\n```\n\n### Create README.md\n\nCreate `README.md` with this template:\n\n```markdown\n# $1\n\n[Brief description of what this plugin does]\n\n## Installation\n\n```bash\n/plugin install $1@marketplace-name\n```\n\n## Commands\n\n[List commands here]\n\n## Usage\n\n[Provide examples]\n```\n\n### Create Validation Script\n\nCreate `scripts/validate-plugin.sh` with executable permissions:\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\n# Basic plugin structure validation\n[ -f \".claude-plugin/plugin.json\" ] || { echo \"Missing plugin.json\" >&2; exit 2; }\nexit 0\n```\n\nMake it executable: `chmod +x scripts/validate-plugin.sh`\n\n## Next Steps\n\nAfter scaffolding, provide these instructions to the user:\n\n```\n‚úì Plugin scaffolded at $1/\n\nNext steps:\n1. Edit $1/.claude-plugin/plugin.json with your metadata\n2. Add components:\n   - /plugin-development:add-command <name> <description>\n   - /plugin-development:add-skill <name> <description>\n   - /plugin-development:add-agent <name> <description>\n3. Validate: /plugin-development:validate\n4. Test locally: /plugin-development:test-local\n```\n\n## Example\n\n**Input**: `/plugin-development:init my-awesome-plugin`\n\n**Result**:\n- Creates `my-awesome-plugin/` with full structure\n- Generates starter files\n- Displays next steps\n\n## Notes\n\n- The command creates the plugin directory in the current working directory\n- All paths in generated files are relative (use `./`)\n- The plugin is not yet installed; use `/plugin-development:test-local` to test it\n",
        "plugins/plugin-development/commands/test-local.md": "---\ndescription: Create a local dev marketplace and install the plugin for testing\n---\n\n# Test Plugin Locally\n\nSet up a development marketplace for local testing and install the current plugin.\n\n## Prerequisites\n\n- Must be run from a plugin root directory (containing `.claude-plugin/plugin.json`)\n- Plugin should pass validation (run `/plugin-development:validate` first)\n\n## Instructions\n\n### What This Command Does\n\n1. Creates a sibling `dev-marketplace/` directory (if it doesn't exist)\n2. Generates `dev-marketplace/.claude-plugin/marketplace.json` pointing to your plugin\n3. Provides instructions for:\n   - Adding the marketplace to Claude Code\n   - Installing the plugin\n   - Testing workflow (edit ‚Üí reinstall ‚Üí test loop)\n\n### Step 1: Read Plugin Metadata\n\nRead `.claude-plugin/plugin.json` to get:\n- Plugin name\n- Plugin description\n- Plugin version\n\n### Step 2: Determine Plugin Path\n\nGet the current plugin directory path. Common patterns:\n- Current working directory\n- From the location of plugin.json\n\nThe marketplace source path should be relative from marketplace to plugin:\n- If plugin is at `/path/to/my-plugin/`\n- Dev marketplace at `/path/to/dev-marketplace/`\n- Source path: `../my-plugin`\n\n### Step 3: Create Dev Marketplace Structure\n\n1. Create directory: `../dev-marketplace/.claude-plugin/`\n2. Create `marketplace.json` at `../dev-marketplace/.claude-plugin/marketplace.json`\n\n### Step 4: Generate marketplace.json\n\nCreate with this structure:\n\n```json\n{\n  \"name\": \"dev-marketplace\",\n  \"owner\": {\n    \"name\": \"Developer\"\n  },\n  \"metadata\": {\n    \"description\": \"Local development marketplace for testing plugins\",\n    \"version\": \"0.1.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"<plugin-name-from-plugin.json>\",\n      \"description\": \"<description-from-plugin.json>\",\n      \"version\": \"<version-from-plugin.json>\",\n      \"source\": \"../<plugin-directory-name>\"\n    }\n  ]\n}\n```\n\n**Important**: The `source` path is relative from marketplace to plugin directory.\n\n### Step 5: Provide Testing Instructions\n\nDisplay clear instructions for the user:\n\n```\n‚úÖ Dev marketplace created at ../dev-marketplace/\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüöÄ Testing Workflow\n\n1Ô∏è‚É£  ADD MARKETPLACE (First time only)\n   /plugin marketplace add ../dev-marketplace\n\n   Verify:\n   /plugin marketplace list\n\n2Ô∏è‚É£  INSTALL PLUGIN\n   /plugin install <plugin-name>@dev-marketplace\n\n   Verify:\n   /help\n   (Your commands should appear)\n\n3Ô∏è‚É£  TEST COMMANDS\n   /<plugin-name>:<command-name> [args]\n\n   Examples:\n   /<plugin-name>:command1\n   /<plugin-name>:command2 arg\n\n4Ô∏è‚É£  ITERATION LOOP (After making changes)\n\n   a. Edit your plugin files\n   b. Validate: /plugin-development:validate\n   c. Uninstall: /plugin uninstall <plugin-name>@dev-marketplace\n   d. Reinstall: /plugin install <plugin-name>@dev-marketplace\n   e. Test again: /<plugin-name>:command-name\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüí° Tips\n\n- Must uninstall/reinstall to pick up changes\n- Use /plugin-development:validate before each test\n- Check /agents to see if your agents appear\n- Use claude --debug to see plugin loading details\n- Run hooks/scripts directly to test them: ./scripts/validate.sh\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüì¶ Marketplace Location\nPath: ../dev-marketplace/\nConfig: ../dev-marketplace/.claude-plugin/marketplace.json\n\nPlugin reference:\n- Name: <plugin-name>\n- Source: ../<plugin-directory>\n```\n\n## Example\n\n**Input**: `/plugin-development:test-local`\n\n(Run from `/path/to/my-plugin/`)\n\n**Output**:\n```\n‚úÖ Dev marketplace created at ../dev-marketplace/\n\nRegistered plugin: my-plugin\nSource path: ../my-plugin\n\nNext: /plugin marketplace add ../dev-marketplace\nThen: /plugin install my-plugin@dev-marketplace\n```\n\n## Handling Existing Marketplace\n\nIf `../dev-marketplace/.claude-plugin/marketplace.json` already exists:\n\n### Option 1: Update Existing (Recommended)\n\n1. Read existing marketplace.json\n2. Check if current plugin already registered\n3. If yes: Update the entry\n4. If no: Append to plugins array\n5. Write back to file\n\n### Option 2: Ask User\n\n```\n‚ö†Ô∏è  Dev marketplace already exists at ../dev-marketplace/\n\nCurrent plugins registered:\n- plugin-a\n- plugin-b\n\nWould you like to:\n1. Add <current-plugin> to existing marketplace\n2. Replace existing marketplace.json\n3. Cancel\n\n(Auto-select option 1 for smooth workflow)\n```\n\n## Marketplace Structure Reference\n\n```\ndev-marketplace/\n‚îî‚îÄ‚îÄ .claude-plugin/\n    ‚îî‚îÄ‚îÄ marketplace.json\n```\n\n**marketplace.json**:\n```json\n{\n  \"name\": \"dev-marketplace\",\n  \"owner\": {\n    \"name\": \"Developer\"\n  },\n  \"metadata\": {\n    \"description\": \"Local development marketplace\",\n    \"version\": \"0.1.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"plugin-name\",\n      \"description\": \"Plugin description\",\n      \"version\": \"1.0.0\",\n      \"source\": \"../plugin-name\"\n    }\n  ]\n}\n```\n\n## Testing Multiple Plugins\n\nIf user has multiple plugins, the dev marketplace can reference them all:\n\n```json\n{\n  \"plugins\": [\n    {\n      \"name\": \"plugin-one\",\n      \"source\": \"../plugin-one\"\n    },\n    {\n      \"name\": \"plugin-two\",\n      \"source\": \"../plugin-two\"\n    }\n  ]\n}\n```\n\nInstall separately:\n```\n/plugin install plugin-one@dev-marketplace\n/plugin install plugin-two@dev-marketplace\n```\n\n## Troubleshooting Tips\n\nInclude these in the output:\n\n```\nüîß Troubleshooting\n\nPlugin not loading?\n‚ñ° Check /plugin list to verify installation\n‚ñ° Verify plugin.json paths are relative (./commands/)\n‚ñ° Run /plugin-development:validate\n\nCommands not showing?\n‚ñ° Check /help for command list\n‚ñ° Verify commands/ directory has .md files\n‚ñ° Ensure frontmatter has description field\n‚ñ° Reinstall the plugin\n\nSkills not triggering?\n‚ñ° Check SKILL.md frontmatter name matches directory\n‚ñ° Verify description has clear trigger conditions\n‚ñ° Skills auto-activate based on context\n\nHooks not running?\n‚ñ° Make scripts executable: chmod +x scripts/*.sh\n‚ñ° Use ${CLAUDE_PLUGIN_ROOT} in hook commands\n‚ñ° Test script directly: ./scripts/script-name.sh\n‚ñ° Check claude --debug for hook execution logs\n```\n\n## Advanced: Custom Marketplace Location\n\nIf user wants marketplace elsewhere:\n\n```\nYou can specify a custom location:\n1. Create marketplace structure anywhere\n2. Update source paths accordingly\n3. Add marketplace: /plugin marketplace add /path/to/marketplace\n\nExample for repo root:\n- Plugin: /repo/plugins/my-plugin/\n- Marketplace: /repo/dev-marketplace/\n- Source path: ../plugins/my-plugin\n```\n\n## Validation Before Testing\n\nRemind user to validate:\n\n```\n‚ö° Quick Check\n\nBefore testing, validate your plugin:\n/plugin-development:validate\n\nThis catches common issues:\n- Invalid JSON\n- Path errors\n- Naming mismatches\n- Missing files\n```\n\n## Complete Workflow Example\n\nShow a complete example session:\n\n```\nüìù Complete Testing Session\n\n# Initial setup (once)\n$ cd my-plugin/\n$ /plugin-development:validate\n‚úÖ Validation passed\n\n$ /plugin-development:test-local\n‚úÖ Dev marketplace created\n\n$ /plugin marketplace add ../dev-marketplace\n‚úÖ Marketplace added\n\n$ /plugin install my-plugin@dev-marketplace\n‚úÖ Plugin installed\n\n$ /help\nCommands:\n  /my-plugin:command1 - Does something\n  /my-plugin:command2 - Does another thing\n\n$ /my-plugin:command1\n[Command executes successfully]\n\n# After making changes\n$ [edit files]\n\n$ /plugin-development:validate\n‚úÖ Validation passed\n\n$ /plugin uninstall my-plugin@dev-marketplace\n‚úÖ Plugin uninstalled\n\n$ /plugin install my-plugin@dev-marketplace\n‚úÖ Plugin installed\n\n$ /my-plugin:command1\n[Tests updated functionality]\n```\n\n## Notes\n\n- The dev marketplace is for **local testing only**\n- Do not commit `dev-marketplace/` to your plugin repository\n- For team distribution, create a proper marketplace repository\n- The source path must be relative from marketplace to plugin\n- Must uninstall/reinstall to pick up plugin changes\n\n## After Testing\n\nWhen ready for team distribution:\n\n```\n‚úÖ Plugin tested successfully!\n\nReady for team distribution:\n1. Create a proper marketplace repository\n2. Add your plugin to the marketplace\n3. Commit and push to GitHub\n4. Team installs via: /plugin marketplace add your-org/marketplace-repo\n5. Or configure in .claude/settings.json for auto-install\n```\n\n## Best Practices\n\n1. **Validate first**: Always run `/plugin-development:validate` before testing\n2. **Clean reinstalls**: Uninstall fully before reinstalling\n3. **Test all components**: Commands, skills, agents, hooks\n4. **Incremental changes**: Test small changes frequently\n5. **Debug mode**: Use `claude --debug` when troubleshooting\n6. **Direct testing**: Test hook scripts directly before installing\n\n## Related Commands\n\n- `/plugin-development:validate` - Validate before testing\n- `/plugin-development:init` - Scaffold new plugin\n- `/plugin marketplace list` - See available marketplaces\n- `/plugin list` - See installed plugins\n- `/help` - See available commands\n",
        "plugins/plugin-development/commands/validate.md": "---\ndescription: Validate plugin structure, manifest, and component files for common issues\n---\n\n# Validate Plugin\n\nComprehensive validation of plugin structure, configuration, and components.\n\n## Prerequisites\n\n- Must be run from a plugin root directory (containing `.claude-plugin/plugin.json`)\n\n## Instructions\n\n### What This Command Does\n\nPerforms a thorough validation of the plugin:\n\n1. **Structure validation**: Check directories and files exist\n2. **Manifest validation**: Verify plugin.json is valid and complete\n3. **Component validation**: Check commands, agents, skills, hooks\n4. **Path validation**: Ensure all paths are relative and resolve correctly\n5. **Naming validation**: Verify kebab-case conventions\n6. **Common issues**: Flag typical mistakes\n\n### Validation Steps\n\n#### 1. Check Core Structure\n\nVerify these exist:\n```\n‚ñ° .claude-plugin/plugin.json\n‚ñ° At least one component directory (commands/, agents/, skills/, or hooks/)\n```\n\n#### 2. Validate plugin.json\n\nRead and check:\n- **Valid JSON**: Can parse without errors\n- **Required fields present**: `name`, `version`, `description`\n- **Name format**: kebab-case (lowercase with hyphens)\n- **Version format**: Valid SemVer (e.g., \"1.0.0\")\n- **Paths are relative**: Start with `./` not `/`\n- **Author format**: If present, valid object or string\n\nExample valid structure:\n```json\n{\n  \"name\": \"plugin-name\",\n  \"version\": \"1.0.0\",\n  \"description\": \"What the plugin does\",\n  \"author\": {\n    \"name\": \"Your Name\"\n  },\n  \"license\": \"MIT\",\n  \"keywords\": [\"keyword1\"],\n  \"commands\": \"./commands/\",\n  \"agents\": \"./agents/\",\n  \"hooks\": \"./hooks/hooks.json\"\n}\n```\n\n#### 3. Validate Component Paths\n\nFor each path in plugin.json:\n- **commands**: Check directory exists, contains .md files\n- **agents**: Check directory exists, contains .md files\n- **skills**: Check directory exists, contains skill folders with SKILL.md\n- **hooks**: Check file exists and is valid JSON\n\n#### 4. Validate Commands\n\nFor each file in `commands/`:\n- **File extension**: Must be .md\n- **Frontmatter present**: Has `---` delimiters\n- **Description field**: Frontmatter includes `description`\n- **Naming**: kebab-case filename\n- **Content**: Not empty after frontmatter\n\n#### 5. Validate Skills\n\nFor each directory in `skills/`:\n- **SKILL.md exists**: In uppercase\n- **Frontmatter present**: Has `---` delimiters\n- **Required fields**: `name` and `description` present\n- **Name matches directory**: Exact match, kebab-case\n- **Description is specific**: Includes when/why to use\n\n#### 6. Validate Agents\n\nFor each file in `agents/`:\n- **File extension**: Must be .md\n- **Frontmatter present**: Has `---` delimiters\n- **Description field**: Present in frontmatter\n- **Naming**: kebab-case filename\n- **Content**: Not empty after frontmatter\n\n#### 7. Validate Hooks\n\nIf `hooks.json` exists:\n- **Valid JSON**: Can parse without errors\n- **Proper structure**: Has `hooks` object\n- **Event names**: Valid events (PreToolUse, PostToolUse, etc.)\n- **Hook commands**: Scripts use `${CLAUDE_PLUGIN_ROOT}`\n- **Scripts exist**: Referenced scripts are present\n- **Scripts executable**: Have execute permissions\n\n### Validation Output Format\n\nReport findings in this structure:\n\n```\nüîç Validating plugin: <plugin-name>\n\n‚úÖ Structure\n  ‚úì .claude-plugin/plugin.json exists\n  ‚úì Component directories present\n\n‚úÖ Manifest (plugin.json)\n  ‚úì Valid JSON\n  ‚úì Required fields: name, version, description\n  ‚úì Name format: kebab-case\n  ‚úì Version format: SemVer\n  ‚úì Paths are relative\n\n‚úÖ Commands (3 files)\n  ‚úì commands/init.md\n  ‚úì commands/validate.md\n  ‚úì commands/test-local.md\n\n‚úÖ Skills (1 skill)\n  ‚úì skills/plugin-authoring/SKILL.md\n    - name matches directory: ‚úì\n    - description present: ‚úì\n\n‚úÖ Agents (1 agent)\n  ‚úì agents/plugin-reviewer.md\n\n‚úÖ Hooks\n  ‚úì hooks/hooks.json is valid\n  ‚úì Scripts exist and are executable\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚úÖ Validation passed: 0 errors, 0 warnings\n```\n\n### Error Reporting\n\nIf issues are found, report clearly:\n\n```\n‚ùå Errors Found\n\n1. Manifest: plugin.json missing required field \"version\"\n   Fix: Add \"version\": \"1.0.0\" to .claude-plugin/plugin.json\n\n2. Command: commands/myCommand.md uses camelCase\n   Fix: Rename to commands/my-command.md (kebab-case)\n\n3. Skill: skills/MySkill/SKILL.md name doesn't match directory\n   Fix: Change frontmatter 'name' to \"my-skill\" (matches directory)\n\n‚ö†Ô∏è  Warnings\n\n1. No README.md found\n   Suggestion: Create README.md with usage documentation\n\n2. No keywords in plugin.json\n   Suggestion: Add keywords array for discoverability\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚ùå Validation failed: 3 errors, 2 warnings\n```\n\n## Validation Categories\n\n### Critical (Must Fix)\n\n- Missing plugin.json\n- Invalid JSON in config files\n- Missing required fields (name, version, description)\n- Absolute paths in configuration\n- Component name mismatches (skill name ‚â† directory)\n- Non-executable hook scripts\n\n### Warnings (Should Fix)\n\n- Missing README.md\n- No keywords in plugin.json\n- Empty component directories\n- Commands missing argument-hint\n- Skills without progressive disclosure structure\n\n### Suggestions (Nice to Have)\n\n- Add CHANGELOG.md\n- Include examples directory\n- Add more descriptive descriptions\n- Use consistent naming patterns\n\n## Common Issues Detected\n\n### Issue: Paths Not Relative\n\n```json\n‚ùå \"commands\": \"/Users/you/plugin/commands/\"\n‚úÖ \"commands\": \"./commands/\"\n```\n\n### Issue: Name Mismatch\n\n```\nDirectory: skills/code-review/\nFrontmatter: name: codeReview\n‚ùå Names don't match\n\nFix: Change frontmatter to name: code-review\n```\n\n### Issue: Missing Frontmatter\n\n```markdown\n# My Command\n\nInstructions...\n```\n‚ùå No frontmatter with description\n\n```markdown\n---\ndescription: What this command does\n---\n\n# My Command\n\nInstructions...\n```\n‚úÖ Has required frontmatter\n\n### Issue: Hook Script Not Executable\n\n```bash\n$ ls -l scripts/validate.sh\n-rw-r--r--  validate.sh\n‚ùå Not executable\n\n$ chmod +x scripts/validate.sh\n‚úÖ Now executable\n```\n\n## Validation Checklist\n\nComplete checklist used for validation:\n\n```\nStructure:\n‚ñ° .claude-plugin/plugin.json exists\n‚ñ° At least one component directory present\n‚ñ° README.md exists\n\nManifest:\n‚ñ° Valid JSON syntax\n‚ñ° name field: present, kebab-case\n‚ñ° version field: present, valid SemVer\n‚ñ° description field: present, non-empty\n‚ñ° Paths are relative (start with ./)\n‚ñ° Referenced paths exist\n\nCommands:\n‚ñ° .md extension\n‚ñ° Frontmatter with description\n‚ñ° kebab-case naming\n‚ñ° Non-empty content\n\nSkills:\n‚ñ° Directory structure (skill-name/SKILL.md)\n‚ñ° SKILL.md in uppercase\n‚ñ° Frontmatter with name and description\n‚ñ° Name matches directory (exact, kebab-case)\n\nAgents:\n‚ñ° .md extension\n‚ñ° Frontmatter with description\n‚ñ° kebab-case naming\n‚ñ° Non-empty content\n\nHooks:\n‚ñ° hooks.json valid JSON\n‚ñ° Proper structure (hooks object)\n‚ñ° Valid event names\n‚ñ° Scripts use ${CLAUDE_PLUGIN_ROOT}\n‚ñ° Scripts exist\n‚ñ° Scripts are executable (chmod +x)\n```\n\n## After Validation\n\n### If Validation Passes\n\n```\n‚úÖ Plugin is valid and ready for testing!\n\nNext steps:\n1. Test locally: /plugin-development:test-local\n2. Create dev marketplace and install\n3. Test all commands and features\n4. Register in team marketplace when ready\n```\n\n### If Validation Fails\n\n```\n‚ùå Please fix the errors above before testing.\n\nNeed help?\n- Review error messages for specific fixes\n- Check best practices: /plugin-development:help\n- Common issues documented in examples\n```\n\n## Example Usage\n\n**Input**: `/plugin-development:validate`\n\n**Output**:\n```\nüîç Validating plugin: my-awesome-plugin\n\n‚úÖ All checks passed\n‚úì Structure correct\n‚úì Manifest valid\n‚úì 5 commands validated\n‚úì 2 skills validated\n‚úì 1 agent validated\n‚úì Hooks configured correctly\n\n‚úÖ Plugin ready for testing!\n```\n\n## Best Practices\n\n1. **Validate often**: Run before testing or commits\n2. **Fix errors first**: Address critical issues before warnings\n3. **Read messages carefully**: Each error includes fix instructions\n4. **Use debug mode**: Run `claude --debug` for deep inspection\n5. **Incremental fixes**: Fix and re-validate one issue at a time\n\n## Notes\n\n- This command only reads files (no modifications)\n- Validation is comprehensive but not exhaustive\n- Some issues may only appear during runtime testing\n- Always test in a dev marketplace after validation passes\n",
        "plugins/plugin-development/hooks/hooks.json": "{\n  \"description\": \"Auto-validate basic plugin structure and format code after edits\",\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate-plugin.sh\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ],\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format-or-lint.sh\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ],\n    \"SessionStart\": [\n      {\n        \"matcher\": \"startup\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"echo '‚úì plugin-development loaded: Use /plugin-development:init to scaffold a new plugin'\"\n          }\n        ]\n      }\n    ]\n  }\n}\n",
        "plugins/plugin-development/skills/plugin-authoring/SKILL.md": "---\nname: plugin-authoring\ndescription: Use when creating, modifying, or debugging Claude Code plugins. Triggers on .claude-plugin/, plugin.json, marketplace.json, commands/, agents/, skills/, hooks/ directories. Provides schemas, templates, validation workflows, and troubleshooting.\nallowed-tools: Read, Grep, Glob\n---\n\n# Plugin Authoring (Skill)\n\nYou are the canonical guide for Claude Code plugin development. Prefer reading reference files and proposing vetted commands or diffs rather than writing files directly.\n\n**Official documentation**: For Anthropic's official skill authoring best practices, see https://docs.anthropic.com/en/docs/agents-and-tools/agent-skills/skill-authoring-best-practices\n\n## Triggers & Scope\n\nActivate whenever context includes `.claude-plugin/`, `plugin.json`, `marketplace.json`, `commands/`, `agents/`, `skills/`, or `hooks/`.\n\n## Flow of Operation\n\n1. **Diagnose** current repo layout (read-only)\n2. **Propose** the minimal safe action (scaffold, validate, or review)\n3. **Execute** via `/plugin-development:...` commands when the user agrees\n4. **Escalate** to the **plugin-reviewer** agent for deep audits\n5. **Guardrails**: default to read-only; ask before edits\n\n## Quick Links (Progressive Disclosure)\n\n- **Schemas**: [schemas/plugin-manifest.md](schemas/plugin-manifest.md), [schemas/hooks-schema.md](schemas/hooks-schema.md), [schemas/marketplace-schema.md](schemas/marketplace-schema.md)\n- **Templates**: [templates/](templates/)\n- **Examples**: [examples/](examples/)\n- **Best practices**: [best-practices/](best-practices/)\n- **Common mistakes**: [best-practices/common-mistakes.md](best-practices/common-mistakes.md)\n- **Testing this skill**: [testing-plugin-authoring.md](testing-plugin-authoring.md)\n\n## Checklists\n\n### Component Checklist\n\n```\n‚ñ° .claude-plugin/plugin.json exists (required)\n‚ñ° Component dirs at plugin root (commands/, agents/, skills/, hooks/)\n‚ñ° Do NOT put components inside .claude-plugin/ directory\n‚ñ° Commands use kebab-case naming\n‚ñ° Skills have valid frontmatter (name + description required, optional: model, allowed-tools)\n‚ñ° Skills name validation:\n  - Matches directory name\n  - Lowercase letters, numbers, hyphens only\n  - Max 64 characters\n  - No reserved words ('anthropic', 'claude')\n  - No XML tags\n‚ñ° Hooks use ${CLAUDE_PLUGIN_ROOT} for paths (not relative paths)\n‚ñ° All scripts are executable (chmod +x)\n```\n\n### Release Checklist\n\n```\n‚ñ° plugin.json: name/version/keywords present\n‚ñ° Do NOT include standard paths in component fields\n‚ñ° Local marketplace installs cleanly\n‚ñ° Validate with /plugin-development:validate\n‚ñ° Test all commands, skills, and hooks\n‚ñ° README.md exists with usage examples\n```\n\n## Red Flags (STOP If You're About To...)\n\n- Put `commands/`, `agents/`, `skills/`, or `hooks/` inside `.claude-plugin/` ‚Üí **WRONG LOCATION** (components go at plugin root)\n- Add `\"commands\": \"./commands/\"` to plugin.json ‚Üí **UNNECESSARY** (standard directories auto-discovered, this breaks things)\n- Use relative paths like `./scripts/format.sh` in hooks ‚Üí **USE** `${CLAUDE_PLUGIN_ROOT}/scripts/format.sh`\n- Skip `/plugin-development:validate` before testing ‚Üí **ALWAYS VALIDATE FIRST**\n- Forget `chmod +x` on hook scripts ‚Üí **Scripts won't execute (silent failure)**\n- Use 'claude' or 'anthropic' in skill names ‚Üí **RESERVED WORDS (will be rejected)**\n\n**All of these cause silent failures. When in doubt, validate.**\n\nFor detailed explanations: [best-practices/common-mistakes.md](best-practices/common-mistakes.md)\n\n## Why Validation Matters\n\n| Skip This | What Happens |\n|-----------|--------------|\n| Validate manifest | Plugin won't load, no error message |\n| chmod +x scripts | Hooks silently fail |\n| ${CLAUDE_PLUGIN_ROOT} | Works in dev, breaks on install |\n| Standard directory rules | Components not discovered |\n\n**Running `/plugin-development:validate` catches 90% of issues before debugging starts.**\n\n## Playbooks\n\n- **Scaffold** ‚Üí `/plugin-development:init <name>` then fill templates\n- **Add a component** ‚Üí `/plugin-development:add-command|add-skill|add-agent|add-hook`\n- **Validate** ‚Üí `/plugin-development:validate` (schema & structure checks)\n- **Test locally** ‚Üí `/plugin-development:test-local` (dev marketplace)\n\n## Common Workflows\n\n### Creating a New Plugin\n\n1. Run `/plugin-development:init <plugin-name>` to scaffold structure\n2. Edit `.claude-plugin/plugin.json` with your metadata\n3. Add components using `/plugin-development:add-command`, etc.\n4. Validate with `/plugin-development:validate`\n5. Test locally with `/plugin-development:test-local`\n\n### Adding a Slash Command\n\n1. Run `/plugin-development:add-command <name> <description>`\n2. Edit `commands/<name>.md` with instructions\n3. Add frontmatter: `description` and `argument-hint`\n4. Test: `/plugin install` your plugin, then `/<name>`\n\n### Adding a Skill\n\n1. Run `/plugin-development:add-skill <name> <when-to-use>`\n2. Edit `skills/<name>/SKILL.md` with your instructions\n3. **Frontmatter requirements**:\n   - `name`: lowercase letters, numbers, and hyphens only, max 64 chars (required). Cannot contain reserved words 'anthropic' or 'claude'. Cannot contain XML tags.\n   - `description`: include both WHAT the Skill does AND WHEN to use it, max 1024 chars (required). Cannot contain XML tags.\n   - `model`: specify which Claude model to use, e.g., `model: claude-sonnet-4-20250514` (optional, defaults to conversation's model)\n   - `allowed-tools`: comma-separated list of tools (optional). Tools listed don't require permission to use when Skill is active. If omitted, Skill doesn't restrict tools.\n4. Keep SKILL.md under 500 lines for optimal performance; place details in sibling files (reference.md, examples.md, scripts/)\n\n### Troubleshooting\n\n- **Plugin not loading?** Check `plugin.json` paths are relative to plugin root. Do NOT include `commands`, `agents`, `skills`, or `hooks` fields for standard directories.\n- **Commands not showing?** Verify `commands/` directory exists at plugin root with `.md` files. Do NOT add `commands` field to `plugin.json` for standard paths.\n- **Hooks not running?** Ensure scripts are executable (`chmod +x`) and use `${CLAUDE_PLUGIN_ROOT}` for paths\n- **Skill not triggering?** Check `name` matches directory and uses lowercase letters, numbers, and hyphens only (max 64 chars). Ensure `description` includes both what and when to use (max 1024 chars). Neither field can contain XML tags.\n\n## Notes\n\n- Prefer templates & scripts over freeform generation for deterministic tasks\n- If writes are needed, propose a command or a PR-style diff first\n- For complex audits, delegate to `/agents plugin-reviewer`\n- Always validate with `/plugin-development:validate` before testing\n",
        "plugins/plugin-development/skills/plugin-authoring/best-practices/common-mistakes.md": "# Common Plugin Mistakes\n\nAvoid these patterns that cause silent failures.\n\n## Directory Structure\n\n### Components Inside .claude-plugin/\n\n```\nmy-plugin/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îú‚îÄ‚îÄ plugin.json\n‚îÇ   ‚îú‚îÄ‚îÄ commands/      # WRONG!\n‚îÇ   ‚îî‚îÄ‚îÄ agents/        # WRONG!\n```\n\n**Why it fails**: Claude Code only looks for `plugin.json` inside `.claude-plugin/`. Components are discovered at plugin root, not inside the manifest directory.\n\n**Fix**:\n```\nmy-plugin/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json    # Only this file here\n‚îú‚îÄ‚îÄ commands/          # At root\n‚îú‚îÄ‚îÄ agents/            # At root\n‚îî‚îÄ‚îÄ skills/            # At root\n```\n\n---\n\n## plugin.json Configuration\n\n### Specifying Standard Paths\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"commands\": \"./commands/\",\n  \"agents\": \"./agents/\"\n}\n```\n\n**Why it fails**: When you specify component paths, you're telling Claude Code to use ONLY those paths. Standard directories (`commands/`, `agents/`, `skills/`, `hooks/`) are auto-discovered‚Äîexplicitly specifying them can interfere with discovery.\n\n**Fix**:\n```json\n{\n  \"name\": \"my-plugin\"\n}\n```\n\nOnly add component fields for **non-standard** locations like `./custom-commands/`.\n\n### Absolute Paths\n\n```json\n{\n  \"commands\": \"/Users/you/plugins/my-plugin/commands/\"\n}\n```\n\n**Why it fails**: Absolute paths break when plugin is installed on another machine or in a different location.\n\n**Fix**: Always use relative paths starting with `./`:\n```json\n{\n  \"commands\": [\"./custom/cmd.md\"]\n}\n```\n\n---\n\n## Hook Scripts\n\n### Relative Paths in Hook Commands\n\n```json\n{\n  \"command\": \"./scripts/format.sh\"\n}\n```\n\n**Why it fails**: Relative paths resolve from where Claude Code runs (the project directory), not from the plugin location. Works during development in the plugin directory, breaks completely when plugin is installed elsewhere.\n\n**Fix**: Always use `${CLAUDE_PLUGIN_ROOT}`:\n```json\n{\n  \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format.sh\"\n}\n```\n\n### Non-Executable Scripts\n\n```bash\n# Created script but forgot: chmod +x scripts/format.sh\n```\n\n**Why it fails**: Hook silently fails with no error message. You'll spend hours debugging why the hook \"isn't running.\"\n\n**Fix**: Always make scripts executable:\n```bash\nchmod +x scripts/*.sh\n```\n\n### Missing Timeout on Slow Operations\n\n```json\n{\n  \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/lint.sh\"\n  // No timeout specified\n}\n```\n\n**Why it fails**: Default timeout is 60 seconds. If your script takes longer, it's killed silently.\n\n**Fix**: Set appropriate timeout:\n```json\n{\n  \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/lint.sh\",\n  \"timeout\": 120\n}\n```\n\n### Wrong Matcher Syntax\n\n```json\n{\n  \"PreToolUse\": [\n    {\n      \"matcher\": \"write\",  // Wrong case!\n      \"hooks\": [...]\n    }\n  ]\n}\n```\n\n**Why it fails**: Matchers are case-sensitive. `\"write\"` won't match the `Write` tool.\n\n**Fix**: Use exact tool names:\n```json\n{\n  \"matcher\": \"Write|Edit\"\n}\n```\n\n---\n\n## Skill Configuration\n\n### Name Doesn't Match Directory\n\n```\nskills/my-skill/SKILL.md\n---\nname: MySkill   # Doesn't match directory!\n---\n```\n\n**Why it fails**: Discovery uses directory name. Mismatched names cause confusion and potential discovery issues.\n\n**Fix**: Name must match directory in kebab-case:\n```\nskills/my-skill/SKILL.md\n---\nname: my-skill  # Matches directory\n---\n```\n\n### Reserved Words in Skill Name\n\n```yaml\nname: claude-helper      # Contains 'claude'!\nname: anthropic-tools    # Contains 'anthropic'!\n```\n\n**Why it fails**: Names containing 'claude' or 'anthropic' are reserved and will be rejected.\n\n**Fix**: Use different naming:\n```yaml\nname: assistant-helper\nname: ai-tools\n```\n\n### Description Missing \"When to Use\"\n\n```yaml\ndescription: Helps with code review\n```\n\n**Why it fails**: Claude uses descriptions to decide when to activate skills. Without trigger conditions, skill may not activate when needed.\n\n**Fix**: Include both what AND when:\n```yaml\ndescription: Provides code review guidance. Use when reviewing PRs, examining code quality, or preparing code for review.\n```\n\n### Skill Over 500 Lines\n\n```markdown\n# SKILL.md (2000 lines of content)\nEverything inline...\n```\n\n**Why it fails**: Large skills consume excessive context tokens and may not be fully processed.\n\n**Fix**: Use progressive disclosure:\n```markdown\n# SKILL.md (~300 lines)\n## Quick Links\n- [Detailed API Reference](./reference.md)\n- [Examples](./examples.md)\n```\n\n---\n\n## Marketplace Configuration\n\n### Plugin Name Mismatch\n\n```json\n// marketplace.json\n{\n  \"plugins\": [\n    {\n      \"name\": \"my-plugin\",\n      \"source\": \"./plugins/other-name\"  // Directory doesn't match!\n    }\n  ]\n}\n\n// plugins/other-name/.claude-plugin/plugin.json\n{\n  \"name\": \"other-name\"  // Doesn't match marketplace entry!\n}\n```\n\n**Why it fails**: The `name` in marketplace.json must match the `name` in the plugin's plugin.json.\n\n**Fix**: Ensure names match:\n```json\n// Both must use \"my-plugin\"\n```\n\n### Absolute Source Paths\n\n```json\n{\n  \"source\": \"/Users/you/dev/plugins/my-plugin\"\n}\n```\n\n**Why it fails**: Breaks for anyone else using the marketplace.\n\n**Fix**: Use relative paths:\n```json\n{\n  \"source\": \"./plugins/my-plugin\"\n}\n```\n\n---\n\n## Validation Skipping\n\n### Testing Without Validation\n\n```bash\n# Skip validation, jump straight to testing\n/plugin install my-plugin@dev-marketplace\n# Wonder why nothing works...\n```\n\n**Why it fails**: Many issues are silent. Plugin loads but components don't work. Hours wasted debugging.\n\n**Fix**: ALWAYS validate first:\n```bash\n/plugin-development:validate\n# Fix any issues BEFORE testing\n/plugin install my-plugin@dev-marketplace\n```\n\n---\n\n## Prevention Checklist\n\nBefore testing any plugin:\n\n```\n‚ñ° Components at plugin root (not inside .claude-plugin/)\n‚ñ° No component fields in plugin.json for standard directories\n‚ñ° Hooks use ${CLAUDE_PLUGIN_ROOT} for all paths\n‚ñ° Scripts are executable (chmod +x)\n‚ñ° Skill names match directory names (kebab-case)\n‚ñ° Skill names don't contain 'claude' or 'anthropic'\n‚ñ° Skill descriptions include when to use\n‚ñ° Marketplace plugin names match plugin.json names\n‚ñ° All paths are relative (start with ./)\n‚ñ° /plugin-development:validate passes\n```\n\n## Quick Diagnostic\n\n| Symptom | Likely Cause | Check |\n|---------|--------------|-------|\n| Plugin doesn't load | plugin.json location or syntax | `.claude-plugin/plugin.json` exists? Valid JSON? |\n| Commands don't appear | Wrong directory or missing frontmatter | `commands/*.md` at root? Has `description` frontmatter? |\n| Hooks don't run | Path or permission issue | Using `${CLAUDE_PLUGIN_ROOT}`? Scripts executable? |\n| Skill doesn't trigger | Description missing triggers | Includes \"when to use\"? |\n| Marketplace install fails | Name mismatch | Names identical in marketplace.json and plugin.json? |\n",
        "plugins/plugin-development/skills/plugin-authoring/best-practices/naming-conventions.md": "# Naming Conventions\n\nConsistent naming patterns for Claude Code plugins and components.\n\n## General Principles\n\n1. **Predictable**: Names should indicate purpose\n2. **Consistent**: Follow patterns throughout plugin\n3. **Case-sensitive**: Respect case conventions for each component type\n4. **Descriptive**: Prefer clarity over brevity\n5. **Avoid conflicts**: Namespace to prevent collisions\n\n## Plugin Names\n\n### Format\n\n**kebab-case** (lowercase with hyphens)\n\n### Examples\n\n‚úÖ **Good**:\n- `plugin-development`\n- `code-review-tools`\n- `git-workflow`\n- `python-helpers`\n\n‚ùå **Bad**:\n- `PluginDevelopment` (camelCase)\n- `plugin_development` (snake_case)\n- `plugindevelopment` (no separators)\n- `PLUGIN-DEVELOPMENT` (uppercase)\n\n### Naming Tips\n\n- **Descriptive**: Name reflects functionality\n- **Concise**: 1-3 words typical\n- **No prefix**: Don't use \"plugin-\" prefix (redundant)\n  - ‚úÖ `code-review`\n  - ‚ùå `plugin-code-review`\n\n## Command Names\n\n### Format\n\n**kebab-case** (lowercase with hyphens)\n\nFiles: `command-name.md`\n\n### Examples\n\n‚úÖ **Good**:\n- `init.md` ‚Üí `/plugin-name:init`\n- `add-command.md` ‚Üí `/plugin-name:add-command`\n- `validate-all.md` ‚Üí `/plugin-name:validate-all`\n- `run-tests.md` ‚Üí `/plugin-name:run-tests`\n\n‚ùå **Bad**:\n- `Init.md` (capitalized)\n- `add_command.md` (snake_case)\n- `addCommand.md` (camelCase)\n\n### Command Invocation\n\nCommands can be invoked with or without the plugin prefix:\n\n**Full format**: `/plugin-name:command-name`\n\n**Examples**:\n- `/plugin-development:init`\n- `/git-workflow:commit-push`\n- `/test-runner:run-all`\n\n### Namespacing\n\n**Plugin prefix is optional** unless there are name conflicts. When no conflict exists, you can use the command directly:\n\n- Direct: `/format-code` (when no conflict)\n- Prefixed: `/my-tools:format-code` (when needed for disambiguation)\n\nCommands are automatically namespaced by plugin name:\n- Plugin: `my-tools`\n- Command file: `format.md`\n- Invocation options:\n  - `/format` (if no other plugin has this command)\n  - `/my-tools:format` (when needed to disambiguate)\n\nThis prevents conflicts between plugins.\n\n### Verb-Based Naming\n\nStart commands with action verbs:\n\n‚úÖ **Good**:\n- `create-component`\n- `validate-config`\n- `run-tests`\n- `deploy-app`\n\n‚ùå **Bad**:\n- `component-creation` (noun-based)\n- `config-validation` (noun-based)\n\n## Skill Names\n\n### Format\n\n**kebab-case** (lowercase with hyphens)\n\nDirectory: `skill-name/`\nFile: `SKILL.md` (always uppercase)\n\n### Examples\n\n‚úÖ **Good**:\n- `plugin-authoring/SKILL.md`\n- `code-review/SKILL.md`\n- `api-design/SKILL.md`\n\n‚ùå **Bad**:\n- `PluginAuthoring/SKILL.md` (camelCase)\n- `plugin_authoring/SKILL.md` (snake_case)\n- `plugin-authoring/skill.md` (lowercase skill.md)\n\n### Frontmatter Name\n\nShould match directory name (recommended for consistency):\n\n```markdown\n---\nname: plugin-authoring    # Matches directory\ndescription: ...\n---\n```\n\n‚ùå **Poor practice**:\n```\nDirectory: plugin-authoring/\nFrontmatter: name: PluginAuthoring  # Doesn't match! Use kebab-case\n```\n\n**Note**: While the `name` field in frontmatter is what Claude uses to discover and reference Skills, having it match the directory name prevents confusion and follows best practices.\n\n### Skill Naming Tips\n\n- **Domain-focused**: Name reflects area of expertise\n- **Singular**: `code-review` not `code-reviews`\n- **Avoid \"skill\" suffix**: Name is the capability\n  - ‚úÖ `plugin-authoring`\n  - ‚ùå `plugin-authoring-skill`\n\n## Agent Names\n\n### Format\n\n**kebab-case** (lowercase with hyphens)\n\nFiles: `agent-name.md`\n\n### Examples\n\n‚úÖ **Good**:\n- `code-reviewer.md`\n- `test-analyzer.md`\n- `security-auditor.md`\n- `plugin-reviewer.md`\n\n‚ùå **Bad**:\n- `CodeReviewer.md` (camelCase)\n- `code_reviewer.md` (snake_case)\n\n### Agent Naming Tips\n\n- **Role-based**: Name indicates what agent does\n- **Often noun**: Describes the agent's role\n  - `reviewer`, `analyzer`, `auditor`\n- **Suffix optional**: `-er`, `-or` common but not required\n  - ‚úÖ `code-reviewer`\n  - ‚úÖ `security-audit`\n\n## Hook Script Names\n\n### Format\n\n**kebab-case** (lowercase with hyphens)\n\nExtension: `.sh` for bash scripts\n\n### Examples\n\n‚úÖ **Good**:\n- `validate-plugin.sh`\n- `format-code.sh`\n- `pre-write-check.sh`\n- `session-start-info.sh`\n\n‚ùå **Bad**:\n- `validatePlugin.sh` (camelCase)\n- `validate_plugin.sh` (snake_case)\n- `VALIDATE-PLUGIN.sh` (uppercase)\n\n### Hook Naming Tips\n\n- **Purpose-based**: Name indicates what hook does\n- **Event optional**: Can include event in name\n  - `pre-write-validate.sh`\n  - `post-write-format.sh`\n\n## Marketplace Names\n\n### Format\n\n**kebab-case** (lowercase with hyphens)\n\n### Examples\n\n‚úÖ **Good**:\n- `team-tools`\n- `acme-plugins`\n- `dev-marketplace`\n- `internal-tools`\n\n‚ùå **Bad**:\n- `TeamTools` (camelCase)\n- `team_tools` (snake_case)\n\n## Variable and Argument Names\n\n### In Commands\n\nUse uppercase with underscores for built-in variables:\n- `$ARGUMENTS`: All arguments as string\n- `$1`, `$2`, etc.: Individual arguments\n\n### In Documentation\n\nUse lowercase with hyphens in examples:\n```markdown\nargument-hint: [plugin-name] [command-type]\n```\n\n## File Extensions\n\n### Markdown\n\n- Commands: `.md`\n- Agents: `.md`\n- Skills: `SKILL.md` (specific name)\n- Documentation: `.md`\n\n### Configuration\n\n- Plugin manifest: `plugin.json`\n- Marketplace manifest: `marketplace.json`\n- Hooks config: `hooks.json`\n\n### Scripts\n\n- Bash: `.sh`\n- Python: `.py`\n- Node: `.js`\n\n## Directory Names\n\n### Standard Directories\n\nUse these exact names:\n- `commands/` (not `command/` or `cmd/`)\n- `agents/` (not `agent/` or `subagents/`)\n- `skills/` (not `skill/`)\n- `hooks/` (not `hook/`)\n- `scripts/` (not `script/` or `bin/`)\n\n### Custom Directories\n\nFor additional organization, use kebab-case:\n- `templates/`\n- `schemas/`\n- `examples/`\n- `best-practices/`\n- `test-fixtures/`\n\n## Metadata Fields\n\n### In plugin.json\n\n```json\n{\n  \"name\": \"kebab-case\",\n  \"description\": \"Sentence case with capital first letter\",\n  \"keywords\": [\"lowercase\", \"multi-word-hyphenated\"],\n  \"license\": \"UPPERCASE (e.g., MIT, Apache-2.0)\"\n}\n```\n\n### Author Names\n\nUse natural capitalization:\n```json\n{\n  \"author\": {\n    \"name\": \"John Smith\",\n    \"email\": \"john@example.com\"\n  }\n}\n```\n\n## Category and Tag Conventions\n\n### Categories\n\nUse singular, lowercase:\n- `development`\n- `productivity`\n- `utilities`\n- `devops`\n\n### Tags\n\nUse lowercase, hyphenated for multi-word:\n- `code-review`\n- `testing`\n- `deployment`\n- `git-workflow`\n\n## Consistency Checklist\n\n```\n‚ñ° Plugin name: kebab-case\n‚ñ° Commands: kebab-case, .md extension\n‚ñ° Skills: kebab-case directory, SKILL.md file\n‚ñ° Agents: kebab-case, .md extension\n‚ñ° Scripts: kebab-case, appropriate extension\n‚ñ° Directories: standard names (commands/, agents/, etc.)\n‚ñ° Frontmatter names match directory/file names\n‚ñ° Categories and tags: lowercase\n```\n\n## Examples by Component\n\n### Complete Plugin\n\n```\nmy-dev-tools/                    # kebab-case\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json              # name: \"my-dev-tools\"\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îú‚îÄ‚îÄ format-code.md           # kebab-case\n‚îÇ   ‚îú‚îÄ‚îÄ run-tests.md             # kebab-case\n‚îÇ   ‚îî‚îÄ‚îÄ validate-all.md          # kebab-case\n‚îú‚îÄ‚îÄ agents/\n‚îÇ   ‚îî‚îÄ‚îÄ code-reviewer.md         # kebab-case\n‚îú‚îÄ‚îÄ skills/\n‚îÇ   ‚îî‚îÄ‚îÄ code-quality/            # kebab-case\n‚îÇ       ‚îî‚îÄ‚îÄ SKILL.md             # UPPERCASE\n‚îú‚îÄ‚îÄ hooks/\n‚îÇ   ‚îî‚îÄ‚îÄ hooks.json\n‚îî‚îÄ‚îÄ scripts/\n    ‚îú‚îÄ‚îÄ pre-write-check.sh       # kebab-case\n    ‚îî‚îÄ‚îÄ post-write-format.sh     # kebab-case\n```\n\n### Invocations\n\n```bash\n/my-dev-tools:format-code\n/my-dev-tools:run-tests\n/my-dev-tools:validate-all\n```\n\n## Anti-Patterns\n\n### ‚ùå Mixed Case\n\n```\nMyDevTools/\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îú‚îÄ‚îÄ FormatCode.md      # Wrong!\n‚îÇ   ‚îî‚îÄ‚îÄ runTests.md        # Wrong!\n```\n\n### ‚ùå Inconsistent Separators\n\n```\nmy_dev_tools/              # snake_case\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îú‚îÄ‚îÄ format-code.md     # kebab-case\n‚îÇ   ‚îî‚îÄ‚îÄ runTests.md        # camelCase\n```\n\n### ‚ùå Wrong SKILL.md Case\n\n```\nskills/\n‚îî‚îÄ‚îÄ my-skill/\n    ‚îî‚îÄ‚îÄ skill.md           # Should be SKILL.md\n```\n\n## When in Doubt\n\nFollow these defaults:\n- **Files/directories**: kebab-case\n- **SKILL.md**: Always uppercase\n- **JSON fields**: Follow schema (usually camelCase for author fields, kebab-case for names)\n- **Invocation**: `/plugin-name:command-name` (always kebab-case)\n",
        "plugins/plugin-development/skills/plugin-authoring/best-practices/organization.md": "# Plugin Organization Best Practices\n\nGuidelines for structuring well-organized, maintainable Claude Code plugins.\n\n## Directory Structure\n\n### Standard Layout\n\n```\nplugin-name/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json           # Manifest only\n‚îú‚îÄ‚îÄ commands/                 # Slash commands (*.md)\n‚îú‚îÄ‚îÄ agents/                   # Sub-agents (*.md)\n‚îú‚îÄ‚îÄ skills/                   # Skills (folders with SKILL.md)\n‚îú‚îÄ‚îÄ hooks/                    # Hook configurations\n‚îÇ   ‚îî‚îÄ‚îÄ hooks.json            # Main hook config file\n‚îú‚îÄ‚îÄ scripts/                  # Hook scripts, utilities\n‚îî‚îÄ‚îÄ README.md                 # User-facing documentation\n```\n\n### Key Principles\n\n1. **Manifest isolation**: Only `plugin.json` goes in `.claude-plugin/`\n2. **Component separation**: Keep commands, agents, skills, and hooks in separate directories\n3. **Relative paths**: All paths in manifests are relative to plugin root\n4. **Default directories**: Standard directories (`commands/`, `agents/`, `skills/`, `hooks/`) are automatically discovered\n5. **Flat commands**: Command files go directly in `commands/`, not subdirectories (unless using custom paths)\n6. **Nested skills**: Skills are folders with `SKILL.md` + support files\n7. **Custom paths**: Use component fields in `plugin.json` only for non-standard locations\n\n## File Naming\n\n### Commands\n\n- **Format**: `command-name.md`\n- **Case**: kebab-case (lowercase with hyphens)\n- **Examples**: `init.md`, `add-command.md`, `validate.md`\n\n### Agents\n\n- **Format**: `agent-name.md`\n- **Case**: kebab-case\n- **Examples**: `code-reviewer.md`, `test-analyzer.md`\n\n### Skills\n\n- **Format**: `skill-name/SKILL.md` (directory + SKILL.md)\n- **Case**: kebab-case for directory\n- **Examples**: `plugin-authoring/SKILL.md`, `code-review/SKILL.md`\n\n### Hooks\n\n- **Standard**: `hooks.json` (one per plugin)\n- **Scripts**: `scripts/script-name.sh` (kebab-case)\n\n## Skill Organization\n\n### Progressive Disclosure Pattern\n\nKeep `SKILL.md` concise (< 500 lines) and link to detailed files:\n\n```\nskills/my-skill/\n‚îú‚îÄ‚îÄ SKILL.md              # Main skill definition (concise)\n‚îú‚îÄ‚îÄ schemas/              # Data format documentation\n‚îÇ   ‚îî‚îÄ‚îÄ config-schema.md\n‚îú‚îÄ‚îÄ templates/            # Reusable templates\n‚îÇ   ‚îî‚îÄ‚îÄ config-template.json\n‚îú‚îÄ‚îÄ examples/             # Usage examples\n‚îÇ   ‚îî‚îÄ‚îÄ basic-usage.md\n‚îî‚îÄ‚îÄ best-practices/       # Detailed guidance\n    ‚îî‚îÄ‚îÄ patterns.md\n```\n\n### SKILL.md Structure\n\n```markdown\n---\nname: skill-name\ndescription: What and when (concise, < 200 chars)\nallowed-tools: Read, Grep, Glob\n---\n\n# Skill Name\n\n[2-3 sentence overview]\n\n## Quick Links\n- [Reference 1](./reference1.md)\n- [Reference 2](./reference2.md)\n\n## [Concise sections...]\n```\n\n## Command Organization\n\n### Simple Plugins\n\nFor plugins with few commands (< 5):\n\n```\ncommands/\n‚îú‚îÄ‚îÄ command1.md\n‚îú‚îÄ‚îÄ command2.md\n‚îî‚îÄ‚îÄ command3.md\n```\n\n### Complex Plugins\n\nFor plugins with many related commands, consider namespacing:\n\n```\ncommands/\n‚îú‚îÄ‚îÄ git-commit.md\n‚îú‚îÄ‚îÄ git-push.md\n‚îú‚îÄ‚îÄ git-branch.md\n‚îú‚îÄ‚îÄ test-unit.md\n‚îú‚îÄ‚îÄ test-integration.md\n‚îî‚îÄ‚îÄ test-e2e.md\n```\n\nCommands are invoked as `/plugin-name:git-commit`, etc.\n\n## Hook Organization\n\n### Simple Hooks\n\nHooks configuration goes in `hooks/hooks.json`:\n\n```\nhooks/\n‚îî‚îÄ‚îÄ hooks.json\n```\n\nAlternatively, hooks can be defined inline in `plugin.json` or specified via the `hooks` field:\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"hooks\": \"./hooks/hooks.json\"\n}\n```\n\nOr inline configuration:\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"hooks\": {\n    \"PostToolUse\": [...]\n  }\n}\n```\n\n### Complex Hooks\n\nWith multiple scripts, organize them under `hooks/scripts/`:\n\n```\nhooks/\n‚îú‚îÄ‚îÄ hooks.json\n‚îî‚îÄ‚îÄ scripts/\n    ‚îú‚îÄ‚îÄ pre-write-validation.sh\n    ‚îú‚îÄ‚îÄ post-write-format.sh\n    ‚îî‚îÄ‚îÄ session-start-info.sh\n```\n\nReference scripts using the `${CLAUDE_PLUGIN_ROOT}` environment variable:\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/hooks/scripts/pre-write-validation.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Documentation Structure\n\n### README.md (Required)\n\nUser-facing documentation:\n\n```markdown\n# Plugin Name\n\nBrief description\n\n## Installation\n\n[How to install]\n\n## Usage\n\n[Commands, examples]\n\n## Configuration\n\n[If applicable]\n```\n\n### Additional Docs\n\nFor complex plugins:\n\n```\ndocs/\n‚îú‚îÄ‚îÄ getting-started.md\n‚îú‚îÄ‚îÄ api-reference.md\n‚îú‚îÄ‚îÄ troubleshooting.md\n‚îî‚îÄ‚îÄ examples/\n    ‚îú‚îÄ‚îÄ basic.md\n    ‚îî‚îÄ‚îÄ advanced.md\n```\n\n## Size Guidelines\n\n### Keep Components Focused\n\n- **Commands**: 50-200 lines (including examples)\n- **Skills**: SKILL.md < 500 lines, plus support files\n- **Agents**: 100-400 lines\n- **Hooks**: Keep scripts fast (< 1 second runtime)\n\n### When to Split\n\nConsider splitting when:\n- Single skill > 500 lines ‚Üí Create multiple skills\n- Many related commands ‚Üí Create separate plugins\n- Complex logic ‚Üí Move to support files with progressive disclosure\n\n## Common Patterns\n\n### Multi-Component Plugin\n\nCombines multiple component types:\n\n```\nmy-dev-tools/\n‚îú‚îÄ‚îÄ .claude-plugin/plugin.json\n‚îú‚îÄ‚îÄ commands/          # Quick actions\n‚îÇ   ‚îú‚îÄ‚îÄ format.md\n‚îÇ   ‚îî‚îÄ‚îÄ lint.md\n‚îú‚îÄ‚îÄ agents/            # Deep analysis\n‚îÇ   ‚îî‚îÄ‚îÄ code-reviewer.md\n‚îú‚îÄ‚îÄ skills/            # Ambient guidance\n‚îÇ   ‚îî‚îÄ‚îÄ code-review/SKILL.md\n‚îî‚îÄ‚îÄ hooks/             # Automation\n    ‚îú‚îÄ‚îÄ hooks.json\n    ‚îî‚îÄ‚îÄ scripts/\n```\n\n### Command-Only Plugin\n\nSimple plugins with just commands:\n\n```\nutility-commands/\n‚îú‚îÄ‚îÄ .claude-plugin/plugin.json\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îú‚îÄ‚îÄ command1.md\n‚îÇ   ‚îú‚îÄ‚îÄ command2.md\n‚îÇ   ‚îî‚îÄ‚îÄ command3.md\n‚îî‚îÄ‚îÄ README.md\n```\n\n### Skill-Focused Plugin\n\nDomain expertise plugins:\n\n```\nframework-expert/\n‚îú‚îÄ‚îÄ .claude-plugin/plugin.json\n‚îú‚îÄ‚îÄ skills/\n‚îÇ   ‚îî‚îÄ‚îÄ framework-guidance/\n‚îÇ       ‚îú‚îÄ‚îÄ SKILL.md\n‚îÇ       ‚îú‚îÄ‚îÄ schemas/\n‚îÇ       ‚îú‚îÄ‚îÄ templates/\n‚îÇ       ‚îî‚îÄ‚îÄ examples/\n‚îî‚îÄ‚îÄ README.md\n```\n\n## Versioning\n\n### Plugin Versioning\n\nUse **SemVer** in `plugin.json`:\n- **Major** (1.0.0): Breaking changes\n- **Minor** (0.1.0): New features, backward compatible\n- **Patch** (0.0.1): Bug fixes\n\n### Change Documentation\n\nMaintain `CHANGELOG.md`:\n\n```markdown\n# Changelog\n\n## [1.1.0] - 2024-01-15\n### Added\n- New command: validate-all\n\n### Changed\n- Improved error messages\n\n## [1.0.0] - 2024-01-01\n### Added\n- Initial release\n```\n\n## Testing Organization\n\n### Test Structure\n\n```\ntests/\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îú‚îÄ‚îÄ test-command1.sh\n‚îÇ   ‚îî‚îÄ‚îÄ test-command2.sh\n‚îú‚îÄ‚îÄ hooks/\n‚îÇ   ‚îú‚îÄ‚îÄ test-validation.sh\n‚îÇ   ‚îî‚îÄ‚îÄ test-formatting.sh\n‚îî‚îÄ‚îÄ integration/\n    ‚îî‚îÄ‚îÄ test-workflow.sh\n```\n\n### Validation Scripts\n\nKeep in `scripts/` for reuse:\n\n```\nscripts/\n‚îú‚îÄ‚îÄ validate-plugin.sh      # Used by hooks\n‚îú‚îÄ‚îÄ validate-commands.sh    # Used by tests\n‚îî‚îÄ‚îÄ validate-manifest.sh    # Used by CI\n```\n\n## Anti-Patterns\n\n### ‚ùå Don't: Components in .claude-plugin/\n\n```\n.claude-plugin/\n‚îú‚îÄ‚îÄ plugin.json\n‚îú‚îÄ‚îÄ commands/        # Wrong!\n‚îî‚îÄ‚îÄ hooks.json       # Wrong!\n```\n\n### ‚úÖ Do: Components at Plugin Root\n\n```\n.claude-plugin/\n‚îî‚îÄ‚îÄ plugin.json      # Only manifest\ncommands/            # At root\nhooks/               # At root\n```\n\n### ‚ùå Don't: Specify Default Paths in Manifest\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"commands\": \"./commands/\",\n  \"agents\": \"./agents/\"\n}\n```\n\n### ‚úÖ Do: Omit Component Fields When Using Default Directories\n\n```json\n{\n  \"name\": \"my-plugin\"\n}\n```\n\nWhen using standard directories (`commands/`, `agents/`, `skills/`, `hooks/`), they are automatically discovered and you don't need to specify them in `plugin.json`. Only use component fields (`commands`, `agents`, etc.) when:\n1. Using non-standard directory names (e.g., `./custom-commands/`)\n2. Including specific individual files (e.g., `[\"./commands/special.md\"]`)\n3. Combining custom paths with default paths\n\n### ‚ùå Don't: Absolute Paths\n\n```json\n{\n  \"commands\": [\"/Users/you/plugins/my-plugin/commands/cmd.md\"]\n}\n```\n\n### ‚úÖ Do: Relative Paths (for custom paths only)\n\n```json\n{\n  \"commands\": [\"./custom/cmd.md\"]\n}\n```\n\n### ‚ùå Don't: Monolithic Skills\n\n```markdown\n# SKILL.md (3000 lines)\n[Everything in one file...]\n```\n\n### ‚úÖ Do: Progressive Disclosure\n\n```markdown\n# SKILL.md (400 lines)\nQuick Links:\n- [Details](./details.md)\n- [Examples](./examples/)\n```\n\n## Summary Checklist\n\n```\n‚ñ° Manifest isolated in .claude-plugin/\n‚ñ° Components at plugin root (not inside .claude-plugin/)\n‚ñ° Default directories (commands/, agents/, skills/, hooks/) are automatically discovered\n‚ñ° Component fields in plugin.json only when using custom paths\n‚ñ° Kebab-case naming throughout\n‚ñ° Relative paths in all configs (start with ./)\n‚ñ° Skills use progressive disclosure\n‚ñ° Commands are focused (< 200 lines)\n‚ñ° Scripts are executable\n‚ñ° Hooks reference scripts using ${CLAUDE_PLUGIN_ROOT}\n‚ñ° README.md documents usage\n‚ñ° Version follows SemVer\n‚ñ° CHANGELOG.md tracks changes\n```\n",
        "plugins/plugin-development/skills/plugin-authoring/examples/simple-plugin.md": "# Example: Simple Plugin\n\nThis example shows a minimal but complete Claude Code plugin.\n\n## Directory Structure\n\n```\nmy-greeting-plugin/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îî‚îÄ‚îÄ greet.md\n‚îî‚îÄ‚îÄ README.md\n```\n\n## plugin.json\n\n```json\n{\n  \"name\": \"my-greeting-plugin\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A simple greeting plugin\",\n  \"author\": {\n    \"name\": \"Your Name\"\n  },\n  \"license\": \"MIT\",\n  \"keywords\": [\"greeting\", \"example\"]\n}\n```\n\n**Note**: No `commands` field needed since we're using the standard `commands/` directory.\n\n## commands/greet.md\n\n```markdown\n---\ndescription: Greet the user with a personalized message\nargument-hint: [name]\n---\n\n# Greet Command\n\nProvide a warm, friendly greeting to the user.\n\n## Instructions\n\n1. If the user provided a name via `$ARGUMENTS`, greet them personally\n2. If no name provided, use a generic friendly greeting\n3. Add a fun emoji to make it welcoming\n\n## Examples\n\n**Input**: `/my-greeting-plugin:greet Alice`\n**Output**: \"Hello, Alice! üëã Great to see you!\"\n\n**Input**: `/my-greeting-plugin:greet`\n**Output**: \"Hello there! üëã How can I help you today?\"\n```\n\n## README.md\n\n```markdown\n# My Greeting Plugin\n\nA simple example plugin that demonstrates Claude Code plugin basics.\n\n## Installation\n\nFrom a marketplace:\n```bash\n/plugin install my-greeting-plugin@marketplace-name\n```\n\n## Usage\n\n```bash\n/my-greeting-plugin:greet [name]\n```\n\n## Examples\n\n- `/my-greeting-plugin:greet World` - Greet with a name\n- `/my-greeting-plugin:greet` - Generic greeting\n```\n\n## Adding to a Marketplace\n\nIn your marketplace's `.claude-plugin/marketplace.json`:\n\n```json\n{\n  \"plugins\": [\n    {\n      \"name\": \"my-greeting-plugin\",\n      \"description\": \"A simple greeting plugin\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"Your Name\"\n      },\n      \"source\": \"./plugins/my-greeting-plugin\",\n      \"category\": \"examples\",\n      \"tags\": [\"greeting\", \"example\"]\n    }\n  ]\n}\n```\n\n## Testing Locally\n\n1. Create the plugin structure\n2. Create a dev marketplace:\n   ```bash\n   mkdir -p dev-marketplace/.claude-plugin\n   ```\n3. Create `dev-marketplace/.claude-plugin/marketplace.json` (see above)\n4. Add marketplace:\n   ```bash\n   /plugin marketplace add ./dev-marketplace\n   ```\n5. Install plugin:\n   ```bash\n   /plugin install my-greeting-plugin@dev-marketplace\n   ```\n6. Test command:\n   ```bash\n   /my-greeting-plugin:greet World\n   ```\n\n## Key Takeaways\n\n- **Minimal structure**: Only `.claude-plugin/plugin.json` and `commands/` are required\n- **Frontmatter**: Commands need `description` (and optionally `argument-hint`)\n- **Namespacing**: Commands are called with `/plugin-name:command-name`\n- **Arguments**: Access via `$ARGUMENTS` or `$1`, `$2`, etc.\n- **Standard paths**: No need to specify component fields in `plugin.json` when using standard directories\n",
        "plugins/plugin-development/skills/plugin-authoring/examples/testing-workflow.md": "# Testing Workflow\n\nA step-by-step guide to testing plugins locally during development.\n\n## Overview\n\nTesting plugins locally uses a **dev marketplace** that points to your working plugin directory. This allows you to:\n- Test changes without publishing\n- Iterate quickly\n- Validate before distribution\n\n## Setup: One-Time\n\n### 1. Create Dev Marketplace Structure\n\n```bash\n# From your project root\nmkdir -p dev-marketplace/.claude-plugin\n```\n\n### 2. Create marketplace.json\n\nCreate `dev-marketplace/.claude-plugin/marketplace.json`:\n\n```json\n{\n  \"name\": \"dev-marketplace\",\n  \"owner\": {\n    \"name\": \"Developer\"\n  },\n  \"metadata\": {\n    \"description\": \"Local development marketplace\",\n    \"version\": \"0.1.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"my-plugin\",\n      \"description\": \"Plugin under development\",\n      \"source\": \"../plugins/my-plugin\"\n    }\n  ]\n}\n```\n\n**Key**: `source` points to your plugin directory (relative path from marketplace).\n\n### 3. Add Marketplace to Claude Code\n\n```bash\nclaude\n/plugin marketplace add ./dev-marketplace\n```\n\nVerify:\n```bash\n/plugin marketplace list\n```\n\nYou should see `dev-marketplace` listed.\n\n## Iteration Loop\n\n### Install Plugin\n\n```bash\n/plugin install my-plugin@dev-marketplace\n```\n\n### Test Commands\n\n```bash\n/my-plugin:command-name args\n```\n\nOr test via `/help` to see if commands appear.\n\n### Make Changes\n\nEdit your plugin files (commands, skills, etc.).\n\n### Reinstall\n\n```bash\n/plugin uninstall my-plugin@dev-marketplace\n/plugin install my-plugin@dev-marketplace\n```\n\n**Note**: You must uninstall/reinstall to pick up changes.\n\n### Repeat\n\nContinue the edit ‚Üí reinstall ‚Üí test cycle.\n\n## Validation\n\nBefore each test cycle, validate your plugin:\n\n```bash\n/plugin-development:validate\n```\n\nThis checks:\n- `plugin.json` exists and is valid JSON\n- Component directories exist\n- Paths are correct\n- No common mistakes\n\n## Debugging\n\n### Plugin Not Loading\n\n1. Check `plugin.json` exists at `.claude-plugin/plugin.json`\n2. Verify JSON syntax: `cat .claude-plugin/plugin.json | jq .`\n3. Check paths are relative: `./commands/` not `/absolute/path/`\n\n### Commands Not Showing\n\n1. Verify `commands` field in `plugin.json` points to `./commands/`\n2. Check command files have `.md` extension\n3. Verify frontmatter has `description` field\n4. Reinstall the plugin\n\n### Hooks Not Running\n\n1. Check `hooks` field in `plugin.json` points to correct path\n2. Verify `hooks.json` is valid JSON\n3. Make scripts executable: `chmod +x scripts/*.sh`\n4. Test script directly: `./scripts/validate-plugin.sh`\n5. Use `claude --debug` to see hook execution\n\n### Skills Not Triggering\n\n1. Check `skills` field in `plugin.json` (if specified)\n2. Verify `SKILL.md` has frontmatter with `name` and `description`\n3. Ensure `name` matches directory name (lowercase, hyphenated)\n4. Check `description` includes clear trigger conditions\n\n## Advanced: Debug Mode\n\nRun Claude Code in debug mode to see detailed plugin loading:\n\n```bash\nclaude --debug\n```\n\nThis shows:\n- Plugin registration\n- Component discovery\n- Hook execution\n- Tool usage\n\nLook for errors related to your plugin in the output.\n\n## Multiple Plugins\n\nYou can test multiple plugins from one dev marketplace:\n\n```json\n{\n  \"plugins\": [\n    {\n      \"name\": \"plugin-one\",\n      \"source\": \"../plugins/plugin-one\"\n    },\n    {\n      \"name\": \"plugin-two\",\n      \"source\": \"../plugins/plugin-two\"\n    }\n  ]\n}\n```\n\nInstall each separately:\n```bash\n/plugin install plugin-one@dev-marketplace\n/plugin install plugin-two@dev-marketplace\n```\n\n## Clean Up\n\n### Uninstall Plugin\n\n```bash\n/plugin uninstall my-plugin@dev-marketplace\n```\n\n### Remove Marketplace\n\n```bash\n/plugin marketplace remove dev-marketplace\n```\n\n## Best Practices\n\n1. **Validate first**: Always run `/plugin-development:validate` before testing\n2. **Small changes**: Test incrementally, don't make many changes at once\n3. **Check logs**: Use `--debug` when troubleshooting\n4. **Script testing**: Test hook scripts directly before adding to hooks.json\n5. **Clean installs**: Uninstall fully before reinstalling to avoid cache issues\n\n## Troubleshooting Checklist\n\n```\n‚ñ° plugin.json exists and is valid JSON\n‚ñ° All paths are relative (start with ./)\n‚ñ° Component directories exist (commands/, etc.)\n‚ñ° Command files have .md extension\n‚ñ° Scripts are executable (chmod +x)\n‚ñ° marketplace.json plugin name matches plugin.json name\n‚ñ° Reinstalled after making changes\n```\n\n## Example Session\n\n```bash\n# One-time setup\nmkdir -p dev-marketplace/.claude-plugin\n# ... create marketplace.json ...\n/plugin marketplace add ./dev-marketplace\n\n# Development loop\n/plugin install my-plugin@dev-marketplace\n/my-plugin:test-command\n\n# Make changes to plugin files...\n\n/plugin-development:validate\n/plugin uninstall my-plugin@dev-marketplace\n/plugin install my-plugin@dev-marketplace\n/my-plugin:test-command\n\n# Repeat...\n```\n",
        "plugins/plugin-development/skills/plugin-authoring/schemas/hooks-schema.md": "# Hooks Schema\n\nHooks allow you to run commands at specific lifecycle events. Define them in `hooks/hooks.json`.\n\n## Location\n\n`hooks/hooks.json` (at plugin root, referenced in `plugin.json`)\n\n## Structure\n\n```json\n{\n  \"description\": \"Optional description of what these hooks do\",\n  \"hooks\": {\n    \"EventName\": [\n      {\n        \"matcher\": \"pattern\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"path/to/script.sh\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Hook Types\n\nHooks support three execution types:\n\n### Command Hooks (`type: \"command\"`)\n\nExecute shell commands with access to stdin (JSON input) and stdout/stderr.\n\n```json\n{\n  \"type\": \"command\",\n  \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate.sh\",\n  \"timeout\": 30\n}\n```\n\n### Prompt Hooks (`type: \"prompt\"`)\n\nEvaluate a prompt with an LLM. Supported for: `Stop`, `SubagentStop`, `UserPromptSubmit`, `PreToolUse`, `PermissionRequest`.\n\n```json\n{\n  \"type\": \"prompt\",\n  \"prompt\": \"Your evaluation prompt with $ARGUMENTS placeholder\",\n  \"timeout\": 30\n}\n```\n\n**LLM Response Schema**:\n```json\n{\n  \"decision\": \"approve\" | \"block\",\n  \"reason\": \"Explanation\",\n  \"continue\": false,\n  \"stopReason\": \"User message\",\n  \"systemMessage\": \"Warning\"\n}\n```\n\n### Agent Hooks (`type: \"agent\"`)\n\nRun an agentic verifier with tools. For complex validation requiring tool access.\n\n## Event Types\n\n### PreToolUse\n\nRuns **before** Claude uses a tool. Can block tool execution, modify inputs, or auto-approve.\n\n```json\n{\n  \"PreToolUse\": [\n    {\n      \"matcher\": \"Write|Edit\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate.sh\",\n          \"timeout\": 30\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Matchers**: Tool names (case-sensitive regex patterns)\n- Built-in tools: `Task`, `Bash`, `Glob`, `Grep`, `Read`, `Edit`, `Write`, `WebFetch`, `WebSearch`\n- Regex patterns: `Edit|Write`, `Notebook.*`\n- Wildcard: `*` matches all tools\n- MCP tools: `mcp__<server>__<tool>` (e.g., `mcp__memory__create_entities`)\n\n**Exit codes**:\n- `0`: Allow (stdout visible to Claude)\n- `2`: **Block** (stderr shown to Claude as feedback)\n- Other: Warning (non-blocking)\n\n### PermissionRequest\n\nRuns when user is shown a permission dialog. Can auto-allow or deny on behalf of user.\n\n```json\n{\n  \"PermissionRequest\": [\n    {\n      \"matcher\": \"Bash\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/auto-approve.sh\",\n          \"timeout\": 10\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Matchers**: Same as PreToolUse (tool names, regex patterns, MCP tools)\n\n### PostToolUse\n\nRuns **after** a tool completes successfully. Can provide feedback to Claude.\n\n```json\n{\n  \"PostToolUse\": [\n    {\n      \"matcher\": \"Write|Edit\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format.sh\",\n          \"timeout\": 30\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Matchers**: Same as PreToolUse\n\n### Notification\n\nRuns when Claude Code sends notifications.\n\n```json\n{\n  \"Notification\": [\n    {\n      \"matcher\": \"permission_prompt\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/notify.sh\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Matchers**:\n- `permission_prompt` - Claude needs permission to use a tool\n- `idle_prompt` - Prompt input idle for 60+ seconds (system default, not configurable)\n- `auth_success` - Authentication success notifications\n- `elicitation_dialog` - Claude Code needs input for MCP tool elicitation\n\n### UserPromptSubmit\n\nRuns when user submits a prompt. Can block prompt processing or add context.\n\n```json\n{\n  \"UserPromptSubmit\": [\n    {\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/context-injector.sh\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**No matchers** - omit the matcher field.\n\n**Exit codes**:\n- `0`: Allow (stdout added to context)\n- `2`: **Block** (stderr shown to user)\n\n### Stop / SubagentStop\n\nRuns when Claude attempts to stop (main agent or subagent). Can decide if Claude should continue.\n\n```json\n{\n  \"Stop\": [\n    {\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/check-continuation.sh\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**No matchers** - omit the matcher field.\n\n### PreCompact\n\nRuns before Claude Code performs a compact operation.\n\n```json\n{\n  \"PreCompact\": [\n    {\n      \"matcher\": \"auto\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/backup-transcript.sh\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Matchers**:\n- `manual` - User-triggered compaction\n- `auto` - Automatic compaction\n\n### SessionStart\n\nRuns when Claude Code session starts.\n\n```json\n{\n  \"SessionStart\": [\n    {\n      \"matcher\": \"startup\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"echo 'Plugin loaded!'\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Matchers**:\n- `startup` - Invoked from startup\n- `resume` - Invoked from `--resume`, `--continue`, or `/resume`\n- `clear` - Invoked from `/clear`\n- `compact` - Invoked from auto or manual compact\n\n**Note**: SessionStart stdout is added to context automatically for Claude.\n\n**Special**: SessionStart hooks have access to `CLAUDE_ENV_FILE` for persisting environment variables.\n\n### SessionEnd\n\nRuns when a Claude Code session ends. Cannot block termination but can perform cleanup.\n\n```json\n{\n  \"SessionEnd\": [\n    {\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/cleanup.sh\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**No matchers** - omit the matcher field.\n\n**Reason field in input**: `exit`, `clear`, `logout`, `prompt_input_exit`, `other`\n\n## Environment Variables\n\nAvailable in hook commands:\n\n### All Hooks\n- `${CLAUDE_PLUGIN_ROOT}`: Absolute path to plugin root\n- `${CLAUDE_PROJECT_DIR}`: Project root directory (where Claude Code started)\n- `CLAUDE_CODE_REMOTE`: `\"true\"` if running in remote (web) environment, empty/unset for local CLI\n- Standard shell environment variables\n\n### SessionStart Hooks Only\n- `CLAUDE_ENV_FILE`: File path where you can persist environment variables for subsequent bash commands\n\n**Example: Persisting environment variables**\n```bash\n#!/bin/bash\nif [ -n \"$CLAUDE_ENV_FILE\" ]; then\n  echo 'export NODE_ENV=production' >> \"$CLAUDE_ENV_FILE\"\n  echo 'export API_KEY=your-api-key' >> \"$CLAUDE_ENV_FILE\"\n  echo 'export PATH=\"$PATH:./node_modules/.bin\"' >> \"$CLAUDE_ENV_FILE\"\nfi\nexit 0\n```\n\n**Example: Persisting environment changes from nvm**\n```bash\n#!/bin/bash\nENV_BEFORE=$(export -p | sort)\nsource ~/.nvm/nvm.sh\nnvm use 20\n\nif [ -n \"$CLAUDE_ENV_FILE\" ]; then\n  ENV_AFTER=$(export -p | sort)\n  comm -13 <(echo \"$ENV_BEFORE\") <(echo \"$ENV_AFTER\") >> \"$CLAUDE_ENV_FILE\"\nfi\nexit 0\n```\n\n## Timeouts\n\n- Default: 60 seconds (configurable per hook)\n- Recommended: 10-30 seconds for validation\n- Max: Keep under 60 seconds for good UX\n\n## JSON Output Format\n\nHooks communicate through exit codes, stdout, and stderr. For advanced control, output JSON to stdout with exit code 0.\n\n### Exit Codes\n- **0**: Success. JSON in stdout parsed for structured control\n- **2**: Blocking error. Only `stderr` used as error message. JSON in stdout ignored\n- **Other**: Non-blocking error. Stderr shown in verbose mode (ctrl+o)\n\n### Common Fields (All Hooks)\n\n```json\n{\n  \"continue\": true,\n  \"stopReason\": \"Reason shown to user\",\n  \"suppressOutput\": false,\n  \"systemMessage\": \"Warning message\"\n}\n```\n\n- `continue`: Allow Claude to continue (default: true)\n- `stopReason`: Why stopped (shown to user when continue=false)\n- `suppressOutput`: Hide output from transcript\n- `systemMessage`: Warning/info message shown to user\n\n### Hook-Specific Output (`hookSpecificOutput`)\n\n#### PreToolUse\n\n```json\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"PreToolUse\",\n    \"permissionDecision\": \"allow\" | \"deny\" | \"ask\",\n    \"permissionDecisionReason\": \"Explanation\",\n    \"updatedInput\": {\n      \"field_to_modify\": \"new_value\"\n    }\n  }\n}\n```\n\n- `permissionDecision`: `\"allow\"` (auto-approve), `\"deny\"` (block), `\"ask\"` (show permission dialog)\n- `updatedInput`: Optional object to modify tool input parameters before execution\n\n#### PermissionRequest\n\n```json\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"PermissionRequest\",\n    \"decision\": {\n      \"behavior\": \"allow\" | \"deny\",\n      \"updatedInput\": {},\n      \"message\": \"Denial reason\",\n      \"interrupt\": false\n    }\n  }\n}\n```\n\n- `behavior`: `\"allow\"` or `\"deny\"` the permission request\n- `updatedInput`: Optional for \"allow\" - modify tool inputs\n- `message`: Optional for \"deny\" - tells Claude why permission was denied\n- `interrupt`: Optional for \"deny\" - if true, stops Claude entirely\n\n#### PostToolUse\n\n```json\n{\n  \"decision\": \"block\" | undefined,\n  \"reason\": \"Explanation\",\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"PostToolUse\",\n    \"additionalContext\": \"Extra info for Claude\"\n  }\n}\n```\n\n- `decision`: Set to `\"block\"` to provide feedback that blocks further action\n- `additionalContext`: Additional information added to Claude's context\n\n#### UserPromptSubmit\n\n```json\n{\n  \"decision\": \"block\" | undefined,\n  \"reason\": \"Why blocked (not added to context)\",\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"UserPromptSubmit\",\n    \"additionalContext\": \"Context added to conversation\"\n  }\n}\n```\n\nAlternatively, plain text stdout with exit code 0 is added as context.\n\n#### Stop / SubagentStop\n\n```json\n{\n  \"decision\": \"block\" | undefined,\n  \"reason\": \"Must provide when blocking - tells Claude how to proceed\"\n}\n```\n\n- `decision`: Set to `\"block\"` to prevent Claude from stopping and continue working\n- `reason`: Required when blocking - instructs Claude on what to do next\n\n#### SessionStart\n\n```json\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"SessionStart\",\n    \"additionalContext\": \"Context loaded at session start\"\n  }\n}\n```\n\n## MCP Tool Matching\n\nMCP tools follow the pattern: `mcp__<server>__<tool>`\n\n**Examples**:\n- `mcp__memory__create_entities`\n- `mcp__filesystem__read_file`\n- `mcp__github__search_repositories`\n\n**Configuration**:\n```json\n{\n  \"PreToolUse\": [\n    {\n      \"matcher\": \"mcp__memory__.*\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"echo 'Memory operation' >> ~/mcp-operations.log\"\n        }\n      ]\n    },\n    {\n      \"matcher\": \"mcp__.*__write.*\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate-mcp-write.py\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n## Common Patterns\n\n### Validation Hook (Blocking)\n\n```json\n{\n  \"PreToolUse\": [\n    {\n      \"matcher\": \"Write|Edit\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate.sh\",\n          \"timeout\": 30\n        }\n      ]\n    }\n  ]\n}\n```\n\n**validate.sh**:\n```bash\n#!/usr/bin/env bash\nif [ validation_fails ]; then\n  echo \"Error: validation failed\" >&2\n  exit 2  # Block the tool\nfi\nexit 0  # Allow\n```\n\n**Advanced JSON output** (alternative to exit codes):\n```json\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"PreToolUse\",\n    \"permissionDecision\": \"deny\",\n    \"permissionDecisionReason\": \"File violates security policy\"\n  },\n  \"suppressOutput\": true\n}\n```\n\n### Formatting Hook (Non-blocking)\n\n```json\n{\n  \"PostToolUse\": [\n    {\n      \"matcher\": \"Write|Edit\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format.sh\",\n          \"timeout\": 30\n        }\n      ]\n    }\n  ]\n}\n```\n\n### Startup Message\n\n```json\n{\n  \"SessionStart\": [\n    {\n      \"matcher\": \"startup\",\n      \"hooks\": [\n        {\n          \"type\": \"command\",\n          \"command\": \"echo '‚úì My Plugin loaded'\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n## Best Practices\n\n- **Use `${CLAUDE_PLUGIN_ROOT}`** for portable paths\n- **Set timeouts** to prevent hanging (10-30 seconds recommended)\n- **Exit code 2** to block (PreToolUse/UserPromptSubmit)\n- **Keep scripts fast** (< 1 second ideally)\n- **Make scripts executable** (`chmod +x`)\n- **Test hooks** before distributing\n- **Handle JSON output** for advanced control (see advanced examples)\n\n## Common Mistakes\n\n‚ùå **Absolute paths** (not portable)\n```json\n{\n  \"command\": \"/Users/you/plugin/scripts/validate.sh\"\n}\n```\n\n‚úÖ **Plugin-relative paths**\n```json\n{\n  \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate.sh\"\n}\n```\n\n‚ùå **No timeout** on slow operations\n```json\n{\n  \"command\": \"npm install\"\n  // Missing timeout!\n}\n```\n\n‚úÖ **Set appropriate timeout**\n```json\n{\n  \"command\": \"npm install\",\n  \"timeout\": 300000\n}\n```\n\n‚ùå **Missing required matcher**\n```json\n{\n  \"SessionStart\": [\n    {\n      \"hooks\": [...]  // No matcher!\n    }\n  ]\n}\n```\n\n‚úÖ **Include appropriate matcher**\n```json\n{\n  \"SessionStart\": [\n    {\n      \"matcher\": \"startup\",\n      \"hooks\": [...]\n    }\n  ]\n}\n```\n\n## Debugging\n\nUse `claude --debug` to see:\n- Hook registration\n- Hook execution timing\n- Exit codes and output\n- Blocking decisions\n",
        "plugins/plugin-development/skills/plugin-authoring/schemas/marketplace-schema.md": "# Marketplace Schema\n\nThe `marketplace.json` file defines a collection of plugins that users can install.\n\n## Location\n\n`.claude-plugin/marketplace.json` (at marketplace root)\n\n## Structure\n\n```json\n{\n  \"name\": \"marketplace-name\",\n  \"owner\": {\n    \"name\": \"Your Organization\",\n    \"email\": \"team@your-org.com\"\n  },\n  \"metadata\": {\n    \"description\": \"Marketplace description\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"plugin-name\",\n      \"description\": \"What the plugin does\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"Author Name\"\n      },\n      \"source\": \"./plugins/plugin-name\",\n      \"category\": \"utilities\",\n      \"tags\": [\"tag1\", \"tag2\"],\n      \"keywords\": [\"keyword1\", \"keyword2\"]\n    }\n  ]\n}\n```\n\n## Required Fields\n\n### Marketplace Level\n\n- **name**: kebab-case string, unique marketplace identifier\n- **owner**: Object with `name` (required) and optional `email`\n- **plugins**: Array of plugin entries\n\n### Plugin Entry\n\n- **name**: Plugin name (must match `plugin.json`)\n- **source**: Relative path to plugin directory OR git URL\n\n## Optional Fields\n\n### Marketplace Level\n\n- **metadata**: Object with:\n  - **description**: Brief marketplace description\n  - **version**: Marketplace version\n  - **pluginRoot**: Base path for relative plugin sources (allows resolving relative plugin paths)\n\n### Plugin Entry\n\n**Standard metadata fields:**\n\n- **description**: Brief description\n- **version**: SemVer version\n- **author**: String or object with `name`, `email`, `url`\n- **category**: Category string (e.g., \"utilities\", \"productivity\")\n- **tags**: Array of tags for filtering\n- **keywords**: Array of keywords for search\n- **homepage**: Plugin homepage URL\n- **repository**: Plugin repository URL\n- **license**: License identifier (e.g., \"MIT\")\n- **strict**: Boolean (default: true) - Require plugin.json in plugin folder\n\n**Component configuration fields:**\n\n- **commands**: String or array - Custom paths to command files or directories\n- **agents**: String or array - Custom paths to agent files\n- **hooks**: String or object - Custom hooks configuration or path to hooks file\n- **mcpServers**: String or object - MCP server configurations or path to MCP config\n- **lspServers**: String or object - LSP server configurations or path to LSP config\n\n## Source Types\n\n### Local Path (Development)\n\n```json\n{\n  \"source\": \"./plugins/my-plugin\"\n}\n```\n\n### GitHub Repository\n\nObject format (recommended):\n\n```json\n{\n  \"source\": {\n    \"source\": \"github\",\n    \"repo\": \"owner/plugin-repo\"\n  }\n}\n```\n\nWith optional `ref` (branch/tag) and `path` (subdirectory) fields:\n\n```json\n{\n  \"source\": {\n    \"source\": \"github\",\n    \"repo\": \"owner/plugin-repo\",\n    \"ref\": \"v2.0\",\n    \"path\": \"plugins/my-plugin\"\n  }\n}\n```\n\n- **ref**: Optional - Git reference (branch, tag, or commit)\n- **path**: Optional - Subdirectory within the repository\n\n> **Migration note**: If you previously used URL strings with `/tree/` paths (e.g., `https://github.com/user/repo/tree/main/plugins/my-plugin`), migrate to the object format with `ref` and `path` fields.\n\n### Git URL Source\n\nFor non-GitHub git repositories (GitLab, Bitbucket, self-hosted):\n\n```json\n{\n  \"source\": {\n    \"source\": \"url\",\n    \"url\": \"https://gitlab.com/team/plugin.git\"\n  }\n}\n```\n\n## Examples\n\n### Local Dev Marketplace\n\n```json\n{\n  \"name\": \"dev-marketplace\",\n  \"owner\": {\n    \"name\": \"Developer\",\n    \"email\": \"dev@localhost\"\n  },\n  \"metadata\": {\n    \"description\": \"Local development marketplace\",\n    \"version\": \"0.1.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"my-plugin\",\n      \"description\": \"Plugin in development\",\n      \"source\": \"../my-plugin\"\n    }\n  ]\n}\n```\n\n### Team Marketplace\n\n```json\n{\n  \"name\": \"acme-tools\",\n  \"owner\": {\n    \"name\": \"ACME Corp\",\n    \"email\": \"tools@acme.com\"\n  },\n  \"metadata\": {\n    \"description\": \"ACME internal tools for Claude Code\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"code-review\",\n      \"description\": \"ACME code review standards\",\n      \"version\": \"2.1.0\",\n      \"author\": {\n        \"name\": \"DevTools Team\"\n      },\n      \"source\": \"./plugins/code-review\",\n      \"category\": \"development\",\n      \"tags\": [\"code-review\", \"standards\"],\n      \"keywords\": [\"review\", \"quality\", \"standards\"]\n    },\n    {\n      \"name\": \"deploy-tools\",\n      \"description\": \"Deployment automation\",\n      \"version\": \"1.5.0\",\n      \"author\": {\n        \"name\": \"DevOps Team\"\n      },\n      \"source\": \"./plugins/deploy-tools\",\n      \"category\": \"devops\",\n      \"tags\": [\"deployment\", \"automation\"],\n      \"keywords\": [\"deploy\", \"ci\", \"cd\"]\n    }\n  ]\n}\n```\n\n### Advanced Plugin Entry\n\nPlugin entries can override default component locations and provide inline configuration:\n\n```json\n{\n  \"name\": \"enterprise-tools\",\n  \"source\": {\n    \"source\": \"github\",\n    \"repo\": \"company/enterprise-plugin\"\n  },\n  \"description\": \"Enterprise workflow automation tools\",\n  \"version\": \"2.1.0\",\n  \"author\": {\n    \"name\": \"Enterprise Team\",\n    \"email\": \"enterprise@company.com\"\n  },\n  \"homepage\": \"https://docs.company.com/plugins/enterprise-tools\",\n  \"repository\": \"https://github.com/company/enterprise-plugin\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"enterprise\", \"workflow\", \"automation\"],\n  \"category\": \"productivity\",\n  \"commands\": [\n    \"./commands/core/\",\n    \"./commands/enterprise/\",\n    \"./commands/experimental/preview.md\"\n  ],\n  \"agents\": [\n    \"./agents/security-reviewer.md\",\n    \"./agents/compliance-checker.md\"\n  ],\n  \"hooks\": \"./config/hooks.json\",\n  \"mcpServers\": {\n    \"enterprise-db\": {\n      \"command\": \"${CLAUDE_PLUGIN_ROOT}/servers/db-server\",\n      \"args\": [\"--config\", \"${CLAUDE_PLUGIN_ROOT}/config.json\"]\n    }\n  },\n  \"lspServers\": {\n    \"custom-lsp\": {\n      \"command\": \"${CLAUDE_PLUGIN_ROOT}/lsp/server\",\n      \"args\": [\"--config\", \"${CLAUDE_PLUGIN_ROOT}/lsp-config.json\"],\n      \"extensionToLanguage\": {\n        \".py\": \"python\",\n        \".js\": \"javascript\"\n      }\n    }\n  },\n  \"strict\": false\n}\n```\n\n<Note>\n**Schema relationship**: Plugin entries are based on the *plugin manifest schema* (with all fields made optional) plus marketplace-specific fields (`source`, `strict`, `category`, `tags`). This means any field valid in a `plugin.json` file can also be used in a marketplace entry. When `strict: false`, the marketplace entry serves as the complete plugin manifest if no `plugin.json` exists. When `strict: true` (default), marketplace fields supplement the plugin's own manifest file.\n</Note>\n\n<Note>\n**Environment variables**: Use `${CLAUDE_PLUGIN_ROOT}` in hooks, mcpServers, and lspServers configurations. This variable resolves to the plugin's installation directory and ensures paths work correctly regardless of where the plugin is installed.\n</Note>\n\n## Usage\n\n### Add Marketplace (Local)\n\n```bash\n/plugin marketplace add /path/to/marketplace\n```\n\n### Add Marketplace (GitHub)\n\n```bash\n/plugin marketplace add your-org/your-repo\n```\n\n### Install Plugin from Marketplace\n\n```bash\n/plugin install plugin-name@marketplace-name\n```\n\n### Team Auto-Install\n\nIn project `.claude/settings.json`:\n\n```json\n{\n  \"extraKnownMarketplaces\": {\n    \"team-tools\": {\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"your-org/marketplace-repo\"\n      }\n    }\n  },\n  \"enabledPlugins\": {\n    \"plugin-name@team-tools\": true\n  }\n}\n```\n\n## Testing Workflow\n\n1. Create dev marketplace:\n   ```bash\n   mkdir -p dev-marketplace/.claude-plugin\n   # Create marketplace.json pointing to ../your-plugin\n   ```\n\n2. Add to Claude Code:\n   ```bash\n   /plugin marketplace add ./dev-marketplace\n   ```\n\n3. Install plugin:\n   ```bash\n   /plugin install your-plugin@dev-marketplace\n   ```\n\n4. After changes, reinstall:\n   ```bash\n   /plugin uninstall your-plugin@dev-marketplace\n   /plugin install your-plugin@dev-marketplace\n   ```\n\n## Best Practices\n\n- **Use kebab-case** for marketplace and plugin names\n- **Keep descriptions concise** (< 100 chars)\n- **Add meaningful tags** for discoverability\n- **Version consistently** using SemVer\n- **Test locally** before publishing to GitHub\n- **Document plugins** in their README files\n\n## Common Mistakes\n\n‚ùå **Plugin name mismatch**\n```json\n// marketplace.json\n{ \"name\": \"my-plugin\", \"source\": \"./plugins/other-plugin\" }\n\n// plugin.json (in other-plugin/)\n{ \"name\": \"other-plugin\" }  // Names don't match!\n```\n\n‚úÖ **Names must match**\n```json\n// marketplace.json\n{ \"name\": \"my-plugin\", \"source\": \"./plugins/my-plugin\" }\n\n// plugin.json\n{ \"name\": \"my-plugin\" }  // Matches!\n```\n\n‚ùå **Absolute source paths**\n```json\n{\n  \"source\": \"/Users/you/plugins/my-plugin\"\n}\n```\n\n‚úÖ **Relative source paths**\n```json\n{\n  \"source\": \"./plugins/my-plugin\"\n}\n```\n\n## Enterprise Marketplace Restrictions\n\nEnterprises can restrict which plugin marketplaces users can add using the `strictKnownMarketplaces` managed setting. This setting is configured in managed settings and cannot be overridden by users.\n\n### strictKnownMarketplaces Setting\n\n| Value | Behavior |\n|-------|----------|\n| Undefined (default) | No restrictions. Users can add any marketplace |\n| Empty array `[]` | Complete lockdown. Users cannot add new marketplaces |\n| List of sources | Users can only add allowlisted marketplaces |\n\n### Disable All Marketplace Additions\n\n```json\n{\n  \"strictKnownMarketplaces\": []\n}\n```\n\n### Allow Specific Marketplaces Only\n\n```json\n{\n  \"strictKnownMarketplaces\": [\n    {\n      \"source\": \"github\",\n      \"repo\": \"acme-corp/approved-plugins\"\n    },\n    {\n      \"source\": \"github\",\n      \"repo\": \"acme-corp/security-tools\",\n      \"ref\": \"v2.0\"\n    },\n    {\n      \"source\": \"url\",\n      \"url\": \"https://plugins.example.com/marketplace.json\"\n    }\n  ]\n}\n```\n\n**Validation:** Exact matching is required. For GitHub sources, `repo` is required; `ref` or `path` must match if specified. For URLs, the full URL must match exactly.\n\n## Reserved Marketplace Names\n\nThe following marketplace names are reserved for official Anthropic use and cannot be used by third-party marketplaces:\n\n- `claude-code-marketplace`\n- `claude-code-plugins`\n- `claude-plugins-official`\n- `anthropic-marketplace`\n- `anthropic-plugins`\n- `agent-skills`\n- `life-sciences`\n\nNames that impersonate official marketplaces (e.g., `official-claude-plugins`, `anthropic-tools-v2`) are also blocked.\n\n## Validation\n\nUse `/plugin-development:validate` to check marketplace structure.\n",
        "plugins/plugin-development/skills/plugin-authoring/schemas/plugin-manifest.md": "# Plugin Manifest Schema\n\nThe `plugin.json` file in `.claude-plugin/` defines your plugin's metadata and optionally custom component paths.\n\n## Location\n\n`.claude-plugin/plugin.json` (at plugin root)\n\n## Required Fields\n\n```json\n{\n  \"name\": \"plugin-name\"\n}\n```\n\n- **name**: kebab-case string, unique identifier (REQUIRED)\n\n## Optional Fields\n\n### Standard Metadata\n\n```json\n{\n  \"version\": \"1.0.0\",\n  \"description\": \"What your plugin does\",\n  \"author\": {\n    \"name\": \"Your Name\",\n    \"email\": \"you@example.com\",\n    \"url\": \"https://github.com/your-username\"\n  },\n  \"homepage\": \"https://your-plugin-homepage.com\",\n  \"repository\": \"https://github.com/your-org/your-repo\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"tag1\", \"tag2\"]\n}\n```\n\n- **version**: Semantic version format (optional metadata)\n- **description**: Brief explanation of plugin purpose (optional metadata)\n- **author**: Can be string or object with name, email, url\n- **homepage**: Documentation URL (optional metadata)\n- **repository**: Source code URL (optional metadata)\n- **license**: License identifier like \"MIT\" (optional metadata)\n- **keywords**: Array of tags for discovery (optional metadata)\n\n### Component Configuration (Custom Paths Only)\n\n**IMPORTANT**: Only include these fields if you're using **non-standard** paths. If using standard directory structure (`commands/`, `agents/`, `skills/`, `hooks/`), omit these fields entirely.\n\n```json\n{\n  \"commands\": [\"./custom/path/cmd1.md\", \"./custom/path/cmd2.md\"],\n  \"agents\": \"./custom/agents/\",\n  \"hooks\": \"./custom/hooks/hooks.json\",\n  \"mcpServers\": {\n    \"server-name\": {\n      \"command\": \"node\",\n      \"args\": [\"path/to/server.js\"]\n    }\n  },\n  \"lspServers\": \"./.lsp.json\",\n  \"outputStyles\": \"./styles/\"\n}\n```\n\n### Component Path Rules\n\n| Field | Type | Description | Example |\n|-------|------|-------------|---------|\n| `commands` | string\\|array | Additional command files/directories | `\"./custom/cmd.md\"` or `[\"./cmd1.md\"]` |\n| `agents` | string\\|array | Additional agent files/directories | `\"./custom/agents/\"` or `[\"./agents/reviewer.md\"]` |\n| `skills` | string\\|array | Additional skill directories | `\"./custom/skills/\"` |\n| `hooks` | string\\|object | Hook config path or inline config | `\"./hooks.json\"` |\n| `mcpServers` | string\\|object | MCP config path or inline config | `\"./mcp-config.json\"` |\n| `outputStyles` | string\\|array | Additional output style files/directories | `\"./styles/\"` or `[\"./style1.md\"]` |\n| `lspServers` | string\\|object | LSP config path or inline config | `\"./.lsp.json\"` |\n\nAll paths must be **relative to plugin root** (where `.claude-plugin/` lives) and start with `./`\n\n**Note**: Custom paths supplement default directories - they don't replace them. If `commands/` exists, it's loaded in addition to custom command paths.\n\n### Skills Configuration\n\nFor Skills (Agent Skills) provided by your plugin, you can restrict which tools Claude can use:\n\n```json\n{\n  \"name\": \"my-skill-plugin\",\n  \"skills\": [\n    {\n      \"name\": \"safe-reader\",\n      \"allowed-tools\": [\"Read\", \"Grep\", \"Glob\"]\n    }\n  ]\n}\n```\n\nHowever, the recommended approach is to specify `allowed-tools` directly in the `SKILL.md` frontmatter:\n\n```yaml\n---\nname: safe-reader\ndescription: Read files without making changes\nallowed-tools: Read, Grep, Glob\n---\n```\n\n### Environment Variables\n\n**`${CLAUDE_PLUGIN_ROOT}`** is a special environment variable available in your plugin that contains the absolute path to your plugin directory. Use this in hooks, MCP servers, and scripts to ensure correct paths regardless of installation location.\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"hooks\": \"./hooks/hooks.json\"\n}\n```\n\nWhere `hooks/hooks.json` contains:\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format-code.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\nOr inline hooks:\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\nUse `${CLAUDE_PLUGIN_ROOT}` for:\n- Scripts executed by hooks\n- MCP server paths\n- Config files referenced by components\n- Any file paths in your plugin configuration\n\n### Hook Types\n\nHooks support three execution types:\n\n| Type | Description | Use Case |\n|------|-------------|----------|\n| `command` | Execute shell commands/scripts | Run linters, formatters, validation scripts |\n| `prompt` | Evaluate prompt with LLM (uses `$ARGUMENTS`) | Context-aware decisions, natural language checks |\n| `agent` | Run agentic verifier with tools | Complex verification requiring tool access |\n\n**Command Hook Example**:\n```json\n{\n  \"type\": \"command\",\n  \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/lint.sh\",\n  \"timeout\": 30\n}\n```\n\n**Prompt Hook Example** (for Stop, SubagentStop, UserPromptSubmit, PreToolUse, PermissionRequest):\n```json\n{\n  \"type\": \"prompt\",\n  \"prompt\": \"Evaluate if Claude should stop: $ARGUMENTS. Check if all tasks are complete.\",\n  \"timeout\": 30\n}\n```\n\n### Hook Events\n\nClaude Code supports the following hook events:\n\n| Event | Description |\n|-------|-------------|\n| `PreToolUse` | Runs after Claude creates tool parameters, before processing the tool call |\n| `PostToolUse` | Runs immediately after a tool completes successfully |\n| `PermissionRequest` | Runs when a permission dialog is shown to the user |\n| `UserPromptSubmit` | Runs when the user submits a prompt, before Claude processes it |\n| `Notification` | Runs when Claude Code sends notifications |\n| `Stop` | Runs when the main Claude Code agent finishes responding |\n| `SubagentStop` | Runs when a Claude Code subagent (Task tool call) finishes responding |\n| `SessionStart` | Runs when Claude Code starts or resumes a session |\n| `SessionEnd` | Runs when a Claude Code session ends |\n| `PreCompact` | Runs before a compact operation |\n\n### Hook Matchers\n\nFor `PreToolUse`, `PermissionRequest`, and `PostToolUse` events, use matchers to target specific tools:\n\n| Pattern | Behavior |\n|---------|----------|\n| `Write` | Exact match (case-sensitive) |\n| `Edit\\|Write` | Regex alternation |\n| `Notebook.*` | Regex patterns |\n| `*` or `\"\"` | Match all tools |\n| `mcp__memory__.*` | Match MCP tools |\n\n### LSP Server Configuration\n\nConfigure Language Server Protocol servers for code intelligence:\n\n**File Configuration** (`.lsp.json` at plugin root):\n```json\n{\n  \"lspServers\": \"./.lsp.json\"\n}\n```\n\n**Inline Configuration**:\n```json\n{\n  \"lspServers\": {\n    \"go\": {\n      \"command\": \"gopls\",\n      \"args\": [\"serve\"],\n      \"extensionToLanguage\": {\n        \".go\": \"go\"\n      }\n    },\n    \"python\": {\n      \"command\": \"pyright-langserver\",\n      \"args\": [\"--stdio\"],\n      \"extensionToLanguage\": {\n        \".py\": \"python\",\n        \".pyi\": \"python\"\n      }\n    }\n  }\n}\n```\n\n**LSP Configuration Fields**:\n- **command**: The language server binary name\n- **args**: Arguments to pass to the server\n- **extensionToLanguage**: Maps file extensions to language identifiers\n\n**Note**: Users must have the language server binary installed on their machine.\n\n## Examples\n\n### Standard Directory Structure (Recommended)\n\n```json\n{\n  \"name\": \"my-dev-tools\"\n}\n```\n\n**Minimal plugin** - The simplest possible plugin. Claude Code automatically discovers `commands/`, `agents/`, `skills/`, and `hooks/` directories.\n\n```json\n{\n  \"name\": \"my-dev-tools\",\n  \"version\": \"1.2.0\",\n  \"description\": \"Developer productivity tools for Claude Code\",\n  \"author\": {\n    \"name\": \"Dev Team\",\n    \"email\": \"dev@company.com\"\n  },\n  \"license\": \"MIT\",\n  \"keywords\": [\"productivity\", \"tools\"]\n}\n```\n\n**With metadata** - Adding optional metadata for better discovery and documentation.\n\n### Custom Paths\n\n```json\n{\n  \"name\": \"enterprise-plugin\",\n  \"description\": \"Enterprise development tools\",\n  \"author\": {\n    \"name\": \"Your Name\"\n  },\n  \"commands\": [\n    \"./specialized/deploy.md\",\n    \"./utilities/batch-process.md\"\n  ],\n  \"agents\": [\n    \"./custom-agents/reviewer.md\",\n    \"./custom-agents/tester.md\"\n  ]\n}\n```\n\n**Note**: Using custom paths to organize components. The `description` and `author` fields are optional metadata.\n\n## Common Mistakes\n\n**Wrong**: Including component fields with standard paths\n```json\n{\n  \"name\": \"my-plugin\",\n  \"commands\": \"./commands/\",\n  \"agents\": \"./agents/\"\n}\n```\n\n**Correct**: Omit component fields for standard paths\n```json\n{\n  \"name\": \"my-plugin\"\n}\n```\n\n**Wrong**: Absolute paths\n```json\n{\n  \"commands\": \"/Users/you/plugins/my-plugin/commands/\"\n}\n```\n\n**Correct**: Relative paths starting with `./`\n```json\n{\n  \"commands\": [\"./custom/cmd.md\"]\n}\n```\n\n**Wrong**: Placing component directories inside `.claude-plugin/`\n```\nmy-plugin/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îú‚îÄ‚îÄ plugin.json\n‚îÇ   ‚îú‚îÄ‚îÄ commands/       # Wrong location!\n‚îÇ   ‚îî‚îÄ‚îÄ agents/         # Wrong location!\n```\n\n**Correct**: Component directories at plugin root\n```\nmy-plugin/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json     # Only plugin.json goes here\n‚îú‚îÄ‚îÄ commands/           # At plugin root\n‚îú‚îÄ‚îÄ agents/             # At plugin root\n‚îî‚îÄ‚îÄ skills/             # At plugin root\n```\n\n## Agents Path Formats\n\nBoth directory paths and file arrays are valid for agents:\n\n**Directory Path**:\n```json\n{\n  \"agents\": \"./custom/agents/\"\n}\n```\n\n**Array of Files**:\n```json\n{\n  \"agents\": [\"./agents/reviewer.md\", \"./agents/tester.md\"]\n}\n```\n\n**Mixed (using default + custom)**:\n```json\n{\n  \"agents\": \"./specialized-agents/\"\n}\n```\nThis loads both the default `agents/` directory AND `./specialized-agents/`.\n\n## Validation\n\nUse `/plugin-development:validate` to check your manifest structure.\n",
        "plugins/plugin-development/skills/plugin-authoring/templates/agent-template.md": "---\nname: agent-name\ndescription: What this agent specializes in and when to invoke it (third person). Include \"PROACTIVELY\" for auto-delegation.\ntools: Read, Grep, Glob, Bash\nmodel: sonnet\npermissionMode: default\nskills: skill1, skill2\n---\n\n<!--\nDocs: https://docs.anthropic.com/en/docs/claude-code/sub-agents\nNOTE: 'capabilities' is deprecated - use 'tools' instead.\n      Agents use short model names (sonnet/opus/haiku/inherit), not full IDs.\n-->\n\n# Agent Name\n\n[Brief introduction to the agent's purpose and specialization]\n\n## What This Agent Does\n\n[Detailed description of the agent's responsibilities]\n\n## Capabilities\n\n1. **Capability 1**: [Description]\n2. **Capability 2**: [Description]\n3. **Capability 3**: [Description]\n\n## When to Use This Agent\n\nInvoke this agent when:\n- [Scenario 1]\n- [Scenario 2]\n- [Scenario 3]\n\n## How It Proceeds\n\n[Step-by-step workflow the agent follows]\n\n1. **Analyze**: [What it reads/examines]\n2. **Evaluate**: [How it assesses the situation]\n3. **Report**: [What it returns to the main conversation]\n\n## Output Format\n\n[What kind of report or recommendations the agent provides]\n\nExample:\n- Critical issues (must fix)\n- Warnings (should fix)\n- Suggestions (nice to have)\n- Summary of findings\n\n## Tool Access\n\n[What tools this agent has access to and why]\n\n## Notes\n\n[Any limitations, constraints, or important considerations]\n",
        "plugins/plugin-development/skills/plugin-authoring/templates/command-template.md": "---\ndescription: Brief, third-person description of what this command does\nargument-hint: [arg1] [arg2]\n---\n\n# Command Name\n\n[Detailed instructions for Claude on how to execute this command]\n\n## Context\n\n[When and why to use this command]\n\n## Instructions\n\n1. [Step 1: What to do first]\n2. [Step 2: Next action]\n3. [Step 3: Final step]\n\n## Arguments\n\n- `$ARGUMENTS` or `$1`, `$2`, etc.: [Explain what each argument means]\n\n## Example Usage\n\n**Command**: `/namespace:command-name arg1 arg2`\n\n**Expected behavior**: [Describe what should happen]\n\n## Notes\n\n[Any additional context, warnings, or tips]\n",
        "plugins/plugin-development/skills/plugin-authoring/templates/skill-template.md": "---\nname: skill-name\ndescription: What the Skill does and WHEN to use it (third person). Be specific about triggers. Cannot contain XML tags.\n# model: claude-sonnet-4-20250514  # Optional: Specify model to use (defaults to conversation's model)\n# allowed-tools: Read, Grep, Glob  # Optional: Tools listed don't require permission when Skill is active\n---\n\n<!--\nSKILL.md Frontmatter Reference:\n- name: (required) lowercase letters, numbers, hyphens only. Max 64 chars. Must match directory name.\n        Cannot contain reserved words 'anthropic' or 'claude'. Cannot contain XML tags.\n- description: (required) Max 1024 chars. Cannot contain XML tags.\n- model: (optional) e.g., claude-sonnet-4-20250514. Defaults to conversation's model.\n- allowed-tools: (optional) Comma-separated. Tools listed auto-approved when Skill active.\n\nBest Practice: Keep SKILL.md under 500 lines for optimal performance.\n-->\n\n# Skill Name\n\n[Brief introduction to what this Skill provides]\n\n## Purpose\n\n[Explain the Skill's role and capabilities]\n\n## When to Activate\n\n[Describe specific contexts or patterns that should trigger this Skill]\n\nExamples:\n- When the user mentions [specific topic]\n- When files matching [pattern] are present\n- When working with [technology/framework]\n\n## Capabilities\n\n[What this Skill can help with]\n\n1. [Capability 1]\n2. [Capability 2]\n3. [Capability 3]\n\n## Quick Links\n\n[Link to sibling files for progressive disclosure]\n\n- [Reference 1](./reference1.md)\n- [Reference 2](./reference2.md)\n\n## Workflow\n\n[Step-by-step approach this Skill follows]\n\n1. [Analyze/Read relevant files]\n2. [Propose actions]\n3. [Execute via commands or provide guidance]\n\n## Notes\n\n[Any constraints, best practices, or important information]\n",
        "plugins/plugin-development/skills/plugin-authoring/testing-plugin-authoring.md": "# Testing Plugin Authoring Skill\n\n**Purpose**: Validate that plugin-authoring instructions produce working plugins and that guidance is unambiguous.\n\n## When to Use\n\nTest this skill when:\n- Adding new instructions to plugin-authoring\n- Observing agents make repeated mistakes\n- Users report confusion about instructions\n- Updating schemas or templates\n\n## Testing Approach\n\nUnlike discipline-enforcing skills (TDD, verification), plugin-authoring is a **reference skill**. Testing focuses on:\n\n| Focus Area | Question |\n|------------|----------|\n| **Clarity** | Are instructions unambiguous? |\n| **Completeness** | Do instructions cover the happy path? |\n| **Error recovery** | Can agents debug when something goes wrong? |\n| **Discoverability** | Can agents find relevant information quickly? |\n\n## Test Scenarios\n\n### Scenario 1: New Plugin Creation (Happy Path)\n\n```markdown\nTASK: Create a new plugin called \"my-test-plugin\" with:\n- One command: \"greet\" that says hello\n- Validate and test it locally\n\nTRACK:\n- Did agent use /plugin-development:init?\n- Did agent put plugin.json in .claude-plugin/ (not components)?\n- Did agent validate before testing?\n- Did agent create dev marketplace correctly?\n```\n\n**Expected behavior**: Agent follows the \"Creating a New Plugin\" workflow exactly.\n\n### Scenario 2: Common Mistake Recovery\n\n```markdown\nTASK: You created a plugin but /plugin-name:command doesn't appear.\nDebug and fix it.\n\nTRACK:\n- Did agent check plugin.json location first?\n- Did agent check component directories exist at plugin root?\n- Did agent run /plugin-development:validate?\n- Did agent check if commands have .md extension?\n```\n\n**Expected behavior**: Agent follows troubleshooting checklist systematically.\n\n### Scenario 3: Hook Script Configuration\n\n```markdown\nTASK: Add a PostToolUse hook that runs a formatting script after Write/Edit.\n\nTRACK:\n- Did agent use ${CLAUDE_PLUGIN_ROOT} for paths?\n- Did agent make script executable (chmod +x)?\n- Did agent set appropriate timeout?\n- Did agent use correct matcher pattern?\n```\n\n**Expected behavior**: Agent produces working hook with portable paths.\n\n### Scenario 4: Skill Creation\n\n```markdown\nTASK: Add a skill called \"code-quality\" to your plugin that provides\nguidance on code review.\n\nTRACK:\n- Did agent create skills/code-quality/SKILL.md structure?\n- Did agent use kebab-case matching directory name?\n- Did agent include both name and description in frontmatter?\n- Did agent keep SKILL.md under 500 lines?\n```\n\n**Expected behavior**: Agent follows skill template and naming conventions.\n\n### Scenario 5: Marketplace Publishing\n\n```markdown\nTASK: Add your plugin to a marketplace for distribution.\n\nTRACK:\n- Did agent create marketplace.json in .claude-plugin/?\n- Did agent match plugin name between marketplace and plugin.json?\n- Did agent use relative source paths?\n- Did agent test with /plugin marketplace add?\n```\n\n**Expected behavior**: Agent follows marketplace schema correctly.\n\n## Pressure Scenarios\n\nTest under realistic constraints:\n\n### Time Pressure\n```markdown\nTASK: Quick - add a validation hook to block writes to .env files.\nYou have 2 minutes before the meeting.\n\nTRACK:\n- Did agent still use ${CLAUDE_PLUGIN_ROOT}?\n- Did agent still validate?\n- Did shortcuts cause failures?\n```\n\n### Iteration Pressure\n```markdown\nTASK: The hook isn't working. This is the 4th attempt.\nJust make it work somehow.\n\nTRACK:\n- Did agent resort to absolute paths?\n- Did agent skip validation steps?\n- Did agent read error messages carefully?\n```\n\n## Validation Checklist\n\nAfter testing, verify:\n\n```\n‚ñ° Agent found correct information in skill\n‚ñ° Agent followed workflow without confusion\n‚ñ° Resulting plugin validates cleanly\n‚ñ° Agent knew how to debug when stuck\n‚ñ° Agent used provided commands (/plugin-development:*)\n‚ñ° Agent didn't need external documentation\n```\n\n## Common Failure Modes\n\n| Failure | Indicates | Fix |\n|---------|-----------|-----|\n| Agent puts components in .claude-plugin/ | Warning not prominent enough | Strengthen warning, add to red flags |\n| Agent adds commands field with standard path | Anti-pattern not visible | Add to main SKILL.md anti-patterns |\n| Agent uses relative paths in hooks | ${CLAUDE_PLUGIN_ROOT} instruction unclear | Add explicit example, add consequence |\n| Agent skips validation | Validation not framed as required | Add authority language, consequences |\n| Agent uses wrong skill name format | Naming rules buried | Surface rules earlier in workflow |\n| Agent creates deeply nested skill refs | Progressive disclosure not explained | Add warning about nesting depth |\n\n## Iteration Process\n\n1. **Run scenario** without skill loaded ‚Üí Document baseline behavior\n2. **Run scenario** with skill loaded ‚Üí Compare to baseline\n3. **Identify gaps** ‚Üí Where did instructions fail?\n4. **Update skill** ‚Üí Add clarifications, examples, warnings\n5. **Re-test** ‚Üí Verify improvement\n6. **Capture rationalizations** ‚Üí Add to Common Mistakes if agent found workaround\n\n## Meta-Testing\n\nAfter an agent makes a mistake despite having the skill:\n\n```markdown\nYou read the plugin-authoring skill and still [made mistake X].\n\nHow could that skill have been written differently to make it\ncrystal clear that [correct approach] was required?\n```\n\n**Three possible responses:**\n\n1. **\"The skill WAS clear, I chose to ignore it\"**\n   - Need stronger authority language\n   - Add to Red Flags section\n\n2. **\"The skill should have said X\"**\n   - Documentation gap\n   - Add their suggestion\n\n3. **\"I didn't see section Y\"**\n   - Organization problem\n   - Make key points more prominent\n\n## Success Criteria\n\n**Skill is effective when:**\n- Agent creates valid plugin on first attempt\n- Agent finds troubleshooting info without external help\n- Agent uses provided commands and workflows\n- Agent doesn't rationalize shortcuts under pressure\n\n**Skill needs work when:**\n- Agent makes mistakes the skill should prevent\n- Agent asks questions answered in the skill\n- Agent uses patterns explicitly marked as anti-patterns\n- Agent skips validation despite warnings\n"
      },
      "plugins": [
        {
          "name": "flutter-tools",
          "description": "Comprehensive Flutter/Dart code quality tools including intelligent code review and automated formatting",
          "version": "2.2.0",
          "author": {
            "name": "Lucas Xu"
          },
          "source": "./plugins/flutter-tools",
          "category": "developer-tools",
          "tags": [
            "flutter",
            "dart",
            "code-review",
            "formatting",
            "quality"
          ],
          "categories": [
            "code-review",
            "dart",
            "developer-tools",
            "flutter",
            "formatting",
            "quality"
          ],
          "install_commands": [
            "/plugin marketplace add LucasXu0/claude-code-plugin",
            "/plugin install flutter-tools@LucasXu0-flutter-tools"
          ]
        },
        {
          "name": "plugin-development",
          "description": "Assist with Claude Code plugin development: scaffold, validate, review, and team-ready distribution",
          "version": "1.3.0",
          "author": {
            "name": "Ivan Magda"
          },
          "source": "./plugins/plugin-development",
          "category": "developer-tools",
          "tags": [
            "development",
            "plugins",
            "scaffold",
            "validation",
            "tools"
          ],
          "categories": [
            "developer-tools",
            "development",
            "plugins",
            "scaffold",
            "tools",
            "validation"
          ],
          "install_commands": [
            "/plugin marketplace add LucasXu0/claude-code-plugin",
            "/plugin install plugin-development@LucasXu0-flutter-tools"
          ]
        }
      ]
    }
  ]
}