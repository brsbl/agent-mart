{
  "author": {
    "id": "cstelmach",
    "display_name": "Christian Stelmach",
    "avatar_url": "https://avatars.githubusercontent.com/u/9914783?u=beafa6f2c115ff14425455d380891e6d2459e3d6&v=4"
  },
  "marketplaces": [
    {
      "name": "terminal-agent-visual-signals",
      "version": null,
      "description": "Visual terminal state indicators for Claude Code sessions",
      "repo_full_name": "cstelmach/terminal-agent-visual-signals",
      "repo_url": "https://github.com/cstelmach/terminal-agent-visual-signals",
      "repo_description": "Visual terminal indicators for Claude Code sessions in Ghostty",
      "signals": {
        "stars": 1,
        "forks": 0,
        "pushed_at": "2026-02-12T20:28:46Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"$schema\": \"https://anthropic.com/claude-code/marketplace.schema.json\",\n  \"name\": \"terminal-agent-visual-signals\",\n  \"owner\": {\n    \"name\": \"cstelmach\",\n    \"email\": \"chrisp.stel@gmail.com\"\n  },\n  \"metadata\": {\n    \"description\": \"Visual terminal state indicators for Claude Code sessions\",\n    \"version\": \"2.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"tavs\",\n      \"description\": \"Changes terminal background color and tab title based on Claude Code state (processing, permission, idle, complete, compacting, subagent, tool_error)\",\n      \"version\": \"2.0.0\",\n      \"source\": \"./\",\n      \"category\": \"productivity\",\n      \"keywords\": [\"hooks\", \"terminal\", \"visual\", \"ghostty\", \"notifications\", \"osc\", \"background-color\", \"catppuccin\"]\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"tavs\",\n  \"description\": \"Visual terminal state indicators for Claude Code sessions using OSC escape sequences. Changes background color and tab title based on Claude's state (processing, permission, idle, complete, compacting, subagent, tool_error).\",\n  \"version\": \"2.0.0\",\n  \"author\": {\n    \"name\": \"cstelmach\"\n  },\n  \"homepage\": \"https://github.com/cstelmach/terminal-agent-visual-signals\",\n  \"repository\": \"https://github.com/cstelmach/terminal-agent-visual-signals\",\n  \"license\": \"MIT\",\n  \"keywords\": [\n    \"hooks\",\n    \"terminal\",\n    \"visual\",\n    \"ghostty\",\n    \"notifications\",\n    \"osc\",\n    \"background-color\",\n    \"catppuccin\"\n  ]\n}\n",
        "README.md": "# TAVS - Terminal Agent Visual Signals\n\n> Visual terminal state indicators for Claude Code sessions using OSC escape sequences\n\n<!-- TODO: Add GIF demos after recording -->\n<!-- GIF 1: All States (terminals showing all colors) -->\n<!-- GIF 2: Graduated Idle Timer (purple fading through stages) -->\n<!-- GIF 3: Practical Usage (processing ‚Üí permission ‚Üí complete flow) -->\n\n## Why?\n\nWhen running multiple Claude Code sessions (12+ terminals side by side), you need to quickly identify which ones need attention. This hook system provides instant visual feedback through background colors, emoji indicators, and optional audible bells.\n\n| State | Color | Emoji | Meaning |\n|-------|-------|-------|---------|\n| Permission | üî¥ Red | üî¥ | **Needs attention** ‚Äî Approval required |\n| Processing | üü† Orange | üü† | **Working** ‚Äî Claude is processing |\n| Idle | üü£ Purple | üü£‚Üíüïê | **Idle** ‚Äî Graduated fade over time |\n| Complete | üü¢ Green | üü¢ | **Done** ‚Äî Task completed |\n| Compacting | üîµ Teal | üîÑ | **Compacting** ‚Äî Context being compressed |\n\n## Features\n\n- **Background color changes** based on Claude Code state\n- **Tab title prefixes** with emoji indicators\n- **Graduated idle timer** ‚Äî Progressive color fade with stage indicators\n- **Audible bells** ‚Äî Optional per-state audio notifications\n- **Multi-session support** ‚Äî Works across concurrent Claude Code sessions\n- **State priority system** ‚Äî Higher priority states (permission) protected from override\n- **Optimized performance** ‚Äî Uses bash builtins, minimal subprocess spawning\n- **Configurable** ‚Äî Enable/disable states, customize colors, adjust timing\n\n## Compatible Terminals\n\nThis script uses standard OSC escape sequences supported by many modern terminals:\n\n| Terminal | Background | Reset | Title | Status |\n|----------|-----------|-------|-------|--------|\n| **Ghostty** | ‚úÖ | ‚úÖ | ‚úÖ | **Recommended** |\n| Kitty | ‚úÖ | ‚úÖ | ‚úÖ | Supported |\n| WezTerm | ‚úÖ | ‚úÖ | ‚úÖ | Supported |\n| iTerm2 | ‚úÖ | ‚úÖ | ‚úÖ | Tested |\n| VS Code / Cursor | ‚úÖ | ‚úÖ | ‚úÖ | Tested |\n| GNOME Terminal | ‚úÖ | ‚úÖ | ‚úÖ | Supported |\n| Windows Terminal | ‚úÖ | ‚úÖ | ‚úÖ | 2025+ |\n| Foot | ‚úÖ | ‚úÖ | ‚úÖ | Supported |\n| Alacritty | ‚ö†Ô∏è | ‚ö†Ô∏è | ‚úÖ | Untested |\n| macOS Terminal.app | ‚ùå | ‚ùå | ‚úÖ | No OSC 11 |\n\n### Why Ghostty?\n\n[Ghostty](https://ghostty.org/) is recommended for Claude Code sessions because:\n\n- **Excellent performance** ‚Äî GPU-accelerated rendering handles rapid output smoothly\n- **No flickering** ‚Äî Unlike many terminals, Ghostty rarely exhibits the \"flickering bug\" that can occur with Claude Code's rapid screen updates\n- **Full OSC support** ‚Äî Native support for OSC 11/111 background color changes\n\n**Test your terminal:**\n```bash\n./test-terminal.sh\n```\n\n## Quick Start\n\n### Option 1: Plugin Install (Recommended)\n\nInstall as a Claude Code plugin in two steps:\n\n**Step 1:** Add the marketplace (one-time setup)\n```bash\nclaude plugin marketplace add cstelmach/terminal-agent-visual-signals\n```\n\n**Step 2:** Install the plugin\n```bash\nclaude plugin install tavs@terminal-agent-visual-signals\n```\n\nThen enable the plugin via `/plugin` in Claude Code and restart.\n\n> **Note:** Bug #14410 (plugin hooks not executing) was fixed in Claude Code v2.1.9. If you're on an older version, see [Workaround for Bug #14410](#workaround-for-bug-14410) below.\n\n### Option 2: Manual Install\n\nIf you prefer manual setup or need to customize hooks:\n\n**1. Clone the repository:**\n\n```bash\ngit clone https://github.com/cstelmach/terminal-agent-visual-signals.git ~/.claude/hooks/terminal-agent-visual-signals\n```\n\n**2. Make executable:**\n\n```bash\nchmod +x ~/.claude/hooks/terminal-agent-visual-signals/src/core/trigger.sh\n```\n\n**3. Add hooks to `~/.claude/settings.json`:**\n\nCopy the hook configuration from `hooks/hooks.json` in this repository into your `settings.json`. Replace `${CLAUDE_PLUGIN_ROOT}` with the full path to the cloned repo.\n\n**4. Restart Claude Code**\n\nThe visual signals will activate on your next session.\n\n---\n\n## Quick Disable (Environment Variable)\n\nTemporarily disable visual signals without changing configuration:\n\n```bash\n# Disable for a single session\nTAVS_STATUS=false claude\n\n# Disable for all sessions in current terminal\nexport TAVS_STATUS=false\n\n# Re-enable\nunset TAVS_STATUS\n# or\nexport TAVS_STATUS=true\n```\n\nRecognized disabled values (case-insensitive): `false`, `0`, `off`, `no`, `disabled`\n\nUseful for presentations, screen sharing, or when you need a \"quiet\" terminal.\n\n---\n\n## Graduated Idle Timer\n\nWhen Claude enters idle state, the terminal progressively fades through stages instead of showing a static color. This provides a visual sense of how long Claude has been waiting.\n\n```\nStage 0 ‚Üí Stage 1 ‚Üí Stage 2 ‚Üí Stage 3 ‚Üí Stage 4 ‚Üí Stage 5 (reset)\n  üü£        üü£        üü£        üü£        üü£      (clear)\n dark     fading...                              default\npurple                                          background\n```\n\n### Configuration\n\n```bash\n# Enable/disable stage indicators in title (emoji progression)\nENABLE_IDLE_STAGE_INDICATORS=true\n\n# Colors for each stage (final stage = \"reset\" returns to terminal default)\nIDLE_COLORS=(\"#443147\" \"#423148\" \"#3f3248\" \"#3a3348\" \"#373348\" \"reset\")\n\n# Emojis for each stage (can use clock faces for time indication)\nIDLE_STATUS_ICONS=(\"üü£\" \"üü£\" \"üü£\" \"üü£\" \"üü£\" \"\")        # Subtle\n# IDLE_STATUS_ICONS=(\"üïê\" \"üïë\" \"üïí\" \"üïì\" \"üïî\" \"\")      # Clock progression\n\n# Duration per stage (seconds) - total idle time = sum of all durations\nIDLE_STAGE_DURATIONS=(180 180 180 180 180 180)  # 18 minutes total\n\n# How often timer checks for stage transitions\n# Must be <= shortest stage duration for smooth transitions\nIDLE_CHECK_INTERVAL=60  # Check every minute\n```\n\n**Testing configuration:**\n```bash\n# Quick testing (5 seconds per stage, 30 seconds total)\nIDLE_STAGE_DURATIONS=(5 5 5 5 5 5)\nIDLE_CHECK_INTERVAL=2\n```\n\n---\n\n## Bell Configuration\n\nOptional audible notifications for specific states. Useful for getting attention when working on other tasks.\n\n```bash\n# Enable/disable bell per state\nBELL_ON_PROCESSING=false\nBELL_ON_PERMISSION=true     # Alert: Claude needs permission\nBELL_ON_COMPLETE=true       # Alert: Claude finished responding\nBELL_ON_IDLE=false\nBELL_ON_COMPACTING=false\nBELL_ON_RESET=false\n```\n\n**Note:** Bells work best with terminals that support audio notifications. Some terminals may need configuration to enable sound.\n\n---\n\n## Configuration Reference\n\nEdit `~/.tavs/user.conf` (or `src/config/defaults.conf` for defaults) to customize:\n\n### Feature Toggles\n\n```bash\nENABLE_BACKGROUND_CHANGE=true    # Change terminal background color\nENABLE_TITLE_PREFIX=true         # Add emoji prefix to terminal title\n\n# Per-state enable/disable\nENABLE_PROCESSING=true\nENABLE_PERMISSION=true\nENABLE_COMPLETE=true\nENABLE_IDLE=true\nENABLE_COMPACTING=true\n```\n\n### Colors\n\nDefault colors are muted tints designed for the [Catppuccin Frappe](https://github.com/catppuccin/catppuccin) dark theme. They blend subtly with the background while remaining distinguishable:\n\n```bash\nCOLOR_PROCESSING=\"#473D2F\"   # Muted orange\nCOLOR_PERMISSION=\"#4A2021\"   # Muted red\nCOLOR_COMPLETE=\"#473046\"     # Muted purple-green\nCOLOR_IDLE=\"#473046\"         # Muted purple\nCOLOR_COMPACTING=\"#2B4645\"   # Muted teal\n```\n\n> **Tip:** If using a different theme, adjust colors to complement your terminal's background. The goal is subtle tinting, not jarring color changes.\n\n### Status Icons\n\n```bash\nSTATUS_ICON_PROCESSING=\"üü†\"\nSTATUS_ICON_PERMISSION=\"üî¥\"\nSTATUS_ICON_COMPLETE=\"üü¢\"\nSTATUS_ICON_IDLE=\"üü£\"\nSTATUS_ICON_COMPACTING=\"üîÑ\"\n```\n\n### Alternative Color Themes\n\n**Brighter colors (more noticeable):**\n```bash\nCOLOR_PROCESSING=\"#5C4A28\"\nCOLOR_PERMISSION=\"#5C2828\"\nCOLOR_COMPLETE=\"#285C3D\"\nCOLOR_IDLE=\"#4A285C\"\nCOLOR_COMPACTING=\"#28525C\"\n```\n\n**Light theme compatible:**\n```bash\nCOLOR_PROCESSING=\"#FFF3CD\"\nCOLOR_PERMISSION=\"#F8D7DA\"\nCOLOR_COMPLETE=\"#D4EDDA\"\nCOLOR_IDLE=\"#E2D9F3\"\nCOLOR_COMPACTING=\"#D1ECF1\"\n```\n\n---\n\n## Manual Testing\n\n```bash\n# Test each state\n./src/core/trigger.sh processing     # üü† Orange\n./src/core/trigger.sh permission     # üî¥ Red\n./src/core/trigger.sh complete       # üü¢ Green\n./src/core/trigger.sh idle           # üü£ Purple (starts timer)\n./src/core/trigger.sh compacting     # üîÑ Teal\n./src/core/trigger.sh subagent-start # üîÄ Golden-Yellow\n./src/core/trigger.sh tool_error     # ‚ùå Orange-Red\n./src/core/trigger.sh reset          # Default background\n```\n\n---\n\n## How It Works\n\n### OSC Escape Sequences\n\n| Sequence | Purpose |\n|----------|---------|\n| `OSC 11` | Set terminal background color |\n| `OSC 111` | Reset background to default |\n| `OSC 0` | Set window/tab title |\n\nThese are sent directly to the TTY device (`/dev/ttysXXX`) to bypass Claude Code's stdout capture.\n\n### Hook Event Flow\n\n```\nUserPromptSubmit ‚Üí processing (orange)\n    ‚Üì\nClaude working...\n    ‚Üì\nPreToolUse (compact) ‚Üí compacting (teal)\n    ‚Üì\nPermissionRequest ‚Üí permission (red)\n    ‚Üì\nUser approves ‚Üí PostToolUse ‚Üí processing (orange)\n    ‚Üì\nStop ‚Üí complete (green)\n    ‚Üì\n60+ sec idle ‚Üí Notification ‚Üí idle (purple, starts graduated timer)\n    ‚Üì\nStage transitions every N seconds ‚Üí color fades ‚Üí reset\n```\n\n### State Priority System\n\nHigher priority states are protected from being overwritten for a brief period:\n\n| State | Priority | Notes |\n|-------|----------|-------|\n| Permission | 100 | Highest - never overwritten |\n| Idle | 90 | Protected during idle |\n| Compacting | 50 | Medium priority |\n| Processing | 30 | Common state |\n| Complete | 20 | Brief flash |\n| Reset | 10 | Lowest |\n\n### Multi-Session Support\n\nA consolidated state file (`/tmp/claude-visual-signals.state`) tracks all active sessions by their TTY identifier. Each session maintains its own state independently.\n\n---\n\n## Troubleshooting\n\n### Colors not appearing\n\n1. **Test your terminal** ‚Äî Run `./test-terminal.sh` to verify OSC support\n2. **Check the script path** ‚Äî Ensure paths in `settings.json` match your install location\n3. **Test manually** ‚Äî Run `./src/core/trigger.sh processing`\n4. **Check TTY detection** ‚Äî The script needs to find the parent process TTY\n\n### Permission errors\n\n```bash\n# Ensure script is executable\nchmod +x ~/.claude/hooks/terminal-agent-visual-signals/src/core/trigger.sh\n```\n\n### Title not updating\n\n- Some window managers may override OSC 0 titles\n- Try toggling `ENABLE_TITLE_PREFIX` in the script\n\n### Idle timer not progressing\n\n- Ensure `IDLE_CHECK_INTERVAL` is less than or equal to the shortest `IDLE_STAGE_DURATIONS` value\n- For testing, use short durations (5s) with matching check interval (2-5s)\n\n### Hooks not firing\n\n- Ensure `settings.json` is valid JSON (use a JSON validator)\n- Check Claude Code logs for hook errors\n- For fastest response, place these hooks **first** in each hook array\n\n---\n\n## Workaround for Bug #14410\n\nDue to [Claude Code bug #14410](https://github.com/anthropics/claude-code/issues/14410), plugin hooks defined in `hooks/hooks.json` may be matched but never executed. This affects all hook types when installed via the plugin system.\n\n### Symptoms\n\n- Plugin installs successfully\n- Visual signals don't appear\n- No errors in Claude Code logs\n\n### Solution\n\nRun the setup script to create a version-independent symlink and add hooks directly to `settings.json`:\n\n**Step 1:** Run the setup script (after plugin install)\n```bash\n# Find and run the setup script from the plugin cache\nbash ~/.claude/plugins/cache/terminal-agent-visual-signals/tavs/*/setup-hooks-workaround.sh --install\n```\n\nThis creates:\n- A stable symlink at `~/.claude/hooks/tavs-current/`\n- A session-start script that auto-updates the symlink when the plugin version changes\n\n**Step 2:** Copy the hooks output to `~/.claude/settings.json`\n\nThe script prints the exact JSON to add. Merge these hooks with your existing `settings.json` hooks, placing the visual signal hooks **first** in each array for fastest response.\n\n**Step 3:** Restart Claude Code\n\n### How It Works\n\n```\nSessionStart hook runs\n    ‚Üì\nChecks if symlink points to current plugin version\n    ‚Üì\nUpdates symlink if version changed (plugin update)\n    ‚Üì\nCalls reset script\n    ‚Üì\nAll other hooks use the stable symlink path\n```\n\n**Benefits:**\n- **Version-independent** ‚Äî Symlink auto-updates when plugin updates\n- **One-time setup** ‚Äî No manual intervention needed after plugin updates\n- **Easy removal** ‚Äî When bug is fixed, run `--uninstall`\n\n### Removing the Workaround\n\nWhen Claude Code bug #14410 is fixed:\n\n```bash\nbash ~/.claude/plugins/cache/terminal-agent-visual-signals/tavs/*/setup-hooks-workaround.sh --uninstall\n```\n\nThen remove the visual signal hooks from your `settings.json`. The native plugin hooks will take over.\n\n---\n\n## Performance\n\nOptimized using bash builtins to minimize subprocess spawning:\n\n| Operation | Before | After |\n|-----------|--------|-------|\n| Get parent PID | `ps -o ppid=` | `$PPID` built-in |\n| Remove spaces | `\\| tr -d ' '` | `${var// /}` |\n| Count slashes | `echo \\| tr \\| wc \\| tr` | `${cwd//[!\\/]/}` |\n| basename/dirname | External commands | Parameter expansion |\n| Elapsed time | `$(date +%s)` | `$SECONDS` built-in |\n| Function returns | `$(func)` subshell | Global variable |\n\n**Result:** Timer worker spawns ~1-2 external processes per iteration vs ~6-8 previously.\n\n---\n\n## Requirements\n\n- A [compatible terminal](#compatible-terminals) with OSC 11/111 support\n- [Claude Code](https://claude.ai/code) CLI\n- Bash 3.2+ (macOS default works)\n- macOS or Linux\n\n---\n\n## Security\n\nThis script sanitizes `$PWD` before writing to the terminal to prevent [terminal escape sequence injection](https://dgl.cx/2023/09/ansi-terminal-security).\n\n**Threat model:** On Unix, directory names can contain escape bytes (0x1B). A malicious directory name could inject OSC sequences to manipulate clipboard (OSC 52) or spoof UI.\n\n**Mitigation:** The `sanitize_for_terminal()` function strips all ASCII control characters (0x00-0x1F, 0x7F) while preserving Unicode for international path support.\n\n---\n\n## Contributing\n\nIssues and PRs welcome! If you've tested on additional terminals or have alternative color schemes to share, please contribute.\n\n**Ideas for contribution:**\n- Additional color themes\n- Terminal compatibility reports\n- Alternative emoji sets\n- Integration with other AI coding tools\n\n---\n\n## License\n\nMIT ‚Äî see [LICENSE](LICENSE) file\n\n---\n\n## Credits\n\nCreated for the Claude Code community. Share your setups on [r/ClaudeAI](https://reddit.com/r/ClaudeAI)!\n"
      },
      "plugins": [
        {
          "name": "tavs",
          "description": "Changes terminal background color and tab title based on Claude Code state (processing, permission, idle, complete, compacting, subagent, tool_error)",
          "version": "2.0.0",
          "source": "./",
          "category": "productivity",
          "keywords": [
            "hooks",
            "terminal",
            "visual",
            "ghostty",
            "notifications",
            "osc",
            "background-color",
            "catppuccin"
          ],
          "categories": [
            "background-color",
            "catppuccin",
            "ghostty",
            "hooks",
            "notifications",
            "osc",
            "productivity",
            "terminal",
            "visual"
          ],
          "install_commands": [
            "/plugin marketplace add cstelmach/terminal-agent-visual-signals",
            "/plugin install tavs@terminal-agent-visual-signals"
          ]
        }
      ]
    }
  ]
}