{
  "author": {
    "id": "raine",
    "display_name": "Raine Virta",
    "avatar_url": "https://avatars.githubusercontent.com/u/11027?u=d9e8e59b86147f5d1cbd789b105a43f2cda1f298&v=4"
  },
  "marketplaces": [
    {
      "name": "git-surgeon",
      "version": null,
      "description": "Surgical, non-interactive git hunk control for AI agents",
      "repo_full_name": "raine/git-surgeon",
      "repo_url": "https://github.com/raine/git-surgeon",
      "repo_description": "Git primitives for autonomous coding agents",
      "signals": {
        "stars": 6,
        "forks": 0,
        "pushed_at": "2026-01-31T13:23:39Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"git-surgeon\",\n  \"owner\": {\n    \"name\": \"Raine Virta\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"git-surgeon\",\n      \"source\": \"./\",\n      \"description\": \"Surgical, non-interactive git hunk control for AI agents\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"git-surgeon\",\n  \"description\": \"Surgical, non-interactive git hunk control for AI agents\",\n  \"version\": \"0.1.0\",\n  \"author\": {\n    \"name\": \"Raine Virta\"\n  },\n  \"repository\": \"https://github.com/raine/git-surgeon\",\n  \"license\": \"MIT\"\n}\n",
        "README.md": "# git-surgeon\n\n`git-surgeon` gives AI agents surgical control over git changes without\ninteractive prompts. Stage, unstage, or discard individual hunks. Commit hunks\ndirectly with line-range precision. Restructure history by splitting commits or\nfolding fixes into earlier ones.\n\n## Why?\n\nAI agents can't use interactive git commands like `git add -p`. When asked to\ncommit changes separately, they resort to destructive workarounds:\n\n```\n❯ commit the changes separately\n\n⏺ Bash(git diff internal/bot/listing_handler.go)\n  ⎿  diff --git i/internal/bot/listing_handler.go ...\n     ... +83 lines\n\n⏺ Let me reset and make the changes in two separate commits.\n\n⏺ Bash(git checkout internal/bot/listing_handler.go)   ← about to destroy changes\n  ⎿  Interrupted\n```\n\nWith git-surgeon, the agent can inspect hunks and commit them selectively:\n\n```\n❯ commit the changes separately\n\n⏺ I'll commit these as separate changes using git-surgeon.\n\n⏺ Skill(git-surgeon)\n  ⎿  Successfully loaded skill\n\n⏺ Bash(git-surgeon hunks)\n  ⎿  ac34353 internal/bot/listing_handler.go (+6 -3)\n     15baf94 internal/bot/listing_handler.go (+10 -2)\n     ...\n\n⏺ Bash(git-surgeon commit ac34353 15baf94 7c6ef9e -m \"allow edit commands during attribute input\")\n\n⏺ Bash(git-surgeon commit 4eefac8 bbba931 -m \"add logging for attribute prompts\")\n```\n\n**Highlights**\n\n- Stage specific lines from a hunk, not just whole hunks\n  ([example](#example-splitting-a-hunk-across-commits))\n- Split commits that mix concerns into focused commits\n  ([example](#example-splitting-a-commit-that-mixes-concerns))\n\n## Quick start\n\n### 1. Install\n\n```bash\n# Shell\ncurl -fsSL https://raw.githubusercontent.com/raine/git-surgeon/main/scripts/install.sh | bash\n\n# Cargo\ncargo install git-surgeon\n\n# Homebrew\nbrew install raine/git-surgeon/git-surgeon\n```\n\n### 2. Install the AI assistant skill\n\n```bash\n# Claude Code\ngit-surgeon install-skill --claude\n\n# OpenCode\ngit-surgeon install-skill --opencode\n\n# Codex\ngit-surgeon install-skill --codex\n```\n\nAlternatively, for Claude Code via the plugin marketplace:\n\n```bash\nclaude plugin marketplace add raine/git-surgeon\nclaude plugin install git-surgeon@git-surgeon\n```\n\n### 3. Use it\n\nAsk Claude Code to make granular commits. It will use git-surgeon automatically\nto stage individual hunks instead of entire files.\n\n## Commands\n\n- [`hunks`](#hunks) — List hunks in the diff\n- [`show`](#show) — Show full diff for a specific hunk\n- [`stage`](#stage) — Stage hunks by ID\n- [`commit`](#commit) — Stage hunks and commit in one step\n- [`unstage`](#unstage) — Unstage hunks by ID\n- [`discard`](#discard) — Discard working tree changes for hunks\n- [`fixup`](#fixup) — Fold staged changes into an earlier commit\n- [`reword`](#reword) — Change the commit message of an existing commit\n- [`squash`](#squash) — Squash multiple commits into one\n- [`undo`](#undo) — Reverse-apply hunks from a commit\n- [`split`](#split) — Split a commit into multiple commits by hunk selection\n\n---\n\n### `hunks`\n\nLists all hunks with their IDs, file paths, function context, change counts, and\na preview of changed lines.\n\n```bash\n# List unstaged hunks\ngit-surgeon hunks\n\n# List staged hunks\ngit-surgeon hunks --staged\n\n# Filter to a specific file\ngit-surgeon hunks --file src/main.rs\n\n# List hunks from a specific commit\ngit-surgeon hunks --commit HEAD\ngit-surgeon hunks --commit abc1234\n\n# Show full diff with line numbers (useful for small commits)\ngit-surgeon hunks --commit abc1234 --full\n```\n\n#### Example output\n\n```\na1b2c3d src/main.rs fn handle_request (+3 -1)\n  -    let result = process(input);\n  +    let result = match process(input) {\n  +        Ok(v) => v,\n  +        Err(e) => return Err(e),\n  +    };\n\ne4f5678 src/lib.rs (+1 -0)\n  +use std::collections::HashMap;\n```\n\nEach line shows: `<hunk-id> <file> [function context] (+additions -deletions)`\n\n---\n\n### `show`\n\nShows the full diff (header + all lines) for a single hunk. Each line is\nprefixed with a 1-based line number for use with `--lines`.\n\n```bash\ngit-surgeon show a1b2c3d\n\n# Show a hunk from a specific commit\ngit-surgeon show a1b2c3d --commit HEAD\n```\n\n#### Example output\n\n```\n@@ -1,4 +1,6 @@ fn main\n1: context\n2:-deleted line\n3:+added line\n4: context\n```\n\nSearches both unstaged and staged diffs when no `--commit` is specified.\n\n---\n\n### `stage`\n\nStages one or more hunks by ID. Equivalent to selectively answering \"y\" in\n`git add -p`.\n\n```bash\ngit-surgeon stage a1b2c3d\ngit-surgeon stage a1b2c3d e4f5678\n\n# Stage only lines 5-30 of a hunk\ngit-surgeon stage a1b2c3d --lines 5-30\n```\n\n---\n\n### `commit`\n\nStages hunks and commits them in a single step. Equivalent to running `stage`\nfollowed by `git commit`. If the commit fails, the hunks are unstaged to restore\nthe original state. Refuses to run if the index already contains staged changes.\n\n```bash\ngit-surgeon commit a1b2c3d e4f5678 -m \"add pagination\"\n\n# With inline line ranges\ngit-surgeon commit a1b2c3d:1-11 e4f5678 -m \"add pagination\"\n```\n\n---\n\n### `unstage`\n\nUnstages one or more previously staged hunks, moving them back to the working\ntree.\n\n```bash\ngit-surgeon unstage a1b2c3d\ngit-surgeon unstage a1b2c3d e4f5678\n\n# Unstage only lines 5-30 of a hunk\ngit-surgeon unstage a1b2c3d --lines 5-30\n```\n\n---\n\n### `discard`\n\nDiscards working tree changes for specific hunks. This reverse-applies the\nhunks, effectively running `git checkout -p` non-interactively.\n\n```bash\ngit-surgeon discard a1b2c3d\n\n# Discard only lines 5-30 of a hunk\ngit-surgeon discard a1b2c3d --lines 5-30\n```\n\n**Warning:** This permanently removes uncommitted changes for the specified\nhunks.\n\n---\n\n### `fixup`\n\nFolds currently staged changes into an earlier commit. Uses `git commit --amend`\nfor HEAD, or an autosquash rebase for older commits. Unstaged changes are\npreserved via `--autostash`.\n\n```bash\n# Stage some hunks, then fixup an earlier commit\ngit-surgeon stage a1b2c3d\ngit-surgeon fixup abc1234\n\n# Fixup HEAD (equivalent to git commit --amend --no-edit)\ngit-surgeon fixup HEAD\n```\n\nIf the rebase hits a conflict, the repo is left in the conflict state for manual\nresolution (`git rebase --continue` or `git rebase --abort`).\n\n---\n\n### `reword`\n\nChanges the commit message of an existing commit without modifying its content.\nUses `git commit --amend` for HEAD, or an autosquash rebase for older commits.\n\n```bash\n# With subject + body\ngit-surgeon reword HEAD -m \"subject\" -m \"body paragraph\"\n\n# Change an earlier commit's message\ngit-surgeon reword abc1234 -m \"corrected message\"\n```\n\nIf the rebase hits a conflict, the repo is left in the conflict state for manual\nresolution (`git rebase --continue` or `git rebase --abort`).\n\n---\n\n### `squash`\n\nCombines commits from `<commit>` through HEAD into a single commit.\n\n```bash\n# Squash last 2 commits\ngit-surgeon squash HEAD~1 -m \"combined feature\"\n\n# Squash last 3 commits with subject + body\ngit-surgeon squash HEAD~2 -m \"Add user auth\" -m \"Implements JWT-based authentication.\"\n\n# Squash from a specific commit\ngit-surgeon squash abc1234 -m \"feature complete\"\n\n# Force squash even if range contains merge commits\ngit-surgeon squash HEAD~3 --force -m \"squash with merges\"\n```\n\nThe target commit must be an ancestor of HEAD. If the range contains merge\ncommits, use `--force` to flatten them into the squashed commit. Uncommitted\nchanges are autostashed and restored after squashing. The author from the oldest\ncommit is preserved by default; use `--no-preserve-author` to use the current\nuser instead.\n\n---\n\n### `undo`\n\nReverse-applies hunks from a specific commit onto the working tree. Useful for\nselectively reverting parts of a previous commit without reverting the entire\ncommit.\n\n```bash\n# List hunks from the commit to find IDs\ngit-surgeon hunks --commit HEAD\n\n# Undo specific hunks\ngit-surgeon undo a1b2c3d --from HEAD\ngit-surgeon undo a1b2c3d e4f5678 --from HEAD~3\n\n# Undo only lines 2-10 of a hunk\ngit-surgeon undo a1b2c3d --from HEAD --lines 2-10\n```\n\nThe changes appear as unstaged modifications in the working tree. Fails\ngracefully if context lines have changed since the commit (the patch no longer\napplies cleanly).\n\n---\n\n### `split`\n\nSplits an existing commit into multiple commits by selecting which hunks go into\neach new commit. Works on HEAD (direct reset) or earlier commits (via rebase).\n\n```bash\n# Split HEAD into two commits\ngit-surgeon split HEAD \\\n  --pick a1b2c3d e4f5678 -m \"add pagination\" \\\n  --rest-message \"filter deleted users\"\n\n# With subject + body (multiple -m flags, like git commit)\ngit-surgeon split HEAD \\\n  --pick a1b2c3d -m \"Add pagination\" -m \"Adds page and per_page params.\" \\\n  --rest-message \"Other changes\" --rest-message \"Body paragraph.\"\n\n# With line ranges (id:range inline syntax)\n# Use commas for non-contiguous ranges\ngit-surgeon split abc1234 \\\n  --pick a1b2c3d:1-11,20-30 e4f5678 \\\n  -m \"add pagination\"\n\n# Multiple splits (more than two commits)\ngit-surgeon split abc1234 \\\n  --pick a1b2c3d -m \"add pagination\" \\\n  --pick e4f5678 -m \"filter deleted users\" \\\n  --rest-message \"remaining cleanup\"\n```\n\nEach `--pick` group specifies hunk IDs (with optional `:start-end` line ranges)\nfollowed by `-m`/`--message`. Use multiple `-m` flags to add a commit body\n(joined with blank lines, like `git commit`). Remaining unpicked hunks are\ncommitted with `--rest-message` (defaults to the original commit message if\nomitted; supports multiple values for body).\n\nRequires a clean working tree. For non-HEAD commits, uses interactive rebase\nwith `--autostash`.\n\n## How hunk IDs work\n\nIDs are 7-character hex strings derived from SHA-1 of the file path and hunk\ncontent (the actual `+`/`-`/context lines, excluding the `@@` header). This\nmeans:\n\n- IDs are stable across line shifts — adding lines above a hunk doesn't change\n  its ID\n- IDs are deterministic — the same content always produces the same ID\n- Collisions get a `-2`, `-3` suffix (e.g., `a1b2c3d-2`)\n\n## Typical AI agent workflow\n\n```bash\n# 1. Agent makes changes to multiple files\n# 2. Review what changed\ngit-surgeon hunks\n\n# 3. Stage and commit hunks for feature A in one step\ngit-surgeon commit a1b2c3d e4f5678 -m \"implement feature A\"\n\n# 4. Commit remaining hunks for feature B\ngit-surgeon commit f6g7h8i -m \"implement feature B\"\n```\n\n## Example: splitting a hunk across commits\n\nA file has two unrelated changes (pagination + soft-delete filtering) that git\ngroups into a single hunk. The agent uses `show` to see line numbers, then\n`--lines` to stage only the pagination part:\n\n```\n❯ Commit the changes separately\n\n⏺ Bash(git diff)\n  ⎿  diff --git i/users.py w/users.py\n     index c3c39df..24929a5 100644\n     --- i/users.py\n     +++ w/users.py\n     @@ -1,13 +1,17 @@\n      import json\n\n     -def list_users(db):\n     +def list_users(db, page=1, per_page=50):\n          \"\"\"Return all active users.\"\"\"\n     -    users = db.query(\"SELECT * FROM users WHERE active = 1\")\n     -    return users\n     +    offset = (page - 1) * per_page\n     +    users = db.query(\"SELECT * FROM users WHERE active = 1 LIMIT ? OFFSET ?\", per_page, offset)\n     +    total = db.query(\"SELECT COUNT(*) FROM users WHERE active = 1\")[0]\n     +    return {\"users\": users, \"total\": total, \"page\": page}\n\n      def get_user(db, user_id):\n          \"\"\"Fetch a single user by ID.\"\"\"\n     -    user = db.query(\"SELECT * FROM users WHERE id = ?\", user_id)\n     +    user = db.query(\"SELECT * FROM users WHERE id = ? AND deleted_at IS NULL\", user_id)\n     +    if not user:\n     +        return None\n          return user\n\n⏺ There are two logical changes here: pagination for list_users and\n  soft-delete filtering + null handling for get_user. Let me commit them\n  separately using git-surgeon.\n\n⏺ Skill(git-surgeon)\n  ⎿  Successfully loaded skill\n\n⏺ Bash(git-surgeon hunks)\n  ⎿  64ba255 users.py (+8 -4)\n       -def list_users(db):\n       +def list_users(db, page=1, per_page=50):\n       -    users = db.query(\"SELECT * FROM users WHERE active = 1\")\n       ... (+8 more lines)\n\n⏺ Only one hunk. Let me see the full diff with line numbers to split it.\n\n⏺ Bash(git-surgeon show 64ba255)\n  ⎿  @@ -1,13 +1,17 @@\n      1: import json\n      2:\n      3:-def list_users(db):\n      4:+def list_users(db, page=1, per_page=50):\n     ... +15 lines (ctrl+o to expand)\n\n⏺ Bash(git-surgeon stage 64ba255 --lines 1-11)\n  ⎿  64ba255\n\n⏺ Bash(git commit -m \"add pagination to list_users\")\n  ⎿  [feature-users e81ede5] add pagination to list_users\n      1 file changed, 5 insertions(+), 3 deletions(-)\n\n⏺ Bash(git add users.py && git commit -m \"filter soft-deleted users in get_user\")\n  ⎿  [feature-users de99d59] filter soft-deleted users in get_user\n      1 file changed, 3 insertions(+), 1 deletion(-)\n```\n\n## Example: splitting a commit that mixes concerns\n\nA commit mixes three unrelated changes: logging, pagination, and active user\nfiltering. The agent uses `hunks --commit` to see the changes, `show --commit`\nto examine line numbers, then `split` with line ranges to separate concerns:\n\n```\n❯ split the big pagination commit that mixes concerns into multiple commits\n\n⏺ Skill(git-surgeon)\n  ⎿  Successfully loaded skill\n\n⏺ I'll help you split the pagination commit. Let me first look at the commit\n  history to identify it, then examine its hunks.\n\n⏺ Bash(git log --oneline -5)\n  ⎿  dda5d0e Add readme\n     945381f Add pagination, logging, and active user filtering\n     386b2fe Initial app setup\n\n⏺ Bash(git-surgeon hunks --commit 945381f --full)\n  ⎿  a811273 config.py (+3 -1)\n     1: DATABASE_URL = \"sqlite:///app.db\"\n     2: SECRET_KEY = \"dev-secret-key\"\n     … +76 lines (ctrl+o to expand)\n\n⏺ I can see the commit mixes several concerns:\n  1. Logging - LOG_LEVEL, LOG_FORMAT, logging imports, logger.info/warning calls\n  2. Pagination - MAX_PAGE_SIZE, pagination logic in list_users\n  3. Active user filtering - active field in User model and data, filtering in list_users\n\n  Let me split this into three focused commits:\n\n⏺ Bash(git-surgeon split 945381f \\\n        --pick a811273:4-6 8c1940f:2,5-6,34,37 \\\n        -m \"Add logging infrastructure\" \\\n        -m \"Configure debug logging level and format, add request l…)\n  ⎿  committed: Add logging infrastructure\n     committed: Add active flag to users\n     committed: Add pagination support\n\n⏺ Done. Let me verify the split:\n\n⏺ Bash(git log --oneline -5)\n  ⎿  f5d7d3e Add readme\n     ff73e29 Add pagination support\n     d6d0a7b Add active flag to users\n     … +2 lines (ctrl+o to expand)\n\n⏺ The commit has been split into three focused commits:\n  ┌─────────┬─────────────────────────────────────────────────────────────────────────────────────────────┐\n  │ Commit  │                                         Description                                         │\n  ├─────────┼─────────────────────────────────────────────────────────────────────────────────────────────┤\n  │ 6f98f7e │ Add logging infrastructure - LOG_LEVEL, LOG_FORMAT config, logging imports and logger calls │\n  ├─────────┼─────────────────────────────────────────────────────────────────────────────────────────────┤\n  │ d6d0a7b │ Add active flag to users - active field in model/data, filtering logic                      │\n  ├─────────┼─────────────────────────────────────────────────────────────────────────────────────────────┤\n  │ ff73e29 │ Add pagination support - MAX_PAGE_SIZE config, page/per_page params, paginated response     │\n  └─────────┴─────────────────────────────────────────────────────────────────────────────────────────────┘\n\n✻ Sautéed for 35s\n```\n\n## Requirements\n\n- Git 2.0+\n- Rust (for building from source)\n"
      },
      "plugins": [
        {
          "name": "git-surgeon",
          "source": "./",
          "description": "Surgical, non-interactive git hunk control for AI agents",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add raine/git-surgeon",
            "/plugin install git-surgeon@git-surgeon"
          ]
        }
      ]
    }
  ]
}