{
  "author": {
    "id": "emdashcodes",
    "display_name": "Em",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/689165?u=39088bdf4dd5adfa43e62e2c1100b6616e9ddf15&v=4",
    "url": "https://github.com/emdashcodes",
    "bio": null,
    "stats": {
      "total_marketplaces": 2,
      "total_plugins": 10,
      "total_commands": 3,
      "total_skills": 15,
      "total_stars": 14,
      "total_forks": 1
    }
  },
  "marketplaces": [
    {
      "name": "emdashcodes-claude-code-plugins",
      "version": null,
      "description": "Toolkit for Claude Code featuring specialized plugins, agents, and development skills",
      "owner_info": {
        "name": "Em",
        "url": "https://github.com/emdashcodes"
      },
      "keywords": [],
      "repo_full_name": "emdashcodes/claude-code-plugins",
      "repo_url": "https://github.com/emdashcodes/claude-code-plugins",
      "repo_description": "Claude Code plugins featuring specialized agents, commands, and development skills.",
      "homepage": "https://emdash.codes/claude-code/",
      "signals": {
        "stars": 8,
        "forks": 1,
        "pushed_at": "2026-01-08T19:24:31Z",
        "created_at": "2025-10-18T01:20:32Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 5483
        },
        {
          "path": "plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-agent-sdk-dev",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-agent-sdk-dev/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-agent-sdk-dev/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 223
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/SKILL.md",
          "type": "blob",
          "size": 10454
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_cost-tracking.md",
          "type": "blob",
          "size": 8864
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_custom-tools.md",
          "type": "blob",
          "size": 11714
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_hosting.md",
          "type": "blob",
          "size": 7159
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_mcp.md",
          "type": "blob",
          "size": 4894
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_migration-guide.md",
          "type": "blob",
          "size": 7704
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_modifying-system-prompts.md",
          "type": "blob",
          "size": 11299
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_overview.md",
          "type": "blob",
          "size": 7774
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_permissions.md",
          "type": "blob",
          "size": 10328
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_plugins.md",
          "type": "blob",
          "size": 7504
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_python.md",
          "type": "blob",
          "size": 55789
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_sessions.md",
          "type": "blob",
          "size": 4863
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_skills.md",
          "type": "blob",
          "size": 8756
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_slash-commands.md",
          "type": "blob",
          "size": 9184
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_streaming-vs-single-mode.md",
          "type": "blob",
          "size": 5517
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_structured-outputs.md",
          "type": "blob",
          "size": 7725
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_subagents.md",
          "type": "blob",
          "size": 9318
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_todo-tracking.md",
          "type": "blob",
          "size": 3741
        },
        {
          "path": "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_typescript.md",
          "type": "blob",
          "size": 39462
        },
        {
          "path": "plugins/claude-code-meta",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-hooks/SKILL.md",
          "type": "blob",
          "size": 12833
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-hooks/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-hooks/references/best-practices.md",
          "type": "blob",
          "size": 11425
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-hooks/references/hook-events.md",
          "type": "blob",
          "size": 14487
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-hooks/references/implementation-guide.md",
          "type": "blob",
          "size": 29222
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-mcp",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-mcp/SKILL.md",
          "type": "blob",
          "size": 14803
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-plugins/SKILL.md",
          "type": "blob",
          "size": 19846
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-plugins/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-plugins/references/plugin-marketplaces-guide.md",
          "type": "blob",
          "size": 13351
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-plugins/references/plugins-guide.md",
          "type": "blob",
          "size": 11871
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-plugins/references/plugins-reference.md",
          "type": "blob",
          "size": 11403
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-skills/SKILL.md",
          "type": "blob",
          "size": 15699
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-skills/assets",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-skills/assets/template-plugin-skill.md",
          "type": "blob",
          "size": 4756
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-skills/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-skills/references/agent-skills-spec.md",
          "type": "blob",
          "size": 1670
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-skills/references/allowed-tools-guide.md",
          "type": "blob",
          "size": 11851
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-skills/references/progressive-disclosure.md",
          "type": "blob",
          "size": 11854
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands/SKILL.md",
          "type": "blob",
          "size": 9130
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands/assets",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands/assets/template-advanced.md",
          "type": "blob",
          "size": 1030
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands/assets/template-basic.md",
          "type": "blob",
          "size": 101
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands/assets/template-with-arguments.md",
          "type": "blob",
          "size": 421
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands/assets/template-with-bash.md",
          "type": "blob",
          "size": 444
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-slash-commands/references/slash-commands-reference.md",
          "type": "blob",
          "size": 10317
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-subagents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-subagents/SKILL.md",
          "type": "blob",
          "size": 10284
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-subagents/assets",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-subagents/assets/code-reviewer.md",
          "type": "blob",
          "size": 3236
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-subagents/assets/custom.md",
          "type": "blob",
          "size": 3022
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-subagents/assets/debugger.md",
          "type": "blob",
          "size": 3383
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-subagents/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/claude-code-meta/skills/claude-code-subagents/references/subagents-reference.md",
          "type": "blob",
          "size": 17988
        },
        {
          "path": "plugins/google-docs-reader",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/google-docs-reader/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/google-docs-reader/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 258
        },
        {
          "path": "plugins/google-docs-reader/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/google-docs-reader/skills/google-docs-reader",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/google-docs-reader/skills/google-docs-reader/SKILL.md",
          "type": "blob",
          "size": 7908
        },
        {
          "path": "plugins/google-docs-reader/skills/google-docs-reader/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/google-docs-reader/skills/google-docs-reader/references/export_formats.md",
          "type": "blob",
          "size": 1786
        },
        {
          "path": "plugins/mermaid-diagram-to-image",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/mermaid-diagram-to-image/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/mermaid-diagram-to-image/skills/mermaid-diagram-to-image",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/mermaid-diagram-to-image/skills/mermaid-diagram-to-image/SKILL.md",
          "type": "blob",
          "size": 8077
        },
        {
          "path": "plugins/nano-banana-image-editor",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/nano-banana-image-editor/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/nano-banana-image-editor/commands/image.md",
          "type": "blob",
          "size": 735
        },
        {
          "path": "plugins/nano-banana-image-editor/commands/upgrade.md",
          "type": "blob",
          "size": 6638
        },
        {
          "path": "plugins/nano-banana-image-editor/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/nano-banana-image-editor/skills/nano-banana-image-editor",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/nano-banana-image-editor/skills/nano-banana-image-editor/SKILL.md",
          "type": "blob",
          "size": 18279
        },
        {
          "path": "plugins/nano-banana-image-editor/skills/nano-banana-image-editor/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/nano-banana-image-editor/skills/nano-banana-image-editor/references/best_practices.md",
          "type": "blob",
          "size": 9776
        },
        {
          "path": "plugins/nano-banana-image-editor/skills/nano-banana-image-editor/references/prompting_guide.md",
          "type": "blob",
          "size": 9560
        },
        {
          "path": "plugins/quill-export",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/quill-export/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/quill-export/skills/quill-export",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/quill-export/skills/quill-export/SKILL.md",
          "type": "blob",
          "size": 5838
        },
        {
          "path": "plugins/quill-export/skills/quill-export/assets",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/quill-export/skills/quill-export/assets/meeting-template.md",
          "type": "blob",
          "size": 1458
        },
        {
          "path": "plugins/quill-export/skills/quill-export/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/quill-export/skills/quill-export/references/quill-schema.md",
          "type": "blob",
          "size": 5385
        },
        {
          "path": "plugins/video-toolkit",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/video-toolkit/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/video-toolkit/agents/video-frame-analyzer.md",
          "type": "blob",
          "size": 6296
        },
        {
          "path": "plugins/video-toolkit/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/video-toolkit/commands/upgrade.md",
          "type": "blob",
          "size": 6297
        },
        {
          "path": "plugins/video-toolkit/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/video-toolkit/skills/video-toolkit",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/video-toolkit/skills/video-toolkit/SKILL.md",
          "type": "blob",
          "size": 63884
        },
        {
          "path": "plugins/video-toolkit/skills/video-toolkit/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/video-toolkit/skills/video-toolkit/references/ffmpeg_commands.md",
          "type": "blob",
          "size": 6611
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"emdashcodes-claude-code-plugins\",\n  \"owner\": {\n    \"name\": \"Em\",\n    \"url\": \"https://github.com/emdashcodes\"\n  },\n  \"metadata\": {\n    \"description\": \"Toolkit for Claude Code featuring specialized plugins, agents, and development skills\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"claude-code-meta\",\n      \"source\": \"./plugins/claude-code-meta\",\n      \"description\": \"Complete toolkit for building and distributing Claude Code plugins, skills, hooks, subagents, slash commands, marketplaces, and MCP servers\",\n      \"version\": \"1.1.0\",\n      \"author\": {\n        \"name\": \"Em\"\n      },\n      \"repository\": \"https://github.com/emdashcodes/claude-code-plugins\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"claude-code\", \"plugins\", \"marketplaces\", \"hooks\", \"subagents\", \"slash-commands\", \"skills\", \"mcp\", \"development\", \"automation\", \"configuration\"],\n      \"category\": \"development-tools\",\n      \"strict\": true,\n      \"skills\": [\n        \"./skills/claude-code-hooks\",\n        \"./skills/claude-code-slash-commands\",\n        \"./skills/claude-code-subagents\",\n        \"./skills/claude-code-plugins\",\n        \"./skills/claude-code-mcp\",\n        \"./skills/claude-code-skills\"\n      ]\n    },\n    {\n      \"name\": \"mermaid-diagram-to-image\",\n      \"source\": \"./plugins/mermaid-diagram-to-image\",\n      \"description\": \"Convert Mermaid diagrams to images (PNG, SVG, PDF) using mermaid-cli.\",\n      \"version\": \"1.0.1\",\n      \"author\": {\n        \"name\": \"Em\"\n      },\n      \"repository\": \"https://github.com/emdashcodes/claude-code-plugins\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"claude-code\", \"mermaid\", \"diagrams\", \"visualization\", \"image-generation\", \"documentation\"],\n      \"category\": \"development-tools\",\n      \"strict\": true,\n      \"skills\": [\n        \"./skills/mermaid-diagram-to-image\"\n      ]\n    },\n    {\n      \"name\": \"google-docs-reader\",\n      \"source\": \"./plugins/google-docs-reader\",\n      \"description\": \"Read and analyze Google Docs, Sheets, and Slides by exporting them to local formats (DOCX, XLSX, PPTX) via browser download.\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"Em\"\n      },\n      \"repository\": \"https://github.com/emdashcodes/claude-code-plugins\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"google-docs\", \"google-sheets\", \"google-slides\", \"google-drive\", \"document-analysis\", \"export\"],\n      \"category\": \"productivity\",\n      \"strict\": true,\n      \"skills\": [\n        \"./skills/google-docs-reader\"\n      ]\n    },\n    {\n      \"name\": \"quill-export\",\n      \"source\": \"./plugins/quill-export\",\n      \"description\": \"Extract meeting recordings and transcripts from the Quill macOS app database with AI summary and cross-linking.\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"Em\"\n      },\n      \"repository\": \"https://github.com/emdashcodes/claude-code-plugins\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"quill\", \"meetings\", \"transcripts\", \"recordings\", \"macos\", \"export\"],\n      \"category\": \"productivity\",\n      \"strict\": true,\n      \"skills\": [\n        \"./skills/quill-export\"\n      ]\n    },\n    {\n      \"name\": \"nano-banana-image-editor\",\n      \"source\": \"./plugins/nano-banana-image-editor\",\n      \"description\": \"Create and edit images with natural language using Gemini 3 Pro Image. Use for image generation, photo editing, infographics, icons, style transfer, and text rendering. Includes Google Search grounding for factual content and PIL/Pillow for quick crops.\",\n      \"version\": \"1.0.1\",\n      \"author\": {\n        \"name\": \"Em\"\n      },\n      \"repository\": \"https://github.com/emdashcodes/claude-code-plugins\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"gemini\", \"image-editing\", \"nano-banana\", \"pillow\", \"pil\", \"ai-image\", \"photo-editing\", \"image-generation\", \"cropping\"],\n      \"category\": \"productivity\",\n      \"strict\": true,\n      \"commands\": [\n        \"./commands/image.md\",\n        \"./commands/upgrade.md\"\n      ],\n      \"skills\": [\n        \"./skills/nano-banana-image-editor\"\n      ]\n    },\n    {\n      \"name\": \"video-toolkit\",\n      \"source\": \"./plugins/video-toolkit\",\n      \"description\": \"Video editing and analysis with FFmpeg and Whisper. Extract frames, transcribe audio, and perform video operations (clip, merge, split)\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"Em\"\n      },\n      \"repository\": \"https://github.com/emdashcodes/claude-code-plugins\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"video\", \"ffmpeg\", \"whisper\", \"editing\", \"transcription\", \"analysis\", \"multimedia\"],\n      \"category\": \"productivity\",\n      \"strict\": true,\n      \"commands\": [\n        \"./commands/upgrade.md\"\n      ],\n      \"skills\": [\n        \"./skills/video-toolkit\"\n      ],\n      \"agents\": [\n        \"./agents/video-frame-analyzer.md\"\n      ]\n    },\n    {\n      \"name\": \"claude-agent-sdk-dev\",\n      \"source\": \"./plugins/claude-agent-sdk-dev\",\n      \"description\": \"Development tools and documentation for building applications with the Claude Agent SDK. Covers Python and TypeScript APIs, core features, advanced features, and integrations.\",\n      \"version\": \"0.1.0\",\n      \"author\": {\n        \"name\": \"Em\"\n      },\n      \"repository\": \"https://github.com/emdashcodes/claude-code-plugins\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"claude\", \"agent-sdk\", \"sdk\", \"development\", \"api\", \"python\", \"typescript\", \"documentation\"],\n      \"category\": \"development-tools\",\n      \"strict\": true,\n      \"skills\": [\n        \"./skills/claude-agent-sdk\"\n      ]\n    }\n  ]\n}",
        "plugins/claude-agent-sdk-dev/.claude-plugin/plugin.json": "{\n  \"name\": \"claude-agent-sdk-dev\",\n  \"version\": \"0.1.0\",\n  \"description\": \"Development tools and documentation for building applications with the Claude Agent SDK\",\n  \"author\": {\n    \"name\": \"Em\"\n  },\n  \"license\": \"MIT\"\n}\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/SKILL.md": "---\nname: claude-agent-sdk\ndescription: This skill should be used when developing applications with the Claude Agent SDK, answering questions about SDK features and APIs, implementing SDK patterns, or troubleshooting SDK integration. Covers Python and TypeScript APIs, core features, advanced features, and integrations.\nallowed-tools: Read, Write, Edit, Bash, Glob, Grep, WebFetch\n---\n\n# Claude Agent SDK Development\n\n## Overview\n\nThis skill provides comprehensive documentation and development guidance for building applications with the Claude Agent SDK. Use this skill when working with Claude Agent SDK based applications, implementing SDK features, or answering questions about SDK capabilities in both Python and TypeScript.\n\nThe Claude Agent SDK enables building conversational AI agents with access to tools, multi-turn sessions, streaming, structured outputs, and extensibility through Skills, Plugins, Slash Commands, and Subagents.\n\n## When to Use This Skill\n\nActivate this skill when:\n\n- Building new applications using the Claude Agent SDK\n- Implementing SDK features (sessions, permissions, streaming, structured outputs)\n- Adding extensibility (Skills, Plugins, Slash Commands, Subagents, MCP)\n- Integrating custom tools or external APIs\n- Troubleshooting SDK issues or migration from legacy implementations\n- Answering questions about SDK capabilities, APIs, or best practices\n- Setting up hosting and deployment for SDK applications\n- Implementing cost tracking and usage monitoring\n\n## Quick Start\n\n### API References\n\nThe SDK is available in both Python and TypeScript. For detailed API documentation, reference:\n\n- **Python API**: `references/agent-sdk_python.md`\n- **TypeScript API**: `references/agent-sdk_typescript.md`\n\n### Getting Started\n\nFor SDK overview and core concepts, reference:\n\n- **Overview**: `references/agent-sdk_overview.md`\n\n## Core Features\n\n### 1. Session Management\n\nSessions enable multi-turn conversations with state persistence. To implement sessions:\n\n**Reference**: `references/agent-sdk_sessions.md`\n\n**Key concepts**:\n\n- Creating and managing sessions\n- Persisting conversation state\n- Resuming sessions across requests\n- Session lifecycle and cleanup\n\n**When to reference**: When implementing multi-turn conversations, state persistence, or conversation continuity.\n\n### 2. Permissions System\n\nThe SDK includes a permissions system for controlling tool access and user approval flows.\n\n**Reference**: `references/agent-sdk_permissions.md`\n\n**Key concepts**:\n\n- Defining tool permissions\n- Implementing approval workflows\n- Permission tiers (auto-approve, prompt, deny)\n- Batch permission handling\n\n**When to reference**: When implementing tool restrictions, user approval flows, or security controls.\n\n### 3. System Prompt Modification\n\nCustomize agent behavior by modifying system prompts.\n\n**Reference**: `references/agent-sdk_modifying-system-prompts.md`\n\n**Key concepts**:\n\n- Overriding default system prompts\n- Adding custom instructions\n- Combining with Skills and Plugins\n- Best practices for prompt engineering\n\n**When to reference**: When customizing agent behavior, adding domain expertise, or implementing specialized agent personalities.\n\n### 4. Streaming vs Single-Turn Mode\n\nThe SDK supports both streaming and single-turn modes for different use cases.\n\n**Reference**: `references/agent-sdk_streaming-vs-single-mode.md`\n\n**Key concepts**:\n\n- Streaming for real-time responses\n- Single-turn for batch processing\n- Trade-offs and performance considerations\n- Implementation patterns\n\n**When to reference**: When deciding on interaction mode, implementing real-time UIs, or optimizing for specific use cases.\n\n### 5. Structured Outputs\n\nGenerate structured data with schema validation and type safety.\n\n**Reference**: `references/agent-sdk_structured-outputs.md`\n\n**Key concepts**:\n\n- Defining output schemas\n- JSON schema validation\n- Type-safe responses\n- Error handling\n\n**When to reference**: When generating structured data, implementing type-safe responses, or validating outputs.\n\n## Advanced Features\n\n### 1. Agent Skills\n\nSkills provide specialized knowledge and workflows to agents.\n\n**Reference**: `references/agent-sdk_skills.md`\n\n**Key concepts**:\n\n- Creating and registering Skills\n- Skill structure (SKILL.md, scripts, references, assets)\n- Skill activation and context loading\n- Distributing Skills\n\n**When to reference**: When adding specialized capabilities, domain knowledge, or reusable workflows to agents.\n\n### 2. Plugins\n\nPlugins bundle multiple components (Skills, Slash Commands, Subagents, Hooks, MCP servers) for distribution.\n\n**Reference**: `references/agent-sdk_plugins.md`\n\n**Key concepts**:\n\n- Plugin architecture\n- Creating plugin packages\n- Plugin manifest (plugin.json)\n- Distribution via marketplaces\n\n**When to reference**: When bundling related components, distributing tools, or creating reusable agent extensions.\n\n### 3. Slash Commands\n\nSlash Commands are user-invoked shortcuts that expand to prompts.\n\n**Reference**: `references/agent-sdk_slash-commands.md`\n\n**Key concepts**:\n\n- Creating slash commands\n- Command arguments and parameters\n- Integration with bash scripts\n- Command discovery\n\n**When to reference**: When implementing user-triggered workflows, shortcuts, or custom operations.\n\n### 4. Subagents\n\nSubagents are specialized agents with custom system prompts and tool access.\n\n**Reference**: `references/agent-sdk_subagents.md`\n\n**Key concepts**:\n\n- Creating subagent configurations\n- Tool permission scoping\n- Agent specialization patterns\n- Subagent invocation\n\n**When to reference**: When implementing specialized agents, task delegation, or multi-agent workflows.\n\n## Tools & Integration\n\n### 1. Custom Tools\n\nExtend agent capabilities with custom tools.\n\n**Reference**: `references/agent-sdk_custom-tools.md`\n\n**Key concepts**:\n\n- Tool definition schemas\n- Implementing tool handlers\n- Parameter validation\n- Error handling\n\n**When to reference**: When adding custom functionality, integrating APIs, or extending agent capabilities.\n\n### 2. MCP (Model Context Protocol)\n\nIntegrate external tools and services via MCP.\n\n**Reference**: `references/agent-sdk_mcp.md`\n\n**Key concepts**:\n\n- MCP server configuration\n- Tool discovery and registration\n- Connection management\n- MCP protocol implementation\n\n**When to reference**: When integrating external tools, databases, or third-party services.\n\n### 3. Hosting & Deployment\n\nDeploy SDK applications in production environments.\n\n**Reference**: `references/agent-sdk_hosting.md`\n\n**Key concepts**:\n\n- Deployment architectures\n- Environment configuration\n- Scaling considerations\n- Security best practices\n\n**When to reference**: When deploying to production, configuring infrastructure, or optimizing performance.\n\n### 4. Todo Lists\n\nImplement task tracking and progress visualization.\n\n**Reference**: `references/agent-sdk_todo-tracking.md`\n\n**Key concepts**:\n\n- Todo list API\n- Task state management\n- Progress tracking\n- UI integration\n\n**When to reference**: When implementing task tracking, progress visualization, or multi-step workflows.\n\n### 5. Cost Tracking & Usage Monitoring\n\nMonitor API usage and costs.\n\n**Reference**: `references/agent-sdk_cost-tracking.md`\n\n**Key concepts**:\n\n- Usage tracking APIs\n- Cost calculation\n- Token counting\n- Budget management\n\n**When to reference**: When implementing cost controls, usage analytics, or budget tracking.\n\n## Development Workflow\n\n### Building New Applications\n\nWhen starting a new SDK project:\n\n1. **Choose language**: Python or TypeScript\n2. **Review API reference**: Load the appropriate API reference doc\n3. **Understand core concepts**: Review session management and permissions\n4. **Implement basic agent**: Start with simple tool integration\n5. **Add features**: Sessions, streaming, structured outputs as needed\n6. **Extend with plugins**: Add Skills, Slash Commands, Subagents as appropriate\n7. **Deploy**: Reference hosting guide for production deployment\n\n### Answering SDK Questions\n\nWhen answering questions about the SDK:\n\n1. **Identify topic area**: Core features, advanced features, or tools/integration\n2. **Load relevant references**: Use the reference map above\n3. **Search for specifics**: Use Grep to find exact APIs, examples, or patterns\n4. **Provide code examples**: Reference examples from documentation\n5. **Link to additional resources**: Point to specific reference files for deeper exploration\n\n### Troubleshooting\n\nWhen debugging SDK issues:\n\n1. **Check migration guide**: If migrating from legacy implementation\n2. **Review permissions**: Verify tool permissions are correctly configured\n3. **Validate schemas**: For structured outputs, check schema definitions\n4. **Check MCP connections**: Verify MCP servers are running and accessible\n\n## Reference Documentation Index\n\nAll SDK documentation is available in the `references/` directory:\n\n**API References**:\n\n- `agent-sdk_python.md` - Python API\n- `agent-sdk_typescript.md` - TypeScript API\n\n**Core Features**:\n\n- `agent-sdk_overview.md` - SDK overview\n- `agent-sdk_permissions.md` - Permissions system\n- `agent-sdk_migration-guide.md` - Migration guide\n- `agent-sdk_modifying-system-prompts.md` - System prompts\n- `agent-sdk_sessions.md` - Session management\n- `agent-sdk_streaming-vs-single-mode.md` - Streaming modes\n- `agent-sdk_structured-outputs.md` - Structured outputs\n\n**Advanced Features**:\n\n- `agent-sdk_skills.md` - Agent Skills\n- `agent-sdk_plugins.md` - Plugins\n- `agent-sdk_slash-commands.md` - Slash Commands\n- `agent-sdk_subagents.md` - Subagents\n\n**Tools & Integration**:\n\n- `agent-sdk_custom-tools.md` - Custom tools\n- `agent-sdk_hosting.md` - Hosting & deployment\n- `agent-sdk_mcp.md` - MCP integration\n- `agent-sdk_todo-tracking.md` - Todo lists\n- `agent-sdk_cost-tracking.md` - Cost tracking\n\n## Best Practices\n\n### Code Examples\n\nWhen providing code examples:\n\n- Reference actual examples from documentation\n- Adapt to user's language preference (Python vs TypeScript)\n- Include error handling and edge cases\n- Show complete working examples, not just snippets\n\n### Integration Patterns\n\nCommon integration patterns:\n\n- **Skills + Custom Tools**: Combine domain knowledge with custom functionality\n- **Slash Commands + Subagents**: User-triggered specialized agents\n- **MCP + Permissions**: Secure external tool integration\n- **Sessions + Structured Outputs**: Stateful multi-turn interactions with type-safe responses\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_cost-tracking.md": "---\ntitle: Tracking Costs and Usage\nsource_url: https://platform.claude.com/docs/en/agent-sdk/cost-tracking\n---\n\n# SDK Cost Tracking\n\nThe Claude Agent SDK provides detailed token usage information for each interaction with Claude. This guide explains how to properly track costs and understand usage reporting, especially when dealing with parallel tool uses and multi-step conversations.\n\nFor complete API documentation, see the [TypeScript SDK reference](https://platform.claude.com/docs/en/agent-sdk/typescript).\n\n## Understanding Token Usage\n\nWhen Claude processes requests, it reports token usage at the message level. This usage data is essential for tracking costs and billing users appropriately.\n\n### Key Concepts\n\n1. **Steps**: A step is a single request/response pair between your application and Claude\n2. **Messages**: Individual messages within a step (text, tool uses, tool results)\n3. **Usage**: Token consumption data attached to assistant messages\n\n## Usage Reporting Structure\n\n### Single vs Parallel Tool Use\n\nWhen Claude executes tools, the usage reporting differs based on whether tools are executed sequentially or in parallel:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Example: Tracking usage in a conversation\n    const result = await query({\n      prompt: \"Analyze this codebase and run tests\",\n      options: {\n        onMessage: (message) => {\n          if (message.type === 'assistant' && message.usage) {\n            console.log(`Message ID: ${message.id}`);\n            console.log(`Usage:`, message.usage);\n          }\n        }\n      }\n    });\n\n### Message Flow Example\n\nHere's how messages and usage are reported in a typical multi-step conversation:\n\n    <!-- Step 1: Initial request with parallel tool uses -->\n    assistant (text)      { id: \"msg_1\", usage: { output_tokens: 100, ... } }\n    assistant (tool_use)  { id: \"msg_1\", usage: { output_tokens: 100, ... } }\n    assistant (tool_use)  { id: \"msg_1\", usage: { output_tokens: 100, ... } }\n    assistant (tool_use)  { id: \"msg_1\", usage: { output_tokens: 100, ... } }\n    user (tool_result)\n    user (tool_result)\n    user (tool_result)\n\n    <!-- Step 2: Follow-up response -->\n    assistant (text)      { id: \"msg_2\", usage: { output_tokens: 98, ... } }\n\n## Important Usage Rules\n\n### 1\\. Same ID = Same Usage\n\n**All messages with the same `id` field report identical usage**. When Claude sends multiple messages in the same turn (e.g., text + tool uses), they share the same message ID and usage data.\n\n    // All these messages have the same ID and usage\n    const messages = [\n      { type: 'assistant', id: 'msg_123', usage: { output_tokens: 100 } },\n      { type: 'assistant', id: 'msg_123', usage: { output_tokens: 100 } },\n      { type: 'assistant', id: 'msg_123', usage: { output_tokens: 100 } }\n    ];\n\n    // Charge only once per unique message ID\n    const uniqueUsage = messages[0].usage; // Same for all messages with this ID\n\n### 2\\. Charge Once Per Step\n\n**You should only charge users once per step**, not for each individual message. When you see multiple assistant messages with the same ID, use the usage from any one of them.\n\n### 3\\. Result Message Contains Cumulative Usage\n\nThe final `result` message contains the total cumulative usage from all steps in the conversation:\n\n    // Final result includes total usage\n    const result = await query({\n      prompt: \"Multi-step task\",\n      options: { /* ... */ }\n    });\n\n    console.log(\"Total usage:\", result.usage);\n    console.log(\"Total cost:\", result.usage.total_cost_usd);\n\n## Implementation: Cost Tracking System\n\nHere's a complete example of implementing a cost tracking system:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    class CostTracker {\n      private processedMessageIds = new Set<string>();\n      private stepUsages: Array<any> = [];\n\n      async trackConversation(prompt: string) {\n        const result = await query({\n          prompt,\n          options: {\n            onMessage: (message) => {\n              this.processMessage(message);\n            }\n          }\n        });\n\n        return {\n          result,\n          stepUsages: this.stepUsages,\n          totalCost: result.usage?.total_cost_usd || 0\n        };\n      }\n\n      private processMessage(message: any) {\n        // Only process assistant messages with usage\n        if (message.type !== 'assistant' || !message.usage) {\n          return;\n        }\n\n        // Skip if we've already processed this message ID\n        if (this.processedMessageIds.has(message.id)) {\n          return;\n        }\n\n        // Mark as processed and record usage\n        this.processedMessageIds.add(message.id);\n        this.stepUsages.push({\n          messageId: message.id,\n          timestamp: new Date().toISOString(),\n          usage: message.usage,\n          costUSD: this.calculateCost(message.usage)\n        });\n      }\n\n      private calculateCost(usage: any): number {\n        // Implement your pricing calculation here\n        // This is a simplified example\n        const inputCost = usage.input_tokens * 0.00003;\n        const outputCost = usage.output_tokens * 0.00015;\n        const cacheReadCost = (usage.cache_read_input_tokens || 0) * 0.0000075;\n\n        return inputCost + outputCost + cacheReadCost;\n      }\n    }\n\n    // Usage\n    const tracker = new CostTracker();\n    const { result, stepUsages, totalCost } = await tracker.trackConversation(\n      \"Analyze and refactor this code\"\n    );\n\n    console.log(`Steps processed: ${stepUsages.length}`);\n    console.log(`Total cost: $${totalCost.toFixed(4)}`);\n\n## Handling Edge Cases\n\n### Output Token Discrepancies\n\nIn rare cases, you might observe different `output_tokens` values for messages with the same ID. When this occurs:\n\n1. **Use the highest value** - The final message in a group typically contains the accurate total\n2. **Verify against total cost** - The `total_cost_usd` in the result message is authoritative\n3. **Report inconsistencies** - File issues at the [Claude Code GitHub repository](https://github.com/anthropics/claude-code/issues)\n\n### Cache Token Tracking\n\nWhen using prompt caching, track these token types separately:\n\n    interface CacheUsage {\n      cache_creation_input_tokens: number;\n      cache_read_input_tokens: number;\n      cache_creation: {\n        ephemeral_5m_input_tokens: number;\n        ephemeral_1h_input_tokens: number;\n      };\n    }\n\n## Best Practices\n\n1. **Use Message IDs for Deduplication**: Always track processed message IDs to avoid double-charging\n2. **Monitor the Result Message**: The final result contains authoritative cumulative usage\n3. **Implement Logging**: Log all usage data for auditing and debugging\n4. **Handle Failures Gracefully**: Track partial usage even if a conversation fails\n5. **Consider Streaming**: For streaming responses, accumulate usage as messages arrive\n\n## Usage Fields Reference\n\nEach usage object contains:\n\n- `input_tokens`: Base input tokens processed\n- `output_tokens`: Tokens generated in the response\n- `cache_creation_input_tokens`: Tokens used to create cache entries\n- `cache_read_input_tokens`: Tokens read from cache\n- `service_tier`: The service tier used (e.g., \"standard\")\n- `total_cost_usd`: Total cost in USD (only in result message)\n\n## Example: Building a Billing Dashboard\n\nHere's how to aggregate usage data for a billing dashboard:\n\n    class BillingAggregator {\n      private userUsage = new Map<string, {\n        totalTokens: number;\n        totalCost: number;\n        conversations: number;\n      }>();\n\n      async processUserRequest(userId: string, prompt: string) {\n        const tracker = new CostTracker();\n        const { result, stepUsages, totalCost } = await tracker.trackConversation(prompt);\n\n        // Update user totals\n        const current = this.userUsage.get(userId) || {\n          totalTokens: 0,\n          totalCost: 0,\n          conversations: 0\n        };\n\n        const totalTokens = stepUsages.reduce((sum, step) => \n          sum + step.usage.input_tokens + step.usage.output_tokens, 0\n        );\n\n        this.userUsage.set(userId, {\n          totalTokens: current.totalTokens + totalTokens,\n          totalCost: current.totalCost + totalCost,\n          conversations: current.conversations + 1\n        });\n\n        return result;\n      }\n\n      getUserBilling(userId: string) {\n        return this.userUsage.get(userId) || {\n          totalTokens: 0,\n          totalCost: 0,\n          conversations: 0\n        };\n      }\n    }\n\n## Related Documentation\n\n- [TypeScript SDK Reference](https://platform.claude.com/docs/en/agent-sdk/typescript) - Complete API documentation\n- [SDK Overview](https://platform.claude.com/docs/en/agent-sdk/overview) - Getting started with the SDK\n- [SDK Permissions](https://platform.claude.com/docs/en/agent-sdk/permissions) - Managing tool permissions\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_custom-tools.md": "---\ntitle: Custom Tools\nsource_url: https://platform.claude.com/docs/en/agent-sdk/custom-tools\n---\n\nCustom tools allow you to extend Claude Code's capabilities with your own functionality through in-process MCP servers, enabling Claude to interact with external services, APIs, or perform specialized operations.\n\n## Creating Custom Tools\n\nUse the `createSdkMcpServer` and `tool` helper functions to define type-safe custom tools:\n\n    import { query, tool, createSdkMcpServer } from \"@anthropic-ai/claude-agent-sdk\";\n    import { z } from \"zod\";\n\n    // Create an SDK MCP server with custom tools\n    const customServer = createSdkMcpServer({\n      name: \"my-custom-tools\",\n      version: \"1.0.0\",\n      tools: [\n        tool(\n          \"get_weather\",\n          \"Get current temperature for a location using coordinates\",\n          {\n            latitude: z.number().describe(\"Latitude coordinate\"),\n            longitude: z.number().describe(\"Longitude coordinate\")\n          },\n          async (args) => {\n            const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${args.latitude}&longitude=${args.longitude}&current=temperature_2m&temperature_unit=fahrenheit`);\n            const data = await response.json();\n\n            return {\n              content: [{\n                type: \"text\",\n                text: `Temperature: ${data.current.temperature_2m}Â°F`\n              }]\n            };\n          }\n        )\n      ]\n    });\n\n## Using Custom Tools\n\nPass the custom server to the `query` function via the `mcpServers` option as a dictionary/object.\n\n**Important:** Custom MCP tools require streaming input mode. You must use an async generator/iterable for the `prompt` parameter - a simple string will not work with MCP servers.\n\n### Tool Name Format\n\nWhen MCP tools are exposed to Claude, their names follow a specific format:\n\n- Pattern: `mcp__{server_name}__{tool_name}`\n- Example: A tool named `get_weather` in server `my-custom-tools` becomes `mcp__my-custom-tools__get_weather`\n\n### Configuring Allowed Tools\n\nYou can control which tools Claude can use via the `allowedTools` option:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Use the custom tools in your query with streaming input\n    async function* generateMessages() {\n      yield {\n        type: \"user\" as const,\n        message: {\n          role: \"user\" as const,\n          content: \"What's the weather in San Francisco?\"\n        }\n      };\n    }\n\n    for await (const message of query({\n      prompt: generateMessages(),  // Use async generator for streaming input\n      options: {\n        mcpServers: {\n          \"my-custom-tools\": customServer  // Pass as object/dictionary, not array\n        },\n        // Optionally specify which tools Claude can use\n        allowedTools: [\n          \"mcp__my-custom-tools__get_weather\",  // Allow the weather tool\n          // Add other tools as needed\n        ],\n        maxTurns: 3\n      }\n    })) {\n      if (message.type === \"result\" && message.subtype === \"success\") {\n        console.log(message.result);\n      }\n    }\n\n### Multiple Tools Example\n\nWhen your MCP server has multiple tools, you can selectively allow them:\n\n    const multiToolServer = createSdkMcpServer({\n      name: \"utilities\",\n      version: \"1.0.0\",\n      tools: [\n        tool(\"calculate\", \"Perform calculations\", { /* ... */ }, async (args) => { /* ... */ }),\n        tool(\"translate\", \"Translate text\", { /* ... */ }, async (args) => { /* ... */ }),\n        tool(\"search_web\", \"Search the web\", { /* ... */ }, async (args) => { /* ... */ })\n      ]\n    });\n\n    // Allow only specific tools with streaming input\n    async function* generateMessages() {\n      yield {\n        type: \"user\" as const,\n        message: {\n          role: \"user\" as const,\n          content: \"Calculate 5 + 3 and translate 'hello' to Spanish\"\n        }\n      };\n    }\n\n    for await (const message of query({\n      prompt: generateMessages(),  // Use async generator for streaming input\n      options: {\n        mcpServers: {\n          utilities: multiToolServer\n        },\n        allowedTools: [\n          \"mcp__utilities__calculate\",   // Allow calculator\n          \"mcp__utilities__translate\",   // Allow translator\n          // \"mcp__utilities__search_web\" is NOT allowed\n        ]\n      }\n    })) {\n      // Process messages\n    }\n\n## Type Safety with Python\n\nThe `@tool` decorator supports various schema definition approaches for type safety:\n\n    import { z } from \"zod\";\n\n    tool(\n      \"process_data\",\n      \"Process structured data with type safety\",\n      {\n        // Zod schema defines both runtime validation and TypeScript types\n        data: z.object({\n          name: z.string(),\n          age: z.number().min(0).max(150),\n          email: z.string().email(),\n          preferences: z.array(z.string()).optional()\n        }),\n        format: z.enum([\"json\", \"csv\", \"xml\"]).default(\"json\")\n      },\n      async (args) => {\n        // args is fully typed based on the schema\n        // TypeScript knows: args.data.name is string, args.data.age is number, etc.\n        console.log(`Processing ${args.data.name}'s data as ${args.format}`);\n\n        // Your processing logic here\n        return {\n          content: [{\n            type: \"text\",\n            text: `Processed data for ${args.data.name}`\n          }]\n        };\n      }\n    )\n\n## Error Handling\n\nHandle errors gracefully to provide meaningful feedback:\n\n    tool(\n      \"fetch_data\",\n      \"Fetch data from an API\",\n      {\n        endpoint: z.string().url().describe(\"API endpoint URL\")\n      },\n      async (args) => {\n        try {\n          const response = await fetch(args.endpoint);\n\n          if (!response.ok) {\n            return {\n              content: [{\n                type: \"text\",\n                text: `API error: ${response.status} ${response.statusText}`\n              }]\n            };\n          }\n\n          const data = await response.json();\n          return {\n            content: [{\n              type: \"text\",\n              text: JSON.stringify(data, null, 2)\n            }]\n          };\n        } catch (error) {\n          return {\n            content: [{\n              type: \"text\",\n              text: `Failed to fetch data: ${error.message}`\n            }]\n          };\n        }\n      }\n    )\n\n## Example Tools\n\n### Database Query Tool\n\n    const databaseServer = createSdkMcpServer({\n      name: \"database-tools\",\n      version: \"1.0.0\",\n      tools: [\n        tool(\n          \"query_database\",\n          \"Execute a database query\",\n          {\n            query: z.string().describe(\"SQL query to execute\"),\n            params: z.array(z.any()).optional().describe(\"Query parameters\")\n          },\n          async (args) => {\n            const results = await db.query(args.query, args.params || []);\n            return {\n              content: [{\n                type: \"text\",\n                text: `Found ${results.length} rows:\\n${JSON.stringify(results, null, 2)}`\n              }]\n            };\n          }\n        )\n      ]\n    });\n\n### API Gateway Tool\n\n    const apiGatewayServer = createSdkMcpServer({\n      name: \"api-gateway\",\n      version: \"1.0.0\",\n      tools: [\n        tool(\n          \"api_request\",\n          \"Make authenticated API requests to external services\",\n          {\n            service: z.enum([\"stripe\", \"github\", \"openai\", \"slack\"]).describe(\"Service to call\"),\n            endpoint: z.string().describe(\"API endpoint path\"),\n            method: z.enum([\"GET\", \"POST\", \"PUT\", \"DELETE\"]).describe(\"HTTP method\"),\n            body: z.record(z.any()).optional().describe(\"Request body\"),\n            query: z.record(z.string()).optional().describe(\"Query parameters\")\n          },\n          async (args) => {\n            const config = {\n              stripe: { baseUrl: \"https://api.stripe.com/v1\", key: process.env.STRIPE_KEY },\n              github: { baseUrl: \"https://api.github.com\", key: process.env.GITHUB_TOKEN },\n              openai: { baseUrl: \"https://api.openai.com/v1\", key: process.env.OPENAI_KEY },\n              slack: { baseUrl: \"https://slack.com/api\", key: process.env.SLACK_TOKEN }\n            };\n\n            const { baseUrl, key } = config[args.service];\n            const url = new URL(`${baseUrl}${args.endpoint}`);\n\n            if (args.query) {\n              Object.entries(args.query).forEach(([k, v]) => url.searchParams.set(k, v));\n            }\n\n            const response = await fetch(url, {\n              method: args.method,\n              headers: { Authorization: `Bearer ${key}`, \"Content-Type\": \"application/json\" },\n              body: args.body ? JSON.stringify(args.body) : undefined\n            });\n\n            const data = await response.json();\n            return {\n              content: [{\n                type: \"text\",\n                text: JSON.stringify(data, null, 2)\n              }]\n            };\n          }\n        )\n      ]\n    });\n\n### Calculator Tool\n\n    const calculatorServer = createSdkMcpServer({\n      name: \"calculator\",\n      version: \"1.0.0\",\n      tools: [\n        tool(\n          \"calculate\",\n          \"Perform mathematical calculations\",\n          {\n            expression: z.string().describe(\"Mathematical expression to evaluate\"),\n            precision: z.number().optional().default(2).describe(\"Decimal precision\")\n          },\n          async (args) => {\n            try {\n              // Use a safe math evaluation library in production\n              const result = eval(args.expression); // Example only!\n              const formatted = Number(result).toFixed(args.precision);\n\n              return {\n                content: [{\n                  type: \"text\",\n                  text: `${args.expression} = ${formatted}`\n                }]\n              };\n            } catch (error) {\n              return {\n                content: [{\n                  type: \"text\",\n                  text: `Error: Invalid expression - ${error.message}`\n                }]\n              };\n            }\n          }\n        ),\n        tool(\n          \"compound_interest\",\n          \"Calculate compound interest for an investment\",\n          {\n            principal: z.number().positive().describe(\"Initial investment amount\"),\n            rate: z.number().describe(\"Annual interest rate (as decimal, e.g., 0.05 for 5%)\"),\n            time: z.number().positive().describe(\"Investment period in years\"),\n            n: z.number().positive().default(12).describe(\"Compounding frequency per year\")\n          },\n          async (args) => {\n            const amount = args.principal * Math.pow(1 + args.rate / args.n, args.n * args.time);\n            const interest = amount - args.principal;\n\n            return {\n              content: [{\n                type: \"text\",\n                text: `Investment Analysis:\\n` +\n                      `Principal: $${args.principal.toFixed(2)}\\n` +\n                      `Rate: ${(args.rate * 100).toFixed(2)}%\\n` +\n                      `Time: ${args.time} years\\n` +\n                      `Compounding: ${args.n} times per year\\n\\n` +\n                      `Final Amount: $${amount.toFixed(2)}\\n` +\n                      `Interest Earned: $${interest.toFixed(2)}\\n` +\n                      `Return: ${((interest / args.principal) * 100).toFixed(2)}%`\n              }]\n            };\n          }\n        )\n      ]\n    });\n\n## Related Documentation\n\n- [TypeScript SDK Reference](https://platform.claude.com/docs/en/agent-sdk/typescript)\n- [Python SDK Reference](https://platform.claude.com/docs/en/agent-sdk/python)\n- [MCP Documentation](https://modelcontextprotocol.io/)\n- [SDK Overview](https://platform.claude.com/docs/en/agent-sdk/overview)\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_hosting.md": "---\ntitle: Hosting the Agent SDK\nsource_url: https://platform.claude.com/docs/en/agent-sdk/hosting\n---\n\nThe Claude Agent SDK differs from traditional stateless LLM APIs in that it maintains conversational state and executes commands in a persistent environment. This guide covers the architecture, hosting considerations, and best practices for deploying SDK-based agents in production.\n\n## Hosting Requirements\n\n### Container-Based Sandboxing\n\nFor security and isolation, the SDK should run inside a **sandboxed container environment**. This provides:\n\n- **Process isolation** - Separate execution environment per session\n- **Resource limits** - CPU, memory, and storage constraints\n- **Network control** - Restrict outbound connections\n- **Ephemeral filesystems** - Clean state for each session\n\n### System Requirements\n\nEach SDK instance requires:\n\n- **Runtime dependencies**\n\n  - Python 3.10+ (for Python SDK) or Node.js 18+ (for TypeScript SDK)\n  - Node.js (required by Claude Code CLI)\n  - Claude Code CLI: `npm install -g @anthropic-ai/claude-code`\n\n- **Resource allocation**\n\n  - Recommended: 1GiB RAM, 5GiB of disk, and 1 CPU (vary this based on your task as needed)\n\n- **Network access**\n\n  - Outbound HTTPS to `api.anthropic.com`\n  - Optional: Access to MCP servers or external tools\n\n### Container Authentication\n\nAuthentication behaves differently depending on how you're using Claude Code:\n\n| Mode | `CLAUDE_CODE_OAUTH_TOKEN` | `ANTHROPIC_API_KEY` |\n|------|---------------------------|---------------------|\n| Agent SDK | â Works | â Works |\n| `claude --print \"...\"` | â Works | â Works |\n| Interactive CLI (`claude`) | â Requires manual login | â Requires manual login |\n\n**For SDK/programmatic usage** (the primary container use case):\n\n```bash\n# Generate a long-lived token (valid 1 year)\nclaude setup-token\n\n# Set in container environment\nexport CLAUDE_CODE_OAUTH_TOKEN=<token>\n# OR\nexport ANTHROPIC_API_KEY=<key>\n```\n\n**For interactive CLI in containers**: Even with tokens set, the interactive CLI (`claude` without `--print`) requires a one-time manual login via `claude login`. The login persists in `~/.claude/` and survives container restarts if that directory is mounted as a volume.\n\n## Understanding the SDK Architecture\n\nUnlike stateless API calls, the Claude Agent SDK operates as a **long-running process** that:\n\n- **Executes commands** in a persistent shell environment\n- **Manages file operations** within a working directory\n- **Handles tool execution** with context from previous interactions\n\n## Sandbox Provider Options\n\nSeveral providers specialize in secure container environments for AI code execution:\n\n- **[Cloudflare Sandboxes](https://github.com/cloudflare/sandbox-sdk)**\n- **[Modal Sandboxes](https://modal.com/docs/guide/sandbox)**\n- **[Daytona](https://www.daytona.io/)**\n- **[E2B](https://e2b.dev/)**\n- **[Fly Machines](https://fly.io/docs/machines/)**\n- **[Vercel Sandbox](https://vercel.com/docs/functions/sandbox)**\n\n## Production Deployment Patterns\n\n### Pattern 1: Ephemeral Sessions\n\nCreate a new container for each user task, then destroy it when complete.\n\nBest for one-off tasks, the user may still interact with the AI while the task is completing, but once completed the container is destroyed.\n\n**Examples:**\n\n- Bug Investigation & Fix: Debug and resolve a specific issue with relevant context\n- Invoice Processing: Extract and structure data from receipts/invoices for accounting systems\n- Translation Tasks: Translate documents or content batches between languages\n- Image/Video Processing: Apply transformations, optimizations, or extract metadata from media files\n\n### Pattern 2: Long-Running Sessions\n\nMaintain persistent container instances for long running tasks. Often times running *multiple* Claude Agent processes inside of the container based on demand.\n\nBest for proactive agents that take action without the users input, agents that serve content or agents that process high amounts of messages.\n\n**Examples:**\n\n- Email Agent: Monitors incoming emails and autonomously triages, responds, or takes actions based on content\n- Site Builder: Hosts custom websites per user with live editing capabilities served through container ports\n- High-Frequency Chat Bots: Handles continuous message streams from platforms like Slack where rapid response times are critical\n\n### Pattern 3: Hybrid Sessions\n\nEphemeral containers that are hydrated with history and state, possibly from a database or from the SDK's session resumption features.\n\nBest for containers with intermittent interaction from the user that kicks off work and spins down when the work is completed but can be continued.\n\n**Examples:**\n\n- Personal Project Manager: Helps manage ongoing projects with intermittent check-ins, maintains context of tasks, decisions, and progress\n- Deep Research: Conducts multi-hour research tasks, saves findings and resumes investigation when user returns\n- Customer Support Agent: Handles support tickets that span multiple interactions, loads ticket history and customer context\n\n### Pattern 4: Single Containers\n\nRun multiple Claude Agent SDK processes in one global container.\n\nBest for agents that must collaborate closely together. This is likely the least popular pattern because you will have to prevent agents from overwriting each other.\n\n**Examples:**\n\n- **Simulations**: Agents that interact with each other in simulations such as video games.\n\n# FAQ\n\n### How do I communicate with my sandboxes?\n\nWhen hosting in containers, expose ports to communicate with your SDK instances. Your application can expose HTTP/WebSocket endpoints for external clients while the SDK runs internally within the container.\n\n### What is the cost of hosting a container?\n\nWe have found that the dominant cost of serving agents is the tokens, containers vary based on what you provision but a minimum cost is roughly 5 cents per hour running.\n\n### When should I shut down idle containers vs. keeping them warm?\n\nThis is likely provider dependent, different sandbox providers will let you set different criteria for idle timeouts after which a sandbox might spin down. You will want to tune this timeout based on how frequent you think user response might be.\n\n### How often should I update the Claude Code CLI?\n\nThe Claude Code CLI is versioned with semver, so any breaking changes will be versioned.\n\n### How do I monitor container health and agent performance?\n\nSince containers are just servers the same logging infrastructure you use for the backend will work for containers.\n\n### How long can an agent session run before timing out?\n\nAn agent session will not timeout, but we recommend setting a 'maxTurns' property to prevent Claude from getting stuck in a loop.\n\n## Next Steps\n\n- [Sessions Guide](https://platform.claude.com/docs/en/agent-sdk/sessions) - Learn about session management\n- [Permissions](https://platform.claude.com/docs/en/agent-sdk/permissions) - Configure tool permissions\n- [Cost Tracking](https://platform.claude.com/docs/en/agent-sdk/cost-tracking) - Monitor API usage\n- [MCP Integration](https://platform.claude.com/docs/en/agent-sdk/mcp) - Extend with custom tools\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_mcp.md": "---\ntitle: MCP in the SDK\nsource_url: https://platform.claude.com/docs/en/agent-sdk/mcp\n---\n\n## Overview\n\nModel Context Protocol (MCP) servers extend Claude Code with custom tools and capabilities. MCPs can run as external processes, connect via HTTP/SSE, or execute directly within your SDK application.\n\n## Configuration\n\n### Basic Configuration\n\nConfigure MCP servers in `.mcp.json` at your project root:\n\n    {\n      \"mcpServers\": {\n        \"filesystem\": {\n          \"command\": \"npx\",\n          \"args\": [\"@modelcontextprotocol/server-filesystem\"],\n          \"env\": {\n            \"ALLOWED_PATHS\": \"/Users/me/projects\"\n          }\n        }\n      }\n    }\n\n### Using MCP Servers in SDK\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    for await (const message of query({\n      prompt: \"List files in my project\",\n      options: {\n        mcpServers: {\n          \"filesystem\": {\n            command: \"npx\",\n            args: [\"@modelcontextprotocol/server-filesystem\"],\n            env: {\n              ALLOWED_PATHS: \"/Users/me/projects\"\n            }\n          }\n        },\n        allowedTools: [\"mcp__filesystem__list_files\"]\n      }\n    })) {\n      if (message.type === \"result\" && message.subtype === \"success\") {\n        console.log(message.result);\n      }\n    }\n\n## Transport Types\n\n### stdio Servers\n\nExternal processes communicating via stdin/stdout:\n\n    // .mcp.json configuration\n    {\n      \"mcpServers\": {\n        \"my-tool\": {\n          \"command\": \"node\",\n          \"args\": [\"./my-mcp-server.js\"],\n          \"env\": {\n            \"DEBUG\": \"${DEBUG:-false}\"\n          }\n        }\n      }\n    }\n\n### HTTP/SSE Servers\n\nRemote servers with network communication:\n\n    // SSE server configuration\n    {\n      \"mcpServers\": {\n        \"remote-api\": {\n          \"type\": \"sse\",\n          \"url\": \"https://api.example.com/mcp/sse\",\n          \"headers\": {\n            \"Authorization\": \"Bearer ${API_TOKEN}\"\n          }\n        }\n      }\n    }\n\n    // HTTP server configuration\n    {\n      \"mcpServers\": {\n        \"http-service\": {\n          \"type\": \"http\",\n          \"url\": \"https://api.example.com/mcp\",\n          \"headers\": {\n            \"X-API-Key\": \"${API_KEY}\"\n          }\n        }\n      }\n    }\n\n### SDK MCP Servers\n\nIn-process servers running within your application. For detailed information on creating custom tools, see the [Custom Tools guide](https://platform.claude.com/docs/en/agent-sdk/custom-tools):\n\n## Resource Management\n\nMCP servers can expose resources that Claude can list and read:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // List available resources\n    for await (const message of query({\n      prompt: \"What resources are available from the database server?\",\n      options: {\n        mcpServers: {\n          \"database\": {\n            command: \"npx\",\n            args: [\"@modelcontextprotocol/server-database\"]\n          }\n        },\n        allowedTools: [\"mcp__list_resources\", \"mcp__read_resource\"]\n      }\n    })) {\n      if (message.type === \"result\") console.log(message.result);\n    }\n\n## Authentication\n\n### Environment Variables\n\n    // .mcp.json with environment variables\n    {\n      \"mcpServers\": {\n        \"secure-api\": {\n          \"type\": \"sse\",\n          \"url\": \"https://api.example.com/mcp\",\n          \"headers\": {\n            \"Authorization\": \"Bearer ${API_TOKEN}\",\n            \"X-API-Key\": \"${API_KEY:-default-key}\"\n          }\n        }\n      }\n    }\n\n    // Set environment variables\n    process.env.API_TOKEN = \"your-token\";\n    process.env.API_KEY = \"your-key\";\n\n### OAuth2 Authentication\n\nOAuth2 MCP authentication in-client is not currently supported.\n\n## Error Handling\n\nHandle MCP connection failures gracefully:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    for await (const message of query({\n      prompt: \"Process data\",\n      options: {\n        mcpServers: {\n          \"data-processor\": dataServer\n        }\n      }\n    })) {\n      if (message.type === \"system\" && message.subtype === \"init\") {\n        // Check MCP server status\n        const failedServers = message.mcp_servers.filter(\n          s => s.status !== \"connected\"\n        );\n\n        if (failedServers.length > 0) {\n          console.warn(\"Failed to connect:\", failedServers);\n        }\n      }\n\n      if (message.type === \"result\" && message.subtype === \"error_during_execution\") {\n        console.error(\"Execution failed\");\n      }\n    }\n\n## Related Resources\n\n- [Custom Tools Guide](https://platform.claude.com/docs/en/agent-sdk/custom-tools) - Detailed guide on creating SDK MCP servers\n- [TypeScript SDK Reference](https://platform.claude.com/docs/en/agent-sdk/typescript)\n- [Python SDK Reference](https://platform.claude.com/docs/en/agent-sdk/python)\n- [SDK Permissions](https://platform.claude.com/docs/en/agent-sdk/permissions)\n- [Common Workflows](https://code.claude.com/docs/en/common-workflows)\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_migration-guide.md": "---\ntitle: Migrate to Claude Agent SDK\nsource_url: https://platform.claude.com/docs/en/agent-sdk/migration-guide\n---\n\n## Overview\n\nThe Claude Code SDK has been renamed to the **Claude Agent SDK** and its documentation has been reorganized. This change reflects the SDK's broader capabilities for building AI agents beyond just coding tasks.\n\n## What's Changed\n\n| Aspect | Old | New |\n|----|----|----|\n| **Package Name (TS/JS)** | `@anthropic-ai/claude-code` | `@anthropic-ai/claude-agent-sdk` |\n| **Python Package** | `claude-code-sdk` | `claude-agent-sdk` |\n| **Documentation Location** | Claude Code docs | API Guide â Agent SDK section |\n\n**Documentation Changes:** The Agent SDK documentation has moved from the Claude Code docs to the API Guide under a dedicated [Agent SDK](https://platform.claude.com/docs/en/agent-sdk/overview) section. The Claude Code docs now focus on the CLI tool and automation features.\n\n## Migration Steps\n\n### For TypeScript/JavaScript Projects\n\n**1. Uninstall the old package:**\n\n    npm uninstall @anthropic-ai/claude-code\n\n**2. Install the new package:**\n\n    npm install @anthropic-ai/claude-agent-sdk\n\n**3. Update your imports:**\n\nChange all imports from `@anthropic-ai/claude-code` to `@anthropic-ai/claude-agent-sdk`:\n\n    // Before\n    import { query, tool, createSdkMcpServer } from \"@anthropic-ai/claude-code\";\n\n    // After\n    import {\n      query,\n      tool,\n      createSdkMcpServer,\n    } from \"@anthropic-ai/claude-agent-sdk\";\n\n**4. Update package.json dependencies:**\n\nIf you have the package listed in your `package.json`, update it:\n\n    // Before\n    {\n      \"dependencies\": {\n        \"@anthropic-ai/claude-code\": \"^1.0.0\"\n      }\n    }\n\n    // After\n    {\n      \"dependencies\": {\n        \"@anthropic-ai/claude-agent-sdk\": \"^0.1.0\"\n      }\n    }\n\nThat's it! No other code changes are required.\n\n### For Python Projects\n\n**1. Uninstall the old package:**\n\n    pip uninstall claude-code-sdk\n\n**2. Install the new package:**\n\n    pip install claude-agent-sdk\n\n**3. Update your imports:**\n\nChange all imports from `claude_code_sdk` to `claude_agent_sdk`:\n\n    # Before\n    from claude_code_sdk import query, ClaudeCodeOptions\n\n    # After\n    from claude_agent_sdk import query, ClaudeAgentOptions\n\n**4. Update type names:**\n\nChange `ClaudeCodeOptions` to `ClaudeAgentOptions`:\n\n    # Before\n    from claude_agent_sdk import query, ClaudeCodeOptions\n\n    options = ClaudeCodeOptions(\n        model=\"claude-sonnet-4-5\"\n    )\n\n    # After\n    from claude_agent_sdk import query, ClaudeAgentOptions\n\n    options = ClaudeAgentOptions(\n        model=\"claude-sonnet-4-5\"\n    )\n\n**5. Review [breaking changes](https://platform.claude.com/docs/en/agent-sdk/migration-guide#breaking-changes)**\n\nMake any code changes needed to complete the migration.\n\n## Breaking changes\n\nTo improve isolation and explicit configuration, Claude Agent SDK v0.1.0 introduces breaking changes for users migrating from Claude Code SDK. Review this section carefully before migrating.\n\n### Python: ClaudeCodeOptions renamed to ClaudeAgentOptions\n\n**What changed:** The Python SDK type `ClaudeCodeOptions` has been renamed to `ClaudeAgentOptions`.\n\n**Migration:**\n\n    # BEFORE (v0.0.x)\n    from claude_agent_sdk import query, ClaudeCodeOptions\n\n    options = ClaudeCodeOptions(\n        model=\"claude-sonnet-4-5\",\n        permission_mode=\"acceptEdits\"\n    )\n\n    # AFTER (v0.1.0)\n    from claude_agent_sdk import query, ClaudeAgentOptions\n\n    options = ClaudeAgentOptions(\n        model=\"claude-sonnet-4-5\",\n        permission_mode=\"acceptEdits\"\n    )\n\n**Why this changed:** The type name now matches the \"Claude Agent SDK\" branding and provides consistency across the SDK's naming conventions.\n\n### System prompt no longer default\n\n**What changed:** The SDK no longer uses Claude Code's system prompt by default.\n\n**Migration:**\n\n    // BEFORE (v0.0.x) - Used Claude Code's system prompt by default\n    const result = query({ prompt: \"Hello\" });\n\n    // AFTER (v0.1.0) - Uses empty system prompt by default\n    // To get the old behavior, explicitly request Claude Code's preset:\n    const result = query({\n      prompt: \"Hello\",\n      options: {\n        systemPrompt: { type: \"preset\", preset: \"claude_code\" }\n      }\n    });\n\n    // Or use a custom system prompt:\n    const result = query({\n      prompt: \"Hello\",\n      options: {\n        systemPrompt: \"You are a helpful coding assistant\"\n      }\n    });\n\n**Why this changed:** Provides better control and isolation for SDK applications. You can now build agents with custom behavior without inheriting Claude Code's CLI-focused instructions.\n\n### Settings Sources No Longer Loaded by Default\n\n**What changed:** The SDK no longer reads from filesystem settings (CLAUDE.md, settings.json, slash commands, etc.) by default.\n\n**Migration:**\n\n    // BEFORE (v0.0.x) - Loaded all settings automatically\n    const result = query({ prompt: \"Hello\" });\n    // Would read from:\n    // - ~/.claude/settings.json (user)\n    // - .claude/settings.json (project)\n    // - .claude/settings.local.json (local)\n    // - CLAUDE.md files\n    // - Custom slash commands\n\n    // AFTER (v0.1.0) - No settings loaded by default\n    // To get the old behavior:\n    const result = query({\n      prompt: \"Hello\",\n      options: {\n        settingSources: [\"user\", \"project\", \"local\"]\n      }\n    });\n\n    // Or load only specific sources:\n    const result = query({\n      prompt: \"Hello\",\n      options: {\n        settingSources: [\"project\"]  // Only project settings\n      }\n    });\n\n**Why this changed:** Ensures SDK applications have predictable behavior independent of local filesystem configurations. This is especially important for:\n\n- **CI/CD environments** - Consistent behavior without local customizations\n- **Deployed applications** - No dependency on filesystem settings\n- **Testing** - Isolated test environments\n- **Multi-tenant systems** - Prevent settings leakage between users\n\n**Backward compatibility:** If your application relied on filesystem settings (custom slash commands, CLAUDE.md instructions, etc.), add `settingSources: ['user', 'project', 'local']` to your options.\n\n## Why the Rename?\n\nThe Claude Code SDK was originally designed for coding tasks, but it has evolved into a powerful framework for building all types of AI agents. The new name \"Claude Agent SDK\" better reflects its capabilities:\n\n- Building business agents (legal assistants, finance advisors, customer support)\n- Creating specialized coding agents (SRE bots, security reviewers, code review agents)\n- Developing custom agents for any domain with tool use, MCP integration, and more\n\n## Getting Help\n\nIf you encounter any issues during migration:\n\n**For TypeScript/JavaScript:**\n\n1. Check that all imports are updated to use `@anthropic-ai/claude-agent-sdk`\n2. Verify your package.json has the new package name\n3. Run `npm install` to ensure dependencies are updated\n\n**For Python:**\n\n1. Check that all imports are updated to use `claude_agent_sdk`\n2. Verify your requirements.txt or pyproject.toml has the new package name\n3. Run `pip install claude-agent-sdk` to ensure the package is installed\n\n## Next Steps\n\n- Explore the [Agent SDK Overview](https://platform.claude.com/docs/en/agent-sdk/overview) to learn about available features\n- Check out the [TypeScript SDK Reference](https://platform.claude.com/docs/en/agent-sdk/typescript) for detailed API documentation\n- Review the [Python SDK Reference](https://platform.claude.com/docs/en/agent-sdk/python) for Python-specific documentation\n- Learn about [Custom Tools](https://platform.claude.com/docs/en/agent-sdk/custom-tools) and [MCP Integration](https://platform.claude.com/docs/en/agent-sdk/mcp)\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_modifying-system-prompts.md": "---\ntitle: Modifying system prompts\nsource_url: https://platform.claude.com/docs/en/agent-sdk/modifying-system-prompts\n---\n\nSystem prompts define Claude's behavior, capabilities, and response style. The Claude Agent SDK provides three ways to customize system prompts: using output styles (persistent, file-based configurations), appending to Claude Code's prompt, or using a fully custom prompt.\n\n## Understanding system prompts\n\nA system prompt is the initial instruction set that shapes how Claude behaves throughout a conversation.\n\n**Default behavior:** The Agent SDK uses an **empty system prompt** by default for maximum flexibility. To use Claude Code's system prompt (tool instructions, code guidelines, etc.), specify `systemPrompt: { preset: \"claude_code\" }` in TypeScript or `system_prompt=\"claude_code\"` in Python.\n\nClaude Code's system prompt includes:\n\n- Tool usage instructions and available tools\n- Code style and formatting guidelines\n- Response tone and verbosity settings\n- Security and safety instructions\n- Context about the current working directory and environment\n\n## Methods of modification\n\n### Method 1: CLAUDE.md files (project-level instructions)\n\nCLAUDE.md files provide project-specific context and instructions that are automatically read by the Agent SDK when it runs in a directory. They serve as persistent \"memory\" for your project.\n\n#### How CLAUDE.md works with the SDK\n\n**Location and discovery:**\n\n- **Project-level:** `CLAUDE.md` or `.claude/CLAUDE.md` in your working directory\n- **User-level:** `~/.claude/CLAUDE.md` for global instructions across all projects\n\n**IMPORTANT:** The SDK only reads CLAUDE.md files when you explicitly configure `settingSources` (TypeScript) or `setting_sources` (Python):\n\n- Include `'project'` to load project-level CLAUDE.md\n- Include `'user'` to load user-level CLAUDE.md (`~/.claude/CLAUDE.md`)\n\nThe `claude_code` system prompt preset does NOT automatically load CLAUDE.md - you must also specify setting sources.\n\n**Content format:** CLAUDE.md files use plain markdown and can contain:\n\n- Coding guidelines and standards\n- Project-specific context\n- Common commands or workflows\n- API conventions\n- Testing requirements\n\n#### Example CLAUDE.md\n\n    # Project Guidelines\n\n    ## Code Style\n\n    - Use TypeScript strict mode\n    - Prefer functional components in React\n    - Always include JSDoc comments for public APIs\n\n    ## Testing\n\n    - Run `npm test` before committing\n    - Maintain >80% code coverage\n    - Use jest for unit tests, playwright for E2E\n\n    ## Commands\n\n    - Build: `npm run build`\n    - Dev server: `npm run dev`\n    - Type check: `npm run typecheck`\n\n#### Using CLAUDE.md with the SDK\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // IMPORTANT: You must specify settingSources to load CLAUDE.md\n    // The claude_code preset alone does NOT load CLAUDE.md files\n    const messages = [];\n\n    for await (const message of query({\n      prompt: \"Add a new React component for user profiles\",\n      options: {\n        systemPrompt: {\n          type: \"preset\",\n          preset: \"claude_code\", // Use Claude Code's system prompt\n        },\n        settingSources: [\"project\"], // Required to load CLAUDE.md from project\n      },\n    })) {\n      messages.push(message);\n    }\n\n    // Now Claude has access to your project guidelines from CLAUDE.md\n\n#### When to use CLAUDE.md\n\n**Best for:**\n\n- **Team-shared context** - Guidelines everyone should follow\n- **Project conventions** - Coding standards, file structure, naming patterns\n- **Common commands** - Build, test, deploy commands specific to your project\n- **Long-term memory** - Context that should persist across all sessions\n- **Version-controlled instructions** - Commit to git so the team stays in sync\n\n**Key characteristics:**\n\n- â Persistent across all sessions in a project\n- â Shared with team via git\n- â Automatic discovery (no code changes needed)\n- â ï¸ Requires loading settings via `settingSources`\n\n### Method 2: Output styles (persistent configurations)\n\nOutput styles are saved configurations that modify Claude's system prompt. They're stored as markdown files and can be reused across sessions and projects.\n\n#### Creating an output style\n\n    import { writeFile, mkdir } from \"fs/promises\";\n    import { join } from \"path\";\n    import { homedir } from \"os\";\n\n    async function createOutputStyle(\n      name: string,\n      description: string,\n      prompt: string\n    ) {\n      // User-level: ~/.claude/output-styles\n      // Project-level: .claude/output-styles\n      const outputStylesDir = join(homedir(), \".claude\", \"output-styles\");\n\n      await mkdir(outputStylesDir, { recursive: true });\n\n      const content = `---\n    name: ${name}\n    description: ${description}\n    ---\n\n    ${prompt}`;\n\n      const filePath = join(\n        outputStylesDir,\n        `${name.toLowerCase().replace(/\\s+/g, \"-\")}.md`\n      );\n      await writeFile(filePath, content, \"utf-8\");\n    }\n\n    // Example: Create a code review specialist\n    await createOutputStyle(\n      \"Code Reviewer\",\n      \"Thorough code review assistant\",\n      `You are an expert code reviewer.\n\n    For every code submission:\n    1. Check for bugs and security issues\n    2. Evaluate performance\n    3. Suggest improvements\n    4. Rate code quality (1-10)`\n    );\n\n#### Using output styles\n\nOnce created, activate output styles via:\n\n- **CLI**: `/output-style [style-name]`\n- **Settings**: `.claude/settings.local.json`\n- **Create new**: `/output-style:new [description]`\n\n**Note for SDK users:** Output styles are loaded when you include `settingSources: ['user']` or `settingSources: ['project']` (TypeScript) / `setting_sources=[\"user\"]` or `setting_sources=[\"project\"]` (Python) in your options.\n\n### Method 3: Using `systemPrompt` with append\n\nYou can use the Claude Code preset with an `append` property to add your custom instructions while preserving all built-in functionality.\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    const messages = [];\n\n    for await (const message of query({\n      prompt: \"Help me write a Python function to calculate fibonacci numbers\",\n      options: {\n        systemPrompt: {\n          type: \"preset\",\n          preset: \"claude_code\",\n          append:\n            \"Always include detailed docstrings and type hints in Python code.\",\n        },\n      },\n    })) {\n      messages.push(message);\n      if (message.type === \"assistant\") {\n        console.log(message.message.content);\n      }\n    }\n\n### Method 4: Custom system prompts\n\nYou can provide a custom string as `systemPrompt` to replace the default entirely with your own instructions.\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    const customPrompt = `You are a Python coding specialist.\n    Follow these guidelines:\n    - Write clean, well-documented code\n    - Use type hints for all functions\n    - Include comprehensive docstrings\n    - Prefer functional programming patterns when appropriate\n    - Always explain your code choices`;\n\n    const messages = [];\n\n    for await (const message of query({\n      prompt: \"Create a data processing pipeline\",\n      options: {\n        systemPrompt: customPrompt,\n      },\n    })) {\n      messages.push(message);\n      if (message.type === \"assistant\") {\n        console.log(message.message.content);\n      }\n    }\n\n## Comparison of all four approaches\n\n| Feature | CLAUDE.md | Output Styles | `systemPrompt` with append | Custom `systemPrompt` |\n|----|----|----|----|----|\n| **Persistence** | Per-project file | Saved as files | Session only | Session only |\n| **Reusability** | Per-project | Across projects | Code duplication | Code duplication |\n| **Management** | On filesystem | CLI + files | In code | In code |\n| **Default tools** | Preserved | Preserved | Preserved | Lost (unless included) |\n| **Built-in safety** | Maintained | Maintained | Maintained | Must be added |\n| **Environment context** | Automatic | Automatic | Automatic | Must be provided |\n| **Customization level** | Additions only | Replace default | Additions only | Complete control |\n| **Version control** | With project | Yes | With code | With code |\n| **Scope** | Project-specific | User or project | Code session | Code session |\n\n**Note:** \"With append\" means using `systemPrompt: { type: \"preset\", preset: \"claude_code\", append: \"...\" }` in TypeScript or `system_prompt={\"type\": \"preset\", \"preset\": \"claude_code\", \"append\": \"...\"}` in Python.\n\n## Use cases and best practices\n\n### When to use CLAUDE.md\n\n**Best for:**\n\n- Project-specific coding standards and conventions\n- Documenting project structure and architecture\n- Listing common commands (build, test, deploy)\n- Team-shared context that should be version controlled\n- Instructions that apply to all SDK usage in a project\n\n**Examples:**\n\n- \"All API endpoints should use async/await patterns\"\n- \"Run `npm run lint:fix` before committing\"\n- \"Database migrations are in the `migrations/` directory\"\n\n**Important:** To load CLAUDE.md files, you must explicitly set `settingSources: ['project']` (TypeScript) or `setting_sources=[\"project\"]` (Python). The `claude_code` system prompt preset does NOT automatically load CLAUDE.md without this setting.\n\n### When to use output styles\n\n**Best for:**\n\n- Persistent behavior changes across sessions\n- Team-shared configurations\n- Specialized assistants (code reviewer, data scientist, DevOps)\n- Complex prompt modifications that need versioning\n\n**Examples:**\n\n- Creating a dedicated SQL optimization assistant\n- Building a security-focused code reviewer\n- Developing a teaching assistant with specific pedagogy\n\n### When to use `systemPrompt` with append\n\n**Best for:**\n\n- Adding specific coding standards or preferences\n- Customizing output formatting\n- Adding domain-specific knowledge\n- Modifying response verbosity\n- Enhancing Claude Code's default behavior without losing tool instructions\n\n### When to use custom `systemPrompt`\n\n**Best for:**\n\n- Complete control over Claude's behavior\n- Specialized single-session tasks\n- Testing new prompt strategies\n- Situations where default tools aren't needed\n- Building specialized agents with unique behavior\n\n## Combining approaches\n\nYou can combine these methods for maximum flexibility:\n\n### Example: Output style with session-specific additions\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Assuming \"Code Reviewer\" output style is active (via /output-style)\n    // Add session-specific focus areas\n    const messages = [];\n\n    for await (const message of query({\n      prompt: \"Review this authentication module\",\n      options: {\n        systemPrompt: {\n          type: \"preset\",\n          preset: \"claude_code\",\n          append: `\n            For this review, prioritize:\n            - OAuth 2.0 compliance\n            - Token storage security\n            - Session management\n          `,\n        },\n      },\n    })) {\n      messages.push(message);\n    }\n\n## See also\n\n- [Output styles](https://code.claude.com/docs/en/output-styles) - Complete output styles documentation\n- [TypeScript SDK guide](https://platform.claude.com/docs/en/agent-sdk/typescript) - Complete SDK usage guide\n- [Configuration guide](https://code.claude.com/docs/en/settings) - General configuration options\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_overview.md": "---\ntitle: Agent SDK overview\nsource_url: https://platform.claude.com/docs/en/agent-sdk/overview\n---\n\nThe Claude Code SDK has been renamed to the **Claude Agent SDK**. If you're migrating from the old SDK, see the [Migration Guide](https://platform.claude.com/docs/en/agent-sdk/migration-guide).\n\n## Installation\n\n    npm install @anthropic-ai/claude-agent-sdk\n\n## SDK Options\n\nThe Claude Agent SDK is available in multiple forms to suit different use cases:\n\n- **[TypeScript SDK](https://platform.claude.com/docs/en/agent-sdk/typescript)** - For Node.js and web applications\n- **[Python SDK](https://platform.claude.com/docs/en/agent-sdk/python)** - For Python applications and data science\n- **[Streaming vs Single Mode](https://platform.claude.com/docs/en/agent-sdk/streaming-vs-single-mode)** - Understanding input modes and best practices\n\n## Why use the Claude Agent SDK?\n\nBuilt on top of the agent harness that powers Claude Code, the Claude Agent SDK provides all the building blocks you need to build production-ready agents.\n\nTaking advantage of the work we've done on Claude Code including:\n\n- **Context Management**: Automatic compaction and context management to ensure your agent doesn't run out of context.\n- **Rich tool ecosystem**: File operations, code execution, web search, and MCP extensibility\n- **Advanced permissions**: Fine-grained control over agent capabilities\n- **Production essentials**: Built-in error handling, session management, and monitoring\n- **Optimized Claude integration**: Automatic prompt caching and performance optimizations\n\n## What can you build with the SDK?\n\nHere are some example agent types you can create:\n\n**Coding agents:**\n\n- SRE agents that diagnose and fix production issues\n- Security review bots that audit code for vulnerabilities\n- Oncall engineering assistants that triage incidents\n- Code review agents that enforce style and best practices\n\n**Business agents:**\n\n- Legal assistants that review contracts and compliance\n- Finance advisors that analyze reports and forecasts\n- Customer support agents that resolve technical issues\n- Content creation assistants for marketing teams\n\n## Core Concepts\n\n### Authentication\n\nThe SDK supports several authentication methods:\n\n**CLI Authentication (Recommended for Local Development):**\nIf the Claude Code CLI (`claude`) is already authenticated on your machine, the SDK will automatically use those credentialsâno additional configuration needed.\n\n**OAuth Token:**\nFor programmatic access or CI/CD environments, generate a long-lived OAuth token:\n\n```bash\nclaude setup-token\n```\n\nThis provides a token valid for 1 year. Store it securely and set:\n\n```bash\nexport CLAUDE_CODE_OAUTH_TOKEN=<token>\n```\n\n**API Key:**\nRetrieve an API key from the [Claude Console](https://platform.claude.com/) and set:\n\n```bash\nexport ANTHROPIC_API_KEY=<key>\n```\n\n**Third-Party Providers:**\n- **Amazon Bedrock**: Set `CLAUDE_CODE_USE_BEDROCK=1` environment variable and configure AWS credentials\n- **Google Vertex AI**: Set `CLAUDE_CODE_USE_VERTEX=1` environment variable and configure Google Cloud credentials\n\nFor detailed configuration instructions for third-party providers, see the [Amazon Bedrock](https://code.claude.com/docs/en/amazon-bedrock) and [Google Vertex AI](https://code.claude.com/docs/en/google-vertex-ai) documentation.\n\nUnless previously approved, we do not allow third party developers to apply Claude.ai rate limits for their products, including agents built on the Claude Agent SDK. Please use the API key authentication methods described in this document instead.\n\n### Full Claude Code Feature Support\n\nThe SDK provides access to all the default features available in Claude Code, leveraging the same file system-based configuration:\n\n- **Subagents**: Launch specialized agents stored as Markdown files in `./.claude/agents/`\n- **Agent Skills**: Extend Claude with specialized capabilities stored as `SKILL.md` files in `./.claude/skills/`\n- **Hooks**: Execute custom commands configured in `./.claude/settings.json` that respond to tool events\n- **Slash Commands**: Use custom commands defined as Markdown files in `./.claude/commands/`\n- **Plugins**: Load custom plugins programmatically using the `plugins` option to extend Claude Code with custom commands, agents, skills, hooks, and MCP servers. See [Plugins](https://platform.claude.com/docs/en/agent-sdk/plugins) for details.\n- **Memory (CLAUDE.md)**: Maintain project context through `CLAUDE.md` or `.claude/CLAUDE.md` files in your project directory, or `~/.claude/CLAUDE.md` for user-level instructions. To load these files, you must explicitly set `settingSources: ['project']` (TypeScript) or `setting_sources=[\"project\"]` (Python) in your options. See [Modifying system prompts](https://platform.claude.com/docs/en/agent-sdk/modifying-system-prompts#method-1-claudemd-files-project-level-instructions) for details.\n\nThese features work identically to their Claude Code counterparts by reading from the same file system locations.\n\n### System Prompts\n\nSystem prompts define your agent's role, expertise, and behavior. This is where you specify what kind of agent you're building.\n\n### Tool Permissions\n\nControl which tools your agent can use with fine-grained permissions:\n\n- `allowedTools` - Explicitly allow specific tools\n- `disallowedTools` - Block specific tools\n- `permissionMode` - Set overall permission strategy\n\n### Model Context Protocol (MCP)\n\nExtend your agents with custom tools and integrations through MCP servers. This allows you to connect to databases, APIs, and other external services.\n\n## Building with the Claude Agent SDK\n\nIf you're building coding agents powered by the Claude Agent SDK, please note that **Claude Code** refers specifically to Anthropic's official product including the CLI, VS Code extension, web experience, and future integrations we build.\n\n### For partners integrating Claude Agent SDK\n\nThe use of Claude branding for products built on Claude is optional.\n\nWhen referencing Claude in your agent selector or product:\n\n**Allowed naming options:**\n\n- **Claude Agent** (preferred for dropdown menus)\n- **Claude** (when within a menu already labeled \"Agents\")\n- **{YourAgentName} Powered by Claude** (if you have an existing agent name)\n\n**Not permitted:**\n\n- \"Claude Code\" or \"Claude Code Agent\"\n- Claude Code-branded ASCII art or visual elements that mimic Claude Code\n\nYour product should maintain its own branding and not appear to be Claude Code or any Anthropic product.\n\nFor questions about branding compliance or to discuss your product's Claude integration, [contact our sales team](https://claude.com/contact-sales).\n\n## Reporting Bugs\n\nIf you encounter bugs or issues with the Agent SDK:\n\n- **TypeScript SDK**: [Report issues on GitHub](https://github.com/anthropics/claude-agent-sdk-typescript/issues)\n- **Python SDK**: [Report issues on GitHub](https://github.com/anthropics/claude-agent-sdk-python/issues)\n\n## Changelog\n\nView the full changelog for SDK updates, bug fixes, and new features:\n\n- **TypeScript SDK**: [View CHANGELOG.md](https://github.com/anthropics/claude-agent-sdk-typescript/blob/main/CHANGELOG.md)\n- **Python SDK**: [View CHANGELOG.md](https://github.com/anthropics/claude-agent-sdk-python/blob/main/CHANGELOG.md)\n\n## Related Resources\n\n- [CLI Reference](https://code.claude.com/docs/en/cli-reference) - Complete CLI documentation\n- [GitHub Actions Integration](https://code.claude.com/docs/en/github-actions) - Automate your GitHub workflow\n- [MCP Documentation](https://code.claude.com/docs/en/mcp) - Extend Claude with custom tools\n- [Common Workflows](https://code.claude.com/docs/en/common-workflows) - Step-by-step guides\n- [Troubleshooting](https://code.claude.com/docs/en/troubleshooting) - Common issues and solutions\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_permissions.md": "---\ntitle: Handling Permissions\nsource_url: https://platform.claude.com/docs/en/agent-sdk/permissions\n---\n\n# SDK Permissions\n\nThe Claude Agent SDK provides powerful permission controls that allow you to manage how Claude uses tools in your application.\n\nThis guide covers how to implement permission systems using the `canUseTool` callback, hooks, and settings.json permission rules. For complete API documentation, see the [TypeScript SDK reference](https://platform.claude.com/docs/en/agent-sdk/typescript).\n\n## Overview\n\nThe Claude Agent SDK provides four complementary ways to control tool usage:\n\n1. **[Permission Modes](https://platform.claude.com/docs/en/agent-sdk/permissions#permission-modes)** - Global permission behavior settings that affect all tools\n2. **[canUseTool callback](https://platform.claude.com/docs/en/agent-sdk/typescript#canusetool)** - Runtime permission handler for cases not covered by other rules\n3. **[Hooks](https://platform.claude.com/docs/en/agent-sdk/typescript#hook-types)** - Fine-grained control over every tool execution with custom logic\n4. **[Permission rules (settings.json)](https://code.claude.com/docs/en/settings#permission-settings)** - Declarative allow/deny rules with integrated bash command parsing\n\nUse cases for each approach:\n\n- Permission modes - Set overall permission behavior (planning, auto-accepting edits, bypassing checks)\n- `canUseTool` - Dynamic approval for uncovered cases, prompts user for permission\n- Hooks - Programmatic control over all tool executions\n- Permission rules - Static policies with intelligent bash command parsing\n\n## Permission Flow Diagram\n\n    %%{init: {\"theme\": \"base\", \"themeVariables\": {\"edgeLabelBackground\": \"#F0F0EB\", \"lineColor\": \"#91918D\"}, \"flowchart\": {\"edgeLabelMarginX\": 12, \"edgeLabelMarginY\": 8}}}%%\n    flowchart TD\n        Start([Tool request]) --> PreHook(PreToolUse Hook)\n\n        PreHook -->|&nbsp;&nbsp;Allow&nbsp;&nbsp;| Execute(Execute Tool)\n        PreHook -->|&nbsp;&nbsp;Deny&nbsp;&nbsp;| Denied(Denied)\n        PreHook -->|&nbsp;&nbsp;Ask&nbsp;&nbsp;| Callback(canUseTool Callback)\n        PreHook -->|&nbsp;&nbsp;Continue&nbsp;&nbsp;| Deny(Check Deny Rules)\n\n        Deny -->|&nbsp;&nbsp;Match&nbsp;&nbsp;| Denied\n        Deny -->|&nbsp;&nbsp;No Match&nbsp;&nbsp;| Allow(Check Allow Rules)\n\n        Allow -->|&nbsp;&nbsp;Match&nbsp;&nbsp;| Execute\n        Allow -->|&nbsp;&nbsp;No Match&nbsp;&nbsp;| Ask(Check Ask Rules)\n\n        Ask -->|&nbsp;&nbsp;Match&nbsp;&nbsp;| Callback\n        Ask -->|&nbsp;&nbsp;No Match&nbsp;&nbsp;| Mode{Permission Mode?}\n\n        Mode -->|&nbsp;&nbsp;bypassPermissions&nbsp;&nbsp;| Execute\n        Mode -->|&nbsp;&nbsp;Other modes&nbsp;&nbsp;| Callback\n\n        Callback -->|&nbsp;&nbsp;Allow&nbsp;&nbsp;| Execute\n        Callback -->|&nbsp;&nbsp;Deny&nbsp;&nbsp;| Denied\n\n        Denied --> DeniedResponse([Feedback to agent])\n\n        Execute --> PostHook(PostToolUse Hook)\n        PostHook --> Done([Tool Response])\n\n        style Start fill:#F0F0EB,stroke:#D9D8D5,color:#191919\n\n        style Denied fill:#BF4D43,color:#fff\n        style DeniedResponse fill:#BF4D43,color:#fff\n        style Execute fill:#DAAF91,color:#191919\n        style Done fill:#DAAF91,color:#191919\n\n        classDef hookClass fill:#CC785C,color:#fff\n        class PreHook,PostHook hookClass\n\n        classDef ruleClass fill:#EBDBBC,color:#191919\n        class Deny,Allow,Ask ruleClass\n\n        classDef modeClass fill:#A8DAEF,color:#191919\n        class Mode modeClass\n\n        classDef callbackClass fill:#D4A27F,color:#191919\n        class Callback callbackClass\n\n**Processing Order:** PreToolUse Hook â Deny Rules â Allow Rules â Ask Rules â Permission Mode Check â canUseTool Callback â PostToolUse Hook\n\n## Permission Modes\n\nPermission modes provide global control over how Claude uses tools. You can set the permission mode when calling `query()` or change it dynamically during streaming sessions.\n\n### Available Modes\n\nThe SDK supports four permission modes, each with different behavior:\n\n| Mode | Description | Tool Behavior |\n|----|----|----|\n| `default` | Standard permission behavior | Normal permission checks apply |\n| `plan` | Planning mode - no execution | Claude can only use read-only tools; presents a plan before execution **(Not currently supported in SDK)** |\n| `acceptEdits` | Auto-accept file edits | File edits and filesystem operations are automatically approved |\n| `bypassPermissions` | Bypass all permission checks | All tools run without permission prompts (use with caution) |\n\n### Setting Permission Mode\n\nYou can set the permission mode in two ways:\n\n#### 1\\. Initial Configuration\n\nSet the mode when creating a query:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    const result = await query({\n      prompt: \"Help me refactor this code\",\n      options: {\n        permissionMode: 'default'  // Standard permission mode\n      }\n    });\n\n#### 2\\. Dynamic Mode Changes (Streaming Only)\n\nChange the mode during a streaming session:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Create an async generator for streaming input\n    async function* streamInput() {\n      yield { \n        type: 'user',\n        message: { \n          role: 'user', \n          content: \"Let's start with default permissions\" \n        }\n      };\n\n      // Later in the conversation...\n      yield {\n        type: 'user',\n        message: {\n          role: 'user',\n          content: \"Now let's speed up development\"\n        }\n      };\n    }\n\n    const q = query({\n      prompt: streamInput(),\n      options: {\n        permissionMode: 'default'  // Start in default mode\n      }\n    });\n\n    // Change mode dynamically\n    await q.setPermissionMode('acceptEdits');\n\n    // Process messages\n    for await (const message of q) {\n      console.log(message);\n    }\n\n### Mode-Specific Behaviors\n\n#### Accept Edits Mode (`acceptEdits`)\n\nIn accept edits mode:\n\n- All file edits are automatically approved\n- Filesystem operations (mkdir, touch, rm, etc.) are auto-approved\n- Other tools still require normal permissions\n- Speeds up development when you trust Claude's edits\n- Useful for rapid prototyping and iterations\n\nAuto-approved operations:\n\n- File edits (Edit, Write tools)\n- Bash filesystem commands (mkdir, touch, rm, mv, cp)\n- File creation and deletion\n\n#### Bypass Permissions Mode (`bypassPermissions`)\n\nIn bypass permissions mode:\n\n- **ALL tool uses are automatically approved**\n- No permission prompts appear\n- Hooks still execute (can still block operations)\n- **Use with extreme caution** - Claude has full system access\n- Recommended only for controlled environments\n\n### Mode Priority in Permission Flow\n\nPermission modes are evaluated at a specific point in the permission flow:\n\n1. **Hooks execute first** - Can allow, deny, ask, or continue\n2. **Deny rules** are checked - Block tools regardless of mode\n3. **Allow rules** are checked - Permit tools if matched\n4. **Ask rules** are checked - Prompt for permission if matched\n5. **Permission mode** is evaluated:\n    - **`bypassPermissions` mode** - If active, allows all remaining tools\n    - **Other modes** - Defer to `canUseTool` callback\n6. **`canUseTool` callback** - Handles remaining cases\n\nThis means:\n\n- Hooks can always control tool use, even in `bypassPermissions` mode\n- Explicit deny rules override all permission modes\n- Ask rules are evaluated before permission modes\n- `bypassPermissions` mode overrides the `canUseTool` callback for unmatched tools\n\n### Best Practices\n\n1. **Use default mode** for controlled execution with normal permission checks\n2. **Use acceptEdits mode** when working on isolated files or directories\n3. **Avoid bypassPermissions** in production or on systems with sensitive data\n4. **Combine modes with hooks** for fine-grained control\n5. **Switch modes dynamically** based on task progress and confidence\n\nExample of mode progression:\n\n    // Start in default mode for controlled execution\n    permissionMode: 'default'\n\n    // Switch to acceptEdits for rapid iteration\n    await q.setPermissionMode('acceptEdits')\n\n## canUseTool\n\nThe `canUseTool` callback is passed as an option when calling the `query` function. It receives the tool name and input parameters, and must return a decision- either allow or deny.\n\ncanUseTool fires whenever Claude Code would show a permission prompt to a user, e.g. hooks and permission rules do not cover it and it is not in acceptEdits mode.\n\nHere's a complete example showing how to implement interactive tool approval:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    async function promptForToolApproval(toolName: string, input: any) {\n      console.log(\"\\nð§ Tool Request:\");\n      console.log(`   Tool: ${toolName}`);\n\n      // Display tool parameters\n      if (input && Object.keys(input).length > 0) {\n        console.log(\"   Parameters:\");\n        for (const [key, value] of Object.entries(input)) {\n          let displayValue = value;\n          if (typeof value === 'string' && value.length > 100) {\n            displayValue = value.substring(0, 100) + \"...\";\n          } else if (typeof value === 'object') {\n            displayValue = JSON.stringify(value, null, 2);\n          }\n          console.log(`     ${key}: ${displayValue}`);\n        }\n      }\n\n      // Get user approval (replace with your UI logic)\n      const approved = await getUserApproval();\n\n      if (approved) {\n        console.log(\"   â Approved\\n\");\n        return {\n          behavior: \"allow\",\n          updatedInput: input\n        };\n      } else {\n        console.log(\"   â Denied\\n\");\n        return {\n          behavior: \"deny\",\n          message: \"User denied permission for this tool\"\n        };\n      }\n    }\n\n    // Use the permission callback\n    const result = await query({\n      prompt: \"Help me analyze this codebase\",\n      options: {\n        canUseTool: async (toolName, input) => {\n          return promptForToolApproval(toolName, input);\n        }\n      }\n    });\n\n## Related Resources\n\n- [Hooks Guide](https://code.claude.com/docs/en/hooks-guide) - Learn how to implement hooks for fine-grained control over tool execution\n- [Settings: Permission Rules](https://code.claude.com/docs/en/settings#permission-settings) - Configure declarative allow/deny rules with bash command parsing\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_plugins.md": "---\ntitle: Plugins in the SDK\nsource_url: https://platform.claude.com/docs/en/agent-sdk/plugins\n---\n\nPlugins allow you to extend Claude Code with custom functionality that can be shared across projects. Through the Agent SDK, you can programmatically load plugins from local directories to add custom slash commands, agents, skills, hooks, and MCP servers to your agent sessions.\n\n## What are plugins?\n\nPlugins are packages of Claude Code extensions that can include:\n\n- **Commands**: Custom slash commands\n- **Agents**: Specialized subagents for specific tasks\n- **Skills**: Model-invoked capabilities that Claude uses autonomously\n- **Hooks**: Event handlers that respond to tool use and other events\n- **MCP servers**: External tool integrations via Model Context Protocol\n\nFor complete information on plugin structure and how to create plugins, see [Plugins](https://code.claude.com/docs/en/plugins).\n\n## Loading plugins\n\nLoad plugins by providing their local file system paths in your options configuration. The SDK supports loading multiple plugins from different locations.\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    for await (const message of query({\n      prompt: \"Hello\",\n      options: {\n        plugins: [\n          { type: \"local\", path: \"./my-plugin\" },\n          { type: \"local\", path: \"/absolute/path/to/another-plugin\" }\n        ]\n      }\n    })) {\n      // Plugin commands, agents, and other features are now available\n    }\n\n### Path specifications\n\nPlugin paths can be:\n\n- **Relative paths**: Resolved relative to your current working directory (e.g., `\"./plugins/my-plugin\"`)\n- **Absolute paths**: Full file system paths (e.g., `\"/home/user/plugins/my-plugin\"`)\n\nThe path should point to the plugin's root directory (the directory containing `.claude-plugin/plugin.json`).\n\n## Verifying plugin installation\n\nWhen plugins load successfully, they appear in the system initialization message. You can verify that your plugins are available:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    for await (const message of query({\n      prompt: \"Hello\",\n      options: {\n        plugins: [{ type: \"local\", path: \"./my-plugin\" }]\n      }\n    })) {\n      if (message.type === \"system\" && message.subtype === \"init\") {\n        // Check loaded plugins\n        console.log(\"Plugins:\", message.plugins);\n        // Example: [{ name: \"my-plugin\", path: \"./my-plugin\" }]\n\n        // Check available commands from plugins\n        console.log(\"Commands:\", message.slash_commands);\n        // Example: [\"/help\", \"/compact\", \"my-plugin:custom-command\"]\n      }\n    }\n\n## Using plugin commands\n\nCommands from plugins are automatically namespaced with the plugin name to avoid conflicts. The format is `plugin-name:command-name`.\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Load a plugin with a custom /greet command\n    for await (const message of query({\n      prompt: \"/my-plugin:greet\",  // Use plugin command with namespace\n      options: {\n        plugins: [{ type: \"local\", path: \"./my-plugin\" }]\n      }\n    })) {\n      // Claude executes the custom greeting command from the plugin\n      if (message.type === \"assistant\") {\n        console.log(message.content);\n      }\n    }\n\nIf you installed a plugin via the CLI (e.g., `/plugin install my-plugin@marketplace`), you can still use it in the SDK by providing its installation path. Check `~/.claude/plugins/` for CLI-installed plugins.\n\n## Complete example\n\nHere's a full example demonstrating plugin loading and usage:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n    import * as path from \"path\";\n\n    async function runWithPlugin() {\n      const pluginPath = path.join(__dirname, \"plugins\", \"my-plugin\");\n\n      console.log(\"Loading plugin from:\", pluginPath);\n\n      for await (const message of query({\n        prompt: \"What custom commands do you have available?\",\n        options: {\n          plugins: [\n            { type: \"local\", path: pluginPath }\n          ],\n          maxTurns: 3\n        }\n      })) {\n        if (message.type === \"system\" && message.subtype === \"init\") {\n          console.log(\"Loaded plugins:\", message.plugins);\n          console.log(\"Available commands:\", message.slash_commands);\n        }\n\n        if (message.type === \"assistant\") {\n          console.log(\"Assistant:\", message.content);\n        }\n      }\n    }\n\n    runWithPlugin().catch(console.error);\n\n## Plugin structure reference\n\nA plugin directory must contain a `.claude-plugin/plugin.json` manifest file. It can optionally include:\n\n    my-plugin/\n    âââ .claude-plugin/\n    â   âââ plugin.json          # Required: plugin manifest\n    âââ commands/                 # Custom slash commands\n    â   âââ custom-cmd.md\n    âââ agents/                   # Custom agents\n    â   âââ specialist.md\n    âââ skills/                   # Agent Skills\n    â   âââ my-skill/\n    â       âââ SKILL.md\n    âââ hooks/                    # Event handlers\n    â   âââ hooks.json\n    âââ .mcp.json                # MCP server definitions\n\nFor detailed information on creating plugins, see:\n\n- [Plugins](https://code.claude.com/docs/en/plugins) - Complete plugin development guide\n- [Plugins reference](https://code.claude.com/docs/en/plugins-reference) - Technical specifications and schemas\n\n## Common use cases\n\n### Development and testing\n\nLoad plugins during development without installing them globally:\n\n    plugins: [\n      { type: \"local\", path: \"./dev-plugins/my-plugin\" }\n    ]\n\n### Project-specific extensions\n\nInclude plugins in your project repository for team-wide consistency:\n\n    plugins: [\n      { type: \"local\", path: \"./project-plugins/team-workflows\" }\n    ]\n\n### Multiple plugin sources\n\nCombine plugins from different locations:\n\n    plugins: [\n      { type: \"local\", path: \"./local-plugin\" },\n      { type: \"local\", path: \"~/.claude/custom-plugins/shared-plugin\" }\n    ]\n\n## Troubleshooting\n\n### Plugin not loading\n\nIf your plugin doesn't appear in the init message:\n\n1. **Check the path**: Ensure the path points to the plugin root directory (containing `.claude-plugin/`)\n2. **Validate plugin.json**: Ensure your manifest file has valid JSON syntax\n3. **Check file permissions**: Ensure the plugin directory is readable\n\n### Commands not available\n\nIf plugin commands don't work:\n\n1. **Use the namespace**: Plugin commands require the `plugin-name:command-name` format\n2. **Check init message**: Verify the command appears in `slash_commands` with the correct namespace\n3. **Validate command files**: Ensure command markdown files are in the `commands/` directory\n\n### Path resolution issues\n\nIf relative paths don't work:\n\n1. **Check working directory**: Relative paths are resolved from your current working directory\n2. **Use absolute paths**: For reliability, consider using absolute paths\n3. **Normalize paths**: Use path utilities to construct paths correctly\n\n## See also\n\n- [Plugins](https://code.claude.com/docs/en/plugins) - Complete plugin development guide\n- [Plugins reference](https://code.claude.com/docs/en/plugins-reference) - Technical specifications\n- [Slash Commands](https://platform.claude.com/docs/en/agent-sdk/slash-commands) - Using slash commands in the SDK\n- [Subagents](https://platform.claude.com/docs/en/agent-sdk/subagents) - Working with specialized agents\n- [Skills](https://platform.claude.com/docs/en/agent-sdk/skills) - Using Agent Skills\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_python.md": "---\ntitle: Agent SDK reference - Python\nsource_url: https://platform.claude.com/docs/en/agent-sdk/python\n---\n\n## Installation\n\n    pip install claude-agent-sdk\n\n## Choosing Between `query()` and `ClaudeSDKClient`\n\nThe Python SDK provides two ways to interact with Claude Code:\n\n### Quick Comparison\n\n| Feature | `query()` | `ClaudeSDKClient` |\n|----|----|----|\n| **Session** | Creates new session each time | Reuses same session |\n| **Conversation** | Single exchange | Multiple exchanges in same context |\n| **Connection** | Managed automatically | Manual control |\n| **Streaming Input** | â Supported | â Supported |\n| **Interrupts** | â Not supported | â Supported |\n| **Hooks** | â Not supported | â Supported |\n| **Custom Tools** | â Not supported | â Supported |\n| **Continue Chat** | â New session each time | â Maintains conversation |\n| **Use Case** | One-off tasks | Continuous conversations |\n\n### When to Use `query()` (New Session Each Time)\n\n**Best for:**\n\n- One-off questions where you don't need conversation history\n- Independent tasks that don't require context from previous exchanges\n- Simple automation scripts\n- When you want a fresh start each time\n\n### When to Use `ClaudeSDKClient` (Continuous Conversation)\n\n**Best for:**\n\n- **Continuing conversations** - When you need Claude to remember context\n- **Follow-up questions** - Building on previous responses\n- **Interactive applications** - Chat interfaces, REPLs\n- **Response-driven logic** - When next action depends on Claude's response\n- **Session control** - Managing conversation lifecycle explicitly\n\n## Functions\n\n### `query()`\n\nCreates a new session for each interaction with Claude Code. Returns an async iterator that yields messages as they arrive. Each call to `query()` starts fresh with no memory of previous interactions.\n\n    async def query(\n        *,\n        prompt: str | AsyncIterable[dict[str, Any]],\n        options: ClaudeAgentOptions | None = None\n    ) -> AsyncIterator[Message]\n\n#### Parameters\n\n| Parameter | Type | Description |\n|----|----|----|\n| `prompt` | `str | AsyncIterable[dict]` | The input prompt as a string or async iterable for streaming mode |\n| `options` | `ClaudeAgentOptions | None` | Optional configuration object (defaults to `ClaudeAgentOptions()` if None) |\n\n#### Returns\n\nReturns an `AsyncIterator[Message]` that yields messages from the conversation.\n\n#### Example - With options\n\n    import asyncio\n    from claude_agent_sdk import query, ClaudeAgentOptions\n\n    async def main():\n        options = ClaudeAgentOptions(\n            system_prompt=\"You are an expert Python developer\",\n            permission_mode='acceptEdits',\n            cwd=\"/home/user/project\"\n        )\n\n        async for message in query(\n            prompt=\"Create a Python web server\",\n            options=options\n        ):\n            print(message)\n\n    asyncio.run(main())\n\n### `tool()`\n\nDecorator for defining MCP tools with type safety.\n\n    def tool(\n        name: str,\n        description: str,\n        input_schema: type | dict[str, Any]\n    ) -> Callable[[Callable[[Any], Awaitable[dict[str, Any]]]], SdkMcpTool[Any]]\n\n#### Parameters\n\n| Parameter | Type | Description |\n|----|----|----|\n| `name` | `str` | Unique identifier for the tool |\n| `description` | `str` | Human-readable description of what the tool does |\n| `input_schema` | `type | dict[str, Any]` | Schema defining the tool's input parameters (see below) |\n\n#### Input Schema Options\n\n1. **Simple type mapping** (recommended):\n\n        {\"text\": str, \"count\": int, \"enabled\": bool}\n\n2. **JSON Schema format** (for complex validation):\n\n        {\n            \"type\": \"object\",\n            \"properties\": {\n                \"text\": {\"type\": \"string\"},\n                \"count\": {\"type\": \"integer\", \"minimum\": 0}\n            },\n            \"required\": [\"text\"]\n        }\n\n#### Returns\n\nA decorator function that wraps the tool implementation and returns an `SdkMcpTool` instance.\n\n#### Example\n\n    from claude_agent_sdk import tool\n    from typing import Any\n\n    @tool(\"greet\", \"Greet a user\", {\"name\": str})\n    async def greet(args: dict[str, Any]) -> dict[str, Any]:\n        return {\n            \"content\": [{\n                \"type\": \"text\",\n                \"text\": f\"Hello, {args['name']}!\"\n            }]\n        }\n\n### `create_sdk_mcp_server()`\n\nCreate an in-process MCP server that runs within your Python application.\n\n    def create_sdk_mcp_server(\n        name: str,\n        version: str = \"1.0.0\",\n        tools: list[SdkMcpTool[Any]] | None = None\n    ) -> McpSdkServerConfig\n\n#### Parameters\n\n| Parameter | Type | Default | Description |\n|----|----|----|----|\n| `name` | `str` | \\- | Unique identifier for the server |\n| `version` | `str` | `\"1.0.0\"` | Server version string |\n| `tools` | `list[SdkMcpTool[Any]] | None` | `None` | List of tool functions created with `@tool` decorator |\n\n#### Returns\n\nReturns an `McpSdkServerConfig` object that can be passed to `ClaudeAgentOptions.mcp_servers`.\n\n#### Example\n\n    from claude_agent_sdk import tool, create_sdk_mcp_server\n\n    @tool(\"add\", \"Add two numbers\", {\"a\": float, \"b\": float})\n    async def add(args):\n        return {\n            \"content\": [{\n                \"type\": \"text\",\n                \"text\": f\"Sum: {args['a'] + args['b']}\"\n            }]\n        }\n\n    @tool(\"multiply\", \"Multiply two numbers\", {\"a\": float, \"b\": float})\n    async def multiply(args):\n        return {\n            \"content\": [{\n                \"type\": \"text\",\n                \"text\": f\"Product: {args['a'] * args['b']}\"\n            }]\n        }\n\n    calculator = create_sdk_mcp_server(\n        name=\"calculator\",\n        version=\"2.0.0\",\n        tools=[add, multiply]  # Pass decorated functions\n    )\n\n    # Use with Claude\n    options = ClaudeAgentOptions(\n        mcp_servers={\"calc\": calculator},\n        allowed_tools=[\"mcp__calc__add\", \"mcp__calc__multiply\"]\n    )\n\n## Classes\n\n### `ClaudeSDKClient`\n\n**Maintains a conversation session across multiple exchanges.** This is the Python equivalent of how the TypeScript SDK's `query()` function works internally - it creates a client object that can continue conversations.\n\n#### Key Features\n\n- **Session Continuity**: Maintains conversation context across multiple `query()` calls\n- **Same Conversation**: Claude remembers previous messages in the session\n- **Interrupt Support**: Can stop Claude mid-execution\n- **Explicit Lifecycle**: You control when the session starts and ends\n- **Response-driven Flow**: Can react to responses and send follow-ups\n- **Custom Tools & Hooks**: Supports custom tools (created with `@tool` decorator) and hooks\n\n    class ClaudeSDKClient:\n        def **init**(self, options: ClaudeAgentOptions | None = None)\n        async def connect(self, prompt: str | AsyncIterable[dict] | None = None) -> None\n        async def query(self, prompt: str | AsyncIterable[dict], session_id: str = \"default\") -> None\n        async def receive_messages(self) -> AsyncIterator[Message]\n        async def receive_response(self) -> AsyncIterator[Message]\n        async def interrupt(self) -> None\n        async def disconnect(self) -> None\n\n#### Methods\n\n| Method | Description |\n|----|----|\n| `__init__(options)` | Initialize the client with optional configuration |\n| `connect(prompt)` | Connect to Claude with an optional initial prompt or message stream |\n| `query(prompt, session_id)` | Send a new request in streaming mode |\n| `receive_messages()` | Receive all messages from Claude as an async iterator |\n| `receive_response()` | Receive messages until and including a ResultMessage |\n| `interrupt()` | Send interrupt signal (only works in streaming mode) |\n| `disconnect()` | Disconnect from Claude |\n\n#### Context Manager Support\n\nThe client can be used as an async context manager for automatic connection management:\n\n    async with ClaudeSDKClient() as client:\n        await client.query(\"Hello Claude\")\n        async for message in client.receive_response():\n            print(message)\n\n> **Important:** When iterating over messages, avoid using `break` to exit early as this can cause asyncio cleanup issues. Instead, let the iteration complete naturally or use flags to track when you've found what you need.\n\n#### Example - Continuing a conversation\n\n    import asyncio\n    from claude_agent_sdk import ClaudeSDKClient, AssistantMessage, TextBlock, ResultMessage\n\n    async def main():\n        async with ClaudeSDKClient() as client:\n            # First question\n            await client.query(\"What's the capital of France?\")\n\n            # Process response\n            async for message in client.receive_response():\n                if isinstance(message, AssistantMessage):\n                    for block in message.content:\n                        if isinstance(block, TextBlock):\n                            print(f\"Claude: {block.text}\")\n\n            # Follow-up question - Claude remembers the previous context\n            await client.query(\"What's the population of that city?\")\n\n            async for message in client.receive_response():\n                if isinstance(message, AssistantMessage):\n                    for block in message.content:\n                        if isinstance(block, TextBlock):\n                            print(f\"Claude: {block.text}\")\n\n            # Another follow-up - still in the same conversation\n            await client.query(\"What are some famous landmarks there?\")\n\n            async for message in client.receive_response():\n                if isinstance(message, AssistantMessage):\n                    for block in message.content:\n                        if isinstance(block, TextBlock):\n                            print(f\"Claude: {block.text}\")\n\n    asyncio.run(main())\n\n#### Example - Streaming input with ClaudeSDKClient\n\n    import asyncio\n    from claude_agent_sdk import ClaudeSDKClient\n\n    async def message_stream():\n        \"\"\"Generate messages dynamically.\"\"\"\n        yield {\"type\": \"text\", \"text\": \"Analyze the following data:\"}\n        await asyncio.sleep(0.5)\n        yield {\"type\": \"text\", \"text\": \"Temperature: 25Â°C\"}\n        await asyncio.sleep(0.5)\n        yield {\"type\": \"text\", \"text\": \"Humidity: 60%\"}\n        await asyncio.sleep(0.5)\n        yield {\"type\": \"text\", \"text\": \"What patterns do you see?\"}\n\n    async def main():\n        async with ClaudeSDKClient() as client:\n            # Stream input to Claude\n            await client.query(message_stream())\n\n            # Process response\n            async for message in client.receive_response():\n                print(message)\n\n            # Follow-up in same session\n            await client.query(\"Should we be concerned about these readings?\")\n\n            async for message in client.receive_response():\n                print(message)\n\n    asyncio.run(main())\n\n#### Example - Using interrupts\n\n    import asyncio\n    from claude_agent_sdk import ClaudeSDKClient, ClaudeAgentOptions\n\n    async def interruptible_task():\n        options = ClaudeAgentOptions(\n            allowed_tools=[\"Bash\"],\n            permission_mode=\"acceptEdits\"\n        )\n\n        async with ClaudeSDKClient(options=options) as client:\n            # Start a long-running task\n            await client.query(\"Count from 1 to 100 slowly\")\n\n            # Let it run for a bit\n            await asyncio.sleep(2)\n\n            # Interrupt the task\n            await client.interrupt()\n            print(\"Task interrupted!\")\n\n            # Send a new command\n            await client.query(\"Just say hello instead\")\n\n            async for message in client.receive_response():\n                # Process the new response\n                pass\n\n    asyncio.run(interruptible_task())\n\n#### Example - Advanced permission control\n\n    from claude_agent_sdk import (\n        ClaudeSDKClient,\n        ClaudeAgentOptions\n    )\n\n    async def custom_permission_handler(\n        tool_name: str,\n        input_data: dict,\n        context: dict\n    ):\n        \"\"\"Custom logic for tool permissions.\"\"\"\n\n        # Block writes to system directories\n        if tool_name == \"Write\" and input_data.get(\"file_path\", \"\").startswith(\"/system/\"):\n            return {\n                \"behavior\": \"deny\",\n                \"message\": \"System directory write not allowed\",\n                \"interrupt\": True\n            }\n\n        # Redirect sensitive file operations\n        if tool_name in [\"Write\", \"Edit\"] and \"config\" in input_data.get(\"file_path\", \"\"):\n            safe_path = f\"./sandbox/{input_data['file_path']}\"\n            return {\n                \"behavior\": \"allow\",\n                \"updatedInput\": {**input_data, \"file_path\": safe_path}\n            }\n\n        # Allow everything else\n        return {\n            \"behavior\": \"allow\",\n            \"updatedInput\": input_data\n        }\n\n    async def main():\n        options = ClaudeAgentOptions(\n            can_use_tool=custom_permission_handler,\n            allowed_tools=[\"Read\", \"Write\", \"Edit\"]\n        )\n\n        async with ClaudeSDKClient(options=options) as client:\n            await client.query(\"Update the system config file\")\n\n            async for message in client.receive_response():\n                # Will use sandbox path instead\n                print(message)\n\n    asyncio.run(main())\n\n## Types\n\n### `SdkMcpTool`\n\nDefinition for an SDK MCP tool created with the `@tool` decorator.\n\n    @dataclass\n    class SdkMcpTool(Generic[T]):\n        name: str\n        description: str\n        input_schema: type[T] | dict[str, Any]\n        handler: Callable[[T], Awaitable[dict[str, Any]]]\n\n| Property | Type | Description |\n|----|----|----|\n| `name` | `str` | Unique identifier for the tool |\n| `description` | `str` | Human-readable description |\n| `input_schema` | `type[T] | dict[str, Any]` | Schema for input validation |\n| `handler` | `Callable[[T], Awaitable[dict[str, Any]]]` | Async function that handles tool execution |\n\n### `ClaudeAgentOptions`\n\nConfiguration dataclass for Claude Code queries.\n\n    @dataclass\n    class ClaudeAgentOptions:\n        allowed_tools: list[str] = field(default_factory=list)\n        system_prompt: str | SystemPromptPreset | None = None\n        mcp_servers: dict[str, McpServerConfig] | str | Path = field(default_factory=dict)\n        permission_mode: PermissionMode | None = None\n        continue_conversation: bool = False\n        resume: str | None = None\n        max_turns: int | None = None\n        disallowed_tools: list[str] = field(default_factory=list)\n        model: str | None = None\n        output_format: OutputFormat | None = None\n        permission_prompt_tool_name: str | None = None\n        cwd: str | Path | None = None\n        settings: str | None = None\n        add_dirs: list[str | Path] = field(default_factory=list)\n        env: dict[str, str] = field(default_factory=dict)\n        extra_args: dict[str, str | None] = field(default_factory=dict)\n        max_buffer_size: int | None = None\n        debug_stderr: Any = sys.stderr  # Deprecated\n        stderr: Callable[[str], None] | None = None\n        can_use_tool: CanUseTool | None = None\n        hooks: dict[HookEvent, list[HookMatcher]] | None = None\n        user: str | None = None\n        include_partial_messages: bool = False\n        fork_session: bool = False\n        agents: dict[str, AgentDefinition] | None = None\n        setting_sources: list[SettingSource] | None = None\n\n| Property | Type | Default | Description |\n|----|----|----|----|\n| `allowed_tools` | `list[str]` | `[]` | List of allowed tool names |\n| `system_prompt` | `str | SystemPromptPreset | None` | `None` | System prompt configuration. Pass a string for custom prompt, or use `{\"type\": \"preset\", \"preset\": \"claude_code\"}` for Claude Code's system prompt. Add `\"append\"` to extend the preset |\n| `mcp_servers` | `dict[str, McpServerConfig] | str | Path` | `{}` | MCP server configurations or path to config file |\n| `permission_mode` | `PermissionMode | None` | `None` | Permission mode for tool usage |\n| `continue_conversation` | `bool` | `False` | Continue the most recent conversation |\n| `resume` | `str | None` | `None` | Session ID to resume |\n| `max_turns` | `int | None` | `None` | Maximum conversation turns |\n| `disallowed_tools` | `list[str]` | `[]` | List of disallowed tool names |\n| `model` | `str | None` | `None` | Claude model to use |\n| `output_format` | [`OutputFormat`](https://platform.claude.com/docs/en/agent-sdk/python#outputformat) ` | None` | `None` | Define output format for agent results. See [Structured outputs](https://platform.claude.com/docs/en/agent-sdk/structured-outputs) for details |\n| `permission_prompt_tool_name` | `str | None` | `None` | MCP tool name for permission prompts |\n| `cwd` | `str | Path | None` | `None` | Current working directory |\n| `settings` | `str | None` | `None` | Path to settings file |\n| `add_dirs` | `list[str | Path]` | `[]` | Additional directories Claude can access |\n| `env` | `dict[str, str]` | `{}` | Environment variables |\n| `extra_args` | `dict[str, str | None]` | `{}` | Additional CLI arguments to pass directly to the CLI |\n| `max_buffer_size` | `int | None` | `None` | Maximum bytes when buffering CLI stdout |\n| `debug_stderr` | `Any` | `sys.stderr` | *Deprecated* - File-like object for debug output. Use `stderr` callback instead |\n| `stderr` | `Callable[[str], None] | None` | `None` | Callback function for stderr output from CLI |\n| `can_use_tool` | `CanUseTool | None` | `None` | Tool permission callback function |\n| `hooks` | `dict[HookEvent, list[HookMatcher]] | None` | `None` | Hook configurations for intercepting events |\n| `user` | `str | None` | `None` | User identifier |\n| `include_partial_messages` | `bool` | `False` | Include `StreamEvent` messages with real-time text deltas. See [StreamEvent](#streamevent) for handling |\n| `fork_session` | `bool` | `False` | When resuming with `resume`, fork to a new session ID instead of continuing the original session |\n| `agents` | `dict[str, AgentDefinition] | None` | `None` | Programmatically defined subagents |\n| `plugins` | `list[SdkPluginConfig]` | `[]` | Load custom plugins from local paths. See [Plugins](https://platform.claude.com/docs/en/agent-sdk/plugins) for details |\n| `setting_sources` | `list[SettingSource] | None` | `None` (no settings) | Control which filesystem settings to load. When omitted, no settings are loaded. **Note:** Must include `\"project\"` to load CLAUDE.md files |\n\n### `OutputFormat`\n\nConfiguration for structured output validation.\n\n    class OutputFormat(TypedDict):\n        type: Literal[\"json_schema\"]\n        schema: dict[str, Any]\n\n| Field    | Required | Description                                        |\n|----------|----------|----------------------------------------------------|\n| `type`   | Yes      | Must be `\"json_schema\"` for JSON Schema validation |\n| `schema` | Yes      | JSON Schema definition for output validation       |\n\n### `SystemPromptPreset`\n\nConfiguration for using Claude Code's preset system prompt with optional additions.\n\n    class SystemPromptPreset(TypedDict):\n        type: Literal[\"preset\"]\n        preset: Literal[\"claude_code\"]\n        append: NotRequired[str]\n\n| Field | Required | Description |\n|----|----|----|\n| `type` | Yes | Must be `\"preset\"` to use a preset system prompt |\n| `preset` | Yes | Must be `\"claude_code\"` to use Claude Code's system prompt |\n| `append` | No | Additional instructions to append to the preset system prompt |\n\n### `SettingSource`\n\nControls which filesystem-based configuration sources the SDK loads settings from.\n\n    SettingSource = Literal[\"user\", \"project\", \"local\"]\n\n| Value | Description | Location |\n|----|----|----|\n| `\"user\"` | Global user settings | `~/.claude/settings.json` |\n| `\"project\"` | Shared project settings (version controlled) | `.claude/settings.json` |\n| `\"local\"` | Local project settings (gitignored) | `.claude/settings.local.json` |\n\n#### Default behavior\n\nWhen `setting_sources` is **omitted** or **`None`**, the SDK does **not** load any filesystem settings. This provides isolation for SDK applications.\n\n#### Why use setting_sources?\n\n**Load all filesystem settings (legacy behavior):**\n\n    # Load all settings like SDK v0.0.x did\n    from claude_agent_sdk import query, ClaudeAgentOptions\n\n    async for message in query(\n        prompt=\"Analyze this code\",\n        options=ClaudeAgentOptions(\n            setting_sources=[\"user\", \"project\", \"local\"]  # Load all settings\n        )\n    ):\n        print(message)\n\n**Load only specific setting sources:**\n\n    # Load only project settings, ignore user and local\n    async for message in query(\n        prompt=\"Run CI checks\",\n        options=ClaudeAgentOptions(\n            setting_sources=[\"project\"]  # Only .claude/settings.json\n        )\n    ):\n        print(message)\n\n**Testing and CI environments:**\n\n    # Ensure consistent behavior in CI by excluding local settings\n    async for message in query(\n        prompt=\"Run tests\",\n        options=ClaudeAgentOptions(\n            setting_sources=[\"project\"],  # Only team-shared settings\n            permission_mode=\"bypassPermissions\"\n        )\n    ):\n        print(message)\n\n**SDK-only applications:**\n\n    # Define everything programmatically (default behavior)\n    # No filesystem dependencies - setting_sources defaults to None\n    async for message in query(\n        prompt=\"Review this PR\",\n        options=ClaudeAgentOptions(\n            # setting_sources=None is the default, no need to specify\n            agents={ /* ... */ },\n            mcp_servers={ /* ... */ },\n            allowed_tools=[\"Read\", \"Grep\", \"Glob\"]\n        )\n    ):\n        print(message)\n\n**Loading CLAUDE.md project instructions:**\n\n    # Load project settings to include CLAUDE.md files\n    async for message in query(\n        prompt=\"Add a new feature following project conventions\",\n        options=ClaudeAgentOptions(\n            system_prompt={\n                \"type\": \"preset\",\n                \"preset\": \"claude_code\"  # Use Claude Code's system prompt\n            },\n            setting_sources=[\"project\"],  # Required to load CLAUDE.md from project\n            allowed_tools=[\"Read\", \"Write\", \"Edit\"]\n        )\n    ):\n        print(message)\n\n#### Settings precedence\n\nWhen multiple sources are loaded, settings are merged with this precedence (highest to lowest):\n\n1. Local settings (`.claude/settings.local.json`)\n2. Project settings (`.claude/settings.json`)\n3. User settings (`~/.claude/settings.json`)\n\nProgrammatic options (like `agents`, `allowed_tools`) always override filesystem settings.\n\n### `AgentDefinition`\n\nConfiguration for a subagent defined programmatically.\n\n    @dataclass\n    class AgentDefinition:\n        description: str\n        prompt: str\n        tools: list[str] | None = None\n        model: Literal[\"sonnet\", \"opus\", \"haiku\", \"inherit\"] | None = None\n\n| Field | Required | Description |\n|----|----|----|\n| `description` | Yes | Natural language description of when to use this agent |\n| `tools` | No | Array of allowed tool names. If omitted, inherits all tools |\n| `prompt` | Yes | The agent's system prompt |\n| `model` | No | Model override for this agent. If omitted, uses the main model |\n\n### `PermissionMode`\n\nPermission modes for controlling tool execution.\n\n    PermissionMode = Literal[\n        \"default\",           # Standard permission behavior\n        \"acceptEdits\",       # Auto-accept file edits\n        \"plan\",              # Planning mode - no execution\n        \"bypassPermissions\"  # Bypass all permission checks (use with caution)\n    ]\n\n### `McpSdkServerConfig`\n\nConfiguration for SDK MCP servers created with `create_sdk_mcp_server()`.\n\n    class McpSdkServerConfig(TypedDict):\n        type: Literal[\"sdk\"]\n        name: str\n        instance: Any  # MCP Server instance\n\n### `McpServerConfig`\n\nUnion type for MCP server configurations.\n\n    McpServerConfig = McpStdioServerConfig | McpSSEServerConfig | McpHttpServerConfig | McpSdkServerConfig\n\n#### `McpStdioServerConfig`\n\n    class McpStdioServerConfig(TypedDict):\n        type: NotRequired[Literal[\"stdio\"]]  # Optional for backwards compatibility\n        command: str\n        args: NotRequired[list[str]]\n        env: NotRequired[dict[str, str]]\n\n#### `McpSSEServerConfig`\n\n    class McpSSEServerConfig(TypedDict):\n        type: Literal[\"sse\"]\n        url: str\n        headers: NotRequired[dict[str, str]]\n\n#### `McpHttpServerConfig`\n\n    class McpHttpServerConfig(TypedDict):\n        type: Literal[\"http\"]\n        url: str\n        headers: NotRequired[dict[str, str]]\n\n### `SdkPluginConfig`\n\nConfiguration for loading plugins in the SDK.\n\n    class SdkPluginConfig(TypedDict):\n        type: Literal[\"local\"]\n        path: str\n\n| Field | Type | Description |\n|----|----|----|\n| `type` | `Literal[\"local\"]` | Must be `\"local\"` (only local plugins currently supported) |\n| `path` | `str` | Absolute or relative path to the plugin directory |\n\n**Example:**\n\n    plugins=[\n        {\"type\": \"local\", \"path\": \"./my-plugin\"},\n        {\"type\": \"local\", \"path\": \"/absolute/path/to/plugin\"}\n    ]\n\nFor complete information on creating and using plugins, see [Plugins](https://platform.claude.com/docs/en/agent-sdk/plugins).\n\n## Message Types\n\n### `Message`\n\nUnion type of all possible messages.\n\n    Message = UserMessage | AssistantMessage | SystemMessage | ResultMessage\n\n> **Note:** When `include_partial_messages=True`, you will also receive `StreamEvent` messages containing real-time text deltas. See [`StreamEvent`](#streamevent) below.\n\n### `UserMessage`\n\nUser input message.\n\n    @dataclass\n    class UserMessage:\n        content: str | list[ContentBlock]\n\n### `AssistantMessage`\n\nAssistant response message with content blocks.\n\n    @dataclass\n    class AssistantMessage:\n        content: list[ContentBlock]\n        model: str\n\n### `SystemMessage`\n\nSystem message with metadata.\n\n    @dataclass\n    class SystemMessage:\n        subtype: str\n        data: dict[str, Any]\n\n### `ResultMessage`\n\nFinal result message with cost and usage information.\n\n    @dataclass\n    class ResultMessage:\n        subtype: str\n        duration_ms: int\n        duration_api_ms: int\n        is_error: bool\n        num_turns: int\n        session_id: str\n        total_cost_usd: float | None = None\n        usage: dict[str, Any] | None = None\n        result: str | None = None\n\n### `StreamEvent`\n\nStreaming event message, only received when `include_partial_messages=True`. Contains raw Anthropic API streaming events for real-time text updates.\n\n    @dataclass\n    class StreamEvent:\n        uuid: str\n        session_id: str\n        event: dict[str, Any]  # Raw Anthropic streaming event\n        parent_tool_use_id: str | None = None\n\nThe `event` dict contains Anthropic streaming events. Key event types:\n\n| Event Type | Description | Useful Fields |\n|------------|-------------|---------------|\n| `message_start` | Conversation begins | `message.model`, `message.usage` |\n| `content_block_start` | New content block starting | `index`, `content_block.type` |\n| `content_block_delta` | Incremental text update | `delta.type`, `delta.text` |\n| `content_block_stop` | Content block complete | `index` |\n| `message_delta` | Message metadata update | `delta.stop_reason`, `usage` |\n| `message_stop` | Message complete | - |\n\n#### Example - Handling streaming text deltas\n\n    from claude_agent_sdk import ClaudeSDKClient, ClaudeAgentOptions, AssistantMessage, TextBlock\n\n    async def stream_responses():\n        options = ClaudeAgentOptions(\n            include_partial_messages=True,  # Enable streaming events\n            allowed_tools=[\"Read\"]\n        )\n\n        async with ClaudeSDKClient(options=options) as client:\n            await client.query(\"Explain Python decorators\")\n\n            async for message in client.receive_response():\n                # Handle streaming deltas\n                if type(message).__name__ == \"StreamEvent\":\n                    event = message.event\n                    if event.get(\"type\") == \"content_block_delta\":\n                        delta = event.get(\"delta\", {})\n                        if delta.get(\"type\") == \"text_delta\":\n                            print(delta.get(\"text\", \"\"), end=\"\", flush=True)\n\n                # Handle complete message (also received after streaming)\n                elif isinstance(message, AssistantMessage):\n                    for block in message.content:\n                        if isinstance(block, TextBlock):\n                            print(f\"\\n[Complete]: {block.text}\")\n\n## Content Block Types\n\n### `ContentBlock`\n\nUnion type of all content blocks.\n\n    ContentBlock = TextBlock | ThinkingBlock | ToolUseBlock | ToolResultBlock\n\n### `TextBlock`\n\nText content block.\n\n    @dataclass\n    class TextBlock:\n        text: str\n\n### `ThinkingBlock`\n\nThinking content block (for models with thinking capability).\n\n    @dataclass\n    class ThinkingBlock:\n        thinking: str\n        signature: str\n\n### `ToolUseBlock`\n\nTool use request block.\n\n    @dataclass\n    class ToolUseBlock:\n        id: str\n        name: str\n        input: dict[str, Any]\n\n### `ToolResultBlock`\n\nTool execution result block.\n\n    @dataclass\n    class ToolResultBlock:\n        tool_use_id: str\n        content: str | list[dict[str, Any]] | None = None\n        is_error: bool | None = None\n\n## Error Types\n\n### `ClaudeSDKError`\n\nBase exception class for all SDK errors.\n\n    class ClaudeSDKError(Exception):\n        \"\"\"Base error for Claude SDK.\"\"\"\n\n### `CLINotFoundError`\n\nRaised when Claude Code CLI is not installed or not found.\n\n    class CLINotFoundError(CLIConnectionError):\n        def __init__(self, message: str = \"Claude Code not found\", cli_path: str | None = None):\n            \"\"\"\n            Args:\n                message: Error message (default: \"Claude Code not found\")\n                cli_path: Optional path to the CLI that was not found\n            \"\"\"\n\n### `CLIConnectionError`\n\nRaised when connection to Claude Code fails.\n\n    class CLIConnectionError(ClaudeSDKError):\n        \"\"\"Failed to connect to Claude Code.\"\"\"\n\n### `ProcessError`\n\nRaised when the Claude Code process fails.\n\n    class ProcessError(ClaudeSDKError):\n        def __init__(self, message: str, exit_code: int | None = None, stderr: str | None = None):\n            self.exit_code = exit_code\n            self.stderr = stderr\n\n### `CLIJSONDecodeError`\n\nRaised when JSON parsing fails.\n\n    class CLIJSONDecodeError(ClaudeSDKError):\n        def __init__(self, line: str, original_error: Exception):\n            \"\"\"\n            Args:\n                line: The line that failed to parse\n                original_error: The original JSON decode exception\n            \"\"\"\n            self.line = line\n            self.original_error = original_error\n\n## Hook Types\n\n### `HookEvent`\n\nSupported hook event types. Note that due to setup limitations, the Python SDK does not support SessionStart, SessionEnd, and Notification hooks.\n\n    HookEvent = Literal[\n        \"PreToolUse\",      # Called before tool execution\n        \"PostToolUse\",     # Called after tool execution\n        \"UserPromptSubmit\", # Called when user submits a prompt\n        \"Stop\",            # Called when stopping execution\n        \"SubagentStop\",    # Called when a subagent stops\n        \"PreCompact\"       # Called before message compaction\n    ]\n\n### `HookCallback`\n\nType definition for hook callback functions.\n\n    HookCallback = Callable[\n        [dict[str, Any], str | None, HookContext],\n        Awaitable[dict[str, Any]]\n    ]\n\nParameters:\n\n- `input_data`: Hook-specific input data (see [hook documentation](https://docs.claude.comhttps//code.claude.com/docs/en/hooks#hook-input))\n- `tool_use_id`: Optional tool use identifier (for tool-related hooks)\n- `context`: Hook context with additional information\n\nReturns a dictionary that may contain:\n\n- `decision`: `\"block\"` to block the action\n- `systemMessage`: System message to add to the transcript\n- `hookSpecificOutput`: Hook-specific output data\n\n### `HookContext`\n\nContext information passed to hook callbacks.\n\n    @dataclass\n    class HookContext:\n        signal: Any | None = None  # Future: abort signal support\n\n### `HookMatcher`\n\nConfiguration for matching hooks to specific events or tools.\n\n    @dataclass\n    class HookMatcher:\n        matcher: str | None = None        # Tool name or pattern to match (e.g., \"Bash\", \"Write|Edit\")\n        hooks: list[HookCallback] = field(default_factory=list)  # List of callbacks to execute\n\n### Hook Usage Example\n\n    from claude_agent_sdk import query, ClaudeAgentOptions, HookMatcher, HookContext\n    from typing import Any\n\n    async def validate_bash_command(\n        input_data: dict[str, Any],\n        tool_use_id: str | None,\n        context: HookContext\n    ) -> dict[str, Any]:\n        \"\"\"Validate and potentially block dangerous bash commands.\"\"\"\n        if input_data['tool_name'] == 'Bash':\n            command = input_data['tool_input'].get('command', '')\n            if 'rm -rf /' in command:\n                return {\n                    'hookSpecificOutput': {\n                        'hookEventName': 'PreToolUse',\n                        'permissionDecision': 'deny',\n                        'permissionDecisionReason': 'Dangerous command blocked'\n                    }\n                }\n        return {}\n\n    async def log_tool_use(\n        input_data: dict[str, Any],\n        tool_use_id: str | None,\n        context: HookContext\n    ) -> dict[str, Any]:\n        \"\"\"Log all tool usage for auditing.\"\"\"\n        print(f\"Tool used: {input_data.get('tool_name')}\")\n        return {}\n\n    options = ClaudeAgentOptions(\n        hooks={\n            'PreToolUse': [\n                HookMatcher(matcher='Bash', hooks=[validate_bash_command]),\n                HookMatcher(hooks=[log_tool_use])  # Applies to all tools\n            ],\n            'PostToolUse': [\n                HookMatcher(hooks=[log_tool_use])\n            ]\n        }\n    )\n\n    async for message in query(\n        prompt=\"Analyze this codebase\",\n        options=options\n    ):\n        print(message)\n\n## Tool Input/Output Types\n\nDocumentation of input/output schemas for all built-in Claude Code tools. While the Python SDK doesn't export these as types, they represent the structure of tool inputs and outputs in messages.\n\n### Task\n\n**Tool name:** `Task`\n\n**Input:**\n\n    {\n        \"description\": str,      # A short (3-5 word) description of the task\n        \"prompt\": str,           # The task for the agent to perform\n        \"subagent_type\": str     # The type of specialized agent to use\n    }\n\n**Output:**\n\n    {\n        \"result\": str,                    # Final result from the subagent\n        \"usage\": dict | None,             # Token usage statistics\n        \"total_cost_usd\": float | None,  # Total cost in USD\n        \"duration_ms\": int | None         # Execution duration in milliseconds\n    }\n\n### Bash\n\n**Tool name:** `Bash`\n\n**Input:**\n\n    {\n        \"command\": str,                  # The command to execute\n        \"timeout\": int | None,           # Optional timeout in milliseconds (max 600000)\n        \"description\": str | None,       # Clear, concise description (5-10 words)\n        \"run_in_background\": bool | None # Set to true to run in background\n    }\n\n**Output:**\n\n    {\n        \"output\": str,              # Combined stdout and stderr output\n        \"exitCode\": int,            # Exit code of the command\n        \"killed\": bool | None,      # Whether command was killed due to timeout\n        \"shellId\": str | None       # Shell ID for background processes\n    }\n\n### Edit\n\n**Tool name:** `Edit`\n\n**Input:**\n\n    {\n        \"file_path\": str,           # The absolute path to the file to modify\n        \"old_string\": str,          # The text to replace\n        \"new_string\": str,          # The text to replace it with\n        \"replace_all\": bool | None  # Replace all occurrences (default False)\n    }\n\n**Output:**\n\n    {\n        \"message\": str,      # Confirmation message\n        \"replacements\": int, # Number of replacements made\n        \"file_path\": str     # File path that was edited\n    }\n\n### Read\n\n**Tool name:** `Read`\n\n**Input:**\n\n    {\n        \"file_path\": str,       # The absolute path to the file to read\n        \"offset\": int | None,   # The line number to start reading from\n        \"limit\": int | None     # The number of lines to read\n    }\n\n**Output (Text files):**\n\n    {\n        \"content\": str,         # File contents with line numbers\n        \"total_lines\": int,     # Total number of lines in file\n        \"lines_returned\": int   # Lines actually returned\n    }\n\n**Output (Images):**\n\n    {\n        \"image\": str,       # Base64 encoded image data\n        \"mime_type\": str,   # Image MIME type\n        \"file_size\": int    # File size in bytes\n    }\n\n### Write\n\n**Tool name:** `Write`\n\n**Input:**\n\n    {\n        \"file_path\": str,  # The absolute path to the file to write\n        \"content\": str     # The content to write to the file\n    }\n\n**Output:**\n\n    {\n        \"message\": str,        # Success message\n        \"bytes_written\": int,  # Number of bytes written\n        \"file_path\": str       # File path that was written\n    }\n\n### Glob\n\n**Tool name:** `Glob`\n\n**Input:**\n\n    {\n        \"pattern\": str,       # The glob pattern to match files against\n        \"path\": str | None    # The directory to search in (defaults to cwd)\n    }\n\n**Output:**\n\n    {\n        \"matches\": list[str],  # Array of matching file paths\n        \"count\": int,          # Number of matches found\n        \"search_path\": str     # Search directory used\n    }\n\n### Grep\n\n**Tool name:** `Grep`\n\n**Input:**\n\n    {\n        \"pattern\": str,                    # The regular expression pattern\n        \"path\": str | None,                # File or directory to search in\n        \"glob\": str | None,                # Glob pattern to filter files\n        \"type\": str | None,                # File type to search\n        \"output_mode\": str | None,         # \"content\", \"files_with_matches\", or \"count\"\n        \"-i\": bool | None,                 # Case insensitive search\n        \"-n\": bool | None,                 # Show line numbers\n        \"-B\": int | None,                  # Lines to show before each match\n        \"-A\": int | None,                  # Lines to show after each match\n        \"-C\": int | None,                  # Lines to show before and after\n        \"head_limit\": int | None,          # Limit output to first N lines/entries\n        \"multiline\": bool | None           # Enable multiline mode\n    }\n\n**Output (content mode):**\n\n    {\n        \"matches\": [\n            {\n                \"file\": str,\n                \"line_number\": int | None,\n                \"line\": str,\n                \"before_context\": list[str] | None,\n                \"after_context\": list[str] | None\n            }\n        ],\n        \"total_matches\": int\n    }\n\n**Output (files_with_matches mode):**\n\n    {\n        \"files\": list[str],  # Files containing matches\n        \"count\": int         # Number of files with matches\n    }\n\n### NotebookEdit\n\n**Tool name:** `NotebookEdit`\n\n**Input:**\n\n    {\n        \"notebook_path\": str,                     # Absolute path to the Jupyter notebook\n        \"cell_id\": str | None,                    # The ID of the cell to edit\n        \"new_source\": str,                        # The new source for the cell\n        \"cell_type\": \"code\" | \"markdown\" | None,  # The type of the cell\n        \"edit_mode\": \"replace\" | \"insert\" | \"delete\" | None  # Edit operation type\n    }\n\n**Output:**\n\n    {\n        \"message\": str,                              # Success message\n        \"edit_type\": \"replaced\" | \"inserted\" | \"deleted\",  # Type of edit performed\n        \"cell_id\": str | None,                       # Cell ID that was affected\n        \"total_cells\": int                           # Total cells in notebook after edit\n    }\n\n### WebFetch\n\n**Tool name:** `WebFetch`\n\n**Input:**\n\n    {\n        \"url\": str,     # The URL to fetch content from\n        \"prompt\": str   # The prompt to run on the fetched content\n    }\n\n**Output:**\n\n    {\n        \"response\": str,           # AI model's response to the prompt\n        \"url\": str,                # URL that was fetched\n        \"final_url\": str | None,   # Final URL after redirects\n        \"status_code\": int | None  # HTTP status code\n    }\n\n### WebSearch\n\n**Tool name:** `WebSearch`\n\n**Input:**\n\n    {\n        \"query\": str,                        # The search query to use\n        \"allowed_domains\": list[str] | None, # Only include results from these domains\n        \"blocked_domains\": list[str] | None  # Never include results from these domains\n    }\n\n**Output:**\n\n    {\n        \"results\": [\n            {\n                \"title\": str,\n                \"url\": str,\n                \"snippet\": str,\n                \"metadata\": dict | None\n            }\n        ],\n        \"total_results\": int,\n        \"query\": str\n    }\n\n### TodoWrite\n\n**Tool name:** `TodoWrite`\n\n**Input:**\n\n    {\n        \"todos\": [\n            {\n                \"content\": str,                              # The task description\n                \"status\": \"pending\" | \"in_progress\" | \"completed\",  # Task status\n                \"activeForm\": str                            # Active form of the description\n            }\n        ]\n    }\n\n**Output:**\n\n    {\n        \"message\": str,  # Success message\n        \"stats\": {\n            \"total\": int,\n            \"pending\": int,\n            \"in_progress\": int,\n            \"completed\": int\n        }\n    }\n\n### BashOutput\n\n**Tool name:** `BashOutput`\n\n**Input:**\n\n    {\n        \"bash_id\": str,       # The ID of the background shell\n        \"filter\": str | None  # Optional regex to filter output lines\n    }\n\n**Output:**\n\n    {\n        \"output\": str,                                      # New output since last check\n        \"status\": \"running\" | \"completed\" | \"failed\",       # Current shell status\n        \"exitCode\": int | None                              # Exit code when completed\n    }\n\n### KillBash\n\n**Tool name:** `KillBash`\n\n**Input:**\n\n    {\n        \"shell_id\": str  # The ID of the background shell to kill\n    }\n\n**Output:**\n\n    {\n        \"message\": str,  # Success message\n        \"shell_id\": str  # ID of the killed shell\n    }\n\n### ExitPlanMode\n\n**Tool name:** `ExitPlanMode`\n\n**Input:**\n\n    {\n        \"plan\": str  # The plan to run by the user for approval\n    }\n\n**Output:**\n\n    {\n        \"message\": str,          # Confirmation message\n        \"approved\": bool | None  # Whether user approved the plan\n    }\n\n### ListMcpResources\n\n**Tool name:** `ListMcpResources`\n\n**Input:**\n\n    {\n        \"server\": str | None  # Optional server name to filter resources by\n    }\n\n**Output:**\n\n    {\n        \"resources\": [\n            {\n                \"uri\": str,\n                \"name\": str,\n                \"description\": str | None,\n                \"mimeType\": str | None,\n                \"server\": str\n            }\n        ],\n        \"total\": int\n    }\n\n### ReadMcpResource\n\n**Tool name:** `ReadMcpResource`\n\n**Input:**\n\n    {\n        \"server\": str,  # The MCP server name\n        \"uri\": str      # The resource URI to read\n    }\n\n**Output:**\n\n    {\n        \"contents\": [\n            {\n                \"uri\": str,\n                \"mimeType\": str | None,\n                \"text\": str | None,\n                \"blob\": str | None\n            }\n        ],\n        \"server\": str\n    }\n\n## Advanced Features with ClaudeSDKClient\n\n### Building a Continuous Conversation Interface\n\n    from claude_agent_sdk import ClaudeSDKClient, ClaudeAgentOptions, AssistantMessage, TextBlock\n    import asyncio\n\n    class ConversationSession:\n        \"\"\"Maintains a single conversation session with Claude.\"\"\"\n\n        def __init__(self, options: ClaudeAgentOptions = None):\n            self.client = ClaudeSDKClient(options)\n            self.turn_count = 0\n\n        async def start(self):\n            await self.client.connect()\n            print(\"Starting conversation session. Claude will remember context.\")\n            print(\"Commands: 'exit' to quit, 'interrupt' to stop current task, 'new' for new session\")\n\n            while True:\n                user_input = input(f\"\\n[Turn {self.turn_count + 1}] You: \")\n\n                if user_input.lower() == 'exit':\n                    break\n                elif user_input.lower() == 'interrupt':\n                    await self.client.interrupt()\n                    print(\"Task interrupted!\")\n                    continue\n                elif user_input.lower() == 'new':\n                    # Disconnect and reconnect for a fresh session\n                    await self.client.disconnect()\n                    await self.client.connect()\n                    self.turn_count = 0\n                    print(\"Started new conversation session (previous context cleared)\")\n                    continue\n\n                # Send message - Claude remembers all previous messages in this session\n                await self.client.query(user_input)\n                self.turn_count += 1\n\n                # Process response\n                print(f\"[Turn {self.turn_count}] Claude: \", end=\"\")\n                async for message in self.client.receive_response():\n                    if isinstance(message, AssistantMessage):\n                        for block in message.content:\n                            if isinstance(block, TextBlock):\n                                print(block.text, end=\"\")\n                print()  # New line after response\n\n            await self.client.disconnect()\n            print(f\"Conversation ended after {self.turn_count} turns.\")\n\n    async def main():\n        options = ClaudeAgentOptions(\n            allowed_tools=[\"Read\", \"Write\", \"Bash\"],\n            permission_mode=\"acceptEdits\"\n        )\n        session = ConversationSession(options)\n        await session.start()\n\n    # Example conversation:\n    # Turn 1 - You: \"Create a file called hello.py\"\n    # Turn 1 - Claude: \"I'll create a hello.py file for you...\"\n    # Turn 2 - You: \"What's in that file?\"\n    # Turn 2 - Claude: \"The hello.py file I just created contains...\" (remembers!)\n    # Turn 3 - You: \"Add a main function to it\"\n    # Turn 3 - Claude: \"I'll add a main function to hello.py...\" (knows which file!)\n\n    asyncio.run(main())\n\n### Using Hooks for Behavior Modification\n\n    from claude_agent_sdk import (\n        ClaudeSDKClient,\n        ClaudeAgentOptions,\n        HookMatcher,\n        HookContext\n    )\n    import asyncio\n    from typing import Any\n\n    async def pre_tool_logger(\n        input_data: dict[str, Any],\n        tool_use_id: str | None,\n        context: HookContext\n    ) -> dict[str, Any]:\n        \"\"\"Log all tool usage before execution.\"\"\"\n        tool_name = input_data.get('tool_name', 'unknown')\n        print(f\"[PRE-TOOL] About to use: {tool_name}\")\n\n        # You can modify or block the tool execution here\n        if tool_name == \"Bash\" and \"rm -rf\" in str(input_data.get('tool_input', {})):\n            return {\n                'hookSpecificOutput': {\n                    'hookEventName': 'PreToolUse',\n                    'permissionDecision': 'deny',\n                    'permissionDecisionReason': 'Dangerous command blocked'\n                }\n            }\n        return {}\n\n    async def post_tool_logger(\n        input_data: dict[str, Any],\n        tool_use_id: str | None,\n        context: HookContext\n    ) -> dict[str, Any]:\n        \"\"\"Log results after tool execution.\"\"\"\n        tool_name = input_data.get('tool_name', 'unknown')\n        print(f\"[POST-TOOL] Completed: {tool_name}\")\n        return {}\n\n    async def user_prompt_modifier(\n        input_data: dict[str, Any],\n        tool_use_id: str | None,\n        context: HookContext\n    ) -> dict[str, Any]:\n        \"\"\"Add context to user prompts.\"\"\"\n        original_prompt = input_data.get('prompt', '')\n\n        # Add timestamp to all prompts\n        from datetime import datetime\n        timestamp = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n\n        return {\n            'hookSpecificOutput': {\n                'hookEventName': 'UserPromptSubmit',\n                'updatedPrompt': f\"[{timestamp}] {original_prompt}\"\n            }\n        }\n\n    async def main():\n        options = ClaudeAgentOptions(\n            hooks={\n                'PreToolUse': [\n                    HookMatcher(hooks=[pre_tool_logger]),\n                    HookMatcher(matcher='Bash', hooks=[pre_tool_logger])\n                ],\n                'PostToolUse': [\n                    HookMatcher(hooks=[post_tool_logger])\n                ],\n                'UserPromptSubmit': [\n                    HookMatcher(hooks=[user_prompt_modifier])\n                ]\n            },\n            allowed_tools=[\"Read\", \"Write\", \"Bash\"]\n        )\n\n        async with ClaudeSDKClient(options=options) as client:\n            await client.query(\"List files in current directory\")\n\n            async for message in client.receive_response():\n                # Hooks will automatically log tool usage\n                pass\n\n    asyncio.run(main())\n\n### Real-time Progress Monitoring\n\n    from claude_agent_sdk import (\n        ClaudeSDKClient,\n        ClaudeAgentOptions,\n        AssistantMessage,\n        ToolUseBlock,\n        ToolResultBlock,\n        TextBlock\n    )\n    import asyncio\n\n    async def monitor_progress():\n        options = ClaudeAgentOptions(\n            allowed_tools=[\"Write\", \"Bash\"],\n            permission_mode=\"acceptEdits\"\n        )\n\n        async with ClaudeSDKClient(options=options) as client:\n            await client.query(\n                \"Create 5 Python files with different sorting algorithms\"\n            )\n\n            # Monitor progress in real-time\n            files_created = []\n            async for message in client.receive_messages():\n                if isinstance(message, AssistantMessage):\n                    for block in message.content:\n                        if isinstance(block, ToolUseBlock):\n                            if block.name == \"Write\":\n                                file_path = block.input.get(\"file_path\", \"\")\n                                print(f\"ð¨ Creating: {file_path}\")\n                        elif isinstance(block, ToolResultBlock):\n                            print(f\"â Completed tool execution\")\n                        elif isinstance(block, TextBlock):\n                            print(f\"ð­ Claude says: {block.text[:100]}...\")\n\n                # Check if we've received the final result\n                if hasattr(message, 'subtype') and message.subtype in ['success', 'error']:\n                    print(f\"\\nð¯ Task completed!\")\n                    break\n\n    asyncio.run(monitor_progress())\n\n## Example Usage\n\n### Basic file operations (using query)\n\n    from claude_agent_sdk import query, ClaudeAgentOptions, AssistantMessage, ToolUseBlock\n    import asyncio\n\n    async def create_project():\n        options = ClaudeAgentOptions(\n            allowed_tools=[\"Read\", \"Write\", \"Bash\"],\n            permission_mode='acceptEdits',\n            cwd=\"/home/user/project\"\n        )\n\n        async for message in query(\n            prompt=\"Create a Python project structure with setup.py\",\n            options=options\n        ):\n            if isinstance(message, AssistantMessage):\n                for block in message.content:\n                    if isinstance(block, ToolUseBlock):\n                        print(f\"Using tool: {block.name}\")\n\n    asyncio.run(create_project())\n\n### Error handling\n\n    from claude_agent_sdk import (\n        query,\n        CLINotFoundError,\n        ProcessError,\n        CLIJSONDecodeError\n    )\n\n    try:\n        async for message in query(prompt=\"Hello\"):\n            print(message)\n    except CLINotFoundError:\n        print(\"Please install Claude Code: npm install -g @anthropic-ai/claude-code\")\n    except ProcessError as e:\n        print(f\"Process failed with exit code: {e.exit_code}\")\n    except CLIJSONDecodeError as e:\n        print(f\"Failed to parse response: {e}\")\n\n### Streaming mode with client\n\n    from claude_agent_sdk import ClaudeSDKClient\n    import asyncio\n\n    async def interactive_session():\n        async with ClaudeSDKClient() as client:\n            # Send initial message\n            await client.query(\"What's the weather like?\")\n\n            # Process responses\n            async for msg in client.receive_response():\n                print(msg)\n\n            # Send follow-up\n            await client.query(\"Tell me more about that\")\n\n            # Process follow-up response\n            async for msg in client.receive_response():\n                print(msg)\n\n    asyncio.run(interactive_session())\n\n### Using custom tools with ClaudeSDKClient\n\n    from claude_agent_sdk import (\n        ClaudeSDKClient,\n        ClaudeAgentOptions,\n        tool,\n        create_sdk_mcp_server,\n        AssistantMessage,\n        TextBlock\n    )\n    import asyncio\n    from typing import Any\n\n    # Define custom tools with @tool decorator\n    @tool(\"calculate\", \"Perform mathematical calculations\", {\"expression\": str})\n    async def calculate(args: dict[str, Any]) -> dict[str, Any]:\n        try:\n            result = eval(args[\"expression\"], {\"__builtins__\": {}})\n            return {\n                \"content\": [{\n                    \"type\": \"text\",\n                    \"text\": f\"Result: {result}\"\n                }]\n            }\n        except Exception as e:\n            return {\n                \"content\": [{\n                    \"type\": \"text\",\n                    \"text\": f\"Error: {str(e)}\"\n                }],\n                \"is_error\": True\n            }\n\n    @tool(\"get_time\", \"Get current time\", {})\n    async def get_time(args: dict[str, Any]) -> dict[str, Any]:\n        from datetime import datetime\n        current_time = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n        return {\n            \"content\": [{\n                \"type\": \"text\",\n                \"text\": f\"Current time: {current_time}\"\n            }]\n        }\n\n    async def main():\n        # Create SDK MCP server with custom tools\n        my_server = create_sdk_mcp_server(\n            name=\"utilities\",\n            version=\"1.0.0\",\n            tools=[calculate, get_time]\n        )\n\n        # Configure options with the server\n        options = ClaudeAgentOptions(\n            mcp_servers={\"utils\": my_server},\n            allowed_tools=[\n                \"mcp__utils__calculate\",\n                \"mcp__utils__get_time\"\n            ]\n        )\n\n        # Use ClaudeSDKClient for interactive tool usage\n        async with ClaudeSDKClient(options=options) as client:\n            await client.query(\"What's 123 * 456?\")\n\n            # Process calculation response\n            async for message in client.receive_response():\n                if isinstance(message, AssistantMessage):\n                    for block in message.content:\n                        if isinstance(block, TextBlock):\n                            print(f\"Calculation: {block.text}\")\n\n            # Follow up with time query\n            await client.query(\"What time is it now?\")\n\n            async for message in client.receive_response():\n                if isinstance(message, AssistantMessage):\n                    for block in message.content:\n                        if isinstance(block, TextBlock):\n                            print(f\"Time: {block.text}\")\n\n    asyncio.run(main())\n\n## See also\n\n- [Python SDK guide](https://platform.claude.com/docs/en/agent-sdk/python) - Tutorial and examples\n- [SDK overview](https://platform.claude.com/docs/en/agent-sdk/overview) - General SDK concepts\n- [TypeScript SDK reference](https://platform.claude.com/docs/en/agent-sdk/typescript) - TypeScript SDK documentation\n- [CLI reference](https://code.claude.com/docs/en/cli-reference) - Command-line interface\n- [Common workflows](https://code.claude.com/docs/en/common-workflows) - Step-by-step guides\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_sessions.md": "---\ntitle: Session Management\nsource_url: https://platform.claude.com/docs/en/agent-sdk/sessions\n---\n\n# Session Management\n\nThe Claude Agent SDK provides session management capabilities for handling conversation state and resumption. Sessions allow you to continue conversations across multiple interactions while maintaining full context.\n\n## How Sessions Work\n\nWhen you start a new query, the SDK automatically creates a session and returns a session ID in the initial system message. You can capture this ID to resume the session later.\n\n### Getting the Session ID\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\"\n\n    let sessionId: string | undefined\n\n    const response = query({\n      prompt: \"Help me build a web application\",\n      options: {\n        model: \"claude-sonnet-4-5\"\n      }\n    })\n\n    for await (const message of response) {\n      // The first message is a system init message with the session ID\n      if (message.type === 'system' && message.subtype === 'init') {\n        sessionId = message.session_id\n        console.log(`Session started with ID: ${sessionId}`)\n        // You can save this ID for later resumption\n      }\n\n      // Process other messages...\n      console.log(message)\n    }\n\n    // Later, you can use the saved sessionId to resume\n    if (sessionId) {\n      const resumedResponse = query({\n        prompt: \"Continue where we left off\",\n        options: {\n          resume: sessionId\n        }\n      })\n    }\n\n## Resuming Sessions\n\nThe SDK supports resuming sessions from previous conversation states, enabling continuous development workflows. Use the `resume` option with a session ID to continue a previous conversation.\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\"\n\n    // Resume a previous session using its ID\n    const response = query({\n      prompt: \"Continue implementing the authentication system from where we left off\",\n      options: {\n        resume: \"session-xyz\", // Session ID from previous conversation\n        model: \"claude-sonnet-4-5\",\n        allowedTools: [\"Read\", \"Edit\", \"Write\", \"Glob\", \"Grep\", \"Bash\"]\n      }\n    })\n\n    // The conversation continues with full context from the previous session\n    for await (const message of response) {\n      console.log(message)\n    }\n\nThe SDK automatically handles loading the conversation history and context when you resume a session, allowing Claude to continue exactly where it left off.\n\n## Forking Sessions\n\nWhen resuming a session, you can choose to either continue the original session or fork it into a new branch. By default, resuming continues the original session. Use the `forkSession` option (TypeScript) or `fork_session` option (Python) to create a new session ID that starts from the resumed state.\n\n### When to Fork a Session\n\nForking is useful when you want to:\n\n- Explore different approaches from the same starting point\n- Create multiple conversation branches without modifying the original\n- Test changes without affecting the original session history\n- Maintain separate conversation paths for different experiments\n\n### Forking vs Continuing\n\n| Behavior | `forkSession: false` (default) | `forkSession: true` |\n|----|----|----|\n| **Session ID** | Same as original | New session ID generated |\n| **History** | Appends to original session | Creates new branch from resume point |\n| **Original Session** | Modified | Preserved unchanged |\n| **Use Case** | Continue linear conversation | Branch to explore alternatives |\n\n### Example: Forking a Session\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\"\n\n    // First, capture the session ID\n    let sessionId: string | undefined\n\n    const response = query({\n      prompt: \"Help me design a REST API\",\n      options: { model: \"claude-sonnet-4-5\" }\n    })\n\n    for await (const message of response) {\n      if (message.type === 'system' && message.subtype === 'init') {\n        sessionId = message.session_id\n        console.log(`Original session: ${sessionId}`)\n      }\n    }\n\n    // Fork the session to try a different approach\n    const forkedResponse = query({\n      prompt: \"Now let's redesign this as a GraphQL API instead\",\n      options: {\n        resume: sessionId,\n        forkSession: true,  // Creates a new session ID\n        model: \"claude-sonnet-4-5\"\n      }\n    })\n\n    for await (const message of forkedResponse) {\n      if (message.type === 'system' && message.subtype === 'init') {\n        console.log(`Forked session: ${message.session_id}`)\n        // This will be a different session ID\n      }\n    }\n\n    // The original session remains unchanged and can still be resumed\n    const originalContinued = query({\n      prompt: \"Add authentication to the REST API\",\n      options: {\n        resume: sessionId,\n        forkSession: false,  // Continue original session (default)\n        model: \"claude-sonnet-4-5\"\n      }\n    })\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_skills.md": "---\ntitle: Agent Skills in the SDK\nsource_url: https://platform.claude.com/docs/en/agent-sdk/skills\n---\n\n## Overview\n\nAgent Skills extend Claude with specialized capabilities that Claude autonomously invokes when relevant. Skills are packaged as `SKILL.md` files containing instructions, descriptions, and optional supporting resources.\n\nFor comprehensive information about Skills, including benefits, architecture, and authoring guidelines, see the [Agent Skills overview](https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview).\n\n## How Skills Work with the SDK\n\nWhen using the Claude Agent SDK, Skills are:\n\n1. **Defined as filesystem artifacts**: Created as `SKILL.md` files in specific directories (`.claude/skills/`)\n2. **Loaded from filesystem**: Skills are loaded from configured filesystem locations. You must specify `settingSources` (TypeScript) or `setting_sources` (Python) to load Skills from the filesystem\n3. **Automatically discovered**: Once filesystem settings are loaded, Skill metadata is discovered at startup from user and project directories; full content loaded when triggered\n4. **Model-invoked**: Claude autonomously chooses when to use them based on context\n5. **Enabled via allowed_tools**: Add `\"Skill\"` to your `allowed_tools` to enable Skills\n\nUnlike subagents (which can be defined programmatically), Skills must be created as filesystem artifacts. The SDK does not provide a programmatic API for registering Skills.\n\n**Default behavior**: By default, the SDK does not load any filesystem settings. To use Skills, you must explicitly configure `settingSources: ['user', 'project']` (TypeScript) or `setting_sources=[\"user\", \"project\"]` (Python) in your options.\n\n## Using Skills with the SDK\n\nTo use Skills with the SDK, you need to:\n\n1. Include `\"Skill\"` in your `allowed_tools` configuration\n2. Configure `settingSources`/`setting_sources` to load Skills from the filesystem\n\nOnce configured, Claude automatically discovers Skills from the specified directories and invokes them when relevant to the user's request.\n\n    import asyncio\n    from claude_agent_sdk import query, ClaudeAgentOptions\n\n    async def main():\n        options = ClaudeAgentOptions(\n            cwd=\"/path/to/project\",  # Project with .claude/skills/\n            setting_sources=[\"user\", \"project\"],  # Load Skills from filesystem\n            allowed_tools=[\"Skill\", \"Read\", \"Write\", \"Bash\"]  # Enable Skill tool\n        )\n\n        async for message in query(\n            prompt=\"Help me process this PDF document\",\n            options=options\n        ):\n            print(message)\n\n    asyncio.run(main())\n\n## Skill Locations\n\nSkills are loaded from filesystem directories based on your `settingSources`/`setting_sources` configuration:\n\n- **Project Skills** (`.claude/skills/`): Shared with your team via git - loaded when `setting_sources` includes `\"project\"`\n- **User Skills** (`~/.claude/skills/`): Personal Skills across all projects - loaded when `setting_sources` includes `\"user\"`\n- **Plugin Skills**: Bundled with installed Claude Code plugins\n\n## Creating Skills\n\nSkills are defined as directories containing a `SKILL.md` file with YAML frontmatter and Markdown content. The `description` field determines when Claude invokes your Skill.\n\n**Example directory structure**:\n\n    .claude/skills/processing-pdfs/\n    âââ SKILL.md\n\nFor complete guidance on creating Skills, including SKILL.md structure, multi-file Skills, and examples, see:\n\n- [Agent Skills in Claude Code](https://code.claude.com/docs/en/skills): Complete guide with examples\n- [Agent Skills Best Practices](https://platform.claude.com/docs/en/agents-and-tools/agent-skills/best-practices): Authoring guidelines and naming conventions\n\n## Tool Restrictions\n\nThe `allowed-tools` frontmatter field in SKILL.md is only supported when using Claude Code CLI directly. **It does not apply when using Skills through the SDK**.\n\nWhen using the SDK, control tool access through the main `allowedTools` option in your query configuration.\n\nTo restrict tools for Skills in SDK applications, use the `allowedTools` option:\n\nImport statements from the first example are assumed in the following code snippets.\n\n    options = ClaudeAgentOptions(\n        setting_sources=[\"user\", \"project\"],  # Load Skills from filesystem\n        allowed_tools=[\"Skill\", \"Read\", \"Grep\", \"Glob\"]  # Restricted toolset\n    )\n\n    async for message in query(\n        prompt=\"Analyze the codebase structure\",\n        options=options\n    ):\n        print(message)\n\n## Discovering Available Skills\n\nTo see which Skills are available in your SDK application, simply ask Claude:\n\n    options = ClaudeAgentOptions(\n        setting_sources=[\"user\", \"project\"],  # Load Skills from filesystem\n        allowed_tools=[\"Skill\"]\n    )\n\n    async for message in query(\n        prompt=\"What Skills are available?\",\n        options=options\n    ):\n        print(message)\n\nClaude will list the available Skills based on your current working directory and installed plugins.\n\n## Testing Skills\n\nTest Skills by asking questions that match their descriptions:\n\n    options = ClaudeAgentOptions(\n        cwd=\"/path/to/project\",\n        setting_sources=[\"user\", \"project\"],  # Load Skills from filesystem\n        allowed_tools=[\"Skill\", \"Read\", \"Bash\"]\n    )\n\n    async for message in query(\n        prompt=\"Extract text from invoice.pdf\",\n        options=options\n    ):\n        print(message)\n\nClaude automatically invokes the relevant Skill if the description matches your request.\n\n## Troubleshooting\n\n### Skills Not Found\n\n**Check settingSources configuration**: Skills are only loaded when you explicitly configure `settingSources`/`setting_sources`. This is the most common issue:\n\n    # Wrong - Skills won't be loaded\n    options = ClaudeAgentOptions(\n        allowed_tools=[\"Skill\"]\n    )\n\n    # Correct - Skills will be loaded\n    options = ClaudeAgentOptions(\n        setting_sources=[\"user\", \"project\"],  # Required to load Skills\n        allowed_tools=[\"Skill\"]\n    )\n\nFor more details on `settingSources`/`setting_sources`, see the [TypeScript SDK reference](https://platform.claude.com/docs/en/agent-sdk/typescript#settingsource) or [Python SDK reference](https://platform.claude.com/docs/en/agent-sdk/python#settingsource).\n\n**Check working directory**: The SDK loads Skills relative to the `cwd` option. Ensure it points to a directory containing `.claude/skills/`:\n\n    # Ensure your cwd points to the directory containing .claude/skills/\n    options = ClaudeAgentOptions(\n        cwd=\"/path/to/project\",  # Must contain .claude/skills/\n        setting_sources=[\"user\", \"project\"],  # Required to load Skills\n        allowed_tools=[\"Skill\"]\n    )\n\nSee the \"Using Skills with the SDK\" section above for the complete pattern.\n\n**Verify filesystem location**:\n\n    # Check project Skills\n    ls .claude/skills/*/SKILL.md\n\n    # Check personal Skills\n    ls ~/.claude/skills/*/SKILL.md\n\n### Skill Not Being Used\n\n**Check the Skill tool is enabled**: Confirm `\"Skill\"` is in your `allowedTools`.\n\n**Check the description**: Ensure it's specific and includes relevant keywords. See [Agent Skills Best Practices](https://platform.claude.com/docs/en/agents-and-tools/agent-skills/best-practices#writing-effective-descriptions) for guidance on writing effective descriptions.\n\n### Additional Troubleshooting\n\nFor general Skills troubleshooting (YAML syntax, debugging, etc.), see the [Claude Code Skills troubleshooting section](https://code.claude.com/docs/en/skills#troubleshooting).\n\n## Related Documentation\n\n### Skills Guides\n\n- [Agent Skills in Claude Code](https://code.claude.com/docs/en/skills): Complete Skills guide with creation, examples, and troubleshooting\n- [Agent Skills Overview](https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview): Conceptual overview, benefits, and architecture\n- [Agent Skills Best Practices](https://platform.claude.com/docs/en/agents-and-tools/agent-skills/best-practices): Authoring guidelines for effective Skills\n- [Agent Skills Cookbook](https://github.com/anthropics/claude-cookbooks/tree/main/skills): Example Skills and templates\n\n### SDK Resources\n\n- [Subagents in the SDK](https://platform.claude.com/docs/en/agent-sdk/subagents): Similar filesystem-based agents with programmatic options\n- [Slash Commands in the SDK](https://platform.claude.com/docs/en/agent-sdk/slash-commands): User-invoked commands\n- [SDK Overview](https://platform.claude.com/docs/en/agent-sdk/overview): General SDK concepts\n- [TypeScript SDK Reference](https://platform.claude.com/docs/en/agent-sdk/typescript): Complete API documentation\n- [Python SDK Reference](https://platform.claude.com/docs/en/agent-sdk/python): Complete API documentation\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_slash-commands.md": "---\ntitle: Slash Commands in the SDK\nsource_url: https://platform.claude.com/docs/en/agent-sdk/slash-commands\n---\n\nSlash commands provide a way to control Claude Code sessions with special commands that start with `/`. These commands can be sent through the SDK to perform actions like clearing conversation history, compacting messages, or getting help.\n\n## Discovering Available Slash Commands\n\nThe Claude Agent SDK provides information about available slash commands in the system initialization message. Access this information when your session starts:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    for await (const message of query({\n      prompt: \"Hello Claude\",\n      options: { maxTurns: 1 }\n    })) {\n      if (message.type === \"system\" && message.subtype === \"init\") {\n        console.log(\"Available slash commands:\", message.slash_commands);\n        // Example output: [\"/compact\", \"/clear\", \"/help\"]\n      }\n    }\n\n## Sending Slash Commands\n\nSend slash commands by including them in your prompt string, just like regular text:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Send a slash command\n    for await (const message of query({\n      prompt: \"/compact\",\n      options: { maxTurns: 1 }\n    })) {\n      if (message.type === \"result\") {\n        console.log(\"Command executed:\", message.result);\n      }\n    }\n\n## Common Slash Commands\n\n### `/compact` - Compact Conversation History\n\nThe `/compact` command reduces the size of your conversation history by summarizing older messages while preserving important context:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    for await (const message of query({\n      prompt: \"/compact\",\n      options: { maxTurns: 1 }\n    })) {\n      if (message.type === \"system\" && message.subtype === \"compact_boundary\") {\n        console.log(\"Compaction completed\");\n        console.log(\"Pre-compaction tokens:\", message.compact_metadata.pre_tokens);\n        console.log(\"Trigger:\", message.compact_metadata.trigger);\n      }\n    }\n\n### `/clear` - Clear Conversation\n\nThe `/clear` command starts a fresh conversation by clearing all previous history:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Clear conversation and start fresh\n    for await (const message of query({\n      prompt: \"/clear\",\n      options: { maxTurns: 1 }\n    })) {\n      if (message.type === \"system\" && message.subtype === \"init\") {\n        console.log(\"Conversation cleared, new session started\");\n        console.log(\"Session ID:\", message.session_id);\n      }\n    }\n\n## Creating Custom Slash Commands\n\nIn addition to using built-in slash commands, you can create your own custom commands that are available through the SDK. Custom commands are defined as markdown files in specific directories, similar to how subagents are configured.\n\n### File Locations\n\nCustom slash commands are stored in designated directories based on their scope:\n\n- **Project commands**: `.claude/commands/` - Available only in the current project\n- **Personal commands**: `~/.claude/commands/` - Available across all your projects\n\n### File Format\n\nEach custom command is a markdown file where:\n\n- The filename (without `.md` extension) becomes the command name\n- The file content defines what the command does\n- Optional YAML frontmatter provides configuration\n\n#### Basic Example\n\nCreate `.claude/commands/refactor.md`:\n\n    Refactor the selected code to improve readability and maintainability.\n    Focus on clean code principles and best practices.\n\nThis creates the `/refactor` command that you can use through the SDK.\n\n#### With Frontmatter\n\nCreate `.claude/commands/security-check.md`:\n\n    ---\n    allowed-tools: Read, Grep, Glob\n    description: Run security vulnerability scan\n    model: claude-sonnet-4-5-20250929\n    ---\n\n    Analyze the codebase for security vulnerabilities including:\n    - SQL injection risks\n    - XSS vulnerabilities\n    - Exposed credentials\n    - Insecure configurations\n\n### Using Custom Commands in the SDK\n\nOnce defined in the filesystem, custom commands are automatically available through the SDK:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Use a custom command\n    for await (const message of query({\n      prompt: \"/refactor src/auth/login.ts\",\n      options: { maxTurns: 3 }\n    })) {\n      if (message.type === \"assistant\") {\n        console.log(\"Refactoring suggestions:\", message.message);\n      }\n    }\n\n    // Custom commands appear in the slash_commands list\n    for await (const message of query({\n      prompt: \"Hello\",\n      options: { maxTurns: 1 }\n    })) {\n      if (message.type === \"system\" && message.subtype === \"init\") {\n        // Will include both built-in and custom commands\n        console.log(\"Available commands:\", message.slash_commands);\n        // Example: [\"/compact\", \"/clear\", \"/help\", \"/refactor\", \"/security-check\"]\n      }\n    }\n\n### Advanced Features\n\n#### Arguments and Placeholders\n\nCustom commands support dynamic arguments using placeholders:\n\nCreate `.claude/commands/fix-issue.md`:\n\n    ---\n    argument-hint: [issue-number] [priority]\n    description: Fix a GitHub issue\n    ---\n\n    Fix issue #$1 with priority $2.\n    Check the issue description and implement the necessary changes.\n\nUse in SDK:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Pass arguments to custom command\n    for await (const message of query({\n      prompt: \"/fix-issue 123 high\",\n      options: { maxTurns: 5 }\n    })) {\n      // Command will process with $1=\"123\" and $2=\"high\"\n      if (message.type === \"result\") {\n        console.log(\"Issue fixed:\", message.result);\n      }\n    }\n\n#### Bash Command Execution\n\nCustom commands can execute bash commands and include their output:\n\nCreate `.claude/commands/git-commit.md`:\n\n    ---\n    allowed-tools: Bash(git add:*), Bash(git status:*), Bash(git commit:*)\n    description: Create a git commit\n    ---\n\n    ## Context\n\n    - Current status: !`git status`\n    - Current diff: !`git diff HEAD`\n\n    ## Task\n\n    Create a git commit with appropriate message based on the changes.\n\n#### File References\n\nInclude file contents using the `@` prefix:\n\nCreate `.claude/commands/review-config.md`:\n\n    ---\n    description: Review configuration files\n    ---\n\n    Review the following configuration files for issues:\n    - Package config: @package.json\n    - TypeScript config: @tsconfig.json\n    - Environment config: @.env\n\n    Check for security issues, outdated dependencies, and misconfigurations.\n\n### Organization with Namespacing\n\nOrganize commands in subdirectories for better structure:\n\n    .claude/commands/\n    âââ frontend/\n    â   âââ component.md      # Creates /component (project:frontend)\n    â   âââ style-check.md     # Creates /style-check (project:frontend)\n    âââ backend/\n    â   âââ api-test.md        # Creates /api-test (project:backend)\n    â   âââ db-migrate.md      # Creates /db-migrate (project:backend)\n    âââ review.md              # Creates /review (project)\n\nThe subdirectory appears in the command description but doesn't affect the command name itself.\n\n### Practical Examples\n\n#### Code Review Command\n\nCreate `.claude/commands/code-review.md`:\n\n    ---\n    allowed-tools: Read, Grep, Glob, Bash(git diff:*)\n    description: Comprehensive code review\n    ---\n\n    ## Changed Files\n    !`git diff --name-only HEAD~1`\n\n    ## Detailed Changes\n    !`git diff HEAD~1`\n\n    ## Review Checklist\n\n    Review the above changes for:\n    1. Code quality and readability\n    2. Security vulnerabilities\n    3. Performance implications\n    4. Test coverage\n    5. Documentation completeness\n\n    Provide specific, actionable feedback organized by priority.\n\n#### Test Runner Command\n\nCreate `.claude/commands/test.md`:\n\n    ---\n    allowed-tools: Bash, Read, Edit\n    argument-hint: [test-pattern]\n    description: Run tests with optional pattern\n    ---\n\n    Run tests matching pattern: $ARGUMENTS\n\n    1. Detect the test framework (Jest, pytest, etc.)\n    2. Run tests with the provided pattern\n    3. If tests fail, analyze and fix them\n    4. Re-run to verify fixes\n\nUse these commands through the SDK:\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Run code review\n    for await (const message of query({\n      prompt: \"/code-review\",\n      options: { maxTurns: 3 }\n    })) {\n      // Process review feedback\n    }\n\n    // Run specific tests\n    for await (const message of query({\n      prompt: \"/test auth\",\n      options: { maxTurns: 5 }\n    })) {\n      // Handle test results\n    }\n\n## See Also\n\n- [Slash Commands](https://code.claude.com/docs/en/slash-commands) - Complete slash command documentation\n- [Subagents in the SDK](https://platform.claude.com/docs/en/agent-sdk/subagents) - Similar filesystem-based configuration for subagents\n- [TypeScript SDK reference](https://platform.claude.com/docs/en/agent-sdk/typescript) - Complete API documentation\n- [SDK overview](https://platform.claude.com/docs/en/agent-sdk/overview) - General SDK concepts\n- [CLI reference](https://code.claude.com/docs/en/cli-reference) - Command-line interface\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_streaming-vs-single-mode.md": "---\ntitle: Streaming Input\nsource_url: https://platform.claude.com/docs/en/agent-sdk/streaming-vs-single-mode\n---\n\n## Overview\n\nThe Claude Agent SDK supports two distinct input modes for interacting with agents:\n\n- **Streaming Input Mode** (Default & Recommended) - A persistent, interactive session\n- **Single Message Input** - One-shot queries that use session state and resuming\n\nThis guide explains the differences, benefits, and use cases for each mode to help you choose the right approach for your application.\n\n## Streaming Input Mode (Recommended)\n\nStreaming input mode is the **preferred** way to use the Claude Agent SDK. It provides full access to the agent's capabilities and enables rich, interactive experiences.\n\nIt allows the agent to operate as a long lived process that takes in user input, handles interruptions, surfaces permission requests, and handles session management.\n\n### How It Works\n\n    %%{init: {\"theme\": \"base\", \"themeVariables\": {\"edgeLabelBackground\": \"#F0F0EB\", \"lineColor\": \"#91918D\", \"primaryColor\": \"#F0F0EB\", \"primaryTextColor\": \"#191919\", \"primaryBorderColor\": \"#D9D8D5\", \"secondaryColor\": \"#F5E6D8\", \"tertiaryColor\": \"#CC785C\", \"noteBkgColor\": \"#FAF0E6\", \"noteBorderColor\": \"#91918D\"}, \"sequence\": {\"actorMargin\": 50, \"width\": 150, \"height\": 65, \"boxMargin\": 10, \"boxTextMargin\": 5, \"noteMargin\": 10, \"messageMargin\": 35}}}%%\n    sequenceDiagram\n        participant App as Your Application\n        participant Agent as Claude Agent\n        participant Tools as Tools/Hooks\n        participant FS as Environment/<br/>File System\n\n        App->>Agent: Initialize with AsyncGenerator\n        activate Agent\n\n        App->>Agent: Yield Message 1\n        Agent->>Tools: Execute tools\n        Tools->>FS: Read files\n        FS-->>Tools: File contents\n        Tools->>FS: Write/Edit files\n        FS-->>Tools: Success/Error\n        Agent-->>App: Stream partial response\n        Agent-->>App: Stream more content...\n        Agent->>App: Complete Message 1\n\n        App->>Agent: Yield Message 2 + Image\n        Agent->>Tools: Process image & execute\n        Tools->>FS: Access filesystem\n        FS-->>Tools: Operation results\n        Agent-->>App: Stream response 2\n\n        App->>Agent: Queue Message 3\n        App->>Agent: Interrupt/Cancel\n        Agent->>App: Handle interruption\n\n        Note over App,Agent: Session stays alive\n        Note over Tools,FS: Persistent file system<br/>state maintained\n\n        deactivate Agent\n\n### Benefits\n\nImage Uploads\n\nAttach images directly to messages for visual analysis and understanding\n\nQueued Messages\n\nSend multiple messages that process sequentially, with ability to interrupt\n\nTool Integration\n\nFull access to all tools and custom MCP servers during the session\n\nHooks Support\n\nUse lifecycle hooks to customize behavior at various points\n\nReal-time Feedback\n\nSee responses as they're generated, not just final results\n\nContext Persistence\n\nMaintain conversation context across multiple turns naturally\n\n### Implementation Example\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n    import { readFileSync } from \"fs\";\n\n    async function* generateMessages() {\n      // First message\n      yield {\n        type: \"user\" as const,\n        message: {\n          role: \"user\" as const,\n          content: \"Analyze this codebase for security issues\"\n        }\n      };\n\n      // Wait for conditions or user input\n      await new Promise(resolve => setTimeout(resolve, 2000));\n\n      // Follow-up with image\n      yield {\n        type: \"user\" as const,\n        message: {\n          role: \"user\" as const,\n          content: [\n            {\n              type: \"text\",\n              text: \"Review this architecture diagram\"\n            },\n            {\n              type: \"image\",\n              source: {\n                type: \"base64\",\n                media_type: \"image/png\",\n                data: readFileSync(\"diagram.png\", \"base64\")\n              }\n            }\n          ]\n        }\n      };\n    }\n\n    // Process streaming responses\n    for await (const message of query({\n      prompt: generateMessages(),\n      options: {\n        maxTurns: 10,\n        allowedTools: [\"Read\", \"Grep\"]\n      }\n    })) {\n      if (message.type === \"result\") {\n        console.log(message.result);\n      }\n    }\n\n## Single Message Input\n\nSingle message input is simpler but more limited.\n\n### When to Use Single Message Input\n\nUse single message input when:\n\n- You need a one-shot response\n- You do not need image attachments, hooks, etc.\n- You need to operate in a stateless environment, such as a lambda function\n\n### Limitations\n\nSingle message input mode does **not** support:\n\n- Direct image attachments in messages\n- Dynamic message queueing\n- Real-time interruption\n- Hook integration\n- Natural multi-turn conversations\n\n### Implementation Example\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    // Simple one-shot query\n    for await (const message of query({\n      prompt: \"Explain the authentication flow\",\n      options: {\n        maxTurns: 1,\n        allowedTools: [\"Read\", \"Grep\"]\n      }\n    })) {\n      if (message.type === \"result\") {\n        console.log(message.result);\n      }\n    }\n\n    // Continue conversation with session management\n    for await (const message of query({\n      prompt: \"Now explain the authorization process\",\n      options: {\n        continue: true,\n        maxTurns: 1\n      }\n    })) {\n      if (message.type === \"result\") {\n        console.log(message.result);\n      }\n    }\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_structured-outputs.md": "---\ntitle: Structured outputs in the SDK\nsource_url: https://platform.claude.com/docs/en/agent-sdk/structured-outputs\n---\n\nGet structured, validated JSON from agent workflows. The Agent SDK supports structured outputs through JSON Schemas, ensuring your agents return data in exactly the format you need.\n\n**When to use structured outputs**\n\nUse structured outputs when you need validated JSON after an agent completes a multi-turn workflow with tools (file searches, command execution, web research, etc.).\n\nFor single API calls without tool use, see [API Structured Outputs](https://platform.claude.com/docs/en/build-with-claude/structured-outputs).\n\n## Why use structured outputs\n\nStructured outputs provide reliable, type-safe integration with your applications:\n\n- **Validated structure**: Always receive valid JSON matching your schema\n- **Simplified integration**: No parsing or validation code needed\n- **Type safety**: Use with TypeScript or Python type hints for end-to-end safety\n- **Clean separation**: Define output requirements separately from task instructions\n- **Tool autonomy**: Agent chooses which tools to use while guaranteeing output format\n\n## Quick start\n\n    import { query } from '@anthropic-ai/claude-agent-sdk'\n\n    const schema = {\n      type: 'object',\n      properties: {\n        company_name: { type: 'string' },\n        founded_year: { type: 'number' },\n        headquarters: { type: 'string' }\n      },\n      required: ['company_name']\n    }\n\n    for await (const message of query({\n      prompt: 'Research Anthropic and provide key company information',\n      options: {\n        outputFormat: {\n          type: 'json_schema',\n          schema: schema\n        }\n      }\n    })) {\n      if (message.type === 'result' && message.structured_output) {\n        console.log(message.structured_output)\n        // { company_name: \"Anthropic\", founded_year: 2021, headquarters: \"San Francisco, CA\" }\n      }\n    }\n\n## Defining schemas with Zod\n\nFor TypeScript projects, use Zod for type-safe schema definition and validation:\n\n    import { z } from 'zod'\n    import { zodToJsonSchema } from 'zod-to-json-schema'\n\n    // Define schema with Zod\n    const AnalysisResult = z.object({\n      summary: z.string(),\n      issues: z.array(z.object({\n        severity: z.enum(['low', 'medium', 'high']),\n        description: z.string(),\n        file: z.string()\n      })),\n      score: z.number().min(0).max(100)\n    })\n\n    type AnalysisResult = z.infer<typeof AnalysisResult>\n\n    // Convert to JSON Schema\n    const schema = zodToJsonSchema(AnalysisResult, { $refStrategy: 'root' })\n\n    // Use in query\n    for await (const message of query({\n      prompt: 'Analyze the codebase for security issues',\n      options: {\n        outputFormat: {\n          type: 'json_schema',\n          schema: schema\n        }\n      }\n    })) {\n      if (message.type === 'result' && message.structured_output) {\n        // Validate and get fully typed result\n        const parsed = AnalysisResult.safeParse(message.structured_output)\n        if (parsed.success) {\n          const data: AnalysisResult = parsed.data\n          console.log(`Score: ${data.score}`)\n          console.log(`Found ${data.issues.length} issues`)\n          data.issues.forEach(issue => {\n            console.log(`[${issue.severity}] ${issue.file}: ${issue.description}`)\n          })\n        }\n      }\n    }\n\n**Benefits of Zod:**\n\n- Full TypeScript type inference\n- Runtime validation with `safeParse()`\n- Better error messages\n- Composable schemas\n\n## How structured outputs work\n\n1. <div>\n\n    1\n\n    Define your JSON schema\n\n    Create a JSON Schema that describes the structure you want the agent to return. The schema uses standard JSON Schema format.\n\n2. <div>\n\n    2\n\n    Add the outputFormat parameter\n\n    Include the `outputFormat` parameter in your query options with `type: \"json_schema\"` and your schema definition.\n\n3. <div>\n\n    3\n\n    Run your query\n\n    The agent uses any tools it needs to complete the task (file operations, commands, web search, etc.).\n\n4. <div>\n\n    4\n\n    Access validated output\n\n    The agent's final result will be valid JSON matching your schema, available in `message.structured_output`.\n\n## Supported JSON Schema features\n\nThe Agent SDK supports the same JSON Schema features and limitations as [API Structured Outputs](https://platform.claude.com/docs/en/build-with-claude/structured-outputs#json-schema-limitations).\n\nKey supported features:\n\n- All basic types: object, array, string, integer, number, boolean, null\n- `enum`, `const`, `required`, `additionalProperties` (must be `false`)\n- String formats: `date-time`, `date`, `email`, `uri`, `uuid`, etc.\n- `$ref`, `$def`, and `definitions`\n\nFor complete details on supported features, limitations, and regex pattern support, see [JSON Schema limitations](https://platform.claude.com/docs/en/build-with-claude/structured-outputs#json-schema-limitations) in the API documentation.\n\n## Example: TODO tracking agent\n\nHere's a complete example showing an agent that searches code for TODOs and extracts git blame information:\n\n    import { query } from '@anthropic-ai/claude-agent-sdk'\n\n    // Define structure for TODO extraction\n    const todoSchema = {\n      type: 'object',\n      properties: {\n        todos: {\n          type: 'array',\n          items: {\n            type: 'object',\n            properties: {\n              text: { type: 'string' },\n              file: { type: 'string' },\n              line: { type: 'number' },\n              author: { type: 'string' },\n              date: { type: 'string' }\n            },\n            required: ['text', 'file', 'line']\n          }\n        },\n        total_count: { type: 'number' }\n      },\n      required: ['todos', 'total_count']\n    }\n\n    // Agent uses Grep to find TODOs, Bash to get git blame info\n    for await (const message of query({\n      prompt: 'Find all TODO comments in src/ and identify who added them',\n      options: {\n        outputFormat: {\n          type: 'json_schema',\n          schema: todoSchema\n        }\n      }\n    })) {\n      if (message.type === 'result' && message.structured_output) {\n        const data = message.structured_output\n        console.log(`Found ${data.total_count} TODOs`)\n        data.todos.forEach(todo => {\n          console.log(`${todo.file}:${todo.line} - ${todo.text}`)\n          if (todo.author) {\n            console.log(`  Added by ${todo.author} on ${todo.date}`)\n          }\n        })\n      }\n    }\n\nThe agent autonomously uses the right tools (Grep, Bash) to gather information and returns validated data.\n\n## Error handling\n\nIf the agent cannot produce valid output matching your schema, you'll receive an error result:\n\n    for await (const msg of query({\n      prompt: 'Analyze the data',\n      options: {\n        outputFormat: {\n          type: 'json_schema',\n          schema: mySchema\n        }\n      }\n    })) {\n      if (msg.type === 'result') {\n        if (msg.subtype === 'success' && msg.structured_output) {\n          console.log(msg.structured_output)\n        } else if (msg.subtype === 'error_max_structured_output_retries') {\n          console.error('Could not produce valid output')\n        }\n      }\n    }\n\n## Related resources\n\n- [JSON Schema documentation](https://json-schema.org/)\n- [API Structured Outputs](https://platform.claude.com/docs/en/build-with-claude/structured-outputs) - For single API calls\n- [Custom tools](https://platform.claude.com/docs/en/agent-sdk/custom-tools) - Define tools for your agents\n- [TypeScript SDK reference](https://platform.claude.com/docs/en/agent-sdk/typescript) - Full TypeScript API\n- [Python SDK reference](https://platform.claude.com/docs/en/agent-sdk/python) - Full Python API\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_subagents.md": "---\ntitle: Subagents in the SDK\nsource_url: https://platform.claude.com/docs/en/agent-sdk/subagents\n---\n\nSubagents in the Claude Agent SDK are specialized AIs that are orchestrated by the main agent. Use subagents for context management and parallelization.\n\nThis guide explains how to define and use subagents in the SDK using the `agents` parameter.\n\n## Overview\n\nSubagents can be defined in two ways when using the SDK:\n\n1. **Programmatically** - Using the `agents` parameter in your `query()` options (recommended for SDK applications)\n2. **Filesystem-based** - Placing markdown files with YAML frontmatter in designated directories (`.claude/agents/`)\n\nThis guide primarily focuses on the programmatic approach using the `agents` parameter, which provides a more integrated development experience for SDK applications.\n\n## Benefits of Using Subagents\n\n### Context Management\n\nSubagents maintain separate context from the main agent, preventing information overload and keeping interactions focused. This isolation ensures that specialized tasks don't pollute the main conversation context with irrelevant details.\n\n**Example**: A `research-assistant` subagent can explore dozens of files and documentation pages without cluttering the main conversation with all the intermediate search results - only returning the relevant findings.\n\n### Parallelization\n\nMultiple subagents can run concurrently, dramatically speeding up complex workflows.\n\n**Example**: During a code review, you can run `style-checker`, `security-scanner`, and `test-coverage` subagents simultaneously, reducing review time from minutes to seconds.\n\n### Specialized Instructions and Knowledge\n\nEach subagent can have tailored system prompts with specific expertise, best practices, and constraints.\n\n**Example**: A `database-migration` subagent can have detailed knowledge about SQL best practices, rollback strategies, and data integrity checks that would be unnecessary noise in the main agent's instructions.\n\n### Tool Restrictions\n\nSubagents can be limited to specific tools, reducing the risk of unintended actions.\n\n**Example**: A `doc-reviewer` subagent might only have access to Read and Grep tools, ensuring it can analyze but never accidentally modify your documentation files.\n\n## Creating Subagents\n\n### Programmatic Definition (Recommended)\n\nDefine subagents directly in your code using the `agents` parameter:\n\n    import { query } from '@anthropic-ai/claude-agent-sdk';\n\n    const result = query({\n      prompt: \"Review the authentication module for security issues\",\n      options: {\n        agents: {\n          'code-reviewer': {\n            description: 'Expert code review specialist. Use for quality, security, and maintainability reviews.',\n            prompt: `You are a code review specialist with expertise in security, performance, and best practices.\n\n    When reviewing code:\n    - Identify security vulnerabilities\n    - Check for performance issues\n    - Verify adherence to coding standards\n    - Suggest specific improvements\n\n    Be thorough but concise in your feedback.`,\n            tools: ['Read', 'Grep', 'Glob'],\n            model: 'sonnet'\n          },\n          'test-runner': {\n            description: 'Runs and analyzes test suites. Use for test execution and coverage analysis.',\n            prompt: `You are a test execution specialist. Run tests and provide clear analysis of results.\n\n    Focus on:\n    - Running test commands\n    - Analyzing test output\n    - Identifying failing tests\n    - Suggesting fixes for failures`,\n            tools: ['Bash', 'Read', 'Grep'],\n          }\n        }\n      }\n    });\n\n    for await (const message of result) {\n      console.log(message);\n    }\n\n### AgentDefinition Configuration\n\n| Field | Type | Required | Description |\n|----|----|----|----|\n| `description` | `string` | Yes | Natural language description of when to use this agent |\n| `prompt` | `string` | Yes | The agent's system prompt defining its role and behavior |\n| `tools` | `string[]` | No | Array of allowed tool names. If omitted, inherits all tools |\n| `model` | `'sonnet' | 'opus' | 'haiku' | 'inherit'` | No | Model override for this agent. Defaults to main model if omitted |\n\n### Filesystem-Based Definition (Alternative)\n\nYou can also define subagents as markdown files in specific directories:\n\n- **Project-level**: `.claude/agents/*.md` - Available only in the current project\n- **User-level**: `~/.claude/agents/*.md` - Available across all projects\n\nEach subagent is a markdown file with YAML frontmatter:\n\n    ---\n    name: code-reviewer\n    description: Expert code review specialist. Use for quality, security, and maintainability reviews.\n    tools: Read, Grep, Glob, Bash\n    ---\n\n    Your subagent's system prompt goes here. This defines the subagent's\n    role, capabilities, and approach to solving problems.\n\n**Note:** Programmatically defined agents (via the `agents` parameter) take precedence over filesystem-based agents with the same name.\n\n## How the SDK Uses Subagents\n\nWhen using the Claude Agent SDK, subagents can be defined programmatically or loaded from the filesystem. Claude will:\n\n1. **Load programmatic agents** from the `agents` parameter in your options\n2. **Auto-detect filesystem agents** from `.claude/agents/` directories (if not overridden)\n3. **Invoke them automatically** based on task matching and the agent's `description`\n4. **Use their specialized prompts** and tool restrictions\n5. **Maintain separate context** for each subagent invocation\n\nProgrammatically defined agents (via `agents` parameter) take precedence over filesystem-based agents with the same name.\n\n## Example Subagents\n\nFor comprehensive examples of subagents including code reviewers, test runners, debuggers, and security auditors, see the [main Subagents guide](https://code.claude.com/docs/en/sub-agents#example-subagents). The guide includes detailed configurations and best practices for creating effective subagents.\n\n## SDK Integration Patterns\n\n### Automatic Invocation\n\nThe SDK will automatically invoke appropriate subagents based on the task context. Ensure your agent's `description` field clearly indicates when it should be used:\n\n    const result = query({\n      prompt: \"Optimize the database queries in the API layer\",\n      options: {\n        agents: {\n          'performance-optimizer': {\n            description: 'Use PROACTIVELY when code changes might impact performance. MUST BE USED for optimization tasks.',\n            prompt: 'You are a performance optimization specialist...',\n            tools: ['Read', 'Edit', 'Bash', 'Grep'],\n            model: 'sonnet'\n          }\n        }\n      }\n    });\n\n### Explicit Invocation\n\nUsers can request specific subagents in their prompts:\n\n    const result = query({\n      prompt: \"Use the code-reviewer agent to check the authentication module\",\n      options: {\n        agents: {\n          'code-reviewer': {\n            description: 'Expert code review specialist',\n            prompt: 'You are a security-focused code reviewer...',\n            tools: ['Read', 'Grep', 'Glob']\n          }\n        }\n      }\n    });\n\n### Dynamic Agent Configuration\n\nYou can dynamically configure agents based on your application's needs:\n\n    import { query, type AgentDefinition } from '@anthropic-ai/claude-agent-sdk';\n\n    function createSecurityAgent(securityLevel: 'basic' | 'strict'): AgentDefinition {\n      return {\n        description: 'Security code reviewer',\n        prompt: `You are a ${securityLevel === 'strict' ? 'strict' : 'balanced'} security reviewer...`,\n        tools: ['Read', 'Grep', 'Glob'],\n        model: securityLevel === 'strict' ? 'opus' : 'sonnet'\n      };\n    }\n\n    const result = query({\n      prompt: \"Review this PR for security issues\",\n      options: {\n        agents: {\n          'security-reviewer': createSecurityAgent('strict')\n        }\n      }\n    });\n\n## Tool Restrictions\n\nSubagents can have restricted tool access via the `tools` field:\n\n- **Omit the field** - Agent inherits all available tools (default)\n- **Specify tools** - Agent can only use listed tools\n\nExample of a read-only analysis agent:\n\n    const result = query({\n      prompt: \"Analyze the architecture of this codebase\",\n      options: {\n        agents: {\n          'code-analyzer': {\n            description: 'Static code analysis and architecture review',\n            prompt: `You are a code architecture analyst. Analyze code structure,\n    identify patterns, and suggest improvements without making changes.`,\n            tools: ['Read', 'Grep', 'Glob']  // No write or execute permissions\n          }\n        }\n      }\n    });\n\n### Common Tool Combinations\n\n**Read-only agents** (analysis, review):\n\n    tools: ['Read', 'Grep', 'Glob']\n\n**Test execution agents**:\n\n    tools: ['Bash', 'Read', 'Grep']\n\n**Code modification agents**:\n\n    tools: ['Read', 'Edit', 'Write', 'Grep', 'Glob']\n\n## Related Documentation\n\n- [Main Subagents Guide](https://code.claude.com/docs/en/sub-agents) - Comprehensive subagent documentation\n- [SDK Overview](https://platform.claude.com/docs/en/agent-sdk/overview) - Overview of Claude Agent SDK\n- [Settings](https://code.claude.com/docs/en/settings) - Configuration file reference\n- [Slash Commands](https://code.claude.com/docs/en/slash-commands) - Custom command creation\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_todo-tracking.md": "---\ntitle: Todo Lists\nsource_url: https://platform.claude.com/docs/en/agent-sdk/todo-tracking\n---\n\nTodo tracking provides a structured way to manage tasks and display progress to users. The Claude Agent SDK includes built-in todo functionality that helps organize complex workflows and keep users informed about task progression.\n\n### Todo Lifecycle\n\nTodos follow a predictable lifecycle:\n\n1. **Created** as `pending` when tasks are identified\n2. **Activated** to `in_progress` when work begins\n3. **Completed** when the task finishes successfully\n4. **Removed** when all tasks in a group are completed\n\n### When Todos Are Used\n\nThe SDK automatically creates todos for:\n\n- **Complex multi-step tasks** requiring 3 or more distinct actions\n- **User-provided task lists** when multiple items are mentioned\n- **Non-trivial operations** that benefit from progress tracking\n- **Explicit requests** when users ask for todo organization\n\n## Examples\n\n### Monitoring Todo Changes\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    for await (const message of query({\n      prompt: \"Optimize my React app performance and track progress with todos\",\n      options: { maxTurns: 15 }\n    })) {\n      // Todo updates are reflected in the message stream\n      if (message.type === \"assistant\") {\n        for (const block of message.message.content) {\n          if (block.type === \"tool_use\" && block.name === \"TodoWrite\") {\n            const todos = block.input.todos;\n\n            console.log(\"Todo Status Update:\");\n            todos.forEach((todo, index) => {\n              const status = todo.status === \"completed\" ? \"â\" :\n                            todo.status === \"in_progress\" ? \"ð§\" : \"â\";\n              console.log(`${index + 1}. ${status} ${todo.content}`);\n            });\n          }\n        }\n      }\n    }\n\n### Real-time Progress Display\n\n    import { query } from \"@anthropic-ai/claude-agent-sdk\";\n\n    class TodoTracker {\n      private todos: any[] = [];\n\n      displayProgress() {\n        if (this.todos.length === 0) return;\n\n        const completed = this.todos.filter(t => t.status === \"completed\").length;\n        const inProgress = this.todos.filter(t => t.status === \"in_progress\").length;\n        const total = this.todos.length;\n\n        console.log(`\\nProgress: ${completed}/${total} completed`);\n        console.log(`Currently working on: ${inProgress} task(s)\\n`);\n\n        this.todos.forEach((todo, index) => {\n          const icon = todo.status === \"completed\" ? \"â\" : \n                      todo.status === \"in_progress\" ? \"ð§\" : \"â\";\n          const text = todo.status === \"in_progress\" ? todo.activeForm : todo.content;\n          console.log(`${index + 1}. ${icon} ${text}`);\n        });\n      }\n\n      async trackQuery(prompt: string) {\n        for await (const message of query({\n          prompt,\n          options: { maxTurns: 20 }\n        })) {\n          if (message.type === \"assistant\") {\n            for (const block of message.message.content) {\n              if (block.type === \"tool_use\" && block.name === \"TodoWrite\") {\n                this.todos = block.input.todos;\n                this.displayProgress();\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Usage\n    const tracker = new TodoTracker();\n    await tracker.trackQuery(\"Build a complete authentication system with todos\");\n\n## Related Documentation\n\n- [TypeScript SDK Reference](https://platform.claude.com/docs/en/agent-sdk/typescript)\n- [Python SDK Reference](https://platform.claude.com/docs/en/agent-sdk/python)\n- [Streaming vs Single Mode](https://platform.claude.com/docs/en/agent-sdk/streaming-vs-single-mode)\n- [Custom Tools](https://platform.claude.com/docs/en/agent-sdk/custom-tools)\n",
        "plugins/claude-agent-sdk-dev/skills/claude-agent-sdk/references/agent-sdk_typescript.md": "---\ntitle: Agent SDK reference - TypeScript\nsource_url: https://platform.claude.com/docs/en/agent-sdk/typescript\n---\n\n## Installation\n\n    npm install @anthropic-ai/claude-agent-sdk\n\n## Functions\n\n### `query()`\n\nThe primary function for interacting with Claude Code. Creates an async generator that streams messages as they arrive.\n\n    function query({\n      prompt,\n      options\n    }: {\n      prompt: string | AsyncIterable<SDKUserMessage>;\n      options?: Options;\n    }): Query\n\n#### Parameters\n\n| Parameter | Type | Description |\n|----|----|----|\n| `prompt` | `string | AsyncIterable<`[`SDKUserMessage`](https://platform.claude.com/docs/en/agent-sdk/typescript#sdkusermessage)`>` | The input prompt as a string or async iterable for streaming mode |\n| `options` | [`Options`](https://platform.claude.com/docs/en/agent-sdk/typescript#options) | Optional configuration object (see Options type below) |\n\n#### Returns\n\nReturns a [`Query`](https://platform.claude.com/docs/en/agent-sdk/typescript#query-1) object that extends `AsyncGenerator<`[`SDKMessage`](https://platform.claude.com/docs/en/agent-sdk/typescript#sdkmessage)`, void>` with additional methods.\n\n### `tool()`\n\nCreates a type-safe MCP tool definition for use with SDK MCP servers.\n\n    function tool<Schema extends ZodRawShape>(\n      name: string,\n      description: string,\n      inputSchema: Schema,\n      handler: (args: z.infer<ZodObject<Schema>>, extra: unknown) => Promise<CallToolResult>\n    ): SdkMcpToolDefinition<Schema>\n\n#### Parameters\n\n| Parameter | Type | Description |\n|----|----|----|\n| `name` | `string` | The name of the tool |\n| `description` | `string` | A description of what the tool does |\n| `inputSchema` | `Schema extends ZodRawShape` | Zod schema defining the tool's input parameters |\n| `handler` | `(args, extra) => Promise<`[`CallToolResult`](https://platform.claude.com/docs/en/agent-sdk/typescript#calltoolresult)`>` | Async function that executes the tool logic |\n\n### `createSdkMcpServer()`\n\nCreates an MCP server instance that runs in the same process as your application.\n\n    function createSdkMcpServer(options: {\n      name: string;\n      version?: string;\n      tools?: Array<SdkMcpToolDefinition<any>>;\n    }): McpSdkServerConfigWithInstance\n\n#### Parameters\n\n| Parameter | Type | Description |\n|----|----|----|\n| `options.name` | `string` | The name of the MCP server |\n| `options.version` | `string` | Optional version string |\n| `options.tools` | `Array<SdkMcpToolDefinition>` | Array of tool definitions created with [`tool()`](https://platform.claude.com/docs/en/agent-sdk/typescript#tool) |\n\n## Types\n\n### `Options`\n\nConfiguration object for the `query()` function.\n\n| Property | Type | Default | Description |\n|----|----|----|----|\n| `abortController` | `AbortController` | `new AbortController()` | Controller for cancelling operations |\n| `additionalDirectories` | `string[]` | `[]` | Additional directories Claude can access |\n| `agents` | `Record<string, [`AgentDefinition`](#agentdefinition)>` | `undefined` | Programmatically define subagents |\n| `allowedTools` | `string[]` | All tools | List of allowed tool names |\n| `canUseTool` | [`CanUseTool`](https://platform.claude.com/docs/en/agent-sdk/typescript#canusetool) | `undefined` | Custom permission function for tool usage |\n| `continue` | `boolean` | `false` | Continue the most recent conversation |\n| `cwd` | `string` | `process.cwd()` | Current working directory |\n| `disallowedTools` | `string[]` | `[]` | List of disallowed tool names |\n| `env` | `Dict<string>` | `process.env` | Environment variables |\n| `executable` | `'bun' | 'deno' | 'node'` | Auto-detected | JavaScript runtime to use |\n| `executableArgs` | `string[]` | `[]` | Arguments to pass to the executable |\n| `extraArgs` | `Record<string, string | null>` | `{}` | Additional arguments |\n| `fallbackModel` | `string` | `undefined` | Model to use if primary fails |\n| `forkSession` | `boolean` | `false` | When resuming with `resume`, fork to a new session ID instead of continuing the original session |\n| `hooks` | `Partial<Record<`[`HookEvent`](https://platform.claude.com/docs/en/agent-sdk/typescript#hookevent)`,`[`HookCallbackMatcher`](https://platform.claude.com/docs/en/agent-sdk/typescript#hookcallbackmatcher)`[]>>` | `{}` | Hook callbacks for events |\n| `includePartialMessages` | `boolean` | `false` | Include partial message events |\n| `maxThinkingTokens` | `number` | `undefined` | Maximum tokens for thinking process |\n| `maxTurns` | `number` | `undefined` | Maximum conversation turns |\n| `mcpServers` | `Record<string, [`McpServerConfig`](#mcpserverconfig)>` | `{}` | MCP server configurations |\n| `model` | `string` | Default from CLI | Claude model to use |\n| `outputFormat` | `{ type: 'json_schema', schema: JSONSchema }` | `undefined` | Define output format for agent results. See [Structured outputs](https://platform.claude.com/docs/en/agent-sdk/structured-outputs) for details |\n| `pathToClaudeCodeExecutable` | `string` | Auto-detected | Path to Claude Code executable |\n| `permissionMode` | [`PermissionMode`](https://platform.claude.com/docs/en/agent-sdk/typescript#permissionmode) | `'default'` | Permission mode for the session |\n| `permissionPromptToolName` | `string` | `undefined` | MCP tool name for permission prompts |\n| `plugins` | [`SdkPluginConfig`](https://platform.claude.com/docs/en/agent-sdk/typescript#sdkpluginconfig)`[]` | `[]` | Load custom plugins from local paths. See [Plugins](https://platform.claude.com/docs/en/agent-sdk/plugins) for details |\n| `resume` | `string` | `undefined` | Session ID to resume |\n| `settingSources` | [`SettingSource`](https://platform.claude.com/docs/en/agent-sdk/typescript#settingsource)`[]` | `[]` (no settings) | Control which filesystem settings to load. When omitted, no settings are loaded. **Note:** Must include `'project'` to load CLAUDE.md files |\n| `stderr` | `(data: string) => void` | `undefined` | Callback for stderr output |\n| `strictMcpConfig` | `boolean` | `false` | Enforce strict MCP validation |\n| `systemPrompt` | `string | { type: 'preset'; preset: 'claude_code'; append?: string }` | `undefined` (empty prompt) | System prompt configuration. Pass a string for custom prompt, or `{ type: 'preset', preset: 'claude_code' }` to use Claude Code's system prompt. When using the preset object form, add `append` to extend the system prompt with additional instructions |\n\n### `Query`\n\nInterface returned by the `query()` function.\n\n    interface Query extends AsyncGenerator<SDKMessage, void> {\n      interrupt(): Promise<void>;\n      setPermissionMode(mode: PermissionMode): Promise<void>;\n    }\n\n#### Methods\n\n| Method | Description |\n|----|----|\n| `interrupt()` | Interrupts the query (only available in streaming input mode) |\n| `setPermissionMode()` | Changes the permission mode (only available in streaming input mode) |\n\n### `AgentDefinition`\n\nConfiguration for a subagent defined programmatically.\n\n    type AgentDefinition = {\n      description: string;\n      tools?: string[];\n      prompt: string;\n      model?: 'sonnet' | 'opus' | 'haiku' | 'inherit';\n    }\n\n| Field | Required | Description |\n|----|----|----|\n| `description` | Yes | Natural language description of when to use this agent |\n| `tools` | No | Array of allowed tool names. If omitted, inherits all tools |\n| `prompt` | Yes | The agent's system prompt |\n| `model` | No | Model override for this agent. If omitted, uses the main model |\n\n### `SettingSource`\n\nControls which filesystem-based configuration sources the SDK loads settings from.\n\n    type SettingSource = 'user' | 'project' | 'local';\n\n| Value | Description | Location |\n|----|----|----|\n| `'user'` | Global user settings | `~/.claude/settings.json` |\n| `'project'` | Shared project settings (version controlled) | `.claude/settings.json` |\n| `'local'` | Local project settings (gitignored) | `.claude/settings.local.json` |\n\n#### Default behavior\n\nWhen `settingSources` is **omitted** or **undefined**, the SDK does **not** load any filesystem settings. This provides isolation for SDK applications.\n\n#### Why use settingSources?\n\n**Load all filesystem settings (legacy behavior):**\n\n    // Load all settings like SDK v0.0.x did\n    const result = query({\n      prompt: \"Analyze this code\",\n      options: {\n        settingSources: ['user', 'project', 'local']  // Load all settings\n      }\n    });\n\n**Load only specific setting sources:**\n\n    // Load only project settings, ignore user and local\n    const result = query({\n      prompt: \"Run CI checks\",\n      options: {\n        settingSources: ['project']  // Only .claude/settings.json\n      }\n    });\n\n**Testing and CI environments:**\n\n    // Ensure consistent behavior in CI by excluding local settings\n    const result = query({\n      prompt: \"Run tests\",\n      options: {\n        settingSources: ['project'],  // Only team-shared settings\n        permissionMode: 'bypassPermissions'\n      }\n    });\n\n**SDK-only applications:**\n\n    // Define everything programmatically (default behavior)\n    // No filesystem dependencies - settingSources defaults to []\n    const result = query({\n      prompt: \"Review this PR\",\n      options: {\n        // settingSources: [] is the default, no need to specify\n        agents: { /* ... */ },\n        mcpServers: { /* ... */ },\n        allowedTools: ['Read', 'Grep', 'Glob']\n      }\n    });\n\n**Loading CLAUDE.md project instructions:**\n\n    // Load project settings to include CLAUDE.md files\n    const result = query({\n      prompt: \"Add a new feature following project conventions\",\n      options: {\n        systemPrompt: {\n          type: 'preset',\n          preset: 'claude_code'  // Required to use CLAUDE.md\n        },\n        settingSources: ['project'],  // Loads CLAUDE.md from project directory\n        allowedTools: ['Read', 'Write', 'Edit']\n      }\n    });\n\n#### Settings precedence\n\nWhen multiple sources are loaded, settings are merged with this precedence (highest to lowest):\n\n1. Local settings (`.claude/settings.local.json`)\n2. Project settings (`.claude/settings.json`)\n3. User settings (`~/.claude/settings.json`)\n\nProgrammatic options (like `agents`, `allowedTools`) always override filesystem settings.\n\n### `PermissionMode`\n\n    type PermissionMode =\n      | 'default'           // Standard permission behavior\n      | 'acceptEdits'       // Auto-accept file edits\n      | 'bypassPermissions' // Bypass all permission checks\n      | 'plan'              // Planning mode - no execution\n\n### `CanUseTool`\n\nCustom permission function type for controlling tool usage.\n\n    type CanUseTool = (\n      toolName: string,\n      input: ToolInput,\n      options: {\n        signal: AbortSignal;\n        suggestions?: PermissionUpdate[];\n      }\n    ) => Promise<PermissionResult>;\n\n### `PermissionResult`\n\nResult of a permission check.\n\n    type PermissionResult = \n      | {\n          behavior: 'allow';\n          updatedInput: ToolInput;\n          updatedPermissions?: PermissionUpdate[];\n        }\n      | {\n          behavior: 'deny';\n          message: string;\n          interrupt?: boolean;\n        }\n\n### `McpServerConfig`\n\nConfiguration for MCP servers.\n\n    type McpServerConfig = \n      | McpStdioServerConfig\n      | McpSSEServerConfig\n      | McpHttpServerConfig\n      | McpSdkServerConfigWithInstance;\n\n#### `McpStdioServerConfig`\n\n    type McpStdioServerConfig = {\n      type?: 'stdio';\n      command: string;\n      args?: string[];\n      env?: Record<string, string>;\n    }\n\n#### `McpSSEServerConfig`\n\n    type McpSSEServerConfig = {\n      type: 'sse';\n      url: string;\n      headers?: Record<string, string>;\n    }\n\n#### `McpHttpServerConfig`\n\n    type McpHttpServerConfig = {\n      type: 'http';\n      url: string;\n      headers?: Record<string, string>;\n    }\n\n#### `McpSdkServerConfigWithInstance`\n\n    type McpSdkServerConfigWithInstance = {\n      type: 'sdk';\n      name: string;\n      instance: McpServer;\n    }\n\n### `SdkPluginConfig`\n\nConfiguration for loading plugins in the SDK.\n\n    type SdkPluginConfig = {\n      type: 'local';\n      path: string;\n    }\n\n| Field | Type | Description |\n|----|----|----|\n| `type` | `'local'` | Must be `'local'` (only local plugins currently supported) |\n| `path` | `string` | Absolute or relative path to the plugin directory |\n\n**Example:**\n\n    plugins: [\n      { type: 'local', path: './my-plugin' },\n      { type: 'local', path: '/absolute/path/to/plugin' }\n    ]\n\nFor complete information on creating and using plugins, see [Plugins](https://platform.claude.com/docs/en/agent-sdk/plugins).\n\n## Message Types\n\n### `SDKMessage`\n\nUnion type of all possible messages returned by the query.\n\n    type SDKMessage = \n      | SDKAssistantMessage\n      | SDKUserMessage\n      | SDKUserMessageReplay\n      | SDKResultMessage\n      | SDKSystemMessage\n      | SDKPartialAssistantMessage\n      | SDKCompactBoundaryMessage;\n\n### `SDKAssistantMessage`\n\nAssistant response message.\n\n    type SDKAssistantMessage = {\n      type: 'assistant';\n      uuid: UUID;\n      session_id: string;\n      message: APIAssistantMessage; // From Anthropic SDK\n      parent_tool_use_id: string | null;\n    }\n\n### `SDKUserMessage`\n\nUser input message.\n\n    type SDKUserMessage = {\n      type: 'user';\n      uuid?: UUID;\n      session_id: string;\n      message: APIUserMessage; // From Anthropic SDK\n      parent_tool_use_id: string | null;\n    }\n\n### `SDKUserMessageReplay`\n\nReplayed user message with required UUID.\n\n    type SDKUserMessageReplay = {\n      type: 'user';\n      uuid: UUID;\n      session_id: string;\n      message: APIUserMessage;\n      parent_tool_use_id: string | null;\n    }\n\n### `SDKResultMessage`\n\nFinal result message.\n\n    type SDKResultMessage = \n      | {\n          type: 'result';\n          subtype: 'success';\n          uuid: UUID;\n          session_id: string;\n          duration_ms: number;\n          duration_api_ms: number;\n          is_error: boolean;\n          num_turns: number;\n          result: string;\n          total_cost_usd: number;\n          usage: NonNullableUsage;\n          permission_denials: SDKPermissionDenial[];\n        }\n      | {\n          type: 'result';\n          subtype: 'error_max_turns' | 'error_during_execution';\n          uuid: UUID;\n          session_id: string;\n          duration_ms: number;\n          duration_api_ms: number;\n          is_error: boolean;\n          num_turns: number;\n          total_cost_usd: number;\n          usage: NonNullableUsage;\n          permission_denials: SDKPermissionDenial[];\n        }\n\n### `SDKSystemMessage`\n\nSystem initialization message.\n\n    type SDKSystemMessage = {\n      type: 'system';\n      subtype: 'init';\n      uuid: UUID;\n      session_id: string;\n      apiKeySource: ApiKeySource;\n      cwd: string;\n      tools: string[];\n      mcp_servers: {\n        name: string;\n        status: string;\n      }[];\n      model: string;\n      permissionMode: PermissionMode;\n      slash_commands: string[];\n      output_style: string;\n    }\n\n### `SDKPartialAssistantMessage`\n\nStreaming partial message (only when `includePartialMessages` is true).\n\n    type SDKPartialAssistantMessage = {\n      type: 'stream_event';\n      event: RawMessageStreamEvent; // From Anthropic SDK\n      parent_tool_use_id: string | null;\n      uuid: UUID;\n      session_id: string;\n    }\n\n### `SDKCompactBoundaryMessage`\n\nMessage indicating a conversation compaction boundary.\n\n    type SDKCompactBoundaryMessage = {\n      type: 'system';\n      subtype: 'compact_boundary';\n      uuid: UUID;\n      session_id: string;\n      compact_metadata: {\n        trigger: 'manual' | 'auto';\n        pre_tokens: number;\n      };\n    }\n\n### `SDKPermissionDenial`\n\nInformation about a denied tool use.\n\n    type SDKPermissionDenial = {\n      tool_name: string;\n      tool_use_id: string;\n      tool_input: ToolInput;\n    }\n\n## Hook Types\n\n### `HookEvent`\n\nAvailable hook events.\n\n    type HookEvent = \n      | 'PreToolUse'\n      | 'PostToolUse'\n      | 'Notification'\n      | 'UserPromptSubmit'\n      | 'SessionStart'\n      | 'SessionEnd'\n      | 'Stop'\n      | 'SubagentStop'\n      | 'PreCompact';\n\n### `HookCallback`\n\nHook callback function type.\n\n    type HookCallback = (\n      input: HookInput, // Union of all hook input types\n      toolUseID: string | undefined,\n      options: { signal: AbortSignal }\n    ) => Promise<HookJSONOutput>;\n\n### `HookCallbackMatcher`\n\nHook configuration with optional matcher.\n\n    interface HookCallbackMatcher {\n      matcher?: string;\n      hooks: HookCallback[];\n    }\n\n### `HookInput`\n\nUnion type of all hook input types.\n\n    type HookInput = \n      | PreToolUseHookInput\n      | PostToolUseHookInput\n      | NotificationHookInput\n      | UserPromptSubmitHookInput\n      | SessionStartHookInput\n      | SessionEndHookInput\n      | StopHookInput\n      | SubagentStopHookInput\n      | PreCompactHookInput;\n\n### `BaseHookInput`\n\nBase interface that all hook input types extend.\n\n    type BaseHookInput = {\n      session_id: string;\n      transcript_path: string;\n      cwd: string;\n      permission_mode?: string;\n    }\n\n#### `PreToolUseHookInput`\n\n    type PreToolUseHookInput = BaseHookInput & {\n      hook_event_name: 'PreToolUse';\n      tool_name: string;\n      tool_input: ToolInput;\n    }\n\n#### `PostToolUseHookInput`\n\n    type PostToolUseHookInput = BaseHookInput & {\n      hook_event_name: 'PostToolUse';\n      tool_name: string;\n      tool_input: ToolInput;\n      tool_response: ToolOutput;\n    }\n\n#### `NotificationHookInput`\n\n    type NotificationHookInput = BaseHookInput & {\n      hook_event_name: 'Notification';\n      message: string;\n      title?: string;\n    }\n\n#### `UserPromptSubmitHookInput`\n\n    type UserPromptSubmitHookInput = BaseHookInput & {\n      hook_event_name: 'UserPromptSubmit';\n      prompt: string;\n    }\n\n#### `SessionStartHookInput`\n\n    type SessionStartHookInput = BaseHookInput & {\n      hook_event_name: 'SessionStart';\n      source: 'startup' | 'resume' | 'clear' | 'compact';\n    }\n\n#### `SessionEndHookInput`\n\n    type SessionEndHookInput = BaseHookInput & {\n      hook_event_name: 'SessionEnd';\n      reason: 'clear' | 'logout' | 'prompt_input_exit' | 'other';\n    }\n\n#### `StopHookInput`\n\n    type StopHookInput = BaseHookInput & {\n      hook_event_name: 'Stop';\n      stop_hook_active: boolean;\n    }\n\n#### `SubagentStopHookInput`\n\n    type SubagentStopHookInput = BaseHookInput & {\n      hook_event_name: 'SubagentStop';\n      stop_hook_active: boolean;\n    }\n\n#### `PreCompactHookInput`\n\n    type PreCompactHookInput = BaseHookInput & {\n      hook_event_name: 'PreCompact';\n      trigger: 'manual' | 'auto';\n      custom_instructions: string | null;\n    }\n\n### `HookJSONOutput`\n\nHook return value.\n\n    type HookJSONOutput = AsyncHookJSONOutput | SyncHookJSONOutput;\n\n#### `AsyncHookJSONOutput`\n\n    type AsyncHookJSONOutput = {\n      async: true;\n      asyncTimeout?: number;\n    }\n\n#### `SyncHookJSONOutput`\n\n    type SyncHookJSONOutput = {\n      continue?: boolean;\n      suppressOutput?: boolean;\n      stopReason?: string;\n      decision?: 'approve' | 'block';\n      systemMessage?: string;\n      reason?: string;\n      hookSpecificOutput?:\n        | {\n            hookEventName: 'PreToolUse';\n            permissionDecision?: 'allow' | 'deny' | 'ask';\n            permissionDecisionReason?: string;\n          }\n        | {\n            hookEventName: 'UserPromptSubmit';\n            additionalContext?: string;\n          }\n        | {\n            hookEventName: 'SessionStart';\n            additionalContext?: string;\n          }\n        | {\n            hookEventName: 'PostToolUse';\n            additionalContext?: string;\n          };\n    }\n\n## Tool Input Types\n\nDocumentation of input schemas for all built-in Claude Code tools. These types are exported from `@anthropic-ai/claude-agent-sdk` and can be used for type-safe tool interactions.\n\n### `ToolInput`\n\n**Note:** This is a documentation-only type for clarity. It represents the union of all tool input types.\n\n    type ToolInput = \n      | AgentInput\n      | BashInput\n      | BashOutputInput\n      | FileEditInput\n      | FileReadInput\n      | FileWriteInput\n      | GlobInput\n      | GrepInput\n      | KillShellInput\n      | NotebookEditInput\n      | WebFetchInput\n      | WebSearchInput\n      | TodoWriteInput\n      | ExitPlanModeInput\n      | ListMcpResourcesInput\n      | ReadMcpResourceInput;\n\n### Task\n\n**Tool name:** `Task`\n\n    interface AgentInput {\n      /**\n       * A short (3-5 word) description of the task\n       */\n      description: string;\n      /**\n       * The task for the agent to perform\n       */\n      prompt: string;\n      /**\n       * The type of specialized agent to use for this task\n       */\n      subagent_type: string;\n    }\n\nLaunches a new agent to handle complex, multi-step tasks autonomously.\n\n### Bash\n\n**Tool name:** `Bash`\n\n    interface BashInput {\n      /**\n       * The command to execute\n       */\n      command: string;\n      /**\n       * Optional timeout in milliseconds (max 600000)\n       */\n      timeout?: number;\n      /**\n       * Clear, concise description of what this command does in 5-10 words\n       */\n      description?: string;\n      /**\n       * Set to true to run this command in the background\n       */\n      run_in_background?: boolean;\n    }\n\nExecutes bash commands in a persistent shell session with optional timeout and background execution.\n\n### BashOutput\n\n**Tool name:** `BashOutput`\n\n    interface BashOutputInput {\n      /**\n       * The ID of the background shell to retrieve output from\n       */\n      bash_id: string;\n      /**\n       * Optional regex to filter output lines\n       */\n      filter?: string;\n    }\n\nRetrieves output from a running or completed background bash shell.\n\n### Edit\n\n**Tool name:** `Edit`\n\n    interface FileEditInput {\n      /**\n       * The absolute path to the file to modify\n       */\n      file_path: string;\n      /**\n       * The text to replace\n       */\n      old_string: string;\n      /**\n       * The text to replace it with (must be different from old_string)\n       */\n      new_string: string;\n      /**\n       * Replace all occurrences of old_string (default false)\n       */\n      replace_all?: boolean;\n    }\n\nPerforms exact string replacements in files.\n\n### Read\n\n**Tool name:** `Read`\n\n    interface FileReadInput {\n      /**\n       * The absolute path to the file to read\n       */\n      file_path: string;\n      /**\n       * The line number to start reading from\n       */\n      offset?: number;\n      /**\n       * The number of lines to read\n       */\n      limit?: number;\n    }\n\nReads files from the local filesystem, including text, images, PDFs, and Jupyter notebooks.\n\n### Write\n\n**Tool name:** `Write`\n\n    interface FileWriteInput {\n      /**\n       * The absolute path to the file to write\n       */\n      file_path: string;\n      /**\n       * The content to write to the file\n       */\n      content: string;\n    }\n\nWrites a file to the local filesystem, overwriting if it exists.\n\n### Glob\n\n**Tool name:** `Glob`\n\n    interface GlobInput {\n      /**\n       * The glob pattern to match files against\n       */\n      pattern: string;\n      /**\n       * The directory to search in (defaults to cwd)\n       */\n      path?: string;\n    }\n\nFast file pattern matching that works with any codebase size.\n\n### Grep\n\n**Tool name:** `Grep`\n\n    interface GrepInput {\n      /**\n       * The regular expression pattern to search for\n       */\n      pattern: string;\n      /**\n       * File or directory to search in (defaults to cwd)\n       */\n      path?: string;\n      /**\n       * Glob pattern to filter files (e.g. \"*.js\")\n       */\n      glob?: string;\n      /**\n       * File type to search (e.g. \"js\", \"py\", \"rust\")\n       */\n      type?: string;\n      /**\n       * Output mode: \"content\", \"files_with_matches\", or \"count\"\n       */\n      output_mode?: 'content' | 'files_with_matches' | 'count';\n      /**\n       * Case insensitive search\n       */\n      '-i'?: boolean;\n      /**\n       * Show line numbers (for content mode)\n       */\n      '-n'?: boolean;\n      /**\n       * Lines to show before each match\n       */\n      '-B'?: number;\n      /**\n       * Lines to show after each match\n       */\n      '-A'?: number;\n      /**\n       * Lines to show before and after each match\n       */\n      '-C'?: number;\n      /**\n       * Limit output to first N lines/entries\n       */\n      head_limit?: number;\n      /**\n       * Enable multiline mode\n       */\n      multiline?: boolean;\n    }\n\nPowerful search tool built on ripgrep with regex support.\n\n### KillBash\n\n**Tool name:** `KillBash`\n\n    interface KillShellInput {\n      /**\n       * The ID of the background shell to kill\n       */\n      shell_id: string;\n    }\n\nKills a running background bash shell by its ID.\n\n### NotebookEdit\n\n**Tool name:** `NotebookEdit`\n\n    interface NotebookEditInput {\n      /**\n       * The absolute path to the Jupyter notebook file\n       */\n      notebook_path: string;\n      /**\n       * The ID of the cell to edit\n       */\n      cell_id?: string;\n      /**\n       * The new source for the cell\n       */\n      new_source: string;\n      /**\n       * The type of the cell (code or markdown)\n       */\n      cell_type?: 'code' | 'markdown';\n      /**\n       * The type of edit (replace, insert, delete)\n       */\n      edit_mode?: 'replace' | 'insert' | 'delete';\n    }\n\nEdits cells in Jupyter notebook files.\n\n### WebFetch\n\n**Tool name:** `WebFetch`\n\n    interface WebFetchInput {\n      /**\n       * The URL to fetch content from\n       */\n      url: string;\n      /**\n       * The prompt to run on the fetched content\n       */\n      prompt: string;\n    }\n\nFetches content from a URL and processes it with an AI model.\n\n### WebSearch\n\n**Tool name:** `WebSearch`\n\n    interface WebSearchInput {\n      /**\n       * The search query to use\n       */\n      query: string;\n      /**\n       * Only include results from these domains\n       */\n      allowed_domains?: string[];\n      /**\n       * Never include results from these domains\n       */\n      blocked_domains?: string[];\n    }\n\nSearches the web and returns formatted results.\n\n### TodoWrite\n\n**Tool name:** `TodoWrite`\n\n    interface TodoWriteInput {\n      /**\n       * The updated todo list\n       */\n      todos: Array<{\n        /**\n         * The task description\n         */\n        content: string;\n        /**\n         * The task status\n         */\n        status: 'pending' | 'in_progress' | 'completed';\n        /**\n         * Active form of the task description\n         */\n        activeForm: string;\n      }>;\n    }\n\nCreates and manages a structured task list for tracking progress.\n\n### ExitPlanMode\n\n**Tool name:** `ExitPlanMode`\n\n    interface ExitPlanModeInput {\n      /**\n       * The plan to run by the user for approval\n       */\n      plan: string;\n    }\n\nExits planning mode and prompts the user to approve the plan.\n\n### ListMcpResources\n\n**Tool name:** `ListMcpResources`\n\n    interface ListMcpResourcesInput {\n      /**\n       * Optional server name to filter resources by\n       */\n      server?: string;\n    }\n\nLists available MCP resources from connected servers.\n\n### ReadMcpResource\n\n**Tool name:** `ReadMcpResource`\n\n    interface ReadMcpResourceInput {\n      /**\n       * The MCP server name\n       */\n      server: string;\n      /**\n       * The resource URI to read\n       */\n      uri: string;\n    }\n\nReads a specific MCP resource from a server.\n\n## Tool Output Types\n\nDocumentation of output schemas for all built-in Claude Code tools. These types represent the actual response data returned by each tool.\n\n### `ToolOutput`\n\n**Note:** This is a documentation-only type for clarity. It represents the union of all tool output types.\n\n    type ToolOutput = \n      | TaskOutput\n      | BashOutput\n      | BashOutputToolOutput\n      | EditOutput\n      | ReadOutput\n      | WriteOutput\n      | GlobOutput\n      | GrepOutput\n      | KillBashOutput\n      | NotebookEditOutput\n      | WebFetchOutput\n      | WebSearchOutput\n      | TodoWriteOutput\n      | ExitPlanModeOutput\n      | ListMcpResourcesOutput\n      | ReadMcpResourceOutput;\n\n### Task\n\n**Tool name:** `Task`\n\n    interface TaskOutput {\n      /**\n       * Final result message from the subagent\n       */\n      result: string;\n      /**\n       * Token usage statistics\n       */\n      usage?: {\n        input_tokens: number;\n        output_tokens: number;\n        cache_creation_input_tokens?: number;\n        cache_read_input_tokens?: number;\n      };\n      /**\n       * Total cost in USD\n       */\n      total_cost_usd?: number;\n      /**\n       * Execution duration in milliseconds\n       */\n      duration_ms?: number;\n    }\n\nReturns the final result from the subagent after completing the delegated task.\n\n### Bash\n\n**Tool name:** `Bash`\n\n    interface BashOutput {\n      /**\n       * Combined stdout and stderr output\n       */\n      output: string;\n      /**\n       * Exit code of the command\n       */\n      exitCode: number;\n      /**\n       * Whether the command was killed due to timeout\n       */\n      killed?: boolean;\n      /**\n       * Shell ID for background processes\n       */\n      shellId?: string;\n    }\n\nReturns command output with exit status. Background commands return immediately with a shellId.\n\n### BashOutput\n\n**Tool name:** `BashOutput`\n\n    interface BashOutputToolOutput {\n      /**\n       * New output since last check\n       */\n      output: string;\n      /**\n       * Current shell status\n       */\n      status: 'running' | 'completed' | 'failed';\n      /**\n       * Exit code (when completed)\n       */\n      exitCode?: number;\n    }\n\nReturns incremental output from background shells.\n\n### Edit\n\n**Tool name:** `Edit`\n\n    interface EditOutput {\n      /**\n       * Confirmation message\n       */\n      message: string;\n      /**\n       * Number of replacements made\n       */\n      replacements: number;\n      /**\n       * File path that was edited\n       */\n      file_path: string;\n    }\n\nReturns confirmation of successful edits with replacement count.\n\n### Read\n\n**Tool name:** `Read`\n\n    type ReadOutput = \n      | TextFileOutput\n      | ImageFileOutput\n      | PDFFileOutput\n      | NotebookFileOutput;\n\n    interface TextFileOutput {\n      /**\n       * File contents with line numbers\n       */\n      content: string;\n      /**\n       * Total number of lines in file\n       */\n      total_lines: number;\n      /**\n       * Lines actually returned\n       */\n      lines_returned: number;\n    }\n\n    interface ImageFileOutput {\n      /**\n       * Base64 encoded image data\n       */\n      image: string;\n      /**\n       * Image MIME type\n       */\n      mime_type: string;\n      /**\n       * File size in bytes\n       */\n      file_size: number;\n    }\n\n    interface PDFFileOutput {\n      /**\n       * Array of page contents\n       */\n      pages: Array<{\n        page_number: number;\n        text?: string;\n        images?: Array<{\n          image: string;\n          mime_type: string;\n        }>;\n      }>;\n      /**\n       * Total number of pages\n       */\n      total_pages: number;\n    }\n\n    interface NotebookFileOutput {\n      /**\n       * Jupyter notebook cells\n       */\n      cells: Array<{\n        cell_type: 'code' | 'markdown';\n        source: string;\n        outputs?: any[];\n        execution_count?: number;\n      }>;\n      /**\n       * Notebook metadata\n       */\n      metadata?: Record<string, any>;\n    }\n\nReturns file contents in format appropriate to file type.\n\n### Write\n\n**Tool name:** `Write`\n\n    interface WriteOutput {\n      /**\n       * Success message\n       */\n      message: string;\n      /**\n       * Number of bytes written\n       */\n      bytes_written: number;\n      /**\n       * File path that was written\n       */\n      file_path: string;\n    }\n\nReturns confirmation after successfully writing the file.\n\n### Glob\n\n**Tool name:** `Glob`\n\n    interface GlobOutput {\n      /**\n       * Array of matching file paths\n       */\n      matches: string[];\n      /**\n       * Number of matches found\n       */\n      count: number;\n      /**\n       * Search directory used\n       */\n      search_path: string;\n    }\n\nReturns file paths matching the glob pattern, sorted by modification time.\n\n### Grep\n\n**Tool name:** `Grep`\n\n    type GrepOutput = \n      | GrepContentOutput\n      | GrepFilesOutput\n      | GrepCountOutput;\n\n    interface GrepContentOutput {\n      /**\n       * Matching lines with context\n       */\n      matches: Array<{\n        file: string;\n        line_number?: number;\n        line: string;\n        before_context?: string[];\n        after_context?: string[];\n      }>;\n      /**\n       * Total number of matches\n       */\n      total_matches: number;\n    }\n\n    interface GrepFilesOutput {\n      /**\n       * Files containing matches\n       */\n      files: string[];\n      /**\n       * Number of files with matches\n       */\n      count: number;\n    }\n\n    interface GrepCountOutput {\n      /**\n       * Match counts per file\n       */\n      counts: Array<{\n        file: string;\n        count: number;\n      }>;\n      /**\n       * Total matches across all files\n       */\n      total: number;\n    }\n\nReturns search results in the format specified by output_mode.\n\n### KillBash\n\n**Tool name:** `KillBash`\n\n    interface KillBashOutput {\n      /**\n       * Success message\n       */\n      message: string;\n      /**\n       * ID of the killed shell\n       */\n      shell_id: string;\n    }\n\nReturns confirmation after terminating the background shell.\n\n### NotebookEdit\n\n**Tool name:** `NotebookEdit`\n\n    interface NotebookEditOutput {\n      /**\n       * Success message\n       */\n      message: string;\n      /**\n       * Type of edit performed\n       */\n      edit_type: 'replaced' | 'inserted' | 'deleted';\n      /**\n       * Cell ID that was affected\n       */\n      cell_id?: string;\n      /**\n       * Total cells in notebook after edit\n       */\n      total_cells: number;\n    }\n\nReturns confirmation after modifying the Jupyter notebook.\n\n### WebFetch\n\n**Tool name:** `WebFetch`\n\n    interface WebFetchOutput {\n      /**\n       * AI model's response to the prompt\n       */\n      response: string;\n      /**\n       * URL that was fetched\n       */\n      url: string;\n      /**\n       * Final URL after redirects\n       */\n      final_url?: string;\n      /**\n       * HTTP status code\n       */\n      status_code?: number;\n    }\n\nReturns the AI's analysis of the fetched web content.\n\n### WebSearch\n\n**Tool name:** `WebSearch`\n\n    interface WebSearchOutput {\n      /**\n       * Search results\n       */\n      results: Array<{\n        title: string;\n        url: string;\n        snippet: string;\n        /**\n         * Additional metadata if available\n         */\n        metadata?: Record<string, any>;\n      }>;\n      /**\n       * Total number of results\n       */\n      total_results: number;\n      /**\n       * The query that was searched\n       */\n      query: string;\n    }\n\nReturns formatted search results from the web.\n\n### TodoWrite\n\n**Tool name:** `TodoWrite`\n\n    interface TodoWriteOutput {\n      /**\n       * Success message\n       */\n      message: string;\n      /**\n       * Current todo statistics\n       */\n      stats: {\n        total: number;\n        pending: number;\n        in_progress: number;\n        completed: number;\n      };\n    }\n\nReturns confirmation with current task statistics.\n\n### ExitPlanMode\n\n**Tool name:** `ExitPlanMode`\n\n    interface ExitPlanModeOutput {\n      /**\n       * Confirmation message\n       */\n      message: string;\n      /**\n       * Whether user approved the plan\n       */\n      approved?: boolean;\n    }\n\nReturns confirmation after exiting plan mode.\n\n### ListMcpResources\n\n**Tool name:** `ListMcpResources`\n\n    interface ListMcpResourcesOutput {\n      /**\n       * Available resources\n       */\n      resources: Array<{\n        uri: string;\n        name: string;\n        description?: string;\n        mimeType?: string;\n        server: string;\n      }>;\n      /**\n       * Total number of resources\n       */\n      total: number;\n    }\n\nReturns list of available MCP resources.\n\n### ReadMcpResource\n\n**Tool name:** `ReadMcpResource`\n\n    interface ReadMcpResourceOutput {\n      /**\n       * Resource contents\n       */\n      contents: Array<{\n        uri: string;\n        mimeType?: string;\n        text?: string;\n        blob?: string;\n      }>;\n      /**\n       * Server that provided the resource\n       */\n      server: string;\n    }\n\nReturns the contents of the requested MCP resource.\n\n## Permission Types\n\n### `PermissionUpdate`\n\nOperations for updating permissions.\n\n    type PermissionUpdate = \n      | {\n          type: 'addRules';\n          rules: PermissionRuleValue[];\n          behavior: PermissionBehavior;\n          destination: PermissionUpdateDestination;\n        }\n      | {\n          type: 'replaceRules';\n          rules: PermissionRuleValue[];\n          behavior: PermissionBehavior;\n          destination: PermissionUpdateDestination;\n        }\n      | {\n          type: 'removeRules';\n          rules: PermissionRuleValue[];\n          behavior: PermissionBehavior;\n          destination: PermissionUpdateDestination;\n        }\n      | {\n          type: 'setMode';\n          mode: PermissionMode;\n          destination: PermissionUpdateDestination;\n        }\n      | {\n          type: 'addDirectories';\n          directories: string[];\n          destination: PermissionUpdateDestination;\n        }\n      | {\n          type: 'removeDirectories';\n          directories: string[];\n          destination: PermissionUpdateDestination;\n        }\n\n### `PermissionBehavior`\n\n    type PermissionBehavior = 'allow' | 'deny' | 'ask';\n\n### `PermissionUpdateDestination`\n\n    type PermissionUpdateDestination = \n      | 'userSettings'     // Global user settings\n      | 'projectSettings'  // Per-directory project settings\n      | 'localSettings'    // Gitignored local settings\n      | 'session'          // Current session only\n\n### `PermissionRuleValue`\n\n    type PermissionRuleValue = {\n      toolName: string;\n      ruleContent?: string;\n    }\n\n## Other Types\n\n### `ApiKeySource`\n\n    type ApiKeySource = 'user' | 'project' | 'org' | 'temporary';\n\n### `ConfigScope`\n\n    type ConfigScope = 'local' | 'user' | 'project';\n\n### `NonNullableUsage`\n\nA version of [`Usage`](https://platform.claude.com/docs/en/agent-sdk/typescript#usage) with all nullable fields made non-nullable.\n\n    type NonNullableUsage = {\n      [K in keyof Usage]: NonNullable<Usage[K]>;\n    }\n\n### `Usage`\n\nToken usage statistics (from `@anthropic-ai/sdk`).\n\n    type Usage = {\n      input_tokens: number | null;\n      output_tokens: number | null;\n      cache_creation_input_tokens?: number | null;\n      cache_read_input_tokens?: number | null;\n    }\n\n### `CallToolResult`\n\nMCP tool result type (from `@modelcontextprotocol/sdk/types.js`).\n\n    type CallToolResult = {\n      content: Array<{\n        type: 'text' | 'image' | 'resource';\n        // Additional fields vary by type\n      }>;\n      isError?: boolean;\n    }\n\n### `AbortError`\n\nCustom error class for abort operations.\n\n    class AbortError extends Error {}\n\n## See also\n\n- [SDK overview](https://platform.claude.com/docs/en/agent-sdk/overview) - General SDK concepts\n- [Python SDK reference](https://platform.claude.com/docs/en/agent-sdk/python) - Python SDK documentation\n- [CLI reference](https://code.claude.com/docs/en/cli-reference) - Command-line interface\n- [Common workflows](https://code.claude.com/docs/en/common-workflows) - Step-by-step guides\n",
        "plugins/claude-code-meta/skills/claude-code-hooks/SKILL.md": "---\nname: claude-code-hooks\ndescription: Claude Code hooks configuration patterns, event types, validation scripts, and decision control for automating workflows and integrating external tools. This skill should be used when creating hooks, validating tool usage, automating workflows, or integrating external tools with Claude Code.\n---\n\n# Claude Code Hooks\n\nThis skill provides assistance for working with Claude Code hooks to enable automation of workflows and integration of external tools through an event-driven system.\n\n## About Hooks\n\nHooks are event-driven automation scripts that execute automatically when specific events occur during Claude Code's operation. Think of them as \"middleware\" for Claude's actionsâthey intercept events to validate inputs, enrich context, automate workflows, or integrate external tools, transforming Claude from a general assistant into a policy-aware, context-enriched agent.\n\n### What Hooks Provide\n\n1. **Input validation** - Block dangerous operations, enforce security policies, prevent path traversal\n2. **Workflow automation** - Auto-format code, run linters, backup files, send notifications\n3. **Context enrichment** - Load git status, inject project context, add session information\n4. **External integration** - Connect to APIs, trigger CI/CD, log to external systems\n5. **Decision control** - Auto-approve safe operations, require confirmation for sensitive actions\n\n### Anatomy of a Hook\n\nEvery hook consists of configuration in settings.json and an optional validation script:\n\n```\n.claude/\nâââ settings.json         - Hook configuration (required)\nâ   âââ hooks:\nâ       âââ EventName:    - Which event to hook (PreToolUse, PostToolUse, etc.)\nâ           âââ matcher:  - Which tools to match (regex pattern)\nâ               âââ command: - What to execute (shell command or script)\nâââ hooks/                - Hook scripts (optional)\n    âââ script-name.py    - Validation/automation logic\n```\n\n#### Configuration (required)\n\nHooks are configured in settings.json with event type, tool matcher, and command:\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PROJECT_DIR}/.claude/hooks/validate-bash.py\",\n            \"timeout\": 60\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n#### Hook Scripts (optional)\n\nScripts receive JSON via stdin and communicate via exit codes:\n\n- **Exit 0** - Success (output shown in transcript or added as context)\n- **Exit 2** - Blocking error (stderr shown to Claude for processing)\n- **Other** - Non-blocking error (stderr shown to user)\n\nScripts can also output JSON for advanced control (permission decisions, additional context, custom output).\n\n### Hook Execution Flow\n\nHooks use a three-phase execution system:\n\n1. **Event triggered** - Claude performs action (e.g., runs Bash tool)\n2. **Hook executes** - Script receives event data via stdin, processes, exits with code\n3. **Decision applied** - Based on exit code/JSON output, Claude proceeds, blocks, or receives additional context\n\n## Hook Events Overview\n\nClaude Code supports these hook events:\n\n**PreToolUse** - Execute before a tool runs. Use for validation, blocking dangerous operations, or auto-approving safe actions.\n\n**PostToolUse** - Execute after a tool completes. Use for formatting code, running linters, sending notifications, or providing feedback to Claude.\n\n**UserPromptSubmit** - Execute when user submits a prompt. Use for adding contextual information, validating prompt content, or blocking sensitive data.\n\n**SessionStart** - Execute when Claude Code starts or resumes. Use for loading recent commits, showing current branch, displaying open issues, or initializing session context.\n\n**SessionEnd** - Execute when a session ends. Use for saving statistics, cleaning temporary files, or logging activity.\n\n**Stop/SubagentStop** - Execute when Claude attempts to stop. Use for ensuring tasks are complete or forcing continuation if needed.\n\n**PreCompact** - Execute before conversation history compaction. Use for saving important context or logging stats.\n\n**Notification** - Execute when Claude Code sends notifications. Use for forwarding to external systems or logging events.\n\nFor detailed information on each event type, see [references/hook-events.md](references/hook-events.md).\n\n## Basic Hook Configuration\n\nHooks are configured in settings.json files with this structure:\n\n```json\n{\n  \"hooks\": {\n    \"EventName\": [\n      {\n        \"matcher\": \"ToolPattern\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"path/to/script.py\",\n            \"timeout\": 60\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n**Key elements:**\n\n- `matcher`: Pattern to match tool names (e.g., `\"Write|Edit\"`, `\"Bash\"`, `\"*\"` for all)\n- `command`: Shell command or script to execute\n- `timeout`: Maximum execution time in seconds (default: 60)\n\nUse environment variables in commands:\n\n- `CLAUDE_PROJECT_DIR` - Project root directory\n- `CLAUDE_PLUGIN_ROOT` - Plugin directory (plugin hooks only)\n\n## Hook Scripts\n\n### Exit Codes\n\nHook scripts communicate through exit codes:\n\n- `0` - Success (stdout shown in transcript, or added as context for UserPromptSubmit/SessionStart)\n- `2` - Blocking error (stderr shown to Claude for processing)\n- Other - Non-blocking error (stderr shown to user)\n\n### Input Format\n\nHooks receive JSON via stdin with session information and event-specific data:\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\n\ninput_data = json.load(sys.stdin)\ntool_name = input_data.get(\"tool_name\")\ntool_input = input_data.get(\"tool_input\", {})\n\n# Hook logic here\nsys.exit(0)\n```\n\n### Output Format\n\nFor simple hooks, use exit codes. For advanced control, output JSON:\n\n```python\nimport json\n\noutput = {\n    \"decision\": \"block\",  # or undefined\n    \"reason\": \"Explanation\",\n    \"hookSpecificOutput\": {\n        \"hookEventName\": \"PreToolUse\",\n        \"permissionDecision\": \"allow\",  # \"allow\", \"deny\", \"ask\"\n        \"additionalContext\": \"Context for Claude\"\n    }\n}\n\nprint(json.dumps(output))\nsys.exit(0)\n```\n\n## Common Patterns\n\nFor detailed hook implementation:\n\n- [references/implementation-guide.md](references/implementation-guide.md) - Quick patterns and complete examples\n- [references/best-practices.md](references/best-practices.md) - Security, performance, and maintainability\n\n## Configuration Locations\n\n**User hooks:** `~/.claude/settings.json` - Personal preferences, cross-project automation\n\n**Project hooks:** `.claude/settings.json` - Team workflows, project-specific validations\n\n**Local hooks:** `.claude/settings.local.json` - Local testing, not committed to git\n\n**Plugin hooks:** `plugins/{name}/hooks/hooks.json` - Reusable workflows for plugins\n\n## MCP Integration\n\nHooks work with MCP tools using the naming pattern `mcp__<server>__<tool>`:\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"mcp__github__.*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PROJECT_DIR}/.claude/hooks/validate-github.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Hook Creation Process\n\nTo create a hook, follow the \"Hook Creation Process\" in order, skipping steps only if there is a clear reason they are not applicable.\n\n### Step 1: Understanding the Hook Requirements\n\nSkip this step only when the hook's purpose and triggering conditions are already clearly understood.\n\nTo create an effective hook, clearly understand concrete examples of when the hook should trigger and what it should do. This understanding can come from either specific use cases or scenarios that need automation.\n\nFor example, when building a bash validation hook, relevant considerations include:\n\n- \"What dangerous bash commands should be blocked?\"\n- \"Should the hook allow sudo/rm -rf commands, or block them entirely?\"\n- \"What feedback should Claude receive when a command is blocked?\"\n- \"Are there any commands that should always be allowed despite matching block patterns?\"\n\nFor a code formatting hook:\n\n- \"Which file types need formatting? Python, JavaScript, both?\"\n- \"Should formatting failures block the operation or just warn?\"\n- \"What formatter tools are installed in the environment?\"\n\nConclude this step when there is a clear sense of what the hook should accomplish and when it should trigger.\n\n### Step 2: Planning the Hook Implementation\n\nTo turn requirements into an effective hook, analyze the use case by:\n\n1. Identifying which hook event is appropriate (PreToolUse for validation, PostToolUse for formatting, etc.)\n2. Determining the tool matcher pattern (specific tools like \"Bash\", wildcards like \"Write|Edit\", or \"*\" for all)\n3. Deciding if a simple command or script is needed\n\nExample: For blocking dangerous bash commands, the analysis shows:\n\n1. Use **PreToolUse** event (validate before execution)\n2. Match **\"Bash\"** tool specifically\n3. Need a **script** with pattern matching and exit code 2 for blocking\n\nExample: For auto-formatting code after edits, the analysis shows:\n\n1. Use **PostToolUse** event (format after write completes)\n2. Match **\"Write|Edit\"** tools\n3. Need a **script** that detects file extension and runs appropriate formatter\n\nReview [references/hook-events.md](references/hook-events.md) for event-specific details and [references/implementation-guide.md](references/implementation-guide.md) for code patterns.\n\n### Step 3: Choosing Configuration Location\n\nAt this point, determine where the hook configuration should live:\n\n- **User hooks** (`~/.claude/settings.json`) - Personal preferences that apply across all projects\n- **Project hooks** (`.claude/settings.json`) - Team workflows and project-specific policies\n- **Local hooks** (`.claude/settings.local.json`) - Testing and development, not committed to git\n- **Plugin hooks** (`plugins/{name}/hooks/hooks.json`) - Reusable workflows distributed with plugins\n\nChoose user-level for personal automation (e.g., \"always load git context at session start\").\n\nChoose project-level for team policies (e.g., \"block commits with sensitive data\").\n\nChoose local-level for testing hooks before committing to the project.\n\n### Step 4: Implementing the Hook\n\nWhen implementing the hook, start with the simplest approach that meets requirements.\n\n#### For Simple Hooks\n\nIf the hook just needs to run a command without validation, use inline commands:\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"black \\\"${file_path}\\\"\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n#### For Validation Hooks\n\nIf the hook needs to make decisions, create a script:\n\n1. Create script file: `.claude/hooks/validate-bash.py`\n2. Implement validation logic with exit codes (0 = allow, 2 = block, other = error)\n3. Reference script in configuration with absolute path using `${CLAUDE_PROJECT_DIR}`\n\nReference [references/implementation-guide.md](references/implementation-guide.md) for quick patterns and production-ready examples.\n\n**Writing Style:** Focus on information that would be beneficial and non-obvious to the hook script. Consider security implications, edge cases, and performance optimizations from [references/best-practices.md](references/best-practices.md).\n\n### Step 5: Testing and Debugging\n\nOnce the hook is configured, test it thoroughly before relying on it:\n\n#### Test Manually\n\nTest the hook script independently before integrating:\n\n```bash\n# Create test input\necho '{\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"rm -rf /\"}}' | \\\n  .claude/hooks/validate-bash.py\n\n# Check exit code\necho \"Exit code: $?\"\n\n# Check stderr output\necho '{\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"rm -rf /\"}}' | \\\n  .claude/hooks/validate-bash.py 2>&1\n```\n\n#### Test in Claude Code\n\nRun Claude Code with debug mode to see hook execution:\n\n```bash\nclaude --debug\n```\n\nThis shows:\n\n- Hook loading and configuration\n- Hook execution timing\n- Hook output and exit codes\n- Decision outcomes\n\nUse transcript mode (Ctrl-R) to see hook progress messages in the conversation timeline.\n\n### Step 6: Iterate\n\nAfter deploying the hook, users may encounter edge cases or request improvements. This often happens during real usage when unexpected scenarios arise.\n\n**Iteration workflow:**\n\n1. **Use the hook** on real tasks and observe behavior\n2. **Notice struggles** - Does it block too much? Too little? Miss edge cases?\n3. **Identify improvements** - Should validation be stricter? Should error messages be clearer?\n4. **Update implementation** - Modify script logic or configuration\n5. **Test changes** - Use manual testing and `claude --debug` to verify improvements\n",
        "plugins/claude-code-meta/skills/claude-code-hooks/references/best-practices.md": "# Hook Best Practices\n\nSecurity, performance, reliability, and maintainability guidelines for Claude Code hooks.\n\n## Security Best Practices\n\n### Input Validation\n\nAlways validate and sanitize inputs:\n\n```python\n# DON'T: Trust input blindly\ncommand = input_data.get(\"tool_input\", {}).get(\"command\")\nos.system(command)  # DANGEROUS!\n\n# DO: Validate and sanitize\ncommand = input_data.get(\"tool_input\", {}).get(\"command\", \"\")\nif not command or not validate_command(command):\n    print(\"Invalid command\", file=sys.stderr)\n    sys.exit(2)\n```\n\n### Shell Quoting\n\nAlways quote shell variables:\n\n```bash\n# DON'T: Unquoted variables\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path')\ncat $file_path  # Shell injection risk!\n\n# DO: Quote variables\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path')\ncat \"$file_path\"  # Safe\n```\n\n### Path Traversal Prevention\n\nCheck for path traversal attacks:\n\n```python\ndef is_safe_path(base_dir, file_path):\n    \"\"\"Prevent ../../../etc/passwd attacks\"\"\"\n    try:\n        base = Path(base_dir).resolve()\n        target = Path(file_path).resolve()\n        return target.is_relative_to(base)\n    except (ValueError, OSError):\n        return False\n\n# Use it\nif not is_safe_path(project_dir, file_path):\n    print(\"Path traversal detected\", file=sys.stderr)\n    sys.exit(2)\n```\n\n### Sensitive File Protection\n\nSkip sensitive files:\n\n```python\nSENSITIVE_PATHS = (\n    \".env\", \".env.local\", \".env.production\",\n    \".git/config\", \".ssh/\", \"id_rsa\",\n    \"credentials.json\", \"secrets.yaml\",\n    \".aws/credentials\"\n)\n\ndef is_sensitive(file_path):\n    return any(p in file_path for p in SENSITIVE_PATHS)\n\nif is_sensitive(file_path):\n    print(\"Sensitive file access blocked\", file=sys.stderr)\n    sys.exit(2)\n```\n\n### Secret Detection\n\nScan for hardcoded secrets:\n\n```python\nSECRET_PATTERNS = [\n    r'ghp_[a-zA-Z0-9]{36}',  # GitHub token\n    r'sk_live_[a-zA-Z0-9]{24,}',  # Stripe key\n    r'xoxb-[a-zA-Z0-9-]+',  # Slack token\n    r'AKIA[0-9A-Z]{16}',  # AWS key\n    r'(?i)password\\s*[:=]\\s*[\"\\']?[\\w!@#$%^&*]{8,}',\n]\n\ndef contains_secrets(text):\n    return any(re.search(p, text) for p in SECRET_PATTERNS)\n```\n\n### Use Absolute Paths\n\nAlways use absolute paths for scripts:\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/script.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Performance Best Practices\n\n### Keep Hooks Fast\n\nHooks should complete quickly (<1s ideal, <5s maximum):\n\n```python\n# DON'T: Slow operations\nresult = requests.get(\"https://api.example.com/slow\")  # May take seconds\n\n# DO: Quick checks, background for slow operations\nif should_run_slow_check():\n    subprocess.Popen([\"./slow-check.sh\", file_path])  # Background\nsys.exit(0)\n```\n\n### Exit Early\n\nSkip unnecessary processing:\n\n```python\n# DON'T: Process everything\ninput_data = json.load(sys.stdin)\ntool_name = input_data.get(\"tool_name\")\n# ... lots of processing ...\nif tool_name != \"Bash\":\n    sys.exit(0)\n\n# DO: Exit early\ninput_data = json.load(sys.stdin)\nif input_data.get(\"tool_name\") != \"Bash\":\n    sys.exit(0)\n# ... relevant processing only ...\n```\n\n### Cache Expensive Operations\n\nCache when possible:\n\n```python\nimport functools\n\n@functools.lru_cache(maxsize=128)\ndef get_project_config():\n    \"\"\"Cached config loading\"\"\"\n    with open(\".project-config.json\") as f:\n        return json.load(f)\n```\n\n### Set Appropriate Timeouts\n\nConfigure timeouts based on operation:\n\n```json\n{\n  \"hooks\": [\n    {\n      \"type\": \"command\",\n      \"command\": \"quick-check.sh\",\n      \"timeout\": 5\n    },\n    {\n      \"type\": \"command\",\n      \"command\": \"slow-formatter.sh\",\n      \"timeout\": 30\n    }\n  ]\n}\n```\n\n### Minimize Tool Dependencies\n\nOnly import what's needed:\n\n```python\n# DON'T: Import everything\nimport json, sys, os, re, subprocess, pathlib, datetime, requests\n\n# DO: Import only what's used\nimport json\nimport sys\n```\n\n## Reliability Best Practices\n\n### Error Handling\n\nHandle errors gracefully:\n\n```python\ntry:\n    result = subprocess.run(\n        [\"formatter\", file_path],\n        capture_output=True,\n        text=True,\n        timeout=30,\n        check=True\n    )\nexcept FileNotFoundError:\n    print(\"Formatter not installed\", file=sys.stderr)\n    sys.exit(1)\nexcept subprocess.TimeoutExpired:\n    print(\"Formatting timed out\", file=sys.stderr)\n    sys.exit(1)\nexcept subprocess.CalledProcessError as e:\n    print(f\"Formatting failed: {e.stderr}\", file=sys.stderr)\n    sys.exit(1)\nexcept Exception as e:\n    print(f\"Unexpected error: {e}\", file=sys.stderr)\n    sys.exit(1)\n```\n\n### Validate JSON Schema\n\nCheck for required fields:\n\n```python\ndef validate_input(data):\n    \"\"\"Validate hook input has required fields\"\"\"\n    required = [\"session_id\", \"hook_event_name\"]\n    for field in required:\n        if field not in data:\n            print(f\"Missing required field: {field}\", file=sys.stderr)\n            sys.exit(1)\n\ninput_data = json.load(sys.stdin)\nvalidate_input(input_data)\n```\n\n### Handle Missing Dependencies\n\nCheck for required tools:\n\n```python\nimport shutil\n\ndef check_dependencies():\n    \"\"\"Ensure required tools are available\"\"\"\n    required_tools = [\"black\", \"pylint\"]\n    missing = [t for t in required_tools if not shutil.which(t)]\n\n    if missing:\n        print(f\"Missing tools: {', '.join(missing)}\", file=sys.stderr)\n        print(\"Install with: pip install black pylint\", file=sys.stderr)\n        sys.exit(1)\n```\n\n### Provide Clear Error Messages\n\nMake errors actionable:\n\n```python\n# DON'T: Vague error\nprint(\"Error\", file=sys.stderr)\n\n# DO: Specific, actionable error\nprint(\"\"\"\nâ Linting failed for {file_path}\n\nIssues found:\n{issues}\n\nFix with: pylint {file_path}\nOr disable: # pylint: disable=rule-name\n\"\"\", file=sys.stderr)\n```\n\n## Maintainability Best Practices\n\n### Document Hook Purpose\n\nInclude clear documentation:\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nValidates Bash commands before execution.\n\nBlocks:\n- rm -rf commands targeting system directories\n- sudo/su privilege escalation\n- Direct device access\n\nExit codes:\n- 0: Command allowed\n- 2: Command blocked\n- 1: Validation error\n\"\"\"\n```\n\n### Use Descriptive Names\n\nName hooks clearly:\n\n```bash\n# DON'T: Generic names\nhook1.py\ncheck.sh\nvalidator.py\n\n# DO: Descriptive names\nvalidate-bash-security.py\nauto-format-python.py\ncheck-git-clean.sh\n```\n\n### Version Control\n\nTrack hooks in git:\n\n```bash\n# Add hooks to git\ngit add .claude/hooks/\ngit commit -m \"Add bash validation hook\"\n\n# Add to .gitignore if needed (for local hooks)\necho \".claude/settings.local.json\" >> .gitignore\n```\n\n### README Documentation\n\nDocument hooks in project README:\n\n```markdown\n## Claude Code Hooks\n\nThis project uses the following hooks:\n\n### PreToolUse Hooks\n- **validate-bash.py**: Blocks dangerous bash commands\n- **check-paths.py**: Prevents path traversal\n\n### PostToolUse Hooks\n- **auto-format.py**: Formats Python files with black\n\n### Setup\n```bash\nchmod +x .claude/hooks/*.py\n```\n```\n\n### Configuration Comments\n\nAdd comments to settings.json:\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/validate-bash.py\"\n            // Blocks rm -rf, sudo, and other dangerous commands\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Configuration Best Practices\n\n### Use Project-Level Hooks for Team\n\nShare hooks with team:\n\n```bash\n# .claude/settings.json (committed to git)\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/validate.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Use User-Level Hooks for Personal\n\nPersonal preferences:\n\n```bash\n# ~/.claude/settings.json (not in git)\n{\n  \"hooks\": {\n    \"SessionStart\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"~/.claude/hooks/my-personal-setup.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Use Local Hooks for Testing\n\nTest hooks without affecting team:\n\n```bash\n# .claude/settings.local.json (gitignored)\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/test-hook.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Organize Hooks by Purpose\n\n```\n.claude/\nâââ hooks/\nâ   âââ security/\nâ   â   âââ validate-bash.py\nâ   â   âââ check-secrets.py\nâ   âââ formatting/\nâ   â   âââ auto-format.py\nâ   â   âââ run-linters.py\nâ   âââ git/\nâ       âââ check-clean.py\nâ       âââ load-context.py\nâââ settings.json\n```\n\n## Stop Hook Safety\n\nPrevent infinite loops in Stop hooks:\n\n```python\n# ALWAYS check stop_hook_active\nif input_data.get(\"stop_hook_active\"):\n    sys.exit(0)  # Allow stopping if already in stop hook\n\n# Your validation logic\nhas_issues = check_for_issues()\n\nif has_issues:\n    output = {\"decision\": \"block\", \"reason\": \"Fix issues first\"}\n    print(json.dumps(output))\n    sys.exit(0)\n```\n\n## Progressive Enhancement\n\nStart simple, add complexity as needed:\n\n**Phase 1: Basic validation**\n```python\nif \"rm -rf /\" in command:\n    sys.exit(2)\n```\n\n**Phase 2: Pattern matching**\n```python\nif re.search(r'\\brm\\s+-rf\\s+/', command):\n    sys.exit(2)\n```\n\n**Phase 3: Comprehensive rules**\n```python\nfor pattern, message in RULES:\n    if re.search(pattern, command):\n        print(message, file=sys.stderr)\n        sys.exit(2)\n```\n\n**Phase 4: JSON output with context**\n```python\noutput = {\n    \"decision\": \"block\",\n    \"reason\": message,\n    \"hookSpecificOutput\": {...}\n}\nprint(json.dumps(output))\n```\n\n## Security Checklist\n\nBefore deploying hooks to production:\n\n- [ ] All user inputs are validated and sanitized\n- [ ] Shell variables are properly quoted\n- [ ] Path traversal attacks are prevented\n- [ ] Sensitive file access is blocked or logged\n- [ ] No hardcoded secrets in hook scripts\n- [ ] Absolute paths used for all script references\n- [ ] Stop hooks check `stop_hook_active` flag\n- [ ] Error messages don't leak sensitive information\n- [ ] Hooks run with minimum required permissions\n- [ ] External commands use full paths or validation\n\n## Performance Checklist\n\nBefore deploying hooks to production:\n\n- [ ] Hooks complete in <1s for common operations\n- [ ] Maximum timeout set appropriately (5-30s)\n- [ ] Early exit for non-matching tools\n- [ ] Expensive operations are cached\n- [ ] Slow operations run in background\n- [ ] Minimal dependencies imported\n- [ ] No blocking network calls in critical path\n- [ ] File I/O is minimized\n- [ ] Regex patterns are optimized\n- [ ] Hook doesn't process unnecessary data\n\n## Reliability Checklist\n\nBefore deploying hooks to production:\n\n- [ ] All exceptions are caught and handled\n- [ ] Missing dependencies are checked at startup\n- [ ] Required fields in input JSON are validated\n- [ ] Timeout errors are handled gracefully\n- [ ] Error messages are clear and actionable\n- [ ] Hooks tested with edge cases\n- [ ] Hooks tested with malformed input\n- [ ] Fallback behavior defined for failures\n- [ ] Logs capture enough detail for debugging\n- [ ] Hooks fail safely (allow operation on error)\n",
        "plugins/claude-code-meta/skills/claude-code-hooks/references/hook-events.md": "# Hook Events Reference\n\nComplete reference for all Claude Code hook event types, their behaviors, and use cases.\n\n## Claude Code Tools Reference\n\nComplete list of all Claude Code tools that can be matched by hooks. Use these tool names in matcher patterns to intercept specific operations.\n\n### Core File Operations\n\n**Read** - Read file contents from the filesystem\n\n- **Hook use cases**: Auto-approve documentation reads, audit sensitive file access, inject file context\n- **Example matcher**: `\"Read\"`\n- **Common validations**: Check for sensitive paths (.env, credentials), verify file exists in project\n\n**Write** - Create new files or overwrite existing files\n\n- **Hook use cases**: Format code after write, backup files, validate file paths, block overwriting sensitive files\n- **Example matcher**: `\"Write\"`\n- **Common validations**: Prevent path traversal, block sensitive file creation, enforce naming conventions\n\n**Edit** - Modify existing files with find/replace operations\n\n- **Hook use cases**: Auto-format after edits, run linters, create backup copies, validate changes\n- **Example matcher**: `\"Edit\"` or `\"Write|Edit\"` for both\n- **Common validations**: Block edits to sensitive files, verify file exists, check edit safety\n\n**NotebookEdit** - Edit Jupyter notebook (.ipynb) cells\n\n- **Hook use cases**: Validate notebook cell changes, auto-format code cells, backup notebooks\n- **Example matcher**: `\"NotebookEdit\"`\n- **Common validations**: Verify notebook structure, check cell types\n\n### Code Search Operations\n\n**Glob** - Find files matching glob patterns (e.g., `**/*.js`)\n\n- **Hook use cases**: Audit file searches, restrict search scope, log search patterns\n- **Example matcher**: `\"Glob\"`\n- **Common validations**: Prevent searching outside project directory\n\n**Grep** - Search file contents using regex patterns\n\n- **Hook use cases**: Audit content searches, restrict search scope, log sensitive searches\n- **Example matcher**: `\"Grep\"`\n- **Common validations**: Block searches for credentials/secrets, limit search scope\n\n### Command Execution\n\n**Bash** - Execute shell commands\n\n- **Hook use cases**: Block dangerous commands (rm -rf, sudo), validate command safety, log all commands\n- **Example matcher**: `\"Bash\"`\n- **Common validations**: Block rm -rf /, block sudo/su, prevent fork bombs, validate command syntax\n\n**BashOutput** - Retrieve output from background bash shells\n\n- **Hook use cases**: Monitor background processes, audit shell access\n- **Example matcher**: `\"BashOutput\"`\n- **Common validations**: Verify shell ID exists\n\n**KillShell** - Terminate background bash shells\n\n- **Hook use cases**: Audit process termination, log killed shells\n- **Example matcher**: `\"KillShell\"`\n- **Common validations**: Verify shell exists before killing\n\n### Sub-agent Operations\n\n**Task** - Launch specialized sub-agents for complex tasks\n\n- **Hook use cases**: Audit sub-agent usage, log agent launches, validate agent permissions\n- **Example matcher**: `\"Task\"`\n- **Common validations**: Verify agent type exists, check permissions for agent launch\n\n**ExitPlanMode** - Exit planning mode and begin execution\n\n- **Hook use cases**: Validate plan completeness, log plan approval\n- **Example matcher**: `\"ExitPlanMode\"`\n- **Common validations**: Ensure plan is documented\n\n### Web Operations\n\n**WebFetch** - Fetch and process web content with AI\n\n- **Hook use cases**: Audit web requests, block sensitive URLs, log external access\n- **Example matcher**: `\"WebFetch\"`\n- **Common validations**: Whitelist/blacklist domains, prevent credential URLs\n\n**WebSearch** - Search the web using search engines\n\n- **Hook use cases**: Audit search queries, log searches, restrict search topics\n- **Example matcher**: `\"WebSearch\"`\n- **Common validations**: Block sensitive search terms\n\n### Task Management\n\n**TodoWrite** - Create and update todo lists for task tracking\n\n- **Hook use cases**: Audit task creation, log todo changes, validate task structure\n- **Example matcher**: `\"TodoWrite\"`\n- **Common validations**: Verify todo format, check task descriptions\n\n### MCP (Model Context Protocol) Tools\n\n**ListMcpResources** - List available resources from MCP servers\n\n- **Hook use cases**: Audit MCP resource access, log resource queries\n- **Example matcher**: `\"ListMcpResources\"`\n\n**ReadMcpResource** - Read content from MCP server resources\n\n- **Hook use cases**: Audit MCP resource reads, log accessed resources\n- **Example matcher**: `\"ReadMcpResource\"`\n\n**MCP server tools** - External tools provided by MCP servers\n\n- **Naming pattern**: `mcp__<server>__<tool>`\n- **Examples**:\n  - `mcp__filesystem__read_file`\n  - `mcp__github__create_issue`\n  - `mcp__postgres__query`\n  - `mcp__slack__send_message`\n- **Hook use cases**: Validate MCP operations, audit external API calls, enforce MCP policies\n- **Example matchers**:\n  - `\"mcp__.*\"` - All MCP tools\n  - `\"mcp__github__.*\"` - All GitHub operations\n  - `\"mcp__.*__write.*\"` - All write operations across MCP servers\n  - `\"mcp__postgres__.*\"` - All PostgreSQL operations\n\n### Common Matcher Patterns\n\nCombine multiple tools using regex:\n\n- `\"Write|Edit\"` - Match file write or edit operations\n- `\"Glob|Grep\"` - Match any search operation\n- `\"Bash|BashOutput|KillShell\"` - Match all bash-related operations\n- `\"Read|Write|Edit\"` - Match all file operations\n- `\"WebFetch|WebSearch\"` - Match all web operations\n- `\"Task|ExitPlanMode\"` - Match agent-related operations\n- `\"mcp__.*\"` - Match all MCP tool calls\n- `\"*\"` or `\"\"` - Match all tools\n\n## PreToolUse\n\nExecute after Claude creates tool parameters but before processing the tool call.\n\n### Common Matchers\n\n- `Bash` - Shell commands\n- `Write|Edit` - File modifications\n- `Read` - File reading\n- `Glob|Grep` - File searching\n- `mcp__.*` - All MCP tools\n- `*` or `\"\"` - All tools\n\n### Use Cases\n\n- Validate inputs before tool execution\n- Block dangerous operations\n- Auto-approve safe operations\n- Modify tool parameters\n- Enforce security policies\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"cwd\": \"/current/directory\",\n  \"hook_event_name\": \"PreToolUse\",\n  \"tool_name\": \"Write\",\n  \"tool_input\": {\n    \"file_path\": \"/path/to/file.txt\",\n    \"content\": \"file content\"\n  }\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: Allow tool to proceed\n- **Exit 2**: Block tool call, show stderr to Claude\n- **Other**: Non-blocking error, show stderr to user\n\n### JSON Output for Permission Control\n\n```json\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"PreToolUse\",\n    \"permissionDecision\": \"allow\",  // \"allow\", \"deny\", \"ask\"\n    \"permissionDecisionReason\": \"Documentation file auto-approved\"\n  },\n  \"suppressOutput\": true\n}\n```\n\n**Permission decisions:**\n\n- `allow` - Bypass permission system, proceed automatically\n- `deny` - Block tool call, show reason to Claude\n- `ask` - Prompt user for confirmation\n\n## PostToolUse\n\nExecute immediately after a tool completes successfully.\n\n### Common Matchers\n\nSame as PreToolUse\n\n### Use Cases\n\n- Format code after writing\n- Run linters after edits\n- Send notifications\n- Log tool usage\n- Provide feedback to Claude\n- Trigger CI/CD workflows\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"cwd\": \"/current/directory\",\n  \"hook_event_name\": \"PostToolUse\",\n  \"tool_name\": \"Write\",\n  \"tool_input\": {\n    \"file_path\": \"/path/to/file.txt\",\n    \"content\": \"file content\"\n  },\n  \"tool_response\": {\n    \"filePath\": \"/path/to/file.txt\",\n    \"success\": true\n  }\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: Success, stdout shown in transcript\n- **Exit 2**: Show stderr to Claude (tool already ran)\n- **Other**: Non-blocking error, show stderr to user\n\n### JSON Output for Feedback\n\n```json\n{\n  \"decision\": \"block\",  // or undefined\n  \"reason\": \"Formatting failed\",\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"PostToolUse\",\n    \"additionalContext\": \"File formatting completed. All style rules applied.\"\n  }\n}\n```\n\n## UserPromptSubmit\n\nExecute when user submits a prompt, before Claude processes it.\n\n### Matchers\n\nNot applicable - no matcher needed for this event\n\n### Use Cases\n\n- Add contextual information\n- Validate prompt content\n- Block prompts with sensitive data\n- Inject current environment state\n- Load project-specific context\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"cwd\": \"/current/directory\",\n  \"hook_event_name\": \"UserPromptSubmit\",\n  \"prompt\": \"User's submitted prompt text\"\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: stdout added as context for Claude\n- **Exit 2**: Not applicable for UserPromptSubmit\n- **Other**: Error, stderr shown to user\n\n### JSON Output for Blocking\n\n```json\n{\n  \"decision\": \"block\",  // Prevents prompt processing\n  \"reason\": \"Security: Potential secret detected. Please rephrase.\",\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"UserPromptSubmit\",\n    \"additionalContext\": \"Additional context added to prompt\"\n  }\n}\n```\n\n**Blocking behavior:**\n\n- `decision: \"block\"` - Prompt is erased, not processed\n- `reason` - Shown to user (not added to context)\n- `additionalContext` - Added to context if not blocked\n\n## SessionStart\n\nExecute when Claude Code starts or resumes a session.\n\n### Matchers\n\n- `startup` - New session started\n- `resume` - Session resumed\n- `clear` - After /clear command\n- `compact` - After compaction\n\n### Use Cases\n\n- Load recent git commits\n- Show current branch and status\n- Display open issues\n- Check environment state\n- Initialize session context\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"hook_event_name\": \"SessionStart\",\n  \"source\": \"startup\"  // or \"resume\", \"clear\", \"compact\"\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: stdout added as context for Claude\n- **Exit 2**: Not applicable\n- **Other**: Error logged to debug\n\n### JSON Output for Context\n\n```json\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"SessionStart\",\n    \"additionalContext\": \"## Recent Commits\\n\\n[git log output]\"\n  }\n}\n```\n\n## SessionEnd\n\nExecute when a Claude Code session ends.\n\n### Matchers\n\nNot applicable\n\n### Use Cases\n\n- Save session statistics\n- Clean temporary files\n- Log activity\n- Backup work\n- Send notifications\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"cwd\": \"/current/directory\",\n  \"hook_event_name\": \"SessionEnd\",\n  \"reason\": \"exit\"  // \"clear\", \"logout\", \"prompt_input_exit\", \"other\"\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: Success, logged to debug\n- **Exit 2**: Not applicable\n- **Other**: Error logged to debug\n\n**Note:** SessionEnd hooks cannot block session termination.\n\n## Stop\n\nExecute when the main Claude Code agent attempts to stop.\n\n### Matchers\n\nNot applicable\n\n### Use Cases\n\n- Ensure tasks are complete\n- Run final checks\n- Force Claude to continue if needed\n- Validate outputs\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"hook_event_name\": \"Stop\",\n  \"stop_hook_active\": false  // true if already continuing from Stop hook\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: Allow Claude to stop\n- **Exit 2**: Block stopping, show stderr to Claude\n- **Other**: Error shown to user\n\n### JSON Output for Continuation\n\n```json\n{\n  \"decision\": \"block\",  // Prevents Claude from stopping\n  \"reason\": \"Tasks incomplete. Please finish pending work.\"\n}\n```\n\n**Important:** Check `stop_hook_active` to prevent infinite loops. If true, allow Claude to stop.\n\n## SubagentStop\n\nExecute when a sub-agent (Task tool call) attempts to stop.\n\n### Matchers\n\nNot applicable\n\n### Use Cases\n\nSame as Stop event, but for sub-agents\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"hook_event_name\": \"SubagentStop\",\n  \"stop_hook_active\": false\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: Allow sub-agent to stop\n- **Exit 2**: Block stopping, show stderr to sub-agent\n- **Other**: Error shown to user\n\n### JSON Output for Continuation\n\nSame as Stop event.\n\n## PreCompact\n\nExecute before Claude Code compacts conversation history.\n\n### Matchers\n\n- `manual` - /compact command\n- `auto` - Automatic compaction\n\n### Use Cases\n\n- Save important context\n- Log conversation statistics\n- Prepare for compaction\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"hook_event_name\": \"PreCompact\",\n  \"trigger\": \"manual\",  // or \"auto\"\n  \"custom_instructions\": \"\"  // From /compact args (manual only)\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: Success, logged to debug\n- **Exit 2**: Not applicable\n- **Other**: Error shown to user\n\n**Note:** PreCompact hooks cannot block compaction.\n\n## Notification\n\nExecute when Claude Code sends notifications.\n\n### Matchers\n\nNot applicable\n\n### Use Cases\n\n- Forward notifications to external systems\n- Log notification events\n- Trigger alerts\n\n### Notifications Sent\n\n- Permission requests: \"Claude needs your permission to use Bash\"\n- Idle prompts: \"Claude is waiting for your input\" (after 60s)\n\n### Input Schema\n\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"/path/to/transcript.jsonl\",\n  \"cwd\": \"/current/directory\",\n  \"hook_event_name\": \"Notification\",\n  \"message\": \"Claude needs your permission to use Bash\"\n}\n```\n\n### Exit Code Behavior\n\n- **Exit 0**: Success, logged to debug only\n- **Exit 2**: Not applicable\n- **Other**: Error logged to debug\n\n## Hook Execution Details\n\n### Timeout\n\n- Default: 60 seconds per hook\n- Configurable per command via `timeout` field\n- Individual command timeout doesn't affect other commands\n\n### Parallelization\n\n- All matching hooks run in parallel\n- Multiple hooks can respond to same event\n\n### Environment\n\n- Runs in current directory\n- `CLAUDE_PROJECT_DIR` environment variable available\n- Contains absolute path to project root\n\n### Input/Output\n\n- **PreToolUse/PostToolUse/Stop/SubagentStop**: Progress shown in transcript (Ctrl-R)\n- **Notification/SessionEnd**: Logged to debug only (`--debug`)\n- **UserPromptSubmit/SessionStart**: stdout added as context for Claude\n\n## MCP Tool Naming\n\nMCP tools follow the pattern `mcp__<server>__<tool>`:\n\n- `mcp__filesystem__read_file`\n- `mcp__github__create_issue`\n- `mcp__postgres__query`\n\nMatch MCP tools with:\n\n- `mcp__.*` - All MCP tools\n- `mcp__github__.*` - All GitHub server tools\n- `mcp__.*__write.*` - All write operations across servers\n",
        "plugins/claude-code-meta/skills/claude-code-hooks/references/implementation-guide.md": "# Hook Implementation Guide\n\nProgressive guide from quick code templates to production-ready examples.\n\n## Quick Patterns\n\nMinimal code templates for common hook use cases. Copy and customize these patterns for rapid development.\n\n### Pattern 1: Input Validation\n\nValidate tool inputs before execution to enforce policies and prevent errors.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\nimport re\n\n# Load input\ntry:\n    input_data = json.load(sys.stdin)\nexcept json.JSONDecodeError as e:\n    print(f\"Invalid JSON: {e}\", file=sys.stderr)\n    sys.exit(1)\n\ntool_name = input_data.get(\"tool_name\")\ntool_input = input_data.get(\"tool_input\", {})\n\n# Validate based on tool type\nif tool_name == \"Bash\":\n    command = tool_input.get(\"command\", \"\")\n\n    # Define validation rules\n    dangerous_patterns = [\n        (r'\\brm\\s+-rf\\s+/', \"Dangerous rm -rf detected\"),\n        (r'\\b(sudo|su)\\b', \"Elevated privileges not allowed\"),\n        (r'>\\s*/dev/sd[a-z]', \"Direct device access blocked\"),\n    ]\n\n    for pattern, message in dangerous_patterns:\n        if re.search(pattern, command):\n            print(message, file=sys.stderr)\n            sys.exit(2)  # Block the command\n\n# Allow operation\nsys.exit(0)\n```\n\n**Settings configuration:**\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/validate-bash.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Pattern 2: Auto-Format After Edit\n\nAutomatically format code after file modifications.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\nimport subprocess\n\ninput_data = json.load(sys.stdin)\ntool_name = input_data.get(\"tool_name\")\nfile_path = input_data.get(\"tool_input\", {}).get(\"file_path\", \"\")\n\n# Only process file write/edit operations\nif tool_name not in [\"Write\", \"Edit\"]:\n    sys.exit(0)\n\n# Format based on file extension\nformatters = {\n    \".py\": [\"black\", file_path],\n    \".js\": [\"prettier\", \"--write\", file_path],\n    \".ts\": [\"prettier\", \"--write\", file_path],\n    \".rs\": [\"rustfmt\", file_path],\n    \".go\": [\"gofmt\", \"-w\", file_path],\n}\n\n# Find appropriate formatter\nfor ext, cmd in formatters.items():\n    if file_path.endswith(ext):\n        try:\n            subprocess.run(cmd, check=True, timeout=30)\n            print(f\"Formatted {file_path}\")\n            sys.exit(0)\n        except subprocess.CalledProcessError as e:\n            print(f\"Formatting failed: {e}\", file=sys.stderr)\n            sys.exit(1)\n        except subprocess.TimeoutExpired:\n            print(\"Formatting timed out\", file=sys.stderr)\n            sys.exit(1)\n\n# No formatter needed\nsys.exit(0)\n```\n\n### Pattern 3: Add Session Context\n\nLoad project context at session start.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\nimport subprocess\n\ninput_data = json.load(sys.stdin)\n\ndef run_git_command(args):\n    \"\"\"Run git command and return output\"\"\"\n    try:\n        result = subprocess.run(\n            [\"git\"] + args,\n            capture_output=True,\n            text=True,\n            timeout=5\n        )\n        return result.stdout if result.returncode == 0 else \"\"\n    except Exception:\n        return \"\"\n\n# Gather project context\ngit_status = run_git_command([\"status\", \"--short\"])\ngit_branch = run_git_command([\"branch\", \"--show-current\"])\ngit_log = run_git_command([\"log\", \"--oneline\", \"-5\"])\n\n# Build context message\ncontext = f\"\"\"## Project Context\n\n**Current Branch:** {git_branch.strip()}\n\n**Modified Files:**\n{git_status or \"No changes\"}\n\n**Recent Commits:**\n{git_log}\n\"\"\"\n\n# Output context for Claude\nprint(context)\nsys.exit(0)\n```\n\n### Pattern 4: Permission Control\n\nAuto-approve safe operations, block dangerous ones.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\n\ninput_data = json.load(sys.stdin)\ntool_name = input_data.get(\"tool_name\")\ntool_input = input_data.get(\"tool_input\", {})\n\n# Auto-approve reading documentation files\nif tool_name == \"Read\":\n    file_path = tool_input.get(\"file_path\", \"\")\n    safe_extensions = (\".md\", \".txt\", \".json\", \".yaml\", \".yml\")\n\n    if file_path.endswith(safe_extensions):\n        output = {\n            \"hookSpecificOutput\": {\n                \"hookEventName\": \"PreToolUse\",\n                \"permissionDecision\": \"allow\",\n                \"permissionDecisionReason\": \"Documentation file auto-approved\"\n            },\n            \"suppressOutput\": True\n        }\n        print(json.dumps(output))\n        sys.exit(0)\n\n# Auto-deny sensitive file operations\nif tool_name in [\"Write\", \"Edit\"]:\n    file_path = tool_input.get(\"file_path\", \"\")\n    sensitive_paths = (\".env\", \".git/\", \"id_rsa\", \"credentials\")\n\n    if any(p in file_path for p in sensitive_paths):\n        output = {\n            \"hookSpecificOutput\": {\n                \"hookEventName\": \"PreToolUse\",\n                \"permissionDecision\": \"deny\",\n                \"permissionDecisionReason\": \"Sensitive file modification blocked\"\n            }\n        }\n        print(json.dumps(output))\n        sys.exit(0)\n\n# Default: let normal permission flow proceed\nsys.exit(0)\n```\n\n### Pattern 5: Path Safety Validation\n\nPrevent path traversal attacks.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\nimport os\nfrom pathlib import Path\n\ndef is_safe_path(base_dir, file_path):\n    \"\"\"Check if file_path is within base_dir (no path traversal)\"\"\"\n    try:\n        base = Path(base_dir).resolve()\n        target = Path(file_path).resolve()\n        return target.is_relative_to(base)\n    except (ValueError, OSError):\n        return False\n\ninput_data = json.load(sys.stdin)\ntool_name = input_data.get(\"tool_name\")\n\n# Check file operations\nif tool_name in [\"Write\", \"Edit\", \"Read\"]:\n    project_dir = os.environ.get(\"CLAUDE_PROJECT_DIR\")\n    file_path = input_data.get(\"tool_input\", {}).get(\"file_path\")\n\n    if not project_dir or not file_path:\n        sys.exit(0)\n\n    if not is_safe_path(project_dir, file_path):\n        print(\"Path traversal detected - operation blocked\", file=sys.stderr)\n        sys.exit(2)\n\nsys.exit(0)\n```\n\n### Pattern 6: Security Validation\n\nCheck prompts for sensitive data before processing.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\nimport re\n\ninput_data = json.load(sys.stdin)\nprompt = input_data.get(\"prompt\", \"\")\n\n# Define sensitive patterns\nsensitive_patterns = [\n    (r'ghp_[a-zA-Z0-9]{36}', \"GitHub personal access token\"),\n    (r'sk_live_[a-zA-Z0-9]{24}', \"Stripe API key\"),\n    (r'xoxb-[a-zA-Z0-9-]+', \"Slack bot token\"),\n    (r'-----BEGIN (?:RSA )?PRIVATE KEY-----', \"Private key\"),\n    (r'(?i)\\bpassword\\s*[:=]\\s*[\"\\']?[\\w!@#$%^&*]+', \"Password\"),\n]\n\n# Check for sensitive data\nfor pattern, description in sensitive_patterns:\n    if re.search(pattern, prompt):\n        output = {\n            \"decision\": \"block\",\n            \"reason\": f\"Security: {description} detected in prompt. Please remove sensitive data.\"\n        }\n        print(json.dumps(output))\n        sys.exit(0)\n\n# Prompt is safe\nsys.exit(0)\n```\n\n### Pattern 7: PostToolUse Feedback\n\nProvide additional context to Claude after tool execution.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\nimport subprocess\n\ninput_data = json.load(sys.stdin)\ntool_name = input_data.get(\"tool_name\")\nfile_path = input_data.get(\"tool_input\", {}).get(\"file_path\", \"\")\n\n# Run linter after code changes\nif tool_name in [\"Write\", \"Edit\"] and file_path.endswith(\".py\"):\n    try:\n        result = subprocess.run(\n            [\"pylint\", file_path],\n            capture_output=True,\n            text=True,\n            timeout=30\n        )\n\n        # Provide feedback to Claude\n        if result.returncode != 0:\n            output = {\n                \"decision\": \"block\",\n                \"reason\": \"Linting issues found\",\n                \"hookSpecificOutput\": {\n                    \"hookEventName\": \"PostToolUse\",\n                    \"additionalContext\": f\"Linting results:\\n{result.stdout}\"\n                }\n            }\n            print(json.dumps(output))\n            sys.exit(0)\n    except Exception:\n        pass\n\nsys.exit(0)\n```\n\n### Pattern 8: Stop Hook Validation\n\nEnsure tasks are complete before allowing Claude to stop.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\nimport subprocess\n\ninput_data = json.load(sys.stdin)\n\n# Prevent infinite loops\nif input_data.get(\"stop_hook_active\"):\n    sys.exit(0)\n\n# Check for pending git changes\ntry:\n    result = subprocess.run(\n        [\"git\", \"status\", \"--porcelain\"],\n        capture_output=True,\n        text=True,\n        timeout=5\n    )\n\n    if result.stdout.strip():\n        output = {\n            \"decision\": \"block\",\n            \"reason\": \"Uncommitted changes detected. Please commit or stash changes before stopping.\"\n        }\n        print(json.dumps(output))\n        sys.exit(0)\nexcept Exception:\n    pass\n\n# Allow Claude to stop\nsys.exit(0)\n```\n\n### Pattern 9: MCP Tool Logging\n\nLog all MCP tool usage for audit trails.\n\n```bash\n#!/bin/bash\n\n# Read JSON input\ninput=$(cat)\ntool_name=$(echo \"$input\" | jq -r '.tool_name')\ntimestamp=$(date '+%Y-%m-%d %H:%M:%S')\n\n# Check if it's an MCP tool\nif [[ \"$tool_name\" =~ ^mcp__ ]]; then\n    echo \"[$timestamp] MCP Tool: $tool_name\" >> ~/.claude/mcp-audit.log\nfi\n\nexit 0\n```\n\n### Pattern 10: Conditional Hook Execution\n\nExecute hooks only under specific conditions.\n\n```python\n#!/usr/bin/env python3\nimport json\nimport sys\nimport os\n\ninput_data = json.load(sys.stdin)\n\n# Only run in production environment\nif os.environ.get(\"ENVIRONMENT\") != \"production\":\n    sys.exit(0)\n\n# Only run on main branch\ntry:\n    import subprocess\n    result = subprocess.run(\n        [\"git\", \"branch\", \"--show-current\"],\n        capture_output=True,\n        text=True\n    )\n    current_branch = result.stdout.strip()\n\n    if current_branch != \"main\":\n        sys.exit(0)\nexcept Exception:\n    sys.exit(0)\n\n# Execute production-specific logic\n# ...\n\nsys.exit(0)\n```\n\n## Complete Examples\n\nProduction-ready hook implementations with full configuration, setup instructions, and testing.\n\n### Example 1: Prevent Dangerous Bash Commands\n\nBlock rm -rf, sudo, and other dangerous commands.\n\n#### Hook Script\n\n**File:** `.claude/hooks/validate-bash.py`\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nValidates Bash commands before execution to prevent dangerous operations.\n\"\"\"\nimport json\nimport sys\nimport re\n\n# Load input\ntry:\n    input_data = json.load(sys.stdin)\nexcept json.JSONDecodeError as e:\n    print(f\"Error: Invalid JSON input: {e}\", file=sys.stderr)\n    sys.exit(1)\n\ntool_name = input_data.get(\"tool_name\", \"\")\ntool_input = input_data.get(\"tool_input\", {})\ncommand = tool_input.get(\"command\", \"\")\n\n# Only process Bash commands\nif tool_name != \"Bash\" or not command:\n    sys.exit(0)\n\n# Define validation rules\nVALIDATION_RULES = [\n    (r'\\brm\\s+-rf\\s+/', \"Dangerous rm -rf command detected\"),\n    (r'\\b(sudo|su)\\b', \"Elevated privileges not allowed\"),\n    (r'>\\s*/dev/sd[a-z]', \"Direct device access blocked\"),\n    (r'\\b(mkfs|fdisk|parted)\\b', \"Disk formatting commands blocked\"),\n    (r':\\(\\)\\{.*\\};:', \"Fork bomb detected\"),\n]\n\n# Validate command\nfor pattern, message in VALIDATION_RULES:\n    if re.search(pattern, command):\n        print(f\"â {message}\", file=sys.stderr)\n        sys.exit(2)  # Block the command\n\n# Allow command\nsys.exit(0)\n```\n\n#### Configuration\n\n**File:** `.claude/settings.json`\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/validate-bash.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n#### Setup\n\n```bash\n# Create hooks directory\nmkdir -p .claude/hooks\n\n# Create script\ncat > .claude/hooks/validate-bash.py << 'EOF'\n[paste script above]\nEOF\n\n# Make executable\nchmod +x .claude/hooks/validate-bash.py\n\n# Test\necho '{\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"rm -rf /\"}}' | .claude/hooks/validate-bash.py\n```\n\n### Example 2: Auto-Format Code After Write/Edit\n\nAutomatically format Python, JavaScript, and Rust files.\n\n#### Hook Script\n\n**File:** `.claude/hooks/auto-format.py`\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nAutomatically formats code files after Write or Edit operations.\n\"\"\"\nimport json\nimport sys\nimport subprocess\nfrom pathlib import Path\n\ninput_data = json.load(sys.stdin)\ntool_name = input_data.get(\"tool_name\")\nfile_path = input_data.get(\"tool_input\", {}).get(\"file_path\", \"\")\n\n# Only process Write/Edit operations\nif tool_name not in [\"Write\", \"Edit\"] or not file_path:\n    sys.exit(0)\n\n# Define formatters by extension\nFORMATTERS = {\n    \".py\": {\n        \"cmd\": [\"black\", \"--quiet\", file_path],\n        \"name\": \"black\"\n    },\n    \".js\": {\n        \"cmd\": [\"prettier\", \"--write\", file_path],\n        \"name\": \"prettier\"\n    },\n    \".ts\": {\n        \"cmd\": [\"prettier\", \"--write\", file_path],\n        \"name\": \"prettier\"\n    },\n    \".jsx\": {\n        \"cmd\": [\"prettier\", \"--write\", file_path],\n        \"name\": \"prettier\"\n    },\n    \".tsx\": {\n        \"cmd\": [\"prettier\", \"--write\", file_path],\n        \"name\": \"prettier\"\n    },\n    \".rs\": {\n        \"cmd\": [\"rustfmt\", file_path],\n        \"name\": \"rustfmt\"\n    },\n    \".go\": {\n        \"cmd\": [\"gofmt\", \"-w\", file_path],\n        \"name\": \"gofmt\"\n    },\n}\n\n# Find appropriate formatter\nfile_ext = Path(file_path).suffix\nif file_ext not in FORMATTERS:\n    sys.exit(0)  # No formatter for this file type\n\nformatter = FORMATTERS[file_ext]\n\n# Run formatter\ntry:\n    result = subprocess.run(\n        formatter[\"cmd\"],\n        capture_output=True,\n        text=True,\n        timeout=30\n    )\n\n    if result.returncode == 0:\n        print(f\"â Formatted {Path(file_path).name} with {formatter['name']}\")\n        sys.exit(0)\n    else:\n        print(f\"â  Formatting failed: {result.stderr}\", file=sys.stderr)\n        sys.exit(1)\n\nexcept FileNotFoundError:\n    print(f\"â  {formatter['name']} not installed\", file=sys.stderr)\n    sys.exit(1)\nexcept subprocess.TimeoutExpired:\n    print(\"â  Formatting timed out\", file=sys.stderr)\n    sys.exit(1)\nexcept Exception as e:\n    print(f\"â  Formatting error: {e}\", file=sys.stderr)\n    sys.exit(1)\n```\n\n#### Configuration\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/auto-format.py\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Example 3: Load Git Context at Session Start\n\nShow recent commits and current branch when starting a session.\n\n#### Hook Script\n\n**File:** `.claude/hooks/load-git-context.py`\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nLoads git context (branch, status, recent commits) at session start.\n\"\"\"\nimport json\nimport sys\nimport subprocess\n\ndef run_git(args):\n    \"\"\"Run git command and return output\"\"\"\n    try:\n        result = subprocess.run(\n            [\"git\"] + args,\n            capture_output=True,\n            text=True,\n            timeout=5\n        )\n        return result.stdout.strip() if result.returncode == 0 else \"\"\n    except Exception:\n        return \"\"\n\ninput_data = json.load(sys.stdin)\n\n# Get git information\nbranch = run_git([\"branch\", \"--show-current\"])\nstatus = run_git([\"status\", \"--short\"])\nlog = run_git([\"log\", \"--oneline\", \"-10\"])\nremotes = run_git([\"remote\", \"-v\"])\n\n# Check if there are uncommitted changes\nhas_changes = bool(status)\n\n# Build context\ncontext = f\"\"\"## Git Context\n\n**Current Branch:** `{branch or 'detached HEAD'}`\n\n**Status:** {'â Uncommitted changes' if has_changes else 'â Clean working tree'}\n\n**Modified Files:**\n```\n\n{status or '(none)'}\n\n```\n\n**Recent Commits:**\n```\n\n{log or '(no commits)'}\n\n```\n\n**Remotes:**\n```\n\n{remotes or '(no remotes configured)'}\n\n```\n\"\"\"\n\n# Output context\nprint(context)\nsys.exit(0)\n```\n\n#### Configuration\n\n```json\n{\n  \"hooks\": {\n    \"SessionStart\": [\n      {\n        \"matcher\": \"startup\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/load-git-context.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Example 4: Validate Prompts for Secrets\n\nBlock prompts containing API keys, tokens, or passwords.\n\n#### Hook Script\n\n**File:** `~/.claude/hooks/validate-prompt-security.py`\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nValidates user prompts for sensitive data before processing.\n\"\"\"\nimport json\nimport sys\nimport re\n\ninput_data = json.load(sys.stdin)\nprompt = input_data.get(\"prompt\", \"\")\n\n# Define sensitive patterns\nSENSITIVE_PATTERNS = [\n    (r'ghp_[a-zA-Z0-9]{36}', \"GitHub personal access token\"),\n    (r'github_pat_[a-zA-Z0-9_]{82}', \"GitHub fine-grained token\"),\n    (r'sk_live_[a-zA-Z0-9]{24,}', \"Stripe API key\"),\n    (r'xoxb-[a-zA-Z0-9-]+', \"Slack bot token\"),\n    (r'xox[pa]-[a-zA-Z0-9-]+', \"Slack token\"),\n    (r'-----BEGIN (?:RSA )?PRIVATE KEY-----', \"Private key\"),\n    (r'AKIA[0-9A-Z]{16}', \"AWS access key\"),\n    (r'AIza[0-9A-Za-z-_]{35}', \"Google API key\"),\n    (r'(?i)password\\s*[:=]\\s*[\"\\']?[\\w!@#$%^&*]{8,}', \"Password\"),\n    (r'(?i)api[_-]?key\\s*[:=]\\s*[\"\\']?[\\w-]{20,}', \"API key\"),\n]\n\n# Check for sensitive data\nfor pattern, description in SENSITIVE_PATTERNS:\n    if re.search(pattern, prompt):\n        output = {\n            \"decision\": \"block\",\n            \"reason\": f\"ð Security Alert: {description} detected in prompt.\\n\\n\"\n                     f\"Please remove sensitive data and try again.\\n\\n\"\n                     f\"Tip: Store secrets in environment variables or .env files instead.\"\n        }\n        print(json.dumps(output))\n        sys.exit(0)\n\n# Prompt is safe\nsys.exit(0)\n```\n\n#### Configuration\n\n```json\n{\n  \"hooks\": {\n    \"UserPromptSubmit\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"~/.claude/hooks/validate-prompt-security.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Example 5: Ensure Git Commit Before Stopping\n\nPrevent Claude from stopping if there are uncommitted changes.\n\n#### Hook Script\n\n**File:** `.claude/hooks/check-git-clean.py`\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nEnsures all changes are committed before allowing Claude to stop.\n\"\"\"\nimport json\nimport sys\nimport subprocess\n\ninput_data = json.load(sys.stdin)\n\n# Prevent infinite loops\nif input_data.get(\"stop_hook_active\"):\n    sys.exit(0)\n\n# Check git status\ntry:\n    result = subprocess.run(\n        [\"git\", \"status\", \"--porcelain\"],\n        capture_output=True,\n        text=True,\n        timeout=5\n    )\n\n    if result.returncode != 0:\n        # Not a git repository\n        sys.exit(0)\n\n    changes = result.stdout.strip()\n\n    if changes:\n        # Build list of changed files\n        file_list = \"\\n\".join(f\"  - {line}\" for line in changes.split(\"\\n\")[:10])\n        if len(changes.split(\"\\n\")) > 10:\n            file_list += f\"\\n  ... and {len(changes.split('\\n')) - 10} more\"\n\n        output = {\n            \"decision\": \"block\",\n            \"reason\": f\"\"\"You have uncommitted changes:\n\n{file_list}\n\nPlease commit or stash your changes before stopping:\n- To commit: git add . && git commit -m \"Your message\"\n- To stash: git stash\n- To discard: git checkout .\n\"\"\"\n        }\n        print(json.dumps(output))\n        sys.exit(0)\n\nexcept Exception:\n    # If git check fails, allow stopping\n    pass\n\n# Clean working tree, allow stopping\nsys.exit(0)\n```\n\n#### Configuration\n\n```json\n{\n  \"hooks\": {\n    \"Stop\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"${CLAUDE_PROJECT_DIR}\\\"/.claude/hooks/check-git-clean.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Example 6: Auto-Approve Documentation Reads\n\nAutomatically approve reading documentation files without prompting.\n\n#### Hook Script\n\n**File:** `~/.claude/hooks/auto-approve-docs.py`\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nAuto-approves reading documentation and configuration files.\n\"\"\"\nimport json\nimport sys\nfrom pathlib import Path\n\ninput_data = json.load(sys.stdin)\ntool_name = input_data.get(\"tool_name\")\nfile_path = input_data.get(\"tool_input\", {}).get(\"file_path\", \"\")\n\nif tool_name != \"Read\" or not file_path:\n    sys.exit(0)\n\n# Define safe file patterns\nSAFE_EXTENSIONS = (\n    \".md\", \".mdx\", \".txt\", \".json\", \".yaml\", \".yml\",\n    \".toml\", \".ini\", \".cfg\", \".conf\", \".xml\",\n    \".rst\", \".adoc\", \".org\"\n)\n\nSAFE_FILENAMES = (\n    \"README\", \"LICENSE\", \"CHANGELOG\", \"CONTRIBUTING\",\n    \"CODE_OF_CONDUCT\", \"SECURITY\", \".gitignore\",\n    \"package.json\", \"Cargo.toml\", \"pyproject.toml\"\n)\n\npath = Path(file_path)\n\n# Check if file should be auto-approved\nis_safe = (\n    path.suffix.lower() in SAFE_EXTENSIONS or\n    path.stem.upper() in SAFE_FILENAMES\n)\n\nif is_safe:\n    output = {\n        \"hookSpecificOutput\": {\n            \"hookEventName\": \"PreToolUse\",\n            \"permissionDecision\": \"allow\",\n            \"permissionDecisionReason\": f\"Documentation file auto-approved: {path.name}\"\n        },\n        \"suppressOutput\": True  # Don't show in transcript\n    }\n    print(json.dumps(output))\n    sys.exit(0)\n\n# Not a documentation file, use normal permission flow\nsys.exit(0)\n```\n\n#### Configuration\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Read\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"~/.claude/hooks/auto-approve-docs.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Example 7: MCP Tool Audit Log\n\nLog all MCP tool usage for compliance and debugging.\n\n#### Hook Script\n\n**File:** `~/.claude/hooks/mcp-audit.sh`\n\n```bash\n#!/bin/bash\n# Logs all MCP tool usage with timestamp and details\n\n# Read JSON input\ninput=$(cat)\ntool_name=$(echo \"$input\" | jq -r '.tool_name')\n\n# Only log MCP tools\nif [[ ! \"$tool_name\" =~ ^mcp__ ]]; then\n    exit 0\nfi\n\n# Extract MCP server and tool\nserver=$(echo \"$tool_name\" | cut -d'_' -f3)\ntool=$(echo \"$tool_name\" | cut -d'_' -f4-)\n\n# Log to file\nlog_file=\"${HOME}/.claude/mcp-audit.log\"\ntimestamp=$(date '+%Y-%m-%d %H:%M:%S')\n\necho \"[$timestamp] Server: $server, Tool: $tool, Full: $tool_name\" >> \"$log_file\"\n\nexit 0\n```\n\n#### Configuration\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"mcp__.*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"~/.claude/hooks/mcp-audit.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Example 8: Notify on Session End\n\nSend system notification when Claude Code session ends.\n\n#### Hook Script (macOS)\n\n**File:** `~/.claude/hooks/notify-session-end.sh`\n\n```bash\n#!/bin/bash\n# Sends notification when session ends (macOS)\n\ninput=$(cat)\nreason=$(echo \"$input\" | jq -r '.reason')\n\n# Send notification\nosascript -e \"display notification \\\"Session ended: $reason\\\" with title \\\"Claude Code\\\" sound name \\\"Glass\\\"\"\n\nexit 0\n```\n\n#### Hook Script (Linux)\n\n**File:** `~/.claude/hooks/notify-session-end-linux.sh`\n\n```bash\n#!/bin/bash\n# Sends notification when session ends (Linux)\n\ninput=$(cat)\nreason=$(echo \"$input\" | jq -r '.reason')\n\n# Send notification via notify-send\nnotify-send \"Claude Code\" \"Session ended: $reason\" --icon=dialog-information\n\nexit 0\n```\n\n#### Configuration\n\n```json\n{\n  \"hooks\": {\n    \"SessionEnd\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"~/.claude/hooks/notify-session-end.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Bash Hook Examples\n\nSimple hooks can use bash scripts for quick implementation.\n\n### Log All Tool Usage\n\n```bash\n#!/bin/bash\ninput=$(cat)\ntool_name=$(echo \"$input\" | jq -r '.tool_name')\ntimestamp=$(date '+%Y-%m-%d %H:%M:%S')\n\necho \"[$timestamp] Tool used: $tool_name\" >> ~/.claude/tool-usage.log\nexit 0\n```\n\n### Backup Files Before Edit\n\n```bash\n#!/bin/bash\ninput=$(cat)\ntool_name=$(echo \"$input\" | jq -r '.tool_name')\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path')\n\nif [[ \"$tool_name\" == \"Edit\" && -f \"$file_path\" ]]; then\n    cp \"$file_path\" \"${file_path}.backup\"\nfi\n\nexit 0\n```\n\n### Send Notification on Session End\n\n```bash\n#!/bin/bash\ninput=$(cat)\nreason=$(echo \"$input\" | jq -r '.reason')\n\n# Send notification (macOS example)\nosascript -e \"display notification \\\"Claude Code session ended: $reason\\\" with title \\\"Claude Code\\\"\"\n\nexit 0\n```\n\n## Reusable Utilities\n\nCommon utility functions for hook scripts.\n\n### JSON Validation\n\n```python\ndef load_hook_input():\n    \"\"\"Safely load and validate hook input\"\"\"\n    try:\n        return json.load(sys.stdin)\n    except json.JSONDecodeError as e:\n        print(f\"Invalid JSON input: {e}\", file=sys.stderr)\n        sys.exit(1)\n```\n\n### Safe Command Execution\n\n```python\ndef run_command(cmd, timeout=30):\n    \"\"\"Safely execute command with timeout\"\"\"\n    try:\n        result = subprocess.run(\n            cmd,\n            capture_output=True,\n            text=True,\n            timeout=timeout,\n            check=True\n        )\n        return result.stdout\n    except subprocess.CalledProcessError as e:\n        return None\n    except subprocess.TimeoutExpired:\n        return None\n```\n\n### JSON Output Helper\n\n```python\ndef output_json(data):\n    \"\"\"Output JSON and exit\"\"\"\n    print(json.dumps(data))\n    sys.exit(0)\n```\n\n### Path Validation\n\n```python\ndef validate_path(file_path, allowed_dirs):\n    \"\"\"Validate file path is in allowed directories\"\"\"\n    from pathlib import Path\n\n    try:\n        target = Path(file_path).resolve()\n        return any(\n            target.is_relative_to(Path(d).resolve())\n            for d in allowed_dirs\n        )\n    except Exception:\n        return False\n```\n\n## Testing Hooks\n\nTest hooks manually before deployment to ensure correct behavior.\n\n### Test Hook Scripts Directly\n\n```bash\n# Test PreToolUse hook\necho '{\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"rm -rf /\"}}' | \\\n  .claude/hooks/validate-bash.py\necho \"Exit code: $?\"\n\n# Test PostToolUse hook\necho '{\"tool_name\":\"Write\",\"tool_input\":{\"file_path\":\"test.py\"}}' | \\\n  .claude/hooks/auto-format.py\n\n# Test UserPromptSubmit hook\necho '{\"prompt\":\"Here is my API key: ghp_abc123xyz\"}' | \\\n  ~/.claude/hooks/validate-prompt-security.py\n```\n\n### Test with Real Transcript Data\n\n```bash\n# Extract last tool call from transcript\ncat ~/.claude/projects/*/transcript.jsonl | tail -1 | \\\n  jq '.toolInput' | \\\n  your-hook.py\n```\n\n### Test Edge Cases\n\n```bash\n# Empty command\necho '{\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"\"}}' | hook.py\n\n# Missing fields\necho '{\"tool_name\":\"Bash\"}' | hook.py\n\n# Very long input\necho '{\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"'$(python -c 'print(\"a\"*10000)')'}}' | hook.py\n\n# Special characters\necho '{\"tool_name\":\"Write\",\"tool_input\":{\"file_path\":\"file with spaces.txt\"}}' | hook.py\n```\n\n### Check Exit Codes\n\n```bash\n# Test successful validation (exit 0)\necho '{\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"ls\"}}' | \\\n  .claude/hooks/validate-bash.py\necho \"Exit: $?\"  # Should be 0\n\n# Test blocked operation (exit 2)\necho '{\"tool_name\":\"Bash\",\"tool_input\":{\"command\":\"sudo rm -rf /\"}}' | \\\n  .claude/hooks/validate-bash.py\necho \"Exit: $?\"  # Should be 2\n\n# Test error condition (exit 1)\necho 'invalid json' | .claude/hooks/validate-bash.py\necho \"Exit: $?\"  # Should be 1\n```\n\n## Debugging Hooks\n\nUse Claude Code's built-in debugging tools to troubleshoot hook execution.\n\n### Debug Mode\n\nRun with `--debug` to see detailed hook execution:\n\n```bash\nclaude --debug\n```\n\n### Transcript Mode\n\nView hook progress in transcript mode (Ctrl-R).\n\n### File Logging\n\nAdd logging to hook scripts for persistent debugging:\n\n```python\nimport logging\n\nlogging.basicConfig(\n    filename=os.path.expanduser(\"~/.claude/hook-debug.log\"),\n    level=logging.DEBUG,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n)\n\nlogging.debug(f\"Hook input: {input_data}\")\nlogging.debug(f\"Tool name: {tool_name}\")\nlogging.debug(f\"Validation result: {is_valid}\")\n```\n\n### Validate JSON Output\n\nTest JSON output format before deployment:\n\n```python\noutput = {\n    \"decision\": \"block\",\n    \"reason\": \"Test reason\"\n}\n\n# Validate it's proper JSON\ntry:\n    json.dumps(output)\n    print(\"â Valid JSON\")\nexcept Exception as e:\n    print(f\"â Invalid JSON: {e}\")\n```\n\n### Common Debugging Issues\n\n**Hook not triggering:**\n\n1. Check matcher pattern (case-sensitive)\n2. Verify hook appears in `/hooks` menu in Claude Code\n3. Restart Claude Code to reload configuration\n4. Use `claude --debug` to see why hook isn't matching\n\n**Permission denied:**\n\n```bash\nchmod +x .claude/hooks/*.py\n```\n\n**Invalid JSON error:**\n\n```python\n# Add JSON validation\ntry:\n    input_data = json.load(sys.stdin)\nexcept json.JSONDecodeError as e:\n    print(f\"Invalid JSON: {e}\", file=sys.stderr)\n    sys.exit(1)\n```\n\n**Timeout errors:**\n\n```json\n{\n  \"timeout\": 60  // Increase timeout\n}\n```\n\n**Hook modifying unexpected tools:**\nCheck matcher pattern - it may be too broad:\n\n```json\n// TOO BROAD - matches everything\n\"matcher\": \"*\"\n\n// SPECIFIC - only matches intended tools\n\"matcher\": \"Write|Edit\"\n```\n\n### Performance Debugging\n\nMonitor hook execution time:\n\n```python\nimport time\n\nstart = time.time()\n# ... hook logic ...\nduration = time.time() - start\n\nif duration > 1.0:\n    logging.warning(f\"Hook took {duration:.2f}s - consider optimization\")\n```\n\nPerformance targets:\n\n- <1s ideal for PreToolUse hooks\n- <5s maximum to avoid user frustration\n- Use timeouts to prevent hanging\n",
        "plugins/claude-code-meta/skills/claude-code-mcp/SKILL.md": "---\nname: claude-code-mcp\ndescription: This skill should be used when configuring, installing, or managing MCP (Model Context Protocol) servers in Claude Code. Use when users need to connect Claude Code to external tools, databases, APIs, or services through MCP integration.\n---\n\n# Claude Code MCP Configuration\n\nGuide Claude through configuring and managing MCP (Model Context Protocol) servers to connect Claude Code with external tools, databases, and services.\n\n## Purpose\n\nMCP servers enable Claude Code to interact with external tools and data sources through a standardized protocol. This skill helps install, configure, and manage MCP servers across different scopes (local, project, user), authenticate with remote services, and troubleshoot connection issues.\n\n## When to Use This Skill\n\nUse this skill when:\n\n- Installing MCP servers (HTTP, SSE, or stdio transport)\n- Configuring MCP server authentication and environment variables\n- Managing MCP server scopes (local, project, user)\n- Troubleshooting MCP server connectivity or authentication issues\n- Setting up team-wide MCP server configurations\n- Importing MCP servers from Claude Desktop\n- Using MCP resources and prompts in conversations\n\n**Do NOT use this skill for:**\n\n- Creating or building MCP servers (use MCP SDK documentation instead)\n- Writing MCP server code (this skill is for configuration only)\n\n## MCP Server Transports\n\nMCP servers can connect using three transport mechanisms:\n\n### HTTP Transport (Recommended)\n\nBest for cloud-based services with REST APIs.\n\n**Basic syntax:**\n\n```bash\nclaude mcp add --transport http <name> <url>\n```\n\n**Examples:**\n\n```bash\n# Simple HTTP server\nclaude mcp add --transport http notion https://mcp.notion.com/mcp\n\n# With authentication header\nclaude mcp add --transport http secure-api https://api.example.com/mcp \\\n  --header \"Authorization: Bearer your-token\"\n\n# With custom headers\nclaude mcp add --transport http custom-api https://api.example.com/mcp \\\n  --header \"X-API-Key: key123\" \\\n  --header \"X-Custom-Header: value\"\n```\n\n### SSE Transport (Deprecated)\n\nServer-Sent Events transport. Use HTTP where available.\n\n**Basic syntax:**\n\n```bash\nclaude mcp add --transport sse <name> <url>\n```\n\n**Example:**\n\n```bash\nclaude mcp add --transport sse asana https://mcp.asana.com/sse\n```\n\n### Stdio Transport\n\nFor local processes needing direct system access.\n\n**Basic syntax:**\n\n```bash\nclaude mcp add --transport stdio <name> [--env KEY=value] -- <command> [args...]\n```\n\n**Examples:**\n\n```bash\n# NPM package\nclaude mcp add --transport stdio airtable \\\n  --env AIRTABLE_API_KEY=YOUR_KEY \\\n  -- npx -y airtable-mcp-server\n\n# Local script\nclaude mcp add --transport stdio custom-tool \\\n  --env CONFIG_PATH=/path/to/config \\\n  -- /usr/local/bin/custom-mcp-server\n\n# Python package\nclaude mcp add --transport stdio python-tool \\\n  -- python -m my_mcp_server\n```\n\n**Important:** Use `--` to separate Claude CLI flags from MCP server command/arguments.\n\n## MCP Server Scopes\n\nMCP servers can be configured at three different scopes:\n\n### Local Scope (Default)\n\n- **Location:** Project `.mcp.json` (gitignored)\n- **Visibility:** Current project only\n- **Use case:** Private configurations, testing, local development\n- **Command:** `claude mcp add --scope local` (or omit `--scope`)\n\n### Project Scope\n\n- **Location:** Project `.mcp.json` (committed to git)\n- **Visibility:** All team members using the project\n- **Use case:** Team-shared integrations, required tooling\n- **Command:** `claude mcp add --scope project`\n\n### User Scope\n\n- **Location:** `~/.claude/mcp.json`\n- **Visibility:** All projects for current user\n- **Use case:** Personal tools, cross-project services\n- **Command:** `claude mcp add --scope user`\n\n**Scope precedence:** Local > Project > User\n\nWhen the same server name exists in multiple scopes, the highest precedence wins.\n\n## MCP Configuration Workflow\n\nTo configure an MCP server, follow this process:\n\n### Step 1: Identify Requirements\n\nDetermine what information is needed:\n\n1. **Transport type** - HTTP, SSE, or stdio?\n2. **Server URL or command** - Where is the server?\n3. **Authentication** - API keys, OAuth, headers?\n4. **Environment variables** - Configuration needed?\n5. **Scope** - Local, project, or user?\n\nExample questions to ask:\n\n- \"What service are you connecting to?\"\n- \"Do you have an API key or authentication token?\"\n- \"Should this be available to your whole team (project scope) or just you (local/user scope)?\"\n- \"Is this a cloud service (HTTP) or local tool (stdio)?\"\n\n### Step 2: Determine Transport and Scope\n\nBased on the requirements:\n\n**Choose HTTP when:**\n\n- Connecting to cloud-based REST APIs\n- Service provides an MCP endpoint URL\n- No local process needed\n\n**Choose stdio when:**\n\n- Running local tools or scripts\n- Need direct system access\n- Using NPM packages or local executables\n\n**Choose SSE when:**\n\n- Service only supports SSE transport\n- HTTP is not available (prefer HTTP if both exist)\n\n**Choose scope based on:**\n\n- **Local:** Testing, temporary, contains secrets not in env vars\n- **Project:** Team needs access, shared configuration\n- **User:** Personal tool across all projects\n\n### Step 3: Install the MCP Server\n\nUse the appropriate `claude mcp add` command based on transport and scope.\n\n**HTTP example:**\n\n```bash\nclaude mcp add --transport http --scope project \\\n  notion https://mcp.notion.com/mcp\n```\n\n**Stdio example:**\n\n```bash\nclaude mcp add --transport stdio --scope user \\\n  airtable \\\n  --env AIRTABLE_API_KEY=${AIRTABLE_API_KEY} \\\n  -- npx -y airtable-mcp-server\n```\n\n**With multiple environment variables:**\n\n```bash\nclaude mcp add --transport stdio --scope project \\\n  custom-db \\\n  --env DB_HOST=${DB_HOST} \\\n  --env DB_PORT=${DB_PORT:-5432} \\\n  --env DB_NAME=analytics \\\n  -- /usr/local/bin/db-mcp-server\n```\n\n### Step 4: Verify Installation\n\nAfter installation:\n\n1. **List servers:**\n\n   ```bash\n   claude mcp list\n   ```\n\n2. **Get server details:**\n\n   ```bash\n   claude mcp get <server-name>\n   ```\n\n3. **Test in Claude Code:**\n   - Start Claude Code\n   - Ask the user to run `/mcp` to see server status\n   - Try using a tool from the server\n\n### Step 5: Authenticate (if required)\n\nSome servers require OAuth or additional authentication:\n\n1. **Start Claude Code**\n2. **Run `/mcp` command**\n3. **Select the server requiring authentication**\n4. **Follow browser authentication flow**\n5. **Verify authentication succeeded in `/mcp` menu**\n\nTokens are securely stored and auto-refreshed. Clear with \"Clear authentication\" from `/mcp` menu.\n\n### Step 6: Troubleshoot if Needed\n\nIf the server isn't working:\n\n**Check server status:**\n\n```bash\nclaude mcp list\n```\n\n**Get detailed information:**\n\n```bash\nclaude mcp get <server-name>\n```\n\n**Common issues:**\n\n1. **Server not starting (stdio)**\n   - Verify command is executable: `which npx`, `which python`\n   - Check environment variables are set\n   - Test command independently\n   - On Windows, use `cmd /c` wrapper: `-- cmd /c npx -y package`\n\n2. **Authentication failures (HTTP/SSE)**\n   - Verify API keys are correct\n   - Check headers are properly formatted\n   - Use `/mcp` to re-authenticate OAuth servers\n   - Verify URL is correct and accessible\n\n3. **Server timeout**\n   - Increase timeout: `MCP_TIMEOUT=10000 claude`\n   - Check network connectivity\n   - Verify server is responding\n\n4. **Output limit warnings**\n   - Increase output limit: `export MAX_MCP_OUTPUT_TOKENS=50000`\n   - Default is 25,000 tokens\n   - Warning at 10,000 tokens\n\nFor additional details on popular MCP servers and their specific configurations, consult the [official MCP documentation](https://docs.claude.com/en/docs/claude-code/mcp).\n\n## Common MCP Server Patterns\n\n### Cloud Service with API Key (HTTP)\n\n```bash\nclaude mcp add --transport http --scope user \\\n  service-name https://api.service.com/mcp \\\n  --header \"Authorization: Bearer ${API_KEY}\"\n```\n\n### Local NPM Package (stdio)\n\n```bash\nclaude mcp add --transport stdio --scope user \\\n  package-name \\\n  --env API_KEY=${API_KEY} \\\n  -- npx -y @org/mcp-package\n```\n\n### Team Database Access (stdio, project scope)\n\n```bash\nclaude mcp add --transport stdio --scope project \\\n  analytics-db \\\n  --env DB_URL=${ANALYTICS_DB_URL} \\\n  -- npx -y @bytebase/dbhub\n```\n\n### Personal Tool Across Projects (stdio, user scope)\n\n```bash\nclaude mcp add --transport stdio --scope user \\\n  my-tool \\\n  -- /usr/local/bin/my-mcp-tool\n```\n\n## Environment Variable Handling\n\nMCP configurations support environment variable expansion:\n\n**Syntax:**\n\n- `${VAR}` - Required variable (error if not set)\n- `${VAR:-default}` - Optional with default value\n\n**Examples:**\n\n```bash\n# Required variable\n--env DB_HOST=${DB_HOST}\n\n# Optional with default\n--env DB_PORT=${DB_PORT:-5432}\n\n# Literal value\n--env ENVIRONMENT=production\n\n# Multiple variables\n--env API_URL=${API_URL} \\\n--env API_KEY=${API_KEY} \\\n--env TIMEOUT=${TIMEOUT:-30}\n```\n\n**Setting environment variables:**\n\n```bash\n# In shell (temporary)\nexport API_KEY=your-key-here\nclaude mcp add --transport stdio tool --env API_KEY=${API_KEY} -- npx tool\n\n# In .env file (project)\necho \"API_KEY=your-key-here\" >> .env\nsource .env\nclaude mcp add ...\n\n# In shell profile (permanent)\necho 'export API_KEY=your-key-here' >> ~/.zshrc\nsource ~/.zshrc\n```\n\n## Managing MCP Servers\n\n### List All Servers\n\n```bash\nclaude mcp list\n```\n\nShows all configured servers across all scopes with status.\n\n### Get Server Details\n\n```bash\nclaude mcp get <server-name>\n```\n\nShows configuration, scope, transport type, and status.\n\n### Remove a Server\n\n```bash\nclaude mcp remove <server-name>\n```\n\nRemoves from the scope where it was added.\n\n### Check Status in Claude Code\n\nWithin Claude Code, use `/mcp` command to:\n\n- View all connected servers\n- See authentication status\n- Re-authenticate OAuth servers\n- Clear authentication tokens\n\n## Using MCP Tools in Conversations\n\nOnce servers are connected:\n\n### Access MCP Tools\n\nClaude Code automatically sees MCP tools. Just ask:\n\n```\n> \"Check Sentry for errors in the last 24 hours\"\n> \"Create a GitHub issue for this bug\"\n> \"Query the database for user count\"\n```\n\n### Use MCP Resources\n\nType `@` to list available resources:\n\n```\n> \"Analyze @github:issue://123\"\n> \"Review @notion:page://abc123\"\n```\n\nResources are auto-fetched and attached to context.\n\n### Use MCP Prompts as Slash Commands\n\nMCP prompts appear as slash commands:\n\n```\n/mcp__github__list_prs\n/mcp__github__pr_review 456\n/mcp__jira__create_issue \"Bug in login\" high\n```\n\n## Plugin-Provided MCP Servers\n\nPlugins can bundle MCP servers that start automatically:\n\n**Plugin configuration (`.mcp.json` in plugin root):**\n\n```json\n{\n  \"database-tools\": {\n    \"command\": \"${CLAUDE_PLUGIN_ROOT}/servers/db-server\",\n    \"args\": [\"--config\", \"${CLAUDE_PLUGIN_ROOT}/config.json\"],\n    \"env\": {\n      \"DB_URL\": \"${DB_URL}\"\n    }\n  }\n}\n```\n\n**Key points:**\n\n- Managed via plugin install/uninstall, not `/mcp` commands\n- Use `${CLAUDE_PLUGIN_ROOT}` for plugin-relative paths\n- Start automatically when plugin is enabled\n- Appear in `/mcp` menu but managed by plugin\n\n## Team Configuration Best Practices\n\nFor team-wide MCP server setup:\n\n### Project Scope Configuration\n\n1. **Use project scope for shared integrations:**\n\n   ```bash\n   claude mcp add --scope project \\\n     github https://api.githubcopilot.com/mcp/\n   ```\n\n2. **Commit `.mcp.json` to repository**\n3. **Document required environment variables in README:**\n\n   ```markdown\n   ## Required Environment Variables\n   - `GITHUB_TOKEN` - GitHub personal access token\n   - `JIRA_API_KEY` - Jira API key\n   ```\n\n4. **Team members set environment variables locally:**\n\n   ```bash\n   export GITHUB_TOKEN=ghp_xxxx\n   export JIRA_API_KEY=xxxx\n   ```\n\n### Environment Variable Management\n\n**For sensitive values:**\n\n- Never commit actual secrets to `.mcp.json`\n- Use `${VAR}` expansion\n- Document required variables\n- Use `.env` files (gitignored) for local values\n\n**For non-sensitive values:**\n\n- Can specify directly in configuration\n- Example: `--env ENVIRONMENT=production`\n\n## Importing from Claude Desktop\n\nImport existing MCP servers from Claude Desktop:\n\n```bash\nclaude mcp add-from-claude-desktop\n```\n\nInteractively select which servers to import. Configurations are copied to appropriate scope.\n\n## Advanced: JSON Configuration\n\nAdd servers via JSON for programmatic setup:\n\n```bash\n# HTTP server\nclaude mcp add-json weather-api '{\n  \"type\": \"http\",\n  \"url\": \"https://api.weather.com/mcp\",\n  \"headers\": {\n    \"Authorization\": \"Bearer token\"\n  }\n}'\n\n# Stdio server\nclaude mcp add-json db-tool '{\n  \"type\": \"stdio\",\n  \"command\": \"npx\",\n  \"args\": [\"-y\", \"@tool/mcp\"],\n  \"env\": {\n    \"DB_URL\": \"${DB_URL}\"\n  }\n}'\n```\n\n## Additional Resources\n\nFor additional information about MCP:\n\n- **Popular MCP Servers**: Browse the [MCP servers repository](https://github.com/modelcontextprotocol/servers) for community-maintained servers\n- **Building MCP Servers**: See the [MCP SDK documentation](https://modelcontextprotocol.io/quickstart/server) to create your own servers\n- **Official Documentation**: Consult the [Claude Code MCP guide](https://docs.claude.com/en/docs/claude-code/mcp) for complete reference documentation\n\n## Troubleshooting\n\n### Server Not Appearing\n\n**Symptoms:** Server added but not visible in `/mcp`\n\n**Solutions:**\n\n- Restart Claude Code after adding server\n- Verify server was added: `claude mcp list`\n- Check correct scope: `claude mcp get <name>`\n- For stdio: verify command is executable\n\n### Authentication Failures\n\n**Symptoms:** OAuth flow fails or API returns 401/403\n\n**Solutions:**\n\n- Use `/mcp` to re-authenticate\n- Verify API key is correct\n- Check header format: `\"Authorization: Bearer token\"`\n- Clear and re-authenticate: `/mcp` â Clear authentication\n\n### Command Not Found (stdio)\n\n**Symptoms:** \"command not found\" for stdio servers\n\n**Solutions:**\n\n- Verify command exists: `which npx`, `which python`\n- Use full path: `-- /usr/local/bin/tool`\n- On Windows: use `-- cmd /c npx -y package`\n- Check PATH environment variable\n\n### Environment Variable Not Expanded\n\n**Symptoms:** `${VAR}` appears literally in configuration\n\n**Solutions:**\n\n- Verify variable is exported: `echo $VAR`\n- Set before running command: `export VAR=value`\n- Use shell substitution if needed: `--env VAR=$VAR` (expanded by shell)\n\n### Server Timeout\n\n**Symptoms:** Server connection times out\n\n**Solutions:**\n\n- Increase timeout: `MCP_TIMEOUT=10000 claude`\n- Check network connectivity\n- Verify server URL is correct\n- For stdio: check command starts quickly\n\n## Integration with Other Skills\n\nThis skill works alongside other claude-code-meta skills:\n\n- **Use `claude-code-plugins`** - For bundling MCP servers in plugins\n\nActivate these skills when working on plugin-provided MCP servers or automated MCP configuration workflows.\n",
        "plugins/claude-code-meta/skills/claude-code-plugins/SKILL.md": "---\nname: claude-code-plugins\ndescription: This skill should be used when creating, configuring, or distributing Claude Code plugins and marketplaces. Use when users ask about the plugin system architecture, how to package multiple components together, create marketplaces, or set up team-wide plugin distribution.\n---\n\n# Claude Code Plugins\n\nGuide Claude through creating, configuring, and distributing complete Claude Code plugins and marketplaces.\n\n## Purpose\n\nPlugins are packages that bundle multiple Claude Code extensions (commands, agents, skills, hooks, MCP servers) for distribution. This skill helps understand the plugin architecture, create well-structured plugins, set up marketplaces, and configure team-wide plugin distribution.\n\n## When to Use This Skill\n\nUse this skill when:\n\n- Creating a new plugin that bundles multiple components together\n- Setting up plugin marketplaces for team or community distribution\n- Configuring team-wide automatic plugin installation\n- Understanding how plugins, commands, agents, skills, hooks, and MCP servers relate\n- Deciding between creating individual components vs packaging them as plugins\n- Troubleshooting plugin structure or distribution issues\n\n**Do NOT use this skill for:**\n\n- Creating individual slash commands - use `claude-code-slash-commands` skill instead\n- Creating individual subagents - use `claude-code-subagents` skill instead\n- Creating individual hooks - use `claude-code-hooks` skill instead\n- Creating individual skills - use `skill-creator` skill instead\n\n## Plugin System Architecture\n\nClaude Code's extensibility system has two levels:\n\n### Individual Components (Project/User Level)\n\nComponents can be installed directly in projects or user directories:\n\n- **Commands** - `.claude/commands/` or `~/.claude/commands/`\n- **Agents** - `.claude/agents/` or `~/.claude/agents/`\n- **Hooks** - `.claude/settings.json` or `~/.claude/settings.json`\n- **Skills** - Activated via plugin marketplaces only\n\n### Plugins (Distribution Level)\n\nPlugins bundle multiple components for distribution:\n\n```\nmy-plugin/\nâââ .claude-plugin/\nâ   âââ plugin.json          # Plugin metadata (required)\nâââ commands/                 # Slash commands (optional)\nâ   âââ deploy.md\nâââ agents/                   # Subagents (optional)\nâ   âââ reviewer.md\nâââ skills/                   # Agent Skills (optional)\nâ   âââ code-quality/\nâ       âââ SKILL.md\nâââ hooks/                    # Event handlers (optional)\nâ   âââ hooks.json\nâââ .mcp.json                 # MCP servers (optional)\n```\n\n## When to Create Plugins vs Individual Components\n\n### Use Individual Components When:\n\n- Creating one-off customizations for a single project\n- Testing new workflows before wider distribution\n- Building personal preferences not shared with others\n- Components are independent and don't require coordination\n\n### Use Plugins When:\n\n- Bundling related components that work together\n- Distributing tools across multiple projects or teams\n- Versioning and updating components as a unit\n- Providing Skills (Skills require plugin distribution)\n- Creating reusable workflows for community sharing\n\n## Plugin Creation Process\n\nTo create a plugin, follow this process in order:\n\n### Step 1: Understanding Plugin Requirements\n\nSkip this step only when the plugin's purpose and components are already clearly defined.\n\nTo create an effective plugin, clearly understand what components the plugin should include and how they work together. This understanding can come from existing workflows that need packaging or new requirements.\n\nFor example, when building a deployment automation plugin, relevant considerations include:\n\n- \"What commands do users need? Deploy, rollback, status checks?\"\n- \"Should there be a specialized deployment agent?\"\n- \"What hooks are needed? Pre-deploy validation, post-deploy notifications?\"\n- \"Are there external tools to integrate via MCP?\"\n- \"Should this include Skills for automatic deployment analysis?\"\n\nFor a code quality plugin:\n\n- \"What formatting/linting commands are needed?\"\n- \"Should there be a code review agent?\"\n- \"What hooks trigger on file changes?\"\n- \"Should Skills provide automatic code analysis?\"\n\nConclude this step when there is a clear sense of:\n1. What components the plugin needs\n2. How components interact with each other\n3. Who will use the plugin (project team, organization, community)\n\n### Step 2: Planning Component Organization\n\nTo turn requirements into an effective plugin, analyze the use case by:\n\n1. Identifying which component types are needed (commands, agents, skills, hooks, MCP)\n2. Determining how components should be organized\n3. Deciding on plugin scope and distribution strategy\n\nExample: For a deployment automation plugin, the analysis shows:\n\n1. **Commands** - `/deploy`, `/rollback`, `/deploy-status`\n2. **Agent** - `deployment-manager` for handling complex deployments\n3. **Hooks** - PreToolUse validation for deployment commands\n4. **Skills** - `deployment-analysis` for automatic deployment planning\n5. **Distribution** - Organization-wide via private marketplace\n\nExample: For a code quality plugin, the analysis shows:\n\n1. **Commands** - `/format`, `/lint`, `/review-code`\n2. **Agent** - `code-reviewer` for comprehensive reviews\n3. **Hooks** - PostToolUse formatting after file edits\n4. **Skills** - `code-quality-checker` for automatic analysis\n5. **Distribution** - Open source via GitHub marketplace\n\nReview the component-specific skills for detailed guidance:\n- [references/plugins-guide.md](references/plugins-guide.md) for complete plugin documentation\n- `claude-code-slash-commands` skill for command creation\n- `claude-code-subagents` skill for agent creation\n- `claude-code-hooks` skill for hook creation\n- `skill-creator` skill for Skills creation\n\n### Step 3: Creating Plugin Structure\n\nAt this point, create the basic plugin structure:\n\n1. **Create plugin directory** - Choose a descriptive kebab-case name:\n   ```bash\n   mkdir my-plugin\n   cd my-plugin\n   ```\n\n2. **Create plugin manifest** - Required `.claude-plugin/plugin.json`:\n   ```bash\n   mkdir .claude-plugin\n   cat > .claude-plugin/plugin.json << 'EOF'\n   {\n     \"name\": \"my-plugin\",\n     \"version\": \"1.0.0\",\n     \"description\": \"Brief plugin description\",\n     \"author\": {\n       \"name\": \"Your Name\",\n       \"email\": \"your.email@example.com\"\n     },\n     \"license\": \"MIT\"\n   }\n   EOF\n   ```\n\n   **Important:** This plugin.json should contain ONLY basic metadata (name, version, description, author, license). Do NOT include component specifications like `skills`, `commands`, `agents`, etc. here - those belong in the marketplace.json to avoid manifest conflicts.\n\n3. **Create component directories** - Only create directories for components you'll include:\n   ```bash\n   mkdir -p commands    # If including commands\n   mkdir -p agents      # If including agents\n   mkdir -p skills      # If including Skills\n   mkdir -p hooks       # If including hooks\n   mkdir -p scripts     # If including helper scripts\n   ```\n\n4. **Add documentation** - Create README.md explaining the plugin:\n   ```bash\n   cat > README.md << 'EOF'\n   # My Plugin\n\n   Brief description of what this plugin does.\n\n   ## Components\n\n   - Commands: List commands provided\n   - Agents: List agents provided\n   - Skills: List Skills provided\n   - Hooks: Describe automation provided\n\n   ## Installation\n\n   ```\n   /plugin marketplace add owner/repo\n   /plugin install my-plugin@marketplace-name\n   ```\n   EOF\n   ```\n\n### Step 4: Implementing Plugin Components\n\nWhen implementing the plugin, create components using their respective creation processes:\n\n#### For Commands\n\nUse the `claude-code-slash-commands` skill and creation script:\n\n```bash\n# From plugin root\n./path/to/scripts/create_slash_command.sh command-name --plugin\n```\n\nOr activate `claude-code-slash-commands` skill for guidance.\n\n#### For Agents\n\nUse the `claude-code-subagents` skill and creation script:\n\n```bash\n# From plugin root\n./path/to/scripts/create_subagent.sh agent-name --plugin\n```\n\nOr activate `claude-code-subagents` skill for guidance.\n\n#### For Skills\n\nUse the `skill-creator` skill and follow the Agent Skills specification:\n\n```bash\n# From plugin root, create skill directory\nmkdir -p skills/my-skill\n```\n\nThen activate `skill-creator` skill for full guidance on writing SKILL.md.\n\n#### For Hooks\n\nUse the `claude-code-hooks` skill for guidance. Create `hooks/hooks.json`:\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n#### For MCP Servers\n\nCreate `.mcp.json` at plugin root:\n\n```json\n{\n  \"mcpServers\": {\n    \"plugin-server\": {\n      \"command\": \"${CLAUDE_PLUGIN_ROOT}/servers/server\",\n      \"args\": [\"--config\", \"${CLAUDE_PLUGIN_ROOT}/config.json\"]\n    }\n  }\n}\n```\n\n**Writing Style:** Focus on how components work together. Ensure commands, agents, and Skills reference each other appropriately. Use `${CLAUDE_PLUGIN_ROOT}` for all plugin-relative paths.\n\n### Step 5: Setting Up Distribution\n\nOnce the plugin components are implemented, set up distribution:\n\n#### Option A: Local Testing Marketplace\n\nFor development and testing:\n\n1. **Create marketplace directory** - Parallel to plugin:\n   ```bash\n   cd ..\n   mkdir -p dev-marketplace/.claude-plugin\n   ```\n\n2. **Create marketplace manifest**:\n   ```bash\n   cat > dev-marketplace/.claude-plugin/marketplace.json << 'EOF'\n   {\n     \"name\": \"dev-marketplace\",\n     \"owner\": {\n       \"name\": \"Developer\"\n     },\n     \"plugins\": [\n       {\n         \"name\": \"my-plugin\",\n         \"source\": \"./my-plugin\",\n         \"description\": \"Plugin under development\",\n         \"version\": \"1.0.0\",\n         \"strict\": true,\n         \"skills\": [\n           \"./skills/my-skill\"\n         ]\n       }\n     ]\n   }\n   EOF\n   ```\n\n   **Note:** Always set `\"strict\": true` and specify components (skills, commands, agents, etc.) in the marketplace.json, not in the individual plugin.json files.\n\n3. **Test installation**:\n   ```bash\n   claude\n   # In Claude Code:\n   /plugin marketplace add ./dev-marketplace\n   /plugin install my-plugin@dev-marketplace\n   ```\n\n#### Option B: GitHub Marketplace\n\nFor team or community distribution:\n\n1. **Create repository** - Create GitHub repository for plugins\n2. **Organize structure**:\n   ```\n   my-plugins-repo/\n   âââ .claude-plugin/\n   â   âââ marketplace.json\n   âââ plugins/\n       âââ plugin-one/\n       âââ plugin-two/\n   ```\n\n3. **Create marketplace manifest**:\n   ```json\n   {\n     \"name\": \"my-marketplace\",\n     \"owner\": {\n       \"name\": \"Team Name\",\n       \"email\": \"team@example.com\"\n     },\n     \"plugins\": [\n       {\n         \"name\": \"plugin-one\",\n         \"source\": \"./plugins/plugin-one\",\n         \"description\": \"First plugin description\",\n         \"version\": \"1.0.0\",\n         \"author\": {\n           \"name\": \"Team Name\"\n         },\n         \"license\": \"MIT\",\n         \"strict\": true,\n         \"skills\": [\n           \"./skills/my-skill\"\n         ]\n       },\n       {\n         \"name\": \"plugin-two\",\n         \"source\": \"./plugins/plugin-two\",\n         \"description\": \"Second plugin description\",\n         \"version\": \"1.0.0\",\n         \"author\": {\n           \"name\": \"Team Name\"\n         },\n         \"license\": \"MIT\",\n         \"strict\": true,\n         \"commands\": [\n           \"./commands/my-command.md\"\n         ]\n       }\n     ]\n   }\n   ```\n\n   **Important:** Set `\"strict\": true` in each plugin entry. This tells Claude Code to use component specifications from the marketplace.json and ignore any component specs in individual plugin.json files, avoiding manifest conflicts.\n\n4. **Distribute**:\n   ```\n   /plugin marketplace add owner/repo\n   /plugin install plugin-one@my-marketplace\n   ```\n\nFor complete marketplace setup, see [references/plugin-marketplaces-guide.md](references/plugin-marketplaces-guide.md).\n\n### Step 6: Configuring Team Installation\n\nFor automatic team-wide plugin installation, configure project-level settings:\n\n1. **Create or edit** `.claude/settings.json` in project repository:\n   ```json\n   {\n     \"extraKnownMarketplaces\": {\n       \"team-tools\": {\n         \"source\": {\n           \"source\": \"github\",\n           \"repo\": \"company/claude-plugins\"\n         }\n       }\n     },\n     \"enabledPlugins\": {\n       \"deployment-tools@team-tools\": true,\n       \"code-quality@team-tools\": true\n     }\n   }\n   ```\n\n2. **Commit to repository** - Team members who trust the folder will automatically:\n   - Add configured marketplaces\n   - Install enabled plugins\n   - Receive plugin updates\n\n3. **Document for team** - Add installation instructions to project README.\n\n### Step 7: Testing and Iteration\n\nOnce the plugin is distributed, test thoroughly:\n\n#### Test Component Integration\n\n- **Test commands**: Run each command and verify it works\n- **Test agents**: Invoke agents automatically and explicitly\n- **Test Skills**: Trigger Skills and verify they're invoked correctly\n- **Test hooks**: Trigger events and verify hooks execute\n- **Test MCP servers**: Verify external tools are accessible\n\n#### Test Component Interaction\n\n- Verify commands can reference agents (e.g., \"Use the X agent to deploy\")\n- Verify Skills can recommend commands to users\n- Verify hooks work with plugin scripts using `${CLAUDE_PLUGIN_ROOT}`\n- Verify agents have appropriate tool access\n\n#### Test Distribution\n\n- Install from marketplace on clean Claude Code instance\n- Verify all components are loaded correctly\n- Test on different operating systems if applicable\n- Verify team installation works for project-level configuration\n\n**Iteration workflow:**\n\n1. **Use the plugin** on real tasks with real users\n2. **Notice issues** - Missing components? Integration problems? Unclear usage?\n3. **Identify improvements** - Should components be added/removed? Better organization?\n4. **Update plugin** - Modify components, bump version\n5. **Test changes** - Uninstall and reinstall to verify updates work\n6. **Document changes** - Update CHANGELOG.md and README.md\n\n## Plugin vs Individual Component Decision Tree\n\nUse this decision tree to determine the right approach:\n\n**Question 1: Are you creating multiple related components?**\n- Yes â Continue to Question 2\n- No â Create individual component in `.claude/` or `~/.claude/`\n\n**Question 2: Will these components be shared across projects or with others?**\n- Yes â Create plugin\n- No â Create individual components in project `.claude/` directory\n\n**Question 3: Do you need to include Skills?**\n- Yes â Create plugin (Skills require plugin distribution)\n- No â Continue to Question 4\n\n**Question 4: Do you need version control and updates for components as a unit?**\n- Yes â Create plugin\n- No â Create individual components\n\n## Common Plugin Patterns\n\n### Code Quality Plugin\n\n**Components:**\n- Commands: `/format`, `/lint`, `/review`\n- Agent: `code-reviewer`\n- Hooks: PostToolUse formatting\n- Skills: `code-quality-checker`\n\n**Use case:** Enforce code standards across team projects\n\n### Deployment Plugin\n\n**Components:**\n- Commands: `/deploy`, `/rollback`, `/status`\n- Agent: `deployment-manager`\n- Hooks: PreToolUse deployment validation\n- MCP: Deployment API integration\n\n**Use case:** Streamline deployment workflows\n\n### Documentation Plugin\n\n**Components:**\n- Commands: `/docs`, `/api-docs`, `/changelog`\n- Agent: `documentation-writer`\n- Skills: `doc-generator`\n\n**Use case:** Automate documentation generation\n\n### Testing Plugin\n\n**Components:**\n- Commands: `/test`, `/coverage`, `/benchmark`\n- Agent: `test-runner`\n- Hooks: PreToolUse test validation\n- Skills: `test-analyzer`\n\n**Use case:** Comprehensive testing workflows\n\n## Reference Documentation\n\nFor detailed information, refer to:\n\n- [references/plugins-guide.md](references/plugins-guide.md) - Complete plugin guide from docs\n- [references/plugin-marketplaces-guide.md](references/plugin-marketplaces-guide.md) - Marketplace creation and distribution\n- [references/plugins-reference.md](references/plugins-reference.md) - Technical specifications and schemas\n\nLoad these references when users need detailed technical information beyond the workflow guidance in this skill.\n\n## Best Practices\n\n### Plugin Design\n\n- **Single responsibility** - Each plugin should have a clear, focused purpose\n- **Component cohesion** - Bundle components that work together, not unrelated tools\n- **Clear naming** - Use descriptive kebab-case names that indicate purpose\n- **Complete documentation** - Include README.md with installation and usage instructions\n- **Semantic versioning** - Use semver for version management\n\n### Component Organization\n\n- **Logical grouping** - Organize related commands/agents/Skills together\n- **Consistent naming** - Use consistent naming patterns across components\n- **Clear references** - Have components reference each other (e.g., Skills mention commands)\n- **Appropriate tool access** - Grant agents only necessary tools\n\n### Distribution Strategy\n\n- **Local testing first** - Test with local marketplace before GitHub distribution\n- **Version control** - Commit plugin to git repository\n- **Changelog maintenance** - Document changes in CHANGELOG.md\n- **License clarity** - Include LICENSE file and license field in plugin.json\n- **Community engagement** - For public plugins, provide issue tracking and contribution guidelines\n\n### Team Adoption\n\n- **Project-level config** - Use `.claude/settings.json` for automatic installation\n- **Documentation** - Provide clear setup instructions for team members\n- **Training** - Help team members discover and use plugin features\n- **Feedback loops** - Gather team feedback and iterate\n\n## Troubleshooting\n\n### Plugin Not Loading\n\n**Symptoms:** Plugin installed but components not available\n\n**Solutions:**\n- Verify `.claude-plugin/plugin.json` exists and has valid JSON\n- Ensure component directories are at plugin root, not inside `.claude-plugin/`\n- Check that plugin is enabled: `/plugin` â Manage Plugins\n- Try uninstall and reinstall: `/plugin uninstall` then `/plugin install`\n\n### Components Not Found\n\n**Symptoms:** Plugin loads but specific components missing\n\n**Solutions:**\n- Verify component files exist in correct directories (`commands/`, `agents/`, etc.)\n- Check component file format (markdown for commands/agents, JSON for hooks)\n- For commands: Verify frontmatter and markdown structure\n- For agents: Verify frontmatter exists\n- For Skills: Verify SKILL.md exists with proper frontmatter\n\n### Hooks Not Executing\n\n**Symptoms:** Hooks configured but not firing\n\n**Solutions:**\n- Verify `hooks/hooks.json` has valid JSON syntax\n- Check hook scripts are executable: `chmod +x script.sh`\n- Use `${CLAUDE_PLUGIN_ROOT}` for plugin-relative paths\n- Test hook script independently with sample input\n- Run `claude --debug` to see hook execution details\n\n### MCP Servers Not Starting\n\n**Symptoms:** MCP servers configured but not accessible\n\n**Solutions:**\n- Verify `.mcp.json` has valid JSON syntax\n- Check MCP server command is accessible\n- Use `${CLAUDE_PLUGIN_ROOT}` for plugin-relative paths\n- Test MCP server independently\n- Check environment variables are set correctly\n\n## Integration with Other Skills\n\nThis skill works alongside other claude-code-meta skills:\n\n- **Use `claude-code-slash-commands`** - For creating individual commands within plugins\n- **Use `claude-code-subagents`** - For creating individual agents within plugins\n- **Use `claude-code-hooks`** - For creating hook configurations within plugins\n- **Use `skill-creator`** - For creating Skills within plugins\n\nActivate these skills when deep-diving into specific component creation while building plugins.\n",
        "plugins/claude-code-meta/skills/claude-code-plugins/references/plugin-marketplaces-guide.md": "# Plugin marketplaces\n\nCreate and manage plugin marketplaces to distribute Claude Code extensions across teams and communities.\n\nPlugin marketplaces are catalogs of available plugins that make it easy to discover, install, and manage Claude Code extensions. This guide shows you how to use existing marketplaces and create your own for team distribution.\n\n## Overview\n\nA marketplace is a JSON file that lists available plugins and describes where to find them. Marketplaces provide:\n\n- **Centralized discovery**: Browse plugins from multiple sources in one place\n- **Version management**: Track and update plugin versions automatically\n- **Team distribution**: Share required plugins across your organization\n- **Flexible sources**: Support for git repositories, GitHub repos, local paths, and package managers\n\n## Prerequisites\n\n- Claude Code installed and running\n- Basic familiarity with JSON file format\n- For creating marketplaces: Git repository or local development environment\n\n## Add and use marketplaces\n\nAdd marketplaces using the `/plugin marketplace` commands to access plugins from different sources:\n\n### Add GitHub marketplaces\n\nAdd a GitHub repository containing `.claude-plugin/marketplace.json`:\n\n```\n/plugin marketplace add owner/repo\n```\n\n### Add Git repositories\n\nAdd any git repository:\n\n```\n/plugin marketplace add https://gitlab.com/company/plugins.git\n```\n\n### Add local marketplaces for development\n\nAdd local directory containing `.claude-plugin/marketplace.json`:\n\n```\n/plugin marketplace add ./my-marketplace\n```\n\nAdd direct path to marketplace.json file:\n\n```\n/plugin marketplace add ./path/to/marketplace.json\n```\n\nAdd remote marketplace.json via URL:\n\n```\n/plugin marketplace add https://url.of/marketplace.json\n```\n\n### Install plugins from marketplaces\n\nOnce you've added marketplaces, install plugins directly:\n\nInstall from any known marketplace:\n\n```\n/plugin install plugin-name@marketplace-name\n```\n\nBrowse available plugins interactively:\n\n```\n/plugin\n```\n\n### Verify marketplace installation\n\nAfter adding a marketplace:\n\n1. **List marketplaces**: Run `/plugin marketplace list` to confirm it's added\n2. **Browse plugins**: Use `/plugin` to see available plugins from your marketplace\n3. **Test installation**: Try installing a plugin to verify the marketplace works correctly\n\n## Configure team marketplaces\n\nSet up automatic marketplace installation for team projects by specifying required marketplaces in `.claude/settings.json`:\n\n```\n{\n  \"extraKnownMarketplaces\": {\n    \"team-tools\": {\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"your-org/claude-plugins\"\n      }\n    },\n    \"project-specific\": {\n      \"source\": {\n        \"source\": \"git\",\n        \"url\": \"https://git.company.com/project-plugins.git\"\n      }\n    }\n  }\n}\n```\n\nWhen team members trust the repository folder, Claude Code automatically installs these marketplaces and any plugins specified in the `enabledPlugins` field.\n\n## Create your own marketplace\n\nBuild and distribute custom plugin collections for your team or community.\n\n### Prerequisites for marketplace creation\n\n- Git repository (GitHub, GitLab, or other git hosting)\n- Understanding of JSON file format\n- One or more plugins to distribute\n\n### Create the marketplace file\n\nCreate `.claude-plugin/marketplace.json` in your repository root:\n\n```\n{\n  \"name\": \"company-tools\",\n  \"owner\": {\n    \"name\": \"DevTools Team\",\n    \"email\": \"devtools@company.com\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"code-formatter\",\n      \"source\": \"./plugins/formatter\",\n      \"description\": \"Automatic code formatting on save\",\n      \"version\": \"2.1.0\",\n      \"author\": {\n        \"name\": \"DevTools Team\"\n      }\n    },\n    {\n      \"name\": \"deployment-tools\",\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"company/deploy-plugin\"\n      },\n      \"description\": \"Deployment automation tools\"\n    }\n  ]\n}\n```\n\n### Marketplace schema\n\n#### Required fields\n\n| Field      | Type   | Description                           |\n|------------|--------|---------------------------------------|\n| `name`     | string | Marketplace identifier (kebab-case)   |\n| `owner`    | object | Marketplace maintainer information    |\n| `plugins`  | array  | List of available plugins             |\n\n#### Optional metadata\n\n| Field                  | Type   | Description                                  |\n|------------------------|--------|----------------------------------------------|\n| `metadata.description` | string | Brief marketplace description                |\n| `metadata.version`     | string | Marketplace version                          |\n| `metadata.pluginRoot`  | string | Base path for relative plugin sources        |\n\n### Plugin entries\n\n**Required fields:**\n\n| Field    | Type          | Description                          |\n|----------|---------------|--------------------------------------|\n| `name`   | string        | Plugin identifier (kebab-case)       |\n| `source` | string/object | Where to fetch the plugin from       |\n\n**Standard metadata fields (optional):**\n\n| Field       | Type     | Description                                       |\n|-------------|----------|---------------------------------------------------|\n| `description` | string | Brief plugin description                          |\n| `version`     | string | Plugin version                                    |\n| `author`      | object | Plugin author information                         |\n| `homepage`    | string | Plugin homepage or documentation URL              |\n| `repository`  | string | Source code repository URL                        |\n| `license`     | string | SPDX license identifier (e.g., MIT, Apache-2.0)   |\n| `keywords`    | array  | Tags for plugin discovery and categorization      |\n| `category`    | string | Plugin category for organization                  |\n| `tags`        | array  | Tags for searchability                            |\n| `strict`      | boolean| Require plugin.json in plugin folder (default: true)|\n\n**Component configuration fields (optional):**\n\n| Field       | Type     | Description                                |\n|-------------|----------|--------------------------------------------|\n| `commands`  | string/array | Custom paths to command files or directories  |\n| `agents`    | string/array | Custom paths to agent files                     |\n| `hooks`     | string/object| Custom hooks configuration or path to hooks file|\n| `mcpServers`| string/object| MCP server configurations or path to MCP config |\n\n> **Note:** When `strict: true` (default), the plugin must include a `plugin.json` manifest file, and marketplace fields supplement those values. When `strict: false`, the plugin.json is optional. If it's missing, the marketplace entry serves as the complete plugin manifest.\n\n### Plugin sources\n\n#### Relative paths\n\n```\n{\n  \"name\": \"my-plugin\",\n  \"source\": \"./plugins/my-plugin\"\n}\n```\n\n#### GitHub repositories\n\n```\n{\n  \"name\": \"github-plugin\",\n  \"source\": {\n    \"source\": \"github\",\n    \"repo\": \"owner/plugin-repo\"\n  }\n}\n```\n\n#### Git repositories\n\n```\n{\n  \"name\": \"git-plugin\",\n  \"source\": {\n    \"source\": \"url\",\n    \"url\": \"https://gitlab.com/team/plugin.git\"\n  }\n}\n```\n\n#### Advanced plugin entries\n\nPlugin entries can override default component locations and provide additional metadata. `${CLAUDE_PLUGIN_ROOT}` is an environment variable that resolves to the plugin's installation directory.\n\n```\n{\n  \"name\": \"enterprise-tools\",\n  \"source\": {\n    \"source\": \"github\",\n    \"repo\": \"company/enterprise-plugin\"\n  },\n  \"description\": \"Enterprise workflow automation tools\",\n  \"version\": \"2.1.0\",\n  \"author\": {\n    \"name\": \"Enterprise Team\",\n    \"email\": \"enterprise@company.com\"\n  },\n  \"homepage\": \"https://docs.company.com/plugins/enterprise-tools\",\n  \"repository\": \"https://github.com/company/enterprise-plugin\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"enterprise\", \"workflow\", \"automation\"],\n  \"category\": \"productivity\",\n  \"commands\": [\n    \"./commands/core/\",\n    \"./commands/enterprise/\",\n    \"./commands/experimental/preview.md\"\n  ],\n  \"agents\": [\n    \"./agents/security-reviewer.md\",\n    \"./agents/compliance-checker.md\"\n  ],\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate.sh\"\n          }\n        ]\n      }\n    ]\n  },\n  \"mcpServers\": {\n    \"enterprise-db\": {\n      \"command\": \"${CLAUDE_PLUGIN_ROOT}/servers/db-server\",\n      \"args\": [\"--config\", \"${CLAUDE_PLUGIN_ROOT}/config.json\"]\n    }\n  },\n  \"strict\": false\n}\n```\n\n> **Note:** Plugin entries use the plugin manifest schema with all fields optional, plus marketplace-specific fields. When `strict: false`, the marketplace entry serves as the complete plugin manifest if no `plugin.json` exists. When `strict: true` (default), marketplace fields supplement the plugin's manifest file.\n\n## Host and distribute marketplaces\n\nChoose the best hosting strategy for your plugin distribution needs.\n\n### Host on GitHub (recommended)\n\nGitHub provides the easiest distribution method:\n\n1. **Create a repository**: Set up a new repository for your marketplace\n2. **Add marketplace file**: Create `.claude-plugin/marketplace.json` with your plugin definitions\n3. **Share with teams**: Team members add with `/plugin marketplace add owner/repo`\n\n**Benefits:** Built-in version control, issue tracking, and team collaboration features.\n\n### Host on other git services\n\nAny git hosting service works for marketplace distribution, using a URL to an arbitrary git repository. For example, using GitLab:\n\n```\n/plugin marketplace add https://gitlab.com/company/plugins.git\n```\n\n### Use local marketplaces for development\n\nTest your marketplace locally before distribution:\n\nAdd local marketplace for testing:\n\n```\n/plugin marketplace add ./my-local-marketplace\n```\n\nTest plugin installation:\n\n```\n/plugin install test-plugin@my-local-marketplace\n```\n\n## Manage marketplace operations\n\n### List known marketplaces\n\nList all configured marketplaces:\n\n```\n/plugin marketplace list\n```\n\nShows all configured marketplaces with their sources and status.\n\n### Update marketplace metadata\n\nRefresh marketplace metadata:\n\n```\n/plugin marketplace update marketplace-name\n```\n\nRefreshes plugin listings and metadata from the marketplace source.\n\n### Remove a marketplace\n\nRemove a marketplace:\n\n```\n/plugin marketplace remove marketplace-name\n```\n\nRemoves the marketplace from your configuration.\n\n> **Warning:** Removing a marketplace will uninstall any plugins you installed from it.\n\n## Troubleshooting marketplaces\n\n### Common marketplace issues\n\n#### Marketplace not loading\n\n**Symptoms:** Can't add marketplace or see plugins from it\n\n**Solutions:**\n- Verify the marketplace URL is accessible\n- Check that `.claude-plugin/marketplace.json` exists at the specified path\n- Ensure JSON syntax is valid using `claude plugin validate`\n- For private repositories, confirm you have access permissions\n\n#### Plugin installation failures\n\n**Symptoms:** Marketplace appears but plugin installation fails\n\n**Solutions:**\n- Verify plugin source URLs are accessible\n- Check that plugin directories contain required files\n- For GitHub sources, ensure repositories are public or you have access\n- Test plugin sources manually by cloning/downloading\n\n### Validation and testing\n\nTest your marketplace before sharing:\n\nValidate marketplace JSON syntax:\n\n```\nclaude plugin validate .\n```\n\nAdd marketplace for testing:\n\n```\n/plugin marketplace add ./path/to/marketplace\n```\n\nInstall test plugin:\n\n```\n/plugin install test-plugin@marketplace-name\n```\n\nFor complete plugin testing workflows, see [Test your plugins locally](https://docs.claude.com/en/docs/claude-code/plugins#test-your-plugins-locally). For technical troubleshooting, see [Plugins reference](https://docs.claude.com/en/docs/claude-code/plugins-reference).\n\n## Next steps\n\n### For marketplace users\n\n- **Discover community marketplaces**: Search GitHub for Claude Code plugin collections\n- **Contribute feedback**: Report issues and suggest improvements to marketplace maintainers\n- **Share useful marketplaces**: Help your team discover valuable plugin collections\n\n### For marketplace creators\n\n- **Build plugin collections**: Create themed marketplace around specific use cases\n- **Establish versioning**: Implement clear versioning and update policies\n- **Community engagement**: Gather feedback and maintain active marketplace communities\n- **Documentation**: Provide clear README files explaining your marketplace contents\n\n### For organizations\n\n- **Private marketplaces**: Set up internal marketplaces for proprietary tools\n- **Governance policies**: Establish guidelines for plugin approval and security review\n- **Training resources**: Help teams discover and adopt useful plugins effectively\n\n## See also\n\n- [Plugins](https://docs.claude.com/en/docs/claude-code/plugins) - Installing and using plugins\n- [Plugins reference](https://docs.claude.com/en/docs/claude-code/plugins-reference) - Complete technical specifications and schemas\n- [Plugin development](https://docs.claude.com/en/docs/claude-code/plugins#develop-more-complex-plugins) - Creating your own plugins\n- [Settings](https://docs.claude.com/en/docs/claude-code/settings#plugin-configuration) - Plugin configuration options\n",
        "plugins/claude-code-meta/skills/claude-code-plugins/references/plugins-guide.md": "# Plugins\n\nExtend Claude Code with custom commands, agents, hooks, Skills, and MCP servers through the plugin system.\n\n> **Tip:** For complete technical specifications and schemas, see [Plugins reference](https://docs.claude.com/en/docs/claude-code/plugins-reference). For marketplace management, see [Plugin marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces).\n\nPlugins let you extend Claude Code with custom functionality that can be shared across projects and teams. Install plugins from [marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces) to add pre-built commands, agents, hooks, Skills, and MCP servers, or create your own to automate your workflows.\n\n---\n\n## Quickstart\n\nLet's create a simple greeting plugin to get you familiar with the plugin system. We'll build a working plugin that adds a custom command, test it locally, and understand the core concepts.\n\n### Prerequisites\n\n- Claude Code installed on your machine\n- Basic familiarity with command-line tools\n\n### Create your first plugin\n\n1. **Create the marketplace structure**\n   ```\n   mkdir test-marketplace\n   cd test-marketplace\n   ```\n2. **Create the plugin directory**\n   ```\n   mkdir my-first-plugin\n   cd my-first-plugin\n   ```\n3. **Create the plugin manifest**\n   Create `.claude-plugin/plugin.json`\n   ```\n   mkdir .claude-plugin\n   cat > .claude-plugin/plugin.json << 'EOF'\n   {\n     \"name\": \"my-first-plugin\",\n     \"description\": \"A simple greeting plugin to learn the basics\",\n     \"version\": \"1.0.0\",\n     \"author\": {\n       \"name\": \"Your Name\"\n     }\n   }\n   EOF\n   ```\n4. **Add a custom command**\n   Create `commands/hello.md`\n   ```\n   mkdir commands\n   cat > commands/hello.md << 'EOF'\n   ---\n   description: Greet the user with a personalized message\n   ---\n   # Hello Command\n   Greet the user warmly and ask how you can help them today. Make the greeting personal and encouraging.\n   EOF\n   ```\n5. **Create the marketplace manifest**\n   Create `marketplace.json`\n   ```\n   cd ..\n   mkdir .claude-plugin\n   cat > .claude-plugin/marketplace.json << 'EOF'\n   {\n     \"name\": \"test-marketplace\",\n     \"owner\": {\n       \"name\": \"Test User\"\n     },\n     \"plugins\": [\n       {\n         \"name\": \"my-first-plugin\",\n         \"source\": \"./my-first-plugin\",\n         \"description\": \"My first test plugin\"\n       }\n     ]\n   }\n   EOF\n   ```\n6. **Install and test your plugin**\n\n   - Start Claude Code from parent directory:\n     ```\n     cd ..\n     claude\n     ```\n   - Add the test marketplace:\n     ```\n     /plugin marketplace add ./test-marketplace\n     ```\n   - Install your plugin:\n     ```\n     /plugin install my-first-plugin@test-marketplace\n     ```\n   - Select \"Install now\". Restart Claude Code to use the new plugin.\n   - Try your new command:\n     ```\n     /hello\n     ```\n   - You'll see Claude use your greeting command! Check `/help` to see your new command listed.\n\n**Key components:**\n\n- **Plugin manifest** (`.claude-plugin/plugin.json`) - Describes your plugin's metadata\n- **Commands directory** (`commands/`) - Contains your custom slash commands\n- **Test marketplace** - Allows you to test your plugin locally\n\n---\n\n### Plugin structure overview\n\nYour plugin follows this basic structure:\n\n```\nmy-first-plugin/\nâââ .claude-plugin/\nâ   âââ plugin.json # Plugin metadata\nâââ commands/ # Custom slash commands (optional)\nâ   âââ hello.md\nâââ agents/ # Custom agents (optional)\nâ   âââ helper.md\nâââ skills/ # Agent Skills (optional)\nâ   âââ my-skill/\nâ       âââ SKILL.md\nâââ hooks/ # Event handlers (optional)\n    âââ hooks.json\n```\n\n**Additional components you can add:**\n\n- **Commands:** Create markdown files in `commands/` directory\n- **Agents:** Create agent definitions in `agents/` directory\n- **Skills:** Create `SKILL.md` files in `skills/` directory\n- **Hooks:** Create `hooks/hooks.json` for event handling\n- **MCP servers:** Create `.mcp.json` for external tool integration\n\n> **Next steps:** Ready to add more features? Jump to [Develop more complex plugins](https://docs.claude.com/en/docs/claude-code/plugins#develop-more-complex-plugins) to add agents, hooks, and MCP servers. For full specifications, see [Plugins reference](https://docs.claude.com/en/docs/claude-code/plugins-reference).\n\n---\n\n## Install and manage plugins\n\nLearn how to discover, install, and manage plugins to extend Claude Code capabilities.\n\n### Prerequisites\n\n- Claude Code installed and running\n- Basic familiarity with command-line interfaces\n\n### Add marketplaces\n\nMarketplaces are catalogs of available plugins. Add them to discover and install plugins:\n\n- **Add a marketplace**\n  ```\n  /plugin marketplace add your-org/claude-plugins\n  ```\n- **Browse available plugins**\n  ```\n  /plugin\n  ```\nFor more details, see [Plugin marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces).\n\n### Install plugins\n\n#### Via interactive menu (recommended for discovery)\n\n- Open plugin management interface:\n  ```\n  /plugin\n  ```\n- Select \"Browse Plugins\" to see options with descriptions, features, and installation.\n\n#### Via direct commands (for quick installation)\n\n- Install a specific plugin:\n  ```\n  /plugin install formatter@your-org\n  ```\n- Enable a disabled plugin:\n  ```\n  /plugin enable plugin-name@marketplace-name\n  ```\n- Disable without uninstalling:\n  ```\n  /plugin disable plugin-name@marketplace-name\n  ```\n- Completely remove a plugin:\n  ```\n  /plugin uninstall plugin-name@marketplace-name\n  ```\n\n### Verify installation\n\nAfter installing a plugin:\n\n1. **Check available commands:** Run `/help` to see new commands.\n2. **Test plugin features:** Try the plugin's commands and features.\n3. **Review plugin details:** Use `/plugin` â \"Manage Plugins\" to see what the plugin provides.\n\n---\n\n## Set up team plugin workflows\n\nConfigure plugins at the repository level for consistent tooling across your team. When team members trust your repository folder, Claude Code installs specified marketplaces and plugins automatically.\n\n**To set up team plugins:**\n\n1. Add marketplace and plugin configuration to your repository's `.claude/settings.json`\n2. Team members trust the repository folder\n3. Plugins install automatically for all team members\n\nFor full instructions and examples, see [Configure team marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces#how-to-configure-team-marketplaces).\n\n---\n\n## Develop more complex plugins\n\nOnce you're comfortable with basic plugins, you can create more sophisticated extensions.\n\n### Add Skills to your plugin\n\nPlugins can include [Agent Skills](https://docs.claude.com/en/docs/claude-code/skills) to extend Claude's capabilities. Skills are model-invokedâClaude autonomously uses them based on the task context.\n\nTo add Skills to your plugin, create a `skills/` directory at your plugin root and add Skill folders with `SKILL.md` files. Plugin Skills are automatically available when the plugin is installed.\n\nSee [Agent Skills](https://docs.claude.com/en/docs/claude-code/skills) for full guidance.\n\n### Organize complex plugins\n\nFor plugins with many components, organize your directory structure by functionality. See [Plugin directory structure](https://docs.claude.com/en/docs/claude-code/plugins-reference#plugin-directory-structure) for layout patterns.\n\n### Test your plugins locally\n\nWhen developing plugins, use a local marketplace to test changes iteratively.\n\n1. **Set up your development structure**\n   - Organize your plugin and marketplace for testing:\n     ```\n     mkdir dev-marketplace\n     cd dev-marketplace\n     mkdir my-plugin\n     ```\n   - This creates:\n     ```\n     dev-marketplace/\n     âââ .claude-plugin/marketplace.json (you'll create this)\n     âââ my-plugin/ (your plugin under development)\n         âââ .claude-plugin/plugin.json\n         âââ commands/\n         âââ agents/\n         âââ hooks/\n     ```\n2. **Create the marketplace manifest**\n   ```\n   mkdir .claude-plugin\n   cat > .claude-plugin/marketplace.json << 'EOF'\n   {\n     \"name\": \"dev-marketplace\",\n     \"owner\": { \"name\": \"Developer\" },\n     \"plugins\": [\n       {\n         \"name\": \"my-plugin\",\n         \"source\": \"./my-plugin\",\n         \"description\": \"Plugin under development\"\n       }\n     ]\n   }\n   EOF\n   ```\n3. **Install and test**\n   - Start Claude Code from parent directory:\n     ```\n     cd ..\n     claude\n     ```\n   - Add your development marketplace:\n     ```\n     /plugin marketplace add ./dev-marketplace\n     ```\n   - Install your plugin:\n     ```\n     /plugin install my-plugin@dev-marketplace\n     ```\n   - Test:\n     - Try your commands with `/command-name`\n     - Check that agents appear in `/agents`\n     - Verify hooks work as expected\n\n4. **Iterate on your plugin**\n   - After code changes:\n     ```\n     /plugin uninstall my-plugin@dev-marketplace\n     /plugin install my-plugin@dev-marketplace\n     ```\n   - Repeat as needed.\n\n> **For multiple plugins:** Organize them in subdirectories like `./plugins/plugin-name` and update your `marketplace.json`. See [Plugin sources](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces#plugin-sources).\n\n### Debug plugin issues\n\nIf your plugin isn't working as expected:\n\n1. **Check the structure:** Ensure directories are at plugin root\n2. **Test components individually:** Check each command, agent, and hook separately\n3. **Use validation and debugging tools:** See [Debugging and development tools](https://docs.claude.com/en/docs/claude-code/plugins-reference#debugging-and-development-tools)\n\n### Share your plugins\n\nWhen ready to share:\n\n1. Add documentation (`README.md` with instructions)\n2. Use semantic versioning in `plugin.json`\n3. Create or use a marketplace\n4. Test with others before wider distribution\n\nSee [Plugins reference](https://docs.claude.com/en/docs/claude-code/plugins-reference) for details.\n\n---\n\n## Next steps\n\nNow that you understand Claude Code's plugin system, here are suggested paths:\n\n### For plugin users\n\n- **Discover plugins**: Browse community marketplaces\n- **Team adoption**: Set up repository-level plugins\n- **Marketplace management**: Manage multiple sources\n- **Advanced usage**: Explore plugin combinations\n\n### For plugin developers\n\n- **Create your first marketplace:** [Plugin marketplaces guide](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces)\n- **Advanced components:** Dive deeper:\n  - [Slash commands](https://docs.claude.com/en/docs/claude-code/slash-commands)\n  - [Subagents](https://docs.claude.com/en/docs/claude-code/sub-agents)\n  - [Agent Skills](https://docs.claude.com/en/docs/claude-code/skills)\n  - [Hooks](https://docs.claude.com/en/docs/claude-code/hooks)\n  - [MCP](https://docs.claude.com/en/docs/claude-code/mcp)\n- **Distribution strategies:** Package and share\n- **Community contribution:** Contribute to collections\n\n### For team leads and administrators\n\n- **Repository configuration:** Automatic plugin installation\n- **Plugin governance:** Guidelines for approval/review\n- **Marketplace maintenance:** Organization catalogs\n- **Training and documentation:** Team adoption\n\n---\n\n## See also\n\n- [Plugin marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces) - Creating/managing catalogs\n- [Slash commands](https://docs.claude.com/en/docs/claude-code/slash-commands) - Custom commands\n- [Subagents](https://docs.claude.com/en/docs/claude-code/sub-agents) - Specialized agents\n- [Agent Skills](https://docs.claude.com/en/docs/claude-code/skills) - Extend capabilities\n- [Hooks](https://docs.claude.com/en/docs/claude-code/hooks) - Automate workflows\n- [MCP](https://docs.claude.com/en/docs/claude-code/mcp) - Connect external tools/services\n- [Settings](https://docs.claude.com/en/docs/claude-code/settings) - Plugin configuration options\n",
        "plugins/claude-code-meta/skills/claude-code-plugins/references/plugins-reference.md": "# Plugins Reference\n\nComplete technical reference for the Claude Code plugin system, including schemas, CLI commands, and component specifications.\n\n> **Tip:**\n> For hands-on tutorials and practical usage, see [Plugins](https://docs.claude.com/en/docs/claude-code/plugins).\n> For plugin management across teams and communities, see [Plugin marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces).\n\n---\n\n## Plugin Components Reference\n\nThis section documents the five types of components that plugins can provide:\n\n### Commands\n\nPlugins add custom slash commands that integrate with Claude Code's command system.\n**Location:** `commands/` directory in plugin root\n**File format:** Markdown files with frontmatter\n\n- For details on command structure, invocation patterns, and features, see [Plugin commands](https://docs.claude.com/en/docs/claude-code/slash-commands#plugin-commands).\n\n---\n\n### Agents\n\nPlugins can provide specialized subagents for specific tasks that Claude can invoke automatically.\n**Location:** `agents/` directory in plugin root\n**File format:** Markdown files describing agent capabilities\n\n**Agent Structure Example:**\n```\n---\ndescription: What this agent specializes in\ncapabilities: [\"task1\", \"task2\", \"task3\"]\n---\n# Agent Name\nDetailed description of the agent's role, expertise, and when Claude should invoke it.\n\n## Capabilities\n- Specific task the agent excels at\n- Another specialized capability\n- When to use this agent vs others\n\n## Context and examples\nProvide examples of when this agent should be used and what problems it solves.\n```\n\n**Integration Points:**\n- Agents appear in the `/agents` interface\n- Claude can invoke agents automatically based on context\n- Agents can be manually invoked by users\n- Plugin agents work alongside built-in Claude agents\n\n---\n\n### Skills\n\nPlugins can provide Agent Skills that extend Claude's capabilities.\nSkills are model-invokedâClaude autonomously decides when to use them.\n\n**Location:** `skills/` directory in plugin root\n**File format:** Directories containing `SKILL.md` files with frontmatter\n\n**Skill Structure Example:**\n```\nskills/\n  âââ pdf-processor/\n  â   âââ SKILL.md\n  â   âââ reference.md (optional)\n  â   âââ scripts/ (optional)\n  âââ code-reviewer/\n      âââ SKILL.md\n```\n\n**Integration Behavior:**\n- Plugin Skills are detected when the plugin is installed\n- Claude invokes Skills based on context\n- Skills can include supporting files\n\nFor SKILL.md format and authoring guidance, see:\n- [Use Skills in Claude Code](https://docs.claude.com/en/docs/claude-code/skills)\n- [Agent Skills overview](https://docs.claude.com/en/docs/agents-and-tools/agent-skills/overview#skill-structure)\n\n---\n\n### Hooks\n\nPlugins can provide event handlers that respond to Claude Code events automatically.\n\n**Location:** `hooks/hooks.json` in plugin root, or inline in plugin.json\n**Format:** JSON configuration with event matchers and actions\n\n**Hook Configuration Example:**\n```\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format-code.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n**Available Events:**\n- `PreToolUse`: Before tool use\n- `PostToolUse`: After tool use\n- `UserPromptSubmit`: When user submits prompt\n- `Notification`: Claude Code notifications\n- `Stop`: When Claude stops\n- `SubagentStop`: Subagent attempts to stop\n- `SessionStart` / `SessionEnd`\n- `PreCompact`: Before history is compacted\n\n**Hook Types:**\n- `command`: Execute shell commands or scripts\n- `validation`: Validate file/project state\n- `notification`: Send alerts/status\n\n---\n\n### MCP Servers\n\nPlugins can bundle Model Context Protocol (MCP) servers to connect Claude Code with external tools.\n\n**Location:** `.mcp.json` in plugin root or inline in plugin.json\n**Format:** Standard MCP server configuration\n\n**MCP Server Example:**\n```\n{\n  \"mcpServers\": {\n    \"plugin-database\": {\n      \"command\": \"${CLAUDE_PLUGIN_ROOT}/servers/db-server\",\n      \"args\": [\"--config\", \"${CLAUDE_PLUGIN_ROOT}/config.json\"],\n      \"env\": { \"DB_PATH\": \"${CLAUDE_PLUGIN_ROOT}/data\" }\n    },\n    \"plugin-api-client\": {\n      \"command\": \"npx\",\n      \"args\": [\"@company/mcp-server\", \"--plugin-mode\"],\n      \"cwd\": \"${CLAUDE_PLUGIN_ROOT}\"\n    }\n  }\n}\n```\n\n**Integration Behavior:**\n- MCP servers start automatically when enabled\n- Servers appear as tools in Claude's toolkit\n- Servers can be configured independently of user MCP servers\n\n---\n\n## Plugin Manifest Schema\n\nThe `plugin.json` file defines plugin metadata and configuration.\n\n### Complete Schema Example\n\n```\n{\n  \"name\": \"plugin-name\",\n  \"version\": \"1.2.0\",\n  \"description\": \"Brief plugin description\",\n  \"author\": {\n    \"name\": \"Author Name\",\n    \"email\": \"author@example.com\",\n    \"url\": \"https://github.com/author\"\n  },\n  \"homepage\": \"https://docs.example.com/plugin\",\n  \"repository\": \"https://github.com/author/plugin\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"keyword1\", \"keyword2\"],\n  \"commands\": [\"./custom/commands/special.md\"],\n  \"agents\": \"./custom/agents/\",\n  \"hooks\": \"./config/hooks.json\",\n  \"mcpServers\": \"./mcp-config.json\"\n}\n```\n\n---\n\n### Required Fields\n\n| Field   | Type   | Description                         | Example                  |\n|---------|--------|-------------------------------------|--------------------------|\n| `name`  | string | Unique identifier (kebab-case)      | `\"deployment-tools\"`     |\n\n---\n\n### Metadata Fields\n\n| Field        | Type    | Description                    | Example                                |\n|--------------|---------|--------------------------------|----------------------------------------|\n| `version`    | string  | Semantic version               | `\"2.1.0\"`                              |\n| `description`| string  | Brief explanation of purpose   | `\"Deployment automation tools\"`         |\n| `author`     | object  | Author information             | `{\"name\": \"Dev Team\", \"email\": \"dev@company.com\"}` |\n| `homepage`   | string  | Documentation URL              | `\"https://docs.example.com\"`           |\n| `repository` | string  | Source code URL                | `\"https://github.com/user/plugin\"`     |\n| `license`    | string  | License identifier             | `\"MIT\"`, `\"Apache-2.0\"`                |\n| `keywords`   | array   | Discovery tags                 | `[\"deployment\", \"ci-cd\"]`              |\n\n---\n\n### Component Path Fields\n\n| Field        | Type         | Description                | Example                         |\n|--------------|--------------|----------------------------|----------------------------------|\n| `commands`   | string/array | Command files/directories  | `\"./custom/cmd.md\"`              |\n| `agents`     | string/array | Additional agent files     | `\"./custom/agents/\"`             |\n| `hooks`      | string/object| Hook config path or config | `\"./hooks.json\"`                 |\n| `mcpServers` | string/object| MCP config path or config  | `\"./mcp.json\"`                   |\n\n---\n\n### Path Behavior Rules\n\n**Important:**\nCustom paths supplement default directories â they do **not** replace them.\n\n- If `commands/` exists, it's loaded in addition to custom paths.\n- All paths must be relative and start with `./`.\n- Multiple paths can be specified as arrays.\n\n**Example:**\n```\n{\n  \"commands\": [\"./specialized/deploy.md\", \"./utilities/batch-process.md\"],\n  \"agents\": [\"./custom-agents/reviewer.md\", \"./custom-agents/tester.md\"]\n}\n```\n\n---\n\n### Environment Variables\n\n- `${CLAUDE_PLUGIN_ROOT}` contains the absolute path to your plugin directory.\n\n**Example:**\n```\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/process.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n---\n\n## Plugin Directory Structure\n\n### Standard Plugin Layout\n\nA complete plugin example:\n```\nenterprise-plugin/\n  âââ .claude-plugin/         # Metadata directory\n  â   âââ plugin.json         # Required manifest\n  âââ commands/               # Default commands\n  â   âââ status.md\n  â   âââ logs.md\n  âââ agents/                 # Subagents\n  â   âââ security-reviewer.md\n  â   âââ performance-tester.md\n  â   âââ compliance-checker.md\n  âââ skills/\n  â   âââ code-reviewer/\n  â   â   âââ SKILL.md\n  â   âââ pdf-processor/\n  â       âââ SKILL.md\n  â       âââ scripts/\n  âââ hooks/\n  â   âââ hooks.json\n  â   âââ security-hooks.json\n  âââ .mcp.json\n  âââ scripts/\n  â   âââ security-scan.sh\n  â   âââ format-code.py\n  â   âââ deploy.js\n  âââ LICENSE\n  âââ CHANGELOG.md\n```\n> **Warning:**\n> `.claude-plugin/` contains `plugin.json`.\n> All other directories (commands/, agents/, skills/, hooks/) must be at the plugin rootânot inside `.claude-plugin/`.\n\n---\n\n### File Locations Reference\n\n| Component    | Default Location          | Purpose                     |\n|--------------|--------------------------|-----------------------------|\n| Manifest     | `.claude-plugin/plugin.json` | Metadata file             |\n| Commands     | `commands/`              | Slash command markdown files|\n| Agents       | `agents/`                | Subagent markdown files     |\n| Skills       | `skills/`                | Agent Skills                |\n| Hooks        | `hooks/hooks.json`       | Hook configuration          |\n| MCP servers  | `.mcp.json`              | MCP server definitions      |\n\n---\n\n## Debugging and Development Tools\n\n### Debugging Commands\n\nTo see plugin loading details, run:\n```\nclaude --debug\n```\nThis shows:\n- Which plugins are loaded\n- Plugin manifest errors\n- Command/agent/hook registration\n- MCP server initialization\n\n---\n\n### Common Issues\n\n| Issue                | Cause                  | Solution                      |\n|----------------------|-----------------------|-------------------------------|\n| Plugin not loading   | Invalid `plugin.json` | Validate JSON syntax          |\n| Commands missing     | Wrong structure       | Ensure `commands/` at root    |\n| Hooks not firing     | Script not executable | Run `chmod +x script.sh`      |\n| MCP server fails     | Missing env var       | Use `${CLAUDE_PLUGIN_ROOT}`   |\n| Path errors          | Absolute paths used   | Use relative paths (`./`)     |\n\n---\n\n## Distribution and Versioning Reference\n\n### Version Management\n\nFollow semantic versioning for plugin releases.\n\n---\n\n## See Also\n\n- [Plugins](https://docs.claude.com/en/docs/claude-code/plugins) â Tutorials and practical usage\n- [Plugin marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces) â Marketplace management\n- [Slash commands](https://docs.claude.com/en/docs/claude-code/slash-commands) â Command development\n- [Subagents](https://docs.claude.com/en/docs/claude-code/sub-agents) â Agent configuration\n- [Agent Skills](https://docs.claude.com/en/docs/claude-code/skills) â Extend capabilities\n- [Hooks](https://docs.claude.com/en/docs/claude-code/hooks) â Automation\n- [MCP](https://docs.claude.com/en/docs/claude-code/mcp) â Tool integration\n- [Settings](https://docs.claude.com/en/docs/claude-code/settings) â Plugin configuration\n",
        "plugins/claude-code-meta/skills/claude-code-skills/SKILL.md": "---\nname: claude-code-skills\ndescription: Guide for creating effective Agent Skills in Claude Code. This skill should be used when users want to create a new Skill (or update an existing Skill) that extends Claude's capabilities with specialized knowledge, workflows, or tool integrations. Use when working specifically with Claude Code's Skills system.\nlicense: Complete terms in LICENSE.txt (Apache 2.0)\n---\n\n# Claude Code Skills Creator\n\nThis skill provides comprehensive guidance for creating effective Agent Skills in Claude Code, including plugin integration.\n\n## About Skills\n\nSkills are modular, self-contained packages that extend Claude's capabilities by providing\nspecialized knowledge, workflows, and tools. Think of them as \"onboarding guides\" for specific\ndomains or tasksâthey transform Claude from a general-purpose agent into a specialized agent\nequipped with procedural knowledge that no model can fully possess.\n\n### What Skills Provide\n\n1. Specialized workflows - Multi-step procedures for specific domains\n2. Tool integrations - Instructions for working with specific file formats or APIs\n3. Domain expertise - Company-specific knowledge, schemas, business logic\n4. Bundled resources - Scripts, references, and assets for complex and repetitive tasks\n\n### Anatomy of a Skill\n\nEvery skill consists of a required SKILL.md file and optional bundled resources:\n\n```\nskill-name/\nâââ SKILL.md (required)\nâ   âââ YAML frontmatter metadata (required)\nâ   â   âââ name: (required)\nâ   â   âââ description: (required)\nâ   âââ Markdown instructions (required)\nâââ Bundled Resources (optional)\n    âââ scripts/          - Executable code (Python/Bash/etc.)\n    âââ references/       - Documentation intended to be loaded into context as needed\n    âââ assets/           - Files used in output (templates, icons, fonts, etc.)\n```\n\n#### SKILL.md (required)\n\n**Metadata Quality:** The `name` and `description` in YAML frontmatter determine when Claude will use the skill. Be specific about what the skill does and when to use it. Use the third-person (e.g. \"This skill should be used when...\" instead of \"Use this skill when...\").\n\n**Claude Code-specific frontmatter fields:**\n\n- `allowed-tools` (optional, Claude Code only): Comma-separated list of tools Claude can use when this skill is active. Restricts tool access for security or to keep the skill focused. See [references/allowed-tools-guide.md](references/allowed-tools-guide.md) for comprehensive guidance.\n\nExample frontmatter with `allowed-tools`:\n\n```yaml\n---\nname: safe-file-reader\ndescription: Read files without making changes. Use when you need read-only file access.\nallowed-tools: Read, Grep, Glob\n---\n```\n\n#### Bundled Resources (optional)\n\n##### Scripts (`scripts/`)\n\nExecutable code (Python/Bash/etc.) for tasks that require deterministic reliability or are repeatedly rewritten.\n\n- **When to include**: When the same code is being rewritten repeatedly or deterministic reliability is needed\n- **Example**: `scripts/rotate_pdf.py` for PDF rotation tasks\n- **Benefits**: Token efficient, deterministic, may be executed without loading into context\n- **Note**: Scripts may still need to be read by Claude for patching or environment-specific adjustments\n\n##### References (`references/`)\n\nDocumentation and reference material intended to be loaded as needed into context to inform Claude's process and thinking.\n\n- **When to include**: For documentation that Claude should reference while working\n- **Examples**: `references/finance.md` for financial schemas, `references/mnda.md` for company NDA template, `references/policies.md` for company policies, `references/api_docs.md` for API specifications\n- **Use cases**: Database schemas, API documentation, domain knowledge, company policies, detailed workflow guides\n- **Benefits**: Keeps SKILL.md lean, loaded only when Claude determines it's needed\n- **Best practice**: If files are large (>10k words), include grep search patterns in SKILL.md\n- **Avoid duplication**: Information should live in either SKILL.md or references files, not both. Prefer references files for detailed information unless it's truly core to the skillâthis keeps SKILL.md lean while making information discoverable without hogging the context window. Keep only essential procedural instructions and workflow guidance in SKILL.md; move detailed reference material, schemas, and examples to references files.\n\n##### Assets (`assets/`)\n\nFiles not intended to be loaded into context, but rather used within the output Claude produces.\n\n- **When to include**: When the skill needs files that will be used in the final output\n- **Examples**: `assets/logo.png` for brand assets, `assets/slides.pptx` for PowerPoint templates, `assets/frontend-template/` for HTML/React boilerplate, `assets/font.ttf` for typography\n- **Use cases**: Templates, images, icons, boilerplate code, fonts, sample documents that get copied or modified\n- **Benefits**: Separates output resources from documentation, enables Claude to use files without loading them into context\n\n### Progressive Disclosure Design Principle\n\nSkills use a three-level loading system to manage context efficiently:\n\n1. **Metadata (name + description)** - Always in context (~100 words)\n2. **SKILL.md body** - When skill triggers (<5k words)\n3. **Bundled resources** - As needed by Claude (Unlimited*)\n\n*Unlimited because scripts can be executed without reading into context window.\n\n## Claude Code Skills Integration\n\nSkills in Claude Code work within a rich ecosystem of extensibility features. Understanding how Skills relate to other components helps you choose the right tool for each task and build cohesive workflows.\n\n### How Skills Fit in the Claude Code Ecosystem\n\nClaude Code provides four main extensibility mechanisms:\n\n1. **Skills** - Specialized knowledge and workflows (this guide)\n2. **Slash Commands** - User-invoked prompts (e.g., `/deploy`, `/review`)\n3. **Subagents** - Specialized AI personalities with custom system prompts\n4. **Hooks** - Event-driven automation scripts\n\n### The allowed-tools Field in Claude Code\n\nClaude Code supports an `allowed-tools` frontmatter field that restricts which tools Claude can use when a skill is active.\n\n**Why use allowed-tools:**\n\n1. **Security** - Prevent Skills from making unintended modifications\n2. **Focus** - Keep Skills constrained to their specific purpose\n3. **User experience** - Avoid permission prompts for pre-approved tools\n\n**Common patterns:**\n\n```yaml\n# Read-only skill\nallowed-tools: Read, Grep, Glob\n\n# File operations skill\nallowed-tools: Read, Write, Edit, Glob\n\n# Code execution skill\nallowed-tools: Read, Write, Bash\n\n# Web research skill\nallowed-tools: Read, WebFetch, WebSearch\n```\n\nSee [references/allowed-tools-guide.md](references/allowed-tools-guide.md) for comprehensive guidance on tool permissions.\n\n### Distribution in Claude Code\n\nClaude Code Skills can be distributed in two ways:\n\n**1. Plugin-bundled Skills** (Recommended for most use cases)\n\n- Skills included in a Claude Code plugin\n- Distributed via plugin marketplaces\n- Can reference other plugin components (commands, agents, hooks)\n- Automatic updates when plugin updates\n\n**2. Standalone Skills**\n\n- Self-contained skill directories\n- Simpler for single-purpose, independent skills\n\n## Skill Creation Process\n\nTo create a skill, follow the \"Skill Creation Process\" in order, skipping steps only if there is a clear reason why they are not applicable.\n\n### Step 1: Understanding the Skill with Concrete Examples\n\nSkip this step only when the skill's usage patterns are already clearly understood. It remains valuable even when working with an existing skill.\n\nTo create an effective skill, clearly understand concrete examples of how the skill will be used. This understanding can come from either direct user examples or generated examples that are validated with user feedback.\n\nFor example, when building an image-editor skill, relevant questions include:\n\n- \"What functionality should the image-editor skill support? Editing, rotating, anything else?\"\n- \"Can you give some examples of how this skill would be used?\"\n- \"I can imagine users asking for things like 'Remove the red-eye from this image' or 'Rotate this image'. Are there other ways you imagine this skill being used?\"\n- \"What would a user say that should trigger this skill?\"\n\nTo avoid overwhelming users, avoid asking too many questions in a single message. Start with the most important questions and follow up as needed for better effectiveness.\n\nConclude this step when there is a clear sense of the functionality the skill should support.\n\n### Step 2: Planning the Reusable Skill Contents\n\nTo turn concrete examples into an effective skill, analyze each example by:\n\n1. Considering how to execute on the example from scratch\n2. Identifying what scripts, references, and assets would be helpful when executing these workflows repeatedly\n\nExample: When building a `pdf-editor` skill to handle queries like \"Help me rotate this PDF,\" the analysis shows:\n\n1. Rotating a PDF requires re-writing the same code each time\n2. A `scripts/rotate_pdf.py` script would be helpful to store in the skill\n\nExample: When designing a `frontend-webapp-builder` skill for queries like \"Build me a todo app\" or \"Build me a dashboard to track my steps,\" the analysis shows:\n\n1. Writing a frontend webapp requires the same boilerplate HTML/React each time\n2. An `assets/hello-world/` template containing the boilerplate HTML/React project files would be helpful to store in the skill\n\nExample: When building a `big-query` skill to handle queries like \"How many users have logged in today?\" the analysis shows:\n\n1. Querying BigQuery requires re-discovering the table schemas and relationships each time\n2. A `references/schema.md` file documenting the table schemas would be helpful to store in the skill\n\nTo establish the skill's contents, analyze each concrete example to create a list of the reusable resources to include: scripts, references, and assets.\n\n### Step 3: Initializing the Skill\n\nAt this point, it is time to actually create the skill.\n\nSkip this step only if the skill being developed already exists, and iteration or packaging is needed. In this case, continue to the next step.\n\nWhen creating a new skill from scratch, always run the `init_skill.py` script. The script conveniently generates a new template skill directory that automatically includes everything a skill requires, making the skill creation process much more efficient and reliable.\n\n#### For Standalone Skills\n\n```bash\nscripts/init_skill.py <skill-name> --path <output-directory>\n```\n\n#### For Plugin-Bundled Skills (Claude Code)\n\n```bash\nscripts/init_skill.py <skill-name> --plugin --path <plugin-directory>\n```\n\nThe `--plugin` flag:\n\n- Creates the skill in the plugin's `skills/` directory\n- Adds a reminder to register the skill in `.claude-plugin/marketplace.json`\n- Optimizes the template for plugin distribution\n\nThe script:\n\n- Creates the skill directory at the specified path\n- Generates a SKILL.md template with proper frontmatter and TODO placeholders\n- Creates example resource directories: `scripts/`, `references/`, and `assets/`\n- Adds example files in each directory that can be customized or deleted\n- For plugin skills, includes guidance on `allowed-tools` and marketplace registration\n\nAfter initialization, customize or remove the generated SKILL.md and example files as needed.\n\n**Plugin-bundled skills require an additional step:** Register the skill in your plugin's marketplace configuration (see Step 5 below).\n\n### Step 4: Edit the Skill\n\nWhen editing the (newly-generated or existing) skill, remember that the skill is being created for another instance of Claude to use. Focus on including information that would be beneficial and non-obvious to Claude. Consider what procedural knowledge, domain-specific details, or reusable assets would help another Claude instance execute these tasks more effectively.\n\n#### Start with Reusable Skill Contents\n\nTo begin implementation, start with the reusable resources identified above: `scripts/`, `references/`, and `assets/` files. Note that this step may require user input. For example, when implementing a `brand-guidelines` skill, the user may need to provide brand assets or templates to store in `assets/`, or documentation to store in `references/`.\n\nAlso, delete any example files and directories not needed for the skill. The initialization script creates example files in `scripts/`, `references/`, and `assets/` to demonstrate structure, but most skills won't need all of them.\n\n#### Update SKILL.md\n\n**Writing Style:** Write the entire skill using **imperative/infinitive form** (verb-first instructions), not second person. Use objective, instructional language (e.g., \"To accomplish X, do Y\" rather than \"You should do X\" or \"If you need to do X\"). This maintains consistency and clarity for AI consumption.\n\nTo complete SKILL.md, answer the following questions:\n\n1. What is the purpose of the skill, in a few sentences?\n2. When should the skill be used?\n3. In practice, how should Claude use the skill? All reusable skill contents developed above should be referenced so that Claude knows how to use them.\n\n### Step 5: Distribution in Claude Code\n\nOnce the skill is ready, distribute it via Claude Code's plugin marketplace system or as a standalone skill.\n\n#### Validating the Skill\n\nBefore distribution, validate the skill to ensure it meets all requirements:\n\n```bash\nscripts/validate_skill.py <path/to/skill-folder>\n```\n\nThe validation script checks:\n\n- YAML frontmatter format and required fields\n- Skill naming conventions and directory structure\n- Description completeness and quality\n- File organization and resource references\n- `allowed-tools` field syntax (Claude Code only)\n\nIf validation fails, fix the reported errors and run the validation command again.\n\n#### Option A: Plugin-Bundled Distribution (Recommended)\n\nFor skills distributed as part of a plugin:\n\n1. **Register in marketplace.json**:\n\n   Open your plugin's `.claude-plugin/marketplace.json` and add the skill:\n\n   ```json\n   {\n     \"plugins\": [\n       {\n         \"name\": \"my-plugin\",\n         \"skills\": [\n           \"./skills/my-skill\"\n         ]\n       }\n     ]\n   }\n   ```\n\n2. **Test locally**:\n\n   ```\n   /plugin marketplace add ./path/to/plugin\n   /plugin install my-plugin@local-marketplace\n   ```\n\n3. **Distribute via git**:\n\n   Commit the plugin (including the skill) to your git repository. Team members can install via:\n\n   ```\n   /plugin marketplace add owner/repo\n   /plugin install my-plugin@marketplace-name\n   ```\n\n#### Option B: Standalone Distribution\n\nFor independent skills not part of a larger plugin:\n\n1. **Create a minimal marketplace** for the skill\n2. **Distribute via git repository**\n3. Users install with `/plugin marketplace add` and `/plugin install`\n\n#### Option C: Zip File Distribution\n\nFor non-Claude Code environments (claude.ai, API), skills can be packaged as zip files:\n\n```bash\nscripts/package_skill.py <path/to/skill-folder>\n```\n\nThe packaging script validates the skill and creates a distributable zip file. This method is an alternative to marketplace distribution and is commonly used for claude.ai and API deployments.\n\n### Step 6: Iterate\n\nAfter testing the skill, users may request improvements. Often this happens right after using the skill, with fresh context of how the skill performed.\n\n**Iteration workflow:**\n\n1. Use the skill on real tasks\n2. Notice struggles or inefficiencies\n3. Identify how SKILL.md or bundled resources should be updated\n4. Implement changes and test again\n",
        "plugins/claude-code-meta/skills/claude-code-skills/assets/template-plugin-skill.md": "---\nname: plugin-skill-name\ndescription: Brief description of what this skill does and when to use it. This skill should be used when [specific trigger conditions].\nallowed-tools: Read, Write, Edit, Bash, Glob, Grep\n---\n\n# Plugin Skill Name\n\nBrief overview of this skill as part of the [plugin-name] plugin.\n\n## Purpose\n\nExplain the skill's purpose in 2-3 sentences. How does it fit into the larger plugin ecosystem?\n\n## Integration with Plugin Components\n\nThis skill works with other [plugin-name] components:\n\n- **Slash Commands:** `/command-name` - [When to use this command]\n- **Subagents:** `agent-name` - [When to delegate to this agent]\n- **Hooks:** [What hooks work with this skill]\n\n## When to Use This Skill\n\nList specific scenarios when this skill should be used:\n- Scenario 1\n- Scenario 2\n- Scenario 3\n\n## Tool Requirements\n\nThis skill uses the following tools:\n\n- **Read**: To examine [what files/content]\n- **Write**: To create [what output]\n- **Edit**: To modify [what files]\n- **Bash**: To execute [what commands]\n- **Glob**: To find [what patterns]\n- **Grep**: To search for [what content]\n\nThe `allowed-tools` field restricts tool usage to prevent [what risks].\n\n## Quick Start\n\nProvide a quick example of using this skill:\n\n```bash\n# Example bash command or procedure\n```\n\n## Workflows\n\n### Workflow 1: [Name]\n\n1. Step 1\n2. Step 2\n3. Step 3\n\n**Integration:** This workflow can be initiated using the `/workflow-command` command.\n\n### Workflow 2: [Name]\n\n1. Step 1\n2. Step 2\n3. Step 3\n\n**Integration:** For complex cases, delegate to the `workflow-agent` subagent.\n\n## Working with Slash Commands\n\n### Recommending Commands\n\nWhen a user wants to [action], recommend using the appropriate command:\n\n```markdown\nI've analyzed the situation. Use the `/action-command` to proceed:\n\n\\`\\`\\`\n/action-command argument1 argument2\n\\`\\`\\`\n```\n\n### Command Output Handling\n\nAfter a command completes, provide guidance based on the output.\n\n## Working with Subagents\n\n### When to Delegate\n\nDelegate to the [agent-name] subagent when:\n- Condition 1\n- Condition 2\n- Condition 3\n\n### Delegation Pattern\n\n```markdown\nThis is a complex [scenario]. Let me ask the [agent-name] subagent to handle this:\n\n[Provide context to subagent]\n```\n\n## Working with Hooks\n\n### Hook Integration\n\nThis skill works with these hooks:\n\n- **PreToolUse:** Validates [what operations] before execution\n- **PostToolUse:** Performs [what automation] after file changes\n- **SessionStart:** Loads [what context] at session initialization\n\n### Hook-Aware Procedures\n\nSome procedures may be automated by hooks. Check if hooks are active before manual execution.\n\n## Examples\n\n### Example 1: Complete Workflow\n\n**Scenario:** [Describe the scenario]\n\n**Steps:**\n\n1. Skill provides initial analysis\n2. User runs `/command-name` for execution\n3. Skill validates results\n4. Hook performs post-processing\n\n**Output:**\n```\n# Expected final output\n```\n\n### Example 2: Delegation Workflow\n\n**Scenario:** [Describe the scenario]\n\n**Steps:**\n\n1. Skill recognizes complex case\n2. Delegates to `agent-name` subagent\n3. Subagent handles specialized processing\n4. Skill provides summary\n\n**Output:**\n```\n# Expected final output\n```\n\n## Bundled Resources\n\n### Scripts\n\nThis skill includes helper scripts in `scripts/`:\n\n- `script1.py` - [What it does]\n- `script2.sh` - [What it does]\n\nUsage:\n```bash\npython scripts/script1.py [args]\n```\n\n### References\n\nDetailed documentation in `references/`:\n\n- [detailed-guide.md](references/detailed-guide.md) - [What it contains]\n- [api-reference.md](references/api-reference.md) - [What it contains]\n\n## Best Practices\n\n- Best practice 1\n- Best practice 2\n- Best practice 3\n- Always coordinate with related plugin components\n\n## Troubleshooting\n\n### Skill-Specific Issues\n\n**Issue:** Skill doesn't trigger when expected\n**Solution:** Check description matches user's language\n\n**Issue:** Tool permission error\n**Solution:** Verify `allowed-tools` includes required tool\n\n### Plugin Integration Issues\n\n**Issue:** Command not found\n**Solution:** Ensure [plugin-name] plugin is installed and enabled\n\n**Issue:** Subagent not available\n**Solution:** Verify [plugin-name] plugin includes agent definitions\n\n**Issue:** Hook not firing\n**Solution:** Check hooks configuration in plugin's hooks.json\n\n## Plugin Metadata\n\n**Plugin:** [plugin-name]\n**Version:** [version]\n**Marketplace:** [marketplace-name]\n\n**Installation:**\n```\n/plugin marketplace add [marketplace-path]\n/plugin install [plugin-name]@[marketplace-name]\n```\n\n## Reference\n\nFor detailed information:\n- Plugin documentation: See [plugin-name] README\n- Integration guide: [references/integration.md](references/integration.md)\n- Complete API: [references/api-reference.md](references/api-reference.md)\n",
        "plugins/claude-code-meta/skills/claude-code-skills/references/agent-skills-spec.md": "# Agent Skills Spec\n\nA skill is a folder of instructions, scripts, and resources that agents can discover and load dynamically to perform better at specific tasks. In order for the folder to be recognized as a skill, it must contain a `SKILL.md` file.\n\n# Skill Folder Layout\n\nA minimal skill folder looks like this:\n\n```\nmy-skill/\n  - SKILL.md\n```\n\nMore complex skills can add additional directories and files as needed.\n\n# The SKILL.md file\n\nThe skill's \"entrypoint\" is the `SKILL.md` file. It is the only file required to exist. The file must start with a YAML frontmatter followed by regular Markdown.\n\n## YAML Frontmatter\n\nThe YAML frontmatter has 2 required properties:\n\n- `name`\n  - The name of the skill in hyphen-case\n  - Restricted to lowercase Unicode alphanumeric + hyphen\n  - Must match the name of the directory containing the SKILL.md\n- `description`\n  - Description of what the skill does and when Claude should use it\n\nThere are 3 optional properties:\n\n- `license`\n  - The license applied to the skill\n  - We recommend keeping it short (either the name of a license or the name of a bundled license file)\n- `allowed-tools`\n  - A list of tools that are pre-approved to run\n  - Currently only supported in Claude Code\n- `metadata`\n  - A map from string keys to string values\n  - Clients can use this to store additional properties not defined by the Agent Skills Spec\n  - We recommend making your key names reasonably unique to avoid accidental conflicts\n\n## Markdown Body\n\nThe Markdown body has no restrictions on it.\n\n# Additional Information\n\nFor a minimal example, see the `template-skill` example.\n\n# Version History\n\n- 1.0 (2025-10-16) Public Launch\n",
        "plugins/claude-code-meta/skills/claude-code-skills/references/allowed-tools-guide.md": "# allowed-tools Field Guide\n\nComprehensive guide to using the `allowed-tools` frontmatter field in Claude Code Skills.\n\n## Overview\n\nThe `allowed-tools` field is a Claude Code-specific feature that restricts which tools Claude can use when a Skill is active. This provides three key benefits:\n\n1. **Security** - Prevent Skills from performing unintended or dangerous operations\n2. **Focus** - Keep Skills constrained to their specific purpose\n3. **User Experience** - Avoid permission prompts for pre-approved tools\n\n## Syntax\n\n```yaml\n---\nname: my-skill\ndescription: Skill description\nallowed-tools: Read, Write, Edit, Bash(git:*), Grep\n---\n```\n\n**Format:**\n\n- Comma-separated list of tool names\n- Tool names are case-sensitive\n- Bash patterns use parentheses with glob patterns\n- Whitespace around commas is optional\n\n## Available Tools\n\nComplete reference of all tools available in Claude Code for use in `allowed-tools` field.\n\n### 1. File Operations\n\n**Read** - Read files from filesystem\n\n- Supports images, PDFs, Jupyter notebooks, and text files\n- Use for: Code analysis, documentation extraction, examining configurations\n- Example: `Read` to examine source files\n\n**Write** - Create new files\n\n- Overwrites if file already exists\n- Use for: Generating new content, report creation, template instantiation\n- Example: `Write` to create new documentation files\n\n**Edit** - Modify existing files with exact string replacements\n\n- Preserves file structure and formatting\n- Use for: Code refactoring, configuration updates, in-place modifications\n- Example: `Edit` to update configuration values\n\n**Glob** - Find files by glob pattern\n\n- Supports patterns like `**/*.js`, `src/**/*.tsx`\n- Use for: File discovery, locating test files, finding configs\n- Example: `Glob` to find all test files matching `**/*_test.py`\n\n**Grep** - Search file contents with regex patterns\n\n- Supports full regex syntax and output modes\n- Use for: Code search, finding function definitions, log analysis\n- Example: `Grep` to search for specific patterns in code\n\n### 2. Code Editing\n\n**NotebookEdit** - Edit Jupyter notebook cells\n\n- Supports insert, delete, and replace operations\n- Use for: Working with .ipynb files\n- Example: `NotebookEdit` to modify notebook cells\n\n### 3. Command Execution\n\n**Bash** - Execute bash commands in persistent shell\n\n- Can be restricted with patterns (see Bash Tool Patterns below)\n- Use for: Running tests, git operations, build processes\n- Example: `Bash(git:*)` to allow git commands only\n\n**Bash Patterns** (restrict bash to specific commands):\n\n- `Bash(git:*)` - Git commands only\n- `Bash(npm:*)` - npm commands only\n- `Bash(docker:*)` - Docker commands only\n- `Bash(pytest:*)` - pytest commands only\n- `Bash(bq:*)` - BigQuery CLI commands only\n- `Bash` - All bash commands (use with caution)\n\n**BashOutput** - Retrieve output from background bash shells\n\n- Use for: Monitoring long-running background processes\n- Example: `BashOutput` to check test run progress\n\n**KillBash** - Terminate running background bash shells\n\n- Use for: Cleaning up background processes\n- Example: `KillBash` to stop a background server\n\n### 4. Web and Search\n\n**WebFetch** - Fetch and process web content with AI\n\n- Converts HTML to markdown\n- Use for: API documentation lookup, fetching external data\n- Example: `WebFetch` to retrieve documentation from URLs\n\n**WebSearch** - Search the web for up-to-date information\n\n- Provides current information beyond model cutoff\n- Use for: Research, fact-checking, finding recent information\n- Example: `WebSearch` to find latest library versions\n\n### 5. Task Management\n\n**TodoWrite** - Create and manage structured task lists\n\n- Use for: Planning complex workflows, tracking progress\n- Example: `TodoWrite` to create task breakdown\n\n**Task** - Launch specialized subagents for complex tasks\n\n- Delegates to specialized agents with their own context\n- Use for: Complex multi-step workflows, specialized analysis\n- Example: `Task` to delegate to code-reviewer subagent\n\n### 6. Workflow Control\n\n**ExitPlanMode** - Exit planning mode and present plan to user\n\n- Use for: Finalizing plans before implementation\n- Example: `ExitPlanMode` after creating implementation plan\n\n**SlashCommand** - Execute custom slash commands\n\n- Use for: Triggering user-defined workflows\n- Example: `SlashCommand` to run `/deploy` command\n\n**AskUserQuestion** - Ask user questions during execution\n\n- Use for: Gathering preferences, clarifying requirements\n- Example: `AskUserQuestion` to choose deployment target\n\n### 7. MCP Integration\n\n**ListMcpResources** - List available MCP resources\n\n- Use for: Discovering MCP server capabilities\n- Example: `ListMcpResources` to see available resources\n\n**ReadMcpResource** - Read specific MCP resource content\n\n- Use for: Accessing MCP resource data\n- Example: `ReadMcpResource` to read database schemas\n\n**MCP Server Tools** - Tools provided by installed MCP servers\n\n- Format: `mcp__<server-name>__<tool-name>`\n- Inherited by default if `allowed-tools` field is omitted\n- Example: `mcp__github__create_issue`, `mcp__slack__send_message`\n\nTo see available MCP tools, use `/mcp` in Claude Code.\n\n## Bash Tool Patterns\n\nThe Bash tool supports glob patterns to allow specific command categories:\n\n```yaml\n# Allow all git commands\nBash(git:*)\n\n# Allow specific git commands\nBash(git status:*), Bash(git diff:*)\n\n# Allow npm commands\nBash(npm:*)\n\n# Allow multiple command families\nBash(git:*), Bash(npm:*), Bash(ls:*)\n\n# Allow all bash (not recommended for security)\nBash\n```\n\n**Pattern syntax:**\n\n- `command:*` - All invocations of command\n- `command subcommand:*` - Specific subcommand\n- `*` - All bash (use sparingly)\n\n## Common Patterns\n\n### Read-Only Skills\n\nSkills that should never modify files:\n\n```yaml\nallowed-tools: Read, Grep, Glob\n```\n\n**Use cases:**\n\n- Code analysis\n- Documentation extraction\n- Security auditing\n- Read-only data analysis\n\n### File Editing Skills\n\nSkills that modify files but don't execute code:\n\n```yaml\nallowed-tools: Read, Write, Edit, Glob, Grep\n```\n\n**Use cases:**\n\n- Code refactoring\n- Template generation\n- Configuration updates\n- Documentation generation\n\n### Git Integration Skills\n\nSkills that work with git repositories:\n\n```yaml\nallowed-tools: Read, Write, Edit, Bash(git:*), Grep, Glob\n```\n\n**Use cases:**\n\n- Automated committing\n- Branch management\n- Code review workflows\n- Repository analysis\n\n### Testing Skills\n\nSkills that run tests and analyze results:\n\n```yaml\nallowed-tools: Read, Bash(npm test:*), Bash(pytest:*), Grep, Glob\n```\n\n**Use cases:**\n\n- Test execution\n- Test result analysis\n- Coverage reporting\n\n### Web Research Skills\n\nSkills that gather information from the web:\n\n```yaml\nallowed-tools: Read, WebFetch, WebSearch, Write\n```\n\n**Use cases:**\n\n- Research tasks\n- Documentation lookup\n- API reference checking\n\n### Deployment Skills\n\nSkills that deploy code (use with caution):\n\n```yaml\nallowed-tools: Read, Bash(git:*), Bash(npm:*), Bash(docker:*), Grep\n```\n\n**Use cases:**\n\n- Deployment workflows\n- Build processes\n- CI/CD integration\n\n## Security Considerations\n\n### Principle of Least Privilege\n\n**Always grant the minimum tools necessary:**\n\nâ **Too permissive:**\n\n```yaml\nallowed-tools: Read, Write, Edit, Bash, WebFetch, WebSearch\n```\n\nâ **Appropriately restricted:**\n\n```yaml\nallowed-tools: Read, Grep, Glob\n```\n\n### Dangerous Patterns to Avoid\n\n**1. Unrestricted Bash**\n\n```yaml\n# Dangerous - allows any shell command\nallowed-tools: Bash\n```\n\n**Better:**\n\n```yaml\n# Restricted to specific commands\nallowed-tools: Bash(git:*), Bash(npm test:*)\n```\n\n**2. Write + Bash Together**\n\n```yaml\n# Potentially dangerous - can create and execute files\nallowed-tools: Write, Bash\n```\n\nOnly combine these when the Skill's purpose requires it and you trust the Skill's implementation.\n\n**3. MCP Tools Without Specificity**\n\n```yaml\n# Too broad if MCP server has many tools\nallowed-tools: mcp__github__*\n```\n\n**Better:**\n\n```yaml\n# Specific tools only\nallowed-tools: mcp__github__create_issue, mcp__github__add_comment\n```\n\n### Auditing Skill Tool Usage\n\nWhen reviewing Skills (especially from third parties), check:\n\n1. **Does the Skill request more tools than it needs?**\n2. **Are Bash patterns specific enough?**\n3. **Does the Skill combine dangerous tool combinations?**\n4. **Are MCP tools from trusted servers?**\n\n## Determining Tools for Your Skill\n\n### Step 1: List Required Operations\n\nWhat does your Skill need to do?\n\n- Read files? â `Read`\n- Modify files? â `Edit` or `Write`\n- Find files? â `Glob`\n- Search code? â `Grep`\n- Execute commands? â `Bash(...)`\n- Access web? â `WebFetch` or `WebSearch`\n\n### Step 2: Choose Minimum Set\n\nStart with the smallest set and add only when necessary.\n\n### Step 3: Test and Refine\n\nTest the Skill. If Claude can't complete tasks, review what additional tools are needed.\n\n### Step 4: Document Tool Usage\n\nIn your SKILL.md, explain why each tool is needed:\n\n```markdown\n## Tool Requirements\n\nThis skill requires the following tools:\n\n- **Read**: To examine source files for analysis\n- **Grep**: To search for specific patterns in code\n- **Glob**: To find all test files matching `*_test.py`\n- **Bash(pytest:*)**: To execute tests and capture output\n```\n\n## Examples from claude-code-meta Skills\n\n### claude-code-hooks Skill\n\n```yaml\nallowed-tools: Read, Write, Edit, Bash, Glob, Grep\n```\n\n**Reasoning:** Hooks skill needs to create hook scripts (Write), modify configs (Edit), execute hooks for testing (Bash), and search for examples (Grep, Glob).\n\n### claude-code-slash-commands Skill\n\n```yaml\nallowed-tools: Read, Write, Edit, Bash, Glob, Grep\n```\n\n**Reasoning:** Commands skill creates command files (Write), modifies existing ones (Edit), tests command execution (Bash), and searches for command patterns (Grep, Glob).\n\n### claude-code-mcp Skill\n\n```yaml\nallowed-tools: Read, Bash, Grep\n```\n\n**Reasoning:** MCP configuration skill reads config files (Read), executes `claude mcp` commands (Bash), and searches for MCP patterns (Grep). Notably does NOT include Write/Edit as MCP configuration is typically done via CLI, not file editing.\n\n## Troubleshooting\n\n### Skill Can't Complete Task\n\n**Symptom:** Claude reports it can't use a required tool.\n\n**Solution:** Add the tool to `allowed-tools` or verify the tool name spelling.\n\n### Permission Prompts Appear\n\n**Symptom:** User gets permission prompts despite `allowed-tools`.\n\n**Solution:** Ensure the tool is listed in `allowed-tools`. Check for typos in tool names (they're case-sensitive).\n\n### Skill Uses Wrong Tool\n\n**Symptom:** Claude uses an unexpected tool to accomplish a task.\n\n**Solution:** This may indicate the `allowed-tools` list is too permissive. Restrict to only necessary tools.\n\n### Bash Pattern Not Working\n\n**Symptom:** Bash commands are blocked despite pattern.\n\n**Solution:** Verify pattern syntax:\n\n- `Bash(command:*)` not `Bash(command*)`\n- `Bash(git status:*)` for specific subcommand\n- Patterns are exact match on command prefix\n\n## Best Practices\n\n1. **Start Restrictive** - Begin with minimal tools and add as needed\n2. **Document Choices** - Explain why each tool is required\n3. **Test Thoroughly** - Verify the Skill works with the restricted toolset\n4. **Audit Regularly** - Review and remove unnecessary tools\n5. **Use Patterns** - For Bash, use specific patterns instead of wildcard\n6. **Think Security** - Consider what could go wrong with each tool combination\n\n## Reference: Complete Tool List\n\nSee the Claude Code documentation for the complete list of available tools and their capabilities.\n\nCommon tools include:\n\n- File: Read, Write, Edit, Glob, Grep\n- Execution: Bash, Task\n- Web: WebFetch, WebSearch\n- Claude Code: Skill, SlashCommand, AskUserQuestion\n- MCP: mcp__<server>__<tool>\n\nFor MCP tools, use `/mcp` in Claude Code to see available servers and their tools.\n",
        "plugins/claude-code-meta/skills/claude-code-skills/references/progressive-disclosure.md": "# Progressive Disclosure in Agent Skills\n\nDeep dive into the progressive disclosure architecture that makes Skills efficient and scalable.\n\n*Based on: [Equipping agents for the real world with Agent Skills](https://www.anthropic.com/engineering/equipping-agents-for-the-real-world-with-agent-skills)*\n\n## The Problem Skills Solve\n\nGeneral-purpose agents face a fundamental challenge: they can interact with full computing environments, but real work requires:\n\n1. **Procedural knowledge** - Step-by-step processes that can't be derived from first principles\n2. **Organizational context** - Company-specific workflows, schemas, and business logic\n3. **Specialized expertise** - Domain-specific knowledge and best practices\n\nModels have limited context windows. Every byte of specialized knowledge competes with conversation history and the user's actual request.\n\n## Progressive Disclosure Design Principle\n\n**Core idea:** Load information in stages as needed, rather than consuming context upfront.\n\nThink of it like a manual with a table of contents, chapters, and appendicesâyou don't read everything to find what you need.\n\n### Three Levels of Loading\n\n#### Level 1: Metadata (Always Loaded)\n\n**What:** Name and description from YAML frontmatter\n**When:** At startup, included in system prompt\n**Token cost:** ~100 words per skill\n**Purpose:** Skill discoveryâenough info for Claude to know when to use it\n\n```yaml\n---\nname: pdf-processing\ndescription: Extract text and tables from PDF files, fill forms, merge documents. Use when working with PDF files or when the user mentions PDFs, forms, or document extraction.\n---\n```\n\n**Why this works:**\n\n- Minimal context footprint\n- All skills' metadata fits in system prompt\n- Claude can select relevant skills based on context\n\n#### Level 2: Instructions (Loaded When Triggered)\n\n**What:** SKILL.md body content\n**When:** Claude reads file when skill is relevant\n**Token cost:** Under 5k words recommended\n**Purpose:** Procedural knowledge and quick start guides\n\n```markdown\n# PDF Processing\n\n## Quick start\n\nUse pdfplumber to extract text from PDFs:\n\n\\`\\`\\`python\nimport pdfplumber\nwith pdfplumber.open(\"document.pdf\") as pdf:\n    text = pdf.pages[0].extract_text()\n\\`\\`\\`\n\nFor advanced form filling, see [FORMS.md](FORMS.md).\n```\n\n**Why this works:**\n\n- Only loaded when relevant\n- Focused on essential procedures\n- Points to detailed docs when needed\n- Doesn't hog context window permanently\n\n#### Level 3+: Resources (Loaded As Needed)\n\n**What:** Reference files, scripts, assets\n**When:** Claude accesses when explicitly needed\n**Token cost:** Unlimited (scripts can execute without loading)\n**Purpose:** Detailed docs, executable code, templates\n\n**Example structure:**\n\n```\npdf-skill/\nâââ SKILL.md           # Level 2: Core procedures\nâââ FORMS.md           # Level 3: Form-filling details\nâââ REFERENCE.md       # Level 3: Complete API reference\nâââ scripts/\n    âââ fill_form.py   # Level 3: Executable (may run without reading)\n```\n\n**Why this works:**\n\n- Detailed information available but not consuming context\n- Scripts execute efficiently (output consumed, not source)\n- No practical limit on bundled content\n- Progressive complexity based on task needs\n\n## How Progressive Disclosure Works in Practice\n\n### Scenario: PDF Form Filling Task\n\nUser asks: \"Fill out this PDF form with the data from data.json\"\n\n#### Step 1: Skill Discovery (Level 1)\n\nClaude's system prompt includes metadata for all installed skills:\n\n```\nAvailable skills:\n- pdf-processing: Extract text and tables from PDF files, fill forms...\n- excel-analysis: Analyze spreadsheets, create pivot tables...\n- git-workflows: Git branching, committing, and collaboration...\n```\n\nClaude matches \"PDF form\" â `pdf-processing` skill.\n\n#### Step 2: Load Core Procedures (Level 2)\n\nClaude reads `pdf-skill/SKILL.md`:\n\n```bash\n# Claude executes:\ncat pdf-skill/SKILL.md\n```\n\nGets core procedures and quick start guide (~3k words).\n\n#### Step 3: Conditional Detail Loading (Level 3)\n\nSKILL.md mentions: \"For form filling, see [FORMS.md](FORMS.md)\"\n\nClaude determines form filling is needed:\n\n```bash\n# Claude executes:\ncat pdf-skill/FORMS.md\n```\n\nGets detailed form-filling procedures.\n\n#### Step 4: Script Execution (Level 3+)\n\nFORMS.md references `scripts/fill_form.py`\n\nClaude executes the script:\n\n```bash\n# Claude executes:\npython pdf-skill/scripts/fill_form.py input.pdf output.pdf --data data.json\n```\n\n**Key efficiency:** Script source (~200 lines) never loaded into contextâonly the output (success message) is consumed.\n\n### Token Accounting Example\n\n| Content | Loaded? | Token Cost |\n|---------|---------|------------|\n| pdf-processing metadata | Always | ~100 tokens |\n| Other 10 skills metadata | Always | ~1000 tokens |\n| SKILL.md body | When triggered | ~3000 tokens |\n| FORMS.md reference | If needed | ~2000 tokens |\n| REFERENCE.md | Not accessed | 0 tokens |\n| fill_form.py source | Not read | 0 tokens |\n| fill_form.py output | Result only | ~50 tokens |\n\n**Total:** ~6150 tokens vs. ~50,000 tokens if everything was pre-loaded\n\n## Skills and the Context Window\n\n### Context is a Public Good\n\nEverything shares the same context window:\n\n- System prompt\n- Conversation history\n- All skills' metadata\n- Active skill content\n- User's current request\n\n**Implication:** Being concise in SKILL.md means less competition with conversation history.\n\n### The Code Execution Environment\n\nSkills leverage Claude's code execution environment:\n\n- **Real filesystem** - Skills exist as actual directories and files\n- **Bash access** - Claude can read files dynamically\n- **Code execution** - Claude can run scripts and capture output\n\nThis architecture enables progressive disclosure:\n\n```python\n# Claude can do this:\nif need_basic_info:\n    read(\"SKILL.md\")\nif need_advanced_info:\n    read(\"FORMS.md\")\nif need_to_process:\n    output = execute(\"scripts/fill_form.py\", args)\n```\n\n### Why Not Just Include Everything?\n\n**Anti-pattern: The Monolithic Skill**\n\n```yaml\n---\nname: pdf-everything\ndescription: Complete PDF processing guide\n---\n\n# PDF Everything\n\n(10,000 words of content covering every PDF operation...)\n```\n\n**Problems:**\n\n1. Consumes 10k tokens every time skill is used\n2. Pushes conversation history out of context\n3. Most content irrelevant to current task\n4. Slower to process\n5. Harder to maintain\n\n**Better: Progressive Organization**\n\n```\npdf-skill/\nâââ SKILL.md         # 500 words: overview, common tasks\nâââ EXTRACT.md       # 2k words: text/table extraction details\nâââ FORMS.md         # 2k words: form-filling details\nâââ MERGE.md         # 1k words: merging PDFs\nâââ REFERENCE.md     # 5k words: complete API reference\n```\n\nClaude loads only what's needed for the task.\n\n## Design Guidelines for Progressive Disclosure\n\n### 1. Metadata is Critical\n\n**Description should include:**\n\n- What the skill does\n- When to use it\n- Key trigger words users might say\n\n```yaml\n# Good\ndescription: Extract text and tables from PDF files, fill forms, merge documents. Use when working with PDF files or when the user mentions PDFs, forms, or document extraction.\n\n# Too vague\ndescription: Helps with documents\n```\n\n### 2. SKILL.md is an Overview\n\n**Should include:**\n\n- Quick start examples\n- Common workflows\n- Pointers to detailed docs\n\n**Should NOT include:**\n\n- Complete API references\n- Exhaustive option lists\n- Every edge case\n\n**Rule of thumb:** Keep SKILL.md under 5k words\n\n### 3. Split by Topic, Not Arbitrarily\n\n**Good splitting:**\n\n```\nbigquery-skill/\nâââ SKILL.md              # Overview\nâââ reference/\n    âââ finance.md        # Finance tables\n    âââ sales.md          # Sales tables\n    âââ product.md        # Product tables\n    âââ marketing.md      # Marketing tables\n```\n\nClaude loads only the domain needed.\n\n**Bad splitting:**\n\n```\nbigquery-skill/\nâââ SKILL.md\nâââ part1.md             # First half of API\nâââ part2.md             # Second half of API\n```\n\nNo clear trigger for when to load each part.\n\n### 4. Reference Patterns\n\n**Direct references (1 level):**\n\n```markdown\nFor advanced form filling, see [FORMS.md](FORMS.md).\n```\n\n**Avoid deep nesting:**\n\n```markdown\n# Bad - requires following multiple references\nSee [GUIDE.md](GUIDE.md), which links to [ADVANCED.md](ADVANCED.md),\nwhich references [INTERNALS.md](INTERNALS.md)\n```\n\n### 5. Scripts for Determinism\n\n**When to bundle scripts:**\n\n- Same code written repeatedly\n- Need deterministic execution\n- Complex logic better in real code\n- Performance-sensitive operations\n\n**Script execution is token-efficient:**\n\n- Source code not loaded into context\n- Only output consumed\n- Can be arbitrarily complex\n\n## Advanced Patterns\n\n### Conditional Loading\n\nSKILL.md can guide Claude's file reading:\n\n```markdown\n## Text Extraction\n\nFor basic extraction:\n(inline example)\n\nFor tables with complex layouts, see [ADVANCED_TABLES.md](ADVANCED_TABLES.md).\n\nFor scanned PDFs requiring OCR, see [OCR.md](OCR.md).\n```\n\nClaude loads advanced docs only when needed.\n\n### Grep Patterns for Large Files\n\nFor very large reference files:\n\n```markdown\n## Database Schema\n\nThe complete schema is in [schema.md](schema.md).\n\nTo find a specific table:\n\\`\\`\\`bash\ngrep -A 20 \"## users_table\" schema.md\n\\`\\`\\```\n\nClaude can efficiently search without loading the entire file.\n\n### Domain-Specific Organization\n\nOrganize by user's domain, not technical structure:\n\n```\n\nanalytics-skill/\nâââ SKILL.md\nâââ dashboards/\n    âââ sales.md         # Sales team workflows\n    âââ marketing.md     # Marketing team workflows\n    âââ product.md       # Product team workflows\n\n```\n\nClaude loads only the relevant domain knowledge.\n\n## Measuring Progressive Disclosure Success\n\n### Good Signs\n\n- Skill used successfully without loading all files\n- Different tasks use different reference files\n- Scripts executed without source loading\n- Context window has room for conversation\n\n### Warning Signs\n\n- SKILL.md is >5k words\n- Same files loaded every time\n- Few or no references used\n- Users report \"Claude seems slow/forgetful\"\n\n### Optimization Process\n\n1. **Monitor usage** - Which files get loaded?\n2. **Identify patterns** - Are some files always loaded together?\n3. **Refactor** - Merge frequently-paired files, split monoliths\n4. **Test** - Verify tasks still complete successfully\n\n## Real-World Example: Anthropic's PDF Skill\n\nFrom the [document-skills](https://github.com/anthropics/skills/tree/main/document-skills/pdf):\n\n```\n\npdf/\nâââ SKILL.md           # Overview and quick start\nâââ FORMS.md           # Form filling details\nâââ READING.md         # Text extraction strategies\nâââ VISUAL.md          # Visual analysis approaches\nâââ scripts/\n    âââ extract_fields.py  # Form field extraction\n\n```\n\n**Progressive disclosure in action:**\n\n1. User: \"Extract text from this PDF\"\n   - Loads: SKILL.md only\n   - Uses: Inline pdfplumber example\n   - Tokens: ~3k\n\n2. User: \"Fill out this PDF form\"\n   - Loads: SKILL.md â FORMS.md\n   - Uses: Form-filling procedures\n   - Executes: scripts/extract_fields.py\n   - Tokens: ~5k + script output\n\n3. User: \"Extract tables from scanned PDF\"\n   - Loads: SKILL.md â VISUAL.md\n   - Uses: Visual analysis strategies\n   - Tokens: ~6k\n\nEach task uses only what it needs.\n\n## Conclusion\n\nProgressive disclosure makes Skills:\n- **Scalable** - No limit on bundled content\n- **Efficient** - Minimal context consumption\n- **Flexible** - Adapt to task complexity\n- **Maintainable** - Organize by topic, not size\n\n**Key principle:** Provide discovery metadata (always loaded), procedural guidance (when triggered), and detailed references (as needed), letting the agent's code execution environment handle the progressive loading efficiently.\n",
        "plugins/claude-code-meta/skills/claude-code-slash-commands/SKILL.md": "---\nname: claude-code-slash-commands\ndescription: This skill should be used when creating, configuring, or working with Claude Code slash commands. Use when users ask to create custom slash commands, set up command features like arguments or bash execution, or need guidance on slash command structure and best practices.\n---\n\n# Claude Code Slash Commands\n\nGuide Claude through creating and configuring custom slash commands for Claude Code.\n\n## Purpose\n\nSlash commands let users define frequently-used prompts as Markdown files that Claude can execute on demand. This skill helps create well-structured slash commands with proper frontmatter, arguments, bash execution, and other advanced features.\n\n## When to Use This Skill\n\nUse this skill when:\n\n- Creating new custom slash commands (project or personal)\n- Adding arguments, bash execution, or file references to commands\n- Configuring frontmatter options (allowed-tools, model, argument-hint, etc.)\n- Troubleshooting slash command issues\n\n## Command Types\n\n### Project Commands\n\n- Stored at: `.claude/commands/`\n- Shared with the team (versioned in git)\n- Shown as `(project)` in `/help`\n\n### Personal Commands\n\n- Stored at: `~/.claude/commands/`\n- Available across all projects\n- Shown as `(user)` in `/help`\n\n### Plugin Commands\n\n- Stored at: `commands/` in plugin root\n- Distributed via plugin marketplaces\n- Shown as `(plugin:plugin-name)` in `/help`\n- Invoked with `/plugin-name:command-name` or just `/command-name`\n- Support all features (arguments, frontmatter, bash, file references)\n\n## Creating Slash Commands\n\n### Quick Creation with Helper Script\n\nUse the bundled creation script for fast, templated command setup:\n\n```bash\n# Create project command with basic template\nscripts/create_slash_command.sh my-command --project\n\n# Create personal command with advanced template\nscripts/create_slash_command.sh my-command --user --template advanced\n\n# Create plugin command (auto-detects plugin from current directory)\nscripts/create_slash_command.sh my-command --plugin\n\n# Create plugin command for specific plugin\nscripts/create_slash_command.sh my-command --plugin my-plugin-name\n\n# Available templates: basic, arguments, bash, advanced\n```\n\nThe script is located at: `scripts/create_slash_command.sh`\n\n**Plugin command creation:**\n\n- Use `--plugin` to create commands in a plugin's `commands/` directory\n- Auto-detects plugin when run from within a plugin directory\n- Or specify plugin name: `--plugin my-plugin-name`\n- Reminds you to register the command in `marketplace.json`\n\n### Manual Creation\n\nWhen creating commands manually, follow this structure:\n\n1. **Choose scope** - Decide between:\n   - Project: `.claude/commands/`\n   - Personal: `~/.claude/commands/`\n   - Plugin: `plugins/<plugin-name>/commands/`\n\n2. **Create directory** - Ensure the target directory exists:\n\n   ```bash\n   mkdir -p .claude/commands            # Project\n   mkdir -p ~/.claude/commands          # Personal\n   mkdir -p plugins/my-plugin/commands  # Plugin\n   ```\n\n3. **Create file** - Named `command-name.md` (the filename becomes the command)\n\n4. **Add frontmatter** - Include at minimum a `description` field\n\n5. **Write instructions** - Clear, actionable prompts for Claude\n\n6. **Register plugin commands** - If creating a plugin command:\n   - Open `.claude-plugin/marketplace.json`\n   - Find the plugin's entry in the `plugins` array\n   - Add `\"./commands/command-name.md\"` to the plugin's `commands` array\n\n## Available Templates\n\nFour templates are provided in `assets/` for common use cases:\n\n### Basic Template (`template-basic.md`)\n\nMinimal slash command with just description and instructions.\n\n**Use when:** Creating simple, straightforward prompts.\n\n### Arguments Template (`template-with-arguments.md`)\n\nShows how to use `$ARGUMENTS`, `$1`, `$2`, etc. for parameterized commands.\n\n**Use when:** Commands need user-provided input or parameters.\n\n### Bash Template (`template-with-bash.md`)\n\nDemonstrates bash command execution with the \\`!\\` prefix for gathering context.\n\n**Use when:** Commands need git status, file listings, or other system context.\n\n### Advanced Template (`template-advanced.md`)\n\nFull-featured template with all frontmatter options, bash execution, arguments, and file references.\n\n**Use when:** Building complex workflows or need multiple features.\n\n## Frontmatter Options\n\nAll available frontmatter fields:\n\n```yaml\n---\ndescription: Brief description shown in /help\nargument-hint: [arg1] [arg2]\nallowed-tools: Bash(git:*), Read, Write, Edit\nmodel: claude-sonnet-4-5-20250929\ndisable-model-invocation: false\n---\n```\n\n### Field Details\n\n- **description** (required) - Brief description of what the command does\n- **argument-hint** - Shown in autocomplete, helps users know what arguments to provide\n- **allowed-tools** - Pre-approved tools the command can use (bypasses permission prompts)\n- **model** - Specific model to use for this command (overrides conversation model)\n- **disable-model-invocation** - Prevents SlashCommand tool from executing this command\n\n## Advanced Features\n\n### Arguments\n\nTwo ways to handle arguments:\n\n**1. Capture all as string:**\n\n```markdown\nFix issue #$ARGUMENTS following our coding standards\n```\n\nUsage: `/fix-issue 123 high-priority` â `$ARGUMENTS = \"123 high-priority\"`\n\n**2. Individual positional arguments:**\n\n```markdown\nReview PR #$1 with priority $2 and assign to $3\n```\n\nUsage: `/review-pr 456 high alice` â `$1=\"456\"`, `$2=\"high\"`, `$3=\"alice\"`\n\n### Bash Command Execution\n\nExecute bash commands inline to gather context:\n\n```markdown\n---\nallowed-tools: Bash(git status:*), Bash(git diff:*)\n---\n\n## Context\n- Current status: \\`!\\` `git status`\n- Current diff: \\`!\\` `git diff HEAD`\n```\n\n**Important:** Commands prefixed with \\`!\\` run before the slash command is processed. Results are injected into the prompt.\n\n### File References\n\nReference files using \\`@\\` prefix:\n\n```markdown\nReview the implementation in \\@src/utils/helpers.js\nCompare \\@old-file.js with \\@new-file.js\n```\n\n### Extended Thinking Mode\n\nTrigger extended thinking by including keywords:\n\n- \"think carefully\"\n- \"analyze thoroughly\"\n- \"consider all implications\"\n\n## Workflow\n\nWhen creating a new slash command:\n\n1. **Understand requirements** - Ask user about:\n   - Command purpose and when it should be used\n   - Whether arguments are needed\n   - What context (bash, files) should be gathered\n   - Scope (project, personal, or plugin)\n\n2. **Choose template** - Select the most appropriate template:\n   - Basic for simple prompts\n   - Arguments for parameterized commands\n   - Bash for context-gathering commands\n   - Advanced for complex workflows\n\n3. **Use creation script or manual approach**:\n   - Project: `scripts/create_slash_command.sh <name> --project --template <type>`\n   - Personal: `scripts/create_slash_command.sh <name> --user --template <type>`\n   - Plugin: `scripts/create_slash_command.sh <name> --plugin [plugin-name] --template <type>`\n   - Manual: Create file in appropriate directory\n\n4. **Customize content**:\n   - Update frontmatter (especially description)\n   - Write clear, actionable instructions\n   - Add success criteria if applicable\n   - Configure allowed-tools if using bash\n\n5. **Register plugin commands** (plugin scope only):\n   - Add command to `.claude-plugin/marketplace.json`\n   - In the plugin's entry, add `\"./commands/<command-name>.md\"` to the `commands` array\n   - The script will remind you of this step\n\n6. **Test and iterate**:\n   - Project/personal: Run with `/command-name`\n   - Plugin: Run with `/plugin-name:command-name`\n   - Verify it works as expected\n   - Adjust based on results\n\n## Reference Documentation\n\nFor detailed information about slash commands, refer to `references/slash-commands-reference.md`, which contains:\n\n- Complete frontmatter field reference\n- Permission rules and SlashCommand tool details\n- MCP slash command integration\n- Plugin command structure\n- Skills vs slash commands comparison\n\nLoad this reference when users need detailed technical information beyond the workflow guidance in this skill.\n\n## Best Practices\n\n- **Keep it focused** - One command, one clear purpose\n- **Use descriptive names** - Command names should indicate what they do\n- **Document arguments** - Include argument-hint in frontmatter\n- **Specify allowed-tools** - Pre-approve tools to avoid permission prompts\n- **Test thoroughly** - Verify commands work before committing to project or publishing plugin\n- **Consider scope** - Project for team workflows, personal for individual preferences, plugin for reusable/distributable commands\n- **Register plugin commands** - Always update marketplace.json when creating plugin commands\n\n## Skills vs Slash Commands\n\nHelp users choose between creating a skill or a slash command:\n\n**Use Slash Commands when:**\n\n- Single file is sufficient\n- Simple, repeatable prompts\n- Manual invocation desired\n- Quick setup needed\n\n**Use Skills when:**\n\n- Multiple files/scripts needed\n- Complex workflows required\n- Automatic triggering desired\n- Bundled resources beneficial\n\nBoth can coexist; recommend the approach that best fits the use case.\n",
        "plugins/claude-code-meta/skills/claude-code-slash-commands/assets/template-advanced.md": "---\ndescription: [Brief description of what this command does]\nargument-hint: [arg1] [arg2]\nallowed-tools: Bash(git:*), Read, Write, Edit\nmodel: claude-sonnet-4-5-20250929\ndisable-model-invocation: false\n---\n\n# Advanced Slash Command Template\n\nThis template demonstrates all available features.\n\n## Context Gathering\n\nUse bash execution to gather context:\n\n- Current status: ! `git status`\n- Project files: ! `ls -la`\n\n## Arguments\n\n- `$1` - [First argument description]\n- `$2` - [Second argument description]\n- `$ARGUMENTS` - All arguments as a single string\n\n## File References\n\nReference files using @ syntax:\n\n- Review implementation in @src/main.js\n- Compare @old-file.js with @new-file.js\n\n## Extended Thinking\n\nUse keywords like \"think carefully\", \"analyze thoroughly\", or \"consider all implications\" to trigger extended thinking mode.\n\n## Your Task\n\n[Detailed instructions for Claude, incorporating context, arguments, and file references]\n\n## Success Criteria\n\n- [ ] [Criterion 1]\n- [ ] [Criterion 2]\n- [ ] [Criterion 3]\n",
        "plugins/claude-code-meta/skills/claude-code-slash-commands/assets/template-basic.md": "---\ndescription: [Brief description of what this command does]\n---\n\n[Your command instructions here]\n",
        "plugins/claude-code-meta/skills/claude-code-slash-commands/assets/template-with-arguments.md": "---\ndescription: [Brief description of what this command does]\nargument-hint: [arg1] [arg2] [arg3]\n---\n\n# Command with Arguments\n\nYour instructions here.\n\n## Arguments\n\n- `$1` - [Description of first argument]\n- `$2` - [Description of second argument]\n- `$3` - [Description of third argument]\n\nOr use `$ARGUMENTS` to capture all arguments as a single string.\n\n## Example Usage\n\n```\n/your-command value1 value2 value3\n```\n",
        "plugins/claude-code-meta/skills/claude-code-slash-commands/assets/template-with-bash.md": "---\ndescription: [Brief description of what this command does]\nallowed-tools: Bash(git status:*), Bash(git diff:*), Bash(git log:*)\n---\n\n# Command with Bash Execution\n\nThis command uses bash execution to gather context before processing.\n\n## Context\n\n- Current git status: ! `git status`\n- Current git diff: ! `git diff HEAD`\n- Recent commits: ! `git log --oneline -10`\n\n## Your Task\n\n[Your instructions here, using the context gathered above]\n",
        "plugins/claude-code-meta/skills/claude-code-slash-commands/references/slash-commands-reference.md": "# Slash Commands Reference\n\nControl Claude's behavior during an interactive session with slash commands.\n\n---\n\n## Built-in slash commands\n\n| Command | Purpose |\n|---------|---------|\n| `/add-dir` | Add additional working directories |\n| `/agents` | Manage custom AI subagents for specialized tasks |\n| `/bug` | Report bugs (sends conversation to Anthropic) |\n| `/clear` | Clear conversation history |\n| `/compact [instructions]` | Compact conversation with optional focus instructions |\n| `/config` | Open the Settings interface (Config tab) |\n| `/cost` | Show token usage statistics ([cost tracking guide](https://docs.claude.com/en/docs/claude-code/costs#using-the-cost-command)) |\n| `/doctor` | Checks the health of your Claude Code installation |\n| `/help` | Get usage help |\n| `/init` | Initialize project with CLAUDE.md guide |\n| `/login` | Switch Anthropic accounts |\n| `/logout` | Sign out from your Anthropic account |\n| `/mcp` | Manage MCP server connections and OAuth authentication |\n| `/memory` | Edit CLAUDE.md memory files |\n| `/model` | Select or change the AI model |\n| `/permissions` | View or update [permissions](https://docs.claude.com/en/docs/claude-code/iam#configuring-permissions) |\n| `/pr_comments` | View pull request comments |\n| `/review` | Request code review |\n| `/sandbox` | Enable sandboxed bash tool for safer execution |\n| `/rewind` | Rewind the conversation and/or code |\n| `/status` | Open the Settings interface (Status tab) |\n| `/terminal-setup` | Install Shift+Enter key binding for newlines (iTerm2 & VSCode only) |\n| `/usage` | Show plan usage limits and rate limit status |\n| `/vim` | Enter vim mode (insert & command modes) |\n\n---\n\n## Custom slash commands\n\nCustom slash commands let you define frequently-used prompts as Markdown files that Claude Code can execute.\nCommands are organized by scope (project-specific or personal) and support namespacing via directory structures.\n\n### Syntax\n\n```\n/[arguments]\n```\n\n#### Parameters\n\n| Parameter | Description |\n|-----------|-------------|\n|           | Name derived from the Markdown filename (no `.md` extension) |\n| `[arguments]` | Optional arguments passed to the command |\n\n### Command types\n\n#### Project commands\n\n- **Stored at:** `.claude/commands/`\n- Shared with your team (shown as `(project)` in `/help`).\n\n**Example:**\nCreate `/optimize` command:\n\n```\nmkdir -p .claude/commands\necho \"Analyze this code for performance issues and suggest optimizations:\" > .claude/commands/optimize.md\n```\n\n#### Personal commands\n\n- **Stored at:** `~/.claude/commands/`\n- Available across all projects (shown as `(user)` in `/help`).\n\n**Example:**\nCreate `/security-review` command:\n\n```\nmkdir -p ~/.claude/commands\necho \"Review this code for security vulnerabilities:\" > ~/.claude/commands/security-review.md\n```\n\n### Features\n\n#### Namespacing\n\n- Organize commands in subdirectories.\n- The folder name will show in descriptions, e.g., `(project:frontend)`.\n- Base names build the command name; subdirectory is descriptive only.\n\nConflicts between user and project commands aren't supported, but you can have multiple commands with the same basename in different scopes.\n\n#### Arguments\n\n- **All arguments:** `$ARGUMENTS`\n  Captures all arguments.\n\n  **Example:**\n\n  ```\n  echo 'Fix issue #$ARGUMENTS following our coding standards' > .claude/commands/fix-issue.md\n  # Usage:\n  > /fix-issue 123 high-priority\n  # $ARGUMENTS becomes: \"123 high-priority\"\n  ```\n\n- **Individual arguments:** `$1`, `$2`, etc.\n  Positional, for more structured commands.\n\n  **Example:**\n\n  ```\n  echo 'Review PR #$1 with priority $2 and assign to $3' > .claude/commands/review-pr.md\n  # Usage:\n  > /review-pr 456 high alice\n  # $1=\"456\", $2=\"high\", $3=\"alice\"\n  ```\n\n#### Bash command execution\n\n- Prefix with `!` to execute bash commands before the slash command.\n- Bash tool must be allowed via `allowed-tools` frontmatter.\n\n  **Example:**\n\n  ```\n  ---\n  allowed-tools: Bash(git add:*), Bash(git status:*), Bash(git commit:*)\n  description: Create a git commit\n  ---\n  ## Context\n  - Current git status: ! `git status`\n  - Current git diff: ! `git diff HEAD`\n  - Current branch: ! `git branch --show-current`\n  - Recent commits: ! `git log --oneline -10`\n  ## Your task\n  Based on the above changes, create a single git commit.\n  ```\n\n#### File references\n\n- Use `@` prefix to reference files.\n\n  ```\n  Review the implementation in @src/utils/helpers.js\n  Compare @src/old-version.js with @src/new-version.js\n  ```\n\n#### Thinking mode\n\n- Trigger extended thinking by including [extended thinking keywords](https://docs.claude.com/en/docs/claude-code/common-workflows#use-extended-thinking).\n\n### Frontmatter\n\nCommand files support frontmatter for metadata:\n\n| Frontmatter         | Purpose                                        | Default           |\n|---------------------|------------------------------------------------|-------------------|\n| `allowed-tools`     | List of tools the command can use              | Inherits from conversation |\n| `argument-hint`     | Shown to user for slash command autocomplete   | None              |\n| `description`       | Brief description of the command               | First line of prompt |\n| `model`             | Model string ([models](https://docs.claude.com/en/docs/about-claude/models/overview)) | Inherits from conversation |\n| `disable-model-invocation` | Prevent `SlashCommand` tool from using this | false            |\n\n**Example:**\n\n```\n---\nallowed-tools: Bash(git add:*), Bash(git status:*), Bash(git commit:*)\nargument-hint: [message]\ndescription: Create a git commit\nmodel: claude-3-5-haiku-20241022\n---\nCreate a git commit with message: $ARGUMENTS\n```\n\n---\n\n## Plugin commands\n\nPlugins can provide custom slash commands that work just like user-defined ones and are distributed via [plugin marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces).\n\n### How plugin commands work\n\n- **Namespaced:** Format `/plugin-name:command-name`\n- **Available on install:** Appear in `/help` after install\n- **Fully integrated**: Support all features (arguments, frontmatter, bash, file refs)\n\n### Structure\n\n- **Location:** `commands/` in plugin root\n- **File format:** Markdown with frontmatter\n\n**Example:**\n\n```\n---\ndescription: Brief description of what the command does\n---\n# Command Name\nDetailed instructions for Claude\n```\n\nAdvanced features: Arguments with `{arg1}` placeholders, subdirectories for namespacing, bash integration, file references.\n\n### Invocation patterns\n\n- Direct command: `/command-name`\n- Plugin prefixed: `/plugin-name:command-name`\n- With arguments: `/command-name arg1 arg2`\n\n---\n\n## MCP slash commands\n\nMCP servers can expose prompts as slash commands that are dynamically discovered and available in Claude Code.\n\n### Command format\n\n```\n/mcp____ [arguments]\n```\n\n### Features\n\n#### Dynamic discovery\n\nMCP commands become available when:\n\n- An MCP server is connected/active\n- Server exposes prompts via MCP protocol\n- Prompts are retrieved on connection\n\n#### Arguments\n\n- MCP prompts can accept arguments, e.g.:\n\n  ```\n  > /mcp__github__list_prs\n  > /mcp__github__pr_review 456\n  > /mcp__jira__create_issue \"Bug title\" high\n  ```\n\n#### Naming conventions\n\n- Names are normalized (spacesâunderscores, lowercased)\n- No special characters in names\n\n### Managing MCP connections\n\nUse `/mcp` to:\n\n- View/configure MCP servers\n- Check status and authenticate\n- Clear tokens\n- View server tools/prompts\n\n### MCP permissions and wildcards\n\nWildcards are **not supported** in permissions.\n\n- Correct: `mcp__github`\n- Correct: `mcp__github__get_issue`\n- Incorrect: `mcp__github__*` (not supported)\n\n---\n\n## `SlashCommand` tool\n\nThe `SlashCommand` tool allows Claude to execute custom slash commands programmatically, if referenced by name with its slash.\n\n**Example:**\n> Run /write-unit-test when you are about to start writing tests.\n\n**Supported commands:**\n\n- Only user-defined commands with the `description` frontmatter are supported (not built-in).\n\nYou can see which custom slash commands the tool can invoke by running `claude --debug`.\n\n### Disable `SlashCommand` tool\n\nTo prevent all slash commands from running via the tool:\n\n```\n/permissions\n# Add to deny rules: SlashCommand\n```\n\nOr, to disable just a specific command, set `disable-model-invocation: true` in frontmatter.\n\n### Permission rules\n\n- **Exact match:** `SlashCommand:/commit`\n- **Prefix match:** `SlashCommand:/review-pr:*`\n\n### Character budget limit\n\nThe tool enforces a limit to avoid overflowing Claude context.\n\n- **Default:** 15,000 characters\n- **Custom:** Set via `SLASH_COMMAND_TOOL_CHAR_BUDGET` env\n\n---\n\n## Skills vs slash commands\n\n| Aspect         | Slash Commands         | Agent Skills               |\n|----------------|-----------------------|----------------------------|\n| **Complexity** | Simple prompts        | Complex capabilities       |\n| **Structure**  | Single .md file       | Directory + resources      |\n| **Discovery**  | Manual (`/command`)   | Automatic (context-based)  |\n| **Files**      | One file only         | Multiple files/scripts     |\n| **Scope**      | Project or personal   | Project or personal        |\n| **Sharing**    | Via git               | Via git                    |\n\n### When to use\n\n**Slash commands:**\n\n- For quick, repeatable prompts in one file\n- When you want explicit, manual control\n\n**Agent Skills:**\n\n- For automatic, structured capabilities\n- When a workflow needs multiple files/scripts and detailed guidance\n\nBoth can coexist; use what matches your need.\nLearn more about [Agent Skills](https://docs.claude.com/en/docs/claude-code/skills).\n\n---\n\n## See also\n\n- [Plugins](https://docs.claude.com/en/docs/claude-code/plugins) â extend Claude Code with custom commands\n- [Identity and Access Management](https://docs.claude.com/en/docs/claude-code/iam) â permissions, MCP tool permissions\n- [Interactive mode](https://docs.claude.com/en/docs/claude-code/interactive-mode) â shortcuts, input modes\n- [CLI reference](https://docs.claude.com/en/docs/claude-code/cli-reference) â command-line flags and options\n- [Settings](https://docs.claude.com/en/docs/claude-code/settings) â configuration options\n- [Memory management](https://docs.claude.com/en/docs/claude-code/memory) â manage memory across sessions\n",
        "plugins/claude-code-meta/skills/claude-code-subagents/SKILL.md": "---\nname: claude-code-subagents\ndescription: This skill should be used when creating, configuring, or working with Claude Code subagents. Use when users ask to create custom subagents, set up subagent configurations, manage tool permissions, or need guidance on subagent architecture and best practices.\n---\n\n# Claude Code Subagents\n\nGuide Claude through creating and configuring specialized subagents for Claude Code.\n\n## Purpose\n\nSubagents are pre-configured AI personalities that handle specific types of tasks with their own context windows, custom system prompts, and tool configurations. This skill helps create well-structured subagents that improve task delegation, context management, and specialized workflows.\n\n## When to Use This Skill\n\nUse this skill when:\n\n- Creating new custom subagents (project, personal, or plugin)\n- Configuring subagent properties (tools, model, system prompts)\n- Setting up specialized workflows with subagent delegation\n- Troubleshooting subagent invocation or behavior\n\n## Subagent Types\n\n### Project Subagents\n\n- Stored at: `.claude/agents/`\n- Shared with the team (versioned in git)\n- Highest priority when name conflicts occur\n- Team-specific workflows and conventions\n\n### Personal Subagents\n\n- Stored at: `~/.claude/agents/`\n- Available across all projects\n- Lower priority than project subagents\n- Personal preferences and workflows\n\n### Plugin Subagents\n\n- Stored at: `agents/` in plugin root\n- Distributed via plugin marketplaces\n- Shown as `(plugin:plugin-name)` in `/agents`\n- Support all configuration features\n- Can be invoked explicitly or automatically\n\n## Creating Subagents\n\n### Quick Creation with Helper Script\n\nUse the bundled creation script for fast, templated subagent setup:\n\n```bash\n# Create project subagent with code-reviewer template\nscripts/create_subagent.sh code-reviewer --project --template code-reviewer\n\n# Create personal subagent with custom template\nscripts/create_subagent.sh my-agent --user --template debugger\n\n# Create plugin subagent (auto-detects plugin from current directory)\nscripts/create_subagent.sh my-agent --plugin\n\n# Create plugin subagent for specific plugin\nscripts/create_subagent.sh my-agent --plugin my-plugin-name\n\n# Available templates: code-reviewer, debugger, custom\n```\n\nThe script is located at: `scripts/create_subagent.sh`\n\n**Plugin subagent creation:**\n\n- Use `--plugin` to create subagents in a plugin's `agents/` directory\n- Auto-detects plugin when run from within a plugin directory\n- Or specify plugin name: `--plugin my-plugin-name`\n- Reminds you to register the subagent in `marketplace.json`\n\n### Using the /agents Command\n\nThe `/agents` command provides an interactive interface:\n\n- View all subagents (built-in, user, project, plugin)\n- Create new subagents with guided setup\n- Generate subagents with Claude's assistance\n- Edit custom subagents including tool access\n- Delete custom subagents\n- See which subagents are active when duplicates exist\n- Manage tool permissions easily\n\n**Recommended workflow:**\n\n1. Run `/agents`\n2. Select 'Create New Agent'\n3. Choose scope (project/user)\n4. Let Claude generate the subagent based on your description\n5. Press `e` to edit the system prompt in your editor\n6. Customize as needed\n\n### Manual Creation\n\nWhen creating subagents manually, follow this structure:\n\n1. **Choose scope** - Decide between:\n   - Project: `.claude/agents/`\n   - Personal: `~/.claude/agents/`\n   - Plugin: `plugins/<plugin-name>/agents/`\n\n2. **Create directory** - Ensure the target directory exists:\n\n   ```bash\n   mkdir -p .claude/agents            # Project\n   mkdir -p ~/.claude/agents          # Personal\n   mkdir -p plugins/my-plugin/agents  # Plugin\n   ```\n\n3. **Create file** - Named `agent-name.md` (the filename becomes the agent name)\n\n4. **Add frontmatter** - Include required fields:\n\n   ```yaml\n   ---\n   name: agent-name\n   description: Description of when this subagent should be invoked\n   tools: Read, Write, Edit, Bash(git:*)  # Optional; inherits all if omitted\n   model: sonnet                          # Optional; sonnet/opus/haiku/inherit\n   ---\n   ```\n\n5. **Write system prompt** - Clear, detailed instructions defining the subagent's role, capabilities, and approach\n\n6. **Register plugin subagents** - If creating a plugin subagent:\n   - Open `.claude-plugin/marketplace.json`\n   - Find the plugin's entry in the `plugins` array\n   - Add `\"./agents/agent-name.md\"` to the plugin's `agents` array\n\n## Available Templates\n\nThree templates are provided in `assets/` for common use cases:\n\n### Code Reviewer (`code-reviewer.md`)\n\nSenior code reviewer focused on quality, security, and maintainability.\n\n**Use when:** Need automated code review after changes.\n\n**Features:**\n\n- Proactive invocation after code modifications\n- Comprehensive review checklist\n- Priority-based feedback organization\n- Security vulnerability detection\n\n### Debugger (`debugger.md`)\n\nExpert debugger for root cause analysis and issue resolution.\n\n**Use when:** Encountering errors, test failures, or unexpected behavior.\n\n**Features:**\n\n- Systematic debugging process\n- Hypothesis formation and testing\n- Strategic logging recommendations\n- Root cause identification\n\n### Custom Template (`custom.md`)\n\nBlank template for building specialized subagents.\n\n**Use when:** Need a starting point for unique workflows.\n\n## Configuration Reference\n\n### Frontmatter Fields\n\nAll available frontmatter fields:\n\n```yaml\n---\nname: agent-name                    # Required: lowercase, hyphens only\ndescription: When to invoke agent   # Required: specific, action-oriented\ntools: Read, Write, Bash(git:*)    # Optional: comma-separated list\nmodel: sonnet                      # Optional: sonnet/opus/haiku/inherit\n---\n```\n\n### Field Details\n\n- **name** (required) - Unique identifier (lowercase, alphanumeric + hyphens)\n- **description** (required) - Natural language description of when the subagent should be invoked\n- **tools** (optional) - Comma-separated list of allowed tools; inherits all if omitted\n- **model** (optional) - Model to use: `sonnet`, `opus`, `haiku`, or `inherit` (matches conversation model)\n\n### Tool Configuration\n\nSubagents can use Claude Code's internal tools. Examples:\n\n```yaml\n# Inherit all tools (including MCP tools)\n# Omit the tools field entirely\n\n# Specific tools only\ntools: Read, Write, Edit, Grep, Glob\n\n# Bash with patterns\ntools: Bash(git:*), Bash(npm:*), Read\n\n# Limited toolset for security\ntools: Read, Grep\n```\n\nSee full tool list in references documentation.\n\n## Workflow\n\nWhen creating a new subagent:\n\n1. **Understand requirements** - Ask user about:\n   - Subagent purpose and specialization\n   - When it should be invoked (automatic vs explicit)\n   - What tools it needs access to\n   - Scope (project, personal, or plugin)\n\n2. **Choose template** - Select the most appropriate template:\n   - Code-reviewer for code quality checks\n   - Debugger for troubleshooting workflows\n   - Custom for unique specialized needs\n\n3. **Use creation method**:\n   - **Recommended**: `/agents` command for guided setup\n   - **Script**: `scripts/create_subagent.sh <name> --<scope> --template <type>`\n   - **Manual**: Create file in appropriate directory\n\n4. **Customize configuration**:\n   - Update frontmatter (especially description)\n   - Configure tool access if needed\n   - Select appropriate model\n   - Write clear, detailed system prompt\n\n5. **Write effective system prompt**:\n   - Define the subagent's role and expertise\n   - Specify the workflow or process to follow\n   - Include success criteria and best practices\n   - Add examples if helpful\n   - Use imperative/infinitive form (verb-first)\n\n6. **Register plugin subagents** (plugin scope only):\n   - Add subagent to `.claude-plugin/marketplace.json`\n   - In the plugin's entry, add `\"./agents/<agent-name>.md\"` to the `agents` array\n   - The script will remind you of this step\n\n7. **Test and iterate**:\n   - Test automatic invocation with matching tasks\n   - Test explicit invocation: \"Use the X subagent to...\"\n   - Verify tool access works as expected\n   - Adjust description for better delegation\n   - Refine system prompt based on results\n\n## Invocation Patterns\n\n### Automatic Delegation\n\nClaude Code automatically delegates based on:\n\n- Task description matching subagent `description`\n- Context and available tools\n- Current conversation needs\n\n**Tips for better automatic delegation:**\n\n- Use proactive language in description: \"Use PROACTIVELY when...\", \"MUST BE USED for...\"\n- Be specific about trigger conditions\n- Include keywords users are likely to use\n\n### Explicit Invocation\n\nUsers can request subagents directly:\n\n```\n> Use the code-reviewer subagent to check my recent changes\n> Have the debugger subagent investigate this error\n> Ask the data-scientist subagent to analyze user growth\n```\n\n### Chaining Subagents\n\nFor complex workflows:\n\n```\n> First use the code-analyzer subagent to find issues, then use the optimizer subagent to fix them\n```\n\n## Reference Documentation\n\nFor detailed information about subagents, refer to `references/subagents-reference.md`, which contains:\n\n- Complete subagent architecture details\n- File format specification\n- Tool permission system\n- Model selection guide\n- Performance considerations\n- Advanced usage patterns\n- CLI-based subagent configuration\n\nLoad this reference when users need detailed technical information beyond the workflow guidance in this skill.\n\n## Best Practices\n\n- **Focus on single responsibility** - Each subagent should have a clear, specific purpose\n- **Write detailed system prompts** - Include role, process, examples, and constraints\n- **Use proactive descriptions** - Help Claude know when to delegate automatically\n- **Limit tool access appropriately** - Grant only necessary tools for security and focus\n- **Test both invocation types** - Verify automatic and explicit invocation work\n- **Consider context efficiency** - Subagents help preserve main context for longer sessions\n- **Version control project subagents** - Share team workflows via git\n- **Document expected behavior** - Include examples in system prompt when helpful\napproach that best fits the use case. Subagents and skills can work togetherâskills can include instructions for when to delegate to specific subagents.\n",
        "plugins/claude-code-meta/skills/claude-code-subagents/assets/code-reviewer.md": "---\nname: code-reviewer\ndescription: Expert code review specialist. Use PROACTIVELY after writing or modifying code for quality, security, and maintainability review.\ntools: Read, Grep, Glob, Bash(git:*)\nmodel: inherit\n---\n\nYou are a senior code reviewer with expertise in software quality, security, and best practices.\n\n## Role\n\nPerform comprehensive code reviews focusing on:\n\n- Code quality and maintainability\n- Security vulnerabilities and best practices\n- Performance considerations\n- Testing and documentation\n- Design patterns and architecture\n\n## Process\n\nWhen invoked:\n\n1. **Gather context**\n   - Run `git diff` to see recent changes\n   - Run `git status` to identify modified files\n   - Understand the scope and purpose of changes\n\n2. **Review systematically**\n   - Analyze each modified file\n   - Check against review checklist\n   - Identify issues by severity\n   - Note positive patterns worth highlighting\n\n3. **Provide structured feedback**\n   - **Critical issues** (must fix): Security vulnerabilities, bugs, breaking changes\n   - **Warnings** (should fix): Code smells, maintainability issues, missing tests\n   - **Suggestions** (consider improving): Style improvements, optimization opportunities\n\n## Review Checklist\n\n### Code Quality\n\n- [ ] Code is simple, clear, and readable\n- [ ] Functions and variables have descriptive names\n- [ ] No duplicated code or logic\n- [ ] Appropriate use of comments for complex logic\n- [ ] Follows project coding standards\n\n### Security\n\n- [ ] No exposed secrets, API keys, or credentials\n- [ ] Input validation implemented\n- [ ] SQL injection prevention (parameterized queries)\n- [ ] XSS prevention (proper escaping)\n- [ ] Authentication and authorization checks\n- [ ] Sensitive data handling follows best practices\n\n### Error Handling\n\n- [ ] Proper error handling implemented\n- [ ] Errors logged with appropriate context\n- [ ] User-friendly error messages\n- [ ] Edge cases considered\n\n### Testing\n\n- [ ] Good test coverage for new code\n- [ ] Existing tests still pass\n- [ ] Tests are clear and maintainable\n- [ ] Edge cases covered by tests\n\n### Performance\n\n- [ ] No obvious performance bottlenecks\n- [ ] Efficient algorithms and data structures\n- [ ] Database queries optimized\n- [ ] Resource cleanup (files, connections, etc.)\n\n### Documentation\n\n- [ ] Public APIs documented\n- [ ] Complex logic explained\n- [ ] README updated if needed\n- [ ] Breaking changes noted\n\n## Output Format\n\nOrganize feedback clearly:\n\n### Critical Issues â\n\n- [Issue description]\n  - **Location**: `file.js:123`\n  - **Problem**: [What's wrong]\n  - **Impact**: [Why it matters]\n  - **Fix**: [How to resolve]\n\n### Warnings â ï¸\n\n- [Issue description]\n  - **Location**: `file.js:456`\n  - **Concern**: [What could be better]\n  - **Recommendation**: [Suggested improvement]\n\n### Suggestions ð¡\n\n- [Improvement opportunity]\n  - **Location**: `file.js:789`\n  - **Idea**: [Enhancement suggestion]\n\n### Positive Highlights â\n\n- [Good patterns observed]\n\n## Guidelines\n\n- Be constructive and specific\n- Provide examples and alternatives\n- Prioritize issues appropriately\n- Explain the \"why\" behind recommendations\n- Acknowledge good practices when observed\n- Focus on teaching, not just finding faults\n",
        "plugins/claude-code-meta/skills/claude-code-subagents/assets/custom.md": "---\nname: custom-agent\ndescription: [Describe when this subagent should be invoked. Be specific and action-oriented. Use keywords like PROACTIVELY or MUST BE USED if appropriate.]\ntools: Read, Write, Edit, Grep, Glob, Bash\nmodel: inherit\n---\n\n[Define the subagent's role, expertise, and purpose here]\n\n## Role\n\n[Describe what this subagent specializes in and what it should accomplish]\n\n## Process\n\nWhen invoked:\n\n1. **[First step name]**\n   - [Action or consideration]\n   - [Action or consideration]\n\n2. **[Second step name]**\n   - [Action or consideration]\n   - [Action or consideration]\n\n3. **[Third step name]**\n   - [Action or consideration]\n   - [Action or consideration]\n\n[Add more steps as needed]\n\n## Guidelines\n\n- [Key principle or constraint]\n- [Important consideration]\n- [Best practice to follow]\n- [What to avoid]\n\n## Output Format\n\n[Describe how the subagent should structure its responses]\n\n[Optional: Include examples of expected output]\n\n## Best Practices\n\n- [Practice 1]\n- [Practice 2]\n- [Practice 3]\n\n---\n\n## Instructions for Customizing This Template\n\n1. **Update frontmatter**:\n   - Change `name` to a descriptive, hyphenated name (e.g., `api-integration-tester`)\n   - Write a clear `description` explaining when to invoke this subagent\n   - Adjust `tools` list to only necessary tools (or omit to inherit all)\n   - Set `model` if needed (`sonnet`, `opus`, `haiku`, or `inherit`)\n\n2. **Define the role**:\n   - Be specific about the subagent's expertise and purpose\n   - Include the domain, technology, or workflow focus\n   - Set clear expectations for what it can accomplish\n\n3. **Document the process**:\n   - Break down the workflow into clear steps\n   - Use action-oriented language\n   - Include decision points and considerations\n   - Add error handling or edge cases\n\n4. **Establish guidelines**:\n   - Define principles the subagent should follow\n   - List important constraints or requirements\n   - Note what the subagent should avoid\n   - Include best practices specific to this domain\n\n5. **Specify output format**:\n   - Describe how results should be structured\n   - Include templates or examples if helpful\n   - Define what constitutes successful completion\n\n6. **Test and iterate**:\n   - Test with realistic tasks\n   - Refine description for better automatic invocation\n   - Adjust process based on actual usage\n   - Update guidelines as patterns emerge\n\n## Examples of Effective Subagents\n\n### Narrow, Focused Subagents\n\n- Security vulnerability scanner (focused on one concern)\n- API documentation generator (specific output type)\n- Database migration creator (specific workflow)\n\n### Domain-Specific Subagents\n\n- React component builder (framework-specific)\n- AWS infrastructure manager (platform-specific)\n- GraphQL schema designer (technology-specific)\n\n### Workflow-Specific Subagents\n\n- Pre-commit validator (workflow stage)\n- Release note generator (process step)\n- Performance benchmark runner (specific task)\n\nChoose clear boundaries and a single responsibility for best results.\n",
        "plugins/claude-code-meta/skills/claude-code-subagents/assets/debugger.md": "---\nname: debugger\ndescription: Debugging specialist for errors, test failures, and unexpected behavior. Use when encountering issues, bugs, or failures that need root cause analysis.\ntools: Read, Edit, Bash, Grep, Glob\nmodel: inherit\n---\n\nYou are an expert debugger specializing in systematic root cause analysis and issue resolution.\n\n## Role\n\nInvestigate and resolve errors, test failures, and unexpected behavior through:\n\n- Systematic debugging methodology\n- Root cause identification\n- Hypothesis formation and testing\n- Minimal, targeted fixes\n- Prevention recommendations\n\n## Process\n\nWhen invoked:\n\n1. **Capture and understand**\n   - Capture complete error message and stack trace\n   - Identify reproduction steps\n   - Gather relevant context (logs, state, inputs)\n   - Determine when the issue started\n\n2. **Analyze and isolate**\n   - Examine error messages and stack traces\n   - Check recent code changes (`git log`, `git diff`)\n   - Identify the failure location\n   - Narrow down the scope\n\n3. **Form hypotheses**\n   - Develop theories about the root cause\n   - Prioritize hypotheses by likelihood\n   - Consider multiple possibilities\n   - Use evidence to support theories\n\n4. **Test and verify**\n   - Test each hypothesis systematically\n   - Add strategic debug logging if needed\n   - Inspect variable states and data flow\n   - Confirm the actual root cause\n\n5. **Fix and validate**\n   - Implement minimal fix addressing root cause\n   - Avoid fixing symptoms instead of causes\n   - Verify fix resolves the issue\n   - Ensure no regressions introduced\n   - Run relevant tests\n\n6. **Document and prevent**\n   - Explain the root cause\n   - Document the fix\n   - Suggest prevention strategies\n   - Consider adding tests to prevent recurrence\n\n## Debugging Techniques\n\n### Error Analysis\n\n- Read complete error messages carefully\n- Trace stack traces from bottom to top\n- Identify the earliest point of failure\n- Look for error patterns\n\n### Code Investigation\n\n- Review recent commits for related changes\n- Check for similar issues in codebase history\n- Examine surrounding code context\n- Look for edge cases\n\n### Hypothesis Testing\n\n- Add strategic logging statements\n- Use print debugging when appropriate\n- Inspect variable values at key points\n- Test with different inputs\n\n### Isolation\n\n- Reproduce with minimal example\n- Remove unrelated code/dependencies\n- Binary search through changes\n- Identify the exact line causing issues\n\n## Output Format\n\nFor each issue debugged, provide:\n\n### Root Cause Analysis\n\n**Problem**: [Clear description of the issue]\n\n**Root Cause**: [Underlying cause, not just symptoms]\n\n**Evidence**:\n\n- [Supporting evidence 1]\n- [Supporting evidence 2]\n\n### Fix Implementation\n\n**Changes Made**:\n\n```language\n[Code fix with clear before/after or diff]\n```\n\n**Explanation**: [Why this fix addresses the root cause]\n\n### Verification\n\n**Testing Approach**: [How to verify the fix works]\n\n**Results**: [Confirmation that issue is resolved]\n\n### Prevention\n\n**Recommendations**:\n\n- [How to prevent similar issues]\n- [Tests to add]\n- [Process improvements]\n\n## Guidelines\n\n- Focus on root causes, not symptoms\n- Be systematic and methodical\n- Document your reasoning\n- Prefer minimal, targeted fixes\n- Verify fixes don't introduce new issues\n- Consider edge cases and error handling\n- Add tests to prevent regression\n- Explain your findings clearly\n",
        "plugins/claude-code-meta/skills/claude-code-subagents/references/subagents-reference.md": "# Claude Code Subagents Reference\n\nComplete technical reference for Claude Code subagents architecture, configuration, and usage patterns.\n\n## Overview\n\nSubagents are specialized AI assistants in Claude Code that handle specific types of tasks with their own context windows, custom system prompts, and tool configurations. They enable efficient task delegation, context preservation, and domain-specific expertise.\n\n## Architecture\n\n### Context Isolation\n\nEach subagent operates in its own context window, separate from the main conversation:\n\n- **Main conversation**: High-level orchestration and user interaction\n- **Subagent context**: Task-specific work with specialized prompts\n- **Benefits**: Prevents context pollution, enables longer sessions, maintains focus\n\n### Delegation System\n\nClaude Code delegates tasks to subagents based on:\n\n1. **Description matching**: Subagent `description` field matches task requirements\n2. **Tool availability**: Subagent has access to necessary tools\n3. **Explicit requests**: User directly invokes a specific subagent\n4. **Context signals**: Current conversation state and needs\n\n### File Structure\n\nSubagents are stored as Markdown files with YAML frontmatter:\n\n```\nsubagent-name.md\nâââ YAML frontmatter (metadata)\nâ   âââ name: (required)\nâ   âââ description: (required)\nâ   âââ tools: (optional)\nâ   âââ model: (optional)\nâââ Markdown body (system prompt)\n```\n\n## File Locations and Priority\n\n### Priority Order\n\nWhen multiple subagents have the same name, Claude Code uses this priority:\n\n1. **Project subagents**: `.claude/agents/` (highest priority)\n2. **CLI-defined subagents**: `--agents` flag\n3. **User subagents**: `~/.claude/agents/`\n4. **Plugin subagents**: `plugins/<name>/agents/` (lowest priority)\n\n### Project Subagents\n\n**Location**: `.claude/agents/`\n\n**Characteristics**:\n\n- Shared with team via version control\n- Project-specific workflows and conventions\n- Override user-level and plugin subagents\n- Best for team standards and project patterns\n\n**Use cases**:\n\n- Code review standards specific to project\n- Project-specific test runners\n- Domain knowledge for the codebase\n- Team workflow automation\n\n### User Subagents\n\n**Location**: `~/.claude/agents/`\n\n**Characteristics**:\n\n- Available across all projects\n- Personal preferences and workflows\n- Lower priority than project subagents\n- Portable across machines (can sync via dotfiles)\n\n**Use cases**:\n\n- Personal coding style preferences\n- Individual productivity workflows\n- Cross-project utilities\n- Learning and experimentation\n\n### Plugin Subagents\n\n**Location**: `plugins/<plugin-name>/agents/`\n\n**Characteristics**:\n\n- Distributed via plugin marketplaces\n- Reusable across installations\n- Lowest priority (overridden by project/user)\n- Professional/community-maintained\n\n**Use cases**:\n\n- Language-specific tooling (Python linter, Go formatter)\n- Framework-specific workflows (React component builder)\n- Cloud platform integration (AWS deployer, GCP manager)\n- Security scanning and compliance\n\n## Configuration Format\n\n### Complete Example\n\n```yaml\n---\nname: code-reviewer\ndescription: Expert code review specialist. Use PROACTIVELY after writing or modifying code for quality, security, and maintainability review.\ntools: Read, Grep, Glob, Bash(git:*)\nmodel: sonnet\n---\n\nYou are a senior code reviewer with expertise in software quality, security, and best practices.\n\n## Role\n\nPerform comprehensive code reviews focusing on:\n- Code quality and maintainability\n- Security vulnerabilities\n- Performance considerations\n- Best practice adherence\n\n## Process\n\nWhen invoked:\n\n1. **Gather context**\n   - Run `git diff` to see recent changes\n   - Identify modified files\n   - Understand the change scope\n\n2. **Review systematically**\n   - Analyze each modified file\n   - Check against review checklist\n   - Identify issues by severity\n\n3. **Provide feedback**\n   - Critical issues (must fix)\n   - Warnings (should fix)\n   - Suggestions (consider improving)\n\n## Review Checklist\n\n- [ ] Code is simple and readable\n- [ ] Functions and variables are well-named\n- [ ] No duplicated code\n- [ ] Proper error handling\n- [ ] No exposed secrets or credentials\n- [ ] Input validation implemented\n- [ ] Good test coverage\n- [ ] Performance considerations addressed\n\n## Output Format\n\nOrganize feedback by priority with specific examples and fix recommendations.\n```\n\n### Frontmatter Fields\n\n#### name (required)\n\n**Format**: Lowercase alphanumeric with hyphens only\n\n**Examples**:\n\n- â `code-reviewer`\n- â `test-runner-jest`\n- â `data-analyst-sql`\n- â `Code_Reviewer` (uppercase and underscores)\n- â `test.runner` (periods)\n- â `data analyst` (spaces)\n\n**Best practices**:\n\n- Use descriptive, specific names\n- Include technology if relevant: `test-runner-pytest`, `linter-eslint`\n- Avoid generic names: prefer `api-integration-tester` over `tester`\n\n#### description (required)\n\n**Purpose**: Determines when Claude Code delegates to this subagent\n\n**Format**: Natural language description of when the subagent should be invoked\n\n**Best practices**:\n\n1. **Be specific and action-oriented**:\n   - â \"Expert code reviewer. Use PROACTIVELY after writing or modifying code for quality, security, and maintainability review.\"\n   - â \"Reviews code\" (too vague)\n\n2. **Include trigger keywords**:\n   - Use \"PROACTIVELY\" for automatic invocation\n   - Use \"MUST BE USED\" for strong delegation signals\n   - Include task-specific verbs: \"analyze\", \"debug\", \"test\", \"review\"\n\n3. **Specify scope and expertise**:\n   - â \"SQL and BigQuery analysis specialist. Use for data queries, analysis, and insights.\"\n   - â \"Data work\" (unclear scope)\n\n4. **Consider user language**:\n   - Think about how users will phrase requests\n   - Include common synonyms and related terms\n\n**Examples**:\n\n```yaml\n# Code reviewer (proactive)\ndescription: Expert code review specialist. Use PROACTIVELY after writing or modifying code for quality, security, and maintainability review.\n\n# Debugger (on-demand)\ndescription: Debugging specialist for errors, test failures, and unexpected behavior. Use when encountering issues or bugs.\n\n# Data analyst (domain-specific)\ndescription: SQL and BigQuery analysis expert. Use for data queries, analysis, visualization, and insights extraction.\n\n# Test runner (workflow-specific)\ndescription: Test automation specialist. Use PROACTIVELY to run tests, analyze failures, and implement fixes.\n```\n\n#### tools (optional)\n\n**Purpose**: Defines which tools the subagent can use\n\n**Behavior**:\n\n- If **omitted**: Inherits ALL tools from main conversation (including MCP tools)\n- If **specified**: Limited to listed tools only\n\n**Format**: Comma-separated list of tool names\n\n**Tool Categories**:\n\n1. **File operations**:\n   - `Read` - Read files from filesystem (supports images, PDFs, Jupyter notebooks)\n   - `Write` - Create new files (overwrites if exists)\n   - `Edit` - Modify existing files with exact string replacements\n   - `Glob` - Find files by glob pattern (e.g., `**/*.js`)\n   - `Grep` - Search file contents with regex patterns\n\n2. **Code editing**:\n   - `NotebookEdit` - Edit Jupyter notebook cells (insert, delete, replace)\n\n3. **Command execution**:\n   - `Bash` - Execute bash commands in persistent shell\n   - `Bash(git:*)` - Git commands only (e.g., `git status`, `git diff`)\n   - `Bash(npm:*)` - npm commands only (e.g., `npm test`, `npm install`)\n   - `Bash(docker:*)` - Docker commands only\n   - `Bash(pytest:*)` - pytest commands only\n   - `Bash(bq:*)` - BigQuery CLI commands only\n   - `BashOutput` - Retrieve output from background bash shells\n   - `KillBash` - Terminate running background bash shells\n\n4. **Web and search**:\n   - `WebFetch` - Fetch and process web content with AI\n   - `WebSearch` - Search the web for up-to-date information\n\n5. **Task management**:\n   - `TodoWrite` - Create and manage structured task lists\n   - `Task` - Launch specialized subagents for complex tasks\n\n6. **Workflow control**:\n   - `ExitPlanMode` - Exit planning mode and present plan to user\n   - `SlashCommand` - Execute custom slash commands\n\n7. **MCP integration**:\n   - `ListMcpResources` - List available MCP resources\n   - `ReadMcpResource` - Read specific MCP resource content\n   - Plus any MCP tools provided by installed servers (inherited by default)\n\n**Examples**:\n\n```yaml\n# Inherit all tools (most permissive)\n# Omit tools field entirely\n\n# Read-only subagent (safest)\ntools: Read, Grep, Glob\n\n# Code reviewer (git + read)\ntools: Read, Grep, Glob, Bash(git:*)\n\n# Test runner (needs execution)\ntools: Read, Edit, Bash(npm:*), Bash(pytest:*)\n\n# Full development subagent\ntools: Read, Write, Edit, Grep, Glob, Bash\n\n# Data analyst (specific commands)\ntools: Read, Write, Bash(bq:*), Bash(psql:*)\n```\n\n**Security considerations**:\n\n- Limit tools to minimum necessary\n- Use bash patterns to restrict command scope\n- Avoid granting `Write` unless needed\n- Consider read-only for review/analysis subagents\n\n#### model (optional)\n\n**Purpose**: Specifies which model the subagent should use\n\n**Options**:\n\n1. **Model aliases**:\n   - `sonnet` - Claude Sonnet (balanced, default)\n   - `opus` - Claude Opus (most capable)\n   - `haiku` - Claude Haiku (fastest, most efficient)\n\n2. **Special values**:\n   - `inherit` - Use same model as main conversation\n   - Omit field - Defaults to `sonnet`\n\n**Behavior**:\n\n```yaml\n# Use Sonnet (default if omitted)\nmodel: sonnet\n\n# Use Opus for complex tasks\nmodel: opus\n\n# Use Haiku for simple, fast tasks\nmodel: haiku\n\n# Match main conversation model\nmodel: inherit\n```\n\n**When to use each**:\n\n- **`sonnet`** (default): Most subagents, balanced capability and speed\n- **`opus`**: Complex analysis, critical reviews, architecture decisions\n- **`haiku`**: Simple tasks, fast iterations, high-volume operations\n- **`inherit`**: Keep consistency with conversation style and model\n\n### System Prompt (Body)\n\nThe Markdown body after frontmatter defines the subagent's system prompt.\n\n**Structure recommendations**:\n\n1. **Role definition**:\n\n   ```markdown\n   You are a [expertise level] [specialization] with [specific skills].\n   ```\n\n2. **Capabilities and scope**:\n\n   ```markdown\n   ## Role\n\n   Perform [primary task] focusing on:\n   - [capability 1]\n   - [capability 2]\n   - [capability 3]\n   ```\n\n3. **Process and workflow**:\n\n   ```markdown\n   ## Process\n\n   When invoked:\n\n   1. **[Step 1 name]**\n      - Action detail\n      - Action detail\n\n   2. **[Step 2 name]**\n      - Action detail\n   ```\n\n4. **Guidelines and best practices**:\n\n   ```markdown\n   ## Guidelines\n\n   - [Principle 1]\n   - [Principle 2]\n   - [Constraint or requirement]\n   ```\n\n5. **Output format**:\n\n   ```markdown\n   ## Output Format\n\n   Provide results as:\n   - [Format requirement 1]\n   - [Format requirement 2]\n   ```\n\n**Writing style**:\n\n- Use imperative/infinitive form (verb-first)\n- Be specific and actionable\n- Include examples when helpful\n- Define success criteria\n- Specify constraints clearly\n\n## CLI-Based Configuration\n\n### Usage\n\nDefine subagents via `--agents` flag with JSON:\n\n```bash\nclaude --agents '{\n  \"code-reviewer\": {\n    \"description\": \"Expert code reviewer. Use proactively after code changes.\",\n    \"prompt\": \"You are a senior code reviewer focusing on quality, security, and best practices.\",\n    \"tools\": [\"Read\", \"Grep\", \"Glob\", \"Bash(git:*)\"],\n    \"model\": \"sonnet\"\n  },\n  \"debugger\": {\n    \"description\": \"Debugging specialist for errors and failures.\",\n    \"prompt\": \"You are an expert debugger specializing in root cause analysis.\",\n    \"model\": \"inherit\"\n  }\n}'\n```\n\n### Use Cases\n\n1. **Quick testing**: Test subagent configurations before creating files\n2. **Session-specific**: Temporary subagents for one-off tasks\n3. **Automation scripts**: Dynamic subagent generation in CI/CD\n4. **Sharing**: Easy copy-paste of subagent definitions\n\n### Priority\n\nCLI-defined subagents have priority:\n\n- Higher than user-level (`~/.claude/agents/`)\n- Lower than project-level (`.claude/agents/`)\n\n## Plugin Integration\n\n### Plugin Structure\n\n```\nplugins/my-plugin/\nâââ .claude-plugin/\nâ   âââ marketplace.json\nâââ agents/\n    âââ code-reviewer.md\n    âââ test-runner.md\n    âââ debugger.md\n```\n\n### Registration\n\nIn `.claude-plugin/marketplace.json`:\n\n```json\n{\n  \"plugins\": [\n    {\n      \"name\": \"my-plugin\",\n      \"agents\": [\n        \"./agents/code-reviewer.md\",\n        \"./agents/test-runner.md\",\n        \"./agents/debugger.md\"\n      ]\n    }\n  ]\n}\n```\n\n### Plugin Subagent Features\n\n- Full configuration support (tools, model, description)\n- Automatic loading when plugin installed\n- Visible in `/agents` interface\n- Can be overridden by project/user subagents\n- Distributed via marketplace\n\n## Advanced Usage Patterns\n\n### Subagent Chaining\n\nComplex workflows with multiple subagents:\n\n```\n> First use the code-analyzer subagent to find performance issues,\n  then use the optimizer subagent to implement improvements,\n  finally use the test-runner subagent to verify changes\n```\n\n### Conditional Delegation\n\nSubagents with specific triggering conditions:\n\n```yaml\n---\nname: security-scanner\ndescription: Security vulnerability scanner. MUST BE USED before commits touching authentication, authorization, or sensitive data handling.\ntools: Read, Grep, Bash(git:*)\n---\n```\n\n### Specialized Tool Access\n\nSubagents with unique tool combinations:\n\n```yaml\n---\nname: api-integration-tester\ndescription: API testing specialist for integration tests and endpoint validation.\ntools: Read, Write, Bash(curl:*), Bash(jq:*), WebFetch\n---\n```\n\n### Model Optimization\n\nChoose models based on task characteristics:\n\n```yaml\n---\n# Complex architectural review (use Opus)\nname: architect-reviewer\nmodel: opus\n---\n\n---\n# Fast syntax checks (use Haiku)\nname: syntax-checker\nmodel: haiku\n---\n\n---\n# Match conversation style (use inherit)\nname: documentation-writer\nmodel: inherit\n---\n```\n\n## Performance Considerations\n\n### Context Efficiency\n\n**Benefits**:\n\n- Each subagent starts with clean context\n- Main conversation stays focused on high-level tasks\n- Enables longer sessions without context bloat\n\n**Trade-offs**:\n\n- Subagent startup requires context gathering\n- May add latency for context-heavy tasks\n- Doesn't have conversation history\n\n### Latency Optimization\n\n**Reduce latency by**:\n\n- Using `haiku` model for simple tasks\n- Limiting tool access to essentials\n- Including context-gathering in system prompt\n- Batching related subagent calls\n\n**Example**:\n\n```yaml\n---\nname: fast-linter\ndescription: Quick syntax and style checker\ntools: Read, Grep  # Limited tools\nmodel: haiku       # Fast model\n---\n\nRun quick syntax checks without heavy analysis.\nFocus on obvious errors and style violations.\n```\n\n### Cost Optimization\n\n**Reduce costs by**:\n\n- Using appropriate models (haiku for simple tasks)\n- Limiting subagent scope and tools\n- Combining related tasks in single subagent\n- Avoiding unnecessary subagent invocations\n\n## Best Practices\n\n### Design Principles\n\n1. **Single responsibility**: Each subagent should have one clear purpose\n2. **Clear boundaries**: Define exactly when and why to invoke\n3. **Minimal tooling**: Grant only necessary tools\n4. **Explicit process**: Document the subagent's workflow\n5. **Measurable success**: Define what \"done\" looks like\n\n### Description Guidelines\n\n1. **Use action-oriented language**:\n   - â \"Use PROACTIVELY after code changes\"\n   - â \"Can be used for code review\"\n\n2. **Include expertise keywords**:\n   - â \"Expert debugger specializing in root cause analysis\"\n   - â \"Helps with bugs\"\n\n3. **Specify trigger conditions**:\n   - â \"MUST BE USED before commits to main branch\"\n   - â \"Code review tool\"\n\n4. **Think about user intent**:\n   - What words will users use?\n   - What problem are they trying to solve?\n   - When do they need this subagent?\n\n### System Prompt Guidelines\n\n1. **Define expertise clearly**: Set expectations for subagent capabilities\n2. **Provide step-by-step process**: Guide the subagent through tasks\n3. **Include examples**: Show expected behavior and output\n4. **Set constraints**: Define what the subagent should NOT do\n5. **Specify output format**: Help subagent provide consistent results\n\n### Tool Permission Strategy\n\n1. **Start minimal**: Begin with read-only tools\n2. **Add incrementally**: Grant additional tools as needed\n3. **Use patterns**: Restrict bash to specific commands\n4. **Consider security**: Limit destructive operations\n5. **Test thoroughly**: Verify tool access works correctly\n\n## Troubleshooting\n\n### Subagent Not Invoked Automatically\n\n**Possible causes**:\n\n1. Description doesn't match user's task phrasing\n2. Another subagent has higher priority\n3. Required tools not available\n4. Name conflict with higher-priority subagent\n\n**Solutions**:\n\n1. Refine description with trigger keywords\n2. Check `/agents` for conflicts\n3. Verify tool access\n4. Use explicit invocation to test\n\n### Subagent Lacks Necessary Context\n\n**Possible causes**:\n\n1. Subagent context is isolated from main conversation\n2. Context gathering not in system prompt\n3. Missing necessary tools\n\n**Solutions**:\n\n1. Include context-gathering steps in system prompt\n2. Grant tools needed to gather context (e.g., `Bash(git:*)`)\n3. Provide explicit context in invocation\n\n### Tool Permission Errors\n\n**Possible causes**:\n\n1. Tools field too restrictive\n2. Bash pattern doesn't match command\n3. MCP tools not inherited\n\n**Solutions**:\n\n1. Add necessary tools to `tools` field\n2. Adjust bash patterns: `Bash(git:*)` not `Bash(git)`\n3. Omit `tools` field to inherit all tools\n\n## Related Documentation\n\n- [Claude Code Plugins](https://docs.claude.com/en/docs/claude-code/plugins)\n- [Slash Commands](https://docs.claude.com/en/docs/claude-code/slash-commands)\n- [Skills](https://docs.claude.com/en/docs/claude-code/skills)\n- [Hooks](https://docs.claude.com/en/docs/claude-code/hooks)\n- [Settings and Tools](https://docs.claude.com/en/docs/claude-code/settings)\n",
        "plugins/google-docs-reader/.claude-plugin/plugin.json": "{\n  \"name\": \"google-docs-reader\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Read and analyze Google Docs, Sheets, and Slides by exporting them to local formats (DOCX, XLSX, PPTX) via browser download.\",\n  \"author\": {\n    \"name\": \"Em\"\n  },\n  \"license\": \"MIT\"\n}\n",
        "plugins/google-docs-reader/skills/google-docs-reader/SKILL.md": "---\nname: google-docs-reader\ndescription: Read and analyze Google Docs, Sheets, and Slides by exporting them to local formats (DOCX, XLSX, PPTX) via browser download. Use this skill when users request to read, summarize, or analyze content from Google Drive URLs or .gdoc/.gsheet/.gslides files.\n---\n\n# Google Docs Reader\n\n## Overview\n\nRead and analyze Google Workspace documents (Docs, Sheets, Slides) without direct API access. This skill exports Google Drive documents to local formats by opening export URLs in the browser, monitoring the Downloads folder, and moving files to a temporary directory for processing.\n\n## When to Use This Skill\n\nActivate this skill when users ask to:\n\n- Read or summarize Google Docs, Sheets, or Slides\n- Extract content from Google Drive URLs\n- Analyze `.gdoc`, `.gsheet`, or `.gslides` files from Google Drive File Stream/Desktop\n- Process multiple Google Workspace documents\n\n**Example user requests:**\n\n- \"Read this Google Doc and summarize it: <https://docs.google.com/document/d/ABC123/edit>\"\n- \"What's in this spreadsheet?\" (pointing to a `.gsheet` file)\n- \"Analyze the data in this Google Sheets URL\"\n- \"Convert this Google Slides to markdown\"\n\n## How It Works\n\nThe skill uses a browser-based export workflow:\n\n1. **Extract document ID** from URL or `.gdoc`/`.gsheet`/`.gslides` file\n2. **Determine document type** (Docs, Sheets, or Slides)\n3. **Build export URL** with appropriate format (DOCX, XLSX, PPTX)\n4. **Open URL in browser** (leverages existing Google account session)\n5. **Monitor Downloads folder** for the downloaded file\n6. **Move to temp directory** (`/tmp/gdoc_exports/`)\n7. **Process with document skills** (docx, xlsx, pptx skills)\n8. **Clean up** temporary file after reading\n\n## Export Formats\n\n- **Google Docs** â DOCX (Microsoft Word format)\n- **Google Sheets** â XLSX (Microsoft Excel format)\n- **Google Slides** â PPTX (Microsoft PowerPoint format)\n\n## Reading Google Docs\n\n### Complete Workflow (Export + Read)\n\nThe simplest approach is to use both scripts together:\n\n```bash\n# 1. Export the Google Doc\nEXPORTED=$(python3 ${CLAUDE_PLUGIN_ROOT}/skills/google-docs-reader/scripts/export_gdoc.py \"<google-drive-url-or-file>\")\n\n# 2. Read the exported file\npython3 ${CLAUDE_PLUGIN_ROOT}/skills/google-docs-reader/scripts/read_exported_doc.py \"$EXPORTED\"\n```\n\n### Step-by-Step Workflow\n\n#### Step 1: Export\n\nRun the export script with your Google Docs URL or file:\n\n```bash\npython3 ${CLAUDE_PLUGIN_ROOT}/skills/google-docs-reader/scripts/export_gdoc.py <input>\n```\n\nWhere `<input>` can be:\n\n- Google Drive URL (e.g., `https://docs.google.com/document/d/ABC123/edit`)\n- Path to `.gdoc`, `.gsheet`, or `.gslides` file\n- Raw document ID (assumes Google Docs type)\n\nThe script will:\n\n- Open the export URL in the default browser\n- Wait up to 30 seconds for download to complete\n- Move file to `/tmp/gdoc_exports/{DOC_ID}.{extension}`\n- Print the output file path\n\n#### Step 2: Read\n\nRead the exported file using the integrated reading script:\n\n```bash\npython3 ${CLAUDE_PLUGIN_ROOT}/skills/google-docs-reader/scripts/read_exported_doc.py <exported-file>\n```\n\nThis automatically uses the appropriate tool based on file type:\n\n- **DOCX** â pandoc (markdown conversion)\n- **XLSX** â pandas (data analysis with preview, statistics)\n- **PPTX** â pandoc (text/markdown extraction)\n\n### Example Usage\n\n**Reading a Google Doc:**\n\n```bash\n# Export\npython3 scripts/export_gdoc.py \"https://docs.google.com/document/d/1abc.../edit\"\n# Output: /tmp/gdoc_exports/1abc...docx\n\n# Read as markdown\npython3 scripts/read_exported_doc.py /tmp/gdoc_exports/1abc...docx\n```\n\n**Reading a Google Sheet:**\n\n```bash\n# Export\npython3 scripts/export_gdoc.py \"https://docs.google.com/spreadsheets/d/1xyz.../edit\"\n# Output: /tmp/gdoc_exports/1xyz...xlsx\n\n# Read with data analysis\npython3 scripts/read_exported_doc.py /tmp/gdoc_exports/1xyz...xlsx\n# Shows: sheet names, dimensions, columns, preview, statistics\n```\n\n**Reading a Google Slides:**\n\n```bash\n# Export\npython3 scripts/export_gdoc.py \"https://docs.google.com/presentation/d/1def.../edit\"\n# Output: /tmp/gdoc_exports/1def...pptx\n\n# Read as markdown\npython3 scripts/read_exported_doc.py /tmp/gdoc_exports/1def...pptx\n```\n\n### Script Options\n\n```bash\npython3 scripts/export_gdoc.py <input> [options]\n\nOptions:\n  -o, --output-dir DIR    Output directory (default: /tmp/gdoc_exports)\n  -t, --timeout SECONDS   Download timeout (default: 30)\n  -h, --help              Show help message\n```\n\n## Processing Exported Files\n\nAfter export, use the appropriate tool to read content:\n\n### Google Docs (DOCX)\n\n- **Activate docx skill** if available\n- **Use pandoc** for markdown conversion: `pandoc file.docx -t markdown`\n- **Read directly** with document processing tools\n\n### Google Sheets (XLSX)\n\n- **Activate xlsx skill** if available for data analysis\n- **Use pandas** for programmatic access\n- **Convert to CSV** for simple text processing\n\n### Google Slides (PPTX)\n\n- **Activate pptx skill** if available\n- **Use pandoc** for text extraction: `pandoc file.pptx -t markdown`\n- **Extract speaker notes** with PowerPoint libraries\n\n## Authentication Requirements\n\n**Important:** This skill requires the user to be logged into Google in their default browser. The browser-based export method uses existing session cookies, avoiding the need for API credentials or OAuth flows.\n\nIf exports fail with authentication errors, ask the user to:\n\n1. Open the browser and log into the Google account\n2. Verify the account has access to the document\n3. Try the export again\n\n## Cleanup\n\nExported files are stored in `/tmp/gdoc_exports/` by default. This directory can be cleaned up manually or automatically:\n\n```bash\n# Remove all exported files\nrm -rf /tmp/gdoc_exports/\n\n# Remove specific file after processing\nrm /tmp/gdoc_exports/{DOC_ID}.docx\n```\n\n## Troubleshooting\n\n### Download timeout\n\nIf downloads take longer than 30 seconds:\n\n```bash\npython3 scripts/export_gdoc.py <input> --timeout 60\n```\n\n### File not found in Downloads\n\n- Check that browser is set to download files to `~/Downloads`\n- Verify no \"Save As\" dialog is blocking the download\n- Ensure sufficient disk space\n\n### Authentication errors\n\n- Log into Google account in the browser\n- Verify document sharing permissions\n- Try opening the document URL manually first\n\n## Dependencies\n\nThe reading functionality requires these tools:\n\n- **pandoc**: For reading DOCX and PPTX files\n\n  ```bash\n  brew install pandoc  # macOS\n  ```\n\n- **pandas + openpyxl**: For reading XLSX files\n\n  ```bash\n  pip3 install pandas openpyxl\n  ```\n\nThese dependencies are only needed for the reading step, not for export.\n\n## Resources\n\n### scripts/export_gdoc.py\n\nPython script that handles the complete export workflow:\n\n- Parses Google Drive URLs and `.gdoc` files\n- Extracts document IDs and determines document types\n- Builds and opens export URLs\n- Monitors Downloads folder\n- Moves files to temp directory\n\nExecute directly or import as a module for custom workflows.\n\n### scripts/read_exported_doc.py\n\nPython script that reads exported files using appropriate tools:\n\n- **DOCX files**: Converts to markdown using pandoc\n- **XLSX files**: Analyzes with pandas (shows preview, statistics, sheet info)\n- **PPTX files**: Extracts text using pandoc\n\nSupports multiple output formats:\n\n- DOCX: `markdown` (default), `plain`, `json`\n- XLSX: `summary` (default), `csv`, `json`\n- PPTX: `markdown` (default), `plain`, `json`\n\nUsage:\n\n```bash\npython3 scripts/read_exported_doc.py <file> [--format <format>] [--output <file>]\n```\n\n### references/export_formats.md\n\nDetailed reference on:\n\n- Available export formats for each Google Workspace type\n- URL patterns and format parameters\n- Quality trade-offs between formats\n- Document ID extraction methods\n- Authentication requirements\n\nLoad this file when users ask about format options or need deeper understanding of export mechanisms.\n",
        "plugins/google-docs-reader/skills/google-docs-reader/references/export_formats.md": "# Google Workspace Export Formats\n\n## Supported Document Types\n\n### Google Docs\n\n- **Best format**: DOCX (Microsoft Word)\n- **Alternative formats**: PDF, RTF, ODT, TXT, HTML, EPUB\n- **URL pattern**: `https://docs.google.com/document/d/{DOC_ID}/export?format=docx`\n\n### Google Sheets\n\n- **Best format**: XLSX (Microsoft Excel)\n- **Alternative formats**: PDF, CSV (first sheet only), TSV, ODS, HTML, ZIP (entire workbook as HTML)\n- **URL pattern**: `https://docs.google.com/spreadsheets/d/{DOC_ID}/export?format=xlsx`\n- **CSV export specific sheet**: Add `&gid={SHEET_ID}` for specific sheet\n\n### Google Slides\n\n- **Best format**: PPTX (Microsoft PowerPoint)\n- **Alternative formats**: PDF, ODP, TXT (speaker notes), SVG (individual slides)\n- **URL pattern**: `https://docs.google.com/presentation/d/{DOC_ID}/export/pptx`\n- **Note**: Slides use `/export/pptx` instead of `?format=pptx`\n\n## File Naming\n\nDownloaded files use Google's default naming:\n\n- **Google Docs**: `{Document Title}.docx`\n- **Google Sheets**: `{Spreadsheet Title}.xlsx`\n- **Google Slides**: `{Presentation Title}.pptx`\n\nThe export script renames files to `{DOC_ID}{extension}` for deterministic handling.\n\n## Document ID Extraction\n\n### From URLs\n\n- Standard edit URL: `https://docs.google.com/document/d/{DOC_ID}/edit`\n- Published URL: `https://docs.google.com/document/d/{DOC_ID}/pub`\n- Preview URL: `https://docs.google.com/document/d/{DOC_ID}/preview`\n\nThe document ID is the alphanumeric string between `/d/` and the next `/`.\n\n### From .gdoc/.gsheet/.gslides Files\n\nThese files are JSON with the format:\n\n```json\n{\n  \"\": \"WARNING! DO NOT EDIT THIS FILE! ANY CHANGES MADE WILL BE LOST!\",\n  \"doc_id\": \"ACTUAL_DOCUMENT_ID_HERE\",\n  \"resource_key\": \"\",\n  \"email\": \"user@gmail.com\"\n}\n```\n\nExtract the `doc_id` field.\n",
        "plugins/mermaid-diagram-to-image/skills/mermaid-diagram-to-image/SKILL.md": "---\nname: mermaid-diagram-to-image\ndescription: Convert Mermaid diagrams to images (PNG, SVG, PDF) using mermaid-cli. This skill should be used when Claude generates Mermaid diagram syntax and wants to create a visual representation for the user, or when converting existing Mermaid diagrams to image formats.\n---\n\n# Mermaid Diagram to Image\n\nConvert Mermaid diagrams to high-quality images in PNG, SVG, or PDF formats using the mermaid-cli tool.\n\n## When to Use This Skill\n\nActivate this skill when:\n\n- Generating Mermaid diagram syntax and wanting to provide a visual representation to the user\n- Converting existing Mermaid diagrams (from files or discussion context) to image formats\n- User requests diagram visualization in a specific format (PNG for embedding, SVG for web, PDF for print)\n\n## Quick Start\n\nTo convert a Mermaid diagram to an image:\n\n1. **Identify the source** - Determine if working with diagram content, a file path, or inline Mermaid syntax\n2. **Create temporary file if needed** - Use `mktemp -t mermaid-XXXXXX.mmd` for inline content\n3. **Run conversion** - Execute mmdc with appropriate flags (input, output, dimensions, theme)\n4. **Clean up** - Use `rm -f /path/to/temp.mmd` to remove temporary file\n5. **Report results** - Confirm successful conversion with output filename\n\n## Conversion Workflow\n\n### Step 1: Parse Input\n\nDetermine the source of the Mermaid diagram:\n\n- **Diagram content in context** - Mermaid syntax recently generated or discussed\n- **File path** - User provides a path to a `.mmd` or `.md` file\n- **Inline Mermaid content** - Raw Mermaid syntax provided by user\n- **Format preferences** - User specifies output format (PNG, SVG, PDF) and options\n\n### Step 2: Set Up Variables\n\nEstablish conversion parameters with sensible defaults:\n\n**Output Format**\n\n- Default: `png`\n- Options: `png`, `svg`, `pdf`\n\n**Output Filename**\n\n- Default pattern: `mermaid-diagram-{SHORT_DESCRIPTIVE_NAME}`\n- Example: `mermaid-diagram-flowchart.png`, `mermaid-diagram-sequence.svg`\n- Base name on diagram type or content context\n\n**Default Image Settings (High Resolution)**\n\n- Width: `1600` pixels\n- Height: `1200` pixels\n- Scale: `2` (for crisp rendering)\n\n**Optional Parameters**\n\n- Theme: `default`, `forest`, `dark`, `neutral`\n- Background color: hex code or named color (e.g., `transparent`, `white`, `#f0f0f0`)\n- PDF fit: `-f` flag for PDF output\n\n### Step 3: Handle Input\n\n**If file path provided:**\n\n- Verify file exists using Read or Glob tools\n- Confirm file extension is `.mmd` or `.md`\n- Use file path directly in mmdc command\n\n**If Mermaid content provided:**\n\n- Create temporary file: `TEMP_FILE=$(mktemp -t mermaid-XXXXXX.mmd)`\n- Write diagram content to file using heredoc or echo\n- Store temp file path for cleanup after conversion\n\nExample:\n\n```bash\nTEMP_FILE=$(mktemp -t mermaid-XXXXXX.mmd)\ncat > \"$TEMP_FILE\" << 'EOF'\ngraph TD\n    A[Start] --> B[Process]\n    B --> C[End]\nEOF\n```\n\n### Step 4: Construct mmdc Command\n\nBuild the mermaid-cli command with appropriate flags:\n\n**Required Flags**\n\n- `-i <input-file>` - Input file (temp file or user-provided file)\n- `-o <output-file>` - Output file with appropriate extension\n\n**High Resolution Flags**\n\n- `-w 1600` - Width in pixels (default for quality output)\n- `-H 1200` - Height in pixels (default for quality output)\n- `-s 2` - Scale factor (2x for high resolution)\n\n**Optional Flags**\n\n- `-t <theme>` - Theme selection (`default`, `forest`, `dark`, `neutral`)\n- `-b <color>` - Background color (hex or named)\n- `-f` - Fit to page (PDF output only)\n\n**Example Commands**\n\nPNG conversion (default):\n\n```bash\nmmdc -i diagram.mmd -o output.png -w 1600 -H 1200 -s 2\n```\n\nSVG with dark theme:\n\n```bash\nmmdc -i diagram.mmd -o output.svg -t dark -b transparent\n```\n\nPDF with fit:\n\n```bash\nmmdc -i diagram.mmd -o output.pdf -f -w 1600 -H 1200\n```\n\n### Step 5: Execute and Clean Up\n\n**Execution**\n\n1. Run the constructed mmdc command using Bash tool\n2. Capture output and error messages\n3. Check exit code for success\n\n**Cleanup** (if temporary file created)\n\n1. Remove temporary file: `rm -f \"$TEMP_FILE\"`\n2. Verify file is in temp directory (e.g., `/tmp/` or `/var/folders/`) before deletion\n3. Use `-f` flag to avoid errors if file doesn't exist\n\n**Verification**\n\n1. Confirm output file was created\n2. Report success with output filename and location\n3. If applicable, note image specifications (format, dimensions)\n\n### Step 6: Report Results\n\nProvide clear feedback to user:\n\n**Success Message Template**\n\n```\nSuccessfully converted Mermaid diagram to {format}.\nOutput: {filename}\nDimensions: {width}x{height}\nTheme: {theme}\n```\n\n**Error Handling**\n\n- If mmdc fails, report error message from stderr\n- Common issues: invalid Mermaid syntax, missing dependencies, file permissions\n- Suggest fixes: validate syntax, check mmdc installation, verify write permissions\n\n## Default Settings\n\nApply these defaults for high-quality output:\n\n- **Format:** PNG\n- **Width:** 1600 pixels\n- **Height:** 1200 pixels\n- **Scale:** 2 (for crisp rendering)\n- **Theme:** default\n- **Filename pattern:** `mermaid-diagram-{descriptive-name}`\n\nOverride defaults based on user requirements or diagram characteristics.\n\n## Common Scenarios\n\n**Scenario 1: Generate and visualize**\n\n1. Generate Mermaid diagram syntax based on user request\n2. Create temporary file using `mktemp -t mermaid-XXXXXX.mmd`\n3. Write diagram content to temporary file\n4. Convert to PNG with default high-resolution settings\n5. Present image to user\n6. Clean up temporary file with `rm -f`\n\n**Scenario 2: Convert existing file**\n\n1. User provides file path to `.mmd` or `.md` file\n2. Verify file exists and read content\n3. Convert directly using file path\n4. Output image file in same directory or user-specified location\n\n**Scenario 3: Custom format and styling**\n\n1. User requests SVG with dark theme and transparent background\n2. Parse requirements\n3. Construct mmdc command with theme and background flags\n4. Execute conversion\n5. Confirm output meets specifications\n\n## Theme Options\n\nAvailable themes for customization:\n\n- `default` - Standard blue/gray Mermaid theme\n- `forest` - Green-themed palette\n- `dark` - Dark background with light text\n- `neutral` - Neutral gray tones\n\nApply theme with `-t` flag: `mmdc -i input.mmd -o output.png -t dark`\n\n## Mermaid Syntax Recognition\n\nRecognize Mermaid diagrams by these starting keywords:\n\n- `graph` or `flowchart` - Flowchart diagrams\n- `sequenceDiagram` - Sequence diagrams\n- `classDiagram` - Class diagrams\n- `stateDiagram` - State diagrams\n- `erDiagram` - Entity relationship diagrams\n- `gantt` - Gantt charts\n- `pie` - Pie charts\n- `journey` - User journey diagrams\n- `gitGraph` - Git graphs\n- `mindmap` - Mind maps\n- `timeline` - Timeline diagrams\n\n## Troubleshooting\n\n**mmdc command not found:**\n\n- Verify mermaid-cli is installed: `npm list -g @mermaid-js/mermaid-cli`\n- Install if missing: `npm install -g @mermaid-js/mermaid-cli`\n\n**Syntax errors in diagram:**\n\n- Validate Mermaid syntax at <https://mermaid.live>\n- Check for missing spaces, invalid keywords, or malformed connections\n- Review Mermaid documentation for diagram-specific syntax\n\n**Output file not created:**\n\n- Verify write permissions in output directory\n- Check disk space availability\n- Ensure output path is valid\n\n**Image quality issues:**\n\n- Increase width/height for larger diagrams\n- Adjust scale factor (try 3 for extra high resolution)\n- Use SVG format for lossless scaling\n\n## Best Practices\n\n1. **Proactive conversion** - When generating Mermaid diagrams, automatically convert to images for better user experience\n2. **Format selection** - Choose PNG for general use, SVG for web/scaling needs, PDF for documents\n3. **High resolution** - Use default high-resolution settings (1600x1200, scale 2) for quality output\n4. **Descriptive naming** - Name output files based on diagram type or content for easy identification\n5. **Cleanup** - Always clean up temporary files after successful conversion\n6. **Error reporting** - Provide clear error messages with actionable troubleshooting steps\n",
        "plugins/nano-banana-image-editor/commands/image.md": "---\ndescription: Create or edit images with natural language prompts\nargument-hint: [your image request]\nallowed-tools: Read, Skill\n---\n\n# Image Generation/Editing Command\n\nActivate the nano-banana-image-editor skill to handle this image request.\n\n## Instructions\n\n1. **Activate the skill**: Use the `nano-banana-image-editor` skill\n2. **Read the prompting guide**: Load `references/prompting_guide.md` to understand how to craft effective prompts for Gemini 3 Pro Image\n3. **Translate the request**: Convert the user's natural language request into an optimized prompt following the guidelines in the prompting guide\n4. **Execute**: Use the appropriate script from the skill to generate or edit the image\n\n## User Request\n\n$ARGUMENTS\n",
        "plugins/nano-banana-image-editor/commands/upgrade.md": "---\ndescription: Upgrade the nano-banana-image-editor plugin to the latest version from the marketplace repository\ntools: Bash, AskUserQuestion\n---\n\n# Nano Banana Image Editor Plugin Upgrade\n\nYou are running the nano-banana-image-editor upgrade command to update the plugin to the latest version.\n\n## Your Task\n\nGuide the user through upgrading the nano-banana-image-editor plugin by pulling the latest changes from the marketplace repository.\n\n## Workflow\n\n### Step 1: Verify Current Installation\n\nCheck the current version and installation location:\n\n```bash\n# Get marketplace directory\nMARKETPLACE_DIR=$(dirname $(dirname ${CLAUDE_PLUGIN_ROOT}))\n\n# Get current version from marketplace.json\nCURRENT_VERSION=$(jq -r '.plugins[] | select(.name==\"nano-banana-image-editor\") | .version' \"$MARKETPLACE_DIR/.claude-plugin/marketplace.json\")\n\n# Verify git repository\ncd \"$MARKETPLACE_DIR\" && git rev-parse --git-dir >/dev/null 2>&1 && echo \"â Git repository found\" || echo \"â Not a git repository\"\n```\n\n**Output to user:**\n\n```\nCurrent version: [version]\nMarketplace directory: [path]\n```\n\n### Step 2: Check for Updates\n\nFetch the latest tags and check for updates:\n\n```bash\ncd \"$MARKETPLACE_DIR\"\ngit fetch --tags origin\n```\n\nThen get the version information:\n\n```bash\n# Get the latest version tag for this plugin\nLATEST_TAG=$(git tag -l 'nano-banana-image-editor/v*' --sort=-v:refname | head -n 1)\n\n# Get current tag (if on a tag)\nCURRENT_TAG=$(git describe --tags --exact-match 2>/dev/null || echo \"none\")\n\n# Filter to only nano-banana-image-editor tags if we're on a tag\nif [ \"$CURRENT_TAG\" != \"none\" ]; then\n  echo \"$CURRENT_TAG\" | grep -q '^nano-banana-image-editor/' || CURRENT_TAG=\"none\"\nfi\n\necho \"Latest tag: $LATEST_TAG\"\necho \"Current tag: $CURRENT_TAG\"\n```\n\n**Analyze the output:**\n\n- If `LATEST_TAG` is empty â No tagged releases available yet\n- If `CURRENT_TAG` equals `LATEST_TAG` â Already on latest version\n- If `LATEST_TAG` is newer â Continue to Step 3\n- If git fetch fails â Inform user there's a connection issue\n\n**Output to user:**\n\n```\nCurrent version: [CURRENT_VERSION] (tag: [CURRENT_TAG or \"not on a tagged release\"])\nLatest available: [LATEST_TAG]\n```\n\n### Step 3: Show Release Notes\n\nIf updates are available, show what's changed by reading the CHANGELOG:\n\n```bash\ncd \"$MARKETPLACE_DIR\" && git show \"$LATEST_TAG:plugins/nano-banana-image-editor/CHANGELOG.md\" | head -50\n```\n\n**Present the release notes** to the user, focusing on the latest version's changes.\n\n### Step 4: Confirm Upgrade\n\nUse the **AskUserQuestion** tool to ask:\n\n- **Question**: \"Ready to upgrade nano-banana-image-editor to the latest version?\"\n- **Options**:\n  - \"Yes, upgrade now\" (description: \"Pull latest changes from the repository\")\n  - \"No, not now\" (description: \"Keep current version\")\n\nIf user selects \"No, not now\":\n\n- Output: \"Upgrade cancelled. Your current version remains unchanged.\"\n- Exit the command\n\n### Step 5: Perform Upgrade\n\nIf user confirms, checkout the latest tagged release:\n\n```bash\ncd \"$MARKETPLACE_DIR\" && git checkout \"$LATEST_TAG\"\n```\n\n**Check the exit code:**\n\n- Exit code 0 â Success, continue to Step 6\n- Exit code != 0 â Error occurred, show user the error message and stop\n\n**Note:** This checks out the specific tagged release ensuring you get a stable, tested version.\n\n### Step 6: Rebuild Plugin Dependencies\n\nAfter pulling changes, reinstall Python dependencies:\n\n```bash\ncd ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor && bash scripts/install_dependencies.sh\n```\n\n**Monitor for errors:**\n\n- If successful â Continue to Step 7\n- If errors occur â Show errors to user and explain that manual intervention may be needed\n\n### Step 7: Verify New Version\n\nCheck the updated version:\n\n```bash\nNEW_VERSION=$(jq -r '.plugins[] | select(.name==\"nano-banana-image-editor\") | .version' \"$MARKETPLACE_DIR/.claude-plugin/marketplace.json\")\n```\n\n### Step 8: Success Message & Restart Prompt\n\n**Output to user:**\n\n```\nâ Nano Banana Image Editor upgraded successfully!\n\nPrevious version: [old version]\nCurrent version: [new version]\n\nâ ï¸  Important: You must restart Claude Code to apply the changes.\n\nTo restart:\n1. Close this conversation\n2. Restart Claude Code\n3. Start a new session\n\nAfter restarting, you can verify the upgrade by running:\n/nano-banana-image-editor:image test\n```\n\n## Error Handling\n\n### Git Repository Not Found\n\nIf the marketplace directory is not a git repository:\n\n```\nâ Upgrade failed: nano-banana-image-editor marketplace is not a git repository.\n\nThis can happen if the plugin was installed differently. To upgrade manually:\n\n1. Navigate to: [marketplace directory]\n2. Run: git fetch --tags origin\n3. List tags: git tag -l 'nano-banana-image-editor/v*' --sort=-v:refname\n4. Checkout latest: git checkout <latest-version-tag>\n5. Navigate to: [plugin directory]/skills/nano-banana-image-editor\n6. Run: bash scripts/install_dependencies.sh\n7. Restart Claude Code\n\nIf you continue to have issues, try reinstalling the plugin:\n/plugin marketplace remove emdashcodes-claude-code-plugins\n/plugin marketplace add emdashcodes/claude-code-plugins\n/plugin install nano-banana-image-editor@emdashcodes-claude-code-plugins\n```\n\n### Network/Connection Errors\n\nIf git fetch/pull fails due to network issues:\n\n```\nâ Upgrade failed: Unable to connect to repository.\n\nPlease check your network connection and GitHub access.\n\nTo upgrade manually:\ncd [marketplace directory]\ngit fetch --tags origin\ngit tag -l 'nano-banana-image-editor/v*' --sort=-v:refname  # List versions\ngit checkout <latest-version-tag>\ncd [plugin directory]/skills/nano-banana-image-editor\nbash scripts/install_dependencies.sh\n\nThen restart Claude Code.\n```\n\n### Build Errors\n\nIf dependency installation fails:\n\n```\nâ Upgrade completed but dependency installation failed.\n\nThe latest code was pulled, but there were errors during Python dependency installation.\nYou may need to troubleshoot manually.\n\nError details:\n[show error output]\n\nTo retry manually:\ncd [plugin directory]/skills/nano-banana-image-editor\nbash scripts/install_dependencies.sh\n\nIf issues persist, report at: https://github.com/emdashcodes/claude-code-plugins/issues\n```\n\n## Important Notes\n\n- This command upgrades to the latest **tagged release** (stable, tested versions)\n- Uses plugin-prefixed semantic versioning tags (e.g., `nano-banana-image-editor/v1.0.0`, `nano-banana-image-editor/v1.1.0`)\n- Your configuration file (`.nano-banana-config.json`) will not be affected\n- A restart of Claude Code is **required** for changes to take effect\n- The upgrade process does not modify your existing Gemini API token or settings\n",
        "plugins/nano-banana-image-editor/skills/nano-banana-image-editor/SKILL.md": "---\nname: nano-banana-image-editor\ndescription: Edit and manipulate images using natural language prompts. Use this skill when users request image creation (photos, illustrations, icons, infographics) or editing tasks (removing objects, changing backgrounds, text overlays, cropping). Supports reference images for character consistency and style transfer. Supports Google Search grounding for real-time factual content (weather, sports, scientific data) - no need to search separately when creating infographics or factual visualizations.\n---\n\n# Image Editor\n\nThis skill enables AI-powered image editing and creation using **Google's Gemini 3 Pro Image** model (nicknamed \"Nano Banana Pro\"). It allows editing existing images or creating new images from scratch through natural language instructions.\n\n## When to Use This Skill\n\nUse this skill when users request:\n\n- Generate icons, images, and illustrations\n- Removing text, logos, or watermarks from images\n- Removing speaker overlays or video conference windows from slides\n- Changing backgrounds, objects, or colors\n- Cropping, resizing, or adjusting image composition\n- Adding or modifying visual elements\n- Style transfers or artistic transformations\n- Any image manipulation describable in natural language\n\n## Prerequisites\n\nIf needed, run the following script to install dependencies:\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/install_dependencies.sh\n```\n\nThis creates a Python virtual environment and installs the required packages (google-genai, Pillow).\n\n**Virtual environment location:**\n- Default: `${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv/`\n- Override: Set `NANO_BANANA_VENV` env var for multi-platform support (e.g., Docker containers)\n\n**API Key Setup:**\n\n1. Get an API key from [Google AI Studio](https://aistudio.google.com/app/apikey)\n2. **Run the setup script** to save the key to the plugin config:\n\n   ```bash\n   ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv/bin/${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/setup-gemini-token.py YOUR_API_KEY\n   ```\n\n   The script will:\n   - Test the API key to verify it works\n   - Save it to `.nano-banana-config.json` in the plugin directory\n   - Confirm that Gemini 3 Pro Image model is available\n\nAll script examples below use `${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3` to ensure the venv's Python interpreter is used.\n\n## How to Use\n\n### Creating New Images from Scratch\n\nUse the `create_image.py` script to generate new images from natural language prompts:\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  OUTPUT_IMAGE \"creation instruction\" --resolution 1K --aspect-ratio 1:1\n```\n\n**Example: Create an icon**\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  cat-icon.png \"A playful orange tabby cat icon, simple and clean design\" \\\n  --resolution 1K --aspect-ratio 1:1\n```\n\n**Example: Create a high-resolution illustration**\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  sunset.png \"A vibrant sunset over mountains with purple and orange sky\" \\\n  --resolution 4K --aspect-ratio 16:9\n```\n\n**Example: Create with reference images for style**\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  landscape.png \"A mountain landscape in this artistic style\" \\\n  --reference style.png --resolution 2K --aspect-ratio 3:2\n```\n\n**Prompting Tips:**\n\n- Be specific about colors, style, and composition\n- Specify the desired mood or atmosphere\n- Use reference images to demonstrate desired style or composition\n- **Important**: See `references/prompting_guide.md` for comprehensive prompting strategies\n\n### Editing Existing Images\n\nUse the `edit_image.py` script to edit existing images with natural language prompts:\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/edit_image.py \\\n  INPUT_IMAGE OUTPUT_IMAGE \"editing instruction\" --resolution 1K --aspect-ratio 1:1\n```\n\n**Example: Remove text overlay**\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/edit_image.py \\\n  slide.png slide-cleaned.png \\\n  \"Remove the text labels from the top of this diagram\"\n```\n\n**Example: Background removal with high resolution**\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/edit_image.py \\\n  photo.jpg photo-no-bg.png \\\n  \"Remove the background and make it transparent white\" \\\n  --resolution 2K --aspect-ratio 4:3\n```\n\n**Example: Style transfer with reference image**\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/edit_image.py \\\n  photo.jpg artistic.png \\\n  \"Apply the artistic style from the reference to this photo\" \\\n  --reference style.png --resolution 2K\n```\n\n### Advanced Multi-Image Features\n\n#### Recreating Templates with Different Characters\n\n**Important**: When recreating memes, comics, or templates with different characters, **always pass both the template AND the character references**.\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  output.png \"Recreate this meme template using these characters\" \\\n  --reference template.png --reference character1.png --reference character2.png \\\n  --resolution 2K --aspect-ratio 16:9\n```\n\n**Why both?**\n\n- The **template/meme reference** provides the composition, layout, poses, and panel structure\n- The **character references** provide facial features, hairstyles, and distinctive characteristics to maintain\n\n**Example: Recreating a two-panel comic meme**\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  my-meme.png \"Recreate this two-panel comic using these two women as the characters. Maintain the exact composition and poses from the template.\" \\\n  --reference original-meme.png --reference my-characters.png \\\n  --resolution 2K --aspect-ratio 16:9\n```\n\n#### Character Consistency (Up to 5 People)\n\nCreate group photos maintaining facial resemblance:\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  group.png \"Office group photo of these people making funny faces\" \\\n  --reference person1.png --reference person2.png --reference person3.png \\\n  --resolution 2K --aspect-ratio 5:4\n```\n\n#### Object Composition (Up to 6 Objects)\n\nBlend multiple objects with high fidelity:\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  product.png \"Product showcase featuring these items on a marble surface\" \\\n  --reference item1.png --reference item2.png --reference item3.png \\\n  --resolution 4K --aspect-ratio 16:9\n```\n\n#### Advanced Editing with References\n\nEdit an image while using additional references:\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/edit_image.py \\\n  background.jpg composite.png \\\n  \"Add these people to the scene, natural lighting\" \\\n  --reference person1.png --reference person2.png \\\n  --resolution 2K\n```\n\n### Google Search Grounding\n\nEnable real-time information for factual content:\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  weather.png \"An infographic about today's weather in San Francisco\" \\\n  --search --resolution 2K --aspect-ratio 3:4\n```\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  plant-guide.png \"Create an educational infographic about String of Turtles houseplant care\" \\\n  --search --resolution 2K --aspect-ratio 3:4\n```\n\n**When to use `--search`:**\n\n- Weather visualizations and forecasts\n- Current events and news graphics\n- Scientific diagrams requiring factual accuracy\n- Educational infographics about real-world subjects\n- Sports statistics and data visualizations\n\n### Resolution and Aspect Ratio Selection\n\n**Resolution Options:**\n\n- `1K` (default) - Fast, good for iteration and testing (1024Ã1024 at 1:1)\n- `2K` - Professional quality (2048Ã2048 at 1:1)\n- `4K` - Maximum quality, studio-grade (4096Ã4096 at 1:1)\n\n**Common Aspect Ratios:**\n\n- `1:1` - Social media posts, profile pictures, icons\n- `16:9` - Presentations, YouTube thumbnails, desktop wallpapers\n- `9:16` - Instagram Stories, TikTok, mobile vertical content\n- `4:3` - Traditional displays, print media\n- `3:2` - Standard photography\n- `21:9` - Ultra-wide cinematic shots\n\n**Example with custom resolution and aspect ratio:**\n\n```bash\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  banner.png \"A website hero banner with mountains and sunrise\" \\\n  --resolution 4K --aspect-ratio 21:9\n```\n\n## Workflow\n\n1. **Identify the task** - Determine if the user wants to create a new image or edit an existing one\n2. **Check for dependencies and API key** - If errors occur, verify the API key is configured in the config file and that dependencies are installed\n3. **Prepare the prompt** - Translate the user's request into a clear, specific natural language instruction\n4. **Run the appropriate script**:\n   - Use `create_image.py` for generating new images\n   - Use `edit_image.py` for modifying existing images\n5. **Review the output** - Check if the result meets expectations; iterate if needed\n\n## Tips for Effective Prompts\n\n- **Be specific**: \"Remove the red text in the top-left corner\" is better than \"clean up the image\"\n- **Describe desired outcome**: \"Replace the blue background with white\" vs just \"change background\"\n- **Iterative editing**: Make one change at a time for better results\n- **Reference locations**: Use \"top left\", \"bottom right\", \"center\" to specify areas\n- **Use reference images**: Provide style examples, object references, or character photos when appropriate\n- **Pass ALL relevant references**: When recreating templates/memes with different characters, pass both the template image AND the character images as references\n- **Enable search for facts**: Add `--search` when generating content requiring real-time information\n\n**For comprehensive prompting strategies, see `references/prompting_guide.md`**\n**For best practices and workflow optimization, see `references/best_practices.md`**\n\n## Model Capabilities\n\n**Gemini 3 Pro Image supports:**\n\n- Object removal and addition with advanced reasoning\n- Background changes and removal\n- Accurate and legible text rendering in multiple languages\n- Color adjustments and advanced color grading\n- Studio-quality lighting controls (day/night, bokeh effects)\n- Camera angle and focus adjustments\n- Style transfers and artistic transformations\n- Multi-image blending (up to 14 reference images)\n- Character/subject consistency for up to 5 people across edits\n- Sketch-to-product and blueprint-to-3D transformations\n- Real-time data grounding via Google Search (recipes, weather, sports)\n- High-resolution output (2K and 4K with multiple aspect ratios)\n\n## Technical Specifications\n\n**Input Limits:**\n\n- Maximum images per prompt: 14 total\n  - Up to 6 images for object fidelity\n  - Up to 5 images for character consistency\n- Maximum file size: 7 MB per image\n- Supported formats: PNG, JPEG, WebP\n\n**Output Specifications:**\n\n- Resolution options: 1K, 2K, 4K\n- Supported aspect ratios: 1:1, 2:3, 3:2, 3:4, 4:3, 4:5, 5:4, 9:16, 16:9, 21:9\n- All generated images include SynthID watermarking\n\n**Resolution Examples:**\n\n- 1K at 1:1 = 1024Ã1024 pixels\n- 2K at 1:1 = 2048Ã2048 pixels\n- 4K at 1:1 = 4096Ã4096 pixels\n- 4K at 16:9 = 5504Ã3072 pixels\n- 4K at 21:9 = 6336Ã2688 pixels\n\n## Troubleshooting\n\n**\"No Gemini API key configured\" error:**\n\n- Run the setup script: `${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/setup-gemini-token.py YOUR_API_KEY`\n\n**\"No image in response\" message:**\n\n- The model may have returned text instead of an edited image\n- Try rephrasing the prompt more specifically\n- Check API rate limits or quota\n\n**Poor edit quality:**\n\n- Be more specific in the prompt\n- Try breaking complex edits into multiple steps\n- Ensure input image quality is sufficient\n\n**\"MALFORMED_FUNCTION_CALL\" error when editing:**\n\n- **Do NOT request watermark removal** - Gemini blocks prompts mentioning \"remove watermark\" to protect SynthID watermarks\n- Avoid prompts like \"remove the watermark\" or \"clean up watermarks\"\n- This is a content policy restriction, not a technical limitation\n\n**Prompts with dollar signs or special characters getting stripped:**\n\n- **Problem:** Dollar signs (`$3`, `$4.50`) and other bash special characters get removed from prompts\n- **Cause:** When using double quotes in bash, `$variable` syntax triggers variable expansion\n- **Solutions:**\n  - Use single quotes instead of double quotes: `'Espresso $3, Latte $4'`\n  - Escape dollar signs with backslash: `\"Espresso \\\\$3, Latte \\\\$4\"`\n  - Other special characters to watch: exclamation marks, backticks, backslashes, dollar signs, quotes\n\n**Example:**\n\n```bash\n# â Wrong - dollar signs get expanded as variables\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  menu.png \"Coffee menu: Espresso $3, Latte $4\"\n\n# â Correct - use single quotes\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  menu.png 'Coffee menu: Espresso $3, Latte $4'\n\n# â Also correct - escape the dollar signs\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/create_image.py \\\n  menu.png \"Coffee menu: Espresso \\$3, Latte \\$4\"\n```\n\n## Non-AI Alternatives for Quick Edits\n\nFor simple, deterministic image operations, you can also use **PIL/Pillow** (Python) instead of the AI model. This is faster, free, and more predictable for basic tasks:\n\n### Quick Crop Script (Recommended)\n\nUse the included `quick_crop.py` script for fast, precise cropping:\n\n```bash\n# Remove 100px from the right edge\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/quick_crop.py \\\n  input.png output.png --remove-right 100\n\n# Exact crop box\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/quick_crop.py \\\n  input.png output.png --left 0 --top 0 --right 1200 --bottom 800\n\n# Remove pixels from bottom\n${NANO_BANANA_VENV:-${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/.venv}/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/nano-banana-image-editor/scripts/quick_crop.py \\\n  input.png output.png --remove-bottom 50\n```\n\n### Manual PIL/Pillow Code\n\nFor custom operations, use PIL directly:\n\n```python\nfrom PIL import Image\n\nimg = Image.open('input.png')\n# Crop: (left, top, right, bottom)\ncropped = img.crop((0, 0, img.size[0] - 100, img.size[1]))  # Remove 100px from right\ncropped.save('output.png')\n```\n\n### Resizing\n\n```python\nfrom PIL import Image\n\nimg = Image.open('input.png')\nresized = img.resize((1920, 1080))\nresized.save('output.png')\n```\n\n### Rotating\n\n```python\nfrom PIL import Image\n\nimg = Image.open('input.png')\nrotated = img.rotate(90, expand=True)\nrotated.save('output.png')\n```\n\n## References\n\n### Essential Guides\n\n**`references/prompting_guide.md`**\n\n- Photorealistic scenes with photography terminology\n- Stylized illustrations and stickers\n- Accurate text rendering in images\n- Product mockups and commercial photography\n- Minimalist and negative space design\n- Sequential art (comic panels, storyboards)\n- Image editing strategies (adding/removing elements, style transfer, composition)\n- Multi-image prompting techniques\n- Google Search grounding examples\n\n**`references/best_practices.md`**\n\n- Writing hyper-specific prompts for maximum control\n- Iterative refinement through multi-turn conversations\n- Step-by-step instructions for complex compositions\n- Using photography and camera terminology effectively\n- Multiple reference images best practices (character consistency, object fidelity, style transfer)\n- Resolution strategy (when to use 1K vs 2K vs 4K)\n- Aspect ratio selection for different use cases\n- When to use Google Search grounding\n- Quality checklist and workflow for complex projects\n\n### External Resources\n\n- [Google AI Studio](https://ai.google.dev/) - Web interface for testing Gemini models\n- [Pillow Documentation](https://pillow.readthedocs.io/) - PIL/Pillow for non-AI image operations\n",
        "plugins/nano-banana-image-editor/skills/nano-banana-image-editor/references/best_practices.md": "# Gemini 3 Pro Image - Best Practices\n\nEssential best practices for getting the most out of Gemini 3 Pro Image (Nano Banana Pro).\n\n## 1. Be Hyper-Specific\n\nVague prompts yield unpredictable results. Specific prompts give you control.\n\n**â Avoid:**\n\n- \"A nice landscape\"\n- \"Make it better\"\n- \"A person in a room\"\n\n**â Instead:**\n\n- \"A snow-covered mountain landscape at sunrise, with a frozen lake in the foreground reflecting pink and orange clouds, shot with a wide-angle lens\"\n- \"Increase the contrast by 20%, warm up the color temperature, and sharpen the details in the foreground\"\n- \"A woman in her 30s with shoulder-length brown hair, wearing a blue blazer, sitting in a modern office with floor-to-ceiling windows, natural lighting from the left\"\n\n**Why it works:** The model has millions of possible interpretations of \"nice landscape.\" By adding specific details (time of day, weather, elements, camera settings), you narrow the possibility space to match your vision.\n\n## 2. Provide Context and Intent\n\nTell the model what the image is for and how it should feel.\n\n**Examples:**\n\n- \"Create a professional LinkedIn headshot with...\"\n- \"Design a playful children's book illustration featuring...\"\n- \"Generate a serious, corporate presentation slide showing...\"\n- \"Make a vibrant, energetic social media graphic for...\"\n\n**Why it works:** Understanding the purpose helps the model make appropriate stylistic choices (formal vs. casual, serious vs. playful, detailed vs. simplified).\n\n## 3. Iterate and Refine\n\nUse Gemini's multi-turn conversation capability to progressively improve images.\n\n**Workflow:**\n\n1. Start with a good baseline prompt\n2. Generate initial image\n3. Identify specific improvements needed\n4. Request targeted edits in follow-up prompts\n5. Repeat until satisfied\n\n**Example conversation:**\n\n```\nYou: Create a logo for a coffee shop called \"Morning Brew\"\n[Review result]\nYou: Make the coffee cup larger and move it to the left side\n[Review result]\nYou: Change the font to something more elegant and vintage\n[Review result]\nYou: Perfect! Now generate it at 4K resolution\n```\n\n**Why it works:** Breaking down complex requests into steps gives you more control and allows you to course-correct based on each result.\n\n## 4. Use Step-by-Step Instructions\n\nFor complex compositions, break down the prompt into clear steps.\n\n**Example:**\n\n```\nCreate a promotional poster:\n1. Background: Gradient from deep blue (top) to purple (bottom)\n2. Main element: Large coffee cup in the center, photorealistic, steam rising\n3. Text: \"MORNING BREW\" in bold sans-serif at the top, white color\n4. Subtext: \"Opening Soon\" below the cup, smaller elegant font\n5. Style: Modern, clean, professional\n```\n\n**Why it works:** Structured prompts help the model prioritize elements and understand their relationships.\n\n## 5. Semantic Negative Prompts\n\nInstead of saying what you don't want, describe what you do want more precisely.\n\n**â Less effective:**\n\n- \"No blur, no distortion, no artifacts\"\n\n**â More effective:**\n\n- \"Sharp focus, clean edges, high-fidelity detail\"\n\n**Why it works:** The model responds better to positive instructions. If you find yourself listing negatives, reframe as specific positive attributes.\n\n## 6. Control the Camera\n\nUse photography terminology to precisely control perspective and quality.\n\n**Camera Terms:**\n\n- **Focal length:** \"24mm wide-angle\", \"85mm portrait lens\", \"200mm telephoto\"\n- **Aperture:** \"f/1.8 for shallow depth of field\", \"f/11 for everything in focus\"\n- **Shot type:** \"wide shot\", \"medium shot\", \"close-up\", \"extreme close-up\"\n- **Angle:** \"eye-level\", \"low angle looking up\", \"bird's eye view\", \"Dutch angle\"\n- **Focus:** \"tack-sharp focus on subject\", \"soft focus background\", \"rack focus\"\n\n**Lighting Terms:**\n\n- \"Golden hour natural light\"\n- \"Studio lighting with three-point setup\"\n- \"Soft diffused window light\"\n- \"Dramatic side lighting with deep shadows\"\n- \"Bright even lighting, no harsh shadows\"\n\n**Why it works:** These terms are well-represented in the training data and give precise control over the visual result.\n\n## 7. Multiple Reference Images Best Practices\n\nWhen using reference images, be strategic about what you include.\n\n**Character Consistency (up to 5 people):**\n\n- Use clear, well-lit photos of faces\n- Consistent angle and expression across references helps\n- Specify: \"Maintain facial resemblance to these people\"\n\n**Object Fidelity (up to 6 objects):**\n\n- Use high-quality photos of objects from multiple angles\n- Specify: \"Keep these objects' appearance accurate\"\n\n**Style Transfer:**\n\n- Use 1-2 reference images for style\n- Clearly state: \"Apply the artistic style of this reference to...\"\n\n**Composition:**\n\n- Reference images for background, foreground, or specific elements\n- Specify what each image contributes: \"Use the first image for style, second for background, third for subject\"\n\n## 8. Resolution Strategy\n\nChoose resolution based on use case, not \"bigger is always better.\"\n\n**When to use 1K (default):**\n\n- Iterating and testing prompts\n- Social media posts (most platforms downscale anyway)\n- Quick mockups and concepts\n- Budget-conscious projects\n\n**When to use 2K:**\n\n- Professional presentations\n- Print materials (small format)\n- High-quality web graphics\n- Portfolio pieces\n\n**When to use 4K:**\n\n- Large print materials\n- Studio-quality output needed\n- Final production assets\n- When maximum detail is critical\n\n**Cost vs. Quality:** 4K costs more tokens and takes longer. Start with 1K to perfect your prompt, then regenerate at 4K for final output.\n\n## 9. Aspect Ratio Selection\n\nMatch aspect ratio to intended use:\n\n**1:1** - Instagram posts, profile pictures, icons, square formats\n**16:9** - YouTube thumbnails, presentation slides, desktop wallpapers\n**9:16** - Instagram Stories, TikTok, mobile-first vertical content\n**4:3** - Traditional print, some presentation formats\n**3:2** - Standard photography, print photos\n**21:9** - Cinematic ultra-wide, dramatic landscapes\n\n**Tip:** Changing aspect ratio can dramatically change composition. If 16:9 cuts off important elements, try a different ratio rather than fighting the composition.\n\n## 10. When to Use Google Search Grounding\n\nEnable `--search` flag for prompts that benefit from real-time or factual information.\n\n**Use search grounding for:**\n\n- Weather visualizations (\"today's weather in...\")\n- Current events (\"recent news about...\")\n- Factual information (species characteristics, historical facts, scientific data)\n- Real-world object appearances\n\n**Don't use search grounding for:**\n\n- Purely creative/artistic requests\n- Abstract concepts\n- Fictional scenarios\n- When speed matters more than factual accuracy\n\n## 11. Editing Best Practices\n\n**Start simple:**\n\n- Make one change at a time\n- Test each edit before adding more\n\n**Be specific about regions:**\n\n- \"In the top left corner...\"\n- \"The background behind the subject...\"\n- \"The person wearing the red shirt...\"\n\n**Preserve what works:**\n\n- \"Change X but keep Y exactly the same\"\n- \"Maintain the subject's facial features while changing the background\"\n\n**Natural integration:**\n\n- \"Blend seamlessly with the existing image\"\n- \"Match the lighting and color temperature of the scene\"\n- \"Integrate naturally, preserving perspective\"\n\n## 12. Common Pitfalls to Avoid\n\n**1. Overloading prompts:**\n\n- â Trying to describe every tiny detail\n- â Focus on the most important 5-7 elements\n\n**2. Ambiguous pronouns:**\n\n- â \"Make it blue and put it on the left\"\n- â \"Make the car blue and place the tree on the left side\"\n\n**3. Contradictory instructions:**\n\n- â \"Photorealistic cartoon style\"\n- â \"Photorealistic portrait\" OR \"Cartoon-style illustration\"\n\n**4. Forgetting the format:**\n\n- â Requesting features outside the aspect ratio\n- â Check that your composition fits the chosen aspect ratio\n\n**5. Not using reference images when you should:**\n\n- â Describing a complex style in words\n- â Providing a reference image of the desired style\n\n**6. Bash special characters in prompts:**\n\n- â Using double quotes with dollar signs: `\"Menu: Espresso $3, Latte $4\"`\n- â Using single quotes: `'Menu: Espresso $3, Latte $4'`\n- â Or escaping special chars: `\"Menu: Espresso \\\\$3, Latte \\\\$4\"`\n- **Why:** In bash, double-quoted strings expand `$variable` syntax. Characters like dollar signs, exclamation marks, backticks, and backslashes need escaping or single quotes\n- **Common issue:** Prompts with prices (`$3.50`) or other special characters get corrupted when passed through bash\n\n## 13. Quality Checklist\n\nBefore finalizing an image, check:\n\n- [ ] Does it match the prompt intent?\n- [ ] Is the resolution appropriate for the use case?\n- [ ] Is the aspect ratio correct?\n- [ ] Are all text elements legible and accurate?\n- [ ] Is the composition balanced and effective?\n- [ ] Does lighting and perspective make sense?\n- [ ] Are colors and mood appropriate?\n- [ ] Are there any artifacts or errors to fix?\n\n## 14. Workflow for Complex Projects\n\n1. **Research and gather references** - Collect style references, example compositions\n2. **Start with low-res iterations** - Use 1K to perfect the prompt\n3. **Test variations** - Try different aspect ratios and compositions\n4. **Refine progressively** - Multi-turn editing to dial in details\n5. **Final high-res render** - Regenerate at 2K or 4K once perfect\n6. **Quality check** - Review against checklist above\n\n## 15. Learning from Results\n\nKeep a \"prompt journal\" of what works:\n\n- Save successful prompts for reuse\n- Note which terminology gives desired results\n- Build a personal library of effective reference images\n- Document the relationship between prompt details and outcomes\n\n**The key to mastery:** Experimentation, iteration, and learning from each generation.\n",
        "plugins/nano-banana-image-editor/skills/nano-banana-image-editor/references/prompting_guide.md": "# Gemini 3 Pro Image - Prompting Guide\n\nComprehensive guide for crafting effective prompts with Gemini 3 Pro Image (Nano Banana Pro).\n\n## Prompting Philosophy\n\n**Golden Rule:** Describe the scene, don't just list keywords.\n\nNarrative, descriptive prompts yield better images than simple keyword lists. Instead of \"sunset, beach, palm trees,\" use \"A serene beach at sunset with palm trees silhouetted against an orange sky.\"\n\n## Prompts for Generating Images\n\n### Photorealistic Scenes\n\nUse photography terminology to achieve photorealistic results.\n\n**Key Elements:**\n\n- Camera specifications (lens type, focal length, aperture)\n- Lighting conditions (golden hour, studio lighting, natural light)\n- Level of detail (sharp focus, depth of field, bokeh)\n- Photography style (portrait, landscape, macro)\n\n**Examples:**\n\n- \"A portrait of a woman in her 30s, shot with a 85mm lens at f/1.8, soft natural window light, shallow depth of field, sharp focus on eyes, professional headshot quality\"\n- \"Wide-angle landscape of mountain range at golden hour, shot with 24mm lens, f/11 for deep depth of field, dramatic clouds, vibrant sunset colors reflecting on lake in foreground\"\n- \"Macro photograph of water droplets on a leaf, shot with 100mm macro lens, f/2.8, soft diffused lighting, extreme detail, bokeh background\"\n\n### Stylized Illustrations & Stickers\n\nSpecify artistic style and desired aesthetic.\n\n**Key Elements:**\n\n- Art style (flat design, vector art, watercolor, oil painting)\n- Color palette (vibrant, pastel, monochrome)\n- Line work (bold outlines, minimal lines, sketch-like)\n- Background treatment (transparent, solid color, gradient)\n\n**Examples:**\n\n- \"Cute sticker-style nano banana character, flat design, bold black outlines, vibrant yellow, simple shapes, transparent background, kawaii aesthetic\"\n- \"Watercolor illustration of a coffee shop, soft pastel colors, loose brushstrokes, artistic splatter effects, dreamy atmosphere\"\n- \"Vector art logo of a mountain peak, minimal geometric shapes, two-color palette (navy and gold), clean lines, modern minimalist style\"\n\n### Accurate Text in Images\n\nSpecify text content, placement, font characteristics, and integration.\n\n**Key Elements:**\n\n- Exact text content (in quotes)\n- Font characteristics (bold, serif, handwritten, modern)\n- Text placement (centered, top left, integrated into design)\n- Text relationship to image (overlay, part of scene, object in scene)\n\n**Examples:**\n\n- \"A vintage movie poster with the title 'NANO BANANA' in bold red serif font at the top, subtitle 'The Golden Adventure' in elegant script below, 1950s aesthetic\"\n- \"A coffee shop menu board with chalk-style handwritten text listing 'Espresso $3', 'Latte $4', 'Cappuccino $4.50', rustic wooden background\"\n- \"A motivational poster with 'STAY FOCUSED' in large bold sans-serif font centered on image, minimalist black text on white background\"\n- \"A product label for organic honey jar with 'Pure Wildflower Honey' in elegant calligraphy, decorative bee illustrations, vintage aesthetic\"\n\n### Product Mockups & Commercial Photography\n\nEmphasize professional presentation and commercial appeal.\n\n**Key Elements:**\n\n- Product positioning (centered, angled, lifestyle context)\n- Lighting setup (studio lighting, soft boxes, three-point lighting)\n- Background (seamless white, lifestyle setting, contextual environment)\n- Camera angle (eye-level, overhead, 45-degree)\n- Feature highlights (close-up details, product in use)\n\n**Examples:**\n\n- \"Product photography of a smartwatch, centered on white seamless background, studio lighting with soft shadows, 45-degree angle showing screen and band, professional commercial quality\"\n- \"Lifestyle product shot of coffee mug on wooden table, morning sunlight from window, steam rising from coffee, book and reading glasses nearby, cozy atmosphere\"\n- \"Overhead flat lay of skincare products arranged on marble surface, soft natural lighting, minimalist composition, clean and bright aesthetic, Instagram-style\"\n\n### Minimalist & Negative Space Design\n\nLeverage composition and spatial relationships.\n\n**Key Elements:**\n\n- Negative space description (where emptiness should be)\n- Subject placement (rule of thirds, off-center, corner placement)\n- Color simplicity (limited palette, monochrome, single accent color)\n- Compositional balance (asymmetric, centered, weighted)\n\n**Examples:**\n\n- \"A single red balloon in the bottom right corner against a vast white background, minimalist composition, lots of negative space, simple and clean\"\n- \"A lone tree on the left third of the frame, right two-thirds empty pale blue sky, minimalist landscape, serene and spacious\"\n- \"A small coffee cup centered in the lower third of image, upper two-thirds soft gradient background from cream to white, minimalist product photography\"\n\n### Sequential Art (Comic Panels / Storyboards)\n\nDescribe panel composition, character actions, dialogue, and mood.\n\n**Key Elements:**\n\n- Panel description (establishing shot, medium shot, close-up, POV)\n- Character actions and expressions\n- Dialogue and text placement (speech bubbles, captions)\n- Scene mood and atmosphere\n- Continuity between panels (if creating multiple)\n\n**Examples:**\n\n- \"Four-panel comic strip: Panel 1 (wide shot) office worker at desk looking tired. Panel 2 (medium shot) coworker offers coffee with speech bubble 'Need a pick-me-up?'. Panel 3 (close-up) first worker's face brightening. Panel 4 (medium shot) both smiling with coffee, speech bubble 'Thanks!'\"\n- \"Storyboard panel: Establishing shot of urban street at night, neon signs, rain-slicked pavement, noir atmosphere, cinematic framing\"\n- \"Comic panel: Close-up of superhero's determined face, dramatic upward angle, speed lines in background, thought bubble 'I can do this', bold ink style\"\n\n## Prompts for Editing Images\n\n### Adding/Removing Elements\n\nClearly specify what to add or remove and how it should integrate.\n\n**Examples:**\n\n- \"Remove the person in the red shirt on the left side of the photo, fill in naturally with background\"\n- \"Add a rainbow in the sky above the mountain, natural and realistic appearance\"\n- \"Remove all text and watermarks from this image, preserve the underlying content\"\n\n### Inpainting/Masking\n\nDescribe the region to edit and the desired result.\n\n**Examples:**\n\n- \"Change the color of the car in the center from red to blue, maintain all reflections and highlights\"\n- \"Replace the sky in the upper half with a dramatic sunset, blend naturally with the horizon\"\n- \"Remove the speaker overlay box in the top right corner, extend the background slide content\"\n\n### Style Transfer\n\nSpecify target style while preserving composition or content.\n\n**Examples:**\n\n- \"Transform this photograph into a watercolor painting, maintain the composition, soft and artistic\"\n- \"Apply the artistic style of the reference image to this photo, preserve the subject and composition\"\n- \"Convert this realistic portrait into a cartoon illustration, bold outlines, simplified colors\"\n\n### Advanced Composition\n\nCombine elements from multiple images cohesively.\n\n**Examples:**\n\n- \"Blend these five people into a group photo standing side by side, natural lighting, consistent perspective\"\n- \"Combine the foreground subject from this image with the background from the reference, seamless integration\"\n- \"Create a product mockup placing this logo onto the reference product image, realistic and natural\"\n\n### High-Fidelity Detail Preservation\n\nSpecify critical features that must remain accurate.\n\n**Examples:**\n\n- \"Change the background to a beach scene, preserve the person's facial features exactly, maintain sharp detail\"\n- \"Adjust lighting to nighttime, keep all architectural details and textures intact, preserve building character\"\n- \"Add artistic effects but preserve the legibility of all text in the image, maintain brand consistency\"\n\n## Resolution and Aspect Ratio Considerations\n\n### Resolution Selection\n\n- **1K (default):** Fast generation, good for iteration and testing\n- **2K:** Higher quality, professional use\n- **4K:** Maximum quality, studio-grade output, highest cost\n\n### Common Aspect Ratios\n\n- **1:1** - Social media posts, profile pictures, thumbnails\n- **16:9** - Presentations, video thumbnails, widescreen displays\n- **9:16** - Mobile screens, Instagram Stories, vertical video\n- **4:3** - Traditional displays, print media\n- **3:2** - Standard photography, DSLR cameras\n- **21:9** - Ultra-wide cinematic shots\n\n## Multi-Image Prompting\n\nWhen using multiple reference images, be explicit about the role of each image.\n\n**Examples:**\n\n- \"Create a scene combining these characters (first 3 images) in this environment (last image), consistent lighting\"\n- \"Generate a new image in the style of the first reference, with the composition of the second reference\"\n- \"Office photo of these five people, maintain facial resemblance for each person, professional setting\"\n\n## Google Search Grounding\n\nUse `--search` flag when prompts reference real-time or factual information.\n\n**When to Use:**\n\n- Weather conditions (\"today's weather in San Francisco\")\n- Sports scores and statistics\n- Current events\n- Factual data (scientific diagrams, historical maps)\n- Real-world objects with specific appearances\n\n**Examples:**\n\n- \"Create an infographic about the String of Turtles houseplant focusing on its origins, care requirements, and growth patterns\" `--search`\n- \"Generate a weather visualization for Seattle showing today's forecast\" `--search`\n- \"Create a diagram of the solar system with accurate planet sizes and positions\" `--search`\n",
        "plugins/quill-export/skills/quill-export/SKILL.md": "---\nname: quill-export\ndescription: Extract meeting recordings and transcripts from the Quill macOS app database. Outputs formatted markdown with speaker identification, transcripts, and metadata. Use when working with Quill meeting data.\n---\n\n# Quill Meeting Export\n\n## Overview\n\nExtract meeting data from Quill (macOS meeting recording app) and generate formatted markdown output with speaker-identified transcripts, meeting metadata, and Quill's AI-generated notes.\n\nThis skill provides:\n1. Database extraction from Quill's SQLite database\n2. Speaker name mapping from contact records\n3. Transcript formatting with speaker identification\n4. Markdown generation with YAML frontmatter\n5. Meeting search by ID or fuzzy name matching\n\n## When to Use This Skill\n\nActivate when working with Quill meeting data:\n- Extracting meeting transcripts\n- Converting Quill recordings to markdown\n- Searching for meetings by name\n- Getting meeting metadata and participants\n\n## Workflow\n\n### Step 1: List Available Meetings\n\nShow recent meetings from Quill:\n\n```bash\npython3 ~/.claude/skills/quill-export/scripts/export_meeting.py list [limit]\n```\n\n**Output** (to stderr):\n- Meeting ID (UUID)\n- Title\n- Date and time\n- Duration\n- Meeting type\n\n### Step 2: Export Meeting\n\nExport meeting by ID or search term:\n\n```bash\n# By exact ID\npython3 ~/.claude/skills/quill-export/scripts/export_meeting.py export 76490ffc-d751-4a2a-9ef5-df4d3ddce442\n\n# By fuzzy search term\npython3 ~/.claude/skills/quill-export/scripts/export_meeting.py export \"orchestrator\"\n```\n\n**Output** (to stdout):\n- Complete markdown document\n- YAML frontmatter with metadata\n- Transcript with real speaker names (if tagged in Quill)\n- Original Quill-generated notes\n- Audio file links\n\n**Fuzzy Search Behavior:**\n- Case-insensitive partial matching\n- If single match: Exports automatically\n- If multiple matches: Lists options (stderr) and exits\n- If no matches: Error message and exit\n\n### Step 3: Use the Markdown Output\n\nThe markdown is printed to stdout, allowing flexible usage:\n\n```bash\n# Save to file\npython3 export_meeting.py export \"meeting name\" > output.md\n\n# Pipe to other tools\npython3 export_meeting.py export <id> | pbcopy\n\n# Capture in a variable (from another script/tool)\nmarkdown=$(python3 export_meeting.py export <id>)\n```\n\n## Database Schema\n\nThe script queries Quill's SQLite database at `~/Library/Application Support/Quill/quill.db`.\n\nSee `references/quill-schema.md` for complete schema documentation including:\n- Meeting table structure\n- Transcript JSON format\n- ContactMeeting speaker mapping\n- Meeting type classifications\n\n## Speaker Name Mapping\n\nThe script automatically maps anonymous speaker IDs to real names:\n\n**How it works:**\n1. Queries `ContactMeeting` table for speaker IDs\n2. Looks up contact names in `Contact` table\n3. Replaces speaker IDs (e.g., `SPK-abc123`) with real names in transcript\n\n**When names are available:**\n```markdown\n**James LePage:** Hello, how are you?\n**Ember:** I'm doing well, thanks!\n```\n\n**When names are not available:**\n```markdown\n**SPK-mvjxhzyf43:** Hello, how are you?\n**SPK-h6xiau6chjv:** I'm doing well, thanks!\n```\n\n## Meeting Type Classification\n\nMeetings are categorized as `work` or `personal` based on type:\n\n**Work types:**\n- `1on1`, `internal_product`, `internal_sync`, `internal_standup`\n- `existing_vendor:customer`, `other`\n\n**Personal types:**\n- `personal`, `self_note`, `medical:patient`\n\nCategory appears in YAML frontmatter `type` field.\n\n## Markdown Output Format\n\n```markdown\n---\nmeeting_id: {UUID}\ntype: work|personal\ndate: YYYY-MM-DD\nstart_time: HH:MM\nduration: X minutes\nparticipants: [\"Name 1\", \"Name 2\"]\ntags: [\"meeting\", \"type\", ...]\n---\n\n# {Meeting Title}\n\n## Summary\n\n_AI summary will be generated here_\n\n## Key Discussion Points\n\n_Key points will be extracted here_\n\n## Action Items\n\n_Action items will be extracted here_\n\n## Related\n\n_Links to related tasks and projects_\n\n## Original Quill Notes\n\n{Quill's AI-generated meeting notes}\n\n## Transcript\n\n**Speaker:** Transcript text...\n\n## Audio\n\n[Recording](file:///path/to/audio.m4a)\n```\n\n## Audio File Handling\n\nAudio files remain in Quill's directory:\n- Location: `~/Library/Application Support/Quill/meetings/`\n- Linked using `file://` absolute URLs\n- Only the combined audio file is linked (`*-combined.m4a`)\n\n## Error Handling\n\n**Meeting not found:**\n- Prints error to stderr\n- Exit code 1\n\n**Multiple search matches:**\n- Lists all matching meetings to stderr\n- Prompts user to be more specific\n- Exit code 1\n\n**Database errors:**\n- Connection failures reported to stderr\n- Exit code 1\n\n## Usage Examples\n\n**List recent meetings:**\n```bash\npython3 export_meeting.py list 10\n```\n\n**Export by ID:**\n```bash\npython3 export_meeting.py export 76490ffc-d751-4a2a-9ef5-df4d3ddce442 > meeting.md\n```\n\n**Export by name search:**\n```bash\npython3 export_meeting.py export \"AI Discussion\" > meeting.md\n```\n\n**Integration with other tools:**\n```bash\n# Copy to clipboard\npython3 export_meeting.py export \"sync meeting\" | pbcopy\n\n# Save with custom filename\npython3 export_meeting.py export <id> > ~/Notes/$(date +%Y-%m-%d)-meeting.md\n```\n\n## Resources\n\n### scripts/export_meeting.py\nPython script for extracting meeting data and generating markdown.\n\n**Functions:**\n- `connect_db()` - Connect to Quill database\n- `get_speaker_names(conn, meeting_id)` - Map speaker IDs to names\n- `list_recent_meetings(conn, limit)` - List meetings\n- `search_meetings(conn, search_term)` - Fuzzy search by title\n- `get_meeting(conn, meeting_id)` - Fetch meeting data\n- `format_transcript(transcript, speaker_names)` - Format with names\n- `format_meeting_markdown(meeting)` - Generate markdown output\n\n### references/quill-schema.md\nComplete Quill database schema documentation.\n\n### assets/meeting-template.md\nTemplate showing markdown structure and formatting.\n",
        "plugins/quill-export/skills/quill-export/assets/meeting-template.md": "---\nmeeting_id: {UUID}\ntype: {work|personal}\ndate: YYYY-MM-DD\nstart_time: HH:MM\nduration: {X minutes}\nparticipants: [\"participant1\", \"participant2\"]\ntags: [meeting, {type}, {additional-tags}]\n---\n\n# {Meeting Title}\n\n## Summary\n\n{1-2 paragraph AI-generated summary of the meeting covering:\n- Main purpose/topic\n- Key outcomes or decisions\n- Overall tone/sentiment}\n\n## Key Discussion Points\n\n- {Important topic 1 with brief context}\n- {Important topic 2 with brief context}\n- {Important topic 3 with brief context}\n- {Additional discussion points as needed}\n\n## Action Items\n\n- [ ] {Specific action item} #{owner-name}\n- [ ] {Specific action item} #{owner-name}\n- [ ] {Specific action item} #{owner-name}\n\n{Format: Clear, specific action with responsible person tagged}\n\n## Related\n\n- [[Related Task or Project Link]]\n- [[Related Note or Document]]\n\n{Add cross-references to tasks in Tasks/, project docs in Automattic/, or other relevant notes}\n\n## Transcript\n\n{Full formatted transcript with speaker identification:}\n\n**{Speaker ID}:** {What they said...}\n\n**{Speaker ID}:** {What they said...}\n\n{Continue with full transcript, grouping consecutive statements from the same speaker}\n\n## Original Quill Notes\n\n{If Quill generated notes, include them here for reference}\n\n### {Note Title}\n\n{Note content from Quill's AI-generated notes}\n\n## Audio\n\n[Recording](path/to/audio.m4a)\n\n{Link to audio file, either relative path if in vault or absolute file:// URL}\n",
        "plugins/quill-export/skills/quill-export/references/quill-schema.md": "# Quill Database Schema Reference\n\nThis document describes the Quill macOS app's SQLite database structure for meeting data extraction.\n\n## Database Location\n\n**Primary Database:**\n- Path: `~/Library/Application Support/Quill/quill.db`\n- Type: SQLite 3.x\n- Contains: Meeting metadata, transcripts, notes, templates\n\n**Audio Files:**\n- Path: `~/Library/Application Support/Quill/meetings/`\n- Structure: `{timestamp}-{uuid}/`\n- Files: `{uuid}-FINAL-{start}-{end}-combined.m4a`\n\n## Core Tables\n\n### Meeting Table\n\nPrimary table containing meeting metadata and transcripts.\n\n```sql\nCREATE TABLE Meeting (\n    id TEXT PRIMARY KEY,          -- UUID\n    title TEXT,                   -- Meeting title\n    type TEXT,                    -- Meeting type (see types below)\n    start INTEGER,                -- Start time (epoch milliseconds)\n    end INTEGER,                  -- End time (epoch milliseconds)\n    audio_transcript TEXT,        -- JSON transcript data\n    participants TEXT,            -- JSON array or string\n    context TEXT,                 -- Additional context\n    tags TEXT,                    -- JSON array of tags\n    folder TEXT,                  -- Folder/category\n    deleteDate INTEGER,           -- Deletion timestamp (NULL if active)\n    confirmedAt INTEGER,          -- Confirmation timestamp\n    audioDeletedAt INTEGER,       -- Audio deletion timestamp\n    word_count INTEGER,           -- Transcript word count\n    selected_note_id TEXT,        -- ID of selected note\n    events TEXT,                  -- JSON events data\n    links TEXT,                   -- JSON links data\n    screenshots TEXT              -- JSON screenshots data\n)\n```\n\n### Note Table\n\nAssociated notes and AI-generated summaries for meetings.\n\n```sql\nCREATE TABLE Note (\n    id TEXT PRIMARY KEY,          -- UUID\n    meeting_id TEXT,              -- Foreign key to Meeting.id\n    kind TEXT,                    -- Note type (e.g., \"template\", \"followupsV3\")\n    title TEXT,                   -- Note title\n    body TEXT,                    -- Note content (markdown)\n    template_id TEXT,             -- Template UUID if generated from template\n    is_published BOOLEAN,         -- Publication status\n    data TEXT,                    -- JSON additional data\n    prompt TEXT,                  -- AI prompt used\n    prompt2 TEXT,                 -- Secondary AI prompt\n    createdAt INTEGER             -- Creation timestamp (epoch milliseconds)\n)\n```\n\n### Template Table\n\nTemplates for AI-generated meeting notes.\n\nCommon templates:\n- \"Article or Post\"\n- \"Full 1:1 Review\"\n- \"Check in\"\n- \"Summary & Todos\"\n- \"Technical Implementation\"\n\n## Meeting Types\n\n### Work Meeting Types\n- `1on1` - One-on-one meetings\n- `internal_product` - Internal product meetings\n- `internal_sync` - Internal sync meetings\n- `internal_standup` - Standup meetings\n- `existing_vendor:customer` - Customer/vendor meetings\n- `other` - Miscellaneous work meetings\n\n### Personal Meeting Types\n- `personal` - Personal meetings\n- `self_note` - Self notes/recordings\n- `medical:patient` - Medical appointments\n\n## Transcript JSON Structure\n\nThe `audio_transcript` field contains JSON with this structure:\n\n```json\n{\n  \"startTime\": 1761318099982,\n  \"endTime\": 1761319232081,\n  \"blocks\": [\n    {\n      \"from\": 1761318099982,         // Block start (epoch ms)\n      \"to\": 1761318103342,           // Block end (epoch ms)\n      \"text\": \"Spoken text here\",    // Transcribed text\n      \"language\": \"en\",              // Language code\n      \"id\": \"07GG\",                  // Block ID\n      \"source\": \"mic\",               // Audio source (mic/system)\n      \"has_embeddings\": true,        // Vector embeddings available\n      \"speaker_confidence\": 0.229,   // Speaker ID confidence (0-1)\n      \"speaker_id\": \"SPK-h6xiau6chjv\", // Anonymous speaker ID\n      \"speaker_origin\": \"CLUSTER\"   // Speaker attribution method\n    }\n  ]\n}\n```\n\n## Speaker Identification\n\nSpeakers are anonymized with IDs like `SPK-h6xiau6chjv`. The system uses clustering to identify different speakers but does not store names.\n\nTo improve readability:\n- Group consecutive blocks from the same speaker\n- Format as \"**Speaker ID:** Text\"\n- Consider allowing manual speaker name mapping\n\n## Note Body Format\n\nNotes are stored as markdown, often containing tables:\n\n```markdown\n| Category | Details |\n|----------|---------|\n| Updates  | Content here |\n| Concerns | Content here |\n\n## Action Items\n[ ] Task 1\n[ ] Task 2\n```\n\n## Querying Examples\n\n### Get Recent Meetings\n\n```sql\nSELECT id, title, type, start, end, participants\nFROM Meeting\nWHERE deleteDate IS NULL\nORDER BY start DESC\nLIMIT 20\n```\n\n### Get Meeting with Notes\n\n```sql\nSELECT\n    m.id, m.title, m.type, m.start, m.end,\n    m.audio_transcript, m.participants,\n    n.body as note_body, n.kind as note_type\nFROM Meeting m\nLEFT JOIN Note n ON m.id = n.meeting_id\nWHERE m.id = ? AND m.deleteDate IS NULL\n```\n\n### Filter by Type\n\n```sql\nSELECT * FROM Meeting\nWHERE type = '1on1'\n  AND deleteDate IS NULL\nORDER BY start DESC\n```\n\n## Data Considerations\n\n1. **Timestamps**: All timestamps are in epoch milliseconds, not seconds\n2. **JSON Fields**: Parse `audio_transcript`, `participants`, `tags` as JSON\n3. **Deleted Items**: Always filter `WHERE deleteDate IS NULL`\n4. **Audio Files**: Match meeting by UUID in directory names\n5. **Speaker Privacy**: Speaker IDs are anonymous, consider manual mapping\n",
        "plugins/video-toolkit/agents/video-frame-analyzer.md": "---\nname: video-frame-analyzer\ndescription: Used after video frames have been extracted to systematically analyze visual content and generate comprehensive video summaries.\ntools: Read, Write\nmodel: inherit\n---\n\nYou are a specialized video frame analysis agent with expert visual comprehension capabilities. Your role is to systematically analyze extracted video frames using Claude's multimodal vision capabilities and generate comprehensive, insightful summaries of video content.\n\n## Role\n\nYou are an expert at:\n\n- Analyzing visual content across multiple frames to understand video narratives\n- Identifying scene changes, key moments, and visual patterns\n- Recognizing UI elements, text, screenshots, and interface designs\n- Correlating sequential frames to understand flow and transitions\n- Synthesizing visual information into clear, structured summaries\n- Detecting important details that reveal the video's purpose and content\n\n## Process\n\nWhen analyzing video frames:\n\n1. **Frame Inventory & Context Loading**\n   - Identify the total number of frames available\n   - Note the frame directory location\n   - **Read frames_metadata.json** if available for accurate timestamps\n   - **Read transcript.md** if available for audio correlation\n   - Understand the extraction method (interval-based or scene-detection)\n   - Check for any additional user-provided context\n\n2. **Sampling Strategy**\n   - For <10 frames: Read ALL frames in a single batch\n   - For 10-30 frames: Read frames in batches of 5-8 to avoid API limits\n   - For 30-50 frames: Read every 2nd frame in batches, plus key frames\n   - For >50 frames: Sample strategically (first, last, evenly spaced) in small batches\n   - Always analyze frame_0001 (first frame) and the final frame\n   - **IMPORTANT**: Never read more than 8 frames in parallel - Claude API has multi-image size limits\n\n3. **Visual Analysis**\n   - Read each frame using the Read tool (images display visually)\n   - Describe what's visible: UI elements, text, people, actions, scenes\n   - Note significant changes between frames\n   - Identify the video type (screen recording, presentation, movie, tutorial, etc.)\n   - Extract any visible text or important labels\n   - Recognize patterns across frames (navigation, progression, narrative)\n\n4. **Scene Organization & Correlation**\n   - Group related frames into logical scenes or sections\n   - Identify transition points and major changes\n   - Track progression through the video\n   - **Use timestamps from metadata to correlate with transcript**\n   - Match visual changes with spoken dialogue or audio events\n   - Note synchronization between what's shown and what's said\n\n5. **Summary Generation**\n   - Create a comprehensive markdown summary\n   - Include frontmatter with metadata (frame count, video type, analysis date)\n   - Organize by scenes or chronological sections with timestamps\n   - **Correlate visual and audio content** using timestamps\n   - Highlight key moments with both frame references and timestamps\n   - Provide both overview and detailed breakdowns\n   - Include specific frame references (e.g., \"frame_0015 @ 45.2s\")\n   - Quote relevant transcript excerpts aligned with visual content\n\n## Guidelines\n\n- **Be thorough but efficient** - Don't describe every pixel, focus on meaningful content\n- **Identify the video's purpose** - Is it a demo? Tutorial? Presentation? Recording?\n- **Notice details** - UI text, button labels, menu items, and visual cues matter\n- **Track changes** - Frame-to-frame differences reveal the video's flow\n- **Provide context** - Help the user understand what they're looking at\n- **Use precise language** - Describe exactly what you see, not assumptions\n- **Preserve frame references** - Always cite which frames contain specific information\n- **Look for patterns** - Repeated elements, navigation paths, workflows\n\n## Output Format\n\nGenerate a markdown summary following this structure:\n\n```markdown\n---\nvideo_analysis: true\ntotal_frames: [N]\nframes_analyzed: [N]\nvideo_type: [screen recording|presentation|tutorial|etc]\nanalysis_date: YYYY-MM-DD\n---\n\n# Video Analysis: [Title/Topic]\n\n## Overview\n[1-2 paragraph summary of the entire video content]\n\n## Video Type & Context\n[Identify what kind of video this is and its apparent purpose]\n\n## Detailed Analysis\n\n### Scene 1: [Section Name] (Frames X-Y)\n[Description of this section with specific frame references]\n\nKey observations:\n- [Important detail from frame_XXXX]\n- [Another observation]\n\n### Scene 2: [Section Name] (Frames X-Y)\n[Continue for each major section]\n\n## Key Highlights\n- [Most important moment or information]\n- [Another significant finding]\n- [Notable detail]\n\n## Visual Elements Identified\n- UI components: [buttons, menus, etc.]\n- Text content: [visible labels, headings]\n- Navigation: [how the video progresses]\n\n## Conclusion\n[Final summary and insights about the video's content and purpose]\n\n---\n*Analyzed [N] of [Total] frames using video-frame-analyzer*\n```\n\n## Best Practices\n\n- **Always check for metadata first** - Read `frames_metadata.json` to get accurate timestamps\n- **Always check for transcript** - Read `transcript.md` if available to correlate audio with visuals\n- **Use timestamps for correlation** - Match frame timestamps with transcript timestamps to understand context\n- **Read frames in small batches** - Never read more than 5-8 frames in parallel to avoid API limits\n- **Handle API errors gracefully** - If you get a \"dimensions exceed max allowed size\" error, read frames individually\n- **Read frames as images** - The Read tool will display frames visually for analysis\n- **Sample intelligently** - For many frames, strategic sampling is better than superficial analysis\n- **Connect the dots** - Explain how frames relate to tell the video's story\n- **Extract text** - Always transcribe visible text, labels, and UI elements\n- **Correlate multimodal data** - Explain how visual content relates to spoken content\n- **Provide value** - Your summary should help someone understand the video without watching it\n- **Ask clarifying questions** - If user context would help (e.g., \"What were you looking for?\"), ask first\n- **Note uncertainty** - If frames are unclear or ambiguous, say so\n- **Respect privacy** - Note if frames contain sensitive or personal information\n",
        "plugins/video-toolkit/commands/upgrade.md": "---\ndescription: Upgrade the video-toolkit plugin to the latest version from the marketplace repository\ntools: Bash, AskUserQuestion\n---\n\n# Video Toolkit Plugin Upgrade\n\nYou are running the video-toolkit upgrade command to update the plugin to the latest version.\n\n## Your Task\n\nGuide the user through upgrading the video-toolkit plugin by pulling the latest changes from the marketplace repository.\n\n## Workflow\n\n### Step 1: Verify Current Installation\n\nCheck the current version and installation location:\n\n```bash\n# Get marketplace directory\nMARKETPLACE_DIR=$(dirname $(dirname ${CLAUDE_PLUGIN_ROOT}))\n\n# Get current version from marketplace.json\nCURRENT_VERSION=$(jq -r '.plugins[] | select(.name==\"video-toolkit\") | .version' \"$MARKETPLACE_DIR/.claude-plugin/marketplace.json\")\n\n# Verify git repository\ncd \"$MARKETPLACE_DIR\" && git rev-parse --git-dir >/dev/null 2>&1 && echo \"â Git repository found\" || echo \"â Not a git repository\"\n```\n\n**Output to user:**\n\n```\nCurrent version: [version]\nMarketplace directory: [path]\n```\n\n### Step 2: Check for Updates\n\nFetch the latest tags and check for updates:\n\n```bash\ncd \"$MARKETPLACE_DIR\"\ngit fetch --tags origin\n```\n\nThen get the version information:\n\n```bash\n# Get the latest version tag for this plugin\nLATEST_TAG=$(git tag -l 'video-toolkit/v*' --sort=-v:refname | head -n 1)\n\n# Get current tag (if on a tag)\nCURRENT_TAG=$(git describe --tags --exact-match 2>/dev/null || echo \"none\")\n\n# Filter to only video-toolkit tags if we're on a tag\nif [ \"$CURRENT_TAG\" != \"none\" ]; then\n  echo \"$CURRENT_TAG\" | grep -q '^video-toolkit/' || CURRENT_TAG=\"none\"\nfi\n\necho \"Latest tag: $LATEST_TAG\"\necho \"Current tag: $CURRENT_TAG\"\n```\n\n**Analyze the output:**\n\n- If `LATEST_TAG` is empty â No tagged releases available yet\n- If `CURRENT_TAG` equals `LATEST_TAG` â Already on latest version\n- If `LATEST_TAG` is newer â Continue to Step 3\n- If git fetch fails â Inform user there's a connection issue\n\n**Output to user:**\n\n```\nCurrent version: [CURRENT_VERSION] (tag: [CURRENT_TAG or \"not on a tagged release\"])\nLatest available: [LATEST_TAG]\n```\n\n### Step 3: Show Release Notes\n\nIf updates are available, show what's changed by reading the CHANGELOG:\n\n```bash\ncd \"$MARKETPLACE_DIR\" && git show \"$LATEST_TAG:plugins/video-toolkit/CHANGELOG.md\" | head -50\n```\n\n**Present the release notes** to the user, focusing on the latest version's changes.\n\n### Step 4: Confirm Upgrade\n\nUse the **AskUserQuestion** tool to ask:\n\n- **Question**: \"Ready to upgrade video-toolkit to the latest version?\"\n- **Options**:\n  - \"Yes, upgrade now\" (description: \"Pull latest changes from the repository\")\n  - \"No, not now\" (description: \"Keep current version\")\n\nIf user selects \"No, not now\":\n\n- Output: \"Upgrade cancelled. Your current version remains unchanged.\"\n- Exit the command\n\n### Step 5: Perform Upgrade\n\nIf user confirms, checkout the latest tagged release:\n\n```bash\ncd \"$MARKETPLACE_DIR\" && git checkout \"$LATEST_TAG\"\n```\n\n**Check the exit code:**\n\n- Exit code 0 â Success, continue to Step 6\n- Exit code != 0 â Error occurred, show user the error message and stop\n\n**Note:** This checks out the specific tagged release ensuring you get a stable, tested version.\n\n### Step 6: Rebuild Plugin Dependencies\n\nAfter pulling changes, reinstall Python dependencies:\n\n```bash\ncd ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit && bash scripts/install_dependencies.sh\n```\n\n**Monitor for errors:**\n\n- If successful â Continue to Step 7\n- If errors occur â Show errors to user and explain that manual intervention may be needed\n\n### Step 7: Verify New Version\n\nCheck the updated version:\n\n```bash\nNEW_VERSION=$(jq -r '.plugins[] | select(.name==\"video-toolkit\") | .version' \"$MARKETPLACE_DIR/.claude-plugin/marketplace.json\")\n```\n\n### Step 8: Success Message & Restart Prompt\n\n**Output to user:**\n\n```\nâ Video Toolkit upgraded successfully!\n\nPrevious version: [old version]\nCurrent version: [new version]\n\nâ ï¸  Important: You must restart Claude Code to apply the changes.\n\nTo restart:\n1. Close this conversation\n2. Restart Claude Code\n3. Start a new session\n\nAfter restarting, you can verify the upgrade by running:\n/video-toolkit [test_video_file]\n```\n\n## Error Handling\n\n### Git Repository Not Found\n\nIf the marketplace directory is not a git repository:\n\n```\nâ Upgrade failed: video-toolkit marketplace is not a git repository.\n\nThis can happen if the plugin was installed differently. To upgrade manually:\n\n1. Navigate to: [marketplace directory]\n2. Run: git fetch --tags origin\n3. List tags: git tag -l 'video-toolkit/v*' --sort=-v:refname\n4. Checkout latest: git checkout <latest-version-tag>\n5. Navigate to: [plugin directory]/skills/video-toolkit\n6. Run: bash scripts/install_dependencies.sh\n7. Restart Claude Code\n\nIf you continue to have issues, try reinstalling the plugin:\n/plugin marketplace remove emdashcodes-claude-code-plugins\n/plugin marketplace add emdashcodes/claude-code-plugins\n/plugin install video-toolkit@emdashcodes-claude-code-plugins\n```\n\n### Network/Connection Errors\n\nIf git fetch/pull fails due to network issues:\n\n```\nâ Upgrade failed: Unable to connect to repository.\n\nPlease check your network connection and GitHub access.\n\nTo upgrade manually:\ncd [marketplace directory]\ngit fetch --tags origin\ngit tag -l 'video-toolkit/v*' --sort=-v:refname  # List versions\ngit checkout <latest-version-tag>\ncd [plugin directory]/skills/video-toolkit\nbash scripts/install_dependencies.sh\n\nThen restart Claude Code.\n```\n\n### Build Errors\n\nIf dependency installation fails:\n\n```\nâ Upgrade completed but dependency installation failed.\n\nThe latest code was pulled, but there were errors during dependency installation.\nYou may need to troubleshoot manually.\n\nError details:\n[show error output]\n\nTo retry manually:\ncd [plugin directory]/skills/video-toolkit\nbash scripts/install_dependencies.sh\n\nIf issues persist, report at: https://github.com/emdashcodes/claude-code-plugins/issues\n```\n\n## Important Notes\n\n- This command upgrades to the latest **tagged release** (stable, tested versions)\n- Uses plugin-prefixed semantic versioning tags (e.g., `video-toolkit/v1.0.0`, `video-toolkit/v1.1.0`)\n- A restart of Claude Code is **required** for changes to take effect\n- The upgrade process will reinstall FFmpeg and Whisper dependencies\n",
        "plugins/video-toolkit/skills/video-toolkit/SKILL.md": "---\nname: video-toolkit\ndescription: Video analysis and editing with FFmpeg and Whisper. This skill should be used when video files are shared (.mov, .mp4, .avi, etc.) or when you encounter \"cannot read binary files\" errors for video files, when users request video analysis or summarization, or when users ask to edit videos (clip, merge, split).\nallowed-tools: Read, Write, Bash, Glob\n---\n\n# Video Toolkit\n\nComprehensive video processing skill combining editing capabilities with multi-modal analysis (visual frames + audio transcription).\n\n## When to Use This Skill\n\nActivate this skill when:\n\n- User shares a video file (.mov, .mp4, .avi, .mkv, .webm, etc.)\n- User asks to analyze, summarize, or understand video content\n- User requests video editing operations (clip, merge, split)\n- User asks questions about what's in a video\n- You encounter \"cannot read binary files\" errors when trying to read video files\n- Guides agents to use proper video analysis workflow\n\n**What this means for users:**\n\nWhen you share a video file, Claude will automatically recognize it and offer to analyze it properly using the video-toolkit, rather than attempting to read the binary file directly.\n\n## Prerequisites\n\n**Required Dependencies:**\n\n1. **FFmpeg** - Video processing and frame extraction\n   - Installation handled by `scripts/install_dependencies.sh`\n   - Verify: `ffmpeg -version`\n\n2. **Python 3.8+** with virtual environment\n   - Installation handled by `scripts/install_dependencies.sh`\n\n3. **OpenAI Whisper** - Speech transcription (local, no API key required)\n   - Installed via pip in `.venv`\n   - Model: base (good balance of speed/accuracy)\n   - Other models available: tiny.en, small, medium, large\n\n4. **Google Gemini API** - Audio analysis and music detection\n   - Installed via pip in `.venv`\n   - Requires API key (see setup below)\n   - Model: gemini-2.5-flash\n\n5. **Shazam API** - Music identification\n   - Installed via pip in `.venv` (shazamio)\n   - No API key required (uses public endpoint)\n\n**Setup:**\n\n**Step 1: Install Dependencies**\n\nRun the installation script on first use:\n\n```bash\nbash ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/install_dependencies.sh\n```\n\nThis creates a Python virtual environment at `${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/` and installs the required packages (ffmpeg-python, openai-whisper, google-genai, shazamio).\n\n**Step 2: Configure API Keys**\n\nSet up Gemini API key for audio analysis:\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/setup_api_keys.py gemini YOUR_API_KEY\n```\n\nGet your Gemini API key from: https://aistudio.google.com/app/apikey\n\n**Optional:** If you want to use RapidAPI's Shazam endpoint instead of the public one:\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/setup_api_keys.py shazam YOUR_RAPIDAPI_KEY\n```\n\nNote: Shazam/music identification works without an API key using shazamio's public endpoint.\n\n## How to Use This Skill\n\n**IMPORTANT: Check API Key Setup First**\n\nBefore analyzing videos with audio, verify that the Gemini API key is configured:\n- Config file location: `/Users/emdash/Dev/claude-code-plugins/emdashcodes/.video-toolkit-config.json`\n- If the file doesn't exist or doesn't contain `gemini.apiKey`, run the setup first (see Prerequisites above)\n- The scripts will error with clear setup instructions if the API key is missing\n\n### Multi-Modal Video Analysis Workflow\n\nWhen analyzing a video file, follow this comprehensive workflow:\n\n**1. Frame Extraction**\n\nExtract visual frames using either **interval mode** or **scene detection mode**:\n\n**Interval Mode** (time-based):\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/extract_frames.py <video_path> <interval_seconds> <output_dir>\n```\n\n- `interval_seconds`: Time between frames (e.g., 2 for every 2 seconds)\n- `output_dir`: Temporary directory for frames\n- Best for: Consistent sampling, slideshows, time-based analysis\n\n**Scene Detection Mode** (change-based):\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/extract_frames.py <video_path> --scene-detect <output_dir> [threshold]\n```\n\n- `threshold`: Sensitivity (0.0-1.0, optional, default: 0.02)\n- Automatically detects visual changes\n- Best for: Screen recordings, presentations, variable content\n\n**Choosing the Right Mode:**\n\n| Video Type | Recommended Mode | Threshold/Interval | Recommended Value |\n|------------|------------------|-------------------|-------------------|\n| **Screen recordings** | **Interval** | 2-3 seconds | **Use 2-3s** |\n| **Presentations/Slides** | Scene detection | 0.05 - 0.10 | **Use 0.05** |\n| **Movies/Hard cuts** | Scene detection | 0.20 - 0.30 | **Use 0.20** |\n| **Surveillance/Static** | Interval | 5-10 seconds | **Use 5s** |\n| **Interviews/Dialogue** | Interval | 3-5 seconds | **Use 3s** |\n| **Action videos** | Interval | 1-2 seconds | **Use 1s** |\n\n**Agent Decision Making:**\n\n- For UI/screen recordings: Use interval mode with 2-3s (captures static periods reliably)\n- For presentations/slides: Use scene detection with 0.05 (good for slide transitions)\n- For movies with hard cuts: Use scene detection with 0.20\n- For talking heads/static: Use interval mode with 3-5s\n- For action/movement: Use interval mode with 1-2s\n- **DEFAULT**: Interval mode with 2s (safest for most videos)\n\n**IMPORTANT: Evaluate and Re-run if Needed**\n\n- After extraction, **check the frame count** - does it seem reasonable for the video duration?\n- If you get too few frames (e.g., <5 frames for a 2-min screen recording), **SWITCH TO INTERVAL MODE**\n- If you get too many frames (e.g., >100 frames), the threshold may be TOO LOW\n- **Think critically about the results, check some frames, and RE-RUN with different settings if necessary**\n- Don't proceed with analysis if frame extraction clearly failed or produced poor results\n\n**Scene Detection Limitation:**\nScene detection **only captures frames when visual content changes significantly**. If the video has long static periods (e.g., same screen for 30+ seconds), scene detection will miss that content entirely. **For videos with static content, USE INTERVAL MODE instead** with `--mode interval --interval 2` or `--interval 3`.\n\n**2. Audio Extraction**\n\nExtract audio track using `scripts/extract_audio.py`:\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/extract_audio.py <video_path> <output_wav_path>\n```\n\n- Converts to WAV format (Whisper-compatible)\n- Preserves original audio quality\n- Returns: Path to extracted WAV file\n\n**3. Audio Analysis (Sequential Workflow)**\n\nThe audio analysis follows a sequential workflow to maximize accuracy and efficiency:\n\n**3a. Speech Transcription (Whisper - Local)**\n\nTranscribe speech using Whisper (runs locally, no API key required):\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/transcribe_audio.py <wav_path> [model_name]\n```\n\n- `model_name`: Whisper model (default: base)\n  - tiny.en: Fastest, English only\n  - base: Good balance (recommended)\n  - small: Better accuracy\n  - medium: High accuracy\n  - large: Best accuracy, slowest\n- Returns: Timestamped transcript with speaker diarization info\n- **Purpose**: Extract speech/dialogue from the audio\n\n**3b. Audio Understanding (Gemini Audio API)**\n\nAnalyze audio comprehensively using Gemini Audio API:\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/analyze_audio_gemini.py <wav_path> [output_markdown]\n```\n\n- Analyzes full audio content (not just speech)\n- **Detects music** with precise timestamps (MM:SS to MM:SS format)\n- Identifies non-speech sounds (applause, ambient noise, sound effects)\n- **Translates foreign languages**: If Whisper detects non-English speech, Gemini provides both original and English translation\n- Returns:\n  - Markdown analysis saved to `[output_markdown]`\n  - JSON data automatically saved to `gemini_audio.json` in same directory\n  - JSON contains `has_music` flag and `music_segments` array for downstream processing\n- **Purpose**: Understand what's in the audio beyond speech, detect if music is present, translate foreign languages\n\n**3c. Music Identification (Shazam - Conditional)**\n\nIf Gemini detects music, identify songs using Shazam:\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/identify_music.py <wav_path> <gemini_json> [output_markdown]\n```\n\n- `<gemini_json>`: Path to the `gemini_audio.json` file created by `analyze_audio_gemini.py`\n- Only runs if Gemini detected music (checks `has_music` flag in JSON)\n- Extracts music segments based on Gemini's timestamps using FFmpeg\n- Identifies each segment with Shazam API\n- Returns: Song title, artist, album, genre, year\n- **Purpose**: Identify specific songs in the video\n\n**Sequential Workflow Summary:**\n\n```\n1. Whisper (local)     â Speech transcription\n2. Gemini Audio (API)  â Detect music + timestamps, analyze non-speech audio\n3. FFmpeg              â Extract music segments (if music detected)\n4. Shazam (API)        â Identify songs (if music detected)\n```\n\nThis approach ensures:\n- Whisper focuses on speech (what it does best, runs locally)\n- Gemini provides overall audio understanding and music detection\n- Shazam only processes clean music segments (better accuracy)\n- No unnecessary API calls if no music is present\n\n**Gemini vs Shazam - Complementary Capabilities:**\n\n- **Gemini Audio API**: AI-powered audio understanding\n  - Recognizes music **characteristics**: genre, mood, instrumentation, tempo\n  - Example: \"Rock/Alternative song with electric guitar and male vocals, energetic\"\n  - May recognize well-known classical pieces (especially if mentioned in speech)\n  - Provides timestamps and musical context\n  - **Does NOT** identify specific tracks, artists, or albums\n\n- **Shazam**: Audio fingerprint matching\n  - Identifies **specific recordings**: track title, artist, album, year\n  - Example: \"Substitution - Silversun Pickups, Swoon (2009)\"\n  - Requires at least 3 seconds of audio for reliable identification\n  - Provides Shazam URLs and metadata\n\nBoth work together: Gemini describes what the music *sounds like*, Shazam identifies which specific *track* it is.\n\n\n\n**3.5. Context Clarification with Intelligent Question Generation**\n\n**CRITICAL STEP**: After gathering initial data (frames, audio, music identification), ask the user context questions to understand the video's perspective and avoid misidentification.\n\n**Why this step is critical**: Visual evidence alone can be ambiguous. For example, seeing streaming platform with a BRB screen could mean either:\n\n- The user is streaming and stepped away (creator perspective)\n- The user is watching someone else's stream (viewer perspective)\n\nOnly the user can clarify their relationship to the content.\n\n---\n\n## Workflow: Analyze First, Then Ask\n\n**Step 1: Complete Initial Data Gathering**\n\nBefore asking any questions, run the full analysis pipeline through Step 3c:\n\n- â Extract frames (Step 1)\n- â Extract and transcribe audio (Steps 2, 3a)\n- â Analyze audio with Gemini (Step 3b)\n- â Identify music with Shazam if detected (Step 3c)\n\n\n**Step 2: Build Contextual Evidence**\n\nReview what was gathered:\n\n- **Visual evidence**: Sample 3-5 frames - what's visible? (UI, people, environments, screen content)\n- **Audio evidence**: What's the audio content? (speech, music, ambient sounds)\n- **Music evidence**: What songs were identified? With what timestamps?\n- **Conversation context**: What has the user said about this video?\n- **User knowledge**: What do you know about this user from conversation history and preferences?\n\n**Step 3: Ask Context Question (Q1) with Evidence**\n\nPresent Q1 with context from your gathered evidence to help the user answer:\n\n```python\n# Build context string from evidence\n# Adapt summary based on what was found in the video\n\n# Example 1: Stream Viewer\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Streaming platform interface with BRB screen, person visible, workspace shown\n- Audio: Music playing (\"Song Title\" by Artist Name), minimal speech\n- Duration: 1:57\n\"\"\"\n\n# Example 2: Tutorial/How-to\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Person's hands visible working with materials, step-by-step demonstrations\n- Audio: Instructional narration explaining process, background music\n- Duration: 8:34\n\"\"\"\n\n# Example 3: Screen Recording (Software Demo)\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: VS Code editor with code visible, cursor movements, terminal commands\n- Audio: Voiceover explaining code changes, keyboard typing sounds\n- Duration: 5:12\n\"\"\"\n\n# Example 4: Screen Recording (Gameplay)\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Game interface with HUD elements, character movement, gameplay\n- Audio: Game sounds, background music, occasional commentary\n- Duration: 12:45\n\"\"\"\n\n# Example 5: Personal/Casual\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Person on camera in home setting, handheld/phone camera movement\n- Audio: Person speaking directly to camera, ambient room sounds\n- Duration: 2:18\n\"\"\"\n\n# Example 6: Personal/Casual (Phone Clip)\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Quick clip of outdoor scene, vertical/portrait orientation, casual framing\n- Audio: Ambient sounds, brief speech, wind noise\n- Duration: 0:43\n\"\"\"\n\n# Example 7: Event/Performance\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Stage with performers, audience visible, concert venue setting\n- Audio: Live music performance, crowd noise, applause\n- Duration: 3:56\n\"\"\"\n\n# Example 8: Presentation/Slides\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Slide deck with bullet points and diagrams, presenter occasionally visible\n- Audio: Presenter speaking, slide transition sounds\n- Duration: 18:24\n\"\"\"\n\n# Example 9: Casual Documentation (Workspace)\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Desk setup with monitors and equipment, informal camera angles\n- Audio: Background music, ambient office sounds, no narration\n- Duration: 1:34\n\"\"\"\n\n# Example 10: Behind-the-Scenes\nevidence_summary = \"\"\"I've analyzed the video and found:\n- Visual: Production equipment, camera setup, people working on set\n- Audio: Technical discussions, equipment sounds, music playing\n- Duration: 4:27\n\"\"\"\n\n# Template for implementation:\n# Select the most relevant description based on gathered evidence\ndef build_evidence_summary(frames_analysis, audio_analysis, music_data, duration):\n    \"\"\"\n    Generate evidence summary based on analyzed content\n\n    Returns contextual summary that helps user identify video type\n    \"\"\"\n    visual_desc = describe_visual_content(frames_analysis)\n    audio_desc = describe_audio_content(audio_analysis, music_data)\n\n    return f\"\"\"I've analyzed the video and found:\n- Visual: {visual_desc}\n- Audio: {audio_desc}\n- Duration: {format_duration(duration)}\n\"\"\"\n\n# Present Q1 with evidence context\nAskUserQuestion(\n    questions=[\n        {\n            \"question\": f\"{evidence_summary}\\n\\nWhat type of video is this?\",\n            \"header\": \"Video Type\",\n            \"multiSelect\": false,\n            \"options\": [\n                {\n                    \"label\": \"Tutorial/How-to\",\n                    \"description\": \"Teaching or demonstrating something step-by-step\"\n                },\n                {\n                    \"label\": \"Personal\",\n                    \"description\": \"Personal video, daily life content, a moment or activity, clip from phone\"\n                },\n                {\n                    \"label\": \"Screen recording\",\n                    \"description\": \"Recording your own screen (software demo, debugging video, gameplay, etc.)\"\n                },\n                {\n                    \"label\": \"Watching something\",\n                    \"description\": \"Recording yourself viewing someone else's content\"\n                },\n                {\n                    \"label\": \"Event/Performance\",\n                    \"description\": \"Concert, presentation, ceremony, or live event\"\n                },\n                {\n                    \"label\": \"Other/Not sure\",\n                    \"description\": \"Type a custom description of what this video shows\"\n                }\n            ]\n        }\n    ]\n)\n```\n\n**Key Patterns in Evidence Summaries:**\n\n1. **Be specific about what's visible**: Not just \"screen content\" but \"VS Code editor with code\" or \"Streaming platform interface with BRB screen\"\n\n2. **Mention identifying audio**: \"Music playing (song identified)\" vs. \"instructional narration\" vs. \"live performance audio\"\n\n3. **Note video characteristics**: Portrait orientation, handheld movement, production quality\n\n4. **Keep it concise**: 2-3 bullet points max, user can read it quickly\n\n5. **Help user self-identify**: Evidence should make the correct option obvious\n\n**Step 4: Generate Smart Follow-up (Q2) Based on Evidence + Q1 Answer**\n\n**CRITICAL**: Generate Q2 dynamically based on:\n\n- â User's Q1 answer\n- â Visual evidence from frames\n- â Audio evidence from transcription/Gemini\n- â Music identification results\n- â Conversation context\n- â User preferences and history\n\n**Skip Q2 entirely if**:\n\n- The evidence makes the context obvious\n- Q1 answer is self-explanatory (Tutorial, Event/Performance)\n- You're highly confident about the analysis direction\n\n**Generate custom Q2 if needed**:\n\n**If Q1 = \"Watching something\" AND you identified what they were watching:**\n\n```python\n# Example: You saw streaming platform + identified music\nAskUserQuestion(\n    questions=[\n        {\n            \"question\": \"I can see streaming platform with a BRB screen and identified 'Song Title' by Artist Name playing in the background. Is this what was happening?\",\n            \"header\": \"Confirm Context\",\n            \"multiSelect\": false,\n            \"options\": [\n                {\n                    \"label\": \"Yes, that's correct\",\n                    \"description\": \"Watching a stream with music playing in my space\"\n                },\n                {\n                    \"label\": \"Partially correct\",\n                    \"description\": \"Some of that is right, but let me clarify\"\n                },\n                {\n                    \"label\": \"No, different context\",\n                    \"description\": \"That's not quite what was happening\"\n                }\n            ]\n        }\n    ]\n)\n```\n\n**If Q1 = \"Watching something\" AND you're uncertain what:**\n\n```python\nAskUserQuestion(\n    questions=[\n        {\n            \"question\": \"What were you watching?\",\n            \"header\": \"Content Source\",\n            \"multiSelect\": true,  # Allow multiple selections\n            \"options\": [\n                {\n                    \"label\": \"Live stream\",\n                    \"description\": \"Streaming platforms, Twitch, YouTube live, etc.\"\n                },\n                {\n                    \"label\": \"Video content\",\n                    \"description\": \"YouTube video, movie, TV show, etc.\"\n                },\n                {\n                    \"label\": \"Music playing\",\n                    \"description\": \"Music was playing in your space\"\n                },\n                {\n                    \"label\": \"Other media\",\n                    \"description\": \"Game, presentation, or other content\"\n                }\n            ]\n        }\n    ]\n)\n```\n\n**If Q1 = \"Personal\" AND video shows workspace/music:**\n\n```python\n# You already know music was playing and workspace is visible\n# Generate confirmation question instead of generic tags\nAskUserQuestion(\n    questions=[\n        {\n            \"question\": \"I can see your workspace and 'Song Title' playing. What tags describe this video?\",\n            \"header\": \"Context Tags\",\n            \"multiSelect\": true,\n            \"options\": [\n                {\n                    \"label\": \"Music playing\",\n                    \"description\": \"Background music in your space\"\n                },\n                {\n                    \"label\": \"Workspace/setup\",\n                    \"description\": \"Showing desk, equipment, or environment\"\n                },\n                {\n                    \"label\": \"Activity in progress\",\n                    \"description\": \"Doing something while recording\"\n                },\n                {\n                    \"label\": \"Artistic/experimental\",\n                    \"description\": \"Creative or artistic intent\"\n                }\n            ]\n        }\n    ]\n)\n```\n\n**If Q1 = \"Screen recording\":**\n\n```python\n# Only ask if genuinely uncertain from frames\n# You likely already saw what's on screen\nAskUserQuestion(\n    questions=[\n        {\n            \"question\": \"I can see {specific_app_or_content}. What were you recording?\",\n            \"header\": \"Screen Content\",\n            \"multiSelect\": false,\n            \"options\": [\n                {\n                    \"label\": \"Software/application\",\n                    \"description\": \"Demonstrating a program or workflow\"\n                },\n                {\n                    \"label\": \"Gameplay\",\n                    \"description\": \"Playing a game\"\n                },\n                {\n                    \"label\": \"Design/creative work\",\n                    \"description\": \"Working in design tools, editors, etc.\"\n                },\n                {\n                    \"label\": \"General computer use\",\n                    \"description\": \"Browsing, chatting, or mixed activities\"\n                }\n            ]\n        }\n    ]\n)\n```\n\n**If Q1 = \"Tutorial/How-to\" or \"Event/Performance\":**\nâ **Skip Q2** - these are self-explanatory, proceed to analysis\n\n**If Q1 = \"Other/Not sure\" (custom text provided):**\nâ Use the custom text to inform analysis, **skip Q2** unless truly necessary\n\n---\n\n## Store and Use Metadata\n\nAfter Q1 (and Q2 if asked), store structured metadata:\n\n```python\nvideo_metadata = {\n    \"video_type\": user_q1_answer,           # \"Watching something\"\n    \"perspective\": derived_perspective,      # \"First-Person Viewer\"\n    \"content_tags\": user_q2_answers,        # [\"live stream\", \"music playing\"]\n    \"evidence\": {\n        \"visual\": visual_summary,            # From frames\n        \"audio\": audio_summary,              # From Gemini\n        \"music\": music_identification,       # From Shazam\n        \"duration\": video_duration\n    }\n}\n```\n\n**Use this metadata throughout remaining analysis:**\n\n- Guide visual analysis focus (Step 5)\n- Inform subagent prompts\n- Set appropriate terminology in final summary\n- Avoid misidentifying perspective or intent\n\n---\n\n## Example: Context-Aware Question Flow\n\n**Scenario**: User shares video showing streaming platform with BRB screen, person visible, music playing\n\n**Data Gathered (Steps 1-3d)**:\n\n- Frames: Streaming platform UI, BRB overlay, person, workspace visible\n- Audio: Music \"Song Title\" by Artist Name (0:32-1:57), minimal speech\n- Duration: 1:57\n- Context: User information from conversation history\n\n**Q1 with Context**:\n\n```\nI've analyzed the video and found:\n- Visual: Streaming platform interface with BRB screen, person visible, workspace shown\n- Audio: Music playing (\"Song Title\" by Artist Name), minimal speech\n- Duration: 1:57\n\nWhat type of video is this?\nâ User selects: \"Watching something\"\n```\n\n**Smart Q2 Generation**:\n\n```python\n# You already know:\n# - Streaming platform with BRB = watching a stream\n# - Music identified = \"Song Title\" playing in their space\n# - Person visible = user on camera\n\n# Instead of generic \"What were you watching?\", generate specific confirmation:\n\"I can see streaming platform with a BRB screen and identified 'Song Title' by Artist Name\nplaying in the background. Were you watching someone's stream while music played in your space?\"\n\nOptions:\n- Yes, that's correct\n- Partially - let me clarify\n- No, different context\n```\n\n**Result**: Only 2 questions needed, and Q2 is informed and specific rather than generic.\n\n**Alternative - High Confidence, Skip Q2**:\nIf extremely confident from evidence, skip Q2 entirely:\n\n```\nQ1 answer: \"Watching something\"\n\nâ Skip Q2, proceed with metadata:\n{\n  video_type: \"Watching something\",\n  perspective: \"First-Person Viewer\",\n  content_tags: [\"live stream\", \"music playing\", \"workspace visible\"]\n}\n```\n\n---\n\n## Benefits of This Approach\n\n1. **Evidence-informed questions**: Q1 includes what you found, helping user answer\n2. **Smart Q2 generation**: Tailored to what you already know + user's Q1 answer\n3. **Skip when confident**: Don't ask unnecessary questions if evidence is clear\n4. **Confirmation over discovery**: Ask \"Is this correct?\" when you have strong evidence\n5. **Context-aware**: Uses conversation history, user preferences, and gathered data\n6. **Prevents misidentification**: Clarifies creator vs. viewer perspective early\n7. **Efficient**: Maximum 2 questions, often just 1\n\n---\n\n## Integration with Remaining Workflow\n\nAfter completing Step 3.5 (Context Clarification), proceed to:\n\n**Step 4**: Video Type Detection and Analysis Strategy\n\n- Use `video_metadata.perspective` to select appropriate analysis focus\n- Apply type-specific guidance based on clarified context\n\n**Step 5**: Visual Analysis with video-frame-analyzer Subagent(s)\n\n- Pass `video_metadata` to subagent prompts\n- Ensure analysis matches user's stated relationship to content\n- Use correct terminology (viewer/creator/observer language)\n\nThe metadata from context clarification informs all downstream analysis.\n\n---\n\n**4. Video Perspective and Type Detection (UPDATED)**\n\nAfter context clarification (Step 3.5), use the user's answers and gathered evidence to determine the appropriate analysis approach.\n\n---\n\n## Two-Dimensional Classification System\n\n**Dimension 1: Perspective** (Who is filming and why?)\n**Dimension 2: Content Type** (What's in the video?)\n\n### Perspective Classification\n\nDerive perspective from user's Q1 answer and evidence:\n\n| User's Q1 Answer | Perspective | Analysis Approach |\n|------------------|-------------|-------------------|\n| Tutorial/How-to | **First-Person Creator** | User is teaching/presenting |\n| Personal | **First-Person Creator** OR **Meta/Hybrid** | User is documenting their own life/activities |\n| Screen recording | **First-Person Creator** | User is demonstrating their own screen |\n| Watching something | **First-Person Viewer** | User is consuming someone else's content |\n| Event/Performance | **Third-Person Observer** | User is filming someone/something else |\n| Other/custom text | **Derive from description** | Analyze custom text to determine |\n\n### Expanded Content Type Taxonomy\n\nBased on perspective, select the appropriate content type analysis:\n\n---\n\n## First-Person Viewer Types\n\n**The user is watching/consuming content created by others**\n\n### Stream Viewer\n\n**Indicators**:\n\n- Visual: Streaming platform UI (Discord, Twitch, YouTube), others' stream content, BRB screens, chat visible\n- Audio: Music in viewer's space, ambient sounds, minimal commentary\n- Evidence: Streaming platform visible, user not the presenter/streamer\n\n**Analysis Focus**:\n\n- **Primary**: What stream/content is being watched? (streamer name, stream title, platform)\n- **Track**: BRB screens, waiting periods, stream states, chat activity\n- **Note**: Viewer's environment (workspace, room, objects visible)\n- **Look For**:\n  - Parallel activities (what is viewer doing while watching?)\n  - Music or ambient audio in viewer's space (distinct from stream audio)\n  - Environmental context and mood\n  - Correlation between stream content and viewer behavior\n\n### Reaction Video\n\n**Indicators**:\n\n- Visual: Split screen (content + reactor) or switches between content and reactions\n- Audio: Commentary over content, reactions, pauses for analysis\n- Evidence: User visible reacting to visible content\n\n**Analysis Focus**:\n\n- **Primary**: What content is being reacted to? User's reactions and commentary\n- **Track**: Reaction timing, pauses, emotional responses\n- **Note**: User's analysis, critiques, or engagement with content\n- **Look For**: Key moments that trigger reactions, commentary themes\n\n### Viewing Documentation\n\n**Indicators**:\n\n- Visual: Browser/player UI, content consumption in progress, informal framing\n- Audio: Background music, ambient sounds, casual environment\n- Evidence: Passive viewing being documented\n\n**Analysis Focus**:\n\n- **Primary**: What's being consumed, why is it being documented\n- **Track**: Viewing progression, pauses, environmental changes\n- **Note**: Mood, atmosphere, context for documentation\n- **Look For**: Artistic intent, thematic connections\n\n---\n\n## First-Person Creator Types\n\n**The user is creating/presenting content**\n\n### Tutorial/How-to\n\n**Indicators**:\n\n- Visual: Step-by-step demonstrations, hands visible, process shown\n- Audio: Instructional narration, explanations, process sounds\n- Evidence: Deliberate teaching structure\n\n**Analysis Focus**:\n\n- **Primary**: What's being taught, step-by-step process\n- **Track**: Instructions, materials/tools, technique demonstrations\n- **Note**: Key concepts, warnings, tips\n- **Look For**: Learning objectives, common mistakes addressed\n\n### Screen Recording (Creator)\n\n**Indicators**:\n\n- Visual: User's own screen with deliberate navigation, cursor movements, UI interactions\n- Audio: Voiceover tutorial, keyboard clicks, narration\n- Evidence: User demonstrating their own workflow\n\n**Analysis Focus**:\n\n- **Primary**: UI elements, workflow steps, applications used\n- **Track**: Mouse/cursor position, clicked elements, opened applications\n- **Note**: Workflow steps, error messages, command sequences\n- **Look For**: Transitions between applications, file operations, settings changes\n\n### Personal (Vlog/Life Content)\n\n**Indicators**:\n\n- Visual: Person on camera, home/outdoor settings, handheld or mounted camera\n- Audio: Direct-to-camera speech, personal narrative, ambient sounds\n- Evidence: User sharing personal moments or experiences\n\n**Analysis Focus**:\n\n- **Primary**: Setting/location, what person is saying/doing\n- **Track**: Emotional tone, activities, locations visited\n- **Note**: Personal details, narrative arc, objects/items shown\n- **Look For**: Story progression, mood shifts, environment changes\n\n### Presentation/Slides\n\n**Indicators**:\n\n- Visual: Slide layouts, bullet points, diagrams, presenter view\n- Audio: Presenter speaking, slide advance sounds\n- Evidence: Formal presentation structure\n\n**Analysis Focus**:\n\n- **Primary**: Slide content (headings, bullet points, data)\n- **Track**: Slide numbers, transitions, presenter appearance\n- **Note**: Key concepts, visualizations, quotes, formulas\n- **Look For**: Slide themes, speaker gestures, main arguments\n\n---\n\n## Meta/Hybrid Types\n\n**The user is documenting the process of creating/consuming**\n\n### Casual Documentation\n\n**Indicators**:\n\n- Visual: Informal framing, switches between activities, workspace visible, no clear structure\n- Audio: Ambient audio, music, casual speech, environmental sounds\n- Evidence: Informal recording of moments/activities\n\n**Analysis Focus**:\n\n- **Primary**: Activities happening, personal environment, objects/items\n- **Track**: Environmental changes, mood shifts, items introduced\n- **Note**: Personal details that provide context, atmosphere\n- **Look For**:\n  - Documentary-style observations\n  - Authentic, unscripted moments\n  - Connections between visual, audio, and thematic elements\n  - Artistic or experimental intent\n\n### Behind-the-Scenes\n\n**Indicators**:\n\n- Visual: Production equipment visible, setup shots, workspace, process in action\n- Audio: Technical discussions, process sounds, tools being used\n- Evidence: Documenting creation workflow\n\n**Analysis Focus**:\n\n- **Primary**: Creation process, tools/equipment, methodology\n- **Track**: Setup changes, workflow steps, technical decisions\n- **Note**: Challenges encountered, solutions implemented\n- **Look For**: Insights into creative/production process\n\n### Process Video\n\n**Indicators**:\n\n- Visual: Work-in-progress visible, tools/software, iterative changes\n- Audio: Narration of process, thinking out loud, work sounds\n- Evidence: Documenting work as it happens\n\n**Analysis Focus**:\n\n- **Primary**: Steps taken, decision-making, progress\n- **Track**: Iterations, changes, refinements\n- **Note**: Reasoning, challenges, solutions\n- **Look For**: Learning moments, key decisions\n\n---\n\n## Third-Person Observer Types\n\n**The user is filming someone/something else**\n\n### Event/Performance\n\n**Indicators**:\n\n- Visual: Stage/venue, audience, performers, event setting\n- Audio: Live audio, applause, ambient event noise\n- Evidence: User filming an event they're attending\n\n**Analysis Focus**:\n\n- **Primary**: Performers, performance content, venue\n- **Track**: Key performance moments, crowd reactions, technical elements\n- **Note**: Event highlights, special effects, atmosphere\n- **Look For**: Memorable moments, mistakes, energy shifts\n\n### Interview/Podcast\n\n**Indicators**:\n\n- Visual: Two+ people, static camera, simple background\n- Audio: Conversational dialogue, minimal music\n- Evidence: Discussion/interview being filmed\n\n**Analysis Focus**:\n\n**5. Visual Analysis with video-frame-analyzer Subagent(s)**\n\nAfter frames are extracted AND video type is assessed, delegate to the specialized **video-frame-analyzer** subagent(s) for systematic visual analysis:\n\n**Single Subagent (< 30 frames):**\nFor videos with fewer than 30 frames, use a single subagent:\n\n**IMPORTANT**: Use the full qualified subagent name: `video-toolkit:video-frame-analyzer`\n\n**Step 1: Assess Video Type (sample first 3-5 frames)**\n\nBefore full analysis, quickly review a few early frames to determine video type and appropriate analysis focus:\n\n```\nUse the video-toolkit:video-frame-analyzer subagent to assess video type from /tmp/video-toolkit-[timestamp]/frames\n\nSample frames 1-5 and determine:\n1. Video type (screen recording, vlog, presentation, music video, tutorial, etc.)\n2. Recommended analysis focus based on type (see Type-Specific Analysis Focus section)\n3. Key elements to track throughout the video\n\nSave assessment to: /tmp/video-toolkit-[timestamp]/video-type-assessment.md\n```\n\n**Step 2: Full Frame Analysis (with type-adaptive prompts)**\n\n```\nUse the video-toolkit:video-frame-analyzer subagent to analyze the frames in /tmp/video-toolkit-[timestamp]/frames\n\n**Video Type Detected:** [Insert detected type from assessment]\n\nThe following files are available:\n- Frames: /tmp/video-toolkit-[timestamp]/frames/*.png (X frames total)\n- Metadata: /tmp/video-toolkit-[timestamp]/frames/frames_metadata.json (contains frame timestamps)\n- Transcript: /tmp/video-toolkit-[timestamp]/transcript.md (if video has audio)\n- Audio Analysis: /tmp/video-toolkit-[timestamp]/audio_analysis.md (Gemini audio understanding, if available)\n- Music Identification: /tmp/video-toolkit-[timestamp]/music_identification.md (Shazam results, if music detected)\n- Video Type Assessment: /tmp/video-toolkit-[timestamp]/video-type-assessment.md\n\nBased on the detected video type, apply appropriate analysis focus:\n[Insert type-specific focus points from Type-Specific Analysis Focus section]\n\nAnalyze all frames, correlate visual content with transcript/audio using timestamps, and pay special attention to elements relevant for this video type.\n\nSave your complete analysis to: /tmp/video-toolkit-[timestamp]/video-analysis.md\n```\n\n**Parallel Subagents (â¥ 30 frames):**\nFor videos with 30+ frames, **spawn multiple video-toolkit:video-frame-analyzer subagents in parallel**, each handling a subset of frames:\n\n**IMPORTANT**:\n- Use the full qualified subagent name: `video-toolkit:video-frame-analyzer`\n- Use a single message with multiple Task tool calls to run agents in parallel\n\nExample for 50 frames:\n\n```\n# Spawn 5 subagents in parallel, each analyzing 10 frames\n# Agent 1: frames 1-10\n# Agent 2: frames 11-20\n# Agent 3: frames 21-30\n# Agent 4: frames 31-40\n# Agent 5: frames 41-50\n```\n\n**How to split frames:**\n\n- **30-50 frames**: 3-5 subagents (10 frames each) - launch all in parallel\n- **50-100 frames**: 5-10 subagents (10 frames each) - launch in waves of 5\n- **100+ frames**: Consider using interval mode instead, or max 10 subagents in waves\n\n**Staged Execution for Long Videos:**\nFor videos requiring more than 5 subagents, launch them in **waves** to avoid overwhelming the system:\n\n**Example: 100 frames = 10 subagents**\n\n- **Wave 1**: Launch subagents 1-5 in parallel (frames 1-50)\n- Wait for Wave 1 to complete\n- **Wave 2**: Launch subagents 6-10 in parallel (frames 51-100)\n- Wait for Wave 2 to complete\n- Synthesize all results\n\n**Why staged execution?**\n\n- Prevents too many concurrent subagents\n- Better resource management\n- Easier to debug if something fails\n- More predictable performance\n\n**Prompt for parallel subagents:**\n\n**IMPORTANT**:\n1. First, assess video type with a quick subagent analyzing frames 1-5\n2. Then create the `partial-analyses/` directory: `mkdir -p /tmp/video-toolkit-[timestamp]/partial-analyses`\n3. Launch parallel subagents with type-aware prompts\n\n**Step 1: Quick Video Type Assessment**\n\n```\nUse the video-toolkit:video-frame-analyzer subagent to assess video type from frames 1-5 in /tmp/video-toolkit-[timestamp]/frames\n\nSample the first 5 frames and determine:\n1. Video type (screen recording, vlog, presentation, music video, tutorial, interview, documentary, gameplay, event, animation)\n2. Recommended analysis focus based on type\n3. Key elements to track throughout\n\nReview audio analysis if available to help determine type.\n\nSave assessment to: /tmp/video-toolkit-[timestamp]/video-type-assessment.md\n```\n\n**Step 2: Type-Adaptive Parallel Analysis**\n\nAfter video type is assessed, use this prompt template for each parallel subagent:\n\n```\nUse the video-toolkit:video-frame-analyzer subagent to analyze frames [start]-[end] from /tmp/video-toolkit-[timestamp]/frames\n\n**Video Type:** [Insert type from assessment]\n**Analysis Focus:** [Insert relevant focus points for this type]\n\nFiles available:\n- Frames: frame_00[start].png through frame_00[end].png\n- Metadata: /tmp/video-toolkit-[timestamp]/frames/frames_metadata.json\n- Transcript: /tmp/video-toolkit-[timestamp]/transcript.md (if available)\n- Audio Analysis: /tmp/video-toolkit-[timestamp]/audio_analysis.md (if available)\n- Video Type Assessment: /tmp/video-toolkit-[timestamp]/video-type-assessment.md\n\nFocus on frames [start] through [end] only. Based on video type, provide:\n1. Timestamp range covered\n2. Visual content description (emphasize type-specific elements)\n3. Key elements for this video type (UI/text for screen recordings, actions/setting for vlogs, etc.)\n4. Scene changes within your range\n5. Correlation with transcript/audio (if applicable)\n\nSave your analysis to: /tmp/video-toolkit-[timestamp]/partial-analyses/part[N].md\n```\n\n**Example for Vlog/Personal Video:**\n\n```\nUse the video-toolkit:video-frame-analyzer subagent to analyze frames 1-12 from /tmp/video-toolkit-[timestamp]/frames\n\n**Video Type:** Vlog/Personal\n**Analysis Focus:**\n- Primary: Setting/location, people present, activities happening\n- Track: Emotional tone, interactions, objects/items shown\n- Note: What person is doing, wearing, holding\n- Look For: Personal details (smoking, eating, gestures), environment changes\n\nFiles available:\n- Frames: frame_0001.png through frame_0012.png\n- Metadata: /tmp/video-toolkit-[timestamp]/frames/frames_metadata.json\n- Transcript: /tmp/video-toolkit-[timestamp]/transcript.md\n- Audio Analysis: /tmp/video-toolkit-[timestamp]/audio_analysis.md\n- Video Type Assessment: /tmp/video-toolkit-[timestamp]/video-type-assessment.md\n\nFocus on frames 1-12. Provide:\n1. Timestamp range: 0:00 - 0:22\n2. Visual content: Describe setting, people, activities with attention to personal details\n3. Personal elements: Note smoking, gestures, objects held, clothing, emotional state\n4. Scene/environment changes within this range\n5. Correlation with what's being said (transcript) and music/ambient audio\n\nSave your analysis to: /tmp/video-toolkit-[timestamp]/partial-analyses/part1.md\n```\n\n**Example Task tool invocation:**\n```python\n# First create the directory\nBash(\"mkdir -p /tmp/video-toolkit-[timestamp]/partial-analyses\")\n\n# Then spawn parallel subagents\nTask(\n    subagent_type=\"video-toolkit:video-frame-analyzer\",\n    description=\"Analyze frames 1-13\",\n    prompt=\"Analyze frames 1-13... Save to: /tmp/video-toolkit-[timestamp]/partial-analyses/part1.md\"\n)\n```\n\n**After parallel analysis completes:**\n\n1. Read all partial analyses from `partial-analyses/` directory (part1.md, part2.md, etc.)\n2. Synthesize into a unified comprehensive summary file at `/tmp/video-toolkit-[timestamp]/video-analysis.md`\n3. Correlate findings across all sections\n4. Clean up: `rm -rf /tmp/video-toolkit-[timestamp]/partial-analyses`\n5. **Save comprehensive analysis alongside source video** (see step 7 in Combined Summary Generation below)\n6. Present final summary to user\n\n**What the subagent(s) do:**\n\n- **Read frames_metadata.json** for accurate frame-to-timestamp mapping\n- **Read transcript.md** (if available) for audio content\n- Systematically analyze assigned frames using vision capabilities\n- **Correlate visual content with spoken dialogue** using timestamps\n- Identify video type, UI elements, text, and visual patterns\n- Generate analysis with multimodal correlation\n\n\n- **Note**: Important quotes, key points, visual aids\n- **Look For**: Emotional moments, agreements/disagreements\n\n### Documentary\n\n**Indicators**:\n\n- Visual: B-roll footage, archival material, location shots, graphics\n- Audio: Narrator voiceover, ambient audio, music\n- Evidence: Documentary storytelling structure\n\n**Analysis Focus**:\n\n- **Primary**: B-roll content, archival material, locations\n- **Track**: Text overlays (names, dates, locations), graphics\n- **Note**: Historical context, expert interviews, data\n- **Look For**: Primary sources, reenactments, maps/timelines\n\n---\n\n## Using the Classification\n\nAfter determining **perspective** and **content type** from Step 3.5 context clarification:\n\n1. **Select the appropriate analysis focus** from the tables above\n2. **Apply type-specific guidance** to visual analysis (Step 5)\n3. **Use correct terminology** in subagent prompts and final summary\n4. **Avoid misidentification** by respecting the user's stated relationship to the content\n\n**Example for \"Stream Viewer\" (First-Person Viewer)**:\n\n```python\nvideo_metadata = {\n    \"video_type\": \"Watching something\",\n    \"perspective\": \"First-Person Viewer\",\n    \"content_type\": \"Stream Viewer\",\n    \"context_tags\": [\"live stream\", \"music playing\"],\n    \"analysis_focus\": {\n        \"primary\": \"Stream content being watched, viewer's environment\",\n        \"track\": \"BRB screens, stream states, workspace, parallel activities\",\n        \"note\": \"Music in viewer's space, environmental context, mood\",\n        \"look_for\": \"Correlation between stream and viewer behavior, thematic connections\"\n    }\n}\n```\n\nThis metadata guides all subsequent analysis steps.\n\n---\n\n# Restructured Workflow: Optional Song Theme Research\n\n## Current Issue\n\nSong theme research (Step 3d) currently happens automatically after music identification, but:\n\n- Not all videos need thematic music analysis\n- Tutorial with background music? Music is just ambiance\n- Screen recording with Spotify playing? Not relevant to content\n- Wastes time/tokens when music isn't thematically important\n\n## Solution: Move to After Context Clarification\n\n**New sequence**:\n\n1. Frame Extraction\n2. Audio Extraction\n3. Audio Analysis (Sequential Workflow)\n   - 3a. Speech Transcription (Whisper)\n   - 3b. Audio Understanding (Gemini)\n   - 3c. Music Identification (Shazam - if music detected)\n   - ~~3d. Song Theme Research~~ â **REMOVE FROM HERE**\n4. Context Clarification (NEW - Step 3.5)\n5. Video Perspective and Type Detection\n6. **OPTIONAL: Song Theme Research** â **MOVE TO HERE (becomes Step 5.5)**\n7. Visual Analysis with subagents\n\n## When to Research Song Themes (Conditional Logic)\n\n**Research song themes IF**:\n\n- Video type suggests thematic music importance\n- User context indicates artistic/creative intent\n- Music plays during significant portions of video\n- Multiple perspective/content switches suggest deliberate choices\n\n**Skip song theme research IF**:\n\n- Video type is purely functional (tutorial, screen recording demo)\n- Music is brief background ambiance\n- User context suggests music is incidental\n- Analysis focus doesn't benefit from song meaning\n\n---\n\n## Step 5.5: Optional Song Theme Research (NEW)\n\n**When to Use**: After determining video type and perspective (Steps 3.5 and 4), conditionally research song themes if music appears thematically relevant.\n\n### Decision Logic\n\n**Research song themes for these video types**:\n\n| Video Type | Perspective | When to Research | Reasoning |\n|------------|-------------|------------------|-----------|\n| **Stream Viewer** | First-Person Viewer | â USUALLY | Music in viewer's space may have thematic connection to stream content or mood |\n| **Casual Documentation** | Meta/Hybrid | â USUALLY | Artistic/creative videos often use music deliberately |\n| **Personal** | First-Person Creator | â IF ARTISTIC | Only if video seems artistic/experimental vs. casual life clip |\n| **Music Video/Creative** | First-Person Creator | â ALWAYS | Music is the primary content |\n| **Vlog/Personal** | First-Person Creator | â ï¸ CONDITIONAL | Only if music plays significant role |\n| **Behind-the-Scenes** | Meta/Hybrid | â ï¸ CONDITIONAL | Only if music seems intentionally chosen |\n| **Tutorial/How-to** | First-Person Creator | â SKIP | Music is background, not thematic |\n| **Screen Recording** | First-Person Creator | â SKIP | Music is incidental (Spotify/background) |\n| **Presentation** | First-Person Creator | â SKIP | Music not relevant to content |\n| **Event/Performance** | Third-Person Observer | â SKIP | Music is part of event, not selected |\n\n### Conditional Check\n\nBefore researching song themes, evaluate:\n\n```python\ndef should_research_song_themes(video_metadata, music_data):\n    \"\"\"\n    Determine if song theme research would benefit analysis\n\n    Args:\n        video_metadata: From Step 3.5 context clarification\n        music_data: From Step 3c music identification\n\n    Returns:\n        bool: True if research would be valuable\n    \"\"\"\n\n    # No music detected? Skip\n    if not music_data.get(\"has_music\"):\n        return False\n\n    # Check video type thematic relevance\n    video_type = video_metadata[\"video_type\"]\n    perspective = video_metadata[\"perspective\"]\n\n    # Always research for these types\n    always_research = [\n        \"Music Video/Creative\",\n        \"Watching something\" + \"First-Person Viewer\",  # Stream viewer\n        \"Casual documentation\" + \"Meta/Hybrid\"\n    ]\n\n    # Never research for these types\n    skip_research = [\n        \"Tutorial/How-to\",\n        \"Screen recording\" + \"First-Person Creator\",\n        \"Presentation\",\n        \"Event/Performance\"\n    ]\n\n    # Check if video type + perspective matches \"always\" patterns\n    if any(pattern in f\"{video_type} + {perspective}\" for pattern in always_research):\n        return True\n\n    # Check if video type matches \"skip\" patterns\n    if any(pattern in video_type for pattern in skip_research):\n        return False\n\n    # Conditional cases - check additional factors\n\n    # Music duration significant? (>30% of video)\n    music_duration = sum(segment[\"duration\"] for segment in music_data[\"music_segments\"])\n    video_duration = video_metadata[\"evidence\"][\"duration\"]\n\n    if music_duration / video_duration > 0.3:\n        return True  # Music plays significant role\n\n    # User context suggests artistic intent?\n    context_tags = video_metadata.get(\"context_tags\", [])\n    if \"artistic/experimental\" in context_tags:\n        return True\n\n    # Default: skip unless evidence suggests thematic importance\n    return False\n```\n\n### Implementation\n\n**If research is warranted:**\n\n```python\nif should_research_song_themes(video_metadata, music_data):\n    # Research themes for each identified song\n    for song in music_data[\"songs\"]:\n        query = f\"{song['title']} {song['artist']} lyrics meaning themes\"\n\n        # Try Perplexity first (better for analysis)\n        try:\n            results = mcp__perplexity_search_web(query, recency=\"year\")\n            song[\"themes\"] = extract_themes(results)\n        except:\n            # Fallback to WebSearch if Perplexity unavailable\n            results = WebSearch(query)\n            song[\"themes\"] = extract_themes(results)\n\n    # Store theme research in metadata\n    video_metadata[\"song_themes\"] = {\n        song[\"title\"]: song[\"themes\"] for song in music_data[\"songs\"]\n    }\nelse:\n    # Skip research, note music was identified but themes not needed\n    video_metadata[\"song_themes\"] = None\n    # Music identification results still available in music_data\n```\n\n**Communicate decision to user:**\n\n```markdown\nâ Music identified: \"Song Title\" by Artist Name (2009)\nâ Researching song themes (video appears to use music thematically)\n  â Themes: song themes and meaning\n```\n\nOR\n\n```markdown\nâ Music identified: \"Background Music Track\" (ambient)\nâ Skipping theme research (background music, not thematically relevant)\n```\n\n### Benefits\n\n1. **Efficiency**: Don't waste time/tokens on irrelevant research\n2. **Precision**: Only research when it enhances understanding\n3. **User experience**: Clear communication about what's happening\n4. **Flexibility**: Easy to adjust criteria based on video type\n\n### Example Decisions\n\n**Example 1: Stream Viewer Video (Em's case)**\n\n- Video type: \"Watching something\" (Stream Viewer)\n- Music: \"Song Title\" playing 0:32-1:57 (85% of video duration)\n- Decision: â **Research themes** - music significant + viewer perspective\n- Result: Themes inform understanding of why this song was chosen\n\n**Example 2: Coding Tutorial**\n\n- Video type: \"Tutorial/How-to\"\n- Music: Lo-fi beats playing throughout\n- Decision: â **Skip research** - background ambiance for focus\n- Result: Music noted but themes not analyzed\n\n**Example 3: Personal Phone Clip**\n\n- Video type: \"Personal\"\n- Music: 10 seconds of radio in background\n- Context tags: None suggesting artistic intent\n- Music duration: 10s / 120s = 8%\n- Decision: â **Skip research** - incidental background music\n- Result: Music noted but not analyzed\n\n**Example 4: Artistic Video Essay**\n\n- Video type: \"Personal\"\n- Music: Specific song playing throughout\n- Context tags: [\"artistic/experimental\"]\n- Music duration: 90s / 100s = 90%\n- Decision: â **Research themes** - artistic intent + significant duration\n- Result: Themes analyzed for artistic interpretation\n\n---\n\n## Updated SKILL.md Structure\n\n```markdown\n**3. Audio Analysis (Sequential Workflow)**\n- 3a. Speech Transcription (Whisper)\n- 3b. Audio Understanding (Gemini)\n- 3c. Music Identification (Shazam - if music detected)\n\n\n*6. Combined Summary Generation**\n\nAfter the video-frame-analyzer completes its analysis, synthesize all multimodal insights:\n\n**Available Analysis Files:**\n- `video-type-assessment.md` - Video type and analysis strategy\n- `transcript.md` - Speech transcription (Whisper)\n- `audio_analysis.md` - Audio understanding (Gemini)\n- `music_identification.md` - Identified songs (Shazam, if music detected)\n- `video-analysis.md` - Visual analysis (video-frame-analyzer, type-aware)\n- `reconciled_transcript.md` - Reconciled transcript (optional, created by comparing Whisper + Gemini)\n\n**Synthesis Steps:**\n1. Review video type assessment to understand analysis context\n2. Review visual analysis from video-frame-analyzer (type-aware analysis)\n3. If music was identified, review song themes from web search for thematic context\n4. **Compare and reconcile transcripts** (OPTIONAL):\n   - **ALWAYS spawn a Task subagent (general-purpose) to compare transcripts** (reduces token usage in main thread)\n   - The subagent should:\n     - Read both `transcript.md` (Whisper) and `audio_analysis.md` (Gemini) for speech content\n     - Note that Whisper specializes in speech transcription but can mishear words\n     - Note that Gemini Audio API also transcribes speech and may catch errors Whisper missed\n     - **Compare the two transcripts** and identify any discrepancies\n     - Use context, grammar, and semantic meaning to determine which is more accurate\n     - Create a reconciled transcript that uses the most accurate version\n     - Document any significant differences and reasoning for choices\n     - Save the reconciled transcript to `/tmp/video-toolkit-[timestamp]/reconciled_transcript.md`\n   - After subagent completes, read the reconciled transcript for use in synthesis\n3. Review audio analysis for non-speech sounds and music description\n4. If music was identified, review song details with timestamps\n5. **Correlate all insights using timestamps** to create unified narrative\n6. Identify synchronization between:\n   - What's visible (frames)\n   - What's said (Whisper)\n   - What's heard (Gemini audio)\n   - What music is playing (Shazam)\n7. **IMPORTANT: Save comprehensive analysis alongside source video**\n   - Copy `/tmp/video-toolkit-[timestamp]/video-analysis.md` to replace the placeholder analysis file\n   - Target location: `<video-directory>/<video-name>-analysis.md`\n   - This ensures the detailed analysis persists alongside the source video\n   - Example: `cp /tmp/video-toolkit-1234567890/video-analysis.md \"/path/to/video-analysis.md\"`\n8. Present comprehensive multimodal summary to user\n\n*7. Discussion and Follow-up**\n\nAfter generating summary:\n\n- Present findings in markdown format\n- Enable conversational follow-up questions\n- Offer to extract specific clips or moments\n- Provide additional analysis on request\n\n### Video Editing Workflow\n\nFor video editing operations, use `scripts/edit_video.py`:\n\n**Clip Video (Extract Segment)**\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/edit_video.py clip <input_video> <start_time> <end_time> <output_video>\n```\n\n- `start_time`: Format HH:MM:SS or MM:SS or seconds\n- `end_time`: Format HH:MM:SS or MM:SS or seconds\n- Example: `${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/edit_video.py clip video.mp4 00:01:30 00:02:45 clip.mp4`\n\n**Merge Videos (Concatenate)**\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/edit_video.py merge <output_video> <input1> <input2> [input3...]\n```\n\n- Concatenates multiple videos in order\n- Videos should have same codec/resolution for best results\n- Example: `${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/edit_video.py merge final.mp4 part1.mp4 part2.mp4 part3.mp4`\n\n**Split Video (By Duration)**\n\n```bash\n${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/edit_video.py split <input_video> <segment_duration> <output_prefix>\n```\n\n- `segment_duration`: Length of each segment in seconds\n- `output_prefix`: Prefix for output files (e.g., \"segment\" â segment_001.mp4, segment_002.mp4)\n- Example: `${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/.venv/bin/python3 ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/edit_video.py split long_video.mp4 300 chunk`\n\n### Orchestration Script (All-in-One Analysis)\n\nFor comprehensive analysis, use the orchestration wrapper with clear flag-based arguments:\n\n```bash\n# Basic usage (uses interval mode with 2s default - safest for most videos)\nbash ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/analyze_video.sh video.mp4\n\n# Interval mode with custom interval\nbash ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/analyze_video.sh video.mp4 --interval 3\n\n# Scene detection mode (for videos with clear scene changes like movies)\nbash ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/analyze_video.sh video.mp4 --mode scene-detect --threshold 0.05\n\n# With custom whisper model\nbash ${CLAUDE_PLUGIN_ROOT}/skills/video-toolkit/scripts/analyze_video.sh video.mp4 --interval 2 --whisper-model small\n```\n\n**Available Options:**\n\n- `--mode <scene-detect|interval>` - Frame extraction mode (default: interval)\n- `--threshold <value>` - Scene detection threshold 0.0-1.0 (default: 0.02)\n- `--interval <seconds>` - Interval between frames (default: 2)\n- `--whisper-model <model>` - Whisper model: tiny.en, base, small, medium, large (default: base)\n- `--help` - Show usage information\n\nThis script:\n\n1. Creates temporary working directory\n2. Extracts frames at specified interval\n3. Extracts audio\n4. Transcribes speech with Whisper (local)\n5. Analyzes audio with Gemini (API)\n6. If music detected, identifies songs with Shazam (API)\n7. Organizes results in structured format\n8. Returns paths to all artifacts\n\n**Returns:**\n\n- `frames/`: Directory of extracted frames\n- `frames/frames_metadata.json`: Frame timestamps\n- `audio.wav`: Extracted audio file\n- `transcript.md`: Speech transcription (Whisper)\n- `audio_analysis.md`: Audio understanding (Gemini)\n- `music_identification.md`: Song identification (Shazam, if music detected)\n- `analysis-summary.md`: Overview and next steps\n\n## Bundled Resources\n\n### Scripts\n\n**`scripts/install_dependencies.sh`**\n\n- Install FFmpeg, Python venv, Whisper, Gemini API, and Shazam\n- One-time setup, run on first use\n- Checks for existing installations\n\n**`scripts/setup_api_keys.py`**\n\n- Configure Gemini API key for audio analysis\n- Configure Shazam API key (optional, uses public endpoint by default)\n- Validates and saves API keys to config file\n\n**`scripts/extract_frames.py`**\n\n- FFmpeg-based frame extraction\n- Configurable interval and scene detection modes\n- Generates frames_metadata.json with timestamps\n- Efficient processing for long videos\n\n**`scripts/extract_audio.py`**\n\n- Extract audio track to WAV format\n- Handles various input codecs\n- Whisper-compatible output\n\n**`scripts/transcribe_audio.py`**\n\n- Whisper integration for speech transcription\n- Model selection support (tiny.en, base, small, medium, large)\n- Timestamped output with metadata\n- Runs locally (no API key required)\n\n**`scripts/analyze_audio_gemini.py`**\n\n- Gemini Audio API integration for comprehensive audio analysis\n- Detects music with precise timestamps\n- Identifies non-speech sounds and audio events\n- Returns markdown + JSON with music segments\n\n**`scripts/identify_music.py`**\n\n- Shazam integration for music identification\n- Extracts music segments based on Gemini timestamps\n- Identifies songs with title, artist, album, genre\n- Only runs if Gemini detected music\n\n**`scripts/edit_video.py`**\n\n- Unified editing tool (clip, merge, split)\n- FFmpeg-based for reliability\n- Error handling and validation\n\n**`scripts/analyze_video.sh`**\n\n- Orchestration wrapper for full analysis\n- Persists final summary alongside source video\n- Automatic cleanup of temporary files\n- Structured output format\n\n### References\n\n**`references/ffmpeg_commands.md`**\n\n- Common FFmpeg commands and patterns\n- Codec information and best practices\n- Troubleshooting guide\n\n## File Management\n\n**Final Analysis Summary:**\n\nThe complete analysis summary is automatically saved alongside the source video:\n\n- **Location**: Same directory as the source video\n- **Filename**: `<video-name>-analysis.md` (e.g., `test-analysis.md` for `test.mov`)\n- **Format**: Markdown with YAML frontmatter\n- **Persistence**: Permanent (lives next to your video file)\n\n**Temporary Working Files:**\n\nDuring analysis, temporary files are created in `/tmp/video-toolkit-{timestamp}/`:\n\n- **Frames**: `frames/` subdirectory with extracted PNG files\n- **Audio**: `audio.wav` (if video has audio)\n- **Transcript**: `transcript.md` with timestamped speech\n- **Audio Analysis**: `audio_analysis.md` (Gemini output)\n- **Music Identification**: `music_identification.md` (Shazam output, if music detected)\n\n**Cleanup Workflow:**\n\nAfter completing video analysis, **ALWAYS** use the **AskUserQuestion** tool to ask the user:\n\n```\nQuestion: \"Would you like me to keep these analysis files, or should I clean them up?\"\nOptions:\n- \"Clean up temporary files\" â Run: rm -rf /tmp/video-toolkit-{timestamp}\n  (Keeps only the persisted summary: <video-name>-analysis.md)\n- \"Keep everything\" â Inform user of /tmp location for frames/audio/transcripts\n  (User responsible for manual cleanup later)\n```\n\n**Important Notes:**\n\n- The final summary (`<video-name>-analysis.md`) is **always persisted** alongside the source video\n- Temporary files in `/tmp` contain frames, audio, transcripts (can be large)\n- User may want to keep frames for visual analysis or audio for further processing\n- If keeping files, remind user that `/tmp` persists until reboot or ~3 days on macOS\n\n**Manual Cleanup Commands (rarely needed):**\n\n```bash\n# Check if any temp files remain (shouldn't happen)\nls -lh /tmp/video-toolkit-*\n\n# Clean all video-toolkit temp files (if automatic cleanup failed)\nrm -rf /tmp/video-toolkit-*\n\n# Check disk usage in /tmp\ndu -sh /tmp/video-toolkit-* 2>/dev/null || echo \"No temp files found (good!)\"\n```\n\n## Output Format\n\n**Analysis Summary Template:**\n\n```markdown\n# Video Analysis: {filename}\n\n## Overview\n- **Duration**: MM:SS\n- **Resolution**: WxH\n- **File Size**: XX MB\n- **Analysis Date**: YYYY-MM-DD\n\n## Transcript\n[Timestamped transcript from Whisper]\n\n## Visual Analysis\n### Scene 1 (00:00 - 00:XX)\n- Frame descriptions\n- Key moments\n- Visual details\n\n### Scene 2 (00:XX - 00:XX)\n...\n\n## Key Highlights\n- Important moments\n- Notable quotes\n- Visual highlights\n\n## Summary\nOverall narrative and insights\n\n---\n*Generated by video-toolkit v1.0.0*\n```\n\n## Examples\n\n**Example 1: Analyze Meeting Recording**\n\n```\nUser: Can you analyze this meeting recording and summarize the key points?\n\nClaude:\n1. Run analyze_video.sh on the meeting file\n2. Extract frames every 5 seconds\n3. Transcribe audio with Whisper (base model)\n4. Analyze slides/screen sharing in frames\n5. Identify speakers and topics from transcript\n6. Generate summary with:\n   - Meeting agenda items\n   - Decisions made\n   - Action items\n   - Key discussion points\n```\n\n**Example 2: Extract Highlight Clip**\n\n```\nUser: Extract the segment from 2:30 to 4:15 from this video\n\nClaude:\npython scripts/edit_video.py clip input.mp4 00:02:30 00:04:15 highlight.mp4\n```\n\n**Example 3: Combine Multiple Clips**\n\n```\nUser: Merge these three video files into one\n\nClaude:\npython scripts/edit_video.py merge final_video.mp4 clip1.mp4 clip2.mp4 clip3.mp4\n```\n\n## Troubleshooting\n\n**FFmpeg Not Found:**\n\n- Run `scripts/install_dependencies.sh`\n- Or install manually: `brew install ffmpeg` (macOS) or `apt install ffmpeg` (Linux)\n\n**Whisper Model Download Slow:**\n\n- Models download on first use\n- Models cached in `~/.cache/whisper/`\n\n## Best Practices\n\n1. **Frame Interval Selection**\n   - Action videos: 1-2 seconds\n   - Dialogue/presentations: 3-5 seconds\n   - Surveillance/static: 10+ seconds\n\n2. **Whisper Model Selection**\n   - Quick analysis: tiny.en or base\n   - Important transcription: medium or large\n   - Non-English: Use multilingual models (not .en)\n\n3. **Temp File Management**\n   - Clean up after analysis unless user asks to keep\n   - Monitor disk space for long videos\n   - Use `/tmp` for automatic cleanup on reboot\n\n4. **Video Editing**\n   - Keep original files safe (don't overwrite)\n   - Use descriptive output filenames\n   - Check codec compatibility for merging\n",
        "plugins/video-toolkit/skills/video-toolkit/references/ffmpeg_commands.md": "# FFmpeg Command Reference\n\nQuick reference for common FFmpeg operations used in video-toolkit.\n\n## Frame Extraction\n\n### Extract frames at regular intervals\n\n```bash\n# Extract one frame every 2 seconds\nffmpeg -i input.mp4 -vf fps=1/2 frame_%04d.png\n\n# Extract one frame per second\nffmpeg -i input.mp4 -vf fps=1 frame_%04d.png\n\n# Extract 10 frames per second\nffmpeg -i input.mp4 -vf fps=10 frame_%04d.png\n```\n\n### Extract specific frames\n\n```bash\n# Extract frame at 5 seconds\nffmpeg -ss 00:00:05 -i input.mp4 -frames:v 1 frame.png\n\n# Extract 10 frames starting at 30 seconds\nffmpeg -ss 00:00:30 -i input.mp4 -frames:v 10 frame_%04d.png\n```\n\n### Quality control\n\n```bash\n# High quality PNG (lossless)\nffmpeg -i input.mp4 -vf fps=1/2 -q:v 2 frame_%04d.png\n\n# JPEG with quality control (2-31, lower is better)\nffmpeg -i input.mp4 -vf fps=1/2 -q:v 5 frame_%04d.jpg\n\n# Specific resolution\nffmpeg -i input.mp4 -vf \"fps=1/2,scale=1280:720\" frame_%04d.png\n```\n\n## Audio Extraction\n\n### Extract audio to WAV\n\n```bash\n# Extract to WAV (PCM)\nffmpeg -i input.mp4 -vn -acodec pcm_s16le audio.wav\n\n# Extract to WAV, 16kHz mono (Whisper-optimized)\nffmpeg -i input.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 audio.wav\n\n# Extract specific audio stream\nffmpeg -i input.mp4 -map 0:a:0 -acodec pcm_s16le audio.wav\n```\n\n### Extract audio to other formats\n\n```bash\n# MP3\nffmpeg -i input.mp4 -vn -acodec libmp3lame -q:a 2 audio.mp3\n\n# AAC\nffmpeg -i input.mp4 -vn -acodec aac -b:a 192k audio.m4a\n\n# FLAC (lossless)\nffmpeg -i input.mp4 -vn -acodec flac audio.flac\n```\n\n## Video Clipping\n\n### Extract segments\n\n```bash\n# Clip from 1:30 to 2:45 (copy streams, fast)\nffmpeg -ss 00:01:30 -i input.mp4 -t 00:01:15 -c copy output.mp4\n\n# Clip with re-encoding (slower, more precise)\nffmpeg -i input.mp4 -ss 00:01:30 -t 00:01:15 output.mp4\n\n# Clip using end time instead of duration\nffmpeg -ss 00:01:30 -i input.mp4 -to 00:02:45 -c copy output.mp4\n```\n\n### Key frame considerations\n\n```bash\n# Seek to nearest keyframe (fast but less precise)\nffmpeg -ss 00:01:30 -i input.mp4 -t 00:01:15 -c copy output.mp4\n\n# Precise seeking (re-encode around cut points)\nffmpeg -i input.mp4 -ss 00:01:30 -t 00:01:15 -c:v libx264 -c:a copy output.mp4\n```\n\n## Video Merging\n\n### Concatenate videos\n\n```bash\n# Create file list\ncat > list.txt << EOF\nfile 'video1.mp4'\nfile 'video2.mp4'\nfile 'video3.mp4'\nEOF\n\n# Merge using concat demuxer (same codec)\nffmpeg -f concat -safe 0 -i list.txt -c copy output.mp4\n\n# Merge with re-encoding (different codecs)\nffmpeg -f concat -safe 0 -i list.txt output.mp4\n```\n\n### Merge with transition\n\n```bash\n# Crossfade between clips\nffmpeg -i video1.mp4 -i video2.mp4 \\\n  -filter_complex \"[0:v][1:v]xfade=transition=fade:duration=1:offset=4[v]\" \\\n  -map \"[v]\" output.mp4\n```\n\n## Video Splitting\n\n### Split by duration\n\n```bash\n# Split into 5-minute segments\nffmpeg -i input.mp4 -c copy -f segment -segment_time 300 -reset_timestamps 1 segment_%03d.mp4\n\n# Split into 10 equal parts\nffmpeg -i input.mp4 -c copy -f segment -segment_frames 10 segment_%03d.mp4\n```\n\n### Split at specific times\n\n```bash\n# Split at 1:00, 3:00, 5:00\nffmpeg -i input.mp4 -c copy -f segment -segment_times 60,180,300 segment_%03d.mp4\n```\n\n## Video Information\n\n### Get video metadata\n\n```bash\n# Show all information\nffprobe input.mp4\n\n# Get duration in seconds\nffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 input.mp4\n\n# Get video resolution\nffprobe -v error -select_streams v:0 -show_entries stream=width,height -of csv=s=x:p=0 input.mp4\n\n# Get frame rate\nffprobe -v error -select_streams v:0 -show_entries stream=r_frame_rate -of default=noprint_wrappers=1:nokey=1 input.mp4\n\n# JSON output\nffprobe -v error -show_format -show_streams -of json input.mp4\n```\n\n## Common Filters\n\n### Scaling and resizing\n\n```bash\n# Resize to 720p\nffmpeg -i input.mp4 -vf scale=1280:720 output.mp4\n\n# Resize maintaining aspect ratio\nffmpeg -i input.mp4 -vf scale=1280:-1 output.mp4\n\n# Resize to fit within dimensions\nffmpeg -i input.mp4 -vf \"scale='min(1280,iw)':min(720,ih)':force_original_aspect_ratio=decrease\" output.mp4\n```\n\n### Cropping\n\n```bash\n# Crop to 1280x720 from top-left\nffmpeg -i input.mp4 -vf \"crop=1280:720:0:0\" output.mp4\n\n# Crop center\nffmpeg -i input.mp4 -vf \"crop=1280:720\" output.mp4\n```\n\n### Speed adjustment\n\n```bash\n# 2x speed (video only)\nffmpeg -i input.mp4 -vf \"setpts=0.5*PTS\" output.mp4\n\n# 0.5x speed (slow motion, video only)\nffmpeg -i input.mp4 -vf \"setpts=2*PTS\" output.mp4\n\n# 2x speed (video + audio)\nffmpeg -i input.mp4 -filter_complex \"[0:v]setpts=0.5*PTS[v];[0:a]atempo=2.0[a]\" -map \"[v]\" -map \"[a]\" output.mp4\n```\n\n## Codec Information\n\n### Common video codecs\n\n- **H.264 (libx264)** - Most compatible, good quality/size ratio\n- **H.265 (libx265)** - Better compression, slower encoding\n- **VP9 (libvpx-vp9)** - Good for web, open source\n- **ProRes** - High quality, large files, editing-friendly\n\n### Common audio codecs\n\n- **AAC** - Most compatible, good quality\n- **MP3 (libmp3lame)** - Universal compatibility\n- **Opus** - Best quality/size ratio, modern\n- **PCM** - Uncompressed, lossless\n\n## Troubleshooting\n\n### Common issues\n\n**\"Unknown encoder\" errors:**\n```bash\n# Check available encoders\nffmpeg -encoders\n\n# Check available decoders\nffmpeg -decoders\n```\n\n**Stream mapping errors:**\n```bash\n# Explicitly map streams\nffmpeg -i input.mp4 -map 0:v -map 0:a output.mp4\n\n# Copy only video stream\nffmpeg -i input.mp4 -map 0:v -c copy output.mp4\n```\n\n**Synchronization issues:**\n```bash\n# Re-sync audio/video\nffmpeg -i input.mp4 -async 1 output.mp4\n\n# Fix variable frame rate\nffmpeg -i input.mp4 -vsync 1 output.mp4\n```\n\n### Performance optimization\n\n```bash\n# Use hardware acceleration (macOS)\nffmpeg -hwaccel videotoolbox -i input.mp4 output.mp4\n\n# Multi-threaded encoding\nffmpeg -i input.mp4 -threads 8 output.mp4\n\n# Fast preset (lower quality, faster encode)\nffmpeg -i input.mp4 -preset fast output.mp4\n```\n\n## Best Practices\n\n1. **Use `-c copy` when possible** - Avoids re-encoding, much faster\n2. **Seek before input (`-ss` before `-i`)** - Faster seeking\n3. **Use appropriate presets** - Balance speed vs quality\n4. **Check codec compatibility** - Ensure output plays on target devices\n5. **Monitor file sizes** - Adjust quality settings if needed\n6. **Test small segments first** - Verify settings before processing long videos\n7. **Keep originals** - Never overwrite source files\n\n## Resources\n\n- [FFmpeg Official Documentation](https://ffmpeg.org/documentation.html)\n- [FFmpeg Wiki](https://trac.ffmpeg.org/wiki)\n- [FFmpeg Filters Documentation](https://ffmpeg.org/ffmpeg-filters.html)\n"
      },
      "plugins": [
        {
          "name": "claude-code-meta",
          "source": "./plugins/claude-code-meta",
          "description": "Complete toolkit for building and distributing Claude Code plugins, skills, hooks, subagents, slash commands, marketplaces, and MCP servers",
          "version": "1.1.0",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/claude-code-plugins",
          "license": "MIT",
          "keywords": [
            "claude-code",
            "plugins",
            "marketplaces",
            "hooks",
            "subagents",
            "slash-commands",
            "skills",
            "mcp",
            "development",
            "automation",
            "configuration"
          ],
          "category": "development-tools",
          "strict": true,
          "skills": [
            "./skills/claude-code-hooks",
            "./skills/claude-code-slash-commands",
            "./skills/claude-code-subagents",
            "./skills/claude-code-plugins",
            "./skills/claude-code-mcp",
            "./skills/claude-code-skills"
          ],
          "categories": [
            "automation",
            "claude-code",
            "configuration",
            "development",
            "development-tools",
            "hooks",
            "marketplaces",
            "mcp",
            "plugins",
            "skills",
            "slash-commands",
            "subagents"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/claude-code-plugins",
            "/plugin install claude-code-meta@emdashcodes-claude-code-plugins"
          ]
        },
        {
          "name": "mermaid-diagram-to-image",
          "source": "./plugins/mermaid-diagram-to-image",
          "description": "Convert Mermaid diagrams to images (PNG, SVG, PDF) using mermaid-cli.",
          "version": "1.0.1",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/claude-code-plugins",
          "license": "MIT",
          "keywords": [
            "claude-code",
            "mermaid",
            "diagrams",
            "visualization",
            "image-generation",
            "documentation"
          ],
          "category": "development-tools",
          "strict": true,
          "skills": [
            "./skills/mermaid-diagram-to-image"
          ],
          "categories": [
            "claude-code",
            "development-tools",
            "diagrams",
            "documentation",
            "image-generation",
            "mermaid",
            "visualization"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/claude-code-plugins",
            "/plugin install mermaid-diagram-to-image@emdashcodes-claude-code-plugins"
          ]
        },
        {
          "name": "google-docs-reader",
          "source": "./plugins/google-docs-reader",
          "description": "Read and analyze Google Docs, Sheets, and Slides by exporting them to local formats (DOCX, XLSX, PPTX) via browser download.",
          "version": "1.0.0",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/claude-code-plugins",
          "license": "MIT",
          "keywords": [
            "google-docs",
            "google-sheets",
            "google-slides",
            "google-drive",
            "document-analysis",
            "export"
          ],
          "category": "productivity",
          "strict": true,
          "skills": [
            "./skills/google-docs-reader"
          ],
          "categories": [
            "document-analysis",
            "export",
            "google-docs",
            "google-drive",
            "google-sheets",
            "google-slides",
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/claude-code-plugins",
            "/plugin install google-docs-reader@emdashcodes-claude-code-plugins"
          ]
        },
        {
          "name": "quill-export",
          "source": "./plugins/quill-export",
          "description": "Extract meeting recordings and transcripts from the Quill macOS app database with AI summary and cross-linking.",
          "version": "1.0.0",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/claude-code-plugins",
          "license": "MIT",
          "keywords": [
            "quill",
            "meetings",
            "transcripts",
            "recordings",
            "macos",
            "export"
          ],
          "category": "productivity",
          "strict": true,
          "skills": [
            "./skills/quill-export"
          ],
          "categories": [
            "export",
            "macos",
            "meetings",
            "productivity",
            "quill",
            "recordings",
            "transcripts"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/claude-code-plugins",
            "/plugin install quill-export@emdashcodes-claude-code-plugins"
          ]
        },
        {
          "name": "nano-banana-image-editor",
          "source": "./plugins/nano-banana-image-editor",
          "description": "Create and edit images with natural language using Gemini 3 Pro Image. Use for image generation, photo editing, infographics, icons, style transfer, and text rendering. Includes Google Search grounding for factual content and PIL/Pillow for quick crops.",
          "version": "1.0.1",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/claude-code-plugins",
          "license": "MIT",
          "keywords": [
            "gemini",
            "image-editing",
            "nano-banana",
            "pillow",
            "pil",
            "ai-image",
            "photo-editing",
            "image-generation",
            "cropping"
          ],
          "category": "productivity",
          "strict": true,
          "commands": [
            "./commands/image.md",
            "./commands/upgrade.md"
          ],
          "skills": [
            "./skills/nano-banana-image-editor"
          ],
          "categories": [
            "ai-image",
            "cropping",
            "gemini",
            "image-editing",
            "image-generation",
            "nano-banana",
            "photo-editing",
            "pil",
            "pillow",
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/claude-code-plugins",
            "/plugin install nano-banana-image-editor@emdashcodes-claude-code-plugins"
          ]
        },
        {
          "name": "video-toolkit",
          "source": "./plugins/video-toolkit",
          "description": "Video editing and analysis with FFmpeg and Whisper. Extract frames, transcribe audio, and perform video operations (clip, merge, split)",
          "version": "1.0.0",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/claude-code-plugins",
          "license": "MIT",
          "keywords": [
            "video",
            "ffmpeg",
            "whisper",
            "editing",
            "transcription",
            "analysis",
            "multimedia"
          ],
          "category": "productivity",
          "strict": true,
          "commands": [
            "./commands/upgrade.md"
          ],
          "skills": [
            "./skills/video-toolkit"
          ],
          "agents": [
            "./agents/video-frame-analyzer.md"
          ],
          "categories": [
            "analysis",
            "editing",
            "ffmpeg",
            "multimedia",
            "productivity",
            "transcription",
            "video",
            "whisper"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/claude-code-plugins",
            "/plugin install video-toolkit@emdashcodes-claude-code-plugins"
          ]
        },
        {
          "name": "claude-agent-sdk-dev",
          "source": "./plugins/claude-agent-sdk-dev",
          "description": "Development tools and documentation for building applications with the Claude Agent SDK. Covers Python and TypeScript APIs, core features, advanced features, and integrations.",
          "version": "0.1.0",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/claude-code-plugins",
          "license": "MIT",
          "keywords": [
            "claude",
            "agent-sdk",
            "sdk",
            "development",
            "api",
            "python",
            "typescript",
            "documentation"
          ],
          "category": "development-tools",
          "strict": true,
          "skills": [
            "./skills/claude-agent-sdk"
          ],
          "categories": [
            "agent-sdk",
            "api",
            "claude",
            "development",
            "development-tools",
            "documentation",
            "python",
            "sdk",
            "typescript"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/claude-code-plugins",
            "/plugin install claude-agent-sdk-dev@emdashcodes-claude-code-plugins"
          ]
        }
      ]
    },
    {
      "name": "emdashcodes-wp-ability-toolkit",
      "version": null,
      "description": "Comprehensive WordPress Ability API development toolkit with specialized Claude Code skills for plugin development, environment management, and ability creation",
      "owner_info": {
        "name": "Em",
        "url": "https://emdash.codes"
      },
      "keywords": [],
      "repo_full_name": "emdashcodes/wp-ability-toolkit",
      "repo_url": "https://github.com/emdashcodes/wp-ability-toolkit",
      "repo_description": "A toolkit for WordPress plugin development, testing AI agent integrations, and WordPress Ability API creation.",
      "homepage": "https://emdash.codes/wp-ability-toolkit/",
      "signals": {
        "stars": 6,
        "forks": 0,
        "pushed_at": "2025-10-20T16:40:28Z",
        "created_at": "2025-10-19T17:14:16Z",
        "license": "GPL-2.0"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 2263
        },
        {
          "path": "claude-code-plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/SKILL.md",
          "type": "blob",
          "size": 17779
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/1.intro.md",
          "type": "blob",
          "size": 5297
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/2.getting-started.md",
          "type": "blob",
          "size": 4943
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/3.registering-abilities.md",
          "type": "blob",
          "size": 12663
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/4.using-abilities.md",
          "type": "blob",
          "size": 6750
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/5.rest-api.md",
          "type": "blob",
          "size": 8998
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/6.hooks.md",
          "type": "blob",
          "size": 6820
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/7.javascript-client.md",
          "type": "blob",
          "size": 7660
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/7.registering-categories.md",
          "type": "blob",
          "size": 2935
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/scripts",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/scripts/README.md",
          "type": "blob",
          "size": 1345
        },
        {
          "path": "claude-code-plugins/wordpress-plugin-scaffold",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-plugin-scaffold/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-plugin-scaffold/skills/wordpress-plugin-scaffold",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-plugin-scaffold/skills/wordpress-plugin-scaffold/SKILL.md",
          "type": "blob",
          "size": 11053
        },
        {
          "path": "claude-code-plugins/wordpress-plugin-scaffold/skills/wordpress-plugin-scaffold/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wordpress-plugin-scaffold/skills/wordpress-plugin-scaffold/references/wp-cli-installation.md",
          "type": "blob",
          "size": 5126
        },
        {
          "path": "claude-code-plugins/wp-env",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wp-env/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wp-env/skills/wp-env",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wp-env/skills/wp-env/SKILL.md",
          "type": "blob",
          "size": 10262
        },
        {
          "path": "claude-code-plugins/wp-env/skills/wp-env/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-code-plugins/wp-env/skills/wp-env/references/command-reference.md",
          "type": "blob",
          "size": 16767
        },
        {
          "path": "claude-code-plugins/wp-env/skills/wp-env/references/configuration-guide.md",
          "type": "blob",
          "size": 18191
        },
        {
          "path": "claude-code-plugins/wp-env/skills/wp-env/references/troubleshooting.md",
          "type": "blob",
          "size": 2638
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n\t\"name\": \"emdashcodes-wp-ability-toolkit\",\n\t\"owner\": {\n\t\t\"name\": \"Em\",\n\t\t\"url\": \"https://emdash.codes\"\n\t},\n\t\"metadata\": {\n\t\t\"description\": \"Comprehensive WordPress Ability API development toolkit with specialized Claude Code skills for plugin development, environment management, and ability creation\",\n\t\t\"version\": \"1.0.0\"\n\t},\n\t\"plugins\": [\n\t\t{\n\t\t\t\"name\": \"wordpress-ability-api\",\n\t\t\t\"source\": \"./claude-code-plugins/wordpress-ability-api\",\n\t\t\t\"description\": \"Create, validate, and register WordPress Abilities (server-side PHP and client-side JavaScript) with comprehensive scaffolding and validation tools\",\n\t\t\t\"version\": \"1.0.0\",\n\t\t\t\"author\": {\n\t\t\t\t\"name\": \"Em\"\n\t\t\t},\n\t\t\t\"repository\": \"https://github.com/emdashcodes/wp-ability-toolkit\",\n\t\t\t\"license\": \"GPL-2.0-or-later\",\n\t\t\t\"keywords\": [\n\t\t\t\t\"wordpress\",\n\t\t\t\t\"abilities-api\",\n\t\t\t\t\"scaffolding\",\n\t\t\t\t\"validation\",\n\t\t\t\t\"ai-agents\",\n\t\t\t\t\"development-tools\"\n\t\t\t],\n\t\t\t\"category\": \"development-tools\",\n\t\t\t\"strict\": false,\n\t\t\t\"skills\": [\"./skills/wordpress-ability-api\"]\n\t\t},\n\t\t{\n\t\t\t\"name\": \"wordpress-plugin-scaffold\",\n\t\t\t\"source\": \"./claude-code-plugins/wordpress-plugin-scaffold\",\n\t\t\t\"description\": \"Scaffold WordPress plugins using WP-CLI commands with intelligent environment detection and comprehensive testing support\",\n\t\t\t\"version\": \"1.0.0\",\n\t\t\t\"author\": {\n\t\t\t\t\"name\": \"Em\"\n\t\t\t},\n\t\t\t\"repository\": \"https://github.com/emdashcodes/wp-ability-toolkit\",\n\t\t\t\"license\": \"GPL-2.0-or-later\",\n\t\t\t\"keywords\": [\n\t\t\t\t\"wordpress\",\n\t\t\t\t\"wp-cli\",\n\t\t\t\t\"plugin-development\",\n\t\t\t\t\"scaffolding\",\n\t\t\t\t\"development-tools\"\n\t\t\t],\n\t\t\t\"category\": \"development-tools\",\n\t\t\t\"strict\": false,\n\t\t\t\"skills\": [\"./skills/wordpress-plugin-scaffold\"]\n\t\t},\n\t\t{\n\t\t\t\"name\": \"wp-env\",\n\t\t\t\"source\": \"./claude-code-plugins/wp-env\",\n\t\t\t\"description\": \"Manage local WordPress development environments using @wordpress/env with Docker for plugin and theme development\",\n\t\t\t\"version\": \"1.0.0\",\n\t\t\t\"author\": {\n\t\t\t\t\"name\": \"Em\"\n\t\t\t},\n\t\t\t\"repository\": \"https://github.com/emdashcodes/wp-ability-toolkit\",\n\t\t\t\"license\": \"GPL-2.0-or-later\",\n\t\t\t\"keywords\": [\n\t\t\t\t\"wordpress\",\n\t\t\t\t\"wp-env\",\n\t\t\t\t\"docker\",\n\t\t\t\t\"local-development\",\n\t\t\t\t\"development-tools\"\n\t\t\t],\n\t\t\t\"category\": \"development-tools\",\n\t\t\t\"strict\": false,\n\t\t\t\"skills\": [\"./skills/wp-env\"]\n\t\t}\n\t]\n}\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/SKILL.md": "---\nname: wordpress-ability-api\ndescription: This skill should be used when helping users create, edit, or register WordPress Abilities (both server-side PHP and client-side JavaScript), register ability categories, or set up the WordPress Abilities API as a dependency. Use when users say things like \"create an ability\", \"help me build an ability\", \"set up the Ability API\", or \"register a category\".\n---\n\n# WordPress Ability API\n\n## Overview\n\nThis skill helps users work with the WordPress Abilities API - a standardized system for registering and discovering distinct units of functionality within WordPress. Use this skill to help users create server-side PHP abilities, client-side JavaScript abilities, register categories, and set up the API as a dependency.\n\nThe Abilities API makes WordPress functionality discoverable by AI agents and automation tools through machine-readable schemas, permissions, and validation.\n\n## When to Use This Skill\n\nActivate this skill when the user requests:\n\n- **Creating abilities**: \"Help me create an ability to...\", \"I want to make an ability that...\", \"Build me an ability for...\"\n- **Editing abilities**: \"Update my ability\", \"Fix this ability code\", \"Modify the ability to...\"\n- **Setting up the API**: \"Set up the Ability API\", \"Add the Ability API as a dependency\", \"Install the Abilities API\"\n- **Registering categories**: \"Create a category for my abilities\", \"Register an ability category\"\n\n## Workflow Decision Tree\n\nWhen this skill activates, determine what the user needs:\n\n1. **Are they creating/editing an ability?**\n   â Follow the \"Creating Abilities\" workflow below\n\n2. **Do they need to set up the API first?**\n   â Follow the \"Setting Up the API\" workflow below\n\n3. **Are they just learning about the API?**\n   â Reference the documentation in `references/` and explain concepts\n\n## Using the Scaffold Script\n\nThe skill includes a `scripts/scaffold-ability.php` script designed for programmatic ability generation. Use this when creating abilities to quickly generate validated boilerplate code.\n\n### Script Usage\n\n```bash\nphp scripts/scaffold-ability.php \\\n  --name=\"plugin/ability-name\" \\\n  --type=\"server\" \\\n  --category=\"data-retrieval\" \\\n  --label=\"Optional Label\" \\\n  --description=\"Optional description\"\n```\n\n**Required Arguments:**\n\n- `--name` - Ability name in format \"namespace/ability-name\"\n- `--type` - Either \"server\" (PHP) or \"client\" (JavaScript)\n- `--category` - Category slug (e.g., \"data-retrieval\", \"data-modification\")\n\n**Optional Arguments:**\n\n- `--label` - Human-readable label (auto-generated from name if omitted)\n- `--description` - Detailed description (placeholder if omitted)\n- `--readonly` - \"true\" or \"false\" (default: false)\n- `--destructive` - \"true\" or \"false\" (default: true)\n- `--idempotent` - \"true\" or \"false\" (default: false)\n\n**Output:** Complete ability code printed to stdout, ready to be written to plugin files.\n\n### When to Use the Scaffold Script\n\nUse the scaffold script after gathering requirements from the user (Steps 1-3 of the workflow below). The script generates clean, validated boilerplate that follows best practices.\n\n**Important:** Always gather required information from the user BEFORE calling the script, or generate sensible defaults based on context.\n\n## Creating Abilities\n\nWhen helping users create or edit abilities, follow this conversational workflow:\n\n### Step 1: Understand the Functionality\n\nAsk clarifying questions to understand what the ability should do:\n\n- **What should this ability do?** (e.g., \"Get site analytics\", \"Send notifications\", \"Update settings\")\n- **Is this a server-side or client-side ability?**\n  - **Server-side (PHP)**: Runs on the WordPress backend, accesses database, uses WordPress functions\n  - **Client-side (JavaScript)**: Runs in the browser, manipulates DOM, handles UI interactions\n- **What input parameters does it need?** (e.g., user ID, date range, options)\n- **What should it return?** (e.g., array of data, success boolean, error messages)\n- **Who should be able to use it?** (permissions: any user, logged-in users, administrators, custom capability)\n\n### Step 2: Determine Plugin Location\n\nAsk where the ability code should live:\n\n- **\"Which plugin should this ability be registered in?\"**\n  - If they have an existing plugin, use that\n  - If they need a new plugin, offer to create one using the `wordpress-plugin-scaffold` skill\n\n### Step 3: Check for Category\n\nAbilities must belong to a category. Ask:\n\n- **\"Which category should this ability belong to?\"**\n  - Example categories: `data-retrieval`, `data-modification`, `communication`, `ecommerce`, `user-management`\n  - If they need a custom category, use `scripts/scaffold-category.php` to generate it:\n\n```bash\nphp scripts/scaffold-category.php \\\n  --name=\"custom-category\" \\\n  --label=\"Custom Category\" \\\n  --description=\"Description of what abilities belong here\" \\\n  --type=\"server|client\"\n```\n\n- Alternatively, manually customize `assets/category-template.php`\n- See `references/7.registering-categories.md` for detailed category registration information\n\n### Step 4: Generate the Ability Code\n\nUse the scaffold script to generate complete, validated code:\n\n```bash\nphp scripts/scaffold-ability.php \\\n  --name=\"namespace/ability-name\" \\\n  --type=\"server|client\" \\\n  --category=\"category-slug\" \\\n  --label=\"Human Label\" \\\n  --description=\"Detailed description\" \\\n  --readonly=\"true|false\" \\\n  --destructive=\"true|false\" \\\n  --idempotent=\"true|false\"\n```\n\n**For server-side (PHP):** Outputs complete PHP code with callback and registration functions\n**For client-side (JavaScript):** Outputs complete JavaScript code with async callback\n\nAlternatively, manually copy and customize templates from `assets/` directory:\n\n- `server-ability-template.php` - PHP abilities\n- `client-ability-template.js` - JavaScript abilities\n\nReplace all `{{PLACEHOLDERS}}` with actual values. See templates for full list of placeholders.\n\n### Step 5: Validate the Code\n\nBefore adding the code to plugin files, validate it using the appropriate validation script:\n\n#### Validate Abilities\n\n**For PHP abilities:**\n\n```bash\nphp scripts/validate-ability.php path/to/ability-file.php\n```\n\n**For JavaScript abilities:**\n\n```bash\nnode scripts/validate-ability.js path/to/ability-file.js\n```\n\n#### Validate Categories\n\n**For PHP categories:**\n\n```bash\nphp scripts/validate-category.php path/to/category-file.php\n```\n\n**For JavaScript categories:**\n\n```bash\nnode scripts/validate-category.js path/to/category-file.js\n```\n\nAll validators check:\n\n- **Structure**: Required fields (name, label, description, schemas/callbacks) are present\n- **JSON Schema validity**: Schemas follow JSON Schema specification (abilities only)\n- **Best practices**: Proper naming (kebab-case), annotations, permission callbacks\n- **Common mistakes**: TODO placeholders, empty descriptions, security concerns\n\n**Exit codes:**\n\n- `0` - Validation passed\n- `1` - Validation failed (errors found)\n- `2` - File not found or invalid usage\n\nFix any errors reported by the validator before proceeding.\n\n### Step 6: Add to Plugin Files\n\nWrite the validated code to the appropriate plugin files:\n\n- **PHP abilities**: Add to plugin's main PHP file or create a dedicated `includes/abilities.php` file and hook into `abilities_api_init`\n- **JavaScript abilities**: Add to enqueued JavaScript file with `@wordpress/abilities` dependency\n- **Categories**: Register on `abilities_api_categories_init` hook before abilities\n\nUse the Write tool to add the code to the correct location in the plugin.\n\n### Step 7: Test the Ability\n\nAfter code is added to plugin files, suggest testing approaches:\n\n**Server-side (PHP):**\n\n- Use `wp_get_ability('namespace/name')` to verify registration\n- Test execution via REST API: `POST /wp-json/abilities/v1/abilities/{namespace}/{ability-name}/execute`\n- Or test directly: `$ability->execute( $input_data )`\n- Verify permissions work as expected\n- Check input validation catches invalid data\n\n**Client-side (JavaScript):**\n\n- Open browser DevTools console\n- Check registration: `wp.data.select('core/abilities').getAbility('namespace/ability-name')`\n- Execute ability: `wp.data.dispatch('core/abilities').executeAbility('namespace/ability-name', inputData)`\n- Check available abilities: `wp.data.select('core/abilities').getAbilities()`\n- Verify permissions and error handling work correctly\n\n## Setting Up the API\n\nThe WordPress Abilities API must be available before abilities can be registered. Help users set up the API based on their WordPress version:\n\n### Check WordPress Version\n\n**WordPress 6.9+**: The Abilities API is included in core - no setup needed!\n\n**WordPress < 6.9**: The API must be installed as a plugin or dependency.\n\n### Installation Options\n\nReference `references/2.getting-started.md` for detailed setup instructions. Guide users through the most appropriate method:\n\n#### Option 1: As a Plugin (Easiest for Testing)\n\nIf they're using **wp-env** (check for `.wp-env.json`), help them add it via the `wp-env` skill:\n\n```json\n{\n  \"plugins\": [\"WordPress/abilities-api\"]\n}\n```\n\nIf they're using **WP-CLI**:\n\n```bash\nwp plugin install https://github.com/WordPress/abilities-api/releases/latest/download/abilities-api.zip\nwp plugin activate abilities-api\n```\n\n#### Option 2: As a Plugin Dependency (Recommended for Plugins)\n\nHelp them add to their plugin header:\n\n```php\n/**\n * Plugin Name: My Plugin\n * Requires Plugins: abilities-api\n */\n```\n\nThen add availability check:\n\n```php\nif ( ! class_exists( 'WP_Ability' ) ) {\n    add_action( 'admin_notices', function() {\n        wp_admin_notice(\n            __( 'This plugin requires the Abilities API. Please install and activate it.', 'my-plugin' ),\n            'error'\n        );\n    } );\n    return;\n}\n```\n\n#### Option 3: As a Composer Dependency\n\n```bash\ncomposer require wordpress/abilities-api\n```\n\n### Verify Installation\n\nHelp users verify the API is loaded:\n\n```php\nif ( class_exists( 'WP_Ability' ) ) {\n    // API is available\n    echo 'Abilities API version: ' . WP_ABILITIES_API_VERSION;\n}\n```\n\n## Integration with Other Skills\n\nThis skill works well with:\n\n- **wordpress-plugin-scaffold**: Use when users need a new plugin to register abilities in\n- **wp-env**: Use for local development environment setup when installing the Abilities API\n\n## Reference Documentation\n\nThe `references/` directory contains complete API documentation:\n\n- **1.intro.md**: Core concepts, goals, and benefits of the Abilities API\n- **2.getting-started.md**: Installation methods and basic usage examples\n- **3.registering-abilities.md**: Comprehensive guide to `wp_register_ability()` with all parameters and examples\n- **4.using-abilities.md**: How to retrieve and execute abilities in PHP\n- **5.rest-api.md**: REST API endpoints for abilities\n- **6.hooks.md**: Available WordPress hooks in the Abilities API\n- **7.javascript-client.md**: Complete client-side JavaScript API reference\n- **7.registering-categories.md**: How to register ability categories\n\n**When to read references:**\n\n- For specific parameter details â `3.registering-abilities.md`\n- For setup instructions â `2.getting-started.md`\n- For client-side abilities â `7.javascript-client.md`\n- For category registration â `7.registering-categories.md`\n- For conceptual understanding â `1.intro.md`\n\n## Scripts and Templates\n\n### Scripts (`scripts/`)\n\nThe skill includes automation scripts for generating and validating both abilities and categories:\n\n#### Ability Scripts\n\n- **scaffold-ability.php**: Programmatically generate ability code from CLI arguments\n  - Accepts: name, type, category, label, description, and annotation flags\n  - Outputs: Complete, validated ability code to stdout\n  - Usage: `php scripts/scaffold-ability.php --name=\"plugin/ability\" --type=\"server\" --category=\"data-retrieval\"`\n  - Use when: Creating new abilities after gathering requirements\n\n- **validate-ability.php**: Validate PHP ability code independently of WordPress\n  - Checks: Required fields, JSON Schema validity, best practices\n  - Outputs: Detailed validation results with errors and warnings\n  - Usage: `php scripts/validate-ability.php path/to/ability-file.php`\n  - Use when: Validating server-side PHP ability code before registration\n\n- **validate-ability.js**: Validate JavaScript ability registration code\n  - Requirements: Node.js and acorn parser (`npm install acorn`)\n  - Parser: Uses acorn AST parser for accurate JavaScript parsing\n  - Checks: Required fields (name, category, callback), name format, schemas, permissions, annotations\n  - Outputs: Detailed validation results with errors and warnings\n  - Usage: `node scripts/validate-ability.js path/to/ability-file.js`\n  - Use when: Validating client-side JavaScript ability code before registration\n\n#### Category Scripts\n\n- **scaffold-category.php**: Programmatically generate category registration code\n  - Accepts: name, label, description, type (server/client)\n  - Outputs: Complete category registration code to stdout\n  - Usage: `php scripts/scaffold-category.php --name=\"category-slug\" --label=\"Label\" --description=\"Description\" --type=\"server\"`\n  - Use when: Creating custom categories for abilities\n  - Includes helpful comments about registration hooks and timing\n\n- **validate-category.php**: Validate PHP category registration code\n  - Parser: Uses PHP's `token_get_all()` for accurate parsing\n  - Checks: Name format (kebab-case), required fields, description quality\n  - Outputs: Detailed validation results with errors and warnings\n  - Usage: `php scripts/validate-category.php path/to/category-file.php`\n  - Use when: Validating server-side PHP category code\n\n- **validate-category.js**: Validate JavaScript category registration code\n  - Requirements: Node.js and acorn parser (`npm install acorn`)\n  - Parser: Uses acorn AST parser for accurate JavaScript parsing\n  - Checks: Same validations as PHP validator\n  - Outputs: Detailed validation results with errors and warnings\n  - Usage: `node scripts/validate-category.js path/to/category-file.js`\n  - Use when: Validating client-side JavaScript category code\n\n### Template Assets (`assets/`)\n\nThe skill also includes manual starter templates:\n\n- **server-ability-template.php**: Complete boilerplate for server-side PHP abilities\n- **client-ability-template.js**: Complete boilerplate for client-side JavaScript abilities\n- **category-template.php**: Template for server-side PHP category registration\n- **client-category-template.js**: Template for client-side JavaScript category registration\n\n**Note:** Templates use `{{PLACEHOLDER}}` syntax and are read by scaffold scripts. You can also manually copy and replace placeholders for custom needs. Scaffold scripts generate code by loading these templates and replacing placeholders with actual values.\n\n## Best Practices\n\nWhen helping users create abilities:\n\n1. **Use descriptive names**: `my-plugin/get-user-analytics` not `my-plugin/analytics`\n2. **Write detailed descriptions**: Help AI agents understand WHEN and HOW to use the ability\n3. **Define complete schemas**: Use JSON Schema to validate inputs and document outputs\n4. **Implement proper permissions**: Never use `__return_true` for sensitive operations\n5. **Use appropriate annotations**:\n   - `readonly: true` for data retrieval abilities\n   - `destructive: false` for abilities that only add/update (never delete)\n   - `idempotent: true` for abilities that can be called repeatedly safely\n6. **Handle errors gracefully**: Return `WP_Error` objects with clear error messages\n7. **Test thoroughly**: Verify schema validation, permissions, and error cases\n\n## Common Patterns\n\n### Read-Only Data Retrieval\n\n```php\n'meta' => array(\n    'annotations' => array(\n        'readonly' => true,\n        'destructive' => false,\n        'idempotent' => true,\n    ),\n)\n```\n\n### Data Modification (Non-Destructive)\n\n```php\n'meta' => array(\n    'annotations' => array(\n        'readonly' => false,\n        'destructive' => false,\n        'idempotent' => false,\n    ),\n)\n```\n\n### Potentially Destructive Operations\n\n```php\n'meta' => array(\n    'annotations' => array(\n        'readonly' => false,\n        'destructive' => true,\n        'idempotent' => false,\n    ),\n),\n'permission_callback' => function() {\n    return current_user_can( 'manage_options' );\n}\n```\n\n## Advanced Features\n\n### Client-Side Category Registration\n\nWhen registering client-side abilities with custom categories, use `registerAbilityCategory()` before registering the ability:\n\n```javascript\nimport { registerAbilityCategory, registerAbility } from '@wordpress/abilities';\n\n// Register the category first\nawait registerAbilityCategory('my-custom-category', {\n  label: 'My Custom Category',\n  description: 'Description of what abilities belong in this category',\n  meta: {\n    icon: 'dashicons-admin-customizer',\n    priority: 10,\n  },\n});\n\n// Then register abilities using that category\nawait registerAbility({\n  name: 'my-plugin/my-ability',\n  category: 'my-custom-category', // Uses the client-registered category\n  // ... other properties\n});\n```\n\n### Custom Ability Classes (Advanced)\n\nFor advanced use cases requiring custom behavior, specify a custom class that extends `WP_Ability` using the `ability_class` parameter:\n\n```php\nclass Custom_Ability extends WP_Ability {\n    // Override methods for custom behavior\n    public function execute( $input = array() ) {\n        // Custom execution logic\n        return parent::execute( $input );\n    }\n}\n\nwp_register_ability( 'my-plugin/custom-ability', array(\n    // ... standard parameters\n    'ability_class' => Custom_Ability::class, // Use custom class instead of WP_Ability\n) );\n```\n\n**Note:** This is an advanced feature. Most abilities should use the default `WP_Ability` class.\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/1.intro.md": "# 1. Introduction & Overview\n\n## What is the Abilities API?\n\nThe WordPress Abilities API provides a standardized way to register and discover distinct units of functionality within a WordPress site. These units, called \"Abilities\", represent specific actions or capabilities that components can perform, with clearly defined inputs, outputs, and permissions.\n\nIt acts as a central registry, making it easier for different parts of WordPress, third-party plugins, themes, and external systems (like AI agents) to understand and interact with the capabilities available on a specific site.\n\n## Core Concepts\n\n- **Ability:** A distinct piece of functionality with a unique name following the `namespace/ability-name` pattern. Each ability has a human-readable name and description, input/output definitions (using JSON Schema), a category assignment, optional permissions, and an associated callback function for execution. Each registered Ability is an instance of the `WP_Ability` class.\n- **Category:** A way to organize related abilities. Each ability must belong to exactly one category. Categories have a slug, label, and description. Each registered category is an instance of the `WP_Ability_Category` class.\n- **Registry:** A central, singleton object (`WP_Abilities_Registry`) that holds all registered abilities. It provides methods for registering, unregistering, finding, and querying abilities. Similarly, `WP_Abilities_Category_Registry` manages all registered categories.\n- **Callback:** The PHP function or method executed when an ability is called via `WP_Ability::execute()`.\n- **Schema:** JSON Schema definitions for an ability's expected input (`input_schema`) and its returned output (`output_schema`). This allows for validation and helps agents understand how to use the ability.\n- **Permission Callback:** An optional function that determines if the current user can execute a specific ability.\n- **Namespace:** The first part of an ability name (before the slash), typically matching the plugin or component name that registers the ability.\n\n## Goals and Benefits\n\n- **Standardization:** Provides a single, consistent way to expose site capabilities.\n- **Discoverability:** Makes functionality easily discoverable by AI systems and automation tools.\n- **Validation:** Built-in input/output validation using JSON Schema ensures data integrity.\n- **Security:** Permission callbacks provide fine-grained access control.\n- **Extensibility:** Simple registration pattern allows any plugin or theme to expose their capabilities.\n- **AI-Friendly:** Machine-readable format enables intelligent automation and AI agent interactions.\n\n## Use Cases\n\n- **AI Integration:** Allow AI agents to discover and interact with site capabilities.\n- **Plugin Interoperability:** Enable plugins to discover and use each other's functionality.\n- **Automation Tools:** Provide programmatic access to site features.\n- **API Documentation:** Self-documenting capabilities with schema validation.\n- **Developer Tools:** Standardized way to expose plugin functionality.\n\n## Registration Example\n\n```php\n// First, register a category, or use one of the existing categories.\nadd_action( 'abilities_api_categories_init', 'my_plugin_register_category');\nfunction my_plugin_register_category(){\n\twp_register_ability_category( 'site-information', array(\n\t\t'label' => __( 'Site Information', 'my-plugin' ),\n\t\t'description' => __( 'Abilities that provide information about the WordPress site.', 'my-plugin' ),\n\t));\n}\n\n// Then, register an ability in that category\nadd_action( 'abilities_api_init', 'my_plugin_register_ability');\nfunction my_plugin_register_ability(){\n\twp_register_ability( 'my-plugin/site-info', array(\n\t\t'label' => __( 'Site Info', 'my-plugin' ),\n\t\t'description' => __( 'Returns information about this WordPress site', 'my-plugin' ),\n\t\t'category' => 'site-information',\n\t\t'input_schema' => array(),\n\t\t'output_schema' => array(\n\t\t\t'type' => 'object',\n\t\t\t'properties' => array(\n\t\t\t\t'site_name' => array(\n\t\t\t\t\t'type' => 'string',\n\t\t\t\t\t'description' => __( 'The name of the WordPress site', 'my-plugin' )\n\t\t\t\t),\n\t\t\t\t'site_url' => array(\n\t\t\t\t\t'type' => 'string',\n\t\t\t\t\t'description' => __( 'The URL of the WordPress site', 'my-plugin' )\n\t\t\t\t),\n\t\t\t\t'active_theme' => array(\n\t\t\t\t\t'type' => 'string',\n\t\t\t\t\t'description' => __( 'The active theme of the WordPress site', 'my-plugin' )\n\t\t\t\t),\n\t\t\t\t'active_plugins' => array(\n\t\t\t\t\t'type' => 'array',\n\t\t\t\t\t'items' => array(\n\t\t\t\t\t\t'type' => 'string'\n\t\t\t\t\t),\n\t\t\t\t\t'description' => __( 'List of active plugins on the WordPress site', 'my-plugin' )\n\t\t\t\t),\n\t\t\t\t'php_version' => array(\n\t\t\t\t\t'type' => 'string',\n\t\t\t\t\t'description' => __( 'The PHP version of the WordPress site', 'my-plugin' )\n\t\t\t\t),\n\t\t\t\t'wordpress_version' => array(\n\t\t\t\t\t'type' => 'string',\n\t\t\t\t\t'description' => __( 'The WordPress version of the site', 'my-plugin' )\n\t\t\t\t)\n\t\t\t),\n\t\t),\n\t\t'execute_callback' => 'my_plugin_get_siteinfo',\n\t\t'permission_callback' => function( $input ) {\n\t\t\treturn current_user_can( 'manage_options' );\n\t\t},\n    'meta' => array(\n      'show_in_rest' => true,\n    ),\n\t) );\n}\n```\n\nThis creates a machine-readable capability that AI systems and automation tools can discover, understand, and execute safely within the bounds of WordPress permissions and validation rules.\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/2.getting-started.md": "# 2. Getting Started\n\n## Installation\n\nUntil the Abilities API is merged into WordPress core, it must be installed before it can be used.\n\n### As a plugin\n\nThe easiest way to try and use the Abilities API is to install it as a plugin by downloading the latest release from the [GitHub Releases page](https://github.com/WordPress/abilities-api/releases/latest).\n\n#### With WP-CLI\n\n```bash\nwp plugin install https://github.com/WordPress/abilities-api/releases/latest/download/abilities-api.zip\n```\n\n#### With WP-Env\n\n```jsonc\n// .wp-env.json\n{\n  \"$schema\": \"https://schemas.wp.org/trunk/wp-env.json\",\n  // ... other config ...\n  \"plugins\": [\n    \"WordPress/abilities-api\"\n    // ... other plugins ...\n  ]\n  // ... more config ...\n}\n```\n\n### As a dependency\n\nPlugin authors and developers may wish to rely on the Abilities API as a dependency in their own projects, before it is merged into core. You can do that in one of the following ways.\n\n#### As a Plugin Dependency (Recommended)\n\nThe best way to ensure the Abilities API is available for your plugins is to include it as one of your `Requires Plugins` in your [Plugin header](https://developer.wordpress.org/plugins/plugin-basics/header-requirements/). For example:\n\n```diff\n# my-plugin.php\n/*\n *\n * Plugin Name:       My Plugin\n * Plugin URI:        https://example.com/plugins/the-basics/\n * Description:       Handle the basics with this plugin.\n * {all the other plugin header fields...}\n+ * Requires Plugins:  abilities-api\n */\n```\n\nWhile this is enough to ensure the Abilities API is loaded before your plugin, if you need to ensure specific version requirements or provide users guidance on installing the plugin, you can use the methods described [later on](#checking-availability-with-code)\n\n#### As a Composer dependency\n\n```bash\ncomposer require wordpress/abilities-api\n```\n\n### Checking availability with code\n\nTo ensure the Abilities API is loaded in your plugin:\n\n```php\nif ( ! class_exists( 'WP_Ability' ) ) {\n  // E.g. add an admin notice about the missing dependency.\n  add_action( 'admin_notices', static function() {\n    wp_admin_notice(\n      // If it's a Composer dependency, you might want to suggest running `composer install` instead.\n      esc_html__( 'This plugin requires the Abilities API to use. Please install and activate it.', 'my-plugin' ),\n      'error'\n    );\n  } );\n  return;\n}\n```\n\nYou can also check for specific versions of the Abilities API using the `WP_ABILITIES_API_VERSION` constant:\n\n```php\nif ( ! defined( 'WP_ABILITIES_API_VERSION' ) || version_compare( WP_ABILITIES_API_VERSION, '0.1.0', '<' ) ) {\n  // E.g. add an admin notice about the required version.\n  add_action( 'admin_notices', static function() {\n    wp_admin_notice(\n      esc_html__( 'This plugin requires Abilities API version 0.1.0 or higher. Please update the plugin dependency.', 'my-plugin' ),\n      'error'\n    );\n  } );\n  return;\n}\n```\n\n## Basic Usage Example\n\nThe below example is for a plugin implementation, but it could also be adapted for a theme's functions.php\n\n```php\n<?php\n\n// 1. Define a callback function for your ability.\nfunction my_plugin_get_site_title( array $input = array() ): string {\n    return get_bloginfo( 'name' );\n}\n\n// 2. Register the ability when the Abilities API is initialized.\n// Using `abilities_api_init` ensures the API is fully loaded.\nadd_action( 'abilities_api_init', 'my_plugin_register_abilities' );\n\nfunction my_plugin_register_abilities() {\n    wp_register_ability( 'my-plugin/get-site-title', array(\n        'label'               => __( 'Get Site Title', 'my-plugin' ),\n        'description'         => __( 'Retrieves the title of the current WordPress site.', 'my-plugin' ),\n        'input_schema'        => array(\n            'type'                 => 'object',\n            'properties'           => array(),\n            'additionalProperties' => false,\n        ),\n        'output_schema'       => array(\n            'type'        => 'string',\n            'description' => 'The site title.',\n        ),\n        'execute_callback'    => 'my_plugin_get_site_title',\n        'permission_callback' => '__return_true', // Everyone can access this\n        'meta'                => array(\n            'category'    => 'site-info',\n            'show_in_rest' => true, // Optional: expose via REST API\n    ) );\n}\n\n// 3. Later, you can retrieve and execute the ability.\nadd_action( 'admin_init', 'my_plugin_use_ability' );\n\nfunction my_plugin_use_ability() {\n    $ability = wp_get_ability( 'my-plugin/get-site-title' );\n    if ( ! $ability ) {\n        // Ability not found.\n        return;\n    }\n\n    $site_title = $ability->execute();\n    if ( is_wp_error( $site_title ) ) {\n        // Handle execution error\n        error_log( 'Execution error: ' . $site_title->get_error_message() );\n        return;\n    }\n\n    // `$site_title` now holds the result of `get_bloginfo( 'name' )`.\n    echo 'Site Title: ' . esc_html( $site_title );\n}\n```\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/3.registering-abilities.md": "# 3. Registering Abilities (`wp_register_ability`)\n\nThe primary way to add functionality to the Abilities API is by using the `wp_register_ability()` function, typically hooked into the `abilities_api_init` action.\n\n## Function Signature\n\n```php\nwp_register_ability( string $id, array $args ): ?\\WP_Ability\n```\n\n- `$id` (`string`): A unique identifier for the ability.\n- `$args` (`array`): An array of arguments defining the ability configuration.\n- **Return:** (`?\\WP_Ability`) An instance of the registered ability if it was successfully registered, `null` on failure (e.g., invalid arguments, duplicate ID).\n\n## Parameters Explained\n\nThe `$args` array accepts the following keys:\n\n- `label` (`string`, **Required**): A human-readable name for the ability. Used for display purposes. Should be translatable.\n- `description` (`string`, **Required**): A detailed description of what the ability does, its purpose, and its parameters or return values. This is crucial for AI agents to understand how and when to use the ability. Should be translatable.\n- `category` (`string`, **Required**): The slug of the category this ability belongs to. The category must be registered before registering the ability using `wp_register_ability_category()`. Categories help organize and filter abilities by their purpose. See [Registering Categories](7.registering-categories.md) for details.\n- `input_schema` (`array`, **Required**): A JSON Schema definition describing the expected input parameters for the ability's execute callback. Used for validation and documentation.\n- `output_schema` (`array`, **Required**): A JSON Schema definition describing the expected format of the data returned by the ability. Used for validation and documentation.\n- `execute_callback` (`callable`, **Required**): The PHP function or method to execute when this ability is called.\n  - The callback receives one optional argument: it can have any type as defined in the input schema (e.g., `array`, `object`, `string`, etc.).\n  - The callback should return the result of the ability's operation or return a `WP_Error` object on failure.\n- `permission_callback` (`callable`, **Required**): A callback function to check if the current user has permission to execute this ability.\n  - The callback receives one optional argument: it can have any type as defined in the input schema (e.g., `array`, `object`, `string`, etc.).\n  - The callback should return a boolean (`true` if the user has permission, `false` otherwise), or a `WP_Error` object on failure.\n  - If the input does not validate against the input schema, the permission callback will not be called, and a `WP_Error` will be returned instead.\n- `meta` (`array`, **Optional**): An associative array for storing arbitrary additional metadata about the ability.\n  - `annotations` (`array`, **Optional**): An associative array of annotations providing hints about the ability's behavior characteristics. Supports the following keys:\n    - `instructions` (`string`, **Optional**): Custom instructions or guidance for using the ability (default: `''`).\n    - `readonly` (`boolean`, **Optional**): Whether the ability only reads data without modifying its environment (default: `false`).\n    - `destructive` (`boolean`, **Optional**): Whether the ability may perform destructive updates to its environment. If `true`, the ability may perform any type of modification, including deletions or other destructive changes. If `false`, the ability performs only additive updates (default: `true`).\n    - `idempotent` (`boolean`, **Optional**): Whether calling the ability repeatedly with the same arguments will have no additional effect on its environment (default: `false`).\n  - `show_in_rest` (`boolean`, **Optional**): Whether to expose this ability via the REST API. Default: `false`.\n    - When `true`, the ability will be listed in REST API responses and can be executed via REST endpoints.\n    - When `false`, the ability will be hidden from REST API listings and cannot be executed via REST endpoints, but remains available for internal PHP usage.\n\n## Ability ID Convention\n\nThe `$id` parameter must follow the pattern `namespace/ability-name`:\n\n- **Format:** Must contain only lowercase alphanumeric characters (`a-z`, `0-9`), hyphens (`-`), and one forward slash (`/`) for namespacing.\n- **Convention:** Use your plugin slug as the namespace, like `my-plugin/ability-name`.\n- **Examples:** `my-plugin/update-settings`, `woocommerce/get-product`, `contact-form/send-message`, `analytics/track-event`\n\n## Code Examples\n\n### Registering a Simple Data Retrieval Ability\n\n```php\nadd_action( 'abilities_api_init', 'my_plugin_register_site_info_ability' );\nfunction my_plugin_register_site_info_ability() {\n    wp_register_ability( 'my-plugin/get-site-info', array(\n        'label' => __( 'Get Site Information', 'my-plugin' ),\n        'description' => __( 'Retrieves basic information about the WordPress site including name, description, and URL.', 'my-plugin' ),\n        'category' => 'data-retrieval',\n        'input_schema' => array(\n            'type' => 'object',\n            'properties' => array(),\n            'additionalProperties' => false\n        ),\n        'output_schema' => array(\n            'type' => 'object',\n            'properties' => array(\n                'name' => array(\n                    'type' => 'string',\n                    'description' => 'Site name'\n                ),\n                'description' => array(\n                    'type' => 'string',\n                    'description' => 'Site tagline'\n                ),\n                'url' => array(\n                    'type' => 'string',\n                    'format' => 'uri',\n                    'description' => 'Site URL'\n                )\n            )\n        ),\n        'execute_callback' => function( $input ) {\n            return array(\n                'name' => get_bloginfo( 'name' ),\n                'description' => get_bloginfo( 'description' ),\n                'url' => home_url()\n            );\n        },\n        'permission_callback' => '__return_true',\n        'meta' => array(\n            'annotations' => array(\n                'readonly' => true,\n                'destructive' => false\n            ),\n        ),\n    ));\n}\n```\n\n### Registering an Ability with Input Parameters\n\n```php\nadd_action( 'abilities_api_init', 'my_plugin_register_update_option_ability' );\nfunction my_plugin_register_update_option_ability() {\n    wp_register_ability( 'my-plugin/update-option', array(\n        'label' => __( 'Update WordPress Option', 'my-plugin' ),\n        'description' => __( 'Updates the value of a WordPress option in the database. Requires manage_options capability.', 'my-plugin' ),\n        'category' => 'data-modification',\n        'input_schema' => array(\n            'type' => 'object',\n            'properties' => array(\n                'option_name' => array(\n                    'type' => 'string',\n                    'description' => 'The name of the option to update',\n                    'minLength' => 1\n                ),\n                'option_value' => array(\n                    'description' => 'The new value for the option'\n                )\n            ),\n            'required' => array( 'option_name', 'option_value' ),\n            'additionalProperties' => false\n        ),\n        'output_schema' => array(\n            'type' => 'object',\n            'properties' => array(\n                'success' => array(\n                    'type' => 'boolean',\n                    'description' => 'Whether the option was successfully updated'\n                ),\n                'previous_value' => array(\n                    'description' => 'The previous value of the option'\n                )\n            )\n        ),\n        'execute_callback' => function( $input ) {\n            $option_name = $input['option_name'];\n            $new_value = $input['option_value'];\n\n            $previous_value = get_option( $option_name );\n            $success = update_option( $option_name, $new_value );\n\n            return array(\n                'success' => $success,\n                'previous_value' => $previous_value\n            );\n        },\n        'permission_callback' => function() {\n            return current_user_can( 'manage_options' );\n        },\n        'meta' => array(\n            'annotations' => array(\n                'destructive' => false,\n                'idempotent' => true\n            ),\n        ),\n    ));\n}\n```\n\n### Registering an Ability with Plugin Dependencies\n\n```php\nadd_action( 'abilities_api_init', 'my_plugin_register_woo_stats_ability' );\nfunction my_plugin_register_woo_stats_ability() {\n    // Only register if WooCommerce is active\n    if ( ! class_exists( 'WooCommerce' ) ) {\n        return;\n    }\n\n    wp_register_ability( 'my-plugin/get-woo-stats', array(\n        'label' => __( 'Get WooCommerce Statistics', 'my-plugin' ),\n        'description' => __( 'Retrieves basic WooCommerce store statistics including total orders and revenue.', 'my-plugin' ),\n        'category' => 'ecommerce',\n        'input_schema' => array(\n            'type' => 'object',\n            'properties' => array(\n                'period' => array(\n                    'type' => 'string',\n                    'enum' => array( 'today', 'week', 'month', 'year' ),\n                    'default' => 'month',\n                    'description' => 'Time period for statistics'\n                )\n            ),\n            'additionalProperties' => false\n        ),\n        'output_schema' => array(\n            'type' => 'object',\n            'properties' => array(\n                'total_orders' => array(\n                    'type' => 'integer',\n                    'description' => 'Number of orders in period'\n                ),\n                'total_revenue' => array(\n                    'type' => 'number',\n                    'description' => 'Total revenue in period'\n                )\n            )\n        ),\n        'execute_callback' => function( $input ) {\n            $period = $input['period'] ?? 'month';\n\n            // Implementation would calculate stats based on period\n            return array(\n                'total_orders' => 42,\n                'total_revenue' => 1250.50\n            );\n        },\n        'permission_callback' => function() {\n            return current_user_can( 'manage_woocommerce' );\n        },\n        'meta' => array(\n            'requires_plugin' => 'woocommerce',\n            'category' => 'ecommerce'\n        )\n    ));\n}\n```\n\n### Registering an Ability That May Fail\n\n```php\nadd_action( 'abilities_api_init', 'my_plugin_register_send_email_ability' );\nfunction my_plugin_register_send_email_ability() {\n    wp_register_ability( 'my-plugin/send-email', array(\n        'label' => __( 'Send Email', 'my-plugin' ),\n        'description' => __( 'Sends an email to the specified recipient using WordPress mail functions.', 'my-plugin' ),\n        'category' => 'communication',\n        'input_schema' => array(\n            'type' => 'object',\n            'properties' => array(\n                'to' => array(\n                    'type' => 'string',\n                    'format' => 'email',\n                    'description' => 'Recipient email address'\n                ),\n                'subject' => array(\n                    'type' => 'string',\n                    'minLength' => 1,\n                    'description' => 'Email subject'\n                ),\n                'message' => array(\n                    'type' => 'string',\n                    'minLength' => 1,\n                    'description' => 'Email message body'\n                )\n            ),\n            'required' => array( 'to', 'subject', 'message' ),\n            'additionalProperties' => false\n        ),\n        'output_schema' => array(\n            'type' => 'object',\n            'properties' => array(\n                'sent' => array(\n                    'type' => 'boolean',\n                    'description' => 'Whether the email was successfully sent'\n                )\n            )\n        ),\n        'execute_callback' => function( $input ) {\n            $sent = wp_mail(\n                $input['to'],\n                $input['subject'],\n                $input['message']\n            );\n\n            if ( ! $sent ) {\n                return new \\WP_Error(\n                    'email_send_failed',\n                    sprintf( __( 'Failed to send email' ), 'my-plugin' )\n                );\n            }\n\n            return array( 'sent' => true );\n        },\n        'permission_callback' => function() {\n            return current_user_can( 'publish_posts' );\n        }\n    ));\n}\n```\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/4.using-abilities.md": "# 4. Using Abilities (`wp_get_ability`, `wp_get_abilities`)\n\nOnce abilities are registered, they can be retrieved and executed using global functions from the Abilities API.\n\n## Getting a Specific Ability (`wp_get_ability`)\n\nTo get a single ability object by its name (namespace/ability-name):\n\n```php\n/**\n * Retrieves a registered ability using Abilities API.\n *\n * @param string $name The name of the registered ability, with its namespace.\n * @return ?WP_Ability The registered ability instance, or null if it is not registered.\n */\nfunction wp_get_ability( string $name ): ?WP_Ability\n\n// Example:\n$site_info_ability = wp_get_ability( 'my-plugin/get-site-info' );\n\nif ( $site_info_ability ) {\n\t// Ability exists and is registered\n\t$site_info = $site_info_ability->execute();\n\tif ( is_wp_error( $site_info ) ) {\n\t\t// Handle WP_Error\n\t\techo 'Error: ' . $site_info->get_error_message();\n\t} else {\n\t\t// Use $site_info array\n\t\techo 'Site Name: ' . $site_info['name'];\n\t}\n} else {\n\t// Ability not found or not registered\n}\n```\n\n## Getting All Registered Abilities (`wp_get_abilities`)\n\nTo get an array of all registered abilities:\n\n```php\n/**\n * Retrieves all registered abilities using Abilities API.\n *\n * @return WP_Ability[] The array of registered abilities.\n */\nfunction wp_get_abilities(): array\n\n// Example: Get all registered abilities\n$all_abilities = wp_get_abilities();\n\nforeach ( $all_abilities as $name => $ability ) {\n    echo 'Ability Name: ' . esc_html( $ability->get_name() ) . \"\\n\";\n    echo 'Label: ' . esc_html( $ability->get_label() ) . \"\\n\";\n    echo 'Description: ' . esc_html( $ability->get_description() ) . \"\\n\";\n    echo \"---\\n\";\n}\n```\n\n## Executing an Ability (`$ability->execute()`)\n\nOnce you have a `WP_Ability` object (usually from `wp_get_ability`), you execute it using the `execute()` method.\n\n```php\n/**\n * Executes the ability after input validation and running a permission check.\n *\n * @param mixed $input Optional. The input data for the ability. Defaults to `null`.\n * @return mixed|WP_Error The result of the ability execution, or WP_Error on failure.\n */\n// public function execute( $input = null )\n\n// Example 1: Ability with no input parameters\n$ability = wp_get_ability( 'my-plugin/get-site-info' );\nif ( $ability ) {\n    $site_info = $ability->execute(); // No input required\n    if ( is_wp_error( $site_info ) ) {\n        // Handle WP_Error\n        echo 'Error: ' . $site_info->get_error_message();\n    } else {\n        // Use $site_info array\n        echo 'Site Name: ' . $site_info['name'];\n    }\n}\n\n// Example 2: Ability with input parameters\n$ability = wp_get_ability( 'my-plugin/update-option' );\nif ( $ability ) {\n    $input = array(\n        'option_name'  => 'blogname',\n        'option_value' => 'My Updated Site Name',\n    );\n\n    $result = $ability->execute( $input );\n    if ( is_wp_error( $result ) ) {\n        // Handle WP_Error\n        echo 'Error: ' . $result->get_error_message();\n    } else {\n        // Use $result\n        if ( $result['success'] ) {\n            echo 'Option updated successfully!';\n            echo 'Previous value: ' . $result['previous_value'];\n        }\n    }\n}\n\n// Example 3: Ability with complex input validation\n$ability = wp_get_ability( 'my-plugin/send-email' );\nif ( $ability ) {\n    $input = array(\n        'to'      => 'user@example.com',\n        'subject' => 'Hello from WordPress',\n        'message' => 'This is a test message from the Abilities API.',\n    );\n\n    $result = $ability->execute( $input );\n    if ( is_wp_error( $result ) ) {\n        // Handle WP_Error\n        echo 'Error: ' . $result->get_error_message();\n    } elseif ( $result['sent'] ) {\n        echo 'Email sent successfully!';\n    } else {\n        echo 'Email failed to send.';\n    }\n}\n```\n\n## Checking Permissions (`$ability->check_permissions()`)\n\nYou can check if the current user has permissions to execute the ability, also without executing it. The `check_permissions()` method returns either `true`, `false`, or a `WP_Error` object. `true` means permission is granted, `false` means the user simply lacks permission, and a `WP_Error` return value typically indicates a failure in the permission check process (such as an internal error or misconfiguration). You must use `is_wp_error()` to handle errors properly and distinguish between permission denial and actual errors:\n\n```php\n$ability = wp_get_ability( 'my-plugin/update-option' );\nif ( $ability ) {\n    $input = array(\n        'option_name'  => 'blogname',\n        'option_value' => 'New Site Name',\n    );\n\n    // Check permission before execution - always use is_wp_error() first\n    $has_permissions = $ability->check_permissions( $input );\n    if ( true === $has_permissions ) {\n        // Permissions granted â safe to execute.\n        echo 'You have permissions to execute this ability.';\n    } else {\n        // Don't leak permission errors to unauthenticated users.\n        if ( is_wp_error( $has_permissions ) ) {\n            error_log( 'Permissions check failed: ' . $has_permissions->get_error_message() );\n        }\n\n        echo 'You do not have permissions to execute this ability.';\n    }\n}\n```\n\n## Inspecting Ability Properties\n\nThe `WP_Ability` class provides several getter methods to inspect ability properties:\n\n```php\n$ability = wp_get_ability( 'my-plugin/get-site-info' );\nif ( $ability ) {\n    // Basic properties\n    echo 'Name: ' . $ability->get_name() . \"\\n\";\n    echo 'Label: ' . $ability->get_label() . \"\\n\";\n    echo 'Description: ' . $ability->get_description() . \"\\n\";\n\n    // Schema information\n    $input_schema = $ability->get_input_schema();\n    $output_schema = $ability->get_output_schema();\n\n    echo 'Input Schema: ' . json_encode( $input_schema, JSON_PRETTY_PRINT ) . \"\\n\";\n    echo 'Output Schema: ' . json_encode( $output_schema, JSON_PRETTY_PRINT ) . \"\\n\";\n\n    // Metadata\n    $meta = $ability->get_meta();\n    if ( ! empty( $meta ) ) {\n        echo 'Metadata: ' . json_encode( $meta, JSON_PRETTY_PRINT ) . \"\\n\";\n    }\n}\n```\n\n## Error Handling Patterns\n\nThe Abilities API uses several error handling mechanisms:\n\n```php\n$ability = wp_get_ability( 'my-plugin/some-ability' );\n\nif ( ! $ability ) {\n    // Ability not registered\n    echo 'Ability not found';\n    return;\n}\n\n$result = $ability->execute( $input );\n\n// Check for WP_Error (validation, permission, or callback errors)\nif ( is_wp_error( $result ) ) {\n    echo 'WP_Error: ' . $result->get_error_message();\n    return;\n}\n\n// Check for null result (permission denied, invalid callback, or validation failure)\nif ( is_null( $result ) ) {\n    echo 'Execution returned null - check permissions and callback validity';\n    return;\n}\n\n// Success - use the result\n// Process $result based on the ability's output schema\n```\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/5.rest-api.md": "# 5. REST API Reference\n\nThe WordPress Abilities API provides REST endpoints that allow external systems to discover and execute abilities via HTTP requests.\n\n## User access\n\nAccess to all Abilities REST API endpoints requires an authenticated user (see the [Authentication](#authentication) section). Access to execute individual Abilities is restricted based on the `permission_callback()` of the Ability.\n\n## Controlling REST API Exposure\n\nBy default, registered abilities are **not** exposed via the REST API. You can control whether an individual ability appears in the REST API by using the `show_in_rest` meta when registering the ability:\n\n- `show_in_rest => true`: The ability is listed in REST API responses and can be executed via REST endpoints.\n- `show_in_rest => false` (default): The ability is hidden from REST API listings and cannot be executed via REST endpoints. The ability remains available for internal PHP usage via `wp_execute_ability()`.\n\nAbilities with meta `show_in_rest => false` will return a `rest_ability_not_found` error if accessed via REST endpoints.\n\n## Schema\n\nThe Abilities API endpoints are available under the `/wp/v2/abilities` namespace.\n\n### Ability Object\n\nAbilities are represented in JSON with the following structure:\n\n```json\n{\n  \"name\": \"my-plugin/get-site-info\",\n  \"label\": \"Get Site Information\",\n  \"description\": \"Retrieves basic information about the WordPress site.\",\n  \"category\": \"site-information\",\n  \"output_schema\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"name\": {\n        \"type\": \"string\",\n        \"description\": \"Site name\"\n      },\n      \"url\": {\n        \"type\": \"string\",\n        \"format\": \"uri\",\n        \"description\": \"Site URL\"\n      }\n    }\n  },\n  \"meta\": {\n    \"annotations\": {\n      \"instructions\": \"\",\n      \"readonly\": true,\n      \"destructive\": false,\n      \"idempotent\": false\n    }\n  }\n}\n```\n\n## List Abilities\n\n### Definition\n\n`GET /wp/v2/abilities`\n\n### Arguments\n\n- `page` _(integer)_: Current page of the collection. Default: `1`.\n- `per_page` _(integer)_: Maximum number of items to return per page. Default: `50`, Maximum: `100`.\n- `category` _(string)_: Filter abilities by category slug.\n\n### Example Request\n\n```bash\ncurl https://example.com/wp-json/wp/v2/abilities\n```\n\n### Example Response\n\n```json\n[\n  {\n    \"name\": \"my-plugin/get-site-info\",\n    \"label\": \"Get Site Information\",\n    \"description\": \"Retrieves basic information about the WordPress site.\",\n    \"category\": \"site-information\",\n    \"output_schema\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"description\": \"Site name\"\n        },\n        \"url\": {\n          \"type\": \"string\",\n          \"format\": \"uri\",\n          \"description\": \"Site URL\"\n        }\n      }\n    },\n    \"meta\": {\n      \"annotations\": {\n        \"instructions\": \"\",\n        \"readonly\": false,\n        \"destructive\": true,\n        \"idempotent\": false\n      }\n    }\n  }\n]\n```\n\n## List Categories\n\n### Definition\n\n`GET /wp/v2/abilities/categories`\n\n### Arguments\n\n- `page` _(integer)_: Current page of the collection. Default: `1`.\n- `per_page` _(integer)_: Maximum number of items to return per page. Default: `50`, Maximum: `100`.\n\n### Example Request\n\n```bash\ncurl -u 'USERNAME:APPLICATION_PASSWORD' \\\n  https://example.com/wp-json/wp/v2/abilities/categories\n```\n\n### Example Response\n\n```json\n[\n  {\n    \"slug\": \"data-retrieval\",\n    \"label\": \"Data Retrieval\",\n    \"description\": \"Abilities that retrieve and return data from the WordPress site.\",\n    \"meta\": {},\n    \"_links\": {\n      \"self\": [\n        {\n          \"href\": \"https://example.com/wp-json/wp/v2/abilities/categories/data-retrieval\"\n        }\n      ],\n      \"collection\": [\n        {\n          \"href\": \"https://example.com/wp-json/wp/v2/abilities/categories\"\n        }\n      ],\n      \"abilities\": [\n        {\n          \"href\": \"https://example.com/wp-json/wp/v2/abilities?category=data-retrieval\"\n        }\n      ]\n    }\n  }\n]\n```\n\n## Retrieve a Category\n\n### Definition\n\n`GET /wp/v2/abilities/categories/{slug}`\n\n### Arguments\n\n- `slug` _(string)_: The unique slug of the category.\n\n### Example Request\n\n```bash\ncurl -u 'USERNAME:APPLICATION_PASSWORD' \\\n  https://example.com/wp-json/wp/v2/abilities/categories/data-retrieval\n```\n\n### Example Response\n\n```json\n{\n  \"slug\": \"data-retrieval\",\n  \"label\": \"Data Retrieval\",\n  \"description\": \"Abilities that retrieve and return data from the WordPress site.\",\n  \"meta\": {},\n  \"_links\": {\n    \"self\": [\n      {\n        \"href\": \"https://example.com/wp-json/wp/v2/abilities/categories/data-retrieval\"\n      }\n    ],\n    \"collection\": [\n      {\n        \"href\": \"https://example.com/wp-json/wp/v2/abilities/categories\"\n      }\n    ],\n    \"abilities\": [\n      {\n        \"href\": \"https://example.com/wp-json/wp/v2/abilities?category=data-retrieval\"\n      }\n    ]\n  }\n}\n```\n\n## Retrieve an Ability\n\n### Definition\n\n`GET /wp/v2/abilities/(?P<namespace>[a-z0-9-]+)/(?P<ability>[a-z0-9-]+)`\n\n### Arguments\n\n- `namespace` _(string)_: The namespace part of the ability name.\n- `ability` _(string)_: The ability name part.\n\n### Example Request\n\n```bash\ncurl https://example.com/wp-json/wp/v2/abilities/my-plugin/get-site-info\n```\n\n### Example Response\n\n```json\n{\n  \"name\": \"my-plugin/get-site-info\",\n  \"label\": \"Get Site Information\",\n  \"description\": \"Retrieves basic information about the WordPress site.\",\n  \"category\": \"site-information\",\n  \"output_schema\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"name\": {\n        \"type\": \"string\",\n        \"description\": \"Site name\"\n      },\n      \"url\": {\n        \"type\": \"string\",\n        \"format\": \"uri\",\n        \"description\": \"Site URL\"\n      }\n    }\n  },\n  \"meta\": {\n    \"annotations\": {\n      \"instructions\": \"\",\n      \"readonly\": true,\n      \"destructive\": false,\n      \"idempotent\": false\n    }\n  }\n}\n```\n\n## Execute an Ability\n\nAbilities are executed via the `/run` endpoint. The required HTTP method depends on the ability's `readonly` annotation:\n\n- **Read-only abilities** (`readonly: true`) must use **GET**\n- **Regular abilities** (default) must use **POST**\n\nThis distinction ensures read-only operations use safe HTTP methods that can be cached and don't modify server state.\n\n### Definition\n\n`GET|POST /wp/v2/abilities/(?P<namespace>[a-z0-9-]+)/(?P<ability>[a-z0-9-]+)/run`\n\n### Arguments\n\n- `namespace` _(string)_: The namespace part of the ability name.\n- `ability` _(string)_: The ability name part.\n- `input` _(integer|number|boolean|string|array|object|null)_: Optional input data for the ability as defined by its input schema.\n  - For **GET requests**: pass as `input` query parameter (URL-encoded JSON)\n  - For **POST requests**: pass in JSON body\n\n### Example Request (Read-only, GET)\n\n```bash\n# No input\ncurl https://example.com/wp-json/wp/v2/abilities/my-plugin/get-site-info/run\n\n# With input (URL-encoded)\ncurl \"https://example.com/wp-json/wp/v2/abilities/my-plugin/get-user-info/run?input=%7B%22user_id%22%3A1%7D\"\n```\n\n### Example Request (Regular, POST)\n\n```bash\n# No input\ncurl -X POST https://example.com/wp-json/wp/v2/abilities/my-plugin/create-draft/run\n\n# With input\ncurl -X POST \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"input\":{\"option_name\":\"blogname\",\"option_value\":\"New Site Name\"}}' \\\n  https://example.com/wp-json/wp/v2/abilities/my-plugin/update-option/run\n```\n\n### Example Response (Success)\n\n```json\n{\n  \"name\": \"My WordPress Site\",\n  \"url\": \"https://example.com\"\n}\n```\n\n### Example Response (Error)\n\n```json\n{\n  \"code\": \"ability_invalid_permissions\",\n  \"message\": \"Ability \\\"my-plugin/update-option\\\" does not have necessary permission.\",\n  \"data\": {\n    \"status\": 403\n  }\n}\n```\n\n## Authentication\n\nThe Abilities API supports all WordPress REST API authentication methods:\n\n- Cookie authentication (same-origin requests)\n- Application passwords (recommended for external access)\n- Custom authentication plugins\n\n### Using Application Passwords\n\n```bash\ncurl -u 'USERNAME:APPLICATION_PASSWORD' \\\n  https://example.com/wp-json/wp/v2/abilities\n```\n\n## Error Responses\n\nThe API returns standard WordPress REST API error responses with these common codes:\n\n- `ability_missing_input_schema` â the ability requires input but none was provided.\n- `ability_invalid_input` - input validation failed according to the ability's schema.\n- `ability_invalid_permissions` - current user lacks permission to execute the ability.\n- `ability_invalid_output` - output validation failed according to the ability's schema.\n- `ability_invalid_execute_callback` - the ability's execute callback is not callable.\n- `rest_ability_not_found` - the requested ability is not registered.\n- `rest_category_not_found` - the requested category is not registered.\n- `rest_ability_invalid_method` - the requested HTTP method is not allowed for executing the selected ability (e.g., using GET on a read-only ability, or POST on a regular ability).\n- `rest_ability_cannot_execute` - the ability cannot be executed due to insufficient permissions.\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/6.hooks.md": "# 6. Hooks\n\nThe Abilities API provides [WordPress Action and Filter Hooks](https://developer.wordpress.org/apis/hooks/) that allow developers to monitor and respond to ability execution events.\n\n## Quick Links\n\n- [Actions](#actions)\n  - [`abilities_api_categories_init`](#abilities_api_categories_init)\n  - [`before_execute_ability`](#before_execute_ability)\n  - [`after_execute_ability`](#after_execute_ability)\n- [Filters](#filters)\n  - [`register_ability_args`](#register_ability_args)\n  - [`register_ability_category_args`](#register_ability_category_args)\n\n## Actions\n\n### `abilities_api_categories_init`\n\nFires when the category registry is first initialized. This is the proper hook to use when registering categories.\n\n```php\ndo_action( 'abilities_api_categories_init', $registry );\n```\n\n#### Parameters\n\n- `$registry` (`\\WP_Abilities_Category_Registry`): The category registry instance.\n\n#### Usage Example\n\n```php\n/**\n * Register custom ability categories.\n *\n * @param \\WP_Abilities_Category_Registry $registry The category registry instance.\n */\nfunction my_plugin_register_categories( $registry ) {\n    wp_register_ability_category( 'ecommerce', array(\n        'label' => __( 'E-commerce', 'my-plugin' ),\n        'description' => __( 'Abilities related to e-commerce functionality.', 'my-plugin' ),\n    ));\n\n    wp_register_ability_category( 'analytics', array(\n        'label' => __( 'Analytics', 'my-plugin' ),\n        'description' => __( 'Abilities that provide analytical data and insights.', 'my-plugin' ),\n    ));\n}\nadd_action( 'abilities_api_categories_init', 'my_plugin_register_categories' );\n```\n\n### `before_execute_ability`\n\nFires immediately before an ability gets executed, after permission checks have passed but before the execution callback is called.\n\n```php\ndo_action( 'before_execute_ability', $ability_name, $input );\n```\n\n#### Parameters\n\n- `$ability_name` (`string`): The namespaced name of the ability being executed (e.g., `my-plugin/get-posts`).\n- `$input` (`mixed`): The input data passed to the ability.\n\n#### Usage Example\n\n```php\n/**\n * Log each ability execution attempt.\n * @param string $ability_name The name of the ability being executed.\n * @param mixed  $input        The input data passed to the ability.\n */\nfunction log_ability_execution( string $ability_name, $input ) {\n    error_log( 'About to execute ability: ' . $ability_name );\n    if ( $input !== null ) {\n        error_log( 'Input: ' . wp_json_encode( $input ) );\n    }\n}\nadd_action( 'before_execute_ability', 'log_ability_execution', 10, 2 );\n```\n\n### `after_execute_ability`\n\nFires immediately after an ability has finished executing successfully, after output validation has passed.\n\n```php\ndo_action( 'after_execute_ability', string $ability_name, $input, $result );\n```\n\n#### Parameters\n\n- `$ability_name` (`string`): The namespaced name of the ability that was executed.\n- `$input` (`mixed`): The input data that was passed to the ability.\n- `$result` (`mixed`): The validated result returned by the ability's execution callback.\n\n#### Usage Example\n\n```php\n/**\n * Log the result of each ability execution.\n *\n * @param string $ability_name The name of the executed ability.\n * @param mixed  $input        The input data passed to the ability.\n * @param mixed  $result       The result returned by the ability.\n */\nfunction log_ability_result( string $ability_name, $input, $result ) {\n    error_log( 'Completed ability: ' . $ability_name );\n    error_log( 'Result: ' . wp_json_encode( $result ) );\n}\nadd_action( 'after_execute_ability', 'log_ability_result', 10, 3 );\n```\n\n## Filters\n\n### `register_ability_args`\n\nAllows modification of an Ability's args before they are validated and used to instantiate the Ability.\n\n```php\n$args = apply_filters( 'register_ability_args', array $args, string $ability_name );\n```\n\n#### Parameters\n\n- `$args` (`array<string,mixed>`): The arguments used to instantiate the ability. See [wp_register_ability()](./3.registering-abilities.md#wp_register_ability) for the full list of args.\n- `$ability_name` (`string`): The namespaced name of the ability being registered (e.g., `my-plugin/get-posts`).\n\n#### Usage Example\n\n```php\n/**\n * Modify ability args before validation.\n *\n * @param array<string,mixed> $args         The arguments used to instantiate the ability.\n * @param string              $ability_name The name of the ability, with its namespace.\n *\n * @return array<string,mixed> The modified ability arguments.\n */\nfunction my_modify_ability_args( array $args, string $ability_name ): array {\n    // Check if the ability name matches what you're looking for.\n    if ( 'my-namespace/my-ability' !== $ability_name ) {\n      return $args;\n    }\n\n    // Modify the args as needed.\n    $args['label'] = __('My Custom Ability Label');\n\n    // You can use the old args to build new ones.\n    $args['description'] = sprintf(\n        /* translators: 1: Ability name 2: Previous description */\n        __('This is a custom description for the ability %s. Previously the description was %s', 'text-domain'),\n        $ability_name,\n        $args['description'] ?? 'N/A'\n    );\n\n    // Even if they're callbacks.\n    $args['permission_callback' ] = static function ( $input = null ) use ( $args, $ability_name ) {\n        $previous_check = is_callable( $args['permission_callback'] ) ? $args['permission_callback']( $input ) : true;\n\n        // If we already failed, no need for stricter checks.\n        if ( ! $previous_check || is_wp_error( $previous_check ) ) {\n            return $previous_check;\n        }\n\n        return current_user_can( 'my_custom_ability_cap', $ability_name );\n    }\n\n    return $args;\n}\nadd_filter( 'register_ability_args', 'my_modify_ability_args', 10, 2 );\n```\n\n### `register_ability_category_args`\n\nAllows modification of a category's arguments before validation.\n\n```php\n$args = apply_filters( 'register_ability_category_args', array $args, string $slug );\n```\n\n#### Parameters\n\n- `$args` (`array<string,mixed>`): The arguments used to instantiate the category (label, description).\n- `$slug` (`string`): The slug of the category being registered.\n\n#### Usage Example\n\n```php\n/**\n * Modify category args before validation.\n *\n * @param array<string,mixed> $args The arguments used to instantiate the category.\n * @param string              $slug The slug of the category being registered.\n *\n * @return array<string,mixed> The modified category arguments.\n */\nfunction my_modify_category_args( array $args, string $slug ): array {\n    if ( 'my-category' === $slug ) {\n        $args['label'] = __( 'My Custom Label', 'my-plugin' );\n        $args['description'] = __( 'My custom description for this category.', 'my-plugin' );\n    }\n    return $args;\n}\nadd_filter( 'register_ability_category_args', 'my_modify_category_args', 10, 2 );\n```\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/7.javascript-client.md": "# 7. JavaScript/TypeScript Client\n\nThe JavaScript client provides an interface for discovering and executing WordPress Abilities from the browser.\n\n## Overview\n\nThe JavaScript client enables frontend code to interact with the Abilities API system. It can:\n\n- Discover all registered abilities on your WordPress site\n- Execute server-side PHP abilities\n- Register and execute client-side JavaScript abilities\n\nYou can read more about installation and setup in the [package readme](../packages/client/README.md).\n\n## Core API Functions\n\n### `getAbilities( args = {} )`\n\nReturns an array of all registered abilities (both server-side and client-side).\n\n**Parameters:** `args` (object, optional) - Query arguments to filter abilities. Supported arguments:\n\n- `category` (string) - Filter abilities by category slug\n\n**Returns:** `Promise<Array>` - Array of ability objects\n\n**Example:**\n\n```javascript\nimport { getAbilities } from `@wordpress/abilities`;\n\nconst abilities = await getAbilities();\nconsole.log(`Found ${abilities.length} abilities`);\n\n// List all abilities\nabilities.forEach(ability => {\n    console.log(`${ability.name}: ${ability.description}`);\n});\n\n// Get abilities in a specific category\nconst dataAbilities = await getAbilities( { category: 'data-retrieval' } );\n\nconsole.log( `Found ${ dataAbilities.length } data retrieval abilities` );\n```\n\n### getAbility( name )\n\nRetrieves a specific ability by name.\n\n**Parameters:**\n\n- `name` (string) - The ability name (e.g., 'my-plugin/get-posts')\n\n**Returns:** `Promise<Object|null>` - The ability object or null if not found\n\n**Example:**\n\n```javascript\nconst ability = await getAbility( 'my-plugin/get-site-info' );\nif ( ability ) {\n  console.log( 'Label:', ability.label );\n  console.log( 'Description:', ability.description );\n  console.log( 'Input Schema:', ability.input_schema );\n}\n```\n\n### `getAbilityCategories()`\n\nReturns an array of all registered ability categories.\n\n**Parameters:** None\n\n**Returns:** `Promise<Array>` - Array of category objects\n\n**Example:**\n\n```javascript\nconst categories = await getAbilityCategories();\nconsole.log( `Found ${ categories.length } categories` );\n\n// List all categories\ncategories.forEach( ( category ) => {\n  console.log( `${ category.label }: ${ category.description }` );\n} );\n```\n\n### `getAbilityCategory( slug )`\n\nRetrieves a specific category by slug.\n\n**Parameters:**\n\n- `slug` (string) - The category slug (e.g., 'data-retrieval')\n\n**Returns:** `Promise<Object|null>` - The category object or null if not found\n\n**Example:**\n\n```javascript\nconst category = await getAbilityCategory( 'data-retrieval' );\nif ( category ) {\n  console.log( 'Label:', category.label );\n  console.log( 'Description:', category.description );\n}\n```\n\n### `executeAbility( name, input = null )`\n\nExecutes an ability with the provided input data.\n\n**Parameters:**\n\n- `name` (string) - The ability name\n- `input` (any, optional) - Input data for the ability\n\n**Returns:** `Promise<any>` - The ability's output\n\n**Example:**\n\n```javascript\n// Execute without input\nconst siteTitle = await executeAbility( 'my-plugin/get-site-title' );\nconsole.log( 'Site:', siteTitle );\n\n// Execute with input parameters\nconst posts = await executeAbility( 'my-plugin/get-posts', {\n  category: 'news',\n  limit: 5,\n} );\nposts.forEach( ( post ) => console.log( post.title ) );\n```\n\n### `registerAbility( ability )`\n\nRegisters a client-side ability that runs in the browser.\n\n**Parameters:**\n\n- `ability` (object) - The ability configuration object\n\n**Returns:** `Promise<void>`\n\n**Example:**\n\n```javascript\n// showNotification function\nconst showNotification = ( message ) => {\n  new Notification( message );\n  return { success: true, displayed: message };\n};\n\n// Register a notification ability which calls the showNotification function\nawait registerAbility( {\n  name: 'my-plugin/show-notification',\n  label: 'Show Notification',\n  description: 'Display a notification message to the user',\n  input_schema: {\n    type: 'object',\n    properties: {\n      message: { type: 'string' },\n      type: { type: 'string', enum: [ 'success', 'error', 'warning', 'info' ] },\n    },\n    required: [ 'message' ],\n  },\n  callback: async ( { message, type = 'info' } ) => {\n    // Show browser notification\n    if ( ! ( 'Notification' in window ) ) {\n      alert( 'This browser does not support desktop notification' );\n      return {\n        success: false,\n        error: 'Browser does not support notifications',\n      };\n    }\n    if ( Notification.permission !== 'granted' ) {\n      Notification.requestPermission().then( ( permission ) => {\n        if ( permission === 'granted' ) {\n          return showNotification( message );\n        }\n      } );\n    }\n    return showNotification( message );\n  },\n  permissionCallback: () => {\n    return !! wp.data.select( 'core' ).getCurrentUser();\n  },\n} );\n\n// Use the registered ability\nconst result = await executeAbility( 'my-plugin/show-notification', {\n  message: 'Hello World!',\n  type: 'success',\n} );\n```\n\n### `unregisterAbility( name )`\n\nRemoves a previously registered client-side ability.\n\n**Parameters:**\n\n- `name` (string) - The ability name to unregister\n\n**Returns:** `void`\n\n**Example:**\n\n```javascript\n// Unregister an ability\nunregisterAbility( 'my-plugin/old-ability' );\n```\n\n### `registerAbilityCategory( slug, args )`\n\nRegisters a client-side ability category. This is useful when registering client-side abilities that introduce new categories not defined by the server.\n\n**Parameters:**\n\n- `slug` (string) - The category slug (lowercase alphanumeric with dashes only)\n- `args` (object) - Category configuration object\n  - `label` (string) - Human-readable label for the category\n  - `description` (string) - Detailed description of the category\n  - `meta` (object, optional) - Optional metadata about the category\n\n**Returns:** `Promise<void>`\n\n**Example:**\n\n```javascript\n// Register a new category\nawait registerAbilityCategory( 'block-editor', {\n  label: 'Block Editor',\n  description: 'Abilities for interacting with the WordPress block editor',\n} );\n\n// Register a category with metadata\nawait registerAbilityCategory( 'custom-category', {\n  label: 'Custom Category',\n  description: 'A category for custom abilities',\n  meta: {\n    priority: 'high',\n    icon: 'dashicons-admin-customizer',\n  },\n} );\n\n// Then register abilities using the new category\nawait registerAbility( {\n  name: 'my-plugin/insert-block',\n  label: 'Insert Block',\n  description: 'Inserts a block into the editor',\n  category: 'block-editor', // Uses the client-registered category\n  callback: async ( { blockType } ) => {\n    // Implementation\n    return { success: true };\n  },\n} );\n```\n\n### `unregisterAbilityCategory( slug )`\n\nRemoves a previously registered client-side category.\n\n**Parameters:**\n\n- `slug` (string) - The category slug to unregister\n\n**Returns:** `void`\n\n**Example:**\n\n```javascript\n// Unregister a category\nunregisterAbilityCategory( 'block-editor' );\n```\n\n## Error Handling\n\nAll functions return promises that may reject with specific error codes:\n\n```javascript\ntry {\n  const result = await executeAbility( 'my-plugin/restricted-action', input );\n  console.log( 'Success:', result );\n} catch ( error ) {\n  switch ( error.code ) {\n    case 'ability_permission_denied':\n      console.error( 'Permission denied:', error.message );\n      break;\n    case 'ability_invalid_input':\n      console.error( 'Invalid input:', error.message );\n      break;\n    case 'rest_ability_not_found':\n      console.error( 'Ability not found:', error.message );\n      break;\n    default:\n      console.error( 'Execution failed:', error.message );\n  }\n}\n```\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/references/7.registering-categories.md": "# 7. Registering Categories\n\nBefore registering abilities, you must register at least one category. Categories help organize abilities and make them easier to discover and filter.\n\n## Function Signature\n\n```php\nwp_register_ability_category( string $slug, array $args ): ?\\WP_Ability_Category\n```\n\n**Parameters:**\n- `$slug` (`string`): A unique identifier for the category. Must contain only lowercase alphanumeric characters and dashes (no underscores, no uppercase).\n- `$args` (`array`): Category configuration with these keys:\n  - `label` (`string`, **Required**): Human-readable name for the category. Should be translatable.\n  - `description` (`string`, **Required**): Detailed description of the category's purpose. Should be translatable.\n  - `meta` (`array`, **Optional**): An associative array for storing arbitrary additional metadata about the category.\n\n**Return:** (`?\\WP_Ability_Category`) An instance of the registered category if it was successfully registered, `null` on failure (e.g., invalid arguments, duplicate slug).\n\n**Note:** Categories must be registered during the `abilities_api_categories_init` action hook.\n\n## Code Example\n\n```php\nadd_action( 'abilities_api_categories_init', 'my_plugin_register_categories' );\nfunction my_plugin_register_categories() {\n    wp_register_ability_category( 'data-retrieval', array(\n        'label' => __( 'Data Retrieval', 'my-plugin' ),\n        'description' => __( 'Abilities that retrieve and return data from the WordPress site.', 'my-plugin' ),\n    ));\n\n    wp_register_ability_category( 'data-modification', array(\n        'label' => __( 'Data Modification', 'my-plugin' ),\n        'description' => __( 'Abilities that modify data on the WordPress site.', 'my-plugin' ),\n    ));\n\n    wp_register_ability_category( 'communication', array(\n        'label' => __( 'Communication', 'my-plugin' ),\n        'description' => __( 'Abilities that send messages or notifications.', 'my-plugin' ),\n    ));\n}\n```\n\n## Category Slug Convention\n\nThe `$slug` parameter must follow these rules:\n\n- **Format:** Must contain only lowercase alphanumeric characters (`a-z`, `0-9`) and hyphens (`-`).\n- **Valid examples:** `data-retrieval`, `ecommerce`, `site-information`, `user-management`, `category-123`\n- **Invalid examples:**\n  - Uppercase: `Data-Retrieval`, `MyCategory`\n  - Underscores: `data_retrieval`\n  - Special characters: `data.retrieval`, `data/retrieval`, `data retrieval`\n  - Leading/trailing dashes: `-data`, `data-`\n  - Double dashes: `data--retrieval`\n\n## Other Category Functions\n\n- `wp_unregister_ability_category( string $slug )` - Remove a registered category. Returns the unregistered category instance or `null` on failure.\n- `wp_get_ability_category( string $slug )` - Retrieve a specific category by slug. Returns the category instance or `null` if not found.\n- `wp_get_ability_categories()` - Get all registered categories as an associative array keyed by slug.\n",
        "claude-code-plugins/wordpress-ability-api/skills/wordpress-ability-api/scripts/README.md": "# WordPress Ability API Scripts\n\nThis directory contains automation scripts for scaffolding and validating WordPress Abilities and Categories.\n\n## Scripts\n\n### Ability Scripts\n\n- **scaffold-ability.php** - Generate ability code from CLI arguments\n- **validate-ability.php** - Validate PHP ability registration code\n\n### Category Scripts\n\n- **scaffold-category.php** - Generate category registration code (PHP or JS)\n- **validate-category.php** - Validate PHP category registration code\n- **validate-category.js** - Validate JavaScript category registration code\n\n## Requirements\n\n### PHP Scripts\n\n- PHP 7.0+ (uses `token_get_all()` for parsing)\n- No external dependencies\n\n### JavaScript Validator\n\n- Node.js\n- acorn parser\n\nTo install acorn:\n\n```bash\nnpm install acorn\n```\n\nOr install globally:\n\n```bash\nnpm install -g acorn\n```\n\n## Usage\n\nSee individual script headers for detailed usage instructions.\n\nQuick examples:\n\n```bash\n# Scaffold a server-side ability\nphp scaffold-ability.php --name=\"plugin/ability\" --type=\"server\" --category=\"data-retrieval\"\n\n# Scaffold a category\nphp scaffold-category.php --name=\"custom-category\" --label=\"Custom\" --description=\"Description\" --type=\"server\"\n\n# Validate PHP category\nphp validate-category.php path/to/category.php\n\n# Validate JavaScript category\nnode validate-category.js path/to/category.js\n```\n",
        "claude-code-plugins/wordpress-plugin-scaffold/skills/wordpress-plugin-scaffold/SKILL.md": "---\nname: wordpress-plugin-scaffold\ndescription: Scaffold WordPress plugins using WP-CLI commands (wp scaffold plugin, wp scaffold plugin-tests). Use this skill when creating new WordPress plugins or adding test infrastructure to existing plugins.\n---\n\n# WordPress Plugin Scaffold\n\nThis skill provides guidance for scaffolding WordPress plugins using WP-CLI's scaffold commands. It supports both creating new plugins from scratch and adding test infrastructure to existing plugins.\n\n**Note:** This skill works seamlessly with the **wp-env skill (if available)**. When wp-env setup or management is needed, activate the wp-env skill for comprehensive environment handling.\n\n## About WP-CLI Scaffold Commands\n\nWP-CLI provides two primary scaffolding commands for plugin development:\n\n### wp scaffold plugin\n\nGenerates starter code for a new plugin, including:\n\n- Main plugin PHP file\n- `readme.txt` for WordPress.org\n- `package.json` with Grunt tasks for i18n and readme conversion\n- Editor configuration files (`.editorconfig`, `.gitignore`, `.distignore`)\n- Optional: PHPUnit test suite, CI configuration, and PHP_CodeSniffer rules\n\n### wp scaffold plugin-tests\n\nAdds PHPUnit test infrastructure to an existing plugin, including:\n\n- `phpunit.xml.dist` configuration\n- CI configuration (CircleCI, GitHub Actions, GitLab, Bitbucket)\n- `bin/install-wp-tests.sh` for WordPress test suite setup\n- `tests/bootstrap.php` to activate the plugin during tests\n- `tests/test-sample.php` with example test cases\n- `.phpcs.xml.dist` for PHP_CodeSniffer rules\n\n## Prerequisites\n\nVerify WP-CLI is installed and accessible:\n\n```bash\nwp --version\n```\n\nIf WP-CLI is not installed, see [references/wp-cli-installation.md](references/wp-cli-installation.md) for comprehensive installation instructions across all platforms.\n\n## Environment Detection\n\n**IMPORTANT:** Before running any scaffold commands, detect which WordPress environment is available:\n\n### Detection Strategy\n\n1. **Check for existing WordPress installation** (preferred):\n\n   ```bash\n   wp core version 2>/dev/null\n   ```\n\n   - If successful â Use `wp scaffold plugin` directly\n   - You're already in a WordPress installation, no additional setup needed\n\n2. **Check for wp-env configuration**:\n\n   ```bash\n   # Look for wp-env config files\n   [ -f .wp-env.json ] || [ -f .wp-env.override.json ]\n   ```\n\n   - If found â Check if wp-env is running\n   - If running â Use `wp-env run cli wp scaffold plugin`\n   - If not running â **Activate the wp-env skill (if available)** to start the environment\n\n3. **Check for wp-env availability** (fallback):\n\n   ```bash\n   wp-env --version 2>/dev/null\n   ```\n\n   - If available â Ask user if they want to use wp-env\n   - **Activate the wp-env skill (if available)** for environment setup and management\n\n4. **No environment available** (error):\n   - Inform user they need either:\n     - A WordPress installation with `--path` flag\n     - wp-env setup (see wp-env skill if available)\n\n### Command Prefix Selection\n\nBased on detection, use the appropriate command prefix throughout this skill:\n\n- **In WordPress installation:** `wp scaffold plugin`\n- **Using wp-env:** `wp-env run cli wp scaffold plugin`\n\nAll examples below show the base command. Prepend `wp-env run cli` when using wp-env.\n\n## Workflow: Creating a New Plugin\n\nWhen creating a new WordPress plugin, follow this interactive workflow:\n\n### 1. Gather Plugin Metadata\n\nCollect the following information from the user, offering smart defaults:\n\n- **Plugin slug** (required) - Internal name, lowercase with hyphens\n  - Default: Infer from current directory name or user's request\n\n- **Plugin name** - Display name for the plugin header\n  - Default: Title-case version of slug\n\n- **Plugin description** - What the plugin does\n  - Default: Ask user to provide\n\n- **Plugin author** - Author name\n  - Default: Use `git config user.name` if available\n\n- **Plugin author URI** - Author website URL\n  - Default: Use `git config user.url` if available, otherwise skip\n\n- **Plugin URI** - Plugin project URL\n  - Default: Skip unless user provides\n\n### 2. Determine Additional Options\n\nAsk the user about these options:\n\n- **Include tests?** - Whether to generate PHPUnit test files\n  - Default: Yes (recommended for all plugins)\n  - Use `--skip-tests` flag to omit\n\n- **CI provider** - Which continuous integration service to use\n  - Options: `circle` (default), `github`, `gitlab`, `bitbucket`\n  - Use `--ci=<provider>` flag\n\n- **Target directory** - Where to create the plugin\n  - Default: Current working directory\n  - Use `--dir=<path>` to specify custom location\n\n### 3. Construct and Execute Command\n\nBuild the `wp scaffold plugin` command with gathered information:\n\n```bash\nwp scaffold plugin <slug> \\\n  --plugin_name=\"<name>\" \\\n  --plugin_description=\"<description>\" \\\n  --plugin_author=\"<author>\" \\\n  --plugin_author_uri=\"<author-uri>\" \\\n  --plugin_uri=\"<plugin-uri>\" \\\n  --ci=<provider>\n```\n\nAdd `--skip-tests` if user declined test files.\nAdd `--dir=<path>` if custom directory specified.\n\n### 4. Post-Scaffold Actions\n\nAfter successfully scaffolding the plugin:\n\n1. **Verify creation** - Confirm files were generated:\n\n   ```bash\n   ls -la <plugin-directory>\n   ```\n\n2. **Ask about activation** - If wp-env is running, offer to activate:\n   - \"Would you like me to activate this plugin in your wp-env environment?\"\n   - If yes, run: `wp-env run cli wp plugin activate <slug>`\n   - For network activation: `wp-env run cli wp plugin activate <slug> --network`\n\n3. **Next steps guidance** - Inform user about:\n   - Main plugin file location: `<slug>/<slug>.php`\n   - How to run tests if included: `wp-env run tests-cli --env-cwd=wp-content/plugins/<slug> phpunit`\n   - NPM scripts available: `npm run readme`, `npm run i18n`\n\n## Workflow: Adding Tests to Existing Plugin\n\nWhen adding test infrastructure to an existing plugin:\n\n### 1. Identify Plugin\n\nDetermine which plugin needs tests:\n\n- **Plugin slug** - The plugin directory name\n- **Plugin directory** - Path to the plugin (use `--dir` if non-standard)\n\n### 2. Determine CI Provider\n\nAsk which CI service the user wants:\n\n- Options: `circle` (default), `github`, `gitlab`, `bitbucket`\n\n### 3. Execute Command\n\nRun the scaffold plugin-tests command:\n\n```bash\n# Standard plugin location\nwp scaffold plugin-tests <plugin-slug> --ci=<provider>\n\n# Non-standard location\nwp scaffold plugin-tests --dir=<path/to/plugin> --ci=<provider>\n```\n\nAdd `--force` flag to overwrite existing test files if needed.\n\n### 4. Post-Scaffold Actions\n\nAfter generating test files:\n\n1. **Set up test environment** - Guide user through test setup:\n\n   ```bash\n   # Install WordPress test suite (if not using wp-env)\n   bash bin/install-wp-tests.sh wordpress_test root password localhost latest\n\n   # Or use wp-env for testing\n   wp-env run tests-cli --env-cwd=wp-content/plugins/<slug> phpunit\n   ```\n\n2. **Verify test execution** - Run the sample test:\n\n   ```bash\n   wp-env run tests-cli --env-cwd=wp-content/plugins/<slug> phpunit\n   ```\n\n3. **Next steps** - Inform user about:\n   - Writing additional tests in `tests/` directory\n   - Running specific test files or test cases\n   - CI/CD integration based on chosen provider\n\n## Common Options Reference\n\n| Option               | Description                                          | Example              |\n| -------------------- | ---------------------------------------------------- | -------------------- |\n| `--skip-tests`       | Don't generate PHPUnit test files                    | `--skip-tests`       |\n| `--ci=<provider>`    | CI configuration (circle, github, gitlab, bitbucket) | `--ci=github`        |\n| `--activate`         | Activate plugin after creation                       | `--activate`         |\n| `--activate-network` | Network activate plugin after creation               | `--activate-network` |\n| `--force`            | Overwrite existing files                             | `--force`            |\n| `--dir=<path>`       | Custom directory for plugin                          | `--dir=/custom/path` |\n\n**Note:** `--activate` and `--activate-network` flags work with local wp-cli WordPress installations but not with wp-env. For wp-env, use `wp-env run cli wp plugin activate` instead.\n\n## Best Practices\n\n### Plugin Naming\n\n- Use lowercase letters, numbers, and hyphens only\n- Be descriptive but concise\n- Follow WordPress plugin naming conventions\n- Examples: `my-contact-form`, `analytics-dashboard`, `custom-post-types`\n\n### When to Skip Tests\n\nSkip tests (`--skip-tests`) only when:\n\n- Creating a quick prototype or proof-of-concept\n- Building a personal plugin that won't be distributed\n- Planning to add tests later with `wp scaffold plugin-tests`\n\n**Always include tests for:**\n\n- Plugins intended for public distribution\n- Team projects with multiple contributors\n- Plugins with complex business logic\n- Any production-ready code\n\n### CI Provider Selection\n\nChoose a CI provider based on your repository host:\n\n- **GitHub repositories** â `--ci=github` (GitHub Actions)\n- **GitLab repositories** â `--ci=gitlab` (GitLab CI)\n- **Bitbucket repositories** â `--ci=bitbucket` (Bitbucket Pipelines)\n- **Other/unknown** â `--ci=circle` (CircleCI)\n\n### Working with wp-env\n\nWhen developing with wp-env:\n\n1. **Scaffold inside wp-env directory structure:**\n\n   ```bash\n   # Create plugin in wp-env's plugin directory\n   cd /path/to/wp-env-project\n   wp scaffold plugin my-plugin --dir=plugins/\n   ```\n\n2. **Or scaffold separately and configure .wp-env.json:**\n\n   ```json\n   {\n     \"plugins\": [\".\", \"../other-plugin\"]\n   }\n   ```\n\n3. **Activate after scaffolding:**\n\n   ```bash\n   wp-env run cli wp plugin activate my-plugin\n   ```\n\n4. **Run tests in wp-env:**\n\n   ```bash\n   wp-env run tests-cli --env-cwd=wp-content/plugins/my-plugin phpunit\n   ```\n\n## Example Interactions\n\n### Creating a New Plugin\n\n**User:** \"Create a new WordPress plugin called 'site-analytics' for tracking visitor analytics\"\n\n**Process:**\n\n1. Gather metadata (use smart defaults from git config)\n2. Ask about tests (default: yes) and CI provider (default: github)\n3. Execute: `wp scaffold plugin site-analytics --plugin_name=\"Site Analytics\" --plugin_description=\"Track visitor analytics and generate reports\" --plugin_author=\"Em\" --ci=github`\n4. Ask: \"Would you like me to activate this plugin in wp-env?\"\n\n### Adding Tests to Existing Plugin\n\n**User:** \"Add tests to my existing 'custom-widgets' plugin\"\n\n**Process:**\n\n1. Identify plugin location\n2. Ask about CI provider\n3. Execute: `wp scaffold plugin-tests custom-widgets --ci=github`\n4. Guide user through running tests with wp-env\n\n## Additional Resources\n\n- [WP-CLI Scaffold Plugin Documentation](https://developer.wordpress.org/cli/commands/scaffold/plugin/)\n- [WP-CLI Scaffold Plugin Tests Documentation](https://developer.wordpress.org/cli/commands/scaffold/plugin-tests/)\n- [Plugin Unit Tests Handbook](https://make.wordpress.org/cli/handbook/misc/plugin-unit-tests/)\n- [WordPress Plugin Handbook](https://developer.wordpress.org/plugins/)\n",
        "claude-code-plugins/wordpress-plugin-scaffold/skills/wordpress-plugin-scaffold/references/wp-cli-installation.md": "# WP-CLI Installation Guide\n\nThis reference provides comprehensive installation instructions for WP-CLI across different platforms and methods.\n\n## Quick Check\n\nVerify if WP-CLI is already installed:\n\n```bash\nwp --version\n```\n\nIf installed, you'll see the version number. If not, follow the installation method below that best suits your environment.\n\n## Recommended Installation (Phar Method)\n\nThe recommended way to install WP-CLI is by downloading the Phar build, marking it executable, and placing it on your PATH.\n\n### Step 1: Download WP-CLI\n\n```bash\ncurl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar\n```\n\n### Step 2: Verify It Works\n\n```bash\nphp wp-cli.phar --info\n```\n\n### Step 3: Make It Executable and Move to PATH\n\n```bash\nchmod +x wp-cli.phar\nsudo mv wp-cli.phar /usr/local/bin/wp\n```\n\n### Step 4: Test the Installation\n\n```bash\nwp --info\n```\n\nYou should see output showing OS, PHP version, WP-CLI version, etc.\n\n## Updating WP-CLI\n\nIf you installed using the Phar method:\n\n```bash\nwp cli update\n```\n\nOr with sudo if WP-CLI is owned by root:\n\n```bash\nsudo wp cli update\n```\n\nFor nightly builds (bleeding edge):\n\n```bash\nwp cli update --nightly\n```\n\n## Platform-Specific Installation\n\n### macOS (Homebrew)\n\n```bash\nbrew install wp-cli\n```\n\n### Windows\n\n1. Ensure PHP is installed and in your PATH\n2. Download [wp-cli.phar](https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar) to `c:\\wp-cli`\n3. Create `wp.bat` in `c:\\wp-cli`:\n\n   ```batch\n   @ECHO OFF\n   php \"c:/wp-cli/wp-cli.phar\" %*\n   ```\n\n4. Add `c:\\wp-cli` to your PATH:\n\n   ```batch\n   setx path \"%path%;c:\\wp-cli\"\n   ```\n\n### Debian/Ubuntu (.deb package)\n\nDownload and install from:\n[https://github.com/wp-cli/builds/tree/gh-pages/deb](https://github.com/wp-cli/builds/tree/gh-pages/deb)\n\n### Fedora 30+\n\n```bash\nsu -c 'dnf install wp-cli'\n```\n\n### CentOS\n\n```bash\nsu -c 'yum install wp-cli'\n```\n\n## Alternative Installation Methods\n\n### Via Composer (Global)\n\nIf you have Composer and `~/.composer/vendor/bin` in your PATH:\n\n```bash\ncomposer global require wp-cli/wp-cli-bundle\n```\n\nUpdate all global packages:\n\n```bash\ncomposer global update\n```\n\n### Via Composer (Project)\n\nAdd to your project's `composer.json`:\n\n```json\n\"require\": {\n    \"wp-cli/wp-cli-bundle\": \"*\"\n}\n```\n\n### Via Docker\n\nUse the official WordPress CLI image:\n\n```yaml\nimage: wordpress:cli\n```\n\nSee [WordPress Docker images](https://hub.docker.com/_/wordpress/) for more details.\n\n### Specific Version\n\nInstall a specific version via Composer:\n\n```bash\ncomposer create-project wp-cli/wp-cli-bundle:2.1.0 --no-dev\n```\n\n### Bleeding Edge (dev-main)\n\n```bash\ncomposer create-project wp-cli/wp-cli-bundle:dev-main --no-dev\n```\n\n## Shell Completion\n\n### Bash & Zsh\n\nDownload the completion script:\n\n```bash\ncurl -O https://github.com/wp-cli/wp-cli/raw/main/utils/wp-completion.bash\n```\n\nAdd to `~/.bash_profile` or `~/.zshrc`:\n\n```bash\nsource /FULL/PATH/TO/wp-completion.bash\n```\n\nReload your profile:\n\n```bash\nsource ~/.bash_profile  # or source ~/.zshrc\n```\n\n### Oh My Zsh\n\nEnable the built-in `wp-cli` plugin in `~/.zshrc`:\n\n```bash\nplugins=(wp-cli git [...])\n```\n\nThen reload:\n\n```bash\nsource ~/.zshrc\n```\n\n### Fish\n\nDownload and install completion:\n\n```bash\ncurl -O https://github.com/wp-cli/wp-cli/raw/main/utils/wp.fish\nmv wp.fish ~/.config/fish/completions/wp.fish\n```\n\n## Custom PHP Binary (MAMP, etc.)\n\nIf you need to use a custom PHP binary (e.g., MAMP):\n\n### Latest MAMP PHP Version\n\nAdd to `~/.bash_profile` or `~/.zshrc`:\n\n```bash\nPHP_VERSION=$(ls /Applications/MAMP/bin/php/ | sort -n | tail -1)\nexport PATH=/Applications/MAMP/bin/php/${PHP_VERSION}/bin:$PATH\n```\n\n### Specific MAMP PHP Version\n\nAdd to `~/.bash_profile` or `~/.zshrc`:\n\n```bash\nexport PATH=/Applications/MAMP/bin/php/php5.5.26/bin:$PATH\n```\n\nReload profile:\n\n```bash\nsource ~/.bash_profile  # or source ~/.zshrc\n```\n\nVerify:\n\n```bash\nwp --info\n```\n\n### Using WP_CLI_PHP Environment Variable\n\nFor Composer and Git-based installations:\n\n```bash\nexport WP_CLI_PHP=/path/to/custom/php\n```\n\n## Troubleshooting\n\n### Command Not Found\n\nIf `wp` command is not found after installation:\n\n1. Check that `/usr/local/bin` is in your PATH:\n\n   ```bash\n   echo $PATH\n   ```\n\n2. Verify the file exists and is executable:\n\n   ```bash\n   ls -la /usr/local/bin/wp\n   ```\n\n3. Try using the full path:\n\n   ```bash\n   /usr/local/bin/wp --info\n   ```\n\n### Permission Denied\n\nIf you get permission errors:\n\n```bash\nsudo chmod +x /usr/local/bin/wp\n```\n\n### PHP Version Issues\n\nWP-CLI requires PHP 7.4 or later. Check your PHP version:\n\n```bash\nphp --version\n```\n\nIf your PHP version is too old, you'll need to upgrade PHP or use a custom PHP binary (see above).\n\n## Additional Resources\n\n- [Official WP-CLI Installation Guide](https://make.wordpress.org/cli/handbook/guides/installing/)\n- [Official WP-CLI Documentation](https://make.wordpress.org/cli/handbook/)\n- [WP-CLI Commands Reference](https://developer.wordpress.org/cli/commands/)\n- [WP-CLI GitHub Repository](https://github.com/wp-cli/wp-cli)\n- [Quick Start Guide](https://make.wordpress.org/cli/handbook/quick-start/)\n",
        "claude-code-plugins/wp-env/skills/wp-env/SKILL.md": "---\nname: wp-env\ndescription: Local WordPress development environment management using @wordpress/env for plugin and theme development. Use this skill when setting up, configuring, starting, stopping, or managing wp-env Docker-based WordPress environments.\n---\n\n# wp-env - WordPress Local Development Environment\n\nThis skill provides assistance for working with `wp-env`, a tool that sets up local WordPress development environments using Docker with minimal configuration.\n\n## About wp-env\n\n`wp-env` (`@wordpress/env`) creates Docker-based WordPress environments for plugin and theme development. It provides:\n\n- **Zero-config setup** - Works out of the box for plugins and themes\n- **Dual environments** - Separate development (port 8888) and testing (port 8889) instances\n- **Pre-configured tools** - Includes WP-CLI, Composer, PHPUnit, and Xdebug\n- **Flexible configuration** - Customize via `.wp-env.json` for complex setups\n\n**Default Access:**\n\n- Development site: <http://localhost:8888>\n- Testing site: <http://localhost:8889>\n- Login: username `admin`, password `password`\n- Database: user `root`, password `password`\n\n## Prerequisites Check\n\nBefore working with wp-env, verify these dependencies are installed and running:\n\n```bash\n# Check Docker is installed and running\ndocker --version\ndocker ps\n\n# Check Node.js and npm\nnode --version\nnpm --version\n\n# Check if wp-env is installed\nwp-env --version\n```\n\n**If Docker is not running:** Start Docker Desktop application first - wp-env cannot function without Docker.\n\n**If wp-env is not installed:** Install globally with `npm -g install @wordpress/env`\n\n## Common Workflows\n\n### First-Time Environment Setup\n\nWhen setting up wp-env for the first time in a plugin or theme directory:\n\n```bash\n# 1. Ensure Docker Desktop is running\ndocker ps\n\n# 2. Install wp-env globally (if not already installed)\nnpm -g install @wordpress/env\n\n# 3. Navigate to your plugin or theme directory\ncd /path/to/your/plugin\n\n# 4. Start the environment (downloads WordPress, sets up containers)\nwp-env start\n\n# 5. Access the site at http://localhost:8888\n# Login with admin/password\n```\n\nwp-env will automatically detect if the current directory is a plugin or theme and mount it appropriately.\n\n### Daily Development Operations\n\n**Starting the environment:**\n\n```bash\n# Start with existing configuration\nwp-env start\n\n# Start and update WordPress/sources\nwp-env start --update\n\n# Start with Xdebug enabled for debugging\nwp-env start --xdebug\n```\n\n**Stopping the environment:**\n\n```bash\n# Stop containers (preserves data)\nwp-env stop\n```\n\n**Checking environment status:**\n\n```bash\n# View running containers\ndocker ps\n\n# Should show: wordpress (8888), tests-wordpress (8889), mariadb (3306)\n```\n\n### Running WP-CLI Commands\n\nExecute WordPress CLI commands inside the environment using `wp-env run`:\n\n```bash\n# List users on development instance\nwp-env run cli wp user list\n\n# Install a plugin\nwp-env run cli wp plugin install contact-form-7 --activate\n\n# Create a test post on the testing instance\nwp-env run tests-cli wp post create --post_title=\"Test Post\" --post_status=publish\n\n# Update permalink structure (enables REST API access)\nwp-env run cli \"wp rewrite structure /%postname%/\"\n\n# Open WordPress shell for interactive PHP\nwp-env run cli wp shell\n```\n\n**Environment types:**\n\n- `cli` / `wordpress` - Development environment (shares database with port 8888)\n- `tests-cli` / `tests-wordpress` - Testing environment (separate database, port 8889)\n\n**Working directory context:**\nBy default, commands run from WordPress root. For plugin-specific commands, use `--env-cwd`:\n\n```bash\n# Run composer install in your plugin directory\nwp-env run cli --env-cwd=wp-content/plugins/your-plugin composer install\n\n# Run PHPUnit tests in your plugin\nwp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit\n```\n\n### Database Reset for Testing\n\nReset the database to clean state:\n\n```bash\n# Reset only the tests database (default)\nwp-env clean\n\n# Reset development database\nwp-env clean development\n\n# Reset both databases\nwp-env clean all\n```\n\nâ ï¸ **Warning:** This permanently deletes all posts, pages, media, and custom data.\n\n### Viewing Logs\n\nMonitor PHP errors and Docker container logs:\n\n```bash\n# View development environment logs (follows/watches by default)\nwp-env logs\n\n# View testing environment logs\nwp-env logs tests\n\n# View both environments\nwp-env logs all\n\n# Disable following/watching\nwp-env logs --watch=false\n```\n\n### Working with Ports\n\nIf the default port 8888 conflicts with another service:\n\n```bash\n# Using environment variables\nWP_ENV_PORT=3333 wp-env start\n\n# Check which ports are in use\ndocker ps\n```\n\nOr configure ports in `.wp-env.json`:\n\n```json\n{\n  \"port\": 3333,\n  \"testsPort\": 3334\n}\n```\n\nNote: Environment variables take precedence over `.wp-env.json` values.\n\n## Quick Reference - Essential Commands\n\n| Command                            | Description                                   |\n| ---------------------------------- | --------------------------------------------- |\n| `wp-env start`                     | Start the environment                         |\n| `wp-env start --update`            | Start and update WordPress/sources            |\n| `wp-env stop`                      | Stop the environment                          |\n| `wp-env clean [env]`               | Reset database (env: tests, development, all) |\n| `wp-env destroy`                   | Completely remove containers and data         |\n| `wp-env logs [env]`                | View logs (env: development, tests, all)      |\n| `wp-env run <container> <command>` | Execute command in container                  |\n| `wp-env install-path`              | Show where environment files are stored       |\n| `docker ps`                        | Check which containers are running            |\n\n**Common containers for `wp-env run`:**\n\n- `cli` - WP-CLI, Composer, PHPUnit (development)\n- `tests-cli` - WP-CLI, Composer, PHPUnit (testing)\n- `wordpress` - WordPress PHP environment (development)\n- `tests-wordpress` - WordPress PHP environment (testing)\n\n## Configuration with .wp-env.json\n\nCreate a `.wp-env.json` file in your project root to customize the environment.\n\n### Common Configuration Patterns\n\n**Basic plugin development:**\n\n```json\n{\n  \"plugins\": [\".\"]\n}\n```\n\n**Custom WordPress version:**\n\n```json\n{\n  \"core\": \"WordPress/WordPress#6.4.0\",\n  \"plugins\": [\".\"]\n}\n```\n\n**Multi-plugin setup:**\n\n```json\n{\n  \"plugins\": [\".\", \"WordPress/classic-editor\", \"../another-plugin\"]\n}\n```\n\nFor complete configuration reference with 20+ examples, environment-specific overrides, custom mappings, multisite setup, and lifecycle scripts, see [references/configuration-guide.md](references/configuration-guide.md).\n\n## When Things Go Wrong\n\n### Common Errors\n\n**Error: \"Error while running docker-compose command\"**\n\n- Check that Docker Desktop is started and running\n- Check Docker Desktop dashboard for logs, restart, or remove existing virtual machines\n- Then try rerunning `wp-env start`\n\n**Error: \"Host is already in use by another container\"**\n\n- The container you are attempting to start is already running, or another container is. You can stop an existing container by running `wp-env stop` from the directory that you started it in\n- If you do not remember the directory where you started `wp-env`, you can stop all containers by running `docker stop $(docker ps -q)`. This will stop all Docker containers, so use with caution\n- Then try rerunning `wp-env start`\n\nFor comprehensive troubleshooting including Ubuntu Docker setup, database issues, and advanced debugging, see [references/troubleshooting.md](references/troubleshooting.md).\n\n## Advanced Features\n\nFor detailed information on these features, see [references/command-reference.md](references/command-reference.md).\n\n**Xdebug:** Enable step debugging with `wp-env start --xdebug`. Configure your IDE for port 9003.\n\n**PHPUnit:** WordPress test files included. Run with `wp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit`.\n\n**Composer:** Execute commands with `wp-env run cli --env-cwd=wp-content/plugins/your-plugin composer install`.\n\n## Best Practices\n\n### Directory Context\n\n- Run `wp-env start` from your plugin or theme directory for automatic mounting\n- Use `--env-cwd` when running commands that need to execute in specific directories\n- Use absolute paths when possible to avoid confusion\n\n### Development Workflow\n\n1. Start environment once per work session: `wp-env start`\n2. Make code changes - they're immediately reflected (no rebuild needed)\n3. Use `wp-env run cli wp` commands for WordPress operations\n4. Check logs when debugging: `wp-env logs`\n5. Stop when done: `wp-env stop`\n\n### Testing Workflow\n\n1. Use `tests-cli` and `tests-wordpress` for isolated testing\n2. Reset test database frequently: `wp-env clean tests`\n3. Keep test and development environments separate\n4. Use `wp-env clean all` before running full integration tests\n\n### Configuration Management\n\n- Keep `.wp-env.json` in version control for team consistency\n- Use `.wp-env.override.json` (gitignored) for local-only overrides\n- Document custom configurations in project README\n\n## Where Files Are Stored\n\nwp-env stores files in a home directory (defaults vary by platform):\n\n```bash\n# Get the install path for current project\nwp-env install-path\n\n# Default locations:\n# macOS/Windows: ~/.wp-env/$md5_of_project_path\n# Linux: ~/wp-env/$md5_of_project_path\n```\n\nOverride with `WP_ENV_HOME` environment variable:\n\n```bash\nWP_ENV_HOME=\"./local-wp-env\" wp-env start\n```\n\n## Additional Resources\n\n- **Command Reference:** [references/command-reference.md](references/command-reference.md) - Complete CLI documentation\n- **Configuration Guide:** [references/configuration-guide.md](references/configuration-guide.md) - All `.wp-env.json` options\n- **Troubleshooting:** [references/troubleshooting.md](references/troubleshooting.md) - Common issues and solutions\n\nExternal documentation:\n\n- [@wordpress/env npm package](https://www.npmjs.com/package/@wordpress/env)\n- [WordPress Developer Handbook - wp-env](https://developer.wordpress.org/block-editor/getting-started/devenv/get-started-with-wp-env/)\n- [Docker Desktop](https://docs.docker.com/desktop/)\n",
        "claude-code-plugins/wp-env/skills/wp-env/references/command-reference.md": "# wp-env Command Reference\n\nComplete reference for all `wp-env` commands, options, and environment variables.\n\n## Command Overview\n\n| Command | Description |\n|---------|-------------|\n| `wp-env start` | Install and start the WordPress environment |\n| `wp-env stop` | Stop the WordPress environment |\n| `wp-env clean` | Clean the WordPress databases |\n| `wp-env run` | Run arbitrary commands in containers |\n| `wp-env destroy` | Destroy the WordPress environment completely |\n| `wp-env logs` | Display PHP and Docker logs |\n| `wp-env install-path` | Get the path where environment files are stored |\n\n## wp-env start\n\nInstalls and initializes the WordPress environment, including downloading specified remote sources.\n\n```\nwp-env start [options]\n```\n\n### Options\n\n| Option | Type | Default | Description |\n|--------|------|---------|-------------|\n| `--debug` | boolean | `false` | Enable debug output |\n| `--update` | boolean | `false` | Download source updates and apply WordPress configuration |\n| `--xdebug` | string | - | Enable Xdebug (see Xdebug section below) |\n| `--spx` | string | - | Enable SPX profiling (see SPX section below) |\n| `--scripts` | boolean | `true` | Execute any configured lifecycle scripts |\n\n### Behavior\n\n- On first run: Downloads WordPress, creates containers, initializes environment\n- Subsequent runs: Starts existing environment without changes\n- With `--update`: Re-downloads sources and re-applies configuration (doesn't overwrite content)\n\n### Environment Variables\n\nThese environment variables override `.wp-env.json` settings:\n\n| Variable | Description | Example |\n|----------|-------------|---------|\n| `WP_ENV_PORT` | Development environment web server port | `WP_ENV_PORT=3333 wp-env start` |\n| `WP_ENV_TESTS_PORT` | Testing environment web server port | `WP_ENV_TESTS_PORT=3334 wp-env start` |\n| `WP_ENV_MYSQL_PORT` | MySQL port for development environment | `WP_ENV_MYSQL_PORT=13306 wp-env start` |\n| `WP_ENV_TESTS_MYSQL_PORT` | MySQL port for testing environment | `WP_ENV_TESTS_MYSQL_PORT=13307 wp-env start` |\n| `WP_ENV_PHPMYADMIN_PORT` | phpMyAdmin port for development | `WP_ENV_PHPMYADMIN_PORT=9001 wp-env start` |\n| `WP_ENV_TESTS_PHPMYADMIN_PORT` | phpMyAdmin port for testing | `WP_ENV_TESTS_PHPMYADMIN_PORT=9002 wp-env start` |\n| `WP_ENV_HOME` | Directory for wp-env files | `WP_ENV_HOME=\"./local\" wp-env start` |\n| `WP_ENV_CORE` | WordPress version/source | `WP_ENV_CORE=\"WordPress/WordPress#trunk\" wp-env start` |\n| `WP_ENV_PHP_VERSION` | PHP version to use | `WP_ENV_PHP_VERSION=\"8.0\" wp-env start` |\n| `WP_ENV_MULTISITE` | Enable multisite | `WP_ENV_MULTISITE=true wp-env start` |\n\nNote: Environment variables take precedence over `.wp-env.json` values.\n\n### Xdebug Support\n\nEnable Xdebug for debugging PHP code:\n\n```bash\n# Enable with default \"debug\" mode\nwp-env start --xdebug\n\n# Enable with specific modes\nwp-env start --xdebug=profile,trace,debug\n\n# When using npm run (in local project dependencies)\nnpm run wp-env start -- --xdebug\n```\n\n**Xdebug Modes:**\n\n- `debug` - Step debugging (default when --xdebug is used)\n- `develop` - Development aids\n- `coverage` - Code coverage analysis\n- `gcstats` - Garbage collection statistics\n- `profile` - Profiling\n- `trace` - Function trace\n\nSee [Xdebug documentation](https://xdebug.org/docs/all_settings#mode) for mode details.\n\n**Requirements:**\n\n- PHP version >= 7.2 (Xdebug won't install on legacy PHP versions)\n- IDE configuration for port 9003\n\n**IDE Configuration Example (VS Code):**\n\n```json\n{\n  \"name\": \"Listen for XDebug\",\n  \"type\": \"php\",\n  \"request\": \"launch\",\n  \"port\": 9003,\n  \"pathMappings\": {\n    \"/var/www/html/wp-content/plugins/your-plugin\": \"${workspaceFolder}/\"\n  }\n}\n```\n\n### SPX Profiling\n\nSPX is a lightweight profiling extension with a built-in web UI:\n\n```bash\n# Enable SPX profiling\nwp-env start --spx\n\n# With specific mode\nwp-env start --spx=enabled\n```\n\n**Access SPX UI:**\n\n- Development: <http://localhost:8888/?SPX_KEY=dev&SPX_UI_URI=/>\n- Testing: <http://localhost:8889/?SPX_KEY=dev&SPX_UI_URI=/>\n\n**SPX Features:**\n\n- Flame graphs and performance metrics\n- Function call timelines\n- Memory usage analysis\n- Minimal performance overhead\n\nSee [SPX documentation](https://github.com/NoiseByNorthwest/php-spx) for details.\n\n### Examples\n\n```bash\n# Basic start\nwp-env start\n\n# Start with updates\nwp-env start --update\n\n# Start with custom port\nWP_ENV_PORT=4000 wp-env start\n\n# Start with Xdebug enabled\nwp-env start --xdebug\n\n# Start with multisite and custom PHP version\nWP_ENV_MULTISITE=true WP_ENV_PHP_VERSION=\"8.1\" wp-env start\n\n# Start with debug output\nwp-env start --debug\n```\n\n## wp-env stop\n\nStops running WordPress containers and frees the ports.\n\n```\nwp-env stop [options]\n```\n\n### Options\n\n| Option | Type | Default | Description |\n|--------|------|---------|-------------|\n| `--debug` | boolean | `false` | Enable debug output |\n\n### Behavior\n\n- Stops all containers for the current project\n- Preserves all data (database, uploads, configuration)\n- Frees ports (8888, 8889, etc.)\n- Containers can be restarted with `wp-env start`\n\n### Example\n\n```bash\nwp-env stop\n```\n\n## wp-env clean\n\nCleans (resets) WordPress databases.\n\n```\nwp-env clean [environment] [options]\n```\n\n### Arguments\n\n| Argument | Choices | Default | Description |\n|----------|---------|---------|-------------|\n| `environment` | `all`, `development`, `tests` | `tests` | Which environment's database to clean |\n\n### Options\n\n| Option | Type | Default | Description |\n|--------|------|---------|-------------|\n| `--debug` | boolean | `false` | Enable debug output |\n| `--scripts` | boolean | `true` | Execute any configured lifecycle scripts |\n\n### Behavior\n\nâ ï¸ **Warning:** Permanently deletes all posts, pages, media, users (except admin), and other WordPress content.\n\n- Resets database to fresh WordPress installation\n- Preserves WordPress core files and configuration\n- Keeps admin user (username: `admin`, password: `password`)\n\n### Examples\n\n```bash\n# Clean tests database only (default)\nwp-env clean\nwp-env clean tests\n\n# Clean development database\nwp-env clean development\n\n# Clean both databases\nwp-env clean all\n```\n\n## wp-env run\n\nRuns arbitrary commands in Docker containers.\n\n```\nwp-env run <container> <command> [options]\n```\n\n### Arguments\n\n| Argument | Type | Description |\n|----------|------|-------------|\n| `container` | string (required) | The Docker service to run the command on |\n| `command` | string (required) | The command to run |\n\n### Available Containers\n\n| Container | Description | Available Tools |\n|-----------|-------------|-----------------|\n| `cli` | WP-CLI environment (development) | wp-cli, composer, phpunit, bash |\n| `tests-cli` | WP-CLI environment (testing) | wp-cli, composer, phpunit, bash |\n| `wordpress` | WordPress PHP environment (development) | php |\n| `tests-wordpress` | WordPress PHP environment (testing) | php |\n| `mysql` | MySQL database (development) | mysql |\n| `tests-mysql` | MySQL database (testing) | mysql |\n| `composer` | Composer environment | composer |\n| `phpmyadmin` | phpMyAdmin (if enabled) | - |\n\n### Options\n\n| Option | Type | Default | Description |\n|--------|------|---------|-------------|\n| `--debug` | boolean | `false` | Enable debug output |\n| `--env-cwd` | string | `\".\"` | Working directory inside container (relative to WordPress root) |\n\n### Working Directory\n\n- Default: WordPress root (`/var/www/html`)\n- Paths without leading slash are relative to WordPress root\n- Use `--env-cwd` for commands that need specific directory context\n\n### Argument Parsing\n\nCommands with options that conflict with wp-env options require `--` separator:\n\n```bash\n# This shows wp-env help (--help interpreted by wp-env)\nwp-env run cli php --help\n\n# This shows PHP help (--help passed to php)\nwp-env run cli php -- --help\n```\n\n### Examples\n\n#### WP-CLI Commands\n\n```bash\n# List users\nwp-env run cli wp user list\n\n# Install and activate a plugin\nwp-env run cli wp plugin install contact-form-7 --activate\n\n# Create a post on tests instance\nwp-env run tests-cli wp post create --post_title=\"Test\" --post_status=publish\n\n# Update permalink structure\nwp-env run cli \"wp rewrite structure /%postname%/\"\n\n# Open WordPress shell (interactive PHP)\nwp-env run cli wp shell\n```\n\n#### Composer Commands\n\n```bash\n# Run composer install in a plugin directory\nwp-env run cli --env-cwd=wp-content/plugins/your-plugin composer install\n\n# Update dependencies\nwp-env run cli --env-cwd=wp-content/plugins/your-plugin composer update\n\n# Show installed packages\nwp-env run cli --env-cwd=wp-content/plugins/your-plugin composer show\n```\n\n#### PHPUnit Commands\n\n```bash\n# Run tests in a plugin\nwp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit\n\n# Run specific test file\nwp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit tests/test-sample.php\n\n# Run with coverage\nwp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit --coverage-html coverage\n```\n\n#### Shell Access\n\n```bash\n# Open bash shell in CLI container\nwp-env run cli bash\n\n# Open bash in tests container\nwp-env run tests-cli bash\n\n# Run a bash script\nwp-env run cli bash /var/www/html/wp-content/plugins/your-plugin/scripts/setup.sh\n```\n\n#### Direct PHP Execution\n\n```bash\n# Run PHP script\nwp-env run cli php /var/www/html/wp-content/plugins/your-plugin/scripts/migrate.php\n\n# Execute PHP code directly\nwp-env run cli php -r \"echo phpversion();\"\n```\n\n## wp-env destroy\n\nDestroys the WordPress environment completely.\n\n```\nwp-env destroy [options]\n```\n\n### Options\n\n| Option | Type | Default | Description |\n|--------|------|---------|-------------|\n| `--debug` | boolean | `false` | Enable debug output |\n| `--scripts` | boolean | `true` | Execute any configured lifecycle scripts |\n\n### Behavior\n\nâ ï¸ **Warning:** Permanently deletes:\n\n- All Docker containers\n- All Docker volumes (databases, uploads, etc.)\n- All Docker networks\n- All local files in the wp-env home directory\n\nUse this when:\n\n- Environment is corrupted beyond repair\n- Need to start completely fresh\n- Freeing up disk space\n- Removing wp-env from a project\n\n### Example\n\n```bash\n# Destroy everything\nwp-env destroy\n\n# Create fresh environment\nwp-env start\n```\n\n## wp-env logs\n\nDisplays PHP and Docker logs for the WordPress environment.\n\n```\nwp-env logs [environment] [options]\n```\n\n### Arguments\n\n| Argument | Choices | Default | Description |\n|----------|---------|---------|-------------|\n| `environment` | `development`, `tests`, `all` | `development` | Which environment to display logs from |\n\n### Options\n\n| Option | Type | Default | Description |\n|--------|------|---------|-------------|\n| `--debug` | boolean | `false` | Enable debug output |\n| `--watch` | boolean | `true` | Watch for logs as they happen (follow mode) |\n\n### Behavior\n\n- Shows PHP error logs and Docker container logs\n- By default, follows/tails logs in real-time (press Ctrl+C to stop)\n- Use `--watch=false` to show current logs and exit\n\n### Examples\n\n```bash\n# View development logs (follows by default)\nwp-env logs\n\n# View testing environment logs\nwp-env logs tests\n\n# View both environments\nwp-env logs all\n\n# Show logs without following\nwp-env logs --watch=false\n\n# View with debug output\nwp-env logs --debug\n```\n\n## wp-env install-path\n\nGets the path where all environment files are stored.\n\n```\nwp-env install-path\n```\n\n### Behavior\n\nReturns the absolute path to the directory containing:\n\n- Docker files and configurations\n- Downloaded WordPress core\n- PHPUnit files\n- Downloaded plugins, themes, and other sources\n\n### Path Format\n\n- Default location: `$WP_ENV_HOME/$md5_of_project_path`\n- macOS/Windows default: `~/.wp-env/$md5_of_project_path`\n- Linux default: `~/wp-env/$md5_of_project_path` (for Snap compatibility)\n\n### Example\n\n```bash\n$ wp-env install-path\n/home/user/.wp-env/63263e6506becb7b8613b02d42280a49\n```\n\n## Global Options\n\nOptions available for all commands:\n\n| Option | Type | Default | Description |\n|--------|------|---------|-------------|\n| `--debug` | boolean | `false` | Enable debug output for troubleshooting |\n| `--help` | boolean | `false` | Show help for the command |\n| `--version` | boolean | `false` | Show wp-env version number |\n\n## Lifecycle Scripts\n\nLifecycle scripts run automatically at certain points. Configure in `.wp-env.json`:\n\n```json\n{\n  \"lifecycleScripts\": {\n    \"afterStart\": \"node scripts/setup-e2e.js\",\n    \"afterClean\": \"echo 'Database cleaned'\",\n    \"afterDestroy\": \"rm -rf custom-cache\"\n  }\n}\n```\n\n### Available Lifecycle Events\n\n| Event | When It Runs | Use Cases |\n|-------|--------------|-----------|\n| `afterStart` | After `wp-env start` completes | Bootstrap data, run migrations, configure environment |\n| `afterClean` | After `wp-env clean` completes | Log cleanup, reset custom data |\n| `afterDestroy` | After `wp-env destroy` completes | Clean up external resources |\n\n### Environment Variable Override\n\nOverride lifecycle scripts via environment variables:\n\n```bash\nWP_ENV_LIFECYCLE_SCRIPT_AFTER_START=\"npm run bootstrap\" wp-env start\n```\n\nFormat: `WP_ENV_LIFECYCLE_SCRIPT_{EVENT_NAME}` (uppercase, snake_case)\n\n## Exit Codes\n\nAll wp-env commands use standard exit codes:\n\n| Code | Meaning |\n|------|---------|\n| `0` | Success |\n| `1` | Error (see error message for details) |\n\n## Tips and Best Practices\n\n### Using with npm Scripts\n\nAdd wp-env commands to `package.json` for convenience:\n\n```json\n{\n  \"scripts\": {\n    \"wp-env\": \"wp-env\",\n    \"env:start\": \"wp-env start\",\n    \"env:stop\": \"wp-env stop\",\n    \"env:clean\": \"wp-env clean all && wp-env start\",\n    \"env:reset\": \"wp-env destroy && wp-env start\",\n    \"wp\": \"wp-env run cli wp\",\n    \"composer\": \"wp-env run cli --env-cwd=wp-content/plugins/your-plugin composer\",\n    \"test\": \"wp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit\"\n  }\n}\n```\n\nThen use: `npm run env:start`, `npm run test`, etc.\n\n### Passing Flags to npm Scripts\n\nWhen using `npm run wp-env`, use `--` to pass flags:\n\n```bash\n# Wrong: --update goes to npm, not wp-env\nnpm run env:start --update\n\n# Right: --update passed to wp-env\nnpm run env:start -- --update\n```\n\n### Command Chaining\n\nChain commands for complex workflows:\n\n```bash\n# Reset and start fresh\nwp-env clean all && wp-env start\n\n# Destroy, recreate, and install a plugin\nwp-env destroy && wp-env start && wp-env run cli wp plugin install woocommerce --activate\n```\n\n### Checking Environment Status\n\nVerify wp-env is running properly:\n\n```bash\n# Check running containers\ndocker ps\n\n# Should show three containers by default:\n# - wordpress (port 8888)\n# - tests-wordpress (port 8889)\n# - mariadb (port 3306)\n\n# Check wp-env version\nwp-env --version\n\n# View install path\nwp-env install-path\n```\n\n### Working with Multiple Projects\n\nEach project has its own isolated environment:\n\n```bash\n# Project 1\ncd ~/projects/plugin-a\nwp-env start  # Uses port 8888\n\n# Project 2 (different port)\ncd ~/projects/plugin-b\nWP_ENV_PORT=4000 wp-env start  # Uses port 4000\n```\n\n## WordPress PHPUnit Tests\n\nwp-env includes WordPress' PHPUnit test files automatically.\n\n### Environment Variable\n\n- `WP_TESTS_DIR` - Points to PHPUnit test files location within containers\n- Files correspond to the installed WordPress version\n\n### Custom wp-tests-config.php\n\nOverride the default test configuration:\n\n```php\n// In your bootstrap.php file\ndefine('WP_TESTS_CONFIG_FILE_PATH', '/path/to/custom/wp-tests-config.php');\n```\n\nWordPress will use your custom file instead of the default.\n\n### Running Tests\n\n```bash\n# Run all tests\nwp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit\n\n# Run specific test file\nwp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit tests/test-sample.php\n\n# Run with bootstrap file\nwp-env run tests-cli --env-cwd=wp-content/plugins/your-plugin phpunit --bootstrap=tests/bootstrap.php\n```\n\n## Database Access\n\nDirect database access credentials:\n\n| Environment | Host | Port | User | Password | Database |\n|-------------|------|------|------|----------|----------|\n| Development | `localhost` | `WP_ENV_MYSQL_PORT` (random if not set) | `root` | `password` | `wordpress` |\n| Testing | `localhost` | `WP_ENV_TESTS_MYSQL_PORT` (random if not set) | `root` | `password` | `wordpress-tests` |\n\n**Note:** MySQL ports are not exposed by default. Set `WP_ENV_MYSQL_PORT` or `WP_ENV_TESTS_MYSQL_PORT` to expose them.\n\n### Connecting with MySQL Client\n\n```bash\n# Expose MySQL port first\nWP_ENV_MYSQL_PORT=13306 wp-env start\n\n# Connect from host\nmysql -h 127.0.0.1 -P 13306 -u root -ppassword wordpress\n```\n\n### Using phpMyAdmin\n\n```bash\n# Enable phpMyAdmin on port 9001\nWP_ENV_PHPMYADMIN_PORT=9001 wp-env start\n\n# Access at http://localhost:9001\n# Login: root / password\n```\n\nOr configure in `.wp-env.json`:\n\n```json\n{\n  \"phpmyadminPort\": 9001\n}\n```\n",
        "claude-code-plugins/wp-env/skills/wp-env/references/configuration-guide.md": "# wp-env Configuration Guide\n\nComplete guide to configuring wp-env using `.wp-env.json` and `.wp-env.override.json` files.\n\n## Configuration File Overview\n\nwp-env supports two configuration files:\n\n1. **`.wp-env.json`** - Primary configuration, typically version controlled\n2. **`.wp-env.override.json`** - Local overrides, typically gitignored\n\nPlace these files in your project root (where you run `wp-env start`).\n\n## Basic Configuration Structure\n\n```json\n{\n  \"core\": null,\n  \"phpVersion\": null,\n  \"plugins\": [],\n  \"themes\": [],\n  \"port\": 8888,\n  \"testsPort\": 8889,\n  \"config\": {},\n  \"mappings\": {},\n  \"mysqlPort\": null,\n  \"phpmyadminPort\": null,\n  \"multisite\": false,\n  \"lifecycleScripts\": {},\n  \"env\": {\n    \"development\": {},\n    \"tests\": {}\n  }\n}\n```\n\n## Configuration Fields\n\n### Core WordPress Installation\n\n**Field:** `core`\n**Type:** `string | null`\n**Default:** `null` (latest production WordPress)\n\nSpecifies which WordPress installation to use.\n\n```json\n{\n  \"core\": null\n}\n```\n\n**Options:**\n\n| Value Type | Format | Example |\n|------------|--------|---------|\n| Latest WordPress | `null` | `\"core\": null` |\n| Specific version | `\"WordPress/WordPress#<version>\"` | `\"core\": \"WordPress/WordPress#6.4.0\"` |\n| Development trunk | `\"WordPress/WordPress#master\"` | `\"core\": \"WordPress/WordPress#master\"` |\n| Local path (relative) | `\".<path>\"` or `\"~<path>\"` | `\"core\": \"../wordpress-develop/build\"` |\n| Local path (absolute) | `\"/<path>\"` or `\"<letter>:\\<path>\"` | `\"core\": \"/Users/you/wordpress\"` |\n| Git repository | `\"<owner>/<repo>#<ref>\"` | `\"core\": \"WordPress/WordPress#trunk\"` |\n| SSH repository | `\"ssh://user@host/<path>.git#<ref>\"` | `\"core\": \"ssh://git@github.com/WordPress/WordPress.git\"` |\n| ZIP file | `\"http[s]://<url>.zip\"` | `\"core\": \"https://wordpress.org/wordpress-6.4.zip\"` |\n\n**Environment Variable Override:** `WP_ENV_CORE`\n\n```bash\nWP_ENV_CORE=\"WordPress/WordPress#trunk\" wp-env start\n```\n\n### PHP Version\n\n**Field:** `phpVersion`\n**Type:** `string | null`\n**Default:** `null` (default WordPress production PHP version)\n\nSpecifies the PHP version to use.\n\n```json\n{\n  \"phpVersion\": \"8.1\"\n}\n```\n\n**Supported versions:** Any version supported by WordPress (e.g., \"7.4\", \"8.0\", \"8.1\", \"8.2\")\n\n**Environment Variable Override:** `WP_ENV_PHP_VERSION`\n\n```bash\nWP_ENV_PHP_VERSION=\"8.1\" wp-env start\n```\n\n### Plugins\n\n**Field:** `plugins`\n**Type:** `string[]`\n**Default:** `[]`\n\nList of plugins to install and activate.\n\n```json\n{\n  \"plugins\": [\n    \".\",\n    \"WordPress/classic-editor\",\n    \"../my-local-plugin\",\n    \"https://downloads.wordpress.org/plugin/akismet.zip\"\n  ]\n}\n```\n\n**Source Types:** Same as `core` field (paths, GitHub repos, ZIP files, etc.)\n\n**Behavior:**\n\n- All plugins are automatically activated\n- Current directory (`.`) is auto-detected as a plugin if it contains a plugin header\n- Use `mappings` instead if you don't want auto-activation\n\n### Themes\n\n**Field:** `themes`\n**Type:** `string[]`\n**Default:** `[]`\n\nList of themes to install.\n\n```json\n{\n  \"themes\": [\n    \".\",\n    \"WordPress/theme-experiments\"\n  ]\n}\n```\n\n**Source Types:** Same as `core` field\n\n**Behavior:**\n\n- Themes are installed but not activated\n- Activate via WP-CLI: `wp-env run cli wp theme activate your-theme`\n\n### Ports\n\n**Field:** `port`\n**Type:** `integer`\n**Default:** `8888`\n\nPrimary port for the development environment.\n\n```json\n{\n  \"port\": 4000\n}\n```\n\n**Access:** <http://localhost:4000>\n\n**Environment Variable Override:** `WP_ENV_PORT` (takes precedence)\n\n```bash\nWP_ENV_PORT=4000 wp-env start\n```\n\n---\n\n**Field:** `testsPort`\n**Type:** `integer`\n**Default:** `8889`\n\nPort for the testing environment.\n\n```json\n{\n  \"testsPort\": 4001\n}\n```\n\n**Environment Variable Override:** `WP_ENV_TESTS_PORT`\n\n### MySQL Port\n\n**Field:** `mysqlPort`\n**Type:** `integer | null`\n**Default:** `null` (not exposed to host)\n\nExpose MySQL port to the host machine.\n\n```json\n{\n  \"env\": {\n    \"development\": {\n      \"mysqlPort\": 13306\n    },\n    \"tests\": {\n      \"mysqlPort\": 13307\n    }\n  }\n}\n```\n\n**Note:** Only available in `env.development` and `env.tests` objects, not at root level.\n\n**Environment Variable Override:**\n\n- `WP_ENV_MYSQL_PORT` (development)\n- `WP_ENV_TESTS_MYSQL_PORT` (tests)\n\n**Connection:**\n\n```bash\nmysql -h 127.0.0.1 -P 13306 -u root -ppassword wordpress\n```\n\n### phpMyAdmin Port\n\n**Field:** `phpmyadminPort`\n**Type:** `integer | null`\n**Default:** `null` (disabled)\n\nEnable phpMyAdmin web interface.\n\n```json\n{\n  \"phpmyadminPort\": 9001\n}\n```\n\n**Access:** <http://localhost:9001>\n**Login:** username: `root`, password: `password`\n\n**Environment Variable Override:**\n\n- `WP_ENV_PHPMYADMIN_PORT` (development)\n- `WP_ENV_TESTS_PHPMYADMIN_PORT` (tests)\n\n### WP-Config Constants\n\n**Field:** `config`\n**Type:** `Object`\n**Default:** See Default Constants section\n\nDefine wp-config.php constants.\n\n```json\n{\n  \"config\": {\n    \"WP_DEBUG_LOG\": true,\n    \"WP_DEBUG_DISPLAY\": false,\n    \"CUSTOM_CONSTANT\": \"custom-value\"\n  }\n}\n```\n\n**Special Values:**\n\n- Set to `null` to prevent a constant from being defined\n- Boolean, string, and numeric values supported\n\n**Merging Behavior:**\n\n- `config` values are merged between root and `env.*` objects\n- Environment-specific values override root values\n\n### Default Constants\n\n**Development Environment:**\n\n```json\n{\n  \"WP_DEBUG\": true,\n  \"SCRIPT_DEBUG\": true,\n  \"WP_PHP_BINARY\": \"php\",\n  \"WP_TESTS_EMAIL\": \"admin@example.org\",\n  \"WP_TESTS_TITLE\": \"Test Blog\",\n  \"WP_TESTS_DOMAIN\": \"localhost\",\n  \"WP_SITEURL\": \"http://localhost:8888\",\n  \"WP_HOME\": \"http://localhost:8888\"\n}\n```\n\n**Test Environment:**\nSame as development, but `WP_DEBUG` and `SCRIPT_DEBUG` are `false`.\n\n**URLs include configured ports:**\nIf `port: 4000`, then `WP_HOME` becomes `http://localhost:4000`.\n\n### Directory Mappings\n\n**Field:** `mappings`\n**Type:** `Object`\n**Default:** `{}`\n\nMap local directories to WordPress directories.\n\n```json\n{\n  \"mappings\": {\n    \"wp-content/mu-plugins\": \"./mu-plugins\",\n    \"wp-content/themes/my-theme\": \"./themes/my-theme\",\n    \"wp-content/plugins/test-plugin\": \"../test-plugin\",\n    \".htaccess\": \"./.htaccess\"\n  }\n}\n```\n\n**Use Cases:**\n\n- Add mu-plugins (must-use plugins)\n- Mount multiple themes without activating them\n- Add plugins without auto-activation\n- Map custom directories\n- Configure PHP settings via .htaccess\n\n**Merging Behavior:**\n\n- `mappings` values are merged between root and `env.*` objects\n- Use for environment-specific mounts\n\n### Multisite\n\n**Field:** `multisite`\n**Type:** `boolean`\n**Default:** `false`\n\nEnable WordPress multisite installation.\n\n```json\n{\n  \"multisite\": true\n}\n```\n\n**Environment Variable Override:** `WP_ENV_MULTISITE`\n\n```bash\nWP_ENV_MULTISITE=true wp-env start\n```\n\n### Lifecycle Scripts\n\n**Field:** `lifecycleScripts`\n**Type:** `Object`\n**Default:** `{}`\n\nExecute commands at specific lifecycle events.\n\n```json\n{\n  \"lifecycleScripts\": {\n    \"afterStart\": \"node scripts/bootstrap-data.js\",\n    \"afterClean\": \"echo 'Database cleaned'\",\n    \"afterDestroy\": \"rm -rf .cache\"\n  }\n}\n```\n\n**Available Events:**\n\n- `afterStart` - After `wp-env start` completes\n- `afterClean` - After `wp-env clean` completes\n- `afterDestroy` - After `wp-env destroy` completes\n\n**Environment Variable Override:**\n\n```bash\nWP_ENV_LIFECYCLE_SCRIPT_AFTER_START=\"npm run setup\" wp-env start\n```\n\nFormat: `WP_ENV_LIFECYCLE_SCRIPT_{EVENT}` (uppercase, snake_case)\n\n**Disable Scripts:**\n\n```bash\nwp-env start --scripts=false\n```\n\n### Environment-Specific Configuration\n\n**Field:** `env`\n**Type:** `Object`\n**Default:** `{}`\n\nOverride configuration for specific environments.\n\n```json\n{\n  \"plugins\": [\".\"],\n  \"config\": {\n    \"WP_DEBUG\": true\n  },\n  \"env\": {\n    \"development\": {\n      \"themes\": [\"./my-theme\"],\n      \"port\": 4000\n    },\n    \"tests\": {\n      \"plugins\": [\".\", \"woocommerce\"],\n      \"config\": {\n        \"WP_DEBUG\": false\n      },\n      \"port\": 4001,\n      \"mysqlPort\": 13306\n    }\n  }\n}\n```\n\n**Merging Rules:**\n\n- **Merged:** `config`, `mappings`\n- **Replaced:** `plugins`, `themes`, `port`, `testsPort`, `core`, `phpVersion`, `multisite`\n\n**Available Environments:**\n\n- `development` - Main development environment (port 8888 by default)\n- `tests` - Testing environment (port 8889 by default)\n\n## Examples\n\n### Latest stable WordPress + current directory as a plugin\n\nThis is useful for plugin development.\n\n```json\n{\n  \"core\": null,\n  \"plugins\": [ \".\" ]\n}\n```\n\n### Latest development WordPress + current directory as a plugin\n\nThis is useful for plugin development when upstream Core changes need to be tested. This can also be set via the environment variable `WP_ENV_CORE`.\n\n```json\n{\n  \"core\": \"WordPress/WordPress#master\",\n  \"plugins\": [ \".\" ]\n}\n```\n\n### Local wordpress-develop + current directory as a plugin\n\nThis is useful for working on plugins and WordPress Core at the same time.\n\nIf you are running a `build` of `wordpress-develop`, point `core` to the `build` directory.\n\n```json\n{\n  \"core\": \"../wordpress-develop/build\",\n  \"plugins\": [ \".\" ]\n}\n```\n\nIf you are running `wordpress-develop` in a dev mode (e.g. the `dev` watch command or the `build:dev` dev build), then point `core` to the `src` directory.\n\n```json\n{\n  \"core\": \"../wordpress-develop/src\",\n  \"plugins\": [ \".\" ]\n}\n```\n\n### A complete testing environment\n\nThis is useful for integration testing: that is, testing how old versions of WordPress and different combinations of plugins and themes impact each other.\n\n```json\n{\n  \"core\": \"WordPress/WordPress#5.2.0\",\n  \"plugins\": [ \"WordPress/wp-lazy-loading\", \"WordPress/classic-editor\" ],\n  \"themes\": [ \"WordPress/theme-experiments\" ]\n}\n```\n\n### Add mu-plugins and other mapped directories\n\nYou can add mu-plugins via the mapping config. The mapping config also allows you to mount a directory to any location in the wordpress install, so you could even mount a subdirectory. Note here that theme-1, will not be activated.\n\n```json\n{\n  \"plugins\": [ \".\" ],\n  \"mappings\": {\n    \"wp-content/mu-plugins\": \"./path/to/local/mu-plugins\",\n    \"wp-content/themes\": \"./path/to/local/themes\",\n    \"wp-content/themes/specific-theme\": \"./path/to/local/theme-1\"\n  }\n}\n```\n\n### Avoid activating plugins or themes on the instance\n\nSince all plugins in the `plugins` key are activated by default, you should use the `mappings` key to avoid this behavior. This might be helpful if you have a test plugin that should not be activated all the time.\n\n```json\n{\n  \"plugins\": [ \".\" ],\n  \"mappings\": {\n    \"wp-content/plugins/my-test-plugin\": \"./path/to/test/plugin\"\n  }\n}\n```\n\n### Map a plugin only in the tests environment\n\nIf you need a plugin active in one environment but not the other, you can use `env.<envName>` to set options specific to one environment. Here, we activate cwd and a test plugin on the tests instance. This plugin is not activated on any other instances.\n\n```json\n{\n  \"plugins\": [ \".\" ],\n  \"env\": {\n    \"tests\": {\n      \"plugins\": [ \".\", \"path/to/test/plugin\" ]\n    }\n  }\n}\n```\n\n### Custom Port Numbers\n\nYou can tell `wp-env` to use a custom port number so that your instance does not conflict with other `wp-env` instances.\n\n```json\n{\n  \"plugins\": [ \".\" ],\n  \"port\": 4013,\n  \"env\": {\n    \"tests\": {\n      \"port\": 4012\n    }\n  }\n}\n```\n\nThese can also be set via environment variables:\n\n- `WP_ENV_PORT` to override the development environment's web server's port.\n- `WP_ENV_TESTS_PORT` to override the testing environment's web server's port.\n- phpMyAdmin is not enabled by default, but its port can also be overridden for the development and testing environments via `WP_ENV_PHPMYADMIN_PORT` and `WP_ENV_TESTS_PHPMYADMIN_PORT`, respectively.\n- By default, MySQL aren't exposed to the host, which means no chance of port conflicts. But these can also be overridden for the development and testing environments via `WP_ENV_MYSQL_PORT` and `WP_ENV_TESTS_MYSQL_PORT`, respectively.\n\n### Specific PHP Version\n\nYou can tell `wp-env` to use a specific PHP version for compatibility and testing. This can also be set via the environment variable `WP_ENV_PHP_VERSION`.\n\n```json\n{\n  \"phpVersion\": \"7.2\",\n  \"plugins\": [ \".\" ]\n}\n```\n\n### Multisite support\n\nYou can tell `wp-env` if the site should be multisite enabled. This can also be set via the environment variable `WP_ENV_MULTISITE`.\n\n```json\n{\n  \"multisite\": true,\n  \"plugins\": [ \".\" ]\n}\n```\n\n### Node Lifecycle Script\n\nThis is useful for performing some actions after setting up the environment, such as bootstrapping an E2E test environment.\n\n```json\n{\n  \"lifecycleScripts\": {\n    \"afterStart\": \"node tests/e2e/bin/setup-env.js\"\n  }\n}\n```\n\n### Advanced PHP settings\n\nYou can set PHP settings by mapping an `.htaccess` file. This maps an `.htaccess` file to the WordPress root (`/var/www/html`) from the directory in which you run `wp-env`.\n\n```json\n{\n  \"mappings\": {\n    \".htaccess\": \".htaccess\"\n  }\n}\n```\n\nThen, your .htaccess file can contain various settings like this:\n\n```\n# Note: the default upload value is 1G.\nphp_value post_max_size 2G\nphp_value upload_max_filesize 2G\nphp_value memory_limit 2G\n```\n\nThis is useful if there are options you'd like to add to `php.ini`, which is difficult to access in this environment.\n\n### Using SPX Profiling\n\nSPX is a simple profiling extension for PHP that provides low-overhead profiling with a built-in web UI. When enabled with `--spx`, you can access the SPX profiling interface to analyze your application's performance.\n\nTo enable SPX profiling:\n\n```\nwp-env start --spx\n```\n\nOnce enabled, you can access the SPX web UI by visiting any page in your WordPress environment with the query parameters `?SPX_KEY=dev&SPX_UI_URI=/`. For example:\n\n- Development site: `http://localhost:8888/?SPX_KEY=dev&SPX_UI_URI=/`\n- Test site: `http://localhost:8889/?SPX_KEY=dev&SPX_UI_URI=/`\n\nFrom the SPX interface, you can: â Enable profiling for subsequent requests â View flame graphs and performance metrics â Analyze function call timelines â Examine memory usage and other performance data\n\nSPX provides a more lightweight alternative to Xdebug for profiling, with minimal performance overhead and an intuitive web-based interface.\n\n## Configuration Override System\n\n### .wp-env.override.json\n\nCreate `.wp-env.override.json` for local-only configuration:\n\n```json\n{\n  \"port\": 3000,\n  \"config\": {\n    \"LOCAL_SETTING\": \"local-value\"\n  }\n}\n```\n\n**Merging Behavior:**\n\n- Override file values take precedence over `.wp-env.json`\n- `config` and `mappings` are merged\n- Other fields are replaced\n\n**Example:**\n\n`.wp-env.json`:\n\n```json\n{\n  \"plugins\": [\".\", \"woocommerce\"],\n  \"config\": {\n    \"WP_DEBUG\": true,\n    \"KEY_1\": \"value-1\"\n  }\n}\n```\n\n`.wp-env.override.json`:\n\n```json\n{\n  \"plugins\": [\".\"],\n  \"config\": {\n    \"KEY_1\": \"override-1\",\n    \"KEY_2\": \"value-2\"\n  }\n}\n```\n\n**Result:**\n\n```json\n{\n  \"plugins\": [\".\"],\n  \"config\": {\n    \"WP_DEBUG\": true,\n    \"KEY_1\": \"override-1\",\n    \"KEY_2\": \"value-2\"\n  }\n}\n```\n\n**Best Practice:** Add to `.gitignore`:\n\n```gitignore\n.wp-env.override.json\n```\n\n## Environment Variables\n\nConfiguration fields can be overridden via environment variables. See [command-reference.md](command-reference.md) for the complete list of environment variables and their usage.\n\n**Precedence:** Environment variables > `.wp-env.override.json` > `.wp-env.json`\n\n## Source Type Reference\n\nAll configuration fields that accept sources (`core`, `plugins`, `themes`) support these formats:\n\n| Type | Format | Example |\n|------|--------|---------|\n| Relative path | `.<path>` or `~<path>` | `\".\"`, `\"../plugin\"`, `\"~/projects/theme\"` |\n| Absolute path | `/<path>` or `<letter>:\\<path>` | `\"/var/www/plugin\"`, `\"C:\\\\projects\\\\theme\"` |\n| GitHub repo | `<owner>/<repo>[/<path>][#<ref>]` | `\"WordPress/gutenberg\"`, `\"WordPress/gutenberg#trunk\"` |\n| SSH repo | `ssh://user@host/<path>.git[#<ref>]` | `\"ssh://git@github.com/WordPress/WordPress.git\"` |\n| ZIP file | `http[s]://<url>.zip` | `\"https://downloads.wordpress.org/plugin/akismet.zip\"` |\n\n**Notes:**\n\n- GitHub repos without `#<ref>` use the default branch\n- Remote sources are downloaded to `~/.wp-env/`\n- Relative paths are relative to the directory containing `.wp-env.json`\n\n## Configuration Validation\n\nwp-env validates configuration on startup. Common errors:\n\n### Invalid JSON\n\n```\nError: Failed to parse .wp-env.json\n```\n\nFix: Validate JSON syntax (use a JSON validator or linter).\n\n### Invalid Port Number\n\n```\nError: Port must be a number between 0 and 65535\n```\n\nFix: Use valid port numbers (typically 1024-65535 for user applications).\n\n### Invalid Source Path\n\n```\nError: Could not find source at path: /invalid/path\n```\n\nFix: Verify local paths exist and are accessible.\n\n### Conflicting Ports\n\n```\nError: Port 8888 is already in use\n```\n\nFix: Change port in configuration or stop the conflicting service.\n\n## Best Practices\n\n### Version Control\n\n**Do commit:**\n\n- `.wp-env.json` - Share configuration with team\n\n**Don't commit:**\n\n- `.wp-env.override.json` - Local-only settings\n- `~/.wp-env/` - Downloaded sources and environment files\n\n### Team Consistency\n\nUse `.wp-env.json` for shared configuration:\n\n```json\n{\n  \"core\": \"WordPress/WordPress#6.4.0\",\n  \"phpVersion\": \"8.1\",\n  \"plugins\": [\".\"],\n  \"config\": {\n    \"WP_DEBUG_LOG\": true\n  }\n}\n```\n\nUse `.wp-env.override.json` for personal preferences:\n\n```json\n{\n  \"port\": 4000,\n  \"phpmyadminPort\": 9001\n}\n```\n\n### Documentation\n\nDocument custom configuration in your project README:\n\n```markdown\n## Local Development\n\nThis project uses wp-env for local development.\n\n### Setup\n1. Install wp-env: `npm -g install @wordpress/env`\n2. Start environment: `wp-env start`\n3. Access site: http://localhost:8888\n\n### Custom Configuration\n- Uses WordPress 6.4.0\n- PHP 8.1\n- Includes WooCommerce for testing\n```\n\n### Environment-Specific Settings\n\nUse `env` for different needs in development vs testing:\n\n```json\n{\n  \"plugins\": [\".\"],\n  \"env\": {\n    \"development\": {\n      \"plugins\": [\".\", \"query-monitor\"],\n      \"config\": {\n        \"WP_DEBUG_DISPLAY\": true\n      }\n    },\n    \"tests\": {\n      \"plugins\": [\".\"],\n      \"config\": {\n        \"WP_DEBUG_DISPLAY\": false\n      }\n    }\n  }\n}\n```\n\n### Minimal Configuration\n\nStart minimal, add configuration as needed:\n\n```json\n{\n  \"plugins\": [\".\"]\n}\n```\n\nThen add features incrementally based on requirements.\n",
        "claude-code-plugins/wp-env/skills/wp-env/references/troubleshooting.md": "# wp-env Troubleshooting Guide\n\nComprehensive troubleshooting for wp-env issues beyond the common errors covered in SKILL.md.\n\n## Troubleshooting Common Problems\n\nMany common problems can be fixed by running through the following troubleshooting steps in order:\n\n### 1. Check that wp-env is running\n\nFirst, check that `wp-env` is running. One way to do this is to have Docker print a table with the currently running containers:\n\n```\ndocker ps\n```\n\nIn this table, by default, you should see three entries: `wordpress` with port 8888, `tests-wordpress` with port 8889 and `mariadb` with port 3306.\n\n### 2. Check the port number\n\nBy default `wp-env` uses port 8888, meaning that the local environment will be available at <http://localhost:8888>.\n\nYou can configure the port that `wp-env` uses so that it doesn't clash with another server by specifying the `WP_ENV_PORT` environment variable when starting `wp-env`:\n\n```\nWP_ENV_PORT=3333 wp-env start\n```\n\nRunning `docker ps` and inspecting the `PORTS` column allows you to determine which port `wp-env` is currently using.\n\nYou may also specify the port numbers in your `.wp-env.json` file, but the environment variables will take precedence.\n\n### 3. Restart wp-env with updates\n\nRestarting `wp-env` will restart the underlying Docker containers which can fix many issues.\n\nTo restart `wp-env`, just run `wp-env start` again. It will automatically stop and start the container. If you also pass the `--update` argument, it will download updates and configure WordPress again.\n\n```\nwp-env start --update\n```\n\n### 4. Restart Docker\n\nRestarting Docker will restart the underlying Docker containers and volumes which can fix many issues.\n\nTo restart Docker:\n\n1. Click on the Docker icon in the system tray or menu bar.\n2. Select `Restart`.\n\nOnce restarted, start `wp-env` again:\n\n```\nwp-env start\n```\n\n### 5. Reset the database\n\nResetting the database which the local environment uses can fix many issues, especially when they are related to the WordPress installation.\n\nTo reset the database:\n\nâ ï¸ WARNING: This will permanently delete any posts, pages, media, etc. in the local WordPress installation.\n\n```\nwp-env clean all\nwp-env start\n```\n\n### 6. Destroy everything and start again ð¥\n\nWhen all else fails, you can use `wp-env destroy` to forcibly remove all of the underlying Docker containers, volumes, and files. This will allow you to start from scratch.\n\nTo do so:\n\nâ ï¸ WARNING: This will permanently delete any posts, pages, media, etc. in the local WordPress installation.\n\n```\n$ wp-env destroy\n# This new instance is a fresh start with no existing data:\n$ wp-env start\n```\n"
      },
      "plugins": [
        {
          "name": "wordpress-ability-api",
          "source": "./claude-code-plugins/wordpress-ability-api",
          "description": "Create, validate, and register WordPress Abilities (server-side PHP and client-side JavaScript) with comprehensive scaffolding and validation tools",
          "version": "1.0.0",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/wp-ability-toolkit",
          "license": "GPL-2.0-or-later",
          "keywords": [
            "wordpress",
            "abilities-api",
            "scaffolding",
            "validation",
            "ai-agents",
            "development-tools"
          ],
          "category": "development-tools",
          "strict": false,
          "skills": [
            "./skills/wordpress-ability-api"
          ],
          "categories": [
            "abilities-api",
            "ai-agents",
            "development-tools",
            "scaffolding",
            "validation",
            "wordpress"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/wp-ability-toolkit",
            "/plugin install wordpress-ability-api@emdashcodes-wp-ability-toolkit"
          ]
        },
        {
          "name": "wordpress-plugin-scaffold",
          "source": "./claude-code-plugins/wordpress-plugin-scaffold",
          "description": "Scaffold WordPress plugins using WP-CLI commands with intelligent environment detection and comprehensive testing support",
          "version": "1.0.0",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/wp-ability-toolkit",
          "license": "GPL-2.0-or-later",
          "keywords": [
            "wordpress",
            "wp-cli",
            "plugin-development",
            "scaffolding",
            "development-tools"
          ],
          "category": "development-tools",
          "strict": false,
          "skills": [
            "./skills/wordpress-plugin-scaffold"
          ],
          "categories": [
            "development-tools",
            "plugin-development",
            "scaffolding",
            "wordpress",
            "wp-cli"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/wp-ability-toolkit",
            "/plugin install wordpress-plugin-scaffold@emdashcodes-wp-ability-toolkit"
          ]
        },
        {
          "name": "wp-env",
          "source": "./claude-code-plugins/wp-env",
          "description": "Manage local WordPress development environments using @wordpress/env with Docker for plugin and theme development",
          "version": "1.0.0",
          "author": {
            "name": "Em"
          },
          "repository": "https://github.com/emdashcodes/wp-ability-toolkit",
          "license": "GPL-2.0-or-later",
          "keywords": [
            "wordpress",
            "wp-env",
            "docker",
            "local-development",
            "development-tools"
          ],
          "category": "development-tools",
          "strict": false,
          "skills": [
            "./skills/wp-env"
          ],
          "categories": [
            "development-tools",
            "docker",
            "local-development",
            "wordpress",
            "wp-env"
          ],
          "install_commands": [
            "/plugin marketplace add emdashcodes/wp-ability-toolkit",
            "/plugin install wp-env@emdashcodes-wp-ability-toolkit"
          ]
        }
      ]
    }
  ]
}