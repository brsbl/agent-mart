{
  "author": {
    "id": "josemlopez",
    "display_name": "Jose Lopez",
    "avatar_url": "https://avatars.githubusercontent.com/u/4112135?u=4da59187053220234830615299f9b732c1cdae2a&v=4"
  },
  "marketplaces": [
    {
      "name": "threat-modeling-toolkit",
      "version": null,
      "description": "AI-powered threat modeling toolkit for Claude Code",
      "repo_full_name": "josemlopez/threat-modeling-toolkit",
      "repo_url": "https://github.com/josemlopez/threat-modeling-toolkit",
      "repo_description": "AI-powered threat modeling toolkit for Claude Code - STRIDE/PASTA framework support, compliance mapping, and security verification",
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-22T14:32:37Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"threat-modeling-toolkit\",\n  \"owner\": {\n    \"name\": \"Jose M. Lopez\",\n    \"url\": \"https://github.com/josemlopez\"\n  },\n  \"metadata\": {\n    \"description\": \"AI-powered threat modeling toolkit for Claude Code\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"threat-modeling-toolkit\",\n      \"source\": \"./\",\n      \"description\": \"AI-powered threat modeling toolkit with STRIDE/PASTA framework support. Analyze architecture, discover threats, verify controls, and generate comprehensive security reports.\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"Jose\"\n      },\n      \"homepage\": \"https://github.com/josemlopez/threat-modeling-toolkit\",\n      \"license\": \"MIT\",\n      \"keywords\": [\n        \"threat-modeling\",\n        \"security\",\n        \"stride\",\n        \"pasta\",\n        \"risk-analysis\",\n        \"compliance\",\n        \"owasp\"\n      ]\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"threat-modeling-toolkit\",\n  \"description\": \"AI-powered threat modeling toolkit with STRIDE/PASTA framework support. Analyze architecture, discover threats, verify controls, and generate comprehensive security reports.\",\n  \"version\": \"1.0.0\",\n  \"author\": {\n    \"name\": \"Jose M. Lopez\",\n    \"url\": \"https://github.com/josemlopez\"\n  },\n  \"homepage\": \"https://github.com/josemlopez/threat-modeling-toolkit\",\n  \"repository\": \"https://github.com/josemlopez/threat-modeling-toolkit\",\n  \"license\": \"MIT\",\n  \"keywords\": [\n    \"threat-modeling\",\n    \"security\",\n    \"stride\",\n    \"pasta\",\n    \"risk-analysis\",\n    \"compliance\",\n    \"owasp\",\n    \"security-assessment\"\n  ]\n}\n",
        "README.md": "<p align=\"center\">\n  <img src=\"https://img.shields.io/badge/version-1.0.0-blue.svg\" alt=\"Version\">\n  <img src=\"https://img.shields.io/badge/license-MIT-green.svg\" alt=\"License\">\n  <img src=\"https://img.shields.io/badge/claude--code-plugin-orange.svg\" alt=\"Claude Code Plugin\">\n</p>\n\n<h1 align=\"center\">Threat Modeling Toolkit</h1>\n\n<p align=\"center\">\n  <strong>Threat modeling inside your developer tools. No new UI. No external platform.</strong>\n</p>\n\n<p align=\"center\">\n  <img src=\"resources/image.png\" alt=\"Threat Modeling Toolkit overview\" width=\"900\" />\n</p>\n\n---\n\n## Installation\n\nIn Claude Code, run these two commands:\n\n```\n/plugin marketplace add josemlopez/threat-modeling-toolkit\n/plugin install threat-modeling-toolkit@josemlopez\n```\n\nThat's it. All 9 skills are now available.\n\nVerify it worked:\n\n```\n/tm-status\n```\n\n---\n\n## Quick Start: Try It in 2 Minutes\n\nTry the toolkit on an included test project.\n\n### Step 1: Clone the test project\n\n```bash\ngit clone https://github.com/josemlopez/threat-modeling-toolkit.git\ncd threat-modeling-toolkit/TEST/simple-app\n```\n\n### Step 2: Run the full analysis\n\nIn Claude Code:\n\n```\n/tm-full --docs ./docs --compliance owasp,soc2\n```\n\n### Step 3: See the results\n\n```\n.threatmodel/\n├── state/\n│   ├── assets.json          # 5 assets discovered\n│   ├── threats.json         # 15 threats identified\n│   ├── controls.json        # 5 implemented, 7 missing\n│   └── gaps.json            # 10 security gaps\n├── diagrams/\n│   └── architecture.mmd     # Mermaid diagram\n└── reports/\n    ├── risk-report.md       # Full findings\n    └── compliance-report.md # OWASP 52%, SOC2 48%\n```\n\n---\n\n## Step-by-Step Tutorial\n\nLet's walk through each skill using the `TEST/simple-app` project (a React + Express + PostgreSQL task manager with intentional security gaps).\n\n### Step 1: Initialize the Threat Model\n\n```bash\n/tm-init --docs ./docs\n```\n\n**What it does:** Reads your architecture documentation and extracts assets, data flows, trust boundaries, and attack surface.\n\n**Output:**\n\n```\nThreat Model Initialized\n========================\n\nProject: TaskFlow\nFramework: STRIDE\n\nDiscovered:\n  - 5 assets (1 client, 1 service, 1 data-store, 1 identity, 1 integration)\n  - 8 data flows (8 cross trust boundaries)\n  - 4 trust boundaries\n  - 8 attack surface entries\n\nCreated:\n  .threatmodel/config.yaml\n  .threatmodel/state/assets.json\n  .threatmodel/state/dataflows.json\n  .threatmodel/diagrams/architecture.mmd\n\nNext Steps:\n  Run /tm-threats to analyze threats\n```\n\n**Files created:**\n- `assets.json` — React Frontend, Express API, PostgreSQL, JWT Auth, SendGrid\n- `attack-surface.json` — All API endpoints with auth requirements\n- `architecture.mmd` — Mermaid diagram ready to render\n\n---\n\n### Step 2: Analyze Threats\n\n```bash\n/tm-threats\n```\n\n**What it does:** Applies STRIDE analysis to every asset and data flow. Generates attack trees for critical threats.\n\n**Output:**\n\n```\nThreat Analysis Complete\n========================\n\nFramework: STRIDE\nAssets Analyzed: 5\n\nThreats Identified:\n  Critical: 4\n  High:     7\n  Medium:   4\n  Total:   15\n\nTop Critical Threats:\n  1. [THREAT-001] Credential Stuffing Attack (Risk: 16)\n  2. [THREAT-003] BOLA - Task Update (Risk: 16)\n  3. [THREAT-004] BOLA - Task Delete (Risk: 16)\n  4. [THREAT-013] Missing MFA (Risk: 16)\n\nFiles Updated:\n  .threatmodel/state/threats.json\n  .threatmodel/state/attack-trees.json\n  .threatmodel/state/risk-register.json\n\nNext Steps:\n  Run /tm-verify to check control implementations\n```\n\n**What you'll find in threats.json:**\n\nEach threat includes category, target, risk score, MITRE ATT&CK mapping, CWE references, and recommended countermeasures.\n\n---\n\n### Step 3: Verify Controls in Code\n\n```bash\n/tm-verify\n```\n\n**What it does:** Searches your codebase to verify security controls actually exist. Provides file:line evidence.\n\n**Output:**\n\n```\nControl Verification Complete\n=============================\n\nControls Analyzed: 15\n\nVerification Results:\n  ✓ Implemented: 5  (33%)\n  ⚠ Partial:     3  (20%)\n  ✗ Missing:     7  (47%)\n\nGaps Identified:\n  Critical: 3\n  High:     5\n  Medium:   2\n\nFiles Updated:\n  .threatmodel/state/controls.json\n  .threatmodel/state/gaps.json\n\nNext Steps:\n  Run /tm-compliance to map to frameworks\n```\n\n**Evidence found:**\n\n| Control | Status | Evidence |\n|---------|--------|----------|\n| Password Hashing | ✓ | `src/routes/auth.js:20` - bcrypt cost 10 |\n| JWT Authentication | ✓ | `src/middleware/auth.js:16` |\n| Rate Limiting (login) | ✓ | `src/middleware/rateLimiter.js:4-10` |\n| BOLA Protection | ✗ | Missing in `src/routes/tasks.js:44` |\n| MFA | ✗ | Not found |\n\n---\n\n### Step 4: Map to Compliance Frameworks\n\n```bash\n/tm-compliance --framework owasp,soc2\n```\n\n**What it does:** Maps your threats and controls to OWASP Top 10, SOC2, PCI-DSS.\n\n**Output:**\n\n```\nCompliance Mapping Complete\n===========================\n\nOWASP Top 10 2021:\n  A01 Broken Access Control:     ██░░░░░░░░ 15%  (2 gaps) NON-COMPLIANT\n  A02 Cryptographic Failures:    █████████░ 90%          COMPLIANT\n  A03 Injection:                 ███████░░░ 70%  (1 gap) PARTIAL\n  A07 Authentication Failures:   █████░░░░░ 45%  (3 gaps) PARTIAL\n  A09 Logging Failures:          ░░░░░░░░░░  0%  (1 gap) NON-COMPLIANT\n  ─────────────────────────────────────────────────────\n  Overall: 52%\n\nSOC2 Trust Services:\n  CC6.1 Logical Access:          ████░░░░░░ 40%  PARTIAL\n  CC6.2 Authentication:          ████░░░░░░ 35%  PARTIAL\n  CC6.7 Transmission Integrity:  ██████████ 100% COMPLIANT\n  ─────────────────────────────────────────────────────\n  Overall: 48%\n\nFiles Created:\n  .threatmodel/state/compliance.json\n  .threatmodel/reports/compliance-report.md\n```\n\n---\n\n### Step 5: Generate Reports\n\n```bash\n/tm-report\n```\n\n**What it does:** Creates markdown reports for stakeholders.\n\n**Files created:**\n- `risk-report.md` — Detailed findings with attack scenarios\n- `executive-summary.md` — 1-page overview for leadership\n\n---\n\n### Step 6: Generate Security Tests\n\n```bash\n/tm-tests --format jest\n```\n\n**What it does:** Creates test cases from identified threats.\n\n**Output:**\n\n```\nTest Generation Complete\n========================\n\nTests Generated: 29\n  Authentication: 10 tests\n  Authorization: 8 tests\n  Input Validation: 11 tests\n\nExpected Failures: 6 tests\n  (Document known gaps - will pass after remediation)\n\nFiles Created:\n  .threatmodel/tests/auth-security.test.js\n  .threatmodel/tests/authz-security.test.js\n```\n\n**Sample generated test:**\n\n```javascript\nit('TEST-012: [EXPECTED FAIL] Should block user from updating others task', async () => {\n  // Documents GAP-001 - will pass after fix\n  const response = await request(app)\n    .put(`/api/tasks/${userATaskId}`)\n    .set('Authorization', `Bearer ${userBToken}`)\n    .send({ title: 'Hacked by User B' });\n\n  expect(response.status).toBe(403);\n});\n```\n\n---\n\n### Step 7: Track Changes Over Time\n\n```bash\n/tm-drift --create-baseline\n```\n\nAfter code changes:\n\n```bash\n/tm-drift\n```\n\n**What it does:** Compares current state to baseline. Detects new components, removed controls, changed configurations.\n\n---\n\n### Step 8: Quick Status Check\n\n```bash\n/tm-status\n```\n\n**Output:**\n\n```\n═══════════════════════════════════════════════════════════════\n                    THREAT MODEL STATUS\n═══════════════════════════════════════════════════════════════\n\nProject: TaskFlow v1.0.0\nFramework: STRIDE\n\n───────────────────────────────────────────────────────────────\n                        THREATS\n───────────────────────────────────────────────────────────────\nTotal: 15 threats\n  ├── Critical:  4  ██████████░░░░░░░░░░  27%\n  ├── High:      7  ██████████████████░░  47%\n  └── Medium:    4  ██████████░░░░░░░░░░  27%\n\n───────────────────────────────────────────────────────────────\n                       CONTROLS\n───────────────────────────────────────────────────────────────\n  ├── Implemented: 5  █████████████░░░░░░░  33%\n  ├── Partial:     3  ████████░░░░░░░░░░░░  20%\n  └── Missing:     7  ██████████████████░░  47%\n\n───────────────────────────────────────────────────────────────\n                      COMPLIANCE\n───────────────────────────────────────────────────────────────\nOWASP Top 10 2021:  52%  ██████░░░░\nSOC2 Trust Services: 48%  █████░░░░░\n\n═══════════════════════════════════════════════════════════════\n```\n\n---\n\n## Or Just Run Everything at Once\n\n```bash\n/tm-full --docs ./docs --compliance owasp,soc2\n```\n\nThis runs all phases automatically: init → threats → verify → compliance → report.\n\n---\n\n## The 9 Skills\n\n| Skill | Purpose | Output |\n|-------|---------|--------|\n| `/tm-init` | Discover architecture | `assets.json`, `dataflows.json`, Mermaid diagrams |\n| `/tm-threats` | Analyze threats | `threats.json`, `attack-trees.json`, risk scores |\n| `/tm-verify` | Check code for controls | `controls.json`, `gaps.json` with file:line evidence |\n| `/tm-compliance` | Map to frameworks | `compliance.json`, coverage percentages |\n| `/tm-report` | Generate documentation | `risk-report.md`, `executive-summary.md` |\n| `/tm-drift` | Track changes | Diff against baseline, new threat detection |\n| `/tm-tests` | Create security tests | Test files for Jest/Pytest |\n| `/tm-status` | Quick overview | Current posture summary |\n| `/tm-full` | Complete workflow | Everything above, one command |\n\n---\n\n## Test Projects Included\n\nThe `TEST/` directory contains two example projects:\n\n| Project | Description | Use Case |\n|---------|-------------|----------|\n| `TEST/simple-app/` | React + Express task manager | Developer experience |\n| `TEST/complex-system/` | Enterprise financial platform | Security expert experience |\n\nPre-generated results are in `TEST/results/` so you can see expected output.\n\n---\n\n## Why This Exists\n\n**The problem:** Threat modeling has always lived outside the developer's world. Specialized tools, separate workflows, complex frameworks that don't speak developer.\n\n**The solution:** Slash commands in Claude Code—the same place you already write and review code.\n\n**For developers:** `/tm-full --docs ./docs` and you're done. No security background needed.\n\n**For security professionals:** Go as deep as you need. Complex trust boundaries, attack trees, STRIDE analysis, multiple compliance frameworks, control verification with file:line evidence.\n\n---\n\n## What Makes This Different\n\n### Code-Connected\nEvery control has evidence. Every gap has a file path. Not assumptions—verification.\n\n### Living Document\nDrift detection keeps your threat model current as code changes.\n\n### Compliance-Ready\nTraceable evidence: Requirement → Threat → Control → Code Location → Test.\n\n### Actionable Output\nPrioritized risks with specific countermeasures, effort estimates, and test cases.\n\n---\n\n## Contributing\n\nContributions welcome! See [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines.\n\n## License\n\nMIT License - see [LICENSE](LICENSE) for details.\n\n---\n\n<p align=\"center\">\n  <strong>Built with Claude Code</strong><br>\n  <em>Threat modeling shouldn't require leaving your dev environment.</em>\n</p>\n\n<p align=\"center\">\n  <a href=\"https://github.com/josemlopez/threat-modeling-toolkit\">Star on GitHub</a> |\n  <a href=\"https://github.com/josemlopez/threat-modeling-toolkit/issues\">Report Bug</a> |\n  <a href=\"https://github.com/josemlopez/threat-modeling-toolkit/issues\">Request Feature</a>\n</p>\n"
      },
      "plugins": [
        {
          "name": "threat-modeling-toolkit",
          "source": "./",
          "description": "AI-powered threat modeling toolkit with STRIDE/PASTA framework support. Analyze architecture, discover threats, verify controls, and generate comprehensive security reports.",
          "version": "1.0.0",
          "author": {
            "name": "Jose"
          },
          "homepage": "https://github.com/josemlopez/threat-modeling-toolkit",
          "license": "MIT",
          "keywords": [
            "threat-modeling",
            "security",
            "stride",
            "pasta",
            "risk-analysis",
            "compliance",
            "owasp"
          ],
          "categories": [
            "compliance",
            "owasp",
            "pasta",
            "risk-analysis",
            "security",
            "stride",
            "threat-modeling"
          ],
          "install_commands": [
            "/plugin marketplace add josemlopez/threat-modeling-toolkit",
            "/plugin install threat-modeling-toolkit@threat-modeling-toolkit"
          ]
        }
      ]
    }
  ]
}