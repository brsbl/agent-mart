{
  "author": {
    "id": "stbenjam",
    "display_name": "Stephen Benjamin",
    "avatar_url": "https://avatars.githubusercontent.com/u/429763?u=dd2c1e820d0d41d3f804cf4ba39ae6a6995673e2&v=4"
  },
  "marketplaces": [
    {
      "name": "metrics-temp",
      "version": null,
      "description": "TODO: Add description",
      "repo_full_name": "stbenjam/metrics-temp",
      "repo_url": "https://github.com/stbenjam/metrics-temp",
      "repo_description": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2025-11-10T21:17:58Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"metrics-temp\",\n  \"owner\": {\n    \"name\": \"stbenjam\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"metrics\",\n      \"source\": \"./plugins/metrics\",\n      \"description\": \"TODO: Add description\"\n    }\n  ]\n}",
        "README.md": "# metrics-temp\n\nClaude Code Plugins by stbenjam\n\n## Installation\n\nAdd the marketplace to Claude Code:\n\n```\n/plugin marketplace add stbenjam/metrics-temp\n```\n\nInstall a specific plugin:\n\n```\n/plugin install example-plugin@metrics-temp\n```\n\n## Plugins\n\n- **example-plugin**: Example plugin demonstrating command structure\n\n## Development\n\nRun the linter to validate plugin structure:\n\n```bash\nmake lint\n```\n\nUpdate plugin documentation and website:\n\n```bash\nmake update\n```\n\n## Documentation\n\nVisit the [documentation site](https://stbenjam.github.io/metrics-temp) for more information.\n\n## License\n\nMIT\n",
        "plugins/metrics/README.md": "# Metrics Plugin\n\nAnonymous usage metrics collection for ai-helpers slash commands, skills, and sessions.\n\n## Overview\n\nThe `metrics` plugin provides anonymous usage tracking for:\n- **Events**: Individual slash commands and skill invocations\n- **Sessions**: Aggregate session-level metrics (duration, tool usage, conversation patterns)\n\nThis helps maintainers understand usage patterns and make data-driven decisions about feature development and improvements.\n\n## How It Works\n\nThe plugin uses Claude Code's [hook system](https://docs.claude.com/en/docs/claude-code/hooks) to automatically track usage:\n\n### Event Tracking (Slash Commands & Skills)\n\n1. **Hook Triggers**:\n   - `UserPromptSubmit`: Fires when you submit a prompt that starts with `/` (slash commands)\n   - `PreToolUse`: Fires when Claude invokes a Skill tool\n2. **Data Collection**: The `send_metrics.py` script extracts the command/skill name and system information\n3. **Background Transmission**: Events are sent asynchronously to the events endpoint\n4. **Local Logging**: If verbose mode is enabled, all activity is logged to `metrics.log`\n\n### Session Tracking (Session-Level Aggregates)\n\n1. **Hook Trigger**: `SessionEnd` fires when your Claude Code session ends\n2. **Transcript Parsing**: The `send_session_metrics.py` script parses the session transcript file\n3. **Metrics Extraction**: Aggregates are calculated (tool usage, conversation turns, duration, etc.)\n4. **Background Transmission**: Session metrics are sent asynchronously to the sessions endpoint\n5. **Privacy**: Only counts and aggregates are collected - no command arguments, file paths, or message content\n\n### Hook Configuration\n\nThe plugin is defined in `plugins/metrics/hooks/hooks.json`:\n\n```json\n{\n  \"description\": \"Anonymous Usage Metric Collection\",\n  \"hooks\": {\n    \"UserPromptSubmit\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/send_metrics.py\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ],\n    \"PreToolUse\": [\n      {\n        \"matcher\": {\n          \"tool\": \"Skill\"\n        },\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/send_metrics.py\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ],\n    \"SessionEnd\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/send_session_metrics.py\",\n            \"timeout\": 30\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## What Data is Collected\n\nThe plugin collects two types of anonymous data:\n\n### Event Metrics (Slash Commands & Skills)\n\nCollected when you use a slash command or invoke a skill:\n\n| Field | Description | Example |\n|-------|-------------|---------|\n| `type` | Metric type | `\"slash_command\"` or `\"skill\"` |\n| `name` | The command or skill name | `\"jira:solve\"` or `\"prow-job:prow-job-analyze-install-failure\"` |\n| `engine` | Always \"claude\" | `\"claude\"` |\n| `version` | Plugin version | `\"1.0\"` |\n| `timestamp` | UTC timestamp | `\"2025-10-30T12:34:56Z\"` |\n| `session_id` | Claude session identifier | `\"abc123...\"` |\n| `user_id` | Persistent anonymous UUID | `\"550e8400-e29b-41d4-a716-446655440000\"` |\n| `os` | Operating system | `\"darwin\"`, `\"linux\"`, `\"windows\"` |\n| `mac` | SHA256 hash of session_id + timestamp | `\"a1b2c3...\"` |\n| `prompt_length` | Character count of the prompt | `42` |\n\n**Privacy Guarantees:**\n- No command arguments or sensitive data are transmitted\n- No personal identifying information (PII) is collected\n- Session IDs are ephemeral and rotate between Claude sessions\n- A persistent anonymous UUID is stored locally in `.anonymous_id`, used only to correlate events across sessions\n- The `user_id` contains no PII and can be regenerated/cleared by deleting the `.anonymous_id` file\n- The `user_id` is treated as anonymous for analytics and integrity purposes\n- The MAC is used for data integrity verification only\n\n**Example payloads:**\n\nSlash command:\n```json\n{\n  \"type\": \"slash_command\",\n  \"name\": \"jira:solve\",\n  \"engine\": \"claude\",\n  \"version\": \"1.0\",\n  \"timestamp\": \"2025-10-30T12:34:56Z\",\n  \"session_id\": \"abc123...\",\n  \"user_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"os\": \"darwin\",\n  \"mac\": \"a1b2c3...\",\n  \"prompt_length\": 42\n}\n```\n\nSkill invocation:\n```json\n{\n  \"type\": \"skill\",\n  \"name\": \"prow-job:prow-job-analyze-install-failure\",\n  \"engine\": \"claude\",\n  \"version\": \"1.0\",\n  \"timestamp\": \"2025-10-30T12:34:56Z\",\n  \"session_id\": \"abc123...\",\n  \"user_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"os\": \"darwin\",\n  \"mac\": \"a1b2c3...\",\n  \"prompt_length\": 0\n}\n```\n\n### Session Metrics (Session-Level Aggregates)\n\nCollected when your Claude Code session ends:\n\n| Field | Description | Example |\n|-------|-------------|---------|\n| `session_id` | Session identifier | `\"abc123...\"` |\n| `user_id` | Persistent anonymous UUID | `\"550e8400-e29b-41d4-a716-446655440000\"` |\n| `os` | Operating system | `\"darwin\"`, `\"linux\"`, `\"windows\"` |\n| `engine` | Always \"claude\" | `\"claude\"` |\n| `start_timestamp` | Session start time (UTC) | `\"2025-10-30T12:00:00Z\"` |\n| `end_timestamp` | Session end time (UTC) | `\"2025-10-30T14:30:00Z\"` |\n| `session_duration` | Duration in seconds | `9000` |\n| `exit_reason` | How session ended | `\"clear\"`, `\"logout\"`, `\"prompt_input_exit\"`, `\"other\"` |\n| `turn_count` | User-assistant exchanges | `42` |\n| `user_message_count` | Total user messages | `45` |\n| `assistant_message_count` | Total assistant messages | `48` |\n| `total_tool_calls` | Total tool invocations | `156` |\n| `tool_error_count` | Failed tool calls | `3` |\n| `bash_call_count` | Bash tool usage | `28` |\n| `file_read_count` | Read tool usage | `42` |\n| `file_edit_count` | Edit tool usage | `18` |\n| `file_write_count` | Write tool usage | `5` |\n| `grep_call_count` | Grep tool usage | `12` |\n| `glob_call_count` | Glob tool usage | `8` |\n| `web_fetch_call_count` | WebFetch tool usage | `2` |\n| `web_search_call_count` | WebSearch tool usage | `1` |\n| `total_input_tokens` | Total input tokens (nullable) | `50000` |\n| `total_output_tokens` | Total output tokens (nullable) | `12000` |\n| `cache_creation_tokens` | Cache creation tokens (nullable) | `15000` |\n| `cache_read_tokens` | Cache read tokens (nullable) | `35000` |\n| `had_errors` | Whether errors occurred | `true` or `false` |\n\n**Privacy Guarantees for Session Metrics:**\n- **Only aggregates**: Tool usage counts, not what tools were used for\n- **No content**: Command arguments, file paths, or message content are never collected\n- **No identifiable patterns**: Git operations, specific bash commands, or file names are excluded\n- **Optional tokens**: Token metrics are only included if non-zero and can be omitted for privacy\n\n**Example session payload:**\n```json\n{\n  \"session_id\": \"abc123...\",\n  \"user_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"os\": \"darwin\",\n  \"engine\": \"claude\",\n  \"start_timestamp\": \"2025-10-30T12:00:00Z\",\n  \"end_timestamp\": \"2025-10-30T14:30:00Z\",\n  \"session_duration\": 9000,\n  \"exit_reason\": \"clear\",\n  \"turn_count\": 42,\n  \"user_message_count\": 45,\n  \"assistant_message_count\": 48,\n  \"total_tool_calls\": 156,\n  \"tool_error_count\": 3,\n  \"bash_call_count\": 28,\n  \"file_read_count\": 42,\n  \"file_edit_count\": 18,\n  \"file_write_count\": 5,\n  \"grep_call_count\": 12,\n  \"glob_call_count\": 8,\n  \"web_fetch_call_count\": 2,\n  \"web_search_call_count\": 1,\n  \"total_input_tokens\": 50000,\n  \"total_output_tokens\": 12000,\n  \"cache_creation_tokens\": 15000,\n  \"cache_read_tokens\": 35000,\n  \"had_errors\": false\n}\n```\n\n## Enabling the Plugin\n\nThe metrics plugin requires explicit configuration.\n\n### Method 1: Repository Trust (Recommended)\n\nIf you clone and trust this repository locally, it will be automatically\ninstalled by the included settings.json.\n\n### Method 2: Manual Installation\n\nIf you've installed ai-helpers from the marketplace:\n\n```bash\n# Enable the plugin\n/plugin enable metrics@ai-helpers\n\n# Verify it's enabled\n/plugin list\n```\n\n## Disabling the Plugin\n\nIf you wish to opt out of metrics collection:\n\n```bash\n/plugin disable metrics@ai-helpers\n```\n\n## Network Behavior\n\n- **Event Endpoint**: `https://us-central1-openshift-ci-data-analysis.cloudfunctions.net/metrics-upload/events`\n- **Session Endpoint**: `https://us-central1-openshift-ci-data-analysis.cloudfunctions.net/metrics-upload/sessions`\n- **Async**: Runs in a background thread so it doesn't delay command execution\n- **Resilience**: Network failures are logged but don't interrupt your work\n\n## Source Code\n\nAll metrics collection logic is open source and available in this repository:\n\n- **Hook definition**: `plugins/metrics/hooks/hooks.json`\n- **Event collection script**: `plugins/metrics/scripts/send_metrics.py`\n- **Session collection script**: `plugins/metrics/scripts/send_session_metrics.py`\n- **Plugin metadata**: `plugins/metrics/.claude-plugin/plugin.json`\n\n## Data Usage\n\nThe collected metrics help us:\n\n**Event metrics:**\n- Understand which commands and skills are most valuable to users\n- Identify commands that may need better documentation\n- Make data-driven decisions about feature prioritization and deprecations\n\n**Session metrics:**\n- Understand typical session patterns (duration, tool usage, conversation depth)\n- Identify workflow bottlenecks and optimization opportunities\n- Measure developer productivity patterns without revealing specific work content\n- Optimize tool performance and caching strategies based on actual usage\n\n**Aggregate metrics may be shared publicly** (e.g., \"The average session uses 42 tool calls\" or \"The most popular command is `/jira:solve` with 1,234 uses this month\"), but individual usage data remains private.\n"
      },
      "plugins": [
        {
          "name": "metrics",
          "source": "./plugins/metrics",
          "description": "TODO: Add description",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add stbenjam/metrics-temp",
            "/plugin install metrics@metrics-temp"
          ]
        }
      ]
    }
  ]
}