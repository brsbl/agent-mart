{
  "author": {
    "id": "andrewleech",
    "display_name": "Andrew Leech",
    "avatar_url": "https://avatars.githubusercontent.com/u/3318786?u=bbb703de38f85c76b1316cdaee8d61c1646a2454&v=4"
  },
  "marketplaces": [
    {
      "name": "claude-reflections-local",
      "version": null,
      "description": "Local development marketplace for claude-reflections",
      "repo_full_name": "andrewleech/claude-reflections",
      "repo_url": "https://github.com/andrewleech/claude-reflections",
      "repo_description": "Simple claude exptension to provide claude the ability to search and read it's own project conversation history",
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-02-20T21:21:54Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"claude-reflections-local\",\n  \"owner\": {\n    \"name\": \"corona\"\n  },\n  \"metadata\": {\n    \"description\": \"Local development marketplace for claude-reflections\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"claude-reflections\",\n      \"version\": \"0.1.0\",\n      \"source\": \"./\",\n      \"description\": \"Minimal conversation memory with vector search and Agent SDK retrieval\",\n      \"author\": {\n        \"name\": \"corona\"\n      }\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"claude-reflections\",\n  \"version\": \"0.2.0\",\n  \"description\": \"Minimal conversation memory with vector search\",\n  \"author\": {\n    \"name\": \"corona\"\n  },\n  \"skills\": [\"./.claude/skills/reflections\"]\n}\n",
        "README.md": "# claude-reflections\n\nMinimal conversation memory with vector search.\n\n## Overview\n\n`claude-reflections` is a Claude Code plugin that indexes your past conversations and makes them searchable. The **reflections** skill is automatically triggered when you ask about past conversations, searches for relevant context, and reads the original JSONL files to provide detailed answers.\n\n### Key Features\n\n- **Zero infrastructure** - embedded sqlite-vec database, no Docker or external services\n- **Reversible indexing** - vectors point back to original JSONL files\n- **Per-project isolation** - each project has its own database and state\n- **Incremental indexing** - only processes new messages on each run\n- **Auto-indexing on search** - search automatically indexes before searching\n- **Skill-based integration** - automatically triggered by conversation questions\n\n## Architecture\n\n```\n+----------------+     +----------------+     +----------------+\n|  Claude Code   | --> |     Skill      | --> |  CLI Commands  |\n|  (user asks    |     |  (reflections) |     |  (index +      |\n|   question)    |     |                |     |   search)      |\n+----------------+     +----------------+     +--------+-------+\n                                                       |\n                                                       v\n                                              +----------------+\n                                              |   sqlite-vec   |\n                                              |  (vectors.db   |\n                                              |  per project)  |\n                                              +----------------+\n\nSkill workflow:\n1. User asks: \"How did we fix X?\"\n2. Skill determines project name from $PWD\n3. Skill runs: uv run claude-reflections search \"X\"\n4. CLI auto-indexes (incremental), then searches\n5. Skill reads JSONL files at returned line numbers\n6. Skill synthesizes answer from actual conversation content\n```\n\n## Installation\n\n### Prerequisites\n\n- Python 3.11+\n- [uv](https://docs.astral.sh/uv/) package manager\n\n### Automated Install (Recommended)\n\n```bash\ncd /path/to/claude-reflections\n./install.sh\n```\n\nThis will:\n- Install Python dependencies (sqlite-vec, fastembed)\n- Download the embedding model\n- Create local marketplace at `~/.claude/plugins/local-marketplace`\n- Symlink plugin into marketplace\n- Update `~/.claude/settings.json` with plugin configuration\n\nVector databases are created automatically per-project on first use.\n\n**After installation:**\n1. Restart Claude Code\n2. Verify installation:\n   - Ask: \"What skills are available?\" → should show `reflections`\n   - Ask: \"What plugins are installed?\" → should show `claude-reflections`\n3. Try asking: \"How did we implement X?\" to trigger the skill\n\n### Manual Installation\n\nIf you prefer manual setup:\n\n1. **Install Python dependencies:**\n   ```bash\n   cd /path/to/claude-reflections\n   uv sync\n   ```\n\n2. **Create local marketplace:**\n   ```bash\n   mkdir -p ~/.claude/plugins/local-marketplace/.claude-plugin\n   mkdir -p ~/.claude/plugins/local-marketplace/plugins\n\n   # Symlink plugin\n   ln -s /path/to/claude-reflections \\\n     ~/.claude/plugins/local-marketplace/plugins/claude-reflections\n   ```\n\n3. **Create marketplace manifest:**\n   ```bash\n   cat > ~/.claude/plugins/local-marketplace/.claude-plugin/marketplace.json << 'EOF'\n   {\n     \"$schema\": \"https://anthropic.com/claude-code/marketplace.schema.json\",\n     \"name\": \"local\",\n     \"description\": \"Local development plugins\",\n     \"owner\": {\"name\": \"your-name\"},\n     \"plugins\": [{\n       \"name\": \"claude-reflections\",\n       \"description\": \"Minimal conversation memory with vector search\",\n       \"version\": \"0.2.0\",\n       \"source\": \"./plugins/claude-reflections\",\n       \"category\": \"productivity\"\n     }]\n   }\n   EOF\n   ```\n\n4. **Update Claude Code settings** (`~/.claude/settings.json`):\n   ```json\n   {\n     \"enabledPlugins\": {\n       \"claude-reflections@local\": true\n     },\n     \"extraKnownMarketplaces\": {\n       \"local\": {\n         \"source\": {\n           \"source\": \"directory\",\n           \"path\": \"/home/YOUR_USER/.claude/plugins/local-marketplace\"\n         }\n       }\n     }\n   }\n   ```\n\n5. **Restart Claude Code** for changes to take effect\n\n### Development Setup\n\nFor development without the marketplace:\n\n```bash\n# Clone and setup\ncd ~/claude-reflections\nuv sync --all-extras\n\n# Install pre-commit hooks\nuv run pre-commit install\n```\n\n## Usage\n\n### Skill Usage (via Claude Code)\n\nOnce installed, the **reflections** skill is automatically available in Claude Code. The skill is triggered when you ask questions about past conversations:\n\n**Example questions:**\n- \"How did we fix the authentication bug?\"\n- \"What approach did we take for the API design?\"\n- \"What have we discussed about X?\"\n\nThe skill automatically:\n1. Determines the current project from your working directory\n2. Searches past conversations using vector similarity\n3. Reads relevant JSONL files for full context\n4. Provides synthesized answers based on actual conversations\n\n**Search automatically indexes before searching** (incremental), ensuring results are always up-to-date.\n\nSee [`.claude/skills/reflections/SKILL.md`](.claude/skills/reflections/SKILL.md) for complete usage details.\n\n### CLI Commands\n\n```bash\n# List available projects\nclaude-reflections list\n\n# Index a project (incremental)\nclaude-reflections index --project my-project\n\n# Full reindex\nclaude-reflections index --project my-project --full\n\n# Search\nclaude-reflections search \"API design\" --project my-project\n\n# Check status\nclaude-reflections status\n```\n\n## Configuration\n\n### Environment Variables\n\n- `REFLECTIONS_STATE_DIR` - State directory (default: `~/.claude/reflections`)\n\n### Per-Project State\n\nEach project's state and vector database are stored in:\n```\n~/.claude/reflections/<project>/\n├── state.json      # Indexing progress tracking\n└── vectors.db      # sqlite-vec database\n```\n\n## Development\n\n```bash\n# Install dev dependencies\nuv sync --all-extras\n\n# Run tests\nuv run pytest\n\n# Run linting\nuv run ruff check .\nuv run ruff format --check .\n\n# Run type checking\nuv run mypy src/claude_reflections\n```\n\n## How It Works\n\n1. **Indexing**: Parses JSONL files from `~/.claude/projects/<project>/*.jsonl`\n2. **Content Extraction**: Extracts user prompts and assistant text responses (skips thinking blocks and tool use)\n3. **Embedding**: Generates 384-dimensional embeddings using FastEmbed (all-MiniLM-L6-v2)\n4. **Storage**: Stores vectors in sqlite-vec with metadata (file path, line number, role, snippet, timestamp)\n5. **Search**: CLI auto-indexes (incremental), then performs cosine similarity search\n6. **Skill**: Reads original JSONL files at returned line numbers to provide detailed answers\n\n## License\n\nMIT\n"
      },
      "plugins": [
        {
          "name": "claude-reflections",
          "version": "0.1.0",
          "source": "./",
          "description": "Minimal conversation memory with vector search and Agent SDK retrieval",
          "author": {
            "name": "corona"
          },
          "categories": [],
          "install_commands": [
            "/plugin marketplace add andrewleech/claude-reflections",
            "/plugin install claude-reflections@claude-reflections-local"
          ]
        }
      ]
    },
    {
      "name": "mpy-reviewer",
      "version": null,
      "description": "MicroPython code review RAG system",
      "repo_full_name": "andrewleech/mpy-reviewer",
      "repo_url": "https://github.com/andrewleech/mpy-reviewer",
      "repo_description": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-02-21T23:09:38Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"$schema\": \"https://anthropic.com/claude-code/marketplace.schema.json\",\n  \"name\": \"mpy-reviewer\",\n  \"owner\": { \"name\": \"Andrew Leech\" },\n  \"metadata\": { \"description\": \"MicroPython code review RAG system\" },\n  \"plugins\": [\n    {\n      \"name\": \"mpy-reviewer\",\n      \"source\": \"./\",\n      \"description\": \"MicroPython code review assistant backed by 18,614 categorized review comments\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"mpy-reviewer\",\n  \"description\": \"MicroPython code review assistant backed by 18,614 categorized review comments\",\n  \"version\": \"0.1.0\",\n  \"author\": { \"name\": \"Andrew Leech\" },\n  \"homepage\": \"https://github.com/andrewleech/mpy-reviewer\",\n  \"repository\": \"https://github.com/andrewleech/mpy-reviewer\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"micropython\", \"code-review\", \"rag\"],\n  \"skills\": \"./skills/\",\n  \"hooks\": \"./hooks/hooks.json\",\n  \"mcpServers\": \"./.mcp.json\"\n}\n",
        "README.md": "# mpy-reviewer\n\nCode review feedback for MicroPython projects, based on historical review patterns from the micropython/micropython repository. Surfaces relevant past reviews, coding conventions, and common issues to help you catch problems before submitting a PR.\n\n## What It Does\n\nWhen you're working on MicroPython code, mpy-reviewer searches a database of 18,614 categorized review comments to find feedback relevant to your changes. It covers:\n\n- **Correctness** — logic bugs, edge cases, missing error handling\n- **Memory safety** — allocation patterns, leaks, embedded constraints\n- **API design** — clean interfaces, constructor conventions, backwards compatibility\n- **Code style** — MicroPython naming, formatting, preprocessor conventions\n- **Portability** — cross-platform assumptions, struct alignment, platform-specific behavior\n- **Testing** — coverage gaps, board-specific vs generic tests\n\nResults are filtered by component (py_core, extmod, ports, etc.), severity (blocking, suggestion, nitpick), and domain, so feedback is targeted to the code you're actually changing.\n\n## Quick Start\n\n### Claude Code Plugin (recommended)\n\n```bash\n/install-plugin https://github.com/andrewleech/mpy-reviewer\n```\n\nThe plugin's SessionStart hook sets up the venv, installs the package, and starts the MCP server automatically. Requires Python 3.10+ and Rust/cargo (for codanna).\n\nOnce installed, ask Claude to review your code:\n\n```\nCan you review my current branch?\nCan you review commit ca65d543?\nCan you review my changes to py/gc.c?\nFind examples of memory allocation reviews.\n```\n\n### CLI\n\nFor use outside Claude Code:\n\n```bash\ncd /path/to/mpy-reviewer\nuv sync\nuv run mpy-reviewer stats\n```\n\n## What Kind of Feedback to Expect\n\nReviews follow the patterns established in the MicroPython project's review history: terse, technical, and direct. No filler, no gratuitous praise.\n\n### Communication Style\n\nFeedback is characteristically brief. Nitpicks are extremely short (median 45 characters), blocking comments are concise but include enough technical detail to explain why.\n\nCommon patterns:\n- Direct statement: \"This should be...\", \"This needs...\", \"This will...\"\n- Question: \"Is there a reason...?\", \"Why not...?\", \"Can this...?\"\n- Instruction: \"Please use...\", \"Please reorder...\", \"Please add...\"\n- Suggestion: \"Maybe use...\", \"Would it be better to...?\"\n\nExamples from real reviews:\n```\n\"please no blank lines at start of files\"\n\"please put `void` in arg list\"\n\"this can just be a `bool`\"\n\"Why not `mp_obj_get_int(args[3])`? That will do error checking that it's an int.\"\n\"Please use `mp_hal_pin_config(...)`\"\n\"To avoid labels and goto (which is nice if possible)...\"\n\"I think this function should be called X. Is that what it's doing?\"\n```\n\n### Recurring Patterns\n\nThese are the most common categories of feedback across the project's review history:\n\n**API Design:**\n- Use constructor arguments with sensible defaults\n- Use descriptive function names that explain purpose\n- Use MicroPython HAL abstraction functions for consistency\n- Clarify meaning of special values (like 0, -1, NULL)\n\n**Code Style:**\n- Prefer bool over int for boolean values\n- Avoid negation in preprocessor conditionals (use positive logic)\n- Avoid goto statements, prefer fall-through logic\n- Wrap macro arguments in parentheses\n- Watch for macro double-evaluation side effects\n- Comment when intentionally discarding return values\n- Extract repeated code to helper functions\n\n**Portability:**\n- Consider struct member alignment for cross-platform compatibility\n- Test on multiple platforms before assuming behavior\n\n**Testing:**\n- Prefer generic tests that work on all boards over board-specific tests\n- Keep tests focused and separated\n- Ensure test coverage before merge\n\n**Documentation:**\n- Provide examples rather than just descriptions\n- Reference shared documentation instead of duplicating\n\n## Usage\n\n### CLI\n\n```bash\n# Search for relevant past reviews\nmpy-reviewer search \"memory allocation error handling\" -k 10\n\n# Search with filters\nmpy-reviewer search \"GPIO configuration\" --component port_specific --domain api_design\n\n# Review a PR\nmpy-reviewer review --pr 17321\n\n# Review a diff from stdin\ngit diff main | mpy-reviewer review --stdin --output prompt\n\n# Review a diff file\nmpy-reviewer review --diff changes.patch\n\n# Show index statistics\nmpy-reviewer stats\n```\n\n### Python API\n\n```python\nfrom rag.retriever import search, find_similar\n\n# Semantic search\nresults = search(\"memory allocation in C\", top_k=10)\n\n# Search with filters\nresults = search(\n    \"error handling\",\n    top_k=10,\n    domain=\"correctness\",\n    component=\"py_core\",\n    severity=\"blocking\",\n)\n\n# Find similar reviews for a code diff\nresults = find_similar(diff_text, top_k=8)\n```\n\n### MCP Tools (Claude Code)\n\nWhen running as a plugin, the MCP server provides these tools:\n\n| Tool | Purpose |\n|------|---------|\n| `review_diff` | Review a unified diff against historical patterns |\n| `review_pr` | Review a GitHub PR by number |\n| `search_reviews` | Semantic search with metadata filters |\n| `find_style_examples` | Find comments that exemplify the review style |\n| `get_review_stats` | Index statistics |\n| `get_pr_review_history` | Full review thread history for a PR |\n\n### Filter Dimensions\n\n| Filter | Values |\n|--------|--------|\n| Domain | correctness, code_style, api_design, memory, performance, portability, documentation, testing, security, architecture, build_system |\n| Severity | blocking, suggestion, nitpick |\n| Component | py_core, extmod, port_specific, drivers, tools, tests, docs, build_system |\n| Language | c_code, python_code, documentation, makefile, yaml, shell_script |\n\n## How It Works\n\nReview comments from the MicroPython repository are categorized across 13 dimensions (domain, severity, component, port, subsystem, language context, etc.) and embedded using CodeRankEmbed into a sqlite-vec vector index.\n\nWhen you submit code for review, the system runs hybrid retrieval (dense vector search + full-text search) with reciprocal rank fusion, applies heuristic boosts for file-path affinity and pattern reusability, then selects a diverse set of examples across severity levels and domains.\n\nThe MCP server writes each retrieved example to a temp file and returns a compact orchestration prompt with file paths, keeping the response well within tool output limits while preserving full diff context in the reference files.\n\n## Roadmap\n\n- GitHub Actions integration for automated review suggestions on PRs\n- Continuous collection of new reviews as the project evolves\n- Author-aware review context — calibrate feedback depth based on contributor history\n- Incremental index updates without full rebuild\n\n## License\n\nData collected from the public GitHub repository micropython/micropython.\nScripts and tools: MIT License.\n"
      },
      "plugins": [
        {
          "name": "mpy-reviewer",
          "source": "./",
          "description": "MicroPython code review assistant backed by 18,614 categorized review comments",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add andrewleech/mpy-reviewer",
            "/plugin install mpy-reviewer@mpy-reviewer"
          ]
        }
      ]
    }
  ]
}