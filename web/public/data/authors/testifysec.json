{
  "author": {
    "id": "testifysec",
    "display_name": "TestifySec",
    "avatar_url": "https://avatars.githubusercontent.com/u/87545603?v=4"
  },
  "marketplaces": [
    {
      "name": "ai-notary-local",
      "version": null,
      "description": "AI command attestation with two-tier policy model: infrastructure policies + feature policies with AI evaluators",
      "repo_full_name": "testifysec/witness-signer-daemon",
      "repo_url": "https://github.com/testifysec/witness-signer-daemon",
      "repo_description": "Secure signing daemon for AI validation attestations with Witness",
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-17T20:05:06Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"ai-notary-local\",\n  \"owner\": {\n    \"name\": \"Cole Kennedy\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"ai-notary\",\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"testifysec/ai-notary-daemon\"\n      },\n      \"description\": \"AI command attestation with two-tier policy model: infrastructure policies + feature policies with AI evaluators\",\n      \"version\": \"0.2.0\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"ai-notary\",\n  \"description\": \"AI command attestation with cryptographic proof. Two-tier policy model: infrastructure policies (build, lint, test) + feature policies (UAT with AI evaluators). Human-in-the-loop policy signing via Sigstore.\",\n  \"version\": \"0.2.0\",\n  \"author\": {\n    \"name\": \"Cole Kennedy\"\n  },\n  \"repository\": \"https://github.com/testifysec/ai-notary\",\n  \"license\": \"Apache-2.0\",\n  \"skills\": [\n    {\n      \"name\": \"ai-attestation\",\n      \"description\": \"Create cryptographic attestations for validation commands (lint, test, build). Use when running validation commands or preparing for git push.\",\n      \"path\": \"skills/ai-attestation.md\"\n    },\n    {\n      \"name\": \"ai-evaluators\",\n      \"description\": \"Configure AI evaluators for semantic verification. Feature policies use AI evaluators for visual/UAT verification; infrastructure policies use Rego for deterministic checks.\",\n      \"path\": \"skills/ai-evaluators.md\",\n      \"triggers\": [\"evaluator\", \"ai evaluator\", \"semantic verification\", \"verify output\", \"uat verification\", \"visual verification\"]\n    },\n    {\n      \"name\": \"uat-tester\",\n      \"description\": \"Perform User Acceptance Testing with browser automation, GIF recording, and AI-powered verification. Use when testing UI features or validating work against acceptance criteria.\",\n      \"path\": \"skills/uat-tester.md\",\n      \"triggers\": [\"test the UI\", \"UAT\", \"acceptance testing\", \"verify the feature\", \"visual testing\"]\n    },\n    {\n      \"name\": \"plan-to-policy\",\n      \"description\": \"Convert a Claude plan file into a signed feature policy with AI evaluators. Creates per-feature acceptance criteria policies (distinct from long-lived infrastructure policies).\",\n      \"path\": \"skills/plan-to-policy.md\",\n      \"triggers\": [\"plan to policy\", \"create policy from plan\", \"generate policy\", \"convert plan\", \"feature policy\"]\n    }\n  ],\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/hooks/block-key-access.sh\"\n          },\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/hooks/verify-before-push.sh\"\n          }\n        ]\n      }\n    ],\n    \"Stop\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/hooks/stop-hook.sh\"\n          }\n        ]\n      }\n    ]\n  },\n  \"mcpServers\": {\n    \"ai-notary\": {\n      \"command\": \"ai-notary\",\n      \"args\": [\"--attestation-dir=/tmp/ai-attestations\"],\n      \"env\": {\n        \"AI_NOTARY_ATTESTATION_DIR\": \"/tmp/ai-attestations\"\n      }\n    }\n  }\n}\n",
        "README.md": "# ai-notary\n\n**Cryptographic proof that AI actually ran your validation commands.**\n\n## Why This Exists\n\nAI assistants like Claude can run `npm test` and tell you it passed. But did it? You have no proof. The AI could:\n- Skip expensive tests and claim they passed\n- Run a subset and report success\n- Simply lie about the output\n\n**ai-notary forces the AI to prove it ran commands.** The proof is cryptographic - the AI literally cannot fake it.\n\n### The Key Insight\n\nThe AI **cannot complete browser-based authentication**. We exploit this:\n\n1. AI runs commands → creates cryptographic attestations (automatic)\n2. Human signs policy → requires browser OIDC login (AI can't do this)\n3. AI tries to push → blocked unless attestations verify against human-signed policy\n\n**Result:** AI must actually run the commands. No shortcuts. No lies.\n\n## Quickstart for Claude\n\n### 1. Install the plugin\n\n```\n/plugin install nkennedy-personal/witness-signer\n```\n\n### 2. One-Time Setup: Create and sign a policy\n\n**Do this once per project.** The policy defines what validation steps are required.\n\n```bash\n# Create and sign in one step (opens browser for OIDC)\nai-notary policy create \\\n  --steps=lint,test,build \\\n  --keyless \\\n  -o policy-signed.json\n\n# Commit the signed policy to your repo\ngit add policy-signed.json && git commit -m \"Add attestation policy\"\n```\n\nOr create from existing attestations:\n```bash\n# After running commands with attestations...\nai-notary policy create \\\n  --from-tree=$(git rev-parse HEAD^{tree}) \\\n  --keyless \\\n  -o policy-signed.json\n```\n\n**The policy is long-lived.** You only recreate it when adding/removing required steps.\n\n### 3. Every Push: Run commands and verify\n\nTell Claude to run your validation commands:\n\n```\nRun lint, test, and build with attestations\n```\n\nClaude will use the MCP bash tool:\n```json\n{\"command\": \"npm run lint\", \"attest\": true, \"step\": \"lint\"}\n{\"command\": \"npm test\", \"attest\": true, \"step\": \"test\"}\n{\"command\": \"npm run build\", \"attest\": true, \"step\": \"build\"}\n```\n\n### 4. Push succeeds if attestations satisfy policy\n\n```\n> git push\n✓ Verification passed (attestations match policy)\n→ Push succeeded\n```\n\n**If Claude skipped any steps, push is blocked.** No new policy needed - just run the missing steps.\n\n## Understanding the Workflow\n\nSee [docs/mental-model.md](docs/mental-model.md) for a detailed explanation of:\n- When to create attestations (daily development)\n- When to create policies (admin setup)\n- Trust model and security guarantees\n\n## Two Types of Policies\n\n### Infrastructure Policies (Set Once)\n\nQuality gates for all code changes:\n- Build passes\n- Linting passes\n- Tests pass\n- Security scans clean\n\n```bash\n# Create once per project\nai-notary policy create \\\n  --steps=build,lint,test \\\n  --keyless -o policy-signed.json\n```\n\n### Feature Policies (Per Feature)\n\nAcceptance criteria for specific features:\n- UAT screenshots show expected behavior\n- API contracts verified\n- Requirements from ticket satisfied\n\n```bash\n# Create per feature (or use /plan-to-policy skill)\nai-notary policy create \\\n  --steps=uat-search \\\n  --add-ai-policy='step=uat-search,name=verify,prompt=\"PASS if search works\"' \\\n  --keyless -o policies/feature-search.json\n```\n\n### Verification Combines Both\n\n```bash\n# All policies in policies/ dir must pass\nai-notary verify --policy-dir=policies/\n\n# Or explicitly list policies\nai-notary verify \\\n  --policy=policy-signed.json \\\n  --policy=policies/feature-search.json\n```\n\nSee [Two-Tier Policy Architecture](docs/two-tier-policies.md) for more details.\n\n## How It Works\n\n```\n┌─────────────────────────────────────────────────────────────────┐\n│  AI runs: npm test                                              │\n│           ↓                                                     │\n│  MCP server creates attestation (cryptographically signed)      │\n│           ↓                                                     │\n│  /tmp/ai-attestations/<tree-hash>/test.json                     │\n└─────────────────────────────────────────────────────────────────┘\n                              ↓\n┌─────────────────────────────────────────────────────────────────┐\n│  HUMAN creates policy from attestations                         │\n│  HUMAN signs policy via Sigstore (browser OIDC)                 │\n│           ↓                                                     │\n│  AI CANNOT complete browser auth → cannot forge policies        │\n└─────────────────────────────────────────────────────────────────┘\n                              ↓\n┌─────────────────────────────────────────────────────────────────┐\n│  AI tries: git push                                             │\n│           ↓                                                     │\n│  Hook checks:                                                   │\n│    ✓ Attestations exist for this tree hash?                     │\n│    ✓ Policy exists and is signed by human?                      │\n│    ✓ Attestations satisfy policy requirements?                  │\n│           ↓                                                     │\n│  All pass → push allowed                                        │\n│  Any fail → BLOCKED                                             │\n└─────────────────────────────────────────────────────────────────┘\n```\n\n## Security Properties\n\n| Property | Enforcement |\n|----------|-------------|\n| AI can't skip tests | Hook blocks push without attestations |\n| AI can't forge attestations | Cryptographic signatures |\n| AI can't forge policies | Browser OIDC required (AI can't) |\n| AI can't push old code | Attestations bound to git tree hash |\n| Tamper-evident | Any modification breaks signatures |\n\n## CLI Reference\n\n### Create attestations (via MCP)\n\nThe AI uses the MCP bash tool:\n```json\n{\n  \"command\": \"npm test\",\n  \"attest\": true,\n  \"step\": \"test\"\n}\n```\n\n### Create policy from attestations\n\n```bash\n# Creates policy from existing attestations and signs it\nai-notary policy create \\\n  --from-tree=$(git rev-parse HEAD^{tree}) \\\n  --keyless \\\n  -o policy-signed.json\n```\n\n### Sign policy (human only)\n\n```bash\nai-notary policy sign --keyless policy.json -o policy-signed.json\n# Opens browser for Sigstore OIDC authentication\n```\n\n### Verify attestations\n\n```bash\nai-notary verify --policy=policy-signed.json\n```\n\n### Inspect policy requirements\n\n```bash\nai-notary policy inspect --policy=policy-signed.json\n# Shows required steps, attestation types, rego rules\n```\n\n### Validate before pushing (dry-run)\n\n```bash\nai-notary policy validate\n# Shows what would pass/fail without blocking\n# Helpful for debugging verification issues\n```\n\n### Check status\n\n```bash\nai-notary status\n# Shows attestations for current tree, policy state\n```\n\n### Run end-to-end test\n\n```bash\nai-notary test --verbose\n```\n\n## Environment Variables\n\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `AI_NOTARY_KEY` | Auto-discovered | Signing key path |\n| `AI_NOTARY_CA` | Auto-discovered | CA certificate path |\n| `AI_NOTARY_ATTESTATION_DIR` | `~/.ai-notary/attestations` | Attestation output directory |\n| `WITNESS_POLICY` | Auto-discovered | Policy file path (searches `policy-signed.json`, etc.) |\n| `WITNESS_PUBLIC_KEY` | None | Public key for policy signature verification |\n\n**Auto-discovery priority for attestation directory:**\n1. `.ai-notary/attestation-dir` file in repo root\n2. `AI_NOTARY_ATTESTATION_DIR` environment variable\n3. Default: `~/.ai-notary/attestations`\n\n## Repo-Namespaced Keys\n\nBy default, keys are global (`~/.ai-notary/keys/ca/`). For multi-repo setups, you can namespace keys per repository:\n\n```bash\n# Generate repo-specific keys\nai-notary init repo\n```\n\nThis creates:\n```\nrepo/\n└── .ai-notary/\n    └── key-id                    # Commit this! Points to the key\n\n~/.ai-notary/keys/\n└── <key-id>/                     # Private key stays local\n    ├── signer-key.pem\n    └── signer-pub.pem\n```\n\n**Key discovery priority:**\n1. `.ai-notary/key-id` in repo root → use repo-specific key\n2. Fall back to global `~/.ai-notary/keys/ca/`\n\n**Benefits:**\n- Different repos can have different signing keys\n- Isolated trust boundaries between projects\n- Key ID tracked in git, private key stays external\n- Collaborators know which key to use\n\n**After running `init repo`:**\n1. Commit `.ai-notary/key-id` to your repo\n2. Re-create and sign your policy (one time)\n3. Share the private key securely with collaborators who create attestations\n\n## Manual Installation\n\n```bash\n# Install binary\ngo install github.com/testifysec/ai-notary/cmd/ai-notary@latest\n\n# Or build from source\ngo build -o ai-notary ./cmd/ai-notary\n\n# Initialize (creates CA and signing keys)\nai-notary init wizard \\\n  --keys=~/.ai-notary/keys \\\n  --attestations=/tmp/ai-attestations \\\n  -o ~/.ai-notary/config.json\n\n# Install git hook\nai-notary init hook\n```\n\n## Advanced: Separate User Setup\n\nFor production, run the MCP server as a separate user:\n\n```bash\nsudo ./scripts/bootstrap-secure.sh\n```\n\nThis creates:\n- `witness-signer` user\n- Keys owned by that user (mode 600)\n- Systemd/launchd service\n\nThe AI cannot read the signing key (wrong user) and must go through the MCP server.\n\n## License\n\nCommercial - All Rights Reserved. Copyright 2026 TestifySec, Inc.\n"
      },
      "plugins": [
        {
          "name": "ai-notary",
          "source": {
            "source": "github",
            "repo": "testifysec/ai-notary-daemon"
          },
          "description": "AI command attestation with two-tier policy model: infrastructure policies + feature policies with AI evaluators",
          "version": "0.2.0",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add testifysec/witness-signer-daemon",
            "/plugin install ai-notary@ai-notary-local"
          ]
        }
      ]
    }
  ]
}