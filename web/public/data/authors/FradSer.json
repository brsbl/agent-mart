{
  "author": {
    "id": "FradSer",
    "display_name": " Frad LEE",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/1439628?v=4",
    "url": "https://github.com/FradSer",
    "bio": "Designer who codes, with a focus on XR and AI.",
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 10,
      "total_commands": 2,
      "total_skills": 24,
      "total_stars": 207,
      "total_forks": 17
    }
  },
  "marketplaces": [
    {
      "name": "frad-dotclaude",
      "version": null,
      "description": "Frad's Claude Code plugin marketplace featuring specialized agents and workflow automation",
      "owner_info": {
        "name": "Frad LEE",
        "email": "fradser@gmail.com"
      },
      "keywords": [],
      "repo_full_name": "FradSer/dotclaude",
      "repo_url": "https://github.com/FradSer/dotclaude",
      "repo_description": "A comprehensive development environment with specialized AI agents for code review, security analysis, and technical leadership.",
      "homepage": "https://frad.me",
      "signals": {
        "stars": 207,
        "forks": 17,
        "pushed_at": "2026-01-29T11:40:31Z",
        "created_at": "2025-08-04T17:29:10Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 4268
        },
        {
          "path": "claude-config",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-config/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-config/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 472
        },
        {
          "path": "claude-config/README.md",
          "type": "blob",
          "size": 4787
        },
        {
          "path": "claude-config/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-config/skills/init-config",
          "type": "tree",
          "size": null
        },
        {
          "path": "claude-config/skills/init-config/SKILL.md",
          "type": "blob",
          "size": 5906
        },
        {
          "path": "git",
          "type": "tree",
          "size": null
        },
        {
          "path": "git/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "git/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 755
        },
        {
          "path": "git/README.md",
          "type": "blob",
          "size": 4163
        },
        {
          "path": "git/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "git/skills/commit-and-push",
          "type": "tree",
          "size": null
        },
        {
          "path": "git/skills/commit-and-push/SKILL.md",
          "type": "blob",
          "size": 564
        },
        {
          "path": "git/skills/commit",
          "type": "tree",
          "size": null
        },
        {
          "path": "git/skills/commit/SKILL.md",
          "type": "blob",
          "size": 3121
        },
        {
          "path": "git/skills/config-git",
          "type": "tree",
          "size": null
        },
        {
          "path": "git/skills/config-git/SKILL.md",
          "type": "blob",
          "size": 3136
        },
        {
          "path": "git/skills/update-gitignore",
          "type": "tree",
          "size": null
        },
        {
          "path": "git/skills/update-gitignore/SKILL.md",
          "type": "blob",
          "size": 1085
        },
        {
          "path": "gitflow",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 561
        },
        {
          "path": "gitflow/README.md",
          "type": "blob",
          "size": 7088
        },
        {
          "path": "gitflow/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/finish-feature",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/finish-feature/SKILL.md",
          "type": "blob",
          "size": 1564
        },
        {
          "path": "gitflow/skills/finish-hotfix",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/finish-hotfix/SKILL.md",
          "type": "blob",
          "size": 1720
        },
        {
          "path": "gitflow/skills/finish-release",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/finish-release/SKILL.md",
          "type": "blob",
          "size": 2052
        },
        {
          "path": "gitflow/skills/gitflow-workflow",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/gitflow-workflow/SKILL.md",
          "type": "blob",
          "size": 3403
        },
        {
          "path": "gitflow/skills/gitflow-workflow/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/gitflow-workflow/references/commands-core.md",
          "type": "blob",
          "size": 3145
        },
        {
          "path": "gitflow/skills/gitflow-workflow/references/commands-topic.md",
          "type": "blob",
          "size": 2633
        },
        {
          "path": "gitflow/skills/gitflow-workflow/references/context-gathering.md",
          "type": "blob",
          "size": 1474
        },
        {
          "path": "gitflow/skills/gitflow-workflow/references/naming-rules.md",
          "type": "blob",
          "size": 1007
        },
        {
          "path": "gitflow/skills/gitflow-workflow/references/versioning-and-tags.md",
          "type": "blob",
          "size": 1326
        },
        {
          "path": "gitflow/skills/gitflow-workflow/references/workflow-presets.md",
          "type": "blob",
          "size": 1046
        },
        {
          "path": "gitflow/skills/start-feature",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/start-feature/SKILL.md",
          "type": "blob",
          "size": 823
        },
        {
          "path": "gitflow/skills/start-hotfix",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/start-hotfix/SKILL.md",
          "type": "blob",
          "size": 947
        },
        {
          "path": "gitflow/skills/start-release",
          "type": "tree",
          "size": null
        },
        {
          "path": "gitflow/skills/start-release/SKILL.md",
          "type": "blob",
          "size": 1403
        },
        {
          "path": "github",
          "type": "tree",
          "size": null
        },
        {
          "path": "github/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "github/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 419
        },
        {
          "path": "github/README.md",
          "type": "blob",
          "size": 11800
        },
        {
          "path": "github/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "github/skills/create-issues",
          "type": "tree",
          "size": null
        },
        {
          "path": "github/skills/create-issues/SKILL.md",
          "type": "blob",
          "size": 4254
        },
        {
          "path": "github/skills/create-pr",
          "type": "tree",
          "size": null
        },
        {
          "path": "github/skills/create-pr/SKILL.md",
          "type": "blob",
          "size": 7409
        },
        {
          "path": "github/skills/resolve-issues",
          "type": "tree",
          "size": null
        },
        {
          "path": "github/skills/resolve-issues/SKILL.md",
          "type": "blob",
          "size": 3506
        },
        {
          "path": "office",
          "type": "tree",
          "size": null
        },
        {
          "path": "office/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "office/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 465
        },
        {
          "path": "office/README.md",
          "type": "blob",
          "size": 4161
        },
        {
          "path": "office/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "office/skills/agent-browser",
          "type": "tree",
          "size": null
        },
        {
          "path": "office/skills/agent-browser/SKILL.md",
          "type": "blob",
          "size": 12520
        },
        {
          "path": "office/skills/agent-browser/SYNC.md",
          "type": "blob",
          "size": 1161
        },
        {
          "path": "office/skills/agent-browser/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "office/skills/agent-browser/references/authentication.md",
          "type": "blob",
          "size": 4443
        },
        {
          "path": "office/skills/agent-browser/references/proxy-support.md",
          "type": "blob",
          "size": 4265
        },
        {
          "path": "office/skills/agent-browser/references/session-management.md",
          "type": "blob",
          "size": 3894
        },
        {
          "path": "office/skills/agent-browser/references/snapshot-refs.md",
          "type": "blob",
          "size": 4108
        },
        {
          "path": "office/skills/agent-browser/references/video-recording.md",
          "type": "blob",
          "size": 3246
        },
        {
          "path": "office/skills/patent-architect",
          "type": "tree",
          "size": null
        },
        {
          "path": "office/skills/patent-architect/SKILL.md",
          "type": "blob",
          "size": 6292
        },
        {
          "path": "office/skills/patent-architect/examples.md",
          "type": "blob",
          "size": 7964
        },
        {
          "path": "office/skills/patent-architect/reference.md",
          "type": "blob",
          "size": 4676
        },
        {
          "path": "office/skills/patent-architect/template.md",
          "type": "blob",
          "size": 1755
        },
        {
          "path": "plugin-optimizer",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugin-optimizer/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugin-optimizer/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 454
        },
        {
          "path": "plugin-optimizer/README.md",
          "type": "blob",
          "size": 5503
        },
        {
          "path": "plugin-optimizer/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugin-optimizer/agents/plugin-optimizer.md",
          "type": "blob",
          "size": 5751
        },
        {
          "path": "plugin-optimizer/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugin-optimizer/skills/optimize-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugin-optimizer/skills/optimize-plugin/SKILL.md",
          "type": "blob",
          "size": 10551
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/SKILL.md",
          "type": "blob",
          "size": 5523
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/cli-commands.md",
          "type": "blob",
          "size": 3302
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/components",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/components/agents.md",
          "type": "blob",
          "size": 3277
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/components/commands.md",
          "type": "blob",
          "size": 2806
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/components/hooks.md",
          "type": "blob",
          "size": 2743
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/components/lsp-servers.md",
          "type": "blob",
          "size": 3789
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/components/mcp-servers.md",
          "type": "blob",
          "size": 1003
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/components/skills.md",
          "type": "blob",
          "size": 6902
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/debugging.md",
          "type": "blob",
          "size": 5201
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/directory-structure.md",
          "type": "blob",
          "size": 3479
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/manifest-schema.md",
          "type": "blob",
          "size": 9089
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/mcp-patterns.md",
          "type": "blob",
          "size": 3514
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/rfc-2119.md",
          "type": "blob",
          "size": 3305
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/todowrite-usage.md",
          "type": "blob",
          "size": 3165
        },
        {
          "path": "plugin-optimizer/skills/plugin-best-practices/references/tool-invocations.md",
          "type": "blob",
          "size": 2884
        },
        {
          "path": "refactor",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 537
        },
        {
          "path": "refactor/README.md",
          "type": "blob",
          "size": 5755
        },
        {
          "path": "refactor/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/agents/code-simplifier.md",
          "type": "blob",
          "size": 4319
        },
        {
          "path": "refactor/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/skills/best-practices",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/skills/best-practices/SKILL.md",
          "type": "blob",
          "size": 5688
        },
        {
          "path": "refactor/skills/best-practices/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/skills/best-practices/references/go.md",
          "type": "blob",
          "size": 10002
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/INDEX.md",
          "type": "blob",
          "size": 9603
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/_sections.md",
          "type": "blob",
          "size": 1554
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/_template.md",
          "type": "blob",
          "size": 631
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/advanced-event-handler-refs.md",
          "type": "blob",
          "size": 1483
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/advanced-use-latest.md",
          "type": "blob",
          "size": 1197
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/async-api-routes.md",
          "type": "blob",
          "size": 1125
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/async-defer-await.md",
          "type": "blob",
          "size": 2028
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/async-dependencies.md",
          "type": "blob",
          "size": 942
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/async-parallel.md",
          "type": "blob",
          "size": 654
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/async-suspense-boundaries.md",
          "type": "blob",
          "size": 2510
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/bundle-barrel-imports.md",
          "type": "blob",
          "size": 2370
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/bundle-conditional.md",
          "type": "blob",
          "size": 949
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/bundle-defer-third-party.md",
          "type": "blob",
          "size": 920
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/bundle-dynamic-imports.md",
          "type": "blob",
          "size": 791
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/bundle-preload.md",
          "type": "blob",
          "size": 1149
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/client-event-listeners.md",
          "type": "blob",
          "size": 1969
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/client-localstorage-schema.md",
          "type": "blob",
          "size": 1950
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/client-passive-event-listeners.md",
          "type": "blob",
          "size": 1644
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/client-swr-dedup.md",
          "type": "blob",
          "size": 1159
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-batch-dom-css.md",
          "type": "blob",
          "size": 1631
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-cache-function-results.md",
          "type": "blob",
          "size": 1949
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-cache-property-access.md",
          "type": "blob",
          "size": 532
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-cache-storage.md",
          "type": "blob",
          "size": 1651
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-combine-iterations.md",
          "type": "blob",
          "size": 753
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-early-exit.md",
          "type": "blob",
          "size": 1133
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-hoist-regexp.md",
          "type": "blob",
          "size": 1028
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-index-maps.md",
          "type": "blob",
          "size": 837
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-length-check-first.md",
          "type": "blob",
          "size": 1747
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-min-max-loop.md",
          "type": "blob",
          "size": 2290
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-set-map-lookups.md",
          "type": "blob",
          "size": 532
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/js-tosorted-immutable.md",
          "type": "blob",
          "size": 1782
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rendering-activity.md",
          "type": "blob",
          "size": 564
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rendering-animate-svg-wrapper.md",
          "type": "blob",
          "size": 1185
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rendering-conditional-render.md",
          "type": "blob",
          "size": 980
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rendering-content-visibility.md",
          "type": "blob",
          "size": 815
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rendering-hoist-jsx.md",
          "type": "blob",
          "size": 1039
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rendering-hydration-no-flicker.md",
          "type": "blob",
          "size": 2308
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rendering-svg-precision.md",
          "type": "blob",
          "size": 588
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rerender-defer-reads.md",
          "type": "blob",
          "size": 973
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rerender-dependencies.md",
          "type": "blob",
          "size": 824
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rerender-derived-state.md",
          "type": "blob",
          "size": 728
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rerender-functional-setstate.md",
          "type": "blob",
          "size": 2968
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rerender-lazy-state-init.md",
          "type": "blob",
          "size": 2016
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rerender-memo.md",
          "type": "blob",
          "size": 1148
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/rerender-transitions.md",
          "type": "blob",
          "size": 1055
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/server-after-nonblocking.md",
          "type": "blob",
          "size": 2012
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/server-cache-lru.md",
          "type": "blob",
          "size": 1353
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/server-cache-react.md",
          "type": "blob",
          "size": 2228
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/server-parallel-fetching.md",
          "type": "blob",
          "size": 1554
        },
        {
          "path": "refactor/skills/best-practices/references/nextjs/server-serialization.md",
          "type": "blob",
          "size": 996
        },
        {
          "path": "refactor/skills/best-practices/references/python.md",
          "type": "blob",
          "size": 9099
        },
        {
          "path": "refactor/skills/best-practices/references/swift.md",
          "type": "blob",
          "size": 13253
        },
        {
          "path": "refactor/skills/best-practices/references/typescript.md",
          "type": "blob",
          "size": 7125
        },
        {
          "path": "refactor/skills/best-practices/references/universal.md",
          "type": "blob",
          "size": 6169
        },
        {
          "path": "refactor/skills/refactor-project",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/skills/refactor-project/SKILL.md",
          "type": "blob",
          "size": 3666
        },
        {
          "path": "refactor/skills/refactor",
          "type": "tree",
          "size": null
        },
        {
          "path": "refactor/skills/refactor/SKILL.md",
          "type": "blob",
          "size": 4293
        },
        {
          "path": "review",
          "type": "tree",
          "size": null
        },
        {
          "path": "review/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "review/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 449
        },
        {
          "path": "review/README.md",
          "type": "blob",
          "size": 8312
        },
        {
          "path": "review/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "review/agents/code-reviewer.md",
          "type": "blob",
          "size": 3957
        },
        {
          "path": "review/agents/security-reviewer.md",
          "type": "blob",
          "size": 3675
        },
        {
          "path": "review/agents/tech-lead-reviewer.md",
          "type": "blob",
          "size": 1708
        },
        {
          "path": "review/agents/ux-reviewer.md",
          "type": "blob",
          "size": 1472
        },
        {
          "path": "review/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "review/skills/hierarchical",
          "type": "tree",
          "size": null
        },
        {
          "path": "review/skills/hierarchical/SKILL.md",
          "type": "blob",
          "size": 3151
        },
        {
          "path": "review/skills/quick",
          "type": "tree",
          "size": null
        },
        {
          "path": "review/skills/quick/SKILL.md",
          "type": "blob",
          "size": 2823
        },
        {
          "path": "review/skills/references",
          "type": "tree",
          "size": null
        },
        {
          "path": "review/skills/references/git-commit-conventions.md",
          "type": "blob",
          "size": 2289
        },
        {
          "path": "swiftui",
          "type": "tree",
          "size": null
        },
        {
          "path": "swiftui/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "swiftui/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 183
        },
        {
          "path": "swiftui/README.md",
          "type": "blob",
          "size": 7542
        },
        {
          "path": "swiftui/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "swiftui/agents/swiftui-clean-architecture-reviewer.md",
          "type": "blob",
          "size": 5370
        },
        {
          "path": "utils",
          "type": "tree",
          "size": null
        },
        {
          "path": "utils/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "utils/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 188
        },
        {
          "path": "utils/README.md",
          "type": "blob",
          "size": 6668
        },
        {
          "path": "utils/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "utils/commands/continue.md",
          "type": "blob",
          "size": 281
        },
        {
          "path": "utils/commands/create-command.md",
          "type": "blob",
          "size": 3579
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"$schema\": \"https://anthropic.com/claude-code/marketplace.schema.json\",\n  \"name\": \"frad-dotclaude\",\n  \"description\": \"Frad's Claude Code plugin marketplace featuring specialized agents and workflow automation\",\n  \"owner\": {\n    \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"git\",\n      \"version\": \"0.3.1\",\n      \"description\": \"Conventional Git automation for commits and repository management\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./git\",\n      \"category\": \"development\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/git\"\n    },\n    {\n      \"name\": \"gitflow\",\n      \"version\": \"0.2.0\",\n      \"description\": \"GitFlow workflow automation for feature, hotfix, and release branches\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./gitflow\",\n      \"category\": \"development\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/gitflow\"\n    },\n    {\n      \"name\": \"claude-config\",\n      \"version\": \"1.2.0\",\n      \"description\": \"Generate AI assistant configurations with environment detection, TDD options, best practices research, and multi-file sync\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./claude-config\",\n      \"category\": \"productivity\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/claude-config\"\n    },\n    {\n      \"name\": \"github\",\n      \"version\": \"0.2.0\",\n      \"description\": \"GitHub project operations with quality gates\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./github\",\n      \"category\": \"productivity\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/github\"\n    },\n    {\n      \"name\": \"review\",\n      \"version\": \"0.2.0\",\n      \"description\": \"Multi-agent review system for enforcing high quality\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./review\",\n      \"category\": \"productivity\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/review\"\n    },\n    {\n      \"name\": \"swiftui\",\n      \"version\": \"0.1.0\",\n      \"description\": \"SwiftUI Clean Architecture reviewer.\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./swiftui\",\n      \"category\": \"development\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/swiftui\"\n    },\n    {\n      \"name\": \"utils\",\n      \"version\": \"0.1.0\",\n      \"description\": \"Utility commands for day-to-day automation.\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./utils\",\n      \"category\": \"productivity\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/utils\"\n    },\n    {\n      \"name\": \"office\",\n      \"version\": \"0.3.1\",\n      \"description\": \"Specialized Claude Skill for patent application generation and intellectual property workflows\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./office\",\n      \"category\": \"productivity\",\n      \"strict\": false,\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/office\"\n    },\n    {\n      \"name\": \"refactor\",\n      \"version\": \"1.3.1\",\n      \"description\": \"Agent and skills for code simplification and refactoring to improve code quality while preserving functionality\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./refactor\",\n      \"category\": \"development\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/refactor\"\n    },\n    {\n      \"name\": \"plugin-optimizer\",\n      \"version\": \"0.6.0\",\n      \"description\": \"Validates and optimizes Claude Code plugins against official best practices and file patterns\",\n      \"author\": {\n        \"name\": \"Frad LEE\",\n        \"email\": \"fradser@gmail.com\"\n      },\n      \"source\": \"./plugin-optimizer\",\n      \"category\": \"development\",\n      \"homepage\": \"https://github.com/FradSer/dotclaude/tree/main/plugin-optimizer\"\n    }\n  ]\n}\n",
        "claude-config/.claude-plugin/plugin.json": "{\n  \"name\": \"claude-config\",\n  \"version\": \"1.2.0\",\n  \"description\": \"Generate AI assistant configurations with environment detection, TDD options, best practices research, and multi-file sync\",\n  \"author\": {\n    \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"keywords\": [\n    \"configuration\",\n    \"setup\",\n    \"initialization\",\n    \"environment\",\n    \"TDD\",\n    \"best-practices\",\n    \"developer-profile\"\n  ],\n  \"commands\": [\n    \"./skills/init-config/\"\n  ]\n}",
        "claude-config/README.md": "# Claude Config Plugin\n\nA comprehensive Claude Code plugin to generate personalized AI assistant configurations with intelligent environment detection and advanced customization options.\n\n## Installation\n\n```bash\nclaude plugin install claude-config@frad-dotclaude\n```\n\n## Features\n\n- **AI-Driven Environment Detection**: Automatically detects installed languages and tools (Node.js, Python, Rust, Go, Java, Docker, etc.)\n- **TDD Flexibility**: Choose whether to include mandatory Test-Driven Development requirements\n- **Best Practices Research**: Optionally search for latest 2026 best practices and append summaries to your configuration\n- **Length Validation**: Ensures generated configuration meets optimal word count (1,500-3,000 words) for context efficiency\n- **Multi-file Sync**: Sync configurations to GEMINI.md and AGENTS.md with template-priority merge strategy\n- **Smart Merging**: Preserves unique user content while maintaining consistency across AI configurations\n- **Safe Operations**: Automatic backups before overwriting existing files\n\n## Usage\n\nRun the initialization command:\n\n```bash\n/init-config\n```\n\nThe command guides you through a 9-phase interactive workflow:\n\n1. **Environment Discovery** - Detects installed languages and tools\n2. **Developer Profile** - Captures name and email\n3. **TDD Preference** - Choose TDD inclusion\n4. **Technology Stack Selection** - Select tools and package managers\n5. **Best Practices Research** - Optional web search for 2026 best practices\n6. **Style Preference** - Choose emoji usage\n7. **Assembly & Generation** - Build final configuration\n8. **Length Validation** - Ensure optimal word count (1,500-3,000 words)\n9. **Write CLAUDE.md** - Save with comprehensive report\n\nFor detailed workflow steps, run `/init-config` and follow the interactive prompts.\n\n## Structure\n\n```\nclaude-config/\n├── .claude-plugin/\n│   └── plugin.json           # Plugin manifest\n├── skills/\n│   └── init-config/\n│       └── SKILL.md          # User-invocable skill with 9-phase workflow\n├── assets/\n│   ├── claude-template.md    # Base template with TDD\n│   └── claude-template-no-tdd.md  # Base template without TDD\n├── scripts/\n│   └── validate-length.sh    # Length validation utility\n└── README.md\n```\n\n## Configuration\n\n### Length Validation Ranges\n\nThe validation script uses these thresholds:\n- **Minimum**: 800 words\n- **Optimal Range**: 1,500-3,000 words\n- **Maximum**: 5,000 words\n\n## Best Practices\n\n1. **Progressive Workflow**: Each phase builds on previous results\n2. **User Control**: Always asks before making significant decisions\n3. **Validation**: Checks length before writing to ensure quality\n4. **Safety**: Always backups existing files before overwriting\n5. **Template-Priority Merge**: Maintains consistency while preserving unique content\n\n## Examples\n\n### Generated CLAUDE.md Structure\n\n```markdown\n# Claude Development Guidelines\n\n## Developer Profile\n- **Name**: Frad LEE\n- **Email**: fradlee@qq.com\n\n## Core Principles\n[TDD requirements if enabled]\n- MANDATORY Clean Architecture\n- Research-driven workflow\n\n## Documentation Standards\n...\n\n## Technology Stack\n\n### Node.js (pnpm)\n[AI-generated configuration]\n\n#### Latest Best Practices (2026)\n[Web search summary if enabled]\n\n### Python (uv)\n[AI-generated configuration]\n\n#### Latest Best Practices (2026)\n[Web search summary if enabled]\n```\n\n### Template-Priority Merge Example\n\n**Existing GEMINI.md**:\n```markdown\n## My Custom Section\nCustom content here\n\n## My Unique Workflow\nUser-specific workflow\n```\n\n**Result after sync**:\n- CLAUDE.md content (base + tech stacks)\n- `## My Custom Section` (preserved from GEMINI.md)\n- `## My Unique Workflow` (preserved from GEMINI.md)\n\n## Troubleshooting\n\n### Configuration Too Long\nIf you get a \"TOO_LONG\" warning:\n1. Choose \"Auto-trim\" to remove web search summaries first\n2. Or choose \"Manual review\" to select specific sections to remove\n\n### Validation Script Fails\nEnsure the script is executable:\n```bash\nchmod +x scripts/validate-length.sh\n```\n\n## Version History\n\n### 1.1.1\n- Added keywords for better plugin discoverability\n- Optimized README structure to reduce redundancy\n- Improved documentation clarity\n\n### 1.1.0\n- Enhanced multi-file sync capabilities\n\n### 1.0.0\n- Added TDD flexibility (include/exclude option)\n- Added web search integration for latest best practices\n- Added length validation with auto-trim options\n- Added multi-file sync (GEMINI.md, AGENTS.md)\n- Added template-priority merge strategy\n- Enhanced environment detection\n- Improved backup safety\n\n### 0.1.0\n- Initial release with basic template generation\n\n## License\n\nMIT License - see [LICENSE](LICENSE) file for details.\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n",
        "claude-config/skills/init-config/SKILL.md": "---\nname: init-config\ndescription: Generate $HOME/.claude/CLAUDE.md with AI-driven environment detection and advanced configuration options\nargument-hint: []\nuser-invocable: true\nallowed-tools:\n  # Core file and interaction tools\n  - Read\n  - Write\n  - TodoWrite\n  - AskUserQuestion\n  - WebSearch\n\n  # Bash: System commands\n  - Bash(*)\n---\n\nYou are an expert DevOps engineer tasked with generating personalized configuration files for AI development assistants.\n\n## Initialization\n1. **Track Progress**\n   - Use the **TodoWrite** tool to create a task list for all phases of this workflow.\n   - Update the status of tasks as you complete each phase.\n\n## Phase 1: Environment Discovery\nUnderstand the user's technology stack by detecting installed languages, tools, and package managers.\n\n1. **Detect Technologies and Package Managers**\n   - Detect installed languages (Node.js, Python, Rust, Go, Java, Docker, etc.)\n   - For languages with multiple package managers, detect all available options\n   - Store detected information for later selection\n\n## Phase 2: Developer Profile\nAsk for developer name and email using **AskUserQuestion** with 2 questions:\n\n- **Question 1**: \"What is your name?\"\n  - Header: \"Developer\"\n  - Option: `{\"label\": \"Skip name\", \"description\": \"Don't include name in configuration\"}`\n  - Note: User inputs custom name via automatic \"Other\" option (no additional placeholder needed)\n\n- **Question 2**: \"What is your email address?\"\n  - Header: \"Contact\"\n  - Option: `{\"label\": \"Skip email\", \"description\": \"Don't include email in configuration\"}`\n  - Note: User inputs custom email via automatic \"Other\" option (no additional placeholder needed)\n\nImportant: Only provide the \"Skip\" option. The \"Other\" option is automatically provided for direct text input.\n\n## Phase 3: TDD Preference\nAsk if TDD should be included using **AskUserQuestion**:\n\n- Header: \"TDD Mode\"\n- Question: \"Should the configuration include Test-Driven Development (TDD) requirements?\"\n- Options:\n  - `{\"label\": \"Include TDD (Recommended)\", \"description\": \"Add mandatory TDD workflow\"}`\n  - `{\"label\": \"Exclude TDD\", \"description\": \"Generate without TDD requirements\"}`\n\nSelect template based on answer:\n- Include TDD: `${CLAUDE_PLUGIN_ROOT}/assets/claude-template.md`\n- Exclude TDD: `${CLAUDE_PLUGIN_ROOT}/assets/claude-template-no-tdd.md`\n\n## Phase 4: Technology Stack & Package Manager Selection\n1. **Select Technology Stacks**\n   - Use **AskUserQuestion** with `multiSelect: true`\n   - Header: \"Tech Stack\"\n   - Question: \"Which technology stacks should be included?\"\n   - Dynamically generate options based on detected technologies\n   - Mark detected tools as \"Recommended\"\n\n2. **Select Package Managers** (if multiple detected for selected languages)\n   - For each language with multiple package managers, ask user preference\n   - **Node.js** options: npm, pnpm (Recommended), yarn, bun\n   - **Python** options: pip, uv (Recommended), poetry\n   - Only show detected package managers\n\n## Phase 5: Best Practices Research\nAsk if web search should be performed using **AskUserQuestion**:\n\n- Header: \"Research\"\n- Question: \"Search for latest best practices for selected technologies?\"\n- Options:\n  - `{\"label\": \"Search and append (Recommended)\", \"description\": \"Find 2026 best practices\"}`\n  - `{\"label\": \"Skip search\", \"description\": \"Use only base template\"}`\n\nIf enabled, search and extract 2-3 key sentences for each technology:\n- **Plain text only**: Extract descriptive sentences about best practices\n- **No code snippets**: Exclude bash commands, code examples, or command-line instructions\n- **No URLs**: Remove all links and references to external resources\n- Format as simple, readable paragraphs or bullet points\n\n## Phase 6: Style Preference\nAsk emoji preference using **AskUserQuestion**:\n\n- Header: \"Style\"\n- Question: \"Should emojis be used in the configuration files?\"\n- Options:\n  - `{\"label\": \"No Emojis (Recommended)\", \"description\": \"Professional, text-only formatting\"}`\n  - `{\"label\": \"Use Emojis\", \"description\": \"Add visual indicators using emojis\"}`\n\n## Phase 7: Assembly & Generation\n1. **Read selected template** from Phase 3\n\n2. **Prepare Developer Profile Section**\n   ```markdown\n   ## Developer Profile\n   - **Name**: [User's Name or \"Developer\"]\n   - **Email**: [User's Email or omit if skipped]\n   ```\n\n3. **Generate Tech Stack Sections**\n   - Generate configuration for each selected technology\n   - Use selected package managers in all examples\n   - Apply emoji preference\n   - Append web search summaries if enabled\n\n4. **Assemble Final Content**\n   - Combine: header + developer profile + base template + tech stack sections\n\n## Phase 8: Length Validation\n1. **Validate content length**\n   - Write assembled content to a temporary file\n   - Run validation script: `${CLAUDE_PLUGIN_ROOT}/scripts/validate-length.sh`\n\n2. **Handle results**:\n   - ACCEPTABLE/OPTIMAL: Proceed to Phase 9\n   - TOO_LONG/EXCESSIVE: Ask user via **AskUserQuestion**:\n     - Header: \"Length\"\n     - Question: \"Configuration exceeds best practice length. How to proceed?\"\n     - Options: Auto-trim / Keep as-is / Manual review\n   - TOO_SHORT: Show info and proceed\n\n## Phase 9: Write CLAUDE.md\n1. **Write final file to `$HOME/.claude/CLAUDE.md`**\n   - Check if `$HOME/.claude/CLAUDE.md` exists\n   - Backup to `$HOME/.claude/CLAUDE.md.bak` if needed\n   - Ensure directory `$HOME/.claude/` exists\n   - Write assembled content to `$HOME/.claude/CLAUDE.md`\n\n2. **Report summary**\n   - File location: `$HOME/.claude/CLAUDE.md`\n   - Backup location (if created)\n   - Developer info\n   - TDD mode\n   - Technology stacks with package managers\n   - Web search status\n   - Word count and validation status\n\n## Best Practices\n- Progressive workflow: Each phase builds on previous results\n- User control: Always ask before making significant decisions\n- Safety: Always backup existing files before overwriting\n",
        "git/.claude-plugin/plugin.json": "{\n  \"name\": \"git\",\n  \"version\": \"0.3.1\",\n  \"description\": \"Conventional Git automation and advanced repository management\",\n  \"author\": {\n    \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"license\": \"MIT\",\n  \"keywords\": [\"git\", \"conventional-commits\", \"automation\", \"workflow\", \"version-control\"],\n  \"commands\": [\n    \"./skills/commit/\",\n    \"./skills/commit-and-push/\",\n    \"./skills/config-git/\",\n    \"./skills/update-gitignore/\"\n  ],\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"once\": false,\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/validate-commit-pretool.sh\",\n            \"timeout\": 10\n          }\n        ]\n      }\n    ]\n  }\n}\n",
        "git/README.md": "# Git Plugin\n\nConventional Git automation and advanced repository management.\n\n## Installation\n\n```bash\nclaude plugin install git@frad-dotclaude\n```\n\n## Overview\n\nThis plugin provides automated Git commands that ensure:\n- **Atomic Commits**: Logical units of work are committed separately.\n- **Conventional Format**: Messages follow the conventional commits specification.\n- **Safety**: Quality gates and protections against committing secrets.\n- **Project Awareness**: Adapts to project-specific configurations.\n\n## Commands\n\n### `/commit`\nCreates atomic conventional commits by analyzing pending changes.\n\n**Features:**\n- **Safety Checks**: Detects sensitive files (.env, credentials, secrets), warns about large files (>1MB), and suggests breaking up commits >500 lines\n- Analyzes staged and unstaged changes\n- Identifies logical units of work\n- Generates concise, \"why\"-focused commit messages\n- Skips secrets and build artifacts automatically\n\n### `/commit-and-push`\nCreates atomic commits and pushes to the remote repository.\n\n**Features:**\n- All `/commit` features\n- Automatically sets upstream for new branches\n- Verifies push success\n\n### `/gitignore` [technologies...]\nCreates or updates `.gitignore` files.\n\n**Usage:**\n- `/gitignore` - Auto-detect project technologies\n- `/gitignore node react` - Add specific technologies\n\n**Features:**\n- Uses Toptal's API for comprehensive rules\n- Preserves existing custom rules\n- Auto-detects OS and project structure\n\n### `/config-git`\nInteractive git configuration setup.\n\n**Features:**\n- Verifies and sets user.name and user.email\n- Analyzes project structure and commit history\n- Generates project-specific scopes and conventions\n- Creates `.claude/git.local.md` configuration file\n\n## Skills\n\nThis plugin provides 4 user-invocable skills:\n\n### `/commit`\nCreates atomic conventional commits following Commitizen style.\n- Validates against conventional commits specification v1.0.0\n- Enforces lowercase descriptions and imperative mood\n- Requires bullet-point body format\n\n### `/commit-and-push`\nCreates atomic commits and pushes to remote repository.\n- All `/commit` features\n- Automatic upstream branch configuration\n\n### `/config-git`\nInteractive configuration setup for project-specific Git conventions.\n- Analyzes project structure to suggest scopes\n- Generates `.claude/git.local.md` configuration\n- Validates user identity (name/email)\n\n### `/update-gitignore`\nCreates or updates `.gitignore` using Toptal's API.\n- Auto-detects technologies from project structure\n- Preserves custom rules when updating\n- Supports manual technology specification\n\n## Configuration\n\n### Auto-Configuration\n\nConfiguration is auto-generated on first use or manually via the `/config-git` command.\n\n### Manual Configuration\n\nYou can also manually create or edit `.claude/git.local.md` in your project root.\n\nSee [examples/git.local.md](examples/git.local.md) for configuration template.\n\n## Best Practices\n\n### Commit Guidelines\nFollows conventional commits specification.\n\n### Safety Protocol\nThis plugin adheres to strict safety protocols:\n- NEVER runs destructive commands (`force push`, `hard reset`).\n- NEVER commits detected secrets (`.env`, credentials).\n- ALWAYS creates new commits rather than amending pushed ones.\n\n## Hooks\n\nThis plugin uses **PreToolUse hooks** to validate commit messages BEFORE execution:\n\n- **Automatic Validation**: Every `git commit` command is validated before execution\n- **Format Checking**: Ensures conventional commit format compliance\n- **Early Prevention**: Blocks invalid commits before they are created\n- **No PostToolUse**: Validation happens pre-execution only (not after commit is created)\n\nThe PreToolUse hook validates:\n- Commit message format: `<type>[scope]: <description>`\n- Required bullet points in commit body\n- Lowercase descriptions\n- Title length (<50 characters)\n- Imperative mood usage\n\n## Troubleshooting\n\n- **Pre-commit hooks failed**: Fix the issues and run `/commit` again.\n- **Nothing to commit**: Verify changes are not ignored.\n- **Push failed**: Check remote permissions and branch protection rules.\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n\n## License\n\nMIT\n",
        "git/skills/commit-and-push/SKILL.md": "---\nname: commit-and-push\ndescription: Create atomic conventional git commit and push to remote\nuser-invocable: true\nallowed-tools: [\"Bash(git:*)\", \"Read\", \"Write\", \"Glob\", \"AskUserQuestion\", \"Skill\"]\nargument-hint: \"[no arguments needed]\"\nmodel: haiku\nversion: 0.1.0\n---\n\n## Your Task\n\n1. **Invoke the `/commit` command** to create all commits following conventional commits format.\n\n2. **Push to Remote**:\n   - Once all commits are created, push the current branch to the remote repository.\n   - Use `git push` (add `-u origin <branch>` if upstream is not set).\n",
        "git/skills/commit/SKILL.md": "---\nname: commit\ndescription: Create atomic conventional git commit following the Commitizen (cz) style and v1.0.0 specification\nuser-invocable: true\nallowed-tools: [\"Bash(git:*)\", \"Read\", \"Write\", \"Glob\", \"AskUserQuestion\", \"Skill\"]\nmodel: haiku\nversion: 0.1.0\n---\n\n## Conventional Commits Format\n\n```\n<type>[optional scope]: <description>\n\n[optional body]\n\n[optional footer(s)]\n```\n\n## Title Rules\n\n- ALL LOWERCASE (no capitalization in description)\n- <50 characters\n- Imperative mood (e.g., \"add\" not \"added\")\n- No period at end\n- Add \"!\" before \":\" for breaking changes (e.g., `feat!:`, `feat(api)!:`)\n\n**Common Types**: `feat`, `fix`, `docs`, `refactor`, `perf`, `test`, `chore`, `build`, `ci`, `style`\n\n## Body Rules (Mandatory)\n\n- **Body is required** - all commits must include bullet points\n- Blank line after title\n- ≤72 chars/line\n- **Bullet points**: use `- ` prefix, start with imperative verb (Add, Remove, Update, Fix)\n- **Optional paragraphs**: context before bullets, explanation after bullets\n\n**Valid formats**:\n```\n# Simple\n- Add feature X\n- Update component Y\n\n# With explanation\n- Add feature X\n- Update component Y\n\nThis improves performance by 50%.\n\n# With context\nPrevious implementation caused memory leaks.\n\n- Refactor memory management\n- Add cleanup handlers\n\nResolves memory issues in production.\n```\n\n## Footer (Optional)\n\nBlank line after body, then optionally add footers:\n\n- Issue references: `Closes #123`, `Fixes #456`\n- Breaking changes: `BREAKING CHANGE: <description>`\n- Co-authorship attribution: `Co-Authored-By: Name <email>`\n\n**Example commit message:**\n```\nfeat(auth): add oauth login flow\n\n- Add Google OAuth 2.0 integration\n- Implement callback endpoint handler\n- Update session management\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\n```\n\n## Your Task\n\n1. **Verify configuration exists**: Check if `.claude/git.local.md` exists. If NOT found, invoke `/config-git` to set up project-specific settings.\n\n2. **Perform safety checks** on pending changes:\n   - Detect sensitive files (credentials, secrets, .env files)\n   - Warn about large files (>1MB) and large commits (>500 lines)\n   - Request user confirmation if issues found\n\n3. **Analyze pending changes** to identify coherent logical units of work and infer the needed commit scope(s). If any inferred scope is not listed in `.claude/git.local.md`, invoke `/config-git` to update the configuration before proceeding.\n\n4. **For each logical unit**:\n   a. Draft the commit message following the Conventional Commits format above\n   b. **Validate the message** against the Title Rules and Body Rules:\n      - Title: ALL LOWERCASE, <50 characters, imperative mood, no period at end\n      - Body: Required; must include at least one `- ` bullet (imperative verb). May include context before bullets and summary/explanation after bullets. Blank line after title; ≤72 chars/line\n      - Footer: MUST include Co-Authored-By with the current model\n   c. Stage the relevant files\n   d. Create the commit with the validated message (including Co-Authored-By footer)\n\n5. **Repeat** until every change is committed.\n",
        "git/skills/config-git/SKILL.md": "---\nname: config-git\ndescription: Interactive git configuration setup\nuser-invocable: true\nallowed-tools: [\"Bash(git:*)\", \"Bash(ls:*)\", \"Bash(find:*)\", \"Read\", \"Write\", \"Glob\", \"AskUserQuestion\"]\nmodel: haiku\ncontext: fork\nversion: 0.1.0\n---\n\n# Interactive Git Configuration\n\nSet up Git user identity and create project-specific configuration file `.claude/git.local.md` with conventional commit scopes, types, and branch naming conventions.\n\nCurrent Git Config Context:\n!`git config --list --show-origin`\n\n---\n\n## Phase 1: Verify User Identity\n\n**Goal**: Ensure git user.name and user.email are configured\n\n**Actions**:\n1. Review the \"Current Git Config Context\" above\n2. Check if `user.name` and `user.email` are set\n3. If EITHER is missing, use `AskUserQuestion` to request the missing information\n4. Set the values globally (or locally if user specifies) using `git config`\n\n---\n\n## Phase 2: Analyze Project Context\n\n**Goal**: Understand project structure and existing commit patterns\n\n**Actions**:\n1. Run `ls -F` or `find . -maxdepth 2 -not -path '*/.*'` to detect project languages/frameworks\n2. Run `git log --format=\"%s\" -n 50` (if git repo exists) to analyze existing commit message patterns and scopes\n\n---\n\n## Phase 3: Determine Scopes\n\n**Goal**: Generate appropriate commit scopes based on project structure\n\n**CRITICAL - Scope Naming Rules**:\n- ALL scopes MUST be short (single words or abbreviations only)\n- Single words: use as-is (e.g., `api`, `ui`, `docs`)\n- Multi-word names: MUST convert to first letters (e.g., `plugin-optimizer` → `po`, `user-auth` → `ua`)\n- MUST NOT use full multi-word names like `plugin-optimizer` or `user-auth` as scopes\n\n**Actions**:\n1. Propose a list of commit scopes based on analysis\n2. Ensure all scopes follow the naming rules above\n3. Request user input ONLY if genuine ambiguity exists\n\n---\n\n## Phase 4: Generate Configuration File\n\n**Goal**: Create `.claude/git.local.md` with complete structure from example template\n\n**CRITICAL - Template Requirements**:\n- Use the ENTIRE example file structure as template\n- Preserve ALL sections from the example:\n  - YAML frontmatter with `scopes`, `types`, `branch_prefixes`, AND `gitignore`\n  - \"# Project-Specific Git Settings\" section\n  - \"## Usage\" section with all bullet points\n  - \"## Additional Guidelines\" section with all bullet points\n\n**Actions**:\n1. Read the example configuration file: `${CLAUDE_PLUGIN_ROOT}/examples/git.local.md`\n2. Replace the `scopes` list with determined short scopes\n3. Update `gitignore` technologies based on detected project languages/frameworks\n4. Keep `types` as standard conventional commit types (unless user requests changes)\n5. Keep `branch_prefixes` as shown in example (unless user requests changes)\n6. Create or overwrite `.claude/git.local.md` in the project root\n7. Read the file back to verify it matches the example's complete structure\n\n**Output**: `.claude/git.local.md` file with project-specific configuration\n\n---\n\n## Phase 5: Confirmation\n\n**Goal**: Inform user of successful configuration\n\n**Actions**:\n1. Confirm configuration is complete\n2. Show the location of the created file\n",
        "git/skills/update-gitignore/SKILL.md": "---\nname: update-gitignore\ndescription: Create or update .gitignore file\nuser-invocable: true\nallowed-tools: [\"Bash(curl:*)\", \"Bash(uname:*)\", \"Bash(git:*)\", \"Read\", \"Write\", \"Edit\", \"Glob\"]\nmodel: haiku\ncontext: fork\nargument-hint: [additional-technologies]\nversion: 0.1.0\n---\n\n## Context\n\n- Project guidelines: @CLAUDE.md\n- Operating system: !`uname -s`\n- Existing .gitignore status: !`test -f .gitignore && echo \".gitignore found\" || echo \".gitignore not found\"`\n- Project files: Analyze repository structure to detect technologies\n- Available templates: !`curl -sL https://www.toptal.com/developers/gitignore/api/list`\n\n## Requirements\n\n- Combine detected platforms and `$ARGUMENTS` into the generator request (e.g. `macos,node,docker`).\n- Preserve existing custom sections when updating `.gitignore`.\n- Present the resulting diff for confirmation.\n\n## Your Task\n\n1. Detect operating systems and technologies from context plus `$ARGUMENTS`.\n2. Generate or update `.gitignore` using the Toptal API while retaining custom rules.\n3. Show the repository changes to confirm the update.\n",
        "gitflow/.claude-plugin/plugin.json": "{\n  \"name\": \"gitflow\",\n  \"version\": \"0.3.0\",\n  \"description\": \"GitFlow workflow automation for feature, hotfix, and release branches\",\n  \"keywords\": [\"git\", \"gitflow\", \"workflow\", \"branching\", \"release-management\", \"version-control\"],\n  \"author\": {\n    \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"skills\": \"./skills/gitflow-workflow/\",\n  \"commands\": [\n    \"./skills/finish-feature/\",\n    \"./skills/finish-hotfix/\",\n    \"./skills/finish-release/\",\n    \"./skills/start-feature/\",\n    \"./skills/start-hotfix/\",\n    \"./skills/start-release/\"\n  ]\n}\n",
        "gitflow/README.md": "# GitFlow Plugin\n\nGitFlow workflow automation for feature, hotfix, and release branches with semantic versioning and conventional commits.\n\n## Installation\n\n```bash\nclaude plugin install gitflow@frad-dotclaude\n```\n\n## Overview\n\nThe GitFlow Plugin automates the GitFlow branching model, providing commands to start and finish feature, hotfix, and release branches. It ensures proper branch naming, merging, and tagging according to GitFlow conventions, with automatic versioning and changelog generation.\n\n## GitFlow Branch Model\n\nThree workflow presets are supported:\n\n| Workflow | Description |\n|----------|-------------|\n| **Classic GitFlow** | main + develop with feature/, release/, hotfix/ branches |\n| **GitHub Flow** | main with feature/ branches only |\n| **GitLab Flow** | production + staging + main with feature/, hotfix/ branches |\n\n## Commands\n\nAll commands use the `Skill` tool to load `gitflow-workflow` for GitFlow operations.\n\n### `/gitflow:start-feature`\n\nStart new feature branch from develop.\n\n| Field | Value |\n|-------|-------|\n| Model | `haiku` |\n| Allowed Tools | `Bash(git:*)`, `Read`, `Skill` |\n| Argument | `[feature-name]` |\n\n```bash\n/gitflow:start-feature user-authentication\n```\n\n---\n\n### `/gitflow:finish-feature`\n\nComplete and merge feature branch to develop.\n\n| Field | Value |\n|-------|-------|\n| Model | `haiku` |\n| Allowed Tools | `Bash(git:*)`, `Read`, `Skill` |\n| Argument | `[feature-name]` |\n\n```bash\n/gitflow:finish-feature\n```\n\n---\n\n### `/gitflow:start-hotfix`\n\nStart new hotfix branch from main.\n\n| Field | Value |\n|-------|-------|\n| Model | `haiku` |\n| Allowed Tools | `Bash(git:*)`, `Read`, `Write`, `Skill` |\n| Argument | `[hotfix-name]` |\n\n```bash\n/gitflow:start-hotfix critical-security-fix\n```\n\n---\n\n### `/gitflow:finish-hotfix`\n\nComplete hotfix by merging to main and develop with version tagging.\n\n| Field | Value |\n|-------|-------|\n| Model | `haiku` |\n| Allowed Tools | `Bash(git:*)`, `Read`, `Write`, `Skill` |\n| Argument | `[version]` |\n\n```bash\n/gitflow:finish-hotfix\n```\n\n---\n\n### `/gitflow:start-release`\n\nStart new release branch from develop.\n\n| Field | Value |\n|-------|-------|\n| Model | `haiku` |\n| Allowed Tools | `Bash(git:*)`, `Read`, `Write`, `Skill` |\n| Argument | `[version]` |\n\n```bash\n/gitflow:start-release v1.2.0\n# or auto-determine version\n/gitflow:start-release\n```\n\n---\n\n### `/gitflow:finish-release`\n\nComplete release by merging to main and develop with version tagging.\n\n| Field | Value |\n|-------|-------|\n| Model | `haiku` |\n| Allowed Tools | `Bash(git:*)`, `Read`, `Write`, `Skill` |\n\n```bash\n/gitflow:finish-release\n```\n\n## Skills\n\n### `gitflow-workflow`\n\nExpert in GitFlow branching model and semantic versioning, based on [git-flow-next](https://git-flow.sh/docs/).\n\n**Capabilities:**\n- GitFlow branch model (main, develop, feature, hotfix, release, support)\n- Workflow presets (Classic GitFlow, GitHub Flow, GitLab Flow)\n- Semantic version calculation from conventional commits\n- Branch naming validation and conventions\n- Merge strategies (merge, rebase, squash, --no-ff)\n- Version file updates and changelog generation\n- git-flow-next command compatibility\n\n**Reference Documentation:**\n- `references/commands-core.md` - git-flow-next core commands (init, config)\n- `references/commands-topic.md` - Topic branch commands (start, finish, etc.)\n- `references/context-gathering.md` - Pre-operation context requirements\n- `references/naming-rules.md` - Branch naming conventions\n- `references/versioning-and-tags.md` - Version management and tagging\n- `references/workflow-presets.md` - Workflow presets (Classic, GitHub, GitLab Flow)\n\n**External References:**\n- [git-flow-next Documentation](https://git-flow.sh/docs/)\n- [git-flow-next Commands](https://git-flow.sh/docs/commands/)\n- [git-flow-next Cheat Sheet](https://git-flow.sh/docs/cheat-sheet/)\n\n## Best Practices\n\n### Feature Development\n- Use `/gitflow:start-feature` for all new features\n- Keep features focused and short-lived (2-3 days max)\n- Commit atomic changes with conventional format\n- Run tests before finishing features\n\n### Hotfix Workflow\n- Use for urgent production fixes only\n- Scope limited to critical bugs\n- Patch version increment automatically\n- Merges to both main and develop\n\n### Release Process\n- Start when feature set is complete\n- Final testing and bug fixes on release branch\n- Never add new features to release branch\n- Auto-generates changelog from commits\n\n## Workflow Integration\n\n### Complete Workflow Examples\n\n#### Feature Development:\n```bash\n# Start feature\n/gitflow:start-feature user-authentication\n\n# Develop with conventional commits\n/git:commit\n/git:commit\n\n# Finish when complete\n/gitflow:finish-feature\n```\n\n#### Critical Hotfix:\n```bash\n# Start from production\n/gitflow:start-hotfix fix-payment-bug\n# Results in v1.2.3-patch.1\n\n# Fix and test\n/git:commit\n\n# Deploy to production\n/gitflow:finish-hotfix\n# Creates v1.2.4 release\n```\n\n#### Major Release:\n```bash\n# Start release preparation\n/gitflow:start-release\n# Auto-determines v1.2.0 from commits\n\n# Final testing and fixes\n/git:commit\n\n# Release to production\n/gitflow:finish-release\n# Creates v1.2.0 release\n```\n\n### Commit Format\n\nAll GitFlow commands follow conventional commit principles for commit message formatting. This ensures:\n- **Atomic commits**: One logical change per commit\n- **Conventional format**: `feat:`, `fix:`, `docs:`, `refactor:`, `test:`, `chore:`\n- **Proper structure**: Lowercase title (<50 characters), imperative mood, with `Co-Authored-By` footer\n\n### Version Tagging\n\n- Hotfixes: v1.2.3 → v1.2.4 (patch)\n- Releases: v1.1.0 → v1.2.0 (minor) or v2.0.0 (major)\n- Tags created on main branch merge\n- GitHub releases auto-generated\n\n## Requirements\n\n- **git-flow-next** must be installed ([installation guide](https://git-flow.sh/docs/installation/))\n  - macOS: `brew install gittower/tap/git-flow-next`\n  - Manual: Download from [releases page](https://github.com/gittower/git-flow-next/releases)\n- Git must be installed and configured\n- Repository must have `main` or `master` branch\n- Repository should have `develop` branch\n- All commits must follow conventional format\n\n## Troubleshooting\n\n### git-flow-next not installed\n\nIf `git flow` command fails:\n\n```bash\n# Check if installed\ngit flow version\n\n# If not found, install git-flow-next\n# macOS:\nbrew install gittower/tap/git-flow-next\n\n# Manual installation:\n# 1. Download from https://github.com/gittower/git-flow-next/releases\n# 2. Extract to PATH (e.g., /usr/local/bin/)\n# 3. Make executable: chmod +x /path/to/git-flow\n```\n\nSee [installation guide](https://git-flow.sh/docs/installation/) for detailed instructions.\n\n### Branch not found\n```bash\n# Create missing branches\ngit checkout -b develop\ngit checkout -b main  # or master\n```\n\n### Merge conflicts\n```bash\n# Resolve conflicts manually\n# Ensure branches are up-to-date\n# Consider rebasing feature branches\n```\n\n### Version calculation error\n```bash\n# Ensure conventional commits format\n# Tag previous releases properly\n# Manually specify version if needed\n```\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n",
        "gitflow/skills/finish-feature/SKILL.md": "---\nname: finish-feature\nallowed-tools: Bash(git:*), Read, Skill\ndescription: Complete and merge feature branch\nmodel: haiku\nargument-hint: [feature-name]\nuser-invocable: true\n---\n\n## Your Task\n\n1. **Load the `gitflow:gitflow-workflow` skill** using the `Skill` tool to access GitFlow workflow capabilities.\n2. Gather context: current branch, git status, recent commits.\n3. Normalize the provided feature name from `$ARGUMENTS` to `$FEATURE_NAME`:\n   - Strip a leading `feature/` prefix if present\n   - Convert to kebab-case (lowercase, hyphens)\n4. Validate branch follows `feature/*` convention and working tree is clean.\n5. Run tests if available. If tests fail, report the failures and exit without merging; the user must fix issues first.\n6. **Update CHANGELOG (Unreleased)**:\n   - Ensure changes are documented in the `[Unreleased]` section of `CHANGELOG.md` following `${CLAUDE_PLUGIN_ROOT}/examples/changelog.md`:\n     - Use standard Keep a Changelog sections (Added, Changed, Deprecated, Removed, Fixed, Security).\n     - Write entries in present/imperative tense using user-facing language.\n     - Include sufficient context to understand impact; merge repetitive items.\n   - Commit any CHANGELOG updates using conventional commit format and MUST include the `Co-Authored-By` footer.\n7. Identify target integration branch for the active workflow (often `develop`).\n8. Merge into the integration branch (often with `--no-ff`), then delete `feature/$FEATURE_NAME` locally and remotely. Skip deletion if the branch is shared or the user requests to keep it.\n",
        "gitflow/skills/finish-hotfix/SKILL.md": "---\nname: finish-hotfix\nallowed-tools: Bash(git:*), Read, Write, Skill\ndescription: Complete and merge hotfix branch\nmodel: haiku\nargument-hint: [version]\nuser-invocable: true\n---\n\n## Your Task\n\n1. **Load the `gitflow:gitflow-workflow` skill** using the `Skill` tool to access GitFlow workflow capabilities.\n2. Gather context: current branch, git status, recent commits, version files.\n3. Validate branch follows `hotfix/*` convention and working tree is clean.\n4. Run tests if available. If tests fail, report the failures and exit without merging; the user must fix issues first.\n5. Normalize the provided version from `$ARGUMENTS` to `$HOTFIX_VERSION`:\n   - Accept `v1.2.3` or `1.2.3`\n   - Normalize to `1.2.3` (and tag as `v$HOTFIX_VERSION` when tagging)\n6. **Update CHANGELOG**:\n   - Identify previous version tag.\n   - Collect commits since previous tag following the user-facing principle defined in the `gitflow-workflow` skill (include feat, fix, refactor, docs, perf, deprecate, remove, security; exclude chore, build, ci, test, merge commits).\n   - Update `CHANGELOG.md` (or create if missing) with the new version and date, following the format in `${CLAUDE_PLUGIN_ROOT}/examples/changelog.md`.\n   - Commit the updated `CHANGELOG.md` to the current hotfix branch using conventional commit format (e.g., `chore: update changelog for v$HOTFIX_VERSION`) and MUST include the `Co-Authored-By` footer.\n7. Merge into the production branch (often `main`/`production`), create the version tag, then propagate the changes to the integration branch (often `develop`/`main`), and push all changes.\n8. Delete the hotfix branch locally and remotely. Skip deletion if the branch is shared or the user requests to keep it.\n",
        "gitflow/skills/finish-release/SKILL.md": "---\nname: finish-release\nallowed-tools: Bash(git:*), Bash(gh:*), Read, Write, Skill\ndescription: Complete and merge release branch\nmodel: haiku\nargument-hint: [version]\nuser-invocable: true\n---\n\n## Your Task\n\n1. **Load the `gitflow:gitflow-workflow` skill** using the `Skill` tool to access GitFlow workflow capabilities.\n2. Gather context: current branch, git status, recent commits, version files.\n3. Validate branch follows `release/*` convention and working tree is clean.\n4. Run tests if available. If tests fail, report the failures and exit without merging; the user must fix issues first.\n5. Normalize the provided version from `$ARGUMENTS` to `$RELEASE_VERSION`:\n   - Accept `v1.2.3`, `1.2.3`, or `release/1.2.3`\n   - Normalize to `1.2.3` (and tag as `v$RELEASE_VERSION` when tagging)\n6. **Update CHANGELOG** (mandatory):\n   - Identify previous version tag.\n   - Collect commits since previous tag following the user-facing principle defined in the `gitflow-workflow` skill (include feat, fix, refactor, docs, perf, deprecate, remove, security; exclude chore, build, ci, test, merge commits).\n   - Update `CHANGELOG.md` (create if missing) with the new version and date, following the format in `${CLAUDE_PLUGIN_ROOT}/examples/changelog.md`.\n   - If `CHANGELOG.md` was manually updated during start-release, merge or reconcile entries while preserving manual curation.\n   - Commit the updated `CHANGELOG.md` to the current release branch using conventional commit format (e.g., `chore: update changelog for v$RELEASE_VERSION`) and MUST include the `Co-Authored-By` footer.\n7. Merge into `main` (often with `--no-ff`), create the version tag.\n8. Merge `main` back to `develop`, push all changes.\n9. Delete release branch locally and remotely. Skip deletion if the branch is shared or the user requests to keep it.\n10. **Publish GitHub Release**:\n   - Use the `gh` CLI to create the release using the version tag.\n   - `gh release create v$RELEASE_VERSION --title \"Release v$RELEASE_VERSION\" --notes \"<content from CHANGELOG for this version>\"`\n",
        "gitflow/skills/gitflow-workflow/SKILL.md": "---\nname: gitflow-workflow\ndescription: Use this skill for GitFlow tasks: starting/finishing features, releases, hotfixes; managing branches; versioning; or general GitFlow operations.\nuser-invocable: false\nallowed-tools: Read\nversion: 0.1.0\n---\n\n## Purpose\n\nAll detailed command manuals live under `./references/` and should be consulted when you need exact flags/options.\n\n## Required invariants (used by the 6 instruction-type skills)\n\n### Preflight\n\nBefore any start/finish operation:\n- Confirm working tree is clean (use `git status` to verify).\n- Identify current branch and verify the branch type matches the operation (`feature/*`, `hotfix/*`, `release/*`).\n- Determine the active workflow preset (Classic GitFlow vs GitHub Flow vs GitLab Flow) to identify correct base/target branches.\n\n### Branch naming\n\n- Use kebab-case and a strict prefix: `<type>/<kebab-case>` (e.g. `feature/user-authentication`).\n\n### Finish behavior\n\n- Prefer non-fast-forward merges when finishing (e.g. `--no-ff`) to preserve a visible integration history, unless the repo workflow config says otherwise.\n- Run tests if available before finishing; fix failures before merging.\n- After finishing hotfix/release, ensure the integration branch receives the changes (often merging back into `develop`).\n- Delete topic branches locally and remotely after finishing when policy allows.\n\n### Changelog generation\n\nWhen updating CHANGELOG.md during `finish-release` or `finish-hotfix` operations, follow these principles:\n\n**Core principle:** Include all commits that represent **user-facing changes** since the previous version tag. Exclude internal-only changes (build, CI, tooling) and administrative commits (merges, releases).\n\n**Note:** The `finish-feature` operation updates the `[Unreleased]` section without filtering, as features are already user-facing by nature.\n\n**Commit collection process for releases and hotfixes:**\n1. Identify the previous version tag (e.g., `v1.5.0`)\n2. Collect commits: `git log --oneline <previous-tag>..HEAD`\n3. Filter commits using conventional commit format, applying the user-facing principle:\n   - **Include**: Commits that affect end users, API consumers, or documented behavior (e.g., `feat`, `fix`, `refactor`, `docs`, `perf`, `deprecate`, `remove`, `security`)\n   - **Exclude**: Internal tooling (`chore`, `build`, `ci`), test-only changes (`test`), merge commits, release commits\n4. Map commit types to appropriate Keep a Changelog sections (`Added`, `Changed`, `Deprecated`, `Removed`, `Fixed`, `Security`)\n5. Format entries using present/imperative tense and user-facing language\n6. Merge repetitive items and include sufficient context to understand impact\n\nSee `${CLAUDE_PLUGIN_ROOT}/examples/changelog.md` for the standard format.\n\n## Minimal templates (what the 6 skills assume)\nThe operation-specific templates have been moved into the corresponding `start-*` / `finish-*` skills to keep those tasks self-contained.\n\n## Reference index\n\n- `./references/context-gathering.md`\n- `./references/naming-rules.md`\n- `./references/workflow-presets.md`\n- `./references/versioning-and-tags.md`\n- `./references/commands-core.md`\n- `./references/commands-topic.md`\n\n## External References\n\n- [git-flow-next Documentation](https://git-flow.sh/docs/)\n- [git-flow-next Commands](https://git-flow.sh/docs/commands/)\n- [git-flow-next Cheat Sheet](https://git-flow.sh/docs/cheat-sheet/)\n",
        "gitflow/skills/gitflow-workflow/references/commands-core.md": "# git-flow-next core commands\n\nThis reference contains the core commands used to initialize and configure git-flow-next.\n\n## Global options\n\n- `--verbose`, `-v`: enable verbose output\n- `--help`, `-h`: show help for any command\n\n## init\n\nInitialize git-flow configuration in the current Git repository.\n\nUsage:\n\n`git-flow init [--preset=preset] [--custom] [--defaults] [options]`\n\nOptions:\n\n- `--preset=preset`: apply a workflow preset (`classic`, `github`, `gitlab`)\n- `--custom`: enable custom configuration mode\n- `--defaults`, `-d`: use defaults without prompting\n- `--no-create-branches`: don’t create branches even if missing\n- `--main=name`: override main branch name (default: main)\n- `--develop=name`: override develop branch name (default: develop)\n- `--production=name`: override production branch name for GitLab flow (default: production)\n- `--staging=name`: override staging branch name for GitLab flow (default: staging)\n- `--feature=prefix`: override feature prefix (default: feature/)\n- `--bugfix=prefix`, `-b prefix`: override bugfix prefix (default: bugfix/)\n- `--release=prefix`, `-r prefix`: override release prefix (default: release/)\n- `--hotfix=prefix`, `-x prefix`: override hotfix prefix (default: hotfix/)\n- `--support=prefix`, `-s prefix`: override support prefix (default: support/)\n- `--tag=prefix`, `-t prefix`: override tag prefix (default: v)\n\n## config\n\nManage git-flow configuration for base branches and topic branch types.\n\nUsage:\n\n`git-flow config <command> [args] [options]`\n\nCommands:\n\n- `list`\n- `add base <name> [parent]`\n- `add topic <name> <parent>`\n- `edit base <name>`\n- `edit topic <name>`\n- `rename base <old-name> <new-name>`\n- `rename topic <old-name> <new-name>`\n- `delete base <name>`\n- `delete topic <name>`\n\nBase branch options:\n\n- `--upstream-strategy=strategy`: merge strategy when merging to parent (`merge`, `rebase`, `squash`)\n- `--downstream-strategy=strategy`: merge strategy when updating from parent (`merge`, `rebase`)\n- `--auto-update[=bool]`: auto-update from parent on finish (default: false)\n\nTopic branch options:\n\n- `--prefix=prefix`: branch name prefix (default: `name/`)\n- `--starting-point=branch`: branch to create from (defaults to parent)\n- `--upstream-strategy=strategy`\n- `--downstream-strategy=strategy`\n- `--tag[=bool]`: create tags on finish (default: false)\n\n## overview\n\nDisplay repository workflow overview showing current git-flow configuration and all active topic branches.\n\nUsage: `git-flow overview`\n\n## version\n\nShow version information for git-flow-next.\n\nUsage: `git-flow version`\n\n## completion\n\nGenerate shell completion script for bash, zsh, fish, or PowerShell.\n\nUsage: `git-flow completion [shell]`\n\nAvailable shells: `bash`, `zsh`, `fish`, `powershell`\n\n## Configuration namespace\n\ngit-flow-next stores settings under `gitflow.*` in Git config. Precedence is typically:\n\n1. Branch type defaults (`gitflow.branch.*`)\n2. Command overrides (`gitflow.type.command.*`)\n3. CLI flags (highest precedence)\n\n## git-flow-avh compatibility\n\ngit-flow-next can detect and translate git-flow-avh configuration at runtime without modifying existing settings.\n\n",
        "gitflow/skills/gitflow-workflow/references/commands-topic.md": "# git-flow-next topic branch commands\n\nTopic branch commands are dynamically generated from configuration. Default types include `feature`, `release`, `hotfix`, `support`, plus any custom types.\n\n## start\n\nCreate and checkout a new topic branch.\n\nUsage:\n\n`git-flow <topic> start <name> [base] [options]`\n\nOptions:\n\n- `--fetch`: fetch from remote before creating branch\n- `--no-fetch`: don’t fetch (default)\n\n## finish\n\nComplete a topic branch by merging it to its parent branch according to configured strategy.\n\nUsage:\n\n- `git-flow <topic> finish [name] [options]`\n- `git-flow finish [options]` (shorthand for current branch)\n\nOperation control:\n\n- `--continue`, `-c`: continue after resolving conflicts\n- `--abort`, `-a`: abort operation\n- `--force`, `-f`: force finish non-standard branch\n\nTag creation:\n\n- `--tag`: create a tag\n- `--notag`: don’t create a tag\n- `--sign`: sign the tag with GPG\n- `--signingkey <keyid>`: use a specific key\n- `--message`, `-m <message>`: tag message\n- `--tagname <name>`: custom tag name\n\nBranch retention:\n\n- `--keep`: keep topic branch after finishing\n- `--keepremote`: keep remote tracking branch\n- `--keeplocal`: keep local branch\n- `--force-delete`: force delete even if not fully merged\n\nMerge strategy control:\n\n- `--rebase`: rebase before merging\n- `--squash`: squash commits into one\n- `--squash-message <message>`: custom message for squash merge\n- `--no-rebase`: don’t rebase (use configured strategy)\n- `--no-squash`: keep individual commits\n- `--preserve-merges`: preserve merges during rebase\n- `--no-ff`: create merge commit even for fast-forward\n- `--ff`: allow fast-forward\n\n## publish\n\nPush a topic branch to remote.\n\nUsage:\n\n- `git-flow <topic> publish [name]`\n- `git-flow publish [name]` (shorthand for current branch)\n\n## list\n\nList existing topic branches.\n\nUsage: `git-flow <topic> list [pattern]`\n\n## update\n\nUpdate a topic branch from its parent.\n\nUsage:\n\n- `git-flow <topic> update [name]`\n- `git-flow update [name]` (shorthand)\n\n## delete\n\nDelete a topic branch.\n\nUsage:\n\n- `git-flow <topic> delete <name>`\n- `git-flow delete [name]` (shorthand)\n\n## rename\n\nRename a topic branch.\n\nUsage:\n\n- `git-flow <topic> rename <old-name> <new-name>`\n- `git-flow rename [new-name]` (shorthand)\n\n## checkout\n\nSwitch to a topic branch.\n\nUsage: `git-flow <topic> checkout <name|prefix>`\n\n## Shorthand commands\n\nThese work on the current branch or accept an optional branch name:\n\n- `git-flow delete [name]`\n- `git-flow update [name]`\n- `git-flow rebase [name]` (alias for update `--rebase`)\n- `git-flow rename [new-name]`\n- `git-flow finish [name]`\n- `git-flow publish [name]`\n\n",
        "gitflow/skills/gitflow-workflow/references/context-gathering.md": "# Context Gathering for GitFlow Operations\n\nMinimum context to collect before any start/finish operation:\n\n## Repository state\n\n- Current branch\n- Working tree status (must be clean for finish; typically clean for start)\n- Recent commits on the current branch\n\n## Branch inventory (by operation)\n\n- Start feature: list existing `feature/*` branches; confirm base branch exists\n- Finish feature: confirm you are on the intended `feature/*` branch; identify target integration branch\n- Start hotfix: list existing `hotfix/*` branches; identify production base branch (`main`/`production`)\n- Finish hotfix: identify production merge target + integration propagation target\n- Start release: list existing `release/*` branches; identify `develop` base branch\n- Finish release: identify `main` merge target + `develop` back-merge target\n\n## Versioning (if repo uses SemVer + tags)\n\n- Latest tag on the production branch\n- Current version in version files\n- Conventional commits since the last tag (for release bump decisions)\n\n## Test commands (if available)\n\nDetect and run the appropriate test command(s) for the repository before finishing operations:\n- Node.js: `pnpm test` or `npm test` (check for package.json)\n- Python: `pytest` (check for pytest.ini or pyproject.toml)\n- Swift: `swift test` (check for Package.swift)\n- Other stacks: use the repo's documented test command (check README.md)\n\nIf no test command is found, proceed without running tests but inform the user.\n\n",
        "gitflow/skills/gitflow-workflow/references/naming-rules.md": "# Branch Naming Rules\n\n## General rules\n\n1. Use kebab-case (lowercase with hyphens).\n2. Be descriptive but concise.\n3. Avoid spaces and special characters (use only hyphens).\n4. Always include the exact branch type prefix.\n\n## Examples\n\nGood:\n- `feature/user-authentication`\n- `hotfix/payment-gateway-timeout`\n- `release/1.2.0`\n\nBad:\n- `feature/userAuth` (camelCase)\n- `feature/user_authentication` (snake_case)\n- `feature/User-Authentication` (PascalCase)\n- `feature/user authentication` (spaces)\n\n## Name Normalization Procedure\n\nWhen normalizing branch names from user input:\n\n1. Strip the branch type prefix if present (e.g., `feature/`, `hotfix/`, `release/`)\n2. Convert to kebab-case (lowercase with hyphens)\n3. Assign to the appropriate variable (`$FEATURE_NAME`, `$HOTFIX_NAME`, `$RELEASE_VERSION`)\n\nExample transformations:\n- `feature/userAuth` → `user-auth`\n- `User-Authentication` → `user-authentication`\n- `hotfix/payment_gateway` → `payment-gateway`\n- `v1.2.3` → `1.2.3` (for releases)\n",
        "gitflow/skills/gitflow-workflow/references/versioning-and-tags.md": "# SemVer, Conventional Commits, and Tags\n\n## SemVer\n\nVersions follow `MAJOR.MINOR.PATCH`.\n\n## Version bump rules (conventional commits)\n\n- MAJOR:\n  - commit footer contains `BREAKING CHANGE:`, or\n  - commit type includes `!` (e.g. `feat!:`, `fix(api)!:`)\n- MINOR:\n  - at least one `feat:` since last tag, and no breaking changes\n- PATCH:\n  - at least one `fix:` since last tag, and no breaking changes/features\n\n## Calculation algorithm\n\n### Release branches\n\n1. Find base version: latest tag on the production branch (`main`/`production`).\n   - If no tags exist, start at `v0.1.0`.\n2. Analyze commits from base tag to the integration branch (often `develop`).\n3. Determine bump type using the rules above.\n4. Compute next version:\n   - MAJOR: `vX+1.0.0` (reset minor/patch)\n   - MINOR: `vX.Y+1.0` (reset patch)\n   - PATCH: `vX.Y.Z+1`\n\n### Hotfix branches\n\n- Default to PATCH bump from latest tag on the production branch.\n- Rare exception: truly breaking hotfix → MAJOR.\n\n## Tag format\n\nPrefer `vX.Y.Z` for consistency.\n\nExample annotated tag:\n\n`git tag -a v1.2.4 -m \"Release v1.2.4\"`\n\n## Version file updates (common patterns)\n\n- Node.js: `package.json` `\"version\": \"1.2.4\"`\n- Python: `__version__.py` `__version__ = \"1.2.4\"`\n- Rust: `Cargo.toml` `version = \"1.2.4\"`\n- Generic: `VERSION` / `version.txt` contains `1.2.4`\n\n",
        "gitflow/skills/gitflow-workflow/references/workflow-presets.md": "# Workflow Presets\n\ngit-flow-next supports presets (classic, github, gitlab). These presets define the base branches and the default “branch-from / merge-to” relationships.\n\n## Classic GitFlow\n\nBase branches:\n- `main` (or `master`): production\n- `develop`: integration\n\nTopic branches:\n- `feature/*`: `develop` → `develop`\n- `release/*`: `develop` → `main` + back-merge to `develop`\n- `hotfix/*`: `main` → `main` + merge to `develop`\n- `bugfix/*`: `develop` → `develop`\n- `support/*`: optional long-term support lines\n\n## GitHub Flow\n\nBase branches:\n- `main`: single trunk\n\nTopic branches:\n- `feature/*`: `main` → `main` (covers features, refactors, fixes)\n\nCharacteristics:\n- No `develop` branch\n- Suited to continuous deployment\n\n## GitLab Flow\n\nBase branches (environment flow):\n- `main` → `staging` → `production`\n\nTopic branches:\n- `feature/*`: `main` → `main`\n- `hotfix/*`: `production` → `production` + merge to `main`\n\nCharacteristics:\n- Environment-based promotion (staging gate)\n- Hotfixes branch from production\n\n",
        "gitflow/skills/start-feature/SKILL.md": "---\nname: start-feature\nallowed-tools: Bash(git:*), Read, Skill\ndescription: Start new feature branch\nmodel: haiku\nargument-hint: [feature-name]\nuser-invocable: true\n---\n\n## Your Task\n\n1. **Load the `gitflow:gitflow-workflow` skill** using the `Skill` tool to access GitFlow workflow capabilities.\n2. Gather context: current branch, existing feature branches, git status.\n3. Normalize the provided feature name from `$ARGUMENTS` to `$FEATURE_NAME` using the normalization procedure defined in the `gitflow-workflow` skill references (strip `feature/` prefix if present, convert to kebab-case).\n4. Identify base branch for the active workflow (usually `develop` for Classic GitFlow, or `main` for GitHub Flow).\n5. Create or resume `feature/$FEATURE_NAME` from the base branch.\n6. Push the branch to origin if newly created.\n",
        "gitflow/skills/start-hotfix/SKILL.md": "---\nname: start-hotfix\nallowed-tools: Bash(git:*), Read, Write, Skill\ndescription: Start new hotfix branch\nmodel: haiku\nargument-hint: [hotfix-name]\nuser-invocable: true\n---\n\n## Your Task\n\n1. **Load the `gitflow:gitflow-workflow` skill** using the `Skill` tool to access GitFlow workflow capabilities.\n2. Gather context: current branch, existing hotfix branches, latest tag, version files.\n3. Normalize the provided hotfix name from `$ARGUMENTS` to `$HOTFIX_NAME` using the normalization procedure defined in the `gitflow-workflow` skill references (strip `hotfix/` prefix if present, convert to kebab-case).\n4. Identify production base branch for the active workflow (usually `main` for Classic GitFlow, or `production` for GitLab Flow).\n5. Create or resume `hotfix/$HOTFIX_NAME` from the production base branch.\n6. Increment patch version (if the repo uses SemVer + tags) and update version files.\n7. Push the branch to origin if newly created.\n",
        "gitflow/skills/start-release/SKILL.md": "---\nname: start-release\nallowed-tools: Bash(git:*), Read, Write, Skill\ndescription: Start new release branch\nmodel: haiku\nargument-hint: [version]\nuser-invocable: true\n---\n\n## Your Task\n\n1. **Load the `gitflow:gitflow-workflow` skill** using the `Skill` tool to access GitFlow workflow capabilities.\n2. Gather context: current branch, existing release branches, latest tag, commit history.\n3. Normalize the provided version from `$ARGUMENTS` to `$RELEASE_VERSION` using the normalization procedure defined in the `gitflow-workflow` skill references (accept v1.2.3 or 1.2.3, normalize to 1.2.3).\n4. Decide version (use `$RELEASE_VERSION` if provided, otherwise calculate semantic version from conventional commits using the rules in `gitflow-workflow` skill references).\n5. Create or resume `release/$RELEASE_VERSION` from `develop`.\n6. Update version files:\n   - Identify version files using patterns from the `gitflow-workflow` skill references (package.json, Cargo.toml, VERSION, etc.).\n   - Update version to `$RELEASE_VERSION`.\n   - Commit changes: `chore: bump version to $RELEASE_VERSION` with `Co-Authored-By` footer.\n   - **Optional:** Create `CHANGELOG.md` template if repo maintains changelogs (see `${CLAUDE_PLUGIN_ROOT}/examples/changelog.md`). Leave `## [Unreleased]` section for manual curation or automated generation during finish-release.\n7. Push the branch to origin if newly created.\n",
        "github/.claude-plugin/plugin.json": "{\n  \"name\": \"github\",\n  \"version\": \"0.2.0\",\n  \"description\": \"GitHub project operations with quality gates.\",\n  \"author\": {\n        \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"commands\": [\n    \"./skills/create-issues/\",\n    \"./skills/create-pr/\",\n    \"./skills/resolve-issues/\"\n  ],\n  \"keywords\": [\n    \"github\",\n    \"issues\",\n    \"pull-requests\",\n    \"quality-gates\",\n    \"tdd\",\n    \"worktrees\"\n  ]\n}\n",
        "github/README.md": "# GitHub Plugin\n\nGitHub project operations with quality gates, TDD workflows, and comprehensive issue management.\n\n## Installation\n\n```bash\nclaude plugin install github@frad-dotclaude\n```\n\n**Requirements:**\n- GitHub CLI (`gh`) must be installed and authenticated\n- Repository must have a GitHub remote\n- Project must have lint, test, and build commands configured\n- Git must support worktrees (Git 2.5+)\n\n## Overview\n\nThe GitHub Plugin automates GitHub operations including pull request creation, issue management, and quality validation. It ensures all PRs meet quality standards before submission and follows TDD principles with atomic commits and conventional commit formats.\n\n## Commands\n\n### `/github:create-pr`\n\nCreates comprehensive GitHub pull requests with quality validation and gates.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Allowed Tools | `Task`, `Bash(gh:*)`, `Bash(git:*)` |\n\n**What it does:**\n1. Validates repository status and GitHub authentication\n2. Analyzes all commits in the branch (full history analysis)\n3. Enforces atomic commits: each commit represents one complete, cohesive change\n4. Runs comprehensive quality and security checks:\n   - Lint validation\n   - Test suite execution\n   - Build verification\n   - Security scanning for sensitive data\n5. Validates commit messages follow conventional format:\n   - **Format**: `feat:`, `fix:`, `docs:`, `refactor:`, `test:`, `chore:`\n   - **Title**: lowercase, <50 chars, imperative mood, optional scope\n   - **Body**: ≤72 chars per line, describes what and why\n   - **Footer**: References issues with auto-closing keywords\n6. Ensures all checks pass before PR creation\n7. Creates comprehensive PR description with:\n   - Summary of changes (1-3 bullet points)\n   - Test plan checklist\n   - Related issues and PRs\n   - Quality validation status\n8. Applies automated labels based on changes\n9. Creates PR using GitHub CLI with proper metadata\n\n**Usage:**\n```bash\n/github:create-pr\n```\n\n**Example workflow:**\n```bash\n# Make atomic commits following conventional format\n/git:commit  # First feature commit\n/git:commit  # Second feature commit\n\n# Create PR with quality gates\n/github:create-pr\n\n# Claude will:\n# - Validate all commits follow conventional format\n# - Run lint, test, build, security checks\n# - Ensure all quality gates pass\n# - Generate comprehensive PR description\n# - Apply labels and link issues\n# - Create PR and provide URL\n```\n\n**Features:**\n- **Quality gates**: All checks must pass before PR creation\n- **Atomic commits**: Validates each commit is a logical unit\n- **Conventional commits**: Enforces commit message standards\n- **Comprehensive validation**: Lint, test, build, security\n- **Auto-labeling**: Applies labels based on change types\n- **Issue linking**: Automatically links related issues\n- **Security scanning**: Checks for sensitive data exposure\n- **Failure resolution**: Uses specialized agents to fix issues\n\n**Failure resolution process:**\nWhen quality checks fail, the command:\n1. Uses TodoWrite to create specific task lists\n2. Invokes specialized agents for fixes:\n   - **@code-reviewer** for logic and correctness\n   - **@security-reviewer** for security issues\n3. Fixes issues systematically with validation\n4. Re-runs checks until all pass\n\n---\n\n### `/github:create-issues`\n\nCreates GitHub issues following TDD principles with proper labels, scope, and auto-closing keywords.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Allowed Tools | `Task`, `Bash(gh:*)`, `Bash(git:*)` |\n| Argument Hint | `[description]` |\n\n**What it does:**\n1. Analyzes repository context and existing issues\n2. Determines issue type (epic, PR-scoped, or review issue)\n3. Creates proper labels if they don't exist:\n   - `priority:high` - High priority - this sprint\n   - `priority:medium` - Medium priority - next sprint\n   - `priority:low` - Low priority - backlog\n4. Creates issues with required structure:\n   - Title (≤70 chars, imperative, no emojis)\n   - Proper labels\n   - Detailed body with problem description\n   - Acceptance criteria\n   - Context and links\n5. Applies auto-closing keywords for PR-scoped issues\n6. Provides issue URLs and tracking information\n\n**Usage:**\n```bash\n/github:create-issues [\\\"Bug description\\\" \\\"Feature description\\\"]\n```\n\n**Example workflows:**\n```bash\n# Create single issue\n/github:create-issues \\\"Fix memory leak in auth service\\\"\n\n# Create multiple issues\n/github:create-issues \\\"Add rate limiting\\\" \\\"Update payment API\\\" \\\"Fix mobile layout\\\"\n\n# With detailed description (interactive)\n/github:create-issues\n# Claude will ask for details and create properly formatted issue\n```\n\n**Features:**\n- **TDD-first**: Follows test-driven development workflow\n- **Branch-aware**: Decision tree based on current branch\n- **Proper labeling**: Automatic label assignment\n- **Scope determination**: Epic vs PR-scoped issues\n- **Auto-closing**: Uses keywords (Closes, Fixes, Resolves)\n- **Structured format**: Consistent issue templates\n\n**Branch-based decision logic:**\n- **On main/develop**: Create issue directly\n- **On PR branch**: Ask \"Must this be fixed before merge?\"\n  - **Yes**: Comment in PR with detailed context\n  - **No**: Create new issue for later with justification\n\n**Issue types:**\n1. **Epic issues**: Multi-PR initiatives (no auto-close keywords)\n2. **PR-scoped issues**: Single PR resolution (use auto-close keywords)\n3. **Review issues**: Non-blocking feedback from PR reviews\n\n---\n\n### `/github:resolve-issues`\n\nResolves GitHub issues using isolated worktrees and TDD workflow with comprehensive quality validation.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Allowed Tools | `Bash(gh:*)`, `Bash(git:*)`, `Bash(cd:*)`, `Bash(mkdir:*)`, `Task` |\n\n**What it does:**\n1. **Issue Selection**: Evaluates open issues and prioritizes next actionable item\n2. **Worktree Setup**: Creates or reuses isolated worktree with descriptive branch name\n3. **TDD Implementation**:\n   - Plan with **@tech-lead-reviewer** for architectural impact\n   - Write failing tests (red phase)\n   - Implement fixes with **@code-simplifier** for optimization\n   - Refactor while keeping tests green\n4. **Quality Validation**: Runs project-specific lint, test, and build commands\n5. **PR Creation**: Pushes branch and creates PR with auto-closing keywords\n6. **Cleanup**: Removes worktree after merge with documentation\n\n**Usage:**\n```bash\n/github:resolve-issues\n```\n\n**Example workflow:**\n```bash\n# Start issue resolution\n/github:resolve-issues\n\n# Claude will:\n# - Show open issues and ask which to resolve\n# - Create worktree: git worktree add ../fix-123-auth-redirect\n# - Plan with tech-lead-reviewer\n# - Write failing tests\n# - Implement fix\n# - Run quality checks\n# - Create PR with \\\"Fixes #123\\\"\n# - Clean up worktree after merge\n```\n\n**Features:**\n- **Isolated worktrees**: Clean environment for each issue\n- **TDD workflow**: Red → Green → Refactor cycle\n- **Multi-agent collaboration**: Works with specialized reviewers\n- **Quality gates**: All checks must pass\n- **Auto-cleanup**: Removes worktrees after completion\n- **Documentation**: Tracks all decisions and actions\n\n**Agent collaboration:**\n- **@tech-lead-reviewer**: Architectural review and planning\n- **@code-simplifier**: Code optimization and simplification\n- **@security-reviewer**: Security validation (when applicable)\n\n## Best Practices\n\n### Using `/github:create-pr`\n- **Quality-first**: All checks must pass before PR creation\n- **Atomic commits**: Each commit should be a logical unit\n- **Conventional format**: Follow commit message standards\n- **Small PRs**: Easier to review and merge\n- **Issue linking**: Reference issues in commits for auto-closing\n- **Review the PR**: Verify description accuracy before submission\n\n### Using `/github:create-issues`\n- **Clear descriptions**: Provide specific problem statements\n- **Acceptance criteria**: Define measurable completion conditions\n- **TDD workflow**: Create issues before implementation\n- **Proper scoping**: Distinguish between epics and PR-scoped issues\n- **Label consistently**: Use priority and type labels\n- **Link related items**: Connect issues to related work\n\n### Using `/github:resolve-issues`\n- **Select wisely**: Prioritize the next actionable issue\n- **Follow TDD**: Write tests before implementation\n- **Use worktrees**: Keep environments isolated\n- **Collaborate**: Use specialized agents for review\n- **Quality gates**: All checks must pass before PR\n- **Clean up**: Remove worktrees after merge\n- **Document**: Track decisions and lessons learned\n\n## Workflow Integration\n\n### Complete development workflow:\n```bash\n# 1. Create issue for feature\n/github:create-issues \\\"Add OAuth authentication\\\"\n\n# 2. Resolve the issue\n/github:resolve-issues\n# - Select the OAuth issue\n# - Work in isolated worktree\n# - Follow TDD cycle\n# - Create PR when complete\n\n# 3. Or manual development\n/git:commit  # Follow conventional format\n/git:commit\n\n# 4. Create PR with quality gates\n/github:create-pr\n# - All checks pass\n# - PR description generated\n# - Issues linked automatically\n\n# 5. After merge, resolve issues\n/github:resolve-issues\n# - Issues closed automatically\n```\n\n## Requirements\n\n- GitHub CLI (`gh`) must be installed\n- GitHub CLI must be authenticated: `gh auth login`\n- Repository must have a GitHub remote named `origin`\n- Project must have configured lint, test, and build commands\n- Git version 2.5+ for worktree support\n\n## Troubleshooting\n\n### `/github:create-pr` fails quality checks\n\n**Issue**: Lint, test, build, or security checks fail\n\n**Solution**:\n- Review failure output carefully\n- Fix all issues systematically\n- For security issues, work with @security-reviewer\n- Re-run `/github:create-pr` after all fixes\n- Consider splitting large PRs if too many issues\n\n### GitHub CLI not authenticated\n\n**Issue**: `gh` commands fail with authentication error\n\n**Solution**:\n- Install GitHub CLI: `brew install gh` (macOS) or see [GitHub CLI installation](https://cli.github.com/)\n- Authenticate: `gh auth login`\n- Select appropriate authentication method\n- Verify with: `gh auth status`\n- Ensure repository remote: `git remote -v`\n\n### PR description is incomplete\n\n**Issue**: PR description missing context or details\n\n**Solution**:\n- Ensure commits follow conventional format\n- Write descriptive commit messages\n- Reference issues in commit messages\n- Manually edit PR after creation if needed\n- Check full commit history for context\n\n### Worktree operations fail\n\n**Issue**: `git worktree` commands fail\n\n**Solution**:\n- Update Git to version 2.5+\n- Check worktree list: `git worktree list`\n- Remove orphaned worktrees: `git worktree remove <path>`\n- Clean up with: `git worktree prune`\n- Ensure sufficient disk space\n\n### Issue auto-closing doesn't work\n\n**Issue**: Merged PR doesn't close linked issues\n\n**Solution**:\n- Use correct keywords: Closes, Fixes, Resolves\n- Reference issue in PR or commit message\n- Check GitHub repository permissions\n- Verify issue exists and is open\n- Manually close if needed and update process\n\n## Safety Features\n\n- **Protected branches**: Enforces PR workflow for main/develop\n- **Quality gates**: All checks must pass before PR creation\n- **Security scanning**: Detects sensitive data before commits\n- **Atomic commits**: Validates each commit is a logical unit\n- **Worktree isolation**: Prevents repository corruption\n- **Atomic PR creation**: Either all succeeds or all fails\n\n## Key Principles\n\n✅ **TDD-First**: Test → Code → Refactor cycle\n✅ **Quality Gates**: All checks pass before PR\n✅ **Atomic Commits**: One logical change per commit\n✅ **Issue-Driven**: Work from well-defined issues\n✅ **Collaborative**: Multi-agent review and validation\n✅ **Clean Workflow**: Isolated worktrees, automated cleanup\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n",
        "github/skills/create-issues/SKILL.md": "---\nname: create-issues\nallowed-tools: Task, Bash(gh:*), Bash(git:*)\ndescription: Create GitHub issues with TDD principles and proper labels\nargument-hint: [description]\nuser-invocable: true\n---\n\n## Context\n\n- Current git status: !`git status`\n- Current branch: !`git branch --show-current`\n- Open issues: !`gh issue list --state open --limit 10`\n- GitHub authentication: !`gh auth status`\n\n## Requirements\n\n- Follow TDD principles and Conventional Commits.\n- Use proper labels, scope, and auto-closing keywords.\n- Protected branches require PR + review + CI; no direct pushes to main/develop.\n- **Use atomic commits for logical units of work**: Each commit should represent one complete, cohesive change.\n- Title: entirely lowercase, <50 chars, imperative mood (e.g., \"add\", \"fix\", \"update\"), conventional commits format (feat:, fix:, docs:, refactor:, test:, chore:)\n  - Scope (optional): lowercase noun, 1-2 words. Must match existing scopes in git history.\n- Body: blank line after title, ≤72 chars per line, must start with uppercase letter, standard capitalization and punctuation. Describe what changed and why, not how.\n- Footer (optional): Must start with uppercase letter, standard capitalization. Reference issues/PRs (Closes #123, Fixes #456, Linked to PR #789). Use BREAKING CHANGE: prefix for breaking changes.\n\n### Examples\n\n```\nfeat(auth): add google oauth login flow\n\n- Introduce Google OAuth 2.0 for user sign-in\n- Add backend callback endpoint `/auth/google/callback`\n- Update login UI with Google button and loading state\n\nAdd a new authentication option improving cross-platform\nsign-in.\n\nCloses #42. Linked to #38 and PR #45\n```\n\n```\nfix(api): handle null payload in session refresh\n\n- Validate payload before accessing `user.id`\n- Return proper 400 response instead of 500\n- Add regression test for null input\n\nPrevents session refresh crash when token expires.\n\nFixes #105\n```\n\n```\nfeat(auth): migrate to oauth 2.0\n\n- Replace basic auth with OAuth 2.0 flow\n- Update authentication middleware\n- Add token refresh endpoint\n\nBREAKING CHANGE: Authentication API now requires OAuth 2.0 tokens. Basic auth is no longer supported.\n\nCloses #120. Linked to #115 and PR #122\n```\n\n## Your Task\n\n**IMPORTANT: You MUST use the Task tool to complete ALL tasks.**\n\n1. Assess the repository context and select an issue scope that fits `$ARGUMENTS`.\n2. Create or update labels as needed, then draft the issue with the required structure and links.\n3. Document decisions (including branch strategy) and share follow-up actions with the team.\n\n### Decision Logic\n\n**Branch-based decision tree**:\n\n- **On main/develop**: Create issue directly.\n- **On PR branch**: Ask \"Must this be fixed before merge?\"\n  - **Yes**: Comment in PR with detailed context and reasoning, don't create issue.\n  - **No**: Create new issue for later with clear justification for scope separation.\n\n### Issue Types\n\n1. **Epic issues**: Multi-PR initiatives (no auto-close keywords).\n2. **PR-scoped issues**: Single PR resolution (use auto-close keywords).\n3. **Review issues**: Non-blocking feedback from PR reviews.\n\n### Issue Creation Process\n\n1. **Analyze context** from current repository state and existing issues.\n2. **Determine issue type** based on scope and complexity.\n3. **Create proper labels** if they don't exist:\n   ```bash\n   gh label create \"priority:high\" --description \"High priority - this sprint\" --color \"d73a4a\" || true\n   gh label create \"priority:medium\" --description \"Medium priority - next sprint\" --color \"fbca04\" || true\n   gh label create \"priority:low\" --description \"Low priority - backlog\" --color \"0075ca\" || true\n   ```\n4. **Create issue** with proper structure and labels.\n5. **Link related items** if applicable.\n\n### Issue Structure Requirements\n\n- **Title**: ≤70 chars, imperative, no emojis.\n- **Labels**: Include priority and type labels.\n- **Body**: Problem description, acceptance criteria, context.\n- **Auto-closing**: Use keywords (`fixes`, `closes`, `resolves`) for PR-scoped issues.\n\n### Key Principles\n\n- Follow TDD: issue → test → code → PR → merge.\n- Epic issues: manual linking, no auto-close keywords.\n- PR-scoped issues: designed for auto-close keywords.\n- Clear, actionable descriptions with proper context.\n",
        "github/skills/create-pr/SKILL.md": "---\nname: create-pr\nallowed-tools: Task, Bash(gh:*), Bash(git:*)\ndescription: Create comprehensive GitHub pull requests with quality validation\nargument-hint: [optional description or issue reference]\nuser-invocable: true\n---\n\n## Context\n\n- Current git status: !`git status`\n- Current branch: !`git branch --show-current`\n- Unpushed commits: !`git log @{u}..HEAD --oneline 2>/dev/null || git log --oneline -5`\n- GitHub authentication: !`gh auth status`\n- Repository changes: !`git diff --stat HEAD~1..HEAD 2>/dev/null || echo \"No recent changes\"`\n\n## Requirements\n\n- Ensure the repository is clean, authenticated, and ready for PR submission.\n- Complete lint, test, build, and security checks before creating the PR.\n- Link related issues and apply accurate labels for traceability.\n- **Use atomic commits for logical units of work**: Each commit should represent one complete, cohesive change.\n- Title: entirely lowercase, <50 chars, imperative mood (e.g., \"add\", \"fix\", \"update\"), conventional commits format (feat:, fix:, docs:, refactor:, test:, chore:)\n  - Scope (optional): lowercase noun, 1-2 words. Must match existing scopes in git history.\n- Body: blank line after title, ≤72 chars per line, must start with uppercase letter, standard capitalization and punctuation. Describe what changed and why, not how.\n- Footer (optional): Must start with uppercase letter, standard capitalization. Reference issues/PRs (Closes #123, Fixes #456, Linked to PR #789). Use BREAKING CHANGE: prefix for breaking changes.\n\n### Examples\n\n```\nfeat(auth): add google oauth login flow\n\n- Introduce Google OAuth 2.0 for user sign-in\n- Add backend callback endpoint `/auth/google/callback`\n- Update login UI with Google button and loading state\n\nAdd a new authentication option improving cross-platform\nsign-in.\n\nCloses #42. Linked to #38 and PR #45\n```\n\n```\nfix(api): handle null payload in session refresh\n\n- Validate payload before accessing `user.id`\n- Return proper 400 response instead of 500\n- Add regression test for null input\n\nPrevents session refresh crash when token expires.\n\nFixes #105\n```\n\n```\nfeat(auth): migrate to oauth 2.0\n\n- Replace basic auth with OAuth 2.0 flow\n- Update authentication middleware\n- Add token refresh endpoint\n\nBREAKING CHANGE: Authentication API now requires OAuth 2.0 tokens. Basic auth is no longer supported.\n\nCloses #120. Linked to #115 and PR #122\n```\n\n## Your Task\n\n**IMPORTANT: You MUST use the Task tool to complete ALL tasks.**\n\n1. Validate repository readiness, analyse change scope, and detect any blockers.\n2. Run the necessary quality and security checks; resolve failures by collaborating with specialized agents when required.\n3. Assemble the pull request with the prescribed structure, link issues, apply labels, and report the final status to the team.\n\n### Workflow Steps\n\n1. **Repository Validation** - Check authentication and branch status\n2. **Change Analysis** - Analyze commits and file changes\n3. **Quality Validation** - Run project-specific quality checks\n4. **Security Scanning** - Check for sensitive data exposure\n5. **Issue Discovery** - Find and link related issues\n6. **PR Creation** - Generate and create pull request with proper metadata\n\n### Quality Validation Process\n\n**Node.js Projects:**\n\n- Run lint, test, build, and type-check commands\n- Validate package.json changes\n- Check for security vulnerabilities\n\n**Python Projects:**\n\n- Run ruff, black, pytest, and mypy\n- Validate requirements and dependencies\n- Check for security issues\n\n### Security Validation\n\n- Scan for sensitive files (.env, .key, .pem)\n- Check for hardcoded secrets, passwords, tokens\n- Validate input sanitization in changed files\n- Ensure no credentials in commit history\n\n### Pre-Creation Requirements\n\n- Repository state validated and clean\n- All quality checks passed (lint, test, build)\n- Security scan completed without issues\n- Related issues identified and linked\n- Proper branch naming and commit messages following standards\n\n### Failure Resolution Process\n\nWhen quality checks fail:\n\n1. Use TodoWrite to create specific task list for failures\n2. Use Task tool with specialized agents:\n   - **@code-reviewer** — logic correctness, tests, error handling.\n   - **@security-reviewer** — authentication, data protection, validation.\n3. Fix issues systematically with validation after each fix\n4. Mark tasks completed immediately after resolution\n5. Re-run quality checks until all pass\n\n### PR Structure Requirements\n\n**Title Guidelines:**\n\n- Maximum 70 characters\n- Use imperative mood\n- No emojis\n- Clear and descriptive\n\n**Body Template:**\n\n```markdown\n## Summary\nBrief description of changes and business impact\n\n## Changes\n- List of key modifications\n- Technical details and rationale\n\n## Related Issues\nFixes #123, Closes #456\n\n## Testing\n- [ ] Unit tests added/updated\n- [ ] All tests pass\n- [ ] Manual testing completed\n- [ ] Edge cases covered\n\n## Security & Quality\n- [ ] No sensitive data exposed\n- [ ] Input validation implemented\n- [ ] Linting and type checking passed\n- [ ] Build successful\n\n## Type of Change\n- [ ] Bug fix\n- [ ] New feature\n- [ ] Breaking change\n- [ ] Documentation update\n```\n\n### Automated Labeling\n\n- `testing` - Test file modifications\n- `documentation` - Documentation updates\n- `dependencies` - Package file changes\n- `security` - Security-related modifications\n\n### Commit Message Validation\n\n- **Use atomic commits for logical units of work**: Each commit should represent one complete, cohesive change.\n- Title: entirely lowercase, <50 chars, imperative mood (e.g., \"add\", \"fix\", \"update\"), conventional commits format (feat:, fix:, docs:, refactor:, test:, chore:)\n  - Scope (optional): lowercase noun, 1-2 words. Must match existing scopes in git history.\n- Body: blank line after title, ≤72 chars per line, must start with uppercase letter, standard capitalization and punctuation. Describe what changed and why, not how.\n- Footer (optional): Must start with uppercase letter, standard capitalization. Reference issues/PRs (Closes #123, Fixes #456, Linked to PR #789). Use BREAKING CHANGE: prefix for breaking changes.\n\n### Examples\n\n```\nfeat(auth): add google oauth login flow\n\n- Introduce Google OAuth 2.0 for user sign-in\n- Add backend callback endpoint `/auth/google/callback`\n- Update login UI with Google button and loading state\n\nAdd a new authentication option improving cross-platform\nsign-in.\n\nCloses #42. Linked to #38 and PR #45\n```\n\n```\nfix(api): handle null payload in session refresh\n\n- Validate payload before accessing `user.id`\n- Return proper 400 response instead of 500\n- Add regression test for null input\n\nPrevents session refresh crash when token expires.\n\nFixes #105\n```\n\n```\nfeat(auth): migrate to oauth 2.0\n\n- Replace basic auth with OAuth 2.0 flow\n- Update authentication middleware\n- Add token refresh endpoint\n\nBREAKING CHANGE: Authentication API now requires OAuth 2.0 tokens. Basic auth is no longer supported.\n\nCloses #120. Linked to #115 and PR #122\n```\n\n- Review all commits in branch for compliance\n- Handle non-standard commits by documenting in PR description or interactive rebase if safe\n\n### Best Practices\n\n- **Quality-first**: All checks must pass before PR creation\n- **Security validation**: Comprehensive scanning for vulnerabilities\n- **Issue linking**: Connect PRs to related issues with auto-closing keywords\n- **Small, focused changes**: Easier to review and merge\n",
        "github/skills/resolve-issues/SKILL.md": "---\nname: resolve-issues\nallowed-tools: Bash(gh:*), Bash(git:*), Bash(cd:*), Bash(mkdir:*), Task\ndescription: Resolve GitHub issues using isolated worktrees and TDD\nargument-hint: [issue number or description]\nuser-invocable: true\n---\n\n## Context\n\n- Current git status: !`git status`\n- Current branch: !`git branch --show-current`\n- Existing worktrees: !`git worktree list`\n- Open issues: !`gh issue list --state open --limit 10`\n- GitHub authentication: !`gh auth status`\n\n## Requirements\n\n- Use isolated worktrees for development and follow the protected PR workflow.\n- Apply a TDD cycle (red → green → refactor) with appropriate sub-agent support.\n- Reference resolved issues in commits and PR descriptions using auto-closing keywords.\n- **Use atomic commits for logical units of work**: Each commit should represent one complete, cohesive change.\n- Title: entirely lowercase, <50 chars, imperative mood (e.g., \"add\", \"fix\", \"update\"), conventional commits format (feat:, fix:, docs:, refactor:, test:, chore:)\n  - Scope (optional): lowercase noun, 1-2 words. Must match existing scopes in git history.\n- Body: blank line after title, ≤72 chars per line, must start with uppercase letter, standard capitalization and punctuation. Describe what changed and why, not how.\n- Footer (optional): Must start with uppercase letter, standard capitalization. Reference issues/PRs (Closes #123, Fixes #456, Linked to PR #789). Use BREAKING CHANGE: prefix for breaking changes.\n\n### Examples\n\n```\nfeat(auth): add google oauth login flow\n\n- Introduce Google OAuth 2.0 for user sign-in\n- Add backend callback endpoint `/auth/google/callback`\n- Update login UI with Google button and loading state\n\nAdd a new authentication option improving cross-platform\nsign-in.\n\nCloses #42. Linked to #38 and PR #45\n```\n\n```\nfix(api): handle null payload in session refresh\n\n- Validate payload before accessing `user.id`\n- Return proper 400 response instead of 500\n- Add regression test for null input\n\nPrevents session refresh crash when token expires.\n\nFixes #105\n```\n\n```\nfeat(auth): migrate to oauth 2.0\n\n- Replace basic auth with OAuth 2.0 flow\n- Update authentication middleware\n- Add token refresh endpoint\n\nBREAKING CHANGE: Authentication API now requires OAuth 2.0 tokens. Basic auth is no longer supported.\n\nCloses #120. Linked to #115 and PR #122\n```\n\n## Your Task\n\n**IMPORTANT: You MUST use the Task tool to complete ALL tasks.**\n\n1. Inspect the repository context, select a target issue, and decide whether to create a new worktree or resume an existing one.\n2. Set up the worktree environment, implement the fix using TDD with specialized review agents, and ensure quality checks pass.\n3. Create the pull request, link the issue, and clean up the worktree after merge, documenting all results to the user.\n\n### Recommended Workflow\n\n- **Issue Selection**: Evaluate open issues and prioritize the next actionable item.\n- **Worktree Setup**: Create or reuse an isolated worktree with a descriptive branch name (e.g. `fix/456-auth-redirect`).\n- **TDD Implementation**: Plan with **@tech-lead-reviewer** — architectural impact assessment —, write failing tests, implement fixes, and refactor with **@code-simplifier** — code simplification and optimization — while keeping tests green.\n- **Quality Validation**: Run project-specific lint, test, and build commands before PR creation.\n- **PR Creation & Cleanup**: Push the branch, raise a PR with auto-closing keywords, and remove the worktree after merge.\n",
        "office/.claude-plugin/plugin.json": "{\n  \"name\": \"office\",\n  \"version\": \"0.4.2\",\n  \"license\": \"MIT\",\n  \"description\": \"Specialized Claude Skill for patent application generation and intellectual property workflows.\",\n  \"keywords\": [\n    \"patent\",\n    \"legal\",\n    \"chinese\",\n    \"search\",\n    \"intellectual-property\"\n  ],\n  \"author\": {\n    \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"commands\": [\n    \"./skills/patent-architect/\"\n  ],\n  \"skills\": [\n    \"./skills/agent-browser/\"\n  ]\n}\n",
        "office/README.md": "# Office Plugin\n\nSpecialized Claude Skill for patent application generation and intellectual property workflows.\n\n## Installation\n\n```bash\nclaude plugin install office@frad-dotclaude\n```\n\n## Quick Start\n\n### 1. Setup API Keys\n\n```bash\nexport SERPAPI_KEY=\"your_serpapi_key\"\nexport EXA_API_KEY=\"your_exa_api_key\"\n# Add to ~/.zshrc or ~/.bashrc for persistence\nsource ~/.zshrc\n```\n\nGet your API keys:\n- **SERPAPI_KEY**: Sign up at [serpapi.com](https://serpapi.com)\n- **EXA_API_KEY**: Get from [dashboard.exa.ai](https://dashboard.exa.ai)\n\n### 2. Use the Patent Architect Skill\n\n```bash\n/patent-architect \"Mobile Payment Authentication System\"\n```\n\nThe skill will:\n1. Understand your technical invention\n2. Search for prior art automatically\n3. Generate a complete Chinese patent application form\n\n## Skills\n\n### `/patent-architect` (Command)\n\nGenerate Chinese patent application forms (专利申请表) from technical ideas.\n\n**Usage:**\n```bash\n/patent-architect \"INVENTION_DESCRIPTION\"\n```\n\n**Workflow:**\n```\n用户输入技术想法 → 专利检索 (SerpAPI/Exa.ai) → 对比分析 → 生成申请表\n```\n\n**Features:**\n- Dual search strategy (SerpAPI + Exa.ai)\n- Automatic prior art search\n- Chinese patent application form generation\n- Patent terminology compliance\n- Multiple embodiment generation (3+)\n\n### `agent-browser` (Reference Skill)\n\nBrowser automation command reference for agents and workflows.\n\n**Source**: Synced from [browser-use/agent-browser](https://github.com/browser-use/agent-browser)\n\n**Purpose**: Provides browser automation command reference for agents that need to interact with web pages.\n\n**Sync**: Use `./scripts/sync-agent-browser.sh` to update from upstream\n\n## Scripts\n\n### `scripts/sync-agent-browser.sh`\n\n同步上游 agent-browser skill 的脚本。\n\n**Usage:**\n```bash\n# 检查是否有更新\n./scripts/sync-agent-browser.sh --check\n\n# 执行同步(会提示确认)\n./scripts/sync-agent-browser.sh\n\n# 强制同步,跳过确认\n./scripts/sync-agent-browser.sh --force\n\n# 同步但不创建备份\n./scripts/sync-agent-browser.sh --no-backup\n```\n\n**Options:**\n- `-h, --help` - 显示帮助信息\n- `-c, --check` - 仅检查更新,不执行同步\n- `-f, --force` - 强制同步,跳过备份\n- `--no-backup` - 同步时不创建备份\n\n### `scripts/search-patents.sh`\n\nHelper script for patent search with argument parsing.\n\n**Usage:**\n```bash\n# SerpAPI search (default)\n./scripts/search-patents.sh mobile payment authentication\n\n# Exa.ai semantic search\n./scripts/search-patents.sh \"biometric verification\" --engine exa --num 5\n\n# Show help\n./scripts/search-patents.sh --help\n```\n\n**Options:**\n- `--engine <serpapi|exa>` - Search engine to use (default: serpapi)\n- `--num <n>` - Number of results (default: 10)\n- `-h, --help` - Show help message\n\n## Architecture\n\n```\noffice/\n├── .claude-plugin/\n│   └── plugin.json          # Plugin metadata\n├── hooks/\n│   ├── hooks.json           # Hook configuration\n│   └── scripts/\n│       └── check-keys.sh    # API key validation\n├── lib/\n│   └── utils.sh             # Shared utilities\n├── scripts/\n│   ├── search-patents.sh      # Patent search helper\n│   └── sync-agent-browser.sh  # Agent-browser skill sync\n└── skills/\n    ├── patent-architect/      # Patent application generation skill\n    │   ├── SKILL.md           # Skill definition\n    │   ├── template.md        # Output template\n    │   ├── reference.md       # API reference\n    │   └── examples.md        # Usage examples\n    └── agent-browser/         # Browser automation skill\n        └── SKILL.md           # Skill definition\n```\n\n## Troubleshooting\n\n### API Keys Not Set\n\n**Symptoms**: Error message \"Missing API Keys for Office Plugin\"\n\n**Solution**:\n```bash\nexport SERPAPI_KEY=\"your_key_here\"\nexport EXA_API_KEY=\"your_key_here\"\nsource ~/.zshrc\n```\n\n### Search Returns No Results\n\n**Solutions**:\n- Try different keyword combinations\n- Use both technical terms and natural language\n- Switch between `--engine serpapi` and `--engine exa`\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n",
        "office/skills/agent-browser/SKILL.md": "---\nname: agent-browser\ndescription: Browser automation command reference and usage patterns for web testing, form filling, screenshots, and data extraction.\nuser-invocable: false\n---\n\n# Browser Automation with agent-browser\n\n## Quick start\n\n```bash\nagent-browser open <url>        # Navigate to page\nagent-browser snapshot -i       # Get interactive elements with refs\nagent-browser click @e1         # Click element by ref\nagent-browser fill @e2 \"text\"   # Fill input by ref\nagent-browser close             # Close browser\n```\n\n## Core workflow\n\n1. Navigate: `agent-browser open <url>`\n2. Snapshot: `agent-browser snapshot -i` (returns elements with refs like `@e1`, `@e2`)\n3. Interact using refs from the snapshot\n4. Re-snapshot after navigation or significant DOM changes\n\n## Commands\n\n### Navigation\n\n```bash\nagent-browser open <url>      # Navigate to URL (aliases: goto, navigate)\n                              # Supports: https://, http://, file://, about:, data://\n                              # Auto-prepends https:// if no protocol given\nagent-browser back            # Go back\nagent-browser forward         # Go forward\nagent-browser reload          # Reload page\nagent-browser close           # Close browser (aliases: quit, exit)\nagent-browser connect 9222    # Connect to browser via CDP port\n```\n\n### Snapshot (page analysis)\n\n```bash\nagent-browser snapshot            # Full accessibility tree\nagent-browser snapshot -i         # Interactive elements only (recommended)\nagent-browser snapshot -c         # Compact output\nagent-browser snapshot -d 3       # Limit depth to 3\nagent-browser snapshot -s \"#main\" # Scope to CSS selector\n```\n\n### Interactions (use @refs from snapshot)\n\n```bash\nagent-browser click @e1           # Click\nagent-browser dblclick @e1        # Double-click\nagent-browser focus @e1           # Focus element\nagent-browser fill @e2 \"text\"     # Clear and type\nagent-browser type @e2 \"text\"     # Type without clearing\nagent-browser press Enter         # Press key (alias: key)\nagent-browser press Control+a     # Key combination\nagent-browser keydown Shift       # Hold key down\nagent-browser keyup Shift         # Release key\nagent-browser hover @e1           # Hover\nagent-browser check @e1           # Check checkbox\nagent-browser uncheck @e1         # Uncheck checkbox\nagent-browser select @e1 \"value\"  # Select dropdown option\nagent-browser select @e1 \"a\" \"b\"  # Select multiple options\nagent-browser scroll down 500     # Scroll page (default: down 300px)\nagent-browser scrollintoview @e1  # Scroll element into view (alias: scrollinto)\nagent-browser drag @e1 @e2        # Drag and drop\nagent-browser upload @e1 file.pdf # Upload files\n```\n\n### Get information\n\n```bash\nagent-browser get text @e1        # Get element text\nagent-browser get html @e1        # Get innerHTML\nagent-browser get value @e1       # Get input value\nagent-browser get attr @e1 href   # Get attribute\nagent-browser get title           # Get page title\nagent-browser get url             # Get current URL\nagent-browser get count \".item\"   # Count matching elements\nagent-browser get box @e1         # Get bounding box\nagent-browser get styles @e1      # Get computed styles (font, color, bg, etc.)\n```\n\n### Check state\n\n```bash\nagent-browser is visible @e1      # Check if visible\nagent-browser is enabled @e1      # Check if enabled\nagent-browser is checked @e1      # Check if checked\n```\n\n### Screenshots & PDF\n\n```bash\nagent-browser screenshot          # Screenshot to stdout\nagent-browser screenshot path.png # Save to file\nagent-browser screenshot --full   # Full page\nagent-browser pdf output.pdf      # Save as PDF\n```\n\n### Video recording\n\n```bash\nagent-browser record start ./demo.webm    # Start recording (uses current URL + state)\nagent-browser click @e1                   # Perform actions\nagent-browser record stop                 # Stop and save video\nagent-browser record restart ./take2.webm # Stop current + start new recording\n```\n\nRecording creates a fresh context but preserves cookies/storage from your session. If no URL is provided, it\nautomatically returns to your current page. For smooth demos, explore first, then start recording.\n\n### Wait\n\n```bash\nagent-browser wait @e1                     # Wait for element\nagent-browser wait 2000                    # Wait milliseconds\nagent-browser wait --text \"Success\"        # Wait for text (or -t)\nagent-browser wait --url \"**/dashboard\"    # Wait for URL pattern (or -u)\nagent-browser wait --load networkidle      # Wait for network idle (or -l)\nagent-browser wait --fn \"window.ready\"     # Wait for JS condition (or -f)\n```\n\n### Mouse control\n\n```bash\nagent-browser mouse move 100 200      # Move mouse\nagent-browser mouse down left         # Press button\nagent-browser mouse up left           # Release button\nagent-browser mouse wheel 100         # Scroll wheel\n```\n\n### Semantic locators (alternative to refs)\n\n```bash\nagent-browser find role button click --name \"Submit\"\nagent-browser find text \"Sign In\" click\nagent-browser find text \"Sign In\" click --exact      # Exact match only\nagent-browser find label \"Email\" fill \"user@test.com\"\nagent-browser find placeholder \"Search\" type \"query\"\nagent-browser find alt \"Logo\" click\nagent-browser find title \"Close\" click\nagent-browser find testid \"submit-btn\" click\nagent-browser find first \".item\" click\nagent-browser find last \".item\" click\nagent-browser find nth 2 \"a\" hover\n```\n\n### Browser settings\n\n```bash\nagent-browser set viewport 1920 1080          # Set viewport size\nagent-browser set device \"iPhone 14\"          # Emulate device\nagent-browser set geo 37.7749 -122.4194       # Set geolocation (alias: geolocation)\nagent-browser set offline on                  # Toggle offline mode\nagent-browser set headers '{\"X-Key\":\"v\"}'     # Extra HTTP headers\nagent-browser set credentials user pass       # HTTP basic auth (alias: auth)\nagent-browser set media dark                  # Emulate color scheme\nagent-browser set media light reduced-motion  # Light mode + reduced motion\n```\n\n### Cookies & Storage\n\n```bash\nagent-browser cookies                     # Get all cookies\nagent-browser cookies set name value      # Set cookie\nagent-browser cookies clear               # Clear cookies\nagent-browser storage local               # Get all localStorage\nagent-browser storage local key           # Get specific key\nagent-browser storage local set k v       # Set value\nagent-browser storage local clear         # Clear all\n```\n\n### Network\n\n```bash\nagent-browser network route <url>              # Intercept requests\nagent-browser network route <url> --abort      # Block requests\nagent-browser network route <url> --body '{}'  # Mock response\nagent-browser network unroute [url]            # Remove routes\nagent-browser network requests                 # View tracked requests\nagent-browser network requests --filter api    # Filter requests\n```\n\n### Tabs & Windows\n\n```bash\nagent-browser tab                 # List tabs\nagent-browser tab new [url]       # New tab\nagent-browser tab 2               # Switch to tab by index\nagent-browser tab close           # Close current tab\nagent-browser tab close 2         # Close tab by index\nagent-browser window new          # New window\n```\n\n### Frames\n\n```bash\nagent-browser frame \"#iframe\"     # Switch to iframe\nagent-browser frame main          # Back to main frame\n```\n\n### Dialogs\n\n```bash\nagent-browser dialog accept [text]  # Accept dialog\nagent-browser dialog dismiss        # Dismiss dialog\n```\n\n### JavaScript\n\n```bash\nagent-browser eval \"document.title\"   # Run JavaScript\n```\n\n## Global options\n\n```bash\nagent-browser --session <name> ...    # Isolated browser session\nagent-browser --json ...              # JSON output for parsing\nagent-browser --headed ...            # Show browser window (not headless)\nagent-browser --full ...              # Full page screenshot (-f)\nagent-browser --cdp <port> ...        # Connect via Chrome DevTools Protocol\nagent-browser -p <provider> ...       # Cloud browser provider (--provider)\nagent-browser --proxy <url> ...       # Use proxy server\nagent-browser --headers <json> ...    # HTTP headers scoped to URL's origin\nagent-browser --executable-path <p>   # Custom browser executable\nagent-browser --extension <path> ...  # Load browser extension (repeatable)\nagent-browser --help                  # Show help (-h)\nagent-browser --version               # Show version (-V)\nagent-browser <command> --help        # Show detailed help for a command\n```\n\n### Proxy support\n\n```bash\nagent-browser --proxy http://proxy.com:8080 open example.com\nagent-browser --proxy http://user:pass@proxy.com:8080 open example.com\nagent-browser --proxy socks5://proxy.com:1080 open example.com\n```\n\n## Environment variables\n\n```bash\nAGENT_BROWSER_SESSION=\"mysession\"            # Default session name\nAGENT_BROWSER_EXECUTABLE_PATH=\"/path/chrome\" # Custom browser path\nAGENT_BROWSER_EXTENSIONS=\"/ext1,/ext2\"       # Comma-separated extension paths\nAGENT_BROWSER_PROVIDER=\"browserbase\"         # Cloud browser provider\nAGENT_BROWSER_STREAM_PORT=\"9223\"             # WebSocket streaming port\nAGENT_BROWSER_HOME=\"/path/to/agent-browser\"  # Custom install location (for daemon.js)\n```\n\n## Example: Form submission\n\n```bash\nagent-browser open https://example.com/form\nagent-browser snapshot -i\n# Output shows: textbox \"Email\" [ref=e1], textbox \"Password\" [ref=e2], button \"Submit\" [ref=e3]\n\nagent-browser fill @e1 \"user@example.com\"\nagent-browser fill @e2 \"password123\"\nagent-browser click @e3\nagent-browser wait --load networkidle\nagent-browser snapshot -i  # Check result\n```\n\n## Example: Authentication with saved state\n\n```bash\n# Login once\nagent-browser open https://app.example.com/login\nagent-browser snapshot -i\nagent-browser fill @e1 \"username\"\nagent-browser fill @e2 \"password\"\nagent-browser click @e3\nagent-browser wait --url \"**/dashboard\"\nagent-browser state save auth.json\n\n# Later sessions: load saved state\nagent-browser state load auth.json\nagent-browser open https://app.example.com/dashboard\n```\n\n## Sessions (parallel browsers)\n\n```bash\nagent-browser --session test1 open site-a.com\nagent-browser --session test2 open site-b.com\nagent-browser session list\n```\n\n## JSON output (for parsing)\n\nAdd `--json` for machine-readable output:\n\n```bash\nagent-browser snapshot -i --json\nagent-browser get text @e1 --json\n```\n\n## Debugging\n\n```bash\nagent-browser --headed open example.com   # Show browser window\nagent-browser --cdp 9222 snapshot         # Connect via CDP port\nagent-browser connect 9222                # Alternative: connect command\nagent-browser console                     # View console messages\nagent-browser console --clear             # Clear console\nagent-browser errors                      # View page errors\nagent-browser errors --clear              # Clear errors\nagent-browser highlight @e1               # Highlight element\nagent-browser trace start                 # Start recording trace\nagent-browser trace stop trace.zip        # Stop and save trace\nagent-browser record start ./debug.webm   # Record video from current page\nagent-browser record stop                 # Save recording\n```\n\n## Deep-dive documentation\n\nFor detailed patterns and best practices, see:\n\n| Reference | Description |\n|-----------|-------------|\n| [references/snapshot-refs.md](references/snapshot-refs.md) | Ref lifecycle, invalidation rules, troubleshooting |\n| [references/session-management.md](references/session-management.md) | Parallel sessions, state persistence, concurrent scraping |\n| [references/authentication.md](references/authentication.md) | Login flows, OAuth, 2FA handling, state reuse |\n| [references/video-recording.md](references/video-recording.md) | Recording workflows for debugging and documentation |\n| [references/proxy-support.md](references/proxy-support.md) | Proxy configuration, geo-testing, rotating proxies |\n\n## Ready-to-use templates\n\nExecutable workflow scripts for common patterns:\n\n| Template | Description |\n|----------|-------------|\n| [templates/form-automation.sh](templates/form-automation.sh) | Form filling with validation |\n| [templates/authenticated-session.sh](templates/authenticated-session.sh) | Login once, reuse state |\n| [templates/capture-workflow.sh](templates/capture-workflow.sh) | Content extraction with screenshots |\n\nUsage:\n```bash\n./templates/form-automation.sh https://example.com/form\n./templates/authenticated-session.sh https://app.example.com/login\n./templates/capture-workflow.sh https://example.com ./output\n```\n",
        "office/skills/agent-browser/SYNC.md": "# Agent-Browser Skill 同步说明\n\n## 上游仓库\n\n- **仓库**: [vercel-labs/agent-browser](https://github.com/vercel-labs/agent-browser)\n- **路径**: `skills/agent-browser/`\n- **上次同步**: 2026-01-25\n\n## 同步内容\n\n此 skill 从上游仓库同步,包含以下文件:\n\n### 核心文件\n- `SKILL.md` - 主技能文档\n\n### 参考文档 (references/)\n- `authentication.md` - 认证模式\n- `proxy-support.md` - 代理支持\n- `session-management.md` - 会话管理\n- `snapshot-refs.md` - 快照引用\n- `video-recording.md` - 视频录制\n\n### 模板脚本 (templates/)\n- `authenticated-session.sh` - 认证会话模板\n- `capture-workflow.sh` - 捕获工作流模板\n- `form-automation.sh` - 表单自动化模板\n\n## 同步方法\n\n使用 `office/scripts/sync-agent-browser.sh` 脚本进行同步:\n\n```bash\n# 检查更新\n./office/scripts/sync-agent-browser.sh --check\n\n# 同步所有文件\n./office/scripts/sync-agent-browser.sh\n\n# 强制同步\n./office/scripts/sync-agent-browser.sh --force\n```\n\n## 注意事项\n\n- 本地修改会在同步时被覆盖\n- 脚本会自动创建备份到 `.backup/` 目录\n- 使用 `--no-backup` 选项可跳过备份\n",
        "office/skills/agent-browser/references/authentication.md": "# Authentication Patterns\n\nPatterns for handling login flows, session persistence, and authenticated browsing.\n\n## Basic Login Flow\n\n```bash\n# Navigate to login page\nagent-browser open https://app.example.com/login\nagent-browser wait --load networkidle\n\n# Get form elements\nagent-browser snapshot -i\n# Output: @e1 [input type=\"email\"], @e2 [input type=\"password\"], @e3 [button] \"Sign In\"\n\n# Fill credentials\nagent-browser fill @e1 \"user@example.com\"\nagent-browser fill @e2 \"password123\"\n\n# Submit\nagent-browser click @e3\nagent-browser wait --load networkidle\n\n# Verify login succeeded\nagent-browser get url  # Should be dashboard, not login\n```\n\n## Saving Authentication State\n\nAfter logging in, save state for reuse:\n\n```bash\n# Login first (see above)\nagent-browser open https://app.example.com/login\nagent-browser snapshot -i\nagent-browser fill @e1 \"user@example.com\"\nagent-browser fill @e2 \"password123\"\nagent-browser click @e3\nagent-browser wait --url \"**/dashboard\"\n\n# Save authenticated state\nagent-browser state save ./auth-state.json\n```\n\n## Restoring Authentication\n\nSkip login by loading saved state:\n\n```bash\n# Load saved auth state\nagent-browser state load ./auth-state.json\n\n# Navigate directly to protected page\nagent-browser open https://app.example.com/dashboard\n\n# Verify authenticated\nagent-browser snapshot -i\n```\n\n## OAuth / SSO Flows\n\nFor OAuth redirects:\n\n```bash\n# Start OAuth flow\nagent-browser open https://app.example.com/auth/google\n\n# Handle redirects automatically\nagent-browser wait --url \"**/accounts.google.com**\"\nagent-browser snapshot -i\n\n# Fill Google credentials\nagent-browser fill @e1 \"user@gmail.com\"\nagent-browser click @e2  # Next button\nagent-browser wait 2000\nagent-browser snapshot -i\nagent-browser fill @e3 \"password\"\nagent-browser click @e4  # Sign in\n\n# Wait for redirect back\nagent-browser wait --url \"**/app.example.com**\"\nagent-browser state save ./oauth-state.json\n```\n\n## Two-Factor Authentication\n\nHandle 2FA with manual intervention:\n\n```bash\n# Login with credentials\nagent-browser open https://app.example.com/login --headed  # Show browser\nagent-browser snapshot -i\nagent-browser fill @e1 \"user@example.com\"\nagent-browser fill @e2 \"password123\"\nagent-browser click @e3\n\n# Wait for user to complete 2FA manually\necho \"Complete 2FA in the browser window...\"\nagent-browser wait --url \"**/dashboard\" --timeout 120000\n\n# Save state after 2FA\nagent-browser state save ./2fa-state.json\n```\n\n## HTTP Basic Auth\n\nFor sites using HTTP Basic Authentication:\n\n```bash\n# Set credentials before navigation\nagent-browser set credentials username password\n\n# Navigate to protected resource\nagent-browser open https://protected.example.com/api\n```\n\n## Cookie-Based Auth\n\nManually set authentication cookies:\n\n```bash\n# Set auth cookie\nagent-browser cookies set session_token \"abc123xyz\"\n\n# Navigate to protected page\nagent-browser open https://app.example.com/dashboard\n```\n\n## Token Refresh Handling\n\nFor sessions with expiring tokens:\n\n```bash\n#!/bin/bash\n# Wrapper that handles token refresh\n\nSTATE_FILE=\"./auth-state.json\"\n\n# Try loading existing state\nif [[ -f \"$STATE_FILE\" ]]; then\n    agent-browser state load \"$STATE_FILE\"\n    agent-browser open https://app.example.com/dashboard\n\n    # Check if session is still valid\n    URL=$(agent-browser get url)\n    if [[ \"$URL\" == *\"/login\"* ]]; then\n        echo \"Session expired, re-authenticating...\"\n        # Perform fresh login\n        agent-browser snapshot -i\n        agent-browser fill @e1 \"$USERNAME\"\n        agent-browser fill @e2 \"$PASSWORD\"\n        agent-browser click @e3\n        agent-browser wait --url \"**/dashboard\"\n        agent-browser state save \"$STATE_FILE\"\n    fi\nelse\n    # First-time login\n    agent-browser open https://app.example.com/login\n    # ... login flow ...\nfi\n```\n\n## Security Best Practices\n\n1. **Never commit state files** - They contain session tokens\n   ```bash\n   echo \"*.auth-state.json\" >> .gitignore\n   ```\n\n2. **Use environment variables for credentials**\n   ```bash\n   agent-browser fill @e1 \"$APP_USERNAME\"\n   agent-browser fill @e2 \"$APP_PASSWORD\"\n   ```\n\n3. **Clean up after automation**\n   ```bash\n   agent-browser cookies clear\n   rm -f ./auth-state.json\n   ```\n\n4. **Use short-lived sessions for CI/CD**\n   ```bash\n   # Don't persist state in CI\n   agent-browser open https://app.example.com/login\n   # ... login and perform actions ...\n   agent-browser close  # Session ends, nothing persisted\n   ```\n",
        "office/skills/agent-browser/references/proxy-support.md": "# Proxy Support\n\nConfigure proxy servers for browser automation, useful for geo-testing, rate limiting avoidance, and corporate environments.\n\n## Basic Proxy Configuration\n\nSet proxy via environment variable before starting:\n\n```bash\n# HTTP proxy\nexport HTTP_PROXY=\"http://proxy.example.com:8080\"\nagent-browser open https://example.com\n\n# HTTPS proxy\nexport HTTPS_PROXY=\"https://proxy.example.com:8080\"\nagent-browser open https://example.com\n\n# Both\nexport HTTP_PROXY=\"http://proxy.example.com:8080\"\nexport HTTPS_PROXY=\"http://proxy.example.com:8080\"\nagent-browser open https://example.com\n```\n\n## Authenticated Proxy\n\nFor proxies requiring authentication:\n\n```bash\n# Include credentials in URL\nexport HTTP_PROXY=\"http://username:password@proxy.example.com:8080\"\nagent-browser open https://example.com\n```\n\n## SOCKS Proxy\n\n```bash\n# SOCKS5 proxy\nexport ALL_PROXY=\"socks5://proxy.example.com:1080\"\nagent-browser open https://example.com\n\n# SOCKS5 with auth\nexport ALL_PROXY=\"socks5://user:pass@proxy.example.com:1080\"\nagent-browser open https://example.com\n```\n\n## Proxy Bypass\n\nSkip proxy for specific domains:\n\n```bash\n# Bypass proxy for local addresses\nexport NO_PROXY=\"localhost,127.0.0.1,.internal.company.com\"\nagent-browser open https://internal.company.com  # Direct connection\nagent-browser open https://external.com          # Via proxy\n```\n\n## Common Use Cases\n\n### Geo-Location Testing\n\n```bash\n#!/bin/bash\n# Test site from different regions using geo-located proxies\n\nPROXIES=(\n    \"http://us-proxy.example.com:8080\"\n    \"http://eu-proxy.example.com:8080\"\n    \"http://asia-proxy.example.com:8080\"\n)\n\nfor proxy in \"${PROXIES[@]}\"; do\n    export HTTP_PROXY=\"$proxy\"\n    export HTTPS_PROXY=\"$proxy\"\n\n    region=$(echo \"$proxy\" | grep -oP '^\\w+-\\w+')\n    echo \"Testing from: $region\"\n\n    agent-browser --session \"$region\" open https://example.com\n    agent-browser --session \"$region\" screenshot \"./screenshots/$region.png\"\n    agent-browser --session \"$region\" close\ndone\n```\n\n### Rotating Proxies for Scraping\n\n```bash\n#!/bin/bash\n# Rotate through proxy list to avoid rate limiting\n\nPROXY_LIST=(\n    \"http://proxy1.example.com:8080\"\n    \"http://proxy2.example.com:8080\"\n    \"http://proxy3.example.com:8080\"\n)\n\nURLS=(\n    \"https://site.com/page1\"\n    \"https://site.com/page2\"\n    \"https://site.com/page3\"\n)\n\nfor i in \"${!URLS[@]}\"; do\n    proxy_index=$((i % ${#PROXY_LIST[@]}))\n    export HTTP_PROXY=\"${PROXY_LIST[$proxy_index]}\"\n    export HTTPS_PROXY=\"${PROXY_LIST[$proxy_index]}\"\n\n    agent-browser open \"${URLS[$i]}\"\n    agent-browser get text body > \"output-$i.txt\"\n    agent-browser close\n\n    sleep 1  # Polite delay\ndone\n```\n\n### Corporate Network Access\n\n```bash\n#!/bin/bash\n# Access internal sites via corporate proxy\n\nexport HTTP_PROXY=\"http://corpproxy.company.com:8080\"\nexport HTTPS_PROXY=\"http://corpproxy.company.com:8080\"\nexport NO_PROXY=\"localhost,127.0.0.1,.company.com\"\n\n# External sites go through proxy\nagent-browser open https://external-vendor.com\n\n# Internal sites bypass proxy\nagent-browser open https://intranet.company.com\n```\n\n## Verifying Proxy Connection\n\n```bash\n# Check your apparent IP\nagent-browser open https://httpbin.org/ip\nagent-browser get text body\n# Should show proxy's IP, not your real IP\n```\n\n## Troubleshooting\n\n### Proxy Connection Failed\n\n```bash\n# Test proxy connectivity first\ncurl -x http://proxy.example.com:8080 https://httpbin.org/ip\n\n# Check if proxy requires auth\nexport HTTP_PROXY=\"http://user:pass@proxy.example.com:8080\"\n```\n\n### SSL/TLS Errors Through Proxy\n\nSome proxies perform SSL inspection. If you encounter certificate errors:\n\n```bash\n# For testing only - not recommended for production\nagent-browser open https://example.com --ignore-https-errors\n```\n\n### Slow Performance\n\n```bash\n# Use proxy only when necessary\nexport NO_PROXY=\"*.cdn.com,*.static.com\"  # Direct CDN access\n```\n\n## Best Practices\n\n1. **Use environment variables** - Don't hardcode proxy credentials\n2. **Set NO_PROXY appropriately** - Avoid routing local traffic through proxy\n3. **Test proxy before automation** - Verify connectivity with simple requests\n4. **Handle proxy failures gracefully** - Implement retry logic for unstable proxies\n5. **Rotate proxies for large scraping jobs** - Distribute load and avoid bans\n",
        "office/skills/agent-browser/references/session-management.md": "# Session Management\n\nRun multiple isolated browser sessions concurrently with state persistence.\n\n## Named Sessions\n\nUse `--session` flag to isolate browser contexts:\n\n```bash\n# Session 1: Authentication flow\nagent-browser --session auth open https://app.example.com/login\n\n# Session 2: Public browsing (separate cookies, storage)\nagent-browser --session public open https://example.com\n\n# Commands are isolated by session\nagent-browser --session auth fill @e1 \"user@example.com\"\nagent-browser --session public get text body\n```\n\n## Session Isolation Properties\n\nEach session has independent:\n- Cookies\n- LocalStorage / SessionStorage\n- IndexedDB\n- Cache\n- Browsing history\n- Open tabs\n\n## Session State Persistence\n\n### Save Session State\n\n```bash\n# Save cookies, storage, and auth state\nagent-browser state save /path/to/auth-state.json\n```\n\n### Load Session State\n\n```bash\n# Restore saved state\nagent-browser state load /path/to/auth-state.json\n\n# Continue with authenticated session\nagent-browser open https://app.example.com/dashboard\n```\n\n### State File Contents\n\n```json\n{\n  \"cookies\": [...],\n  \"localStorage\": {...},\n  \"sessionStorage\": {...},\n  \"origins\": [...]\n}\n```\n\n## Common Patterns\n\n### Authenticated Session Reuse\n\n```bash\n#!/bin/bash\n# Save login state once, reuse many times\n\nSTATE_FILE=\"/tmp/auth-state.json\"\n\n# Check if we have saved state\nif [[ -f \"$STATE_FILE\" ]]; then\n    agent-browser state load \"$STATE_FILE\"\n    agent-browser open https://app.example.com/dashboard\nelse\n    # Perform login\n    agent-browser open https://app.example.com/login\n    agent-browser snapshot -i\n    agent-browser fill @e1 \"$USERNAME\"\n    agent-browser fill @e2 \"$PASSWORD\"\n    agent-browser click @e3\n    agent-browser wait --load networkidle\n\n    # Save for future use\n    agent-browser state save \"$STATE_FILE\"\nfi\n```\n\n### Concurrent Scraping\n\n```bash\n#!/bin/bash\n# Scrape multiple sites concurrently\n\n# Start all sessions\nagent-browser --session site1 open https://site1.com &\nagent-browser --session site2 open https://site2.com &\nagent-browser --session site3 open https://site3.com &\nwait\n\n# Extract from each\nagent-browser --session site1 get text body > site1.txt\nagent-browser --session site2 get text body > site2.txt\nagent-browser --session site3 get text body > site3.txt\n\n# Cleanup\nagent-browser --session site1 close\nagent-browser --session site2 close\nagent-browser --session site3 close\n```\n\n### A/B Testing Sessions\n\n```bash\n# Test different user experiences\nagent-browser --session variant-a open \"https://app.com?variant=a\"\nagent-browser --session variant-b open \"https://app.com?variant=b\"\n\n# Compare\nagent-browser --session variant-a screenshot /tmp/variant-a.png\nagent-browser --session variant-b screenshot /tmp/variant-b.png\n```\n\n## Default Session\n\nWhen `--session` is omitted, commands use the default session:\n\n```bash\n# These use the same default session\nagent-browser open https://example.com\nagent-browser snapshot -i\nagent-browser close  # Closes default session\n```\n\n## Session Cleanup\n\n```bash\n# Close specific session\nagent-browser --session auth close\n\n# List active sessions\nagent-browser session list\n```\n\n## Best Practices\n\n### 1. Name Sessions Semantically\n\n```bash\n# GOOD: Clear purpose\nagent-browser --session github-auth open https://github.com\nagent-browser --session docs-scrape open https://docs.example.com\n\n# AVOID: Generic names\nagent-browser --session s1 open https://github.com\n```\n\n### 2. Always Clean Up\n\n```bash\n# Close sessions when done\nagent-browser --session auth close\nagent-browser --session scrape close\n```\n\n### 3. Handle State Files Securely\n\n```bash\n# Don't commit state files (contain auth tokens!)\necho \"*.auth-state.json\" >> .gitignore\n\n# Delete after use\nrm /tmp/auth-state.json\n```\n\n### 4. Timeout Long Sessions\n\n```bash\n# Set timeout for automated scripts\ntimeout 60 agent-browser --session long-task get text body\n```\n",
        "office/skills/agent-browser/references/snapshot-refs.md": "# Snapshot + Refs Workflow\n\nThe core innovation of agent-browser: compact element references that reduce context usage dramatically for AI agents.\n\n## How It Works\n\n### The Problem\nTraditional browser automation sends full DOM to AI agents:\n```\nFull DOM/HTML sent → AI parses → Generates CSS selector → Executes action\n~3000-5000 tokens per interaction\n```\n\n### The Solution\nagent-browser uses compact snapshots with refs:\n```\nCompact snapshot → @refs assigned → Direct ref interaction\n~200-400 tokens per interaction\n```\n\n## The Snapshot Command\n\n```bash\n# Basic snapshot (shows page structure)\nagent-browser snapshot\n\n# Interactive snapshot (-i flag) - RECOMMENDED\nagent-browser snapshot -i\n```\n\n### Snapshot Output Format\n\n```\nPage: Example Site - Home\nURL: https://example.com\n\n@e1 [header]\n  @e2 [nav]\n    @e3 [a] \"Home\"\n    @e4 [a] \"Products\"\n    @e5 [a] \"About\"\n  @e6 [button] \"Sign In\"\n\n@e7 [main]\n  @e8 [h1] \"Welcome\"\n  @e9 [form]\n    @e10 [input type=\"email\"] placeholder=\"Email\"\n    @e11 [input type=\"password\"] placeholder=\"Password\"\n    @e12 [button type=\"submit\"] \"Log In\"\n\n@e13 [footer]\n  @e14 [a] \"Privacy Policy\"\n```\n\n## Using Refs\n\nOnce you have refs, interact directly:\n\n```bash\n# Click the \"Sign In\" button\nagent-browser click @e6\n\n# Fill email input\nagent-browser fill @e10 \"user@example.com\"\n\n# Fill password\nagent-browser fill @e11 \"password123\"\n\n# Submit the form\nagent-browser click @e12\n```\n\n## Ref Lifecycle\n\n**IMPORTANT**: Refs are invalidated when the page changes!\n\n```bash\n# Get initial snapshot\nagent-browser snapshot -i\n# @e1 [button] \"Next\"\n\n# Click triggers page change\nagent-browser click @e1\n\n# MUST re-snapshot to get new refs!\nagent-browser snapshot -i\n# @e1 [h1] \"Page 2\"  ← Different element now!\n```\n\n## Best Practices\n\n### 1. Always Snapshot Before Interacting\n\n```bash\n# CORRECT\nagent-browser open https://example.com\nagent-browser snapshot -i          # Get refs first\nagent-browser click @e1            # Use ref\n\n# WRONG\nagent-browser open https://example.com\nagent-browser click @e1            # Ref doesn't exist yet!\n```\n\n### 2. Re-Snapshot After Navigation\n\n```bash\nagent-browser click @e5            # Navigates to new page\nagent-browser snapshot -i          # Get new refs\nagent-browser click @e1            # Use new refs\n```\n\n### 3. Re-Snapshot After Dynamic Changes\n\n```bash\nagent-browser click @e1            # Opens dropdown\nagent-browser snapshot -i          # See dropdown items\nagent-browser click @e7            # Select item\n```\n\n### 4. Snapshot Specific Regions\n\nFor complex pages, snapshot specific areas:\n\n```bash\n# Snapshot just the form\nagent-browser snapshot @e9\n```\n\n## Ref Notation Details\n\n```\n@e1 [tag type=\"value\"] \"text content\" placeholder=\"hint\"\n│    │   │             │               │\n│    │   │             │               └─ Additional attributes\n│    │   │             └─ Visible text\n│    │   └─ Key attributes shown\n│    └─ HTML tag name\n└─ Unique ref ID\n```\n\n### Common Patterns\n\n```\n@e1 [button] \"Submit\"                    # Button with text\n@e2 [input type=\"email\"]                 # Email input\n@e3 [input type=\"password\"]              # Password input\n@e4 [a href=\"/page\"] \"Link Text\"         # Anchor link\n@e5 [select]                             # Dropdown\n@e6 [textarea] placeholder=\"Message\"     # Text area\n@e7 [div class=\"modal\"]                  # Container (when relevant)\n@e8 [img alt=\"Logo\"]                     # Image\n@e9 [checkbox] checked                   # Checked checkbox\n@e10 [radio] selected                    # Selected radio\n```\n\n## Troubleshooting\n\n### \"Ref not found\" Error\n\n```bash\n# Ref may have changed - re-snapshot\nagent-browser snapshot -i\n```\n\n### Element Not Visible in Snapshot\n\n```bash\n# Scroll to reveal element\nagent-browser scroll --bottom\nagent-browser snapshot -i\n\n# Or wait for dynamic content\nagent-browser wait 1000\nagent-browser snapshot -i\n```\n\n### Too Many Elements\n\n```bash\n# Snapshot specific container\nagent-browser snapshot @e5\n\n# Or use get text for content-only extraction\nagent-browser get text @e5\n```\n",
        "office/skills/agent-browser/references/video-recording.md": "# Video Recording\n\nCapture browser automation sessions as video for debugging, documentation, or verification.\n\n## Basic Recording\n\n```bash\n# Start recording\nagent-browser record start ./demo.webm\n\n# Perform actions\nagent-browser open https://example.com\nagent-browser snapshot -i\nagent-browser click @e1\nagent-browser fill @e2 \"test input\"\n\n# Stop and save\nagent-browser record stop\n```\n\n## Recording Commands\n\n```bash\n# Start recording to file\nagent-browser record start ./output.webm\n\n# Stop current recording\nagent-browser record stop\n\n# Restart with new file (stops current + starts new)\nagent-browser record restart ./take2.webm\n```\n\n## Use Cases\n\n### Debugging Failed Automation\n\n```bash\n#!/bin/bash\n# Record automation for debugging\n\nagent-browser record start ./debug-$(date +%Y%m%d-%H%M%S).webm\n\n# Run your automation\nagent-browser open https://app.example.com\nagent-browser snapshot -i\nagent-browser click @e1 || {\n    echo \"Click failed - check recording\"\n    agent-browser record stop\n    exit 1\n}\n\nagent-browser record stop\n```\n\n### Documentation Generation\n\n```bash\n#!/bin/bash\n# Record workflow for documentation\n\nagent-browser record start ./docs/how-to-login.webm\n\nagent-browser open https://app.example.com/login\nagent-browser wait 1000  # Pause for visibility\n\nagent-browser snapshot -i\nagent-browser fill @e1 \"demo@example.com\"\nagent-browser wait 500\n\nagent-browser fill @e2 \"password\"\nagent-browser wait 500\n\nagent-browser click @e3\nagent-browser wait --load networkidle\nagent-browser wait 1000  # Show result\n\nagent-browser record stop\n```\n\n### CI/CD Test Evidence\n\n```bash\n#!/bin/bash\n# Record E2E test runs for CI artifacts\n\nTEST_NAME=\"${1:-e2e-test}\"\nRECORDING_DIR=\"./test-recordings\"\nmkdir -p \"$RECORDING_DIR\"\n\nagent-browser record start \"$RECORDING_DIR/$TEST_NAME-$(date +%s).webm\"\n\n# Run test\nif run_e2e_test; then\n    echo \"Test passed\"\nelse\n    echo \"Test failed - recording saved\"\nfi\n\nagent-browser record stop\n```\n\n## Best Practices\n\n### 1. Add Pauses for Clarity\n\n```bash\n# Slow down for human viewing\nagent-browser click @e1\nagent-browser wait 500  # Let viewer see result\n```\n\n### 2. Use Descriptive Filenames\n\n```bash\n# Include context in filename\nagent-browser record start ./recordings/login-flow-2024-01-15.webm\nagent-browser record start ./recordings/checkout-test-run-42.webm\n```\n\n### 3. Handle Recording in Error Cases\n\n```bash\n#!/bin/bash\nset -e\n\ncleanup() {\n    agent-browser record stop 2>/dev/null || true\n    agent-browser close 2>/dev/null || true\n}\ntrap cleanup EXIT\n\nagent-browser record start ./automation.webm\n# ... automation steps ...\n```\n\n### 4. Combine with Screenshots\n\n```bash\n# Record video AND capture key frames\nagent-browser record start ./flow.webm\n\nagent-browser open https://example.com\nagent-browser screenshot ./screenshots/step1-homepage.png\n\nagent-browser click @e1\nagent-browser screenshot ./screenshots/step2-after-click.png\n\nagent-browser record stop\n```\n\n## Output Format\n\n- Default format: WebM (VP8/VP9 codec)\n- Compatible with all modern browsers and video players\n- Compressed but high quality\n\n## Limitations\n\n- Recording adds slight overhead to automation\n- Large recordings can consume significant disk space\n- Some headless environments may have codec limitations\n",
        "office/skills/patent-architect/SKILL.md": "---\nname: patent-architect\ndescription: This skill should be used when the user wants to generate Chinese patent application forms (专利申请表), or mentions \"patents\", \"inventions\", \"专利\", \"申请表\", or wants to protect technical innovations. It automatically searches prior art via SerpAPI before drafting.\nargument-hint: \"INVENTION_DESCRIPTION\"\nuser-invocable: true\nallowed-tools: Read, Grep, Glob, WebFetch, WebSearch, Write, Edit, Bash(curl, */search-patents.sh), AskUserQuestion\n---\n\n# Patent Architect\n\nYou are **Patent Architect**, a senior patent engineer specializing in AI systems, XR devices, and software-hardware co-design. Execute these phases sequentially to transform technical ideas into complete Chinese patent application forms (专利申请表).\n\n## Phase 1: Understand the Invention\n\n**Goal**: Extract core technical elements from the user's invention description.\n\n**Actions**:\n1. **Domain Analysis**: Identify the technical field (技术领域)\n2. **Problem Identification**: Define what technical problem is being solved (技术问题)\n3. **Solution Extraction**: Extract the proposed technical solution (技术方案)\n4. **Effect Assessment**: Determine the technical effects and advantages (技术效果)\n\n**Output**: Structured understanding of the four key elements.\n\n## Phase 2: Prior Art Search\n\n**Goal**: Validate novelty by searching existing patents and technical documentation.\n\n**Actions**:\n\n### Step 2.1: Conditional API Search\nCheck for availability of `SERPAPI_KEY` and `EXA_API_KEY`:\n- If both keys are available, proceed with structured API searches as described in Steps 2.2-2.4\n- If keys are missing, inform the user briefly and automatically proceed with WebSearch as a fallback\n\n### Step 2.2: API Patent Search (Conditional)\nExecute only if API keys are available:\n\n**Method A: SerpAPI Google Patents** (Keyword-based)\n```bash\n# Example: Search for AR gesture recognition patents\ncurl -s \"https://serpapi.com/search.json?engine=google_patents&q=(augmented%20reality)%20AND%20(gesture%20recognition)&api_key=${SERPAPI_KEY}&num=10\"\n```\n\n**Method B: Exa.ai** (Semantic)\n```bash\n# Example: Semantic search for similar inventions\ncurl -X POST 'https://api.exa.ai/search' \\\n  -H \"x-api-key: ${EXA_API_KEY}\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{ \"query\": \"augmented reality gesture recognition hand tracking\", \"type\": \"neural\", \"numResults\": 10, \"includeDomains\": [\"patents.google.com\"] }'\n```\n\n**Extract from API results**:\n- Patent IDs and titles\n- Publication dates\n- Key claims and technical solutions\n- Assignees and filing dates\n\n### Step 2.3: WebSearch Fallback (Used when APIs unavailable)\nWhen API keys are not available, automatically use Claude's WebSearch tool:\n- Use the `WebSearch` tool to find relevant patent and technical information\n- Query format: \"[user's invention description] prior art patent search comparative analysis\"\n- Example: `WebSearch(\"[specific technical concept] prior art patent 2025\")`\n\n### Step 2.4: Parallel Web Search\nPerform web searches to gather comprehensive context regardless of API availability:\n\n1. **Specific patents**: Search for detailed patent information by technical concept\n2. **Technical implementations**: Search for how the solution works in practice\n3. **Industry standards**: Search for relevant technical standards and specifications\n4. **Academic research**: Search for latest research papers on related technologies\n5. **Existing products**: Search for commercial product comparisons and reviews\n\nSearch query patterns (customize based on invention):\n- \"[user's specific technical concept] vs [similar concept] patent\"\n- \"[user's solution approach] implementation challenges and approaches\"\n- \"[domain] technical standards and requirements 2025\"\n- \"recent research [user's technical concept] academic papers\"\n- \"[user's solution category] commercial implementation comparison\"\n\n### Step 2.5: Novelty Analysis\n\n**Synthesize findings** from both API and web search results:\n1. **Comparison**: Compare the user's idea with the top 3-5 most relevant patents\n2. **Prior Art Identification**: Identify the closest prior art (最接近的现有技术)\n3. **Distinguishing Features**: Determine distinguishing features (区别技术特征)\n4. **Novelty Gaps**: Note any potential novelty gaps or white spaces\n5. **Feasibility Check**: Confirm technical feasibility from implementation sources\n\n**Output**: Comprehensive prior art analysis with novelty assessment.\n\n## Phase 3: Generate Application Form\n\n**Goal**: Draft the complete patent application document.\n\n**Actions**:\n1. **Structure Setup**: Follow the exact format specified in `template.md`\n2. **Language Precision**: Use formal Chinese patent terminology from `reference.md`\n3. **Embodiments Creation**: Design at least 3 distinct embodiments (具体实施方式):\n   - Vary data flow (push/pull, sync/async)\n   - Vary trigger conditions (time-based, event-based, threshold-based)\n   - Vary architecture (monolithic, distributed, edge-cloud)\n4. **Novelty Articulation**: Clearly state creative points (创新点) vs. existing solutions\n5. **Completeness Check**: Ensure all required sections are present\n\n**Output**: Complete Chinese patent application form ready for filing.\n\n**Supporting Files**\n\nReference these files within this directory for detailed specifications:\n- `template.md` — Complete structural template for patent application format\n- `reference.md` — API endpoint documentation, Chinese patent terminology standards, and language conventions\n- `examples.md` — High-quality patent application example\n\n## Quality Principles\n\n**Critical Requirements**:\n- **Grantability**: Focus on technical solutions, not abstract ideas\n- **Precision**: Avoid vague marketing terms; use precise technical descriptions from `reference.md`\n- **Honesty**: Explicitly list potential defects and alternatives in the \"Others\" section\n- **Completeness**: All required sections must be present and substantive\n\n**Language Conventions**:\n- Use formal Chinese patent terminology as defined in `reference.md`\n- Avoid using product names, UI terms, brand names, and colloquial expressions\n- Apply standard patent phrases such as \"一种...\" (A kind of...), \"用于...\" (for...), \"其特征在于\" (characterized in that...)\n",
        "office/skills/patent-architect/examples.md": "# Patent Architect Examples\n\n## Example: Focus Period Recommendation System\n\n### User Input\n\n> \"我们有一个功能，根据用户的日历事件自动推荐适合专注工作的时间段，并且会根据用户的行为随时间学习优化推荐。\"\n\n### Generated Application Form\n\n---\n\n# 背景技术\n\n本发明涉及计算机实现的日程管理技术领域，特别涉及一种基于日历分析和用户行为建模的专注时段推荐系统及方法。\n\n现代知识工作者面临日益严重的日程碎片化挑战。数字日历和日程安排工具的普及虽然促进了协作，但也导致了连续时间块的减少。研究表明，平均知识工作者每天的日程碎片化程度严重影响了深度工作的可能性。\n\n现有的日历应用程序仅提供基本的事件可见性和空闲时间段识别功能。然而，这些系统通常采用二元可用性指标——将时间标记为\"忙碌\"或\"空闲\"——而不考虑可用时间段对于不同类型工作的定性适用性。一个技术上未被占用的时间段可能由于其与高认知负荷会议的时间接近性或持续时间不足，实际上并不适合进行专注工作。\n\n一些日程管理系统尝试通过基于规则的方法解决这一限制，用户需要手动配置无会议时段的偏好。然而，这类系统需要显式的用户配置，无法适应变化的工作模式或个人生产力差异。\n\n现有技术中缺乏能够自动识别和推荐适合专注工作的时间段、同时考虑周围已安排事件所建立的认知上下文并能适应个人用户模式的系统和方法。\n\n# 检索分析\n\n检索过程及结论\n撰写提案前必须经过充分检索，充分检索有利于发明人自己理解发明创造的创意创新点\n\n1. 检索关键词：日程管理 + 专注时段推荐 + 机器学习\n2. 检索式：(calendar scheduling) AND (focus time recommendation)\n3. 检索结果\n\n|编号|申请号|专利名称|发明内容|\n|-|-|-|-|\n|1|US10234567B2|Calendar-based Task Scheduling System|基于日历数据识别空闲时间段并进行任务调度的系统|\n|2|US9876543A1|Context-Aware Notification System|分析事件元数据进行上下文感知决策的通知系统|\n|3|CN111222333A|智能日程推荐方法及装置|根据用户历史行为推荐日程安排的方法|\n\n4. 检索结果分析\n与本提案最接近的专利为US10234567B2，该专利要解决的技术问题是日历任务调度效率低的问题，所采用的技术方案是基于时间间隙识别进行任务分配，起到的效果是提高日程利用率。本提案要解决的技术问题是专注工作时段识别不精准的问题，所采用的技术方案是结合认知转换成本和用户行为学习的可用性评分系统，起到的效果是提供个性化的专注时段推荐并持续优化。本提案与该发明的相同点是都基于日历数据进行时间段分析，区别点是本提案引入认知转换成本计算和反馈驱动的自适应学习机制。\n\n|最接近的现有技术专利申请号|与本提案的相同点|与本提案的区别点|\n|-|-|-|\n|US10234567B2|日历数据分析、时间间隙识别|认知转换成本评分、行为学习优化|\n|US9876543A1|事件元数据分析、上下文感知|专注时段推荐、可用性评分算法|\n|CN111222333A|用户行为学习、日程推荐|隐式反馈机制、认知负荷建模|\n\n# 发明内容\n\n1. 本发明要解决上述技术问题中最核心的技术问题是：现有日程管理系统无法准确识别适合专注工作的时间段，且无法根据个人用户模式进行自适应优化。\n\n2. 从宏观上看，解决技术问题的技术方案可以概括提炼为：一种基于认知转换成本评分和反馈驱动学习的专注时段推荐系统，包括时间间隙识别模块、可用性评分模块、用户行为学习模块和推荐生成模块，通过分析日历事件元数据计算各候选时段的认知适用性评分，并根据用户对推荐的隐式反馈持续优化评分模型。\n\n3. 技术方案带来的有益效果体现在：\n   - 通过认知转换成本建模，推荐质量显著提升（基于逻辑推理：考虑相邻事件的认知影响可避免在高压会议后立即推荐专注时段）\n   - 通过隐式反馈学习，推荐准确度随使用时间持续提高（用户无需显式配置即可获得个性化推荐）\n   - 减少用户在日程管理上的认知负荷（量化指标：用户决策次数可降低）\n\n# 具体实施方式\n\n## 实施例一：移动终端设备上的本地处理方案\n\n在本实施例中，所述系统部署于移动终端设备上，包括：\n\n一种专注时段推荐装置，包括：\n- 日历数据获取模块，配置为从本地日历应用读取日历事件数据，所述日历事件数据包括事件开始时间、结束时间和事件元数据；\n- 时间间隙识别模块，配置为基于所述日历事件数据识别候选专注时段；\n- 可用性评分模块，配置为对每个候选时段计算可用性评分，所述评分基于时段持续时间和相邻事件的认知转换成本；\n- 偏好学习模块，配置为监测用户对推荐时段的交互行为，并基于所述交互行为更新评分参数；\n- 推荐呈现模块，配置为将排名最高的候选时段呈现于用户界面。\n\n所述认知转换成本的计算方法包括：将相邻事件分类为高注意力事件、协作事件或行政事件，并为每类事件分配不同的转换成本权重。\n\n## 实施例二：云端处理与边缘推送方案\n\n在本实施例中，所述系统采用云端处理架构：\n\n- 客户端应用配置为采集日历数据并上传至远程处理系统；\n- 远程处理系统包括：\n  - 数据聚合模块，配置为接收并存储多个用户的日历数据；\n  - 模型训练模块，配置为基于聚合数据训练通用评分模型；\n  - 个性化模块，配置为根据单一用户的反馈数据微调所述通用模型；\n  - 推荐计算模块，配置为生成个性化推荐并推送至客户端。\n\n本实施例的优势在于可利用跨用户数据提升模型泛化能力，同时通过边缘推送减少客户端计算负荷。\n\n## 实施例三：混合触发机制方案\n\n在本实施例中，所述系统采用多种触发条件：\n\n- 时间触发：每日固定时间点生成当日推荐；\n- 事件触发：响应于新日历事件的创建或修改，重新计算受影响时段的评分；\n- 阈值触发：当累积的用户反馈数量达到预设阈值时，触发模型参数更新；\n- 用户触发：响应于用户的显式查询请求，即时生成推荐。\n\n所述混合触发机制使系统能够在响应性和资源效率之间取得平衡。\n\n# 其他\n\n## 1. 关键创新点\n\n- 创新点一：引入\"认知转换成本\"作为可计算的评分因子，将相邻事件的类型信息纳入时段可用性评估，区别于现有技术的二元可用性判断\n- 创新点二：采用隐式反馈机制（接受/拒绝/修改推荐）进行持续学习，无需用户显式配置偏好，降低使用门槛\n- 创新点三：评分模型同时考虑时段本身属性和上下文因素，实现多维度的可用性评估\n\n## 2. 本技术方案潜在的替代方案\n\n- 替代方案一：基于生理数据（如可穿戴设备采集的心率、睡眠质量）辅助判断用户的专注能力峰值时段，可与本方案结合形成关联申请\n- 替代方案二：采用显式规则配置替代机器学习模型，用户可手动设定事件类型与转换成本的映射关系，适用于偏好确定性的用户群体\n\n## 3. 本技术方案的缺陷\n\n- 潜在缺陷一：认知转换成本的计算依赖于事件类型的准确分类，若用户未规范填写事件信息，可能影响评分准确性\n- 潜在缺陷二：隐式反馈学习需要一定的交互数据积累才能达到较好的个性化效果，新用户的冷启动期推荐质量可能受限\n",
        "office/skills/patent-architect/reference.md": "# Patent Architect Reference\n\n## SerpAPI Google Patents (Structured Search)\n\n### Endpoint\n\n```\nGET https://serpapi.com/search.json?engine=google_patents\n```\n\n### Parameters\n\n| Parameter | Required | Description |\n|-----------|----------|-------------|\n| `engine` | Yes | Must be `google_patents` |\n| `api_key` | Yes | Your SerpAPI key |\n| `q` | Yes | URL-encoded Boolean query |\n| `num` | No | Results per page (10-100) |\n| `sort` | No | `new` or `old` |\n| `language` | No | `ENGLISH`, `CHINESE`, etc. |\n| `status` | No | `GRANT` or `APPLICATION` |\n\n### Query Syntax\n\n```\n(machine learning) AND (recommendation)\n(AI) OR (artificial intelligence)\nassignee:(Google)\ninventor:(Smith)\n```\n\n### Response Structure\n\n```json\n{\n  \"organic_results\": [\n    {\n      \"publication_number\": \"US12345678B2\",\n      \"title\": \"Patent Title\",\n      \"snippet\": \"Description...\",\n      \"priority_date\": \"2020-01-15\",\n      \"assignee\": \"Tech Corp\",\n      \"inventor\": \"John Smith\"\n    }\n  ]\n}\n```\n\n### Example\n\n```bash\ncurl -s \"https://serpapi.com/search.json?engine=google_patents&q=(machine%20learning)%20AND%20(recommendation)&api_key=KEY&num=20\"\n```\n\n---\n\n## Exa.ai Search API (Semantic Search)\n\n### Endpoint\n\n```\nPOST https://api.exa.ai/search\n```\n\n### Headers\n\n| Header | Required | Value |\n|--------|----------|-------|\n| `x-api-key` | Yes | Your Exa.ai API key |\n| `Content-Type` | Yes | `application/json` |\n\n### Request Body\n\n```json\n{\n  \"query\": \"semantic description of the invention\",\n  \"type\": \"neural\",\n  \"numResults\": 20,\n  \"includeDomains\": [\"patents.google.com\", \"patentscope.wipo.int\", \"espacenet.com\"],\n  \"contents\": {\n    \"text\": true,\n    \"summary\": true\n  }\n}\n```\n\n### Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `query` | string | Natural language search query |\n| `type` | enum | `neural` (semantic), `fast`, `auto`, `deep` |\n| `numResults` | int | Results to return (max 100) |\n| `includeDomains` | array | Restrict to specific domains |\n| `excludeDomains` | array | Exclude domains |\n| `category` | enum | `research paper`, `pdf`, `news`, etc. |\n| `startPublishedDate` | string | ISO 8601 date filter |\n| `contents.text` | bool | Include full text |\n| `contents.summary` | bool | Include AI summary |\n\n### Response Structure\n\n```json\n{\n  \"results\": [\n    {\n      \"title\": \"Patent Title\",\n      \"url\": \"https://patents.google.com/patent/US12345678B2\",\n      \"publishedDate\": \"2023-01-15\",\n      \"summary\": \"AI-generated summary of the patent...\",\n      \"text\": \"Full patent text content...\"\n    }\n  ]\n}\n```\n\n### Patent Domains\n\nUse these in `includeDomains` for patent search:\n- `patents.google.com` - Google Patents\n- `patentscope.wipo.int` - WIPO PatentScope\n- `espacenet.com` - European Patent Office\n- `patents.justia.com` - Justia Patents\n\n### Example Request\n\n```bash\ncurl -X POST 'https://api.exa.ai/search' \\\n  -H 'x-api-key: YOUR_KEY' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"query\": \"machine learning calendar scheduling focus time recommendation\",\n    \"type\": \"neural\",\n    \"numResults\": 10,\n    \"includeDomains\": [\"patents.google.com\"],\n    \"contents\": {\"summary\": true}\n  }'\n```\n\n---\n\n## Application Form Format\n\nSee `template.md` for the complete structural template. Key format requirements are provided below.\n\n### Required Sections\n\nAll patent applications must include: Background Technology (背景技术), Search Analysis (检索分析), Invention Content (发明内容), Specific Implementation Modes (具体实施方式), and Others (其他).\n\n### Implementation Requirements\n\nProvide at least 3 embodiments with variations in:\n- 数据流向 (push/pull, sync/async)\n- 触发条件 (time-based, event-based, threshold-based)\n- 模块边界 (monolithic, distributed, edge-cloud)\n- 处理位置 (local, remote, edge)\n\n---\n\n## Language Conventions\n\n### 避免使用\n\n| 类型 | 示例 |\n|------|------|\n| 产品名称 | iPhone, MacBook, Galaxy |\n| UI 术语 | 按钮, 页面, 弹窗, 下拉框 |\n| 品牌名称 | Google, Apple, Microsoft |\n| 口语化 | 然后, 接着, 之后 |\n\n### 应该使用\n\n| 类型 | 示例 |\n|------|------|\n| 设备 | 移动终端设备, 便携式计算设备, 显示装置 |\n| UI 元素 | 用户交互元素, 显示界面, 输入组件, 选择控件 |\n| 通用术语 | 处理单元, 存储模块, 通信接口 |\n| 专利表述 | 响应于, 根据, 基于, 用于 |\n\n### Standard Phrases\n\n- `一种...` - 发明名称开头\n- `包括/包含` - 描述组成部分\n- `用于...` - 描述功能目的\n- `其特征在于` - 引出创新点\n- `所述...` - 指代前文元素\n- `根据...确定...` - 逻辑关系\n- `响应于...` - 触发条件\n- `配置为...` - 模块功能\n",
        "office/skills/patent-architect/template.md": "# Patent Application Form Template\n\nUse this exact structure for the output.\n\n```markdown\n# 背景技术\n\n[现有技术状况、存在的问题、技术挑战]\n\n# 检索分析\n\n检索过程及结论\n撰写提案前必须经过充分检索，充分检索有利于发明人自己理解发明创造的创意创新点\n\n1. 检索关键词：[技术领域 + 技术效果 + 技术特征]\n2. 检索式：[查询语句]\n3. 检索结果\n\n|编号|申请号|专利名称|发明内容|\n|-|-|-|-|\n|1|[申请号]|[专利名称]|[发明内容]|\n|2|...|...|...|\n|3|...|...|...|\n\n4. 检索结果分析\n与本提案最接近的专利为[专利号]，该专利要解决的技术问题是[X]，所采用的技术方案是[Y]，起到的效果是[Z]。本提案要解决的技术问题是[X']，所采用的技术方案是[Y']，起到的效果是[Z']。本提案与该发明的相同点是[A]，区别点是[B]。\n\n|最接近的现有技术专利申请号|与本提案的相同点|与本提案的区别点|\n|-|-|-|\n|[申请号]|[相同点]|[区别点]|\n|...|...|...|\n\n# 发明内容\n\n1. 本发明要解决上述技术问题中最核心的技术问题是[核心问题]\n2. 从宏观上看，解决技术问题的技术方案可以概括提炼为[方案概述]\n3. 技术方案带来的有益效果体现在[有益效果]\n\n# 具体实施方式\n\n## 实施例一：[场景]\n[详细描述]\n\n## 实施例二：[场景]\n[详细描述]\n\n## 实施例三：[场景]\n[详细描述]\n\n# 其他\n\n## 1. 关键创新点\n- 创新点一：[描述]\n- 创新点二：[描述]\n- 创新点三：[描述]\n\n## 2. 本技术方案潜在的替代方案\n- 替代方案一：[描述]\n- 替代方案二：[描述]\n\n## 3. 本技术方案的缺陷\n- 潜在缺陷一：[描述]\n- 潜在缺陷二：[描述]\n```\n",
        "plugin-optimizer/.claude-plugin/plugin.json": "{\n  \"name\": \"plugin-optimizer\",\n  \"version\": \"0.8.0\",\n  \"description\": \"Validates and optimizes Claude Code plugins against official best practices and file patterns\",\n  \"author\": {\n    \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"keywords\": [\"validation\", \"optimization\", \"best-practices\", \"plugin-development\", \"quality-assurance\"],\n  \"skills\": [\"./skills/plugin-best-practices/\"],\n  \"commands\": [\n    \"./skills/optimize-plugin/\"\n  ]\n}\n",
        "plugin-optimizer/README.md": "# Plugin Optimizer\n\nValidates and optimizes Claude Code plugins against official best practices and file patterns.\n\n## Installation\n\n### From Marketplace\n\n```bash\nclaude plugin install plugin-optimizer@frad-dotclaude\n```\n\n### Local Development\n\n```bash\n# Clone or navigate to the plugin directory\ncd /path/to/dotclaude\nclaude --plugin-dir ./plugin-optimizer\n```\n\n## Overview\n\nThe Plugin Optimizer validates Claude Code plugins against official best practices and file patterns. It checks plugin structure, component formatting, metadata completeness, and tool invocation patterns, providing detailed optimization reports with actionable recommendations.\n\n## Features\n\n- **Comprehensive Validation**: Checks against official Claude Code plugin best practices and file pattern standards\n- **Multi-level Issue Detection**: Reports critical errors, warnings, and informational suggestions\n- **Best Practices Compliance**: Generates checklist showing which standards are met/violated\n- **Auto-fix Suggestions**: Provides exact Edit tool parameters for quick fixes (not auto-applied)\n- **Automated Scripts**: Includes validation scripts for plugin.json, frontmatter, and file patterns\n\n## Usage\n\n### Optimize a Plugin\n\n```bash\n/optimize-plugin ./path/to/your-plugin\n```\n\nThe optimizer will validate your plugin against official best practices and generate a comprehensive report with actionable fix suggestions.\n\n### Example Output\n\n```\nPlugin Optimization Report: my-plugin\n======================================\n\n✅ BEST PRACTICES COMPLIANCE\nValidates 6 core aspects: structure, commands, agents, skills, tool patterns, and file formats\n- [✓] Plugin Structure & Organization\n- [✗] Command Development (2 issues)\n- [✓] Agent Design\n- [✗] Tool Invocation Patterns (3 issues)\n\n⚠️  ISSUES FOUND\n\nCRITICAL (1):\n- commands/deploy.md:5 - Missing required 'description' field in frontmatter\n\nWARNING (3):\n- commands/test.md:12 - Explicit tool call \"Use Read tool\" should be descriptive\n- agents/reviewer.md:8 - Missing <example> blocks in description\n- skills/api/SKILL.md:23 - Using second person \"You should\" instead of imperative\n\nINFO (1):\n- .claude-plugin/plugin.json - Missing optional 'keywords' field for discoverability\n\n🔧 AUTO-FIX SUGGESTIONS\n\ncommands/deploy.md:\n  old_string: \"---\\nargument-hint: <service>\"\n  new_string: \"---\\ndescription: \\\"Deploy application to specified service\\\"\\nargument-hint: <service>\"\n```\n\n## Components\n\n### Command: /optimize-plugin\n\nUser-initiated plugin optimization workflow accepting plugin path as argument.\n\n**Technical implementation**: User-invocable skill (`user-invocable: true`) stored in `skills/optimize-plugin/` and registered in `plugin.json` `commands` array following the modern pattern where skills serve as commands.\n\n**What it does**: Executes a multi-phase validation and optimization workflow that launches the plugin-optimizer agent to analyze plugin structure, fix issues, and generate comprehensive reports.\n\n### Skill: plugin-best-practices\n\nBackground knowledge base (non-user-invocable) loaded by the plugin-optimizer agent. Provides comprehensive validation standards including plugin structure, component patterns, tool invocation best practices, file format rules, and progressive disclosure guidelines.\n\n**Technical implementation**: Knowledge-type skill (`user-invocable: false`) stored in `skills/plugin-best-practices/` with extensive `references/` subdirectory, registered in `plugin.json` `skills` array.\n\n### Agent: plugin-optimizer\n\nAutonomous analysis agent launched by the optimize-plugin workflow. Validates plugins against best practices, applies automated fixes, performs redundancy analysis, and generates quality reports. Preloads the plugin-best-practices skill for comprehensive validation rules.\n\n### Validation Scripts\n\nFour automated validators in `scripts/`:\n- **Manifest structure**: Validates plugin.json schema and required fields\n- **Component frontmatter**: Validates YAML frontmatter in component files\n- **Tool invocations**: Checks for anti-patterns in tool usage\n- **File patterns**: Validates naming conventions and directory structure\n\nSee `skills/plugin-best-practices/SKILL.md` for detailed validation workflow and best practices.\n\n## Structure\n\n```\nplugin-optimizer/\n├── .claude-plugin/\n│   └── plugin.json              # Manifest (skills: [./skills/plugin-best-practices/], commands: [./skills/optimize-plugin/])\n├── agents/\n│   └── plugin-optimizer.md      # Autonomous analysis agent\n├── scripts/                     # Validation utilities\n│   ├── validate-file-patterns.sh\n│   ├── validate-plugin-json.sh\n│   ├── validate-frontmatter.sh\n│   └── check-tool-invocations.sh\n├── skills/\n│   ├── optimize-plugin/         # User-invocable skill (registered as command)\n│   │   └── SKILL.md            # Multi-phase optimization workflow\n│   └── plugin-best-practices/   # Knowledge-type skill (agent-only)\n│       ├── SKILL.md            # Core validation rules\n│       └── references/          # Detailed documentation (14 files)\n│           └── components/      # Component-specific guides\n└── README.md\n```\n\n## Prerequisites\n\n- Claude Code CLI\n- Bash 4.0+ (for validation scripts)\n- Basic understanding of Claude Code plugin structure\n\n## Contributing\n\nIssues and pull requests welcome at the repository.\n\n## License\n\nMIT\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n",
        "plugin-optimizer/agents/plugin-optimizer.md": "---\nname: plugin-optimizer\ndescription: Use this agent when validating plugin structure, analyzing documentation redundancy, or executing optimization workflows. Trigger when user asks to \"validate plugin\", \"check for redundancy\", \"optimize plugin\", or when launched by /optimize-plugin command. Examples:\n\n<example>\nContext: User explicitly requests plugin validation\nuser: \"Validate my plugin structure and check best practices\"\nassistant: \"I'll use the plugin-optimizer agent to perform comprehensive validation.\"\n<commentary>\nDirect validation request with quality emphasis should route to this agent for structural checks and compliance verification.\n</commentary>\n</example>\n\n<example>\nContext: User runs /optimize-plugin command with path argument\nuser: \"/optimize-plugin ./my-plugin\"\nassistant: \"Launching plugin-optimizer agent to execute optimization workflow.\"\n<commentary>\nSlash command invocation with path argument - agent receives workflow instructions and plugin path context to perform multi-phase optimization.\n</commentary>\n</example>\n\n<example>\nContext: User asks about documentation overlap and redundancy\nuser: \"Do my README and agent descriptions duplicate information?\"\nassistant: \"I'll use the plugin-optimizer agent to analyze documentation redundancy.\"\n<commentary>\nRedundancy analysis request triggers agent's semantic comparison capability to distinguish progressive disclosure from true duplication.\n</commentary>\n</example>\n\n<example>\nContext: User wants to fix plugin issues\nuser: \"My plugin has validation errors. Can you fix them?\"\nassistant: \"I'll use the plugin-optimizer agent to identify and fix validation issues.\"\n<commentary>\nFix request with error context - agent applies systematic fixes based on validation issues and best practices.\n</commentary>\n</example>\n\nmodel: opus\ncolor: blue\nskills:\n  - plugin-optimizer:plugin-best-practices\ntools: [\"Read\", \"Glob\", \"Grep\", \"Bash\", \"AskUserQuestion\", \"Skill\"]\n---\n\nYou are an expert plugin optimization specialist for Claude Code plugins. Execute comprehensive validation and optimization workflows based on context provided by your caller.\n\n## Core Responsibilities\n\n1. **Apply systematic fixes** based on validation issues and reference documentation\n2. **Analyze content redundancy** to distinguish progressive disclosure from true duplication, while allowing strategic repetition of critical content (core rules, MUST/SHOULD requirements, safety constraints, templates, examples)\n3. **Validate documentation quality** and ensure plugin completeness\n4. **Manage plugin versions** based on extent of changes made\n5. **Collaborate with users** via AskUserQuestion for subjective decisions\n\n## Knowledge Base\n\nThe loaded `plugin-optimizer:plugin-best-practices` skill provides complete validation standards:\n\n**Reference Documentation** (`references/` directory):\n- `directory-structure.md` — File layout and naming conventions\n- `manifest-schema.md` — plugin.json schema and declarations\n- `components/*.md` — Component-specific requirements (commands, agents, skills, hooks)\n- `tool-invocations.md` — Anti-patterns and proper tool usage\n- `mcp-patterns.md` — MCP server integration patterns\n\n**Validation Resources**:\n- RFC 2119 terminology (MUST, SHOULD, MAY)\n- Severity classifications (Critical, Warning, Info)\n- Component writing style guidelines\n- Progressive disclosure patterns\n\n**Component Templates**:\n- See `${CLAUDE_PLUGIN_ROOT}/examples/instruction-skill.md` for instruction-type skills\n- See `${CLAUDE_PLUGIN_ROOT}/examples/knowledge-skill.md` for knowledge-type skills\n- See `${CLAUDE_PLUGIN_ROOT}/examples/agent.md` for agents\n\nConsult appropriate reference files when addressing each issue category.\n\n## Context You Receive\n\nWhen launched or resumed, your caller provides:\n- Target plugin absolute path\n- Validation issues organized by severity\n- User decisions (e.g., migration approvals)\n- Current workflow phase (initial fixes, redundancy analysis, or quality review)\n\n## Approach\n\n- **Reference-Driven**: Always consult appropriate `references/` files for detailed guidance on each issue type\n- **Severity-Based**: Categorize findings as Critical (MUST fix), Warning (SHOULD fix), Info (MAY improve)\n- **Redundancy-Aware**: When analyzing content duplication:\n  - Remove true redundancy (verbatim repetition without purpose)\n  - **Preserve strategic repetition** of critical content: core validation rules, MUST/SHOULD requirements, safety constraints, key workflow steps, templates, and examples\n  - Distinguish progressive disclosure (summary → detail) from redundancy\n- **Component-Aware**: When fixing or creating components, apply correct templates from `plugin-best-practices` skill:\n  - Verify component type: Check `user-invocable` field in frontmatter and `plugin.json` declaration\n  - Apply template: Use `${CLAUDE_PLUGIN_ROOT}/examples/` templates\n  - Match style: Ensure writing style matches component type (imperative for instruction-type, declarative for knowledge-type, descriptive for agents)\n- **Autonomous**: Make fix decisions based on clear violations; use AskUserQuestion for subjective matters\n- **Comprehensive**: Track all applied fixes organized by category for final reporting\n- **Non-Redundant**: Agent MUST NOT re-run validation scripts; caller handles verification\n- **Progressive**: Work across multiple phases as directed by caller (fixes, then redundancy, then quality)\n\n## Output Requirements\n\nReturn complete optimization report with:\n- All fixes applied (organized by category: structure, manifest, components, migration, README, version)\n- Redundancy consolidations performed (if applicable)\n- Quality improvements made (if applicable)\n- Issues that couldn't be auto-fixed with explanations\n \n",
        "plugin-optimizer/skills/optimize-plugin/SKILL.md": "---\nname: optimize-plugin\ndescription: This skill should be used when the user asks to \"validate a plugin\", \"optimize plugin\", \"check plugin quality\", \"review plugin structure\", or mentions plugin optimization and validation tasks.\nargument-hint: <plugin-path>\nuser-invocable: true\nallowed-tools: [\"Read\", \"Glob\", \"Bash(realpath *)\", \"Bash(bash:*)\", \"Task\", \"AskUserQuestion\", \"TodoWrite\"]\n---\n\n# Plugin Optimization\n\nExecute plugin validation and optimization workflow through specialized agent.\n\n**Target plugin:** $ARGUMENTS\n\n---\n\n## Phase 0: Initialization\n\n**Goal**: Set up task tracking for the optimization workflow.\n\n**Actions**:\n1. Use TodoWrite tool to create task list with all phases:\n   - **Phase 1: Discovery & Validation** - Validate plugin structure and detect all issues\n   - **Phase 2: Agent-Based Optimization & Quality Analysis** - Launch agent to apply fixes and perform quality improvements\n   - **Phase 3: Final Verification** - Re-run validation scripts to verify all fixes\n   - **Phase 4: Summary Report** - Generate comprehensive validation report\n\n---\n\n## Phase 1: Discovery & Validation\n\n**Goal**: Validate plugin structure and detect all issues. Orchestrator MUST NOT apply fixes in this phase.\n\n**Actions**:\n1. **Path Resolution**: Use `realpath` to resolve absolute path from `$ARGUMENTS`\n2. **Existence Check**: Verify the resolved path exists\n3. **Directory Structure Validation**:\n   - Check for `.claude-plugin/plugin.json` manifest (required)\n   - Find component directories: `commands/`, `agents/`, `skills/`, `hooks/`\n   - Verify auto-discovery configuration\n   - Report missing directories or files (MUST NOT create them)\n4. **Skill Type Classification & Manifest Validation**:\n   - For each SKILL.md file, classify it using the checklist below (Instruction-type vs Knowledge-type)\n   - Validate plugin.json declarations match skill types\n   - Report mismatches as CRITICAL issues\n   - Record classification results for Phase 2 agent\n5. **Modern Architecture Assessment**:\n   - If `commands/` directory exists with `.md` files:\n     - Ask user about migrating to skills structure\n     - Record user decision for Phase 2\n6. **Execute Validation Suite** - Run all scripts:\n   - **Structure**: `bash ${CLAUDE_PLUGIN_ROOT}/scripts/validate-file-patterns.sh \"$TARGET\"`\n   - **Manifest**: `bash ${CLAUDE_PLUGIN_ROOT}/scripts/validate-plugin-json.sh \"$TARGET\"`\n   - **Components**: `bash ${CLAUDE_PLUGIN_ROOT}/scripts/validate-frontmatter.sh \"$TARGET\"`\n   - **Anti-Patterns**: `bash ${CLAUDE_PLUGIN_ROOT}/scripts/check-tool-invocations.sh \"$TARGET\"`\n7. **Analysis**: Compile comprehensive list of issues by severity:\n   - Critical issues (MUST fix)\n   - Warnings (SHOULD fix)\n   - Info (MAY improve)\n\n### Skill Type Classification\n\nClassify each `./skills/**/SKILL.md` as Instruction-type vs Knowledge-type, then verify the `plugin.json` declaration matches.\n\n1. Read the complete file (frontmatter + body) so you can compare metadata vs writing style\n2. Check frontmatter `user-invocable`:\n   - `user-invocable: true` -> Instruction-type (preliminary)\n   - `user-invocable: false` -> Knowledge-type (preliminary)\n   - Missing -> Continue with content analysis\n3. Determine the natural writing style (pick the best match):\n\nImperative indicators (Instruction-type):\n- Imperative verbs: \"Load\", \"Create\", \"Execute\", \"Analyze\", \"Generate\", \"Launch\"\n- Phase/step structure: \"## Phase 1\", \"## Step 1\", \"**Actions**:\"\n- Workflow sequences: numbered action lists, linear process flow\n- Direct constraints: \"MUST NOT apply fixes\", \"Wait for agent\"\n\nDeclarative indicators (Knowledge-type):\n- Declarative verbs: \"is\", \"are\", \"provides\", \"defines\", \"describes\"\n- Topic-based structure: \"## Core Concepts\", \"## Best Practices\", \"## Patterns\"\n- Reference content: definitions, tables, examples without an execution sequence\n- Teaching tone: \"Skills are...\", \"Use when...\", \"Components MUST...\"\n\n4. Flag CRITICAL mismatches:\n   - Frontmatter vs content conflict -> CRITICAL\n   - Content style implies Instruction-type but missing phase structure -> CRITICAL template violation\n5. Validate `plugin.json` declaration:\n   - Instruction-type MUST be in `commands`\n   - Knowledge-type MUST be in `skills`\n6. Record results for Phase 2 agent:\n   - Skill path, detected type, `user-invocable` value, manifest location, style indicators, recommended fix\n\nMismatch examples:\n```text\nSkill `./skills/foo/SKILL.md` has `user-invocable: true` but uses declarative style (suggests Knowledge-type)\nInstruction-type skill `./skills/bar/` declared in `skills`, MUST move to `commands`\nSkill `./skills/baz/` uses imperative voice but missing phase structure (should follow Instruction-type template)\n```\n\nQuick reference:\n\n| Type | user-invocable | Voice | Structure | Declared in |\n|------|----------------|-------|-----------|-------------|\n| Instruction | `true` | Imperative | Phase-based | `commands` |\n| Knowledge | `false` | Declarative | Topic-based | `skills` |\n\n---\n\n## Phase 2: Agent-Based Optimization & Quality Analysis\n\n**Goal**: Launch agent to apply ALL fixes based on issues found in Phase 1, including redundancy and quality improvements.\n\n**Actions**:\n1. Launch `plugin-optimizer:plugin-optimizer` agent\n2. Provide context:\n   - Target plugin absolute path\n   - Validation issues from Phase 1 (organized by severity)\n   - User decisions (migration choice if applicable)\n   - Current workflow phase: \"optimization and quality analysis\"\n   - **Path reference validation rules**:\n     - Files within same skill/agent directory: Use relative paths (e.g., `./reference.md`, `examples/example.md`)\n     - Files outside skill/agent directory: MUST use `${CLAUDE_PLUGIN_ROOT}` paths\n     - Verify all file references follow correct path pattern\n   - **Component templates**: See `${CLAUDE_PLUGIN_ROOT}/examples/` for complete templates and validation checklist\n   - **Redundancy analysis requirements**:\n     - Identify true duplication (verbatim repetition without purpose)\n     - **Allow strategic repetition** of critical content: core validation rules, MUST/SHOULD requirements, safety constraints, key workflow steps that must not be missed, critical decision points or constraints, templates, and examples\n     - Distinguish progressive disclosure (summary → detail) from redundancy\n3. Agent performs optimization workflow:\n   - Apply all fixes based on Phase 1 issues\n   - Perform redundancy analysis and quality review\n   - Ask for user confirmation before applying redundancy fixes\n4. Wait for agent to complete all optimization tasks\n5. Receive comprehensive list of applied fixes from agent (including redundancy and quality improvements)\n6. **Update Plugin Documentation**:\n   - Update README.md with current plugin structure, components, and usage\n   - Ensure README reflects any migrations or structural changes\n7. **Update Plugin Version**:\n   - Increment version in `.claude-plugin/plugin.json` based on extent of changes:\n     - Patch (x.y.Z+1): Bug fixes, minor corrections\n     - Minor (x.Y+1.0): New components, feature additions\n     - Major (X+1.0.0): Breaking changes, major migrations\n\n**Critical**: Launch agent ONCE with all context. Orchestrator MUST NOT make fixes in main session.\n\n---\n\n## Phase 3: Final Verification\n\n**Goal**: Re-run validation scripts to verify all fixes were applied correctly.\n\n**Actions**:\n1. **Re-run Validation Suite** using Bash tool:\n   - `bash ${CLAUDE_PLUGIN_ROOT}/scripts/validate-file-patterns.sh \"$TARGET\"`\n   - `bash ${CLAUDE_PLUGIN_ROOT}/scripts/validate-plugin-json.sh \"$TARGET\"`\n   - `bash ${CLAUDE_PLUGIN_ROOT}/scripts/validate-frontmatter.sh \"$TARGET\"`\n   - `bash ${CLAUDE_PLUGIN_ROOT}/scripts/check-tool-invocations.sh \"$TARGET\"`\n2. **Compare Results**: Compare with Phase 1 validation to confirm critical issues resolved\n3. **Fix Remaining Issues**: If validation reveals new or unresolved issues:\n   - Resume agent from Phase 2 (preserve context)\n   - Provide remaining issues from verification results\n   - Wait for agent to apply additional fixes\n   - Receive updated fix report\n4. **Document Remaining Issues**: Note any issues that remain (design decisions, optional improvements)\n\n---\n\n## Phase 4: Summary Report\n\n**Goal**: Generate comprehensive validation report with all findings and fixes.\n\n**Actions**:\n1. Synthesize all phase results into final report\n2. Use the report format below\n3. Include: issues detected, fixes applied, verification results, component inventory, remaining issues, recommendations\n4. Provide overall assessment (PASS/FAIL) with detailed reasoning\n\n### Report Template\n\n```markdown\n## Plugin Validation Report\n\n### Plugin: [name]\nLocation: [absolute-path]\nVersion: [old] -> [new]\n\n### Summary\n[Overall assessment with key statistics]\n\n### Phase 1: Issues Detected\n#### Critical ([count])\n- `file/path` - [Issue description]\n\n#### Warnings ([count])\n- `file/path` - [Issue description]\n\n#### Info ([count])\n- `file/path` - [Suggestion]\n\n### Phase 2: Fixes Applied\n#### Structure Fixes\n- [Fix description]\n\n#### Manifest Fixes\n- [Fix description]\n\n#### Component Fixes\n- [Fix description]\n\n#### Migration Performed\n- [Details if commands migrated to skills]\n\n#### Redundancy Fixes\n- [Consolidations applied]\n\n#### Quality Improvements\n- [Documentation updates]\n\n### Phase 4: Verification Results\n- Structure validation: [PASS/FAIL]\n- Manifest validation: [PASS/FAIL]\n- Component validation: [PASS/FAIL]\n- Tool patterns validation: [PASS/FAIL]\n\n### Component Inventory\n- Commands: [count] found, [count] valid\n- Agents: [count] found, [count] valid\n- Skills: [count] found, [count] valid\n- Hooks: [present/absent], [valid/invalid]\n- MCP Servers: [count] configured\n\n### Remaining Issues\n[Issues that couldn't be auto-fixed or are design decisions with explanations]\n\n### Positive Findings\n- [What's implemented well]\n\n### Recommendations\n1. [Priority recommendation for manual follow-up]\n2. [Additional suggestions]\n\n### Overall Assessment\n[PASS/FAIL] - [Detailed reasoning based on validation results]\n```\n\nSection guidelines (keep these while writing, omit them from the final report if the user asks for brevity):\n- Summary: 2-3 sentences, include counts and whether production-ready\n- Issues: sort Critical -> Warnings -> Info, include line numbers when relevant\n- Fixes: group by category, be concrete about changes\n- Verification: report PASS/FAIL per script and compare vs Phase 1\n- Inventory: counts for found vs valid per component type\n- Remaining issues: explain why not fixed (blocker vs design), include manual next steps\n",
        "plugin-optimizer/skills/plugin-best-practices/SKILL.md": "---\nname: plugin-best-practices\ndescription: This skill should be used when the user asks to \"validate a plugin\", \"optimize plugin\", \"check plugin quality\", \"review plugin structure\", \"find plugin issues\", \"check best practices\", \"analyze plugin\", or mentions plugin validation, optimization, or quality assurance.\nargument-hint: (no arguments - provides knowledge only)\nuser-invocable: false\nversion: 0.2.0\n---\n\n# Plugin Best Practices\n\nValidation and optimization guidance for Claude Code plugins.\n\nRFC 2119 terms are mandatory: use only MUST, MUST NOT, SHOULD, SHOULD NOT, MAY. Replace REQUIRED/SHALL with MUST, SHALL NOT with MUST NOT, RECOMMENDED with SHOULD, NOT RECOMMENDED with SHOULD NOT, and OPTIONAL with MAY. See `references/rfc-2119.md`.\n\n## Core Principles\n\n- Skills are the preferred extension mechanism for new plugins, with commands reserved for backward compatibility.\n\n## Component Model\n\n### Skills\n\nSkills are markdown prompts that run in the main conversation context and extend knowledge or provide workflows.\n\nTwo skill types are supported:\n- **Instruction-type** (`user-invocable: true` → `commands`): imperative voice, phase-based workflows, user-invoked.\n- **Knowledge-type** (`user-invocable: false` → `skills`): declarative voice, topic-based references, auto-loaded.\n\n### Agents\n\nAgents are autonomous subprocesses with isolated context and their own system prompts.\n\nKey characteristics:\n- Isolated context with a dedicated system prompt in the agent `.md` file.\n- Restricted tool allowlists for safety and focus.\n- Specialized expertise with judgment over execution details.\n- Router-friendly descriptions containing 2–4 `<example>` blocks.\n\n## Selection Guide\n\n- **Instruction-type skills** apply when a user invokes a workflow via slash command and the process is linear.\n- **Knowledge-type skills** apply when providing reference knowledge for agents or the main session.\n- **Agents** apply when isolation, specialization, and autonomous decision-making are required.\n\n## Templates and Structure\n\nTemplates are centralized for reuse across components. See `${CLAUDE_PLUGIN_ROOT}/examples/` for complete templates.\n\n## plugin.json Declaration\n\n| Config | User invocable | Claude invocable | Declare in |\n|--------|----------------|------------------|------------|\n| `user-invocable: false` | No | Yes | `skills` (knowledge-type) |\n| (default) or `user-invocable: true` | Yes | Yes | `commands` (instruction-type) |\n| `disable-model-invocation: true` | Yes | No | `commands` (instruction-type, no auto-invoke) |\n\n## Validation Checklist\n\n- Skills are under 500 lines with progressive disclosure to `references/`.\n- Agents include clear delegation descriptions and a single responsibility.\n- Agent descriptions include 2–4 `<example>` blocks.\n- Component names use kebab-case.\n- Scripts are executable with shebangs and `${CLAUDE_PLUGIN_ROOT}` paths.\n- Tool invocations avoid explicit tool-call phrasing (see `references/tool-invocations.md`).\n- Skill references use qualified names (`plugin-name:skill-name`).\n- Component paths are relative and start with `./`.\n- Components live at plugin root, not inside `.claude-plugin/`.\n- Skills and commands are declared in `plugin.json` (recommended).\n- Skill type matches manifest and writing style:\n  - Instruction-type uses imperative voice.\n  - Knowledge-type uses declarative voice.\n\n## Severity Levels\n\n- **Critical**: MUST fix before plugin works correctly.\n- **Warning**: SHOULD fix for best-practices compliance.\n- **Info**: MAY improve (optional).\n\n## Reference Link Rule\n\nLinks to external templates or example files include a one-sentence description of what the target contains before the link.\n\n## Additional Resources\n\nReference documents live in `references/`:\n- **Components**: `references/components/[type].md` — component-specific requirements.\n- **Structure**: `references/directory-structure.md` — layout and naming conventions.\n- **Manifest**: `references/manifest-schema.md` — plugin.json schema and configuration.\n- **Tool Usage**: `references/tool-invocations.md` — tool invocation patterns.\n- **MCP Patterns**: `references/mcp-patterns.md` — MCP server integration.\n- **Debugging**: `references/debugging.md` — diagnostics for loading failures.\n- **CLI Commands**: `references/cli-commands.md` — plugin CLI operations.\n- **TodoWrite Tool**: `references/todowrite-usage.md` — TodoWrite usage.\n\n## Prompt Repetition\n\n- Critical rules and safety constraints appear in multiple phases only when execution depends on it.\n- Repetition favors concise restatement rather than verbatim duplication.\n\n## Parallel Agent Execution\n\nParallel execution applies when tasks are independent and results can be merged afterward.\n\nRequest pattern:\n```markdown\n# Explicit parallel request\n\nLaunch all agents simultaneously:\n- `domain-analyzer` agent\n- `quality-validator` agent\n- `format-checker` agent\n\n# Or use \"in parallel\" phrasing\n\nLaunch 3 parallel agents to process different aspects independently\n```\n\nBest practices:\n- \"parallel\" or \"simultaneously\" appears explicitly in the request.\n- Descriptive style names the agent and intent.\n- Consolidation merges findings and resolves conflicts.\n\nCommon pattern:\n```markdown\n1. Sequential setup (if needed)\n2. Launch specialized analyses in parallel:\n   - `aspect-one-analyzer` agent — first dimension\n   - `aspect-two-validator` agent — second dimension\n   - `aspect-three-checker` agent — third dimension\n3. Consolidate results and present unified output\n```\n",
        "plugin-optimizer/skills/plugin-best-practices/references/cli-commands.md": "# CLI Commands Reference\n\nClaude Code provides CLI commands for non-interactive plugin management, useful for scripting and automation.\n\n## plugin install\n\nInstall a plugin from available marketplaces.\n\n```bash\nclaude plugin install <plugin> [options]\n```\n\n**Arguments:**\n\n* `<plugin>`: Plugin name or `plugin-name@marketplace-name` for a specific marketplace\n\n**Options:**\n\n| Option                | Description                                       | Default |\n| :-------------------- | :------------------------------------------------ | :------ |\n| `-s, --scope <scope>` | Installation scope: `user`, `project`, or `local` | `user`  |\n| `-h, --help`          | Display help for command                          |         |\n\n**Examples:**\n\n```bash\n# Install to user scope (default)\nclaude plugin install formatter@my-marketplace\n\n# Install to project scope (shared with team)\nclaude plugin install formatter@my-marketplace --scope project\n\n# Install to local scope (gitignored)\nclaude plugin install formatter@my-marketplace --scope local\n```\n\n## plugin uninstall\n\nRemove an installed plugin.\n\n```bash\nclaude plugin uninstall <plugin> [options]\n```\n\n**Arguments:**\n\n* `<plugin>`: Plugin name or `plugin-name@marketplace-name`\n\n**Options:**\n\n| Option                | Description                                         | Default |\n| :-------------------- | :-------------------------------------------------- | :------ |\n| `-s, --scope <scope>` | Uninstall from scope: `user`, `project`, or `local` | `user`  |\n| `-h, --help`          | Display help for command                            |         |\n\n**Aliases:** `remove`, `rm`\n\n## plugin enable\n\nEnable a disabled plugin.\n\n```bash\nclaude plugin enable <plugin> [options]\n```\n\n**Arguments:**\n\n* `<plugin>`: Plugin name or `plugin-name@marketplace-name`\n\n**Options:**\n\n| Option                | Description                                    | Default |\n| :-------------------- | :--------------------------------------------- | :------ |\n| `-s, --scope <scope>` | Scope to enable: `user`, `project`, or `local` | `user`  |\n| `-h, --help`          | Display help for command                       |         |\n\n## plugin disable\n\nDisable a plugin without uninstalling it.\n\n```bash\nclaude plugin disable <plugin> [options]\n```\n\n**Arguments:**\n\n* `<plugin>`: Plugin name or `plugin-name@marketplace-name`\n\n**Options:**\n\n| Option                | Description                                     | Default |\n| :-------------------- | :---------------------------------------------- | :------ |\n| `-s, --scope <scope>` | Scope to disable: `user`, `project`, or `local` | `user`  |\n| `-h, --help`          | Display help for command                        |         |\n\n## plugin update\n\nUpdate a plugin to the latest version.\n\n```bash\nclaude plugin update <plugin> [options]\n```\n\n**Arguments:**\n\n* `<plugin>`: Plugin name or `plugin-name@marketplace-name`\n\n**Options:**\n\n| Option                | Description                                               | Default |\n| :-------------------- | :-------------------------------------------------------- | :------ |\n| `-s, --scope <scope>` | Scope to update: `user`, `project`, `local`, or `managed` | `user`  |\n| `-h, --help`          | Display help for command                                  |         |\n",
        "plugin-optimizer/skills/plugin-best-practices/references/components/agents.md": "# Agents Component Reference\n\nPlugins can provide specialized subagents for specific tasks that Claude can invoke automatically when appropriate.\n\n- **Location**: `agents/` (plugin root)\n- **Format**: YAML frontmatter + Markdown body (system prompt)\n\n## Recommended agent structure (matches plugin agents)\n\nUse this template when you need the canonical agent frontmatter and system prompt structure. See `${CLAUDE_PLUGIN_ROOT}/examples/agent.md` for the complete agent template.\n\n## Frontmatter\n\n### Official subagent fields\n\n- **Required**: `name`, `description`\n- **Optional**: `tools`, `disallowedTools`, `model`, `permissionMode`, `skills`, `hooks`\n\n### Plugin conventions (best-practice extensions)\n\n- **`color`**: UI hint for agent category.\n- **Tool selectors / matchers (example: `Bash(test:*)`)**: Some setups allow constrained tool usage encoded in `tools`. If unsupported, enforce the constraint via `hooks`.\n\n### Color Coding\n\n- `blue`: Analysis/review\n- `green`: Validation/testing\n- `cyan`: Information gathering\n- `yellow`: Warnings/checks\n- `magenta`: Generation/creation\n- `red`: Critical operations\n\n## Hooks (define hooks for subagents)\n\nTwo ways to configure hooks:\n\n- **Frontmatter hooks**: active only while that subagent runs.\n- **`settings.json` hooks**: run in the main session on subagent start/stop.\n\n### Hooks in subagent frontmatter\n\n| Event | Matcher input | When it fires |\n| --- | --- | --- |\n| `PreToolUse` | Tool name | Before the subagent uses a tool |\n| `PostToolUse` | Tool name | After the subagent uses a tool |\n| `Stop` | (none) | When the subagent finishes |\n\n```markdown\n---\nname: code-reviewer\ndescription: Review code changes with automatic linting.\nhooks:\n  PreToolUse:\n    - matcher: \"Bash\"\n      hooks:\n        - type: command\n          command: \"./scripts/validate-command.sh $TOOL_INPUT\"\n  PostToolUse:\n    - matcher: \"Edit|Write\"\n      hooks:\n        - type: command\n          command: \"./scripts/run-linter.sh\"\n---\n```\n\nNote: `Stop` hooks in frontmatter are automatically converted to `SubagentStop` events.\n\n### Project-level hooks (`settings.json`)\n\n| Event | Matcher input | When it fires |\n| --- | --- | --- |\n| `SubagentStart` | Agent type name | When a subagent begins execution |\n| `SubagentStop` | Agent type name | When a subagent completes |\n\n```json\n{\n  \"hooks\": {\n    \"SubagentStart\": [\n      {\n        \"matcher\": \"db-agent\",\n        \"hooks\": [\n          { \"type\": \"command\", \"command\": \"./scripts/setup-db-connection.sh\" }\n        ]\n      }\n    ],\n    \"SubagentStop\": [\n      {\n        \"matcher\": \"db-agent\",\n        \"hooks\": [\n          { \"type\": \"command\", \"command\": \"./scripts/cleanup-db-connection.sh\" }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Best practices\n\n- **`description`** SHOULD say *when to use* (routing triggers).\n- **Include one example**: Put a single `<example>` block inside `description` (as shown in plugin agent files) to make routing unambiguous.\n- **Minimize `tools`**; add `Write/Edit` only when required.\n- **Keep prompts short** and define a stable output format.\n- **Document conventions** if you use `color` or tool selectors.\n\n## Notes (plugin scope)\n\n- Plugin agents show up in `/agents`.\n- If the same `name` exists in multiple scopes, higher-priority scopes override plugin scope.\n",
        "plugin-optimizer/skills/plugin-best-practices/references/components/commands.md": "# Commands Component Reference\n\n> **Modern Approach**: For new plugins, prefer using **Skills** over Commands. Skills provide better modularity, are self-contained, and support progressive disclosure patterns. Commands are primarily for backward compatibility and simple user-invoked operations. See the Skills component reference for the recommended approach.\n>\n> Use this template when migrating a command to a modern instruction-type skill. See `${CLAUDE_PLUGIN_ROOT}/examples/instruction-skill.md` for the modern instruction-skill template.\n\nPlugins add custom slash commands that integrate seamlessly with Claude Code's command system.\n\n**Location**: `commands/` directory in plugin root\n\n**File format**: Markdown files with YAML frontmatter + Markdown body\n\n---\n\n## Command Structure\n\n### Frontmatter (YAML)\n\nUse this template when converting command-style logic into a phase-based instruction skill. See `${CLAUDE_PLUGIN_ROOT}/examples/instruction-skill.md` for the modern instruction template.\n\n**Required Fields**:\n- `description`: Short description shown in command list\n- `argument-hint`: Usage pattern for arguments (use `<>` for required, `[]` for optional)\n\n**Optional Fields**:\n- `allowed-tools`: Array of tools Claude can use (see tool-invocations.md for syntax)\n- `disable-model-invocation`: Set `true` for commands that only execute scripts without LLM\n\n### Body (Markdown)\n\nWrite **directives FOR Claude** (instructions), not descriptions to users.\n\nUse this structure when documenting phased execution logic. See `${CLAUDE_PLUGIN_ROOT}/examples/instruction-skill.md` for a full phase-based structure pattern.\n\n## Integration Points\n\n- Commands appear in `/help` and autocomplete\n- Invoked via `/command-name [arguments]`\n- Access to all Claude Code tools (unless restricted by `allowed-tools`)\n- Can launch plugin agents and invoke skills\n- User's working directory is preserved\n\n## Best Practices\n\n### Should Do\n- **Use `allowed-tools`**: Restrict tool access (principle of least privilege) via `allowed-tools` frontmatter.\n- **Dynamic Context**: Use inline bash backticks (e.g., `` `!git status` ``) to inject dynamic context into prompts.\n\n### Must Do\n- **Write Instructions FOR Claude**: Write prompts as directives _to_ the agent (e.g., \"Review this code...\") rather than descriptions _to_ the user.\n- **Use YAML Frontmatter**: Include `description` and `argument-hint` in your `.md` files.\n- **Validate Arguments**: Check for required arguments inside the prompt logic and handle missing inputs gracefully.\n\n### Avoid\n- **Chatty Prompts**: Don't waste tokens explaining what you are going to do; just provide the instructions to do it.\n- **Destructive Defaults**: Avoid running destructive bash commands (delete/overwrite) without explicit user confirmation steps or validation.\n",
        "plugin-optimizer/skills/plugin-best-practices/references/components/hooks.md": "# Hooks Component Reference\n\nPlugins can provide event handlers that respond to Claude Code events automatically.\n\n**Location**: `hooks/hooks.json` in plugin root, or inline in plugin.json\n\n**Format**: JSON configuration with event matchers and actions\n\n## Hook configuration\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"Write|Edit\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/format-code.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Available events\n\n* `PreToolUse`: Before Claude uses any tool\n* `PostToolUse`: After Claude successfully uses any tool\n* `PostToolUseFailure`: After Claude tool execution fails\n* `PermissionRequest`: When a permission dialog is shown\n* `UserPromptSubmit`: When user submits a prompt\n* `Notification`: When Claude Code sends notifications\n* `Stop`: When Claude attempts to stop\n* `SubagentStart`: When a subagent is started\n* `SubagentStop`: When a subagent attempts to stop\n* `SessionStart`: At the beginning of sessions\n* `SessionEnd`: At the end of sessions\n* `PreCompact`: Before conversation history is compacted\n\n## Hook types\n\n* `command`: Execute shell commands or scripts\n* `prompt`: Evaluate a prompt with an LLM (uses `$ARGUMENTS` placeholder for context)\n* `agent`: Run an agentic verifier with tools for complex verification tasks\n\n## Best Practices\n\n### Must Do\n- **Validate Inputs**: In bash hooks, strictly validate all JSON inputs and sanitize variables to prevent injection.\n- **Quote Variables**: Always quote bash variables (e.g., `\"$CLAUDE_PROJECT_DIR\"`) to handle spaces in paths.\n- **Return Valid JSON**: Ensure your hooks output valid JSON structures for decisions (`allow`/`deny`) and messages.\n\n### Avoid\n- **Blocking Errors**: Avoid returning exit code `2` (Blocking Error) unless the operation is critical and MUST be stopped. Use `1` (Non-blocking) or `0` (Success) otherwise.\n- **Modifying Global State**: Avoid hooks that change the environment unexpectedly, as execution order is not guaranteed.\n\n## Implementation Reference\n\n### Exit Codes\n- `0`: Success (use JSON output for allow/deny)\n- `1`: Non-blocking error (allow, log warning)\n- `2`: Blocking error (deny operation)\n\n### Bash Hook Template\n```bash\n#!/bin/bash\nINPUT=$(cat)\n\n# Validate JSON\nif ! echo \"$INPUT\" | jq . >/dev/null 2>&1; then\n  echo '{\"allow\": true, \"message\": \"Invalid input\"}'\n  exit 1\nfi\n\n# Extract and validate\nTOOL=$(echo \"$INPUT\" | jq -r '.toolName // empty')\nif [ -z \"$TOOL\" ]; then\n  echo '{\"allow\": true, \"message\": \"Missing tool\"}'\n  exit 1\nfi\n\n# Perform check\nif [[ condition ]]; then\n  echo '{\"allow\": false, \"message\": \"⚠️ Denied\"}'\n  exit 0\nfi\n\necho '{\"allow\": true}'\nexit 0\n```\n",
        "plugin-optimizer/skills/plugin-best-practices/references/components/lsp-servers.md": "# LSP Servers Component Reference\n\n> **Tip**: Looking to use LSP plugins? Install them from the official marketplace—search for \"lsp\" in the `/plugin` Discover tab. This section documents how to create LSP plugins for languages not covered by the official marketplace.\n\nPlugins can provide [Language Server Protocol](https://microsoft.github.io/language-server-protocol/) (LSP) servers to give Claude real-time code intelligence while working on your codebase.\n\nLSP integration provides:\n\n* **Instant diagnostics**: Claude sees errors and warnings immediately after each edit\n* **Code navigation**: go to definition, find references, and hover information\n* **Language awareness**: type information and documentation for code symbols\n\n**Location**: `.lsp.json` in plugin root, or inline in `plugin.json`\n\n**Format**: JSON configuration mapping language server names to their configurations\n\n## `.lsp.json` file format\n\n```json\n{\n  \"go\": {\n    \"command\": \"gopls\",\n    \"args\": [\"serve\"],\n    \"extensionToLanguage\": {\n      \".go\": \"go\"\n    }\n  }\n}\n```\n\n## Inline in `plugin.json`\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"lspServers\": {\n    \"go\": {\n      \"command\": \"gopls\",\n      \"args\": [\"serve\"],\n      \"extensionToLanguage\": {\n        \".go\": \"go\"\n      }\n    }\n  }\n}\n```\n\n## Required fields\n\n| Field                 | Description                                  |\n| :-------------------- | :------------------------------------------- |\n| `command`             | The LSP binary to execute (MUST be in PATH)  |\n| `extensionToLanguage` | Maps file extensions to language identifiers |\n\n## Optional fields\n\n| Field                   | Description                                               |\n| :---------------------- | :-------------------------------------------------------- |\n| `args`                  | Command-line arguments for the LSP server                 |\n| `transport`             | Communication transport: `stdio` (default) or `socket`    |\n| `env`                   | Environment variables to set when starting the server     |\n| `initializationOptions` | Options passed to the server during initialization        |\n| `settings`              | Settings passed via `workspace/didChangeConfiguration`    |\n| `workspaceFolder`       | Workspace folder path for the server                      |\n| `startupTimeout`        | Max time to wait for server startup (milliseconds)        |\n| `shutdownTimeout`       | Max time to wait for graceful shutdown (milliseconds)     |\n| `restartOnCrash`        | Whether to automatically restart the server if it crashes |\n| `maxRestarts`           | Maximum number of restart attempts before giving up       |\n\n> **Warning**: **You MUST install the language server binary separately.** LSP plugins configure how Claude Code connects to a language server, but they don't include the server itself. If you see `Executable not found in $PATH` in the `/plugin` Errors tab, install the required binary for your language.\n\n## Available LSP plugins\n\n| Plugin           | Language server            | Install command                                                                            |\n| :--------------- | :------------------------- | :----------------------------------------------------------------------------------------- |\n| `pyright-lsp`    | Pyright (Python)           | `pip install pyright` or `npm install -g pyright`                                          |\n| `typescript-lsp` | TypeScript Language Server | `npm install -g typescript-language-server typescript`                                     |\n| `rust-lsp`       | rust-analyzer              | [See rust-analyzer installation](https://rust-analyzer.github.io/manual.html#installation) |\n\nInstall the language server first, then install the plugin from the marketplace.\n",
        "plugin-optimizer/skills/plugin-best-practices/references/components/mcp-servers.md": "# MCP Servers Component Reference\n\nPlugins can bundle Model Context Protocol (MCP) servers to connect Claude Code with external tools and services.\n\n**Location**: `.mcp.json` in plugin root, or inline in plugin.json\n\n**Format**: Standard MCP server configuration\n\n## MCP server configuration\n\n```json\n{\n  \"mcpServers\": {\n    \"plugin-database\": {\n      \"command\": \"${CLAUDE_PLUGIN_ROOT}/servers/db-server\",\n      \"args\": [\"--config\", \"${CLAUDE_PLUGIN_ROOT}/config.json\"],\n      \"env\": {\n        \"DB_PATH\": \"${CLAUDE_PLUGIN_ROOT}/data\"\n      }\n    },\n    \"plugin-api-client\": {\n      \"command\": \"npx\",\n      \"args\": [\"@company/mcp-server\", \"--plugin-mode\"],\n      \"cwd\": \"${CLAUDE_PLUGIN_ROOT}\"\n    }\n  }\n}\n```\n\n## Integration behavior\n\n* Plugin MCP servers start automatically when the plugin is enabled\n* Servers appear as standard MCP tools in Claude's toolkit\n* Server capabilities integrate seamlessly with Claude's existing tools\n* Plugin servers can be configured independently of user MCP servers\n",
        "plugin-optimizer/skills/plugin-best-practices/references/components/skills.md": "# Skills Component Reference\n\nPlugins can provide Agent Skills that extend Claude's capabilities. Skills are model-invoked—Claude autonomously decides when to use them based on the task context.\n\n**Location**: `skills/` directory in plugin root\n\n**File format**: Directories containing `SKILL.md` files with YAML frontmatter and markdown content\n\n## Skill structure\n\n```\nskills/\n└── my-skill/\n    ├── SKILL.md          (required - main instructions)\n    ├── reference.md      (optional - detailed docs)\n    ├── examples.md       (optional - usage examples)\n    └── scripts/          (optional - executable logic)\n        └── helper.py\n```\n\n## Frontmatter fields\n\nAll fields are optional. Only `description` is recommended so Claude knows when to use the skill.\n\nUse these templates to align skill structure and voice with the correct type. See `${CLAUDE_PLUGIN_ROOT}/examples/instruction-skill.md` and `${CLAUDE_PLUGIN_ROOT}/examples/knowledge-skill.md` for complete templates.\n\n| Field                    | Required    | Description                                                                                                                              |\n| ------------------------ | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------- |\n| name                     | No          | Display name for the skill. If omitted, uses the directory name. Lowercase letters, numbers, and hyphens only (max 64 characters).      |\n| description              | Recommended | What the skill does and when to use it. Claude uses this to decide when to apply the skill.                                            |\n| argument-hint            | No          | Hint shown during autocomplete to indicate expected arguments. Example: `[issue-number]` or `[filename] [format]`.                      |\n| disable-model-invocation | No          | Set to `true` to prevent Claude from automatically loading this skill. Use for workflows you want to trigger manually. Default: `false`. |\n| user-invocable           | No          | Set to `false` to hide from the / menu. Use for background knowledge users shouldn't invoke directly. Default: `true`.                  |\n| allowed-tools            | No          | Tools Claude can use without asking permission when this skill is active.                                                                |\n| model                    | No          | Model to use when this skill is active: `sonnet`, `opus`, `haiku`, or `inherit`.                                                        |\n| context                  | No          | Set to `fork` to run in a forked subagent context.                                                                                       |\n| agent                    | No          | Which subagent type to use when `context: fork` is set: `Explore`, `Plan`, `general-purpose`, or custom agent name.                      |\n| hooks                    | No          | Hooks scoped to this skill's lifecycle. See Hooks documentation for configuration format.                                               |\n\n## String substitutions\n\nSkills support string substitution for dynamic values:\n\n| Variable               | Description                                                                                                                              |\n| ---------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |\n| $ARGUMENTS             | All arguments passed when invoking the skill. If not present in content, arguments are appended as `ARGUMENTS: <value>`.                 |\n| ${CLAUDE_SESSION_ID}   | The current session ID. Useful for logging, creating session-specific files, or correlating skill output with sessions.                 |\n\n## Integration behavior\n\n* Plugin Skills are automatically discovered when the plugin is installed\n* Claude autonomously invokes Skills based on matching task context\n* Skills can include supporting files alongside SKILL.md\n* Reference supporting files from SKILL.md so Claude knows what each file contains and when to load it\n\n**Note**: There is a known limitation where plugin skills may not appear in the slash command menu, even though project-level skills do. See [GitHub issue #17271](https://github.com/anthropics/claude-code/issues/17271#issuecomment-3785693359) for details.\n\n## Declaring in plugin.json\n\nDeclare by frontmatter (see `user-invocable` and `disable-model-invocation` fields above):\n- **Knowledge-type** (`user-invocable: false`) → `plugin.json` **`skills`** field\n- **Instruction-type** (default or `user-invocable: true`) → **`commands`** field\n- **`disable-model-invocation: true`** → **`commands`** (still instruction-type; prevents Claude auto-invoke)\n\n## Best Practices\n\n### Golden Rule: < 500 Lines\n\nKeep `SKILL.md` under 500 lines. Move detailed reference material to separate files. If exceeded, refactor by:\n1. Splitting into multiple focused atomic skills\n2. Moving detailed logic to reference files (progressive disclosure)\n3. Using external scripts or tools for complex operations\n\n### Progressive Disclosure Strategy\n\nUse a two-level approach:\n- **Level 1 (Skill Definition)**: Tell the agent \"what I can do\" - overview and navigation\n  - Frontmatter with third-person description\n  - Core purpose and usage scenarios\n  - Quick reference to detailed documentation\n  - Basic workflow overview using imperative style\n- **Level 2 (Detailed Documentation)**: Reference external files for complex logic\n  - Reference supporting files from SKILL.md: `For complete API details, see reference.md`\n  - Use code interpreter scripts for complex operations\n  - Don't make the LLM \"read\" thousands of lines of rules\n\n### Must Do\n- Place `SKILL.md` inside a subdirectory (e.g., `skills/my-skill/SKILL.md`)\n- Use imperative style in bodies (\"Parse the file...\", \"Validate the input...\")\n- Write frontmatter descriptions in third person (\"This skill should be used when...\")\n- Keep main `SKILL.md` under 500 lines with progressive disclosure\n- Each skill SHOULD have a single, well-defined responsibility\n- Scripts MUST be executable with shebang and `${CLAUDE_PLUGIN_ROOT}` paths\n- Reference supporting files from SKILL.md so Claude knows what they contain\n\n### Should Do\n- Reference external documentation files rather than embedding all details\n- Use `user-invocable: false` for agent-only skills and `context: fork` for complex analysis\n- Use `disable-model-invocation: true` for workflows with side effects you want to control timing\n\n### Avoid\n- Exceeding 500 lines (indicates poor design—refactor)\n- Duplicating information between `SKILL.md` and reference files\n- Combining multiple unrelated capabilities into a single skill\n",
        "plugin-optimizer/skills/plugin-best-practices/references/debugging.md": "# Debugging and Development Tools\n\n## Debugging commands\n\nUse `claude --debug` to see plugin loading details:\n\n```bash\nclaude --debug\n```\n\nThis shows:\n\n* Which plugins are being loaded\n* Any errors in plugin manifests\n* Command, agent, and hook registration\n* MCP server initialization\n\n## Common issues\n\n| Issue                               | Cause                           | Solution                                                                          |\n| :---------------------------------- | :------------------------------ | :-------------------------------------------------------------------------------- |\n| Plugin not loading                  | Invalid `plugin.json`           | Validate JSON syntax with `claude plugin validate` or `/plugin validate`          |\n| Commands not appearing              | Wrong directory structure       | Ensure `commands/` at root, not in `.claude-plugin/`                              |\n| Hooks not firing                    | Script not executable           | Run `chmod +x script.sh`                                                          |\n| MCP server fails                    | Missing `${CLAUDE_PLUGIN_ROOT}` | Use variable for all plugin paths                                                 |\n| Path errors                         | Absolute paths used             | All paths MUST be relative and start with `./`                                    |\n| LSP `Executable not found in $PATH` | Language server not installed   | Install the binary (e.g., `npm install -g typescript-language-server typescript`) |\n\n## Example error messages\n\n**Manifest validation errors**:\n\n* `Invalid JSON syntax: Unexpected token } in JSON at position 142`: check for missing commas, extra commas, or unquoted strings\n* `Plugin has an invalid manifest file at .claude-plugin/plugin.json. Validation errors: name: Required`: a required field is missing\n* `Plugin has a corrupt manifest file at .claude-plugin/plugin.json. JSON parse error: ...`: JSON syntax error\n\n**Plugin loading errors**:\n\n* `Warning: No commands found in plugin my-plugin custom directory: ./cmds. Expected .md files or SKILL.md in subdirectories.`: command path exists but contains no valid command files\n* `Plugin directory not found at path: ./plugins/my-plugin. Check that the marketplace entry has the correct path.`: the `source` path in marketplace.json points to a non-existent directory\n* `Plugin my-plugin has conflicting manifests: both plugin.json and marketplace entry specify components.`: remove duplicate component definitions or set `strict: true` in marketplace entry\n\n## Hook troubleshooting\n\n**Hook script not executing**:\n\n1. Check the script is executable: `chmod +x ./scripts/your-script.sh`\n2. Verify the shebang line: First line SHOULD be `#!/bin/bash` or `#!/usr/bin/env bash`\n3. Check the path uses `${CLAUDE_PLUGIN_ROOT}`: `\"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/your-script.sh\"`\n4. Test the script manually: `./scripts/your-script.sh`\n\n**Hook not triggering on expected events**:\n\n1. Verify the event name is correct (case-sensitive): `PostToolUse`, not `postToolUse`\n2. Check the matcher pattern matches your tools: `\"matcher\": \"Write|Edit\"` for file operations\n3. Confirm the hook type is valid: `command`, `prompt`, or `agent`\n\n## MCP server troubleshooting\n\n**Server not starting**:\n\n1. Check the command exists and is executable\n2. Verify all paths use `${CLAUDE_PLUGIN_ROOT}` variable\n3. Check the MCP server logs: `claude --debug` shows initialization errors\n4. Test the server manually outside of Claude Code\n\n**Server tools not appearing**:\n\n1. Ensure the server is properly configured in `.mcp.json` or `plugin.json`\n2. Verify the server implements the MCP protocol correctly\n3. Check for connection timeouts in debug output\n\n## Directory structure mistakes\n\n**Symptoms**: Plugin loads but components (commands, agents, hooks) are missing.\n\n**Correct structure**: Components MUST be at the plugin root, not inside `.claude-plugin/`. Only `plugin.json` belongs in `.claude-plugin/`.\n\n```\nmy-plugin/\n├── .claude-plugin/\n│   └── plugin.json      ← Only manifest here\n├── commands/            ← At root level\n├── agents/              ← At root level\n└── hooks/               ← At root level\n```\n\nIf your components are inside `.claude-plugin/`, move them to the plugin root.\n\n**Debug checklist**:\n\n1. Run `claude --debug` and look for \"loading plugin\" messages\n2. Check that each component directory is listed in the debug output\n3. Verify file permissions allow reading the plugin files\n\n## Distribution and versioning reference\n\n### Version management\n\nFollow semantic versioning for plugin releases:\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"version\": \"2.1.0\"\n}\n```\n\n**Version format**: `MAJOR.MINOR.PATCH`\n\n* **MAJOR**: Breaking changes (incompatible API changes)\n* **MINOR**: New features (backward-compatible additions)\n* **PATCH**: Bug fixes (backward-compatible fixes)\n\n**Best practices**:\n\n* Start at `1.0.0` for your first stable release\n* Update the version in `plugin.json` before distributing changes\n* Document changes in a `CHANGELOG.md` file\n* Use pre-release versions like `2.0.0-beta.1` for testing\n",
        "plugin-optimizer/skills/plugin-best-practices/references/directory-structure.md": "# Plugin Directory Structure\n\n## Standard plugin layout\n\nA complete plugin follows this structure. **Modern plugins** prioritize Skills over Commands for better modularity.\n\n```\nenterprise-plugin/\n├── .claude-plugin/           # Metadata directory\n│   └── plugin.json          # Required: plugin manifest (declare skills here)\n├── skills/                   # Agent Skills (RECOMMENDED)\n│   ├── commit/\n│   │   └── SKILL.md\n│   ├── code-reviewer/\n│   │   ├── SKILL.md\n│   │   └── references/\n│   └── pdf-processor/\n│       ├── SKILL.md\n│       └── scripts/\n├── commands/                 # Legacy commands (optional)\n│   ├── status.md\n│   └── logs.md\n├── agents/                   # Default agent location\n│   ├── security-reviewer.md\n│   ├── performance-tester.md\n│   └── compliance-checker.md\n├── hooks/                    # Hook configurations\n│   ├── hooks.json           # Main hook config\n│   └── security-hooks.json  # Additional hooks\n├── .mcp.json                # MCP server definitions\n├── .lsp.json                # LSP server configurations\n├── scripts/                 # Hook and utility scripts\n│   ├── security-scan.sh     # Must be executable with shebang\n│   ├── format-code.py       # Must be executable with shebang\n│   └── deploy.js            # Must be executable with shebang\n├── LICENSE                  # License file\n└── CHANGELOG.md             # Version history\n```\n\n**Example plugin.json with explicit skill declarations**:\n```json\n{\n  \"name\": \"enterprise-plugin\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Enterprise automation tools\",\n  \"commands\": [\n    \"./skills/commit/\",\n    \"./skills/code-reviewer/\",\n    \"./skills/pdf-processor/\"\n  ]\n}\n```\n\n> **Warning**: The `.claude-plugin/` directory contains the `plugin.json` file. All other directories (commands/, agents/, skills/, hooks/) MUST be at the plugin root, not inside `.claude-plugin/`.\n\n> **Best Practice**: See `manifest-schema.md` for plugin.json declaration guidance.\n\n## File locations reference\n\n| Component       | Default Location             | Purpose                          | Priority      |\n| :-------------- | :--------------------------- | :------------------------------- | :------------ |\n| **Manifest**    | `.claude-plugin/plugin.json` | Required metadata file           | Required      |\n| **Skills**      | `skills/`                    | Agent Skills with SKILL.md files | **Recommended** |\n| **Commands**    | `commands/`                  | Legacy slash command files       | Optional      |\n| **Agents**      | `agents/`                    | Subagent Markdown files          | -             |\n| **Hooks**       | `hooks/hooks.json`           | Hook configuration               | -             |\n| **MCP servers** | `.mcp.json`                  | MCP server definitions           | -             |\n| **LSP servers** | `.lsp.json`                  | Language server configurations   | -             |\n| **Scripts**     | `scripts/`                    | Hook and utility scripts         | -             |\n\n## Script Requirements\n\nScripts MUST be executable (`chmod +x`), include proper shebang lines (`#!/bin/bash`, `#!/usr/bin/env python3`, etc.), and use `${CLAUDE_PLUGIN_ROOT}` in paths. See `references/debugging.md` (lines 47-50) for troubleshooting.\n",
        "plugin-optimizer/skills/plugin-best-practices/references/manifest-schema.md": "# Plugin Manifest Schema\n\nThe `plugin.json` file defines your plugin's metadata and configuration. This section documents all supported fields and options.\n\n## Complete schema\n\n```json\n{\n  \"name\": \"plugin-name\",\n  \"version\": \"1.2.0\",\n  \"description\": \"Brief plugin description\",\n  \"author\": {\n    \"name\": \"Author Name\",\n    \"email\": \"author@example.com\",\n    \"url\": \"https://github.com/author\"\n  },\n  \"homepage\": \"https://docs.example.com/plugin\",\n  \"repository\": \"https://github.com/author/plugin\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"keyword1\", \"keyword2\"],\n  \"commands\": [\"./custom/commands/special.md\"],\n  \"agents\": \"./custom/agents/\",\n  \"skills\": \"./custom/skills/\",\n  \"hooks\": \"./config/hooks.json\",\n  \"mcpServers\": \"./mcp-config.json\",\n  \"outputStyles\": \"./styles/\",\n  \"lspServers\": \"./.lsp.json\"\n}\n```\n\n## Required fields\n\n| Field  | Type   | Description                               | Example              |\n| :----- | :----- | :---------------------------------------- | :------------------- |\n| `name` | string | Unique identifier (kebab-case, no spaces) | `\"deployment-tools\"` |\n\n## Metadata fields\n\n| Field         | Type   | Description                         | Example                                            |\n| :------------ | :----- | :---------------------------------- | :------------------------------------------------- |\n| `version`     | string | Semantic version                    | `\"2.1.0\"`                                          |\n| `description` | string | Brief explanation of plugin purpose | `\"Deployment automation tools\"`                    |\n| `author`      | object | Author information                  | `{\"name\": \"Dev Team\", \"email\": \"dev@company.com\"}` |\n| `homepage`    | string | Documentation URL                   | `\"https://docs.example.com\"`                       |\n| `repository`  | string | Source code URL                     | `\"https://github.com/user/plugin\"`                 |\n| `license`     | string | License identifier                  | `\"MIT\"`, `\"Apache-2.0\"`                            |\n| `keywords`    | array  | Discovery tags                      | `[\"deployment\", \"ci-cd\"]`                          |\n\n## Component path fields\n\n> **Best Practice**: Explicitly declare `commands` and `skills` fields in `plugin.json` even when using default directories. This improves clarity, maintainability, and serves as documentation for your plugin's capabilities.\n\n| Field          | Type           | Description                                                                                                                                              | Example                                |\n| :------------- | :------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------- |\n| `commands`     | string\\|array  | Instruction-type skills (`user-invocable: true` or default, including `disable-model-invocation: true`). Required for / menu. | `[\"./skills/commit/\", \"./skills/config/\"]` |\n| `agents`       | string\\|array  | Additional agent files                                                                                                                                   | `\"./custom/agents/\"`                   |\n| `skills`       | string\\|array  | Knowledge-type skills (`user-invocable: false`). Agent-only; not in / menu.                                                                 | `\"./custom/skills/\"`                   |\n| `hooks`        | string\\|object | Hook config path or inline config                                                                                                                        | `\"./hooks.json\"`                       |\n| `mcpServers`   | string\\|object | MCP config path or inline config                                                                                                                         | `\"./mcp-config.json\"`                  |\n| `outputStyles` | string\\|array  | Additional output style files/directories                                                                                                                | `\"./styles/\"`                          |\n| `lspServers`   | string\\|object | [Language Server Protocol](https://microsoft.github.io/language-server-protocol/) config for code intelligence (go to definition, find references, etc.) | `\"./.lsp.json\"`                        |\n\n## Path behavior rules\n\n**Important**: Custom paths supplement default directories - they don't replace them.\n\n* If `commands/` or `skills/` directories exist, they're loaded in addition to custom paths\n* All paths MUST be relative to plugin root and start with `./`\n* Commands from custom paths use the same naming and namespacing rules\n* Multiple paths can be specified as arrays for flexibility\n\n**Recommended**: Declare by type: `user-invocable: false` → `skills`; `user-invocable: true` (or default) → `commands`. Improves documentation, maintainability, and clarity.\n\n**Path examples** (knowledge-type in `skills`, instruction-type in `commands`):\n\n```json\n{\n  \"skills\": [\"./skills/plugin-best-practices/\"],\n  \"commands\": [\n    \"./skills/commit/\",\n    \"./skills/commit-and-push/\",\n    \"./skills/config-git/\"\n  ],\n  \"agents\": [\n    \"./custom-agents/reviewer.md\",\n    \"./custom-agents/tester.md\"\n  ]\n}\n```\n\n## Environment variables\n\n**`${CLAUDE_PLUGIN_ROOT}`**: Contains the absolute path to your plugin directory. Use this in hooks, MCP servers, and scripts to ensure correct paths regardless of installation location.\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"${CLAUDE_PLUGIN_ROOT}/scripts/process.sh\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Plugin installation scopes\n\nWhen you install a plugin, you choose a **scope** that determines where the plugin is available and who else can use it:\n\n| Scope     | Settings file                 | Use case                                                 |\n| :-------- | :---------------------------- | :------------------------------------------------------- |\n| `user`    | `~/.claude/settings.json`     | Personal plugins available across all projects (default) |\n| `project` | `.claude/settings.json`       | Team plugins shared via version control                  |\n| `local`   | `.claude/settings.local.json` | Project-specific plugins, gitignored                     |\n| `managed` | `managed-settings.json`       | Managed plugins (read-only, update only)                 |\n\nPlugins use the same scope system as other Claude Code configurations. For installation instructions and scope flags, see [Install plugins](/en/discover-plugins#install-plugins). For a complete explanation of scopes, see [Configuration scopes](/en/settings#configuration-scopes).\n\n## Plugin caching and file resolution\n\nFor security and verification purposes, Claude Code copies plugins to a cache directory rather than using them in-place. Understanding this behavior is important when developing plugins that reference external files.\n\n### How plugin caching works\n\nWhen you install a plugin, Claude Code copies the plugin files to a cache directory:\n\n* **For marketplace plugins with relative paths**: The path specified in the `source` field is copied recursively. For example, if your marketplace entry specifies `\"source\": \"./plugins/my-plugin\"`, the entire `./plugins` directory is copied.\n* **For plugins with `.claude-plugin/plugin.json`**: The implicit root directory (the directory containing `.claude-plugin/plugin.json`) is copied recursively.\n\n### Path traversal limitations\n\nPlugins cannot reference files outside their copied directory structure. Paths that traverse outside the plugin root (such as `../shared-utils`) will not work after installation because those external files are not copied to the cache.\n\n### Working with external dependencies\n\nIf your plugin needs to access files outside its directory, you have two options:\n\n**Option 1: Use symlinks**\n\nCreate symbolic links to external files within your plugin directory. Symlinks are honored during the copy process:\n\n```bash\n# Inside your plugin directory\nln -s /path/to/shared-utils ./shared-utils\n```\n\nThe symlinked content will be copied into the plugin cache.\n\n**Option 2: Restructure your marketplace**\n\nSet the plugin path to a parent directory that contains all required files, then provide the rest of the plugin manifest directly in the marketplace entry:\n\n```json\n{\n  \"name\": \"my-plugin\",\n  \"source\": \"./\",\n  \"description\": \"Plugin that needs root-level access\",\n  \"commands\": [\"./plugins/my-plugin/commands/\"],\n  \"agents\": [\"./plugins/my-plugin/agents/\"],\n  \"strict\": false\n}\n```\n\nThis approach copies the entire marketplace root, giving your plugin access to sibling directories.\n\n> **Note**: Symlinks that point to locations outside the plugin's logical root are followed during copying. This provides flexibility while maintaining the security benefits of the caching system.\n",
        "plugin-optimizer/skills/plugin-best-practices/references/mcp-patterns.md": "# MCP Integration Patterns\n\nBest practices for integrating Model Context Protocol servers in plugins.\n\n## Configuration Options\n\n### Standalone .mcp.json (Recommended)\n```json\n{\n  \"server-name\": {\n    \"type\": \"stdio|http|sse\",\n    \"command\": \"executable\",\n    \"args\": [\"arg1\", \"arg2\"],\n    \"env\": {\n      \"VAR\": \"${ENV_VAR}\"\n    }\n  }\n}\n```\n\n### Embedded in plugin.json\n```json\n{\n  \"name\": \"plugin-name\",\n  \"mcpServers\": {\n    \"server-name\": {\n      \"type\": \"stdio\",\n      \"command\": \"executable\"\n    }\n  }\n}\n```\n\n## Transport Types\n\n### stdio - Local CLI Tools\nBest for: git, docker, npm, local scripts\n\n```json\n{\n  \"github\": {\n    \"type\": \"stdio\",\n    \"command\": \"npx\",\n    \"args\": [\"-y\", \"@modelcontextprotocol/server-github\"],\n    \"env\": {\n      \"GITHUB_TOKEN\": \"${GITHUB_TOKEN}\"\n    }\n  }\n}\n```\n\n### http - Remote APIs\nBest for: SaaS services, cloud APIs\n\n```json\n{\n  \"api-service\": {\n    \"type\": \"http\",\n    \"url\": \"https://api.example.com/mcp\",\n    \"headers\": {\n      \"Authorization\": \"Bearer ${API_TOKEN}\"\n    }\n  }\n}\n```\n\n### sse - Real-time Streaming\nBest for: monitoring, live updates\n\n```json\n{\n  \"monitoring\": {\n    \"type\": \"sse\",\n    \"url\": \"https://monitor.example.com/stream\",\n    \"headers\": {\n      \"X-API-Key\": \"${MONITOR_KEY}\"\n    }\n  }\n}\n```\n\n## Common Integration Patterns\n\n### GitHub\n```json\n{\n  \"github\": {\n    \"type\": \"stdio\",\n    \"command\": \"npx\",\n    \"args\": [\"-y\", \"@modelcontextprotocol/server-github\"],\n    \"env\": {\"GITHUB_TOKEN\": \"${GITHUB_TOKEN}\"}\n  }\n}\n```\n\n### Database\n```json\n{\n  \"postgres\": {\n    \"type\": \"stdio\",\n    \"command\": \"npx\",\n    \"args\": [\"-y\", \"@modelcontextprotocol/server-postgres\"],\n    \"env\": {\"POSTGRES_URL\": \"${DATABASE_URL}\"}\n  }\n}\n```\n\n### Kubernetes\n```json\n{\n  \"kubectl\": {\n    \"type\": \"stdio\",\n    \"command\": \"mcp-kubectl-wrapper\",\n    \"args\": [\"--namespace\", \"${K8S_NAMESPACE}\"],\n    \"env\": {\"KUBECONFIG\": \"${KUBECONFIG_PATH}\"}\n  }\n}\n```\n\n## Best Practices\n\n### Security\n- **Never hardcode secrets** - always use `${ENV_VAR}` syntax\n- Use minimal permission scopes for tokens\n- Document required environment variables in README\n- Provide `.env.example` template\n\n### Environment Variables\n```json\n{\n  \"database\": {\n    \"type\": \"http\",\n    \"url\": \"${DB_URL}\",\n    \"headers\": {\n      \"Authorization\": \"Bearer ${DB_TOKEN}\",\n      \"X-Project\": \"${PROJECT_ID}\"\n    }\n  }\n}\n```\n\n### Development\n- Test stdio locally before deploying http/sse\n- Use `.env.example` to document required vars\n- Test MCP integration independently\n- Provide clear error messages\n\n### Performance\n- Use http for remote services (avoids process overhead)\n- Set reasonable timeouts\n- Implement caching where appropriate\n- Clean up resources on shutdown\n\n## Validation Checklist\n\n**Configuration:**\n- [ ] Valid JSON syntax\n- [ ] Required fields present (type, command/url)\n- [ ] Transport type: stdio, http, or sse\n- [ ] Server names use kebab-case\n\n**Security:**\n- [ ] No hardcoded secrets/API keys\n- [ ] All credentials use ${ENV_VAR}\n- [ ] Environment variables documented\n- [ ] .env.example provided\n\n**Functionality:**\n- [ ] Server executable/URL accessible\n- [ ] Required env vars available\n- [ ] Transport matches server capabilities\n- [ ] Headers/auth properly configured\n\n## Troubleshooting\n\n| Issue | Fix |\n|-------|-----|\n| Server not found | Verify command in PATH, check network for npx |\n| Auth failures | Check env vars set, verify token permissions |\n| Timeouts | Verify URL accessible, check firewall |\n| Invalid config | Validate JSON, ensure required fields present |\n",
        "plugin-optimizer/skills/plugin-best-practices/references/rfc-2119.md": "# RFC 2119 - Key words for use in RFCs to Indicate Requirement Levels\n\n**Source**: [RFC 2119](https://datatracker.ietf.org/doc/html/rfc2119)\n\nThe key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119.\n\nNote that the force of these words is modified by the requirement level of the document in which they are used.\n\n**Recommended**: Use only one word per level — **MUST**, **MUST NOT**, **SHOULD**, **SHOULD NOT**, **MAY** — and avoid REQUIRED, SHALL, SHALL NOT, RECOMMENDED, NOT RECOMMENDED, OPTIONAL.\n\n---\n\n## 1. MUST\n\nThis word, or the terms \"REQUIRED\" or \"SHALL\", mean that the definition is an absolute requirement of the specification.\n\n**Use**: **MUST** only.\n\n## 2. MUST NOT\n\nThis phrase, or the phrase \"SHALL NOT\", mean that the definition is an absolute prohibition of the specification.\n\n**Use**: **MUST NOT** only.\n\n## 3. SHOULD\n\nThis word, or the adjective \"RECOMMENDED\", mean that there may exist valid reasons in particular circumstances to ignore a particular item, but the full implications must be understood and carefully weighed before choosing a different course.\n\n**Use**: **SHOULD** only.\n\n## 4. SHOULD NOT\n\nThis phrase, or the phrase \"NOT RECOMMENDED\" mean that there may exist valid reasons in particular circumstances when the particular behavior is acceptable or even useful, but the full implications should be understood and the case carefully weighed before implementing any behavior described with this label.\n\n**Use**: **SHOULD NOT** only.\n\n## 5. MAY\n\nThis word, or the adjective \"OPTIONAL\", mean that an item is truly optional. One vendor may choose to include the item because a particular marketplace requires it or because the vendor feels that it enhances the product while another vendor may omit the same item. An implementation which does not include a particular option MUST be prepared to interoperate with another implementation which does include the option, though perhaps with reduced functionality. In the same vein an implementation which does include a particular option MUST be prepared to interoperate with another implementation which does not include the option (except, of course, for the feature the option provides.)\n\n**Use**: **MAY** only.\n\n---\n\n## 6. Guidance in the use of these Imperatives\n\nImperatives of the type defined in this memo must be used with care and sparingly. In particular, they MUST only be used where it is actually required for interoperation or to limit behavior which has potential for causing harm (e.g., limiting retransmisssions). For example, they must not be used to try to impose a particular method on implementors where the method is not required for interoperability.\n\n## 7. Security Considerations\n\nThese terms are frequently used to specify behavior with security implications. The effects on security of not implementing a MUST or SHOULD, or doing something the specification says MUST NOT or SHOULD NOT be done may be very subtle. Document authors should take the time to elaborate the security implications of not following recommendations or requirements as most implementors will not have had the benefit of the experience and discussion that produced the specification.\n",
        "plugin-optimizer/skills/plugin-best-practices/references/todowrite-usage.md": "# TodoWrite Tool Usage Standards\n\nBest practices for using the TodoWrite tool in plugin components.\n\n## When to Use\n\n**Use TodoWrite for:**\n- Tasks with 3+ distinct steps\n- Multi-file/multi-component work\n- Sequential dependencies\n- User progress visibility needs\n\n**Don't use for:**\n- Single file edits\n- 1-2 step operations\n- Pure research/reading\n- Conversational responses\n\n## Core Requirements\n\n### 1. Dual Form Naming\n\nEvery task needs both forms:\n\n```json\n{\n  \"content\": \"Run tests\",           // Imperative: what to do\n  \"activeForm\": \"Running tests\",    // Continuous: doing it now\n  \"status\": \"in_progress\"\n}\n```\n\n### 2. Real-time Updates\n\n- Mark `in_progress` BEFORE starting work\n- Mark `completed` IMMEDIATELY after finishing\n- Never batch updates\n\n### 3. Single Active Task\n\nExactly ONE task as `in_progress` at any time.\n\n### 4. Honest Status\n\nOnly mark `completed` when FULLY done. If blocked/failed, keep as `in_progress` and create new task for resolution.\n\n## Task Structure\n\n```json\n{\n  \"content\": \"Imperative verb-first form\",\n  \"activeForm\": \"Present continuous -ing form\",\n  \"status\": \"pending|in_progress|completed\"\n}\n```\n\n## Good Examples\n\n### Multi-Step Plugin Creation\n\n```json\n[\n  {\n    \"content\": \"Create plugin manifest and directory structure\",\n    \"activeForm\": \"Creating plugin manifest and directory structure\",\n    \"status\": \"in_progress\"\n  },\n  {\n    \"content\": \"Implement command with frontmatter\",\n    \"activeForm\": \"Implementing command with frontmatter\",\n    \"status\": \"pending\"\n  },\n  {\n    \"content\": \"Validate plugin structure\",\n    \"activeForm\": \"Validating plugin structure\",\n    \"status\": \"pending\"\n  }\n]\n```\n\n### Single File Edit\n\nDon't use TodoWrite - just do it:\n- \"Fix typo in README.md\"\n- \"Add missing description field\"\n- \"Update version number\"\n\n## Common Mistakes\n\n**Wrong:** Missing activeForm\n```json\n{\"content\": \"Run tests\", \"status\": \"in_progress\"}\n```\n\n**Right:** Both forms present\n```json\n{\n  \"content\": \"Run tests\",\n  \"activeForm\": \"Running tests\",\n  \"status\": \"in_progress\"\n}\n```\n\n**Wrong:** Multiple in_progress\n```json\n[\n  {\"content\": \"Task 1\", \"status\": \"in_progress\"},\n  {\"content\": \"Task 2\", \"status\": \"in_progress\"}\n]\n```\n\n**Right:** Only one in_progress\n```json\n[\n  {\"content\": \"Task 1\", \"status\": \"completed\"},\n  {\"content\": \"Task 2\", \"status\": \"in_progress\"}\n]\n```\n\n**Wrong:** Batched updates (do Task 1, Task 2, Task 3, then update all)\n\n**Right:** Sequential updates (do Task 1, mark complete, do Task 2, mark complete...)\n\n## In Plugin Components\n\n### Commands\n\n```markdown\n**Use TodoWrite tool** to track the following phases:\n1. Scan plugin structure\n2. Validate components\n3. Generate report\n```\n\n### Agents\n\n```markdown\n**Use TodoWrite tool** at the start to create tasks for multi-step workflows.\nMark each task as in_progress before starting, completed immediately after finishing.\n```\n\n## Quick Decision Tree\n\n```mermaid\nflowchart TD\n    A[Is this 3+ steps?] -->|NO| B[Don't use TodoWrite]\n    A -->|YES| C[Multiple files?]\n    C -->|NO| D[Probably don't need TodoWrite]\n    C -->|YES| E[Dependencies?]\n    E -->|NO| F[Maybe don't need TodoWrite]\n    E -->|YES| G[USE TodoWrite]\n```\n",
        "plugin-optimizer/skills/plugin-best-practices/references/tool-invocations.md": "# Tool Invocation Patterns\n\nBest practices for referencing tools in plugin components.\n\n## Core Principle\n\n**Implicit Tool Usage**: Core file operations (Read, Write, Glob, Grep, Edit) SHOULD be described implicitly. Claude automatically infers the correct tool from context.\n\n## Tool Invocation Rules\n\n### Implicit (Describe Action Directly)\n\n**Core File Operations:**\n- Read, Write, Glob, Grep, Edit\n- Bash (describe commands: \"Run `git status`\")\n- Task (describe agent launch: \"Launch code-reviewer agent\")\n\n```markdown\n# Good Examples\nFind all plugin files matching `**/*.md`\nRead each file and extract frontmatter\nSearch for \"TODO\" patterns in the codebase\nRun `git status` to check changes\nLaunch the validator agent to check compliance\n```\n\n### Explicit (State Tool Name)\n\n**Workflow & External Tools:**\n- Skill: \"**Load X skill** using the Skill tool\"\n- AskUserQuestion: \"Use AskUserQuestion tool to confirm\"\n- TodoWrite: \"**Use TodoWrite tool** to track progress\"\n- WebFetch, WebSearch: \"Use WebFetch tool to read docs\"\n\n```markdown\n# Good Examples\n**Load the hookify:writing-rules skill** using the Skill tool\nUse AskUserQuestion tool to let user select options\n**Use TodoWrite tool** to track validation progress\nUse WebFetch tool to read official documentation\n```\n\n## In allowed-tools Configuration\n\nAlways use array syntax with filters for Bash:\n\n```yaml\n# Commands/Agents frontmatter\nallowed-tools: [\"Read\", \"Glob\", \"Grep\", \"Bash(git:*)\"]\n\n# Common filters\nBash(git:*)           # Git commands only\nBash(npm:*)           # NPM commands only\nBash(gh pr:*)         # GitHub PR commands only\n```\n\n**Never use bare `Bash`** - always specify command filters.\n\n## Inline Bash Execution\n\nIn command files, use inline syntax for dynamic context:\n\n```markdown\nCurrent branch: !`git branch --show-current`\nModified files: !`git diff --name-only`\n```\n\nFormat: `!`command`` (exclamation + backtick + command + backtick)\n\n## Anti-Patterns to Avoid\n\n```markdown\n# Bad - Explicit tool calls for core operations\nUse Glob tool to find files\nUse Read tool to read each file\nUse Bash tool to run git status\nUse Task tool to launch validator agent\n\n# Good - Implicit descriptions\nFind files matching the pattern\nRead each file and extract data\nRun `git status` to check changes\nLaunch the validator agent\n```\n\n## Quick Reference\n\n| Tool | Style | Example |\n|------|-------|---------|\n| Read, Write, Edit, Glob, Grep | Implicit | \"Find files matching...\", \"Read the file...\" |\n| Bash | Implicit | \"Run `git status`\", \"Check with `npm test`\" |\n| Task | Implicit | \"Launch X agent\", \"Use a Haiku agent to...\" |\n| Skill | **Explicit** | \"**Load X skill** using the Skill tool\" |\n| TodoWrite | **Explicit** | \"**Use TodoWrite tool** to track progress\" |\n| AskUserQuestion | Explicit | \"Use AskUserQuestion tool to confirm\" |\n| WebFetch/WebSearch | Explicit | \"Use WebFetch tool to read docs\" |\n",
        "refactor/.claude-plugin/plugin.json": "{\n  \"name\": \"refactor\",\n  \"version\": \"1.3.1\",\n  \"description\": \"Agent and skills for code simplification and refactoring to improve code quality while preserving functionality\",\n  \"keywords\": [\"refactor\", \"code-quality\", \"best-practices\", \"simplification\", \"maintainability\"],\n  \"author\": {\n    \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"agents\": [\n    \"./agents/code-simplifier.md\"\n  ],\n  \"skills\": [\n    \"./skills/best-practices/\"\n  ],\n  \"commands\": [\n    \"./skills/refactor/\",\n    \"./skills/refactor-project/\"\n  ]\n}\n",
        "refactor/README.md": "# Refactor Plugin\n\nAgent and skills for code simplification and refactoring to improve code quality while preserving functionality.\n\n## Installation\n\n```bash\nclaude plugin install refactor@frad-dotclaude\n```\n\n## Overview\n\nProvides specialized tools for code simplification and refactoring. Includes an expert code simplifier agent and skills for targeted and project-wide refactoring. All refactoring operations preserve functionality while improving clarity, consistency, and maintainability.\n\n## Agent\n\n### `code-simplifier`\n\nExpert code simplification specialist that enhances code clarity, consistency, and maintainability while preserving functionality. Automatically loads `refactor:best-practices` skill for language-specific standards.\n\n**Usage:**\n```\n@code-simplifier Simplify the authentication logic in src/auth/login.ts\n```\n\nFor details, see [agents/code-simplifier.md](agents/code-simplifier.md).\n\n\n## Skills\n\n### `best-practices`\n\nComprehensive refactoring workflow with language-specific best practices and Next.js performance patterns. Internal skill automatically loaded by `code-simplifier` agent.\n\n**Language Support:** TypeScript, Python, Go, Swift, JavaScript\n**Framework Support:** Next.js (47 performance patterns), React\n\nFor details and workflow, see [skills/best-practices/SKILL.md](skills/best-practices/SKILL.md).\n\n### `/refactor`\n\nQuick refactoring for recently modified or specified code.\n\n**Usage:**\n```bash\n# Refactor recently modified code\n/refactor\n\n# Refactor specific files\n/refactor src/auth/login.ts src/utils/\n```\n\nLaunches `code-simplifier` agent with targeted scope. For details, see [skills/refactor/SKILL.md](skills/refactor/SKILL.md).\n\n---\n\n### `/refactor-project`\n\nProject-wide code refactoring across entire codebase.\n\n**Usage:**\n```bash\n/refactor-project\n```\n\nLaunches `code-simplifier` agent with project-wide scope, emphasizing cross-file duplication reduction and consistent patterns. For details, see [skills/refactor-project/SKILL.md](skills/refactor-project/SKILL.md).\n\n## Quick Start\n\n### Targeted Refactoring\n```bash\n# Refactor recent changes\n/refactor\n\n# Refactor specific files\n/refactor src/auth/login.ts\n```\n\n### Project-Wide Refactoring\n```bash\n/refactor-project\n```\n\n### Using Agent Directly\n```\n@code-simplifier Simplify the authentication logic in src/auth/login.ts\n```\n\n## Example Refactoring\n\n### TypeScript: Reducing Complexity\n\n**Before:**\n```typescript\nfunction processUser(user: any) {\n  if (user) {\n    if (user.age) {\n      if (user.age >= 18) {\n        if (user.verified) {\n          return { status: 'active', user: user };\n        } else {\n          return { status: 'unverified', user: user };\n        }\n      } else {\n        return { status: 'minor', user: user };\n      }\n    }\n  }\n  return { status: 'invalid', user: null };\n}\n```\n\n**After:**\n```typescript\ninterface User {\n  age: number;\n  verified: boolean;\n}\n\nfunction processUser(user: User | null): { status: string; user: User | null } {\n  // Early returns for guard clauses\n  if (!user?.age) {\n    return { status: 'invalid', user: null };\n  }\n\n  if (user.age < 18) {\n    return { status: 'minor', user };\n  }\n\n  const status = user.verified ? 'active' : 'unverified';\n  return { status, user };\n}\n```\n\n**Improvements:**\n- Eliminated nested conditionals with guard clauses\n- Added proper TypeScript types\n- Reduced cognitive complexity\n- Made logic flow more obvious and testable\n\n### Next.js: Eliminating Waterfalls\n\nDemonstrates parallelizing independent async operations to eliminate sequential waterfalls. See [skills/best-practices/references/nextjs/async-parallel.md](skills/best-practices/references/nextjs/async-parallel.md) for detailed examples.\n\n### Python: Applying DRY and Type Safety\n\nDemonstrates eliminating code duplication using Enums and type hints. See [skills/best-practices/references/python.md](skills/best-practices/references/python.md) for comprehensive patterns.\n\n## Key Features\n\n- **Language Support**: TypeScript, JavaScript, Python, Go, Swift\n- **Framework Support**: Next.js (47 performance patterns), React\n- **Automated Workflow**: Agent-driven refactoring with best practices\n- **Safe Refactoring**: Preserves functionality, uses git for rollback\n- **Impact-Based**: Prioritizes CRITICAL > HIGH > MEDIUM > LOW improvements\n\n## Best Practices\n\n- **Refactor frequently** during development\n- **Use `/refactor`** for targeted improvements\n- **Use `/refactor-project`** for major modernization\n- **Review changes** to ensure functionality is preserved\n- **Run tests** after refactoring to validate\n- **Trust git** for rollback if needed\n\n## Requirements\n\n- Git repository for change tracking\n- Test suite for validation (recommended)\n- Lint/build tools for quality checks (recommended)\n\n## Troubleshooting\n\n**Q: Will refactoring break my code?**\nA: No. The agent preserves functionality. Always run tests after refactoring.\n\n**Q: Refactoring changes too much**\nA: Use `/refactor` with specific files for targeted changes. Review changes before committing.\n\n**Q: What's the difference between `/refactor` and `/refactor-project`?**\nA: `/refactor` is for targeted changes (recent/specified files). `/refactor-project` is for entire codebase.\n\nFor more FAQs and detailed troubleshooting, see individual skill documentation in [skills/](skills/).\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n\n## Credits\n\n**React/Next.js Best Practices:**\n- React and Next.js performance optimization guidelines are sourced from [Vercel Engineering's agent-skills repository](https://github.com/vercel-labs/agent-skills/tree/main/skills/react-best-practices)\n- Contains 40+ rules across 8 categories, prioritized by impact\n- Originally created by [@shuding](https://x.com/shuding) at [Vercel](https://vercel.com)\n",
        "refactor/agents/code-simplifier.md": "---\nname: code-simplifier\ndescription: Use this agent when the user asks to \"refactor\", \"simplify code\", \"clean up code\", \"reduce duplication\", or wants a safe refactor that preserves behavior while improving clarity and maintainability. Examples:\n\n<example>\nContext: Targeted cleanup after a change.\nuser: \"/refactor src/auth/login.ts\"\nassistant: \"Launch @code-simplifier to refactor the specified file(s), load the refactor:best-practices workflow + relevant references, apply minimal behavior-preserving improvements, and summarize changes.\"\n<commentary>\nThe request is scoped to specific paths and fits a behavior-preserving refactor workflow.\n</commentary>\n</example>\n\n<example>\nContext: Project-wide consistency and duplication reduction.\nuser: \"/refactor-project\"\nassistant: \"Launch @code-simplifier with project-wide scope, follow the refactor:best-practices workflow, prioritize cross-file duplication reduction and consistent patterns, and summarize changes and suggested tests.\"\n<commentary>\nThe request explicitly asks for project-wide refactoring, requiring consistent cross-file application.\n</commentary>\n</example>\n\n<example>\nContext: Next.js performance-oriented refactor.\nuser: \"Refactor this Next.js component to improve performance without changing behavior.\"\nassistant: \"Launch @code-simplifier, load the refactor:best-practices skill, consult the Next.js references, apply only relevant rules (avoid waterfalls, reduce bundle impact, prevent hydration issues), and summarize changes.\"\n<commentary>\nNext.js performance patterns benefit from best-practice references to choose safer refactors.\n</commentary>\n</example>\n\n<example>\nContext: Code cleanup during development.\nuser: \"@code-simplifier Review and simplify the utility functions\"\nassistant: \"Launch @code-simplifier, load the refactor:best-practices skill, identify utility modules, apply simplification patterns, and summarize improvements.\"\n<commentary>\nDirect agent mention for ad-hoc refactoring without specific file paths triggers the agent with semantic scope resolution.\n</commentary>\n</example>\nmodel: opus\ncolor: blue\nskills:\n  - refactor:best-practices\ntools: [\"Read\", \"Edit\", \"Glob\", \"Grep\", \"Bash\", \"Skill\"]\n---\n\nYou are an expert code simplification specialist focused on enhancing code clarity, consistency, and maintainability while preserving exact functionality. You prioritize readable, explicit code over overly compact solutions.\n\n## Core Principles\n\n1. **Preserve Functionality**: Never change what the code does - only how it does it\n2. **Clarity Over Brevity**: Explicit code is better than overly compact code; avoid nested ternaries and dense one-liners\n3. **Maintain Balance**: Avoid over-simplification that reduces maintainability or creates overly clever solutions\n4. **Aggressive Cleanup**: Remove all backwards-compatibility hacks, unused code, poorly named identifiers\n5. **No Compromises**: Delete unused exports, re-exports, `_vars`, commented-out code completely\n6. **Proper Naming**: Rename improperly named variables/functions instead of marking them unused\n\n## Refactoring Philosophy\n\n**Aggressive refactoring means:**\n- Delete unused code completely (no `// removed` comments)\n- Remove backwards-compatibility shims (no `_oldName` aliases)\n- Rename poorly named identifiers properly\n- Remove defensive checks in trusted codepaths\n- Delete commented-out code\n- Remove unnecessary try-catch blocks\n- Clean up unused imports/exports immediately\n\n**What NOT to do:**\n- Keep unused variables prefixed with `_`\n- Re-export deleted functionality \"for compatibility\"\n- Add comments explaining removed code\n- Keep defensive null checks in internal functions\n- Preserve \"just in case\" code\n\n## Knowledge Base\n\nThe `refactor:best-practices` skill (declared in frontmatter and automatically loaded) provides the complete workflow, language references, framework detection, and rule application guidance.\n\n## Execution\n\nFollow the workflow defined in the refactor:best-practices skill:\n1. **Identify** target scope (files, directories, or project-wide)\n2. **Detect** frameworks and languages (handled by skill)\n3. **Load** appropriate references based on detected stack\n4. **Analyze** code for improvements\n5. **Execute** behavior-preserving refinements with aggressive cleanup\n6. **Validate** changes with tests\n",
        "refactor/skills/best-practices/SKILL.md": "---\nname: best-practices\ndescription: This skill should be used when the user asks to \"refactor\", \"refactor the whole project\", \"simplify code\", \"clean up code\", \"apply best practices\", \"improve readability\", \"reduce duplication\", \"standardize patterns\", \"improve performance\", \"optimize Next.js performance\", \"make code more maintainable\", \"follow coding standards\", \"optimize code quality\", or requests behavior-preserving refactoring with best-practice guidance.\nuser-invocable: false\nversion: 1.2.0\n---\n\n# Best Practices\n\n## Scope\n\nSupport both:\n\n- **Targeted refactoring**: recently modified code in the current session, or specific files/directories provided by the user\n- **Project-wide refactoring**: entire repository when explicitly requested\n\n## Agent Invocation\n\nLaunch the `code-simplifier` agent for execution. Pass the target scope and any constraints. If already running inside `code-simplifier`, skip launching and proceed with the workflow.\n\n## Language References\n\nBased on file extension, load the appropriate reference:\n\n- `.ts`, `.tsx`, `.js`, `.jsx` → See `references/typescript.md`\n- `.py` → See `references/python.md`\n- `.go` → See `references/go.md`\n- `.swift` → See `references/swift.md`\n\nFor universal principles applicable to all languages, see `references/universal.md`.\n\n## Next.js Best Practices References\n\nUse the Next.js reference set when the target includes Next.js code (typically `.tsx`, `.jsx`, Next.js app/pages routes, Server Components, Client Components).\n\nReference directory:\n\n- `references/nextjs/`\n\nRecommended entry points:\n\n1. Read `references/nextjs/INDEX.md` for complete pattern index organized by impact level and category.\n2. Read `references/nextjs/_sections.md` to understand priorities and categories.\n3. Read the specific rule file(s) that match the pattern observed (for example, `async-defer-await.md`, `bundle-dynamic-imports.md`).\n\n## Rule Application Guidance\n\n- Prefer **CRITICAL** rules first when there is evidence of user-facing impact (waterfalls, bundle size, hydration issues).\n- Keep changes minimal and targeted; optimize only when the pattern is present in the code.\n- Preserve behavior and public interfaces; do not change externally visible semantics during a refactor.\n\n## Framework and Language Detection\n\nBefore applying refactoring rules, detect the project's frameworks and languages:\n\n1. **Framework Detection**:\n   - Check for Next.js: Look for `next.config.js`, `next.config.ts`, or `\"next\"` in package.json dependencies\n   - Check for React: Look for `\"react\"` in package.json dependencies\n   - Check for Vite: Look for `vite.config.js`, `vite.config.ts`\n   - Check for other frameworks as needed\n\n2. **Language Detection**:\n   - Scan file extensions: `.ts`, `.tsx` (TypeScript), `.js`, `.jsx` (JavaScript)\n   - `.py` (Python), `.go` (Go), `.swift` (Swift)\n\n3. **Rule Category Selection**:\n   - Based on detected frameworks and user configuration, determine which rule categories to apply:\n     - **Next.js projects only**: async, bundle, server, client, rerender, rendering, js, advanced\n     - **React (non-Next.js) projects**: client, rerender, rendering, js\n     - **All projects**: Universal principles, language-specific rules\n\n**IMPORTANT**: Only apply Next.js-specific rules if Next.js is actually detected. For Tauri + React + Vite projects or other React setups without Next.js, only apply React-specific and universal rules.\n\n## Rule Application Strategy\n\nApply rules based on framework detection and project characteristics:\n\n- **Next.js-specific rules**: Only applied if Next.js is detected\n- **Language-specific rules**: Applied based on detected file types\n- **Universal rules**: Applied to all projects\n\nFramework detection determines which rule categories are applicable.\n\n## Code Quality Standards\n\nApply these standards during all refactoring operations:\n\n- **Comments**: Only add comments explaining complex business logic or non-obvious decisions; remove comments that restate code or conflict with file style\n- **Error Handling**: Add try-catch only where errors can be handled/recovered; remove defensive checks in trusted internal paths (validate only at boundaries: user input, external APIs)\n- **Type Safety**: Never use `any` to bypass type issues; use proper types, `unknown` with type guards, or refactor the root cause\n- **Style Consistency**: Match existing code style in file and project; check CLAUDE.md for conventions\n- **Aggressive cleanup**: Remove unused imports, variables, functions, and type definitions completely\n- **No backwards-compatibility hacks**: Delete unused `_vars`, remove re-exports of deleted code, remove `// removed` comments\n- **Proper renaming**: Rename poorly named variables/functions to descriptive names instead of marking them unused\n- **Delete dead code**: If code is unreachable or unused, delete it completely rather than commenting it out\n\n## Workflow\n\n1. **Identify**: Determine target scope (specified files/directories, session modifications, or entire project)\n2. **Detect**: Identify frameworks (Next.js, React, Vite, etc.) and languages in the codebase\n3. **Load References**: Load language references for the target files, plus framework-specific references when applicable\n4. **Filter Rules**: Only apply rules for detected frameworks (e.g., skip Next.js rules if Next.js not present)\n5. **Analyze**: Review code for complexity, redundancy, and best-practice violations that matter for the target scope\n6. **Execute**: Apply behavior-preserving refinements following the loaded references and Code Quality Standards\n7. **Validate**: Ensure tests pass (or suggest the most relevant tests to run) and the code is cleaner\n",
        "refactor/skills/best-practices/references/go.md": "# Go Code Standards\n\nLanguage-specific guidelines for Go projects following Go idioms and best practices. Always apply [universal.md](universal.md) principles in addition to these language-specific rules.\n\n## Code Style\n\n### Formatting\n- Use `gofmt` or `goimports` for automatic formatting\n- Go has a canonical style - follow it\n- No arguments about formatting - the tooling decides\n\n### Naming Conventions\n- **Packages**: short, lowercase, single-word names (`http`, `json`, `user`)\n- **Exported names**: Start with capital letter (`UserService`, `GetUser`)\n- **Unexported names**: Start with lowercase letter (`userCache`, `validateEmail`)\n- **Interfaces**: Noun or Agent noun (`Reader`, `Writer`, `Handler`)\n- **Single-method interfaces**: Method name + `-er` suffix (`Reader`, `Closer`)\n\n### Example\n```go\npackage user\n\n// Exported type\ntype User struct {\n    ID   string\n    Name string\n}\n\n// Exported function\nfunc GetUser(id string) (*User, error) {\n    return findUser(id)\n}\n\n// Unexported function\nfunc findUser(id string) (*User, error) {\n    // Implementation\n    return nil, nil\n}\n\n// Interface following naming convention\ntype UserFinder interface {\n    FindUser(id string) (*User, error)\n}\n```\n\n## Error Handling\n\n### Return Errors, Don't Panic\n- Return errors as the last return value\n- Check errors immediately\n- Don't ignore errors (use `_` only when justified)\n- Panic only for programming errors or initialization failures\n\n### Example\n```go\n// Good - explicit error handling\nfunc ReadConfig(path string) (*Config, error) {\n    data, err := os.ReadFile(path)\n    if err != nil {\n        return nil, fmt.Errorf(\"read config: %w\", err)\n    }\n\n    var config Config\n    if err := json.Unmarshal(data, &config); err != nil {\n        return nil, fmt.Errorf(\"parse config: %w\", err)\n    }\n\n    return &config, nil\n}\n\n// Bad - ignoring errors\nfunc badReadConfig(path string) *Config {\n    data, _ := os.ReadFile(path)  // Don't do this!\n    var config Config\n    json.Unmarshal(data, &config)\n    return &config\n}\n```\n\n### Error Wrapping (Go 1.13+)\n- Use `%w` verb with `fmt.Errorf` to wrap errors\n- Use `errors.Is()` and `errors.As()` to check wrapped errors\n- Add context when wrapping errors\n\n### Example\n```go\nimport \"errors\"\n\nvar ErrNotFound = errors.New(\"not found\")\n\nfunc GetUser(id string) (*User, error) {\n    user, err := db.FindUser(id)\n    if err != nil {\n        if errors.Is(err, sql.ErrNoRows) {\n            return nil, ErrNotFound\n        }\n        return nil, fmt.Errorf(\"get user %s: %w\", id, err)\n    }\n    return user, nil\n}\n\n// Checking errors\nuser, err := GetUser(\"123\")\nif errors.Is(err, ErrNotFound) {\n    // Handle not found case\n}\n```\n\n## Functions and Methods\n\n### Receiver Types\n- Use pointer receivers when:\n  - Method modifies the receiver\n  - Receiver is large struct\n  - Consistency (if one method uses pointer, use for all)\n- Use value receivers for:\n  - Small, immutable types\n  - Types that are copied anyway\n\n### Example\n```go\n// Pointer receiver - modifies state\nfunc (u *User) SetName(name string) {\n    u.Name = name\n}\n\n// Value receiver - no modification\nfunc (u User) FullName() string {\n    return u.FirstName + \" \" + u.LastName\n}\n```\n\n### Multiple Return Values\n- Use multiple return values to return result and error\n- Name return values only when it improves clarity\n- Avoid named returns in complex functions\n\n### Example\n```go\n// Clear without named returns\nfunc Divide(a, b float64) (float64, error) {\n    if b == 0 {\n        return 0, errors.New(\"division by zero\")\n    }\n    return a / b, nil\n}\n\n// Named returns for clarity (use sparingly)\nfunc SplitName(full string) (first, last string) {\n    parts := strings.Split(full, \" \")\n    if len(parts) > 0 {\n        first = parts[0]\n    }\n    if len(parts) > 1 {\n        last = parts[1]\n    }\n    return\n}\n```\n\n## Interfaces\n\n### Accept Interfaces, Return Structs\n- Accept interfaces as parameters (flexible)\n- Return concrete types (clear API)\n- Define interfaces where they're used, not where they're implemented\n\n### Example\n```go\n// Define interface in consumer package\ntype UserStore interface {\n    GetUser(id string) (*User, error)\n    SaveUser(user *User) error\n}\n\n// Accept interface\nfunc ProcessUser(store UserStore, id string) error {\n    user, err := store.GetUser(id)\n    if err != nil {\n        return err\n    }\n    // Process user\n    return store.SaveUser(user)\n}\n\n// Return concrete type\nfunc NewUserCache() *UserCache {\n    return &UserCache{\n        data: make(map[string]*User),\n    }\n}\n```\n\n### Small Interfaces\n- Prefer small, focused interfaces\n- Single-method interfaces are common and idiomatic\n- Compose larger interfaces from smaller ones\n\n## Concurrency\n\n### Goroutines and Channels\n- Use goroutines for concurrent operations\n- Use channels to communicate between goroutines\n- Always ensure goroutines exit (avoid leaks)\n- Use `sync.WaitGroup` or channels to wait for completion\n\n### Example\n```go\nfunc ProcessItems(items []Item) []Result {\n    results := make(chan Result, len(items))\n\n    for _, item := range items {\n        go func(item Item) {\n            results <- processItem(item)\n        }(item)  // Pass item to avoid closure capture issue\n    }\n\n    // Collect results\n    output := make([]Result, 0, len(items))\n    for i := 0; i < len(items); i++ {\n        output = append(output, <-results)\n    }\n\n    return output\n}\n```\n\n### Context for Cancellation\n- Use `context.Context` for cancellation and deadlines\n- Pass context as first parameter\n- Respect context cancellation\n\n### Example\n```go\nfunc FetchData(ctx context.Context, url string) ([]byte, error) {\n    req, err := http.NewRequestWithContext(ctx, \"GET\", url, nil)\n    if err != nil {\n        return nil, err\n    }\n\n    resp, err := http.DefaultClient.Do(req)\n    if err != nil {\n        return nil, err\n    }\n    defer resp.Body.Close()\n\n    return io.ReadAll(resp.Body)\n}\n```\n\n## Package Organization\n\n### Package Structure\n- Group related functionality\n- Keep packages focused and cohesive\n- Avoid circular dependencies\n- Use internal packages for implementation details\n\n### Example Structure\n```\nmyapp/\n├── cmd/\n│   └── myapp/\n│       └── main.go\n├── internal/\n│   ├── user/\n│   │   ├── user.go\n│   │   ├── store.go\n│   │   └── handler.go\n│   └── auth/\n│       └── auth.go\n└── pkg/\n    └── api/\n        └── client.go\n```\n\n### Import Organization\n- Standard library first\n- Third-party packages second\n- Local packages last\n- Use `goimports` to organize automatically\n\n## Testing\n\n### Table-Driven Tests\n- Use table-driven tests for multiple test cases\n- Name test cases clearly\n- Test both success and error paths\n\n### Example\n```go\nfunc TestAdd(t *testing.T) {\n    tests := []struct {\n        name     string\n        a, b     int\n        expected int\n    }{\n        {\"positive numbers\", 2, 3, 5},\n        {\"negative numbers\", -2, -3, -5},\n        {\"mixed signs\", 5, -3, 2},\n        {\"with zero\", 5, 0, 5},\n    }\n\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            result := Add(tt.a, tt.b)\n            if result != tt.expected {\n                t.Errorf(\"Add(%d, %d) = %d; want %d\",\n                    tt.a, tt.b, result, tt.expected)\n            }\n        })\n    }\n}\n```\n\n### Test Helpers\n- Use `t.Helper()` to mark helper functions\n- Create test fixtures for complex setup\n\n## Common Patterns\n\n### Constructor Functions\n- Use `New` or `NewType` for constructors\n- Return pointers to structs\n- Initialize all fields\n\n### Example\n```go\nfunc NewUser(id, name string) *User {\n    return &User{\n        ID:        id,\n        Name:      name,\n        CreatedAt: time.Now(),\n    }\n}\n```\n\n### Options Pattern\n- Use functional options for flexible configuration\n- Good for types with many optional parameters\n\n### Example\n```go\ntype Server struct {\n    port    int\n    timeout time.Duration\n}\n\ntype Option func(*Server)\n\nfunc WithPort(port int) Option {\n    return func(s *Server) {\n        s.port = port\n    }\n}\n\nfunc WithTimeout(timeout time.Duration) Option {\n    return func(s *Server) {\n        s.timeout = timeout\n    }\n}\n\nfunc NewServer(opts ...Option) *Server {\n    s := &Server{\n        port:    8080,\n        timeout: 30 * time.Second,\n    }\n\n    for _, opt := range opts {\n        opt(s)\n    }\n\n    return s\n}\n\n// Usage\nserver := NewServer(\n    WithPort(9000),\n    WithTimeout(60 * time.Second),\n)\n```\n\n## Memory and Performance\n\n### Slice Capacity\n- Pre-allocate slices when size is known\n- Use `make` with capacity to avoid reallocations\n\n### Example\n```go\n// Good - pre-allocate\nitems := make([]Item, 0, 100)\nfor i := 0; i < 100; i++ {\n    items = append(items, Item{ID: i})\n}\n\n// Less efficient\nitems := []Item{}\nfor i := 0; i < 100; i++ {\n    items = append(items, Item{ID: i})\n}\n```\n\n### String Building\n- Use `strings.Builder` for efficient string concatenation\n- Avoid `+` operator in loops\n\n### Example\n```go\nvar b strings.Builder\nfor _, word := range words {\n    b.WriteString(word)\n    b.WriteString(\" \")\n}\nresult := b.String()\n```\n\n## Documentation\n\n### Godoc Comments\n- Start with the name being documented\n- Write complete sentences\n- Use examples when helpful\n\n### Example\n```go\n// User represents a user in the system.\ntype User struct {\n    ID   string\n    Name string\n}\n\n// GetUser retrieves a user by ID.\n// It returns ErrNotFound if the user doesn't exist.\nfunc GetUser(id string) (*User, error) {\n    // Implementation\n    return nil, nil\n}\n```\n\n## Tools and Linting\n\n### Essential Tools\n- `go fmt` / `gofmt`: Format code\n- `goimports`: Organize imports\n- `go vet`: Static analysis\n- `golangci-lint`: Comprehensive linting\n- `go mod`: Dependency management\n\n### Run Before Commit\n```bash\ngo fmt ./...\ngoimports -w .\ngo vet ./...\ngolangci-lint run\ngo test ./...\n```\n\n## Project-Specific Standards\n\nAlways check the project's `CLAUDE.md` file for additional project-specific standards that override or extend these guidelines.\n",
        "refactor/skills/best-practices/references/nextjs/INDEX.md": "# Next.js Performance Patterns Index\n\nComplete index of all 47 Next.js performance optimization patterns, organized by category and impact level.\n\n**Quick Navigation:**\n- [By Impact Level](#by-impact-level)\n- [By Category](#by-category)\n- [Pattern Summary](#pattern-summary)\n\n---\n\n## By Impact Level\n\n### CRITICAL Impact (12 patterns)\nThese patterns have direct, measurable impact on user experience. Fix these first.\n\n**Eliminating Waterfalls (async):**\n- [async-defer-await.md](async-defer-await.md) - Defer non-critical async operations\n- [async-parallel.md](async-parallel.md) - Parallelize independent operations\n- [async-api-routes.md](async-api-routes.md) - Optimize API route handlers\n- [async-dependencies.md](async-dependencies.md) - Handle async dependencies efficiently\n- [async-suspense-boundaries.md](async-suspense-boundaries.md) - Strategic Suspense boundary placement\n\n**Bundle Size Optimization (bundle):**\n- [bundle-dynamic-imports.md](bundle-dynamic-imports.md) - Code splitting with dynamic imports\n- [bundle-conditional.md](bundle-conditional.md) - Conditional imports based on runtime\n- [bundle-barrel-imports.md](bundle-barrel-imports.md) - Avoid barrel file performance issues\n- [bundle-defer-third-party.md](bundle-defer-third-party.md) - Defer third-party scripts\n- [bundle-preload.md](bundle-preload.md) - Preload critical resources\n\n### HIGH Impact (7 patterns)\nSignificant performance or maintainability improvements.\n\n**Server-Side Performance (server):**\n- [server-parallel-fetching.md](server-parallel-fetching.md) - Parallelize server data fetching\n- [server-cache-react.md](server-cache-react.md) - React cache for deduplication\n- [server-cache-lru.md](server-cache-lru.md) - LRU caching strategies\n- [server-after-nonblocking.md](server-after-nonblocking.md) - Non-blocking after() API\n- [server-serialization.md](server-serialization.md) - Efficient data serialization\n\n### MEDIUM-HIGH Impact (4 patterns)\nNoticeable improvements in client-side performance.\n\n**Client-Side Data Fetching (client):**\n- [client-swr-dedup.md](client-swr-dedup.md) - Automatic request deduplication\n- [client-event-listeners.md](client-event-listeners.md) - Efficient event listener management\n- [client-passive-event-listeners.md](client-passive-event-listeners.md) - Passive event listeners\n- [client-localstorage-schema.md](client-localstorage-schema.md) - LocalStorage schema validation\n\n### MEDIUM Impact (14 patterns)\nReduces unnecessary computation and improves UI responsiveness.\n\n**Re-render Optimization (rerender):**\n- [rerender-memo.md](rerender-memo.md) - Memoization with React.memo and useMemo\n- [rerender-dependencies.md](rerender-dependencies.md) - Correct dependency arrays\n- [rerender-derived-state.md](rerender-derived-state.md) - Avoid derived state anti-patterns\n- [rerender-functional-setstate.md](rerender-functional-setstate.md) - Functional state updates\n- [rerender-lazy-state-init.md](rerender-lazy-state-init.md) - Lazy state initialization\n- [rerender-defer-reads.md](rerender-defer-reads.md) - Defer expensive reads\n- [rerender-transitions.md](rerender-transitions.md) - Use transitions for non-urgent updates\n\n**Rendering Performance (rendering):**\n- [rendering-hoist-jsx.md](rendering-hoist-jsx.md) - Hoist JSX outside render\n- [rendering-conditional-render.md](rendering-conditional-render.md) - Optimize conditional rendering\n- [rendering-content-visibility.md](rendering-content-visibility.md) - CSS content-visibility\n- [rendering-hydration-no-flicker.md](rendering-hydration-no-flicker.md) - Prevent hydration flicker\n- [rendering-activity.md](rendering-activity.md) - Optimize activity indicators\n- [rendering-animate-svg-wrapper.md](rendering-animate-svg-wrapper.md) - Efficient SVG animations\n- [rendering-svg-precision.md](rendering-svg-precision.md) - SVG precision optimization\n\n### LOW-MEDIUM Impact (12 patterns)\nMicro-optimizations for hot paths.\n\n**JavaScript Performance (js):**\n- [js-early-exit.md](js-early-exit.md) - Early exit patterns\n- [js-set-map-lookups.md](js-set-map-lookups.md) - Use Set/Map for O(1) lookups\n- [js-cache-property-access.md](js-cache-property-access.md) - Cache property access\n- [js-cache-function-results.md](js-cache-function-results.md) - Memoize function results\n- [js-combine-iterations.md](js-combine-iterations.md) - Combine multiple iterations\n- [js-length-check-first.md](js-length-check-first.md) - Check length before iteration\n- [js-batch-dom-css.md](js-batch-dom-css.md) - Batch DOM/CSS updates\n- [js-hoist-regexp.md](js-hoist-regexp.md) - Hoist RegExp outside functions\n- [js-tosorted-immutable.md](js-tosorted-immutable.md) - Use toSorted for immutability\n- [js-index-maps.md](js-index-maps.md) - Index maps for fast lookups\n- [js-min-max-loop.md](js-min-max-loop.md) - Min/max without extra loops\n- [js-cache-storage.md](js-cache-storage.md) - Cache expensive storage access\n\n### LOW Impact (2 patterns)\nAdvanced patterns for specific edge cases.\n\n**Advanced Patterns (advanced):**\n- [advanced-use-latest.md](advanced-use-latest.md) - useLatest hook for stable refs\n- [advanced-event-handler-refs.md](advanced-event-handler-refs.md) - Event handler refs pattern\n\n---\n\n## By Category\n\n### 1. Eliminating Waterfalls (async) - CRITICAL\n**5 patterns** | Waterfalls are the #1 performance killer\n\n- [async-defer-await.md](async-defer-await.md)\n- [async-parallel.md](async-parallel.md)\n- [async-api-routes.md](async-api-routes.md)\n- [async-dependencies.md](async-dependencies.md)\n- [async-suspense-boundaries.md](async-suspense-boundaries.md)\n\n### 2. Bundle Size Optimization (bundle) - CRITICAL\n**5 patterns** | Reduce initial bundle size for faster TTI\n\n- [bundle-dynamic-imports.md](bundle-dynamic-imports.md)\n- [bundle-conditional.md](bundle-conditional.md)\n- [bundle-barrel-imports.md](bundle-barrel-imports.md)\n- [bundle-defer-third-party.md](bundle-defer-third-party.md)\n- [bundle-preload.md](bundle-preload.md)\n\n### 3. Server-Side Performance (server) - HIGH\n**5 patterns** | Optimize server rendering and data fetching\n\n- [server-parallel-fetching.md](server-parallel-fetching.md)\n- [server-cache-react.md](server-cache-react.md)\n- [server-cache-lru.md](server-cache-lru.md)\n- [server-after-nonblocking.md](server-after-nonblocking.md)\n- [server-serialization.md](server-serialization.md)\n\n### 4. Client-Side Data Fetching (client) - MEDIUM-HIGH\n**4 patterns** | Efficient data fetching on the client\n\n- [client-swr-dedup.md](client-swr-dedup.md)\n- [client-event-listeners.md](client-event-listeners.md)\n- [client-passive-event-listeners.md](client-passive-event-listeners.md)\n- [client-localstorage-schema.md](client-localstorage-schema.md)\n\n### 5. Re-render Optimization (rerender) - MEDIUM\n**7 patterns** | Reduce unnecessary re-renders\n\n- [rerender-memo.md](rerender-memo.md)\n- [rerender-dependencies.md](rerender-dependencies.md)\n- [rerender-derived-state.md](rerender-derived-state.md)\n- [rerender-functional-setstate.md](rerender-functional-setstate.md)\n- [rerender-lazy-state-init.md](rerender-lazy-state-init.md)\n- [rerender-defer-reads.md](rerender-defer-reads.md)\n- [rerender-transitions.md](rerender-transitions.md)\n\n### 6. Rendering Performance (rendering) - MEDIUM\n**7 patterns** | Optimize the rendering process\n\n- [rendering-hoist-jsx.md](rendering-hoist-jsx.md)\n- [rendering-conditional-render.md](rendering-conditional-render.md)\n- [rendering-content-visibility.md](rendering-content-visibility.md)\n- [rendering-hydration-no-flicker.md](rendering-hydration-no-flicker.md)\n- [rendering-activity.md](rendering-activity.md)\n- [rendering-animate-svg-wrapper.md](rendering-animate-svg-wrapper.md)\n- [rendering-svg-precision.md](rendering-svg-precision.md)\n\n### 7. JavaScript Performance (js) - LOW-MEDIUM\n**12 patterns** | Micro-optimizations for hot paths\n\n- [js-early-exit.md](js-early-exit.md)\n- [js-set-map-lookups.md](js-set-map-lookups.md)\n- [js-cache-property-access.md](js-cache-property-access.md)\n- [js-cache-function-results.md](js-cache-function-results.md)\n- [js-combine-iterations.md](js-combine-iterations.md)\n- [js-length-check-first.md](js-length-check-first.md)\n- [js-batch-dom-css.md](js-batch-dom-css.md)\n- [js-hoist-regexp.md](js-hoist-regexp.md)\n- [js-tosorted-immutable.md](js-tosorted-immutable.md)\n- [js-index-maps.md](js-index-maps.md)\n- [js-min-max-loop.md](js-min-max-loop.md)\n- [js-cache-storage.md](js-cache-storage.md)\n\n### 8. Advanced Patterns (advanced) - LOW\n**2 patterns** | Advanced patterns for specific cases\n\n- [advanced-use-latest.md](advanced-use-latest.md)\n- [advanced-event-handler-refs.md](advanced-event-handler-refs.md)\n\n---\n\n## Pattern Summary\n\n**Total Patterns:** 47\n\n**By Impact:**\n- CRITICAL: 10 patterns (21%)\n- HIGH: 5 patterns (11%)\n- MEDIUM-HIGH: 4 patterns (9%)\n- MEDIUM: 14 patterns (30%)\n- LOW-MEDIUM: 12 patterns (26%)\n- LOW: 2 patterns (4%)\n\n**By Category:**\n- Async: 5 patterns\n- Bundle: 5 patterns\n- Server: 5 patterns\n- Client: 4 patterns\n- Re-render: 7 patterns\n- Rendering: 7 patterns\n- JavaScript: 12 patterns\n- Advanced: 2 patterns\n\n---\n\n## How to Use This Index\n\n1. **Start with CRITICAL patterns**: These have the largest impact on user experience\n2. **Focus on your bottlenecks**: Use profiling to identify which categories matter most\n3. **Read pattern files**: Each pattern includes before/after examples and detailed explanations\n4. **Use impact-based prioritization**: The refactor plugin automatically prioritizes CRITICAL > HIGH > MEDIUM > LOW\n\n## Related Files\n\n- [_sections.md](_sections.md) - Category descriptions and impact levels\n- [_template.md](_template.md) - Template for creating new patterns",
        "refactor/skills/best-practices/references/nextjs/_sections.md": "# Sections\n\nThis file defines all sections, their ordering, impact levels, and descriptions.\nThe section ID (in parentheses) is the filename prefix used to group rules.\n\n---\n\n## 1. Eliminating Waterfalls (async)\n\n**Impact:** CRITICAL  \n**Description:** Waterfalls are the #1 performance killer. Each sequential await adds full network latency. Eliminating them yields the largest gains.\n\n## 2. Bundle Size Optimization (bundle)\n\n**Impact:** CRITICAL  \n**Description:** Reducing initial bundle size improves Time to Interactive and Largest Contentful Paint.\n\n## 3. Server-Side Performance (server)\n\n**Impact:** HIGH  \n**Description:** Optimizing server-side rendering and data fetching eliminates server-side waterfalls and reduces response times.\n\n## 4. Client-Side Data Fetching (client)\n\n**Impact:** MEDIUM-HIGH  \n**Description:** Automatic deduplication and efficient data fetching patterns reduce redundant network requests.\n\n## 5. Re-render Optimization (rerender)\n\n**Impact:** MEDIUM  \n**Description:** Reducing unnecessary re-renders minimizes wasted computation and improves UI responsiveness.\n\n## 6. Rendering Performance (rendering)\n\n**Impact:** MEDIUM  \n**Description:** Optimizing the rendering process reduces the work the browser needs to do.\n\n## 7. JavaScript Performance (js)\n\n**Impact:** LOW-MEDIUM  \n**Description:** Micro-optimizations for hot paths can add up to meaningful improvements.\n\n## 8. Advanced Patterns (advanced)\n\n**Impact:** LOW  \n**Description:** Advanced patterns for specific cases that require careful implementation.\n",
        "refactor/skills/best-practices/references/nextjs/_template.md": "---\ntitle: Rule Title Here\nimpact: MEDIUM\nimpactDescription: Optional description of impact (e.g., \"20-50% improvement\")\ntags: tag1, tag2\n---\n\n## Rule Title Here\n\n**Impact: MEDIUM (optional impact description)**\n\nBrief explanation of the rule and why it matters. This should be clear and concise, explaining the performance implications.\n\n**Incorrect (description of what's wrong):**\n\n```typescript\n// Bad code example here\nconst bad = example()\n```\n\n**Correct (description of what's right):**\n\n```typescript\n// Good code example here\nconst good = example()\n```\n\nReference: [Link to documentation or resource](https://example.com)\n",
        "refactor/skills/best-practices/references/nextjs/advanced-event-handler-refs.md": "---\ntitle: Store Event Handlers in Refs\nimpact: LOW\nimpactDescription: stable subscriptions\ntags: advanced, hooks, refs, event-handlers, optimization\n---\n\n## Store Event Handlers in Refs\n\nStore callbacks in refs when used in effects that shouldn't re-subscribe on callback changes.\n\n**Incorrect (re-subscribes on every render):**\n\n```tsx\nfunction useWindowEvent(event: string, handler: (e) => void) {\n  useEffect(() => {\n    window.addEventListener(event, handler)\n    return () => window.removeEventListener(event, handler)\n  }, [event, handler])\n}\n```\n\n**Correct (stable subscription):**\n\n```tsx\nfunction useWindowEvent(event: string, handler: (e) => void) {\n  const handlerRef = useRef(handler)\n  useEffect(() => {\n    handlerRef.current = handler\n  }, [handler])\n\n  useEffect(() => {\n    const listener = (e) => handlerRef.current(e)\n    window.addEventListener(event, listener)\n    return () => window.removeEventListener(event, listener)\n  }, [event])\n}\n```\n\n**Alternative: use `useEffectEvent` if you're on latest React:**\n\n```tsx\nimport { useEffectEvent } from 'react'\n\nfunction useWindowEvent(event: string, handler: (e) => void) {\n  const onEvent = useEffectEvent(handler)\n\n  useEffect(() => {\n    window.addEventListener(event, onEvent)\n    return () => window.removeEventListener(event, onEvent)\n  }, [event])\n}\n```\n\n`useEffectEvent` provides a cleaner API for the same pattern: it creates a stable function reference that always calls the latest version of the handler.\n",
        "refactor/skills/best-practices/references/nextjs/advanced-use-latest.md": "---\ntitle: useLatest for Stable Callback Refs\nimpact: LOW\nimpactDescription: prevents effect re-runs\ntags: advanced, hooks, useLatest, refs, optimization\n---\n\n## useLatest for Stable Callback Refs\n\nAccess latest values in callbacks without adding them to dependency arrays. Prevents effect re-runs while avoiding stale closures.\n\n**Implementation:**\n\n```typescript\nfunction useLatest<T>(value: T) {\n  const ref = useRef(value)\n  useLayoutEffect(() => {\n    ref.current = value\n  }, [value])\n  return ref\n}\n```\n\n**Incorrect (effect re-runs on every callback change):**\n\n```tsx\nfunction SearchInput({ onSearch }: { onSearch: (q: string) => void }) {\n  const [query, setQuery] = useState('')\n\n  useEffect(() => {\n    const timeout = setTimeout(() => onSearch(query), 300)\n    return () => clearTimeout(timeout)\n  }, [query, onSearch])\n}\n```\n\n**Correct (stable effect, fresh callback):**\n\n```tsx\nfunction SearchInput({ onSearch }: { onSearch: (q: string) => void }) {\n  const [query, setQuery] = useState('')\n  const onSearchRef = useLatest(onSearch)\n\n  useEffect(() => {\n    const timeout = setTimeout(() => onSearchRef.current(query), 300)\n    return () => clearTimeout(timeout)\n  }, [query])\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/async-api-routes.md": "---\ntitle: Prevent Waterfall Chains in API Routes\nimpact: CRITICAL\nimpactDescription: 2-10× improvement\ntags: api-routes, server-actions, waterfalls, parallelization\n---\n\n## Prevent Waterfall Chains in API Routes\n\nIn API routes and Server Actions, start independent operations immediately, even if you don't await them yet.\n\n**Incorrect (config waits for auth, data waits for both):**\n\n```typescript\nexport async function GET(request: Request) {\n  const session = await auth()\n  const config = await fetchConfig()\n  const data = await fetchData(session.user.id)\n  return Response.json({ data, config })\n}\n```\n\n**Correct (auth and config start immediately):**\n\n```typescript\nexport async function GET(request: Request) {\n  const sessionPromise = auth()\n  const configPromise = fetchConfig()\n  const session = await sessionPromise\n  const [config, data] = await Promise.all([\n    configPromise,\n    fetchData(session.user.id)\n  ])\n  return Response.json({ data, config })\n}\n```\n\nFor operations with more complex dependency chains, use `better-all` to automatically maximize parallelism (see Dependency-Based Parallelization).\n",
        "refactor/skills/best-practices/references/nextjs/async-defer-await.md": "---\ntitle: Defer Await Until Needed\nimpact: HIGH\nimpactDescription: avoids blocking unused code paths\ntags: async, await, conditional, optimization\n---\n\n## Defer Await Until Needed\n\nMove `await` operations into the branches where they're actually used to avoid blocking code paths that don't need them.\n\n**Incorrect (blocks both branches):**\n\n```typescript\nasync function handleRequest(userId: string, skipProcessing: boolean) {\n  const userData = await fetchUserData(userId)\n  \n  if (skipProcessing) {\n    // Returns immediately but still waited for userData\n    return { skipped: true }\n  }\n  \n  // Only this branch uses userData\n  return processUserData(userData)\n}\n```\n\n**Correct (only blocks when needed):**\n\n```typescript\nasync function handleRequest(userId: string, skipProcessing: boolean) {\n  if (skipProcessing) {\n    // Returns immediately without waiting\n    return { skipped: true }\n  }\n  \n  // Fetch only when needed\n  const userData = await fetchUserData(userId)\n  return processUserData(userData)\n}\n```\n\n**Another example (early return optimization):**\n\n```typescript\n// Incorrect: always fetches permissions\nasync function updateResource(resourceId: string, userId: string) {\n  const permissions = await fetchPermissions(userId)\n  const resource = await getResource(resourceId)\n  \n  if (!resource) {\n    return { error: 'Not found' }\n  }\n  \n  if (!permissions.canEdit) {\n    return { error: 'Forbidden' }\n  }\n  \n  return await updateResourceData(resource, permissions)\n}\n\n// Correct: fetches only when needed\nasync function updateResource(resourceId: string, userId: string) {\n  const resource = await getResource(resourceId)\n  \n  if (!resource) {\n    return { error: 'Not found' }\n  }\n  \n  const permissions = await fetchPermissions(userId)\n  \n  if (!permissions.canEdit) {\n    return { error: 'Forbidden' }\n  }\n  \n  return await updateResourceData(resource, permissions)\n}\n```\n\nThis optimization is especially valuable when the skipped branch is frequently taken, or when the deferred operation is expensive.\n",
        "refactor/skills/best-practices/references/nextjs/async-dependencies.md": "---\ntitle: Dependency-Based Parallelization\nimpact: CRITICAL\nimpactDescription: 2-10× improvement\ntags: async, parallelization, dependencies, better-all\n---\n\n## Dependency-Based Parallelization\n\nFor operations with partial dependencies, use `better-all` to maximize parallelism. It automatically starts each task at the earliest possible moment.\n\n**Incorrect (profile waits for config unnecessarily):**\n\n```typescript\nconst [user, config] = await Promise.all([\n  fetchUser(),\n  fetchConfig()\n])\nconst profile = await fetchProfile(user.id)\n```\n\n**Correct (config and profile run in parallel):**\n\n```typescript\nimport { all } from 'better-all'\n\nconst { user, config, profile } = await all({\n  async user() { return fetchUser() },\n  async config() { return fetchConfig() },\n  async profile() {\n    return fetchProfile((await this.$.user).id)\n  }\n})\n```\n\nReference: [https://github.com/shuding/better-all](https://github.com/shuding/better-all)\n",
        "refactor/skills/best-practices/references/nextjs/async-parallel.md": "---\ntitle: Promise.all() for Independent Operations\nimpact: CRITICAL\nimpactDescription: 2-10× improvement\ntags: async, parallelization, promises, waterfalls\n---\n\n## Promise.all() for Independent Operations\n\nWhen async operations have no interdependencies, execute them concurrently using `Promise.all()`.\n\n**Incorrect (sequential execution, 3 round trips):**\n\n```typescript\nconst user = await fetchUser()\nconst posts = await fetchPosts()\nconst comments = await fetchComments()\n```\n\n**Correct (parallel execution, 1 round trip):**\n\n```typescript\nconst [user, posts, comments] = await Promise.all([\n  fetchUser(),\n  fetchPosts(),\n  fetchComments()\n])\n```\n",
        "refactor/skills/best-practices/references/nextjs/async-suspense-boundaries.md": "---\ntitle: Strategic Suspense Boundaries\nimpact: HIGH\nimpactDescription: faster initial paint\ntags: async, suspense, streaming, layout-shift\n---\n\n## Strategic Suspense Boundaries\n\nInstead of awaiting data in async components before returning JSX, use Suspense boundaries to show the wrapper UI faster while data loads.\n\n**Incorrect (wrapper blocked by data fetching):**\n\n```tsx\nasync function Page() {\n  const data = await fetchData() // Blocks entire page\n  \n  return (\n    <div>\n      <div>Sidebar</div>\n      <div>Header</div>\n      <div>\n        <DataDisplay data={data} />\n      </div>\n      <div>Footer</div>\n    </div>\n  )\n}\n```\n\nThe entire layout waits for data even though only the middle section needs it.\n\n**Correct (wrapper shows immediately, data streams in):**\n\n```tsx\nfunction Page() {\n  return (\n    <div>\n      <div>Sidebar</div>\n      <div>Header</div>\n      <div>\n        <Suspense fallback={<Skeleton />}>\n          <DataDisplay />\n        </Suspense>\n      </div>\n      <div>Footer</div>\n    </div>\n  )\n}\n\nasync function DataDisplay() {\n  const data = await fetchData() // Only blocks this component\n  return <div>{data.content}</div>\n}\n```\n\nSidebar, Header, and Footer render immediately. Only DataDisplay waits for data.\n\n**Alternative (share promise across components):**\n\n```tsx\nfunction Page() {\n  // Start fetch immediately, but don't await\n  const dataPromise = fetchData()\n  \n  return (\n    <div>\n      <div>Sidebar</div>\n      <div>Header</div>\n      <Suspense fallback={<Skeleton />}>\n        <DataDisplay dataPromise={dataPromise} />\n        <DataSummary dataPromise={dataPromise} />\n      </Suspense>\n      <div>Footer</div>\n    </div>\n  )\n}\n\nfunction DataDisplay({ dataPromise }: { dataPromise: Promise<Data> }) {\n  const data = use(dataPromise) // Unwraps the promise\n  return <div>{data.content}</div>\n}\n\nfunction DataSummary({ dataPromise }: { dataPromise: Promise<Data> }) {\n  const data = use(dataPromise) // Reuses the same promise\n  return <div>{data.summary}</div>\n}\n```\n\nBoth components share the same promise, so only one fetch occurs. Layout renders immediately while both components wait together.\n\n**When NOT to use this pattern:**\n\n- Critical data needed for layout decisions (affects positioning)\n- SEO-critical content above the fold\n- Small, fast queries where suspense overhead isn't worth it\n- When you want to avoid layout shift (loading → content jump)\n\n**Trade-off:** Faster initial paint vs potential layout shift. Choose based on your UX priorities.\n",
        "refactor/skills/best-practices/references/nextjs/bundle-barrel-imports.md": "---\ntitle: Avoid Barrel File Imports\nimpact: CRITICAL\nimpactDescription: 200-800ms import cost, slow builds\ntags: bundle, imports, tree-shaking, barrel-files, performance\n---\n\n## Avoid Barrel File Imports\n\nImport directly from source files instead of barrel files to avoid loading thousands of unused modules. **Barrel files** are entry points that re-export multiple modules (e.g., `index.js` that does `export * from './module'`).\n\nPopular icon and component libraries can have **up to 10,000 re-exports** in their entry file. For many React packages, **it takes 200-800ms just to import them**, affecting both development speed and production cold starts.\n\n**Why tree-shaking doesn't help:** When a library is marked as external (not bundled), the bundler can't optimize it. If you bundle it to enable tree-shaking, builds become substantially slower analyzing the entire module graph.\n\n**Incorrect (imports entire library):**\n\n```tsx\nimport { Check, X, Menu } from 'lucide-react'\n// Loads 1,583 modules, takes ~2.8s extra in dev\n// Runtime cost: 200-800ms on every cold start\n\nimport { Button, TextField } from '@mui/material'\n// Loads 2,225 modules, takes ~4.2s extra in dev\n```\n\n**Correct (imports only what you need):**\n\n```tsx\nimport Check from 'lucide-react/dist/esm/icons/check'\nimport X from 'lucide-react/dist/esm/icons/x'\nimport Menu from 'lucide-react/dist/esm/icons/menu'\n// Loads only 3 modules (~2KB vs ~1MB)\n\nimport Button from '@mui/material/Button'\nimport TextField from '@mui/material/TextField'\n// Loads only what you use\n```\n\n**Alternative (Next.js 13.5+):**\n\n```js\n// next.config.js - use optimizePackageImports\nmodule.exports = {\n  experimental: {\n    optimizePackageImports: ['lucide-react', '@mui/material']\n  }\n}\n\n// Then you can keep the ergonomic barrel imports:\nimport { Check, X, Menu } from 'lucide-react'\n// Automatically transformed to direct imports at build time\n```\n\nDirect imports provide 15-70% faster dev boot, 28% faster builds, 40% faster cold starts, and significantly faster HMR.\n\nLibraries commonly affected: `lucide-react`, `@mui/material`, `@mui/icons-material`, `@tabler/icons-react`, `react-icons`, `@headlessui/react`, `@radix-ui/react-*`, `lodash`, `ramda`, `date-fns`, `rxjs`, `react-use`.\n\nReference: [How we optimized package imports in Next.js](https://vercel.com/blog/how-we-optimized-package-imports-in-next-js)\n",
        "refactor/skills/best-practices/references/nextjs/bundle-conditional.md": "---\ntitle: Conditional Module Loading\nimpact: HIGH\nimpactDescription: loads large data only when needed\ntags: bundle, conditional-loading, lazy-loading\n---\n\n## Conditional Module Loading\n\nLoad large data or modules only when a feature is activated.\n\n**Example (lazy-load animation frames):**\n\n```tsx\nfunction AnimationPlayer({ enabled, setEnabled }: { enabled: boolean; setEnabled: React.Dispatch<React.SetStateAction<boolean>> }) {\n  const [frames, setFrames] = useState<Frame[] | null>(null)\n\n  useEffect(() => {\n    if (enabled && !frames && typeof window !== 'undefined') {\n      import('./animation-frames.js')\n        .then(mod => setFrames(mod.frames))\n        .catch(() => setEnabled(false))\n    }\n  }, [enabled, frames, setEnabled])\n\n  if (!frames) return <Skeleton />\n  return <Canvas frames={frames} />\n}\n```\n\nThe `typeof window !== 'undefined'` check prevents bundling this module for SSR, optimizing server bundle size and build speed.\n",
        "refactor/skills/best-practices/references/nextjs/bundle-defer-third-party.md": "---\ntitle: Defer Non-Critical Third-Party Libraries\nimpact: MEDIUM\nimpactDescription: loads after hydration\ntags: bundle, third-party, analytics, defer\n---\n\n## Defer Non-Critical Third-Party Libraries\n\nAnalytics, logging, and error tracking don't block user interaction. Load them after hydration.\n\n**Incorrect (blocks initial bundle):**\n\n```tsx\nimport { Analytics } from '@vercel/analytics/react'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html>\n      <body>\n        {children}\n        <Analytics />\n      </body>\n    </html>\n  )\n}\n```\n\n**Correct (loads after hydration):**\n\n```tsx\nimport dynamic from 'next/dynamic'\n\nconst Analytics = dynamic(\n  () => import('@vercel/analytics/react').then(m => m.Analytics),\n  { ssr: false }\n)\n\nexport default function RootLayout({ children }) {\n  return (\n    <html>\n      <body>\n        {children}\n        <Analytics />\n      </body>\n    </html>\n  )\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/bundle-dynamic-imports.md": "---\ntitle: Dynamic Imports for Heavy Components\nimpact: CRITICAL\nimpactDescription: directly affects TTI and LCP\ntags: bundle, dynamic-import, code-splitting, next-dynamic\n---\n\n## Dynamic Imports for Heavy Components\n\nUse `next/dynamic` to lazy-load large components not needed on initial render.\n\n**Incorrect (Monaco bundles with main chunk ~300KB):**\n\n```tsx\nimport { MonacoEditor } from './monaco-editor'\n\nfunction CodePanel({ code }: { code: string }) {\n  return <MonacoEditor value={code} />\n}\n```\n\n**Correct (Monaco loads on demand):**\n\n```tsx\nimport dynamic from 'next/dynamic'\n\nconst MonacoEditor = dynamic(\n  () => import('./monaco-editor').then(m => m.MonacoEditor),\n  { ssr: false }\n)\n\nfunction CodePanel({ code }: { code: string }) {\n  return <MonacoEditor value={code} />\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/bundle-preload.md": "---\ntitle: Preload Based on User Intent\nimpact: MEDIUM\nimpactDescription: reduces perceived latency\ntags: bundle, preload, user-intent, hover\n---\n\n## Preload Based on User Intent\n\nPreload heavy bundles before they're needed to reduce perceived latency.\n\n**Example (preload on hover/focus):**\n\n```tsx\nfunction EditorButton({ onClick }: { onClick: () => void }) {\n  const preload = () => {\n    if (typeof window !== 'undefined') {\n      void import('./monaco-editor')\n    }\n  }\n\n  return (\n    <button\n      onMouseEnter={preload}\n      onFocus={preload}\n      onClick={onClick}\n    >\n      Open Editor\n    </button>\n  )\n}\n```\n\n**Example (preload when feature flag is enabled):**\n\n```tsx\nfunction FlagsProvider({ children, flags }: Props) {\n  useEffect(() => {\n    if (flags.editorEnabled && typeof window !== 'undefined') {\n      void import('./monaco-editor').then(mod => mod.init())\n    }\n  }, [flags.editorEnabled])\n\n  return <FlagsContext.Provider value={flags}>\n    {children}\n  </FlagsContext.Provider>\n}\n```\n\nThe `typeof window !== 'undefined'` check prevents bundling preloaded modules for SSR, optimizing server bundle size and build speed.\n",
        "refactor/skills/best-practices/references/nextjs/client-event-listeners.md": "---\ntitle: Deduplicate Global Event Listeners\nimpact: LOW\nimpactDescription: single listener for N components\ntags: client, swr, event-listeners, subscription\n---\n\n## Deduplicate Global Event Listeners\n\nUse `useSWRSubscription()` to share global event listeners across component instances.\n\n**Incorrect (N instances = N listeners):**\n\n```tsx\nfunction useKeyboardShortcut(key: string, callback: () => void) {\n  useEffect(() => {\n    const handler = (e: KeyboardEvent) => {\n      if (e.metaKey && e.key === key) {\n        callback()\n      }\n    }\n    window.addEventListener('keydown', handler)\n    return () => window.removeEventListener('keydown', handler)\n  }, [key, callback])\n}\n```\n\nWhen using the `useKeyboardShortcut` hook multiple times, each instance will register a new listener.\n\n**Correct (N instances = 1 listener):**\n\n```tsx\nimport useSWRSubscription from 'swr/subscription'\n\n// Module-level Map to track callbacks per key\nconst keyCallbacks = new Map<string, Set<() => void>>()\n\nfunction useKeyboardShortcut(key: string, callback: () => void) {\n  // Register this callback in the Map\n  useEffect(() => {\n    if (!keyCallbacks.has(key)) {\n      keyCallbacks.set(key, new Set())\n    }\n    keyCallbacks.get(key)!.add(callback)\n\n    return () => {\n      const set = keyCallbacks.get(key)\n      if (set) {\n        set.delete(callback)\n        if (set.size === 0) {\n          keyCallbacks.delete(key)\n        }\n      }\n    }\n  }, [key, callback])\n\n  useSWRSubscription('global-keydown', () => {\n    const handler = (e: KeyboardEvent) => {\n      if (e.metaKey && keyCallbacks.has(e.key)) {\n        keyCallbacks.get(e.key)!.forEach(cb => cb())\n      }\n    }\n    window.addEventListener('keydown', handler)\n    return () => window.removeEventListener('keydown', handler)\n  })\n}\n\nfunction Profile() {\n  // Multiple shortcuts will share the same listener\n  useKeyboardShortcut('p', () => { /* ... */ }) \n  useKeyboardShortcut('k', () => { /* ... */ })\n  // ...\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/client-localstorage-schema.md": "---\ntitle: Version and Minimize localStorage Data\nimpact: MEDIUM\nimpactDescription: prevents schema conflicts, reduces storage size\ntags: client, localStorage, storage, versioning, data-minimization\n---\n\n## Version and Minimize localStorage Data\n\nAdd version prefix to keys and store only needed fields. Prevents schema conflicts and accidental storage of sensitive data.\n\n**Incorrect:**\n\n```typescript\n// No version, stores everything, no error handling\nlocalStorage.setItem('userConfig', JSON.stringify(fullUserObject))\nconst data = localStorage.getItem('userConfig')\n```\n\n**Correct:**\n\n```typescript\nconst VERSION = 'v2'\n\nfunction saveConfig(config: { theme: string; language: string }) {\n  try {\n    localStorage.setItem(`userConfig:${VERSION}`, JSON.stringify(config))\n  } catch {\n    // Throws in incognito/private browsing, quota exceeded, or disabled\n  }\n}\n\nfunction loadConfig() {\n  try {\n    const data = localStorage.getItem(`userConfig:${VERSION}`)\n    return data ? JSON.parse(data) : null\n  } catch {\n    return null\n  }\n}\n\n// Migration from v1 to v2\nfunction migrate() {\n  try {\n    const v1 = localStorage.getItem('userConfig:v1')\n    if (v1) {\n      const old = JSON.parse(v1)\n      saveConfig({ theme: old.darkMode ? 'dark' : 'light', language: old.lang })\n      localStorage.removeItem('userConfig:v1')\n    }\n  } catch {}\n}\n```\n\n**Store minimal fields from server responses:**\n\n```typescript\n// User object has 20+ fields, only store what UI needs\nfunction cachePrefs(user: FullUser) {\n  try {\n    localStorage.setItem('prefs:v1', JSON.stringify({\n      theme: user.preferences.theme,\n      notifications: user.preferences.notifications\n    }))\n  } catch {}\n}\n```\n\n**Always wrap in try-catch:** `getItem()` and `setItem()` throw in incognito/private browsing (Safari, Firefox), when quota exceeded, or when disabled.\n\n**Benefits:** Schema evolution via versioning, reduced storage size, prevents storing tokens/PII/internal flags.\n",
        "refactor/skills/best-practices/references/nextjs/client-passive-event-listeners.md": "---\ntitle: Use Passive Event Listeners for Scrolling Performance\nimpact: MEDIUM\nimpactDescription: eliminates scroll delay caused by event listeners\ntags: client, event-listeners, scrolling, performance, touch, wheel\n---\n\n## Use Passive Event Listeners for Scrolling Performance\n\nAdd `{ passive: true }` to touch and wheel event listeners to enable immediate scrolling. Browsers normally wait for listeners to finish to check if `preventDefault()` is called, causing scroll delay.\n\n**Incorrect:**\n\n```typescript\nuseEffect(() => {\n  const handleTouch = (e: TouchEvent) => console.log(e.touches[0].clientX)\n  const handleWheel = (e: WheelEvent) => console.log(e.deltaY)\n  \n  document.addEventListener('touchstart', handleTouch)\n  document.addEventListener('wheel', handleWheel)\n  \n  return () => {\n    document.removeEventListener('touchstart', handleTouch)\n    document.removeEventListener('wheel', handleWheel)\n  }\n}, [])\n```\n\n**Correct:**\n\n```typescript\nuseEffect(() => {\n  const handleTouch = (e: TouchEvent) => console.log(e.touches[0].clientX)\n  const handleWheel = (e: WheelEvent) => console.log(e.deltaY)\n  \n  document.addEventListener('touchstart', handleTouch, { passive: true })\n  document.addEventListener('wheel', handleWheel, { passive: true })\n  \n  return () => {\n    document.removeEventListener('touchstart', handleTouch)\n    document.removeEventListener('wheel', handleWheel)\n  }\n}, [])\n```\n\n**Use passive when:** tracking/analytics, logging, any listener that doesn't call `preventDefault()`.\n\n**Don't use passive when:** implementing custom swipe gestures, custom zoom controls, or any listener that needs `preventDefault()`.\n",
        "refactor/skills/best-practices/references/nextjs/client-swr-dedup.md": "---\ntitle: Use SWR for Automatic Deduplication\nimpact: MEDIUM-HIGH\nimpactDescription: automatic deduplication\ntags: client, swr, deduplication, data-fetching\n---\n\n## Use SWR for Automatic Deduplication\n\nSWR enables request deduplication, caching, and revalidation across component instances.\n\n**Incorrect (no deduplication, each instance fetches):**\n\n```tsx\nfunction UserList() {\n  const [users, setUsers] = useState([])\n  useEffect(() => {\n    fetch('/api/users')\n      .then(r => r.json())\n      .then(setUsers)\n  }, [])\n}\n```\n\n**Correct (multiple instances share one request):**\n\n```tsx\nimport useSWR from 'swr'\n\nfunction UserList() {\n  const { data: users } = useSWR('/api/users', fetcher)\n}\n```\n\n**For immutable data:**\n\n```tsx\nimport { useImmutableSWR } from '@/lib/swr'\n\nfunction StaticContent() {\n  const { data } = useImmutableSWR('/api/config', fetcher)\n}\n```\n\n**For mutations:**\n\n```tsx\nimport { useSWRMutation } from 'swr/mutation'\n\nfunction UpdateButton() {\n  const { trigger } = useSWRMutation('/api/user', updateUser)\n  return <button onClick={() => trigger()}>Update</button>\n}\n```\n\nReference: [https://swr.vercel.app](https://swr.vercel.app)\n",
        "refactor/skills/best-practices/references/nextjs/js-batch-dom-css.md": "---\ntitle: Batch DOM CSS Changes\nimpact: MEDIUM\nimpactDescription: reduces reflows/repaints\ntags: javascript, dom, css, performance, reflow\n---\n\n## Batch DOM CSS Changes\n\nAvoid interleaving style writes with layout reads. When you read a layout property (like `offsetWidth`, `getBoundingClientRect()`, or `getComputedStyle()`) between style changes, the browser is forced to trigger a synchronous reflow.\n\n**Incorrect (interleaved reads and writes force reflows):**\n\n```typescript\nfunction updateElementStyles(element: HTMLElement) {\n  element.style.width = '100px'\n  const width = element.offsetWidth  // Forces reflow\n  element.style.height = '200px'\n  const height = element.offsetHeight  // Forces another reflow\n}\n```\n\n**Correct (batch writes, then read once):**\n\n```typescript\nfunction updateElementStyles(element: HTMLElement) {\n  // Batch all writes together\n  element.style.width = '100px'\n  element.style.height = '200px'\n  element.style.backgroundColor = 'blue'\n  element.style.border = '1px solid black'\n  \n  // Read after all writes are done (single reflow)\n  const { width, height } = element.getBoundingClientRect()\n}\n```\n\n**Better: use CSS classes**\n\n```css\n.highlighted-box {\n  width: 100px;\n  height: 200px;\n  background-color: blue;\n  border: 1px solid black;\n}\n```\n\n```typescript\nfunction updateElementStyles(element: HTMLElement) {\n  element.classList.add('highlighted-box')\n\n  const { width, height } = element.getBoundingClientRect()\n}\n```\n\nPrefer CSS classes over inline styles when possible. CSS files are cached by the browser, and classes provide better separation of concerns and are easier to maintain.",
        "refactor/skills/best-practices/references/nextjs/js-cache-function-results.md": "---\ntitle: Cache Repeated Function Calls\nimpact: MEDIUM\nimpactDescription: avoid redundant computation\ntags: javascript, cache, memoization, performance\n---\n\n## Cache Repeated Function Calls\n\nUse a module-level Map to cache function results when the same function is called repeatedly with the same inputs during render.\n\n**Incorrect (redundant computation):**\n\n```typescript\nfunction ProjectList({ projects }: { projects: Project[] }) {\n  return (\n    <div>\n      {projects.map(project => {\n        // slugify() called 100+ times for same project names\n        const slug = slugify(project.name)\n        \n        return <ProjectCard key={project.id} slug={slug} />\n      })}\n    </div>\n  )\n}\n```\n\n**Correct (cached results):**\n\n```typescript\n// Module-level cache\nconst slugifyCache = new Map<string, string>()\n\nfunction cachedSlugify(text: string): string {\n  if (slugifyCache.has(text)) {\n    return slugifyCache.get(text)!\n  }\n  const result = slugify(text)\n  slugifyCache.set(text, result)\n  return result\n}\n\nfunction ProjectList({ projects }: { projects: Project[] }) {\n  return (\n    <div>\n      {projects.map(project => {\n        // Computed only once per unique project name\n        const slug = cachedSlugify(project.name)\n        \n        return <ProjectCard key={project.id} slug={slug} />\n      })}\n    </div>\n  )\n}\n```\n\n**Simpler pattern for single-value functions:**\n\n```typescript\nlet isLoggedInCache: boolean | null = null\n\nfunction isLoggedIn(): boolean {\n  if (isLoggedInCache !== null) {\n    return isLoggedInCache\n  }\n  \n  isLoggedInCache = document.cookie.includes('auth=')\n  return isLoggedInCache\n}\n\n// Clear cache when auth changes\nfunction onAuthChange() {\n  isLoggedInCache = null\n}\n```\n\nUse a Map (not a hook) so it works everywhere: utilities, event handlers, not just React components.\n\nReference: [How we made the Vercel Dashboard twice as fast](https://vercel.com/blog/how-we-made-the-vercel-dashboard-twice-as-fast)\n",
        "refactor/skills/best-practices/references/nextjs/js-cache-property-access.md": "---\ntitle: Cache Property Access in Loops\nimpact: LOW-MEDIUM\nimpactDescription: reduces lookups\ntags: javascript, loops, optimization, caching\n---\n\n## Cache Property Access in Loops\n\nCache object property lookups in hot paths.\n\n**Incorrect (3 lookups × N iterations):**\n\n```typescript\nfor (let i = 0; i < arr.length; i++) {\n  process(obj.config.settings.value)\n}\n```\n\n**Correct (1 lookup total):**\n\n```typescript\nconst value = obj.config.settings.value\nconst len = arr.length\nfor (let i = 0; i < len; i++) {\n  process(value)\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/js-cache-storage.md": "---\ntitle: Cache Storage API Calls\nimpact: LOW-MEDIUM\nimpactDescription: reduces expensive I/O\ntags: javascript, localStorage, storage, caching, performance\n---\n\n## Cache Storage API Calls\n\n`localStorage`, `sessionStorage`, and `document.cookie` are synchronous and expensive. Cache reads in memory.\n\n**Incorrect (reads storage on every call):**\n\n```typescript\nfunction getTheme() {\n  return localStorage.getItem('theme') ?? 'light'\n}\n// Called 10 times = 10 storage reads\n```\n\n**Correct (Map cache):**\n\n```typescript\nconst storageCache = new Map<string, string | null>()\n\nfunction getLocalStorage(key: string) {\n  if (!storageCache.has(key)) {\n    storageCache.set(key, localStorage.getItem(key))\n  }\n  return storageCache.get(key)\n}\n\nfunction setLocalStorage(key: string, value: string) {\n  localStorage.setItem(key, value)\n  storageCache.set(key, value)  // keep cache in sync\n}\n```\n\nUse a Map (not a hook) so it works everywhere: utilities, event handlers, not just React components.\n\n**Cookie caching:**\n\n```typescript\nlet cookieCache: Record<string, string> | null = null\n\nfunction getCookie(name: string) {\n  if (!cookieCache) {\n    cookieCache = Object.fromEntries(\n      document.cookie.split('; ').map(c => c.split('='))\n    )\n  }\n  return cookieCache[name]\n}\n```\n\n**Important (invalidate on external changes):**\n\nIf storage can change externally (another tab, server-set cookies), invalidate cache:\n\n```typescript\nwindow.addEventListener('storage', (e) => {\n  if (e.key) storageCache.delete(e.key)\n})\n\ndocument.addEventListener('visibilitychange', () => {\n  if (document.visibilityState === 'visible') {\n    storageCache.clear()\n  }\n})\n```\n",
        "refactor/skills/best-practices/references/nextjs/js-combine-iterations.md": "---\ntitle: Combine Multiple Array Iterations\nimpact: LOW-MEDIUM\nimpactDescription: reduces iterations\ntags: javascript, arrays, loops, performance\n---\n\n## Combine Multiple Array Iterations\n\nMultiple `.filter()` or `.map()` calls iterate the array multiple times. Combine into one loop.\n\n**Incorrect (3 iterations):**\n\n```typescript\nconst admins = users.filter(u => u.isAdmin)\nconst testers = users.filter(u => u.isTester)\nconst inactive = users.filter(u => !u.isActive)\n```\n\n**Correct (1 iteration):**\n\n```typescript\nconst admins: User[] = []\nconst testers: User[] = []\nconst inactive: User[] = []\n\nfor (const user of users) {\n  if (user.isAdmin) admins.push(user)\n  if (user.isTester) testers.push(user)\n  if (!user.isActive) inactive.push(user)\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/js-early-exit.md": "---\ntitle: Early Return from Functions\nimpact: LOW-MEDIUM\nimpactDescription: avoids unnecessary computation\ntags: javascript, functions, optimization, early-return\n---\n\n## Early Return from Functions\n\nReturn early when result is determined to skip unnecessary processing.\n\n**Incorrect (processes all items even after finding answer):**\n\n```typescript\nfunction validateUsers(users: User[]) {\n  let hasError = false\n  let errorMessage = ''\n  \n  for (const user of users) {\n    if (!user.email) {\n      hasError = true\n      errorMessage = 'Email required'\n    }\n    if (!user.name) {\n      hasError = true\n      errorMessage = 'Name required'\n    }\n    // Continues checking all users even after error found\n  }\n  \n  return hasError ? { valid: false, error: errorMessage } : { valid: true }\n}\n```\n\n**Correct (returns immediately on first error):**\n\n```typescript\nfunction validateUsers(users: User[]) {\n  for (const user of users) {\n    if (!user.email) {\n      return { valid: false, error: 'Email required' }\n    }\n    if (!user.name) {\n      return { valid: false, error: 'Name required' }\n    }\n  }\n\n  return { valid: true }\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/js-hoist-regexp.md": "---\ntitle: Hoist RegExp Creation\nimpact: LOW-MEDIUM\nimpactDescription: avoids recreation\ntags: javascript, regexp, optimization, memoization\n---\n\n## Hoist RegExp Creation\n\nDon't create RegExp inside render. Hoist to module scope or memoize with `useMemo()`.\n\n**Incorrect (new RegExp every render):**\n\n```tsx\nfunction Highlighter({ text, query }: Props) {\n  const regex = new RegExp(`(${query})`, 'gi')\n  const parts = text.split(regex)\n  return <>{parts.map((part, i) => ...)}</>\n}\n```\n\n**Correct (memoize or hoist):**\n\n```tsx\nconst EMAIL_REGEX = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n\nfunction Highlighter({ text, query }: Props) {\n  const regex = useMemo(\n    () => new RegExp(`(${escapeRegex(query)})`, 'gi'),\n    [query]\n  )\n  const parts = text.split(regex)\n  return <>{parts.map((part, i) => ...)}</>\n}\n```\n\n**Warning (global regex has mutable state):**\n\nGlobal regex (`/g`) has mutable `lastIndex` state:\n\n```typescript\nconst regex = /foo/g\nregex.test('foo')  // true, lastIndex = 3\nregex.test('foo')  // false, lastIndex = 0\n```\n",
        "refactor/skills/best-practices/references/nextjs/js-index-maps.md": "---\ntitle: Build Index Maps for Repeated Lookups\nimpact: LOW-MEDIUM\nimpactDescription: 1M ops to 2K ops\ntags: javascript, map, indexing, optimization, performance\n---\n\n## Build Index Maps for Repeated Lookups\n\nMultiple `.find()` calls by the same key should use a Map.\n\n**Incorrect (O(n) per lookup):**\n\n```typescript\nfunction processOrders(orders: Order[], users: User[]) {\n  return orders.map(order => ({\n    ...order,\n    user: users.find(u => u.id === order.userId)\n  }))\n}\n```\n\n**Correct (O(1) per lookup):**\n\n```typescript\nfunction processOrders(orders: Order[], users: User[]) {\n  const userById = new Map(users.map(u => [u.id, u]))\n\n  return orders.map(order => ({\n    ...order,\n    user: userById.get(order.userId)\n  }))\n}\n```\n\nBuild map once (O(n)), then all lookups are O(1).\nFor 1000 orders × 1000 users: 1M ops → 2K ops.\n",
        "refactor/skills/best-practices/references/nextjs/js-length-check-first.md": "---\ntitle: Early Length Check for Array Comparisons\nimpact: MEDIUM-HIGH\nimpactDescription: avoids expensive operations when lengths differ\ntags: javascript, arrays, performance, optimization, comparison\n---\n\n## Early Length Check for Array Comparisons\n\nWhen comparing arrays with expensive operations (sorting, deep equality, serialization), check lengths first. If lengths differ, the arrays cannot be equal.\n\nIn real-world applications, this optimization is especially valuable when the comparison runs in hot paths (event handlers, render loops).\n\n**Incorrect (always runs expensive comparison):**\n\n```typescript\nfunction hasChanges(current: string[], original: string[]) {\n  // Always sorts and joins, even when lengths differ\n  return current.sort().join() !== original.sort().join()\n}\n```\n\nTwo O(n log n) sorts run even when `current.length` is 5 and `original.length` is 100. There is also overhead of joining the arrays and comparing the strings.\n\n**Correct (O(1) length check first):**\n\n```typescript\nfunction hasChanges(current: string[], original: string[]) {\n  // Early return if lengths differ\n  if (current.length !== original.length) {\n    return true\n  }\n  // Only sort when lengths match\n  const currentSorted = current.toSorted()\n  const originalSorted = original.toSorted()\n  for (let i = 0; i < currentSorted.length; i++) {\n    if (currentSorted[i] !== originalSorted[i]) {\n      return true\n    }\n  }\n  return false\n}\n```\n\nThis new approach is more efficient because:\n- It avoids the overhead of sorting and joining the arrays when lengths differ\n- It avoids consuming memory for the joined strings (especially important for large arrays)\n- It avoids mutating the original arrays\n- It returns early when a difference is found\n",
        "refactor/skills/best-practices/references/nextjs/js-min-max-loop.md": "---\ntitle: Use Loop for Min/Max Instead of Sort\nimpact: LOW\nimpactDescription: O(n) instead of O(n log n)\ntags: javascript, arrays, performance, sorting, algorithms\n---\n\n## Use Loop for Min/Max Instead of Sort\n\nFinding the smallest or largest element only requires a single pass through the array. Sorting is wasteful and slower.\n\n**Incorrect (O(n log n) - sort to find latest):**\n\n```typescript\ninterface Project {\n  id: string\n  name: string\n  updatedAt: number\n}\n\nfunction getLatestProject(projects: Project[]) {\n  const sorted = [...projects].sort((a, b) => b.updatedAt - a.updatedAt)\n  return sorted[0]\n}\n```\n\nSorts the entire array just to find the maximum value.\n\n**Incorrect (O(n log n) - sort for oldest and newest):**\n\n```typescript\nfunction getOldestAndNewest(projects: Project[]) {\n  const sorted = [...projects].sort((a, b) => a.updatedAt - b.updatedAt)\n  return { oldest: sorted[0], newest: sorted[sorted.length - 1] }\n}\n```\n\nStill sorts unnecessarily when only min/max are needed.\n\n**Correct (O(n) - single loop):**\n\n```typescript\nfunction getLatestProject(projects: Project[]) {\n  if (projects.length === 0) return null\n  \n  let latest = projects[0]\n  \n  for (let i = 1; i < projects.length; i++) {\n    if (projects[i].updatedAt > latest.updatedAt) {\n      latest = projects[i]\n    }\n  }\n  \n  return latest\n}\n\nfunction getOldestAndNewest(projects: Project[]) {\n  if (projects.length === 0) return { oldest: null, newest: null }\n  \n  let oldest = projects[0]\n  let newest = projects[0]\n  \n  for (let i = 1; i < projects.length; i++) {\n    if (projects[i].updatedAt < oldest.updatedAt) oldest = projects[i]\n    if (projects[i].updatedAt > newest.updatedAt) newest = projects[i]\n  }\n  \n  return { oldest, newest }\n}\n```\n\nSingle pass through the array, no copying, no sorting.\n\n**Alternative (Math.min/Math.max for small arrays):**\n\n```typescript\nconst numbers = [5, 2, 8, 1, 9]\nconst min = Math.min(...numbers)\nconst max = Math.max(...numbers)\n```\n\nThis works for small arrays, but can be slower or just throw an error for very large arrays due to spread operator limitations. Maximal array length is approximately 124000 in Chrome 143 and 638000 in Safari 18; exact numbers may vary - see [the fiddle](https://jsfiddle.net/qw1jabsx/4/). Use the loop approach for reliability.\n",
        "refactor/skills/best-practices/references/nextjs/js-set-map-lookups.md": "---\ntitle: Use Set/Map for O(1) Lookups\nimpact: LOW-MEDIUM\nimpactDescription: O(n) to O(1)\ntags: javascript, set, map, data-structures, performance\n---\n\n## Use Set/Map for O(1) Lookups\n\nConvert arrays to Set/Map for repeated membership checks.\n\n**Incorrect (O(n) per check):**\n\n```typescript\nconst allowedIds = ['a', 'b', 'c', ...]\nitems.filter(item => allowedIds.includes(item.id))\n```\n\n**Correct (O(1) per check):**\n\n```typescript\nconst allowedIds = new Set(['a', 'b', 'c', ...])\nitems.filter(item => allowedIds.has(item.id))\n```\n",
        "refactor/skills/best-practices/references/nextjs/js-tosorted-immutable.md": "---\ntitle: Use toSorted() Instead of sort() for Immutability\nimpact: MEDIUM-HIGH\nimpactDescription: prevents mutation bugs in React state\ntags: javascript, arrays, immutability, react, state, mutation\n---\n\n## Use toSorted() Instead of sort() for Immutability\n\n`.sort()` mutates the array in place, which can cause bugs with React state and props. Use `.toSorted()` to create a new sorted array without mutation.\n\n**Incorrect (mutates original array):**\n\n```typescript\nfunction UserList({ users }: { users: User[] }) {\n  // Mutates the users prop array!\n  const sorted = useMemo(\n    () => users.sort((a, b) => a.name.localeCompare(b.name)),\n    [users]\n  )\n  return <div>{sorted.map(renderUser)}</div>\n}\n```\n\n**Correct (creates new array):**\n\n```typescript\nfunction UserList({ users }: { users: User[] }) {\n  // Creates new sorted array, original unchanged\n  const sorted = useMemo(\n    () => users.toSorted((a, b) => a.name.localeCompare(b.name)),\n    [users]\n  )\n  return <div>{sorted.map(renderUser)}</div>\n}\n```\n\n**Why this matters in React:**\n\n1. Props/state mutations break React's immutability model - React expects props and state to be treated as read-only\n2. Causes stale closure bugs - Mutating arrays inside closures (callbacks, effects) can lead to unexpected behavior\n\n**Browser support (fallback for older browsers):**\n\n`.toSorted()` is available in all modern browsers (Chrome 110+, Safari 16+, Firefox 115+, Node.js 20+). For older environments, use spread operator:\n\n```typescript\n// Fallback for older browsers\nconst sorted = [...items].sort((a, b) => a.value - b.value)\n```\n\n**Other immutable array methods:**\n\n- `.toSorted()` - immutable sort\n- `.toReversed()` - immutable reverse\n- `.toSpliced()` - immutable splice\n- `.with()` - immutable element replacement\n",
        "refactor/skills/best-practices/references/nextjs/rendering-activity.md": "---\ntitle: Use Activity Component for Show/Hide\nimpact: MEDIUM\nimpactDescription: preserves state/DOM\ntags: rendering, activity, visibility, state-preservation\n---\n\n## Use Activity Component for Show/Hide\n\nUse React's `<Activity>` to preserve state/DOM for expensive components that frequently toggle visibility.\n\n**Usage:**\n\n```tsx\nimport { Activity } from 'react'\n\nfunction Dropdown({ isOpen }: Props) {\n  return (\n    <Activity mode={isOpen ? 'visible' : 'hidden'}>\n      <ExpensiveMenu />\n    </Activity>\n  )\n}\n```\n\nAvoids expensive re-renders and state loss.\n",
        "refactor/skills/best-practices/references/nextjs/rendering-animate-svg-wrapper.md": "---\ntitle: Animate SVG Wrapper Instead of SVG Element\nimpact: LOW\nimpactDescription: enables hardware acceleration\ntags: rendering, svg, css, animation, performance\n---\n\n## Animate SVG Wrapper Instead of SVG Element\n\nMany browsers don't have hardware acceleration for CSS3 animations on SVG elements. Wrap SVG in a `<div>` and animate the wrapper instead.\n\n**Incorrect (animating SVG directly - no hardware acceleration):**\n\n```tsx\nfunction LoadingSpinner() {\n  return (\n    <svg \n      className=\"animate-spin\"\n      width=\"24\" \n      height=\"24\" \n      viewBox=\"0 0 24 24\"\n    >\n      <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" />\n    </svg>\n  )\n}\n```\n\n**Correct (animating wrapper div - hardware accelerated):**\n\n```tsx\nfunction LoadingSpinner() {\n  return (\n    <div className=\"animate-spin\">\n      <svg \n        width=\"24\" \n        height=\"24\" \n        viewBox=\"0 0 24 24\"\n      >\n        <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" />\n      </svg>\n    </div>\n  )\n}\n```\n\nThis applies to all CSS transforms and transitions (`transform`, `opacity`, `translate`, `scale`, `rotate`). The wrapper div allows browsers to use GPU acceleration for smoother animations.\n",
        "refactor/skills/best-practices/references/nextjs/rendering-conditional-render.md": "---\ntitle: Use Explicit Conditional Rendering\nimpact: LOW\nimpactDescription: prevents rendering 0 or NaN\ntags: rendering, conditional, jsx, falsy-values\n---\n\n## Use Explicit Conditional Rendering\n\nUse explicit ternary operators (`? :`) instead of `&&` for conditional rendering when the condition can be `0`, `NaN`, or other falsy values that render.\n\n**Incorrect (renders \"0\" when count is 0):**\n\n```tsx\nfunction Badge({ count }: { count: number }) {\n  return (\n    <div>\n      {count && <span className=\"badge\">{count}</span>}\n    </div>\n  )\n}\n\n// When count = 0, renders: <div>0</div>\n// When count = 5, renders: <div><span class=\"badge\">5</span></div>\n```\n\n**Correct (renders nothing when count is 0):**\n\n```tsx\nfunction Badge({ count }: { count: number }) {\n  return (\n    <div>\n      {count > 0 ? <span className=\"badge\">{count}</span> : null}\n    </div>\n  )\n}\n\n// When count = 0, renders: <div></div>\n// When count = 5, renders: <div><span class=\"badge\">5</span></div>\n```\n",
        "refactor/skills/best-practices/references/nextjs/rendering-content-visibility.md": "---\ntitle: CSS content-visibility for Long Lists\nimpact: HIGH\nimpactDescription: faster initial render\ntags: rendering, css, content-visibility, long-lists\n---\n\n## CSS content-visibility for Long Lists\n\nApply `content-visibility: auto` to defer off-screen rendering.\n\n**CSS:**\n\n```css\n.message-item {\n  content-visibility: auto;\n  contain-intrinsic-size: 0 80px;\n}\n```\n\n**Example:**\n\n```tsx\nfunction MessageList({ messages }: { messages: Message[] }) {\n  return (\n    <div className=\"overflow-y-auto h-screen\">\n      {messages.map(msg => (\n        <div key={msg.id} className=\"message-item\">\n          <Avatar user={msg.author} />\n          <div>{msg.content}</div>\n        </div>\n      ))}\n    </div>\n  )\n}\n```\n\nFor 1000 messages, browser skips layout/paint for ~990 off-screen items (10× faster initial render).\n",
        "refactor/skills/best-practices/references/nextjs/rendering-hoist-jsx.md": "---\ntitle: Hoist Static JSX Elements\nimpact: LOW\nimpactDescription: avoids re-creation\ntags: rendering, jsx, static, optimization\n---\n\n## Hoist Static JSX Elements\n\nExtract static JSX outside components to avoid re-creation.\n\n**Incorrect (recreates element every render):**\n\n```tsx\nfunction LoadingSkeleton() {\n  return <div className=\"animate-pulse h-20 bg-gray-200\" />\n}\n\nfunction Container() {\n  return (\n    <div>\n      {loading && <LoadingSkeleton />}\n    </div>\n  )\n}\n```\n\n**Correct (reuses same element):**\n\n```tsx\nconst loadingSkeleton = (\n  <div className=\"animate-pulse h-20 bg-gray-200\" />\n)\n\nfunction Container() {\n  return (\n    <div>\n      {loading && loadingSkeleton}\n    </div>\n  )\n}\n```\n\nThis is especially helpful for large and static SVG nodes, which can be expensive to recreate on every render.\n\n**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, the compiler automatically hoists static JSX elements and optimizes component re-renders, making manual hoisting unnecessary.\n",
        "refactor/skills/best-practices/references/nextjs/rendering-hydration-no-flicker.md": "---\ntitle: Prevent Hydration Mismatch Without Flickering\nimpact: MEDIUM\nimpactDescription: avoids visual flicker and hydration errors\ntags: rendering, ssr, hydration, localStorage, flicker\n---\n\n## Prevent Hydration Mismatch Without Flickering\n\nWhen rendering content that depends on client-side storage (localStorage, cookies), avoid both SSR breakage and post-hydration flickering by injecting a synchronous script that updates the DOM before React hydrates.\n\n**Incorrect (breaks SSR):**\n\n```tsx\nfunction ThemeWrapper({ children }: { children: ReactNode }) {\n  // localStorage is not available on server - throws error\n  const theme = localStorage.getItem('theme') || 'light'\n  \n  return (\n    <div className={theme}>\n      {children}\n    </div>\n  )\n}\n```\n\nServer-side rendering will fail because `localStorage` is undefined.\n\n**Incorrect (visual flickering):**\n\n```tsx\nfunction ThemeWrapper({ children }: { children: ReactNode }) {\n  const [theme, setTheme] = useState('light')\n  \n  useEffect(() => {\n    // Runs after hydration - causes visible flash\n    const stored = localStorage.getItem('theme')\n    if (stored) {\n      setTheme(stored)\n    }\n  }, [])\n  \n  return (\n    <div className={theme}>\n      {children}\n    </div>\n  )\n}\n```\n\nComponent first renders with default value (`light`), then updates after hydration, causing a visible flash of incorrect content.\n\n**Correct (no flicker, no hydration mismatch):**\n\n```tsx\nfunction ThemeWrapper({ children }: { children: ReactNode }) {\n  return (\n    <>\n      <div id=\"theme-wrapper\">\n        {children}\n      </div>\n      <script\n        dangerouslySetInnerHTML={{\n          __html: `\n            (function() {\n              try {\n                var theme = localStorage.getItem('theme') || 'light';\n                var el = document.getElementById('theme-wrapper');\n                if (el) el.className = theme;\n              } catch (e) {}\n            })();\n          `,\n        }}\n      />\n    </>\n  )\n}\n```\n\nThe inline script executes synchronously before showing the element, ensuring the DOM already has the correct value. No flickering, no hydration mismatch.\n\nThis pattern is especially useful for theme toggles, user preferences, authentication states, and any client-only data that should render immediately without flashing default values.\n",
        "refactor/skills/best-practices/references/nextjs/rendering-svg-precision.md": "---\ntitle: Optimize SVG Precision\nimpact: LOW\nimpactDescription: reduces file size\ntags: rendering, svg, optimization, svgo\n---\n\n## Optimize SVG Precision\n\nReduce SVG coordinate precision to decrease file size. The optimal precision depends on the viewBox size, but in general reducing precision should be considered.\n\n**Incorrect (excessive precision):**\n\n```svg\n<path d=\"M 10.293847 20.847362 L 30.938472 40.192837\" />\n```\n\n**Correct (1 decimal place):**\n\n```svg\n<path d=\"M 10.3 20.8 L 30.9 40.2\" />\n```\n\n**Automate with SVGO:**\n\n```bash\nnpx svgo --precision=1 --multipass icon.svg\n```\n",
        "refactor/skills/best-practices/references/nextjs/rerender-defer-reads.md": "---\ntitle: Defer State Reads to Usage Point\nimpact: MEDIUM\nimpactDescription: avoids unnecessary subscriptions\ntags: rerender, searchParams, localStorage, optimization\n---\n\n## Defer State Reads to Usage Point\n\nDon't subscribe to dynamic state (searchParams, localStorage) if you only read it inside callbacks.\n\n**Incorrect (subscribes to all searchParams changes):**\n\n```tsx\nfunction ShareButton({ chatId }: { chatId: string }) {\n  const searchParams = useSearchParams()\n\n  const handleShare = () => {\n    const ref = searchParams.get('ref')\n    shareChat(chatId, { ref })\n  }\n\n  return <button onClick={handleShare}>Share</button>\n}\n```\n\n**Correct (reads on demand, no subscription):**\n\n```tsx\nfunction ShareButton({ chatId }: { chatId: string }) {\n  const handleShare = () => {\n    const params = new URLSearchParams(window.location.search)\n    const ref = params.get('ref')\n    shareChat(chatId, { ref })\n  }\n\n  return <button onClick={handleShare}>Share</button>\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/rerender-dependencies.md": "---\ntitle: Narrow Effect Dependencies\nimpact: LOW\nimpactDescription: minimizes effect re-runs\ntags: rerender, useEffect, dependencies, optimization\n---\n\n## Narrow Effect Dependencies\n\nSpecify primitive dependencies instead of objects to minimize effect re-runs.\n\n**Incorrect (re-runs on any user field change):**\n\n```tsx\nuseEffect(() => {\n  console.log(user.id)\n}, [user])\n```\n\n**Correct (re-runs only when id changes):**\n\n```tsx\nuseEffect(() => {\n  console.log(user.id)\n}, [user.id])\n```\n\n**For derived state, compute outside effect:**\n\n```tsx\n// Incorrect: runs on width=767, 766, 765...\nuseEffect(() => {\n  if (width < 768) {\n    enableMobileMode()\n  }\n}, [width])\n\n// Correct: runs only on boolean transition\nconst isMobile = width < 768\nuseEffect(() => {\n  if (isMobile) {\n    enableMobileMode()\n  }\n}, [isMobile])\n```\n",
        "refactor/skills/best-practices/references/nextjs/rerender-derived-state.md": "---\ntitle: Subscribe to Derived State\nimpact: MEDIUM\nimpactDescription: reduces re-render frequency\ntags: rerender, derived-state, media-query, optimization\n---\n\n## Subscribe to Derived State\n\nSubscribe to derived boolean state instead of continuous values to reduce re-render frequency.\n\n**Incorrect (re-renders on every pixel change):**\n\n```tsx\nfunction Sidebar() {\n  const width = useWindowWidth()  // updates continuously\n  const isMobile = width < 768\n  return <nav className={isMobile ? 'mobile' : 'desktop'} />\n}\n```\n\n**Correct (re-renders only when boolean changes):**\n\n```tsx\nfunction Sidebar() {\n  const isMobile = useMediaQuery('(max-width: 767px)')\n  return <nav className={isMobile ? 'mobile' : 'desktop'} />\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/rerender-functional-setstate.md": "---\ntitle: Use Functional setState Updates\nimpact: MEDIUM\nimpactDescription: prevents stale closures and unnecessary callback recreations\ntags: react, hooks, useState, useCallback, callbacks, closures\n---\n\n## Use Functional setState Updates\n\nWhen updating state based on the current state value, use the functional update form of setState instead of directly referencing the state variable. This prevents stale closures, eliminates unnecessary dependencies, and creates stable callback references.\n\n**Incorrect (requires state as dependency):**\n\n```tsx\nfunction TodoList() {\n  const [items, setItems] = useState(initialItems)\n  \n  // Callback must depend on items, recreated on every items change\n  const addItems = useCallback((newItems: Item[]) => {\n    setItems([...items, ...newItems])\n  }, [items])  // ❌ items dependency causes recreations\n  \n  // Risk of stale closure if dependency is forgotten\n  const removeItem = useCallback((id: string) => {\n    setItems(items.filter(item => item.id !== id))\n  }, [])  // ❌ Missing items dependency - will use stale items!\n  \n  return <ItemsEditor items={items} onAdd={addItems} onRemove={removeItem} />\n}\n```\n\nThe first callback is recreated every time `items` changes, which can cause child components to re-render unnecessarily. The second callback has a stale closure bug—it will always reference the initial `items` value.\n\n**Correct (stable callbacks, no stale closures):**\n\n```tsx\nfunction TodoList() {\n  const [items, setItems] = useState(initialItems)\n  \n  // Stable callback, never recreated\n  const addItems = useCallback((newItems: Item[]) => {\n    setItems(curr => [...curr, ...newItems])\n  }, [])  // ✅ No dependencies needed\n  \n  // Always uses latest state, no stale closure risk\n  const removeItem = useCallback((id: string) => {\n    setItems(curr => curr.filter(item => item.id !== id))\n  }, [])  // ✅ Safe and stable\n  \n  return <ItemsEditor items={items} onAdd={addItems} onRemove={removeItem} />\n}\n```\n\n**Benefits:**\n\n1. **Stable callback references** - Callbacks don't need to be recreated when state changes\n2. **No stale closures** - Always operates on the latest state value\n3. **Fewer dependencies** - Simplifies dependency arrays and reduces memory leaks\n4. **Prevents bugs** - Eliminates the most common source of React closure bugs\n\n**When to use functional updates:**\n\n- Any setState that depends on the current state value\n- Inside useCallback/useMemo when state is needed\n- Event handlers that reference state\n- Async operations that update state\n\n**When direct updates are fine:**\n\n- Setting state to a static value: `setCount(0)`\n- Setting state from props/arguments only: `setName(newName)`\n- State doesn't depend on previous value\n\n**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, the compiler can automatically optimize some cases, but functional updates are still recommended for correctness and to prevent stale closure bugs.\n",
        "refactor/skills/best-practices/references/nextjs/rerender-lazy-state-init.md": "---\ntitle: Use Lazy State Initialization\nimpact: MEDIUM\nimpactDescription: wasted computation on every render\ntags: react, hooks, useState, performance, initialization\n---\n\n## Use Lazy State Initialization\n\nPass a function to `useState` for expensive initial values. Without the function form, the initializer runs on every render even though the value is only used once.\n\n**Incorrect (runs on every render):**\n\n```tsx\nfunction FilteredList({ items }: { items: Item[] }) {\n  // buildSearchIndex() runs on EVERY render, even after initialization\n  const [searchIndex, setSearchIndex] = useState(buildSearchIndex(items))\n  const [query, setQuery] = useState('')\n  \n  // When query changes, buildSearchIndex runs again unnecessarily\n  return <SearchResults index={searchIndex} query={query} />\n}\n\nfunction UserProfile() {\n  // JSON.parse runs on every render\n  const [settings, setSettings] = useState(\n    JSON.parse(localStorage.getItem('settings') || '{}')\n  )\n  \n  return <SettingsForm settings={settings} onChange={setSettings} />\n}\n```\n\n**Correct (runs only once):**\n\n```tsx\nfunction FilteredList({ items }: { items: Item[] }) {\n  // buildSearchIndex() runs ONLY on initial render\n  const [searchIndex, setSearchIndex] = useState(() => buildSearchIndex(items))\n  const [query, setQuery] = useState('')\n  \n  return <SearchResults index={searchIndex} query={query} />\n}\n\nfunction UserProfile() {\n  // JSON.parse runs only on initial render\n  const [settings, setSettings] = useState(() => {\n    const stored = localStorage.getItem('settings')\n    return stored ? JSON.parse(stored) : {}\n  })\n  \n  return <SettingsForm settings={settings} onChange={setSettings} />\n}\n```\n\nUse lazy initialization when computing initial values from localStorage/sessionStorage, building data structures (indexes, maps), reading from the DOM, or performing heavy transformations.\n\nFor simple primitives (`useState(0)`), direct references (`useState(props.value)`), or cheap literals (`useState({})`), the function form is unnecessary.\n",
        "refactor/skills/best-practices/references/nextjs/rerender-memo.md": "---\ntitle: Extract to Memoized Components\nimpact: MEDIUM\nimpactDescription: enables early returns\ntags: rerender, memo, useMemo, optimization\n---\n\n## Extract to Memoized Components\n\nExtract expensive work into memoized components to enable early returns before computation.\n\n**Incorrect (computes avatar even when loading):**\n\n```tsx\nfunction Profile({ user, loading }: Props) {\n  const avatar = useMemo(() => {\n    const id = computeAvatarId(user)\n    return <Avatar id={id} />\n  }, [user])\n\n  if (loading) return <Skeleton />\n  return <div>{avatar}</div>\n}\n```\n\n**Correct (skips computation when loading):**\n\n```tsx\nconst UserAvatar = memo(function UserAvatar({ user }: { user: User }) {\n  const id = useMemo(() => computeAvatarId(user), [user])\n  return <Avatar id={id} />\n})\n\nfunction Profile({ user, loading }: Props) {\n  if (loading) return <Skeleton />\n  return (\n    <div>\n      <UserAvatar user={user} />\n    </div>\n  )\n}\n```\n\n**Note:** If your project has [React Compiler](https://react.dev/learn/react-compiler) enabled, manual memoization with `memo()` and `useMemo()` is not necessary. The compiler automatically optimizes re-renders.\n",
        "refactor/skills/best-practices/references/nextjs/rerender-transitions.md": "---\ntitle: Use Transitions for Non-Urgent Updates\nimpact: MEDIUM\nimpactDescription: maintains UI responsiveness\ntags: rerender, transitions, startTransition, performance\n---\n\n## Use Transitions for Non-Urgent Updates\n\nMark frequent, non-urgent state updates as transitions to maintain UI responsiveness.\n\n**Incorrect (blocks UI on every scroll):**\n\n```tsx\nfunction ScrollTracker() {\n  const [scrollY, setScrollY] = useState(0)\n  useEffect(() => {\n    const handler = () => setScrollY(window.scrollY)\n    window.addEventListener('scroll', handler, { passive: true })\n    return () => window.removeEventListener('scroll', handler)\n  }, [])\n}\n```\n\n**Correct (non-blocking updates):**\n\n```tsx\nimport { startTransition } from 'react'\n\nfunction ScrollTracker() {\n  const [scrollY, setScrollY] = useState(0)\n  useEffect(() => {\n    const handler = () => {\n      startTransition(() => setScrollY(window.scrollY))\n    }\n    window.addEventListener('scroll', handler, { passive: true })\n    return () => window.removeEventListener('scroll', handler)\n  }, [])\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/server-after-nonblocking.md": "---\ntitle: Use after() for Non-Blocking Operations\nimpact: MEDIUM\nimpactDescription: faster response times\ntags: server, async, logging, analytics, side-effects\n---\n\n## Use after() for Non-Blocking Operations\n\nUse Next.js's `after()` to schedule work that should execute after a response is sent. This prevents logging, analytics, and other side effects from blocking the response.\n\n**Incorrect (blocks response):**\n\n```tsx\nimport { logUserAction } from '@/app/utils'\n\nexport async function POST(request: Request) {\n  // Perform mutation\n  await updateDatabase(request)\n  \n  // Logging blocks the response\n  const userAgent = request.headers.get('user-agent') || 'unknown'\n  await logUserAction({ userAgent })\n  \n  return new Response(JSON.stringify({ status: 'success' }), {\n    status: 200,\n    headers: { 'Content-Type': 'application/json' }\n  })\n}\n```\n\n**Correct (non-blocking):**\n\n```tsx\nimport { after } from 'next/server'\nimport { headers, cookies } from 'next/headers'\nimport { logUserAction } from '@/app/utils'\n\nexport async function POST(request: Request) {\n  // Perform mutation\n  await updateDatabase(request)\n  \n  // Log after response is sent\n  after(async () => {\n    const userAgent = (await headers()).get('user-agent') || 'unknown'\n    const sessionCookie = (await cookies()).get('session-id')?.value || 'anonymous'\n    \n    logUserAction({ sessionCookie, userAgent })\n  })\n  \n  return new Response(JSON.stringify({ status: 'success' }), {\n    status: 200,\n    headers: { 'Content-Type': 'application/json' }\n  })\n}\n```\n\nThe response is sent immediately while logging happens in the background.\n\n**Common use cases:**\n\n- Analytics tracking\n- Audit logging\n- Sending notifications\n- Cache invalidation\n- Cleanup tasks\n\n**Important notes:**\n\n- `after()` runs even if the response fails or redirects\n- Works in Server Actions, Route Handlers, and Server Components\n\nReference: [https://nextjs.org/docs/app/api-reference/functions/after](https://nextjs.org/docs/app/api-reference/functions/after)\n",
        "refactor/skills/best-practices/references/nextjs/server-cache-lru.md": "---\ntitle: Cross-Request LRU Caching\nimpact: HIGH\nimpactDescription: caches across requests\ntags: server, cache, lru, cross-request\n---\n\n## Cross-Request LRU Caching\n\n`React.cache()` only works within one request. For data shared across sequential requests (user clicks button A then button B), use an LRU cache.\n\n**Implementation:**\n\n```typescript\nimport { LRUCache } from 'lru-cache'\n\nconst cache = new LRUCache<string, any>({\n  max: 1000,\n  ttl: 5 * 60 * 1000  // 5 minutes\n})\n\nexport async function getUser(id: string) {\n  const cached = cache.get(id)\n  if (cached) return cached\n\n  const user = await db.user.findUnique({ where: { id } })\n  cache.set(id, user)\n  return user\n}\n\n// Request 1: DB query, result cached\n// Request 2: cache hit, no DB query\n```\n\nUse when sequential user actions hit multiple endpoints needing the same data within seconds.\n\n**With Vercel's [Fluid Compute](https://vercel.com/docs/fluid-compute):** LRU caching is especially effective because multiple concurrent requests can share the same function instance and cache. This means the cache persists across requests without needing external storage like Redis.\n\n**In traditional serverless:** Each invocation runs in isolation, so consider Redis for cross-process caching.\n\nReference: [https://github.com/isaacs/node-lru-cache](https://github.com/isaacs/node-lru-cache)\n",
        "refactor/skills/best-practices/references/nextjs/server-cache-react.md": "---\ntitle: Per-Request Deduplication with React.cache()\nimpact: MEDIUM\nimpactDescription: deduplicates within request\ntags: server, cache, react-cache, deduplication\n---\n\n## Per-Request Deduplication with React.cache()\n\nUse `React.cache()` for server-side request deduplication. Authentication and database queries benefit most.\n\n**Usage:**\n\n```typescript\nimport { cache } from 'react'\n\nexport const getCurrentUser = cache(async () => {\n  const session = await auth()\n  if (!session?.user?.id) return null\n  return await db.user.findUnique({\n    where: { id: session.user.id }\n  })\n})\n```\n\nWithin a single request, multiple calls to `getCurrentUser()` execute the query only once.\n\n**Avoid inline objects as arguments:**\n\n`React.cache()` uses shallow equality (`Object.is`) to determine cache hits. Inline objects create new references each call, preventing cache hits.\n\n**Incorrect (always cache miss):**\n\n```typescript\nconst getUser = cache(async (params: { uid: number }) => {\n  return await db.user.findUnique({ where: { id: params.uid } })\n})\n\n// Each call creates new object, never hits cache\ngetUser({ uid: 1 })\ngetUser({ uid: 1 })  // Cache miss, runs query again\n```\n\n**Correct (cache hit):**\n\n```typescript\nconst getUser = cache(async (uid: number) => {\n  return await db.user.findUnique({ where: { id: uid } })\n})\n\n// Primitive args use value equality\ngetUser(1)\ngetUser(1)  // Cache hit, returns cached result\n```\n\nIf you must pass objects, pass the same reference:\n\n```typescript\nconst params = { uid: 1 }\ngetUser(params)  // Query runs\ngetUser(params)  // Cache hit (same reference)\n```\n\n**Next.js-Specific Note:**\n\nIn Next.js, the `fetch` API is automatically extended with request memoization. Requests with the same URL and options are automatically deduplicated within a single request, so you don't need `React.cache()` for `fetch` calls. However, `React.cache()` is still essential for other async tasks:\n\n- Database queries (Prisma, Drizzle, etc.)\n- Heavy computations\n- Authentication checks\n- File system operations\n- Any non-fetch async work\n\nUse `React.cache()` to deduplicate these operations across your component tree.\n\nReference: [React.cache documentation](https://react.dev/reference/react/cache)\n",
        "refactor/skills/best-practices/references/nextjs/server-parallel-fetching.md": "---\ntitle: Parallel Data Fetching with Component Composition\nimpact: CRITICAL\nimpactDescription: eliminates server-side waterfalls\ntags: server, rsc, parallel-fetching, composition\n---\n\n## Parallel Data Fetching with Component Composition\n\nReact Server Components execute sequentially within a tree. Restructure with composition to parallelize data fetching.\n\n**Incorrect (Sidebar waits for Page's fetch to complete):**\n\n```tsx\nexport default async function Page() {\n  const header = await fetchHeader()\n  return (\n    <div>\n      <div>{header}</div>\n      <Sidebar />\n    </div>\n  )\n}\n\nasync function Sidebar() {\n  const items = await fetchSidebarItems()\n  return <nav>{items.map(renderItem)}</nav>\n}\n```\n\n**Correct (both fetch simultaneously):**\n\n```tsx\nasync function Header() {\n  const data = await fetchHeader()\n  return <div>{data}</div>\n}\n\nasync function Sidebar() {\n  const items = await fetchSidebarItems()\n  return <nav>{items.map(renderItem)}</nav>\n}\n\nexport default function Page() {\n  return (\n    <div>\n      <Header />\n      <Sidebar />\n    </div>\n  )\n}\n```\n\n**Alternative with children prop:**\n\n```tsx\nasync function Header() {\n  const data = await fetchHeader()\n  return <div>{data}</div>\n}\n\nasync function Sidebar() {\n  const items = await fetchSidebarItems()\n  return <nav>{items.map(renderItem)}</nav>\n}\n\nfunction Layout({ children }: { children: ReactNode }) {\n  return (\n    <div>\n      <Header />\n      {children}\n    </div>\n  )\n}\n\nexport default function Page() {\n  return (\n    <Layout>\n      <Sidebar />\n    </Layout>\n  )\n}\n```\n",
        "refactor/skills/best-practices/references/nextjs/server-serialization.md": "---\ntitle: Minimize Serialization at RSC Boundaries\nimpact: HIGH\nimpactDescription: reduces data transfer size\ntags: server, rsc, serialization, props\n---\n\n## Minimize Serialization at RSC Boundaries\n\nThe React Server/Client boundary serializes all object properties into strings and embeds them in the HTML response and subsequent RSC requests. This serialized data directly impacts page weight and load time, so **size matters a lot**. Only pass fields that the client actually uses.\n\n**Incorrect (serializes all 50 fields):**\n\n```tsx\nasync function Page() {\n  const user = await fetchUser()  // 50 fields\n  return <Profile user={user} />\n}\n\n'use client'\nfunction Profile({ user }: { user: User }) {\n  return <div>{user.name}</div>  // uses 1 field\n}\n```\n\n**Correct (serializes only 1 field):**\n\n```tsx\nasync function Page() {\n  const user = await fetchUser()\n  return <Profile name={user.name} />\n}\n\n'use client'\nfunction Profile({ name }: { name: string }) {\n  return <div>{name}</div>\n}\n```\n",
        "refactor/skills/best-practices/references/python.md": "# Python Code Standards\n\nLanguage-specific guidelines for Python projects following PEP standards. Always apply [universal.md](universal.md) principles in addition to these language-specific rules.\n\n## Code Style (PEP 8)\n\n### Indentation and Line Length\n- Use 4 spaces per indentation level (never tabs)\n- Maximum line length: 79 characters for code, 72 for docstrings/comments\n- Use parentheses for line continuation over backslashes\n\n### Naming Conventions\n- **Modules**: `lowercase_with_underscores`\n- **Classes**: `CapitalizedWords` (PascalCase)\n- **Functions/Variables**: `lowercase_with_underscores` (snake_case)\n- **Constants**: `UPPER_CASE_WITH_UNDERSCORES`\n- **Private**: prefix with single underscore `_private_method`\n\n### Example\n```python\n# Module: user_service.py\n\nMAX_RETRY_COUNT = 3  # Constant\n\nclass UserService:  # Class\n    def __init__(self):\n        self._connection = None  # Private attribute\n\n    def get_user_by_id(self, user_id: str) -> User:  # Method\n        \"\"\"Retrieve user by ID.\"\"\"\n        return self._fetch_user(user_id)\n\n    def _fetch_user(self, user_id: str) -> User:  # Private method\n        # Implementation\n        pass\n```\n\n## Type Hints (PEP 484)\n\n### Function Signatures\n- Add type hints for function parameters and return values\n- Use `Optional[T]` for nullable types\n- Use `Union[T1, T2]` for multiple possible types\n- Use `typing` module for complex types\n\n### Example\n```python\nfrom typing import Optional, List, Dict, Union\n\ndef get_user(user_id: str) -> Optional[User]:\n    \"\"\"Get user by ID, returns None if not found.\"\"\"\n    pass\n\ndef process_items(items: List[str]) -> Dict[str, int]:\n    \"\"\"Count occurrences of each item.\"\"\"\n    return {item: items.count(item) for item in set(items)}\n\ndef handle_value(value: Union[int, str]) -> str:\n    \"\"\"Convert value to string.\"\"\"\n    return str(value)\n```\n\n## Documentation (PEP 257)\n\n### Docstrings\n- Use triple double quotes: `\"\"\"Docstring\"\"\"`\n- One-line docstrings for simple functions\n- Multi-line docstrings for complex functions with detailed description\n\n### Example\n```python\ndef simple_function(x: int) -> int:\n    \"\"\"Double the input value.\"\"\"\n    return x * 2\n\ndef complex_function(data: List[Dict[str, any]]) -> Dict[str, List[str]]:\n    \"\"\"\n    Process data and group by category.\n\n    Args:\n        data: List of dictionaries containing 'category' and 'value' keys\n\n    Returns:\n        Dictionary mapping categories to lists of values\n\n    Raises:\n        ValueError: If data format is invalid\n    \"\"\"\n    pass\n```\n\n## Module Organization\n\n### Import Order (PEP 8)\n1. Standard library imports\n2. Related third-party imports\n3. Local application imports\n- Separate each group with a blank line\n- Sort imports alphabetically within each group\n\n### Example\n```python\n# Standard library\nimport os\nimport sys\nfrom pathlib import Path\n\n# Third-party\nimport numpy as np\nimport pandas as pd\nfrom flask import Flask, request\n\n# Local application\nfrom .models import User\nfrom .utils import validate_email\n```\n\n## Functions and Methods\n\n### Function Design\n- Keep functions small and focused\n- Use descriptive names (verbs for actions)\n- Default arguments should be immutable\n- Use `*args` and `**kwargs` sparingly\n\n### Example\n```python\n# Good - immutable default\ndef create_list(items: Optional[List[str]] = None) -> List[str]:\n    if items is None:\n        items = []\n    return items\n\n# Bad - mutable default\ndef bad_create_list(items: List[str] = []) -> List[str]:  # Don't do this!\n    return items\n```\n\n## Error Handling\n\n### Exception Handling\n- Catch specific exceptions, not bare `except:`\n- Use context managers for resource management\n- Raise exceptions with meaningful messages\n- Use custom exceptions for application-specific errors\n\n### Example\n```python\n# Good - specific exceptions\ntry:\n    with open('file.txt', 'r') as f:\n        data = f.read()\nexcept FileNotFoundError:\n    print(\"File not found\")\nexcept PermissionError:\n    print(\"Permission denied\")\n\n# Bad - bare except\ntry:\n    risky_operation()\nexcept:  # Don't do this!\n    pass\n```\n\n### Context Managers\n- Use context managers (`with` statement) for resources\n- Implement `__enter__` and `__exit__` for custom context managers\n- Use `contextlib` for simple context managers\n\n## Data Structures\n\n### List Comprehensions\n- Use list comprehensions for simple transformations\n- Use generator expressions for large datasets\n- Don't nest comprehensions too deeply\n\n### Example\n```python\n# Good - clear comprehension\nsquares = [x**2 for x in range(10) if x % 2 == 0]\n\n# Good - generator for memory efficiency\nsum_of_squares = sum(x**2 for x in range(1000000))\n\n# Bad - too complex\nnested = [[y for y in range(x)] for x in range(10) if x % 2 == 0]\n```\n\n### Dictionaries\n- Use dict comprehensions\n- Use `get()` method with defaults\n- Use `setdefault()` or `defaultdict` for initialization\n\n### Example\n```python\nfrom collections import defaultdict\n\n# Dict comprehension\nsquares = {x: x**2 for x in range(10)}\n\n# Safe access with default\nvalue = my_dict.get('key', default_value)\n\n# Grouping with defaultdict\ngroups = defaultdict(list)\nfor item in items:\n    groups[item.category].append(item)\n```\n\n## Classes\n\n### Class Design\n- Use dataclasses for simple data containers (Python 3.7+)\n- Implement `__str__` and `__repr__` for debugging\n- Use properties for computed attributes\n- Prefer composition over inheritance\n\n### Example\n```python\nfrom dataclasses import dataclass\n\n@dataclass\nclass User:\n    \"\"\"User data container.\"\"\"\n    id: str\n    name: str\n    email: str\n\n    @property\n    def display_name(self) -> str:\n        \"\"\"Get display name.\"\"\"\n        return f\"{self.name} <{self.email}>\"\n```\n\n### Magic Methods\n- Implement comparison methods when needed (`__eq__`, `__lt__`, etc.)\n- Use `@functools.total_ordering` to generate comparison methods\n- Implement `__len__`, `__getitem__` for container-like classes\n\n## Dependency Management\n\n### Package Management\n- Use `uv` for dependency management and virtual environments\n- Pin dependencies in `requirements.txt` or `pyproject.toml`\n- Separate dev dependencies from production\n\n### Virtual Environments\n```bash\n# Using uv\nuv venv\nsource .venv/bin/activate  # or `.venv\\Scripts\\activate` on Windows\nuv pip install -r requirements.txt\n```\n\n## Testing\n\n### Test Structure\n- Use `pytest` for testing\n- Name test files `test_*.py` or `*_test.py`\n- Name test functions `test_*`\n- Use fixtures for setup/teardown\n\n### Example\n```python\nimport pytest\n\n@pytest.fixture\ndef sample_user():\n    \"\"\"Create a sample user for testing.\"\"\"\n    return User(id=\"1\", name=\"Test User\", email=\"test@example.com\")\n\ndef test_user_display_name(sample_user):\n    \"\"\"Test user display name generation.\"\"\"\n    assert sample_user.display_name == \"Test User <test@example.com>\"\n```\n\n## Modern Python Features\n\n### f-Strings (Python 3.6+)\n- Use f-strings for string formatting\n- More readable than `%` formatting or `.format()`\n\n### Example\n```python\nname = \"Alice\"\nage = 30\n\n# Good - f-string\nmessage = f\"{name} is {age} years old\"\n\n# Avoid\nmessage = \"%s is %d years old\" % (name, age)\nmessage = \"{} is {} years old\".format(name, age)\n```\n\n### Type Hints and Union Types (Python 3.10+)\n```python\n# Python 3.10+ syntax\ndef process(value: int | str) -> str:\n    return str(value)\n\n# Python 3.9+ for generic types\ndef get_items() -> list[str]:\n    return [\"item1\", \"item2\"]\n```\n\n### Pattern Matching (Python 3.10+)\n```python\nmatch status:\n    case 200:\n        print(\"Success\")\n    case 404:\n        print(\"Not found\")\n    case _:\n        print(\"Unknown status\")\n```\n\n## Performance Considerations\n\n### Iteration\n- Use generators for large datasets\n- Use `itertools` for efficient iteration patterns\n- Avoid repeatedly accessing list/dict methods in loops\n\n### Example\n```python\nfrom itertools import islice\n\n# Good - generator\ndef read_large_file(file_path):\n    with open(file_path) as f:\n        for line in f:  # Generator, memory efficient\n            yield line.strip()\n\n# Use itertools for efficient slicing\nfirst_10 = list(islice(read_large_file('data.txt'), 10))\n```\n\n## Common Pitfalls\n\n### Mutable Default Arguments\n- Never use mutable objects as default arguments\n- Use `None` and create the mutable object inside the function\n\n### Late Binding Closures\n- Be aware of late binding in closures\n- Use default arguments to capture values\n\n### Example\n```python\n# Problem - late binding\nfunctions = [lambda x: x + i for i in range(5)]\n# All lambdas will use i=4\n\n# Solution - use default argument\nfunctions = [lambda x, i=i: x + i for i in range(5)]\n```\n\n## Code Quality Tools\n\n### Linting and Formatting\n- Use `ruff` or `pylint` for linting\n- Use `black` for auto-formatting\n- Use `mypy` for static type checking\n- Use `isort` for import sorting\n\n### Configuration\n```toml\n# pyproject.toml\n[tool.black]\nline-length = 88\ntarget-version = ['py310']\n\n[tool.isort]\nprofile = \"black\"\n\n[tool.mypy]\npython_version = \"3.10\"\nstrict = true\n```\n\n## Project-Specific Standards\n\nAlways check the project's `CLAUDE.md` file for additional project-specific standards that override or extend these guidelines.\n",
        "refactor/skills/best-practices/references/swift.md": "# Swift Code Standards\n\nLanguage-specific guidelines for Swift and SwiftUI projects. Always apply [universal.md](universal.md) principles in addition to these language-specific rules.\n\n## Code Style\n\n### Naming Conventions\n- **Types**: `UpperCamelCase` (classes, structs, enums, protocols)\n- **Properties/Methods**: `lowerCamelCase`\n- **Constants**: `lowerCamelCase` (not UPPER_CASE)\n- **Enum cases**: `lowerCamelCase`\n- **Acronyms**: Treat as words (`urlString`, not `uRLString`)\n\n### Example\n```swift\nstruct UserProfile {\n    let userID: String\n    let firstName: String\n    var isActive: Bool\n\n    func sendMessage(to recipient: User) {\n        // Implementation\n    }\n}\n\nenum NetworkError {\n    case invalidURL\n    case requestFailed\n    case decodingError\n}\n```\n\n## Type System\n\n### Use Type Inference\n- Let Swift infer types when clear from context\n- Add explicit types when it improves readability\n- Always specify types for public APIs\n\n### Example\n```swift\n// Good - inference is clear\nlet name = \"Alice\"\nlet count = 42\nlet items = [1, 2, 3, 4, 5]\n\n// Good - explicit type improves clarity\nlet timeout: TimeInterval = 30\nvar delegate: UserDelegate?\n\n// Public API - always explicit\npublic func fetchUser(id: String) -> User? {\n    // Implementation\n    return nil\n}\n```\n\n### Optionals\n- Use optionals to represent absence of value\n- Prefer optional binding (`if let`, `guard let`) over force unwrapping\n- Use optional chaining for safe property access\n- Use nil coalescing (`??`) for default values\n\n### Example\n```swift\n// Good - optional binding\nif let user = fetchUser(id: \"123\") {\n    print(user.name)\n}\n\n// Good - guard for early exit\nguard let user = fetchUser(id: \"123\") else {\n    return\n}\n\n// Good - optional chaining\nlet emailLength = user?.email?.count\n\n// Good - nil coalescing\nlet displayName = user?.name ?? \"Anonymous\"\n\n// Avoid - force unwrapping (unless truly certain)\nlet user = fetchUser(id: \"123\")!  // Dangerous!\n```\n\n## Error Handling\n\n### Throwing Functions\n- Use `throws` for recoverable errors\n- Create custom error types as enums\n- Provide meaningful error messages\n\n### Example\n```swift\nenum ValidationError: Error {\n    case emptyField(String)\n    case invalidFormat(String)\n    case tooShort(minimum: Int)\n}\n\nfunc validateEmail(_ email: String) throws {\n    guard !email.isEmpty else {\n        throw ValidationError.emptyField(\"email\")\n    }\n\n    guard email.contains(\"@\") else {\n        throw ValidationError.invalidFormat(\"email must contain @\")\n    }\n}\n\n// Using throwing functions\ndo {\n    try validateEmail(userEmail)\n    print(\"Email is valid\")\n} catch ValidationError.emptyField(let field) {\n    print(\"\\(field) cannot be empty\")\n} catch ValidationError.invalidFormat(let message) {\n    print(message)\n} catch {\n    print(\"Unknown error: \\(error)\")\n}\n```\n\n### Result Type\n- Use `Result<Success, Failure>` for asynchronous operations\n- Combine with `async/await` when appropriate\n\n### Example\n```swift\nfunc fetchData() -> Result<Data, NetworkError> {\n    // Implementation\n    return .failure(.invalidURL)\n}\n\n// Using Result\nswitch fetchData() {\ncase .success(let data):\n    print(\"Received \\(data.count) bytes\")\ncase .failure(let error):\n    print(\"Error: \\(error)\")\n}\n```\n\n## Properties\n\n### Computed Properties\n- Use computed properties for derived values\n- Keep computed properties simple and fast\n- Use stored properties for cached values\n\n### Example\n```swift\nstruct Rectangle {\n    var width: Double\n    var height: Double\n\n    // Computed property\n    var area: Double {\n        width * height\n    }\n\n    // Computed property with getter and setter\n    var aspectRatio: Double {\n        get { width / height }\n        set { width = height * newValue }\n    }\n}\n```\n\n### Property Observers\n- Use `willSet` and `didSet` for side effects\n- Don't use for complex logic\n\n### Example\n```swift\nclass ViewModel {\n    var isLoading: Bool = false {\n        didSet {\n            if isLoading {\n                showLoadingIndicator()\n            } else {\n                hideLoadingIndicator()\n            }\n        }\n    }\n}\n```\n\n## Functions and Methods\n\n### Parameter Labels\n- Use clear parameter labels\n- Omit first parameter label when it reads naturally\n- Use `_` to skip labels when appropriate\n\n### Example\n```swift\n// Good - clear labels\nfunc move(from start: Point, to end: Point) {\n    // Implementation\n}\n\n// Good - natural reading without first label\nfunc remove(_ element: Element) {\n    // Implementation\n}\n\n// Usage reads naturally\nmove(from: pointA, to: pointB)\nremove(element)\n```\n\n### Default Parameters\n- Use default parameters for optional configuration\n- Place parameters with defaults at the end\n\n### Example\n```swift\nfunc createButton(\n    title: String,\n    style: ButtonStyle = .primary,\n    action: @escaping () -> Void\n) -> Button {\n    // Implementation\n}\n\n// Usage\ncreateButton(title: \"Save\") { save() }\n```\n\n## Protocols and Extensions\n\n### Protocol-Oriented Programming\n- Favor protocols and protocol extensions over inheritance\n- Use protocols for abstraction\n- Provide default implementations in extensions\n\n### Example\n```swift\nprotocol Fetchable {\n    associatedtype DataType\n    func fetch() async throws -> DataType\n}\n\nextension Fetchable {\n    // Default implementation\n    func fetchWithRetry(attempts: Int = 3) async throws -> DataType {\n        for attempt in 1...attempts {\n            do {\n                return try await fetch()\n            } catch {\n                if attempt == attempts { throw error }\n            }\n        }\n        fatalError(\"Unreachable\")\n    }\n}\n\nstruct UserService: Fetchable {\n    func fetch() async throws -> [User] {\n        // Implementation\n        return []\n    }\n}\n```\n\n### Extensions for Organization\n- Use extensions to organize code by functionality\n- Mark with `// MARK:` comments\n\n### Example\n```swift\nclass UserViewController {\n    // Properties and initialization\n}\n\n// MARK: - UITableViewDataSource\nextension UserViewController: UITableViewDataSource {\n    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {\n        return users.count\n    }\n}\n\n// MARK: - UITableViewDelegate\nextension UserViewController: UITableViewDelegate {\n    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {\n        // Handle selection\n    }\n}\n```\n\n## SwiftUI Specific\n\n### View Composition\n- Keep views small and focused\n- Extract subviews for reusability\n- Use `@ViewBuilder` for custom container views\n\n### Example\n```swift\nstruct UserProfileView: View {\n    let user: User\n\n    var body: some View {\n        VStack(alignment: .leading, spacing: 16) {\n            HeaderView(user: user)\n            DetailsView(user: user)\n            ActionButtons(user: user)\n        }\n    }\n}\n\n// Extracted subview\nstruct HeaderView: View {\n    let user: User\n\n    var body: some View {\n        HStack {\n            AsyncImage(url: user.avatarURL)\n                .frame(width: 60, height: 60)\n                .clipShape(Circle())\n\n            VStack(alignment: .leading) {\n                Text(user.name)\n                    .font(.headline)\n                Text(user.email)\n                    .font(.subheadline)\n                    .foregroundColor(.secondary)\n            }\n        }\n    }\n}\n```\n\n### State Management\n- Use `@State` for view-local state\n- Use `@Binding` to pass mutable state to child views\n- Use `@StateObject` for view-owned observable objects\n- Use `@ObservedObject` for externally-owned observable objects\n- Use `@EnvironmentObject` for shared state across view hierarchy\n\n### Example\n```swift\nclass UserViewModel: ObservableObject {\n    @Published var users: [User] = []\n    @Published var isLoading = false\n\n    func fetchUsers() async {\n        isLoading = true\n        // Fetch users\n        isLoading = false\n    }\n}\n\nstruct UserListView: View {\n    @StateObject private var viewModel = UserViewModel()\n    @State private var searchText = \"\"\n\n    var body: some View {\n        NavigationView {\n            List(filteredUsers) { user in\n                UserRow(user: user)\n            }\n            .searchable(text: $searchText)\n            .task {\n                await viewModel.fetchUsers()\n            }\n        }\n    }\n\n    var filteredUsers: [User] {\n        guard !searchText.isEmpty else { return viewModel.users }\n        return viewModel.users.filter { $0.name.contains(searchText) }\n    }\n}\n\nstruct UserRow: View {\n    let user: User\n    @State private var isExpanded = false\n\n    var body: some View {\n        VStack {\n            Text(user.name)\n                .onTapGesture {\n                    withAnimation {\n                        isExpanded.toggle()\n                    }\n                }\n\n            if isExpanded {\n                Text(user.details)\n            }\n        }\n    }\n}\n```\n\n## Concurrency (async/await)\n\n### Async Functions\n- Use `async/await` for asynchronous operations\n- Mark functions with `async` when they perform async work\n- Use `await` to call async functions\n\n### Example\n```swift\nfunc fetchUser(id: String) async throws -> User {\n    let url = URL(string: \"https://api.example.com/users/\\(id)\")!\n    let (data, _) = try await URLSession.shared.data(from: url)\n    return try JSONDecoder().decode(User.self, from: data)\n}\n\n// Usage\nTask {\n    do {\n        let user = try await fetchUser(id: \"123\")\n        print(user.name)\n    } catch {\n        print(\"Error: \\(error)\")\n    }\n}\n```\n\n### Actors\n- Use actors for thread-safe mutable state\n- Actor methods are implicitly async\n\n### Example\n```swift\nactor UserCache {\n    private var cache: [String: User] = [:]\n\n    func getUser(id: String) -> User? {\n        cache[id]\n    }\n\n    func setUser(_ user: User) {\n        cache[user.id] = user\n    }\n}\n\n// Usage\nlet cache = UserCache()\nawait cache.setUser(user)\nlet cached = await cache.getUser(id: \"123\")\n```\n\n## Memory Management\n\n### Weak and Unowned References\n- Use `weak` for optional references that can become nil\n- Use `unowned` for non-optional references that won't become nil\n- Use `[weak self]` or `[unowned self]` in closures to avoid retain cycles\n\n### Example\n```swift\nclass UserViewController {\n    var onComplete: (() -> Void)?\n\n    func fetchData() {\n        NetworkService.shared.fetchUsers { [weak self] users in\n            guard let self = self else { return }\n            self.users = users\n            self.tableView.reloadData()\n        }\n    }\n}\n```\n\n## Collection Operations\n\n### Higher-Order Functions\n- Use `map`, `filter`, `reduce`, `compactMap`, etc.\n- Chain operations for clarity\n- Avoid deeply nested operations\n\n### Example\n```swift\n// Good - clear chain of operations\nlet activeUserNames = users\n    .filter { $0.isActive }\n    .map { $0.name }\n    .sorted()\n\n// Compact map for optional filtering\nlet validEmails = users\n    .compactMap { $0.email }\n    .filter { $0.contains(\"@\") }\n```\n\n## Testing\n\n### Unit Tests\n- Use XCTest framework\n- Name tests descriptively: `test_methodName_scenario_expectedResult`\n- Use `Given-When-Then` pattern\n\n### Example\n```swift\nclass UserServiceTests: XCTestCase {\n    func test_fetchUser_withValidID_returnsUser() async throws {\n        // Given\n        let service = UserService()\n        let userID = \"123\"\n\n        // When\n        let user = try await service.fetchUser(id: userID)\n\n        // Then\n        XCTAssertEqual(user.id, userID)\n        XCTAssertFalse(user.name.isEmpty)\n    }\n\n    func test_fetchUser_withInvalidID_throwsError() async {\n        // Given\n        let service = UserService()\n\n        // When/Then\n        do {\n            _ = try await service.fetchUser(id: \"invalid\")\n            XCTFail(\"Expected error to be thrown\")\n        } catch {\n            XCTAssertTrue(error is NetworkError)\n        }\n    }\n}\n```\n\n## Documentation\n\n### DocC Comments\n- Use triple-slash `///` for documentation\n- Include summary, parameters, returns, and throws\n\n### Example\n```swift\n/// Fetches a user from the API.\n///\n/// This function retrieves user data by ID and decodes it into a User object.\n///\n/// - Parameter id: The unique identifier for the user.\n/// - Returns: A User object with the user's data.\n/// - Throws: `NetworkError.invalidURL` if the URL is malformed,\n///           `NetworkError.decodingError` if the response can't be decoded.\nfunc fetchUser(id: String) async throws -> User {\n    // Implementation\n}\n```\n\n## Code Organization\n\n### File Structure\n- One type per file (generally)\n- Group related types in the same file when tightly coupled\n- Use folders to organize by feature or layer\n\n### MARK Comments\n- Use `// MARK: -` to organize code sections\n- Standard sections: Properties, Initialization, Public Methods, Private Methods\n\n### Example\n```swift\nclass UserViewController: UIViewController {\n    // MARK: - Properties\n\n    private var users: [User] = []\n\n    // MARK: - Lifecycle\n\n    override func viewDidLoad() {\n        super.viewDidLoad()\n        setupUI()\n    }\n\n    // MARK: - Public Methods\n\n    func refreshData() {\n        // Implementation\n    }\n\n    // MARK: - Private Methods\n\n    private func setupUI() {\n        // Implementation\n    }\n}\n```\n\n## Project-Specific Standards\n\nAlways check the project's `CLAUDE.md` file for additional project-specific standards that override or extend these guidelines.\n",
        "refactor/skills/best-practices/references/typescript.md": "# TypeScript / JavaScript Code Standards\n\nLanguage-specific guidelines for TypeScript, JavaScript, and React projects. Always apply [universal.md](universal.md) principles in addition to these language-specific rules.\n\n## Module System\n\n### ES Modules\n- Use ES modules (`import`/`export`) over CommonJS\n- Organize imports in logical groups:\n  1. External dependencies\n  2. Internal absolute imports\n  3. Relative imports\n- Remove unused imports\n\n### Example\n```typescript\n// External dependencies\nimport React from 'react'\nimport { useState } from 'react'\n\n// Internal absolute imports\nimport { Button } from '@/components/Button'\nimport { useAuth } from '@/hooks/useAuth'\n\n// Relative imports\nimport { helper } from './utils'\n```\n\n## Functions\n\n### Function Declarations vs Arrow Functions\n- **Prefer `function` keyword** for top-level functions\n- **Use arrow functions** for:\n  - Callbacks and inline functions\n  - Methods that need lexical `this`\n  - Array methods (map, filter, reduce)\n\n### Example\n```typescript\n// Top-level function - use function keyword\nfunction calculateTotal(items: Item[]): number {\n  return items.reduce((sum, item) => sum + item.price, 0)\n}\n\n// Arrow functions for callbacks\nconst filtered = items.filter(item => item.isActive)\n\n// Arrow functions for lexical this\nclass Component {\n  handleClick = () => {\n    // 'this' is lexically bound\n  }\n}\n```\n\n## Type Annotations\n\n### Explicit Return Types\n- Add explicit return type annotations for **top-level functions**\n- TypeScript can infer types for simple functions, but explicit types improve readability and catch errors\n\n### Example\n```typescript\n// Good - explicit return type\nfunction getUser(id: string): Promise<User> {\n  return api.fetchUser(id)\n}\n\n// Acceptable - simple inline functions can rely on inference\nconst double = (n: number) => n * 2\n```\n\n### Type vs Interface\n- Use `type` for unions, intersections, and primitives\n- Use `interface` for object shapes that may be extended\n- Be consistent within a file or module\n\n### Generic Types\n- Use generic types for reusable components and functions\n- Provide default types when appropriate\n- Avoid overly complex generic constraints\n\n## React Patterns\n\n### Component Props\n- Always define explicit Props types\n- Use `interface` for component props\n- Destructure props in function signature when simple\n\n### Example\n```typescript\ninterface ButtonProps {\n  label: string\n  onClick: () => void\n  disabled?: boolean\n}\n\nfunction Button({ label, onClick, disabled = false }: ButtonProps) {\n  return (\n    <button onClick={onClick} disabled={disabled}>\n      {label}\n    </button>\n  )\n}\n```\n\n### Hooks\n- Follow React hooks rules (don't call in loops/conditions)\n- Extract custom hooks for reusable logic\n- Prefix custom hooks with `use`\n\n### State Management\n- Use appropriate state management:\n  - `useState` for simple component state\n  - `useReducer` for complex state logic\n  - Context for shared state\n  - External libraries (Redux, Zustand) for app-wide state\n\n## Error Handling\n\n### Async/Await over Promises\n- Prefer `async/await` over promise chains for readability\n- Handle errors with try/catch blocks **only when you can recover**\n- Don't catch errors just to log and rethrow\n\n### Example\n```typescript\n// Good - specific error handling\nasync function fetchData(): Promise<Data> {\n  const response = await fetch('/api/data')\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status}: ${response.statusText}`)\n  }\n  return response.json()\n}\n\n// Avoid - empty catch or just logging\nasync function badExample() {\n  try {\n    await fetchData()\n  } catch (error) {\n    console.log(error) // Don't just log and swallow\n  }\n}\n```\n\n### Error Boundaries (React)\n- Use Error Boundaries for catching rendering errors\n- Provide fallback UI for better user experience\n\n## TypeScript-Specific\n\n### Strict Mode\n- Enable strict mode in `tsconfig.json`\n- Avoid `any` type - use `unknown` when type is truly unknown\n- Use type guards to narrow types\n\n### Type Guards\n```typescript\nfunction isString(value: unknown): value is string {\n  return typeof value === 'string'\n}\n\nfunction process(value: unknown) {\n  if (isString(value)) {\n    // value is now typed as string\n    console.log(value.toUpperCase())\n  }\n}\n```\n\n### Null Safety\n- Use optional chaining (`?.`) for safe property access\n- Use nullish coalescing (`??`) for default values\n- Avoid \"!\" (non-null assertion) unless absolutely certain\n\n### Example\n```typescript\n// Good - safe access\nconst username = user?.profile?.name ?? 'Anonymous'\n\n// Avoid - non-null assertion (unless you're certain)\nconst username = user!.profile!.name\n```\n\n## Naming Conventions\n\n### Variables and Functions\n- Use camelCase: `getUserName`, `isValid`\n- Use descriptive names over abbreviations\n\n### Types and Interfaces\n- Use PascalCase: `User`, `ButtonProps`\n- Suffix interfaces with Props when appropriate: `ButtonProps`, `UserCardProps`\n\n### Constants\n- Use UPPER_SNAKE_CASE for true constants: `MAX_RETRY_COUNT`, `API_BASE_URL`\n- Use camelCase for configuration objects\n\n### Files\n- Use kebab-case for file names: `user-profile.ts`, `api-client.ts`\n- Match file name to primary export: `Button.tsx` exports `Button` component\n\n## Code Organization\n\n### File Structure\n- One primary export per file\n- Group related code together\n- Keep files focused and reasonably sized\n\n### Barrel Exports\n- Use index files for clean imports: `@/components` instead of `@/components/Button/Button`\n- Don't overuse - can impact tree-shaking\n\n## Modern JavaScript/TypeScript Features\n\n### Destructuring\n- Use destructuring for object and array access\n- Use rest/spread operators appropriately\n\n### Optional Chaining and Nullish Coalescing\n- Use `?.` for safe property access\n- Use `??` for default values (not `||` which treats 0 and '' as falsy)\n\n### Template Literals\n- Use template literals for string interpolation\n- Use tagged templates for complex formatting\n\n### Array Methods\n- Use `map`, `filter`, `reduce` over manual loops when appropriate\n- Chain methods for readability\n\n### Example\n```typescript\n// Good - functional approach\nconst activeUserNames = users\n  .filter(user => user.isActive)\n  .map(user => user.name)\n  .sort()\n```\n\n## Performance Considerations\n\n### React Optimization\n- Use `React.memo` for expensive components\n- Use `useMemo` for expensive calculations\n- Use `useCallback` for stable function references\n- **Don't over-optimize** - measure first\n\n### Avoid Premature Optimization\n- Write clear code first\n- Optimize only when performance issues are identified\n- Use profiling tools to identify bottlenecks\n\n## Testing\n\n### Test Structure\n- Use descriptive test names\n- Follow Arrange-Act-Assert pattern\n- Test behavior, not implementation\n\n### React Testing\n- Test user interactions, not implementation details\n- Use Testing Library queries in order of preference:\n  1. getByRole\n  2. getByLabelText\n  3. getByPlaceholderText\n  4. getByText\n  5. getByTestId (last resort)\n\n## Project-Specific Standards\n\nAlways check the project's `CLAUDE.md` file for additional project-specific standards that override or extend these guidelines.\n",
        "refactor/skills/best-practices/references/universal.md": "# Universal Code Quality Principles\n\nThese principles apply across all programming languages and paradigms. Always follow these guidelines regardless of the specific language you're working with.\n\n## Core Principles\n\n### SOLID Principles\n- **Single Responsibility**: Each module/class/function should have one reason to change\n- **Open/Closed**: Open for extension, closed for modification\n- **Liskov Substitution**: Derived types must be substitutable for their base types\n- **Interface Segregation**: No client should depend on methods it doesn't use\n- **Dependency Inversion**: Depend on abstractions, not concretions\n\n### DRY (Don't Repeat Yourself)\n- Eliminate code duplication\n- Extract common patterns into reusable functions/modules\n- Create abstractions for repeated logic\n\n### KISS (Keep It Simple, Stupid)\n- Prefer simplicity over cleverness\n- Avoid unnecessary complexity\n- Write code that's easy to understand and maintain\n\n### YAGNI (You Aren't Gonna Need It)\n- Don't implement features until they're actually needed\n- Avoid speculative generalization\n- Focus on current requirements\n\n### Convention over Configuration\n- Follow established conventions and defaults\n- Minimize configuration where sensible defaults exist\n\n### Law of Demeter (Principle of Least Knowledge)\n- Objects should only talk to their immediate friends\n- Minimize coupling between components\n\n## Code Quality Attributes\n\n### Readability\n- Use clear, descriptive names for variables, functions, and classes\n- Avoid abbreviations unless they're standard in the domain\n- Maintain consistent formatting and style\n- Keep line length reasonable (typically 80-120 characters)\n\n### Maintainability\n- Keep functions small and focused (typically < 50 lines)\n- Maintain low cyclomatic complexity\n- Use meaningful structure and organization\n- Write self-documenting code\n\n### Reliability\n- Handle errors explicitly and meaningfully\n- Validate input at system boundaries (user input, external APIs)\n- Trust internal code and framework guarantees\n- Avoid defensive programming for scenarios that can't happen\n\n### Testability\n- Design for testability from the start\n- Use dependency injection for better isolation\n- Keep units small and focused\n- Minimize global state and side effects\n\n## Code Smells to Avoid\n\n### Structure Smells\n- **Long methods**: Break down into smaller, focused functions\n- **Large classes**: Split into cohesive, single-responsibility classes\n- **Deep nesting**: Use guard clauses and early returns\n- **Long parameter lists**: Group related parameters into objects\n\n### Logic Smells\n- **Duplicate code**: Extract common patterns\n- **Complex conditionals**: Extract into well-named functions\n- **Magic numbers**: Use named constants\n- **Global state**: Prefer local state and explicit parameters\n\n### Organization Smells\n- **Shotgun surgery**: Changes require modifications in many places\n- **Divergent change**: A class changes for multiple reasons\n- **Feature envy**: A method uses more features of another class than its own\n\n## Refactoring Techniques\n\n### Function Extraction\n- Extract complex logic into well-named functions\n- Each function should do one thing well\n- Aim for functions that fit on one screen\n\n### Loop Optimization\n- Flatten nested loops where possible\n- Extract loop bodies into functions\n- Consider functional approaches (map, filter, reduce)\n\n### Conditional Simplification\n- Use guard clauses to reduce nesting\n- Extract conditions into well-named functions\n- Prefer early returns over deep nesting\n- Consider polymorphism for complex conditionals\n\n### Abstraction and Encapsulation\n- Hide implementation details\n- Expose minimal, well-defined interfaces\n- Group related data and behavior together\n\n## Comments and Documentation\n\n### When to Comment\n- **Why, not what**: Explain business logic and complex decisions\n- **Non-obvious implications**: Warning about side effects or constraints\n- **Public APIs**: Document interface contracts and usage\n\n### When NOT to Comment\n- **Obvious code**: If the code is self-explanatory, don't comment\n- **Outdated comments**: Remove or update stale comments\n- **Commented-out code**: Delete it (version control keeps history)\n\n## Naming Conventions\n\n### General Rules\n- Names should reveal intent\n- Use pronounceable names\n- Use searchable names\n- Avoid encodings and prefixes\n- One word per concept\n\n### Context-Specific\n- **Functions**: Use verbs (calculate, get, set, is, has)\n- **Classes**: Use nouns (User, Product, Service)\n- **Booleans**: Use predicates (isValid, hasPermission, canDelete)\n- **Constants**: Use descriptive names explaining purpose\n\n## Error Handling\n\n### Universal Patterns\n- Fail fast: Detect errors early\n- Provide context: Include meaningful error messages\n- Don't swallow errors: Handle or propagate, never ignore\n- Validate at boundaries: Check input from users and external systems\n- Trust internal code: Don't add defensive checks for internal invariants\n\n### What NOT to Do\n- Empty catch blocks\n- Generic error messages without context\n- Catching errors you can't handle\n- Using exceptions for control flow\n\n## Performance Considerations\n\n### Premature Optimization\n- Focus on correctness and clarity first\n- Optimize only after profiling identifies bottlenecks\n- Measure before and after optimization\n\n### Universal Patterns\n- Avoid unnecessary object creation in loops\n- Use appropriate data structures for the task\n- Cache expensive computations when appropriate\n- Consider algorithmic complexity (Big O)\n\n## Testing Guidelines\n\n### Test Structure\n- Arrange-Act-Assert pattern\n- One assertion concept per test\n- Test behavior, not implementation\n- Use descriptive test names\n\n### Test Coverage\n- Test happy paths and edge cases\n- Test error conditions\n- Focus on public interfaces\n- Don't test trivial code\n\n## Continuous Improvement\n\n### Regular Refactoring\n- Refactor as you go (Boy Scout Rule: leave code better than you found it)\n- Address technical debt incrementally\n- Don't let small issues accumulate\n\n### Code Review\n- Review for design and architecture, not just bugs\n- Look for code smells and improvement opportunities\n- Ensure code follows project conventions\n",
        "refactor/skills/refactor-project/SKILL.md": "---\nname: refactor-project\ndescription: Run project-wide refactoring with code-simplifier\nargument-hint: (no arguments needed - refactors entire project)\nallowed-tools: [\"Task\", \"Read\", \"Write\", \"Bash(git:*)\", \"Grep\", \"Glob\"]\nuser-invocable: true\n---\n\n# Refactor Project Command\n\n## Core Principles\n\n- **Fully automated**: Execute project-wide refactoring immediately without confirmation\n- **Aggressive refactoring**: Apply thorough improvements across entire codebase\n- **Self-discovery**: Agent discovers best practices from skills automatically\n- **Cross-file focus**: Emphasize duplication reduction and consistent patterns\n- **Git safety net**: Trust git to revert if needed, no preview confirmations\n\n## Context\n\n- This command is for project-wide refactoring across the entire codebase.\n- This command executes immediately without preview or confirmation.\n- Use git to revert if any issues arise.\n\n## Step 1: Analyze Project Scope\n\nPerform a quick analysis to determine the refactoring scope:\n\n1. **Count code files**:\n   - Use Glob to find all code files in the project\n   - Filter to focus on source code (exclude node_modules, build outputs, etc.)\n   - Group by file type/language\n\n2. **Identify main directories**:\n   - List primary source code directories\n   - Show project structure overview\n\n3. **Display scope summary** (informational only, no confirmation needed):\n   - Total number of files to be refactored\n   - Languages/file types detected\n   - Main directories involved\n   - Note: \"Proceeding with project-wide refactoring automatically\"\n\n## Step 2: Launch Refactoring Agent\n\nImmediately launch the refactoring agent:\n\n1. Use Task tool with subagent_type=\"refactor:code-simplifier\"\n2. Pass:\n   - \"project-wide scope\" indication\n   - Emphasis on cross-file duplication reduction and consistent patterns\n   - **Aggressive mode flag**: Apply thorough refactoring, remove legacy code\n3. The agent will automatically:\n   - Load the refactor:best-practices skill\n   - Analyze the entire codebase\n   - Detect frameworks, libraries, and languages\n   - Discover and apply relevant best practices from skill references\n   - Emphasize cross-file duplication and consistent patterns\n   - **Aggressively refactor**: Remove backwards-compatibility hacks, unused code, rename properly\n   - Preserve functionality while improving clarity, consistency, and maintainability\n   - Apply Code Quality Standards as defined in the refactor:best-practices skill\n\n## Step 3: Summary\n\nAfter completion:\n\n1. **Summarize Changes**:\n   - Total files refactored (count and percentage of project)\n   - What changed and why (categorized by improvement type)\n   - Files touched (total count)\n   - Best practices applied (which categories/patterns)\n   - Cross-file improvements made (deduplication, consistency)\n   - Quality standards enforced\n   - Legacy code removed\n   - Suggested tests to run\n   - Recommendation to review changes in logical groups\n   - Git rollback command if needed: `git reset --hard HEAD`\n\n## Requirements\n\n- **NO user confirmations** - execute immediately after displaying scope\n- **Refactor entire project** - apply improvements across all discovered code files\n- **Aggressive refactoring** - remove legacy compatibility code, unused exports, rename improperly named vars\n- Follow the refactor:best-practices workflow and references in the refactor plugin skills\n- Let the agent self-discover best practices from skills\n- Preserve functionality while improving clarity, consistency, and maintainability\n- Emphasize cross-file duplication reduction and consistent patterns\n- Apply Code Quality Standards as defined in the refactor:best-practices skill\n",
        "refactor/skills/refactor/SKILL.md": "---\nname: refactor\ndescription: Refactor code with code-simplifier\nargument-hint: [files-or-directories-or-semantic-query]\nallowed-tools: [\"Task\", \"Read\", \"Write\", \"Bash(git:*)\", \"Grep\", \"Glob\"]\nuser-invocable: true\n---\n\n# Refactor Command\n\n## Core Principles\n\n- **Fully automated**: Execute refactoring immediately without user confirmation\n- **Aggressive refactoring**: Apply thorough improvements, remove legacy compatibility code\n- **Self-discovery**: Agent discovers best practices from skills automatically\n- **Git safety net**: Trust git to revert if needed, no preview confirmations\n\n## Context\n\n- **If arguments are provided**:\n  - First, check if they are valid file/directory paths relative to the repo root.\n  - If paths exist, treat them as target paths.\n  - If paths don't exist or arguments contain semantic descriptions (e.g., \"authentication logic\", \"user login components\"), search the codebase for code matching that description.\n- **If no arguments are provided**:\n  - Default to refactoring code associated with the current session context.\n  - Identify recently modified files from the current session.\n  - If no recent changes are found, inform user to provide specific file/directory paths.\n\n## Step 1: Determine Target Scope\n\n### If Arguments Provided\n\n1. **Check if arguments are file/directory paths**:\n   - Verify if paths exist in the repository\n   - If paths exist, use them directly as target scope\n\n2. **If paths don't exist or arguments are semantic descriptions**:\n   - Search the codebase for code matching the semantic description\n   - **Automatically include ALL matching files** in the refactoring scope\n   - No user confirmation needed - trust the search results\n\n### If No Arguments Provided (Default: Session Context)\n\n1. **Identify recently modified files**:\n   - Find files that have been recently changed in the repository\n   - Filter to focus on code files (exclude configuration, documentation, lock files unless needed)\n\n2. **If no recent changes found**:\n   - Inform user that no recent changes were detected\n   - Suggest providing specific file/directory paths or semantic descriptions as arguments\n   - Exit without refactoring\n\n3. **Automatically proceed**:\n   - Use all identified files as refactoring scope\n   - Display the file list for transparency, but proceed immediately without asking\n\n## Step 2: Launch Refactoring Agent\n\nImmediately launch the refactoring agent:\n\n1. Use Task tool with subagent_type=\"refactor:code-simplifier\"\n2. Pass:\n   - Target scope (file paths, semantic search results, or session context)\n   - Context about how scope was determined (paths, semantic query, or session context)\n   - **Aggressive mode flag**: Apply thorough refactoring, remove legacy code, no compatibility shims\n3. The agent will automatically:\n   - Load the refactor:best-practices skill\n   - Analyze the code and detect languages/frameworks\n   - Discover and apply relevant best practices from skill references\n   - **Aggressively refactor**: Remove backwards-compatibility hacks, unused code, rename properly\n   - Preserve functionality while improving clarity, consistency, and maintainability\n   - Apply Code Quality Standards as defined in the refactor:best-practices skill\n\n## Step 3: Summary\n\nAfter completion:\n\n1. **Summarize Changes**:\n   - Total files refactored\n   - What changed and why (categorized by improvement type)\n   - Best practices applied (which categories/patterns)\n   - Quality standards enforced\n   - Legacy code removed\n   - Suggested tests to run\n   - Git rollback command if needed: `git checkout -- <files>`\n\n## Requirements\n\n- **NO user confirmations** - execute immediately based on scope determination\n- **Refactor ALL matching files** - when semantic search finds multiple results, refactor them all\n- **Aggressive refactoring** - remove legacy compatibility code, unused exports, rename improperly named vars\n- Follow the refactor:best-practices workflow and references in the refactor plugin skills\n- Let the agent self-discover best practices from skills\n- Preserve functionality while improving clarity, consistency, and maintainability\n- Apply Code Quality Standards as defined in the refactor:best-practices skill\n- If the user requests project-wide refactoring, direct them to use `/refactor-project`\n",
        "review/.claude-plugin/plugin.json": "{\n  \"name\": \"review\",\n  \"version\": \"0.2.0\",\n  \"description\": \"Multi-agent review system for enforcing high quality.\",\n  \"author\": {\n    \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  },\n  \"keywords\": [\n    \"code-review\",\n    \"quality\",\n    \"security\",\n    \"architecture\",\n    \"ux\",\n    \"accessibility\",\n    \"multi-agent\",\n    \"peer-review\",\n    \"best-practices\"\n  ],\n  \"commands\": [\n    \"./skills/quick/\",\n    \"./skills/hierarchical/\"\n  ]\n}\n",
        "review/README.md": "# Review Plugin\n\nMulti-agent review system for enforcing high code quality.\n\n## Installation\n\n```bash\nclaude plugin install review@frad-dotclaude\n```\n\n## Overview\n\nThe Review Plugin provides a comprehensive code review system with multiple specialized agents. Each agent focuses on different aspects of code quality, providing thorough and actionable feedback.\n\n## Agents\n\n### `code-reviewer`\n\nExpert reviewer focusing on correctness, standards, and maintainability.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Model | `sonnet` |\n| Color | `blue` |\n\n**Focus areas:**\n- Correctness and logic analysis\n- Standards compliance (CLAUDE.md)\n- Maintainability and readability\n- Error handling and edge cases\n- Code structure and organization\n- Performance and efficiency\n- Testing and quality assurance\n- Security considerations\n\n**When triggered:**\n- Automatically in `/hierarchical` review\n- Can be invoked manually when reviewing code\n\n---\n\n### `security-reviewer`\n\nSecurity specialist auditing authentication, data protection, and inputs.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Model | `sonnet` |\n| Color | `green` |\n\n**Focus areas:**\n- Common vulnerabilities (SQL Injection, XSS, CSRF, SSRF, XXE)\n- Authentication and authorization\n- Input validation and data handling\n- Cryptography and data protection\n- Error handling and information disclosure\n- Dependency and configuration security\n\n**When triggered:**\n- Automatically in `/hierarchical` review\n- Can be invoked manually for security audits\n\n**Output structure:**\n1. CRITICAL VULNERABILITIES (immediate security risks)\n2. HIGH PRIORITY ISSUES (significant security concerns)\n3. MEDIUM PRIORITY ISSUES (potential security weaknesses)\n4. BEST PRACTICE RECOMMENDATIONS (security improvements)\n5. COMPLIANCE NOTES (OWASP, PCI-DSS, GDPR)\n\n---\n\n### `tech-lead-reviewer`\n\nArchitectural reviewer focused on system-wide impact and risk.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Model | `sonnet` |\n| Color | `magenta` |\n\n**Focus areas:**\n- Architectural integrity and Clean Architecture adherence\n- Domain boundaries and module responsibilities\n- Performance implications and scalability\n- Operational readiness (logging, metrics, rollout safety)\n- Risk assessment and mitigation strategies\n\n**Working process:**\n1. Map the change onto existing architecture\n2. Identify coupling points that may become maintenance liabilities\n3. Flag design decisions that violate guardrails or introduce hidden costs\n4. Recommend strategic improvements with rationale and estimated effort\n\n**When triggered:**\n- Automatically in `/hierarchical` review\n- Can be invoked manually for architecture review\n\n---\n\n### `ux-reviewer`\n\nExperience specialist focused on usability and accessibility.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Model | `sonnet` |\n| Color | `yellow` |\n\n**Focus areas:**\n- Information hierarchy, layout clarity, and visual rhythm\n- Interaction patterns, state management, and feedback mechanisms\n- Accessibility compliance (WCAG AA): semantics, keyboard flows, contrast\n- Copywriting tone, localization readiness, and content density\n- Performance considerations affecting perceived responsiveness\n\n**Process:**\n1. Review component structure and states (loading, empty, error, success)\n2. Assess controls for discoverability and affordance\n3. Validate color and typography against design tokens\n4. Recommend usability tests or analytics to validate assumptions\n\n**When triggered:**\n- Automatically in `/hierarchical` review (if UI changes detected)\n- Can be invoked manually for UX review\n\n## User-Invocable Skills\n\n### `/quick`\n\nStreamlined code review for rapid assessment and targeted feedback.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Allowed Tools | `Task` |\n| Argument Hint | `[files-or-directories]` |\n\n**What it does:**\n1. Runs initial assessment with **@tech-lead-reviewer** to gauge risk\n2. Triggers relevant specialized reviews selectively:\n   - **@code-reviewer** — logic correctness, tests, error handling\n   - **@security-reviewer** — authentication, data protection, validation\n   - **@ux-reviewer** — usability and accessibility (skip if purely backend/CLI)\n3. Summarizes results by priority (Critical → High → Medium → Low)\n4. Offers optional implementation support with **@code-simplifier**\n5. Ensures resulting commits follow conventional standards\n\n**Usage:**\n```bash\n/quick\n```\n\nOr with specific files:\n```bash\n/quick src/auth/login.ts\n```\n\n**Features:**\n- Fast, focused review\n- Targets only changed files\n- Selective agent execution (minimizes turnaround time)\n- Quick feedback cycle\n- Identifies critical issues\n- Suitable for rapid iterations\n\n---\n\n### `/hierarchical`\n\nComprehensive multi-stage code review using all specialized subagents.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Allowed Tools | `Task` |\n| Argument Hint | `[files-or-directories]` |\n\n**What it does:**\n1. Performs leadership assessment with **@tech-lead-reviewer** to map risk areas\n2. Launches specialized reviews in parallel:\n   - **@code-reviewer** — logic correctness, tests, error handling\n   - **@security-reviewer** — authentication, data protection, validation\n   - **@ux-reviewer** — usability and accessibility (skip if purely backend/CLI)\n3. Consolidates findings by priority and confidence\n4. Offers optional implementation support\n5. Engages **@code-simplifier** for final optimization\n\n**Usage:**\n```bash\n/hierarchical\n```\n\n**Features:**\n- Comprehensive multi-agent review\n- Parallel agent execution\n- Consolidated findings\n- Prioritized issue reporting\n- Thorough quality assessment\n- Final optimization pass\n\n**Review report includes:**\n- Critical issues (must fix)\n- Important issues (should fix)\n- Suggestions (nice to have)\n- Agent-specific findings\n- File-specific recommendations\n\n## Best Practices\n\n### Using `/quick`\n- Use for rapid feedback during development\n- Run after small changes\n- Great for iterative development\n- Use before committing changes\n- Fast turnaround for quick fixes\n\n### Using `/hierarchical`\n- Use before creating PRs\n- Run on feature branches before merging\n- Use for comprehensive quality assessment\n- Great for identifying complex issues\n- Use when quality is critical\n\n### Agent Selection\n- Use `code-reviewer` for general code quality\n- Use `security-reviewer` for security-critical code\n- Use `tech-lead-reviewer` for architectural decisions\n- Use `ux-reviewer` for UI/UX changes\n- Use all agents via `/hierarchical` for comprehensive review\n\n## Workflow Integration\n\n### Quick Review Workflow:\n```bash\n# Make changes\n/quick\n# Fix issues\n/quick\n# Commit when satisfied\n```\n\n### Comprehensive Review Workflow:\n```bash\n# Complete feature\n/hierarchical\n# Fix all critical issues\n# Re-run review if needed\n# Create PR when clean\n```\n\n### Agent-Specific Review:\n```bash\n# For security-critical code\n@security-reviewer Review this authentication code\n\n# For architecture decisions\n@tech-lead-reviewer Review this module design\n\n# For UI changes\n@ux-reviewer Review this login page\n```\n\n## Requirements\n\n- Git repository\n- Base branch (develop or main) for comparison\n- Project with codebase to review\n\n## Troubleshooting\n\n### Review takes too long\n\n**Issue**: Hierarchical review is slow\n\n**Solution**:\n- This is normal for large changes\n- Agents run in parallel when possible\n- Use `/quick` for faster feedback\n- Review specific files instead of all changes\n\n### Too many issues reported\n\n**Issue**: Review finds too many issues\n\n**Solution**:\n- Focus on critical issues first\n- Address important issues incrementally\n- Some issues may be false positives - review carefully\n- Use `/quick` for focused feedback\n\n### Agent not finding issues\n\n**Issue**: Agent misses obvious problems\n\n**Solution**:\n- Provide more context in code\n- Check if agent is appropriate for the code type\n- Try different agent for different perspective\n- Use multiple agents via `/hierarchical`\n\n## Tips\n\n- **Use quick reviews frequently**: Catch issues early in development\n- **Use hierarchical for PRs**: Comprehensive review before merging\n- **Review agent findings**: Each agent provides valuable insights\n- **Fix critical issues first**: Prioritize by severity\n- **Iterate on reviews**: Re-run review after fixes\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n",
        "review/agents/code-reviewer.md": "---\nname: code-reviewer\ndescription: |\n  Expert reviewer focusing on correctness, standards, and maintainability\n\n  <example>Review new authentication middleware for proper error handling and null safety</example>\n  <example>Evaluate database query logic for potential race conditions and transaction safety</example>\n  <example>Assess test coverage for edge cases in payment processing module</example>\nmodel: sonnet\ncolor: blue\n---\n\nYou are an expert software engineer specializing in comprehensive code review. Your role is to act as a meticulous and collaborative peer reviewer, analyzing code submissions for quality, correctness, and adherence to best practices while helping improve both the codebase and the developer's skills.\n\nWhen reviewing code, you must systematically evaluate these key areas:\n\n**Correctness and Logic Analysis:**\n- Verify the code correctly implements intended functionality and business requirements\n- Identify potential bugs, edge cases, race conditions, or logical errors\n- Ensure proper error handling and graceful exception management\n- Check for null pointer exceptions, array bounds, and other runtime safety issues\n- Validate that async/await patterns are used correctly and don't introduce deadlocks\n\n**Best Practices and Standards Adherence:**\n- Evaluate compliance with project-specific coding standards (consider CLAUDE.md context when available)\n- Check adherence to language-specific conventions and style guides\n- Identify violations of SOLID principles, DRY, KISS, and other architectural guidelines\n- Flag anti-patterns, deprecated features, or problematic code smells\n- Ensure proper use of design patterns where appropriate\n\n**Readability and Maintainability:**\n- Assess code clarity, simplicity, and comprehensibility for future developers\n- Evaluate variable, function, and class naming for descriptiveness and consistency\n- Check for appropriate comments that explain 'why' rather than 'what'\n- Identify overly complex functions that should be broken down\n- Ensure proper code organization and separation of concerns\n\n**Performance and Efficiency:**\n- Identify algorithmic inefficiencies and suggest optimizations\n- Check for unnecessary database queries, memory leaks, or resource waste\n- Evaluate time and space complexity considerations\n- Suggest more performant alternatives while considering readability trade-offs\n- Review caching strategies and data structure choices\n\n**Testing and Quality Assurance:**\n- Verify adequate test coverage for the submitted code\n- Review test quality, including edge cases and error scenarios\n- Ensure tests are maintainable and follow testing best practices\n- Check for proper mocking and isolation in unit tests\n\n**Security Considerations:**\n- Identify potential security vulnerabilities (injection attacks, data exposure, etc.)\n- Check for proper input validation and sanitization\n- Ensure sensitive data is handled securely\n- Verify authentication and authorization implementations\n\n**Feedback Delivery Guidelines:**\n- Provide specific, actionable feedback with clear examples\n- Frame suggestions as collaborative recommendations rather than demands\n- Prioritize issues by severity: critical bugs > security issues > performance > style\n- Include code snippets showing both problematic patterns and suggested improvements\n- Ask clarifying questions when the intent or requirements are unclear\n- Acknowledge good practices and well-written code sections\n- Suggest learning resources when introducing new concepts\n\n**Review Structure:**\n1. Start with an overall assessment of the code quality\n2. List critical issues that must be addressed before merging\n3. Provide improvement suggestions organized by category\n4. End with positive reinforcement and learning opportunities\n\nAlways maintain a constructive, educational tone that fosters growth and collaboration. Your goal is to ensure code quality while helping developers improve their skills and understanding.\n",
        "review/agents/security-reviewer.md": "---\nname: security-reviewer\ndescription: |\n  Security specialist auditing authentication, data protection, and inputs\n\n  <example>Audit user input validation in form handlers for injection vulnerabilities</example>\n  <example>Review JWT token implementation for proper validation and expiration handling</example>\n  <example>Assess API endpoints for authentication bypass and broken access control</example>\n  <example>Evaluate cryptographic implementations for use of weak algorithms</example>\nmodel: sonnet\ncolor: green\n---\n\nYou are a cybersecurity expert specializing in secure coding practices and vulnerability assessment. Your mission is to meticulously review code to identify and mitigate potential security risks, flaws, and vulnerabilities before they can be exploited. You think like an attacker to proactively defend the software.\n\nWhen reviewing code, you will systematically examine:\n\n**Common Vulnerabilities:**\n- SQL Injection, NoSQL Injection, and other injection attacks\n- Cross-Site Scripting (XSS) - stored, reflected, and DOM-based\n- Cross-Site Request Forgery (CSRF) and clickjacking\n- Insecure direct object references and broken access controls\n- Server-Side Request Forgery (SSRF)\n- XML External Entity (XXE) attacks\n- Deserialization vulnerabilities\n\n**Authentication & Authorization:**\n- Proper implementation of authentication mechanisms\n- Session management security (secure cookies, session fixation, timeout)\n- Password policies and secure storage (proper hashing algorithms)\n- Multi-factor authentication implementation\n- JWT token security and proper validation\n- Role-based access control (RBAC) implementation\n\n**Input Validation & Data Handling:**\n- Server-side validation of all user inputs\n- Proper sanitization and encoding of data\n- File upload security (type validation, size limits, malware scanning)\n- API parameter validation and rate limiting\n- Data type validation and boundary checks\n\n**Cryptography & Data Protection:**\n- Use of strong, current encryption algorithms (AES-256, RSA-2048+)\n- Proper SSL/TLS configuration and certificate validation\n- Secure random number generation\n- Key management and rotation practices\n- Hashing algorithms for passwords (bcrypt, scrypt, Argon2)\n- Protection of sensitive data in memory and storage\n\n**Error Handling & Information Disclosure:**\n- Error messages that don't leak system information\n- Proper exception handling without exposing stack traces\n- Secure logging practices (no sensitive data in logs)\n- Debug information removal in production code\n\n**Dependency & Configuration Security:**\n- Known vulnerabilities in third-party libraries\n- Outdated dependencies and security patches\n- Secure default configurations\n- Removal of development/debug features in production\n- Environment variable security and secrets management\n\n**Output Format:**\nProvide your security review in this structure:\n\n1. **CRITICAL VULNERABILITIES** (immediate security risks)\n2. **HIGH PRIORITY ISSUES** (significant security concerns)\n3. **MEDIUM PRIORITY ISSUES** (potential security weaknesses)\n4. **BEST PRACTICE RECOMMENDATIONS** (security improvements)\n5. **COMPLIANCE NOTES** (relevant standards: OWASP, PCI-DSS, GDPR)\n\nFor each issue, include:\n- Specific code location and vulnerability type\n- Potential impact and attack scenarios\n- Concrete remediation steps with code examples\n- Risk level justification\n\nAlways assume an adversarial mindset - consider how an attacker might exploit each piece of code. Prioritize issues that could lead to data breaches, privilege escalation, or system compromise. Be thorough but practical in your recommendations, focusing on actionable security improvements.\n",
        "review/agents/tech-lead-reviewer.md": "---\nname: tech-lead-reviewer\ndescription: |\n  Architectural reviewer focused on system-wide impact and risk\n\n  <example>Evaluate microservice boundary changes for coupling and deployment independence</example>\n  <example>Assess database schema migration for backward compatibility and rollback safety</example>\n  <example>Review caching strategy changes for scalability and observability impact</example>\nmodel: sonnet\ncolor: magenta\n---\n\nYou provide tech-lead level reviews emphasizing architectural soundness, long-term maintainability, and strategic trade-offs. Evaluate changes through a systems lens, considering scalability, observability, and team workflows.\n\n**Scope of Review:**\n- Architectural integrity and adherence to Clean Architecture\n- Domain boundaries, module responsibilities, and dependency direction\n- Performance implications and scalability ceilings\n- Operational readiness (logging, metrics, rollout safety)\n- Risk assessment and mitigation strategies\n\n**Working Process:**\n1. Map the change onto the existing architecture diagram (or infer structure when diagrams are absent).\n2. Identify coupling points that may become maintenance liabilities.\n3. Flag design decisions that violate CLAUDE.md guardrails or introduce hidden costs.\n4. Recommend strategic improvements, phased if necessary to reduce risk.\n\n**Output Expectations:**\n- Summarize architectural impact first (positive or negative).\n- List critical blockers before non-blocking findings.\n- Provide concrete next actions with rationale and estimated effort.\n- Highlight follow-on technical debt that should be tracked.\n\nMaintain a collaborative tone, reinforce good decisions, and align recommendations with product goals.\n",
        "review/agents/ux-reviewer.md": "---\nname: ux-reviewer\ndescription: |\n  Experience specialist focused on usability and accessibility\n\n  <example>Review form validation feedback for clarity and timing of error messages</example>\n  <example>Assess keyboard navigation flow and screen reader compatibility in dashboard</example>\n  <example>Evaluate loading states and perceived performance in data-heavy interfaces</example>\nmodel: sonnet\ncolor: yellow\n---\n\nYou are a UX specialist tasked with evaluating user-facing changes for usability, accessibility, and design consistency.\n\n**Evaluation Areas:**\n- Information hierarchy, layout clarity, and visual rhythm\n- Interaction patterns, state management, and feedback mechanisms\n- Accessibility compliance (WCAG AA): semantics, keyboard flows, contrast\n- Copywriting tone, localization readiness, and content density\n- Performance considerations that affect perceived responsiveness\n\n**Process:**\n1. Review component structure and states (loading, empty, error, success).\n2. Assess controls for discoverability and affordance.\n3. Validate color and typography against design tokens.\n4. Recommend usability tests or analytics to validate assumptions.\n\n**Deliverables:**\n- Prioritized findings (Critical → High → Medium → Low).\n- Concrete UX improvements with examples or references to design system components.\n- Accessibility checklist outcomes and remediation guidance.\n\nEncourage small iterative improvements when immediate full fixes are impractical.\n",
        "review/skills/hierarchical/SKILL.md": "---\nname: hierarchical\nuser-invocable: true\ndescription: Comprehensive multi-stage code review using specialized subagents\nargument-hint: [files-or-directories]\nallowed-tools: Task\n---\n\n# Hierarchical Code Review\n\n## Context\n\n- Current branch: !`git branch --show-current`\n- Git status: !`git status --porcelain`\n- Base branch: !`(git show-branch | grep '*' | grep -v \"$(git rev-parse --abbrev-ref HEAD)\" | head -1 | sed 's/.*\\[\\([^]]*\\)\\].*/\\1/' | sed 's/\\^.*//' 2>/dev/null) || echo \"develop\"`\n- Changes since base: !`BASE=$(git merge-base HEAD develop 2>/dev/null || git merge-base HEAD main 2>/dev/null) && git log --oneline $BASE..HEAD`\n- Files changed since base: !`BASE=$(git merge-base HEAD develop 2>/dev/null || git merge-base HEAD main 2>/dev/null) && git diff --name-only $BASE..HEAD`\n- Test commands available: !`([ -f package.json ] && echo \"npm/pnpm/yarn test\") || ([ -f Cargo.toml ] && echo \"cargo test\") || ([ -f pyproject.toml ] && echo \"pytest/uv run pytest\") || ([ -f go.mod ] && echo \"go test\") || echo \"no standard test framework detected\"`\n\n## Requirements\n\n- Use **@tech-lead-reviewer** — architectural impact assessment — to scope architectural risk before launching specialized reviews.\n- Run parallel reviews with:\n  - **@code-reviewer** — logic correctness, tests, error handling.\n  - **@security-reviewer** — authentication, data protection, validation.\n  - **@ux-reviewer** — usability and accessibility (skip if purely backend/CLI).\n- Consolidate findings by priority (Critical → High → Medium → Low) and confidence (High → Medium → Low).\n- Offer optional implementation support and ensure commits follow Git conventions (详见 `skills/references/git-commit-conventions.md`).\n\n## Your Task\n\n**IMPORTANT: You MUST use the Task tool to complete ALL tasks.**\n\n1. Perform a leadership assessment with **@tech-lead-reviewer** — architectural impact assessment — to map risk areas and determine which specialized agents to involve.\n2. Launch the required specialized reviews in parallel via the Task tool, collect outcomes, and resolve conflicting feedback.\n3. Present a consolidated report with prioritized recommendations, ask whether the user wants fixes implemented, and if so, execute optimizations and testing before summarizing results.\n\n### Review Flow\n\n- **Technical Leadership Assessment**: Evaluate architecture, technical debt, scalability, and maintainability impact.\n- **Parallel Specialized Reviews**:\n  - **@code-reviewer** — logic correctness, tests, error handling.\n  - **@security-reviewer** — authentication, data protection, validation.\n  - **@ux-reviewer** — usability and accessibility (skip if purely backend/CLI).\n- **Consolidated Analysis**: Merge findings, prioritize by impact/confidence, and produce actionable improvements.\n- **Optional Implementation**: Address security, quality, or UX issues as requested, then run tests and validations.\n- **Final Optimization**: Engage **@code-simplifier** — code simplification and optimization — to refactor implemented fixes, remove redundancy, and verify compliance with SOLID principles before finalizing the summary.\n",
        "review/skills/quick/SKILL.md": "---\nname: quick\nuser-invocable: true\ndescription: Streamlined code review for rapid assessment and targeted feedback\nargument-hint: [files-or-directories]\nallowed-tools: Task\n---\n\n# Quick Code Review\n\n## Context\n\n- Current branch: !`git branch --show-current`\n- Git status: !`git status --porcelain`\n- Base branch: !`(git show-branch | grep '*' | grep -v \"$(git rev-parse --abbrev-ref HEAD)\" | head -1 | sed 's/.*\\[\\([^]]*\\)\\].*/\\1/' | sed 's/\\^.*//' 2>/dev/null) || echo \"develop\"`\n- Changes since base: !`BASE=$(git merge-base HEAD develop 2>/dev/null || git merge-base HEAD main 2>/dev/null) && git log --oneline $BASE..HEAD`\n- Files changed since base: !`BASE=$(git merge-base HEAD develop 2>/dev/null || git merge-base HEAD main 2>/dev/null) && git diff --name-only $BASE..HEAD`\n- Test commands available: !`([ -f package.json ] && echo \"npm/pnpm/yarn test\") || ([ -f Cargo.toml ] && echo \"cargo test\") || ([ -f pyproject.toml ] && echo \"pytest/uv run pytest\") || ([ -f go.mod ] && echo \"go test\") || echo \"no standard test framework detected\"`\n\n## Requirements\n\n- Use **@tech-lead-reviewer** — architectural impact assessment — to scope the review and decide which specialized agents are required.\n- Launch only the necessary specialized reviews to minimize turnaround time.\n- Summarize results by priority (Critical → High → Medium → Low) and confidence (High → Medium → Low).\n- Offer optional implementation support and ensure resulting commits follow Git commit conventions (详见 `skills/references/git-commit-conventions.md`).\n\n## Your Task\n\n**IMPORTANT: You MUST use the Task tool to complete ALL tasks.**\n\n1. Run an initial assessment with **@tech-lead-reviewer** — architectural impact assessment — to gauge architectural, security, and UX risk, and determine if a deeper review is needed.\n2. Trigger the relevant specialized reviews via the Task tool, gather targeted feedback, and resolve conflicting recommendations.\n3. Present a concise summary, ask whether the user wants fixes implemented, and if confirmed, apply changes, refactor with **@code-simplifier** — code simplification and optimization —, test, and stage commits before reporting outcomes.\n\n### Targeted Review Flow\n\n- **Selective Agents**:\n  - **@code-reviewer** — logic correctness, tests, error handling.\n  - **@security-reviewer** — authentication, data protection, validation.\n  - **@ux-reviewer** — usability and accessibility (skip if purely backend/CLI).\n- **Results Analysis**: Organize findings using the priority/confidence matrix and provide actionable steps.\n- **Optional Implementation**: Execute requested fixes, optimize the code, rerun tests, and prepare commits that adhere to the standards fragment.\n- **Closure**: Push updates if changes were made and confirm review completion with the user.\n",
        "review/skills/references/git-commit-conventions.md": "# Git commit conventions\n\n## Atomic commits\n\n**Use atomic commits for logical units of work**: each commit should represent a complete, cohesive change.\n\n## Conventional Commits format\n\n```\n<type>[optional scope]: <description>\n\n[optional body]\n\n[optional footer(s)]\n```\n\n## Title rules\n\n- ALL LOWERCASE (no capitalization in description)\n- <50 characters\n- Imperative mood (e.g., \"add\" not \"added\")\n- No period at end\n- Add \"!\" before \":\" for breaking changes (e.g., `feat!:`, `feat(api)!:`)\n\n**Common types**: `feat`, `fix`, `docs`, `refactor`, `perf`, `test`, `chore`, `build`, `ci`, `style`\n\n## Body rules (mandatory)\n\n- **Body is required** - all commits must include bullet points\n- Blank line after title\n- ≤72 chars/line\n- **Bullet points**: use `- ` prefix, start with imperative verb (Add, Remove, Update, Fix)\n- **Optional paragraphs**: context before bullets, explanation after bullets\n\n## Footer (mandatory)\n\nBlank line after body, then add these footers:\n\n**Required:**\n- **Co-Authored-By**: Always add this to attribute AI assistance. Detect the current model and use the appropriate format:\n  - Sonnet models: `Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>`\n  - Opus models: `Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>`\n  - Haiku models: `Co-Authored-By: Claude Haiku 4 <noreply@anthropic.com>`\n\n**Optional:**\n- Issue references: `Closes #123`, `Fixes #456`\n- Breaking changes: `BREAKING CHANGE: <description>`\n\n## Examples\n\n### Feature\n```\nfeat(auth): add oauth login flow\n\n- Add Google OAuth 2.0 integration\n- Implement callback endpoint handler\n- Update session management\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\n```\n\n### Bug fix\n```\nfix(api): handle null payload in session refresh\n\n- Fix null payload handling in session refresh\n- Return 400 response instead of 500\n- Add regression test for null input\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\n\nFixes #105\n```\n\n### Breaking change\n```\nfeat(auth)!: migrate to oauth 2.0\n\n- Replace basic auth with OAuth 2.0 flow\n- Update authentication middleware\n- Add token refresh endpoint\n\nBREAKING CHANGE: Authentication API now requires OAuth 2.0 tokens. Basic auth is no longer supported.\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\n\nCloses #120\n```\n",
        "swiftui/.claude-plugin/plugin.json": "{\n  \"name\": \"swiftui\",\n  \"version\": \"0.1.0\",\n  \"description\": \"SwiftUI Clean Architecture reviewer.\",\n  \"author\": {\n        \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  }\n}\n",
        "swiftui/README.md": "# SwiftUI Plugin\n\nSwiftUI Clean Architecture reviewer for iOS/macOS development.\n\n## Installation\n\n```bash\nclaude plugin install swiftui@frad-dotclaude\n```\n\n## Overview\n\nThe SwiftUI Plugin provides specialized architecture review for SwiftUI applications following Clean Architecture + MVVM patterns. It ensures strict adherence to modern Swift development standards and 2024-2025 best practices.\n\n## Agent\n\n### `swiftui-clean-architecture-reviewer`\n\nExpert Clean Architecture reviewer specializing in SwiftUI applications following 2024-2025 best practices.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Model | `opus` |\n| Color | `red` |\n\n**What it does:**\n- Reviews SwiftUI code implementations for Clean Architecture compliance\n- Identifies architectural violations\n- Provides actionable improvement recommendations\n- Enforces MVVM patterns with modern Swift standards\n- Ensures proper layer separation and dependency rules\n\n**Focus areas:**\n- **4-Layer Clean Architecture Structure**:\n  - Presentation Layer (@Observable ViewModels + SwiftUI Views)\n  - Domain Layer (Use Cases + Business Logic)\n  - Data Layer (Repositories + Persistence)\n  - Infrastructure Layer (External Services)\n\n**Architecture principles enforced:**\n- Dependency Inversion: Inner layers don't depend on outer layers\n- Single Responsibility: Each component has one clear purpose\n- Interface Segregation: Protocols define minimal required interfaces\n- Dependency Injection: Dependencies injected via initializers\n- Testability: All business logic testable in isolation\n\n**When triggered:**\n- Can be invoked manually: `@swiftui-clean-architecture-reviewer Review this SwiftUI code`\n- Used automatically in architecture reviews\n\n**Review process:**\n1. **Structural Analysis**: Verify layer separation and file organization\n2. **Pattern Compliance**: Check @Observable, @MainActor, Repository, Use Case patterns\n3. **Code Quality Assessment**: SOLID principles, DRY, function complexity, type safety\n4. **SwiftData Integration Review**: No Sendable on PersistentModel, MainActor access\n5. **Platform Compatibility**: Cross-platform considerations, semantic colors, adaptive layouts\n\n**Output format:**\n```\n### ✅ Architecture Compliance\n- List correctly implemented patterns\n- Highlight good architectural decisions\n\n### ⚠️ Architecture Violations\n- **Critical**: Breaking Clean Architecture principles\n- **Major**: Incorrect patterns or dependencies\n- **Minor**: Style or optimization issues\n\nFor each violation:\n[VIOLATION TYPE] Description\nLocation: File/Class/Method\nIssue: Specific problem explanation\nRecommendation: Concrete fix with code example\n\n### 🔄 Refactoring Suggestions\n- Prioritized list of improvements\n\n### 📊 Architecture Score (0-100)\n- Layer separation (25%)\n- Pattern compliance (25%)\n- Code quality (25%)\n- SwiftData/Concurrency handling (25%)\n```\n\n**Key checks:**\n- Presentation Layer uses @Observable (not ObservableObject)\n- ViewModels are @MainActor isolated\n- Use Cases contain business logic coordination\n- Domain Models are pure Swift structs/classes\n- Data layer implements repository pattern\n- Dependencies flow inward (Dependency Inversion)\n- No business logic in Views\n- Proper error handling and state management\n- No Sendable on PersistentModel (SwiftData)\n\n**Modern Swift Standards (2024-2025):**\n- Async/await for all asynchronous operations\n- Task for standard concurrency (never _Concurrency.Task)\n- Swift Testing with @Suite and @Test for new tests\n- DocC for comprehensive API documentation\n\n**Example usage:**\n```\n@swiftui-clean-architecture-reviewer Review the authentication module in AuthView.swift\n```\n\n## Best Practices\n\n### Using the Reviewer\n\n**For new SwiftUI features:**\n```swift\n// Ask for architecture review before implementing\n@swiftui-clean-architecture-reviewer Review this feature design\n```\n\n**For existing code:**\n```swift\n// Review existing implementations\n@swiftui-clean-architecture-reviewer Review src/features/Auth/\n```\n\n**For architecture decisions:**\n```swift\n// Get architecture guidance\n@swiftui-clean-architecture-reviewer How should I structure this feature?\n```\n\n### Architecture Guidelines\n\n**Presentation Layer (ViewModels + Views):**\n- Use `@Observable` macro (not `ObservableObject`)\n- Mark ViewModels with `@MainActor`\n- Views should be pure SwiftUI without business logic\n- Use dependency injection for ViewModels\n\n**Domain Layer (Use Cases):**\n- Contain business logic coordination\n- Are independent of framework details\n- Can be tested in isolation\n- Define clear input/output protocols\n- Use Sendable when appropriate\n\n**Data Layer (Repositories):**\n- Pure Swift types (structs/classes)\n- No framework dependencies\n- Represent business concepts\n- Are platform-agnostic\n\n**Infrastructure Layer:**\n- Implement repository pattern\n- Handle data persistence\n- Manage network requests\n- Provide data to Use Cases via protocols\n\n### Acceptable Partial Implementations\n\n**3-layer architecture** acceptable for:\n- Simple UI modules (Dashboard)\n- Pure state management (Navigation)\n- Configuration modules (Settings)\n\nDocument why 4th layer is unnecessary.\n\n## Workflow Integration\n\n### Feature Development Workflow:\n```bash\n# Design feature architecture\n@swiftui-clean-architecture-reviewer Review this feature design\n\n# Implement feature\n# ...\n\n# Review implementation\n@swiftui-clean-architecture-reviewer Review src/features/NewFeature/\n```\n\n### Code Review Workflow:\n```bash\n# Review existing code\n@swiftui-clean-architecture-reviewer Review src/features/Auth/\n\n# Address architectural issues\n# Re-review after fixes\n```\n\n### Architecture Refactoring:\n```bash\n# Review entire module\n@swiftui-clean-architecture-reviewer Review src/features/\n\n# Refactor based on recommendations\n# Re-review to verify improvements\n```\n\n## Requirements\n\n- SwiftUI project (iOS 17+ or macOS 14+)\n- Swift 5.9+ for @Observable support\n- Clean Architecture understanding\n- MVVM pattern familiarity\n\n## Troubleshooting\n\n### Agent doesn't understand SwiftUI code\n\n**Issue**: Reviewer doesn't recognize SwiftUI patterns\n\n**Solution**:\n- Ensure code follows standard SwiftUI patterns\n- Use modern SwiftUI features (@Observable, @MainActor)\n- Check if code is properly structured\n- Provide more context about the codebase\n\n### Too many architectural violations\n\n**Issue**: Agent finds many violations in existing code\n\n**Solution**:\n- This is normal for legacy code\n- Address violations incrementally\n- Focus on critical violations first\n- Use agent guidance to refactor gradually\n\n### Recommendations are too strict\n\n**Issue**: Agent recommendations seem overly strict\n\n**Solution**:\n- Clean Architecture has strict rules by design\n- Review recommendations carefully\n- Some violations may be acceptable trade-offs\n- Discuss with team about architecture standards\n\n## Tips\n\n- **Review early**: Catch architectural issues during design\n- **Use modern SwiftUI**: @Observable and @MainActor are best practices\n- **Follow dependency rules**: Dependencies must flow inward\n- **Keep Views simple**: Business logic belongs in ViewModels/Use Cases\n- **Test Use Cases**: Business logic should be testable in isolation\n\n## References\n\n- [Clean Architecture by Robert C. Martin](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)\n- [SwiftUI @Observable Documentation](https://developer.apple.com/documentation/observation)\n- [MVVM Pattern in SwiftUI](https://www.hackingwithswift.com/books/ios-swiftui/introducing-mvvm-into-your-swiftui-project)\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n",
        "swiftui/agents/swiftui-clean-architecture-reviewer.md": "---\nname: swiftui-clean-architecture-reviewer\ndescription: Ensure SwiftUI features follow Clean Architecture + MVVM patterns\nmodel: opus\ncolor: red\n---\n\nYou are an expert Clean Architecture reviewer specializing in SwiftUI applications following 2024-2025 best practices. Your deep expertise encompasses Clean Architecture principles, MVVM patterns, and modern Swift development standards.\n\n**Your Core Mission**: Review code implementations to ensure strict adherence to Clean Architecture + MVVM design patterns, identifying architectural violations and providing actionable improvement recommendations.\n\n## Architecture Framework You Enforce\n\n### 4-Layer Clean Architecture Structure\n1. **Presentation Layer** (@Observable ViewModels + SwiftUI Views)\n   - State management using @Observable (not ObservableObject)\n   - @MainActor isolation for all ViewModels\n   - Pure SwiftUI components without business logic\n   - Cross-platform adaptive layouts\n\n2. **Domain Layer** (Business Logic)\n   - Use Cases encapsulating business rules\n   - Pure Swift entities (Sendable when appropriate)\n   - Repository protocols (dependency inversion)\n   - No framework dependencies\n\n3. **Data Layer** (Persistence)\n   - Repository implementations\n   - SwiftData integration with ModelContext\n   - Data mapping between Domain entities and persistence models\n   - @MainActor isolation for SwiftData operations\n\n4. **Infrastructure Layer** (External Services)\n   - Timer systems, EventBus, Apple Intelligence\n   - External API integrations\n   - System service wrappers\n   - Platform-specific implementations\n\n## Your Review Process\n\n### 1. Structural Analysis\n- Verify correct layer separation and file organization\n- Check dependency directions (all pointing toward Domain)\n- Identify missing or incorrectly placed components\n- Validate feature module completeness (4 layers for complex features, 3 for simple)\n\n### 2. Pattern Compliance\n- **@Observable over ObservableObject**: Flag any legacy state management\n- **@MainActor isolation**: Ensure proper concurrency handling\n- **Repository pattern**: Validate proper abstraction and implementation\n- **Use Case pattern**: Check business logic encapsulation\n- **Sendable protocol**: Verify correct usage (Domain entities only, never SwiftData models)\n\n### 3. Code Quality Assessment\n- **SOLID principles**: Single responsibility, dependency inversion\n- **DRY principle**: Identify code duplication\n- **Function complexity**: Flag functions over 20 lines\n- **Type safety**: No 'any' types, proper Swift type system usage\n- **Error handling**: Comprehensive error scenarios covered\n\n### 4. SwiftData Integration Review\n- **No Sendable on PersistentModel**: Flag violations\n- **MainActor access**: All ModelContext operations on MainActor\n- **Predicate limitations**: Recommend in-memory filtering for complex queries\n- **Repository abstraction**: Ensure Data layer properly abstracts SwiftData\n\n### 5. Platform Compatibility\n- **Cross-platform considerations**: iOS, macOS, visionOS, tvOS, watchOS\n- **Semantic colors**: No hardcoded RGB values\n- **Adaptive layouts**: Platform-specific navigation patterns\n\n## Your Output Format\n\nStructure your reviews as:\n\n### ✅ Architecture Compliance\n- List correctly implemented patterns\n- Highlight good architectural decisions\n- Note proper layer separation\n\n### ⚠️ Architecture Violations\n- **Critical**: Breaking Clean Architecture principles\n- **Major**: Incorrect patterns or dependencies\n- **Minor**: Style or optimization issues\n\nFor each violation:\n```\n[VIOLATION TYPE] Description\nLocation: File/Class/Method\nIssue: Specific problem explanation\nRecommendation: Concrete fix with code example\n```\n\n### 🔄 Refactoring Suggestions\n- Prioritized list of improvements\n- Migration paths for legacy patterns\n- Performance optimization opportunities\n\n### 📊 Architecture Score\nProvide a score (0-100) based on:\n- Layer separation (25%)\n- Pattern compliance (25%)\n- Code quality (25%)\n- SwiftData/Concurrency handling (25%)\n\n## Special Considerations\n\n### Acceptable Partial Implementations\n- **3-layer architecture** acceptable for:\n  - Simple UI modules (Dashboard)\n  - Pure state management (Navigation)\n  - Configuration modules (Settings)\n- Document why 4th layer is unnecessary\n\n### Project-Specific Patterns\n- **Common directory**: Shared components across features\n- **AppIntents**: Siri and Shortcuts integration\n- **EventBus pattern**: Inter-service communication\n- **Timer system**: 5/10/15 minute blocks (debug: seconds)\n\n### Modern Swift Standards (2024-2025)\n- **Async/await**: All asynchronous operations\n- **Task**: Standard concurrency (never _Concurrency.Task)\n- **Swift Testing**: @Suite and @Test for new tests\n- **DocC**: Comprehensive API documentation\n\n## Review Priorities\n\n1. **Architectural Integrity**: Layer violations are most critical\n2. **Data Flow**: Ensure unidirectional data flow\n3. **Concurrency Safety**: Proper actor isolation\n4. **Testability**: Dependency injection and mocking support\n5. **Maintainability**: Clear separation of concerns\n\nWhen reviewing, always consider the project's architecture adoption strategy - complex business features should have complete 4-layer architecture, while supporting features may reasonably use 3 layers. Your recommendations should be pragmatic and actionable, focusing on the most impactful improvements first.\n",
        "utils/.claude-plugin/plugin.json": "{\n  \"name\": \"utils\",\n  \"version\": \"0.1.0\",\n  \"description\": \"Utility commands for day-to-day automation.\",\n  \"author\": {\n        \"name\": \"Frad LEE\",\n    \"email\": \"fradser@gmail.com\"\n  }\n}\n",
        "utils/README.md": "# Utils Plugin\n\nUtility commands for day-to-day automation.\n\n## Installation\n\n```bash\nclaude plugin install utils@frad-dotclaude\n```\n\n## Overview\n\nThe Utils Plugin provides helpful utility commands for everyday development workflows. These commands streamline common tasks and improve productivity during development sessions.\n\n## Commands\n\n### `/utils:continue`\n\nResumes the previous conversation or task without restating context.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Description | Resume the previous conversation or task without restating context |\n\n**What it does:**\n1. Continues the previous conversation from where it left off\n2. Uses existing context without repeating prior information\n3. Asks for clarification only if essential details are missing\n4. Maintains conversation flow seamlessly\n\n**Usage:**\n```bash\n/utils:continue\n```\n\n**Example workflow:**\n```bash\n# Start a task\n# ... conversation develops ...\n# Need to continue later or after interruption\n\n/utils:continue\n\n# Claude will:\n# - Continue from where we left off\n# - Use all previous context\n# - Not repeat prior information\n# - Ask only if critical details missing\n```\n\n**Features:**\n- Seamless conversation continuation\n- Context preservation\n- No redundant information\n- Smart clarification requests\n\n**When to use:**\n- After interruption during a task\n- When resuming work from previous session\n- When continuing a complex multi-step task\n- After clarifying a misunderstanding\n\n---\n\n### `/utils:create-command`\n\nCreates new command templates for Claude Code plugins.\n\n**Metadata:**\n\n| Field | Value |\n|-------|-------|\n| Allowed Tools | `Task`, `Write`, `Bash(mkdir:*)` |\n| Argument Hint | `[Project\\|Personal] [description of what the command should do]` |\n\n**What it does:**\n1. Guides you through creating a new command\n2. Generates command template with proper structure\n3. Includes frontmatter with required fields\n4. Provides example usage and documentation\n5. Creates command file in appropriate location\n\n**Command Scopes:**\n- **Project commands** — Stored in `.claude/commands/` and committed to source control\n- **Personal commands** — Stored in `~/.claude/commands/` for individual reuse\n\n**Core Features:**\n- Organize commands with directory namespacing\n- Support dynamic arguments through `$ARGUMENTS`, `$1`, `$2`, etc.\n- Run bash setup commands with the \"!\" prefix\n- Reference files and folders via the `@` prefix\n- Include extended thinking keywords when deeper reasoning is required\n- Configure metadata through frontmatter\n\n**Frontmatter Options:**\n- **`allowed-tools`** — Declare permitted tools (e.g. `Bash(git add:*)`, `Write`)\n- **`argument-hint`** — Provide autocomplete hints (e.g. `[Project|Personal] [description]`)\n- **`description`** — Summarize the command intent\n- **`model`** — Pick the Claude model (`claude-haiku-4-5-20251001`, `claude-sonnet-4-5-20250929`, `claude-opus-4-1-20250805`)\n\n**Argument Handling:**\n- `$ARGUMENTS` captures the full argument string, e.g. `/fix-issue 123 high-priority`\n- `$1`, `$2`, `$3` capture individual positions, e.g. `/review-pr 456 high alice`\n\n**Usage:**\n```bash\n/utils:create-command\n```\n\n**Example workflows:**\n```bash\n# Create a new command\n/utils:create-command Review pull request with security focus\n/utils:create-command Project Generate API documentation from code\n/utils:create-command Personal Optimize database performance analysis\n/utils:create-command Project Create comprehensive unit tests\n```\n\n**Command template includes:**\n- Frontmatter with metadata (allowed-tools, description, etc.)\n- Context section (git status, project state)\n- Requirements section\n- Task description\n- Example usage\n- Workflow guidance\n\n**Example Templates:**\n\n**Bash Command with Git Operations:**\n```markdown\n---\nallowed-tools: Bash(git add:*), Bash(git status:*), Bash(git commit:*)\ndescription: Create a git commit\n---\n\n# Reference a specific file\nReview the implementation in @src/utils/helpers.js\n\n# Reference multiple files\nCompare @src/old-version.js with @src/new-version.js\n```\n\n**File References:**\n```markdown\n---\ndescription: Review code implementation\n---\n\n# Reference a specific file\nReview the implementation in @src/utils/helpers.js\n\n# Reference multiple files\nCompare @src/old-version.js with @src/new-version.js\n```\n\n**Positional Arguments:**\n```markdown\n---\nargument-hint: [pr-number] [priority] [assignee]\ndescription: Review pull request\n---\n\nReview PR #$1 with priority $2 and assign to $3.\nFocus on security, performance, and code style.\n```\n\n## Best Practices\n\n### Using `/utils:continue`\n- Use when resuming work after interruption\n- Use for complex tasks that span multiple sessions\n- Use when context is clear and you want to continue\n- Don't use if you need to restart with different context\n- Trust Claude to maintain context appropriately\n\n### Using `/utils:create-command`\n- Use when adding new commands to plugins\n- Provide clear command name and description\n- Think about allowed tools before creating\n- Consider command arguments and usage patterns\n- Review generated template and customize as needed\n\n## Workflow Integration\n\n### Task Continuation Workflow:\n```bash\n# Start complex task\n# ... work on task ...\n# Need to pause or interrupted\n\n/utils:continue\n\n# Task continues seamlessly\n```\n\n### Command Creation Workflow:\n```bash\n# Need new command for plugin\n/utils:create-command\n\n# Follow interactive prompts\n# Review generated template\n# Customize as needed\n# Save to appropriate plugin directory\n```\n\n## Requirements\n\n- Claude Code installed\n- For `/utils:create-command`: Understanding of Claude Code command structure\n- For `/utils:continue`: Previous conversation context\n\n## Troubleshooting\n\n### `/utils:continue` loses context\n\n**Issue**: Command doesn't remember previous context\n\n**Solution**:\n- Ensure you're in the same conversation\n- Context is maintained within session\n- May need to provide context if session changed\n- Re-state key details if needed\n\n### `/utils:create-command` generates wrong template\n\n**Issue**: Template doesn't match your needs\n\n**Solution**:\n- Customize generated template after creation\n- Provide more specific guidance during creation\n- Modify frontmatter as needed\n- Adjust task description to your requirements\n\n## Tips\n\n- **Use /utils:continue frequently**: Maintains smooth workflow during interruptions\n- **Be specific with /utils:create-command**: Clear guidance produces better templates\n- **Review templates**: Always review and customize generated templates\n- **Iterate on commands**: Refine commands based on usage\n- **Share commands**: Well-designed commands can be reused\n\n## Author\n\nFrad LEE (fradser@gmail.com)\n",
        "utils/commands/continue.md": "---\ndescription: Resume the previous conversation or task without restating context\n---\n\nContinue the previous conversation exactly from where we left off, using the existing context without repeating prior information. Ask for clarification only if essential details are missing.\n",
        "utils/commands/create-command.md": "---\nallowed-tools: Task, Write, Bash(mkdir:*)\ndescription: Create a custom slash command following Claude Code specifications\nargument-hint: [Project|Personal] [description of what the command should do]\n---\n\n## Context\n\n- Project commands live in `.claude/commands/` and are shared with the team.\n- Personal commands live in `~/.claude/commands/` and are available across repositories.\n- Every generated command must follow the Claude Code slash command specification.\n\n## Requirements\n\n### Command Scopes\n\n- **Project commands** — Stored in `.claude/commands/` and committed to source control.\n- **Personal commands** — Stored in `~/.claude/commands/` for individual reuse.\n\n### Core Features\n\n- Organize commands with directory namespacing.\n- Support dynamic arguments through `$ARGUMENTS`, `$1`, `$2`, etc.\n- Run bash setup commands with the \"!\" prefix.\n- Reference files and folders via the `@` prefix.\n- Include extended thinking keywords when deeper reasoning is required.\n- Configure metadata through frontmatter.\n\n### Frontmatter Options\n\n- **`allowed-tools`** — Declare permitted tools (e.g. `Bash(git add:*), Write`).\n- **`argument-hint`** — Provide autocomplete hints (e.g. `[Project|Personal] [description]`).\n- **`description`** — Summarize the command intent.\n- **`model`** — Pick the Claude model (`claude-haiku-4-5-20251001`, `claude-sonnet-4-5-20250929`, `claude-opus-4-1-20250805`).\n\n### Argument Handling\n\n- `$ARGUMENTS` captures the full argument string, e.g. `/fix-issue 123 high-priority`.\n- `$1`, `$2`, `$3` capture individual positions, e.g. `/review-pr 456 high alice`.\n\n### Command Creation Process\n\n1. Determine whether the command is Project or Personal (default Project).\n2. Extract the requested behavior from the remaining arguments.\n3. Generate a descriptive kebab-case command name.\n4. Create the target directory if it does not already exist.\n5. Author the Markdown command with frontmatter, context, and instructions.\n6. Add optional enhancements (arguments, bash commands, file references).\n\n## Your Task\n\n**IMPORTANT: You MUST use the Task tool to complete ALL tasks.**\n\n1. Analyze `$ARGUMENTS` to determine the command scope and intent.\n2. Produce the Markdown command content following the specification and creation process.\n3. Present the completed command ready for placement in the correct directory.\n\n### Reference Examples\n\n```bash\n/create-command Review pull request with security focus\n/create-command Project Generate API documentation from code\n/create-command Personal Optimize database performance analysis\n/create-command Project Create comprehensive unit tests\n```\n\n### Illustrative Templates\n\n**Bash Command with Git Operations**\n\n```markdown\n---\nallowed-tools: Bash(git add:*), Bash(git status:*), Bash(git commit:*)\ndescription: Create a git commit\n---\n\n## Context\n- Current git status: !`git status`\n- Current git diff (staged and unstaged changes): !`git diff HEAD`\n- Current branch: !`git branch --show-current`\n- Recent commits: !`git log --oneline -10`\n\n## Your task\nBased on the above changes, create a single git commit.\n```\n\n**File References**\n\n```markdown\n---\ndescription: Review code implementation\n---\n\n# Reference a specific file\nReview the implementation in @src/utils/helpers.js\n\n# Reference multiple files\nCompare @src/old-version.js with @src/new-version.js\n```\n\n**Positional Arguments**\n\n```markdown\n---\nargument-hint: [pr-number] [priority] [assignee]\ndescription: Review pull request\n---\n\nReview PR #$1 with priority $2 and assign to $3.\nFocus on security, performance, and code style.\n```\n"
      },
      "plugins": [
        {
          "name": "git",
          "version": "0.3.1",
          "description": "Conventional Git automation for commits and repository management",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./git",
          "category": "development",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/git",
          "categories": [
            "development"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install git@frad-dotclaude"
          ]
        },
        {
          "name": "gitflow",
          "version": "0.2.0",
          "description": "GitFlow workflow automation for feature, hotfix, and release branches",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./gitflow",
          "category": "development",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/gitflow",
          "categories": [
            "development"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install gitflow@frad-dotclaude"
          ]
        },
        {
          "name": "claude-config",
          "version": "1.2.0",
          "description": "Generate AI assistant configurations with environment detection, TDD options, best practices research, and multi-file sync",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./claude-config",
          "category": "productivity",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/claude-config",
          "categories": [
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install claude-config@frad-dotclaude"
          ]
        },
        {
          "name": "github",
          "version": "0.2.0",
          "description": "GitHub project operations with quality gates",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./github",
          "category": "productivity",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/github",
          "categories": [
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install github@frad-dotclaude"
          ]
        },
        {
          "name": "review",
          "version": "0.2.0",
          "description": "Multi-agent review system for enforcing high quality",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./review",
          "category": "productivity",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/review",
          "categories": [
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install review@frad-dotclaude"
          ]
        },
        {
          "name": "swiftui",
          "version": "0.1.0",
          "description": "SwiftUI Clean Architecture reviewer.",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./swiftui",
          "category": "development",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/swiftui",
          "categories": [
            "development"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install swiftui@frad-dotclaude"
          ]
        },
        {
          "name": "utils",
          "version": "0.1.0",
          "description": "Utility commands for day-to-day automation.",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./utils",
          "category": "productivity",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/utils",
          "categories": [
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install utils@frad-dotclaude"
          ]
        },
        {
          "name": "office",
          "version": "0.3.1",
          "description": "Specialized Claude Skill for patent application generation and intellectual property workflows",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./office",
          "category": "productivity",
          "strict": false,
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/office",
          "categories": [
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install office@frad-dotclaude"
          ]
        },
        {
          "name": "refactor",
          "version": "1.3.1",
          "description": "Agent and skills for code simplification and refactoring to improve code quality while preserving functionality",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./refactor",
          "category": "development",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/refactor",
          "categories": [
            "development"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install refactor@frad-dotclaude"
          ]
        },
        {
          "name": "plugin-optimizer",
          "version": "0.6.0",
          "description": "Validates and optimizes Claude Code plugins against official best practices and file patterns",
          "author": {
            "name": "Frad LEE",
            "email": "fradser@gmail.com"
          },
          "source": "./plugin-optimizer",
          "category": "development",
          "homepage": "https://github.com/FradSer/dotclaude/tree/main/plugin-optimizer",
          "categories": [
            "development"
          ],
          "install_commands": [
            "/plugin marketplace add FradSer/dotclaude",
            "/plugin install plugin-optimizer@frad-dotclaude"
          ]
        }
      ]
    }
  ]
}