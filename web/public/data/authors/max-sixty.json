{
  "author": {
    "id": "max-sixty",
    "display_name": "Maximilian Roos",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/5635139?u=6f1102d28e4e15c49584cea2596a75eea0eb8bc3&v=4",
    "url": "https://github.com/max-sixty",
    "bio": "Developer of worktrunk, prql, xarray & insta.\r\n\r\nAlso pytest-accept and numbagg.\r\n\r\n\r\nYou can give me feedback at feedback.maxroos.com",
    "stats": {
      "total_marketplaces": 2,
      "total_plugins": 2,
      "total_commands": 0,
      "total_skills": 2,
      "total_stars": 1658,
      "total_forks": 58
    }
  },
  "marketplaces": [
    {
      "name": "worktrunk",
      "version": null,
      "description": "Configuration guidance skills for Worktrunk git worktree workflow tool",
      "owner_info": {
        "name": "Worktrunk",
        "email": "m@maxroos.com"
      },
      "keywords": [],
      "repo_full_name": "max-sixty/worktrunk",
      "repo_url": "https://github.com/max-sixty/worktrunk",
      "repo_description": "Worktrunk is a CLI for Git worktree management, designed for parallel AI agent workflows",
      "homepage": "https://worktrunk.dev",
      "signals": {
        "stars": 1633,
        "forks": 56,
        "pushed_at": "2026-01-29T23:06:26Z",
        "created_at": "2025-10-17T22:13:14Z",
        "license": "NOASSERTION"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/CLAUDE.md",
          "type": "blob",
          "size": 1972
        },
        {
          "path": ".claude-plugin/README.md",
          "type": "blob",
          "size": 1280
        },
        {
          "path": ".claude-plugin/hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/hooks/hooks.json",
          "type": "blob",
          "size": 647
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 1026
        },
        {
          "path": ".claude-plugin/plugin.json",
          "type": "blob",
          "size": 782
        },
        {
          "path": ".claude-plugin/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/skills/worktrunk",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/skills/worktrunk/SKILL.md",
          "type": "blob",
          "size": 9197
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/README.md",
          "type": "blob",
          "size": 21
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/claude-code.md",
          "type": "blob",
          "size": 3569
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/config.md",
          "type": "blob",
          "size": 23183
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/faq.md",
          "type": "blob",
          "size": 10700
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/hook.md",
          "type": "blob",
          "size": 17010
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/list.md",
          "type": "blob",
          "size": 15003
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/llm-commits.md",
          "type": "blob",
          "size": 4248
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/merge.md",
          "type": "blob",
          "size": 4705
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/remove.md",
          "type": "blob",
          "size": 4122
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/select.md",
          "type": "blob",
          "size": 2187
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/shell-integration.md",
          "type": "blob",
          "size": 6335
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/step.md",
          "type": "blob",
          "size": 13624
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/switch.md",
          "type": "blob",
          "size": 7409
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/tips-patterns.md",
          "type": "blob",
          "size": 11420
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/troubleshooting.md",
          "type": "blob",
          "size": 3321
        },
        {
          "path": ".claude-plugin/skills/worktrunk/reference/worktrunk.md",
          "type": "blob",
          "size": 7998
        }
      ],
      "files": {
        ".claude-plugin/CLAUDE.md": "# Claude Code Plugin Guidelines\n\n## Skills Directory Location\n\n**Working solution**: Using `source: \"./.claude-plugin\"` in `marketplace.json` allows skills to remain in `.claude-plugin/skills/` ‚úÖ\n\nConfiguration in `marketplace.json`:\n```json\n{\n  \"source\": \"./.claude-plugin\",\n  \"skills\": [\"./skills/worktrunk\"]\n}\n```\n\nConfiguration in `plugin.json`:\n```json\n{\n  \"hooks\": \"./hooks/hooks.json\",\n  \"skills\": [\"./skills/worktrunk\"]\n}\n```\n\n**Path resolution**:\n- Source base: `./.claude-plugin`\n- Skills: `./.claude-plugin + ./skills/worktrunk = ./.claude-plugin/skills/worktrunk` ‚úÖ\n- Hooks: `./.claude-plugin + ./hooks/hooks.json = ./.claude-plugin/hooks/hooks.json` ‚úÖ\n\nThis approach keeps all Claude Code components organized together in `.claude-plugin/` and avoids root directory clutter.\n\n**Note**: The official Claude Code documentation states \"All other directories (commands/, agents/, skills/, hooks/) must be at the plugin root\" but using the `source` field to point to `./.claude-plugin` makes paths relative to that directory, allowing this organizational structure.\n\n**Why this works**: The `source` field in `marketplace.json` changes the base directory for path resolution. When `source: \"./\"` (the default), skills paths are resolved from the plugin root. When `source: \"./.claude-plugin\"`, skills paths are resolved from `.claude-plugin/`, allowing the entire plugin to be self-contained in one directory.\n\n## Known Limitations\n\n### Status persists after user interrupt\n\nThe hooks track Claude Code activity via git config (`worktrunk.status.{branch}`):\n- `UserPromptSubmit` ‚Üí ü§ñ (working)\n- `Notification` ‚Üí üí¨ (waiting for input)\n- `SessionEnd` ‚Üí clears status\n\n**Problem**: If the user interrupts Claude Code (Escape/Ctrl+C), the ü§ñ status persists because there's no `UserInterrupt` hook. The `Stop` hook explicitly does not fire on user interrupt.\n\n**Tracking**: [claude-code#9516](https://github.com/anthropics/claude-code/issues/9516)\n",
        ".claude-plugin/README.md": "# Worktrunk Plugin for Claude Code\n\nGit worktree management CLI integration with activity tracking.\n\n## Features\n\n1. **Configuration skill** ‚Äî Guides LLM-powered commit message setup, project hooks (post-create, pre-merge), and worktree path customization\n2. **Activity tracking** ‚Äî Shows which branches have active Claude sessions via indicators in `wt list`\n\n## Examples\n\n**Activity tracking across worktrees**\n\nThe plugin installs Claude Code hooks that track session activity per branch. When a prompt is submitted, the hook sets ü§ñ on that branch. When Claude finishes and waits for input, it switches to üí¨. When the session ends, the marker clears.\n\nThese markers appear in `wt list` output, making it easy to see which worktrees have active Claude sessions ‚Äî useful when running multiple instances in parallel.\n\n**Set up LLM commit message generation**\n\nThe configuration skill guides through configuring an AI tool (Claude Code, Codex, llm, or aichat) and adding `[commit.generation]` to the user config so `wt merge` can auto-generate commit messages.\n\n**Add post-create hooks to run npm install automatically**\n\nThe skill configures `.config/wt.toml` with project hooks. Post-create hooks run when creating worktrees, pre-merge hooks validate before merging.\n",
        ".claude-plugin/hooks/hooks.json": "{\n  \"hooks\": {\n    \"UserPromptSubmit\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"wt config state marker set ü§ñ || true\"\n          }\n        ]\n      }\n    ],\n    \"Notification\": [\n      {\n        \"matcher\": \"\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"wt config state marker set üí¨ || true\"\n          }\n        ]\n      }\n    ],\n    \"SessionEnd\": [\n      {\n        \"matcher\": \"\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"wt config state marker clear || true\"\n          }\n        ]\n      }\n    ]\n  }\n}\n",
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"worktrunk\",\n  \"owner\": {\n    \"name\": \"Worktrunk\",\n    \"email\": \"m@maxroos.com\"\n  },\n  \"metadata\": {\n    \"description\": \"Configuration guidance skills for Worktrunk git worktree workflow tool\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"worktrunk\",\n      \"description\": \"Worktrunk is a git worktree management CLI that streamlines multi-branch development. This plugin provides Claude Code integration with two features: (1) A configuration skill guiding you through LLM-powered commit message generation, project automation hooks (post-create, pre-merge), and worktree path customization. (2) Automatic activity tracking that displays ü§ñ (working) and üí¨ (waiting) indicators in `wt list`, showing which branches have active Claude sessions. Use when setting up Worktrunk configuration, automating project workflows, or monitoring AI activity across branches.\",\n      \"source\": \"./.claude-plugin\",\n      \"strict\": false,\n      \"skills\": [\n        \"./skills/worktrunk\"\n      ]\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"worktrunk\",\n  \"description\": \"Worktrunk is a git worktree management CLI that streamlines multi-branch development. This plugin provides Claude Code integration with two features: (1) A configuration skill guiding you through LLM-powered commit message generation, project automation hooks (post-create, pre-merge), and worktree path customization. (2) Automatic activity tracking that displays ü§ñ (working) and üí¨ (waiting) indicators in `wt list`, showing which branches have active Claude sessions. Use when setting up Worktrunk configuration, automating project workflows, or monitoring AI activity across branches.\",\n  \"version\": \"1.0.0\",\n  \"author\": {\n    \"name\": \"Worktrunk\"\n  },\n  \"hooks\": \"./hooks/hooks.json\",\n  \"skills\": [\n    \"./skills/worktrunk\"\n  ]\n}\n",
        ".claude-plugin/skills/worktrunk/SKILL.md": "---\nname: worktrunk\ndescription: Guidance for Worktrunk, a CLI tool for managing git worktrees. Covers configuration (user config at ~/.config/worktrunk/config.toml and project hooks at .config/wt.toml), usage, and troubleshooting. Use for \"setting up commit message generation\", \"configuring hooks\", \"automating tasks\", or general worktrunk questions.\n---\n\n<!-- worktrunk-skill-version: 0.9.3 -->\n\n# Worktrunk\n\nHelp users work with Worktrunk, a CLI tool for managing git worktrees.\n\n## Available Documentation\n\nReference files are synced from [worktrunk.dev](https://worktrunk.dev) documentation:\n\n- **reference/config.md**: User and project configuration (LLM, hooks, command defaults)\n- **reference/hook.md**: Hook types, timing, and execution order\n- **reference/switch.md**, **merge.md**, **list.md**, etc.: Command documentation\n- **reference/llm-commits.md**: LLM commit message generation\n- **reference/tips-patterns.md**: Language-specific tips and patterns\n- **reference/shell-integration.md**: Shell integration debugging\n- **reference/troubleshooting.md**: Troubleshooting for LLM and hooks (Claude-specific)\n\nFor command-specific options, run `wt <command> --help`. For configuration, follow the workflows below.\n\n## Two Types of Configuration\n\nWorktrunk uses two separate config files with different scopes and behaviors:\n\n### User Config (`~/.config/worktrunk/config.toml`)\n- **Scope**: Personal preferences for the individual developer\n- **Location**: `~/.config/worktrunk/config.toml` (never checked into git)\n- **Contains**: LLM integration, worktree path templates, command settings, user hooks, approved commands\n- **Permission model**: Always propose changes and get consent before editing\n- **See**: `reference/config.md` for detailed guidance\n\n### Project Config (`.config/wt.toml`)\n- **Scope**: Team-wide automation shared by all developers\n- **Location**: `<repo>/.config/wt.toml` (checked into git)\n- **Contains**: Hooks for worktree lifecycle (post-create, pre-merge, etc.)\n- **Permission model**: Proactive (create directly, changes are reversible via git)\n- **See**: `reference/hook.md` for detailed guidance\n\n## Determining Which Config to Use\n\nWhen a user asks for configuration help, determine which type based on:\n\n**User config indicators**:\n- \"set up LLM\" or \"configure commit generation\"\n- \"change where worktrees are created\"\n- \"customize commit message templates\"\n- Affects only their environment\n\n**Project config indicators**:\n- \"set up hooks for this project\"\n- \"automate npm install\"\n- \"run tests before merge\"\n- Affects the entire team\n\n**Both configs may be needed**: For example, setting up commit message generation requires user config, but automating quality checks requires project config.\n\n## Core Workflows\n\n### Setting Up Commit Message Generation (User Config)\n\nMost common request. See `reference/llm-commits.md` for supported tools and exact command syntax.\n\n1. **Detect available tools**\n   ```bash\n   which claude codex llm aichat 2>/dev/null\n   ```\n\n2. **If none installed, recommend Claude Code** (already available in Claude Code sessions)\n\n3. **Propose config change** ‚Äî Get the exact command from `reference/llm-commits.md`\n   ```toml\n   [commit.generation]\n   command = \"...\"  # see reference/llm-commits.md for tool-specific commands\n   ```\n   Ask: \"Should I add this to your config?\"\n\n4. **After approval, apply**\n   - Check if config exists: `wt config show`\n   - If not, guide through `wt config create`\n   - Read, modify, write preserving structure\n\n5. **Suggest testing**\n   ```bash\n   wt step commit --show-prompt | head  # verify prompt builds\n   wt merge  # in a repo with uncommitted changes\n   ```\n\n### Setting Up Project Hooks (Project Config)\n\nCommon request for workflow automation. Follow discovery process:\n\n1. **Detect project type**\n   ```bash\n   ls package.json Cargo.toml pyproject.toml\n   ```\n\n2. **Identify available commands**\n   - For npm: Read `package.json` scripts\n   - For Rust: Common cargo commands\n   - For Python: Check pyproject.toml\n\n3. **Design appropriate hooks** (7 hook types available)\n   - Dependencies (fast, must complete) ‚Üí `post-create`\n   - Tests/linting (must pass) ‚Üí `pre-commit` or `pre-merge`\n   - Long builds, dev servers ‚Üí `post-start`\n   - Terminal/IDE updates ‚Üí `post-switch`\n   - Deployment ‚Üí `post-merge`\n   - Cleanup tasks ‚Üí `pre-remove`\n\n4. **Validate commands work**\n   ```bash\n   npm run lint  # verify exists\n   which cargo   # verify tool exists\n   ```\n\n5. **Create `.config/wt.toml`**\n   ```toml\n   # Install dependencies when creating worktrees\n   post-create = \"npm install\"\n\n   # Validate code quality before committing\n   [pre-commit]\n   lint = \"npm run lint\"\n   typecheck = \"npm run typecheck\"\n\n   # Run tests before merging\n   pre-merge = \"npm test\"\n   ```\n\n6. **Add comments explaining choices**\n\n7. **Suggest testing**\n   ```bash\n   wt switch --create test-hooks\n   ```\n\n**See `reference/hook.md` for complete details.**\n\n### Adding Hooks to Existing Config\n\nWhen users want to add automation to an existing project:\n\n1. **Read existing config**: `cat .config/wt.toml`\n\n2. **Determine hook type** - When should this run?\n   - Creating worktree (blocking) ‚Üí `post-create`\n   - Creating worktree (background) ‚Üí `post-start`\n   - Every switch ‚Üí `post-switch`\n   - Before committing ‚Üí `pre-commit`\n   - Before merging ‚Üí `pre-merge`\n   - After merging ‚Üí `post-merge`\n   - Before removal ‚Üí `pre-remove`\n\n3. **Handle format conversion if needed**\n\n   Single command to named table:\n   ```toml\n   # Before\n   post-create = \"npm install\"\n\n   # After (adding db:migrate)\n   [post-create]\n   install = \"npm install\"\n   migrate = \"npm run db:migrate\"\n   ```\n\n4. **Preserve existing structure and comments**\n\n### Validation Before Adding Commands\n\nBefore adding hooks, validate:\n\n```bash\n# Verify command exists\nwhich npm\nwhich cargo\n\n# For npm, verify script exists\nnpm run lint --dry-run\n\n# For shell commands, check syntax\nbash -n -c \"if [ true ]; then echo ok; fi\"\n```\n\n**Dangerous patterns** ‚Äî Warn users before creating hooks with:\n- Destructive commands: `rm -rf`, `DROP TABLE`\n- External dependencies: `curl http://...`\n- Privilege escalation: `sudo`\n\n## Permission Models\n\n### User Config: Conservative\n- **Never edit without consent** - Always show proposed change and wait for approval\n- **Never install tools** - Provide commands for users to run themselves\n- **Preserve structure** - Keep existing comments and organization\n- **Validate first** - Ensure TOML is valid before writing\n\n### Project Config: Proactive\n- **Create directly** - Changes are versioned, easily reversible\n- **Validate commands** - Check commands exist before adding\n- **Explain choices** - Add comments documenting why hooks exist\n- **Warn on danger** - Flag destructive operations before adding\n\n## Common Tasks Reference\n\n### User Config Tasks\n- Set up commit message generation ‚Üí `reference/llm-commits.md`\n- Customize worktree paths ‚Üí `reference/config.md#worktree-path-template`\n- Custom commit templates ‚Üí `reference/llm-commits.md#templates`\n- Configure command defaults ‚Üí `reference/config.md#command-settings`\n- Set up personal hooks ‚Üí `reference/config.md#user-hooks`\n\n### Project Config Tasks\n- Set up hooks for new project ‚Üí `reference/hook.md`\n- Add hook to existing config ‚Üí `reference/hook.md#configuration`\n- Use template variables ‚Üí `reference/hook.md#template-variables`\n- Add dev server URL to list ‚Üí `reference/config.md#dev-server-url`\n\n## Key Commands\n\n```bash\n# View all configuration\nwt config show\n\n# Create initial user config\nwt config create\n\n# LLM setup guide\nwt config --help\n```\n\n## Loading Additional Documentation\n\nLoad **reference files** for detailed configuration, hook specifications, and troubleshooting.\n\nFind specific sections with grep:\n```bash\ngrep -A 20 \"## Setup\" reference/llm-commits.md\ngrep -A 30 \"### post-create\" reference/hook.md\ngrep -A 20 \"## Warning Messages\" reference/shell-integration.md\n```\n\n## Advanced: Agent Handoffs\n\nWhen the user requests spawning a worktree with Claude in a background session (\"spawn a worktree for...\", \"hand off to another agent\"), use the appropriate pattern for their terminal multiplexer:\n\n**tmux** (check `$TMUX` env var):\n```bash\ntmux new-session -d -s <branch-name> \"wt switch --create <branch-name> -x claude -- '<task description>'\"\n```\n\n**Zellij** (check `$ZELLIJ` env var):\n```bash\nzellij run -- wt switch --create <branch-name> -x claude -- '<task description>'\n```\n\n**Requirements** (all must be true):\n- User explicitly requests spawning/handoff\n- User is in a supported multiplexer (tmux or Zellij)\n- User's CLAUDE.md or explicit instruction authorizes this pattern\n\n**Do not use this pattern** for normal worktree operations.\n\nExample (tmux):\n```bash\ntmux new-session -d -s fix-auth-bug \"wt switch --create fix-auth-bug -x claude -- \\\n  'The login session expires after 5 minutes. Find the session timeout config and extend it to 24 hours.'\"\n```\n\nExample (Zellij):\n```bash\nzellij run -- wt switch --create fix-auth-bug -x claude -- \\\n  'The login session expires after 5 minutes. Find the session timeout config and extend it to 24 hours.'\n```\n",
        ".claude-plugin/skills/worktrunk/reference/README.md": "../../../../README.md",
        ".claude-plugin/skills/worktrunk/reference/claude-code.md": "# Claude Code Integration\n\nThe worktrunk Claude Code plugin provides two features:\n\n1. **Configuration skill** ‚Äî Documentation Claude Code can read, so it can help set up LLM commits, hooks, and troubleshoot issues\n2. **Activity tracking** ‚Äî Status markers in `wt list` showing which worktrees have active Claude sessions (ü§ñ working, üí¨ waiting)\n\n## Installation\n\n```bash\n$ claude plugin marketplace add max-sixty/worktrunk\n$ claude plugin install worktrunk@worktrunk\n```\n\n## Configuration skill\n\nThe plugin includes a skill ‚Äî documentation that Claude Code can read ‚Äî covering worktrunk's configuration system. After installation, Claude Code can help with:\n\n- Setting up LLM-generated commit messages\n- Adding project hooks (post-create, pre-merge, pre-commit)\n- Configuring worktree path templates\n- Fixing shell integration issues\n\nClaude Code is designed to load the skill automatically when it detects worktrunk-related questions.\n\n## Activity tracking\n\nThe plugin tracks Claude sessions with status markers in `wt list`:\n\n<span class=\"cmd\">wt list</span>\n  <b>Branch</b>       <b>Status</b>        <b>HEAD¬±</b>    <b>main‚Üï</b>  <b>Path</b>                 <b>Remote‚áÖ</b>  <b>Commit</b>    <b>Age</b>   <b>Message</b>\n@ main             <span class=d>^</span><span class=d>‚á°</span>                        .                     <span class=g>‚á°1</span>      <span class=d>33323bc1</span>  <span class=d>1d</span>    <span class=d>Initial commit</span>\n+ feature-api      <span class=d>‚Üë</span> ü§ñ              <span class=g>‚Üë1</span>      ../repo.feature-api           <span class=d>70343f03</span>  <span class=d>1d</span>    <span class=d>Add REST API endpoints</span>\n+ review-ui      <span class=c>?</span> <span class=d>‚Üë</span> üí¨              <span class=g>‚Üë1</span>      ../repo.review-ui             <span class=d>a585d6ed</span>  <span class=d>1d</span>    <span class=d>Add dashboard component</span>\n+ wip-docs       <span class=c>?</span> <span class=d>‚Äì</span>                         ../repo.wip-docs              <span class=d>33323bc1</span>  <span class=d>1d</span>    <span class=d>Initial commit</span>\n\n<span class=d>‚óã</span> <span class=d>Showing 4 worktrees, 2 with changes, 2 ahead</span>\n\n- ü§ñ ‚Äî Claude is working\n- üí¨ ‚Äî Claude is waiting for input\n\n### Manual status markers\n\nSet status markers manually for any workflow:\n\n```bash\n$ wt config state marker set \"üöß\"                   # Current branch\n$ wt config state marker set \"‚úÖ\" --branch feature  # Specific branch\n$ git config worktrunk.state.feature.marker '{\"marker\":\"üí¨\",\"set_at\":0}'  # Direct\n```\n\n## Statusline\n\n`wt list statusline --format=claude-code` outputs a single-line status for the Claude Code statusline. This may fetch CI status from the network when the cache is stale (often ~1‚Äì2 seconds), making it suitable for async statuslines but too slow for synchronous shell prompts. If a faster version would be helpful, please [open an issue](https://github.com/max-sixty/worktrunk/issues).\n\n<code>~/w/myproject.feature-auth  !ü§ñ  @<span style='color:#0a0'>+42</span> <span style='color:#a00'>-8</span>  <span style='color:#0a0'>‚Üë3</span>  <span style='color:#0a0'>‚á°1</span>  <span style='color:#0a0'>‚óè</span>  | Opus üåî 65%</code>\n\nWhen Claude Code provides context window usage via stdin JSON, a moon phase gauge appears (üåï‚Üíüåë as context fills).\n\nAdd to `~/.claude/settings.json`:\n\n```json\n{\n  \"statusLine\": {\n    \"type\": \"command\",\n    \"command\": \"wt list statusline --format=claude-code\"\n  }\n}\n```\n",
        ".claude-plugin/skills/worktrunk/reference/config.md": "# wt config\n\nManage user & project configs. Includes shell integration, hooks, and saved state.\n\n## Examples\n\nInstall shell integration (required for directory switching):\n\n```bash\nwt config shell install\n```\n\nCreate user config file with documented examples:\n\n```bash\nwt config create\n```\n\nCreate project config file (`.config/wt.toml`) for hooks:\n\n```bash\nwt config create --project\n```\n\nShow current configuration and file locations:\n\n```bash\nwt config show\n```\n\n## Configuration files\n\n| File | Location | Contains | Committed & shared |\n|------|----------|----------|--------------------|\n| **User config** | `~/.config/worktrunk/config.toml` | Worktree path template, LLM commit configs, etc | ‚úó |\n| **Project config** | `.config/wt.toml` | Project hooks, dev server URL | ‚úì |\n\n**User config** ‚Äî personal preferences:\n\n```toml\n# ~/.config/worktrunk/config.toml\nworktree-path = \".worktrees/{{ branch | sanitize }}\"\n\n[commit.generation]\ncommand = \"MAX_THINKING_TOKENS=0 claude -p --model=haiku --tools='' --disable-slash-commands --setting-sources='' --system-prompt=''\"\n```\n\n**Project config** ‚Äî shared team settings:\n\n```toml\n# .config/wt.toml\n[post-create]\ndeps = \"npm ci\"\n\n[pre-merge]\ntest = \"npm test\"\n```\n\n---\n\n<!-- USER_CONFIG_START -->\n# User Configuration\n\nCreate with `wt config create`.\n\nLocation:\n\n- macOS/Linux: `~/.config/worktrunk/config.toml` (or `$XDG_CONFIG_HOME` if set)\n- Windows: `%APPDATA%\\worktrunk\\config.toml`\n\n## Worktree path template\n\nControls where new worktrees are created. Paths are relative to the repository root.\n\n**Variables:**\n\n- `{{ repo }}` ‚Äî repository directory name\n- `{{ branch }}` ‚Äî raw branch name (e.g., `feature/auth`)\n- `{{ branch | sanitize }}` ‚Äî filesystem-safe: `/` and `\\` become `-` (e.g., `feature-auth`)\n- `{{ branch | sanitize_db }}` ‚Äî database-safe: lowercase, underscores, hash suffix (e.g., `feature_auth_x7k`)\n\n**Examples** for repo at `~/code/myproject`, branch `feature/auth`:\n\n```toml\n# Default ‚Äî siblings in parent directory\n# Creates: ~/code/myproject.feature-auth\nworktree-path = \"../{{ repo }}.{{ branch | sanitize }}\"\n\n# Inside the repository\n# Creates: ~/code/myproject/.worktrees/feature-auth\nworktree-path = \".worktrees/{{ branch | sanitize }}\"\n\n# Namespaced (useful when multiple repos share a parent directory)\n# Creates: ~/code/worktrees/myproject/feature-auth\nworktree-path = \"../worktrees/{{ repo }}/{{ branch | sanitize }}\"\n\n# Nested bare repo (git clone --bare <url> project/.git)\n# Creates: ~/code/project/feature-auth (sibling to .git)\nworktree-path = \"../{{ branch | sanitize }}\"\n```\n\n## LLM commit messages\n\nGenerate commit messages automatically during merge. Requires an external CLI tool.\n\nSee [LLM commits docs](https://worktrunk.dev/llm-commits/) for setup and [Custom prompt templates](#custom-prompt-templates) for template customization.\n\n## Command config\n\n### List\n\nPersistent flag values for `wt list`. Override on command line as needed.\n\n```toml\n[list]\nfull = false       # Show CI status and main‚Ä¶¬± diffstat columns (--full)\nbranches = false   # Include branches without worktrees (--branches)\nremotes = false    # Include remote-only branches (--remotes)\n```\n\n### Commit\n\nShared by `wt step commit`, `wt step squash`, and `wt merge`.\n\n```toml\n[commit]\nstage = \"all\"      # What to stage before commit: \"all\", \"tracked\", or \"none\"\n```\n\n### Merge\n\nAll flags are on by default. Set to false to change default behavior.\n\n```toml\n[merge]\nsquash = true      # Squash commits into one (--no-squash to preserve history)\ncommit = true      # Commit uncommitted changes first (--no-commit to skip)\nrebase = true      # Rebase onto target before merge (--no-rebase to skip)\nremove = true      # Remove worktree after merge (--no-remove to keep)\nverify = true      # Run project hooks (--no-verify to skip)\n```\n\n### Select\n\nPager behavior for `wt select` diff previews.\n\n```toml\n[select]\n# Pager command with flags for diff preview (overrides git's core.pager)\n# Use this to specify pager flags needed for non-TTY contexts\n# Example:\n# pager = \"delta --paging=never\"\n```\n\n### User project-specific settings\n\nFor context:\n\n- [Project config](https://worktrunk.dev/config/#project-configuration) settings are shared with teammates.\n- User configs generally apply to all projects.\n- User configs _also_ has a `[projects]` table which holds project-specific settings for the user, such as approved hook commands and worktree layout. That's what this section covers.\n\nEntries are keyed by project identifier (e.g., `github.com/user/repo`).\n\n#### Approved hook commands\n\nWhen a project hook runs for the first time, Worktrunk asks for approval. Approved commands are saved here, preventing repeated prompts.\n\n```toml\n[projects.\"github.com/user/repo\"]\napproved-commands = [\"npm ci\", \"npm test\"]\n```\n\nTo reset, delete the entry or run `wt hook approvals clear`.\n\n#### Setting overrides (Experimental)\n\nOverride global user config for a specific project. Scalar values (like `worktree-path`) replace the global value. Hooks append ‚Äî both global and per-project hooks run.\n\n```toml\n[projects.\"github.com/user/repo\"]\nworktree-path = \".worktrees/{{ branch | sanitize }}\"\nlist.full = true\nmerge.squash = false\npost-create.env = \"cp .env.example .env\"\n```\n\n### Custom prompt templates\n\nTemplates use [minijinja](https://docs.rs/minijinja/) syntax.\n\n#### Commit template\n\nAvailable variables:\n\n- `{{ git_diff }}`, `{{ git_diff_stat }}` ‚Äî diff content\n- `{{ branch }}`, `{{ repo }}` ‚Äî context\n- `{{ recent_commits }}` ‚Äî recent commit messages\n\nDefault template:\n\n<!-- DEFAULT_TEMPLATE_START -->\n```toml\n[commit.generation]\ntemplate = \"\"\"\nWrite a commit message for the staged changes below.\n\n<format>\n- Subject line under 50 chars\n- For material changes, add a blank line then a body paragraph explaining the change\n- Output only the commit message, no quotes or code blocks\n</format>\n\n<style>\n- Imperative mood: \"Add feature\" not \"Added feature\"\n- Match recent commit style (conventional commits if used)\n- Describe the change, not the intent or benefit\n</style>\n\n<diffstat>\n{{ git_diff_stat }}\n</diffstat>\n\n<diff>\n{{ git_diff }}\n</diff>\n\n<context>\nBranch: {{ branch }}\n{% if recent_commits %}<recent_commits>\n{% for commit in recent_commits %}- {{ commit }}\n{% endfor %}</recent_commits>{% endif %}\n</context>\n\n\"\"\"\n```\n<!-- DEFAULT_TEMPLATE_END -->\n\n#### Squash template\n\nAvailable variables (in addition to commit template variables):\n\n- `{{ commits }}` ‚Äî list of commits being squashed\n- `{{ target_branch }}` ‚Äî merge target branch\n\nDefault template:\n\n<!-- DEFAULT_SQUASH_TEMPLATE_START -->\n```toml\n[commit.generation]\nsquash-template = \"\"\"\nCombine these commits into a single commit message.\n\n<format>\n- Subject line under 50 chars\n- For material changes, add a blank line then a body paragraph explaining the change\n- Output only the commit message, no quotes or code blocks\n</format>\n\n<style>\n- Imperative mood: \"Add feature\" not \"Added feature\"\n- Match the style of commits being squashed (conventional commits if used)\n- Describe the change, not the intent or benefit\n</style>\n\n<commits branch=\"{{ branch }}\" target=\"{{ target_branch }}\">\n{% for commit in commits %}- {{ commit }}\n{% endfor %}</commits>\n\n<diffstat>\n{{ git_diff_stat }}\n</diffstat>\n\n<diff>\n{{ git_diff }}\n</diff>\n\n\"\"\"\n```\n<!-- DEFAULT_SQUASH_TEMPLATE_END -->\n<!-- USER_CONFIG_END -->\n\n---\n\n# Project Configuration\n\nProject config (`.config/wt.toml`) defines lifecycle hooks and project-specific settings. This file is checked into version control and shared with the team. Create with `wt config create --project`.\n\nSee [`wt hook`](https://worktrunk.dev/hook/) for hook types, execution order, template variables, and examples.\n\n### Non-hook settings\n\n```toml\n# .config/wt.toml\n\n# URL column in wt list (dimmed when port not listening)\n[list]\nurl = \"http://localhost:{{ branch | hash_port }}\"\n\n# Override CI platform detection for self-hosted instances\n[ci]\nplatform = \"github\"  # or \"gitlab\"\n```\n\n---\n\n# Shell Integration\n\nWorktrunk needs shell integration to change directories when switching worktrees. Install with:\n\n```bash\nwt config shell install\n```\n\nOr manually add to the shell config:\n\n```bash\n# For bash: add to ~/.bashrc\neval \"$(wt config shell init bash)\"\n\n# For zsh: add to ~/.zshrc\neval \"$(wt config shell init zsh)\"\n\n# For fish: add to ~/.config/fish/config.fish\nwt config shell init fish | source\n```\n\nWithout shell integration, `wt switch` prints the target directory but cannot `cd` into it.\n\n### First-run prompts\n\nOn first run without shell integration, Worktrunk offers to install it. Similarly, on first commit without LLM configuration, it offers to configure a detected tool (`claude`, `codex`). Declining sets `skip-shell-integration-prompt` or `skip-commit-generation-prompt` automatically.\n\n# Other\n\n## Environment variables\n\nAll user config options can be overridden with environment variables using the `WORKTRUNK_` prefix.\n\n### Naming convention\n\nConfig keys use kebab-case (`worktree-path`), while env vars use SCREAMING_SNAKE_CASE (`WORKTRUNK_WORKTREE_PATH`). The conversion happens automatically.\n\nFor nested config sections, use double underscores to separate levels:\n\n| Config | Environment Variable |\n|--------|---------------------|\n| `worktree-path` | `WORKTRUNK_WORKTREE_PATH` |\n| `commit.generation.command` | `WORKTRUNK_COMMIT__GENERATION__COMMAND` |\n| `commit.stage` | `WORKTRUNK_COMMIT__STAGE` |\n\nNote the single underscore after `WORKTRUNK` and double underscores between nested keys.\n\n### Example: CI/testing override\n\nOverride the LLM command in CI to use a mock:\n\n```bash\nWORKTRUNK_COMMIT__GENERATION__COMMAND=\"echo 'test: automated commit'\" wt merge\n```\n\n### Other environment variables\n\n| Variable | Purpose |\n|----------|---------|\n| `WORKTRUNK_BIN` | Override binary path for shell wrappers (useful for testing dev builds) |\n| `WORKTRUNK_CONFIG_PATH` | Override user config file location |\n| `WORKTRUNK_DIRECTIVE_FILE` | Internal: set by shell wrappers to enable directory changes |\n| `WORKTRUNK_SHELL` | Internal: set by shell wrappers to indicate shell type (e.g., `powershell`) |\n| `WORKTRUNK_MAX_CONCURRENT_COMMANDS` | Max parallel git commands (default: 32). Lower if hitting file descriptor limits. |\n| `NO_COLOR` | Disable colored output ([standard](https://no-color.org/)) |\n| `CLICOLOR_FORCE` | Force colored output even when not a TTY |\n\n## Command reference\n\nwt config - Manage user &amp; project configs\n\nIncludes shell integration, hooks, and saved state.\n\nUsage: <b><span class=c>wt config</span></b> <span class=c>[OPTIONS]</span> <span class=c>&lt;COMMAND&gt;</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>shell</span></b>   Shell integration setup\n  <b><span class=c>create</span></b>  Create configuration file\n  <b><span class=c>show</span></b>    Show configuration files &amp; locations\n  <b><span class=c>state</span></b>   Manage internal data and cache\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n# Subcommands\n\n## wt config show\n\nShow configuration files & locations.\n\nShows location and contents of user config (`~/.config/worktrunk/config.toml`)\nand project config (`.config/wt.toml`).\n\nIf a config file doesn't exist, shows defaults that would be used.\n\n### Full diagnostics\n\nUse `--full` to run diagnostic checks:\n\n```bash\nwt config show --full\n```\n\nThis tests:\n- **CI tool status** ‚Äî Whether `gh` (GitHub) or `glab` (GitLab) is installed and authenticated\n- **Commit generation** ‚Äî Whether the LLM command can generate commit messages\n\n### Command reference\n\nwt config show - Show configuration files &amp; locations\n\nUsage: <b><span class=c>wt config show</span></b> <span class=c>[OPTIONS]</span>\n\n<b><span class=g>Options:</span></b>\n      <b><span class=c>--full</span></b>\n          Run diagnostic checks (CI tools, commit generation)\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n## wt config state\n\nManage internal data and cache.\n\nState is stored in `.git/` (config entries and log files), separate from configuration files.\nUse `wt config show` to view file-based configuration.\n\n### Keys\n\n- **default-branch**: The repository's default branch (`main`, `master`, etc.)\n- **previous-branch**: Previous branch for `wt switch -`\n- **ci-status**: CI/PR status for a branch (passed, running, failed, conflicts, no-ci, error)\n- **marker**: Custom status marker for a branch (shown in `wt list`)\n- **logs**: Background operation logs\n\n### Examples\n\nGet the default branch:\n```bash\nwt config state default-branch\n```\n\nSet the default branch manually:\n```bash\nwt config state default-branch set main\n```\n\nSet a marker for current branch:\n```bash\nwt config state marker set \"üöß WIP\"\n```\n\nClear all CI status cache:\n```bash\nwt config state ci-status clear --all\n```\n\nShow all stored state:\n```bash\nwt config state get\n```\n\nClear all stored state:\n```bash\nwt config state clear\n```\n\n### Command reference\n\nwt config state - Manage internal data and cache\n\nUsage: <b><span class=c>wt config state</span></b> <span class=c>[OPTIONS]</span> <span class=c>&lt;COMMAND&gt;</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>default-branch</span></b>   Default branch detection and override\n  <b><span class=c>previous-branch</span></b>  Previous branch (for <b>wt switch -</b>)\n  <b><span class=c>ci-status</span></b>        CI status cache\n  <b><span class=c>marker</span></b>           Branch markers\n  <b><span class=c>logs</span></b>             Background operation logs\n  <b><span class=c>hints</span></b>            One-time hints shown in this repo\n  <b><span class=c>get</span></b>              Get all stored state\n  <b><span class=c>clear</span></b>            Clear all stored state\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n## wt config state default-branch\n\nDefault branch detection and override.\n\nUseful in scripts to avoid hardcoding `main` or `master`:\n\n```bash\ngit rebase $(wt config state default-branch)\n```\n\nWithout a subcommand, runs `get`. Use `set` to override, or `clear` then `get` to re-detect.\n\n### Detection\n\nWorktrunk detects the default branch automatically:\n\n1. **Worktrunk cache** ‚Äî Checks `git config worktrunk.default-branch` (single command)\n2. **Git cache** ‚Äî Detects primary remote and checks its HEAD (e.g., `origin/HEAD`)\n3. **Remote query** ‚Äî If not cached, queries `git ls-remote` (100ms‚Äì2s)\n4. **Local inference** ‚Äî If no remote, infers from local branches\n\nOnce detected, the result is cached in `worktrunk.default-branch` for fast access.\n\nThe local inference fallback uses these heuristics in order:\n- If only one local branch exists, uses it\n- For bare repos or empty repos, checks `symbolic-ref HEAD`\n- Checks `git config init.defaultBranch`\n- Looks for common names: `main`, `master`, `develop`, `trunk`\n\n### Command reference\n\nwt config state default-branch - Default branch detection and override\n\nUsage: <b><span class=c>wt config state default-branch</span></b> <span class=c>[OPTIONS]</span> <span class=c>[COMMAND]</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>get</span></b>    Get the default branch\n  <b><span class=c>set</span></b>    Set the default branch\n  <b><span class=c>clear</span></b>  Clear the default branch cache\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n## wt config state ci-status\n\nCI status cache.\n\nCaches GitHub/GitLab CI status for display in [`wt list`](https://worktrunk.dev/list/#ci-status).\n\nRequires `gh` (GitHub) or `glab` (GitLab) CLI, authenticated. Platform auto-detects from remote URL; override with `ci.platform = \"github\"` in `.config/wt.toml` for self-hosted instances.\n\nChecks open PRs/MRs first, then branch pipelines for branches with upstream. Local-only branches (no remote tracking) show blank.\n\nResults cache for 30-60 seconds. Indicators dim when local changes haven't been pushed.\n\n### Status values\n\n| Status | Meaning |\n|--------|---------|\n| `passed` | All checks passed |\n| `running` | Checks in progress |\n| `failed` | Checks failed |\n| `conflicts` | PR has merge conflicts |\n| `no-ci` | No checks configured |\n| `error` | Fetch error (rate limit, network, auth) |\n\nSee [`wt list` CI status](https://worktrunk.dev/list/#ci-status) for display symbols and colors.\n\nWithout a subcommand, runs `get` for the current branch. Use `clear` to reset cache for a branch or `clear --all` to reset all.\n\n### Command reference\n\nwt config state ci-status - CI status cache\n\nUsage: <b><span class=c>wt config state ci-status</span></b> <span class=c>[OPTIONS]</span> <span class=c>[COMMAND]</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>get</span></b>    Get CI status for a branch\n  <b><span class=c>clear</span></b>  Clear CI status cache\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n## wt config state marker\n\nBranch markers.\n\nCustom status text or emoji shown in the `wt list` Status column.\n\n### Display\n\nMarkers appear at the start of the Status column:\n\n```\nBranch    Status   Path\nmain      ^        ~/code/myproject\nfeature   üöß‚Üë      ~/code/myproject.feature\nbugfix    ü§ñ!‚Üë‚á°    ~/code/myproject.bugfix\n```\n\n### Use cases\n\n- **Work status** ‚Äî `üöß` WIP, `‚úÖ` ready for review, `üî•` urgent\n- **Agent tracking** ‚Äî The [Claude Code plugin](https://worktrunk.dev/claude-code/) sets markers automatically\n- **Notes** ‚Äî Any short text: `\"blocked\"`, `\"needs tests\"`\n\n### Storage\n\nStored in git config as `worktrunk.state.<branch>.marker`. Set directly with:\n\n```bash\ngit config worktrunk.state.feature.marker '{\"marker\":\"üöß\",\"set_at\":0}'\n```\n\nWithout a subcommand, runs `get` for the current branch. For `--branch`, use `get --branch=NAME`.\n\n### Command reference\n\nwt config state marker - Branch markers\n\nUsage: <b><span class=c>wt config state marker</span></b> <span class=c>[OPTIONS]</span> <span class=c>[COMMAND]</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>get</span></b>    Get marker for a branch\n  <b><span class=c>set</span></b>    Set marker for a branch\n  <b><span class=c>clear</span></b>  Clear marker for a branch\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n## wt config state logs\n\nBackground operation logs.\n\nView and manage logs from background operations.\n\n### What's logged\n\n| Operation | Log file |\n|-----------|----------|\n| post-start hooks | `{branch}-{source}-post-start-{name}.log` |\n| Background removal | `{branch}-remove.log` |\n\nSource is `user` or `project` depending on where the hook is defined.\n\n### Location\n\nAll logs are stored in `.git/wt-logs/` (in the main worktree's git directory).\n\n### Behavior\n\n- **Overwrites** ‚Äî Same operation on same branch overwrites previous log\n- **Persists** ‚Äî Logs from deleted branches remain until manually cleared\n- **Shared** ‚Äî All worktrees write to the same log directory\n\n### Examples\n\nList all log files:\n```bash\nwt config state logs get\n```\n\nView a specific log:\n```bash\ncat \"$(git rev-parse --git-dir)/wt-logs/feature-project-post-start-build.log\"\n```\n\nClear all logs:\n```bash\nwt config state logs clear\n```\n\n### Command reference\n\nwt config state logs - Background operation logs\n\nUsage: <b><span class=c>wt config state logs</span></b> <span class=c>[OPTIONS]</span> <span class=c>[COMMAND]</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>get</span></b>    Get log file paths\n  <b><span class=c>clear</span></b>  Clear background operation logs\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n",
        ".claude-plugin/skills/worktrunk/reference/faq.md": "# FAQ\n\n## How does Worktrunk compare to alternatives?\n\n### vs. branch switching\n\nBranch switching uses one directory: uncommitted changes from one agent get mixed with the next agent's work, or block switching entirely. Worktrees give each agent its own directory with independent files and index.\n\n### vs. Plain `git worktree`\n\nGit's built-in worktree commands work but require manual lifecycle management:\n\n```bash\n# Plain git worktree workflow\ngit worktree add -b feature-branch ../myapp-feature main\ncd ../myapp-feature\n# ...work, commit, push...\ncd ../myapp\ngit merge feature-branch\ngit worktree remove ../myapp-feature\ngit branch -d feature-branch\n```\n\nWorktrunk automates the full lifecycle:\n\n```bash\nwt switch --create feature-branch  # Creates worktree, runs setup hooks\n# ...work...\nwt merge                            # Merges into default branch, cleans up\n```\n\nNo cd back to main ‚Äî `wt merge` runs from the feature worktree and merges into the target, like GitHub's merge button.\n\nWhat `git worktree` doesn't provide:\n\n- Consistent directory naming and cleanup validation\n- Project-specific automation (install dependencies, start services)\n- Unified status across all worktrees (commits, CI, conflicts, changes)\n\n### vs. git-machete / git-town\n\nDifferent scopes:\n\n- **git-machete**: Branch stack management in a single directory\n- **git-town**: Git workflow automation in a single directory\n- **worktrunk**: Multi-worktree management with hooks and status aggregation\n\nThese tools can be used together‚Äîrun git-machete or git-town inside individual worktrees.\n\n### vs. Git TUIs (lazygit, gh-dash, etc.)\n\nGit TUIs operate on a single repository. Worktrunk manages multiple worktrees, runs automation hooks, and aggregates status across branches. TUIs work inside each worktree directory.\n\n## There's an issue with my shell setup\n\nIf shell integration isn't working (auto-cd not happening, completions missing, `wt` not found as a function), the fastest path to a fix is using Claude Code with the Worktrunk plugin:\n\n1. Install the [Worktrunk plugin](https://worktrunk.dev/claude-code/) in Claude Code\n2. Ask Claude to debug the Worktrunk shell integration\n\nClaude will run `wt config show`, inspect the shell config files, and identify the issue.\n\nIf Claude can't fix it, please [open an issue](https://github.com/max-sixty/worktrunk/issues/new?title=Shell%20setup%20issue&body=%23%23%20Shell%20and%20OS%0A%0A-%20Shell%3A%20%0A-%20OS%3A%20%0A%0A%23%23%20Output%20of%20%60wt%20config%20show%60%0A%0A%60%60%60%0A%0A%60%60%60%0A%0A%23%23%20What%20Claude%20found%20%28if%20available%29%0A%0A) with the output of `wt config show`, the shell (bash/zsh/fish), and OS. (And even if it fixes the problem, feel free to open an issue: non-standard success cases are useful for ensuring Worktrunk is easy to set up for others.)\n\n## What files does Worktrunk create?\n\nWorktrunk creates files in four categories.\n\n### 1. Worktree directories\n\nCreated by `wt switch <branch>` (or `wt select`) when switching to a branch that doesn't have a worktree. Use `wt switch --create <branch>` to create a new branch. Default location is `../<repo>.<branch>` (sibling to main repo), configurable via `worktree-path` in user config.\n\n**To remove:** `wt remove <branch>` removes the worktree directory and deletes the branch.\n\n### 2. Config files\n\n| File | Created by | Purpose |\n|------|------------|---------|\n| `~/.config/worktrunk/config.toml` | `wt config create`, or approving project commands | User preferences, approved commands |\n| `.config/wt.toml` | `wt config create --project` | Project hooks (checked into repo) |\n\nUser config location: `$XDG_CONFIG_HOME/worktrunk/` (or `~/.config/worktrunk/`) on Linux/macOS, `%APPDATA%\\worktrunk\\` on Windows.\n\n**To remove:** Delete directly. User config: `rm ~/.config/worktrunk/config.toml`. Project config: `rm .config/wt.toml` (and commit).\n\n### 3. Shell integration\n\nCreated by `wt config shell install`:\n\n- **Bash**: adds line to `~/.bashrc`\n- **Zsh**: adds line to `~/.zshrc` (or `$ZDOTDIR/.zshrc`)\n- **Fish**: creates `~/.config/fish/functions/wt.fish` and `~/.config/fish/completions/wt.fish`\n- **PowerShell** (Windows): creates both profile files if they don't exist:\n  - `Documents/PowerShell/Microsoft.PowerShell_profile.ps1` (PowerShell 7+)\n  - `Documents/WindowsPowerShell/Microsoft.PowerShell_profile.ps1` (Windows PowerShell 5.1)\n\n**PowerShell detection on Windows:** When running from cmd.exe or PowerShell, both PowerShell profile files are created automatically. When running from Git Bash or MSYS2, PowerShell is skipped (use `wt config shell install powershell` to create the profiles explicitly).\n\n**To remove:** `wt config shell uninstall`.\n\n### 4. Metadata in `.git/` (automatic)\n\nWorktrunk stores small amounts of cache and log data in the repository's `.git/` directory:\n\n| Location | Purpose | Created by |\n|----------|---------|------------|\n| `.git/config` keys under `worktrunk.*` | Cached default branch, switch history, branch markers | Various commands |\n| `.git/wt-cache/ci-status/*.json` | CI status cache (~1KB each) | `wt list` when `gh` or `glab` CLI is installed |\n| `.git/wt-logs/*.log` | Background command output | Hooks, background `wt remove` |\n\nNone of this is tracked by git or pushed to remotes.\n\n**To remove:** `wt config state clear` removes all worktrunk keys from `.git/config`, deletes CI cache, and clears logs.\n\n### What Worktrunk does NOT create\n\n- No files outside `.git/`, config directories, or worktree directories\n- No global git hooks\n- No modifications to `~/.gitconfig`\n- No background processes or daemons\n\n## What can Worktrunk delete?\n\nWorktrunk can delete **worktrees** and **branches**. Both have safeguards.\n\n### Worktree removal\n\n`wt remove` mirrors `git worktree remove`: it refuses to remove worktrees with uncommitted changes (staged, modified, or untracked files). The `--force` flag overrides the untracked-files check for build artifacts that weren't cleaned up.\n\nFor worktrees containing precious ignored data (databases, caches, large assets), use `git worktree lock`:\n\n```bash\ngit worktree lock ../myproject.feature --reason \"Contains local database\"\n```\n\nLocked worktrees show `‚äû` in `wt list`. Neither `git worktree remove` nor `wt remove` (even with `--force`) will delete them. Unlock with `git worktree unlock`.\n\n### Branch deletion\n\nBy default, `wt remove` only deletes branches whose content is already in the default branch. Branches showing `_` (same commit) or `‚äÇ` (integrated) in `wt list` are safe to delete.\n\nFor the full algorithm, see [Branch cleanup](https://worktrunk.dev/remove/#branch-cleanup) ‚Äî it handles squash-merge and rebase workflows where commit history differs but file changes match.\n\nUse `-D` to force-delete branches with unmerged changes. Use `--no-delete-branch` to keep the branch regardless of status.\n\n### Other cleanup\n\n- `wt config state clear` ‚Äî removes cached state from `.git/config` and clears CI cache/logs\n- `wt config shell uninstall` ‚Äî removes shell integration from rc files\n\nSee [What files does Worktrunk create?](#what-files-does-worktrunk-create) for details.\n\n## What commands does Worktrunk execute?\n\nWorktrunk runs `git` commands internally and optionally runs `gh` (GitHub) or `glab` (GitLab) for CI status. Beyond that, user-defined commands execute in four contexts:\n\n1. **User hooks** (`~/.config/worktrunk/config.toml`) ‚Äî Personal automation for all repositories\n2. **Project hooks** (`.config/wt.toml`) ‚Äî Repository-specific automation\n3. **LLM commands** (`~/.config/worktrunk/config.toml`) ‚Äî Commit message generation\n4. **--execute flag** ‚Äî Explicitly provided commands\n\nUser hooks don't require approval (you defined them). Commands from project hooks require approval on first run. Approved commands are saved to user config. If a command changes, Worktrunk requires new approval.\n\n### Example approval prompt\n\n```\n‚ñ≤ repo needs approval to execute 3 commands:\n\n‚óã post-create install:\n  echo 'Installing dependencies...'\n‚óã post-create build:\n  echo 'Building project...'\n‚óã post-create test:\n  echo 'Running tests...'\n‚ùØ Allow and remember? [y/N]\n```\n\nUse `--yes` to bypass prompts (useful for CI/automation).\n\n## Does Worktrunk work on Windows?\n\nYes. Core commands, shell integration, and tab completion work in both Git Bash and PowerShell. See [installation](https://worktrunk.dev/worktrunk/#install) for setup details, including avoiding the Windows Terminal `wt` conflict.\n\n**Git for Windows required** ‚Äî Hooks use bash syntax and execute via Git Bash, so [Git for Windows](https://gitforwindows.org/) must be installed even when PowerShell is the interactive shell.\n\n**`wt select` unavailable** ‚Äî Uses [skim](https://github.com/skim-rs/skim), which doesn't support Windows. Use `wt list` and `wt switch <branch>` instead.\n\n## How does Worktrunk determine the default branch?\n\nWorktrunk checks the local git cache first, queries the remote if needed, and falls back to local inference when no remote exists. The result is cached for fast subsequent lookups.\n\nIf the remote's default branch has changed (e.g., renamed from master to main), clear the cache with `wt config state default-branch clear`.\n\nFor full details on the detection mechanism, see `wt config state default-branch --help`.\n\n## Installation fails with C compilation errors\n\nErrors related to tree-sitter or C compilation (C99 mode, `le16toh` undefined) can be avoided by installing without syntax highlighting:\n\n```bash\n$ cargo install worktrunk --no-default-features\n```\n\nThis disables bash syntax highlighting in command output but keeps all core functionality. The syntax highlighting feature requires C99 compiler support and can fail on older systems or minimal Docker images.\n\n## Running tests (for contributors)\n\n### Quick tests\n\n```bash\n$ cargo test\n```\n\n### Full integration tests\n\nShell integration tests require bash, zsh, and fish:\n\n```bash\n$ cargo test --test integration --features shell-integration-tests\n```\n\n## How can I contribute?\n\n- Star the repo\n- Try it out and [open an issue](https://github.com/max-sixty/worktrunk/issues) with feedback ‚Äî even small annoyances\n- What worktree friction does Worktrunk not yet solve? [Tell us](https://github.com/max-sixty/worktrunk/issues)\n- Send to a friend\n- Post about it on [X](https://twitter.com/intent/tweet?text=Worktrunk%20%E2%80%94%20CLI%20for%20git%20worktree%20management&url=https%3A%2F%2Fworktrunk.dev), [Reddit](https://www.reddit.com/submit?url=https%3A%2F%2Fworktrunk.dev&title=Worktrunk%20%E2%80%94%20CLI%20for%20git%20worktree%20management), or [LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fworktrunk.dev)\n",
        ".claude-plugin/skills/worktrunk/reference/hook.md": "# wt hook\n\nRun configured hooks.\n\nHooks are shell commands that run at key points in the worktree lifecycle ‚Äî automatically during `wt switch`, `wt merge`, & `wt remove`, or on demand via `wt hook <type>`. Both user (`~/.config/worktrunk/config.toml`) and project (`.config/wt.toml`) hooks are supported.\n\n## Hook types\n\n| Hook | When | Blocking | Fail-fast |\n|------|------|----------|-----------|\n| `post-start` | After worktree created | No (background) | No |\n| `post-create` | After worktree created | Yes | No |\n| `post-switch` | After every switch | No (background) | No |\n| `pre-commit` | Before commit during merge | Yes | Yes |\n| `pre-merge` | Before merging to target | Yes | Yes |\n| `post-merge` | After successful merge | Yes | No |\n| `pre-remove` | Before worktree removed | Yes | Yes |\n| `post-remove` | After worktree removed | No (background) | No |\n\n**Blocking**: Command waits for hook to complete before continuing.\n**Fail-fast**: First failure aborts the operation.\n\nBackground hooks show a single-line summary by default. Use `-v` to see expanded command details.\n\n### post-start\n\nDev servers, long builds, file watchers, copying caches. Output logged to `.git/wt-logs/{branch}-{source}-post-start-{name}.log`.\n\n```toml\n[post-start]\ncopy = \"wt step copy-ignored\"\nserver = \"npm run dev -- --port {{ branch | hash_port }}\"\n```\n\n### post-create\n\nTasks that must complete before `post-start` hooks or `--execute` run: dependency installation, environment file generation.\n\n```toml\n[post-create]\ninstall = \"npm ci\"\nenv = \"echo 'PORT={{ branch | hash_port }}' > .env.local\"\n```\n\n### post-switch\n\nTriggers on all switch results: creating new worktrees, switching to existing ones, or staying on current. Output logged to `.git/wt-logs/{branch}-{source}-post-switch-{name}.log`.\n\n```toml\n[post-switch]\ntmux = \"[ -n \\\"$TMUX\\\" ] && tmux rename-window {{ branch | sanitize }}\"\n```\n\n### pre-commit\n\nFormatters, linters, type checking ‚Äî runs during `wt merge` before the squash commit.\n\n```toml\n[pre-commit]\nformat = \"cargo fmt -- --check\"\nlint = \"cargo clippy -- -D warnings\"\n```\n\n### pre-merge\n\nTests, security scans, build verification ‚Äî runs after rebase, before merge to target.\n\n```toml\n[pre-merge]\ntest = \"cargo test\"\nbuild = \"cargo build --release\"\n```\n\n### post-merge\n\nDeployment, notifications, installing updated binaries. Runs in the target branch worktree if it exists, otherwise the main worktree.\n\n```toml\npost-merge = \"cargo install --path .\"\n```\n\n### pre-remove\n\nCleanup tasks before worktree is deleted, saving test artifacts, backing up state. Runs in the worktree being removed, with access to worktree files.\n\n```toml\n[pre-remove]\narchive = \"tar -czf ~/.wt-logs/{{ branch }}.tar.gz test-results/ logs/ 2>/dev/null || true\"\n```\n\n### post-remove\n\nCleanup tasks after worktree removal: stopping dev servers, removing containers, notifying external systems. All template variables reference the removed worktree, so cleanup scripts can identify resources to clean up. Output logged to `.git/wt-logs/{branch}-{source}-post-remove-{name}.log`.\n\n```toml\n[post-remove]\nkill-server = \"lsof -ti :{{ branch | hash_port }} | xargs kill 2>/dev/null || true\"\nremove-db = \"docker stop {{ repo }}-{{ branch | sanitize }}-postgres 2>/dev/null || true\"\n```\n\nDuring `wt merge`, hooks run in this order: pre-commit ‚Üí pre-merge ‚Üí pre-remove ‚Üí post-remove ‚Üí post-merge. See [`wt merge`](https://worktrunk.dev/merge/#pipeline) for the complete pipeline.\n\n## Security\n\nProject commands require approval on first run:\n\n```\n‚ñ≤ repo needs approval to execute 3 commands:\n\n‚óã post-create install:\n   echo 'Installing dependencies...'\n\n‚ùØ Allow and remember? [y/N]\n```\n\n- Approvals are saved to user config (`~/.config/worktrunk/config.toml`)\n- If a command changes, new approval is required\n- Use `--yes` to bypass prompts (useful for CI/automation)\n- Use `--no-verify` to skip hooks\n\nManage approvals with `wt hook approvals add` and `wt hook approvals clear`.\n\n## Configuration\n\nHooks can be defined in two places: project config (`.config/wt.toml`) for repository-specific automation, or user config (`~/.config/worktrunk/config.toml`) for personal automation across all repositories.\n\n### Project hooks\n\nProject hooks are defined in `.config/wt.toml`. They can be a single command or multiple named commands:\n\n```toml\n# Single command (string)\npost-create = \"npm install\"\n\n# Multiple commands (table) ‚Äî run sequentially in declaration order\n[pre-merge]\ntest = \"cargo test\"\nbuild = \"cargo build --release\"\n```\n\n### User hooks\n\nDefine hooks in `~/.config/worktrunk/config.toml` to run for all repositories. User hooks run before project hooks and don't require approval. For repository-specific user hooks, see [setting overrides](https://worktrunk.dev/config/#setting-overrides-experimental).\n\n```toml\n# ~/.config/worktrunk/config.toml\n[post-create]\nsetup = \"echo 'Setting up worktree...'\"\n\n[pre-merge]\nnotify = \"notify-send 'Merging {{ branch }}'\"\n```\n\nUser hooks support the same hook types and template variables as project hooks.\n\n**Key differences from project hooks:**\n\n| Aspect | Project hooks | User hooks |\n|--------|--------------|------------|\n| Location | `.config/wt.toml` | `~/.config/worktrunk/config.toml` |\n| Scope | Single repository | All repositories (or per-project) |\n| Approval | Required | Not required |\n| Execution order | After user hooks | Global first, then per-project |\n\nSkip hooks with `--no-verify`. To run a specific hook when user and project both define the same name, use `user:name` or `project:name` syntax.\n\n**Use cases:**\n- Personal notifications or logging\n- Editor/IDE integration\n- Repository-agnostic setup tasks\n\n### Template variables\n\nHooks can use template variables that expand at runtime:\n\n| Variable | Description |\n|----------|-------------|\n| `{{ repo }}` | Repository directory name |\n| `{{ repo_path }}` | Absolute path to repository root |\n| `{{ branch }}` | Branch name |\n| `{{ worktree_name }}` | Worktree directory name |\n| `{{ worktree_path }}` | Absolute worktree path |\n| `{{ primary_worktree_path }}` | Primary worktree path (main worktree for normal repos; default branch worktree for bare repos) |\n| `{{ default_branch }}` | Default branch name |\n| `{{ commit }}` | Full HEAD commit SHA |\n| `{{ short_commit }}` | Short HEAD commit SHA (7 chars) |\n| `{{ remote }}` | Primary remote name |\n| `{{ remote_url }}` | Remote URL |\n| `{{ upstream }}` | Upstream tracking branch (if set) |\n| `{{ target }}` | Target branch (merge hooks only) |\n| `{{ base }}` | Base branch (creation hooks only) |\n| `{{ base_worktree_path }}` | Base branch worktree (creation hooks only) |\n\nSome variables may not be defined: `upstream` is only set when the branch tracks a remote; `target`, `base`, and `base_worktree_path` are hook-specific. Using an undefined variable directly errors ‚Äî use conditionals for optional behavior:\n\n```toml\n[post-create]\n# Rebase onto upstream if tracking a remote branch (e.g., wt switch --create feature origin/feature)\nsync = \"{% if upstream %}git fetch && git rebase {{ upstream }}{% endif %}\"\n```\n\n### Worktrunk filters\n\nTemplates support Jinja2 filters for transforming values:\n\n| Filter | Example | Description |\n|--------|---------|-------------|\n| `sanitize` | `{{ branch \\| sanitize }}` | Replace `/` and `\\` with `-` |\n| `sanitize_db` | `{{ branch \\| sanitize_db }}` | Database-safe identifier with hash suffix (`[a-z0-9_]`, max 63 chars) |\n| `hash_port` | `{{ branch \\| hash_port }}` | Hash to port 10000-19999 |\n\nThe `sanitize` filter makes branch names safe for filesystem paths. The `sanitize_db` filter produces database-safe identifiers (lowercase alphanumeric and underscores, no leading digits, with a 3-character hash suffix to avoid collisions and reserved words). The `hash_port` filter is useful for running dev servers on unique ports per worktree:\n\n```toml\n[post-start]\ndev = \"npm run dev -- --host {{ branch }}.lvh.me --port {{ branch | hash_port }}\"\n```\n\nHash any string, including concatenations:\n\n```toml\n# Unique port per repo+branch combination\ndev = \"npm run dev --port {{ (repo ~ '-' ~ branch) | hash_port }}\"\n```\n\nVariables are shell-escaped automatically ‚Äî quotes around `{{ ... }}` are unnecessary and can cause issues with special characters.\n\n### Worktrunk functions\n\nTemplates also support functions for dynamic lookups:\n\n| Function | Example | Description |\n|----------|---------|-------------|\n| `worktree_path_of_branch(branch)` | `{{ worktree_path_of_branch(\"main\") }}` | Look up the path of a branch's worktree |\n\nThe `worktree_path_of_branch` function returns the filesystem path of a worktree given a branch name, or an empty string if no worktree exists for that branch. This is useful for referencing files in other worktrees:\n\n```toml\n[post-create]\n# Copy config from main worktree\nsetup = \"cp {{ worktree_path_of_branch('main') }}/config.local {{ worktree_path }}\"\n```\n\n### JSON context\n\nHooks receive context as JSON on stdin, enabling complex logic that templates can't express:\n\n```python\nimport json, sys, subprocess\nctx = json.load(sys.stdin)\n# Run extra setup for feature branches on backend repos\nif ctx['branch'].startswith('feature/') and 'backend' in ctx['repo']:\n    subprocess.run(['make', 'seed-db'])\n```\n\nThe JSON includes all template variables plus `hook_type` and `hook_name`.\n\n## Running hooks manually\n\n`wt hook <type>` runs hooks on demand ‚Äî useful for testing during development, running in CI pipelines, or re-running after a failure.\n\n```bash\nwt hook pre-merge              # Run all pre-merge hooks\nwt hook pre-merge test         # Run hooks named \"test\" from both sources\nwt hook pre-merge user:        # Run all user hooks\nwt hook pre-merge project:     # Run all project hooks\nwt hook pre-merge user:test    # Run only user's \"test\" hook\nwt hook pre-merge project:test # Run only project's \"test\" hook\nwt hook pre-merge --yes        # Skip approval prompts (for CI)\nwt hook post-create --var branch=feature/test  # Override template variable\n```\n\nThe `user:` and `project:` prefixes filter by source. Use `user:` or `project:` alone to run all hooks from that source, or `user:name` / `project:name` to run a specific hook.\n\nThe `--var KEY=VALUE` flag overrides built-in template variables ‚Äî useful for testing hooks with different contexts without switching to that context.\n\n## Designing effective hooks\n\n### post-start vs post-create\n\nBoth run when creating a worktree. The difference:\n\n| Hook | Execution | Best for |\n|------|-----------|----------|\n| `post-start` | Background, parallel | Long-running tasks that don't block worktree creation |\n| `post-create` | Blocks until complete | Tasks the developer needs before working (dependency install) |\n\nMany tasks work well in `post-start` ‚Äî they'll likely be ready by the time they're needed, especially when the fallback is recompiling. If unsure, prefer `post-start` for faster worktree creation.\n\nBackground processes spawned by `post-start` outlive the worktree ‚Äî pair them with `post-remove` hooks to clean up. See [Dev servers](#dev-servers) and [Databases](#databases) for examples.\n\n### Copying untracked files\n\nGit worktrees share the repository but not untracked files. [`wt step copy-ignored`](https://worktrunk.dev/step/#wt-step-copy-ignored) copies gitignored files between worktrees:\n\n```toml\n[post-start]\ncopy = \"wt step copy-ignored\"\n```\n\nUse `post-create` instead if subsequent hooks or `--execute` command need the copied files immediately.\n\n### Dev servers\n\nRun a dev server per worktree on a deterministic port using `hash_port`:\n\n```toml\n[post-start]\nserver = \"npm run dev -- --port {{ branch | hash_port }}\"\n\n[post-remove]\nserver = \"lsof -ti :{{ branch | hash_port }} | xargs kill 2>/dev/null || true\"\n```\n\nThe port is stable across machines and restarts ‚Äî `feature-api` always gets the same port. Show it in `wt list`:\n\n```toml\n[list]\nurl = \"http://localhost:{{ branch | hash_port }}\"\n```\n\nFor subdomain-based routing (useful for cookies/CORS), use `lvh.me` which resolves to 127.0.0.1:\n\n```toml\n[post-start]\nserver = \"npm run dev -- --host {{ branch | sanitize }}.lvh.me --port {{ branch | hash_port }}\"\n```\n\n### Databases\n\nEach worktree can have its own database. Docker containers get unique names and ports:\n\n```toml\n[post-start]\ndb = \"\"\"\ndocker run -d --rm \\\n  --name {{ repo }}-{{ branch | sanitize }}-postgres \\\n  -p {{ ('db-' ~ branch) | hash_port }}:5432 \\\n  -e POSTGRES_DB={{ branch | sanitize_db }} \\\n  -e POSTGRES_PASSWORD=dev \\\n  postgres:16\n\"\"\"\n\n[post-remove]\ndb-stop = \"docker stop {{ repo }}-{{ branch | sanitize }}-postgres 2>/dev/null || true\"\n```\n\nThe `('db-' ~ branch)` concatenation hashes differently than plain `branch`, so database and dev server ports don't collide.\nJinja2's operator precedence has pipe `|` with higher precedence than concatenation `~`, meaning expressions need parentheses to filter concatenated values.\n\nGenerate `.env.local` with the connection string:\n\n```toml\n[post-create]\nenv = \"\"\"\ncat > .env.local << EOF\nDATABASE_URL=postgres://postgres:dev@localhost:{{ ('db-' ~ branch) | hash_port }}/{{ branch | sanitize_db }}\nDEV_PORT={{ branch | hash_port }}\nEOF\n\"\"\"\n```\n\n### Progressive validation\n\nQuick checks before commit, thorough validation before merge:\n\n```toml\n[pre-commit]\nlint = \"npm run lint\"\ntypecheck = \"npm run typecheck\"\n\n[pre-merge]\ntest = \"npm test\"\nbuild = \"npm run build\"\n```\n\n### Target-specific behavior\n\nDifferent actions for production vs staging:\n\n```toml\npost-merge = \"\"\"\nif [ {{ target }} = main ]; then\n    npm run deploy:production\nelif [ {{ target }} = staging ]; then\n    npm run deploy:staging\nfi\n\"\"\"\n```\n\n### Python virtual environments\n\nUse `uv sync` to recreate virtual environments (or `python -m venv .venv && .venv/bin/pip install -r requirements.txt` for pip-based projects):\n\n```toml\n[post-create]\ninstall = \"uv sync\"\n```\n\nFor copying dependencies and caches between worktrees, see [`wt step copy-ignored`](https://worktrunk.dev/step/#language-specific-notes).\n\n## Command reference\n\nwt hook - Run configured hooks\n\nUsage: <b><span class=c>wt hook</span></b> <span class=c>[OPTIONS]</span> <span class=c>&lt;COMMAND&gt;</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>show</span></b>         Show configured hooks\n  <b><span class=c>post-create</span></b>  Run post-create hooks\n  <b><span class=c>post-start</span></b>   Run post-start hooks\n  <b><span class=c>post-switch</span></b>  Run post-switch hooks\n  <b><span class=c>pre-commit</span></b>   Run pre-commit hooks\n  <b><span class=c>pre-merge</span></b>    Run pre-merge hooks\n  <b><span class=c>post-merge</span></b>   Run post-merge hooks\n  <b><span class=c>pre-remove</span></b>   Run pre-remove hooks\n  <b><span class=c>post-remove</span></b>  Run post-remove hooks\n  <b><span class=c>approvals</span></b>    Manage command approvals\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n# Subcommands\n\n## wt hook approvals\n\nManage command approvals.\n\nProject hooks require approval on first run to prevent untrusted projects from running arbitrary commands.\n\n### Examples\n\nPre-approve all commands for current project:\n```bash\nwt hook approvals add\n```\n\nClear approvals for current project:\n```bash\nwt hook approvals clear\n```\n\nClear global approvals:\n```bash\nwt hook approvals clear --global\n```\n\n### How approvals work\n\nApproved commands are saved to user config. Re-approval is required when the command template changes or the project moves. Use `--yes` to bypass prompts in CI.\n\n### Command reference\n\nwt hook approvals - Manage command approvals\n\nUsage: <b><span class=c>wt hook approvals</span></b> <span class=c>[OPTIONS]</span> <span class=c>&lt;COMMAND&gt;</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>add</span></b>    Store approvals in config\n  <b><span class=c>clear</span></b>  Clear approved commands from config\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n",
        ".claude-plugin/skills/worktrunk/reference/list.md": "# wt list\n\nList worktrees and their status.\n\nShows uncommitted changes, divergence from the default branch and remote, and optional CI status.\n\nThe table renders progressively: branch names, paths, and commit hashes appear immediately, then status, divergence, and other columns fill in as background git operations complete. With `--full`, CI status fetches from the network ‚Äî the table displays instantly and CI fills in as results arrive.\n\n## Examples\n\nList all worktrees:\n\n<span class=\"cmd\">wt list</span>\n  <b>Branch</b>       <b>Status</b>        <b>HEAD¬±</b>    <b>main‚Üï</b>  <b>Remote‚áÖ</b>  <b>Commit</b>    <b>Age</b>   <b>Message</b>\n@ feature-api  <span class=c>+</span>   <span class=d>‚Üï</span><span class=d>‚á°</span>     <span class=g>+54</span>   <span class=r>-5</span>   <span class=g>‚Üë4</span>  <span class=d><span class=r>‚Üì1</span></span>   <span class=g>‚á°3</span>      <span class=d>6814f02a</span>  <span class=d>30m</span>   <span class=d>Add API tests</span>\n^ main             <span class=d>^</span><span class=d>‚áÖ</span>                         <span class=g>‚á°1</span>  <span class=d><span class=r>‚á£1</span></span>  <span class=d>41ee0834</span>  <span class=d>4d</span>    <span class=d>Merge fix-auth: hardened to‚Ä¶</span>\n+ fix-auth         <span class=d>‚Üï</span><span class=d>|</span>                <span class=g>‚Üë2</span>  <span class=d><span class=r>‚Üì1</span></span>     <span class=d>|</span>     <span class=d>b772e68b</span>  <span class=d>5h</span>    <span class=d>Add secure token storage</span>\n\n<span class=d>‚óã</span> <span class=d>Showing 3 worktrees, 1 with changes, 2 ahead, 1 column hidden</span>\n\nInclude CI status and line diffs:\n\n<span class=\"cmd\">wt list --full</span>\n  <b>Branch</b>       <b>Status</b>        <b>HEAD¬±</b>    <b>main‚Üï</b>     <b>main‚Ä¶¬±</b>  <b>Remote‚áÖ</b>  <b>CI</b>  <b>Commit</b>    <b>Age</b>   <b>Message</b>\n@ feature-api  <span class=c>+</span>   <span class=d>‚Üï</span><span class=d>‚á°</span>     <span class=g>+54</span>   <span class=r>-5</span>   <span class=g>‚Üë4</span>  <span class=d><span class=r>‚Üì1</span></span>  <span class=g>+234</span>  <span class=r>-24</span>   <span class=g>‚á°3</span>      <span class=d><span style='color:var(--blue,#00a)'>‚óè</span></span>   <span class=d>6814f02a</span>  <span class=d>30m</span>   <span class=d>Add API tests</span>\n^ main             <span class=d>^</span><span class=d>‚áÖ</span>                                    <span class=g>‚á°1</span>  <span class=d><span class=r>‚á£1</span></span>  <span class=g>‚óè</span>   <span class=d>41ee0834</span>  <span class=d>4d</span>    <span class=d>Merge fix-au‚Ä¶</span>\n+ fix-auth         <span class=d>‚Üï</span><span class=d>|</span>                <span class=g>‚Üë2</span>  <span class=d><span class=r>‚Üì1</span></span>   <span class=g>+25</span>  <span class=r>-11</span>     <span class=d>|</span>     <span class=g>‚óè</span>   <span class=d>b772e68b</span>  <span class=d>5h</span>    <span class=d>Add secure t‚Ä¶</span>\n\n<span class=d>‚óã</span> <span class=d>Showing 3 worktrees, 1 with changes, 2 ahead, 1 column hidden</span>\n\nInclude branches that don't have worktrees:\n\n<span class=\"cmd\">wt list --branches --full</span>\n  <b>Branch</b>       <b>Status</b>        <b>HEAD¬±</b>    <b>main‚Üï</b>     <b>main‚Ä¶¬±</b>  <b>Remote‚áÖ</b>  <b>CI</b>  <b>Commit</b>    <b>Age</b>   <b>Message</b>\n@ feature-api  <span class=c>+</span>   <span class=d>‚Üï</span><span class=d>‚á°</span>     <span class=g>+54</span>   <span class=r>-5</span>   <span class=g>‚Üë4</span>  <span class=d><span class=r>‚Üì1</span></span>  <span class=g>+234</span>  <span class=r>-24</span>   <span class=g>‚á°3</span>      <span class=d><span style='color:var(--blue,#00a)'>‚óè</span></span>   <span class=d>6814f02a</span>  <span class=d>30m</span>   <span class=d>Add API tests</span>\n^ main             <span class=d>^</span><span class=d>‚áÖ</span>                                    <span class=g>‚á°1</span>  <span class=d><span class=r>‚á£1</span></span>  <span class=g>‚óè</span>   <span class=d>41ee0834</span>  <span class=d>4d</span>    <span class=d>Merge fix-au‚Ä¶</span>\n+ fix-auth         <span class=d>‚Üï</span><span class=d>|</span>                <span class=g>‚Üë2</span>  <span class=d><span class=r>‚Üì1</span></span>   <span class=g>+25</span>  <span class=r>-11</span>     <span class=d>|</span>     <span class=g>‚óè</span>   <span class=d>b772e68b</span>  <span class=d>5h</span>    <span class=d>Add secure t‚Ä¶</span>\n  exp             <span class=d>/</span><span class=d>‚Üï</span>                 <span class=g>‚Üë2</span>  <span class=d><span class=r>‚Üì1</span></span>  <span class=g>+137</span>                    <span class=d>96379229</span>  <span class=d>2d</span>    <span class=d>Add GraphQL‚Ä¶</span>\n  wip             <span class=d>/</span><span class=d>‚Üï</span>                 <span class=g>‚Üë1</span>  <span class=d><span class=r>‚Üì1</span></span>   <span class=g>+33</span>                    <span class=d>b40716dc</span>  <span class=d>3d</span>    <span class=d>Start API do‚Ä¶</span>\n\n<span class=d>‚óã</span> <span class=d>Showing 3 worktrees, 2 branches, 1 with changes, 4 ahead, 1 column hidden</span>\n\nOutput as JSON for scripting:\n\n```bash\n$ wt list --format=json\n```\n\n## Columns\n\n| Column | Shows |\n|--------|-------|\n| Branch | Branch name |\n| Status | Compact symbols (see below) |\n| HEAD¬± | Uncommitted changes: +added -deleted lines |\n| main‚Üï | Commits ahead/behind default branch |\n| main‚Ä¶¬± | Line diffs since the merge-base with the default branch (`--full`) |\n| Path | Worktree directory |\n| Remote‚áÖ | Commits ahead/behind tracking branch |\n| URL | Dev server URL from project config (dimmed if port not listening) |\n| CI | Pipeline status (`--full`) |\n| Commit | Short hash (8 chars) |\n| Age | Time since last commit |\n| Message | Last commit message (truncated) |\n\nNote: `main‚Üï` and `main‚Ä¶¬±` refer to the default branch (header label stays `main` for compactness). `main‚Ä¶¬±` uses a merge-base (three-dot) diff.\n\n### CI status\n\nThe CI column shows GitHub/GitLab pipeline status:\n\n| Indicator | Meaning |\n|-----------|---------|\n| <span style='color:#0a0'>‚óè</span> green | All checks passed |\n| <span style='color:#00a'>‚óè</span> blue | Checks running |\n| <span style='color:#a00'>‚óè</span> red | Checks failed |\n| <span style='color:#a60'>‚óè</span> yellow | Merge conflicts with base |\n| <span style='color:#888'>‚óè</span> gray | No checks configured |\n| <span style='color:#a60'>‚ö†</span> yellow | Fetch error (rate limit, network) |\n| (blank) | No upstream or no PR/MR |\n\nCI indicators are clickable links to the PR or pipeline page. Any CI dot appears dimmed when there are unpushed local changes (stale status). PRs/MRs are checked first, then branch workflows/pipelines for branches with an upstream. Local-only branches show blank; remote-only branches (visible with `--remotes`) get CI status detection. Results are cached for 30-60 seconds; use `wt config state` to view or clear.\n\n## Status symbols\n\nThe Status column has multiple subcolumns. Within each, only the first matching symbol is shown (listed in priority order):\n\n| Subcolumn | Symbol | Meaning |\n|-----------|--------|---------|\n| Working tree (1) | `+` | Staged files |\n| Working tree (2) | `!` | Modified files (unstaged) |\n| Working tree (3) | `?` | Untracked files |\n| Worktree | `‚úò` | Merge conflicts |\n| | `‚§¥` | Rebase in progress |\n| | `‚§µ` | Merge in progress |\n| | `/` | Branch without worktree |\n| | `‚öë` | Branch-worktree mismatch (branch name doesn't match worktree path) |\n| | `‚äü` | Prunable (directory missing) |\n| | `‚äû` | Locked worktree |\n| Default branch | `^` | Is the default branch |\n| | `‚àÖ` | Orphan branch (no common ancestor with the default branch) |\n| | `‚úó` | Would conflict if merged to the default branch (with `--full`, includes uncommitted changes) |\n| | `_` | Same commit as the default branch, clean |\n| | `‚Äì` | Same commit as the default branch, uncommitted changes |\n| | `‚äÇ` | Content [integrated](https://worktrunk.dev/remove/#branch-cleanup) into the default branch or target |\n| | `‚Üï` | Diverged from the default branch |\n| | `‚Üë` | Ahead of the default branch |\n| | `‚Üì` | Behind the default branch |\n| Remote | `\\|` | In sync with remote |\n| | `‚áÖ` | Diverged from remote |\n| | `‚á°` | Ahead of remote |\n| | `‚á£` | Behind remote |\n\nRows are dimmed when [safe to delete](https://worktrunk.dev/remove/#branch-cleanup) (`_` same commit with clean working tree or `‚äÇ` content integrated).\n\n---\n\n## JSON output\n\nQuery structured data with `--format=json`:\n\n```bash\n# Current worktree path (for scripts)\nwt list --format=json | jq -r '.[] | select(.is_current) | .path'\n\n# Branches with uncommitted changes\nwt list --format=json | jq '.[] | select(.working_tree.modified)'\n\n# Worktrees with merge conflicts\nwt list --format=json | jq '.[] | select(.operation_state == \"conflicts\")'\n\n# Branches ahead of main (needs merging)\nwt list --format=json | jq '.[] | select(.main.ahead > 0) | .branch'\n\n# Integrated branches (safe to remove)\nwt list --format=json | jq '.[] | select(.main_state == \"integrated\" or .main_state == \"empty\") | .branch'\n\n# Branches without worktrees\nwt list --format=json --branches | jq '.[] | select(.kind == \"branch\") | .branch'\n\n# Worktrees ahead of remote (needs pushing)\nwt list --format=json | jq '.[] | select(.remote.ahead > 0) | {branch, ahead: .remote.ahead}'\n\n# Stale CI (local changes not reflected in CI)\nwt list --format=json --full | jq '.[] | select(.ci.stale) | .branch'\n```\n\n**Fields:**\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `branch` | string/null | Branch name (null for detached HEAD) |\n| `path` | string | Worktree path (absent for branches without worktrees) |\n| `kind` | string | `\"worktree\"` or `\"branch\"` |\n| `commit` | object | Commit info (see below) |\n| `working_tree` | object | Working tree state (see below) |\n| `main_state` | string | Relation to the default branch (see below) |\n| `integration_reason` | string | Why branch is integrated (see below) |\n| `operation_state` | string | `\"conflicts\"`, `\"rebase\"`, or `\"merge\"` (absent when clean) |\n| `main` | object | Relationship to the default branch (see below, absent when is_main) |\n| `remote` | object | Tracking branch info (see below, absent when no tracking) |\n| `worktree` | object | Worktree metadata (see below) |\n| `is_main` | boolean | Is the main worktree |\n| `is_current` | boolean | Is the current worktree |\n| `is_previous` | boolean | Previous worktree from wt switch |\n| `ci` | object | CI status (see below, absent when no CI) |\n| `url` | string | Dev server URL from project config (absent when not configured) |\n| `url_active` | boolean | Whether the URL's port is listening (absent when not configured) |\n| `statusline` | string | Pre-formatted status with ANSI colors |\n| `symbols` | string | Raw status symbols without colors (e.g., `\"!?‚Üì\"`) |\n\n### Commit object\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `sha` | string | Full commit SHA (40 chars) |\n| `short_sha` | string | Short commit SHA (7 chars) |\n| `message` | string | Commit message (first line) |\n| `timestamp` | number | Unix timestamp |\n\n### working_tree object\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `staged` | boolean | Has staged files |\n| `modified` | boolean | Has modified files (unstaged) |\n| `untracked` | boolean | Has untracked files |\n| `renamed` | boolean | Has renamed files |\n| `deleted` | boolean | Has deleted files |\n| `diff` | object | Lines changed vs HEAD: `{added, deleted}` |\n\n### main object\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `ahead` | number | Commits ahead of the default branch |\n| `behind` | number | Commits behind the default branch |\n| `diff` | object | Lines changed vs the default branch: `{added, deleted}` |\n\n### remote object\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `name` | string | Remote name (e.g., `\"origin\"`) |\n| `branch` | string | Remote branch name |\n| `ahead` | number | Commits ahead of remote |\n| `behind` | number | Commits behind remote |\n\n### worktree object\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `state` | string | `\"no_worktree\"`, `\"branch_worktree_mismatch\"`, `\"prunable\"`, `\"locked\"` (absent when normal) |\n| `reason` | string | Reason for locked/prunable state |\n| `detached` | boolean | HEAD is detached |\n\n### ci object\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `status` | string | CI status (see below) |\n| `source` | string | `\"pr\"` (PR/MR) or `\"branch\"` (branch workflow) |\n| `stale` | boolean | Local HEAD differs from remote (unpushed changes) |\n| `url` | string | URL to the PR/MR page |\n\n### main_state values\n\nThese values describe the relation to the default branch.\n\n`\"is_main\"` `\"orphan\"` `\"would_conflict\"` `\"empty\"` `\"same_commit\"` `\"integrated\"` `\"diverged\"` `\"ahead\"` `\"behind\"`\n\n### integration_reason values\n\nWhen `main_state == \"integrated\"`: `\"ancestor\"` `\"trees_match\"` `\"no_added_changes\"` `\"merge_adds_nothing\"`\n\n### ci.status values\n\n`\"passed\"` `\"running\"` `\"failed\"` `\"conflicts\"` `\"no-ci\"` `\"error\"`\n\nMissing a field that would be generally useful? [Open an issue](https://github.com/max-sixty/worktrunk/issues).\n\n## Command reference\n\nwt list - List worktrees and their status\n\nUsage: <b><span class=c>wt list</span></b> <span class=c>[OPTIONS]</span>\n       <b><span class=c>wt list</span></b> <span class=c>&lt;COMMAND&gt;</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>statusline</span></b>  Single-line status for shell prompts\n\n<b><span class=g>Options:</span></b>\n      <b><span class=c>--format</span></b><span class=c> &lt;FORMAT&gt;</span>\n          Output format (table, json)\n\n          [default: table]\n\n      <b><span class=c>--branches</span></b>\n          Include branches without worktrees\n\n      <b><span class=c>--remotes</span></b>\n          Include remote branches\n\n      <b><span class=c>--full</span></b>\n          Include CI status and diff analysis (slower)\n\n      <b><span class=c>--progressive</span></b>\n          Show fast info immediately, update with slow info\n\n          Displays local data (branches, paths, status) first, then updates with\n          remote data (CI, upstream) as it arrives. Auto-enabled for TTY.\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n",
        ".claude-plugin/skills/worktrunk/reference/llm-commits.md": "# LLM Commit Messages\n\nWorktrunk generates commit messages by building a templated prompt and piping it to an external command. This integrates with `wt merge`, `wt step commit`, and `wt step squash`.\n\n## Setup\n\nAny command that reads a prompt from stdin and outputs a commit message works. Add to `~/.config/worktrunk/config.toml`:\n\n### Claude Code\n\n```toml\n[commit.generation]\ncommand = \"MAX_THINKING_TOKENS=0 claude -p --model=haiku --tools='' --disable-slash-commands --setting-sources='' --system-prompt=''\"\n```\n\nThe flags disable tools, skills, settings, and system prompt for fast text-only output. See [Claude Code docs](https://docs.anthropic.com/en/docs/build-with-claude/claude-code) for installation.\n\n### llm\n\n```toml\n[commit.generation]\ncommand = \"llm -m claude-haiku-4.5\"\n```\n\nInstall with `uv tool install llm llm-anthropic && llm keys set anthropic`. See [llm docs](https://llm.datasette.io/).\n\n### aichat\n\n```toml\n[commit.generation]\ncommand = \"aichat -m claude:claude-haiku-4.5\"\n```\n\nSee [aichat docs](https://github.com/sigoden/aichat).\n\n### Codex\n\n```toml\n[commit.generation]\ncommand = \"codex exec -m gpt-5.1-codex-mini -c model_reasoning_effort='low' --sandbox=read-only --json - | jq -sr '[.[] | select(.item.type? == \\\"agent_message\\\")] | last.item.text'\"\n```\n\nUses the fast mini model with low reasoning effort. Requires `jq` for JSON parsing. See [Codex CLI docs](https://developers.openai.com/codex/cli/).\n\n## How it works\n\nWhen worktrunk needs a commit message, it builds a prompt from a template and pipes it to the configured command via shell (`sh -c`). Environment variables can be set inline in the command string.\n\n## Usage\n\nThese examples assume a feature worktree with changes to commit.\n\n### wt merge\n\nSquashes all changes (uncommitted + existing commits) into one commit with an LLM-generated message, then merges to the default branch:\n\n```bash\n$ wt merge\n‚óé Squashing 3 commits into a single commit (5 files, +48)...\n‚óé Generating squash commit message...\n   feat(auth): Implement JWT authentication system\n   ...\n```\n\n### wt step commit\n\nStages and commits with LLM-generated message:\n\n```bash\n$ wt step commit\n```\n\n### wt step squash\n\nSquashes branch commits into one with LLM-generated message:\n\n```bash\n$ wt step squash\n```\n\nSee [`wt merge`](https://worktrunk.dev/merge/) and [`wt step`](https://worktrunk.dev/step/) for full documentation.\n\n## Prompt templates\n\nWorktrunk uses [minijinja](https://docs.rs/minijinja/) templates (Jinja2-like syntax) to build prompts. There are sensible defaults, but templates are fully customizable.\n\n### Custom templates\n\nOverride the defaults with inline templates:\n\n```toml\n[commit.generation]\ncommand = \"llm -m claude-haiku-4.5\"\n\ntemplate = \"\"\"\nWrite a commit message for this diff. One line, under 50 chars.\n\nBranch: {{ branch }}\nDiff:\n{{ git_diff }}\n\"\"\"\n\nsquash-template = \"\"\"\nCombine these {{ commits | length }} commits into one message:\n{% for c in commits %}\n- {{ c }}\n{% endfor %}\n\nDiff:\n{{ git_diff }}\n\"\"\"\n```\n\n### Template variables\n\n| Variable | Description |\n|----------|-------------|\n| `{{ git_diff }}` | The diff (staged changes or combined diff for squash) |\n| `{{ git_diff_stat }}` | Diff statistics (files changed, insertions, deletions) |\n| `{{ branch }}` | Current branch name |\n| `{{ repo }}` | Repository name |\n| `{{ recent_commits }}` | Recent commit subjects (for style reference) |\n| `{{ commits }}` | Commits being squashed (squash template only) |\n| `{{ target_branch }}` | Merge target branch (squash template only) |\n\n### Template syntax\n\nTemplates use [minijinja](https://docs.rs/minijinja/latest/minijinja/syntax/index.html), which supports:\n\n- **Variables**: `{{ branch }}`, `{{ repo | upper }}`\n- **Filters**: `{{ commits | length }}`, `{{ repo | upper }}`\n- **Conditionals**: `{% if recent_commits %}...{% endif %}`\n- **Loops**: `{% for c in commits %}{{ c }}{% endfor %}`\n- **Loop variables**: `{{ loop.index }}`, `{{ loop.length }}`\n- **Whitespace control**: `{%- ... -%}` strips surrounding whitespace\n\nSee `wt config create --help` for the full default templates.\n\n## Fallback behavior\n\nWhen no LLM is configured, worktrunk generates deterministic messages based on changed filenames (e.g., \"Changes to auth.rs & config.rs\").\n",
        ".claude-plugin/skills/worktrunk/reference/merge.md": "# wt merge\n\nMerge current branch into target. Squash & rebase, fast-forward target, remove the worktree.\n\nUnlike `git merge`, this merges current into target (not target into current). Similar to clicking \"Merge pull request\" on GitHub, but locally. Target defaults to the default branch.\n\n## Examples\n\nMerge to the default branch:\n\n```bash\nwt merge\n```\n\nMerge to a different branch:\n\n```bash\nwt merge develop\n```\n\nKeep the worktree after merging:\n\n```bash\nwt merge --no-remove\n```\n\nPreserve commit history (no squash):\n\n```bash\nwt merge --no-squash\n```\n\nSkip committing/squashing (rebase still runs unless --no-rebase):\n\n```bash\nwt merge --no-commit\n```\n\n## Pipeline\n\n`wt merge` runs these steps:\n\n1. **Squash** ‚Äî Stages uncommitted changes, then combines all commits since target into one (like GitHub's \"Squash and merge\"). Use `--stage` to control what gets staged: `all` (default), `tracked`, or `none`. A backup ref is saved to `refs/wt-backup/<branch>`. With `--no-squash`, uncommitted changes become a separate commit and individual commits are preserved.\n2. **Rebase** ‚Äî Rebases onto target if behind. Skipped if already up-to-date. Conflicts abort immediately.\n3. **Pre-merge hooks** ‚Äî Hooks run after rebase, before merge. Failures abort. See [`wt hook`](https://worktrunk.dev/hook/).\n4. **Merge** ‚Äî Fast-forward merge to the target branch. Non-fast-forward merges are rejected.\n5. **Pre-remove hooks** ‚Äî Hooks run before removing worktree. Failures abort.\n6. **Cleanup** ‚Äî Removes the worktree and branch. Use `--no-remove` to keep the worktree. When already on the target branch or in the main worktree, the worktree is preserved.\n7. **Post-merge hooks** ‚Äî Hooks run after cleanup. Failures are logged but don't abort.\n\nUse `--no-commit` to skip committing uncommitted changes and squashing; rebase still runs by default and can rewrite commits unless `--no-rebase` is passed. Useful after preparing commits manually with `wt step`. Requires a clean working tree.\n\n## Local CI\n\nFor personal projects, pre-merge hooks open up the possibility of a workflow with much faster iteration ‚Äî an order of magnitude more small changes instead of fewer large ones.\n\nHistorically, ensuring tests ran before merging was difficult to enforce locally. Remote CI was valuable for the process as much as the checks: it guaranteed validation happened. `wt merge` brings that guarantee local.\n\nThe full workflow: start an agent (one of many) on a task, work elsewhere, return when it's ready. Review the diff, run `wt merge`, move on. Pre-merge hooks validate before merging ‚Äî if they pass, the branch goes to the default branch and the worktree cleans up.\n\n```toml\n[pre-merge]\ntest = \"cargo test\"\nlint = \"cargo clippy\"\n```\n\n## Command reference\n\nwt merge - Merge current branch into target\n\nSquash &amp; rebase, fast-forward target, remove the worktree.\n\nUsage: <b><span class=c>wt merge</span></b> <span class=c>[OPTIONS]</span> <span class=c>[TARGET]</span>\n\n<b><span class=g>Arguments:</span></b>\n  <span class=c>[TARGET]</span>\n          Target branch\n\n          Defaults to default branch.\n\n<b><span class=g>Options:</span></b>\n      <b><span class=c>--no-squash</span></b>\n          Skip commit squashing\n\n      <b><span class=c>--no-commit</span></b>\n          Skip commit and squash\n\n      <b><span class=c>--no-rebase</span></b>\n          Skip rebase (fail if not already rebased)\n\n      <b><span class=c>--no-remove</span></b>\n          Keep worktree after merge\n\n      <b><span class=c>--no-verify</span></b>\n          Skip hooks\n\n  <b><span class=c>-y</span></b>, <b><span class=c>--yes</span></b>\n          Skip approval prompts\n\n      <b><span class=c>--stage</span></b><span class=c> &lt;STAGE&gt;</span>\n          What to stage before committing [default: all]\n\n          Possible values:\n          - <b><span class=c>all</span></b>:     Stage everything: untracked files + unstaged tracked\n            changes\n          - <b><span class=c>tracked</span></b>: Stage tracked changes only (like <b>git add -u</b>)\n          - <b><span class=c>none</span></b>:    Stage nothing, commit only what&#39;s already in the index\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n",
        ".claude-plugin/skills/worktrunk/reference/remove.md": "# wt remove\n\nRemove worktree; delete branch if merged. Defaults to the current worktree.\n\n## Examples\n\nRemove current worktree:\n\n```bash\nwt remove\n```\n\nRemove specific worktrees:\n\n```bash\nwt remove feature-branch\nwt remove old-feature another-branch\n```\n\nKeep the branch:\n\n```bash\nwt remove --no-delete-branch feature-branch\n```\n\nForce-delete an unmerged branch:\n\n```bash\nwt remove -D experimental\n```\n\n## Branch cleanup\n\nBy default, branches are deleted when merging them would add nothing. This works with squash-merge and rebase workflows where commit history differs but file changes match.\n\nWorktrunk checks five conditions (in order of cost):\n\n1. **Same commit** ‚Äî Branch HEAD equals the default branch. Shows `_` in `wt list`.\n2. **Ancestor** ‚Äî Branch is in target's history (fast-forward or rebase case). Shows `‚äÇ`.\n3. **No added changes** ‚Äî Three-dot diff (`target...branch`) is empty. Shows `‚äÇ`.\n4. **Trees match** ‚Äî Branch tree SHA equals target tree SHA. Shows `‚äÇ`.\n5. **Merge adds nothing** ‚Äî Simulated merge produces the same tree as target. Handles squash-merged branches where target has advanced. Shows `‚äÇ`.\n\nThe 'same commit' check uses the local default branch; for other checks, 'target' means the default branch, or its upstream (e.g., `origin/main`) when strictly ahead.\n\nBranches showing `_` or `‚äÇ` are dimmed as safe to delete.\n\n## Force flags\n\nWorktrunk has two force flags for different situations:\n\n| Flag | Scope | When to use |\n|------|-------|-------------|\n| `--force` (`-f`) | Worktree | Worktree has untracked files (build artifacts, IDE config) |\n| `--force-delete` (`-D`) | Branch | Branch has unmerged commits |\n\n```bash\nwt remove feature --force       # Remove worktree with untracked files\nwt remove feature -D            # Delete unmerged branch\nwt remove feature --force -D    # Both\n```\n\nWithout `--force`, removal fails if the worktree contains untracked files. Without `-D`, removal keeps branches with unmerged changes. Use `--no-delete-branch` to keep the branch regardless of merge status.\n\n## Background removal\n\nRemoval runs in the background by default (returns immediately). Logs are written to `.git/wt-logs/{branch}-remove.log`. Use `--foreground` to run in the foreground.\n\n## Hooks\n\n`pre-remove` hooks run before the worktree is deleted (with access to worktree files). `post-remove` hooks run after removal. See [`wt hook`](https://worktrunk.dev/hook/) for configuration.\n\n## Command reference\n\nwt remove - Remove worktree; delete branch if merged\n\nDefaults to the current worktree.\n\nUsage: <b><span class=c>wt remove</span></b> <span class=c>[OPTIONS]</span> <span class=c>[BRANCHES]...</span>\n\n<b><span class=g>Arguments:</span></b>\n  <span class=c>[BRANCHES]...</span>\n          Branch name [default: current]\n\n<b><span class=g>Options:</span></b>\n      <b><span class=c>--no-delete-branch</span></b>\n          Keep branch after removal\n\n  <b><span class=c>-D</span></b>, <b><span class=c>--force-delete</span></b>\n          Delete unmerged branches\n\n      <b><span class=c>--foreground</span></b>\n          Run removal in foreground (block until complete)\n\n      <b><span class=c>--no-verify</span></b>\n          Skip hooks\n\n  <b><span class=c>-y</span></b>, <b><span class=c>--yes</span></b>\n          Skip approval prompts\n\n  <b><span class=c>-f</span></b>, <b><span class=c>--force</span></b>\n          Force worktree removal\n\n          Remove worktrees even if they contain untracked files (like build\n          artifacts). Without this flag, removal fails if untracked files exist.\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n",
        ".claude-plugin/skills/worktrunk/reference/select.md": "# wt select\n\nInteractive worktree selector. Browse and switch worktrees with live preview.\n\n## Examples\n\nOpen the selector:\n\n```bash\nwt select\n```\n\n## Preview tabs\n\nToggle between views with number keys:\n\n1. **HEAD¬±** ‚Äî Diff of uncommitted changes\n2. **log** ‚Äî Recent commits; commits already on the default branch have dimmed hashes\n3. **main‚Ä¶¬±** ‚Äî Diff of changes since the merge-base with the default branch\n4. **remote‚áÖ** ‚Äî Diff vs upstream tracking branch (ahead/behind)\n\n## Keybindings\n\n| Key | Action |\n|-----|--------|\n| `‚Üë`/`‚Üì` | Navigate worktree list |\n| `Enter` | Switch to selected worktree |\n| `Esc` | Cancel |\n| (type) | Filter worktrees |\n| `1`/`2`/`3`/`4` | Switch preview tab |\n| `Alt-p` | Toggle preview panel |\n| `Ctrl-u`/`Ctrl-d` | Scroll preview up/down |\n\nWith `--branches`, branches without worktrees are included ‚Äî selecting one creates a worktree. This matches `wt list --branches`.\n\n## Configuration\n\n### Pager\n\nThe preview panel pipes diff output through git's pager (typically `less` or `delta`). Override pager behavior in user config:\n\n```toml\n[select]\npager = \"delta --paging=never\"\n```\n\nThis is useful when the default pager doesn't render correctly in the embedded preview panel.\n\n## Command reference\n\nwt select - Interactive worktree selector\n\nBrowse and switch worktrees with live preview.\n\nUsage: <b><span class=c>wt select</span></b> <span class=c>[OPTIONS]</span>\n\n<b><span class=g>Options:</span></b>\n      <b><span class=c>--branches</span></b>\n          Include branches without worktrees\n\n      <b><span class=c>--remotes</span></b>\n          Include remote branches\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n",
        ".claude-plugin/skills/worktrunk/reference/shell-integration.md": "# Shell Integration Reference\n\nHow Worktrunk's shell integration works and how to debug issues.\n\n## Why Shell Integration Exists\n\nSubprocesses cannot change the parent shell's current directory. When\n`wt switch feature` runs, the `wt` binary runs as a child process and cannot\n`cd` the terminal.\n\nWorktrunk solves this with **directive file passing**:\n\n1. Shell wrapper creates a temp file via `mktemp`\n2. Shell sets `WORKTRUNK_DIRECTIVE_FILE` env var to the temp file path\n3. `wt` binary writes shell commands (like `cd '/path'`) to that file\n4. Shell sources the file after `wt` exits, executing the commands\n5. Shell removes the temp file\n\nThis allows `wt switch` to change the terminal's directory.\n\n## Installation\n\n```bash\n# Auto-install for all shells (bash, zsh, fish, PowerShell)\nwt config shell install\n\n# Or manual installation - add to the shell config:\n# bash (~/.bashrc):\neval \"$(wt config shell init bash)\"\n\n# zsh (~/.zshrc):\neval \"$(wt config shell init zsh)\"\n\n# fish (~/.config/fish/config.fish):\nwt config shell init fish | source\n\n# PowerShell ($PROFILE):\nInvoke-Expression (& wt config shell init powershell | Out-String)\n```\n\n## Checking Status\n\n```bash\n# Show shell integration status\nwt config show\n```\n\nThe RUNTIME section shows whether shell integration is active for the current\nsession.\n\n## Warning Messages\n\nWhen shell integration isn't working, `wt switch` shows warnings explaining why.\n\n### \"shell integration not installed\"\n\n**Meaning**: The shell config file doesn't have the `eval \"$(wt config shell init ...)\"` line.\n\n**Fix**: Run `wt config shell install` or add the line manually.\n\n### \"shell requires restart\"\n\n**Meaning**: Shell integration is configured, but the current shell session was\nstarted before installation. The shell function isn't loaded yet.\n\n**Fix**: Start a new terminal or run `source ~/.bashrc` (or equivalent).\n\n### \"ran ./path/to/wt; shell integration wraps wt\"\n\n**Meaning**: The binary was invoked with an explicit path (like `./target/debug/wt`\nor `/usr/local/bin/wt`) instead of just `wt`. The shell wrapper only intercepts\nthe bare command `wt`.\n\n**Fix**: Use `wt` without a path. For testing dev builds, set `WORKTRUNK_BIN`:\n```bash\nexport WORKTRUNK_BIN=./target/debug/wt\nwt switch feature  # Now uses the dev build with shell integration\n```\n\n### \"ran git wt; running through git prevents cd\"\n\n**Meaning**: `git wt` (git alias) was used instead of `wt`. Git runs worktrunk as\na subprocess, bypassing the shell wrapper.\n\n**Fix**: Use `wt` directly instead of `git wt` when directory switching is needed.\n\n### \"Alias bypasses shell integration\"\n\n**Meaning**: An alias like `alias gwt=\"/usr/bin/wt\"` or `alias gwt=\"wt.exe\"`\npoints directly to the binary instead of the shell function.\n\nWhen shell integration is installed, it creates a shell function named `wt` (or\n`git-wt`). If the alias points to the binary path, it bypasses this function\nand shell integration won't work.\n\n**Examples that bypass** (won't auto-cd):\n```bash\nalias gwt=\"/usr/bin/wt\"\nalias gwt=\"wt.exe\"\nalias wt=\"/path/to/wt\"\n```\n\n**Fix**: Change the alias to point to the function name instead of the binary:\n```bash\nalias gwt=\"wt\"       # Good - uses the shell function\nalias gwt=\"git-wt\"   # Good - uses the shell function\n```\n\n`wt config show` detects these problematic aliases and shows a warning with the\nsuggested fix.\n\n## How the Shell Wrapper Works\n\nThe shell wrapper (installed by `wt config shell install`) defines a shell\nfunction that:\n\n1. Creates a temp file for directives\n2. Sets `WORKTRUNK_DIRECTIVE_FILE` to that path\n3. Runs the real `wt` binary\n4. Sources the directive file (executes `cd` commands)\n5. Cleans up the temp file\n\nSimplified example (actual wrapper handles completions and edge cases):\n```bash\nwt() {\n    local directive_file\n    directive_file=\"$(mktemp)\"\n\n    WORKTRUNK_DIRECTIVE_FILE=\"$directive_file\" command wt \"$@\" || exit_code=$?\n\n    if [[ -s \"$directive_file\" ]]; then\n        source \"$directive_file\"\n    fi\n\n    rm -f \"$directive_file\"\n    return \"$exit_code\"\n}\n```\n\n## Debugging Checklist\n\n### 1. Check if wrapper is installed\n\n```bash\n# Should show shell function, not binary path\ntype wt\n\n# Expected output (bash/zsh):\n# wt is a function\n# wt () { ... }\n\n# If it shows a path like /usr/local/bin/wt, wrapper isn't loaded\n```\n\n### 2. Check shell config file\n\n```bash\n# bash\ngrep -n \"wt config shell init\" ~/.bashrc\n\n# zsh\ngrep -n \"wt config shell init\" ~/.zshrc\n\n# fish\ngrep -n \"wt config shell init\" ~/.config/fish/config.fish\n```\n\nShould show the `eval` line with line number.\n\n### 3. Check if directive file is set\n\n```bash\n# After running any wt command, this should be unset (temp file deleted)\necho $WORKTRUNK_DIRECTIVE_FILE\n\n# During wt execution, this would be set to a temp file path\n```\n\n### 4. Test directive file manually\n\n```bash\n# Create a temp file and test\nexport WORKTRUNK_DIRECTIVE_FILE=$(mktemp)\ncommand wt switch feature\ncat $WORKTRUNK_DIRECTIVE_FILE  # Should contain: cd '/path/to/worktree'\nsource $WORKTRUNK_DIRECTIVE_FILE  # Should cd you there\nrm $WORKTRUNK_DIRECTIVE_FILE\n```\n\n## Common Issues\n\n### Shell integration works in terminal but not in IDE terminal\n\nIDE terminals may use different shell configs. Check:\n- VS Code: Settings ‚Üí Terminal ‚Üí Integrated ‚Üí Shell Args\n- The IDE terminal might source a different profile\n\n### Completions not working\n\nCompletions are installed alongside shell integration. If they're missing:\n\n```bash\n# Reinstall (forces regeneration)\nwt config shell install\n\n# For zsh, you may need compinit before the wt line:\nautoload -Uz compinit && compinit\neval \"$(wt config shell init zsh)\"\n```\n\n### Windows Git Bash issues\n\nGit Bash uses MSYS2, which automatically converts POSIX paths in environment\nvariables. The directive file path is handled correctly without manual conversion.\n\nIf you see path issues, ensure you're using a recent Git for Windows version.\n\n## Environment Variables\n\n| Variable | Purpose |\n|----------|---------|\n| `WORKTRUNK_DIRECTIVE_FILE` | Set by shell wrapper; path to temp file for directives |\n| `WORKTRUNK_BIN` | Override binary path (for testing dev builds) |\n| `WORKTRUNK_SHELL` | Set by PowerShell wrapper to indicate shell type |\n\n## See Also\n\n- `wt config shell --help` ‚Äî Shell integration commands\n- `wt config show` ‚Äî View current configuration and status\n",
        ".claude-plugin/skills/worktrunk/reference/step.md": "# wt step\n\nRun individual operations. The building blocks of wt merge ‚Äî commit, squash, rebase, push ‚Äî plus standalone utilities.\n\n## Examples\n\nCommit with LLM-generated message:\n\n```bash\nwt step commit\n```\n\nManual merge workflow with review between steps:\n\n```bash\nwt step commit\nwt step squash\nwt step rebase\nwt step push\n```\n\n## Operations\n\n- `commit` ‚Äî Stage and commit with [LLM-generated message](https://worktrunk.dev/llm-commits/)\n- `squash` ‚Äî Squash all branch commits into one with [LLM-generated message](https://worktrunk.dev/llm-commits/)\n- `rebase` ‚Äî Rebase onto target branch\n- `push` ‚Äî Fast-forward target to current branch\n- `copy-ignored` ‚Äî Copy gitignored files between worktrees\n- `for-each` ‚Äî [experimental] Run a command in every worktree\n\n## Command reference\n\nwt step - Run individual operations\n\nThe building blocks of <b>wt merge</b> ‚Äî commit, squash, rebase, push ‚Äî plus standalone\nutilities.\n\nUsage: <b><span class=c>wt step</span></b> <span class=c>[OPTIONS]</span> <span class=c>&lt;COMMAND&gt;</span>\n\n<b><span class=g>Commands:</span></b>\n  <b><span class=c>commit</span></b>        Stage and commit with LLM-generated message\n  <b><span class=c>squash</span></b>        Squash commits since branching\n  <b><span class=c>push</span></b>          Fast-forward target to current branch\n  <b><span class=c>rebase</span></b>        Rebase onto target\n  <b><span class=c>copy-ignored</span></b>  Copy gitignored files to another worktree\n  <b><span class=c>for-each</span></b>      [experimental] Run command in each worktree\n  <b><span class=c>relocate</span></b>      [experimental] Move worktrees to expected paths\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n# Subcommands\n\n## wt step commit\n\nStage and commit with LLM-generated message.\n\nStages all changes (including untracked files) and commits with an [LLM-generated message](https://worktrunk.dev/llm-commits/).\n\n### Options\n\n#### `--stage`\n\nControls what to stage before committing:\n\n| Value | Behavior |\n|-------|----------|\n| `all` | Stage all changes including untracked files (default) |\n| `tracked` | Stage only modified tracked files |\n| `none` | Don't stage anything, commit only what's already staged |\n\n```bash\nwt step commit --stage=tracked\n```\n\nConfigure the default in user config:\n\n```toml\n[commit]\nstage = \"tracked\"\n```\n\n#### `--show-prompt`\n\nOutput the rendered LLM prompt to stdout without running the command. Useful for inspecting prompt templates or piping to other tools:\n\n```bash\n# Inspect the rendered prompt\nwt step commit --show-prompt | less\n\n# Pipe to a different LLM\nwt step commit --show-prompt | llm -m gpt-5-nano\n```\n\n### Command reference\n\nwt step commit - Stage and commit with LLM-generated message\n\nUsage: <b><span class=c>wt step commit</span></b> <span class=c>[OPTIONS]</span>\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-y</span></b>, <b><span class=c>--yes</span></b>\n          Skip approval prompts\n\n      <b><span class=c>--no-verify</span></b>\n          Skip hooks\n\n      <b><span class=c>--stage</span></b><span class=c> &lt;STAGE&gt;</span>\n          What to stage before committing [default: all]\n\n          Possible values:\n          - <b><span class=c>all</span></b>:     Stage everything: untracked files + unstaged tracked\n            changes\n          - <b><span class=c>tracked</span></b>: Stage tracked changes only (like <b>git add -u</b>)\n          - <b><span class=c>none</span></b>:    Stage nothing, commit only what&#39;s already in the index\n\n      <b><span class=c>--show-prompt</span></b>\n          Show prompt without running LLM\n\n          Outputs the rendered prompt to stdout for debugging or manual piping.\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n## wt step squash\n\nSquash commits since branching. Stages changes and generates message with LLM.\n\nStages all changes (including untracked files), then squashes all commits since diverging from the target branch into a single commit with an [LLM-generated message](https://worktrunk.dev/llm-commits/).\n\n### Options\n\n#### `--stage`\n\nControls what to stage before squashing:\n\n| Value | Behavior |\n|-------|----------|\n| `all` | Stage all changes including untracked files (default) |\n| `tracked` | Stage only modified tracked files |\n| `none` | Don't stage anything, squash only committed changes |\n\n```bash\nwt step squash --stage=none\n```\n\nConfigure the default in user config:\n\n```toml\n[commit]\nstage = \"tracked\"\n```\n\n#### `--show-prompt`\n\nOutput the rendered LLM prompt to stdout without running the command. Useful for inspecting prompt templates or piping to other tools:\n\n```bash\nwt step squash --show-prompt | less\n```\n\n### Command reference\n\nwt step squash - Squash commits since branching\n\nStages changes and generates message with LLM.\n\nUsage: <b><span class=c>wt step squash</span></b> <span class=c>[OPTIONS]</span> <span class=c>[TARGET]</span>\n\n<b><span class=g>Arguments:</span></b>\n  <span class=c>[TARGET]</span>\n          Target branch\n\n          Defaults to default branch.\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-y</span></b>, <b><span class=c>--yes</span></b>\n          Skip approval prompts\n\n      <b><span class=c>--no-verify</span></b>\n          Skip hooks\n\n      <b><span class=c>--stage</span></b><span class=c> &lt;STAGE&gt;</span>\n          What to stage before committing [default: all]\n\n          Possible values:\n          - <b><span class=c>all</span></b>:     Stage everything: untracked files + unstaged tracked\n            changes\n          - <b><span class=c>tracked</span></b>: Stage tracked changes only (like <b>git add -u</b>)\n          - <b><span class=c>none</span></b>:    Stage nothing, commit only what&#39;s already in the index\n\n      <b><span class=c>--show-prompt</span></b>\n          Show prompt without running LLM\n\n          Outputs the rendered prompt to stdout for debugging or manual piping.\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n## wt step copy-ignored\n\nCopy gitignored files to another worktree. Eliminates cold starts by copying build caches and dependencies.\n\nGit worktrees share the repository but not untracked files. This command copies gitignored files to another worktree, eliminating cold starts.\n\n### Setup\n\nAdd to the project config:\n\n```toml\n# .config/wt.toml\n[post-start]\ncopy = \"wt step copy-ignored\"\n```\n\n### What gets copied\n\nAll gitignored files are copied by default. Tracked files are never touched.\n\nTo limit what gets copied, create `.worktreeinclude` with gitignore-style patterns. Files must be **both** gitignored **and** in `.worktreeinclude`:\n\n```gitignore\n# .worktreeinclude\n.env\nnode_modules/\ntarget/\n```\n\n### Common patterns\n\n| Type | Patterns |\n|------|----------|\n| Dependencies | `node_modules/`, `.venv/`, `target/`, `vendor/`, `Pods/` |\n| Build caches | `.cache/`, `.next/`, `.parcel-cache/`, `.turbo/` |\n| Generated assets | Images, ML models, binaries too large for git |\n| Environment files | `.env` (if not generated per-worktree) |\n\n### Features\n\n- Uses copy-on-write (reflink) when available for space-efficient copies\n- Handles nested `.gitignore` files, global excludes, and `.git/info/exclude`\n- Skips existing files (safe to re-run)\n- Skips `.git` entries and other worktrees\n\n### Performance\n\nReflink copies share disk blocks until modified ‚Äî no data is actually copied. For a 14GB `target/` directory:\n\n| Command | Time |\n|---------|------|\n| `cp -R` (full copy) | 2m |\n| `cp -Rc` / `wt step copy-ignored` | 20s |\n\nUses per-file reflink (like `cp -Rc`) ‚Äî copy time scales with file count.\n\nUse the `post-start` hook so the copy runs in the background. Use `post-create` instead if subsequent hooks or `--execute` command need the copied files immediately.\n\n### Language-specific notes\n\n#### Rust\n\nThe `target/` directory is huge (often 1-10GB). Copying with reflink cuts first build from ~68s to ~3s by reusing compiled dependencies.\n\n#### Node.js\n\n`node_modules/` is large but mostly static. If the project has no native dependencies, symlinks are even faster:\n\n```toml\n[post-create]\ndeps = \"ln -sf {{ primary_worktree_path }}/node_modules .\"\n```\n\n#### Python\n\nVirtual environments contain absolute paths and can't be copied. Use `uv sync` instead ‚Äî it's fast enough that copying isn't worth it.\n\n### Behavior vs Claude Code on desktop\n\nThe `.worktreeinclude` pattern is shared with [Claude Code on desktop](https://code.claude.com/docs/en/desktop), which copies matching files when creating worktrees. Differences:\n\n- worktrunk copies all gitignored files by default; Claude Code requires `.worktreeinclude`\n- worktrunk uses copy-on-write for large directories like `target/` ‚Äî potentially 30x faster on macOS, 6x on Linux\n- worktrunk runs as a configurable hook in the worktree lifecycle\n\n### Command reference\n\nwt step copy-ignored - Copy gitignored files to another worktree\n\nEliminates cold starts by copying build caches and dependencies.\n\nUsage: <b><span class=c>wt step copy-ignored</span></b> <span class=c>[OPTIONS]</span>\n\n<b><span class=g>Options:</span></b>\n      <b><span class=c>--from</span></b><span class=c> &lt;FROM&gt;</span>\n          Source worktree branch\n\n          Defaults to main worktree.\n\n      <b><span class=c>--to</span></b><span class=c> &lt;TO&gt;</span>\n          Destination worktree branch\n\n          Defaults to current worktree.\n\n      <b><span class=c>--dry-run</span></b>\n          Show what would be copied\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n\n## wt step for-each\n\n[experimental] Run command in each worktree. Executes sequentially with real-time output; continues on failure.\n\nExecutes a command sequentially in every worktree with real-time output. Continues on failure and shows a summary at the end.\n\nContext JSON is piped to stdin for scripts that need structured data.\n\n### Template variables\n\nAll variables are shell-escaped. See [`wt hook` template variables](https://worktrunk.dev/hook/#template-variables) for the complete list and filters.\n\n### Examples\n\nCheck status across all worktrees:\n\n```bash\nwt step for-each -- git status --short\n```\n\nRun npm install in all worktrees:\n\n```bash\nwt step for-each -- npm install\n```\n\nUse branch name in command:\n\n```bash\nwt step for-each -- \"echo Branch: {{ branch }}\"\n```\n\nPull updates in worktrees with upstreams (skips others):\n\n```bash\ngit fetch --prune && wt step for-each -- '[ \"$(git rev-parse @{u} 2>/dev/null)\" ] || exit 0; git pull --autostash'\n```\n\nNote: This command is experimental and may change in future versions.\n\n### Command reference\n\nwt step for-each - [experimental] Run command in each worktree\n\nExecutes sequentially with real-time output; continues on failure.\n\nUsage: <b><span class=c>wt step for-each</span></b> <span class=c>[OPTIONS]</span> <b><span class=c>--</span></b> <span class=c>&lt;ARGS&gt;...</span>\n\n<b><span class=g>Arguments:</span></b>\n  <span class=c>&lt;ARGS&gt;...</span>\n          Command template (see --help for all variables)\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n",
        ".claude-plugin/skills/worktrunk/reference/switch.md": "# wt switch\n\nSwitch to a worktree. Creates one if needed.\n\nWorktrees are addressed by branch name; paths are computed from a configurable template. Unlike `git switch`, this navigates between worktrees rather than changing branches in place.\n\n## Examples\n\n```bash\nwt switch feature-auth           # Switch to worktree\nwt switch -                      # Previous worktree (like cd -)\nwt switch --create new-feature   # Create new branch and worktree\nwt switch --create hotfix --base production\nwt switch pr:123                 # Switch to PR #123's branch\n```\n\n## Creating a branch\n\nThe `--create` flag creates a new branch from the `--base` branch (defaults to default branch). Without `--create`, the branch must already exist.\n\n**Upstream tracking:** Branches created with `--create` have no upstream tracking configured. This prevents accidental pushes to the wrong branch ‚Äî for example, `--base origin/main` would otherwise make `git push` target `main`. Use `git push -u origin <branch>` to set up tracking when you're ready.\n\nWithout `--create`, switching to a remote branch (e.g., `wt switch feature` when only `origin/feature` exists) creates a local branch tracking the remote ‚Äî this is the standard git behavior and is preserved.\n\n## Creating worktrees\n\nIf the branch already has a worktree, `wt switch` changes directories to it. Otherwise, it creates one, running [hooks](https://worktrunk.dev/hook/).\n\nWhen creating a worktree, worktrunk:\n\n1. Creates worktree at configured path\n2. Switches to new directory\n3. Runs [post-create hooks](https://worktrunk.dev/hook/#post-create) (blocking)\n4. Spawns [post-start hooks](https://worktrunk.dev/hook/#post-start) (background)\n\n```bash\nwt switch feature                        # Existing branch ‚Üí creates worktree\nwt switch --create feature               # New branch and worktree\nwt switch --create fix --base release    # New branch from release\nwt switch --create temp --no-verify      # Skip hooks\n```\n\n## Shortcuts\n\n| Shortcut | Meaning |\n|----------|---------|\n| `^` | Default branch (`main`/`master`) |\n| `@` | Current branch/worktree |\n| `-` | Previous worktree (like `cd -`) |\n| `pr:{N}` | GitHub PR #N's branch |\n| `mr:{N}` | GitLab MR !N's branch |\n\n```bash\nwt switch -                      # Back to previous\nwt switch ^                      # Default branch worktree\nwt switch --create fix --base=@  # Branch from current HEAD\nwt switch pr:123                 # PR #123's branch\nwt switch mr:101                 # MR !101's branch\n```\n\n## GitHub pull requests (experimental)\n\nThe `pr:<number>` syntax resolves the branch for a GitHub pull request. For same-repo PRs, it switches to the branch directly. For fork PRs, it fetches `refs/pull/N/head` and configures `pushRemote` to the fork URL.\n\n```bash\nwt switch pr:101                 # Checkout PR #101\n```\n\nRequires `gh` CLI to be installed and authenticated. The `--create` flag cannot be used with `pr:` syntax since the branch already exists.\n\n**Fork PRs:** The local branch uses the PR's branch name directly (e.g., `feature-fix`), so `git push` works normally. If a local branch with that name already exists tracking something else, rename it first.\n\n## GitLab merge requests (experimental)\n\nThe `mr:<number>` syntax resolves the branch for a GitLab merge request. For same-project MRs, it switches to the branch directly. For fork MRs, it fetches `refs/merge-requests/N/head` and configures `pushRemote` to the fork URL.\n\n```bash\nwt switch mr:101                 # Checkout MR !101\n```\n\nRequires `glab` CLI to be installed and authenticated. The `--create` flag cannot be used with `mr:` syntax since the branch already exists.\n\n**Fork MRs:** The local branch uses the MR's branch name directly, so `git push` works normally. If a local branch with that name already exists tracking something else, rename it first.\n\n## When wt switch fails\n\n- **Branch doesn't exist** ‚Äî Use `--create`, or check `wt list --branches`\n- **Path occupied** ‚Äî Another worktree is at the target path; switch to it or remove it\n- **Stale directory** ‚Äî Use `--clobber` to remove a non-worktree directory at the target path\n\nTo change which branch a worktree is on, use `git switch` inside that worktree.\n\n## Command reference\n\nwt switch - Switch to a worktree\n\nCreates one if needed.\n\nUsage: <b><span class=c>wt switch</span></b> <span class=c>[OPTIONS]</span> <span class=c>&lt;BRANCH&gt;</span> <b><span class=c>[--</span></b> <span class=c>&lt;EXECUTE_ARGS&gt;...</span><b><span class=c>]</span></b>\n\n<b><span class=g>Arguments:</span></b>\n  <span class=c>&lt;BRANCH&gt;</span>\n          Branch name or shortcut\n\n          Shortcuts: &#39;^&#39; (default branch), &#39;-&#39; (previous), &#39;@&#39; (current),\n          &#39;pr:{N}&#39; (GitHub PR), &#39;mr:{N}&#39; (GitLab MR)\n\n  <span class=c>[EXECUTE_ARGS]...</span>\n          Additional arguments for --execute command (after --)\n\n          Arguments after <b>--</b> are appended to the execute command. Each argument\n          is expanded for templates, then POSIX shell-escaped.\n\n<b><span class=g>Options:</span></b>\n  <b><span class=c>-c</span></b>, <b><span class=c>--create</span></b>\n          Create a new branch\n\n  <b><span class=c>-b</span></b>, <b><span class=c>--base</span></b><span class=c> &lt;BASE&gt;</span>\n          Base branch\n\n          Defaults to default branch.\n\n  <b><span class=c>-x</span></b>, <b><span class=c>--execute</span></b><span class=c> &lt;EXECUTE&gt;</span>\n          Command to run after switch\n\n          Replaces the wt process with the command after switching, giving it\n          full terminal control. Useful for launching editors, AI agents, or\n          other interactive tools.\n\n          Supports <u>hook template variables</u> (<b>{{ branch }}</b>, <b>{{ worktree_path }}</b>,\n          etc.) and filters. <b>{{ base }}</b> and <b>{{ base_worktree_path }}</b> require\n          --create.\n\n          Especially useful with shell aliases:\n\n            <b>alias wsc=&#39;wt switch --create -x claude&#39;</b>\n            <b>wsc feature-branch -- &#39;Fix GH #322&#39;</b>\n\n          Then <b>wsc feature-branch</b> creates the worktree and launches Claude Code.\n          Arguments after <b>--</b> are passed to the command, so <b>wsc feature -- &#39;Fix</b>\n          GH #322&#39; runs <b>claude &#39;Fix GH #322&#39;</b>, starting Claude with a prompt.\n\n          Template example: <b>-x &#39;code {{ worktree_path }}&#39;</b> opens VS Code at the\n          worktree, <b>-x &#39;tmux new -s {{ branch | sanitize }}&#39;</b> starts a tmux\n          session named after the branch.\n\n  <b><span class=c>-y</span></b>, <b><span class=c>--yes</span></b>\n          Skip approval prompts\n\n      <b><span class=c>--clobber</span></b>\n          Remove stale paths at target\n\n      <b><span class=c>--no-verify</span></b>\n          Skip hooks\n\n  <b><span class=c>-h</span></b>, <b><span class=c>--help</span></b>\n          Print help (see a summary with &#39;-h&#39;)\n\n<b><span class=g>Global Options:</span></b>\n  <b><span class=c>-C</span></b><span class=c> &lt;path&gt;</span>\n          Working directory for this command\n\n      <b><span class=c>--config</span></b><span class=c> &lt;path&gt;</span>\n          User config file path\n\n  <b><span class=c>-v</span></b>, <b><span class=c>--verbose</span></b><span class=c>...</span>\n          Verbose output (-v: hooks, templates; -vv: debug report)\n",
        ".claude-plugin/skills/worktrunk/reference/tips-patterns.md": "# Tips & Patterns\n\nPractical recipes for common Worktrunk workflows.\n\n## Alias for new worktree + agent\n\nCreate a worktree and launch Claude in one command:\n\n```bash\nalias wsc='wt switch --create --execute=claude'\nwsc new-feature                       # Creates worktree, runs hooks, launches Claude\nwsc feature -- 'Fix GH #322'          # Runs `claude 'Fix GH #322'`\n```\n\n## Eliminate cold starts\n\nUse [`wt step copy-ignored`](https://worktrunk.dev/step/#wt-step-copy-ignored) to copy gitignored files (caches, dependencies, `.env`) between worktrees:\n\n```toml\n[post-start]\ncopy = \"wt step copy-ignored\"\n```\n\nUse `post-create` instead if subsequent hooks or `--execute` command need the copied files immediately.\n\nAll gitignored files are copied by default. To limit what gets copied, create `.worktreeinclude` with patterns ‚Äî files must be both gitignored and listed. See [`wt step copy-ignored`](https://worktrunk.dev/step/#wt-step-copy-ignored) for details.\n\n## Dev server per worktree\n\nEach worktree runs its own dev server on a deterministic port. The `hash_port` filter generates a stable port (10000-19999) from the branch name:\n\n```toml\n# .config/wt.toml\n[post-start]\nserver = \"npm run dev -- --port {{ branch | hash_port }}\"\n\n[list]\nurl = \"http://localhost:{{ branch | hash_port }}\"\n\n[pre-remove]\nserver = \"lsof -ti :{{ branch | hash_port }} | xargs kill 2>/dev/null || true\"\n```\n\nThe URL column in `wt list` shows each worktree's dev server:\n\n<span class=\"cmd\">wt list</span>\n  <b>Branch</b>       <b>Status</b>        <b>HEAD¬±</b>    <b>main‚Üï</b>  <b>Remote‚áÖ</b>  <b>URL</b>                     <b>Commit</b>    <b>Age</b>\n@ main           <span class=c>?</span> <span class=d>^</span><span class=d>‚áÖ</span>                         <span class=g>‚á°1</span>  <span class=d><span class=r>‚á£1</span></span>  <span class=d>http://localhost:12107</span>  <span class=d>41ee0834</span>  <span class=d>4d</span>\n+ feature-api  <span class=c>+</span>   <span class=d>‚Üï</span><span class=d>‚á°</span>     <span class=g>+54</span>   <span class=r>-5</span>   <span class=g>‚Üë4</span>  <span class=d><span class=r>‚Üì1</span></span>   <span class=g>‚á°3</span>      <span class=d>http://localhost:10703</span>  <span class=d>6814f02a</span>  <span class=d>30m</span>\n+ fix-auth         <span class=d>‚Üï</span><span class=d>|</span>                <span class=g>‚Üë2</span>  <span class=d><span class=r>‚Üì1</span></span>     <span class=d>|</span>     <span class=d>http://localhost:16460</span>  <span class=d>b772e68b</span>  <span class=d>5h</span>\n\n<span class=d>‚óã</span> <span class=d>Showing 3 worktrees, 2 with changes, 2 ahead, 2 columns hidden</span>\n\nPorts are deterministic ‚Äî `fix-auth` always gets port 16460, regardless of which machine or when. The URL dims if the server isn't running.\n\n## Database per worktree\n\nEach worktree can have its own isolated database. Docker containers get unique names and ports:\n\n```toml\n[post-start]\ndb = \"\"\"\ndocker run -d --rm \\\n  --name {{ repo }}-{{ branch | sanitize }}-postgres \\\n  -p {{ ('db-' ~ branch) | hash_port }}:5432 \\\n  -e POSTGRES_DB={{ branch | sanitize_db }} \\\n  -e POSTGRES_PASSWORD=dev \\\n  postgres:16\n\"\"\"\n\n[pre-remove]\ndb-stop = \"docker stop {{ repo }}-{{ branch | sanitize }}-postgres 2>/dev/null || true\"\n```\n\nThe `('db-' ~ branch)` concatenation hashes differently than plain `branch`, so database and dev server ports don't collide.\nJinja2's operator precedence has pipe `|` with higher precedence than concatenation `~`, meaning expressions need parentheses to filter concatenated values.\n\nThe `sanitize_db` filter produces database-safe identifiers (lowercase, underscores, no leading digits, with a short hash suffix to avoid collisions and SQL reserved words).\n\nGenerate `.env.local` with the correct `DATABASE_URL` using a `post-create` hook:\n\n```toml\n[post-create]\nenv = \"\"\"\ncat > .env.local << EOF\nDATABASE_URL=postgres://postgres:dev@localhost:{{ ('db-' ~ branch) | hash_port }}/{{ branch | sanitize_db }}\nDEV_PORT={{ branch | hash_port }}\nEOF\n\"\"\"\n```\n\n## Local CI gate\n\n`pre-merge` hooks run before merging. Failures abort the merge:\n\n```toml\n[pre-merge]\n\"lint\" = \"uv run ruff check\"\n\"test\" = \"uv run pytest\"\n```\n\nThis catches issues locally before pushing ‚Äî like running CI locally.\n\n## Track agent status\n\nCustom emoji markers show agent state in `wt list`. The Claude Code plugin sets these automatically:\n\n```\n+ feature-api      ‚Üë  ü§ñ              ‚Üë1      ./repo.feature-api\n+ review-ui      ? ‚Üë  üí¨              ‚Üë1      ./repo.review-ui\n```\n\n- `ü§ñ` ‚Äî Claude is working\n- `üí¨` ‚Äî Claude is waiting for input\n\nSet status manually for any workflow:\n\n```bash\nwt config state marker set \"üöß\"                   # Current branch\nwt config state marker set \"‚úÖ\" --branch feature  # Specific branch\ngit config worktrunk.state.feature.marker '{\"marker\":\"üí¨\",\"set_at\":0}'  # Direct\n```\n\nSee [Claude Code Integration](https://worktrunk.dev/claude-code/#installation) for plugin installation.\n\n## Monitor CI across branches\n\n```bash\nwt list --full --branches\n```\n\nShows PR/CI status for all branches, including those without worktrees. CI indicators are clickable links to the PR page.\n\n## JSON API\n\n```bash\nwt list --format=json\n```\n\nStructured output for dashboards, statuslines, and scripts. See [`wt list`](https://worktrunk.dev/list/) for query examples.\n\n## Reuse `default-branch`\n\nWorktrunk maintains useful state. Default branch [detection](https://worktrunk.dev/config/#wt-config-state-default-branch), for instance, means scripts work on any repo ‚Äî no need to hardcode `main` or `master`:\n\n```bash\ngit rebase $(wt config state default-branch)\n```\n\n## Task runners in hooks\n\nReference Taskfile/Justfile/Makefile in hooks:\n\n```toml\n[post-create]\n\"setup\" = \"task install\"\n\n[pre-merge]\n\"validate\" = \"just test lint\"\n```\n\n## Shortcuts\n\nSpecial arguments work across all commands‚Äîsee [`wt switch`](https://worktrunk.dev/switch/#shortcuts) for the full list.\n\n```bash\nwt switch --create hotfix --base=@       # Branch from current HEAD\nwt switch -                              # Switch to previous worktree\nwt remove @                              # Remove current worktree\n```\n\n## Stacked branches\n\nBranch from current HEAD instead of the default branch:\n\n```bash\nwt switch --create feature-part2 --base=@\n```\n\nCreates a worktree that builds on the current branch's changes.\n\n## Agent handoffs\n\nSpawn a worktree with Claude running in the background:\n\n**tmux** (new detached session):\n```bash\ntmux new-session -d -s fix-auth-bug \"wt switch --create fix-auth-bug -x claude -- \\\n  'The login session expires after 5 minutes. Find the session timeout config and extend it to 24 hours.'\"\n```\n\n**Zellij** (new pane in current session):\n```bash\nzellij run -- wt switch --create fix-auth-bug -x claude -- \\\n  'The login session expires after 5 minutes. Find the session timeout config and extend it to 24 hours.'\n```\n\nThis lets one Claude session hand off work to another that runs in the background. Hooks run inside the multiplexer session/pane.\n\nThe [worktrunk skill](https://worktrunk.dev/claude-code/) includes guidance for Claude Code to execute this pattern. To enable it, request it explicitly (\"spawn a parallel worktree for...\") or add to `CLAUDE.md`:\n\n```markdown\nWhen I ask you to spawn parallel worktrees, use the agent handoff pattern\nfrom the worktrunk skill.\n```\n\n## Tmux session per worktree\n\nEach worktree gets its own tmux session with a multi-pane layout. Sessions are named after the branch for easy identification.\n\n```toml\n# .config/wt.toml\n[post-create]\ntmux = \"\"\"\nS={{ branch | sanitize }}\nW={{ worktree_path }}\ntmux new-session -d -s \"$S\" -c \"$W\" -n dev\n\n# Create 4-pane layout: shell | backend / claude | frontend\ntmux split-window -h -t \"$S:dev\" -c \"$W\"\ntmux split-window -v -t \"$S:dev.0\" -c \"$W\"\ntmux split-window -v -t \"$S:dev.2\" -c \"$W\"\n\n# Start services in each pane\ntmux send-keys -t \"$S:dev.1\" 'npm run backend' Enter\ntmux send-keys -t \"$S:dev.2\" 'claude' Enter\ntmux send-keys -t \"$S:dev.3\" 'npm run frontend' Enter\n\ntmux select-pane -t \"$S:dev.0\"\necho \"‚úì Session '$S' ‚Äî attach with: tmux attach -t $S\"\n\"\"\"\n\n[pre-remove]\ntmux = \"tmux kill-session -t {{ branch | sanitize }} 2>/dev/null || true\"\n```\n\n`pre-remove` stops all services when the worktree is removed.\n\nTo create a worktree and immediately attach:\n\n```bash\nwt switch --create feature -x 'tmux attach -t {{ branch | sanitize }}'\n```\n\n## Subdomain routing with Caddy\n<!-- Hand-tested 2025-01-15 -->\n\nClean URLs like `http://feature-auth.myproject.lvh.me` without port numbers. Useful for cookies, CORS, and matching production URL structure.\n\n**Prerequisites:** [Caddy](https://caddyserver.com/docs/install) (`brew install caddy`)\n\n```toml\n# .config/wt.toml\n[post-start]\nserver = \"npm run dev -- --port {{ branch | hash_port }}\"\nproxy = \"\"\"\n  curl -sf --max-time 0.5 http://localhost:2019/config/ || caddy start\n  curl -sf http://localhost:2019/config/apps/http/servers/wt || \\\n    curl -sfX PUT http://localhost:2019/config/apps/http/servers/wt -H 'Content-Type: application/json' \\\n      -d '{\"listen\":[\":8080\"],\"automatic_https\":{\"disable\":true},\"routes\":[]}'\n  curl -sf -X DELETE http://localhost:2019/id/wt:{{ repo }}:{{ branch | sanitize }} || true\n  curl -sfX PUT http://localhost:2019/config/apps/http/servers/wt/routes/0 -H 'Content-Type: application/json' \\\n    -d '{\"@id\":\"wt:{{ repo }}:{{ branch | sanitize }}\",\"match\":[{\"host\":[\"{{ branch | sanitize }}.{{ repo }}.lvh.me\"]}],\"handle\":[{\"handler\":\"reverse_proxy\",\"upstreams\":[{\"dial\":\"127.0.0.1:{{ branch | hash_port }}\"}]}]}'\n\"\"\"\n\n[pre-remove]\nproxy = \"curl -sf -X DELETE http://localhost:2019/id/wt:{{ repo }}:{{ branch | sanitize }} || true\"\n\n[list]\nurl = \"http://{{ branch | sanitize }}.{{ repo }}.lvh.me:8080\"\n```\n\n**How it works:**\n\n1. `wt switch --create feature-auth` runs the `post-start` hook, starting the dev server on a deterministic port (`{{ branch | hash_port }}` ‚Üí 16460)\n2. The hook starts Caddy if needed and registers a route using the same port: `feature-auth.myproject` ‚Üí `localhost:16460`\n3. `lvh.me` is a public domain with wildcard DNS ‚Äî `*.lvh.me` resolves to `127.0.0.1`\n4. Visiting `http://feature-auth.myproject.lvh.me:8080`: Caddy matches the subdomain and proxies to the dev server\n\n## Monitor hook logs\n\nFollow background hook output in real-time:\n\n```bash\ntail -f \"$(wt config state logs get --hook=user:post-start:server)\"\n```\n\nThe `--hook` format is `source:hook-type:name` ‚Äî e.g., `project:post-start:build` for project-defined hooks. Use `wt config state logs get` to list all available logs.\n\nCreate an alias for frequent use:\n\n```bash\nalias wtlog='f() { tail -f \"$(wt config state logs get --hook=\"$1\")\"; }; f'\n```\n\n## Bare repository layout\n\nAn alternative to the default sibling layout (`myproject.feature/`) uses a bare repository with worktrees as subdirectories:\n\n```\nmyproject/\n‚îú‚îÄ‚îÄ .git/       # bare repository\n‚îú‚îÄ‚îÄ main/       # default branch\n‚îú‚îÄ‚îÄ feature/    # feature branch\n‚îî‚îÄ‚îÄ bugfix/     # bugfix branch\n```\n\nSetup:\n\n```bash\ngit clone --bare <url> myproject/.git\ncd myproject\n```\n\nConfigure worktrunk to create worktrees as subdirectories:\n\n```toml\n# ~/.config/worktrunk/config.toml\nworktree-path = \"../{{ branch | sanitize }}\"\n```\n\nCreate the first worktree:\n\n```bash\nwt switch --create main\n```\n\nNow `wt switch --create feature` creates `myproject/feature/`.\n",
        ".claude-plugin/skills/worktrunk/reference/troubleshooting.md": "# Troubleshooting\n\nClaude-specific troubleshooting guidance for common worktrunk issues.\n\n## Commit Message Generation\n\n### Command not found\n\nCheck if the configured tool is installed:\n\n```bash\n$ wt config show  # shows the configured command\n$ which claude    # or: which codex, which llm, which aichat\n```\n\nIf empty, install one of the supported tools. See [LLM commits docs](https://worktrunk.dev/llm-commits/) for setup instructions.\n\n### Command returns an error\n\nTest the configured command directly by piping a prompt to it. See `reference/llm-commits.md` for the exact command syntax for each tool.\n\n```bash\n$ echo \"say hello\" | <your-configured-command>\n```\n\nCommon issues:\n- **API key not set**: Each tool has its own auth mechanism\n- **Model not available**: Check model name with the tool's help\n- **Network issues**: Check internet connectivity\n\n### Config not loading\n\n1. View config path: `wt config show` shows location\n2. Verify file exists: `ls -la ~/.config/worktrunk/config.toml`\n3. Check TOML syntax: `cat ~/.config/worktrunk/config.toml`\n4. Look for validation errors (path must be relative, not absolute)\n\n### Template conflicts\n\nCheck for mutually exclusive options:\n- `template` and `template-file` cannot both be set\n- `squash-template` and `squash-template-file` cannot both be set\n\nIf a template file is used, verify it exists at the specified path.\n\n## Hooks\n\n### Hook not running\n\nCheck sequence:\n1. Verify `.config/wt.toml` exists: `ls -la .config/wt.toml`\n2. Check TOML syntax (use `wt hook show` to see parsed config)\n3. Verify hook type spelling matches one of the seven types\n4. Test command manually in the worktree\n\n### Hook failing\n\nDebug steps:\n1. Run the command manually in the worktree to see errors\n2. Check for missing dependencies (npm packages, system tools)\n3. Verify template variables expand correctly (`wt hook show --verbose`)\n4. For background hooks, check `.git/wt-logs/` for output\n\n### Slow blocking hooks\n\nMove long-running commands to background:\n\n```toml\n# Before ‚Äî blocks for minutes\npost-create = \"npm run build\"\n\n# After ‚Äî fast setup, build in background\npost-create = \"npm install\"\npost-start = \"npm run build\"\n```\n\n## PowerShell on Windows\n\n### PowerShell profiles not created\n\nOn Windows, `wt config shell install` creates PowerShell profiles automatically when running from cmd.exe or PowerShell. It creates both:\n- `Documents/PowerShell/Microsoft.PowerShell_profile.ps1` (PowerShell 7+/pwsh)\n- `Documents/WindowsPowerShell/Microsoft.PowerShell_profile.ps1` (Windows PowerShell 5.1)\n\n**If running from Git Bash or MSYS2**, PowerShell is skipped because the `SHELL` environment variable is set. To create PowerShell profiles explicitly:\n\n```bash\nwt config shell install powershell\n```\n\n### Wrong PowerShell variant configured\n\nBoth profile files are created when installing from a Windows-native shell. This ensures shell integration works regardless of which PowerShell variant the user opens later. The profile files are small and harmless if unused.\n\n### Detection logic\n\nWorktrunk detects Windows-native shells (cmd/PowerShell) by checking if the `SHELL` environment variable is **not** set:\n- `SHELL` not set ‚Üí Windows-native shell ‚Üí create both PowerShell profiles\n- `SHELL` set (e.g., `/usr/bin/bash`) ‚Üí Git Bash/MSYS2 ‚Üí skip PowerShell\n",
        ".claude-plugin/skills/worktrunk/reference/worktrunk.md": "# Worktrunk\n\nWorktrunk is a CLI for git worktree management, designed for running AI agents\nin parallel.\n\nWorktrunk's three core commands make worktrees as easy as branches.\nPlus, Worktrunk has a bunch of quality-of-life features to simplify working\nwith many parallel changes, including hooks to automate local workflows.\n\nScaling agents becomes trivial. A quick demo:\n\n## Context: git worktrees\n\nAI agents like Claude Code and Codex can handle longer tasks without\nsupervision, such that it's possible to manage 5-10+ in parallel. Git's native\nworktree feature give each agent its own working directory, so they don't step\non each other's changes.\n\nBut the git worktree UX is clunky. Even a task as small as starting a new\nworktree requires typing the branch name three times: `git worktree add -b feat\n../repo.feat`, then `cd ../repo.feat`.\n\n## Worktrunk makes git worktrees as easy as branches\n\nWorktrees are addressed by branch name; paths are computed from a configurable template.\n\n> Start with the core commands\n\n**Core commands:**\n\n<table class=\"cmd-compare\">\n  <thead>\n    <tr>\n      <th>Task</th>\n      <th>Worktrunk</th>\n      <th>Plain git</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Switch worktrees</td>\n      <td>{% rawcode() %}wt switch feat{% end %}</td>\n      <td>{% rawcode() %}cd ../repo.feat{% end %}</td>\n    </tr>\n    <tr>\n      <td>Create + start Claude</td>\n      <td>{% rawcode() %}wt switch -c -x claude feat{% end %}</td>\n      <td>{% rawcode() %}git worktree add -b feat ../repo.feat && \\\ncd ../repo.feat && \\\nclaude{% end %}</td>\n    </tr>\n    <tr>\n      <td>Clean up</td>\n      <td>{% rawcode() %}wt remove{% end %}</td>\n      <td>{% rawcode() %}cd ../repo && \\\ngit worktree remove ../repo.feat && \\\ngit branch -d feat{% end %}</td>\n    </tr>\n    <tr>\n      <td>List with status</td>\n      <td>{% rawcode() %}wt list{% end %}</td>\n      <td>{% rawcode() %}git worktree list{% end %} (paths only)</td>\n    </tr>\n  </tbody>\n</table>\n\n**Workflow automation:**\n\n> Expand into the more advanced commands as needed\n\n- **[Hooks](https://worktrunk.dev/hook/)** ‚Äî run commands on create, pre-merge, post-merge, etc\n- **[LLM commit messages](https://worktrunk.dev/llm-commits/)** ‚Äî generate commit messages from diffs\n- **[Merge workflow](https://worktrunk.dev/merge/)** ‚Äî squash, rebase, merge, clean up in one command\n- ...and **[lots more](#next-steps)**\n\nA demo with some advanced features:\n\n## Install\n\n**Homebrew (macOS & Linux):**\n\n```bash\nbrew install worktrunk && wt config shell install\n```\n\nShell integration allows commands to change directories.\n\n**Cargo:**\n\n```bash\ncargo install worktrunk && wt config shell install\n```\n\n<details>\n<summary><strong>Windows</strong></summary>\n\nOn Windows, `wt` defaults to Windows Terminal's command. Winget additionally installs Worktrunk as `git-wt` to avoid the conflict:\n\n```bash\nwinget install max-sixty.worktrunk\ngit-wt config shell install\n```\n\nAlternatively, disable Windows Terminal's alias (Settings ‚Üí Privacy & security ‚Üí For developers ‚Üí App Execution Aliases ‚Üí disable \"Windows Terminal\") to use `wt` directly.\n\n</details>\n\n**Arch Linux:**\n\n```bash\nparu worktrunk-bin && wt config shell install\n```\n\n## Quick start\n\nCreate a worktree for a new feature:\n\n<span class=\"cmd\">wt switch --create feature-auth</span>\n<span class=g>‚úì</span> <span class=g>Created branch <b>feature-auth</b> from <b>main</b> and worktree @ <b>repo.feature-auth</b></span>\n\nThis creates a new branch and worktree, then switches to it. Do your work, then check all worktrees with [`wt list`](https://worktrunk.dev/list/):\n\n<span class=\"cmd\">wt list</span>\n  <b>Branch</b>        <b>Status</b>        <b>HEAD¬±</b>    <b>main‚Üï</b>  <b>Remote‚áÖ</b>  <b>Commit</b>    <b>Age</b>   <b>Message</b>\n@ feature-auth  <span class=c>+</span>   <span class=d>‚Äì</span>      <span class=g>+53</span>                         <span class=d>0e631add</span>  <span class=d>1d</span>    <span class=d>Initial commit</span>\n^ main              <span class=d>^</span><span class=d>‚á°</span>                         <span class=g>‚á°1</span>      <span class=d>0e631add</span>  <span class=d>1d</span>    <span class=d>Initial commit</span>\n\n<span class=d>‚óã</span> <span class=d>Showing 2 worktrees, 1 with changes, 1 column hidden</span>\n\nThe `@` marks the current worktree. `+` means uncommitted changes, `‚Üï` means unpushed commits.\n\nWhen done, either:\n\n**PR workflow** ‚Äî commit, push, open a PR, merge via GitHub/GitLab, then clean up:\n\n```bash\nwt step commit                    # commit staged changes\ngh pr create                      # or glab mr create\nwt remove                         # after PR is merged\n```\n\n**Local merge** ‚Äî squash, rebase onto main, fast-forward merge, clean up:\n\n<span class=\"cmd\">wt merge main</span>\n<span class=c>‚óé</span> <span class=c>Generating commit message and committing changes... <span style='color:var(--bright-black,#555)'>(2 files, <span class=g>+53</span></span></span>, no squashing needed<span style='color:var(--bright-black,#555)'>)</span>\n<span style='background:var(--bright-white,#fff)'> </span> <b>Add authentication module</b>\n<span class=g>‚úì</span> <span class=g>Committed changes @ <span class=d>a1b2c3d</span></span>\n<span class=c>‚óé</span> <span class=c>Merging 1 commit to <b>main</b> @ <span class=d>a1b2c3d</span> (no rebase needed)</span>\n<span style='background:var(--bright-white,#fff)'> </span> * <span style='color:var(--yellow,#a60)'>a1b2c3d</span> Add authentication module\n<span style='background:var(--bright-white,#fff)'> </span>  auth.rs | 51 <span class=g>+++++++++++++++++++++++++++++++++++++++++++++++++++</span>\n<span style='background:var(--bright-white,#fff)'> </span>  lib.rs  |  2 <span class=g>++</span>\n<span style='background:var(--bright-white,#fff)'> </span>  2 files changed, 53 insertions(+)\n<span class=g>‚úì</span> <span class=g>Merged to <b>main</b> <span style='color:var(--bright-black,#555)'>(1 commit, 2 files, +53</span></span><span style='color:var(--bright-black,#555)'>)</span>\n<span class=c>‚óé Removing <b>feature-auth</b> worktree &amp; branch in background (same commit as <b>main</b>,</span> <span class=d>_</span><span class=c>)</span>\n<span class=d>‚óã</span> Switched to worktree for <b>main</b> @ <b>repo</b>\n\nFor parallel agents, create multiple worktrees and launch an agent in each:\n\n```bash\nwt switch -x claude -c feature-a -- 'Add user authentication'\nwt switch -x claude -c feature-b -- 'Fix the pagination bug'\nwt switch -x claude -c feature-c -- 'Write tests for the API'\n```\n\nThe `-x` flag runs a command after switching; arguments after `--` are passed to it. Configure [post-start hooks](https://worktrunk.dev/hook/) to automate setup (install deps, start dev servers).\n\n## Next steps\n\n- Learn the core commands: [`wt switch`](https://worktrunk.dev/switch/), [`wt list`](https://worktrunk.dev/list/), [`wt merge`](https://worktrunk.dev/merge/), [`wt remove`](https://worktrunk.dev/remove/)\n- Set up [project hooks](https://worktrunk.dev/hook/) for automated setup\n- Explore [LLM commit messages](https://worktrunk.dev/llm-commits/), [fzf-like\n  selector](https://worktrunk.dev/select/), [Claude Code integration](https://worktrunk.dev/claude-code/), [CI\n  status & PR links](https://worktrunk.dev/list/#ci-status)\n- Run `wt --help` or `wt <command> --help` for quick CLI reference\n\n## Further reading\n\n- [Claude Code: Best practices for agentic coding](https://www.anthropic.com/engineering/claude-code-best-practices) ‚Äî Anthropic's official guide, including the worktree pattern\n- [Shipping faster with Claude Code and Git Worktrees](https://incident.io/blog/shipping-faster-with-claude-code-and-git-worktrees) ‚Äî incident.io's workflow for parallel agents\n- [Git worktree pattern discussion](https://github.com/anthropics/claude-code/issues/1052) ‚Äî Community discussion in the Claude Code repo\n- [git-worktree documentation](https://git-scm.com/docs/git-worktree) ‚Äî Official git reference\n"
      },
      "plugins": [
        {
          "name": "worktrunk",
          "description": "Worktrunk is a git worktree management CLI that streamlines multi-branch development. This plugin provides Claude Code integration with two features: (1) A configuration skill guiding you through LLM-powered commit message generation, project automation hooks (post-create, pre-merge), and worktree path customization. (2) Automatic activity tracking that displays ü§ñ (working) and üí¨ (waiting) indicators in `wt list`, showing which branches have active Claude sessions. Use when setting up Worktrunk configuration, automating project workflows, or monitoring AI activity across branches.",
          "source": "./.claude-plugin",
          "strict": false,
          "skills": [
            "./skills/worktrunk"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add max-sixty/worktrunk",
            "/plugin install worktrunk@worktrunk"
          ]
        }
      ]
    },
    {
      "name": "jean-claude",
      "version": null,
      "description": "Gmail, Calendar, Drive, and iMessage integration",
      "owner_info": {
        "name": "Maximilian"
      },
      "keywords": [],
      "repo_full_name": "max-sixty/jean-claude",
      "repo_url": "https://github.com/max-sixty/jean-claude",
      "repo_description": null,
      "homepage": null,
      "signals": {
        "stars": 25,
        "forks": 2,
        "pushed_at": "2026-01-29T18:57:31Z",
        "created_at": "2025-12-17T18:09:41Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 284
        },
        {
          "path": ".claude-plugin/plugin.json",
          "type": "blob",
          "size": 452
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 6262
        },
        {
          "path": "skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/jean-claude",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/jean-claude/ISSUES.md",
          "type": "blob",
          "size": 2211
        },
        {
          "path": "skills/jean-claude/ONBOARDING.md",
          "type": "blob",
          "size": 9697
        },
        {
          "path": "skills/jean-claude/PREFERENCES.md",
          "type": "blob",
          "size": 14423
        },
        {
          "path": "skills/jean-claude/SKILL.md",
          "type": "blob",
          "size": 52603
        },
        {
          "path": "skills/jean-claude/platforms",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/jean-claude/platforms/docs.md",
          "type": "blob",
          "size": 989
        },
        {
          "path": "skills/jean-claude/platforms/drive.md",
          "type": "blob",
          "size": 1073
        },
        {
          "path": "skills/jean-claude/platforms/imessage.md",
          "type": "blob",
          "size": 3875
        },
        {
          "path": "skills/jean-claude/platforms/reminders.md",
          "type": "blob",
          "size": 1349
        },
        {
          "path": "skills/jean-claude/platforms/sheets.md",
          "type": "blob",
          "size": 2133
        },
        {
          "path": "skills/jean-claude/platforms/signal.md",
          "type": "blob",
          "size": 2212
        },
        {
          "path": "skills/jean-claude/platforms/whatsapp.md",
          "type": "blob",
          "size": 3072
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"jean-claude\",\n  \"owner\": {\n    \"name\": \"Maximilian\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"jean-claude\",\n      \"source\": \"./\",\n      \"description\": \"Gmail, Calendar, Drive, and iMessage integration\",\n      \"skills\": [\n        \"./skills/jean-claude\"\n      ]\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"jean-claude\",\n  \"version\": \"0.1.0\",\n  \"description\": \"Google Workspace (Gmail, Calendar, Drive) and iMessage integration for Claude Code\",\n  \"author\": {\n    \"name\": \"Maximilian\"\n  },\n  \"license\": \"MIT\",\n  \"repository\": \"https://github.com/max-sixty/jean-claude\",\n  \"keywords\": [\n    \"gmail\",\n    \"google-calendar\",\n    \"google-drive\",\n    \"imessage\",\n    \"assistant\",\n    \"productivity\"\n  ],\n  \"skills\": [\n    \"./skills/jean-claude\"\n  ]\n}\n",
        "README.md": "# jean-claude\n\nA Claude Code plugin for managing Gmail, Google Calendar, Google Drive, and\niMessage (macOS only).\n\n<img width=\"1536\" height=\"1024\" alt=\"image\" src=\"https://github.com/user-attachments/assets/6481069a-a730-434a-b3f1-6fd88a78da60\" />\n\n## Prerequisites\n\n### Claude Code\n\nThis is a plugin for [Claude Code](https://code.claude.com/docs/en/setup),\nAnthropic's agentic coding tool. Install it first:\n\n```bash\ncurl -fsSL https://claude.ai/install.sh | bash\n```\n\n### uv (Python package manager)\n\nThis plugin requires [uv](https://docs.astral.sh/uv/) to manage Python\ndependencies (requires Python 3.11+, which uv will install automatically if\nneeded):\n\n```bash\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n```\n\n## Installation\n\nFrom your terminal, run:\n\n```bash\nclaude plugin marketplace add max-sixty/jean-claude\nclaude plugin install jean-claude@jean-claude\n```\n\n## Setup\n\n### Google Workspace (Gmail, Calendar, Drive)\n\nAfter installing the plugin, ask Claude to authenticate:\n\n```\n\"Set up Google authentication for jean-claude\"\n```\n\nClaude will run the auth command for you, which opens a browser for OAuth\nconsent.\n\n<details>\n<summary><strong>Manual setup</strong> (if you prefer running commands yourself)</summary>\n\n```bash\n# The plugin is installed at:\ncd ~/.claude/plugins/marketplaces/jean-claude\n\n# Full access (read, send, modify)\nuv run jean-claude auth\n\n# Or read-only access (no send/modify capabilities)\nuv run jean-claude auth --readonly\n\n# Verify it worked\nuv run jean-claude status\n```\n\nCredentials are saved to `~/.config/jean-claude/token.json` and persist until\nrevoked.\n\n</details>\n\n> [!NOTE]\n> You may see an \"unverified app\" warning during OAuth‚Äîthis is normal for apps\n> pending Google verification. Click \"Advanced\" ‚Üí \"Go to jean-claude (unsafe)\"\n> to proceed. The app only requests the permissions you approve and stores\n> credentials locally on your machine.\n\n<details>\n<summary><strong>Using your own Google Cloud credentials</strong> (optional)</summary>\n\nUse your own credentials if the default ones stop working (Google limits\nunverified apps to 100 users) or if you want your own quota.\n\n1. Create a Google Cloud project at https://console.cloud.google.com\n2. Go to \"APIs & Services\" ‚Üí \"Enabled APIs\" and enable:\n   - Gmail API\n   - Google Calendar API\n   - Google Drive API\n3. Go to \"APIs & Services\" ‚Üí \"OAuth consent screen\":\n   - Choose \"External\" user type\n   - Fill in app name and your email\n   - Add scopes: `gmail.modify`, `calendar`, `drive`\n   - Add yourself as a test user\n4. Go to \"APIs & Services\" ‚Üí \"Credentials\":\n   - Click \"Create Credentials\" ‚Üí \"OAuth client ID\"\n   - Choose \"Desktop app\" as application type\n   - Download the JSON file\n5. Move the downloaded file:\n   ```bash\n   mkdir -p ~/.config/jean-claude\n   mv ~/Downloads/client_secret_*.json ~/.config/jean-claude/client_secret.json\n   ```\n6. Run the auth command‚Äîit will automatically use your credentials\n\n</details>\n\n### iMessage (macOS only)\n\niMessage integration requires macOS‚Äîit uses AppleScript and the local Messages\ndatabase.\n\n- **Sending messages**: Works via AppleScript. On first use, macOS prompts to\n  allow your terminal to control Messages.app (Automation permission). Grant\n  this to whichever app runs Claude Code (Terminal, iTerm2, VS Code, etc.).\n\n- **Reading messages**: Requires Full Disk Access to read the Messages database.\n  1. Open **System Settings** ‚Üí **Privacy & Security** ‚Üí **Full Disk Access**\n  2. Click **+** and add the app that runs Claude Code:\n     - If using Terminal: add `/Applications/Utilities/Terminal.app`\n     - If using iTerm2: add `/Applications/iTerm.app`\n     - If using VS Code: add `/Applications/Visual Studio Code.app`\n     - If using another terminal: find it in `/Applications` or via `which`\n  3. Toggle the app **on** and restart it\n\n## Usage\n\nOnce installed, Claude automatically uses this plugin when you ask it to:\n\n- Search, send, or draft emails\n- Check calendar or create events\n- Find, upload, or share Drive files\n- Send texts or check iMessages\n\n### Example Prompts\n\n```\n\"Check my inbox for unread emails\"\n\"What's on my calendar today?\"\n\"Send an email to alice@example.com about the meeting\"\n\"Search Drive for quarterly reports\"\n\"Text +12025551234 that I'm running late\"\n```\n\n<details>\n<summary><strong>CLI Commands</strong></summary>\n\nThe plugin provides a unified CLI with subcommands. Claude invokes these\nautomatically, but you can also run them manually:\n\n```bash\ncd ~/.claude/plugins/marketplaces/jean-claude\nuv run jean-claude --help\nuv run jean-claude gmail --help\nuv run jean-claude gcal --help\nuv run jean-claude gdrive --help\nuv run jean-claude imessage --help  # macOS only\n```\n\n</details>\n\n### Shell Completions\n\nEnable tab completion for the CLI:\n\n```bash\ncd ~/.claude/plugins/marketplaces/jean-claude\n\n# Bash (~/.bashrc)\neval \"$(uv run jean-claude completions bash)\"\n\n# Zsh (~/.zshrc)\neval \"$(uv run jean-claude completions zsh)\"\n\n# Fish (~/.config/fish/config.fish)\nuv run jean-claude completions fish | source\n```\n\n## Features\n\n### Gmail\n\n- Search and list emails\n- Create, send, and manage drafts\n- Reply and forward with threading preserved\n- Star, archive/unarchive, mark read/unread, trash messages\n\n### Google Calendar\n\n- List events (today, date range, or N days)\n- Create events with attendees, location, description\n- Search, update, and delete events\n- Timezone auto-detection\n\n### Google Drive\n\n- List and search files\n- Upload and download files\n- Create folders and share files\n- Trash and restore files\n\n### iMessage (macOS only)\n\n- Send messages to individuals or groups\n- Send file attachments\n- List chats and participants\n- Search message history\n- View unread messages\n\n## Security\n\n- OAuth tokens are stored with 0600 permissions (owner read/write only)\n- Default OAuth client credentials are embedded for convenience (standard\n  practice for desktop/CLI apps per Google's guidelines)\n- Users can provide their own Google Cloud credentials if preferred\n- All email/message sends require explicit user approval\n\n<details>\n<summary><strong>Development</strong></summary>\n\n```bash\n# Install with dev dependencies\nuv sync\n\n# Run tests\nuv run pytest\n\n# Run lints\npre-commit run --all-files\n```\n\n</details>\n\n## License\n\nMIT\n",
        "skills/jean-claude/ISSUES.md": "# Creating GitHub Issues\n\nDetailed guide for filing bug reports when jean-claude encounters library problems.\n\n## Gather Information\n\nCollect before drafting the issue:\n\n- Command that failed\n- Error message or unexpected behavior\n- Expected behavior\n- Jean-claude version: `jean-claude --version`\n- Python version: `python3 --version`\n- OS: `uname -s` (or check platform from status)\n\n## Scrub Personal Information\n\nRemove before including in issue:\n\n- Email addresses ‚Üí replace with `user@example.com`\n- Phone numbers ‚Üí replace with `+1-555-XXX-XXXX`\n- Names ‚Üí replace with `[Name]` or `[Contact]`\n- OAuth tokens or credentials ‚Üí remove entirely\n- File paths containing usernames ‚Üí use `~` or `$HOME`\n- Message content ‚Üí summarize as \"message body\" or \"[content]\"\n- Calendar event details ‚Üí use generic descriptions\n\nTell the user what you've scrubbed:\n\n> I've removed your email address, two phone numbers, and the message content\n> from the report.\n\n## Issue Format\n\n```markdown\n## Description\n\n[One-sentence summary of the problem]\n\n## Steps to Reproduce\n\n1. Run `jean-claude [command]`\n2. [What happens]\n\n## Expected Behavior\n\n[What should happen]\n\n## Actual Behavior\n\n[What actually happened, including error message]\n\n## Environment\n\n- jean-claude version: X.Y.Z\n- Python: 3.X.Y\n- OS: macOS/Linux\n\n## Additional Context\n\n[Any other relevant details]\n```\n\n## Submit with Approval\n\n**Always show the user the full issue before submitting. Wait for explicit\napproval.**\n\nCheck if `gh` CLI is available:\n\n```bash\nwhich gh\n```\n\n### If `gh` is available\n\n```bash\ngh issue create --repo anthropics/jean-claude \\\n  --title \"Brief description of bug\" \\\n  --body \"$(cat <<'EOF'\n[Issue body here]\nEOF\n)\"\n```\n\nAfter submission, share the issue URL with the user so they can track it.\n\n### If `gh` is not available\n\nGenerate a pre-filled GitHub URL. URL-encode the title and body:\n\n```\nhttps://github.com/anthropics/jean-claude/issues/new?title=URL_ENCODED_TITLE&body=URL_ENCODED_BODY\n```\n\nProvide the link to the user:\n\n> Here's a link that will open GitHub with the issue pre-filled. Click it to\n> review and submit:\n>\n> [Create Issue](https://github.com/anthropics/jean-claude/issues/new?title=...)\n",
        "skills/jean-claude/ONBOARDING.md": "# First-Run Onboarding\n\nInstructions for guiding a new user through jean-claude setup.\n\n**Command prefix:** All commands in this guide use the full prefix:\n```bash\njean-claude ...\n```\n\n## When to Load This Guide\n\nLoad this guide when:\n\n- `jean-claude status --json` shows `setup_completed: false`\n- Google services not authenticated AND user asks about email/calendar/drive\n- User explicitly requests setup (\"set up jean-claude\", \"configure email\", etc.)\n\n## Orientation\n\nIntroduce jean-claude briefly. Keep it conversational:\n\n> I can connect to your Gmail, Calendar, Drive, iMessage, and other services to\n> help manage email, schedule meetings, find files, and send messages. Let's set\n> up the services you want to use‚Äîthis takes 2-5 minutes.\n\n## Service Selection\n\nAsk which services they want. Present options conversationally, not as a menu:\n\n**Most users want:** Gmail + Calendar (one OAuth flow covers both)\n\n**Power users might also want:**\n\n- Google Drive, Docs, Sheets (same OAuth, just more scopes)\n- iMessage (macOS only, requires granting permissions)\n- Apple Reminders (macOS only)\n- WhatsApp (requires phone pairing via QR code)\n- Signal (requires phone pairing via QR code)\n\nAsk: \"What would you like to set up? Most people start with email and calendar.\"\n\nBased on response, proceed to relevant setup sections.\n\n## Google Services Setup\n\nAll Google services (Gmail, Calendar, Drive, Docs, Sheets) share one OAuth flow.\n\n### Step 1: Explain access levels\n\nTwo options to present to the user:\n\n**Read-only access** - Can read email/calendar/files but not send or modify.\nGood for trying it out. Can upgrade later.\n\n**Full access** - Can send email, create events, upload files. Required for\nactually getting things done.\n\nAsk which they prefer. Most users who know what they want should choose full\naccess.\n\n### Step 2: Initiate OAuth\n\nRun the appropriate command:\n\n```bash\njean-claude auth           # Full access\njean-claude auth --readonly  # Read-only\n```\n\nThis opens their browser. Tell the user:\n\n> A browser window should open asking you to sign in with Google. After you\n> grant permission, you'll see a success message. Let me know when that's done.\n\n**If the user sees \"This app isn't verified\":** Explain that this warning\nappears because jean-claude uses a personal OAuth app that hasn't gone through\nGoogle's verification process (which costs money and requires a company). It's\nsafe to proceed‚Äîthey should click \"Advanced\" ‚Üí \"Go to jean-claude (unsafe)\" ‚Üí\nthen grant the permissions. The \"unsafe\" label just means unverified.\n\n### Step 3: Verify authentication\n\nAfter user confirms, run:\n\n```bash\njean-claude status --json\n```\n\nCheck `services.google.authenticated`. If true, confirm success and mention\nwhich Google account is connected.\n\n**If auth failed**, troubleshoot:\n\n- Browser didn't open? Ask user to check for a URL in terminal output to open\n  manually\n- Wrong account? Run `jean-claude auth --logout` (with prefix) and retry\n- Permission denied? Work/school accounts may have admin restrictions\n\n### Step 4: Confirm scope\n\nCheck `services.google.scopes` matches what they chose. If they picked full but\ngot readonly, they may have clicked wrong options in Google's consent screen‚Äî\nre-run auth.\n\n## iMessage Setup (macOS Only)\n\nSkip this section if not on macOS (`platform` in status output is not `darwin`).\n\niMessage requires two macOS permissions that the user must grant manually.\n\n### Step 1: Explain what's needed\n\nTell the user:\n\n> iMessage needs two permissions: one for sending messages, one for reading your\n> message history. macOS will prompt for the first one automatically. The second\n> requires a trip to System Settings.\n\n### Step 2: Test send permission\n\nRun a read-only command to trigger the Automation permission prompt:\n\n```bash\njean-claude imessage chats -n 1\n```\n\nIf this returns a permission error, guide the user:\n\n> macOS should have shown a permission prompt. If you denied it or it didn't\n> appear, go to **System Settings ‚Üí Privacy & Security ‚Üí Privacy ‚Üí\n> Automation** and enable the checkbox for your terminal app under \"System\n> Events\".\n\n### Step 3: Test read permission\n\nThe `chats` command also requires Full Disk Access. If it failed with a database\nerror, guide the user:\n\n> To read your message history, you need to grant Full Disk Access:\n>\n> 1. Open **System Settings ‚Üí Privacy & Security ‚Üí Privacy ‚Üí Full Disk Access**\n> 2. Click the lock icon to make changes\n> 3. Click the + button and add your terminal app (Terminal, iTerm2, VS Code, Cursor, etc.)\n> 4. Restart your terminal completely (quit and reopen)\n>\n> Let me know when you've done this and restarted your terminal.\n\nAfter user confirms, re-run `jean-claude imessage chats -n 5` (with prefix) to verify.\n\n### Step 4: Confirm success\n\nWhen chats command succeeds, summarize: \"iMessage is set up. I can see X recent\nconversations.\"\n\n## Apple Reminders Setup (macOS Only)\n\nReminders only needs Automation permission, granted automatically on first use.\n\nRun:\n\n```bash\njean-claude reminders list\n```\n\nIf permission prompt appears, tell user to allow it. If denied, same Automation\nfix as iMessage.\n\n## WhatsApp Setup (Optional)\n\nWhatsApp is disabled by default because it requires phone pairing and maintains\na persistent connection.\n\n### Step 1: Confirm user wants this\n\nOnly proceed if user explicitly wants WhatsApp. It's not part of default setup.\n\n### Step 2: Enable in config\n\nRun:\n\n```bash\njean-claude config set enable_whatsapp true\n```\n\n### Step 3: Authenticate\n\nRun:\n\n```bash\njean-claude whatsapp auth\n```\n\nThis displays a QR code in the terminal. Tell the user:\n\n> A QR code should appear in the terminal. On your phone, open WhatsApp ‚Üí\n> Settings ‚Üí Linked Devices ‚Üí Link a Device, and scan the code. Let me know\n> when it's linked.\n\n### Step 4: Verify\n\nAfter user confirms, run:\n\n```bash\njean-claude whatsapp chats -n 5\n```\n\nIf successful, summarize: \"WhatsApp is connected. I can see your recent chats.\"\n\n## Signal Setup (Optional)\n\nSignal links jean-claude as a secondary device to the user's Signal account.\nThe user scans a QR code with their phone to authorize the connection.\n\n**Prerequisite:** Confirm the user has Signal installed on their phone‚Äîthey'll\nneed it to scan the QR code.\n\n### Step 1: Enable in config\n\n```bash\njean-claude config set enable_signal true\n```\n\n### Step 2: Link device\n\nRun:\n\n```bash\njean-claude signal link --device-name \"jean-claude\"\n```\n\nTell the user:\n\n> A QR code should appear in the terminal. On your phone, open Signal ‚Üí\n> Settings ‚Üí Linked Devices ‚Üí Link New Device, and scan the code.\n\n### Step 3: Verify\n\nAfter user confirms:\n\n```bash\njean-claude signal chats -n 5\n```\n\n## Setup Completion\n\nAfter all desired services are configured, mark setup complete:\n\n```bash\njean-claude config set setup_completed true\n```\n\nRun final status check:\n\n```bash\njean-claude status\n```\n\nSummarize what's configured in natural language:\n\n> \"Setup complete! Here's what I can access:\n>\n> - Gmail and Calendar (full access) - connected as user@gmail.com\n> - iMessage - can send and read messages\n> - Reminders - working\n>\n> WhatsApp and Signal are available to add later if you want.\"\n\n## Post-Setup: First Actions\n\nOnce setup is complete, offer to help with something based on what's enabled.\nDon't list commands‚Äîask what they'd like to do:\n\n- \"Want me to check your inbox for anything urgent?\"\n- \"Should I look at your calendar for today?\"\n- \"Any messages you'd like me to help with?\"\n\nThe agent runs the appropriate commands and presents results conversationally.\n\n## Creating Preferences (Optional)\n\nAfter helping with their first request, offer to create a preferences skill if\nthey don't have one yet. This teaches jean-claude their communication style.\n\nSee [PREFERENCES.md](PREFERENCES.md) for the full guide. Quick version:\n\n> I can learn your communication style from your sent messages‚Äîhow you sign off,\n> your tone, people you message often. Want me to take a look? You'll review\n> before I save anything.\n\nIf they agree:\n1. Read their sent emails to infer sign-off, tone, greeting style\n2. Check messages for frequent contacts\n3. Generate a skill file and show it to them for review\n4. Save to `~/.claude/skills/managing-messages/SKILL.md` after approval\n\nDon't push this‚Äîpreferences also emerge naturally through corrections\n(\"actually, sign it 'Best' not 'Cheers'\"). When users correct you, offer to\nsave it as a preference.\n\n## Re-Running Setup\n\nIf user wants to add services later or change access level:\n\n- \"Add WhatsApp\" ‚Üí WhatsApp Setup section\n- \"Switch to read-only\" ‚Üí Run `auth --logout` then `auth --readonly` (with prefix)\n- \"What's configured?\" ‚Üí Run `status` (with prefix)\n\n## Troubleshooting Reference\n\n### Google auth issues\n\n- Browser didn't open: Look for URL in terminal output\n- Wrong account: Run `auth --logout` (with prefix) and retry\n- Scope issues: Re-run auth, pay attention to checkboxes in Google consent\n\n### iMessage permission issues\n\n- Automation denied: System Settings ‚Üí Automation ‚Üí enable terminal app\n- Full Disk Access: System Settings ‚Üí Full Disk Access ‚Üí add terminal app\n- Still failing: Quit and reopen the terminal app after granting permissions\n- **Which terminal app?** Use the app where Claude Code is running (Terminal,\n  iTerm2, VS Code, Cursor, etc.)\n\n### WhatsApp issues\n\n- QR code not appearing: Check `enable_whatsapp` is true in config\n- Won't connect: Phone must be online; run `whatsapp logout` and re-pair\n- Connection drops: WhatsApp limits linked devices to 4\n\n### Signal issues\n\n- QR code not working: Ensure phone has Signal installed and is online\n- Won't link: Run `signal unlink` and re-link\n",
        "skills/jean-claude/PREFERENCES.md": "# Creating User Preferences\n\nGuide for creating a personalization skill from user messages and corrections.\n\n## When to Offer\n\nAfter setup completes, check if the user has a personalization skill:\n\n1. Check `~/.claude/skills/` for existing user skills\n2. Look for any skill mentioning: inbox, email, message, communication,\n   preferences, or contacts in its description\n3. If none found, offer to learn from their messages\n\n**How to offer** (conversational, not pushy):\n\n> I can learn your communication style from your sent messages‚Äîthings like how\n> you sign off emails, your tone, people you message often. Want me to take a\n> look and create a preferences file? You'll review it before I save anything.\n\nIf user declines, respect that. Don't ask again in the same session.\n\n## Learning from Messages\n\nAnalyze the user's existing messages to infer preferences. This is faster than\nasking questions and captures their actual patterns.\n\n**Goal:** Build a comprehensive picture without reading thousands of messages.\nUse strategic sampling and targeted searches to extract patterns efficiently.\n\n**Time:** This process takes 5-10 minutes. The user can request it anytime,\nincluding after completing their current task‚Äîno need to do it right now.\n\n**Scope:** Focus on communication preferences that affect how to draft messages:\n- Sign-offs, greetings, tone\n- Key contacts (name + phone/email for disambiguation)\n- Writing patterns and tics\n\nDo NOT extract: full biographical details, work history, address, topics of\ninterest. This is a messaging preferences file, not a dossier.\n\n### Efficiency Notes\n\n- **Run searches in parallel** ‚Äî Phases 1-5 are presented sequentially but many\n  searches are independent. Run them concurrently when possible.\n- **Distinguish user text from quotes** ‚Äî Email bodies include quoted replies.\n  Look for text BEFORE the \"On [date], [name] wrote:\" line. For emails with\n  long quoted chains, only analyze the first 20-50 lines.\n- **Deduplication** ‚Äî The same email may appear in multiple search results.\n  Focus on unique messages, not thread count.\n- **Sample size** ‚Äî Read 15-20+ unique email bodies across contexts. For\n  iMessage/WhatsApp, read 30-50 messages from top 3-5 contacts.\n- **Empty search results** ‚Äî If a search (e.g., \"Regards,\") returns nothing,\n  that's useful data. Move on and focus on patterns that do appear.\n- **Email body files** ‚Äî Thread output (`inbox`) contains metadata only. Use\n  `gmail message MESSAGE_ID` to fetch bodies. The message JSON includes `body_file` path.\n- **\"No sign-off\" is a preference** ‚Äî If the user just ends with their name\n  and no preceding word (\"Best,\", \"Thanks,\"), that's itself a pattern.\n- **User can always edit** ‚Äî Mention that they can edit the file directly\n  anytime, and that preferences will also update over time as they correct\n  drafts or provide feedback.\n\n### Phase 1: Survey the Landscape\n\nGet a high-level view of message volume and categories before diving deep.\n\n**Email overview** (100+ snippets to understand patterns):\n\n```bash\n# Recent emails - current style\njean-claude gmail search \"in:sent\" -n 100\n\n# Older emails - check for consistency\njean-claude gmail search \"in:sent older_than:3m\" -n 50\njean-claude gmail search \"in:sent older_than:6m\" -n 50\n```\n\nFrom snippets alone, note:\n- **Snippet length** ‚Äî proxy for email length (short snippets = terse writer)\n- **Recipient patterns** ‚Äî domains suggest professional vs personal\n- **Subject line style** ‚Äî formal vs casual\n\n**iMessage/WhatsApp chat list** (identify key relationships):\n\n```bash\n# Get all chats sorted by activity\njean-claude imessage chats -n 50\njean-claude whatsapp chats -n 50\n```\n\nNote the top 5-10 most active chats ‚Äî these are the key relationships.\n\n**Group chat names reveal context** ‚Äî Names like \"Team OA Lesly\" suggest\nhousehold staff; \"Smith Family\" indicates family group. Use these to understand\nrelationships without reading every message.\n\n### Phase 2: Targeted Sign-Off Analysis\n\nSign-offs are the most actionable preference. Search for common patterns:\n\n```bash\n# Search for emails with common sign-offs\njean-claude gmail search \"in:sent Thanks,\" -n 30\njean-claude gmail search \"in:sent Best,\" -n 30\njean-claude gmail search \"in:sent Cheers,\" -n 30\njean-claude gmail search \"in:sent Regards,\" -n 30\n```\n\n**Important:** Gmail search matches anywhere in the message, including quoted\nreplies. You must read full email bodies to verify the sign-off is actually\nthe user's text, not quoted from someone else.\n\nFor each search that returns results, read a few full bodies to see:\n- What comes after (just name? full name? nothing?)\n- What context triggers this sign-off (professional? casual?)\n- Does the user use a dash before their name? (`-Max` vs `Max`)\n\n**Joint sign-offs** (for couples/families):\n\n```bash\n# Find emails CC'd to spouse - often use joint sign-off\njean-claude gmail search \"in:sent cc:spouse@email.com\" -n 20\n```\n\nLook for patterns like \"Max & Sarah\", \"Best, The Smiths\", etc. in family/social\ncorrespondence.\n\nIf no common sign-offs found, read 10-15 random email bodies and look at endings.\n\n### Phase 3: Context-Based Sampling\n\nDifferent contexts reveal different styles. Sample strategically:\n\n**Professional/vendor emails:**\n\n```bash\n# Support and vendor communications\njean-claude gmail search \"in:sent to:support@\" -n 20\njean-claude gmail search \"in:sent to:help@\" -n 20\njean-claude gmail search \"in:sent to:info@\" -n 20\n```\n\nRead 5-10 of these to understand professional tone.\n\n**Personal emails** (if user mixes personal and work in one account):\n\n```bash\n# Personal domains often indicate informal correspondence\njean-claude gmail search \"in:sent to:gmail.com\" -n 20\n```\n\nCompare tone and formality to professional emails.\n\n**Emails to spouse** (forwarding patterns):\n\n```bash\n# Forwards and FYIs to spouse reveal communication patterns\njean-claude gmail search \"in:sent to:spouse@email.com\" -n 30\n```\n\nLook for how they introduce forwarded content (\"FYI\", \"thoughts?\", \"reminder!\").\n\n**Replies vs new threads:**\n\n```bash\n# Replies (may be more casual, shorter)\njean-claude gmail search \"in:sent subject:Re:\" -n 30\n\n# New threads (may have fuller greetings)\njean-claude gmail search \"in:sent -subject:Re:\" -n 30\n```\n\n**Repeated recipients** (reveals relationship patterns):\n\nFrom the Phase 1 results, identify email addresses that appear multiple times.\nRead a few emails to each to see how the user's style varies by recipient.\n\n### Phase 4: Message Style Deep Dive\n\nFor iMessage/WhatsApp, sample from key relationships identified in Phase 1.\n\n**Prefer 1:1 chats over group chats** for style analysis ‚Äî group chats mix\nmultiple people's messages. Use groups to identify relationships, but read\n1:1 conversations to understand the user's style.\n\n```bash\n# Messages from specific chats (use chat ID from chats command)\njean-claude imessage messages --chat \"CHAT_ID\" -n 50\njean-claude whatsapp messages --chat \"JID\" -n 50\n\n# Or filter by contact name (iMessage only)\njean-claude imessage messages --name \"Contact Name\" -n 50\n```\n\n**Focus on outgoing messages** ‚Äî filter to `is_from_me: true` when analyzing\nthe user's style. Incoming messages show how others write, not the user. Look for:\n\n- **Case usage** ‚Äî Always proper case? Often lowercase?\n- **Punctuation** ‚Äî Heavy exclamation marks? Minimal punctuation?\n- **Emoji usage** ‚Äî Frequent? Rare? Which ones?\n- **Message length** ‚Äî One-liners? Paragraphs?\n- **Parenthetical asides** ‚Äî \"(just kidding)\", \"(ironic that...)\"\n\n### Phase 5: Extract Key Contacts\n\nFrom all the data gathered:\n\n1. **Most frequent email recipients** ‚Äî Note name, email, apparent relationship\n2. **Most active iMessage/WhatsApp chats** ‚Äî Note name, phone, relationship\n3. **Family members** ‚Äî Often identifiable from context (spouse, parents, kids)\n\nFor contacts that will be referenced by name, capture both name and phone/email\nso the user can say \"text Sarah\" without ambiguity.\n\n**Finding family relationships:**\n\n- Spouse often CC'd on emails or mentioned (\"my wife\", \"Ursula and I\")\n- Parents identifiable from surnames, context (\"my father\", formal address)\n- Children mentioned in scheduling, school emails, family updates\n- Siblings from family group chats, shared parents\n\n**Finding household staff/assistants:**\n\n- Look for group chats with family + another person (nanny, housekeeper)\n- Calendar events with recurring names\n- Emails about scheduling, logistics with non-family\n\n### What to Look For (Checklist)\n\n**Email patterns:**\n- [ ] Default sign-off (and variations by context)\n- [ ] Default greeting (and variations)\n- [ ] Typical email length\n- [ ] Formality level (contractions? exclamation marks?)\n- [ ] Writing tics (em-dashes? specific phrases?)\n- [ ] Professional vs personal style differences\n- [ ] Apology phrases (\"Very sorry for the slow reply\" vs \"Apologies for...\")\n- [ ] Forwarding style (brief note before forward? \"FYI\", \"thoughts?\")\n- [ ] Thread position style (first message vs quick reply ‚Äî often different)\n\n**Messaging patterns:**\n- [ ] Case usage (proper vs lowercase)\n- [ ] Emoji frequency and types\n- [ ] Punctuation habits\n- [ ] Message length\n- [ ] Reaction style (tapbacks like \"Loved [quote]\" vs emoji reactions)\n- [ ] Cross-platform consistency (same style on iMessage and WhatsApp?)\n\n**Key contacts** (use format: +1-555-123-4567 for phones):\n- [ ] Spouse/partner (name + phone + email)\n- [ ] Family members\n- [ ] Frequent correspondents (top 5-10)\n- [ ] Assistants or staff (if apparent)\n\n**Contextual preferences:**\n- [ ] Different styles for different audiences?\n- [ ] Seasonal greetings (\"HNY\" in Dec/Jan)?\n- [ ] Emoji usage by channel (often none in email, more in messages?)\n- [ ] Link sharing style (with context? just the URL?)\n- [ ] Scheduling phrases (\"How about Tuesday?\", \"any day works\")\n\n### Inferring Preferences\n\nSynthesize what you learned. Be specific and actionable:\n\n**Good inferences:**\n- \"Signs emails 'Max' for friends, 'Thanks, Max' for vendors/support\"\n- \"Uses exclamation marks freely with friends, sparingly in professional emails\"\n- \"Keeps emails to 2-3 sentences; uses numbered lists for technical issues\"\n- \"Opens casual emails with just the name + '!', professional with 'Hi [Name],'\"\n- \"Messages wife Ursula frequently at +1-555-123-4567\"\n- \"Often uses parenthetical asides: '(ironic that X!)'\"\n\n**Bad inferences** (too vague to act on):\n- \"Casual tone\" ‚Äî *how* casual? what markers?\n- \"Has contacts\" ‚Äî *which* ones? how should they be referenced?\n- \"Friendly\" ‚Äî what does that mean for drafting?\n\n**Subtle patterns emerge from volume:**\n\nSome patterns only become clear after reading 10+ examples:\n- Punctuation quirks (em-dashes, ellipses, exclamation frequency)\n- Phrase patterns (\"Random question ‚Äî\", \"gentle ping on this\")\n- Apology styles (\"Very sorry for the slow reply\" vs \"Apologies for the delay\")\n\nIf you notice something once, search for more examples to confirm it's a pattern.\n\n### Show for Review\n\nAfter analyzing, generate the skill file and **show it to the user before\nsaving**. They should review and approve:\n\n> Based on reviewing ~200 email snippets and reading samples from key threads,\n> plus your recent iMessages/WhatsApp, here's what I learned:\n>\n> ```markdown\n> [Generated skill content]\n> ```\n>\n> Does this look right? I can adjust anything before saving.\n\nTell them how many messages you analyzed so they understand the basis.\n\nOnly save after they approve. If they want changes, edit and show again.\n\n## Generating the Skill File\n\n### Check for Existing Skills\n\nBefore creating a new skill, check if the user already has one:\n\n```bash\nls ~/.claude/skills/\n```\n\nLook for:\n- `managing-messages`\n- Any skill mentioning email/inbox/messages in its description\n\nIf found, confirm: \"You already have a preferences skill. Want me to update\nthat one, or create a new one?\"\n\n### Skill Location\n\nUser skills go in `~/.claude/skills/`. Create a directory for their preferences:\n\n```bash\nmkdir -p ~/.claude/skills/managing-messages\n```\n\n### Skill Structure\n\nGenerate a SKILL.md based on what you learned. Keep it minimal‚Äîonly include\npatterns you actually observed.\n\n**Minimal example:**\n\n```markdown\n---\nname: managing-messages\ndescription: \"Personal messaging preferences. Load before jean-claude for inbox review, email drafting, or sending messages. Use when user asks about email, messages, or communication.\"\n---\n\n# Managing Messages\n\nSign off emails with \"Cheers, Max\"\n\nTone: casual with friends, professional but warm with work contacts.\n```\n\n**Fuller example** (when more patterns observed):\n\n```markdown\n---\nname: managing-messages\ndescription: \"Personal messaging preferences. Load before jean-claude for inbox review, email drafting, or sending messages. Use when user asks about email, messages, or communication.\"\n---\n\n# Managing Messages\n\nLoad `jean-claude` for Gmail, Calendar, iMessage, and WhatsApp commands.\n\n## Email Style\n\nSign off emails with \"Cheers, Max\" (just first name).\n\n**Tone by context:**\n- Work emails: professional but warm, not stiff\n- Friends and family: casual, uses exclamation marks freely\n\n**Patterns observed:**\n- Keeps emails short‚Äîusually 2-3 sentences\n- Opens with just the person's name, no \"Hi\" or \"Dear\"\n- Uses em-dashes frequently\n\n## Key Contacts\n\n- **Sarah** (wife): +1-555-123-4567\n- **Mom**: +1-555-987-6543\n\n## Inbox Approach\n\n[Only include if you can infer from their behavior or they mention it]\n```\n\n### Writing Guidelines\n\n- **Be specific** ‚Äî \"Signs 'Cheers, Max'\" not \"casual sign-off\"\n- **Only include observed patterns** ‚Äî Don't invent preferences\n- **Make it actionable** ‚Äî Each line should change how you draft messages\n\n### After Creating\n\n1. Show the generated content to the user for review\n2. Make any requested changes\n3. Write to `~/.claude/skills/managing-messages/SKILL.md`\n4. Confirm: \"Saved your preferences. I'll use these when drafting messages.\"\n\n## Updating Preferences\n\nWhen adding or changing preferences (from initial setup or learned corrections):\n\n1. Read the existing skill file\n2. Find the right section (or create one)\n3. Add/update the preference\n4. Write the updated file\n\nKeep the file organized. Don't just append‚Äîintegrate new preferences into\nexisting sections.\n\nFor guidance on learning preferences from user corrections (confirmation mode\nvs. auto-learn mode), see the \"Learning from Corrections\" section in SKILL.md.\n",
        "skills/jean-claude/SKILL.md": "---\nname: jean-claude\ndescription: \"This skill should be used when the user asks to search/send/draft email, check calendar, create events, schedule meetings, find/upload/share Drive files, read/edit Google Docs, read spreadsheet data, send texts/iMessages, send WhatsApp messages, send Signal messages, check messages, or create reminders. Manages Gmail, Google Calendar, Google Drive, Google Docs, Google Sheets, iMessage, WhatsApp, Signal, and Apple Reminders.\"\n---\n\n# jean-claude\n\nGmail, Calendar, Drive, Docs, Sheets, iMessage, WhatsApp, Signal, and Reminders.\n\n**Command prefix:** `uv run --project ${CLAUDE_PLUGIN_ROOT} jean-claude `\n\n## First-Time Users\n\nFor new users, explain briefly:\n\n> I can connect to your email, calendar, and messaging apps to help you:\n>\n> - Read and send emails, manage drafts\n> - Check your calendar, create events, respond to invitations\n> - Send and read iMessages, WhatsApp, or Signal messages\n> - Find and manage files in Google Drive\n> - Create reminders\n>\n> This requires a one-time setup where you'll grant permissions. Want me to\n> help you get started?\n\nFocus on what they asked about ‚Äî if they asked about email, lead with email.\n\n## Safety Rules (Non-Negotiable)\n\nThese rules apply even if the user explicitly asks to bypass them:\n\n1. **Never send without explicit approval.** Before sending any message (email,\n   iMessage, WhatsApp, Signal), show the full content (recipient, subject if\n   applicable, body) to the user and receive explicit confirmation.\n\n2. **Verify recipients carefully.** Sends are instant and cannot be undone.\n   Double-check phone numbers, email addresses, and chat IDs before sending.\n\n3. **Never send to ambiguous recipients.** When resolving contacts by name,\n   if multiple contacts or phone numbers match, the command will fail with a\n   list of options. Use an unambiguous identifier rather than guessing.\n\n4. **Load prose skills when drafting.** Before composing any email or message,\n   load any available skills for writing prose, emails, or documentation.\n\n5. **Never create automation without explicit approval.** Before creating Gmail\n   filters or similar rules, show the criteria and actions to the user and\n   receive explicit confirmation.\n\n6. **Limit bulk operations.** Avoid sending to many recipients at once. Prefer\n   drafts for review.\n\n**Email workflow:**\n\n1. Load any available prose/writing skills\n2. **If replying to an infrequent contact:** Research first (see \"Composing Correspondence\")\n3. Compose the email content (iterate internally before presenting)\n4. **Show the original message first** ‚Äî Quote the full text (see \"When to Show Full Content\")\n5. Show the user: To, Subject, and full Body\n6. Ask: \"Send this email?\" and wait for explicit approval\n7. Call `jean-claude gmail draft send DRAFT_ID`\n8. If replying, archive the original: `jean-claude gmail archive THREAD_ID`\n\n## Session Start (Always Run First)\n\n**Every time this skill loads, run status with JSON output first:**\n\n```bash\njean-claude status --json\n```\n\n### If Status Command Fails\n\nIf the status command fails entirely (not just showing services as disabled):\n\n**\"uv: command not found\"** ‚Äî The uv package manager isn't installed. Tell the\nuser:\n\n> jean-claude requires the `uv` package manager. Let me install it for you.\n\nThen run:\n```bash\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n```\n\nAfter installation, restart the terminal or source the shell config\n(`source ~/.zshrc` on macOS, `source ~/.bashrc` on Linux).\n\n**Other errors** ‚Äî The plugin may be misconfigured. Check that\n`${CLAUDE_PLUGIN_ROOT}` resolves to a valid path containing a `pyproject.toml`.\n\n### Branching Based on Status\n\n**If `setup_completed: false`** ‚Äî This is a new user. Skip personalization\nskills (they won't have any yet) and go straight to onboarding:\n\n```bash\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/ONBOARDING.md\n```\n\nFollow the onboarding guide to help set up services. After setup completes:\n\n```bash\njean-claude config set setup_completed true\n```\n\nThen **re-run status** and continue to the `setup_completed: true` branch below.\nThis ensures you have fresh status info and can proceed with the user's original\nrequest.\n\n**If `setup_completed: true`** ‚Äî Check for partial setup and load personalization:\n\n1. **Surface any auth warnings** ‚Äî If services show `authenticated: false`,\n   missing scopes, or errors, briefly mention it even if unrelated to the\n   user's request. Don't derail‚Äîjust note the issue and offer to fix later:\n\n   > \"By the way, your Google Contacts permission is missing ‚Äî I can't show\n   > contact names in emails. Want me to help fix that after your request?\"\n\n2. **Check for missing services** ‚Äî If the user asks for a service that shows\n   `authenticated: false` or `enabled: false`, guide them through just that\n   service's setup from ONBOARDING.md. After partial setup completes, continue\n   to step 3.\n\n3. **Load personalization skills** ‚Äî Check if user skills like `managing-messages`\n   exist (look at available skills for anything mentioning inbox, email, message,\n   or communication). If found, load them‚Äîuser preferences override defaults.\n\n4. **Offer to create preferences** ‚Äî If no personalization skill was found in\n   step 3, offer to create one after completing the user's immediate request.\n   See [PREFERENCES.md](PREFERENCES.md) for the creation flow. Don't interrupt\n   the user's task‚Äîhelp them first, then offer.\n\n5. **Proceed with the user's request** ‚Äî Execute whatever task prompted loading\n   this skill (check inbox, send message, etc.).\n\n### Before Using Messaging (iMessage/WhatsApp/Signal)\n\n**Load the platform guide before using any messaging commands.** Each platform\nhas different commands and options. Gmail is documented in this file, but\nmessaging platforms have separate guides:\n\n```bash\n# Load before using iMessage\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/imessage.md\n\n# Load before using WhatsApp\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/whatsapp.md\n\n# Load before using Signal\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/signal.md\n```\n\nDon't guess command syntax ‚Äî each platform is different. iMessage and WhatsApp\nhave different flags and subcommands despite similar functionality.\n\n### Understanding the Status\n\nFor users with setup complete, interpret the status output to understand their\nworkflow. Run human-readable status if needed for counts:\n\n```bash\njean-claude status\n```\n\n**Gmail:**\n- **13 inbox, 11 unread** ‚Üí inbox zero person, wants to triage everything\n- **2,847 inbox, 89 unread** ‚Üí not inbox zero, focus on recent/unread/starred\n- **5 drafts** ‚Üí has pending drafts to review or send\n\n**Calendar:**\n- **3 today, 12 this week** ‚Üí busy schedule, may need help with conflicts\n- **0 today** ‚Üí open day, good time for focused work\n\n**Reminders:**\n- **7 incomplete** ‚Üí has pending tasks, may want to review or complete them\n\n**Messaging:**\n- **54 unread across 12 WhatsApp chats** ‚Üí active messaging, may want summary\n- **1,353 unread across 113 iMessage chats** ‚Üí backlog, focus on recent/important\n\n**Apple services (Contacts, iMessage, Reminders):** These are disabled by default.\nIf `enabled: false` in status, enable with:\n```bash\njean-claude config set enable_contacts true   # For iMessage name lookup\njean-claude config set enable_imessage true\njean-claude config set enable_reminders true\n```\nOnce enabled, status checks full permissions (may trigger macOS permission\ndialogs on first run). If permission is missing, guide the user through\nSystem Settings > Privacy & Security > Automation.\n\n### Refreshing State\n\n**Summaries become stale immediately.** Once you present an inbox summary, that\nsnapshot is already potentially outdated. State changes constantly:\n\n- New messages arrive\n- Messages get read/sent from other devices or apps\n- The user takes actions outside this conversation\n- You took actions earlier in the conversation that you may not be tracking\n\n**Verify before making claims.** When the user asks about current state ‚Äî \"did I\nreply?\", \"is that still unread?\", \"how many are left?\" ‚Äî re-check rather than\nrelying on your memory of earlier summaries. Your memory is of what was true\nwhen you last checked, not what's true now.\n\n<example>\n<bad>\n\nUser: \"Did I reply to the Acme email?\"\n\nAgent: _recalls earlier summary where it wasn't replied to_\n\n\"No, that thread is still waiting for your reply.\"\n\n</bad>\n<good>\n\nUser: \"Did I reply to the Acme email?\"\n\nAgent: _searches for sent messages to Acme_\n\n\"Yes ‚Äî you replied today at 12:27pm following up on their question.\"\n\n</good>\n</example>\n\n**Re-fetch when:**\n\n- User asks about current counts or status\n- User asks \"did I...\" or \"is it still...\"\n- Presenting a summary after taking actions\n- You need metadata (dates, IDs, recipients) ‚Äî conversation summaries lose it,\n  so re-query the API rather than inferring from content\n\n**General principle:** Verify claims from the source. Re-fetching is cheap;\nwrong information is expensive.\n\n```bash\n# Check full inbox state (total count, all threads)\njean-claude gmail inbox\n\n# Check recent emails only (useful for \"what's new\")\njean-claude gmail inbox --since yesterday\n\n# Check sent messages to verify replies\njean-claude gmail search \"in:sent to:someone@example.com\" -n 5\n\n# Re-fetch iMessage (see platforms/imessage.md for full docs)\njean-claude imessage messages --unread\n\n# Re-sync WhatsApp for message updates\njean-claude whatsapp messages --unread\n```\n\n**Choosing between filtered and full inbox:**\n\n- **`--since yesterday`** ‚Äî Use for \"what's new\" or daily triage. Shows recent\n  arrivals only. After archiving these, there may still be older emails in inbox.\n- **No filter** ‚Äî Use when reporting inbox state (\"inbox cleared\", \"X emails\n  left\") or when the user wants to see everything, not just recent.\n\n## Defaults\n\nUser personalization skills override these defaults. If no personalization skill\nexists, use these behaviors:\n\n### Email Defaults\n- Fetch both read and unread messages (context helps)\n- Present messages neutrally ‚Äî don't assume priority\n- No automatic archiving without user guidance\n\n### iMessage Defaults\n- Prioritize known contacts over unknown senders\n\n### Response Drafting Defaults\n- Load prose/writing skills before composing\n- No assumed tone or style ‚Äî ask if unclear\n- Show full message for approval before sending\n\n## Working with Messages\n\n### Presenting Messages\n\nWhen showing messages (inbox, unread, search results), use a numbered list so\nthe user can reference items by number: \"archive 1, reply to 2\", \"star 3 and 5\".\n\n**Use manual numbering, not markdown lists.** Markdown numbered lists auto-correct\nto be sequential ‚Äî if you write \"3. 4. 5. 7. 15. 16.\" the renderer displays\n\"3. 4. 5. 6. 7. 8.\" causing a mismatch between what you wrote and what the user\nsees. Instead, format as `N:` on each line:\n\n```\n1: DoorDash (35 min ago) ‚Äî Your order...\n2: Squarespace (yesterday) ‚Äî Domain transfer...\n```\n\nThis prevents the renderer from \"fixing\" your numbering.\n\n**Keep items compact ‚Äî no blank lines between them.** Blank lines waste vertical\nspace and make the list harder to scan. Items should be on consecutive lines.\n\n**Preserve original numbers through the session.** After archiving items 1 and 3\nfrom a list of 1-5, show items 2, 4, 5 with their original numbers ‚Äî don't\nrenumber to 1, 2, 3. This gives items stable identifiers across operations.\n\n**Always include dates conversationally.** Check today's date before formatting:\n\n```bash\ndate \"+%Y-%m-%d %H:%M %Z\"  # Current date/time for reference\n```\n\n**Date formatting rules:**\n- **< 1 hour ago**: \"35 min ago\"\n- **Today** (> 1 hour): \"today at 9:15 AM\" ‚Äî not \"3 hours ago\"\n- **Yesterday**: \"yesterday at 2:30 PM\"\n- **This week**: \"Thursday at 4:30 PM\" (day name, not date)\n- **Beyond this week**: \"Dec 15\" or \"Nov 15 at 3pm\" (if time matters)\n\n**Example** (assuming today is Sunday, Dec 29):\n```\n1: DoorDash (35 min ago) ‚Äî Your order from Superba\n2: Squarespace (yesterday at 9:15 AM) ‚Äî Domain transfer rejected\n3: GitHub (Friday at 4:30 PM) ‚Äî PR merged: fix-auth-flow\n4: Goodreads (today at 10:30 AM) ‚Äî Book newsletter\n5: Jordan Lee (Nov 15) ‚Äî Forwarded: Fellowship nomination\n```\n\n### Accuracy in Summaries\n\n**Never fabricate details not present in the data.**\n\n- If an email says \"your child\", say \"your child\" ‚Äî don't invent \"Rachel\"\n- If a sender's relationship isn't stated, don't assume it\n- If a time/date isn't specified, say so ‚Äî don't guess\n- Quote or paraphrase what's actually there\n\nWhen uncertain, say so: \"The email doesn't specify who the assessment is for.\"\n\n### Accurate Counts\n\n**Use the `total_threads` and `total_unread` fields from the inbox response.**\n\nThe inbox command returns accurate counts from Gmail's label stats:\n\n```json\n{\"total_threads\": 32, \"total_unread\": 28, \"threads\": [...]}\n```\n\nWhen reporting counts, use these fields ‚Äî not the number of threads returned.\nThe `-n` flag limits how many threads are fetched, not how many exist.\n\n**Prefer `--since` over `-n` for complete results.** If you need emails from\ntoday, use `--since today` rather than `-n 20`. The `-n` flag returns the\nN most recent threads but may miss older unread emails in the inbox.\n\nThe `--since` flag accepts human-readable dates like \"yesterday\", \"3 days ago\",\n\"last week\", or explicit dates like \"2026-01-21\".\n\n### Filtered Results\n\nWhen `--since` or `--unread` is used, the `threads` array is a **subset** of\nthe full inbox. The `total_threads` and `total_unread` fields still reflect the\nfull inbox, not the filtered results.\n\n**Report filtered results accurately:**\n\n- \"6 threads from yesterday (32 total in inbox, 28 unread)\"\n- \"Archived 6 threads from yesterday\"\n\n**Never claim \"inbox cleared\" after archiving filtered results.** If you\narchived 6 threads from `--since yesterday` and `total_threads` was 32, there\nare still 26 other threads in the inbox. To check true inbox state after\ntriaging recent emails, run `jean-claude gmail inbox` without filters.\n\nHallucinated details erode trust. The user can't distinguish fabrications from\nreal data.\n\n### When to Show Full Content\n\n**Show the full email text** (not a summary) when:\n\n- **Drafting a reply** ‚Äî The user needs to see exactly what they're responding to\n- **User asks for a specific email** ‚Äî \"read the email from X\", \"show me that message\"\n- **User asks what they're replying to** ‚Äî \"what's the original?\", \"what did they say?\"\n\n**Summaries are appropriate when:**\n\n- Showing inbox/search results (the numbered list format with snippets)\n- The user asks for a specific detail ‚Äî \"when is the meeting?\", \"did they confirm?\"\n- Triaging multiple messages ‚Äî giving the user an overview to decide what to act on\n\n**The test:** If the user might need to quote, reference, or respond to the exact\nwording, show the full text. If they just need to understand the gist, summarize.\n\n### Presenting Individual Emails\n\nWhen showing the full text of an email, include all relevant headers:\n\n```\nFrom: Sender Name <sender@example.com>\nTo: Recipient <recipient@example.com>\nDate: Yesterday at 9:54 PM\nSubject: Meeting follow-up\n\n[email body]\n```\n\n**Always include:**\n- **From** ‚Äî Who sent it\n- **To** ‚Äî Who it was sent to (important for context, especially forwarded emails)\n- **Date** ‚Äî When it was sent (use conversational format per date rules above)\n- **Subject** ‚Äî The email subject\n\n**Include when present:**\n- **CC** ‚Äî If others were copied\n\nThe To field helps the user understand context ‚Äî was this sent directly to them,\nto a group, or forwarded from somewhere else?\n\n<example>\n<bad>\n\nUser: \"Reply to Alex's email and say I can't make it\"\n\nAgent: _reads email, immediately drafts reply_\n\n\"Alex's email was about NY logistics. Draft reply:\n\nHi Alex,\nUnfortunately I won't be able to join...\"\n\n</bad>\n<good>\n\nUser: \"Reply to Alex's email and say I can't make it\"\n\nAgent: _reads email, shows it first_\n\n\"From: Alex Chen <alex@sequoiacap.com>\nTo: Max <max@example.com>\nDate: Sunday at 9:34 PM\nSubject: Re: Napa Trip Logistics\n\n> Hey- Sam is going to fly back on Friday with Jordan and me. Same itinerary\n> as Jordan all the way back to LA. please let the office know. Also she'll\n> stay in the second bedroom at the hotel. Can you let them know? She can take\n> the car with Dana from the airport- drop Dana off downtown and then go to the\n> hotel while we take the other car straight to the venue on Wednesday.\n\nDraft reply:\n\nHi Alex,\n...\"\n\n</good>\n</example>\n\n### Marking Messages as Read\n\nWhen you show the full body of a message ‚Äî not just a snippet from a list ‚Äî\nmark it as read. The `gmail message` and `gmail thread` commands print a\nreminder with the exact command to run.\n\n**Don't mark as read** when only showing inbox/search results (snippets).\n\nCross-service commands:\n- Gmail: `jean-claude gmail mark-read THREAD_ID`\n- iMessage: `jean-claude imessage mark-read CHAT_ID`\n- WhatsApp: `jean-claude whatsapp mark-read CHAT_ID`\n\n### Cross-Referencing Email and Calendar\n\n**Always cross-reference between email and calendar.** When processing messages,\ncheck if they relate to calendar events. When reviewing calendar, check email\nfor relevant context.\n\n**Messages ‚Üí Calendar:**\n\n- **Availability questions** (\"Are you free Tuesday?\") ‚Üí Check calendar, include\n  the answer\n- **Meeting details** (phone numbers, Zoom links, addresses) ‚Üí Check for matching\n  event, offer to add details\n- **Schedule mentions** (\"call at 11:30\", \"meeting tomorrow\") ‚Üí Check if event\n  exists, offer to create if not\n- **Changes** (\"let's push to 3pm\", \"need to reschedule\") ‚Üí Find the event,\n  offer to update\n- **Cancellations** (\"can't make it\", \"let's cancel\") ‚Üí Find the event, offer\n  to delete or decline\n\n<example>\n<bad>\n\n```\n1. Dana Chen (today at 10:33 AM) ‚Äî \"Please call Marcus at 415-555-0142\"\n   ‚Üí You have his number for the 11:30 call.\n```\n\n</bad>\n<good>\n\n```\n1. Dana Chen (today at 10:33 AM) ‚Äî \"Please call Marcus at 415-555-0142\"\n   ‚Üí You have \"Call with Marcus\" at 11:30. Want me to add his number to the invite?\n```\n\n</good>\n</example>\n\n<example>\n<bad>\n\n```\n1. Alex Chen (yesterday at 12:24 PM) ‚Äî \"Re: Dinner in Jan\"\n   He's asking: Tuesday the 6th or Thursday the 8th?\n```\n\n</bad>\n<good>\n\n```\n1. Alex Chen (yesterday at 12:24 PM) ‚Äî \"Re: Dinner in Jan\"\n   He's asking: Tuesday the 6th or Thursday the 8th?\n   ‚Üí You're free both evenings. Thursday has a 3pm meeting that ends at 4.\n```\n\n</good>\n</example>\n\n**Calendar ‚Üí Email:**\n\nWhen reviewing calendar events, check email for related context:\n\n- Upcoming meeting with someone ‚Üí Recent emails with them may have agenda items\n- Event missing details ‚Üí Search email for the invite or logistics thread\n- Unfamiliar attendee ‚Üí Search email history to understand the relationship\n\nThe user shouldn't have to ask \"what's on my calendar?\" or \"did they send\ndetails?\" as follow-ups. If a message relates to a scheduled event, check the\ncalendar proactively. Check calendars where the user has events (see \"Choosing\nthe Right Calendar\").\n\n## Proactive Behavior\n\nComplete tasks fully. Don't stop early to ask if you should continue.\n\n### Browser Navigation\n\nProceed through Terms of Service, cookie banners, login confirmations, and\n\"Continue\" buttons without asking ‚Äî these are prerequisites, not decisions.\n\nAsk only for: purchases, sending messages, creating public content, or sharing\ndata with new parties.\n\n**The test:** Would a reasonable person pause here?\n\n### Research Questions\n\nWhen the user asks about facts ‚Äî names, relationships, dates, contact info ‚Äî do\nthe research immediately. Don't say \"I don't know\" based on limited context.\n\n- **\"What's Marco's wife's name?\"** ‚Üí Search emails and messages from Marco,\n  check calendar invites for +1s\n- **\"When did I last talk to Sarah?\"** ‚Üí Search messages and emails\n- **\"What's Tom's phone number?\"** ‚Üí Search contacts, emails, messages\n\nIf you search thoroughly and find nothing, say so: \"I searched your emails and\nmessages with Marco but didn't find any family names mentioned.\"\n\n<example>\n<bad>\n\nUser: \"What are Marco's wife & kid's names?\"\n\nAgent: \"I don't know‚Äîthe message from Marco didn't mention names. Want me to\nsearch your emails or messages for more context?\"\n\n</bad>\n<good>\n\nUser: \"What are Marco's wife & kid's names?\"\n\nAgent: _searches emails from/to Marco, searches messages, looks for birth\nannouncements, wedding invites, etc._\n\n\"From your email history with Marco:\n- Wife: Sofia Martinez\n- Daughter: Isabella ('Bella'), born January 4, 2017\"\n\n</good>\n</example>\n\n### Reading Content\n\nWhen the user asks to read something, include all related content:\n\n- **\"Read the email from X\"** ‚Üí Fetch the email, read any attachments (PDFs,\n  images) without asking\n- **\"Check my messages\"** ‚Üí If messages contain images, describe them\n- **\"Look at the calendar invite\"** ‚Üí Open linked documents\n\nDon't stop at metadata. \"Want me to download the attachment?\" is asking the user\nto do your job.\n\n<example>\n<bad>\n\nUser: \"read the amex email\"\n\nAgent: _fetches email metadata_\n\n\"The AMEX email has a PDF attachment (claim_docs.pdf, 28KB). Want me to download it?\"\n\n</bad>\n<good>\n\nUser: \"read the amex email\"\n\nAgent: _fetches email, downloads PDF, reads it_\n\n\"AMEX sent claim documents for #12266792. The PDF contains:\n- Claim form to fill out\n- Instructions to mail to [address]\n- Supporting documentation requirements\"\n\n</good>\n</example>\n\n## Composing Correspondence\n\nFor infrequent contacts ‚Äî people the user doesn't interact with regularly ‚Äî\nunderstand the relationship before drafting. Skip this for close friends, family,\nor frequent correspondents where context is obvious.\n\n### Research First\n\nWhen replying to an infrequent contact (catching up, introductions, social\ncorrespondence), research before drafting:\n\n1. **Search email history** ‚Äî When did they last correspond? What did they discuss?\n2. **Search the web** ‚Äî If unfamiliar, who is this person? What do they do? Where are they based?\n3. **Report context** ‚Äî Tell the user what you found before showing a draft\n\n<example>\n<bad>\n\nUser: \"Reply to Alex's email\"\n\nAgent: _immediately drafts reply_\n\n\"Draft:\nHi Alex,\nThanks for reaching out! The AI coding tool sounds right up my alley. Happy to\nconnect with Jordan.\nBest, Max\"\n\n</bad>\n<good>\n\nUser: \"Reply to Alex's email\"\n\nAgent: _searches email history and web_\n\n\"Alex Chen ‚Äî based in SF, you last emailed him 8 months ago about the open-source\nproject. He's a research scientist at Google DeepMind, one of the original\nauthors of the library. Before that you collaborated on a NeurIPS tutorial in 2019.\n\nHis email mentions Jordan Lee, who I found on LinkedIn was at Stripe for 6 years\nand is now building an AI coding tool, also in SF...\"\n\n[Then proceeds to draft with this context]\n\n</good>\n</example>\n\nThe user shouldn't need to ask \"when did I last talk to them?\" or \"who is this\nperson?\" ‚Äî do that research proactively.\n\n### Intro Email Etiquette\n\nWhen replying to an introduction email (someone introduced you to a new contact),\nmove the introducer to BCC and acknowledge it:\n\n```\nBCCing [Introducer] to spare their inbox.\n\n[Rest of reply]\n```\n\nThis lets the introducer see that the connection was made without receiving every\nsubsequent message in the thread. It's standard professional etiquette.\n\n### Redirecting a Reply\n\nSometimes the user wants to reply in-thread but send it to someone other than\nthe original sender ‚Äî typically moving the sender to CC. This keeps everyone in\nthe loop while directing the reply to the right person.\n\n**When to apply:** The user says something like:\n- \"reply to the email, but send it to [person]\"\n- \"moving [original sender] to CC\"\n- \"reply to [someone else on the thread], CC [sender]\"\n\n**Pattern:** Create the reply, then update recipients:\n\n```bash\n# Step 1: Create reply (preserves threading, quotes original)\ncat << 'EOF' | jean-claude gmail draft reply MESSAGE_ID\nYour message here.\nEOF\n\n# Step 2: Update recipients\njean-claude gmail draft update DRAFT_ID \\\n  --to \"new_recipient@example.com\" --cc \"original_sender@example.com\" < /dev/null\n```\n\n<example>\n<scenario>\n\nAlex sends an email to his assistant Dana at Sequoia, CC'ing the user:\n> \"Dana - Max will join us for the partners retreat in Napa. Please book him\n> on the Friday flight.\"\n\nUser says: \"Reply to Dana that I can't make it, CC Alex\"\n\n</scenario>\n<workflow>\n\n1. `jean-claude gmail draft reply MESSAGE_ID` with the body\n2. `jean-claude gmail draft update DRAFT_ID --to \"dana@sequoiacap.com\" --cc \"alex@sequoiacap.com\"`\n3. `jean-claude gmail draft get DRAFT_ID` to verify recipients, show to user\n4. `jean-claude gmail draft send DRAFT_ID` after approval\n\n</workflow>\n</example>\n\n### Address the Person, Not the Issue\n\nCustomary emails ‚Äî introductions, catching up, social correspondence ‚Äî are about\nthe relationship, not transactions.\n\n<example>\n<bad>\n\n\"The AI coding tool sounds right up my alley.\"\n\nCenters the user's interests, jumps straight to business.\n\n</bad>\n<good>\n\n\"I'm glad to see the project continues to thrive. Hope all's well with you ‚Äî\nwould enjoy catching up soon.\"\n\nAcknowledges what matters to Alex before addressing the introduction.\n\n</good>\n</example>\n\nFor social correspondence, address the person before addressing what they asked about.\n\n### Iterate Before Presenting\n\nDrafts deserve thought. Don't produce one immediately and present it.\n\n**Internal iteration process:**\n\n1. Research the relationship (see above)\n2. Consider the tone ‚Äî formal? warm? brief?\n3. Draft internally, critique it: \"If this email is bad, why?\"\n4. Revise, then present\n\nFor important correspondence, explain your reasoning or offer alternatives:\n\"I went with a warm but brief tone since you haven't talked in 8 months. Want\nsomething more formal?\"\n\n### Iterating with the User\n\nCreate actual Gmail drafts, not just text in the conversation. Drafts persist\nif the session ends and can be edited in Gmail directly.\n\n**Workflow:**\n\n1. Create the draft: `jean-claude gmail draft create` (or `reply`/`forward`)\n2. Show the user what you created (recipient, subject, key points)\n3. If they request changes, edit the draft file and update:\n   - `cat ~/.cache/jean-claude/drafts/draft-DRAFT_ID.txt` to see current\n   - Edit the file with the changes\n   - `cat ... | jean-claude gmail draft update DRAFT_ID` to save\n4. Repeat until approved, then send\n\n### Vocabulary\n\nAvoid hollow phrases. If a phrase could apply to anyone, it says nothing.\n\n- \"Nice to hear from you\" ‚Üí could be sent to anyone\n- \"I'm glad to see the project continues to thrive\" ‚Üí specific to this person\n\nCheck the user's personalization skill for vocabulary preferences.\n\n## Setup\n\n### Prerequisites\n\nThis plugin requires `uv` (Python package manager). If not installed:\n\n```bash\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n```\n\n### Google Workspace\n\nCredentials stored in `~/.config/jean-claude/`. First-time setup:\n\n```bash\n# Full access (read, send, modify)\njean-claude auth\n\n# Or read-only access (no send/modify capabilities)\njean-claude auth --readonly\n\n# Check authentication status and API availability\njean-claude status\n\n# Log out (remove stored credentials)\njean-claude auth --logout\n```\n\nThis opens a browser for OAuth consent. Credentials persist until revoked.\n\n**If you see \"This app isn't verified\":** This warning appears because\njean-claude uses a personal OAuth app that hasn't gone through Google's\n(expensive) verification process. It's safe to proceed:\n\n1. Click \"Advanced\"\n2. Click \"Go to jean-claude (unsafe)\"\n3. Review and grant the requested permissions\n\nThe \"unsafe\" label just means unverified, not malicious. The app only accesses\nthe specific Google services you authorize.\n\nTo use your own Google Cloud credentials instead (if default ones hit the 100\nuser limit), download your OAuth JSON from Google Cloud Console and save it as\n`~/.config/jean-claude/client_secret.json` before running the auth script. See\nREADME for detailed setup steps.\n\n### Feature Flags (WhatsApp & Signal)\n\nWhatsApp and Signal are **disabled by default**. These services require\ncompiling native binaries (Go for WhatsApp, Rust for Signal), and we want\njean-claude to work smoothly for Gmail/Calendar users without those toolchains.\nEnable explicitly if you need messaging:\n\n```bash\njean-claude config set enable_whatsapp true\njean-claude config set enable_signal true\n```\n\nThe `status` command shows whether each service is enabled or disabled.\n\n### WhatsApp\n\nWhatsApp requires enabling the feature flag, a Go binary, and QR code\nauthentication. First-time setup:\n\n```bash\n# Build the Go CLI (requires Go installed)\ncd ${CLAUDE_PLUGIN_ROOT}/whatsapp && go build -o whatsapp-cli .\n\n# Authenticate with WhatsApp (scan QR code with your phone)\njean-claude whatsapp auth\n\n# Check authentication status\njean-claude status\n```\n\nThe QR code will be displayed in the terminal and saved as a PNG file. Scan it\nwith WhatsApp: Settings > Linked Devices > Link a Device.\n\nCredentials are stored in `~/.config/jean-claude/whatsapp/`. To log out:\n\n```bash\njean-claude whatsapp logout\n```\n\n### Signal\n\nSignal requires enabling the feature flag, a Rust binary, and QR code linking.\nFirst-time setup:\n\n```bash\n# Build the Rust CLI (requires Rust/Cargo and protobuf installed)\ncd ${CLAUDE_PLUGIN_ROOT}/signal && cargo build --release\n\n# Link as a secondary device (scan QR code with your phone)\njean-claude signal link\n\n# Check authentication status\njean-claude status\n```\n\nThe QR code will be displayed in the terminal. Scan it with Signal on your\nphone: Settings > Linked Devices > Link New Device.\n\nCredentials are stored in `~/.local/share/jean-claude/signal/`.\n\n## Gmail\n\n**CLI convention:** Email addresses are comma-separated (`--to \"a@x.com,b@x.com\"`).\nOther multi-value flags use repeated flags (`--attach f1 --attach f2`).\n\n### Reading Emails\n\nSee \"Personalization\" section for default behaviors and user skill overrides.\n\n**Two data types:**\n\n- **Threads** ‚Äî Conversations (one or more messages). Returned by `inbox`.\n- **Messages** ‚Äî Individual emails. Returned by `search` and `get`.\n\n**Thread response schema (from `inbox`):**\n\n```json\n{\n  \"threads\": [\n    {\n      \"threadId\": \"19b29039fd36d1c1\",\n      \"messageCount\": 3,\n      \"unreadCount\": 1,\n      \"subject\": \"Subject line\",\n      \"labels\": [\"INBOX\", \"UNREAD\"],\n      \"messages\": [\n        {\"id\": \"msg_id_1\", \"date\": \"2025-12-14T10:00:00-08:00\", \"from\": \"alice@example.com\", \"to\": \"you@example.com\", \"labels\": [\"INBOX\"], \"unread\": false},\n        {\"id\": \"msg_id_2\", \"date\": \"2025-12-15T14:30:00-08:00\", \"from\": \"you@example.com\", \"to\": \"alice@example.com\", \"labels\": [\"SENT\"], \"unread\": false},\n        {\"id\": \"msg_id_3\", \"date\": \"2025-12-16T09:00:00-08:00\", \"from\": \"alice@example.com\", \"to\": \"you@example.com\", \"labels\": [\"INBOX\", \"UNREAD\"], \"unread\": true}\n      ],\n      \"latest\": {\n        \"id\": \"msg_id_3\",\n        \"date\": \"2025-12-16T09:00:00-08:00\",\n        \"from\": \"alice@example.com\",\n        \"snippet\": \"Latest message snippet...\"\n      },\n      \"file\": \"~/.cache/jean-claude/emails/thread-19b29039fd36d1c1.json\"\n    }\n  ],\n  \"nextPageToken\": \"abc123...\"\n}\n```\n\nThread files contain **metadata only** (no message bodies). The `messages` array\nshows each message with date, sender, and read status ‚Äî **ordered oldest to newest**.\nThe `latest` object provides quick access to the most recent message's metadata and\nsnippet. To read message bodies, use `gmail message MESSAGE_ID` or `gmail thread THREAD_ID`.\n\n**Message response schema (from `search`):**\n\n```json\n{\n  \"messages\": [\n    {\n      \"id\": \"19b29039fd36d1c1\",\n      \"threadId\": \"19b29039fd36d1c1\",\n      \"from\": \"Name <email@example.com>\",\n      \"to\": \"recipient@example.com\",\n      \"subject\": \"Subject line\",\n      \"date\": \"2025-12-16T21:12:21-08:00\",\n      \"snippet\": \"First ~200 chars of body...\",\n      \"labels\": [\"INBOX\", \"UNREAD\"],\n      \"file\": \"~/.cache/jean-claude/emails/email-19b29039fd36d1c1.json\"\n    }\n  ],\n  \"nextPageToken\": \"abc123...\"\n}\n```\n\n**`get` returns a list directly** (no pagination wrapper):\n\n```json\n[\n  {\n    \"id\": \"19b29039fd36d1c1\",\n    \"threadId\": \"19b29039fd36d1c1\",\n    \"from\": \"Name <email@example.com>\",\n    ...\n    \"file\": \"~/.cache/jean-claude/emails/email-19b29039fd36d1c1.json\"\n  }\n]\n```\n\n**Message file format:** Each message creates three files:\n- `email-{id}.json` ‚Äî Metadata with `body_file` and `html_file` paths\n- `email-{id}.txt` ‚Äî Plain text body (readable with `cat`/`less`)\n- `email-{id}.html` ‚Äî HTML body when present (contains unsubscribe links)\n\nThe `nextPageToken` field is only present when more results are available. Use\n`--page-token` to fetch the next page:\n\n```bash\n# First page\njean-claude gmail search \"is:unread\" -n 50\n\n# If nextPageToken is in the response, fetch next page\njean-claude gmail search \"is:unread\" -n 50 \\\n  --page-token \"TOKEN_FROM_PREVIOUS_RESPONSE\"\n```\n\n### Search Emails\n\n```bash\n# Inbox emails from a sender\njean-claude gmail search \"in:inbox from:someone@example.com\"\n\n# Limit results with -n\njean-claude gmail search \"from:newsletter@example.com\" -n 10\n\n# Unread inbox emails\njean-claude gmail search \"in:inbox is:unread\"\n\n# Shortcut for inbox (includes total_threads and total_unread counts)\njean-claude gmail inbox\njean-claude gmail inbox --unread\n\n# Use --since for complete results from a date (preferred over -n)\n# Accepts human-readable dates like \"yesterday\", \"last week\", \"3 days ago\"\njean-claude gmail inbox --since yesterday\njean-claude gmail inbox --since \"3 days ago\"\njean-claude gmail inbox --since \"last week\"\njean-claude gmail inbox --since 2026-01-20\n\n# -n limits results but may miss older emails - use --since instead\njean-claude gmail inbox -n 5\n\n# Inbox also supports pagination\njean-claude gmail inbox --unread -n 50 --page-token \"TOKEN\"\n```\n\nCommon Gmail search operators: `in:inbox`, `is:unread`, `is:starred`, `from:`,\n`to:`, `subject:`, `after:2025/01/01`, `has:attachment`, `label:`\n\n### Fetch Messages and Threads\n\n```bash\n# Fetch message by ID (writes body to ~/.cache/jean-claude/emails/)\njean-claude gmail message MESSAGE_ID\n\n# Fetch multiple messages\njean-claude gmail message MSG_ID_1 MSG_ID_2 MSG_ID_3\n\n# Fetch all messages in a thread (full conversation)\njean-claude gmail thread THREAD_ID\n```\n\nUse this when you have a specific message ID and want to read its full content.\n\n**Mark as read after fetching.** When you fetch unread messages, the command\nprints a reminder with the exact mark-read command to run:\n\n```\nTo mark as read: jean-claude gmail mark-read THREAD_ID\n```\n\nRun that command after presenting the content to the user. This also applies\nwhen creating replies or forwards (you read the original to compose the response).\n\n### Drafts\n\nAll draft commands read body from stdin. Create uses flags for metadata.\n\n**IMPORTANT: Use heredocs, not echo.** Claude Code's Bash tool has a known bug\nthat escapes exclamation marks ('!' becomes '\\!'). Always use heredocs:\n\n```bash\n# Create a new draft\ncat << 'EOF' | jean-claude gmail draft create --to \"recipient@example.com\" --subject \"Subject\"\nMessage body here!\nEOF\n\n# Create with CC/BCC\ncat << 'EOF' | jean-claude gmail draft create --to \"recipient@example.com\" --subject \"Subject\" --cc \"cc@example.com\"\nMulti-line message body here.\nEOF\n\n# Multiple recipients\ncat << 'EOF' | jean-claude gmail draft create --to \"alice@example.com,bob@example.com\" --subject \"Team update\"\nMessage to multiple people.\nEOF\n\n# Reply to a message (body from stdin, preserves threading, includes quoted original)\ncat << 'EOF' | jean-claude gmail draft reply MESSAGE_ID\nThanks for your email!\nEOF\n\n# Reply with custom CC\ncat << 'EOF' | jean-claude gmail draft reply MESSAGE_ID --cc \"manager@example.com\"\nThanks for the update!\nEOF\n\n# Forward a message (TO as argument, optional note from stdin)\ncat << 'EOF' | jean-claude gmail draft forward MESSAGE_ID someone@example.com\nFYI - see below!\nEOF\n\n# Forward without a note\njean-claude gmail draft forward MESSAGE_ID someone@example.com < /dev/null\n\n# Reply-all (includes all original recipients)\ncat << 'EOF' | jean-claude gmail draft reply-all MESSAGE_ID\nThanks everyone!\nEOF\n\n# List drafts\njean-claude gmail draft list\njean-claude gmail draft list -n 5\n\n# Get draft (writes metadata to .json and body to .txt)\njean-claude gmail draft get DRAFT_ID\n\n# Update draft body (from stdin)\ncat ~/.cache/jean-claude/drafts/draft-DRAFT_ID.txt | jean-claude gmail draft update DRAFT_ID\n\n# Update metadata only\njean-claude gmail draft update DRAFT_ID --subject \"New subject\" --cc \"added@example.com\"\n\n# Update both body and metadata\ncat body.txt | jean-claude gmail draft update DRAFT_ID --subject \"Updated\"\n\n# Send a draft (after approval)\njean-claude gmail draft send DRAFT_ID\n\n# Delete a draft\njean-claude gmail draft delete DRAFT_ID\n```\n\n#### Attachments\n\nDraft creation commands (`create`, `reply`, `reply-all`, `forward`, `update`)\nsupport `--attach` for file attachments. Use multiple times for multiple files:\n\n```bash\n# Create draft with attachments\ncat << 'EOF' | jean-claude gmail draft create --to \"x@y.com\" --subject \"Report\" --attach report.pdf --attach data.csv\nPlease see the attached files.\nEOF\n\n# Reply with attachment\ncat << 'EOF' | jean-claude gmail draft reply MESSAGE_ID --attach response.pdf\nHere is my response with the requested document.\nEOF\n\n# Forward (original attachments included automatically)\ncat << 'EOF' | jean-claude gmail draft forward MESSAGE_ID someone@example.com\nFYI - see below.\nEOF\n\n# Forward with additional attachment\ncat << 'EOF' | jean-claude gmail draft forward MESSAGE_ID someone@example.com --attach notes.pdf\nFYI - I added my notes.\nEOF\n\n# Add attachment to existing draft (replaces any existing attachments)\njean-claude gmail draft update DRAFT_ID --attach newfile.pdf < /dev/null\n\n# Remove all attachments from a draft\njean-claude gmail draft update DRAFT_ID --clear-attachments < /dev/null\n```\n\n**Viewing attachments:** Use `draft get` to see what files are attached:\n\n```bash\njean-claude gmail draft get DRAFT_ID\n# Output includes: {\"attachments\": [{\"filename\": \"report.pdf\", \"mimeType\": \"application/pdf\"}]}\n```\n\n**Iterating on long emails:** For complex emails, use file editing to iterate\nwith the user without rewriting the full email each time:\n\n1. Create initial draft using heredoc (see examples above)\n2. Get draft files: `jean-claude gmail draft get DRAFT_ID` (writes `.json` and `.txt`)\n3. Use Edit tool to modify `~/.cache/jean-claude/drafts/draft-DRAFT_ID.txt`\n4. Update draft: `cat ~/.cache/jean-claude/drafts/draft-DRAFT_ID.txt | jean-claude gmail draft update DRAFT_ID`\n5. Show user, get feedback, repeat steps 3-4 until approved\n\n**Verifying important drafts:** For important emails, read the draft back after\ncreating it to confirm formatting is correct:\n\n```bash\n# Create draft\ncat << 'EOF' | jean-claude gmail draft create --to \"...\" --subject \"...\"\nEmail body here!\nEOF\n\n# Verify the draft content (check for escaping issues like \\!)\njean-claude gmail draft get DRAFT_ID\ncat ~/.cache/jean-claude/drafts/draft-DRAFT_ID.txt\n```\n\nThis catches any escaping bugs before sending. Also verify drafts with\nattachments ‚Äî confirm the right files are attached before sending.\n\n### Manage Threads and Messages\n\nMost commands operate on threads (matching Gmail UI behavior). Use `threadId` from\ninbox output. Star/unstar operate on individual messages (use IDs from `messages` array).\n\n```bash\n# Star/unstar (message-level - use message IDs from `messages` array)\njean-claude gmail star MSG_ID1 MSG_ID2 MSG_ID3\njean-claude gmail unstar MSG_ID1 MSG_ID2\n\n# Archive/unarchive (thread-level - use threadId)\njean-claude gmail archive THREAD_ID1 THREAD_ID2 THREAD_ID3\njean-claude gmail archive --query \"from:newsletter@example.com\" -n 50\njean-claude gmail unarchive THREAD_ID1 THREAD_ID2 THREAD_ID3\n\n# Mark read/unread (thread-level - use threadId)\njean-claude gmail mark-read THREAD_ID1 THREAD_ID2\njean-claude gmail mark-unread THREAD_ID1 THREAD_ID2\n\n# Trash (thread-level - use threadId)\njean-claude gmail trash THREAD_ID1 THREAD_ID2 THREAD_ID3\n```\n\n**Which ID to use:**\n- Thread operations (archive, mark-read, trash, `gmail thread`): use `threadId`\n- Message operations (star, `gmail message`, reply): use `id` from `messages` array\n- Use `--query` for pattern-based operations (archive supports this)\n\n### Attachments\n\n```bash\n# List attachments for a message\njean-claude gmail attachments MESSAGE_ID\n\n# Download an attachment (saved to ~/.cache/jean-claude/attachments/)\njean-claude gmail attachment-download MESSAGE_ID ATTACHMENT_ID filename.pdf\n\n# Download to specific directory\njean-claude gmail attachment-download MESSAGE_ID ATTACHMENT_ID filename.pdf --output ./\n```\n\n### Unsubscribing from Newsletters\n\nUnsubscribe links are in the HTML file, not the plain text. Note: HTML files are\nonly created when the email has HTML content (most newsletters do).\n\n```bash\n# Search HTML body for unsubscribe links (if HTML file exists)\ngrep -oE 'https?://[^\"<>]+unsubscribe[^\"<>]*' ~/.cache/jean-claude/emails/email-MESSAGE_ID.html\n```\n\n**Decoding tracking URLs:** Newsletters often wrap links in tracking redirects.\nURL-decode to get the actual destination:\n\n```python\nimport urllib.parse\nprint(urllib.parse.unquote(encoded_url))\n```\n\n**Completing the unsubscribe:**\n- Mailchimp, Mailgun, and similar services work with browser automation\n- Cloudflare-protected sites (Coinbase, etc.) block automated requests ‚Äî provide\n  the decoded URL to the user to click manually\n\n### Labels\n\nList all Gmail labels to get label IDs for filtering:\n\n```bash\njean-claude gmail labels\n```\n\nReturns system labels (INBOX, SENT, TRASH, etc.) and custom labels (Label_123...).\n\n### Filters\n\nFilters automatically process incoming mail based on criteria.\n\n```bash\n# List all filters\njean-claude gmail filter list\n\n# Get a specific filter\njean-claude gmail filter get FILTER_ID\n\n# Delete a filter\njean-claude gmail filter delete FILTER_ID\n```\n\n**Creating filters** ‚Äî query + label operations:\n\n```bash\n# Archive (remove INBOX label)\njean-claude gmail filter create \\\n    \"to:reports@company.com\" -r INBOX\n\n# Star and mark important\njean-claude gmail filter create \\\n    \"from:boss@company.com\" -a STARRED -a IMPORTANT\n\n# Mark as read (remove UNREAD label)\njean-claude gmail filter create \\\n    \"from:alerts@service.com\" -r UNREAD\n\n# Forward\njean-claude gmail filter create \\\n    \"from:vip@example.com\" -f backup@example.com\n```\n\n**Common labels:** `INBOX`, `UNREAD`, `STARRED`, `IMPORTANT`, `TRASH`, `SPAM`,\n`CATEGORY_PROMOTIONS`, `CATEGORY_SOCIAL`, `CATEGORY_UPDATES`\n\n**Custom labels:** Use `jean-claude gmail labels` to get IDs like `Label_123456`.\n\n## Calendar\n\nAll calendar commands return JSON.\n\n### Multiple Calendars\n\nBy default, commands operate on the primary calendar. Use `--calendar` to work\nwith other calendars.\n\n```bash\n# List available calendars\njean-claude gcal calendars\n```\n\nReturns:\n```json\n[\n  {\"id\": \"user@gmail.com\", \"name\": \"Personal\", \"primary\": true, \"accessRole\": \"owner\"},\n  {\"id\": \"work@company.com\", \"name\": \"Work Calendar\", \"primary\": false, \"accessRole\": \"writer\"},\n  {\"id\": \"family@group.calendar.google.com\", \"name\": \"Family\", \"primary\": false, \"accessRole\": \"owner\"}\n]\n```\n\nUse `--calendar` with any command to specify a different calendar:\n\n```bash\n# List events from a specific calendar\njean-claude gcal list --calendar work@company.com\n\n# Create event on another calendar\njean-claude gcal create \"Team Sync\" \\\n  --start \"2025-01-15 14:00\" --calendar work@company.com\n\n# Search by calendar name (case-insensitive substring match)\njean-claude gcal list --calendar \"Family\"\n```\n\nThe `--calendar` flag accepts:\n- Calendar ID (email or group calendar ID)\n- Calendar name (case-insensitive substring match)\n- `primary` (default)\n\nIf a name matches multiple calendars, the command fails with a list of options.\n\n**Multiple calendars in one query:** The `list`, `search`, and `invitations`\ncommands accept multiple `--calendar` flags to query across calendars:\n\n```bash\njean-claude gcal list --from 2025-01-15 --to 2025-01-15 \\\n  --calendar \"Personal\" --calendar \"Work\"\n```\n\nEach event includes `calendar_id` and `calendar_name` in the output.\n\n### Choosing the Right Calendar\n\nThe status command shows participation metrics:\n\n```\nMax @ Personal (primary) (24 upcoming: 10 yours, 14 invited) [owner]\nRoos family (81 upcoming: 3 invited) [owner]\nMax @ TGS (44 upcoming, 0 yours) [freeBusyReader]\n```\n\n- **X yours** ‚Äî Events where user is the organizer\n- **X invited** ‚Äî Events where user is an attendee\n- **0 yours** ‚Äî Likely a \"block\" calendar (someone else's schedule)\n\nCheck user preferences for which calendars represent their availability vs\ncalendars they just view. When in doubt, ask.\n\n**Checking availability:** Query multiple calendars at once:\n\n```bash\njean-claude gcal list --from 2025-01-07 --to 2025-01-07 \\\n  --calendar \"Max @ Personal\" --calendar \"Roos family\"\n```\n\n**Creating events:** Use the primary calendar unless the user names a different\none or context suggests otherwise (work event ‚Üí work calendar).\n\n### Proactive Calendar Management\n\nWhen creating events, add useful information proactively:\n\n- **Attendees** ‚Äî If the user mentions meeting someone, look up their email and\n  add them\n- **Locations** ‚Äî If the user mentions a place, search for the full address\n- **Video links** ‚Äî For remote meetings, include the call link if known\n\nA calendar invite should have everything attendees need to show up prepared.\n\n**Description is visible to all attendees.** Never put internal notes or context\nabout the person/company in the `--description` field.\n\n### Check for Conflicts\n\nAlways check the calendar before creating events.\n\n```bash\njean-claude gcal list --from 2025-01-21 --to 2025-01-21\n```\n\nIf there's a conflict the user may not be aware of, confirm before creating:\n\n- \"You have a dentist appointment at 11am. Want me to schedule this for a\n  different time?\"\n- \"You already have 'NYU Meeting' at 11am. Want me to update it instead?\"\n\n### Calendar Safety (Non-Negotiable)\n\n1. **Never guess dates.** When the user says \"Sunday\" or \"next week\", calculate:\n   ```bash\n   date -v+0d \"+%A %Y-%m-%d\"\n   ```\n   Then verify: \"Sunday is 2025-12-28 ‚Äî creating the event for that date.\"\n\n2. **Never hallucinate emails.** If the user says \"add Ursula\", look up her\n   email or ask. Never invent addresses.\n\n3. **Verify after creating.** Run `jean-claude gcal list` for that date to confirm. If\n   wrong, delete and recreate before confirming to the user.\n\n4. **Show invite and get confirmation.** Before `jean-claude gcal create`, show\n   the full invite and ask for approval ‚Äî just like messages:\n\n   > **Calendar invite to create:**\n   > - **Title:** 1:1 with Alice\n   > - **When:** Tuesday 2025-12-30, 2:00‚Äì2:30pm PT\n   > - **Attendees:** alice@example.com\n   > - **Location:** Zoom (link in description)\n   > - **Description:** Weekly sync\n   >\n   > Create this invite?\n\n   Include location and description if set. Wait for \"yes\" before creating.\n\n5. **Confirm ambiguous locations.** \"SVB\" could mean West Hollywood or Santa\n   Monica ‚Äî ask which one.\n\n**Example workflow:**\n```\nUser: \"Add a meeting with Alice for next Tuesday at 2pm\"\n\n1. Check: date -v+0d \"+%A %Y-%m-%d\" ‚Üí \"Friday 2025-12-26\"\n2. Calculate: next Tuesday = 2025-12-30\n3. Look up Alice's email\n4. Show the full invite preview (title, date/time, attendees, location, description)\n5. Wait for user confirmation\n6. Create, then verify with `jean-claude gcal list`\n```\n\n### List Events\n\n```bash\n# Today's events\njean-claude gcal list\n\n# Next 7 days\njean-claude gcal list --days 7\n\n# Date range\njean-claude gcal list --from 2025-01-15 --to 2025-01-20\n```\n\n### Create Events\n\n```bash\n# Simple event\njean-claude gcal create \"Team Meeting\" \\\n  --start \"2025-01-15 14:00\" --end \"2025-01-15 15:00\"\n\n# With attendee, location, and description\njean-claude gcal create \"1:1 with Alice\" \\\n  --start \"2025-01-15 10:00\" --duration 30 \\\n  --attendees alice@example.com \\\n  --location \"Conference Room A\" \\\n  --description \"Weekly sync\"\n\n# Multiple attendees\njean-claude gcal create \"Team Sync\" \\\n  --start \"2025-01-15 14:00\" --duration 25 \\\n  --attendees \"alice@example.com,bob@example.com\"\n\n# All-day event (single day)\njean-claude gcal create \"Holiday\" \\\n  --start 2025-01-15 --all-day\n\n# Multi-day all-day event\njean-claude gcal create \"Vacation\" \\\n  --start 2025-01-15 --end 2025-01-20 --all-day\n```\n\n### Search & Manage Events\n\n```bash\n# Search (default: 30 days ahead)\njean-claude gcal search \"standup\"\njean-claude gcal search \"standup\" --days 90\n\n# Update\njean-claude gcal update EVENT_ID --start \"2025-01-16 14:00\"\n\n# Delete\njean-claude gcal delete EVENT_ID --notify\n```\n\n### Invitations\n\nList and respond to calendar invitations (events you've been invited to).\n\n**Recurring events:** The invitations command collapses recurring event\ninstances into a single entry. Each collapsed entry includes:\n- `recurring: true` - indicates this is a recurring series\n- `instanceCount: N` - number of pending instances\n- `id` - the parent event ID (use this to respond to all instances at once)\n\nResponding to a parent ID accepts/declines all instances in the series.\nResponding to an instance ID (if you have one) affects only that instance.\n\n```bash\n# List all pending invitations (no time limit by default)\njean-claude gcal invitations\n\n# Limit to next 7 days\njean-claude gcal invitations --days 7\n\n# Show all individual instances (don't collapse recurring events)\njean-claude gcal invitations --expand\n\n# Accept an invitation (or all instances if recurring)\njean-claude gcal respond EVENT_ID --accept\n\n# Decline an invitation\njean-claude gcal respond EVENT_ID --decline\n\n# Tentatively accept\njean-claude gcal respond EVENT_ID --tentative\n\n# Respond without notifying organizer\njean-claude gcal respond EVENT_ID --accept --no-notify\n```\n\n## Other Platforms\n\nLoad these platform-specific guides as needed:\n\n```bash\n# Messaging\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/imessage.md\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/whatsapp.md\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/signal.md\n\n# Google Workspace (non-Gmail)\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/drive.md\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/docs.md\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/sheets.md\n\n# Apple\ncat ${CLAUDE_PLUGIN_ROOT}/skills/jean-claude/platforms/reminders.md\n```\n\n**When to load:** Load the relevant platform file when the user asks about that\nservice. For example, if they ask \"send a WhatsApp message\", load whatsapp.md\nfirst.\n\n**Safety rules still apply:** The messaging safety rules in this file (never\nsend without approval, verify recipients) apply to all messaging platforms.\n\n## Appendix\n\n### Location Context\n\nFor \"near me\" queries, use these sources in order:\n\n1. **User preferences** ‚Äî Home/work location in personalization skills\n2. **Calendar events** ‚Äî Frequent venues reveal neighborhood\n3. **System timezone** ‚Äî Narrows to region\n4. **IP geolocation** (last resort, often inaccurate):\n   ```bash\n   curl -s ipinfo.io/json | jq '{city, region, country, loc}'\n   ```\n\nState your assumption: \"I see you're in the LA area based on your calendar.\"\n\n### Learning from Corrections\n\nWhen users correct drafts or behavior, offer to save learnable preferences:\n\n- \"Actually, sign it 'Best' not 'Cheers'\" ‚Üí sign-off preference\n- \"Always CC my assistant on work emails\" ‚Üí email rule\n- \"Don't use exclamation marks\" ‚Üí tone preference\n\nOne-off corrections (\"make this shorter\") are situational, not preferences.\n\n**Default behavior:** Make the correction, then ask \"Want me to remember this?\"\nIf yes, update their personalization skill file (e.g., `~/.claude/skills/managing-messages/SKILL.md`).\n\n**Auto-learn mode:** After a few saved corrections, offer to enable auto-learning.\nWhen enabled, save preferences automatically and confirm briefly: \"Noted ‚Äî I'll\nsign emails 'Best' from now on.\"\n\nNever auto-learn anything affecting recipients or major workflow changes.\n\n### Reporting Issues\n\nWhen you hit unexpected exceptions, schema mismatches, or behavior that\ncontradicts documentation, offer to file a GitHub issue.\n\nDon't offer for: authentication failures, permission errors, network issues, or\nuser configuration problems.\n\n> I ran into what looks like a bug in jean-claude. Want me to create a GitHub\n> issue? I'll show you the report first and remove any personal information.\n\nSee [ISSUES.md](ISSUES.md) for formatting and submission.\n",
        "skills/jean-claude/platforms/docs.md": "# Google Docs\n\nRead and write Google Docs documents.\n\n**Command prefix:** `jean-claude `\n\nThe document ID is in the URL:\n`https://docs.google.com/document/d/DOCUMENT_ID/edit`\n\n## Create Document\n\n```bash\njean-claude gdocs create \"My Document\"\n```\n\n## Read Content\n\n```bash\n# Read as plain text\njean-claude gdocs read DOCUMENT_ID\n\n# Read full JSON structure (includes indices for advanced editing)\njean-claude gdocs read DOCUMENT_ID --json\n```\n\n## Write Content\n\n**Use heredocs** for text content (Claude Code's Bash tool escapes '!' to '\\!'\nwhen using echo).\n\n```bash\n# Append text to end of document\ncat << 'EOF' | jean-claude gdocs append DOCUMENT_ID\nNew paragraph to add!\nEOF\n\n# Find and replace text\njean-claude gdocs replace DOCUMENT_ID --find \"old text\" --replace-with \"new text\"\njean-claude gdocs replace DOCUMENT_ID --find \"TODO\" --replace-with \"DONE\" --match-case\n```\n\n## Get Document Info\n\n```bash\njean-claude gdocs info DOCUMENT_ID\njean-claude gdocs info DOCUMENT_ID --json\n```\n",
        "skills/jean-claude/platforms/drive.md": "# Google Drive\n\n**Command prefix:** `jean-claude `\n\n## List & Search Files\n\n```bash\n# List files in root\njean-claude gdrive list\njean-claude gdrive list -n 20\njean-claude gdrive list --folder FOLDER_ID --json\n\n# Search\njean-claude gdrive search \"quarterly report\"\njean-claude gdrive search \"quarterly report\" -n 10 --json\n```\n\n## Download & Upload\n\n```bash\n# Download (saved to ~/.cache/jean-claude/drive/)\njean-claude gdrive download FILE_ID\n\n# Download to specific directory\njean-claude gdrive download FILE_ID --output ./\n\n# Upload to root\njean-claude gdrive upload document.pdf\n\n# Upload to folder with custom name\njean-claude gdrive upload document.pdf --folder FOLDER_ID --name \"Q4 Report.pdf\"\n```\n\n## Manage Files\n\n```bash\n# Create folder\njean-claude gdrive mkdir \"New Folder\"\n\n# Move file to different folder\njean-claude gdrive move FILE_ID FOLDER_ID\n\n# Share\njean-claude gdrive share FILE_ID user@example.com --role reader\n\n# Trash/untrash\njean-claude gdrive trash FILE_ID\njean-claude gdrive untrash FILE_ID\n\n# Get file metadata\njean-claude gdrive get FILE_ID\n```\n",
        "skills/jean-claude/platforms/imessage.md": "# iMessage\n\nSend via AppleScript. On first use, macOS will prompt for Automation permission.\nReading history requires Full Disk Access. See \"Personalization\" section in\nSKILL.md for default behaviors.\n\n**Command prefix:** `jean-claude `\n\n**Chat IDs:** Individual chats use `any;-;+1234567890` (phone number), group\nchats use `any;+;chat123...`. Get these from `imessage chats`.\n\n## Send Messages\n\nMessage body is read from stdin. **Always use heredocs** (Claude Code's Bash\ntool has a bug that escapes '!' to '\\!' when using echo). Supports one or more\nrecipients.\n\n```bash\n# Send to phone number\ncat << 'EOF' | jean-claude imessage send \"+12025551234\"\nHello!\nEOF\n\n# Send to contact by name (must match exactly one contact with one phone)\ncat << 'EOF' | jean-claude imessage send \"John Smith\"\nHello!\nEOF\n\n# Send to group chat by name\ncat << 'EOF' | jean-claude imessage send \"Team OA\"\nHello team!\nEOF\n\n# Message with apostrophe and multiple lines\ncat << 'EOF' | jean-claude imessage send \"+12025551234\"\nIt's great to hear from you!\nLet me know when you're free.\nEOF\n\n# Send to group chat by ID\ncat << 'EOF' | jean-claude imessage send \"any;+;chat123456789\"\nHello group!\nEOF\n\n# Send to multiple recipients (uses existing group with those participants)\ncat << 'EOF' | jean-claude imessage send \"+12025551234\" \"+16467194457\"\nHello!\nEOF\n\n# Send file (recipient auto-detects phone, contact name, or group name)\njean-claude imessage send-file \"+12025551234\" ./document.pdf\njean-claude imessage send-file \"John Smith\" ./photo.jpg\n```\n\n**Recipient resolution:** Auto-detects the recipient type:\n1. Chat IDs (e.g., `any;+;chat123...`) - used directly\n2. Phone numbers (e.g., `+12025551234`) - sent to that number\n3. Group/chat names (e.g., `Team OA`) - looked up in Messages.app\n4. Contact names (e.g., `John Smith`) - looked up in Contacts.app\n\n**Multiple recipients:** When you specify multiple recipients, the command finds\nan existing group chat with those exact participants and sends to it. If no\ngroup exists, you'll be prompted to create one manually in Messages.app first\n(macOS doesn't allow creating group chats programmatically).\n\n**Contact lookup fails if:**\n- Multiple contacts match (e.g., \"John\" matches \"John Smith\" and \"John Davis\")\n- One contact has multiple phone numbers\n\nWhen lookup fails, the error shows all matches‚Äîuse the specific phone number.\n\n## List Chats\n\n```bash\n# List chats (shows name, chat ID, unread count)\njean-claude imessage chats\njean-claude imessage chats -n 10\n\n# Show only chats with unread messages\njean-claude imessage chats --unread\n\n# Get participants\njean-claude imessage participants \"any;+;chat123456789\"\n```\n\nOther: `imessage open CHAT_ID` opens a chat in Messages.app (brings app to focus).\n\n## Read Messages (Requires Full Disk Access)\n\n```bash\n# Recent messages\njean-claude imessage messages -n 20\n\n# Unread messages only (excludes spam-filtered by default)\njean-claude imessage messages --unread\n\n# Include spam-filtered messages\njean-claude imessage messages --unread --include-spam\n\n# Messages from specific chat\njean-claude imessage messages --chat \"any;-;+12025551234\"\njean-claude imessage messages --name \"John Smith\"\n\n# Search messages\njean-claude imessage search \"dinner plans\"\n```\n\nTo enable reading: System Settings > Privacy & Security > Full Disk Access >\nadd your terminal app.\n\n## Image Attachments\n\nMessages include an `attachments` field with file paths to images. Use Claude's\nRead tool to view and describe the images.\n\n**Attachment schema:**\n\n```json\n{\n  \"attachments\": [\n    {\n      \"type\": \"image\",\n      \"filename\": \"IMG_1234.heic\",\n      \"mimeType\": \"image/heic\",\n      \"size\": 456789,\n      \"file\": \"/Users/you/Library/Messages/Attachments/.../IMG_1234.heic\"\n    }\n  ]\n}\n```\n\nOnly image attachments are included (HEIC, JPEG, PNG, GIF, WebP). Other media\ntypes (video, audio, documents) are not exposed.\n",
        "skills/jean-claude/platforms/reminders.md": "# Apple Reminders\n\nCreate and manage Apple Reminders via AppleScript. Reminders sync across all\nApple devices via iCloud. On first use, macOS will prompt for Automation\npermission.\n\n**Command prefix:** `jean-claude `\n\n## Create Reminders\n\n```bash\n# Simple reminder\njean-claude reminders create \"Buy groceries\"\n\n# With due date and time\njean-claude reminders create \"Call doctor\" --due \"2025-12-27 14:00\"\n\n# Date only (defaults to 9:00 AM)\njean-claude reminders create \"Submit report\" --due 2025-12-30\n\n# With list, priority, and notes\njean-claude reminders create \"Important task\" \\\n  --list Work --priority high --notes \"Don't forget!\"\n```\n\n## List Reminders\n\n```bash\n# List incomplete reminders (all lists)\njean-claude reminders list\n\n# From specific list\njean-claude reminders list --list Work\n\n# Show completed reminders\njean-claude reminders list --completed\n\n# Limit results\njean-claude reminders list -n 10\n```\n\n## Manage Reminder Lists\n\n```bash\n# Show all reminder lists with counts\njean-claude reminders lists\n```\n\n## Complete & Delete\n\n```bash\n# Mark as completed\njean-claude reminders complete \"x-apple-reminder://...\"\n\n# Delete a reminder\njean-claude reminders delete \"x-apple-reminder://...\"\n```\n\n## Search\n\n```bash\n# Search reminders by title\njean-claude reminders search \"groceries\"\njean-claude reminders search \"groceries\" -n 10\n```\n",
        "skills/jean-claude/platforms/sheets.md": "# Google Sheets\n\nRead and write Google Sheets data directly without downloading files.\n\n**Command prefix:** `jean-claude `\n\nThe spreadsheet ID is in the URL:\n`https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit`\n\n## Create Spreadsheet\n\n```bash\n# Create a new spreadsheet\njean-claude gsheets create \"My Spreadsheet\"\n\n# With custom initial sheet name\njean-claude gsheets create \"Budget 2025\" --sheet \"January\"\n```\n\n## Read Data\n\n```bash\n# Read entire first sheet\njean-claude gsheets read SPREADSHEET_ID\n\n# Read specific range\njean-claude gsheets read SPREADSHEET_ID --range 'Sheet1!A1:D10'\n\n# Read specific sheet\njean-claude gsheets read SPREADSHEET_ID --sheet 'Data'\n\n# Output as JSON\njean-claude gsheets read SPREADSHEET_ID --json\n```\n\n## Write Data\n\nAll write commands read JSON from stdin (array of rows, each row is array of cells).\n\n```bash\n# Append rows to end of sheet\necho '[[\"Alice\", 100], [\"Bob\", 200]]' | jean-claude gsheets append SPREADSHEET_ID\necho '[[\"New row\"]]' | jean-claude gsheets append SPREADSHEET_ID --sheet 'Data'\n\n# Write to specific range (overwrites existing data)\necho '[[\"Name\", \"Score\"], [\"Alice\", 100]]' | jean-claude gsheets write SPREADSHEET_ID 'Sheet1!A1:B2'\n\n# Clear a range (keeps formatting)\njean-claude gsheets clear SPREADSHEET_ID 'Sheet1!A2:Z1000'\n```\n\n## Get Spreadsheet Info\n\n```bash\n# Get metadata (title, sheet names, dimensions)\njean-claude gsheets info SPREADSHEET_ID\njean-claude gsheets info SPREADSHEET_ID --json\n```\n\n## Manage Sheets\n\n```bash\n# Add a new sheet to a spreadsheet\njean-claude gsheets add-sheet SPREADSHEET_ID \"February\"\n\n# Add at specific position (0 = first)\njean-claude gsheets add-sheet SPREADSHEET_ID \"Summary\" --index 0\n\n# Delete a sheet\njean-claude gsheets delete-sheet SPREADSHEET_ID \"Old Data\"\n```\n\n## Sort Data\n\n```bash\n# Sort by column A (ascending)\njean-claude gsheets sort SPREADSHEET_ID 'Sheet1!A1:D100' --by A\n\n# Sort by multiple columns\njean-claude gsheets sort SPREADSHEET_ID 'Sheet1!A1:D100' --by B --by 'C desc'\n\n# Sort with header row (exclude first row from sorting)\njean-claude gsheets sort SPREADSHEET_ID 'Sheet1!A1:D100' --by A --header\n```\n",
        "skills/jean-claude/platforms/signal.md": "# Signal\n\nSend and receive Signal messages via end-to-end encrypted protocol. Requires\nRust binary to be built and QR code linking (see Setup section in SKILL.md).\n\n**Command prefix:** `jean-claude `\n\n## List Chats\n\n```bash\n# List contacts and groups\njean-claude signal chats\njean-claude signal chats -n 20\n```\n\n**Output schema:**\n\n```json\n[\n  {\n    \"id\": \"abc123-def456-...\",\n    \"name\": \"Alice Smith\",\n    \"is_group\": false,\n    \"phone\": \"+12025551234\"\n  },\n  {\n    \"id\": \"fedcba987654...\",\n    \"name\": \"Team Chat\",\n    \"is_group\": true\n  }\n]\n```\n\n## Send Messages\n\nMessage body is read from stdin. **Always use heredocs** (Claude Code's Bash\ntool has a bug that escapes '!' to '\\!' when using echo). Recipient can be a\nUUID or contact name.\n\n```bash\n# Send by contact name\ncat << 'EOF' | jean-claude signal send \"Alice Smith\"\nHello!\nEOF\n\n# Send by UUID (from chats command)\ncat << 'EOF' | jean-claude signal send \"abc123-def456-...\"\nHello!\nEOF\n\n# Message with multiple lines\ncat << 'EOF' | jean-claude signal send \"Alice\"\nGreat to hear from you!\nLet me know when you're free.\nEOF\n```\n\n**Recipient resolution:** Accepts UUID directly or contact name (case-insensitive\nsubstring match). If multiple contacts match, the command fails with a list of\noptions‚Äîuse a more specific name or the UUID.\n\n## Receive Messages\n\n```bash\n# Receive pending messages from Signal\njean-claude signal receive\n```\n\nThis fetches any pending messages and stores them locally. Messages are returned\nas JSON.\n\n## Read Stored Messages\n\n```bash\n# Read messages from a specific chat (use ID from chats command)\njean-claude signal messages \"abc123-def456-...\"\n\n# Limit results\njean-claude signal messages \"abc123-def456-...\" -n 20\n```\n\nMessages are stored locally after `receive`. Use the chat ID (UUID for contacts,\nhex for groups) from the `chats` command.\n\n**Output schema:**\n\n```json\n[\n  {\n    \"id\": \"1234567890123\",\n    \"chat_id\": \"abc123-def456-...\",\n    \"sender\": \"abc123-def456-...\",\n    \"timestamp\": 1735000000,\n    \"text\": \"Hello!\",\n    \"is_outgoing\": false,\n    \"is_read\": true\n  }\n]\n```\n\n## Other Commands\n\n```bash\n# Show account information\njean-claude signal whoami\n\n# Check connection status\njean-claude signal status\n```\n",
        "skills/jean-claude/platforms/whatsapp.md": "# WhatsApp\n\nSend and receive WhatsApp messages. Requires Go binary to be built and QR code\nauthentication (see Setup section in SKILL.md).\n\n**Command prefix:** `jean-claude `\n\n## Sync Messages\n\nWhatsApp messages are stored locally for fast access. The `messages --unread`\ncommand auto-syncs, so explicit sync is only needed for other queries:\n\n```bash\n# Sync messages (also fetches chat names)\njean-claude whatsapp sync\n```\n\nThe sync command downloads new messages and automatically fetches names for\nchats that don't have them.\n\n## Send Messages\n\nMessage body is read from stdin. **Always use heredocs** (Claude Code's Bash\ntool has a bug that escapes '!' to '\\!' when using echo). Recipient is a\npositional argument.\n\n```bash\n# Send to phone number (with country code)\ncat << 'EOF' | jean-claude whatsapp send \"+12025551234\"\nHello!\nEOF\n\n# Message with apostrophe and multiple lines\ncat << 'EOF' | jean-claude whatsapp send \"+12025551234\"\nIt's great to hear from you!\nLet me know when you're free.\nEOF\n\n# Reply to a specific message\ncat << 'EOF' | jean-claude whatsapp send \"+12025551234\" --reply-to MSG_ID\nReply text!\nEOF\n```\n\n## List Chats\n\n```bash\n# List recent chats\njean-claude whatsapp chats\n\n# Limit results\njean-claude whatsapp chats -n 10\n```\n\n## Read Messages\n\n```bash\n# Recent messages (from local database)\njean-claude whatsapp messages -n 20\n\n# Unread messages (auto-syncs and downloads all media)\njean-claude whatsapp messages --unread\n\n# Messages from specific chat (use ID from chats command)\njean-claude whatsapp messages --chat \"120363277025153496@g.us\"\n\n# Explicitly download media for non-unread queries\njean-claude whatsapp messages --chat \"...\" --with-media\n```\n\n**Output includes:**\n- `reply_to`: When a message is a reply, shows the original message context (id, sender, text preview)\n- `reactions`: List of emoji reactions with sender info\n- `file`: Path to downloaded media (with `--with-media`)\n\n**Example output with new fields:**\n```json\n{\n  \"id\": \"ABC123\",\n  \"text\": \"That's great!\",\n  \"sender_name\": \"Alice\",\n  \"reply_to\": {\n    \"id\": \"XYZ789\",\n    \"sender\": \"12025551234@s.whatsapp.net\",\n    \"text\": \"Check out this article: https://...\"\n  },\n  \"reactions\": [\n    {\"emoji\": \"üëç\", \"sender_name\": \"Bob\"},\n    {\"emoji\": \"‚ù§Ô∏è\", \"sender_name\": \"Carol\"}\n  ]\n}\n```\n\n**Note:** The `--unread` flag automatically syncs with WhatsApp and downloads\nall media (images, videos, audio, documents, stickers). Other queries read from\nthe local database only‚Äîrun `whatsapp sync` first if you need the latest\nmessages, and use `--with-media` to download media.\n\n## Media Downloads\n\nUse `download` to fetch media from specific messages:\n\n```bash\n# Download media from a specific message\njean-claude whatsapp download MESSAGE_ID\n\n# Download to custom path\njean-claude whatsapp download MESSAGE_ID --output ./photo.jpg\n```\n\nFiles are stored with content-hash filenames for deduplication (same image sent\ntwice ‚Üí downloaded once).\n\n## Other Commands\n\n```bash\n# List contacts\njean-claude whatsapp contacts\n\n# Check status\njean-claude whatsapp status\n```\n"
      },
      "plugins": [
        {
          "name": "jean-claude",
          "source": "./",
          "description": "Gmail, Calendar, Drive, and iMessage integration",
          "skills": [
            "./skills/jean-claude"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add max-sixty/jean-claude",
            "/plugin install jean-claude@jean-claude"
          ]
        }
      ]
    }
  ]
}