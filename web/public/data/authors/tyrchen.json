{
  "author": {
    "id": "tyrchen",
    "display_name": "Tyr Chen",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/473888?u=624bc9a2acf9cdbe5742ae0fcf683e2c57bcc0cf&v=4",
    "url": "https://github.com/tyrchen",
    "bio": "father, programming enthusiast, author and entrepreneur.",
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 7,
      "total_stars": 25,
      "total_forks": 6
    }
  },
  "marketplaces": [
    {
      "name": "tchen-skills",
      "version": null,
      "description": "Tian Chen custom skills",
      "owner_info": {
        "name": "Tian Chen",
        "email": "tyr.chen@gmail.com"
      },
      "keywords": [],
      "repo_full_name": "tyrchen/claude-skills",
      "repo_url": "https://github.com/tyrchen/claude-skills",
      "repo_description": null,
      "homepage": null,
      "signals": {
        "stars": 25,
        "forks": 6,
        "pushed_at": "2025-12-26T16:52:11Z",
        "created_at": "2025-11-10T05:41:48Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 400
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 3830
        },
        {
          "path": "ai-image",
          "type": "tree",
          "size": null
        },
        {
          "path": "ai-image/README.md",
          "type": "blob",
          "size": 3297
        },
        {
          "path": "ai-image/SKILL.md",
          "type": "blob",
          "size": 3721
        },
        {
          "path": "cel",
          "type": "tree",
          "size": null
        },
        {
          "path": "cel/SKILL.md",
          "type": "blob",
          "size": 13748
        },
        {
          "path": "chat-history",
          "type": "tree",
          "size": null
        },
        {
          "path": "chat-history/SKILL.md",
          "type": "blob",
          "size": 5085
        },
        {
          "path": "codex-code-review",
          "type": "tree",
          "size": null
        },
        {
          "path": "codex-code-review/SKILL.md",
          "type": "blob",
          "size": 13175
        },
        {
          "path": "design-guide",
          "type": "tree",
          "size": null
        },
        {
          "path": "design-guide/README.md",
          "type": "blob",
          "size": 4428
        },
        {
          "path": "design-guide/SKILL.md",
          "type": "blob",
          "size": 15264
        },
        {
          "path": "kro-rgd",
          "type": "tree",
          "size": null
        },
        {
          "path": "kro-rgd/SKILL.md",
          "type": "blob",
          "size": 16894
        },
        {
          "path": "kro-rgd/templates",
          "type": "tree",
          "size": null
        },
        {
          "path": "kro-rgd/templates/README.md",
          "type": "blob",
          "size": 3992
        },
        {
          "path": "surrealdb",
          "type": "tree",
          "size": null
        },
        {
          "path": "surrealdb/SKILL.md",
          "type": "blob",
          "size": 16330
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"tchen-skills\",\n  \"owner\": {\n    \"name\": \"Tian Chen\",\n    \"email\": \"tyr.chen@gmail.com\"\n  },\n  \"metadata\": {\n    \"description\": \"Tian Chen custom skills\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"tchen-skills\",\n      \"description\": \"Tian Chen-specific skills\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./ai-image\"\n      ]\n    }\n  ]\n}\n",
        "README.md": "# Claude Skills Collection\n\nA collection of powerful skills for Claude Code that enhance AI capabilities with specialized tools for image generation and design system analysis.\n\n## Available Skills\n\n### 1. AI Image Generation (`ai-image`)\n\nGenerate high-quality AI images using OpenAI's gpt-image-1 model with customizable styles and artistic themes.\n\n**Key Features:**\n- Multiple aspect ratios (vertical, horizontal, square)\n- Artistic themes (Studio Ghibli, futuristic, Pixar, oil painting, Chinese painting)\n- High-resolution output (up to 4096x4096 pixels)\n- Base64 encoded image generation\n\n**Use Cases:**\n- Create custom artwork from text descriptions\n- Generate images with specific artistic styles\n- Produce marketing visuals\n- Create concept art and illustrations\n\n**Quick Start:**\n```bash\ncd ai-image\nuv run main.py --prompt \"a serene mountain landscape\" --style horizontal --theme oil-paint\n```\n\n**Requirements:**\n- OpenAI API key with gpt-image-1 access\n- Organization verification on OpenAI platform\n\n[Full Documentation](./ai-image/README.md) | [Skill Details](./ai-image/SKILL.md)\n\n---\n\n### 2. Design Guide Generator (`design-guide`)\n\nExtract comprehensive design language from any website including colors, typography, animations, interactive states, and component patterns. Creates pixel-perfect design guides with responsive screenshots.\n\n**Key Features:**\n- Complete color palette extraction (text, background, borders, shadows, gradients)\n- Typography system analysis (font families, sizes, weights, line heights)\n- Interactive state capture (hover effects, transitions, animations)\n- Component pattern recognition (buttons, cards, forms, navigation)\n- Responsive design testing (mobile, tablet, desktop)\n- UX pattern analysis (accessibility features, interaction patterns)\n- Visual effects extraction (shadows, filters, transforms)\n- Automated screenshot generation at multiple breakpoints\n\n**Use Cases:**\n- Analyze competitor website designs\n- Create design system documentation\n- Reverse-engineer design patterns\n- Build pixel-perfect recreations\n- Extract component libraries\n- Understand UX interaction patterns\n\n**Quick Start:**\n```bash\ncd design-guide\nuv run main.py --url https://stripe.com --output ./stripe-design\n```\n\n**Requirements:**\n- Playwright with Chromium browser\n- No API keys needed (fully local)\n\n**Output Includes:**\n- Comprehensive design guide (Markdown)\n- Full-page and viewport screenshots\n- Interactive hover state captures\n- Responsive design screenshots (3 breakpoints)\n- Complete HTML and CSS source files\n- Structured design data (JSON)\n\n[Full Documentation](./design-guide/README.md) | [Skill Details](./design-guide/SKILL.md)\n\n---\n\n## Installation\n\nEach skill is self-contained with its own dependencies. Navigate to the skill directory and install:\n\n```bash\n# For ai-image\ncd ai-image\nuv sync\n\n# For design-guide\ncd design-guide\nuv sync\nplaywright install chromium\n```\n\n## Usage with Claude Code\n\nThese skills are designed to be invoked by Claude Code when relevant tasks are detected:\n\n- **Image Generation**: Automatically triggered when users request image creation or mention artistic styles\n- **Design Analysis**: Automatically triggered when users ask about website design, design systems, or want to analyze/recreate websites\n\n## Project Structure\n\n```\nclaude-skills/\n‚îú‚îÄ‚îÄ ai-image/\n‚îÇ   ‚îú‚îÄ‚îÄ main.py\n‚îÇ   ‚îú‚îÄ‚îÄ SKILL.md\n‚îÇ   ‚îî‚îÄ‚îÄ README.md\n‚îú‚îÄ‚îÄ design-guide/\n‚îÇ   ‚îú‚îÄ‚îÄ main.py\n‚îÇ   ‚îú‚îÄ‚îÄ SKILL.md\n‚îÇ   ‚îî‚îÄ‚îÄ README.md\n‚îî‚îÄ‚îÄ README.md\n```\n\n## Contributing\n\nWhen adding new skills:\n1. Create a dedicated directory for the skill\n2. Include `SKILL.md` with skill metadata and instructions for Claude\n3. Include `README.md` with user-facing documentation\n4. Update this main README with the new skill details\n\n## License\n\nMIT\n",
        "ai-image/README.md": "# AI Image Generation Skill\n\nA Claude Code skill for generating high-quality AI images using OpenAI's **gpt-image-1** model with customizable aspect ratios and artistic themes.\n\n## Features\n\n- Generate images from text prompts using OpenAI's latest gpt-image-1 model\n- Choose from multiple aspect ratios (vertical, horizontal, square)\n- Apply different artistic themes (Studio Ghibli, futuristic, Pixar, oil painting, Chinese painting)\n- Customizable output location\n- High-quality image generation up to 4096x4096 pixels\n- Base64 image handling for reliable downloads\n\n## Installation\n\nThis is a Claude Code skill. To use it:\n\n1. Ensure you have [uv](https://github.com/astral-sh/uv) installed\n2. Clone or place this skill in your project\n3. Set your OpenAI API key:\n\n```bash\nexport OPENAI_API_KEY='your-api-key-here'\n```\n\nNote: Using gpt-image-1 requires organization verification on [platform.openai.com](https://platform.openai.com).\n\n## Usage\n\n### Basic Usage\n\n```bash\nuv run main.py --prompt \"a cat sitting on a tree\"\n```\n\n### With Style and Theme\n\n```bash\nuv run main.py --prompt \"a sunset over mountains\" --style horizontal --theme oil-paint --output ./sunset.png\n```\n\n### More Examples\n\n```bash\n# Futuristic portrait\nuv run main.py --prompt \"a robot in a city\" --style vertical --theme futuristic --output ./robot.png\n\n# Studio Ghibli landscape\nuv run main.py --prompt \"a magical forest with spirits\" --style horizontal --theme ghibli --output ./forest.png\n\n# Pixar-style character\nuv run main.py --prompt \"a friendly dragon\" --style square --theme pixar --output ./dragon.png\n```\n\n## Options\n\n- `--prompt`: Text description of the image to generate (required)\n- `--style`: Image aspect ratio (default: square)\n  - `vertical`: 1024x1536 pixels (portrait)\n  - `horizontal`: 1536x1024 pixels (landscape)\n  - `square`: 1024x1024 pixels\n- `--theme`: Artistic theme (optional)\n  - `ghibli`: Studio Ghibli animation style\n  - `futuristic`: Sci-fi with sleek designs and neon lights\n  - `pixar`: Vibrant 3D animation style\n  - `oil-paint`: Classical oil painting with textures\n  - `chinese-paint`: Traditional Chinese ink painting\n- `--output`: Output file path (default: ./generated_image.png)\n\n## Technical Details\n\n- **Model**: OpenAI gpt-image-1 (released April 2025)\n- **Supported Sizes**: 1024x1024, 1024x1536, 1536x1024\n- **Maximum Resolution**: Up to 4096x4096 pixels\n- **Response Format**: Base64 encoded images (b64_json)\n- **Dependencies**: openai>=2.7.1\n\n## Pricing\n\nUsage is priced per token:\n- Text tokens: $5 per million\n- Image input tokens: $10 per million\n- Image output tokens: $40 per million\n\nApproximate costs per generated image:\n- Low quality square: ~$0.02\n- Medium quality square: ~$0.07\n- High quality square: ~$0.19\n\n## Troubleshooting\n\n### API Key Not Set\n\nIf you see \"Error: OPENAI_API_KEY environment variable not set\":\n\n```bash\nexport OPENAI_API_KEY='your-api-key-here'\n```\n\n### Organization Not Verified\n\ngpt-image-1 requires organization verification. Visit [platform.openai.com](https://platform.openai.com) and complete the verification process in your account settings.\n\n### Invalid Size Error\n\nEnsure you're using one of the supported aspect ratios: `vertical`, `horizontal`, or `square`.\n\n## License\n\nThis skill is provided as-is for use with Claude Code.\n",
        "ai-image/SKILL.md": "---\nname: ai-image\ndescription: Generate AI images using OpenAI's gpt-image-1 model with customizable aspect ratios and artistic themes. Use when the user wants to create images, generate artwork, or mentions image generation with specific styles like Ghibli, futuristic, Pixar, oil painting, or Chinese painting.\n---\n\n# AI Image Generation Skill\n\nGenerate high-quality AI images using OpenAI's gpt-image-1 model with customizable styles and themes.\n\n## When to Use This Skill\n\nUse this skill when the user wants to:\n- Generate images from text descriptions\n- Create artwork with specific artistic styles\n- Generate images with particular aspect ratios (vertical, horizontal, square)\n- Apply themed visual styles (Studio Ghibli, futuristic, Pixar, oil painting, Chinese painting)\n\n## Instructions\n\n1. **Check for API Key**: Verify that the OPENAI_API_KEY environment variable is set\n2. **Gather Requirements**: Ask the user for:\n   - Image prompt (required)\n   - Style/aspect ratio: vertical (1024x1536), horizontal (1536x1024), or square (1024x1024)\n   - Theme: ghibli, futuristic, pixar, oil-paint, or chinese-paint (optional)\n   - Output location (optional, defaults to ./generated_image.png)\n3. **Run the CLI**: Execute the main.py script with the appropriate parameters\n4. **Report Results**: Show the user where the image was saved and any relevant details\n\n## Available Options\n\n### Aspect Ratios (--style)\n- `vertical`: 1024x1536 pixels (portrait orientation)\n- `horizontal`: 1536x1024 pixels (landscape orientation)\n- `square`: 1024x1024 pixels (default)\n\n### Artistic Themes (--theme)\n- `ghibli`: Studio Ghibli animation style with whimsical, dreamlike aesthetics\n- `futuristic`: Sci-fi style with sleek designs and neon lights\n- `pixar`: Vibrant 3D animation style with expressive characters\n- `oil-paint`: Classical oil painting with rich textures and brushstrokes\n- `chinese-paint`: Traditional Chinese ink painting with delicate brushwork\n\n## Usage Examples\n\n### Basic Usage\n```bash\nuv run main.py --prompt \"a cat sitting on a tree\"\n```\n\n### With Style and Theme\n```bash\nuv run main.py --prompt \"a sunset over mountains\" --style horizontal --theme oil-paint --output ./sunset.png\n```\n\n### Futuristic Portrait\n```bash\nuv run main.py --prompt \"a robot in a city\" --style vertical --theme futuristic --output ./robot.png\n```\n\n### Studio Ghibli Landscape\n```bash\nuv run main.py --prompt \"a magical forest with spirits\" --style horizontal --theme ghibli --output ./forest.png\n```\n\n## Setup Requirements\n\nThis skill requires an OpenAI API key with access to the gpt-image-1 model:\n\n```bash\nexport OPENAI_API_KEY='your-api-key-here'\n```\n\nNote: Using gpt-image-1 requires organization verification on the OpenAI platform.\n\n## Technical Details\n\n- **Model**: OpenAI gpt-image-1 (released April 2025)\n- **Response Format**: Base64 encoded images (b64_json)\n- **Supported Sizes**: 1024x1024, 1024x1536, 1536x1024\n- **Maximum Resolution**: Up to 4096x4096 pixels\n- **Dependencies**: openai>=2.7.1\n\n## Pricing Information\n\nUsage is priced per token:\n- Text tokens: $5 per million\n- Image input tokens: $10 per million\n- Image output tokens: $40 per million\n\nApproximate costs per generated image:\n- Low quality square: ~$0.02\n- Medium quality square: ~$0.07\n- High quality square: ~$0.19\n\n## Troubleshooting\n\n### API Key Not Set\nIf you see \"Error: OPENAI_API_KEY environment variable not set\", ensure your API key is exported in your shell session.\n\n### Organization Not Verified\ngpt-image-1 requires organization verification on platform.openai.com. Visit your OpenAI account settings to complete verification.\n\n### Invalid Size Error\nEnsure you're using one of the supported sizes: 1024x1024, 1024x1536, or 1536x1024.\n",
        "cel/SKILL.md": "---\nname: cel-k8s\ndescription: Write production-ready CEL (Common Expression Language) code for Kubernetes ValidatingAdmissionPolicies, CRD validation rules, and security policies. Use when users need to create admission policies, validate Kubernetes resources, enforce security constraints, or write CEL expressions for Kubernetes.\n---\n\n# CEL for Kubernetes - Production-Ready Policy Generator\n\nGenerate solid, high-quality, production-ready CEL (Common Expression Language) code for Kubernetes admission control, CRD validation, and security policy enforcement.\n\n## When to Use This Skill\n\nUse this skill when the user wants to:\n- **Write ValidatingAdmissionPolicy** resources with CEL expressions\n- **Create CRD validation rules** using x-kubernetes-validations\n- **Enforce security policies** (Pod Security Standards, image restrictions, etc.)\n- **Validate resource configurations** (labels, annotations, resource limits)\n- **Build admission control** without external webhooks\n- **Migrate from OPA/Gatekeeper/Kyverno** to native Kubernetes CEL\n- **Debug or optimize existing CEL expressions**\n\n## CEL Quick Reference\n\n### Core Operators\n\n```cel\n// Comparison\n==  !=  <  <=  >  >=\n\n// Logical\n&&  ||  !\n\n// Arithmetic\n+  -  *  /  %\n\n// Membership\nin  // Check if element exists in collection\n\n// Ternary\ncondition ? trueValue : falseValue\n```\n\n### Essential Functions\n\n```cel\n// Field existence (CRITICAL - always check before accessing optional fields)\nhas(object.spec.field)\n\n// String functions\nsize(string)                    // Length\ncontains(string, substring)     // Contains check\nstartsWith(string, prefix)      // Prefix check\nendsWith(string, suffix)        // Suffix check\nmatches(string, regex)          // Regex match\nsplit(string, delimiter)        // Split to list\nlower(string)                   // Lowercase\nupper(string)                   // Uppercase\ntrim(string)                    // Remove whitespace\n\n// Collection functions\nsize(list)                      // List length\nall(list, var, condition)       // All elements satisfy\nexists(list, var, condition)    // Any element satisfies\nexists_one(list, var, condition) // Exactly one satisfies\nfilter(list, var, condition)    // Filter elements\nmap(list, var, transformation)  // Transform elements\n\n// Kubernetes-specific\nquantity(string)                // Parse K8s quantity (e.g., \"2Gi\", \"500m\")\nisQuantity(string)              // Validate quantity format\nurl(string)                     // Parse URL\n```\n\n### Available Context Variables\n\n**In ValidatingAdmissionPolicy:**\n- `object` - The incoming resource being validated\n- `oldObject` - The existing resource (UPDATE operations)\n- `request` - Admission request metadata (user, operation, namespace)\n- `params` - Parameters from ValidatingAdmissionPolicyBinding\n- `namespaceObject` - The namespace resource\n\n**In CRD Validation (x-kubernetes-validations):**\n- `self` - The field being validated\n- `oldSelf` - Previous field value (UPDATE)\n\n## Instructions for Writing CEL Policies\n\n### Step 1: Understand the Requirement\n\nBefore writing any CEL:\n1. What resource types need validation? (Deployments, Pods, Services, etc.)\n2. What operations should trigger validation? (CREATE, UPDATE, DELETE)\n3. What specific conditions must be enforced?\n4. Should violations block the request or just audit?\n\n### Step 2: Design the Expression\n\nFollow these principles:\n\n**1. Always use `has()` for optional fields:**\n```cel\n// CORRECT - Safe field access\nhas(object.spec.template.spec.securityContext) &&\nobject.spec.template.spec.securityContext.runAsNonRoot == true\n\n// WRONG - Will error if field doesn't exist\nobject.spec.template.spec.securityContext.runAsNonRoot == true\n```\n\n**2. Handle null/missing values gracefully:**\n```cel\n// Check for labels existence before accessing\nhas(object.metadata.labels) &&\n'app' in object.metadata.labels &&\nobject.metadata.labels['app'] == 'myapp'\n```\n\n**3. Use short-circuit evaluation:**\n```cel\n// Fast checks first, expensive operations last\nhas(object.metadata.labels) &&           // Fast: field existence\n'app' in object.metadata.labels &&       // Medium: map lookup\nobject.metadata.labels['app'].matches('^[a-z]+$')  // Slow: regex\n```\n\n**4. Prefer positive assertions:**\n```cel\n// BETTER - Clear intent\nobject.spec.replicas >= 1 && object.spec.replicas <= 10\n\n// AVOID - Double negatives\n!(object.spec.replicas < 1 || object.spec.replicas > 10)\n```\n\n### Step 3: Write the ValidatingAdmissionPolicy\n\nUse this structure:\n\n```yaml\napiVersion: admissionregistration.k8s.io/v1\nkind: ValidatingAdmissionPolicy\nmetadata:\n  name: \"policy-name.example.com\"\nspec:\n  failurePolicy: Fail  # or Ignore for non-critical policies\n  matchConstraints:\n    resourceRules:\n    - apiGroups: [\"apps\"]\n      apiVersions: [\"v1\"]\n      operations: [\"CREATE\", \"UPDATE\"]\n      resources: [\"deployments\"]\n  validations:\n  - expression: \"CEL expression here\"\n    message: \"Human-readable error message\"\n    messageExpression: \"'Dynamic message with ' + object.metadata.name\"\n```\n\n### Step 4: Create the Binding\n\n```yaml\napiVersion: admissionregistration.k8s.io/v1\nkind: ValidatingAdmissionPolicyBinding\nmetadata:\n  name: \"policy-binding\"\nspec:\n  policyName: \"policy-name.example.com\"\n  validationActions: [Deny]  # or [Audit] for testing\n  matchResources:\n    namespaceSelector:\n      matchLabels:\n        environment: production\n```\n\n### Step 5: Test Before Deploying\n\n1. **Use dry-run mode:**\n   ```bash\n   kubectl apply --dry-run=server -f test-resource.yaml\n   ```\n\n2. **Start with Audit mode:**\n   ```yaml\n   validationActions: [Audit]  # Log violations, don't block\n   ```\n\n3. **Check events for violations:**\n   ```bash\n   kubectl get events --field-selector reason=PolicyAudit\n   ```\n\n## Common Policy Patterns\n\n### Security Policies\n\n**Require non-root containers:**\n```yaml\nvalidations:\n- expression: |\n    has(object.spec.template.spec.securityContext) &&\n    has(object.spec.template.spec.securityContext.runAsNonRoot) &&\n    object.spec.template.spec.securityContext.runAsNonRoot == true\n  message: \"Pods must run as non-root user\"\n```\n\n**Disallow privileged containers:**\n```yaml\nvalidations:\n- expression: |\n    !has(object.spec.template.spec.containers) ||\n    !object.spec.template.spec.containers.exists(c,\n      has(c.securityContext) &&\n      has(c.securityContext.privileged) &&\n      c.securityContext.privileged == true\n    )\n  message: \"Privileged containers are not allowed\"\n```\n\n**Drop all capabilities:**\n```yaml\nvalidations:\n- expression: |\n    object.spec.template.spec.containers.all(c,\n      has(c.securityContext) &&\n      has(c.securityContext.capabilities) &&\n      has(c.securityContext.capabilities.drop) &&\n      c.securityContext.capabilities.drop.exists(cap, cap == 'ALL')\n    )\n  message: \"All containers must drop ALL capabilities\"\n```\n\n**Restrict to approved registries:**\n```yaml\nvalidations:\n- expression: |\n    object.spec.template.spec.containers.all(c,\n      c.image.startsWith('myregistry.io/') ||\n      c.image.startsWith('gcr.io/myproject/')\n    )\n  message: \"Container images must come from approved registries\"\n```\n\n**Disallow latest tag:**\n```yaml\nvalidations:\n- expression: |\n    object.spec.template.spec.containers.all(c,\n      c.image.contains(':') && !c.image.endsWith(':latest')\n    )\n  message: \"Container images must not use 'latest' tag\"\n```\n\n### Resource Validation\n\n**Require resource limits:**\n```yaml\nvalidations:\n- expression: |\n    object.spec.template.spec.containers.all(c,\n      has(c.resources) &&\n      has(c.resources.limits) &&\n      has(c.resources.limits.memory) &&\n      has(c.resources.limits.cpu) &&\n      has(c.resources.requests) &&\n      has(c.resources.requests.memory) &&\n      has(c.resources.requests.cpu)\n    )\n  message: \"All containers must define CPU and memory limits and requests\"\n```\n\n**Enforce resource quotas:**\n```yaml\nvalidations:\n- expression: |\n    object.spec.template.spec.containers.all(c,\n      !has(c.resources.requests.memory) ||\n      quantity(c.resources.requests.memory) <= quantity('2Gi')\n    )\n  message: \"Memory requests cannot exceed 2Gi per container\"\n```\n\n### Label and Annotation Validation\n\n**Require specific labels:**\n```yaml\nvalidations:\n- expression: |\n    has(object.metadata.labels) &&\n    'app' in object.metadata.labels &&\n    'environment' in object.metadata.labels &&\n    'team' in object.metadata.labels\n  message: \"Resources must have 'app', 'environment', and 'team' labels\"\n```\n\n**Validate label values:**\n```yaml\nvalidations:\n- expression: |\n    !has(object.metadata.labels) ||\n    !('environment' in object.metadata.labels) ||\n    object.metadata.labels['environment'] in ['dev', 'staging', 'prod']\n  message: \"environment label must be one of: dev, staging, prod\"\n```\n\n**Validate naming conventions:**\n```yaml\nvalidations:\n- expression: |\n    object.metadata.name.matches('^[a-z][a-z0-9-]*[a-z0-9]$') &&\n    object.metadata.name.size() <= 63\n  message: \"Resource name must be lowercase alphanumeric with hyphens, max 63 chars\"\n```\n\n### Network Policies\n\n**Disallow hostNetwork:**\n```yaml\nvalidations:\n- expression: |\n    !has(object.spec.template.spec.hostNetwork) ||\n    object.spec.template.spec.hostNetwork == false\n  message: \"hostNetwork is not allowed\"\n```\n\n**Disallow hostPath volumes:**\n```yaml\nvalidations:\n- expression: |\n    !has(object.spec.template.spec.volumes) ||\n    object.spec.template.spec.volumes.all(v, !has(v.hostPath))\n  message: \"hostPath volumes are not allowed\"\n```\n\n## CRD Validation Rules\n\nFor CustomResourceDefinitions, use `x-kubernetes-validations`:\n\n```yaml\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: myresources.example.com\nspec:\n  group: example.com\n  versions:\n  - name: v1\n    schema:\n      openAPIV3Schema:\n        type: object\n        properties:\n          spec:\n            type: object\n            properties:\n              replicas:\n                type: integer\n                minimum: 1\n                maximum: 100\n                x-kubernetes-validations:\n                - rule: \"self >= 1 && self <= 100\"\n                  message: \"Replicas must be between 1 and 100\"\n              schedule:\n                type: string\n                x-kubernetes-validations:\n                - rule: \"self.matches('^(\\\\\\\\d+|\\\\\\\\*)(/\\\\\\\\d+)?(\\\\\\\\s+(\\\\\\\\d+|\\\\\\\\*)(/\\\\\\\\d+)?){4}$')\"\n                  message: \"Must be a valid cron expression\"\n            x-kubernetes-validations:\n            - rule: \"has(self.replicas) || has(self.schedule)\"\n              message: \"Either replicas or schedule must be specified\"\n```\n\n## Performance Best Practices\n\n### Set Schema Constraints\n\nHelp the cost estimator by bounding collections:\n\n```yaml\nproperties:\n  containers:\n    type: array\n    maxItems: 20       # Bound array iterations\n  labels:\n    type: object\n    maxProperties: 50  # Bound map operations\n  name:\n    type: string\n    maxLength: 253     # Bound string operations\n```\n\n### Avoid O(n^2) Patterns\n\n```yaml\n# BAD - O(n^2): Nested iteration over same collection\n- expression: |\n    object.spec.containers.all(c1,\n      object.spec.containers.all(c2,\n        c1.name != c2.name || c1 == c2\n      )\n    )\n\n# GOOD - O(n): Use unique check\n- expression: |\n    object.spec.containers.map(c, c.name).size() ==\n    object.spec.containers.size()\n  message: \"Container names must be unique\"\n```\n\n### Use Targeted Match Rules\n\nLimit policy scope to reduce evaluations:\n\n```yaml\nmatchConstraints:\n  resourceRules:\n  - apiGroups: [\"apps\"]          # Specific group\n    apiVersions: [\"v1\"]           # Specific version\n    operations: [\"CREATE\"]        # Only CREATE, not every operation\n    resources: [\"deployments\"]    # Specific resource\n  namespaceSelector:              # Target specific namespaces\n    matchLabels:\n      enforce-policies: \"true\"\n```\n\n## Debugging CEL Expressions\n\n### Common Errors and Fixes\n\n**Error: \"no such key\"**\n```cel\n// Problem: Accessing map key that doesn't exist\nobject.metadata.labels['app']\n\n// Fix: Check key existence\nhas(object.metadata.labels) && 'app' in object.metadata.labels &&\nobject.metadata.labels['app']\n```\n\n**Error: \"type mismatch\"**\n```cel\n// Problem: Comparing wrong types\nobject.spec.replicas == \"5\"\n\n// Fix: Use correct type\nobject.spec.replicas == 5\n```\n\n**Error: \"no such field\"**\n```cel\n// Problem: Accessing field on null object\nobject.spec.securityContext.runAsNonRoot\n\n// Fix: Check parent existence\nhas(object.spec.securityContext) &&\nobject.spec.securityContext.runAsNonRoot == true\n```\n\n### Testing Commands\n\n```bash\n# Test with dry-run\nkubectl apply --dry-run=server -f resource.yaml\n\n# Check policy status\nkubectl get validatingadmissionpolicy\nkubectl describe validatingadmissionpolicy <name>\n\n# View audit events\nkubectl get events --field-selector reason=PolicyAudit\n\n# Check type checking warnings\nkubectl get validatingadmissionpolicy <name> -o yaml | grep -A 20 typeChecking\n```\n\n## Output Format\n\nWhen generating CEL policies, always provide:\n\n1. **Complete ValidatingAdmissionPolicy YAML**\n2. **Corresponding ValidatingAdmissionPolicyBinding YAML**\n3. **Test resources** (both passing and failing examples)\n4. **Explanation** of each validation rule\n5. **Deployment instructions**\n\n## Reference Files\n\n- **[CEL Syntax Reference](./references/cel_syntax.md)** - Complete language reference\n- **[Common Patterns](./references/common_patterns.md)** - Reusable validation patterns\n- **[Templates](./templates/)** - Production-ready policy templates\n\n## Kubernetes Version Compatibility\n\n- **CEL in ValidatingAdmissionPolicy**: GA in Kubernetes 1.30+\n- **CEL in CRD validation**: GA in Kubernetes 1.29+\n- **Alpha/Beta**: Available in earlier versions with feature gates\n\nAlways verify target cluster version before generating policies.\n",
        "chat-history/SKILL.md": "---\nname: chat-history\ndescription: Extract and organize Claude Code session history into project .chats directory. Use when users want to document their Claude sessions, export conversation inputs, or maintain a log of instructions given to Claude.\nuser_invocable: true\n---\n\n# Chat History Extractor\n\nExtract user inputs from Claude Code session history (`~/.claude/projects/`) and organize them into a project's `.chats` directory with daily markdown files.\n\n## When to Use This Skill\n\nUse this skill when the user wants to:\n- **Extract session history** from Claude Code sessions\n- **Document conversations** for future reference\n- **Create instruction logs** organized by date\n- **Export user inputs** from `.jsonl` session files\n- **Maintain a changelog** of Claude interactions\n\n## How It Works\n\nClaude Code stores session data in `~/.claude/projects/{project-path-encoded}/` as `.jsonl` files. Each file contains messages with:\n- `type: \"user\"` - User messages\n- `userType: \"external\"` - External user (not system/agent)\n- `message.content` - The actual message content\n\nThis skill extracts meaningful user instructions (filtering out system commands, tool results, and session continuations) and organizes them by date into `.chats/{YYYYMMDD}.md` files.\n\n## Instructions\n\n### Step 1: Identify the Project Session Directory\n\nThe session directory is derived from the current working directory path:\n- Replace `/` with `-` in the path\n- Prefix with `-`\n- Location: `~/.claude/projects/{encoded-path}/`\n\n```bash\n# Example: /Users/tchen/projects/tubi/titc\n# Becomes: -Users-tchen-projects-tubi-titc\n# Full path: ~/.claude/projects/-Users-tchen-projects-tubi-titc/\n```\n\n### Step 2: Find Session Files by Date\n\nList session files and filter by modification date:\n\n```bash\n# List all main session files (excluding agent-* files) for a specific date\nls -la ~/.claude/projects/{project-dir}/*.jsonl | grep \"Dec 25\" | grep -v agent-\n```\n\n### Step 3: Extract User Inputs\n\nExtract user messages from jsonl files using jq:\n\n```bash\ncat {session-file}.jsonl | jq -r '\n  select(.type == \"user\" and .userType == \"external\" and (.isMeta | not)) |\n  .message.content |\n  if type == \"string\" then . else empty end\n' | grep -v \"^Caveat:\" \\\n  | grep -v \"^<command\" \\\n  | grep -v \"^<local-command\" \\\n  | grep -v \"^This session is being continued\" \\\n  | grep -v \"^<user-prompt-submit-hook>\" \\\n  | grep -v \"^Analysis:\" \\\n  | grep -v \"^$\"\n```\n\n### Step 4: Create/Update .chats Files\n\nCreate markdown files in `.chats/` directory with format:\n\n```markdown\n# Instructions\n\n## {task title}\n\n{user instruction}\n\n## {another task title}\n\n{another user instruction}\n```\n\n### Step 5: Commit Changes\n\nAfter creating/updating chat files, commit with:\n\n```bash\ngit add .chats/*.md\ngit commit -m \"docs(chats): add session history for {date range}\"\n```\n\n## File Format\n\nEach `.chats/{YYYYMMDD}.md` file should:\n- Start with `# Instructions` header\n- Use `##` for each major task/instruction\n- Include the actual user input text\n- Group related instructions under the same heading\n- Preserve code blocks and formatting\n\n## Example Output\n\n`.chats/20251225.md`:\n```markdown\n# Instructions\n\n## implement feature X\n\nbased on @specs/feature-x.md implement all phases entirely\n\ncommit the code and test\n\n## fix bug Y\n\ninvestigate why component Z is not working\n\nuse sub agents to analyze the issue in parallel\n```\n\n## Filtering Rules\n\n**Include:**\n- Direct user instructions and requests\n- Questions about the codebase\n- Task specifications and requirements\n\n**Exclude:**\n- System commands (`<command-name>`, `<local-command-stdout>`)\n- Session continuation messages\n- Tool results and agent responses\n- Hook notifications (`<user-prompt-submit-hook>`)\n- Empty lines and caveat messages\n\n## Workflow Summary\n\n1. Get current working directory\n2. Compute encoded project path\n3. Find session directory: `~/.claude/projects/{encoded-path}/`\n4. List sessions grouped by date\n5. For each date with sessions:\n   - Extract user inputs from all sessions\n   - Create `.chats/{YYYYMMDD}.md`\n   - Organize inputs with descriptive headers\n6. Create `.chats/` directory if it doesn't exist\n7. Optionally commit the changes\n\n## Helper Script\n\nYou can use this bash snippet to quickly find the project session directory:\n\n```bash\n# Get encoded project path\nPROJECT_PATH=$(pwd | sed 's|/|-|g' | sed 's|^|/|' | sed 's|^/|-|')\nSESSION_DIR=\"$HOME/.claude/projects/$PROJECT_PATH\"\n\n# Check if exists\nif [ -d \"$SESSION_DIR\" ]; then\n    echo \"Session directory: $SESSION_DIR\"\n    echo \"Sessions by date:\"\n    ls -la \"$SESSION_DIR\"/*.jsonl 2>/dev/null | grep -v agent- | awk '{print $6, $7}' | sort -u\nelse\n    echo \"No session directory found for this project\"\nfi\n```\n\n## Notes\n\n- Session files named `agent-*.jsonl` are sub-agent sessions and typically don't contain direct user input\n- Main session files have UUID-style names (e.g., `01e78099-de0e-4424-845c-518638c8241e.jsonl`)\n- The `.message.content` field can be either a string (user text) or an array (tool results)\n- Always verify the extracted content makes sense before committing\n",
        "codex-code-review/SKILL.md": "---\nname: codex-code-review\ndescription: Perform comprehensive code reviews using OpenAI Codex CLI. This skill should be used when users request code reviews, want to analyze diffs/PRs, need security audits, performance analysis, or want automated code quality feedback. Supports reviewing staged changes, specific files, entire directories, or git diffs.\n---\n\n# Codex Code Review\n\n## Overview\n\nTo perform thorough, automated code reviews using the OpenAI Codex CLI agent, use this skill. Codex runs locally and can analyze code changes, identify issues, suggest improvements, and provide security/performance insights through non-interactive automation.\n\n> **‚ö†Ô∏è CRITICAL**: When reviewing code that involves dependency versions, latest releases, or current best practices, you MUST use the WebSearch tool to verify information before making any claims. Never assume version numbers or release status - always search first to avoid false positives. See the \"Web Search Verification\" section for details.\n\n## Prerequisites\n\nEnsure Codex CLI is installed and authenticated:\n\n```bash\n# Install via npm\nnpm install -g @openai/codex\n\n# Or via Homebrew (macOS)\nbrew install --cask codex\n\n# Authenticate (recommended: ChatGPT account)\ncodex\n# Follow authentication prompts\n```\n\n## Decision Tree: Choosing Review Type\n\n```text\nCode review request ‚Üí What scope?\n    ‚îú‚îÄ Git changes (staged/unstaged) ‚Üí Use: Git Diff Review\n    ‚îÇ\n    ‚îú‚îÄ Pull Request ‚Üí Use: PR Review Workflow\n    ‚îÇ\n    ‚îú‚îÄ Specific files ‚Üí Use: File Review\n    ‚îÇ\n    ‚îú‚îÄ Entire directory/project ‚Üí Use: Directory Review\n    ‚îÇ\n    ‚îî‚îÄ Special focus needed?\n        ‚îú‚îÄ Security concerns ‚Üí Use: Security Audit\n        ‚îú‚îÄ Performance issues ‚Üí Use: Performance Review\n        ‚îî‚îÄ Architecture/Design ‚Üí Use: Architecture Review\n```\n\n## Headless Execution (Required)\n\nWhen running codex for automated code reviews, you MUST use the `--full-auto` flag to grant all necessary permissions for headless operation. Without this flag, codex may hang waiting for user approval.\n\n**Always use `--full-auto` for non-interactive reviews:**\n\n```bash\n# CORRECT: Full automation mode - grants all permissions automatically\ncodex --full-auto exec \"Review the staged git changes...\"\n\n# WRONG: May hang waiting for approval in automated contexts\ncodex exec \"Review the staged git changes...\"\n```\n\n**Why this matters:**\n\n- Codex requires approval for file reads, command execution, and other operations\n- In headless/automated mode, there's no user to approve these actions\n- `--full-auto` auto-approves all safe operations, enabling true automation\n\n**Alternative: Granular approval flags:**\n\n```bash\n# Auto-approve specific operation types\ncodex --auto-approve-read --auto-approve-execute exec \"...\"\n```\n\n## Quick Start\n\nTo perform a basic code review on staged changes:\n\n```bash\ncodex --full-auto exec \"Review the staged git changes. Analyze code quality, identify bugs, suggest improvements, and check for security issues. Provide a structured review with severity levels.\"\n```\n\n## Review Workflows\n\n### 1. Git Diff Review\n\nTo review uncommitted changes in the current repository:\n\n**Staged changes only:**\n\n```bash\ncodex --full-auto exec \"Review all staged changes (git diff --cached). For each file:\n1. Summarize what changed\n2. Identify potential bugs or logic errors\n3. Check for security vulnerabilities\n4. Suggest code quality improvements\n5. Rate severity: critical/high/medium/low\n\nFormat as a structured review report.\"\n```\n\n**All uncommitted changes:**\n\n```bash\ncodex --full-auto exec \"Review all uncommitted changes (git diff HEAD). Provide:\n- Summary of changes per file\n- Bug identification with line numbers\n- Security concerns\n- Code style issues\n- Suggested fixes with code examples\"\n```\n\n**Changes between branches:**\n\n```bash\ncodex --full-auto exec \"Review changes between main and current branch (git diff main...HEAD). Focus on:\n1. Breaking changes\n2. API compatibility\n3. Test coverage gaps\n4. Documentation needs\"\n```\n\n### 2. PR Review Workflow\n\nTo review a GitHub Pull Request:\n\n```bash\n# First, fetch PR diff\ngh pr diff <PR_NUMBER> > /tmp/pr_diff.txt\n\n# Then review with codex (--full-auto for headless operation)\ncodex --full-auto exec \"Review the code changes in /tmp/pr_diff.txt as a thorough PR reviewer. Provide:\n\n## Summary\nBrief description of what this PR accomplishes\n\n## Code Review\nFor each file changed:\n- Purpose of changes\n- Potential issues (bugs, edge cases)\n- Security considerations\n- Performance implications\n\n## Recommendations\n- Required changes (blocking)\n- Suggested improvements (non-blocking)\n- Questions for the author\n\n## Verdict\nAPPROVE / REQUEST_CHANGES / NEEDS_DISCUSSION\"\n```\n\n### 3. File Review\n\nTo review specific files:\n\n**Single file:**\n\n```bash\ncodex --full-auto exec \"Perform a comprehensive code review of src/utils/auth.ts. Analyze:\n1. Code correctness and logic\n2. Error handling completeness\n3. Security vulnerabilities (OWASP Top 10)\n4. Performance bottlenecks\n5. Code maintainability\n6. Test coverage recommendations\"\n```\n\n**Multiple files:**\n\n```bash\ncodex --full-auto exec \"Review these files as a cohesive unit: src/api/handler.ts, src/api/middleware.ts, src/api/routes.ts. Focus on:\n- Consistency across files\n- Proper separation of concerns\n- Error propagation\n- Request validation\"\n```\n\n### 4. Directory Review\n\nTo review an entire directory or project:\n\n```bash\ncodex --full-auto exec \"Perform a code review of the src/services/ directory. For each file:\n- Identify the file's purpose\n- List any bugs or issues\n- Note security concerns\n- Suggest improvements\n\nProvide a summary with prioritized action items.\"\n```\n\n### 5. Security Audit\n\nTo perform a security-focused review:\n\n```bash\ncodex --full-auto exec \"Perform a security audit of the codebase. Check for:\n\n**Critical:**\n- SQL injection vulnerabilities\n- Command injection risks\n- Authentication/authorization flaws\n- Sensitive data exposure\n- Insecure deserialization\n\n**High:**\n- XSS vulnerabilities\n- CSRF issues\n- Insecure dependencies\n- Hardcoded secrets/credentials\n- Improper input validation\n\n**Medium:**\n- Missing rate limiting\n- Verbose error messages\n- Insecure configurations\n- Missing security headers\n\nReport findings with:\n- Severity level\n- File and line number\n- Description of vulnerability\n- Remediation steps\n- Code fix examples\"\n```\n\n### 6. Performance Review\n\nTo analyze code for performance issues:\n\n```bash\ncodex --full-auto exec \"Analyze the codebase for performance issues:\n\n1. **Algorithm Complexity**\n   - O(n^2) or worse operations\n   - Unnecessary nested loops\n   - Inefficient data structures\n\n2. **Resource Usage**\n   - Memory leaks\n   - Unclosed resources\n   - Large object allocations\n\n3. **I/O Operations**\n   - N+1 query patterns\n   - Synchronous blocking calls\n   - Missing caching opportunities\n\n4. **Concurrency**\n   - Race conditions\n   - Deadlock potential\n   - Thread safety issues\n\nProvide specific file locations and optimization suggestions.\"\n```\n\n### 7. Architecture Review\n\nTo review code architecture and design:\n\n```bash\ncodex --full-auto exec \"Review the codebase architecture:\n\n1. **Design Patterns**\n   - Identify patterns in use\n   - Suggest missing patterns\n   - Flag anti-patterns\n\n2. **SOLID Principles**\n   - Single Responsibility violations\n   - Open/Closed principle adherence\n   - Dependency Inversion issues\n\n3. **Code Organization**\n   - Module boundaries\n   - Circular dependencies\n   - Coupling analysis\n\n4. **Maintainability**\n   - Code duplication\n   - Complex functions (cyclomatic complexity)\n   - Missing abstractions\n\nProvide architectural recommendations with examples.\"\n```\n\n## Advanced Options\n\n### Model Selection\n\nTo use a specific model (if need to use the latest model - make sure do web search first to find the latest and most suitable model) for deeper analysis:\n\n```bash\ncodex --full-auto exec --model gpt-5.1-codex \"Perform thorough code review of src/...\"\n```\n\n### Reasoning Depth\n\nTo adjust reasoning effort (available: minimal, low, medium, high, xhigh):\n\nConfigure in `~/.codex/config.toml`:\n\n```toml\nmodel_reasoning_effort = \"high\"\n```\n\n### Output to File\n\nTo save review results:\n\n```bash\ncodex --full-auto exec -o review_report.md \"Review src/api/...\"\n```\n\n### JSON Output\n\nTo get structured JSON output for CI integration:\n\n```bash\ncodex --full-auto exec --json \"Review staged changes. Return JSON with structure:\n{\n  \\\"summary\\\": \\\"...\\\",\n  \\\"files_reviewed\\\": [...],\n  \\\"issues\\\": [{\\\"severity\\\": \\\"...\\\", \\\"file\\\": \\\"...\\\", \\\"line\\\": N, \\\"message\\\": \\\"...\\\"}],\n  \\\"recommendations\\\": [...]\n}\" 2>/dev/null | jq '.item.content'\n```\n\n## CI/CD Integration\n\nTo integrate code review in CI pipelines:\n\n```bash\n#!/bin/bash\n# ci-review.sh\n\n# Get changed files\nCHANGED_FILES=$(git diff --name-only origin/main...HEAD)\n\nif [ -z \"$CHANGED_FILES\" ]; then\n    echo \"No files changed\"\n    exit 0\nfi\n\n# Run codex review (--full-auto required for CI/headless operation)\ncodex --full-auto exec --skip-git-repo-check -o review.md \"Review these changed files: $CHANGED_FILES\n\nProvide a structured review. If any critical or high severity issues are found, clearly indicate BLOCKING_ISSUES=true at the end.\"\n\n# Check for blocking issues\nif grep -q \"BLOCKING_ISSUES=true\" review.md; then\n    echo \"Critical issues found in code review\"\n    cat review.md\n    exit 1\nfi\n\necho \"Code review passed\"\nexit 0\n```\n\n## Prompt Templates\n\n### Standard Review Template\n\n```text\nReview the following code changes. For each issue found:\n\n1. **Location**: File path and line number\n2. **Severity**: Critical / High / Medium / Low / Info\n3. **Category**: Bug / Security / Performance / Style / Documentation\n4. **Description**: Clear explanation of the issue\n5. **Suggestion**: How to fix it with code example\n\nOrganize by severity, starting with Critical issues.\n```\n\n### PR Approval Template\n\n```text\nAs a senior engineer, review this PR for merge readiness:\n\n## Checklist\n- [ ] Code correctness verified\n- [ ] No security vulnerabilities\n- [ ] Performance acceptable\n- [ ] Error handling complete\n- [ ] Tests adequate\n- [ ] Documentation updated\n\n## Issues Found\n[List any blocking or non-blocking issues]\n\n## Verdict\n[APPROVE / REQUEST_CHANGES with specific required changes]\n```\n\n## Best Practices\n\n- **Be specific**: Narrow the scope of reviews for better results\n- **Use context**: Provide relevant context about the codebase or requirements\n- **Iterate**: Run multiple focused reviews rather than one broad review\n- **Verify**: Always verify critical security findings manually\n- **Document**: Save review outputs for future reference\n\n## CRITICAL: Web Search Verification\n\n**IMPORTANT**: Before making ANY claims about version numbers, latest releases, or current best practices, you MUST perform a web search to verify the information. This prevents false positives in reviews.\n\n### Why This Matters\n\nCode reviews often involve checking if dependencies are up-to-date or if code follows current best practices. Without verification, you may provide incorrect information. For example:\n\n- Claiming \"ArgoCD latest version is 2.x\" when it's actually 3.2.x (with 3.3.0 in RC)\n- Stating a library is deprecated when it's actively maintained\n- Recommending outdated security practices\n\n### When to Web Search\n\n**Always search before commenting on:**\n\n1. **Version numbers** - Latest versions of any tool, library, or framework\n2. **Deprecation status** - Whether APIs, functions, or libraries are deprecated\n3. **Security advisories** - Current CVEs or security recommendations\n4. **Best practices** - Current recommended patterns (they evolve over time)\n5. **Feature availability** - When features were introduced in specific versions\n\n### How to Verify\n\nBefore finalizing any review that mentions versions or current practices:\n\n```bash\n# Use WebSearch tool to verify current information\n# Example queries:\n# - \"ArgoCD latest version 2025\"\n# - \"React 19 release date\"\n# - \"Node.js LTS current version\"\n# - \"[library name] latest stable release\"\n```\n\n### Review Output Template with Verification\n\nWhen your review includes version-related findings, format them as:\n\n```text\n**Dependency Check** (verified via web search on YYYY-MM-DD):\n- Package X: Using v1.2.3, latest stable is v2.0.1 ‚úì\n- Package Y: Using v3.0.0, this IS the latest version ‚úì\n- Package Z: Using v0.9.0, latest is v1.0.0 (breaking changes - review release notes)\n```\n\n**Never guess or assume version information. When in doubt, search first.**\n\n## Reference Files\n\n- **[Codex CLI Reference](./references/codex_cli.md)** - Complete command reference and configuration options\n- **[Review Prompts Library](./references/review_prompts.md)** - Collection of specialized review prompts\n\n## Troubleshooting\n\n**Codex not finding files:**\n\n- Ensure running from the correct directory\n- Use absolute paths when needed\n- Check that the Git repository is initialized\n\n**Authentication issues:**\n\n- Run `codex` interactively to re-authenticate\n- Check `~/.codex/` for credential files\n\n**Timeout on large reviews:**\n\n- Break into smaller file sets\n- Use `--full-auto` for longer operations\n- Consider directory-by-directory reviews\n",
        "design-guide/README.md": "# Design Guide Generator\n\nGenerate pixel-perfect design guides from any website URL with automated extraction of design tokens, CSS styles, and screenshots.\n\n## Features\n\n- üì∏ **Screenshot Capture** - Viewport and full-page screenshots\n- üé® **Color Extraction** - Comprehensive color palette analysis\n- üìù **Typography Analysis** - Font families, sizes, weights, and line heights\n- üìê **Layout & Spacing** - Margin, padding, gap, and border radius extraction\n- üíÖ **CSS Extraction** - All stylesheets and inline styles\n- üìä **Computed Styles** - Detailed element-by-element style analysis\n- üìã **Design Documentation** - Comprehensive markdown design guide\n\n## Installation\n\n```bash\n# Install dependencies\nuv sync\n\n# Install Playwright browsers\nplaywright install chromium\n```\n\n## Usage\n\n### Basic Usage\n\n```bash\nuv run main.py --url https://example.com\n```\n\n### Custom Output Directory\n\n```bash\nuv run main.py --url https://stripe.com --output ./stripe-design\n```\n\n### Custom Viewport Size\n\n```bash\nuv run main.py --url https://github.com --viewport-width 1920 --viewport-height 1080\n```\n\n## Options\n\n- `--url, -u` - Website URL to analyze (required)\n- `--output, -o` - Output directory (default: `./output`)\n- `--viewport-width` - Viewport width in pixels (default: 1600)\n- `--viewport-height` - Viewport height in pixels (default: 1200)\n\n## Output\n\nThe tool generates the following files in the output directory:\n\n```\noutput/\n‚îú‚îÄ‚îÄ design-guide.md           # Comprehensive design documentation\n‚îú‚îÄ‚îÄ viewport_screenshot.png   # Viewport screenshot\n‚îú‚îÄ‚îÄ fullpage_screenshot.png   # Full page screenshot\n‚îú‚îÄ‚îÄ extracted.html            # Original HTML structure\n‚îú‚îÄ‚îÄ extracted.css             # All CSS styles\n‚îî‚îÄ‚îÄ computed_styles.json      # Computed element styles\n```\n\n## Design Guide Contents\n\nThe generated `design-guide.md` includes:\n\n1. **Color Palette** - Text, background, and border colors\n2. **Typography** - Fonts, sizes, weights, line heights\n3. **Layout & Spacing** - Margins, paddings, gaps, border radius\n4. **Design Principles** - Extracted patterns and recommendations\n5. **Implementation Notes** - Tips for pixel-perfect recreation\n\n## Example Workflow\n\n### Analyzing a Website\n\n```bash\n# Extract design from Stripe\nuv run main.py --url https://stripe.com --output ./stripe-design\n\n# Review the design guide\ncat ./stripe-design/design-guide.md\n\n# Examine extracted CSS\ncat ./stripe-design/extracted.css\n```\n\n### Pixel-Perfect Recreation\n\n1. **Extract design information**\n   ```bash\n   uv run main.py --url https://example.com\n   ```\n\n2. **Review the design guide** - Study design tokens and patterns\n\n3. **Build HTML** - Create `/tmp/test.html` using the design tokens\n\n4. **Compare** - Take screenshots and compare with originals\n\n5. **Iterate** - Refine until pixel-perfect\n\n6. **Document learnings** - Update design guide with findings\n\n## Dependencies\n\n- **click** - CLI framework\n- **playwright** - Browser automation for screenshots\n- **beautifulsoup4** - HTML parsing\n- **cssutils** - CSS parsing and analysis\n- **pillow** - Image processing\n\n## Requirements\n\n- Python 3.12 or higher\n- uv package manager\n- Chromium browser (installed via Playwright)\n\n## Claude Code Integration\n\nThis tool is designed as a Claude Code skill. When used in Claude Code:\n\n1. Claude will navigate to the skill directory\n2. Install dependencies automatically\n3. Run the extraction\n4. Analyze the results\n5. Optionally use Playwright MCP for advanced captures\n6. Generate pixel-perfect HTML recreations\n7. Deliver final assets to `./design-guide/output/`\n\n## Advanced Features\n\n### Playwright MCP Integration\n\nWhen running in Claude Code with Playwright MCP:\n\n- Interactive page exploration before capture\n- Multiple viewport sizes (desktop, tablet, mobile)\n- Dynamic content interaction\n- State capture (hover, active, focus states)\n\n### Pixel-Perfect Recreation\n\nThe tool supports an iterative workflow:\n\n1. Extract ‚Üí 2. Build ‚Üí 3. Compare ‚Üí 4. Refine ‚Üí 5. Document\n\nEach iteration improves accuracy and captures nuances.\n\n## Tips\n\n- **Desktop sites**: Use 1600x1200 or 1920x1080 viewport\n- **Mobile sites**: Use 375x812 viewport\n- **SPAs**: Wait for full page load before capture\n- **Multiple pages**: Analyze homepage, product pages, etc.\n- **Iterate**: Refine the design guide after recreation\n\n## License\n\nMIT\n\n## Author\n\nGenerated using Claude Code skill framework\n",
        "design-guide/SKILL.md": "---\nname: design-guide\ndescription: Extract comprehensive design language from websites including colors, typography, animations, interactive states, shadows, gradients, component patterns, and UX behaviors. Generates pixel-perfect design guides with responsive screenshots and complete design system documentation. Use when analyzing website design, creating design systems, or rebuilding sites.\n---\n\n# Comprehensive Design Guide Generator\n\nExtract the complete design language from any website with automated analysis of colors, typography, animations, interactions, and UX patterns. Goes far beyond basic CSS extraction to capture the full design system.\n\n## When to Use This Skill\n\nUse this skill when you want to:\n- **Analyze a website's complete design system** - Not just colors and fonts, but the entire design language\n- **Extract interactive design patterns** - Hover states, transitions, animations, micro-interactions\n- **Document component libraries** - Buttons, cards, forms, navigation patterns\n- **Create pixel-perfect recreations** - Comprehensive data for exact replicas\n- **Build design systems** - Complete token systems with all design decisions documented\n- **Understand UX patterns** - Interaction patterns, accessibility features, responsive behavior\n- **Reverse-engineer designs** - Full extraction of design decisions from live websites\n\n## What This Skill Extracts\n\n### üé® Visual Design\n\n**Colors & Gradients**\n- Text colors (all variations)\n- Background colors\n- Border colors\n- Shadow colors (extracted from box-shadow)\n- Linear and radial gradients\n- Complete color palette with CSS custom properties\n\n**Typography System**\n- Font families and fallback stacks\n- Complete type scale (all font sizes used)\n- Font weights (100-900)\n- Line heights\n- Letter spacing\n- Text transforms\n- Heading hierarchy (H1-H6) with exact styles\n- Body text specifications\n\n**Visual Effects**\n- Box shadows (all variations)\n- Text shadows\n- CSS filters (blur, brightness, contrast, etc.)\n- Transform properties\n- Opacity values\n- Border radius values\n\n### ‚ö° Interactive Design\n\n**Interactive States**\n- Hover effects (color, transform, shadow changes)\n- Focus states\n- Active states\n- Transition properties\n- Before/after comparisons for hover states\n- Screenshots of interactive elements in hover state\n\n**Animations**\n- CSS transitions (timing, easing, duration)\n- Keyframe animations\n- Animated element detection\n- Animation names and rules\n\n### üìê Layout & Spacing\n\n**Spacing System**\n- Margin values (sorted scale)\n- Padding values (sorted scale)\n- Gap values (Flexbox/Grid)\n- Complete spacing token system\n\n**Layout Patterns**\n- Container max-widths\n- Centered container patterns\n- Flexbox configurations\n- Grid layouts\n- Sticky/fixed positioning\n\n### üß© Component Patterns\n\n**UI Components Identified**\n- Buttons (with exact styling)\n- Cards (background, shadow, radius, padding)\n- Navigation bars\n- Forms and inputs\n- Modals\n- Badges\n- Alerts\n\n**Component Documentation**\n- Exact CSS for each component variant\n- Component text content\n- Visual hierarchy\n\n### üé≠ UX & Behavior\n\n**Interaction Patterns**\n- Scroll behavior\n- Cursor styles used\n- Interactive element count\n- Sticky/fixed element patterns\n\n**Accessibility Features**\n- ARIA labels count\n- ARIA descriptions count\n- Role attributes count\n- Image alt text usage\n\n### üì± Responsive Design\n\n**Multi-Device Analysis**\n- Mobile screenshots (375x812)\n- Tablet screenshots (768x1024)\n- Desktop screenshots (1920x1080)\n- Layout metrics at each breakpoint\n- Viewport-specific behaviors\n\n## Instructions for Claude\n\n### Step 1: Verify Setup\n\nNavigate to the skill directory:\n```bash\ncd /Users/tchen/projects/mycode/claude-skills/design-guide\n```\n\nEnsure dependencies are installed (first time only):\n```bash\nuv sync\nplaywright install chromium\n```\n\n### Step 2: Gather Requirements\n\nAsk the user for:\n- **URL** (required): The website to analyze\n- **Output directory** (optional): Where to save results (default: `./output`)\n- **Viewport size** (optional): Custom viewport dimensions (default: 1600x1200)\n\n### Step 3: Run the Enhanced Extractor\n\nExecute the comprehensive extraction:\n\n```bash\nuv run main.py --url <URL> [OPTIONS]\n```\n\n**Available Options:**\n- `--url, -u`: Website URL to analyze (required)\n- `--output, -o`: Output directory (default: `./output`)\n- `--viewport-width`: Viewport width in pixels (default: 1600)\n- `--viewport-height`: Viewport height in pixels (default: 1200)\n\n**What happens during extraction:**\n\nThe tool will:\n1. üìÑ Load the page and wait for network idle\n2. üì∏ Take viewport and full-page screenshots\n3. üîç Extract HTML structure\n4. üíÖ Extract all CSS (linked and inline)\n5. üéØ Compute styles for every element\n6. ‚ö° Capture interactive states (hover 10 elements)\n7. üé® Analyze complete color palette\n8. üìù Extract typography system\n9. üìê Analyze layout and spacing\n10. ‚ú® Detect animations and transitions\n11. üåü Extract shadows and visual effects\n12. üß© Identify component patterns\n13. üé≠ Analyze UX patterns\n14. üì± Test responsive behavior (3 breakpoints)\n15. üíæ Save all data and generate design guide\n\n### Step 4: Review Generated Assets\n\nAfter extraction, the output directory contains:\n\n**Documentation**\n- `design-guide.md` - Comprehensive design guide (main deliverable)\n- `design_data.json` - Complete structured data\n\n**Visual Assets**\n- `viewport_screenshot.png` - Desktop viewport capture\n- `fullpage_screenshot.png` - Complete page capture\n- `interactive_hover.png` - Hover state demonstrations\n- `responsive_mobile.png` - Mobile view (375x812)\n- `responsive_tablet.png` - Tablet view (768x1024)\n- `responsive_desktop.png` - Large desktop view (1920x1080)\n\n**Source Code**\n- `extracted.html` - Original HTML\n- `extracted.css` - All CSS (can be 2-3MB for complex sites)\n- `computed_styles.json` - Computed styles for every element (can be large)\n\n### Step 5: Explore the Design Guide\n\nThe generated `design-guide.md` contains:\n\n1. **Visual Assets** - All screenshots with descriptions\n2. **Color System** - Complete palette with CSS variables\n3. **Typography System** - Font stacks, type scale, heading hierarchy\n4. **Spacing & Layout** - Complete spacing tokens and container patterns\n5. **Visual Effects** - Shadows, filters, transforms, opacity\n6. **Animations & Transitions** - All transitions and keyframe animations\n7. **Interactive States** - Hover effects with before/after comparisons\n8. **Component Patterns** - Button, card, form, nav styling\n9. **UX Patterns** - Accessibility, cursor styles, sticky elements\n10. **Responsive Design** - Breakpoint analysis\n11. **Implementation Guide** - Step-by-step recreation instructions\n\n### Step 6: Analyze Design Patterns\n\nUse the extracted data to understand:\n\n**Design System Maturity**\n- Consistent spacing scale? (Check margin/padding variations)\n- Defined type scale? (Check font size progression)\n- Component library? (Check identified components)\n- Accessibility? (Check ARIA features)\n\n**Design Decisions**\n- Color choices and usage patterns\n- Typography hierarchy clarity\n- Animation smoothness (check transition timings)\n- Shadow depth system\n- Border radius consistency\n\n### Step 7: Pixel-Perfect Recreation (Advanced)\n\nFor recreating the design:\n\n1. **Use Design Tokens**: Copy CSS variables from design guide\n2. **Match Typography**: Use exact font stacks and sizes\n3. **Implement Spacing**: Follow extracted spacing scale\n4. **Apply Effects**: Use exact shadow and border-radius values\n5. **Add Interactions**: Implement hover/focus states as documented\n6. **Test Responsive**: Match layouts at all breakpoints\n7. **Verify Visually**: Compare with extracted screenshots\n\n### Step 8: Interactive Exploration with Playwright MCP (Optional)\n\nIf you need deeper interaction analysis:\n\n```python\n# Use Playwright MCP to:\n1. Navigate to specific pages/states\n2. Test form interactions\n3. Trigger modals/dropdowns\n4. Capture specific UI states\n5. Test animations manually\n6. Explore navigation flows\n```\n\n## Usage Examples\n\n### Basic Usage - Any Website\n```bash\nuv run main.py --url https://stripe.com\n```\n\n### E-commerce Site Analysis\n```bash\nuv run main.py --url https://shopify.com --output ./shopify-design\n```\n\n### Custom Viewport\n```bash\nuv run main.py --url https://github.com --viewport-width 1920 --viewport-height 1080\n```\n\n### Design System Extraction\n```bash\n# Extract from design system documentation\nuv run main.py --url https://primer.style --output ./primer-system\n```\n\n## Example Output\n\nAfter analyzing **GitHub.com**, you get:\n\n**Colors:**\n- 100+ unique colors cataloged\n- Dark theme palette (rgb(13, 17, 23) backgrounds)\n- Brand colors (rgb(31, 111, 235))\n- 5+ gradient variations\n- Shadow color system\n\n**Typography:**\n- Mona Sans font family\n- 10-level type scale (12px to 72px)\n- 5 font weights (400, 450, 500, 600, 700)\n- Heading hierarchy\n\n**Components:**\n- 5+ button variations\n- Card patterns with exact shadows\n- Navigation bar styles\n- Form input specifications\n\n**Interactive:**\n- Hover state transitions\n- Animation keyframes\n- Transform effects\n\n**Responsive:**\n- Mobile, tablet, desktop screenshots\n- Layout adaptations documented\n\n## Advanced Features\n\n### Component Pattern Recognition\n\nThe skill automatically identifies:\n- **Buttons**: Searches for button, [role=\"button\"], .btn, input[type=\"button\"]\n- **Cards**: Searches for [class*=\"card\"], article, [class*=\"post\"]\n- **Nav**: Searches for nav, [role=\"navigation\"], header nav\n- **Forms**: Extracts input, select, textarea styling\n\n### Interactive State Capture\n\n- Hovers over first 10 interactive elements\n- Captures computed styles before and after hover\n- Takes screenshot in hover state\n- Documents changes in design guide\n\n### Responsive Testing\n\nAutomatically tests at:\n- **Mobile**: 375x812 (iPhone X/11/12/13/14 size)\n- **Tablet**: 768x1024 (iPad portrait)\n- **Desktop**: 1920x1080 (Full HD)\n\n### Animation Detection\n\n- Scans all elements for CSS animations\n- Extracts keyframe rules from stylesheets\n- Identifies animated elements\n- Documents transition properties\n\n## Tips for Best Results\n\n### Choosing the Right URL\n\n‚úÖ **Good URLs:**\n- Homepage (comprehensive overview)\n- Marketing pages (best design work)\n- Component libraries (design system docs)\n- Login/signup pages (form patterns)\n\n‚ùå **Challenging URLs:**\n- Authenticated content (may redirect)\n- Dynamic SPAs (may need extra wait time)\n- Sites with aggressive anti-bot measures\n\n### Viewport Selection\n\n- **1600x1200** - Default, good for most sites\n- **1920x1080** - Large desktop analysis\n- **1280x720** - Smaller desktop\n- **Custom** - Match specific design requirements\n\n### Multiple Page Analysis\n\nFor complete design systems, run on multiple pages:\n\n```bash\n# Homepage\nuv run main.py --url https://example.com -o ./design/home\n\n# Product page\nuv run main.py --url https://example.com/product -o ./design/product\n\n# About page\nuv run main.py --url https://example.com/about -o ./design/about\n\n# Then compare to find:\n# - Consistent design tokens\n# - Page-specific variations\n# - Component reuse patterns\n```\n\n### Performance Notes\n\n**Extraction Time:**\n- Simple sites: 30-60 seconds\n- Complex sites (GitHub, Stripe): 60-120 seconds\n- Includes responsive testing at 3 breakpoints\n\n**Output Size:**\n- Design guide: 5-20KB (markdown)\n- Screenshots: 500KB - 3MB total\n- CSS file: 10KB - 5MB (complex sites)\n- Computed styles: 100KB - 10MB\n- Design data JSON: 50KB - 500KB\n\n## Troubleshooting\n\n### Browser Not Installed\n```bash\nplaywright install chromium\n```\n\n### Page Load Timeout\n- Increase timeout in code if needed\n- Some SPAs may need extra wait time\n- Check network connectivity\n\n### Missing Interactive States\n- Some sites block mouse events\n- Screenshot may capture only first few hovers\n- Manual Playwright MCP can capture more\n\n### Empty Design Guide Sections\n- Page may not use certain features (animations, shadows, etc.)\n- This is normal for minimalist designs\n- Check `design_data.json` for raw data\n\n### CORS Errors for CSS\n- External stylesheets may be blocked\n- Tool extracts what it can access\n- Check extracted.css for completeness\n- Use browser DevTools to manually inspect\n\n## Cost Considerations\n\n**Resource Usage:**\n- Local Playwright (free)\n- No external APIs (free)\n- CPU: Moderate (page rendering)\n- Memory: 500MB-2GB (complex sites)\n- Disk: 5-50MB per extraction\n\n**No API Keys Required!**\n\n## Design Guide Quality\n\nThe generated design guide is:\n- ‚úÖ **Comprehensive** - Covers all design aspects\n- ‚úÖ **Actionable** - Ready to use for implementation\n- ‚úÖ **Organized** - Clear sections and categories\n- ‚úÖ **Visual** - References screenshots throughout\n- ‚úÖ **Technical** - Exact CSS values and code\n- ‚úÖ **Accessible** - Documents accessibility features\n\n## Integration with Claude Code Workflow\n\n### Typical Usage Flow\n\n1. **User Request**: \"Analyze the design of stripe.com\"\n\n2. **Claude Uses Skill**:\n   ```bash\n   cd /Users/tchen/projects/mycode/claude-skills/design-guide\n   uv run main.py --url https://stripe.com --output ./stripe-design\n   ```\n\n3. **Claude Reviews Output**: Reads design-guide.md\n\n4. **Claude Presents Findings**:\n   - Color system overview\n   - Typography hierarchy\n   - Key components identified\n   - Interactive patterns found\n   - Accessibility score\n\n5. **User Follow-up**: \"Recreate the hero section\"\n\n6. **Claude Implements**: Uses extracted design tokens to build pixel-perfect HTML/CSS\n\n## Example User Interactions\n\n**User**: \"What design system does Shopify use?\"\n\n**Claude**:\n```bash\n# Runs extraction\nuv run main.py --url https://shopify.com -o ./shopify-design\n\n# Analyzes output\n# Reports findings:\n```\n\"Shopify uses:\n- **Polaris design system**\n- Typography: Inter font family\n- Colors: Green primary (rgb(0, 128, 96))\n- Spacing: 4px base unit\n- Components: Identified 12 button variants, card system, navigation\n- Shadows: 3-level depth system\n- Responsive: Mobile-first approach\"\n\n---\n\n**User**: \"Extract the button styles from GitHub\"\n\n**Claude**:\n```bash\nuv run main.py --url https://github.com -o ./github-design\n```\n\n\"Found 5 button variants on GitHub:\n\n1. **Primary Button**:\n   - Background: rgb(31, 111, 235)\n   - Color: white\n   - Padding: 5px 16px\n   - Border-radius: 6px\n   - Hover: Transforms darker\n\n[Shows exact CSS from design guide]\"\n\n---\n\n## Advanced: Claude-Driven Analysis\n\nWhen using this skill, Claude should:\n\n1. **Run extraction** automatically\n2. **Read design-guide.md** to understand design\n3. **Analyze patterns** for insights\n4. **Present findings** in structured format\n5. **Offer to recreate** components if requested\n6. **Use Playwright MCP** for deeper interaction testing if needed\n\n## Deliverables\n\nAfter running this skill, deliver to user:\n\n‚úÖ **design-guide.md** - Main comprehensive guide\n‚úÖ **All screenshots** - Visual reference\n‚úÖ **design_data.json** - Structured data for programmatic use\n‚úÖ **Source files** - HTML, CSS, computed styles\n\nOptional:\n‚úÖ **Recreated components** - If requested\n‚úÖ **Comparison analysis** - If analyzing multiple sites\n‚úÖ **Token library** - CSS/SCSS variables file\n\n---\n\n**Skill Version:** 2.0 (Enhanced - Full Design Language Extraction)\n**Last Updated:** 2025-11-16\n**Extraction Depth:** Comprehensive (11+ analysis types)\n",
        "kro-rgd/SKILL.md": "---\nname: kro-rgd-pulumi\ndescription: Create production-ready KRO ResourceGraphDefinitions using Pulumi TypeScript. Use when users need to define custom Kubernetes APIs, compose resources with KRO, integrate AWS ACK resources, or build platform abstractions using Pulumi infrastructure as code.\n---\n\n# KRO ResourceGraphDefinition with Pulumi TypeScript\n\nGenerate production-ready Kubernetes Resource Orchestrator (KRO) ResourceGraphDefinitions using Pulumi TypeScript for creating custom Kubernetes APIs and composing resources with AWS ACK integration.\n\n## When to Use This Skill\n\nUse this skill when the user wants to:\n\n- **Create custom Kubernetes APIs** using KRO ResourceGraphDefinitions\n- **Compose multiple K8s resources** as a single declarative unit\n- **Integrate AWS resources via ACK** (S3, RDS, DynamoDB, etc.) with KRO\n- **Build platform abstractions** for developer self-service\n- **Generate Pulumi TypeScript code** for KRO resources\n- **Define resource dependencies** with automatic orchestration\n- **Create reusable application templates** with CEL expressions (use CEL skill when necessary)\n\n## Overview\n\n### What is KRO?\n\n**KRO (Kube Resource Orchestrator)** is an open-source Kubernetes-native project that allows you to:\n\n- Define custom Kubernetes APIs without writing Go controllers\n- Compose multiple resources as a directed acyclic graph (DAG)\n- Automatically manage resource dependencies and ordering\n- Use CEL expressions for dynamic configuration\n- Provide lifecycle management with drift detection\n\n### What is ResourceGraphDefinition (RGD)?\n\nAn **RGD** is KRO's core custom resource that:\n\n- Defines a schema for your custom API (apiVersion, kind, spec, status)\n- Lists resources to create with CEL expression templating\n- Automatically generates a CRD when applied\n- Deploys a microcontroller to manage instances\n\n### Pulumi Integration\n\nUsing Pulumi TypeScript to deploy KRO resources provides:\n\n- **Type safety** for resource definitions\n- **IDE support** with autocomplete and error checking\n- **Programmatic logic** for complex configurations\n- **GitOps-friendly** workflow\n- **Multi-stack architecture** for separation of concerns\n\n## Prerequisites\n\n### Required Components\n\n```bash\n# 1. Kubernetes cluster (1.25+ for CEL support)\nkubectl version\n\n# 2. KRO installed in cluster\nhelm install kro oci://ghcr.io/kubernetes-sigs/kro/charts/kro \\\n  --namespace kro-system \\\n  --create-namespace\n\n# 3. ACK controllers (if using AWS resources)\nhelm install ack-s3-controller \\\n  oci://public.ecr.aws/aws-controllers-k8s/s3-chart \\\n  --namespace ack-system \\\n  --create-namespace\n\n# 4. Pulumi CLI and Node.js\npulumi version\nnode --version\n```\n\n### Pulumi Project Setup\n\n```bash\n# Create new Pulumi project\nmkdir my-kro-project && cd my-kro-project\npulumi new kubernetes-typescript\n\n# Install dependencies\nnpm install @pulumi/kubernetes @pulumi/pulumi\n```\n\n## Instructions\n\n### Step 1: Understand the Requirements\n\nBefore generating code, gather:\n\n1. **Custom API design**: What kind/apiVersion? What fields in spec?\n2. **Resources to compose**: Deployments, Services, ConfigMaps, ACK resources?\n3. **Dependencies**: Which resources depend on others?\n4. **Conditions**: Any conditional resource creation (includeWhen)?\n5. **Status fields**: What status to expose to users?\n\n### Step 2: Design the Schema\n\nDefine the user-facing API:\n\n```typescript\n// Schema design principles:\n// - Use descriptive field names\n// - Provide sensible defaults\n// - Group related fields in nested objects\n// - Add validation rules for constraints\n```\n\n### Step 3: Generate Pulumi TypeScript Code\n\nUse this structure for KRO RGD:\n\n```typescript\nimport * as k8s from \"@pulumi/kubernetes\";\nimport * as pulumi from \"@pulumi/pulumi\";\n\n// Create the ResourceGraphDefinition\nconst rgd = new k8s.apiextensions.CustomResource(\"my-app-rgd\", {\n    apiVersion: \"kro.run/v1alpha1\",\n    kind: \"ResourceGraphDefinition\",\n    metadata: {\n        name: \"my-application\",\n        namespace: \"default\",\n    },\n    spec: {\n        schema: {\n            apiVersion: \"v1alpha1\",\n            kind: \"Application\",\n            spec: {\n                // Define user-configurable fields\n                name: \"string\",\n                image: \"string | default=\\\"nginx:latest\\\"\",\n                replicas: \"integer | default=3\",\n            },\n            status: {\n                // Auto-populated status fields\n                ready: \"${deployment.status.conditions.exists(c, c.type == 'Available' && c.status == 'True')}\",\n                availableReplicas: \"${deployment.status.availableReplicas}\",\n            },\n            validation: [\n                {\n                    expression: \"self.replicas >= 1 && self.replicas <= 100\",\n                    message: \"Replicas must be between 1 and 100\",\n                },\n            ],\n        },\n        resources: [\n            {\n                id: \"deployment\",\n                template: {\n                    apiVersion: \"apps/v1\",\n                    kind: \"Deployment\",\n                    metadata: {\n                        name: \"${schema.spec.name}\",\n                    },\n                    spec: {\n                        replicas: \"${schema.spec.replicas}\",\n                        selector: {\n                            matchLabels: {\n                                app: \"${schema.spec.name}\",\n                            },\n                        },\n                        template: {\n                            metadata: {\n                                labels: {\n                                    app: \"${schema.spec.name}\",\n                                },\n                            },\n                            spec: {\n                                containers: [\n                                    {\n                                        name: \"app\",\n                                        image: \"${schema.spec.image}\",\n                                    },\n                                ],\n                            },\n                        },\n                    },\n                },\n                readyWhen: [\n                    \"${deployment.status.conditions.exists(c, c.type == 'Available' && c.status == 'True')}\",\n                ],\n            },\n            {\n                id: \"service\",\n                template: {\n                    apiVersion: \"v1\",\n                    kind: \"Service\",\n                    metadata: {\n                        name: \"${schema.spec.name}-service\",\n                    },\n                    spec: {\n                        selector: {\n                            app: \"${schema.spec.name}\",\n                        },\n                        ports: [\n                            {\n                                port: 80,\n                                targetPort: 8080,\n                            },\n                        ],\n                    },\n                },\n            },\n        ],\n    },\n});\n\nexport const rgdName = rgd.metadata.name;\n```\n\n### Step 4: Add ACK Resources (AWS Integration)\n\nFor AWS resources via ACK:\n\n```typescript\nconst rgdWithAws = new k8s.apiextensions.CustomResource(\"app-with-aws-rgd\", {\n    apiVersion: \"kro.run/v1alpha1\",\n    kind: \"ResourceGraphDefinition\",\n    metadata: {\n        name: \"application-with-storage\",\n    },\n    spec: {\n        schema: {\n            apiVersion: \"v1alpha1\",\n            kind: \"AppWithStorage\",\n            spec: {\n                name: \"string\",\n                image: \"string\",\n                bucketName: \"string\",\n            },\n            status: {\n                bucketArn: \"${bucket.status.ackResourceMetadata.arn}\",\n                ready: \"${deployment.status.conditions.exists(c, c.type == 'Available' && c.status == 'True')}\",\n            },\n        },\n        resources: [\n            // ACK S3 Bucket\n            {\n                id: \"bucket\",\n                template: {\n                    apiVersion: \"s3.services.k8s.aws/v1alpha1\",\n                    kind: \"Bucket\",\n                    metadata: {\n                        name: \"${schema.spec.bucketName}\",\n                    },\n                    spec: {\n                        name: \"${schema.spec.bucketName}\",\n                        tagging: {\n                            tagSet: [\n                                {\n                                    key: \"ManagedBy\",\n                                    value: \"KRO\",\n                                },\n                            ],\n                        },\n                    },\n                },\n                readyWhen: [\n                    \"${bucket.status.ackResourceMetadata.?arn != null}\",\n                ],\n            },\n            // Deployment referencing bucket\n            {\n                id: \"deployment\",\n                template: {\n                    apiVersion: \"apps/v1\",\n                    kind: \"Deployment\",\n                    metadata: {\n                        name: \"${schema.spec.name}\",\n                    },\n                    spec: {\n                        replicas: 3,\n                        selector: {\n                            matchLabels: {\n                                app: \"${schema.spec.name}\",\n                            },\n                        },\n                        template: {\n                            metadata: {\n                                labels: {\n                                    app: \"${schema.spec.name}\",\n                                },\n                            },\n                            spec: {\n                                containers: [\n                                    {\n                                        name: \"app\",\n                                        image: \"${schema.spec.image}\",\n                                        env: [\n                                            {\n                                                name: \"S3_BUCKET\",\n                                                value: \"${schema.spec.bucketName}\",\n                                            },\n                                            {\n                                                name: \"S3_BUCKET_ARN\",\n                                                value: \"${bucket.status.ackResourceMetadata.arn}\",\n                                            },\n                                        ],\n                                    },\n                                ],\n                            },\n                        },\n                    },\n                },\n            },\n        ],\n    },\n});\n```\n\n### Step 5: Deploy and Test\n\n```bash\n# Deploy the RGD\npulumi up\n\n# Verify RGD is active\nkubectl get resourcegraphdefinition\nkubectl describe resourcegraphdefinition my-application\n\n# Check generated CRD\nkubectl get crd | grep kro\n\n# Create an instance of your custom API\nkubectl apply -f - <<EOF\napiVersion: v1alpha1\nkind: Application\nmetadata:\n  name: my-test-app\nspec:\n  name: my-test-app\n  image: nginx:1.21\n  replicas: 5\nEOF\n\n# Monitor instance\nkubectl get application\nkubectl describe application my-test-app\n```\n\n## CEL Expression Reference\n\n### Referencing Schema Fields\n\n```cel\n${schema.spec.name}              // User-provided spec field\n${schema.metadata.name}          // Instance name\n${schema.metadata.namespace}     // Instance namespace\n${schema.metadata.uid}           // Unique ID\n```\n\n### Referencing Other Resources\n\n```cel\n${deployment.metadata.name}      // Resource name\n${deployment.spec.replicas}      // Spec field\n${deployment.status.?endpoint}   // Optional status field (use ? for null safety)\n```\n\n### Operators and Functions\n\n```cel\n// Ternary conditional\n${schema.spec.env == 'prod' ? 10 : 3}\n\n// String concatenation\n${\"prefix-\" + schema.spec.name}\n\n// Null coalescing\n${deployment.status.?ready ?? false}\n\n// List operations\n${deployment.status.conditions.exists(c, c.type == 'Available' && c.status == 'True')}\n${schema.spec.containers.map(c, c.name)}\n\n// Type conversion\n${string(schema.spec.replicas)}\n${int(schema.spec.replicasString)}\n```\n\n### Conditional Resource Inclusion\n\n```yaml\nresources:\n  - id: ingress\n    includeWhen:\n      - ${schema.spec.ingress.enabled}\n    template:\n      apiVersion: networking.k8s.io/v1\n      kind: Ingress\n      # ...\n```\n\n## Common Patterns\n\n### Pattern 1: Web Application Stack\n\n```typescript\n// Creates: Deployment + Service + optional Ingress + optional HPA\nconst webAppRgd = createWebAppRgd({\n    name: \"webapp\",\n    supportsIngress: true,\n    supportsAutoscaling: true,\n});\n```\n\n### Pattern 2: Database Application\n\n```typescript\n// Creates: ACK RDS Instance + Secret + ConfigMap + Deployment\nconst dbAppRgd = createDatabaseAppRgd({\n    name: \"dbapp\",\n    dbEngine: \"postgres\",\n    withBackup: true,\n});\n```\n\n### Pattern 3: Microservices Bundle\n\n```typescript\n// Creates: Multiple Deployments + Services + NetworkPolicies\nconst microservicesRgd = createMicroservicesRgd({\n    name: \"platform\",\n    services: [\"api\", \"worker\", \"scheduler\"],\n});\n```\n\n### Pattern 4: Multi-Environment App\n\n```typescript\n// Creates environment-specific resources with quotas\nconst envAppRgd = createEnvironmentAppRgd({\n    name: \"envapp\",\n    environments: [\"dev\", \"staging\", \"prod\"],\n});\n```\n\n## ACK Resource Integration\n\n### Supported ACK Resources\n\n| Service     | Resource Types                       | ACK Controller           |\n|-------------|--------------------------------------|--------------------------|\n| S3          | Bucket                               | `s3-controller`          |\n| RDS         | DBInstance, DBCluster, DBSubnetGroup | `rds-controller`         |\n| DynamoDB    | Table, GlobalTable                   | `dynamodb-controller`    |\n| SQS         | Queue                                | `sqs-controller`         |\n| SNS         | Topic, Subscription                  | `sns-controller`         |\n| Lambda      | Function                             | `lambda-controller`      |\n| ElastiCache | CacheCluster, ReplicationGroup       | `elasticache-controller` |\n\n### ACK Status Fields\n\n```cel\n// Common ACK status patterns\n${bucket.status.ackResourceMetadata.arn}           // AWS ARN\n${bucket.status.ackResourceMetadata.ownerAccountID} // AWS Account\n${dbinstance.status.endpoint.address}               // RDS endpoint\n${dbinstance.status.endpoint.port}                  // RDS port\n${queue.status.queueURL}                            // SQS URL\n```\n\n## Best Practices\n\n### 1. Schema Design\n\n```yaml\n# Good: Clear, intuitive fields with defaults\nspec:\n  name: string\n  image: string | default=\"nginx:latest\"\n  replicas: integer | default=3\n  environment: string | default=\"dev\"\n\n# Bad: Cryptic field names, no defaults\nspec:\n  n: string\n  i: string\n  r: integer\n```\n\n### 2. Validation Rules\n\n```yaml\nvalidation:\n  - expression: \"self.replicas >= 1 && self.replicas <= 100\"\n    message: \"Replicas must be between 1 and 100\"\n  - expression: \"self.environment in ['dev', 'staging', 'prod']\"\n    message: \"Environment must be dev, staging, or prod\"\n  - expression: \"self.environment == 'prod' ? self.replicas >= 3 : true\"\n    message: \"Production requires at least 3 replicas\"\n```\n\n### 3. Readiness Conditions\n\n```yaml\nreadyWhen:\n  - ${deployment.status.conditions.exists(c, c.type == 'Available' && c.status == 'True')}\n  - ${deployment.status.readyReplicas == deployment.spec.replicas}\n```\n\n### 4. Status Exposure\n\n```yaml\nstatus:\n  ready: ${deployment.status.conditions.exists(c, c.type == 'Available' && c.status == 'True')}\n  availableReplicas: ${deployment.status.availableReplicas}\n  endpoint: ${service.spec.clusterIP}\n  bucketArn: ${bucket.status.ackResourceMetadata.?arn ?? 'pending'}\n```\n\n### 5. Naming Conventions\n\n```yaml\n# Consistent naming pattern\nmetadata:\n  name: ${schema.spec.name}\n  labels:\n    app.kubernetes.io/name: ${schema.spec.name}\n    app.kubernetes.io/managed-by: kro\n```\n\n## Reference Files\n\n- **[KRO Schema Reference](./references/kro_schema.md)** - Complete RGD schema documentation\n- **[ACK Resources Reference](./references/ack_resources.md)** - ACK resource definitions and status fields\n- **[CEL Expressions Reference](./references/cel_expressions.md)** - CEL syntax and functions\n- **[Templates](./templates/)** - Production-ready Pulumi TypeScript templates\n\n## Current Status\n\n**KRO Status:** v1alpha1 (Alpha)\n\n- Not yet production-ready\n- Breaking changes may occur\n- Kubernetes 1.25+ required\n- Latest release: v0.7.1 (December 2025)\n\n**Recommendation:** Use in development/testing environments while awaiting v1beta1 for production readiness.\n\n## Output Format\n\nWhen generating KRO RGD with Pulumi, always provide:\n\n1. **Complete Pulumi TypeScript code** with proper types\n2. **RGD specification** with schema, resources, and validations\n3. **Example instance YAML** showing how to use the custom API\n4. **Deployment instructions** for both Pulumi and kubectl\n5. **Testing commands** to verify the deployment\n",
        "kro-rgd/templates/README.md": "# KRO ResourceGraphDefinition Pulumi Templates\n\nProduction-ready Pulumi TypeScript templates for creating KRO ResourceGraphDefinitions.\n\n## Templates\n\n| Template | Description | AWS Resources |\n|----------|-------------|---------------|\n| `web-application.ts` | Web app with Deployment, Service, optional Ingress/HPA/PDB | None |\n| `database-application.ts` | App with AWS RDS database via ACK | RDS DBInstance |\n| `fullstack-application.ts` | Full-stack with frontend, backend, and AWS services | S3, ElastiCache, SQS |\n| `multi-environment.ts` | Environment-aware app with tier-based configurations | None |\n\n## Usage\n\n### 1. Create Pulumi Project\n\n```bash\nmkdir my-kro-project && cd my-kro-project\npulumi new kubernetes-typescript\nnpm install @pulumi/kubernetes @pulumi/pulumi\n```\n\n### 2. Copy Template\n\n```bash\n# Copy the template you need\ncp path/to/templates/web-application.ts src/\n```\n\n### 3. Customize and Deploy\n\n```typescript\nimport { createWebApplicationRgd } from \"./web-application\";\n\nconst rgd = createWebApplicationRgd({\n    name: \"my-webapp\",\n    namespace: \"platform\",\n    labels: {\n        team: \"platform\",\n    },\n});\n\nexport const rgdName = rgd.metadata.name;\n```\n\n### 4. Deploy with Pulumi\n\n```bash\npulumi up\n```\n\n### 5. Create Instances\n\nAfter deployment, create instances of your custom API:\n\n```bash\nkubectl apply -f - <<EOF\napiVersion: v1alpha1\nkind: WebApplication\nmetadata:\n  name: my-frontend\nspec:\n  name: frontend\n  image: nginx:1.25\n  replicas: 3\nEOF\n```\n\n## Template Details\n\n### web-application.ts\n\nCreates a web application stack with:\n- Deployment with configurable replicas and resources\n- Service (ClusterIP, NodePort, or LoadBalancer)\n- Optional Ingress with TLS support\n- Optional HorizontalPodAutoscaler\n- Optional PodDisruptionBudget\n\n### database-application.ts\n\nCreates a database-backed application with:\n- AWS RDS DBInstance via ACK controller\n- Kubernetes Secret for database credentials\n- ConfigMap for connection details\n- Application Deployment with DB connectivity\n- Service for application access\n\nPrerequisites:\n- ACK RDS controller installed\n- IRSA configured for RDS access\n- DB subnet group and security group created\n\n### fullstack-application.ts\n\nCreates a complete application stack with:\n- Frontend Deployment + Service + Ingress\n- Backend Deployment + Service\n- AWS S3 bucket for static assets\n- AWS ElastiCache Redis for caching\n- AWS SQS queue for async processing\n- Network Policies for security\n\nPrerequisites:\n- ACK controllers: s3, elasticache, sqs\n- IRSA configured for all services\n- VPC subnets and security groups\n\n### multi-environment.ts\n\nCreates environment-aware applications with:\n- Automatic resource sizing by environment (dev/staging/prod)\n- Tier-based configurations (standard/critical/background)\n- Environment-specific replica counts\n- Optional autoscaling with environment-aware behavior\n- Optional PDB with tier-based availability\n- Optional ServiceMonitor for Prometheus\n- Network Policies\n\n## Customization\n\nEach template function accepts configuration arguments:\n\n```typescript\ninterface WebApplicationRgdArgs {\n    name: string;           // Required: RGD name\n    namespace?: string;     // Optional: defaults to \"default\"\n    labels?: Record<string, string>;  // Optional: additional labels\n}\n```\n\nModify the template's `spec.schema.spec` section to add/remove fields.\nModify the `resources` array to add/remove Kubernetes resources.\n\n## Validation\n\nAll templates include CEL validation rules. Add custom validations:\n\n```typescript\nvalidation: [\n    {\n        expression: \"self.replicas >= 1 && self.replicas <= 100\",\n        message: \"Replicas must be between 1 and 100\",\n    },\n    // Add your custom validations\n],\n```\n\n## Testing\n\n```bash\n# Deploy RGD\npulumi up\n\n# Verify RGD is active\nkubectl get resourcegraphdefinition\n\n# Check generated CRD\nkubectl get crd | grep kro\n\n# Create test instance\nkubectl apply -f test-instance.yaml\n\n# Check status\nkubectl describe <your-kind> <instance-name>\n```\n",
        "surrealdb/SKILL.md": "---\nname: surrealdb\ndescription: Write production-ready SurrealDB queries and operations using SurrealQL. Use when users need to create schemas, write CRUD queries, model graph relationships, build authentication systems, optimize performance, or work with SurrealDB in any capacity.\n---\n\n# SurrealDB - Production-Ready Query Generator\n\nGenerate solid, high-quality, production-ready SurrealDB queries and operations using SurrealQL for multi-model database applications including document, graph, and relational patterns.\n\n## When to Use This Skill\n\nUse this skill when the user wants to:\n\n- **Write SurrealQL queries** (SELECT, CREATE, UPDATE, DELETE, UPSERT)\n- **Design database schemas** (SCHEMAFULL/SCHEMALESS tables, field definitions)\n- **Model relationships** (record links, graph edges with RELATE, nested data)\n- **Implement authentication** (DEFINE ACCESS, SCOPE, permissions, RBAC)\n- **Create indexes** for performance optimization\n- **Write custom functions** using DEFINE FUNCTION\n- **Build real-time applications** with LIVE queries\n- **Implement transactions** for data consistency\n- **Migrate from SQL/NoSQL** to SurrealDB\n- **Debug or optimize existing SurrealQL**\n\n## SurrealQL Quick Reference\n\n### Core Statement Syntax\n\n```sql\n-- SELECT with graph traversal\nSELECT *, ->friends->person AS mutual_friends FROM person:alice;\n\n-- CREATE with specific ID\nCREATE person:john SET name = 'John', age = 30;\n\n-- UPDATE with operators\nUPDATE person SET age += 1, tags += 'senior' WHERE age >= 65;\n\n-- DELETE with conditions\nDELETE person WHERE active = false;\n\n-- UPSERT (create if not exists, update if exists)\nUPSERT user:email@example.com SET email = 'email@example.com', visits += 1;\n\n-- RELATE for graph edges\nRELATE person:alice->follows->person:bob SET since = time::now();\n```\n\n### Data Types\n\n```sql\n-- Basic types\nstring, int, float, bool, datetime, duration, decimal, uuid\n\n-- Complex types\narray, object, record<table>, option<type>\n\n-- Special types\ngeometry (point, line, polygon), bytes, null, none\n```\n\n### Essential Functions\n\n```sql\n-- Time functions\ntime::now()                    -- Current timestamp\ntime::floor(datetime, 1d)      -- Floor to day\nduration::from::days(7)        -- Create duration\n\n-- String functions\nstring::is::email($value)      -- Validate email\nstring::concat($a, ' ', $b)    -- Concatenate\nstring::split($s, ',')         -- Split to array\nstring::lowercase($s)          -- Lowercase\n\n-- Array functions\narray::len($arr)               -- Array length\narray::push($arr, $item)       -- Add to array\narray::distinct($arr)          -- Remove duplicates\narray::flatten($arr)           -- Flatten nested arrays\n\n-- Crypto functions\ncrypto::argon2::generate($password)           -- Hash password\ncrypto::argon2::compare($hash, $password)     -- Verify password\n\n-- Math functions\nmath::sum($arr)                -- Sum values\nmath::mean($arr)               -- Average\nmath::max($arr)                -- Maximum\n\n-- Record functions\nrecord::id($record)            -- Get record ID\nrecord::table($record)         -- Get table name\n\n-- Type functions\ntype::is::string($val)         -- Type check\ntype::thing($table, $id)       -- Create record ID\n```\n\n## Instructions for Writing SurrealDB Queries\n\n### Step 1: Understand the Data Model\n\nBefore writing any SurrealQL:\n\n1. **What is the data structure?** (Document, graph, relational, or hybrid?)\n2. **What relationships exist?** (One-to-many, many-to-many, graph traversals?)\n3. **What access patterns?** (Read-heavy, write-heavy, real-time?)\n4. **What consistency requirements?** (Eventual, strong, transactional?)\n\n### Step 2: Choose Schema Strategy\n\n**SCHEMAFULL** - Use when:\n- Data structure is well-defined\n- Type safety is critical\n- Validation rules are needed\n- Production workloads\n\n**SCHEMALESS** - Use when:\n- Rapid prototyping\n- Evolving data structures\n- Flexible document storage\n\n```sql\n-- SCHEMAFULL with validation\nDEFINE TABLE user SCHEMAFULL;\nDEFINE FIELD email ON user TYPE string ASSERT string::is::email($value);\nDEFINE FIELD password ON user TYPE string;\nDEFINE FIELD created_at ON user TYPE datetime DEFAULT time::now();\nDEFINE FIELD status ON user TYPE string DEFAULT 'active'\n    ASSERT $value IN ['active', 'inactive', 'suspended'];\n\n-- SCHEMALESS (flexible)\nDEFINE TABLE event SCHEMALESS;\n```\n\n### Step 3: Design Relationships\n\nChoose the right relationship model:\n\n**Record Links** - Simple, direct references:\n```sql\n-- One-to-many via array of record IDs\nCREATE user:alice SET\n    name = 'Alice',\n    friends = [user:bob, user:carol];\n\n-- Fetch with link resolution\nSELECT *, friends.* FROM user:alice;\n```\n\n**Graph Edges (RELATE)** - Complex relationships with metadata:\n```sql\n-- Create relationship with properties\nRELATE user:alice->follows->user:bob SET\n    since = time::now(),\n    notifications = true;\n\n-- Traverse graph\nSELECT\n    ->follows->user AS following,\n    <-follows<-user AS followers\nFROM user:alice;\n\n-- Multi-hop traversal\nSELECT ->follows->user->follows->user AS friends_of_friends\nFROM user:alice;\n```\n\n**Embedded Documents** - Denormalized data:\n```sql\nCREATE order SET\n    customer = { name: 'Alice', email: 'alice@example.com' },\n    items = [\n        { product: 'Widget', quantity: 2, price: 29.99 },\n        { product: 'Gadget', quantity: 1, price: 49.99 }\n    ],\n    total = 109.97;\n```\n\n### Step 4: Implement Authentication\n\n**Record-Level Access with DEFINE ACCESS:**\n```sql\n-- Define user access\nDEFINE ACCESS user_auth ON DATABASE TYPE RECORD\n    SIGNUP (\n        CREATE user SET\n            email = $email,\n            password = crypto::argon2::generate($password),\n            created_at = time::now()\n    )\n    SIGNIN (\n        SELECT * FROM user\n        WHERE email = $email\n        AND crypto::argon2::compare(password, $password)\n    )\n    DURATION FOR TOKEN 24h, FOR SESSION 7d;\n\n-- Define table permissions\nDEFINE TABLE post SCHEMAFULL\n    PERMISSIONS\n        FOR select WHERE published = true OR author = $auth.id\n        FOR create WHERE $auth.id != NONE\n        FOR update WHERE author = $auth.id\n        FOR delete WHERE author = $auth.id;\n```\n\n### Step 5: Optimize with Indexes\n\n```sql\n-- Unique index\nDEFINE INDEX unique_email ON user FIELDS email UNIQUE;\n\n-- Composite index\nDEFINE INDEX order_lookup ON order FIELDS customer, status;\n\n-- Full-text search index\nDEFINE ANALYZER english TOKENIZERS blank FILTERS lowercase, snowball(english);\nDEFINE INDEX content_search ON article FIELDS content\n    SEARCH ANALYZER english BM25;\n\n-- Verify index usage\nEXPLAIN SELECT * FROM user WHERE email = 'test@example.com';\n```\n\n### Step 6: Write Transactions\n\n```sql\nBEGIN TRANSACTION;\n\n-- Transfer funds between accounts\nLET $amount = 100;\nUPDATE account:alice SET balance -= $amount;\nUPDATE account:bob SET balance += $amount;\nCREATE transaction SET\n    from = account:alice,\n    to = account:bob,\n    amount = $amount,\n    timestamp = time::now();\n\nCOMMIT TRANSACTION;\n```\n\n## Common Query Patterns\n\n### CRUD Operations\n\n**Create with validation:**\n```sql\nCREATE user CONTENT {\n    email: 'user@example.com',\n    name: 'John Doe',\n    roles: ['user'],\n    metadata: {\n        source: 'signup',\n        ip: '192.168.1.1'\n    }\n};\n```\n\n**Select with filtering and pagination:**\n```sql\nSELECT * FROM user\nWHERE status = 'active'\n    AND created_at > time::now() - 30d\nORDER BY created_at DESC\nLIMIT 20\nSTART 0;\n```\n\n**Update with operators:**\n```sql\n-- Increment/decrement\nUPDATE user:alice SET login_count += 1;\n\n-- Array manipulation\nUPDATE user:alice SET tags += 'premium', tags -= 'trial';\n\n-- Conditional update\nUPDATE user SET status = 'inactive'\nWHERE last_login < time::now() - 90d;\n```\n\n**Upsert pattern:**\n```sql\nUPSERT user:email@example.com SET\n    email = 'email@example.com',\n    last_seen = time::now(),\n    visits += 1;\n```\n\n### Graph Queries\n\n**Social network - friends of friends:**\n```sql\nSELECT\n    id,\n    name,\n    array::distinct(->follows->user->follows->user) AS suggested_friends\nFROM user:alice\nWHERE suggested_friends != user:alice;\n```\n\n**E-commerce - product recommendations:**\n```sql\n-- Find products bought by users who bought this product\nSELECT\n    <-purchased<-user->purchased->product AS related_products,\n    count() AS frequency\nFROM product:widget123\nGROUP BY related_products\nORDER BY frequency DESC\nLIMIT 10;\n```\n\n**Knowledge graph - recursive traversal:**\n```sql\n-- Find all ancestors up to 5 levels\nSELECT\n    ->parent->(1..5)->category AS ancestors\nFROM category:electronics;\n```\n\n### Analytics Queries\n\n**Aggregations:**\n```sql\nSELECT\n    status,\n    count() AS total,\n    math::mean(age) AS avg_age,\n    math::min(created_at) AS first_created\nFROM user\nGROUP BY status;\n```\n\n**Time-series analysis:**\n```sql\nSELECT\n    time::floor(timestamp, 1h) AS hour,\n    count() AS events,\n    math::sum(value) AS total_value\nFROM metrics\nWHERE timestamp > time::now() - 24h\nGROUP BY hour\nORDER BY hour;\n```\n\n### Subqueries and Computed Fields\n\n**Subquery in SELECT:**\n```sql\nSELECT\n    *,\n    (SELECT count() FROM post WHERE author = $parent.id) AS post_count,\n    (SELECT VALUE title FROM post WHERE author = $parent.id LIMIT 5) AS recent_posts\nFROM user;\n```\n\n**LET for complex queries (CTE alternative):**\n```sql\nLET $active_users = (SELECT id FROM user WHERE status = 'active');\nLET $recent_orders = (SELECT * FROM order WHERE created_at > time::now() - 7d);\n\nSELECT * FROM $recent_orders\nWHERE customer IN $active_users.id;\n```\n\n## Schema Design Patterns\n\n### User Profile with Nested Objects\n\n```sql\nDEFINE TABLE user SCHEMAFULL;\nDEFINE FIELD email ON user TYPE string ASSERT string::is::email($value);\nDEFINE FIELD password ON user TYPE string;\nDEFINE FIELD profile ON user TYPE object;\nDEFINE FIELD profile.name ON user TYPE string;\nDEFINE FIELD profile.avatar ON user TYPE option<string>;\nDEFINE FIELD profile.bio ON user TYPE option<string>;\nDEFINE FIELD settings ON user TYPE object DEFAULT {};\nDEFINE FIELD settings.notifications ON user TYPE bool DEFAULT true;\nDEFINE FIELD settings.theme ON user TYPE string DEFAULT 'light';\nDEFINE FIELD created_at ON user TYPE datetime DEFAULT time::now();\nDEFINE FIELD updated_at ON user TYPE datetime VALUE time::now();\n\nDEFINE INDEX unique_email ON user FIELDS email UNIQUE;\n```\n\n### E-commerce Schema\n\n```sql\n-- Products\nDEFINE TABLE product SCHEMAFULL;\nDEFINE FIELD name ON product TYPE string;\nDEFINE FIELD description ON product TYPE string;\nDEFINE FIELD price ON product TYPE decimal;\nDEFINE FIELD inventory ON product TYPE int DEFAULT 0;\nDEFINE FIELD categories ON product TYPE array<record<category>>;\nDEFINE FIELD active ON product TYPE bool DEFAULT true;\n\nDEFINE INDEX product_search ON product FIELDS name, description\n    SEARCH ANALYZER blank BM25;\n\n-- Orders\nDEFINE TABLE order SCHEMAFULL;\nDEFINE FIELD customer ON order TYPE record<user>;\nDEFINE FIELD items ON order TYPE array;\nDEFINE FIELD items.*.product ON order TYPE record<product>;\nDEFINE FIELD items.*.quantity ON order TYPE int;\nDEFINE FIELD items.*.price ON order TYPE decimal;\nDEFINE FIELD status ON order TYPE string DEFAULT 'pending'\n    ASSERT $value IN ['pending', 'processing', 'shipped', 'delivered', 'cancelled'];\nDEFINE FIELD total ON order TYPE decimal;\nDEFINE FIELD created_at ON order TYPE datetime DEFAULT time::now();\n\nDEFINE INDEX order_customer ON order FIELDS customer;\nDEFINE INDEX order_status ON order FIELDS status, created_at;\n```\n\n### Graph Relationship Schema\n\n```sql\n-- Define edge table\nDEFINE TABLE follows SCHEMAFULL TYPE RELATION;\nDEFINE FIELD in ON follows TYPE record<user>;\nDEFINE FIELD out ON follows TYPE record<user>;\nDEFINE FIELD since ON follows TYPE datetime DEFAULT time::now();\nDEFINE FIELD notifications ON follows TYPE bool DEFAULT true;\n\n-- Prevent duplicate follows\nDEFINE INDEX unique_follow ON follows FIELDS in, out UNIQUE;\n```\n\n## Custom Functions\n\n```sql\n-- Calculate user engagement score\nDEFINE FUNCTION fn::engagement_score($user_id: record<user>) {\n    LET $posts = (SELECT count() FROM post WHERE author = $user_id);\n    LET $comments = (SELECT count() FROM comment WHERE author = $user_id);\n    LET $likes_received = (SELECT count() FROM like WHERE post.author = $user_id);\n\n    RETURN ($posts * 5) + ($comments * 2) + $likes_received;\n};\n\n-- Usage\nSELECT *, fn::engagement_score(id) AS score FROM user;\n\n-- Validate and normalize email\nDEFINE FUNCTION fn::normalize_email($email: string) {\n    IF !string::is::email($email) {\n        THROW \"Invalid email format\";\n    };\n    RETURN string::lowercase(string::trim($email));\n};\n\n-- Pagination helper\nDEFINE FUNCTION fn::paginate($table: string, $page: int, $per_page: int) {\n    LET $offset = ($page - 1) * $per_page;\n    RETURN (SELECT * FROM type::table($table) LIMIT $per_page START $offset);\n};\n```\n\n## Real-Time (LIVE Queries)\n\n```sql\n-- Subscribe to changes on a table\nLIVE SELECT * FROM post WHERE published = true;\n\n-- Subscribe to specific record changes\nLIVE SELECT * FROM user:alice;\n\n-- Subscribe with graph traversal\nLIVE SELECT *, ->comments->comment AS comments FROM post;\n\n-- Kill a live query\nKILL $live_query_id;\n```\n\n## Performance Best Practices\n\n### 1. Use Specific Record IDs Instead of Scans\n\n```sql\n-- FAST: Direct ID access\nSELECT * FROM user:alice;\n\n-- SLOW: Table scan\nSELECT * FROM user WHERE id = 'alice';\n```\n\n### 2. Select Only Needed Fields\n\n```sql\n-- BETTER: Specific fields\nSELECT name, email FROM user;\n\n-- AVOID: All fields when not needed\nSELECT * FROM user;\n```\n\n### 3. Use Indexes Effectively\n\n```sql\n-- Create index for common queries\nDEFINE INDEX active_users ON user FIELDS status, created_at;\n\n-- Query uses index\nSELECT * FROM user\nWHERE status = 'active'\nORDER BY created_at DESC;\n```\n\n### 4. Batch Operations\n\n```sql\n-- BETTER: Single batch insert\nINSERT INTO log [\n    { level: 'info', message: 'Start' },\n    { level: 'info', message: 'Processing' },\n    { level: 'info', message: 'Complete' }\n];\n\n-- AVOID: Multiple separate inserts\n```\n\n### 5. Use Transactions for Related Operations\n\n```sql\nBEGIN TRANSACTION;\n-- Multiple related operations\nCOMMIT TRANSACTION;\n```\n\n## Common Anti-patterns to Avoid\n\n### 1. Missing Field Existence Checks\n\n```sql\n-- WRONG: Field might not exist\nSELECT * FROM user WHERE profile.name = 'John';\n\n-- CORRECT: Check existence first (in application logic)\n-- Or use SCHEMAFULL tables with proper defaults\n```\n\n### 2. N+1 Query Problem\n\n```sql\n-- WRONG: Fetching related data in loops\n-- (in application: for each user, fetch their posts)\n\n-- CORRECT: Use record links and fetch in one query\nSELECT *, posts.* FROM user FETCH posts;\n```\n\n### 3. Not Using Appropriate Relationship Model\n\n```sql\n-- WRONG: String IDs for relationships\nCREATE user SET friend_ids = ['alice', 'bob'];\n\n-- CORRECT: Record links\nCREATE user SET friends = [user:alice, user:bob];\n```\n\n### 4. Over-fetching with Graph Traversals\n\n```sql\n-- WRONG: Unbounded traversal\nSELECT ->*->* FROM user:alice;\n\n-- CORRECT: Bounded traversal\nSELECT ->(1..3)->follows->user FROM user:alice;\n```\n\n## Debugging and Testing\n\n### Explain Query Execution\n\n```sql\nEXPLAIN SELECT * FROM user WHERE email = 'test@example.com';\nEXPLAIN FULL SELECT * FROM user WHERE email = 'test@example.com';\n```\n\n### Check Table Info\n\n```sql\nINFO FOR TABLE user;\nINFO FOR DB;\nINFO FOR NS;\n```\n\n### Test Queries with Parameters\n\n```sql\nLET $email = 'test@example.com';\nSELECT * FROM user WHERE email = $email;\n```\n\n## Output Format\n\nWhen generating SurrealDB queries, always provide:\n\n1. **Complete SurrealQL statements** with proper syntax\n2. **Schema definitions** when creating tables/fields\n3. **Index recommendations** for query patterns\n4. **Example data** for testing\n5. **Explanation** of design decisions\n6. **Performance considerations** if relevant\n\n## Reference Files\n\n- **[SurrealQL Syntax Reference](./references/surrealql_syntax.md)** - Complete language reference\n- **[Schema Patterns](./references/schema_patterns.md)** - Common schema designs\n- **[Graph Relationships](./references/graph_relationships.md)** - Relationship modeling patterns\n- **[Security & Auth](./references/security_auth.md)** - Authentication and permissions\n\n## Version Compatibility\n\n- **SurrealDB 2.x**: Latest features, GraphQL support, improved performance\n- **SurrealDB 1.x**: Legacy version, use `scope` instead of `access`\n\nAlways verify target SurrealDB version before generating queries.\n"
      },
      "plugins": [
        {
          "name": "tchen-skills",
          "description": "Tian Chen-specific skills",
          "source": "./",
          "strict": false,
          "skills": [
            "./ai-image"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add tyrchen/claude-skills",
            "/plugin install tchen-skills@tchen-skills"
          ]
        }
      ]
    }
  ]
}