{
  "author": {
    "id": "kbrockhoff",
    "display_name": "Kevin Brockhoff",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/1822996?u=bc546d5646c45beb9c0da73cf261f587289b0b31&v=4",
    "url": "https://github.com/kbrockhoff",
    "bio": "AI & Cloud Platforms Architect",
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 2,
      "total_commands": 0,
      "total_skills": 18,
      "total_stars": 0,
      "total_forks": 0
    }
  },
  "marketplaces": [
    {
      "name": "brockhoff-tools",
      "version": null,
      "description": "Git lifecycle commands for worktree-based development: status, branch, commit, sync, and PR management",
      "owner_info": {
        "name": "kbrockhoff"
      },
      "keywords": [],
      "repo_full_name": "kbrockhoff/brockhoff-tools-claude",
      "repo_url": "https://github.com/kbrockhoff/brockhoff-tools-claude",
      "repo_description": "Brockhoff Cloud Claude Plugins",
      "homepage": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-24T17:56:41Z",
        "created_at": "2026-01-03T17:51:29Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 596
        },
        {
          "path": ".claude-plugin/marketplace.json.template",
          "type": "blob",
          "size": 262
        },
        {
          "path": ".claude-plugin/settings.json",
          "type": "blob",
          "size": 29
        },
        {
          "path": "plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 381
        },
        {
          "path": "plugins/bkff-git/README.md",
          "type": "blob",
          "size": 8839
        },
        {
          "path": "plugins/bkff-git/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git/skills/git-branch",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git/skills/git-branch/SKILL.md",
          "type": "blob",
          "size": 4250
        },
        {
          "path": "plugins/bkff-git/skills/git-commit",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git/skills/git-commit/SKILL.md",
          "type": "blob",
          "size": 7598
        },
        {
          "path": "plugins/bkff-git/skills/git-pr",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git/skills/git-pr/SKILL.md",
          "type": "blob",
          "size": 15287
        },
        {
          "path": "plugins/bkff-git/skills/git-st",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git/skills/git-st/SKILL.md",
          "type": "blob",
          "size": 5795
        },
        {
          "path": "plugins/bkff-git/skills/git-sync",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff-git/skills/git-sync/SKILL.md",
          "type": "blob",
          "size": 4526
        },
        {
          "path": "plugins/bkff",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 494
        },
        {
          "path": "plugins/bkff/README.md",
          "type": "blob",
          "size": 6209
        },
        {
          "path": "plugins/bkff/agents",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/agents/adr-formatter.md",
          "type": "blob",
          "size": 4157
        },
        {
          "path": "plugins/bkff/agents/adr-validator.md",
          "type": "blob",
          "size": 4278
        },
        {
          "path": "plugins/bkff/agents/adr-writer.md",
          "type": "blob",
          "size": 4021
        },
        {
          "path": "plugins/bkff/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/cancelloop",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/cancelloop/SKILL.md",
          "type": "blob",
          "size": 4310
        },
        {
          "path": "plugins/bkff/skills/chkcompliance",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/chkcompliance/SKILL.md",
          "type": "blob",
          "size": 4279
        },
        {
          "path": "plugins/bkff/skills/fixcompliance",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/fixcompliance/SKILL.md",
          "type": "blob",
          "size": 7322
        },
        {
          "path": "plugins/bkff/skills/genreadme",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/genreadme/SKILL.md",
          "type": "blob",
          "size": 14218
        },
        {
          "path": "plugins/bkff/skills/gentests",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/gentests/SKILL.md",
          "type": "blob",
          "size": 12456
        },
        {
          "path": "plugins/bkff/skills/prfeedback",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/prfeedback/SKILL.md",
          "type": "blob",
          "size": 17027
        },
        {
          "path": "plugins/bkff/skills/startloop",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/startloop/SKILL.md",
          "type": "blob",
          "size": 9366
        },
        {
          "path": "plugins/bkff/skills/tasks2issues",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/tasks2issues/SKILL.md",
          "type": "blob",
          "size": 6756
        },
        {
          "path": "plugins/bkff/skills/verifybug",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/verifybug/SKILL.md",
          "type": "blob",
          "size": 3902
        },
        {
          "path": "plugins/bkff/skills/verifyepic",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/verifyepic/SKILL.md",
          "type": "blob",
          "size": 3408
        },
        {
          "path": "plugins/bkff/skills/verifyfeat",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/verifyfeat/SKILL.md",
          "type": "blob",
          "size": 5631
        },
        {
          "path": "plugins/bkff/skills/verifytask",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/verifytask/SKILL.md",
          "type": "blob",
          "size": 4298
        },
        {
          "path": "plugins/bkff/skills/writeadr",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/bkff/skills/writeadr/SKILL.md",
          "type": "blob",
          "size": 8431
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"brockhoff-tools\",\n  \"owner\": {\n    \"name\": \"kbrockhoff\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"bkff-git\",\n      \"source\": \"./plugins/bkff-git\",\n      \"description\": \"Git lifecycle commands for worktree-based development: status, branch, commit, sync, and PR management\"\n    },\n    {\n      \"name\": \"bkff\",\n      \"source\": \"./plugins/bkff\",\n      \"description\": \"Spec-driven development workflows: compliance checking, task-to-issue conversion, agentic development loops, verification skills, ADR generation, test generation, README generation, and PR feedback handling\"\n    }\n  ]\n}\n",
        ".claude-plugin/marketplace.json.template": "{\n  \"name\": \"{{MARKETPLACE_NAME}}\",\n  \"owner\": {\n    \"name\": \"{{OWNER_NAME}}\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"example-plugin\",\n      \"source\": \"./plugins/example-plugin\",\n      \"description\": \"Example plugin demonstrating command structure\"\n    }\n  ]\n}\n",
        ".claude-plugin/settings.json": "{\n  \"installedPlugins\": []\n}\n",
        "plugins/bkff-git/.claude-plugin/plugin.json": "{\n  \"name\": \"bkff-git\",\n  \"description\": \"Git lifecycle commands for worktree-based development: status, branch, commit, sync, and PR management\",\n  \"version\": \"0.1.0\",\n  \"author\": {\n    \"name\": \"kbrockhoff\"\n  },\n  \"repository\": \"https://github.com/kbrockhoff/brockhoff-tools-claude\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"git\", \"github\", \"worktree\", \"conventional-commits\", \"pr\"]\n}\n",
        "plugins/bkff-git/README.md": "# bkff-git Plugin\n\nGit lifecycle commands for Claude Code, designed for developers working in git worktree environments. Automates branch creation, conventional commits with GPG signing, remote synchronization, PR management, and status reporting.\n\n## Installation\n\n1. **Clone or copy** this plugin to your Claude Code plugins directory:\n   ```bash\n   # Option 1: Clone the repository\n   git clone https://github.com/kbrockhoff/brockhoff-tools-claude.git\n   cd brockhoff-tools-claude/git-plugin/plugins/bkff-git\n\n   # Option 2: Copy to your plugins directory\n   cp -r plugins/bkff-git ~/.claude/plugins/\n   ```\n\n2. **Install dependencies**:\n   ```bash\n   # Git (2.25+) - required\n   git --version  # verify >= 2.25\n\n   # GitHub CLI (2.0+) - required for PR management\n   brew install gh        # macOS\n   # apt install gh       # Debian/Ubuntu\n   gh auth login\n\n   # jq - required for JSON parsing\n   brew install jq        # macOS\n   # apt install jq       # Debian/Ubuntu\n\n   # Beads CLI - optional (features degrade gracefully without it)\n   # Install bd from the Claude Code marketplace or your organization\n   # Verify: bd --version\n   ```\n\n3. **Configure GPG signing** (required for commits):\n   ```bash\n   # Install GPG if needed\n   brew install gnupg     # macOS\n   # apt install gnupg    # Debian/Ubuntu\n\n   # Generate a GPG key if you don't have one\n   gpg --gen-key\n\n   # Get your key ID (look for \"sec\" line, use the part after the slash)\n   gpg --list-secret-keys --keyid-format=long\n\n   # Configure git to use your key\n   git config --global user.signingkey YOUR_KEY_ID\n   git config --global commit.gpgsign true\n   ```\n\n4. **Verify installation**:\n   ```bash\n   # Run the status command\n   /bkff:git-st\n   ```\n\n## Commands\n\n| Command | Priority | Description |\n|---------|----------|-------------|\n| `/bkff:git-st` | P1 | Check development status (changes, commits, tasks, PR) |\n| `/bkff:git-branch` | P2 | Create feature branch from beads issue |\n| `/bkff:git-commit` | P2 | Commit with validation, conventional message, GPG signing |\n| `/bkff:git-sync` | P3 | Sync with remote using smart rebase/merge |\n| `/bkff:git-pr` | P3 | Create or update pull request |\n\n## Command Reference\n\n### `/bkff:git-st` - Check Status\n\nDisplays comprehensive status of the current git worktree.\n\n```bash\n/bkff:git-st\n```\n\n**Output includes:**\n- Current branch and push status\n- Staged, unstaged, and untracked files\n- Last commit information\n- In-progress beads tasks\n- Pull request status (if exists)\n\n### `/bkff:git-branch` - Create Branch\n\nCreates a new branch from a beads issue with automatic prefix detection.\n\n```bash\n/bkff:git-branch <issue-id>\n```\n\n**Branch prefix logic:**\n| Issue Type | Priority | Prefix |\n|------------|----------|--------|\n| feature/task | any | `feature/` |\n| bug | P2-P4 | `bugfix/` |\n| bug | P0-P1 | `hotfix/` |\n\n**Actions:**\n1. Validates issue exists\n2. Creates worktree with new branch\n3. Pushes to origin\n4. Initializes beads database\n\n### `/bkff:git-commit` - Commit Changes\n\nValidates, stages, commits with conventional message, and pushes.\n\n```bash\n/bkff:git-commit [-m \"message\"] [--co-author \"Name <email>\"]\n```\n\n**Options:**\n- `-m`, `--message`: Override auto-generated commit message\n- `--co-author`: Add co-author attribution (format: `\"Name <email>\"`)\n\n**Actions:**\n1. Runs build validation (make lint, npm run lint, etc.)\n2. Stages all changes\n3. Generates conventional commit message\n4. Creates GPG-signed commit\n5. Pushes to origin\n\n### `/bkff:git-sync` - Sync with Remote\n\nFetches and integrates changes using smart strategy selection.\n\n```bash\n/bkff:git-sync [source-branch]\n```\n\n**Arguments:**\n- `source-branch`: Branch to sync from (default: `main`)\n\n**Strategy:**\n- **Rebase**: Used when branch not yet pushed (clean history)\n- **Merge**: Used when branch already pushed (preserve history)\n\n**Actions:**\n1. Fetches from origin\n2. Determines push status\n3. Rebases or merges from source branch\n4. Reports conflicts if any\n\n### `/bkff:git-pr` - Manage Pull Request\n\nCreates or updates a pull request for the current branch.\n\n```bash\n/bkff:git-pr [-t \"PR title\"] [-d]\n```\n\n**Options:**\n- `-t`, `--title`: Override auto-generated PR title\n- `-d`, `--draft`: Create as draft PR\n\n**Actions:**\n1. Pushes branch if needed\n2. Checks for existing PR\n3. Creates new PR or updates existing\n4. Uses PR template if available\n\n## Features\n\n- **Worktree-aware**: Designed for git worktree development workflows\n- **Conventional commits**: Auto-generates properly formatted commit messages\n- **GPG signing**: All commits are signed for security\n- **Smart sync**: Chooses rebase (unpushed) or merge (pushed) automatically\n- **Beads integration**: Links branches to beads issues for tracking\n- **PR templates**: Uses repository PR templates when available\n\n## Requirements\n\n| Dependency | Version | Purpose |\n|------------|---------|---------|\n| Git | 2.25+ | Version control |\n| GitHub CLI (`gh`) | 2.0+ | PR management |\n| `bd` (beads CLI) | any | Issue tracking |\n| `jq` | any | JSON parsing |\n| GPG | any | Commit signing |\n\n## Directory Structure\n\n```\nplugins/bkff-git/\nâ”œâ”€â”€ .claude-plugin/\nâ”‚   â””â”€â”€ plugin.json       # Plugin metadata\nâ”œâ”€â”€ skills/\nâ”‚   â”œâ”€â”€ git-st/SKILL.md        # Status command\nâ”‚   â”œâ”€â”€ git-branch/SKILL.md    # Branch command\nâ”‚   â”œâ”€â”€ git-commit/SKILL.md    # Commit command\nâ”‚   â”œâ”€â”€ git-sync/SKILL.md      # Sync command\nâ”‚   â””â”€â”€ git-pr/SKILL.md        # PR command\nâ”œâ”€â”€ lib/\nâ”‚   â”œâ”€â”€ common.sh         # Shared utilities (worktree, errors, formatting)\nâ”‚   â”œâ”€â”€ git-helpers.sh    # Git helper functions (branch status, parsing)\nâ”‚   â””â”€â”€ validation.sh     # Validation helpers (build tools, GPG)\nâ””â”€â”€ tests/\n    â”œâ”€â”€ test-helpers.sh   # Test framework\n    â””â”€â”€ test-common.sh    # Tests for common.sh\n```\n\n## Quick Start\n\n```bash\n# 1. Check current status\n/bkff:git-st\n\n# 2. Create branch for a beads issue\n/bkff:git-branch tool-abc\n\n# 3. Make your changes...\n\n# 4. Commit all changes\n/bkff:git-commit\n\n# 5. Sync with main (if needed)\n/bkff:git-sync\n\n# 6. Create/update PR\n/bkff:git-pr\n```\n\n## Troubleshooting\n\n### \"Command must be run within a git worktree\"\n\nYou're not in a git repository. Navigate to a git worktree directory:\n```bash\ncd /path/to/your/repo\n```\n\n### \"GPG signing required but unavailable\"\n\nGPG is not configured. Set up GPG signing:\n```bash\n# List your keys\ngpg --list-secret-keys --keyid-format=long\n\n# Configure git (replace KEY_ID with your key)\ngit config --global user.signingkey KEY_ID\ngit config --global commit.gpgsign true\n```\n\n### \"gh CLI not available\"\n\nInstall and authenticate GitHub CLI:\n```bash\nbrew install gh  # macOS\ngh auth login\n```\n\n### \"bd CLI not available\"\n\nThe beads CLI is not installed. Install it or the beads-related features will be skipped gracefully.\n\n### \"Push failed\"\n\nCheck your network connection and git remote configuration:\n```bash\ngit remote -v\ngit fetch origin\n```\n\n### \"Branch already exists\"\n\nThe branch name conflicts with an existing branch:\n```bash\ngit branch -a | grep <branch-name>\n```\n\n### Validation Errors\n\nIf `git-commit` reports validation errors, fix them before committing:\n```bash\n# Check what validation is running\nmake lint  # or npm run lint, cargo clippy, etc.\n```\n\n### Merge/Rebase Conflicts\n\nIf `git-sync` reports conflicts:\n1. Open conflicted files and resolve conflicts\n2. Stage resolved files: `git add <file>`\n3. Continue: `git rebase --continue` or `git commit`\n4. Or abort: `git rebase --abort` or `git merge --abort`\n\n### \"Cannot create PR from main branch\"\n\nYou're on the main/master branch. Create a feature branch first:\n```bash\n/bkff:git-branch <issue-id>\n```\n\n### \"Failed to create PR\" / GitHub Authentication\n\nGitHub CLI is not authenticated or token expired:\n```bash\ngh auth status      # Check current auth\ngh auth login       # Re-authenticate\ngh auth refresh     # Refresh token\n```\n\n### \"Issue not found\"\n\nThe beads issue ID doesn't exist. List available issues:\n```bash\nbd list --status=open\nbd search \"keyword\"\n```\n\n### \"Directory already exists\"\n\nThe worktree directory path already exists. Remove or rename it:\n```bash\nls -la ../          # Check existing directories\nrm -rf ../old-dir   # Remove if unused\n```\n\n### \"You have uncommitted changes\"\n\n`git-sync` requires a clean working directory. Commit or stash changes first:\n```bash\n/bkff:git-commit              # Commit changes\n# or\ngit stash                     # Temporarily stash\n/bkff:git-sync\ngit stash pop                 # Restore stashed changes\n```\n\n### \"Source branch not found on origin\"\n\nThe branch you're syncing from doesn't exist on the remote:\n```bash\ngit fetch origin              # Update remote refs\ngit branch -r                 # List remote branches\n/bkff:git-sync main           # Specify correct branch\n```\n",
        "plugins/bkff-git/skills/git-branch/SKILL.md": "---\nname: git-branch\ndescription: Create a new feature branch from a beads issue with proper prefix, worktree, and beads initialization\ninvocation: /bkff:git-branch\narguments:\n  - name: issue-id\n    type: string\n    required: true\n    description: Beads issue identifier (e.g., beads-042, tool-abc)\n---\n\n# Create Feature Branch\n\nCreates a new git branch and worktree from a beads issue. Automatically determines the branch type prefix based on issue type and priority, pushes to origin, and initializes beads database.\n\n## Usage\n\n```\n/bkff:git-branch <issue-id>\n```\n\n## Arguments\n\n| Argument | Required | Description |\n|----------|----------|-------------|\n| `issue-id` | Yes | Beads issue ID (e.g., `beads-042`, `tool-abc`) |\n\n## Branch Prefix Logic\n\n| Issue Type | Priority | Branch Prefix |\n|------------|----------|---------------|\n| `feature` | any | `feature/` |\n| `bug` | P2-P4 (medium-backlog) | `bugfix/` |\n| `bug` | P0-P1 (critical-high) | `hotfix/` |\n| `task` | any | `feature/` |\n\n## What It Does\n\n1. Validates the beads issue exists\n2. Determines branch prefix from issue type/priority\n3. Creates a new worktree directory (sibling to current worktree)\n4. Creates and checks out the new branch\n5. Pushes the branch to origin\n6. Initializes beads database in new worktree\n7. Syncs beads with remote\n\n## Example Output\n\n```\n## Branch Created\n\n- **Issue**: tool-abc - Implement user authentication\n- **Branch**: feature/tool-abc-implement-user-authent\n- **Worktree**: /path/to/repo/tool-abc-implement-user-\n- **Pushed**: Yes\n\nTo start working: cd /path/to/repo/tool-abc-implement-user-\n```\n\n## Requirements\n\n- Must be run inside a git worktree\n- `git` CLI for branch and worktree operations\n- `bd` CLI for issue retrieval and beads initialization\n- `jq` for JSON parsing\n\n## Error Cases\n\n- **Invalid issue ID**: Shows list of valid open issues\n- **Branch already exists**: Error with existing branch name\n- **Worktree path exists**: Error with existing directory path\n- **Push failed**: Warning (branch still created locally)\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/git-helpers.sh\"\n\nrequire_worktree\n\nISSUE_ID=\"${1:-}\"\n[[ -z \"$ISSUE_ID\" ]] && error_exit \"Usage: git-branch <issue-id>\"\n\ncommand -v bd &>/dev/null || error_exit \"bd CLI required\"\n\nISSUE_JSON=$(bd show \"$ISSUE_ID\" --json 2>/dev/null) || {\n    echo \"Error: Issue '$ISSUE_ID' not found.\" >&2\n    bd list --status=open --limit=10 2>/dev/null >&2\n    exit 1\n}\n\nISSUE_TITLE=$(echo \"$ISSUE_JSON\" | jq -r '.title // empty')\nISSUE_TYPE=$(echo \"$ISSUE_JSON\" | jq -r '.issue_type // \"task\"')\nISSUE_PRIORITY=$(echo \"$ISSUE_JSON\" | jq -r '.priority // 2')\n\ncase \"$ISSUE_TYPE\" in\n    bug) [[ \"$ISSUE_PRIORITY\" -le 1 ]] && BRANCH_PREFIX=\"hotfix\" || BRANCH_PREFIX=\"bugfix\" ;;\n    *) BRANCH_PREFIX=\"feature\" ;;\nesac\n\nSANITIZED=$(echo \"$ISSUE_TITLE\" | tr '[:upper:]' '[:lower:]' | sed 's/[^a-z0-9]/-/g' | tr -s '-' | cut -c1-30)\nBRANCH_NAME=\"${BRANCH_PREFIX}/${ISSUE_ID}-${SANITIZED}\"\n\ngit rev-parse --verify \"$BRANCH_NAME\" &>/dev/null && error_exit \"Branch '$BRANCH_NAME' already exists\"\n\nWORKTREE_BASE=$(dirname \"$(get_worktree_path)\")\nWORKTREE_DIR=\"${WORKTREE_BASE}/${ISSUE_ID}-$(echo \"$ISSUE_TITLE\" | tr '[:upper:]' '[:lower:]' | sed 's/[^a-z0-9]/-/g' | tr -s '-' | cut -c1-20)\"\n\n[[ -d \"$WORKTREE_DIR\" ]] && error_exit \"Directory '$WORKTREE_DIR' already exists\"\n\nMAIN_BRANCH=$(get_main_branch)\ninfo \"Creating worktree for $ISSUE_ID...\"\ngit worktree add -b \"$BRANCH_NAME\" \"$WORKTREE_DIR\" \"$MAIN_BRANCH\" || error_exit \"Failed to create worktree\"\nsuccess \"Created worktree at $WORKTREE_DIR\"\n\ninfo \"Pushing branch to origin...\"\n(cd \"$WORKTREE_DIR\" && git push -u origin \"$BRANCH_NAME\") || warn \"Push failed\"\nPUSH_STATUS=\"${PUSH_STATUS:-Yes}\"\n\ninfo \"Initializing beads...\"\n(cd \"$WORKTREE_DIR\" && bd init && bd sync) 2>/dev/null || warn \"Beads init/sync failed\"\n\necho \"\"\necho \"## Branch Created\"\necho \"- **Issue**: $ISSUE_ID - $ISSUE_TITLE\"\necho \"- **Branch**: $BRANCH_NAME\"\necho \"- **Worktree**: $WORKTREE_DIR\"\necho \"- **Pushed**: $PUSH_STATUS\"\necho \"\"\necho \"To start working: cd $WORKTREE_DIR\"\n```\n",
        "plugins/bkff-git/skills/git-commit/SKILL.md": "---\nname: git-commit\ndescription: Commit all changes with validation, conventional commit message, GPG signing, and push to origin\ninvocation: /bkff:git-commit\narguments:\n  - name: --message\n    type: string\n    required: false\n    description: Override auto-generated commit message\n  - name: --co-author\n    type: string\n    required: false\n    description: Add co-author attribution (format \"Name <email>\")\n---\n\n# Commit Changes\n\nValidates changes, stages all new and modified files, generates a conventional commit message, creates a GPG-signed commit, and pushes to origin.\n\n## Usage\n\n```\n/bkff:git-commit [--message \"custom message\"] [--co-author \"Name <email>\"]\n```\n\n## Options\n\n| Option | Description |\n|--------|-------------|\n| `--message` | Override the auto-generated commit message |\n| `--co-author` | Add a co-author to the commit |\n\n## What It Does\n\n1. Validates changes using build tool (make lint, npm run lint, etc.)\n2. Halts if validation fails with error details\n3. Stages all changes (`git add -A`)\n4. Analyzes changes to generate conventional commit type and scope\n5. Creates a GPG-signed commit\n6. Pushes to origin\n\n## Conventional Commit Types\n\n| Change Pattern | Generated Type |\n|----------------|----------------|\n| New files in `src/` | `feat` |\n| Bug fixes, modifications | `fix` |\n| Refactoring | `refactor` |\n| Test file changes only | `test` |\n| Documentation changes | `docs` |\n| Build/config changes | `build` |\n\n## Example Output\n\n```\n## Commit Created\n\n### Validation\n- âœ“ Build tool validation passed\n\n### Changes Committed\n- **Files**: 3 files changed\n  - M src/auth.ts\n  - A src/utils.ts\n  - M README.md\n\n### Commit\n- **Hash**: abc1234\n- **Message**: feat(auth): implement login functionality\n- **Signed**: Yes\n\n### Push\n- **Status**: Success\n```\n\n## Requirements\n\n- Must be run inside a git worktree\n- `git` CLI for commit and push\n- GPG configured for commit signing\n- Build tool with validate/lint target (optional)\n\n## Error Cases\n\n- **No changes**: \"Nothing to commit\"\n- **Validation failed**: Shows lint/test errors\n- **GPG unavailable**: Error with configuration instructions\n- **Push failed**: Commit preserved locally, retry instructions\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/git-helpers.sh\"\nsource \"$PLUGIN_DIR/lib/validation.sh\"\n\n# Parse arguments\nCUSTOM_MESSAGE=\"\"\nCO_AUTHOR=\"\"\nwhile [[ $# -gt 0 ]]; do\n    case \"$1\" in\n        --message|-m)\n            CUSTOM_MESSAGE=\"$2\"\n            shift 2\n            ;;\n        --co-author)\n            CO_AUTHOR=\"$2\"\n            shift 2\n            ;;\n        *)\n            shift\n            ;;\n    esac\ndone\n\nrequire_worktree\n\n# Check for changes\nif ! has_changes; then\n    info \"Nothing to commit. Working directory is clean.\"\n    exit 0\nfi\n\necho \"## Commit Process\"\necho \"\"\n\n# FR-012, FR-013: Run validation\necho \"### Validation\"\nif has_validate_target; then\n    if run_validation; then\n        echo \"- âœ“ Build tool validation passed\"\n    else\n        echo \"- âœ— Build tool validation failed\"\n        echo \"\"\n        error_exit \"Fix validation errors before committing.\"\n    fi\nelse\n    echo \"- âŠ˜ No validation target found (skipped)\"\nfi\necho \"\"\n\n# FR-016: Check GPG signing availability\nif ! has_signing_available; then\n    error_exit \"GPG signing required but unavailable. Configure GPG key first:\\n  git config --global user.signingkey <KEY_ID>\\n  git config --global commit.gpgsign true\"\nfi\n\n# FR-014: Stage all changes\ninfo \"Staging all changes...\"\ngit add -A\n\n# Get list of staged files for display and analysis\nSTAGED_FILES=$(git diff --cached --name-status)\nSTAGED_COUNT=$(echo \"$STAGED_FILES\" | grep -c '^' || echo \"0\")\n\necho \"### Changes to Commit\"\necho \"- **Files**: $STAGED_COUNT files\"\necho \"$STAGED_FILES\" | while IFS=$'\\t' read -r status file; do\n    printf \"  - %s %s\\n\" \"$status\" \"$file\"\ndone\necho \"\"\n\n# FR-015: Generate conventional commit message\ngenerate_commit_type() {\n    local files=\"$1\"\n\n    # Check for new files (feat)\n    if echo \"$files\" | grep -q '^A'; then\n        # New source files = feat\n        if echo \"$files\" | grep -qE '^A.*\\.(ts|js|py|go|rs|java|sh)$'; then\n            echo \"feat\"\n            return\n        fi\n    fi\n\n    # Check for test files only\n    if echo \"$files\" | grep -qE 'test|spec' && ! echo \"$files\" | grep -vqE 'test|spec'; then\n        echo \"test\"\n        return\n    fi\n\n    # Check for docs only\n    if echo \"$files\" | grep -qE '\\.(md|txt|rst)$' && ! echo \"$files\" | grep -vqE '\\.(md|txt|rst)$'; then\n        echo \"docs\"\n        return\n    fi\n\n    # Check for build/config files\n    if echo \"$files\" | grep -qE '(Makefile|package\\.json|Cargo\\.toml|\\.yml|\\.yaml)'; then\n        echo \"build\"\n        return\n    fi\n\n    # Default to fix for modifications\n    echo \"fix\"\n}\n\ngenerate_scope() {\n    local files=\"$1\"\n\n    # Extract common directory from changed files\n    local first_dir\n    first_dir=$(echo \"$files\" | head -1 | awk -F'\\t' '{print $2}' | cut -d'/' -f1)\n\n    # If it's a known directory, use it as scope\n    case \"$first_dir\" in\n        src|lib|pkg|cmd|internal)\n            # Get the next level directory as scope\n            local scope\n            scope=$(echo \"$files\" | head -1 | awk -F'\\t' '{print $2}' | cut -d'/' -f2)\n            if [[ -n \"$scope\" && \"$scope\" != *.* ]]; then\n                echo \"$scope\"\n                return\n            fi\n            ;;\n        skills|plugins|commands)\n            echo \"$first_dir\"\n            return\n            ;;\n    esac\n\n    echo \"\"\n}\n\ngenerate_description() {\n    local commit_type=\"$1\"\n    local files=\"$2\"\n\n    # Get the first changed file for context\n    local first_file\n    first_file=$(echo \"$files\" | head -1 | awk -F'\\t' '{print $2}' | xargs basename 2>/dev/null || echo \"files\")\n    first_file=\"${first_file%.*}\"  # Remove extension\n\n    case \"$commit_type\" in\n        feat) echo \"add ${first_file} functionality\" ;;\n        fix) echo \"update ${first_file}\" ;;\n        docs) echo \"update documentation\" ;;\n        test) echo \"update tests\" ;;\n        build) echo \"update build configuration\" ;;\n        *) echo \"update ${first_file}\" ;;\n    esac\n}\n\nif [[ -n \"$CUSTOM_MESSAGE\" ]]; then\n    COMMIT_MSG=\"$CUSTOM_MESSAGE\"\nelse\n    COMMIT_TYPE=$(generate_commit_type \"$STAGED_FILES\")\n    COMMIT_SCOPE=$(generate_scope \"$STAGED_FILES\")\n    COMMIT_DESC=$(generate_description \"$COMMIT_TYPE\" \"$STAGED_FILES\")\n\n    if [[ -n \"$COMMIT_SCOPE\" ]]; then\n        COMMIT_MSG=\"${COMMIT_TYPE}(${COMMIT_SCOPE}): ${COMMIT_DESC}\"\n    else\n        COMMIT_MSG=\"${COMMIT_TYPE}: ${COMMIT_DESC}\"\n    fi\nfi\n\n# Add co-author if specified\nif [[ -n \"$CO_AUTHOR\" ]]; then\n    COMMIT_MSG=\"${COMMIT_MSG}\n\nCo-authored-by: ${CO_AUTHOR}\"\nfi\n\n# FR-016: Create signed commit\ninfo \"Creating signed commit...\"\nif git commit -S -m \"$COMMIT_MSG\"; then\n    COMMIT_HASH=$(git rev-parse --short HEAD)\n    success \"Commit created: $COMMIT_HASH\"\nelse\n    error_exit \"Failed to create commit\"\nfi\n\necho \"\"\necho \"### Commit\"\necho \"- **Hash**: $COMMIT_HASH\"\necho \"- **Message**: $(echo \"$COMMIT_MSG\" | head -1)\"\necho \"- **Signed**: Yes\"\n[[ -n \"$CO_AUTHOR\" ]] && echo \"- **Co-Author**: $CO_AUTHOR\"\necho \"\"\n\n# FR-017: Push to origin\necho \"### Push\"\ninfo \"Pushing to origin...\"\nif git push; then\n    echo \"- **Status**: Success\"\n    echo \"\"\n    success \"Commit pushed to origin.\"\nelse\n    warn \"Push failed (commit preserved locally)\"\n    echo \"- **Status**: Failed\"\n    echo \"\"\n    echo \"Run 'git push' to retry.\"\nfi\n```\n",
        "plugins/bkff-git/skills/git-pr/SKILL.md": "---\nname: git-pr\ndescription: Create or update a pull request for the current branch\ninvocation: /bkff:git-pr\narguments:\n  - name: --title\n    type: string\n    required: false\n    description: Override auto-generated PR title\n  - name: --draft\n    type: flag\n    required: false\n    description: Create as draft PR\n  - name: --ready\n    type: flag\n    required: false\n    description: Mark draft PR as ready for review\n  - name: --comments\n    type: flag\n    required: false\n    description: Retrieve and display PR review comments\n  - name: --analyze\n    type: flag\n    required: false\n    description: Analyze comments for requirements compliance (requires --comments)\n---\n\n# Manage Pull Request\n\nCreates or updates a pull request for the current branch. Uses the repository's PR template if available, or generates a default description.\n\n## Usage\n\n```\n/bkff:git-pr [--title \"PR title\"] [--draft] [--ready] [--comments] [--analyze]\n```\n\n## Options\n\n| Option | Description |\n|--------|-------------|\n| `--title` | Override the auto-generated PR title |\n| `--draft` | Create as a draft pull request |\n| `--ready` | Mark existing draft PR as ready for review |\n| `--comments` | Retrieve and display PR review comments |\n| `--analyze` | Analyze comments for requirements compliance (requires `--comments`) |\n\n## What It Does\n\n1. Checks if PR already exists for branch\n2. Pushes branch to origin if needed\n3. Creates new PR or updates existing one\n4. Uses PR template if available\n\n## Example Output\n\n```\n## Pull Request Created\n\n### Branch\n- **Head**: feature/auth-login\n- **Base**: main\n\n### Pull Request\n- **Number**: #123\n- **Title**: feat(auth): implement user authentication\n- **URL**: https://github.com/owner/repo/pull/123\n```\n\n## Requirements\n\n- Must be run inside a git worktree\n- `git` CLI for branch operations\n- `gh` CLI for PR creation (authenticated)\n- Cannot be on main/master branch\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/git-helpers.sh\"\nsource \"$PLUGIN_DIR/lib/pr-analysis.sh\"\n\n# Parse arguments\nCUSTOM_TITLE=\"\"\nDRAFT_FLAG=\"\"\nREADY_FLAG=\"\"\nCOMMENTS_FLAG=\"\"\nANALYZE_FLAG=\"\"\nwhile [[ $# -gt 0 ]]; do\n    case \"$1\" in\n        --title|-t)\n            CUSTOM_TITLE=\"$2\"\n            shift 2\n            ;;\n        --draft|-d)\n            DRAFT_FLAG=\"--draft\"\n            shift\n            ;;\n        --ready|-r)\n            READY_FLAG=\"true\"\n            shift\n            ;;\n        --comments|-c)\n            COMMENTS_FLAG=\"true\"\n            shift\n            ;;\n        --analyze|-a)\n            ANALYZE_FLAG=\"true\"\n            shift\n            ;;\n        *)\n            shift\n            ;;\n    esac\ndone\n\n# FR-040: Validate --analyze requires --comments\nif [[ -n \"$ANALYZE_FLAG\" && -z \"$COMMENTS_FLAG\" ]]; then\n    error_exit \"--analyze requires --comments flag\"\nfi\n\nrequire_worktree\n\n# Check if gh is available\ncommand -v gh &>/dev/null || error_exit \"gh CLI required but not installed\"\n\nCURRENT_BRANCH=$(get_current_branch)\nMAIN_BRANCH=$(get_main_branch)\n\n# FR-033: Cannot create PR from main branch\nif [[ \"$CURRENT_BRANCH\" == \"$MAIN_BRANCH\" || \"$CURRENT_BRANCH\" == \"master\" ]]; then\n    error_exit \"Cannot create PR from $CURRENT_BRANCH branch\"\nfi\n\n# FR-035: Handle --ready flag to mark draft PR as ready for review\nif [[ -n \"$READY_FLAG\" ]]; then\n    # Check if PR exists\n    EXISTING_PR=$(gh pr list --head \"$CURRENT_BRANCH\" --json number,url,title,isDraft --jq '.[0]' 2>/dev/null || echo \"\")\n\n    if [[ -z \"$EXISTING_PR\" ]]; then\n        error_exit \"No PR exists for this branch. Create one first.\"\n    fi\n\n    PR_NUMBER=$(echo \"$EXISTING_PR\" | jq -r '.number')\n    PR_URL=$(echo \"$EXISTING_PR\" | jq -r '.url')\n    PR_TITLE=$(echo \"$EXISTING_PR\" | jq -r '.title')\n    IS_DRAFT=$(echo \"$EXISTING_PR\" | jq -r '.isDraft')\n\n    if [[ \"$IS_DRAFT\" == \"true\" ]]; then\n        # Mark as ready using gh pr ready\n        if gh pr ready \"$PR_NUMBER\" 2>/dev/null; then\n            echo \"## Pull Request Ready for Review\"\n            echo \"\"\n            echo \"### Pull Request\"\n            echo \"- **Number**: #$PR_NUMBER\"\n            echo \"- **Title**: $PR_TITLE\"\n            echo \"- **Status**: Open (was Draft)\"\n            echo \"- **URL**: $PR_URL\"\n            echo \"\"\n            success \"PR is now ready for review.\"\n        else\n            error_exit \"Failed to mark PR as ready. Check GitHub authentication.\"\n        fi\n    else\n        # FR-036: Handle --ready on already-ready PR\n        echo \"## Pull Request Already Ready\"\n        echo \"\"\n        echo \"### Pull Request\"\n        echo \"- **Number**: #$PR_NUMBER\"\n        echo \"- **Title**: $PR_TITLE\"\n        echo \"- **Status**: Open\"\n        echo \"\"\n        info \"PR is already ready for review. No changes made.\"\n    fi\n    exit 0\nfi\n\n# FR-037: Handle --comments flag to retrieve PR review comments\nif [[ -n \"$COMMENTS_FLAG\" ]]; then\n    # Check if PR exists\n    EXISTING_PR=$(gh pr list --head \"$CURRENT_BRANCH\" --json number,url --jq '.[0]' 2>/dev/null || echo \"\")\n\n    if [[ -z \"$EXISTING_PR\" ]]; then\n        error_exit \"No PR exists for this branch.\"\n    fi\n\n    PR_NUMBER=$(echo \"$EXISTING_PR\" | jq -r '.number')\n\n    # Get repository info for API calls\n    REPO_INFO=$(gh repo view --json owner,name --jq '\"\\(.owner.login)/\\(.name)\"') || error_exit \"Failed to get repository info. Check network connection.\"\n\n    # T084: Fetch review comments with network failure handling\n    API_ERROR=\"\"\n    REVIEW_COMMENTS=$(gh api \"repos/$REPO_INFO/pulls/$PR_NUMBER/comments\" 2>&1) || API_ERROR=\"$REVIEW_COMMENTS\"\n    if [[ -n \"$API_ERROR\" ]]; then\n        if [[ \"$API_ERROR\" == *\"connect\"* ]] || [[ \"$API_ERROR\" == *\"network\"* ]] || [[ \"$API_ERROR\" == *\"timeout\"* ]]; then\n            error_exit \"Network error fetching PR comments. Check your internet connection.\"\n        elif [[ \"$API_ERROR\" == *\"404\"* ]]; then\n            REVIEW_COMMENTS=\"[]\"\n        else\n            warn \"Failed to fetch review comments: $API_ERROR\"\n            REVIEW_COMMENTS=\"[]\"\n        fi\n    fi\n\n    # T084: Fetch issue comments with network failure handling\n    API_ERROR=\"\"\n    ISSUE_COMMENTS=$(gh api \"repos/$REPO_INFO/issues/$PR_NUMBER/comments\" 2>&1) || API_ERROR=\"$ISSUE_COMMENTS\"\n    if [[ -n \"$API_ERROR\" ]]; then\n        if [[ \"$API_ERROR\" == *\"connect\"* ]] || [[ \"$API_ERROR\" == *\"network\"* ]] || [[ \"$API_ERROR\" == *\"timeout\"* ]]; then\n            error_exit \"Network error fetching PR comments. Check your internet connection.\"\n        elif [[ \"$API_ERROR\" == *\"404\"* ]]; then\n            ISSUE_COMMENTS=\"[]\"\n        else\n            warn \"Failed to fetch issue comments: $API_ERROR\"\n            ISSUE_COMMENTS=\"[]\"\n        fi\n    fi\n\n    # Count total comments\n    REVIEW_COUNT=$(echo \"$REVIEW_COMMENTS\" | jq 'length')\n    ISSUE_COUNT=$(echo \"$ISSUE_COMMENTS\" | jq 'length')\n    TOTAL_COMMENTS=$((REVIEW_COUNT + ISSUE_COUNT))\n\n    # FR-040: Adjust header for analysis mode\n    if [[ -n \"$ANALYZE_FLAG\" ]]; then\n        echo \"## Review Comments Analysis for PR #$PR_NUMBER\"\n    else\n        echo \"## Review Comments for PR #$PR_NUMBER\"\n    fi\n    echo \"\"\n\n    # FR-039: Handle no comments case\n    if [[ \"$TOTAL_COMMENTS\" -eq 0 ]]; then\n        info \"No review comments exist for this pull request.\"\n        exit 0\n    fi\n\n    # FR-044: Detect spec file for analysis\n    SPEC_FILE=\"\"\n    if [[ -n \"$ANALYZE_FLAG\" ]]; then\n        SPEC_FILE=$(detect_spec_file \"$CURRENT_BRANCH\")\n    fi\n\n    # FR-038: Calculate reviewer attribution\n    ALL_REVIEWERS=$(echo \"$REVIEW_COMMENTS $ISSUE_COMMENTS\" | jq -s 'add | [.[].user.login] | group_by(.) | map({user: .[0], count: length}) | sort_by(-.count)')\n    REVIEWER_SUMMARY=$(echo \"$ALL_REVIEWERS\" | jq -r 'map(\"@\\(.user) (\\(.count))\") | join(\", \")')\n\n    echo \"### Summary\"\n    echo \"- **Total Comments**: $TOTAL_COMMENTS\"\n    echo \"- **Reviewers**: $REVIEWER_SUMMARY\"\n\n    # Analysis-specific summary\n    if [[ -n \"$ANALYZE_FLAG\" ]]; then\n        if [[ -n \"$SPEC_FILE\" ]]; then\n            echo \"- **Spec File**: Found ($(basename \"$(dirname \"$SPEC_FILE\")\")/spec.md)\"\n        else\n            echo \"- **Spec File**: Not found (evaluating against general principles)\"\n        fi\n    fi\n    echo \"\"\n\n    echo \"### Comments\"\n    echo \"\"\n\n    # Track high-priority comments for recommendation\n    declare -a PRIORITY_COMMENTS=()\n\n    # Function to display a comment with optional analysis\n    display_comment() {\n        local user=\"$1\"\n        local location=\"$2\"\n        local body=\"$3\"\n\n        echo \"#### @$user on $location\"\n        echo \"> ${body//$'\\n'/$'\\n'> }\"\n        echo \"\"\n\n        if [[ -n \"$ANALYZE_FLAG\" ]]; then\n            # FR-041: Compliance probability scoring\n            local category\n            category=$(categorize_comment \"$body\" \"$SPEC_FILE\")\n            local score\n            score=$(estimate_compliance_score \"$body\" \"$category\")\n\n            echo \"**Compliance Score**: $score\"\n            echo \"**Category**: $category\"\n\n            # FR-042: Rationale generation\n            local rationale=\"\"\n            case \"$category\" in\n                \"Security-Related\")\n                    rationale=\"Addresses security best practices or vulnerability prevention.\"\n                    ;;\n                \"Requirements-Related\")\n                    if [[ -n \"$SPEC_FILE\" ]]; then\n                        rationale=\"May relate to functional requirements in spec file.\"\n                    else\n                        rationale=\"Substantive feedback that may impact functionality.\"\n                    fi\n                    ;;\n                \"Stylistic/Preference\")\n                    rationale=\"Code style or naming suggestion. No impact on requirements compliance.\"\n                    ;;\n                \"General Feedback\")\n                    rationale=\"Summary or approval comment without actionable code change.\"\n                    ;;\n            esac\n            echo \"**Rationale**: $rationale\"\n\n            # Track high-priority comments (score >= 80)\n            if [[ \"$score\" != \"N/A\" && \"$score\" -ge 80 ]]; then\n                PRIORITY_COMMENTS+=(\"$location ($score% - $category)\")\n            fi\n        fi\n\n        echo \"\"\n        echo \"---\"\n        echo \"\"\n    }\n\n    # Display review comments (line-specific)\n    if [[ \"$REVIEW_COUNT\" -gt 0 ]]; then\n        while IFS= read -r comment_json; do\n            user=$(echo \"$comment_json\" | jq -r '.user.login')\n            path=$(echo \"$comment_json\" | jq -r '.path')\n            line=$(echo \"$comment_json\" | jq -r '.line // .original_line // \"N/A\"')\n            body=$(echo \"$comment_json\" | jq -r '.body')\n            display_comment \"$user\" \"$path:$line\" \"$body\"\n        done < <(echo \"$REVIEW_COMMENTS\" | jq -c '.[]')\n    fi\n\n    # Display issue comments (general)\n    if [[ \"$ISSUE_COUNT\" -gt 0 ]]; then\n        while IFS= read -r comment_json; do\n            user=$(echo \"$comment_json\" | jq -r '.user.login')\n            body=$(echo \"$comment_json\" | jq -r '.body')\n            display_comment \"$user\" \"(general)\" \"$body\"\n        done < <(echo \"$ISSUE_COMMENTS\" | jq -c '.[]')\n    fi\n\n    # FR-081: Analysis summary with priority recommendations\n    if [[ -n \"$ANALYZE_FLAG\" && ${#PRIORITY_COMMENTS[@]} -gt 0 ]]; then\n        echo \"### Recommendation\"\n        echo \"**Priority comments to address**:\"\n        local i=1\n        for comment in \"${PRIORITY_COMMENTS[@]}\"; do\n            echo \"$i. $comment\"\n            ((i++))\n        done\n        echo \"\"\n    fi\n\n    exit 0\nfi\n\n# FR-034: Adjust header for draft PRs\nif [[ -n \"$DRAFT_FLAG\" ]]; then\n    echo \"## Draft Pull Request Created\"\nelse\n    echo \"## Pull Request\"\nfi\necho \"\"\n\n# FR-024: Check if PR already exists\necho \"### Branch\"\necho \"- **Head**: $CURRENT_BRANCH\"\necho \"- **Base**: $MAIN_BRANCH\"\n\nEXISTING_PR=$(gh pr list --head \"$CURRENT_BRANCH\" --json number,url --jq '.[0]' 2>/dev/null || echo \"\")\n\n# FR-028: Ensure branch is pushed\nif ! is_branch_pushed \"$CURRENT_BRANCH\"; then\n    info \"Pushing branch to origin...\"\n    if git push -u origin \"$CURRENT_BRANCH\"; then\n        echo \"- **Pushed**: Yes (just pushed)\"\n    else\n        error_exit \"Failed to push branch. Check network connection.\"\n    fi\nelse\n    # Check if we're ahead of origin\n    AHEAD=$(get_ahead_count \"$CURRENT_BRANCH\")\n    if [[ \"$AHEAD\" -gt 0 ]]; then\n        info \"Pushing $AHEAD new commits...\"\n        git push || warn \"Push failed\"\n    fi\n    echo \"- **Pushed**: Yes\"\nfi\necho \"\"\n\n# Generate PR title from commits if not provided\nif [[ -z \"$CUSTOM_TITLE\" ]]; then\n    # Use first commit message as title\n    CUSTOM_TITLE=$(git log \"$MAIN_BRANCH..HEAD\" --format=\"%s\" | tail -1)\nfi\n\n# FR-027: Check for PR template\nTEMPLATE_FILE=\"\"\nfor tmpl in .github/pull_request_template.md .github/PULL_REQUEST_TEMPLATE.md PULL_REQUEST_TEMPLATE.md; do\n    if [[ -f \"$tmpl\" ]]; then\n        TEMPLATE_FILE=\"$tmpl\"\n        break\n    fi\ndone\n\n# Generate PR body\ngenerate_pr_body() {\n    echo \"## Summary\"\n    echo \"\"\n    git log \"$MAIN_BRANCH..HEAD\" --format=\"- %s\" | tac\n    echo \"\"\n    echo \"## Test Plan\"\n    echo \"\"\n    echo \"- [ ] Unit tests pass\"\n    echo \"- [ ] Manual testing completed\"\n    echo \"\"\n    echo \"---\"\n    echo \"\"\n    echo \"ðŸ¤– Generated with [Claude Code](https://claude.ai/code)\"\n}\n\nif [[ -n \"$EXISTING_PR\" ]]; then\n    # FR-025: Update existing PR\n    PR_NUMBER=$(echo \"$EXISTING_PR\" | jq -r '.number')\n    PR_URL=$(echo \"$EXISTING_PR\" | jq -r '.url')\n\n    echo \"### Pull Request (Existing)\"\n    echo \"- **Number**: #$PR_NUMBER\"\n    echo \"- **Status**: Updated\"\n    echo \"- **URL**: $PR_URL\"\n    echo \"\"\n    success \"PR already exists. Branch pushed with latest changes.\"\nelse\n    # FR-026: Create new PR\n    echo \"### Pull Request\"\n    info \"Creating pull request...\"\n\n    # Build gh pr create command using array for safe argument handling\n    CREATE_ARGS=('--title' \"$CUSTOM_TITLE\" '--base' \"$MAIN_BRANCH\")\n    [[ -n \"$DRAFT_FLAG\" ]] && CREATE_ARGS+=('--draft')\n\n    # FR-027: Only provide --body if no template file exists\n    # gh pr create automatically uses PR template when found and --body is not provided\n    if [[ -z \"$TEMPLATE_FILE\" ]]; then\n        PR_BODY=$(generate_pr_body)\n        CREATE_ARGS+=('--body' \"$PR_BODY\")\n    fi\n\n    if PR_URL=$(gh pr create \"${CREATE_ARGS[@]}\" 2>&1); then\n        PR_NUMBER=$(echo \"$PR_URL\" | grep -oE '[0-9]+$' || echo \"\")\n        echo \"- **Number**: #$PR_NUMBER\"\n        echo \"- **Title**: $CUSTOM_TITLE\"\n        [[ -n \"$DRAFT_FLAG\" ]] && echo \"- **Status**: Draft (not ready for review)\" || echo \"- **Status**: Open\"\n        echo \"- **URL**: $PR_URL\"\n        [[ -n \"$TEMPLATE_FILE\" ]] && echo \"- **Template**: Used $TEMPLATE_FILE\"\n        echo \"\"\n\n        # Display commits included in the PR\n        echo \"### Commits Included\"\n        git log \"$MAIN_BRANCH..HEAD\" --format=\"%s\" | tac | nl -w1 -s'. '\n        echo \"\"\n\n        # FR-034: Different success message for draft PRs\n        if [[ -n \"$DRAFT_FLAG\" ]]; then\n            success \"Draft PR created. Use \\`/bkff:git-pr --ready\\` when ready for review.\"\n        else\n            success \"PR created successfully. Awaiting review.\"\n        fi\n    else\n        error_exit \"Failed to create PR. Check GitHub authentication.\\n$PR_URL\"\n    fi\nfi\n```\n",
        "plugins/bkff-git/skills/git-st/SKILL.md": "---\nname: git-st\ndescription: Check development status - uncommitted changes, last commit, beads tasks, and PR status\ninvocation: /bkff:git-st\narguments: []\n---\n\n# Git Status Check\n\nDisplays comprehensive status of the current git worktree including:\n- Uncommitted changes (staged and unstaged)\n- Last commit information\n- In-progress beads tasks\n- Pull request status\n\n## Usage\n\n```\n/bkff:git-st\n```\n\nNo arguments required. Operates on the current working directory.\n\n## Output Sections\n\n### Working Directory\nShows the current branch name and a summary of changes:\n- Number of staged files\n- Number of unstaged files\n- Number of untracked files\n\n### Staged/Unstaged Changes\nLists files with their status:\n- `A` - Added (new file)\n- `M` - Modified\n- `D` - Deleted\n- `R` - Renamed\n- `?` - Untracked\n\n### Last Commit\nShows information about the most recent commit:\n- Short hash\n- Commit message\n- Author name\n- Relative date\n\n### Beads Task\nShows any in-progress beads issues associated with the current work.\n\n### Pull Request\nIf a PR exists for the current branch, shows:\n- PR number and title\n- Status (open/closed/merged)\n- Check status (passing/failing/pending)\n- URL link\n\n## Requirements\n\n- Must be run inside a git worktree\n- `git` CLI for status and commit info\n- `gh` CLI for PR status (optional - graceful fallback)\n- `bd` CLI for beads task status (optional - graceful fallback)\n\n## Examples\n\n### With Changes\n```\n## Git Status\n\n### Working Directory\n- **Branch**: feature/auth-login\n- **Status**: 3 files changed (2 staged, 1 unstaged)\n\n### Staged Changes\n  A  src/new-file.ts\n  M  src/auth.ts\n\n### Unstaged Changes\n  M  README.md\n\n### Last Commit\n- **Hash**: abc1234\n- **Message**: feat(auth): add login endpoint\n- **Date**: 2 hours ago\n\n### Pull Request\n- **PR #42**: Add authentication feature\n- **Status**: Open (checks passing)\n```\n\n### Clean State\n```\n## Git Status\n\n### Working Directory\n- **Branch**: main\n- **Status**: Clean (no uncommitted changes)\n\n### Last Commit\n- **Hash**: def5678\n- **Message**: chore: update dependencies\n- **Date**: 1 day ago\n\n### Pull Request\n- No PR exists for this branch\n```\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/git-helpers.sh\"\n\nrequire_worktree\n\necho \"## Git Status\"\necho \"\"\n\n# Working Directory\nbranch=$(get_current_branch)\nstaged=$(git diff --cached --name-only 2>/dev/null | wc -l | tr -d ' ')\nunstaged=$(git diff --name-only 2>/dev/null | wc -l | tr -d ' ')\nuntracked=$(git ls-files --others --exclude-standard 2>/dev/null | wc -l | tr -d ' ')\ntotal=$((staged + unstaged + untracked))\n\necho \"### Working Directory\"\necho \"- **Branch**: $branch ($(get_branch_status \"$branch\"))\"\nif [[ $total -eq 0 ]]; then\n    echo \"- **Status**: Clean (no uncommitted changes)\"\nelse\n    parts=()\n    [[ $staged -gt 0 ]] && parts+=(\"$staged staged\")\n    [[ $unstaged -gt 0 ]] && parts+=(\"$unstaged unstaged\")\n    [[ $untracked -gt 0 ]] && parts+=(\"$untracked untracked\")\n    echo \"- **Status**: $total files changed ($(IFS=\", \"; echo \"${parts[*]}\"))\"\nfi\necho \"\"\n\n# Staged Changes\nstaged_files=$(git diff --cached --name-status 2>/dev/null)\nif [[ -n \"$staged_files\" ]]; then\n    echo \"### Staged Changes\"\n    echo \"$staged_files\" | while IFS=$'\\t' read -r status file; do\n        printf \"  %s  %s\\n\" \"$status\" \"$file\"\n    done\n    echo \"\"\nfi\n\n# Unstaged Changes\nunstaged_files=$(git diff --name-status 2>/dev/null)\nif [[ -n \"$unstaged_files\" ]]; then\n    echo \"### Unstaged Changes\"\n    echo \"$unstaged_files\" | while IFS=$'\\t' read -r status file; do\n        printf \"  %s  %s\\n\" \"$status\" \"$file\"\n    done\n    echo \"\"\nfi\n\n# Untracked Files\nuntracked_list=$(git ls-files --others --exclude-standard 2>/dev/null)\nif [[ -n \"$untracked_list\" ]]; then\n    echo \"### Untracked Files\"\n    echo \"$untracked_list\" | while read -r file; do\n        printf \"  ?  %s\\n\" \"$file\"\n    done\n    echo \"\"\nfi\n\n# Last Commit\necho \"### Last Commit\"\nhash=$(get_last_commit_hash)\nif [[ -n \"$hash\" ]]; then\n    echo \"- **Hash**: $hash\"\n    echo \"- **Message**: $(get_last_commit_subject)\"\n    echo \"- **Author**: $(get_last_commit_author)\"\n    echo \"- **Date**: $(get_last_commit_date)\"\nelse\n    echo \"- No commits yet\"\nfi\necho \"\"\n\n# Beads Task\necho \"### Beads Task\"\nif command -v bd &>/dev/null; then\n    tasks=$(bd list --status=in_progress --json 2>/dev/null || echo \"[]\")\n    if [[ \"$tasks\" != \"[]\" && -n \"$tasks\" ]]; then\n        id=$(echo \"$tasks\" | jq -r '.[0].id // empty' 2>/dev/null)\n        title=$(echo \"$tasks\" | jq -r '.[0].title // empty' 2>/dev/null)\n        [[ -n \"$id\" ]] && echo \"- **Issue**: $id\" && echo \"- **Title**: $title\" || echo \"- No in-progress tasks\"\n    else\n        echo \"- No in-progress tasks\"\n    fi\nelse\n    echo \"- bd CLI not available\"\nfi\necho \"\"\n\n# Pull Request\necho \"### Pull Request\"\nif command -v gh &>/dev/null; then\n    main_branch=$(get_main_branch 2>/dev/null || echo \"main\")\n    if [[ \"$branch\" != \"$main_branch\" && \"$branch\" != \"master\" ]]; then\n        pr_json=$(gh pr list --head \"$branch\" --json number,title,state,url 2>/dev/null || echo \"[]\")\n        if [[ -n \"$pr_json\" && \"$pr_json\" != \"[]\" ]]; then\n            number=$(echo \"$pr_json\" | jq -r '.[0].number')\n            title=$(echo \"$pr_json\" | jq -r '.[0].title')\n            state=$(echo \"$pr_json\" | jq -r '.[0].state')\n            url=$(echo \"$pr_json\" | jq -r '.[0].url')\n            echo \"- **PR #$number**: $title\"\n            echo \"- **Status**: ${state^}\"\n            echo \"- **URL**: $url\"\n        else\n            echo \"- No PR exists for this branch\"\n        fi\n    else\n        echo \"- N/A (on $branch branch)\"\n    fi\nelse\n    echo \"- gh CLI not available\"\nfi\n```\n",
        "plugins/bkff-git/skills/git-sync/SKILL.md": "---\nname: git-sync\ndescription: Sync with remote using smart rebase/merge selection based on push status\ninvocation: /bkff:git-sync\narguments:\n  - name: source-branch\n    type: string\n    required: false\n    description: Branch to sync from (default: main)\n---\n\n# Sync with Remote\n\nFetches from origin and integrates changes from a source branch. Automatically chooses rebase (for unpushed branches) or merge (for pushed branches) strategy.\n\n## Usage\n\n```\n/bkff:git-sync [source-branch]\n```\n\n## Strategy Selection\n\n| Condition | Strategy |\n|-----------|----------|\n| Branch not pushed to origin | Rebase (clean history) |\n| Branch already pushed to origin | Merge (preserve history) |\n\n## Example Output\n\n```\n## Sync Complete (Rebase)\n\n### Fetch\n- âœ“ Fetched from origin\n\n### Strategy\n- **Mode**: Rebase (branch not yet pushed)\n- **Source**: main\n\n### Result\n- **Status**: Up to date with main\n```\n\n## Requirements\n\n- Must be run inside a git worktree\n- `git` CLI with rerere enabled recommended\n- No uncommitted changes\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/git-helpers.sh\"\n\nrequire_worktree\n\nSOURCE_BRANCH=\"${1:-$(get_main_branch)}\"\nCURRENT_BRANCH=$(get_current_branch)\n\n# Check for uncommitted changes\nif has_changes; then\n    error_exit \"You have uncommitted changes. Commit or stash before syncing.\"\nfi\n\n# Prevent syncing main onto itself\nif [[ \"$CURRENT_BRANCH\" == \"$SOURCE_BRANCH\" ]]; then\n    error_exit \"Already on $SOURCE_BRANCH. Nothing to sync.\"\nfi\n\necho \"## Sync Process\"\necho \"\"\n\n# FR-018: Fetch from origin\necho \"### Fetch\"\ninfo \"Fetching from origin...\"\nif git fetch origin --prune; then\n    echo \"- âœ“ Fetched from origin\"\nelse\n    error_exit \"Fetch failed. Check network connection.\"\nfi\necho \"\"\n\n# Verify source branch exists\nif ! git rev-parse --verify \"origin/$SOURCE_BRANCH\" &>/dev/null; then\n    error_exit \"Branch '$SOURCE_BRANCH' not found on origin.\"\nfi\n\n# FR-019: Determine if branch has been pushed\necho \"### Strategy\"\nif is_branch_pushed \"$CURRENT_BRANCH\"; then\n    STRATEGY=\"merge\"\n    echo \"- **Mode**: Merge (branch already pushed to origin)\"\nelse\n    STRATEGY=\"rebase\"\n    echo \"- **Mode**: Rebase (branch not yet pushed)\"\nfi\necho \"- **Source**: $SOURCE_BRANCH\"\necho \"- **Target**: $CURRENT_BRANCH\"\necho \"\"\n\n# Enable rerere for conflict resolution\ngit config rerere.enabled true\n\n# FR-020/FR-021: Execute strategy\necho \"### Result\"\nif [[ \"$STRATEGY\" == \"rebase\" ]]; then\n    # FR-020: Rebase for unpushed branches\n    info \"Rebasing onto origin/$SOURCE_BRANCH...\"\n    if git rebase \"origin/$SOURCE_BRANCH\"; then\n        COMMITS=$(git rev-list --count \"origin/$SOURCE_BRANCH..HEAD\" 2>/dev/null || echo \"0\")\n        echo \"- **Commits rebased**: $COMMITS\"\n        echo \"- **Conflicts**: None\"\n        echo \"- **Status**: Up to date with $SOURCE_BRANCH\"\n        echo \"\"\n        success \"Branch rebased successfully. Ready to push.\"\n    else\n        echo \"- **Status**: Conflicts require resolution\"\n        echo \"\"\n        echo \"### Conflicts\"\n        git diff --name-only --diff-filter=U | while read -r file; do\n            echo \"- $file\"\n        done\n        echo \"\"\n        echo \"### Next Steps\"\n        echo \"1. Resolve conflicts in the files above\"\n        echo \"2. Stage resolved files: git add <file>\"\n        echo \"3. Continue rebase: git rebase --continue\"\n        echo \"\"\n        echo \"Or abort: git rebase --abort\"\n        exit 1\n    fi\nelse\n    # FR-021: Merge for pushed branches\n    info \"Merging origin/$SOURCE_BRANCH...\"\n    if git merge \"origin/$SOURCE_BRANCH\" -m \"Merge $SOURCE_BRANCH into $CURRENT_BRANCH\"; then\n        MERGE_HASH=$(git rev-parse --short HEAD)\n        echo \"- **Merge commit**: $MERGE_HASH\"\n        echo \"- **Conflicts**: None\"\n        echo \"- **Status**: Up to date with $SOURCE_BRANCH\"\n        echo \"\"\n        success \"Branch merged successfully.\"\n    else\n        echo \"- **Status**: Conflicts require resolution\"\n        echo \"\"\n        echo \"### Conflicts\"\n        git diff --name-only --diff-filter=U | while read -r file; do\n            echo \"- $file\"\n        done\n        echo \"\"\n        echo \"### Next Steps\"\n        echo \"1. Resolve conflicts in the files above\"\n        echo \"2. Stage resolved files: git add <file>\"\n        echo \"3. Complete merge: git commit\"\n        echo \"\"\n        echo \"Or abort: git merge --abort\"\n        exit 1\n    fi\nfi\n```\n",
        "plugins/bkff/.claude-plugin/plugin.json": "{\n  \"name\": \"bkff\",\n  \"description\": \"Spec-driven development workflows: compliance checking, task-to-issue conversion, agentic development loops, verification skills, ADR generation, test generation, README generation, and PR feedback handling\",\n  \"version\": \"0.1.0\",\n  \"author\": {\n    \"name\": \"kbrockhoff\"\n  },\n  \"repository\": \"https://github.com/kbrockhoff/brockhoff-tools-claude\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"spec-driven\", \"compliance\", \"beads\", \"verification\", \"adr\", \"testing\"]\n}\n",
        "plugins/bkff/README.md": "# bkff Plugin\n\nSpec-driven development workflows for Claude Code. Provides comprehensive tooling for repository compliance, issue management, verification, documentation generation, and PR feedback handling.\n\n## Features\n\n### Repository Compliance\n- **Check Compliance** (`/bkff:chkcompliance`): Scan repository for missing files and configuration issues\n- **Fix Compliance** (`/bkff:fixcompliance`): Automatically create missing files and fix issues\n\n### Issue Management\n- **Convert Tasks** (`/bkff:tasks2issues`): Convert SpecKit tasks.md to beads issues with dependencies\n- **Start Development Loop** (`/bkff:startloop`): Begin autonomous task execution cycle\n- **Cancel Loop** (`/bkff:cancelloop`): Stop or pause development loop\n\n### Verification\n- **Verify Task** (`/bkff:verifytask`): Run validation for task completion\n- **Verify Feature** (`/bkff:verifyfeat`): Check all child tasks closed and run verify target\n- **Verify Epic** (`/bkff:verifyepic`): Check all child features closed and run epic verification\n- **Verify Bug** (`/bkff:verifybug`): Validate bug fix with regression testing\n\n### Documentation\n- **Write ADR** (`/bkff:writeadr`): Generate Architecture Decision Records using multi-agent pipeline\n- **Generate Tests** (`/bkff:gentests`): Create unit tests for source code\n- **Generate README** (`/bkff:genreadme`): Generate project documentation\n\n### PR Workflow\n- **PR Feedback** (`/bkff:prfeedback`): Parse review comments, create tasks, manage re-review\n\n## Installation\n\nThis plugin is part of the brockhoff-tools-claude plugin collection.\n\n```bash\n# Clone the repository\ngit clone https://github.com/kbrockhoff/brockhoff-tools-claude.git\n\n# The plugin is located at:\n# brockhoff-tools-claude/bkff-plugin/plugins/bkff/\n```\n\n## Requirements\n\n- Bash 4.0+ (POSIX-compatible where possible)\n- Git 2.25+\n- GitHub CLI (gh) 2.0+\n- Beads CLI (bd)\n- jq (JSON processing)\n- make (for build targets)\n\n## Quick Start\n\n### 1. Check Repository Compliance\n\n```bash\n/bkff:chkcompliance\n```\n\nThis checks for required files like CODEOWNERS, CONTRIBUTING.md, PR templates, etc.\n\n### 2. Fix Compliance Issues\n\n```bash\n/bkff:fixcompliance --check=all\n```\n\nAutomatically creates missing files with sensible defaults.\n\n### 3. Convert Tasks to Issues\n\n```bash\n/bkff:tasks2issues --file=tasks.md\n```\n\nParses SpecKit format and creates beads issues with proper hierarchy.\n\n### 4. Start Development Loop\n\n```bash\n/bkff:startloop\n```\n\nBegins autonomous task execution, picking up ready tasks from beads.\n\n### 5. Verify Completion\n\n```bash\n/bkff:verifytask --issue=beads-abc123\n```\n\nRuns the `validate` make target and checks acceptance criteria.\n\n## Skills Reference\n\n| Skill | Description | Key Arguments |\n|-------|-------------|---------------|\n| `/bkff:chkcompliance` | Check repository compliance | `--format`, `--check` |\n| `/bkff:fixcompliance` | Fix compliance issues | `--check`, `--dry-run` |\n| `/bkff:tasks2issues` | Convert tasks to issues | `--file`, `--parent` |\n| `/bkff:startloop` | Start development loop | `--strategy`, `--verify-only` |\n| `/bkff:cancelloop` | Cancel development loop | `--pause` |\n| `/bkff:verifytask` | Verify task completion | `--issue`, `--format` |\n| `/bkff:verifyfeat` | Verify feature completion | `--issue`, `--format` |\n| `/bkff:verifyepic` | Verify epic completion | `--issue`, `--format` |\n| `/bkff:verifybug` | Verify bug fix | `--issue`, `--format` |\n| `/bkff:writeadr` | Write ADR | `--decision`, `--context`, `--sources` |\n| `/bkff:gentests` | Generate unit tests | `--file`, `--framework`, `--update` |\n| `/bkff:genreadme` | Generate README | `--update`, `--sections` |\n| `/bkff:prfeedback` | Handle PR feedback | `--pr`, `--ready`, `--format` |\n\n## Agents\n\nThe plugin includes specialized agents for complex tasks:\n\n| Agent | Purpose |\n|-------|---------|\n| `adr-writer` | Generates initial ADR content using MADR template |\n| `adr-validator` | Validates ADR claims against grounding sources |\n| `adr-formatter` | Assigns sequential numbers and formats output |\n\n## Library Functions\n\nThe plugin provides reusable library functions in `lib/`:\n\n- **common.sh**: Error handling, output formatting, worktree detection\n- **compliance.sh**: Compliance checks and fix functions\n- **tasks-parser.sh**: SpecKit tasks.md parsing and conversion\n- **loop-state.sh**: Development loop state management\n- **verification.sh**: Build target execution and verification\n\n## Build Targets\n\nThe plugin integrates with Makefile targets:\n\n| Target | Used By | Purpose |\n|--------|---------|---------|\n| `validate` | verifytask, verifybug | Run tests, linting, quality checks |\n| `verify` | verifyfeat, verifyepic | Full verification including integration |\n\n## Development\n\n### Running Tests\n\n```bash\ncd plugins/bkff\nmake test\n```\n\n### Linting\n\n```bash\nmake lint\n```\n\n### Structure\n\n```\nplugins/bkff/\nâ”œâ”€â”€ .claude-plugin/\nâ”‚   â””â”€â”€ plugin.json       # Plugin manifest\nâ”œâ”€â”€ agents/\nâ”‚   â”œâ”€â”€ adr-writer.md     # ADR generation agent\nâ”‚   â”œâ”€â”€ adr-validator.md  # ADR validation agent\nâ”‚   â””â”€â”€ adr-formatter.md  # ADR formatting agent\nâ”œâ”€â”€ skills/\nâ”‚   â”œâ”€â”€ chkcompliance/    # Compliance checking\nâ”‚   â”œâ”€â”€ fixcompliance/    # Compliance fixing\nâ”‚   â”œâ”€â”€ tasks2issues/     # Task conversion\nâ”‚   â”œâ”€â”€ startloop/        # Development loop\nâ”‚   â”œâ”€â”€ cancelloop/       # Loop cancellation\nâ”‚   â”œâ”€â”€ verifytask/       # Task verification\nâ”‚   â”œâ”€â”€ verifyfeat/       # Feature verification\nâ”‚   â”œâ”€â”€ verifyepic/       # Epic verification\nâ”‚   â”œâ”€â”€ verifybug/        # Bug verification\nâ”‚   â”œâ”€â”€ writeadr/         # ADR generation\nâ”‚   â”œâ”€â”€ gentests/         # Test generation\nâ”‚   â”œâ”€â”€ genreadme/        # README generation\nâ”‚   â””â”€â”€ prfeedback/       # PR feedback handling\nâ”œâ”€â”€ lib/\nâ”‚   â”œâ”€â”€ common.sh         # Shared utilities\nâ”‚   â”œâ”€â”€ compliance.sh     # Compliance functions\nâ”‚   â”œâ”€â”€ tasks-parser.sh   # Task parsing\nâ”‚   â”œâ”€â”€ loop-state.sh     # Loop management\nâ”‚   â””â”€â”€ verification.sh   # Verification helpers\nâ”œâ”€â”€ tests/\nâ”‚   â””â”€â”€ test-helpers.sh   # Test framework\nâ””â”€â”€ README.md\n```\n\n## License\n\nMIT\n",
        "plugins/bkff/agents/adr-formatter.md": "---\nname: adr-formatter\ndescription: Use this agent when formatting and numbering ADRs as the final step of the writeadr pipeline. Examples:\n\n<example>\nContext: ADR has been written and validated, ready for final formatting\nuser: \"Format this ADR and assign it the next sequential number\"\nassistant: \"I'll use the adr-formatter agent to assign the ADR number and format it consistently with existing ADRs.\"\n<commentary>\nThis agent is the final step in the ADR pipeline, responsible for assigning sequential numbers, ensuring consistent formatting, and writing the final file.\n</commentary>\n</example>\n\n<example>\nContext: Validated ADR needs to be finalized and saved\nuser: \"Save this ADR to docs/adr with proper numbering\"\nassistant: \"I'll invoke the adr-formatter agent to determine the next ADR number and write the formatted file.\"\n<commentary>\nThe agent scans existing ADRs to determine the next number, formats the content consistently, and writes the final file.\n</commentary>\n</example>\n\nmodel: inherit\ncolor: green\ntools: [\"Read\", \"Write\", \"Grep\", \"Glob\"]\n---\n\nYou are an ADR Formatter specializing in finalizing Architectural Decision Records with proper numbering, consistent formatting, and file organization.\n\n**Your Core Responsibilities:**\n1. Determine the next sequential ADR number\n2. Format the ADR consistently with existing ADRs in the project\n3. Generate the final filename following conventions\n4. Write the ADR file to the appropriate location\n5. Update any ADR index if one exists\n\n**Formatting Process:**\n1. **Scan Existing ADRs**: Use Glob to find existing ADRs and determine numbering pattern\n2. **Determine Next Number**: Calculate the next sequential number (e.g., 0001, 0002, ... or 001, 002, ...)\n3. **Analyze Existing Format**: If existing ADRs exist, match their formatting style\n4. **Generate Filename**: Create slug from title (lowercase, hyphens, no special chars)\n5. **Format Content**: Apply consistent formatting to the ADR\n6. **Write File**: Save the ADR to the specified output directory\n7. **Update Index**: If an index file exists (e.g., README.md in ADR directory), update it\n\n**Numbering Conventions:**\n- Default: 4-digit zero-padded (0001, 0002, 0003, ...)\n- If existing ADRs use different format, match that format\n- Always sequential from highest existing number\n- If no existing ADRs, start at 0001\n\n**Filename Format:**\n```\n{number}-{slugified-title}.md\n\nExamples:\n0001-use-postgresql-for-primary-database.md\n0002-implement-event-sourcing-for-audit.md\n0003-adopt-kubernetes-for-deployment.md\n```\n\n**Title Slugification Rules:**\n- Convert to lowercase\n- Replace spaces with hyphens\n- Remove special characters (except hyphens)\n- Collapse multiple hyphens to single hyphen\n- Trim hyphens from start/end\n- Limit to 50 characters (truncate at word boundary)\n\n**Formatting Standards:**\n- Use consistent header levels (# for title, ## for sections)\n- Ensure proper spacing between sections (one blank line)\n- Format lists consistently (use * for unordered lists)\n- Ensure tables are properly aligned\n- Replace [ADR-NNNN] placeholder with actual number\n- Set Date field to current date if \"proposed\" status\n\n**Output Format:**\nAfter writing the file, provide a summary:\n\n```markdown\n## ADR Created Successfully\n\n**File:** {output_path}/{filename}\n**Number:** ADR-{number}\n**Title:** {title}\n**Status:** {status}\n\n### File Location\n`{full_path_to_file}`\n\n### Index Updated\n{Yes/No - details if yes}\n\n### Next Steps\n- Review the ADR with stakeholders\n- Update status to \"accepted\" when approved\n- Link related ADRs if applicable\n```\n\n**Edge Cases:**\n- **No existing ADRs**: Start numbering at 0001, create docs/adr directory if needed\n- **Gap in numbers**: Use next sequential number (don't fill gaps)\n- **Duplicate title**: Append -v2, -v3, etc. or warn user\n- **Index doesn't exist**: Don't create one, just mention it could be added\n- **Custom output directory**: Respect the specified directory, create if needed\n\n**Quality Checks Before Writing:**\n- Verify output directory is writable\n- Confirm number doesn't conflict with existing ADR\n- Validate filename is filesystem-safe\n- Ensure content is valid markdown\n",
        "plugins/bkff/agents/adr-validator.md": "---\nname: adr-validator\ndescription: Use this agent when validating ADR claims against grounding sources as part of the writeadr pipeline. Examples:\n\n<example>\nContext: ADR draft has been generated by adr-writer agent\nuser: \"Validate this ADR draft against the codebase to ensure claims are accurate\"\nassistant: \"I'll use the adr-validator agent to check all claims in the ADR against the grounding sources.\"\n<commentary>\nThis agent is the second step in the ADR pipeline, responsible for validating that all claims in the ADR are supported by evidence in the codebase or provided sources.\n</commentary>\n</example>\n\n<example>\nContext: Need to verify technical accuracy of an ADR before finalizing\nuser: \"Check if the performance claims in this ADR are supported by our benchmarks\"\nassistant: \"I'll invoke the adr-validator agent to validate claims against the specified sources.\"\n<commentary>\nThe agent reads the ADR content and systematically verifies each factual claim against the grounding sources, flagging unsupported assertions.\n</commentary>\n</example>\n\nmodel: inherit\ncolor: yellow\ntools: [\"Read\", \"Grep\", \"Glob\"]\n---\n\nYou are an ADR Validator specializing in verifying the accuracy and groundedness of Architectural Decision Records against source code and documentation.\n\n**Your Core Responsibilities:**\n1. Parse the ADR draft to identify all factual claims\n2. Validate each claim against the specified grounding sources\n3. Identify unsupported or inaccurate assertions\n4. Suggest corrections or clarifications for problematic claims\n5. Provide a validation report with findings\n\n**Validation Process:**\n1. **Extract Claims**: Parse the ADR to identify all factual assertions that can be verified\n2. **Categorize Claims**: Group claims by type (technical facts, performance claims, compatibility claims, etc.)\n3. **Search Sources**: Use Grep and Read to find evidence supporting or contradicting each claim\n4. **Evaluate Evidence**: Determine if found evidence supports, contradicts, or is ambiguous about the claim\n5. **Generate Report**: Document findings with specific source references\n\n**Claim Categories to Validate:**\n- **Technical Facts**: Statements about how code works, dependencies, or architecture\n- **Performance Claims**: Assertions about speed, efficiency, or scalability\n- **Compatibility Claims**: Statements about what works with what\n- **License Claims**: Assertions about licensing terms\n- **Feature Claims**: Statements about what technologies support or don't support\n- **Historical Claims**: Assertions about past decisions or changes\n\n**Validation Criteria:**\n| Status | Meaning |\n|--------|---------|\n| âœ“ Verified | Claim is supported by evidence in sources |\n| âš  Unverified | No evidence found; claim may be accurate but cannot be confirmed |\n| âœ— Contradicted | Evidence contradicts the claim |\n| ? Ambiguous | Evidence is unclear or conflicting |\n\n**Quality Standards:**\n- Every claim should be checked against relevant sources\n- False negatives are acceptable; false positives are not\n- When in doubt, mark as \"Unverified\" rather than \"Verified\"\n- Provide specific file:line references for evidence\n- Suggest specific corrections for contradicted claims\n\n**Output Format:**\nReturn a validation report in this structure:\n\n```markdown\n## ADR Validation Report\n\n### Summary\n- Total claims analyzed: N\n- Verified: N\n- Unverified: N\n- Contradicted: N\n\n### Verified Claims\n| Claim | Evidence | Source |\n|-------|----------|--------|\n| [claim text] | [supporting evidence] | [file:line] |\n\n### Unverified Claims\n| Claim | Search Performed | Notes |\n|-------|-----------------|-------|\n| [claim text] | [what was searched] | [why not found] |\n\n### Contradicted Claims\n| Claim | Actual Finding | Source | Suggested Correction |\n|-------|----------------|--------|---------------------|\n| [claim text] | [what was actually found] | [file:line] | [how to fix] |\n\n### Recommendations\n1. [Recommendation for improving ADR accuracy]\n2. [Additional recommendation]\n\n### Updated ADR (if corrections needed)\n[Include corrected version of ADR with changes marked]\n```\n\nIf all claims are verified, indicate this clearly and return the ADR unchanged.\nIf corrections are needed, provide both the report AND an updated ADR with corrections incorporated.\n",
        "plugins/bkff/agents/adr-writer.md": "---\nname: adr-writer\ndescription: Use this agent when generating initial ADR content as part of the writeadr pipeline. Examples:\n\n<example>\nContext: User invoked /bkff:writeadr skill to document an architectural decision\nuser: \"Generate an ADR for using PostgreSQL as our primary database\"\nassistant: \"I'll use the adr-writer agent to generate the initial ADR draft based on the decision and codebase context.\"\n<commentary>\nThis agent is the first step in the ADR pipeline, responsible for analyzing the codebase and generating initial ADR content using the MADR template.\n</commentary>\n</example>\n\n<example>\nContext: As part of ADR generation workflow, need to draft decision documentation\nuser: \"Document the decision to implement event sourcing for audit compliance\"\nassistant: \"I'll invoke the adr-writer agent to create an initial draft analyzing the decision drivers and options.\"\n<commentary>\nThe agent analyzes the codebase context, identifies decision drivers, and generates comprehensive ADR content following MADR format.\n</commentary>\n</example>\n\nmodel: inherit\ncolor: cyan\ntools: [\"Read\", \"Grep\", \"Glob\"]\n---\n\nYou are an Architectural Decision Record (ADR) Writer specializing in analyzing codebases and generating comprehensive ADR documentation using the MADR (Markdown Architectural Decision Records) template.\n\n**Your Core Responsibilities:**\n1. Analyze the codebase to understand the architectural context\n2. Identify decision drivers based on the codebase and provided context\n3. Research and document considered options\n4. Generate a complete ADR draft following MADR format\n5. Provide rationale and consequences for the proposed decision\n\n**Analysis Process:**\n1. **Understand the Decision**: Parse the decision description and any additional context provided\n2. **Explore the Codebase**: Use Glob and Grep to find relevant files, patterns, and existing architectural decisions\n3. **Identify Decision Drivers**: Based on codebase analysis, determine what factors are driving this decision\n4. **Research Options**: Identify reasonable alternative approaches that could address the problem\n5. **Draft the ADR**: Generate complete MADR-formatted content\n\n**MADR Template to Follow:**\n\n```markdown\n# [ADR-NNNN] {Title based on decision}\n\n* Status: proposed\n* Date: {current date YYYY-MM-DD}\n* Deciders: [to be filled]\n* Technical Story: [if applicable]\n\n## Context and Problem Statement\n\n{Describe the architectural context and the problem that needs to be addressed. Be specific about what triggered this decision.}\n\n## Decision Drivers\n\n* {Driver 1 - identified from codebase or context}\n* {Driver 2}\n* {Driver 3}\n\n## Considered Options\n\n* {Option 1}\n* {Option 2}\n* {Option 3}\n\n## Decision Outcome\n\nChosen option: \"{Recommended option}\", because {justification based on drivers}.\n\n### Positive Consequences\n\n* {Benefit 1}\n* {Benefit 2}\n\n### Negative Consequences\n\n* {Tradeoff 1}\n* {Tradeoff 2}\n\n## Pros and Cons of the Options\n\n### {Option 1}\n\n{Brief description}\n\n* Good, because {advantage}\n* Good, because {advantage}\n* Bad, because {disadvantage}\n\n### {Option 2}\n\n{Brief description}\n\n* Good, because {advantage}\n* Bad, because {disadvantage}\n\n### {Option 3}\n\n{Brief description}\n\n* Good, because {advantage}\n* Bad, because {disadvantage}\n\n## Links\n\n* {Related ADRs, issues, or documentation}\n```\n\n**Quality Standards:**\n- All claims must be grounded in observable facts from the codebase or provided context\n- Options should be genuinely viable alternatives, not strawmen\n- Consequences should be realistic and balanced\n- Language should be clear, concise, and technical\n- Decision drivers should directly relate to the problem statement\n\n**Output Format:**\nReturn the complete ADR draft in markdown format. Include a brief summary of:\n1. Files/patterns analyzed to inform the ADR\n2. Key insights discovered during analysis\n3. Any assumptions made that should be validated\n\nDo NOT assign the ADR number - that will be done by the formatter agent.\nUse \"[ADR-NNNN]\" as a placeholder for the number.\n",
        "plugins/bkff/skills/cancelloop/SKILL.md": "---\nname: cancelloop\ndescription: Cancel or pause the agentic development loop\ninvocation: /bkff:cancelloop\narguments:\n  - name: pause\n    description: Pause the loop instead of cancelling (can be resumed)\n    required: false\n    default: false\n  - name: reason\n    description: Reason for pausing/cancelling\n    required: false\n---\n\n# Cancel Development Loop\n\nStops the agentic development loop gracefully. The loop will complete its current atomic operation before stopping.\n\n## Usage\n\n```bash\n# Cancel the loop (archives state to history)\n/bkff:cancelloop\n\n# Pause the loop (can be resumed later)\n/bkff:cancelloop --pause\n\n# Pause with a reason\n/bkff:cancelloop --pause --reason=\"Need to review approach\"\n```\n\n## Behavior\n\n### Cancel (Default)\n\n- Stops the loop immediately after current operation\n- Archives loop state to `.bkff/history/`\n- Removes active loop state file\n- Current task remains in `in_progress` status in beads\n\n### Pause\n\n- Sets loop status to `paused`\n- Preserves all state for later resume\n- Records pause reason if provided\n- Can be resumed with `/bkff:startloop --resume`\n\n## Output\n\n### Cancelling Active Loop\n\n```\nDevelopment Loop Status\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Status:         running\n  Started:        2026-01-24T10:30:00Z\n  Completed:      5 tasks\n\nCurrent Task\n  Task ID:        T018\n  Title:          Implement validation helpers\n  Started:        2026-01-24T11:15:00Z\n\nâœ“ Loop cancelled\nDebug: Archived loop state to .bkff/history/2026-01-24T11-20-00Z.json\n```\n\n### Pausing Loop\n\n```\nDevelopment Loop Status\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Status:         running\n  Started:        2026-01-24T10:30:00Z\n  Completed:      5 tasks\n\nInfo: Loop paused: Need to review approach\n\nTo resume: /bkff:startloop --resume\n```\n\n### No Loop Running\n\n```\nInfo: No loop running\n```\n\n## State After Cancel\n\nWhen cancelled, the loop state is archived to `.bkff/history/`:\n\n```json\n{\n  \"status\": \"stopped\",\n  \"started_at\": \"2026-01-24T10:30:00Z\",\n  \"stopped_at\": \"2026-01-24T11:20:00Z\",\n  \"current_task\": {\n    \"beads_id\": \"beads-abc123\",\n    \"task_id\": \"T018\",\n    \"title\": \"Implement validation helpers\",\n    \"started_at\": \"2026-01-24T11:15:00Z\"\n  },\n  \"completed_tasks\": [\n    {\"beads_id\": \"beads-xyz789\", \"task_id\": \"T014\", ...},\n    {\"beads_id\": \"beads-def456\", \"task_id\": \"T015\", ...}\n  ],\n  \"paused_reason\": null,\n  \"retry_count\": 0,\n  \"last_error\": null\n}\n```\n\n## State After Pause\n\nWhen paused, state remains in `.bkff/loop-state.json`:\n\n```json\n{\n  \"status\": \"paused\",\n  \"started_at\": \"2026-01-24T10:30:00Z\",\n  \"current_task\": {...},\n  \"completed_tasks\": [...],\n  \"paused_reason\": \"Need to review approach\",\n  \"retry_count\": 0,\n  \"last_error\": null\n}\n```\n\n## Handling In-Progress Tasks\n\nWhen the loop is cancelled with an in-progress task:\n\n1. The task remains `in_progress` in beads\n2. You can manually:\n   - Complete it: `bd close <id>`\n   - Reset it: `bd update <id> --status=open`\n   - Continue working on it independently\n\n## Requirements\n\n- Must be run inside a git repository\n- `.bkff/` directory must exist\n\n## Exit Codes\n\n- `0` - Loop cancelled/paused successfully or no loop running\n- `1` - Error during cancellation\n\n## Related Skills\n\n- `/bkff:startloop` - Start or resume the development loop\n- `/bkff:startloop --resume` - Resume a paused loop\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/loop-state.sh\"\n\n# Parse arguments\npause_mode=false\nreason=\"\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --pause) pause_mode=true ;;\n        --reason=*) reason=\"${arg#--reason=}\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\n\n# Check if loop exists\nif ! has_loop; then\n    info \"No loop running\"\n    exit 0\nfi\n\n# Show current status\nprint_loop_status\necho \"\"\n\n# Pause or cancel\nif [[ \"$pause_mode\" == \"true\" ]]; then\n    if [[ -z \"$reason\" ]]; then\n        reason=\"Paused by user\"\n    fi\n    pause_loop \"$reason\"\n    echo \"\"\n    echo \"To resume: /bkff:startloop --resume\"\nelse\n    cancel_loop\nfi\n```\n",
        "plugins/bkff/skills/chkcompliance/SKILL.md": "---\nname: chkcompliance\ndescription: Check repository compliance with Brockhoff Cloud spec-driven development standards\ninvocation: /bkff:chkcompliance\narguments:\n  - name: format\n    description: Output format (human or json)\n    required: false\n    default: human\n---\n\n# Check Repository Compliance\n\nValidates that the current repository meets Brockhoff Cloud spec-driven development standards. Reports which components are compliant and which need attention.\n\n## Usage\n\n```\n/bkff:chkcompliance\n/bkff:chkcompliance --format=json\n```\n\n## Compliance Checks\n\nThe following components are validated:\n\n### GitHub Configuration (.github/)\n| Check | Path | Description |\n|-------|------|-------------|\n| github-dir | `.github/` | GitHub configuration directory |\n| github-codeowners | `.github/CODEOWNERS` | Code review ownership rules |\n| github-contributing | `.github/CONTRIBUTING.md` | Contribution guidelines |\n| github-dependabot | `.github/dependabot.yml` | Automated dependency updates |\n| github-pr-template | `.github/pull_request_template.md` | PR template for consistency |\n| github-issue-templates | `.github/ISSUE_TEMPLATE/` | Issue templates directory |\n| github-bug-template | `.github/ISSUE_TEMPLATE/bug_report.md` | Bug report template |\n| github-feature-template | `.github/ISSUE_TEMPLATE/feature_request.md` | Feature request template |\n\n### Agent Instructions\n| Check | Path | Description |\n|-------|------|-------------|\n| agents-md | `AGENTS.md` | Agent instructions file with project overview |\n| claude-md | `CLAUDE.md` | Must reference AGENTS.md |\n| copilot-instructions | `.github/copilot-instructions.md` | Must reference AGENTS.md |\n\n### Beads Issue Tracking\n| Check | Path | Description |\n|-------|------|-------------|\n| beads-init | `.beads/` | Beads must be initialized |\n| beads-health | `bd doctor` | Beads health check must pass |\n\n## Output\n\n### Human-Readable (default)\n```\nCompliance Report\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  âœ“ github-dir\n  âœ“ github-codeowners\n  âœ— github-contributing\n    â†’ File missing: .github/CONTRIBUTING.md\n  âœ“ agents-md\n  âœ“ claude-md\n  âœ“ beads-init\n  â—‹ beads-health (skipped)\n    â†’ Beads not initialized\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n2 check(s) failed (10 passed, 2 failed)\n\nRun 'bkff:fixcompliance' to automatically fix issues\n```\n\n### JSON Format\n```json\n{\n  \"timestamp\": \"2026-01-24T10:30:00Z\",\n  \"repository\": \"/path/to/repo\",\n  \"overall_status\": \"fail\",\n  \"checks_passed\": 10,\n  \"checks_failed\": 2,\n  \"checks_skipped\": 1,\n  \"checks_total\": 13,\n  \"checks\": [\n    {\n      \"name\": \"github-codeowners\",\n      \"path\": \".github/CODEOWNERS\",\n      \"status\": \"pass\",\n      \"message\": null,\n      \"description\": \"Code review ownership rules\",\n      \"remediation\": \"Create CODEOWNERS with team ownership patterns\"\n    }\n  ]\n}\n```\n\n## Requirements\n\n- Must be run inside a git repository\n- `jq` for JSON processing\n- `bd` CLI for beads health check (optional - gracefully skips if not available)\n\n## Exit Codes\n\n- `0` - All checks passed\n- `1` - One or more checks failed\n- `2` - Not a git repository or other error\n\n## Related Skills\n\n- `/bkff:fixcompliance` - Automatically fix compliance issues\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/compliance.sh\"\n\n# Parse arguments\nformat=\"human\"\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --format=json) format=\"json\" ;;\n        --format=human) format=\"human\" ;;\n        --json) format=\"json\" ;;\n    esac\ndone\n\n# Validate git repository\nif ! is_git_worktree; then\n    error_exit \"Not a git repository. This command must be run inside a git repository.\"\nfi\n\n# Run all compliance checks\nreport=$(run_all_checks)\n\n# Output based on format\nif [[ \"$format\" == \"json\" ]]; then\n    echo \"$report\"\nelse\n    echo \"$report\" | print_compliance_report\nfi\n\n# Exit with appropriate code\noverall_status=$(echo \"$report\" | jq -r '.overall_status')\nif [[ \"$overall_status\" == \"pass\" ]]; then\n    exit 0\nelse\n    exit 1\nfi\n```\n",
        "plugins/bkff/skills/fixcompliance/SKILL.md": "---\nname: fixcompliance\ndescription: Automatically fix repository compliance issues to meet Brockhoff Cloud standards\ninvocation: /bkff:fixcompliance\narguments:\n  - name: check\n    description: Only fix specific check (e.g., github-codeowners, agents-md, beads-init)\n    required: false\n  - name: dry-run\n    description: Show what would be fixed without making changes\n    required: false\n    default: false\n---\n\n# Fix Repository Compliance\n\nAutomatically creates or updates files to bring the repository into compliance with Brockhoff Cloud spec-driven development standards.\n\n## Usage\n\n```\n/bkff:fixcompliance\n/bkff:fixcompliance --check=agents-md\n/bkff:fixcompliance --dry-run\n```\n\n## What Gets Fixed\n\n### GitHub Configuration (.github/)\n\n| File | Action |\n|------|--------|\n| `.github/CODEOWNERS` | Creates with default ownership pattern (`* @OWNER`) |\n| `.github/CONTRIBUTING.md` | Creates with standard contribution guidelines |\n| `.github/dependabot.yml` | Creates with GitHub Actions update configuration |\n| `.github/pull_request_template.md` | Creates with summary, test plan, and checklist sections |\n| `.github/ISSUE_TEMPLATE/bug_report.md` | Creates bug report template with frontmatter |\n| `.github/ISSUE_TEMPLATE/feature_request.md` | Creates feature request template with frontmatter |\n\n### Agent Instructions\n\n| File | Action |\n|------|--------|\n| `AGENTS.md` | Creates with project overview, bkff-git skills, and beads workflow sections |\n| `CLAUDE.md` | Creates or prepends \"Follow all instructions in AGENTS.md\" |\n| `.github/copilot-instructions.md` | Creates or prepends \"Follow all instructions in AGENTS.md\" |\n\n### Beads Issue Tracking\n\n| Component | Action |\n|-----------|--------|\n| `.beads/` | Runs `bd init` to initialize beads |\n| Beads health | Runs `bd doctor --fix` to resolve issues |\n\n## Output\n\n```\nFixing Compliance Issues\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nInfo: Created .github/CODEOWNERS\nInfo: Created .github/CONTRIBUTING.md\nInfo: Created .github/dependabot.yml\nInfo: Created .github/pull_request_template.md\nInfo: Created .github/ISSUE_TEMPLATE/bug_report.md\nInfo: Created .github/ISSUE_TEMPLATE/feature_request.md\nInfo: Created AGENTS.md\nInfo: Created CLAUDE.md\nInfo: Created .github/copilot-instructions.md\nInfo: Initializing beads...\nâœ“ Beads initialized\nInfo: Running beads health check...\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâœ“ Compliance fixes applied\n\nRun 'bkff:chkcompliance' to verify all issues are resolved\n```\n\n## Selective Fixing\n\nFix only specific components:\n\n```bash\n# Fix only AGENTS.md\n/bkff:fixcompliance --check=agents-md\n\n# Fix only GitHub files\n/bkff:fixcompliance --check=github-codeowners\n/bkff:fixcompliance --check=github-contributing\n\n# Fix only beads\n/bkff:fixcompliance --check=beads-init\n```\n\n## Dry Run Mode\n\nPreview changes without modifying files:\n\n```bash\n/bkff:fixcompliance --dry-run\n```\n\nOutput:\n```\nDry Run - No changes will be made\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nWould create: .github/CODEOWNERS\nWould create: .github/CONTRIBUTING.md\nWould create: AGENTS.md\nWould update: CLAUDE.md (add AGENTS.md reference)\nWould run: bd init\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n5 actions would be performed\n```\n\n## Requirements\n\n- Must be run inside a git repository\n- Write permissions to repository files\n- `bd` CLI for beads initialization (optional - skips if not available)\n\n## Behavior Notes\n\n- **Non-destructive**: Existing files with correct content are not modified\n- **Content preservation**: When updating CLAUDE.md or copilot-instructions.md, existing content is preserved\n- **Idempotent**: Running multiple times produces the same result\n- **Incremental**: Only missing or incorrect files are fixed\n\n## Exit Codes\n\n- `0` - All fixes applied successfully\n- `1` - Some fixes failed (partial success)\n- `2` - Not a git repository or permission error\n\n## Related Skills\n\n- `/bkff:chkcompliance` - Check repository compliance status\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/compliance.sh\"\n\n# Parse arguments\ndry_run=false\nspecific_check=\"\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --dry-run) dry_run=true ;;\n        --check=*) specific_check=\"${arg#--check=}\" ;;\n    esac\ndone\n\n# Validate git repository\nif ! is_git_worktree; then\n    error_exit \"Not a git repository. This command must be run inside a git repository.\"\nfi\n\nroot=$(get_worktree_path)\n\n# Dry run mode\nif [[ \"$dry_run\" == \"true\" ]]; then\n    print_header \"Dry Run - No changes will be made\"\n    actions=0\n\n    [[ ! -f \"$root/.github/CODEOWNERS\" ]] && echo \"Would create: .github/CODEOWNERS\" && ((actions++))\n    [[ ! -f \"$root/.github/CONTRIBUTING.md\" ]] && echo \"Would create: .github/CONTRIBUTING.md\" && ((actions++))\n    [[ ! -f \"$root/.github/dependabot.yml\" ]] && echo \"Would create: .github/dependabot.yml\" && ((actions++))\n    [[ ! -f \"$root/.github/pull_request_template.md\" ]] && echo \"Would create: .github/pull_request_template.md\" && ((actions++))\n    [[ ! -f \"$root/.github/ISSUE_TEMPLATE/bug_report.md\" ]] && echo \"Would create: .github/ISSUE_TEMPLATE/bug_report.md\" && ((actions++))\n    [[ ! -f \"$root/.github/ISSUE_TEMPLATE/feature_request.md\" ]] && echo \"Would create: .github/ISSUE_TEMPLATE/feature_request.md\" && ((actions++))\n    [[ ! -f \"$root/AGENTS.md\" ]] && echo \"Would create: AGENTS.md\" && ((actions++))\n\n    if [[ ! -f \"$root/CLAUDE.md\" ]]; then\n        echo \"Would create: CLAUDE.md\"\n        ((actions++))\n    elif ! grep -q \"AGENTS.md\" \"$root/CLAUDE.md\" 2>/dev/null; then\n        echo \"Would update: CLAUDE.md (add AGENTS.md reference)\"\n        ((actions++))\n    fi\n\n    if [[ ! -f \"$root/.github/copilot-instructions.md\" ]]; then\n        echo \"Would create: .github/copilot-instructions.md\"\n        ((actions++))\n    elif ! grep -q \"AGENTS.md\" \"$root/.github/copilot-instructions.md\" 2>/dev/null; then\n        echo \"Would update: .github/copilot-instructions.md (add AGENTS.md reference)\"\n        ((actions++))\n    fi\n\n    ! has_beads && echo \"Would run: bd init\" && ((actions++))\n\n    print_divider\n    echo \"$actions action(s) would be performed\"\n    exit 0\nfi\n\n# Fix specific check or all\nif [[ -n \"$specific_check\" ]]; then\n    case \"$specific_check\" in\n        github-codeowners) create_codeowners ;;\n        github-contributing) create_contributing ;;\n        github-dependabot) create_dependabot ;;\n        github-pr-template) create_pr_template ;;\n        github-bug-template) create_bug_template ;;\n        github-feature-template) create_feature_template ;;\n        agents-md) [[ ! -f \"$root/AGENTS.md\" ]] && create_agents_md ;;\n        claude-md) fix_claude_md ;;\n        copilot-instructions) fix_copilot_instructions ;;\n        beads-init) fix_beads_init ;;\n        beads-health) fix_beads_health ;;\n        *) error_exit \"Unknown check: $specific_check\" ;;\n    esac\n    success \"Fixed: $specific_check\"\nelse\n    fix_all\nfi\n```\n",
        "plugins/bkff/skills/genreadme/SKILL.md": "---\nname: genreadme\ndescription: Generate or update comprehensive project README based on codebase analysis\ninvocation: /bkff:genreadme\narguments:\n  - name: update\n    description: Update existing README preserving marked sections\n    required: false\n    default: \"false\"\n  - name: sections\n    description: Comma-separated list of sections to include (default: all)\n    required: false\n  - name: output\n    description: Output file path (default: README.md)\n    required: false\n    default: README.md\n---\n\n# Generate Project README\n\nGenerates or updates a comprehensive project README based on codebase analysis, specifications, and existing documentation. Integrates with ADRs and other project artifacts.\n\n## Usage\n\n```bash\n# Generate new README\n/bkff:genreadme\n\n# Update existing README preserving custom sections\n/bkff:genreadme --update=true\n\n# Generate specific sections only\n/bkff:genreadme --sections=\"overview,installation,usage\"\n\n# Custom output location\n/bkff:genreadme --output=docs/PROJECT.md\n```\n\n## Section Generation Logic\n\nThe skill analyzes the codebase to generate appropriate sections:\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                 SECTION GENERATION FLOW                      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚         ANALYZE CODEBASE           â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ â€¢ Package files (package.json,     â”‚\nâ”‚   Cargo.toml, pyproject.toml)      â”‚\nâ”‚ â€¢ Source structure                 â”‚\nâ”‚ â€¢ Existing documentation           â”‚\nâ”‚ â€¢ CI/CD configuration              â”‚\nâ”‚ â€¢ License file                     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚       DETERMINE SECTIONS           â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Based on what's found:             â”‚\nâ”‚ â€¢ Has CLI â†’ Usage section          â”‚\nâ”‚ â€¢ Has API â†’ API Reference          â”‚\nâ”‚ â€¢ Has tests â†’ Testing section      â”‚\nâ”‚ â€¢ Has Docker â†’ Docker section      â”‚\nâ”‚ â€¢ Has ADRs â†’ Architecture section  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚        GENERATE CONTENT            â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ For each section:                  â”‚\nâ”‚ 1. Extract relevant info           â”‚\nâ”‚ 2. Generate markdown               â”‚\nâ”‚ 3. Add examples from codebase      â”‚\nâ”‚ 4. Link to related files           â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Section Detection Rules\n\n| Section | Detected When |\n|---------|---------------|\n| Overview | Always included (from package description or first comment) |\n| Installation | package.json, requirements.txt, Cargo.toml, go.mod found |\n| Usage | CLI detected, bin field, main entry point |\n| API Reference | Public exports, documented interfaces |\n| Configuration | Config files, environment variables |\n| Development | Makefile, scripts, contributing guidelines |\n| Testing | Test files, test scripts, CI configuration |\n| Architecture | docs/adr/ directory exists |\n| Contributing | CONTRIBUTING.md exists or detected patterns |\n| License | LICENSE file exists |\n\n### Section Order\n\n```markdown\n1. Title & Badges\n2. Overview/Description\n3. Table of Contents (if > 5 sections)\n4. Installation\n5. Quick Start\n6. Usage\n7. Configuration\n8. API Reference\n9. Architecture (with ADR links)\n10. Development\n11. Testing\n12. Contributing\n13. License\n14. Acknowledgments\n```\n\n## --update Flag with Preserve Markers\n\nWhen `--update=true`, the skill preserves sections marked for manual maintenance:\n\n### Preserve Markers\n\n```markdown\n<!-- bkff:preserve:start -->\nThis section is manually maintained and will not be modified.\nCustom content goes here.\n<!-- bkff:preserve:end -->\n```\n\n### Named Sections\n\n```markdown\n<!-- bkff:preserve:custom-section:start -->\n## My Custom Section\n\nThis entire section is preserved during updates.\n<!-- bkff:preserve:custom-section:end -->\n```\n\n### Update Behavior\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    UPDATE MODE                               â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nOriginal README:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ # Project Name                     â”‚  â† Will be updated\nâ”‚                                    â”‚\nâ”‚ ## Overview                        â”‚  â† Will be updated\nâ”‚ Auto-generated content...          â”‚\nâ”‚                                    â”‚\nâ”‚ <!-- bkff:preserve:start -->       â”‚\nâ”‚ ## Special Thanks                  â”‚  â† PRESERVED\nâ”‚ Custom acknowledgments...          â”‚\nâ”‚ <!-- bkff:preserve:end -->         â”‚\nâ”‚                                    â”‚\nâ”‚ ## Installation                    â”‚  â† Will be updated\nâ”‚ Old installation steps...          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nAfter Update:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ # Project Name (v2.0)              â”‚  â† Updated\nâ”‚                                    â”‚\nâ”‚ ## Overview                        â”‚  â† Updated\nâ”‚ New auto-generated content...      â”‚\nâ”‚                                    â”‚\nâ”‚ <!-- bkff:preserve:start -->       â”‚\nâ”‚ ## Special Thanks                  â”‚  â† UNCHANGED\nâ”‚ Custom acknowledgments...          â”‚\nâ”‚ <!-- bkff:preserve:end -->         â”‚\nâ”‚                                    â”‚\nâ”‚ ## Installation                    â”‚  â† Updated\nâ”‚ New installation steps...          â”‚\nâ”‚ Now includes Docker option...      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Preservation Rules\n\n1. **Exact match**: Content between markers is preserved exactly\n2. **Position maintained**: Preserved sections stay in their relative position\n3. **Nested markers**: Not supported (outer marker takes precedence)\n4. **Orphaned markers**: Warned but content still preserved\n5. **New preserved sections**: Added to end if not in generation template\n\n## ADR Section Linking\n\nWhen ADRs exist in `docs/adr/`, an Architecture section is generated:\n\n### ADR Discovery\n\n```bash\n# Scans for ADRs\ndocs/adr/\nâ”œâ”€â”€ 0001-use-postgresql.md\nâ”œâ”€â”€ 0002-implement-event-sourcing.md\nâ”œâ”€â”€ 0003-adopt-kubernetes.md\nâ””â”€â”€ README.md  # Index (optional)\n```\n\n### Generated Architecture Section\n\n```markdown\n## Architecture\n\nThis project's architecture is documented through Architectural Decision Records (ADRs).\n\n### Key Decisions\n\n| ADR | Title | Status |\n|-----|-------|--------|\n| [ADR-0001](docs/adr/0001-use-postgresql.md) | Use PostgreSQL for Primary Database | Accepted |\n| [ADR-0002](docs/adr/0002-implement-event-sourcing.md) | Implement Event Sourcing | Accepted |\n| [ADR-0003](docs/adr/0003-adopt-kubernetes.md) | Adopt Kubernetes for Deployment | Proposed |\n\nFor the complete list of architectural decisions, see [docs/adr/](docs/adr/).\n```\n\n### ADR Parsing\n\nEach ADR is parsed to extract:\n- **Number**: From filename (NNNN-title.md)\n- **Title**: From H1 heading\n- **Status**: From frontmatter or status line\n- **Date**: From frontmatter or content\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                   ADR INTEGRATION                            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nADR File:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ # ADR-0001: Use PostgreSQL         â”‚ â†’ Title\nâ”‚                                    â”‚\nâ”‚ * Status: accepted                 â”‚ â†’ Status\nâ”‚ * Date: 2024-01-15                â”‚ â†’ Date\nâ”‚                                    â”‚\nâ”‚ ## Context                         â”‚\nâ”‚ ...                                â”‚ â†’ Summary (first paragraph)\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â–¼\nREADME Architecture Section:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ ## Architecture                    â”‚\nâ”‚                                    â”‚\nâ”‚ ### Key Decisions                  â”‚\nâ”‚ | ADR | Title | Status |           â”‚\nâ”‚ |-----|-------|--------|           â”‚\nâ”‚ | 0001 | Use PostgreSQL | âœ“ |      â”‚ â† Linked entry\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Available Sections\n\n### `overview`\nProject description from package file or first file comment.\n\n### `installation`\nPackage manager commands, system requirements, prerequisites.\n\n### `quickstart`\nMinimal example to get started quickly.\n\n### `usage`\nDetailed usage examples, CLI commands, API examples.\n\n### `configuration`\nEnvironment variables, config files, options.\n\n### `api`\nPublic API documentation (if detected).\n\n### `architecture`\nADR links, system diagrams (if available).\n\n### `development`\nSetup for contributors, build commands.\n\n### `testing`\nHow to run tests, coverage.\n\n### `contributing`\nLink to CONTRIBUTING.md or generated guidelines.\n\n### `license`\nLicense information.\n\n## Output\n\n### Success (New README)\n\n```\nInfo: Generating README for project\n\nREADME Generation\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Project:    my-awesome-project\n  Type:       Node.js (npm)\n  Output:     README.md\n\nSections Generated:\n  âœ“ Overview (from package.json)\n  âœ“ Installation\n  âœ“ Quick Start\n  âœ“ Usage (CLI detected)\n  âœ“ Configuration (3 env vars found)\n  âœ“ Architecture (4 ADRs linked)\n  âœ“ Development\n  âœ“ Testing (jest)\n  âœ“ License (MIT)\n\nâœ“ README generated successfully\n\nOutput: README.md (287 lines)\n```\n\n### Success (Update)\n\n```\nInfo: Updating README\n\nREADME Update\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Existing:   README.md (312 lines)\n  Mode:       Update with preserve\n\nSections:\n  â†» Overview - Updated\n  â†» Installation - Updated (added Docker)\n  âœ“ Quick Start - Preserved (manual)\n  â†» Usage - Updated\n  â†» Architecture - Updated (1 new ADR)\n  âœ“ Acknowledgments - Preserved (manual)\n\nâœ“ README updated successfully\n\nChanges: 4 sections updated, 2 preserved\nOutput: README.md (328 lines)\n```\n\n## Requirements\n\n- Git repository with valid worktree\n- Write access to output location\n- At least one parseable project file (package.json, etc.)\n\n## Exit Codes\n\n- `0` - README generated/updated successfully\n- `1` - Generation failed\n- `2` - No project metadata found\n- `3` - Output location not writable\n\n## Related Skills\n\n- `/bkff:writeadr` - Write architectural decision records\n- `/bkff:chkcompliance` - Check repository compliance\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\n\n# Parse arguments\nupdate_mode=\"false\"\nsections=\"\"\noutput_file=\"README.md\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --update=*) update_mode=\"${arg#--update=}\" ;;\n        --sections=*) sections=\"${arg#--sections=}\" ;;\n        --output=*) output_file=\"${arg#--output=}\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\n\nroot=$(get_worktree_path)\noutput_path=\"$root/$output_file\"\n\ninfo \"Generating README for project\"\n\n# Detect project type\ndetect_project_type() {\n    if [[ -f \"$root/package.json\" ]]; then\n        echo \"nodejs\"\n    elif [[ -f \"$root/pyproject.toml\" ]] || [[ -f \"$root/setup.py\" ]]; then\n        echo \"python\"\n    elif [[ -f \"$root/Cargo.toml\" ]]; then\n        echo \"rust\"\n    elif [[ -f \"$root/go.mod\" ]]; then\n        echo \"go\"\n    elif [[ -f \"$root/pom.xml\" ]] || [[ -f \"$root/build.gradle\" ]]; then\n        echo \"java\"\n    else\n        echo \"unknown\"\n    fi\n}\n\n# Check for ADRs\nhas_adrs() {\n    [[ -d \"$root/docs/adr\" ]] && ls \"$root/docs/adr\"/*.md &>/dev/null\n}\n\n# Get existing preserved sections if updating\nif [[ \"$update_mode\" == \"true\" && -f \"$output_path\" ]]; then\n    info \"Update mode: preserving marked sections\"\nfi\n\n# README generation is performed by Claude analyzing the codebase\n# and generating appropriate markdown content\necho \"Analysis ready. Generate README content based on project structure.\"\n```\n",
        "plugins/bkff/skills/gentests/SKILL.md": "---\nname: gentests\ndescription: Generate unit tests for code based on structure and acceptance criteria\ninvocation: /bkff:gentests\narguments:\n  - name: file\n    description: Source file or directory to generate tests for\n    required: true\n  - name: framework\n    description: Test framework to use (auto-detected if not specified)\n    required: false\n  - name: update\n    description: Update existing tests instead of creating new ones\n    required: false\n    default: \"false\"\n  - name: coverage\n    description: Target coverage percentage (default: 80)\n    required: false\n    default: \"80\"\n---\n\n# Generate Unit Tests\n\nGenerates unit tests for newly implemented code based on code structure, acceptance criteria, and testing best practices. Automatically detects the appropriate test framework based on the project's existing configuration.\n\n## Usage\n\n```bash\n# Generate tests for a specific file\n/bkff:gentests --file=src/lib/compliance.sh\n\n# Generate tests for a directory\n/bkff:gentests --file=src/services/\n\n# Specify test framework\n/bkff:gentests --file=src/app.py --framework=pytest\n\n# Update existing tests to cover new code paths\n/bkff:gentests --file=src/utils.ts --update=true\n\n# Target specific coverage\n/bkff:gentests --file=lib/parser.go --coverage=90\n```\n\n## Supported Languages and Frameworks\n\n| Language | Detected By | Default Framework | Supported Frameworks |\n|----------|-------------|-------------------|---------------------|\n| Bash/Shell | `.sh`, `.bash` | bats | bats, shunit2 |\n| Python | `.py` | pytest | pytest, unittest |\n| JavaScript | `.js`, `.mjs` | jest | jest, mocha, vitest |\n| TypeScript | `.ts`, `.tsx` | jest | jest, vitest |\n| Go | `.go` | go test | go test |\n| Rust | `.rs` | cargo test | cargo test |\n| Java | `.java` | junit | junit4, junit5, testng |\n| Ruby | `.rb` | rspec | rspec, minitest |\n\n### Framework Detection Logic\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                FRAMEWORK DETECTION                           â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n1. Check explicit --framework argument\n   â””â”€â”€ Use specified framework\n\n2. Check project configuration files:\n   â”œâ”€â”€ package.json â†’ jest.config, vitest.config\n   â”œâ”€â”€ pyproject.toml â†’ pytest section\n   â”œâ”€â”€ Cargo.toml â†’ Rust project\n   â”œâ”€â”€ go.mod â†’ Go module\n   â”œâ”€â”€ pom.xml / build.gradle â†’ JUnit\n   â””â”€â”€ Gemfile â†’ rspec/minitest\n\n3. Check existing test files:\n   â”œâ”€â”€ *.test.js, *.spec.js â†’ jest/mocha\n   â”œâ”€â”€ test_*.py, *_test.py â†’ pytest/unittest\n   â”œâ”€â”€ *_test.go â†’ go test\n   â””â”€â”€ *_spec.rb â†’ rspec\n\n4. Fall back to language default\n```\n\n## Test Generation Process\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                   TEST GENERATION FLOW                       â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   Analyze Source    â”‚\nâ”‚   - Parse functions â”‚\nâ”‚   - Extract types   â”‚\nâ”‚   - Find exports    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n          â”‚\n          â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Check Acceptance   â”‚\nâ”‚  - Find beads issue â”‚\nâ”‚  - Extract criteria â”‚\nâ”‚  - Map to tests     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n          â”‚\n          â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Generate Tests     â”‚\nâ”‚  - Unit tests       â”‚\nâ”‚  - Edge cases       â”‚\nâ”‚  - Error handling   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n          â”‚\n          â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Validate Tests     â”‚\nâ”‚  - Syntax check     â”‚\nâ”‚  - Import check     â”‚\nâ”‚  - Execute tests    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Test Structure\n\nGenerated tests follow best practices for each framework:\n\n### Bash (bats)\n\n```bash\n#!/usr/bin/env bats\n\nload 'test_helper/bats-support/load'\nload 'test_helper/bats-assert/load'\n\nsetup() {\n    source \"${BATS_TEST_DIRNAME}/../lib/compliance.sh\"\n}\n\n@test \"check_codeowners returns success when CODEOWNERS exists\" {\n    # Arrange\n    mkdir -p .github\n    echo \"* @owner\" > .github/CODEOWNERS\n\n    # Act & Assert\n    run check_codeowners\n    assert_success\n}\n\n@test \"check_codeowners returns failure when CODEOWNERS missing\" {\n    # Act & Assert\n    run check_codeowners\n    assert_failure\n}\n```\n\n### Python (pytest)\n\n```python\nimport pytest\nfrom src.parser import parse_config, ConfigError\n\nclass TestParseConfig:\n    \"\"\"Tests for parse_config function.\"\"\"\n\n    def test_parse_valid_config(self, tmp_path):\n        \"\"\"Should parse valid configuration file.\"\"\"\n        # Arrange\n        config_file = tmp_path / \"config.yaml\"\n        config_file.write_text(\"key: value\")\n\n        # Act\n        result = parse_config(config_file)\n\n        # Assert\n        assert result[\"key\"] == \"value\"\n\n    def test_parse_missing_file_raises_error(self):\n        \"\"\"Should raise ConfigError for missing file.\"\"\"\n        with pytest.raises(ConfigError, match=\"not found\"):\n            parse_config(\"nonexistent.yaml\")\n```\n\n### TypeScript (jest)\n\n```typescript\nimport { validateInput, ValidationError } from '../src/validator';\n\ndescribe('validateInput', () => {\n  describe('with valid input', () => {\n    it('should return validated data', () => {\n      // Arrange\n      const input = { name: 'test', value: 42 };\n\n      // Act\n      const result = validateInput(input);\n\n      // Assert\n      expect(result).toEqual({ name: 'test', value: 42 });\n    });\n  });\n\n  describe('with invalid input', () => {\n    it('should throw ValidationError for missing name', () => {\n      // Arrange\n      const input = { value: 42 };\n\n      // Act & Assert\n      expect(() => validateInput(input)).toThrow(ValidationError);\n    });\n  });\n});\n```\n\n## --update Flag Behavior\n\nWhen `--update=true` is specified:\n\n1. **Find Existing Tests**: Locate existing test files for the source\n2. **Analyze Coverage Gaps**: Identify untested code paths\n3. **Add New Test Cases**: Generate tests for uncovered scenarios\n4. **Preserve Existing Tests**: Don't modify or remove existing tests\n5. **Maintain Style**: Match existing test file style and patterns\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    UPDATE MODE                               â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nExisting Tests:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ test_function_a() âœ“    â”‚\nâ”‚ test_function_b() âœ“    â”‚\nâ”‚ test_edge_case_1() âœ“   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n          â”‚\n          â”‚ Analyze source changes\n          â–¼\nNew Code Paths Found:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ function_c() - NEW     â”‚\nâ”‚ error_handler() - NEW  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n          â”‚\n          â”‚ Generate additions\n          â–¼\nUpdated Tests:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ test_function_a() âœ“    â”‚  (preserved)\nâ”‚ test_function_b() âœ“    â”‚  (preserved)\nâ”‚ test_edge_case_1() âœ“   â”‚  (preserved)\nâ”‚ test_function_c() NEW  â”‚  (added)\nâ”‚ test_error_handler() N â”‚  (added)\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Unsupported Language Handling\n\nWhen a language is not supported or cannot be auto-detected:\n\n```\nWarning: Unable to generate tests for 'src/main.xyz'\n\nReason: Unsupported language or unknown file extension\n\nSuggestions:\n  1. Specify a test framework: --framework=<name>\n  2. Check if the file extension is correct\n  3. Manual test generation may be required\n\nSupported extensions: .sh, .bash, .py, .js, .mjs, .ts, .tsx, .go, .rs, .java, .rb\n```\n\nThe skill will:\n1. Log a warning with the file path\n2. Skip the unsupported file\n3. Continue processing other files if a directory was specified\n4. Return exit code 0 if some files were processed, 4 if none were\n\n## Output\n\n### Success\n\n```\nInfo: Generating tests for: src/lib/compliance.sh\n\nTest Generation\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Source:     src/lib/compliance.sh\n  Framework:  bats\n  Functions:  12 found\n\nGenerated Tests:\n  File: tests/test-compliance.sh\n  Tests: 24 test cases\n  Coverage: 85% (estimated)\n\nâœ“ Tests generated successfully\n\nRun tests with: bats tests/test-compliance.sh\n```\n\n### Partial Success\n\n```\nInfo: Generating tests for: src/\n\nTest Generation\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Directory:  src/\n  Files:      5 source files\n\nResults:\n  âœ“ src/parser.py â†’ tests/test_parser.py (12 tests)\n  âœ“ src/validator.py â†’ tests/test_validator.py (8 tests)\n  âš  src/legacy.py â†’ Skipped (complex dependencies)\n  âœ“ src/utils.py â†’ tests/test_utils.py (15 tests)\n  âœ— src/config.xyz â†’ Unsupported language\n\nSummary: 3 files processed, 1 skipped, 1 unsupported\n```\n\n## Requirements\n\n- Git repository with valid worktree\n- Source files in supported languages\n- Write access to test directory\n- Test framework installed (for validation)\n\n## Exit Codes\n\n- `0` - Tests generated successfully\n- `1` - Test generation failed\n- `2` - Source file not found\n- `3` - Test framework not detected\n- `4` - Unsupported language (all files)\n\n## Related Skills\n\n- `/bkff:verifytask` - Verify task completion including tests\n- `/bkff:chkcompliance` - Check repository compliance\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\n\n# Parse arguments\nsource_file=\"\"\nframework=\"\"\nupdate_mode=\"false\"\ntarget_coverage=\"80\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --file=*) source_file=\"${arg#--file=}\" ;;\n        --framework=*) framework=\"${arg#--framework=}\" ;;\n        --update=*) update_mode=\"${arg#--update=}\" ;;\n        --coverage=*) target_coverage=\"${arg#--coverage=}\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\n\nif [[ -z \"$source_file\" ]]; then\n    error_exit \"Source file required. Use --file=<path>\"\nfi\n\nroot=$(get_worktree_path)\nfull_path=\"$root/$source_file\"\n\nif [[ ! -e \"$full_path\" ]]; then\n    error_exit \"Source not found: $source_file\"\nfi\n\ninfo \"Generating tests for: $source_file\"\n\n# Detect language and framework\ndetect_language() {\n    local file=\"$1\"\n    case \"${file##*.}\" in\n        sh|bash) echo \"bash\" ;;\n        py) echo \"python\" ;;\n        js|mjs) echo \"javascript\" ;;\n        ts|tsx) echo \"typescript\" ;;\n        go) echo \"go\" ;;\n        rs) echo \"rust\" ;;\n        java) echo \"java\" ;;\n        rb) echo \"ruby\" ;;\n        *) echo \"unknown\" ;;\n    esac\n}\n\ndetect_framework() {\n    local lang=\"$1\"\n    case \"$lang\" in\n        bash) echo \"bats\" ;;\n        python) echo \"pytest\" ;;\n        javascript|typescript) echo \"jest\" ;;\n        go) echo \"gotest\" ;;\n        rust) echo \"cargo\" ;;\n        java) echo \"junit\" ;;\n        ruby) echo \"rspec\" ;;\n        *) echo \"\" ;;\n    esac\n}\n\n# Test generation is performed by Claude analyzing the source\n# and generating appropriate test code based on the detected framework\necho \"Analysis ready. Generate tests using detected framework.\"\n```\n",
        "plugins/bkff/skills/prfeedback/SKILL.md": "---\nname: prfeedback\ndescription: Parse PR review comments, categorize them, and create beads tasks for required changes\ninvocation: /bkff:prfeedback\narguments:\n  - name: pr\n    description: PR number or URL to process\n    required: true\n  - name: ready\n    description: Mark PR as ready for re-review after addressing comments\n    required: false\n    default: \"false\"\n  - name: format\n    description: Output format (human or json)\n    required: false\n    default: human\n---\n\n# Handle PR Review Feedback\n\nParses PR review comments from GitHub, categorizes them by type and priority, and creates beads tasks for required changes. Supports marking the PR ready for re-review once all blocking comments are addressed.\n\n## Usage\n\n```bash\n# Process PR feedback\n/bkff:prfeedback --pr=123\n\n# Process by URL\n/bkff:prfeedback --pr=https://github.com/owner/repo/pull/123\n\n# Mark ready for re-review after addressing comments\n/bkff:prfeedback --pr=123 --ready=true\n\n# Output as JSON for automation\n/bkff:prfeedback --pr=123 --format=json\n```\n\n## Comment Categorization Logic\n\nComments are categorized by type and priority based on content analysis:\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚               COMMENT CATEGORIZATION                         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚         FETCH PR COMMENTS          â”‚\nâ”‚  â€¢ Review comments                 â”‚\nâ”‚  â€¢ Inline code comments            â”‚\nâ”‚  â€¢ Conversation threads            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚        ANALYZE EACH COMMENT        â”‚\nâ”‚  â€¢ Extract action indicators       â”‚\nâ”‚  â€¢ Detect blocking keywords        â”‚\nâ”‚  â€¢ Identify suggestions            â”‚\nâ”‚  â€¢ Check resolution status         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚          CATEGORIZE                â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Type:                              â”‚\nâ”‚  â€¢ BLOCKING - Must fix             â”‚\nâ”‚  â€¢ SUGGESTION - Should consider    â”‚\nâ”‚  â€¢ QUESTION - Needs response       â”‚\nâ”‚  â€¢ PRAISE - No action needed       â”‚\nâ”‚  â€¢ NIT - Minor/optional            â”‚\nâ”‚                                    â”‚\nâ”‚ Priority:                          â”‚\nâ”‚  â€¢ P0 - Critical/Security          â”‚\nâ”‚  â€¢ P1 - Must fix before merge      â”‚\nâ”‚  â€¢ P2 - Should fix                 â”‚\nâ”‚  â€¢ P3 - Nice to have               â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Category Detection Rules\n\n| Category | Detected By | Priority |\n|----------|-------------|----------|\n| BLOCKING | \"must\", \"required\", \"fix\", \"blocker\", changes_requested review | P1 |\n| SECURITY | \"vulnerability\", \"security\", \"XSS\", \"injection\", \"CVE\" | P0 |\n| SUGGESTION | \"suggest\", \"consider\", \"could\", \"might\", \"optional\" | P2 |\n| QUESTION | \"?\", \"why\", \"how\", \"what\", \"can you explain\" | P2 |\n| NIT | \"nit:\", \"nitpick\", \"minor\", \"style\" | P3 |\n| PRAISE | \"LGTM\", \"nice\", \"great\", \"well done\", approved review | None |\n\n### Keyword Patterns\n\n```\nBLOCKING patterns:\n  - \"please fix\"\n  - \"this needs to\"\n  - \"must be\"\n  - \"required\"\n  - \"blocker\"\n  - \"cannot merge until\"\n  - Review state: CHANGES_REQUESTED\n\nSECURITY patterns:\n  - \"security\"\n  - \"vulnerability\"\n  - \"injection\"\n  - \"XSS\"\n  - \"CSRF\"\n  - \"authentication\"\n  - \"authorization\"\n  - \"CVE-\"\n\nSUGGESTION patterns:\n  - \"consider\"\n  - \"suggestion:\"\n  - \"you could\"\n  - \"might want to\"\n  - \"alternatively\"\n  - \"optional:\"\n\nNIT patterns:\n  - \"nit:\"\n  - \"nitpick\"\n  - \"minor:\"\n  - \"style:\"\n  - \"formatting\"\n```\n\n## Beads Task Creation for Required Changes\n\nWhen blocking or high-priority comments are found, beads tasks are created:\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                TASK CREATION FLOW                            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nCategorized Comments:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ BLOCKING: 2 comments               â”‚\nâ”‚ SECURITY: 1 comment                â”‚\nâ”‚ SUGGESTION: 3 comments             â”‚\nâ”‚ NIT: 2 comments                    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â”‚ Create tasks for P0-P2\n              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚         CREATE BEADS TASKS         â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                    â”‚\nâ”‚ bd create --type=task              â”‚\nâ”‚   --title=\"PR #123: Fix SQL        â”‚\nâ”‚            injection in query\"     â”‚\nâ”‚   --priority=0                     â”‚\nâ”‚   --description=\"...\"              â”‚\nâ”‚                                    â”‚\nâ”‚ bd create --type=task              â”‚\nâ”‚   --title=\"PR #123: Add input      â”‚\nâ”‚            validation\"             â”‚\nâ”‚   --priority=1                     â”‚\nâ”‚   --description=\"...\"              â”‚\nâ”‚                                    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â”‚ Link to parent issue\n              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚     SET DEPENDENCIES               â”‚\nâ”‚                                    â”‚\nâ”‚ â€¢ Link tasks to PR feature/epic    â”‚\nâ”‚ â€¢ Add dependency on PR approval    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Task Format\n\n```markdown\nTitle: PR #123: [Comment summary]\n\nDescription:\nFrom PR review comment by @reviewer:\n\n> [Original comment text]\n\nFile: src/api/query.ts\nLine: 42\n\nAction Required:\n[Extracted action from comment]\n\n---\nPR: https://github.com/owner/repo/pull/123\nComment: https://github.com/owner/repo/pull/123#discussion_r123456\n```\n\n### Task Creation Rules\n\n| Comment Type | Task Created | Priority |\n|--------------|--------------|----------|\n| SECURITY | Yes | P0 |\n| BLOCKING | Yes | P1 |\n| SUGGESTION (with \"should\") | Yes | P2 |\n| SUGGESTION (with \"could\") | No (logged only) | - |\n| QUESTION | No (needs response) | - |\n| NIT | No (logged only) | - |\n| PRAISE | No | - |\n\n## --ready Flag for Re-Review\n\nWhen `--ready=true` is specified:\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                  RE-REVIEW FLOW                              â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚     CHECK BLOCKING COMMENTS        â”‚\nâ”‚                                    â”‚\nâ”‚ Scan for unresolved BLOCKING and   â”‚\nâ”‚ SECURITY comments                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚                   â”‚\n    â–¼                   â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ All      â”‚     â”‚ Unresolved       â”‚\nâ”‚ Resolved â”‚     â”‚ Comments Remain  â”‚\nâ””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n     â”‚                    â”‚\n     â–¼                    â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Request      â”‚  â”‚ List unresolved  â”‚\nâ”‚ Re-review    â”‚  â”‚ Exit with error  â”‚\nâ”‚ via gh CLI   â”‚  â”‚                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nRe-review request:\n  gh pr ready 123\n  gh pr edit 123 --add-reviewer @original-reviewer\n```\n\n### Re-Review Checklist\n\nBefore marking ready:\n1. All BLOCKING comments resolved\n2. All SECURITY comments resolved\n3. All created beads tasks closed\n4. Tests passing (checked via CI status)\n5. Optional: Response to all QUESTION comments\n\n## Stale Comment Handling\n\nComments may become stale when code changes after the review:\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                 STALE DETECTION                              â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nComment on src/api/query.ts:42\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ @reviewer: \"Fix the SQL injection\" â”‚\nâ”‚ Posted: 2 days ago                 â”‚\nâ”‚ Line content: \"SELECT * FROM...\"   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â”‚ Compare with current\n              â–¼\nCurrent src/api/query.ts:42\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ // Using parameterized queries     â”‚\nâ”‚ Line changed since comment         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n              â”‚\n              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ STALE COMMENT DETECTED             â”‚\nâ”‚                                    â”‚\nâ”‚ Possible reasons:                  â”‚\nâ”‚ â€¢ Already addressed                â”‚\nâ”‚ â€¢ Code refactored                  â”‚\nâ”‚ â€¢ Line moved                       â”‚\nâ”‚                                    â”‚\nâ”‚ Action: Mark as potentially stale  â”‚\nâ”‚ Require manual verification        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Stale Indicators\n\n| Indicator | Confidence | Action |\n|-----------|------------|--------|\n| Line deleted | High | Mark as likely resolved |\n| Line content changed | Medium | Mark as potentially resolved |\n| Commit after comment | Low | Needs verification |\n| Resolved in GitHub | Certain | Skip comment |\n\n### Stale Output Format\n\n```\nStale Comments (require verification):\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  src/api/query.ts:42 - BLOCKING\n    Comment: \"Fix the SQL injection\"\n    Status: LINE_CHANGED\n    Reason: Line content no longer matches\n    Recommendation: Verify fix and resolve in GitHub\n```\n\n## Output\n\n### Human Format\n\n```\nPR Review Feedback Analysis\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nPR: #123 - Add user authentication\nAuthor: @contributor\nReviewers: @reviewer1, @reviewer2\n\nComment Summary\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  SECURITY:    1\n  BLOCKING:    2\n  SUGGESTION:  3\n  QUESTION:    1\n  NIT:         2\n  PRAISE:      1\n\nRequired Actions (tasks created)\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  âœ“ beads-abc123: PR #123: Fix SQL injection vulnerability (P0)\n  âœ“ beads-def456: PR #123: Add input validation (P1)\n  âœ“ beads-ghi789: PR #123: Handle edge case in auth flow (P1)\n\nSuggestions (logged, no task)\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  â€¢ src/auth.ts:15 - Consider using bcrypt instead of sha256\n  â€¢ src/api.ts:42 - Could add rate limiting here\n  â€¢ src/utils.ts:8 - Might want to extract this to a helper\n\nQuestions (need response)\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  â€¢ src/config.ts:22 - Why is this timeout set to 30s?\n\nStale Comments\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  âš  src/old-code.ts:10 - Line no longer exists (likely resolved)\n\nStatus: 3 blocking items require attention\n```\n\n### JSON Format\n\n```json\n{\n  \"pr\": {\n    \"number\": 123,\n    \"title\": \"Add user authentication\",\n    \"author\": \"contributor\",\n    \"reviewers\": [\"reviewer1\", \"reviewer2\"],\n    \"url\": \"https://github.com/owner/repo/pull/123\"\n  },\n  \"summary\": {\n    \"security\": 1,\n    \"blocking\": 2,\n    \"suggestion\": 3,\n    \"question\": 1,\n    \"nit\": 2,\n    \"praise\": 1\n  },\n  \"tasks_created\": [\n    {\n      \"beads_id\": \"beads-abc123\",\n      \"title\": \"PR #123: Fix SQL injection vulnerability\",\n      \"priority\": 0,\n      \"comment_url\": \"https://github.com/.../discussion_r123\"\n    }\n  ],\n  \"comments\": [\n    {\n      \"id\": \"123456\",\n      \"type\": \"SECURITY\",\n      \"priority\": 0,\n      \"file\": \"src/api/query.ts\",\n      \"line\": 42,\n      \"author\": \"reviewer1\",\n      \"body\": \"This query is vulnerable to SQL injection\",\n      \"resolved\": false,\n      \"stale\": false,\n      \"task_created\": \"beads-abc123\"\n    }\n  ],\n  \"stale_comments\": [\n    {\n      \"id\": \"789\",\n      \"reason\": \"LINE_DELETED\",\n      \"file\": \"src/old-code.ts\",\n      \"line\": 10\n    }\n  ],\n  \"ready_for_review\": false,\n  \"blocking_count\": 3\n}\n```\n\n## Requirements\n\n- Git repository with valid worktree\n- `gh` CLI authenticated with repo access\n- Beads initialized (for task creation)\n- PR must exist and be accessible\n\n## Exit Codes\n\n- `0` - Success (or ready for re-review)\n- `1` - Processing failed\n- `2` - PR not found\n- `3` - Blocking comments remain (when --ready=true)\n- `4` - gh CLI not authenticated\n\n## Related Skills\n\n- `/bkff:verifytask` - Verify task completion\n- `/bkff:tasks2issues` - Convert tasks to beads issues\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\n\n# Parse arguments\npr_ref=\"\"\nready_mode=\"false\"\nformat=\"human\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --pr=*) pr_ref=\"${arg#--pr=}\" ;;\n        --ready=*) ready_mode=\"${arg#--ready=}\" ;;\n        --format=json) format=\"json\" ;;\n        --format=human) format=\"human\" ;;\n        --json) format=\"json\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\n\nif [[ -z \"$pr_ref\" ]]; then\n    error_exit \"PR reference required. Use --pr=<number|url>\"\nfi\n\n# Extract PR number from URL if needed\npr_number=\"$pr_ref\"\nif [[ \"$pr_ref\" =~ /pull/([0-9]+) ]]; then\n    pr_number=\"${BASH_REMATCH[1]}\"\nfi\n\n# Check gh CLI\nif ! command -v gh &>/dev/null; then\n    error_exit \"GitHub CLI (gh) is required but not installed\"\nfi\n\nif ! gh auth status &>/dev/null; then\n    error_exit \"GitHub CLI not authenticated. Run 'gh auth login'\"\nfi\n\ninfo \"Processing PR #$pr_number feedback\"\n\n# Fetch PR comments using gh CLI\n# Categorization and task creation is performed by Claude\necho \"Ready to fetch and analyze PR comments via gh CLI\"\n```\n",
        "plugins/bkff/skills/startloop/SKILL.md": "---\nname: startloop\ndescription: Start the agentic development loop to autonomously work through beads issues\ninvocation: /bkff:startloop\narguments:\n  - name: resume\n    description: Resume a paused loop instead of starting new\n    required: false\n    default: false\n---\n\n# Start Agentic Development Loop\n\nInitiates an autonomous development loop that iteratively works through beads issues. The loop automatically selects the highest priority ready task (no blockers), claims it, and presents it for implementation.\n\n## Usage\n\n```bash\n# Start a new development loop\n/bkff:startloop\n\n# Resume a paused loop\n/bkff:startloop --resume\n```\n\n## How It Works\n\n1. **Task Selection**: Finds the highest priority task with no blockers (`bd ready`)\n2. **Task Claiming**: Sets the task status to `in_progress`\n3. **Work Presentation**: Displays the task details for implementation\n4. **Completion**: After work is done, verification passes, and task is closed\n5. **Iteration**: Automatically selects the next ready task\n\n## Loop Lifecycle\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    START LOOP                           â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                      â”‚\n                      â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚              SELECT READY TASK                          â”‚\nâ”‚         (highest priority, no blockers)                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                      â”‚\n           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n           â”‚                     â”‚\n           â–¼                     â–¼\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚ Task Found  â”‚       â”‚ No Tasks    â”‚\n    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜\n           â”‚                     â”‚\n           â–¼                     â–¼\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚ Claim Task  â”‚       â”‚ LOOP STOPS  â”‚\n    â”‚ (in_progressâ”‚       â”‚ (complete)  â”‚\n    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n           â”‚\n           â–¼\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚              WORK ON TASK                           â”‚\n    â”‚  â€¢ Implement changes                                â”‚\n    â”‚  â€¢ Generate tests (/bkff:gentests)                  â”‚\n    â”‚  â€¢ Run verification (/bkff:verifytask)              â”‚\n    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                          â”‚\n               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n               â”‚                     â”‚\n               â–¼                     â–¼\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n        â”‚ Success     â”‚       â”‚ Failure     â”‚\n        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜\n               â”‚                     â”‚\n               â–¼                     â–¼\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n        â”‚ Close Task  â”‚       â”‚ Retry with  â”‚\n        â”‚ Continue    â”‚â—„â”€â”€â”€â”€â”€â”€â”‚ Backoff     â”‚\n        â”‚ Loop        â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜\n        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚\n               â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”\n               â”‚              â”‚ Max Retries â”‚\n               â”‚              â”‚ Exceeded    â”‚\n               â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜\n               â”‚                     â”‚\n               â”‚                     â–¼\n               â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n               â”‚              â”‚ LOOP PAUSES â”‚\n               â”‚              â”‚ (user input)â”‚\n               â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n               â”‚\n               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                                      â”‚\n                                      â–¼\n                              (back to SELECT)\n```\n\n## Output\n\n### Starting New Loop\n\n```\nDevelopment Loop Status\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Status:         running\n  Started:        2026-01-24T10:30:00Z\n  Completed:      0 tasks\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nWorking on: T015 Implement compliance check logic\nIssue: beads-abc123\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\nThe development loop has selected this task.\nWork on implementing the task, then run verification.\nWhen complete, the loop will automatically select the next task.\n\nTo pause: /bkff:cancelloop\n```\n\n### No Ready Tasks\n\n```\nDevelopment Loop Status\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Status:         running\n  Started:        2026-01-24T10:30:00Z\n  Completed:      5 tasks\n\nInfo: No ready tasks available\nâœ“ Loop completed - all tasks done or blocked\n```\n\n### Resuming Paused Loop\n\n```\nInfo: Loop resumed\n\nDevelopment Loop Status\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Status:         running\n  Started:        2026-01-24T10:30:00Z\n  Completed:      3 tasks\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nWorking on: T018 Fix failing test\nIssue: beads-def456\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n```\n\n## State Management\n\nLoop state is persisted in `.bkff/loop-state.json`:\n\n```json\n{\n  \"status\": \"running\",\n  \"started_at\": \"2026-01-24T10:30:00Z\",\n  \"current_task\": {\n    \"beads_id\": \"beads-abc123\",\n    \"task_id\": \"T015\",\n    \"title\": \"Implement compliance check logic\",\n    \"started_at\": \"2026-01-24T10:35:00Z\"\n  },\n  \"completed_tasks\": [\n    {\n      \"beads_id\": \"beads-xyz789\",\n      \"task_id\": \"T014\",\n      \"completed_at\": \"2026-01-24T10:34:00Z\",\n      \"duration_seconds\": 240\n    }\n  ],\n  \"paused_reason\": null,\n  \"retry_count\": 0,\n  \"last_error\": null\n}\n```\n\n## Retry Behavior\n\nWhen errors occur, the loop implements exponential backoff:\n\n| Attempt | Wait Time |\n|---------|-----------|\n| 1 | 5 seconds |\n| 2 | 10 seconds |\n| 3 | 20 seconds |\n| Max | Pause loop |\n\nAfter max retries (default: 3), the loop pauses and waits for user input.\n\n## Requirements\n\n- Must be run inside a git repository\n- Beads must be initialized with tasks\n- `bd` CLI must be available\n- No other loop currently running (or use `--resume`)\n\n## Exit Codes\n\n- `0` - Loop started/resumed successfully\n- `1` - Loop paused (issue encountered)\n- `2` - No ready tasks (all done or blocked)\n- `3` - Another loop already running\n\n## Related Skills\n\n- `/bkff:cancelloop` - Stop the development loop\n- `/bkff:verifytask` - Verify task completion\n- `/bkff:gentests` - Generate tests for implemented code\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/loop-state.sh\"\n\n# Parse arguments\nresume=false\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --resume) resume=true ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\nrequire_beads\nrequire_bd\n\n# Handle resume\nif [[ \"$resume\" == \"true\" ]]; then\n    if ! has_loop; then\n        error_exit \"No loop to resume\"\n    fi\n    resume_loop\n    print_loop_status\n    run_loop_cycle\n    exit $?\nfi\n\n# Check for existing loop\nif has_loop; then\n    error_exit \"A development loop is already active. Use --resume or run /bkff:cancelloop first.\"\nfi\n\n# Initialize new loop\ninit_loop\nprint_loop_status\n\n# Start first cycle\nrun_loop_cycle\nexit_code=$?\n\ncase $exit_code in\n    0) exit 0 ;;  # Task selected, continue\n    1) exit 1 ;;  # Paused\n    2)            # No tasks\n        success \"Loop completed - all tasks done or blocked\"\n        cancel_loop\n        exit 0\n        ;;\nesac\n```\n",
        "plugins/bkff/skills/tasks2issues/SKILL.md": "---\nname: tasks2issues\ndescription: Convert SpecKit tasks.md to beads issues with proper hierarchy and dependencies\ninvocation: /bkff:tasks2issues\narguments:\n  - name: file\n    description: Path to tasks.md file (default: auto-detect from specs/)\n    required: false\n  - name: parent\n    description: Parent beads issue ID for created tasks\n    required: false\n  - name: dry-run\n    description: Parse and validate without creating issues\n    required: false\n    default: false\n---\n\n# Convert SpecKit Tasks to Beads Issues\n\nParses a SpecKit-generated tasks.md file and creates corresponding beads issues with:\n- Proper parent-child hierarchy\n- Priority mapping (P0-P4 â†’ 0-4)\n- Dependency relationships (blocks/blocked-by)\n- Phase and user story metadata\n\n## Usage\n\n```bash\n# Auto-detect tasks.md from current feature branch\n/bkff:tasks2issues\n\n# Specify tasks.md file explicitly\n/bkff:tasks2issues --file=specs/001-feature/tasks.md\n\n# Create tasks under a parent epic\n/bkff:tasks2issues --parent=beads-abc123\n\n# Preview without creating issues\n/bkff:tasks2issues --dry-run\n```\n\n## Input Format\n\nThe skill parses SpecKit tasks.md format:\n\n```markdown\n## Phase 1: Setup (Shared Infrastructure)\n\n### US1 - Check Repository Compliance\n\n- [ ] **T001**: Create plugin directory structure (P2)\n  Description of the task goes here\n  Depends on: T000\n\n- [ ] **T002**: Create plugin manifest (P2) [parallel]\n  Another task description\n```\n\n### Supported Elements\n\n| Element | Pattern | Example |\n|---------|---------|---------|\n| Phase | `## Phase N: Name` | `## Phase 1: Setup` |\n| User Story | `### USN` or `### User Story N` | `### US1 - Compliance` |\n| Task | `- [ ] **TXXX**: Title` | `- [ ] **T001**: Create structure` |\n| Priority | `(P0)` to `(P4)` | `(P2)` |\n| Parallel | `[parallel]` | `[parallel]` |\n| Dependency | `Depends on: TXXX` | `Depends on: T001, T002` |\n\n## Output\n\n### Normal Execution\n\n```\nConverting 15 tasks to beads issues\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  âœ“ T001 -> beads-abc123\n  âœ“ T002 -> beads-def456\n  âœ“ T003 -> beads-ghi789\n  ...\n\nAdding dependencies\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  âœ“ beads-def456 depends on beads-abc123\n  âœ“ beads-ghi789 depends on beads-def456\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nCreated: 15 issues\nFailed: 0 issues\nDependencies: 8 added\n```\n\n### Dry Run\n\n```\nParsed Tasks (15 total)\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\nPhase 1: Setup\n  T001 [P2] Create plugin directory structure\n  T002 [P2] Create plugin manifest (depends: T001)\n\nPhase 2: Implementation\n  T003 [P1] Implement core feature (depends: T002)\n  ...\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nValidation: OK\nDependencies: Valid (no cycles)\n\nDry run complete - no issues created\n```\n\n## Priority Mapping\n\n| tasks.md | beads |\n|----------|-------|\n| `(P0)` | Priority 0 (Critical) |\n| `(P1)` | Priority 1 (High) |\n| `(P2)` | Priority 2 (Medium) - default |\n| `(P3)` | Priority 3 (Low) |\n| `(P4)` | Priority 4 (Backlog) |\n\n## Dependency Handling\n\nDependencies are converted to beads `blocks`/`blocked-by` relationships:\n\n- `T002 depends on T001` â†’ `beads-T002` is blocked by `beads-T001`\n- Multiple dependencies supported: `Depends on: T001, T003, T005`\n\n### Validation\n\nBefore creating issues, the skill validates:\n1. All referenced dependencies exist\n2. No circular dependencies\n3. Task IDs are unique\n\n## Requirements\n\n- Must be run inside a git repository\n- Beads must be initialized (`.beads/` directory)\n- `bd` CLI must be available\n- `jq` for JSON processing\n\n## Auto-Detection\n\nWhen no `--file` is specified, the skill attempts to find tasks.md by:\n\n1. Looking for `specs/<branch-name>/tasks.md`\n2. Looking for `specs/*/tasks.md` (uses first match)\n3. Looking for `tasks.md` in repository root\n\n## Exit Codes\n\n- `0` - All tasks converted successfully\n- `1` - Some tasks failed to convert\n- `2` - Validation error (missing deps, cycles)\n- `3` - Tasks file not found\n\n## Related Skills\n\n- `/speckit.tasks` - Generate tasks.md from specification\n- `/bkff:startloop` - Start agentic development loop on created issues\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/tasks-parser.sh\"\n\n# Parse arguments\ntasks_file=\"\"\nparent_id=\"\"\ndry_run=false\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --file=*) tasks_file=\"${arg#--file=}\" ;;\n        --parent=*) parent_id=\"${arg#--parent=}\" ;;\n        --dry-run) dry_run=true ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\nrequire_beads\nrequire_jq\n\nroot=$(get_worktree_path)\n\n# Auto-detect tasks.md if not specified\nif [[ -z \"$tasks_file\" ]]; then\n    branch=$(get_current_branch)\n\n    # Try branch-specific specs\n    if [[ -f \"$root/specs/$branch/tasks.md\" ]]; then\n        tasks_file=\"$root/specs/$branch/tasks.md\"\n    # Try any specs directory\n    elif ls \"$root\"/specs/*/tasks.md &>/dev/null 2>&1; then\n        tasks_file=$(ls \"$root\"/specs/*/tasks.md 2>/dev/null | head -1)\n    # Try root\n    elif [[ -f \"$root/tasks.md\" ]]; then\n        tasks_file=\"$root/tasks.md\"\n    else\n        error_exit \"No tasks.md found. Specify with --file=<path>\"\n    fi\nfi\n\nif [[ ! -f \"$tasks_file\" ]]; then\n    error_exit \"Tasks file not found: $tasks_file\"\nfi\n\ninfo \"Using tasks file: $tasks_file\"\n\n# Parse tasks\ntasks_json=$(parse_tasks_file \"$tasks_file\")\ntask_count=$(get_task_count \"$tasks_json\")\n\nif [[ \"$task_count\" -eq 0 ]]; then\n    warn \"No tasks found in $tasks_file\"\n    exit 0\nfi\n\n# Dry run mode\nif [[ \"$dry_run\" == \"true\" ]]; then\n    print_tasks \"$tasks_json\"\n\n    echo \"\"\n    if validate_dependencies \"$tasks_json\" 2>/dev/null; then\n        echo -e \"${GREEN}Validation: OK${NC}\"\n    else\n        echo -e \"${RED}Validation: Failed (invalid dependencies)${NC}\"\n        exit 2\n    fi\n\n    if check_circular_deps \"$tasks_json\" 2>/dev/null; then\n        echo -e \"${GREEN}Dependencies: Valid (no cycles)${NC}\"\n    else\n        echo -e \"${RED}Dependencies: Circular dependency detected${NC}\"\n        exit 2\n    fi\n\n    echo \"\"\n    echo \"Dry run complete - no issues created\"\n    exit 0\nfi\n\n# Convert tasks to issues\nmapping=$(convert_tasks_to_issues \"$tasks_json\" \"$parent_id\")\n\n# Output mapping for reference\necho \"\"\necho \"Task to Issue Mapping:\"\necho \"$mapping\" | jq -r 'to_entries[] | \"  \\(.key) -> \\(.value)\"'\n```\n",
        "plugins/bkff/skills/verifybug/SKILL.md": "---\nname: verifybug\ndescription: Verify bug fix by running validate target and confirming fix\ninvocation: /bkff:verifybug\narguments:\n  - name: issue\n    description: Beads bug issue ID to verify\n    required: true\n  - name: format\n    description: Output format (human or json)\n    required: false\n    default: human\n---\n\n# Verify Bug Fix\n\nVerifies that a beads bug is fixed by:\n1. Checking acceptance criteria (reproduction steps and fix verification)\n2. Executing the build system `validate` target\n3. Confirming the bug no longer reproduces\n\n## Usage\n\n```bash\n# Verify bug fix\n/bkff:verifybug --issue=beads-abc123\n\n# Output as JSON\n/bkff:verifybug --issue=beads-abc123 --format=json\n```\n\n## Verification Process\n\n1. **Acceptance Criteria Check**: Bug must have:\n   - Reproduction steps (how to trigger the bug)\n   - Fix verification steps (how to confirm the fix)\n\n2. **Validate Target**: Runs tests to ensure:\n   - The bug no longer reproduces\n   - No regression in existing functionality\n   - Code quality standards maintained\n\n## What Gets Checked\n\nThe `validate` target for bugs should verify:\n\n| Check Type | Description |\n|------------|-------------|\n| Regression Tests | Bug-specific regression test passes |\n| Unit Tests | All related unit tests pass |\n| Quality | No new quality issues introduced |\n| Standards | Fix follows coding standards |\n\n## Output\n\n### Verification Passed\n\n```\nInfo: Verifying bug fix: beads-abc123\n\nVerification Result\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Issue:          beads-abc123\n  Target:         validate\n\nâœ“ Verification passed\n```\n\n### Verification Failed\n\n```\nInfo: Verifying bug fix: beads-abc123\n\nVerification Result\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Issue:          beads-abc123\n  Target:         validate\n\nâœ— Verification failed\n\nSummary:\n  â€¢ Tests failed: 1\n\nFailures:\n  tests/test-regression.sh:-: [test] Test failed: test_bug_123_does_not_reproduce\n```\n\n## Bug Issue Best Practices\n\nFor effective bug verification, ensure your bug issue includes:\n\n```markdown\n## Description\nClear description of the bug behavior.\n\n## Reproduction Steps\n1. Step to reproduce\n2. Step to reproduce\n3. Observe the bug\n\n## Expected Behavior\nWhat should happen instead.\n\n## Fix Verification\n1. Step to verify fix\n2. Confirm expected behavior\n3. Check no regression\n```\n\n## Requirements\n\n- Beads bug must have acceptance criteria (reproduction/verification steps)\n- Build system must have a `validate` target in Makefile\n- `bd` CLI must be available\n\n## Exit Codes\n\n- `0` - Verification passed (bug is fixed)\n- `1` - Verification failed (bug still reproduces or other failures)\n- `2` - Missing acceptance criteria\n- `3` - Missing validate target\n\n## Related Skills\n\n- `/bkff:verifytask` - Verify task completion\n- `/bkff:verifyfeat` - Verify feature completion\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/verification.sh\"\n\n# Parse arguments\nissue_id=\"\"\nformat=\"human\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --issue=*) issue_id=\"${arg#--issue=}\" ;;\n        --format=json) format=\"json\" ;;\n        --format=human) format=\"human\" ;;\n        --json) format=\"json\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\nrequire_bd\n\nif [[ -z \"$issue_id\" ]]; then\n    error_exit \"Issue ID required. Use --issue=<id>\"\nfi\n\n# Run verification\nresult=$(verify_bug \"$issue_id\")\n\n# Output based on format\nif [[ \"$format\" == \"json\" ]]; then\n    echo \"$result\"\nelse\n    echo \"$result\" | print_verification_result\nfi\n\n# Exit with appropriate code\nstatus=$(echo \"$result\" | jq -r '.status')\n[[ \"$status\" == \"pass\" ]]\n```\n",
        "plugins/bkff/skills/verifyepic/SKILL.md": "---\nname: verifyepic\ndescription: Verify epic completion by checking child features and running verify target\ninvocation: /bkff:verifyepic\narguments:\n  - name: issue\n    description: Beads epic issue ID to verify\n    required: true\n  - name: format\n    description: Output format (human or json)\n    required: false\n    default: human\n---\n\n# Verify Epic Completion\n\nVerifies that a beads epic is complete by:\n1. Checking all child features are closed\n2. Executing the build system `verify` target for epic scope\n3. Running comprehensive cross-feature validation\n\n## Usage\n\n```bash\n# Verify epic\n/bkff:verifyepic --issue=beads-abc123\n\n# Output as JSON\n/bkff:verifyepic --issue=beads-abc123 --format=json\n```\n\n## Verification Process\n\n1. **Acceptance Criteria Check**: Epic must have defined acceptance criteria\n2. **Child Features Check**: All child features must be in 'closed' status\n3. **Verify Target**: Run comprehensive verification for epic scope\n\n## What Gets Checked\n\nThe `verify` target at epic scope should run:\n\n| Check Type | Description |\n|------------|-------------|\n| Cross-Feature Tests | Integration across all features |\n| Epic Documentation | Epic-level documentation complete |\n| System Integration | End-to-end system tests |\n| All feature checks | Everything from feature verification |\n\n## Output\n\n### With Open Child Features\n\n```\nWarning: Epic has 3 open child feature(s)\n\nVerification Result\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Issue:          beads-abc123\n  Target:         verify\n\nâœ— Verification failed\n\nSummary:\n\nFailures:\n  beads:-: [standards] Epic has 3 open child feature(s) that must be completed first\n```\n\n### Verification Passed\n\n```\nInfo: Verifying epic: beads-abc123\n\nVerification Result\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Issue:          beads-abc123\n  Target:         verify\n\nâœ“ Verification passed\n```\n\n## Requirements\n\n- Beads epic must have acceptance criteria defined\n- All child features must be in 'closed' status\n- Build system must have a `verify` target in Makefile\n- `bd` CLI must be available\n\n## Exit Codes\n\n- `0` - Verification passed\n- `1` - Verification failed\n- `2` - Missing acceptance criteria\n- `3` - Missing verify target\n\n## Related Skills\n\n- `/bkff:verifytask` - Verify task completion\n- `/bkff:verifyfeat` - Verify feature completion\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/verification.sh\"\n\n# Parse arguments\nissue_id=\"\"\nformat=\"human\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --issue=*) issue_id=\"${arg#--issue=}\" ;;\n        --format=json) format=\"json\" ;;\n        --format=human) format=\"human\" ;;\n        --json) format=\"json\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\nrequire_bd\n\nif [[ -z \"$issue_id\" ]]; then\n    error_exit \"Issue ID required. Use --issue=<id>\"\nfi\n\n# Run verification\nresult=$(verify_epic \"$issue_id\")\n\n# Output based on format\nif [[ \"$format\" == \"json\" ]]; then\n    echo \"$result\"\nelse\n    echo \"$result\" | print_verification_result\nfi\n\n# Exit with appropriate code\nstatus=$(echo \"$result\" | jq -r '.status')\n[[ \"$status\" == \"pass\" ]]\n```\n",
        "plugins/bkff/skills/verifyfeat/SKILL.md": "---\nname: verifyfeat\ndescription: Verify feature completion by checking child tasks and running verify target\ninvocation: /bkff:verifyfeat\narguments:\n  - name: issue\n    description: Beads feature issue ID to verify\n    required: true\n  - name: format\n    description: Output format (human or json)\n    required: false\n    default: human\n---\n\n# Verify Feature Completion\n\nVerifies that a beads feature is complete by:\n1. Checking all child tasks are closed\n2. Executing the build system `verify` target\n3. Running comprehensive validation including integration tests\n\n## Usage\n\n```bash\n# Verify feature\n/bkff:verifyfeat --issue=beads-abc123\n\n# Output as JSON\n/bkff:verifyfeat --issue=beads-abc123 --format=json\n```\n\n## Verification Process\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚            CHECK ACCEPTANCE CRITERIA                    â”‚\nâ”‚         (must be defined on the feature)                â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                      â”‚\n                      â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚              CHECK CHILD TASKS                          â”‚\nâ”‚         (all must be in 'closed' status)                â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                      â”‚\n           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n           â”‚                     â”‚\n           â–¼                     â–¼\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚ All Closed  â”‚       â”‚ Open Tasks  â”‚\n    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜\n           â”‚                     â”‚\n           â–¼                     â–¼\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚ Run verify  â”‚       â”‚ FAIL        â”‚\n    â”‚ target      â”‚       â”‚ (list open) â”‚\n    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n           â”‚\n           â–¼\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚              VERIFICATION RESULT                    â”‚\n    â”‚  (pass/fail based on verify target exit code)       â”‚\n    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## What Gets Checked\n\nThe `verify` target should run comprehensive validation:\n\n| Check Type | Description |\n|------------|-------------|\n| Integration Tests | Cross-component tests |\n| Feature Documentation | Feature-level docs complete |\n| API Contracts | API compatibility verified |\n| Performance | Performance benchmarks (if defined) |\n| All validate checks | Tests, quality, security, standards |\n\n## Output\n\n### With Open Child Tasks\n\n```\nWarning: Feature has 2 open child task(s)\n\nVerification Result\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Issue:          beads-abc123\n  Target:         verify\n\nâœ— Verification failed\n\nSummary:\n\nFailures:\n  beads:-: [standards] Feature has 2 open child task(s) that must be completed first\n```\n\n### Verification Passed\n\n```\nInfo: Verifying feature: beads-abc123\n\nVerification Result\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Issue:          beads-abc123\n  Target:         verify\n\nâœ“ Verification passed\n```\n\n## Requirements\n\n- Beads feature must have acceptance criteria defined\n- All child tasks must be in 'closed' status\n- Build system must have a `verify` target in Makefile\n- `bd` CLI must be available\n\n## Exit Codes\n\n- `0` - Verification passed\n- `1` - Verification failed (open children or verify target failed)\n- `2` - Missing acceptance criteria\n- `3` - Missing verify target\n\n## Related Skills\n\n- `/bkff:verifytask` - Verify task completion\n- `/bkff:verifyepic` - Verify epic completion\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/verification.sh\"\n\n# Parse arguments\nissue_id=\"\"\nformat=\"human\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --issue=*) issue_id=\"${arg#--issue=}\" ;;\n        --format=json) format=\"json\" ;;\n        --format=human) format=\"human\" ;;\n        --json) format=\"json\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\nrequire_bd\n\nif [[ -z \"$issue_id\" ]]; then\n    error_exit \"Issue ID required. Use --issue=<id>\"\nfi\n\n# Run verification\nresult=$(verify_feature \"$issue_id\")\n\n# Output based on format\nif [[ \"$format\" == \"json\" ]]; then\n    echo \"$result\"\nelse\n    echo \"$result\" | print_verification_result\nfi\n\n# Exit with appropriate code\nstatus=$(echo \"$result\" | jq -r '.status')\n[[ \"$status\" == \"pass\" ]]\n```\n",
        "plugins/bkff/skills/verifytask/SKILL.md": "---\nname: verifytask\ndescription: Verify task completion by running build system validate target\ninvocation: /bkff:verifytask\narguments:\n  - name: issue\n    description: Beads issue ID to verify (default: current task from loop)\n    required: false\n  - name: format\n    description: Output format (human or json)\n    required: false\n    default: human\n---\n\n# Verify Task Completion\n\nVerifies that a beads task is complete by executing the build system `validate` target. Checks acceptance criteria and runs tests, code quality, documentation, security, and standards checks.\n\n## Usage\n\n```bash\n# Verify specific task\n/bkff:verifytask --issue=beads-abc123\n\n# Verify current task from development loop\n/bkff:verifytask\n\n# Output as JSON (for agent consumption)\n/bkff:verifytask --format=json\n```\n\n## What Gets Checked\n\nThe `validate` target should run:\n\n| Check Type | Description |\n|------------|-------------|\n| Tests | Unit tests, integration tests |\n| Quality | Linting, static analysis (shellcheck, eslint, etc.) |\n| Docs | Documentation completeness |\n| Security | Security scanning, vulnerability checks |\n| Standards | Code standards, formatting |\n\n## Output\n\n### Human-Readable (Pass)\n\n```\nInfo: Verifying task: beads-abc123\n\nVerification Result\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Issue:          beads-abc123\n  Target:         validate\n\nâœ“ Verification passed\n```\n\n### Human-Readable (Fail)\n\n```\nInfo: Verifying task: beads-abc123\n\nVerification Result\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Issue:          beads-abc123\n  Target:         validate\n\nâœ— Verification failed\n\nSummary:\n  â€¢ Tests failed: 2\n  â€¢ Quality errors: 1\n\nFailures:\n  tests/test-compliance.sh:-: [test] Test failed: test_check_file_exists\n  lib/compliance.sh:42: [quality] SC2086: Double quote to prevent globbing\n```\n\n### JSON Format\n\n```json\n{\n  \"issue_id\": \"beads-abc123\",\n  \"issue_type\": \"task\",\n  \"target\": \"validate\",\n  \"status\": \"fail\",\n  \"timestamp\": \"2026-01-24T12:00:00Z\",\n  \"acceptance_criteria_checked\": true,\n  \"failures\": [\n    {\n      \"file\": \"lib/compliance.sh\",\n      \"line\": 42,\n      \"type\": \"quality\",\n      \"severity\": \"error\",\n      \"message\": \"SC2086: Double quote to prevent globbing\",\n      \"hint\": null\n    }\n  ],\n  \"summary\": {\n    \"tests\": {\"passed\": 0, \"failed\": 2},\n    \"quality\": {\"errors\": 1, \"warnings\": 0},\n    \"docs\": {\"complete\": true},\n    \"security\": {\"issues\": 0}\n  }\n}\n```\n\n## Requirements\n\n- Beads issue must have acceptance criteria defined\n- Build system must have a `validate` target in Makefile\n- `bd` CLI must be available\n\n## Exit Codes\n\n- `0` - Verification passed\n- `1` - Verification failed\n- `2` - Missing acceptance criteria\n- `3` - Missing validate target\n\n## Related Skills\n\n- `/bkff:verifyfeat` - Verify feature completion\n- `/bkff:verifyepic` - Verify epic completion\n- `/bkff:verifybug` - Verify bug fix\n\n## Implementation\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\nsource \"$PLUGIN_DIR/lib/verification.sh\"\nsource \"$PLUGIN_DIR/lib/loop-state.sh\"\n\n# Parse arguments\nissue_id=\"\"\nformat=\"human\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --issue=*) issue_id=\"${arg#--issue=}\" ;;\n        --format=json) format=\"json\" ;;\n        --format=human) format=\"human\" ;;\n        --json) format=\"json\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\nrequire_bd\n\n# Get issue ID from current task if not specified\nif [[ -z \"$issue_id\" ]]; then\n    current=$(get_current_task 2>/dev/null || echo \"null\")\n    if [[ \"$current\" != \"null\" && -n \"$current\" ]]; then\n        issue_id=$(echo \"$current\" | jq -r '.beads_id // empty')\n    fi\nfi\n\nif [[ -z \"$issue_id\" ]]; then\n    error_exit \"No issue specified. Use --issue=<id> or run from within a development loop.\"\nfi\n\n# Run verification\nresult=$(verify_task \"$issue_id\")\n\n# Output based on format\nif [[ \"$format\" == \"json\" ]]; then\n    echo \"$result\"\nelse\n    echo \"$result\" | print_verification_result\nfi\n\n# Exit with appropriate code\nstatus=$(echo \"$result\" | jq -r '.status')\n[[ \"$status\" == \"pass\" ]]\n```\n",
        "plugins/bkff/skills/writeadr/SKILL.md": "---\nname: writeadr\ndescription: Generate MADR-format Architectural Decision Records using a multi-agent pipeline\ninvocation: /bkff:writeadr\narguments:\n  - name: decision\n    description: Brief description of the architectural decision to document\n    required: true\n  - name: context\n    description: Additional context or constraints for the ADR\n    required: false\n  - name: sources\n    description: Comma-separated list of grounding source files or directories\n    required: false\n    default: \".\"\n  - name: output\n    description: Output directory for ADRs (default: docs/adr)\n    required: false\n    default: docs/adr\n---\n\n# Write Architectural Decision Record\n\nGenerates high-quality Architectural Decision Records (ADRs) using the MADR (Markdown Architectural Decision Records) template through a multi-agent pipeline.\n\n## Usage\n\n```bash\n# Basic usage\n/bkff:writeadr --decision=\"Use PostgreSQL for primary data storage\"\n\n# With context and specific sources\n/bkff:writeadr --decision=\"Implement event sourcing\" --context=\"High audit requirements\" --sources=\"src/domain,docs/requirements.md\"\n\n# Custom output directory\n/bkff:writeadr --decision=\"Adopt microservices\" --output=\"architecture/decisions\"\n```\n\n## Multi-Agent Pipeline\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     ADR GENERATION PIPELINE                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    1. ADR Writer Agent                       â”‚\nâ”‚  â€¢ Analyzes codebase and context                            â”‚\nâ”‚  â€¢ Generates initial ADR content using MADR template        â”‚\nâ”‚  â€¢ Documents options, decision drivers, and consequences    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                      â”‚\n                      â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                   2. ADR Validator Agent                     â”‚\nâ”‚  â€¢ Validates claims against grounding sources               â”‚\nâ”‚  â€¢ Checks technical accuracy                                â”‚\nâ”‚  â€¢ Identifies unsupported assertions                        â”‚\nâ”‚  â€¢ Suggests corrections or clarifications                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                      â”‚\n                      â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                  3. ADR Formatter Agent                      â”‚\nâ”‚  â€¢ Assigns sequential ADR number                            â”‚\nâ”‚  â€¢ Formats for consistency with existing ADRs               â”‚\nâ”‚  â€¢ Generates final markdown output                          â”‚\nâ”‚  â€¢ Creates index entry if needed                            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                      â”‚\n                      â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     OUTPUT                                   â”‚\nâ”‚  â€¢ ADR file: docs/adr/NNNN-decision-title.md                â”‚\nâ”‚  â€¢ Updated index (if exists)                                â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## MADR Template\n\nThe generated ADRs follow the MADR template:\n\n```markdown\n# [ADR-NNNN] Title\n\n* Status: [proposed | accepted | deprecated | superseded]\n* Date: YYYY-MM-DD\n* Deciders: [list of people involved]\n* Technical Story: [optional link to issue/story]\n\n## Context and Problem Statement\n\n[Describe the context and problem]\n\n## Decision Drivers\n\n* [driver 1]\n* [driver 2]\n\n## Considered Options\n\n* [option 1]\n* [option 2]\n* [option 3]\n\n## Decision Outcome\n\nChosen option: \"[option N]\", because [justification].\n\n### Positive Consequences\n\n* [e.g., improvement of quality attribute satisfaction]\n\n### Negative Consequences\n\n* [e.g., compromising quality attribute, follow-up decisions required]\n\n## Pros and Cons of the Options\n\n### [option 1]\n\n[description]\n\n* Good, because [argument a]\n* Bad, because [argument b]\n\n### [option 2]\n\n[description]\n\n* Good, because [argument a]\n* Bad, because [argument b]\n\n## Links\n\n* [Link type] [Link to ADR]\n* ...\n```\n\n## Output\n\n### Success\n\n```\nInfo: Generating ADR for decision: Use PostgreSQL for primary data storage\n\nPipeline Progress\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Writer:     âœ“ Draft generated\n  Validator:  âœ“ Claims verified (3 sources checked)\n  Formatter:  âœ“ ADR-0005 created\n\nâœ“ ADR generated successfully\n\nOutput: docs/adr/0005-use-postgresql-for-primary-data-storage.md\n```\n\n### Validation Warnings\n\n```\nInfo: Generating ADR for decision: Use PostgreSQL for primary data storage\n\nPipeline Progress\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  Writer:     âœ“ Draft generated\n  Validator:  âš  2 claims need verification\n              - \"PostgreSQL supports 10M TPS\" - not found in sources\n              - \"License is MIT\" - actually PostgreSQL License\n\nValidation warnings incorporated into final ADR.\n\nâœ“ ADR generated with notes\n\nOutput: docs/adr/0005-use-postgresql-for-primary-data-storage.md\n```\n\n## Requirements\n\n- Git repository with valid worktree\n- Write access to output directory\n- Optional: Existing ADRs for sequential numbering\n\n## Exit Codes\n\n- `0` - ADR generated successfully\n- `1` - Generation failed\n- `2` - Invalid decision description\n- `3` - Output directory not writable\n\n## Related Skills\n\n- `/bkff:chkcompliance` - Check repository compliance\n- `/bkff:verifytask` - Verify task completion\n\n## Implementation\n\nThis skill orchestrates three specialized agents in sequence:\n\n1. **adr-writer**: Generates initial ADR content\n2. **adr-validator**: Validates claims against sources\n3. **adr-formatter**: Assigns numbers and formats output\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPLUGIN_DIR=\"$(dirname \"$(dirname \"$SCRIPT_DIR\")\")\"\nsource \"$PLUGIN_DIR/lib/common.sh\"\n\n# Parse arguments\ndecision=\"\"\ncontext=\"\"\nsources=\".\"\noutput_dir=\"docs/adr\"\n\nfor arg in \"$@\"; do\n    case \"$arg\" in\n        --decision=*) decision=\"${arg#--decision=}\" ;;\n        --context=*) context=\"${arg#--context=}\" ;;\n        --sources=*) sources=\"${arg#--sources=}\" ;;\n        --output=*) output_dir=\"${arg#--output=}\" ;;\n    esac\ndone\n\n# Validate prerequisites\nrequire_worktree\n\nif [[ -z \"$decision\" ]]; then\n    error_exit \"Decision description required. Use --decision=\\\"...\\\"\"\nfi\n\n# Ensure output directory exists\nroot=$(get_worktree_path)\nmkdir -p \"$root/$output_dir\"\n\ninfo \"Generating ADR for decision: $decision\"\n\n# Pipeline execution is handled by Claude invoking the agents in sequence:\n# 1. bkff:adr-writer - generates initial content\n# 2. bkff:adr-validator - validates claims\n# 3. bkff:adr-formatter - formats and numbers\n\n# The orchestration is performed by Claude based on this skill's instructions\necho \"Pipeline ready. Invoke agents: adr-writer -> adr-validator -> adr-formatter\"\n```\n"
      },
      "plugins": [
        {
          "name": "bkff-git",
          "source": "./plugins/bkff-git",
          "description": "Git lifecycle commands for worktree-based development: status, branch, commit, sync, and PR management",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add kbrockhoff/brockhoff-tools-claude",
            "/plugin install bkff-git@brockhoff-tools"
          ]
        },
        {
          "name": "bkff",
          "source": "./plugins/bkff",
          "description": "Spec-driven development workflows: compliance checking, task-to-issue conversion, agentic development loops, verification skills, ADR generation, test generation, README generation, and PR feedback handling",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add kbrockhoff/brockhoff-tools-claude",
            "/plugin install bkff@brockhoff-tools"
          ]
        }
      ]
    }
  ]
}