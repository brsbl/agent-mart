{
  "author": {
    "id": "choam2426",
    "display_name": "Yonghun Shin",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/117963215?u=7c192a79eb1edd62ce6c562b90546cda79704469&v=4",
    "url": "https://github.com/choam2426",
    "bio": null,
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 0,
      "total_stars": 11,
      "total_forks": 0
    }
  },
  "marketplaces": [
    {
      "name": "cmdlens-marketplace",
      "version": null,
      "description": "CmdLens - Bash command explanation plugin",
      "owner_info": {
        "name": "choam2426"
      },
      "keywords": [],
      "repo_full_name": "choam2426/CmdLens",
      "repo_url": "https://github.com/choam2426/CmdLens",
      "repo_description": null,
      "homepage": null,
      "signals": {
        "stars": 11,
        "forks": 0,
        "pushed_at": "2026-01-28T12:34:01Z",
        "created_at": "2026-01-19T13:51:05Z",
        "license": "Apache-2.0"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 573
        },
        {
          "path": "plugins",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/cmdlens",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/cmdlens/.claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/cmdlens/.claude-plugin/plugin.json",
          "type": "blob",
          "size": 242
        },
        {
          "path": "plugins/cmdlens/hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "plugins/cmdlens/hooks/hooks.json",
          "type": "blob",
          "size": 438
        },
        {
          "path": "plugins/cmdlens/hooks/pre_tool_use.py",
          "type": "blob",
          "size": 5724
        },
        {
          "path": "plugins/cmdlens/hooks/session_start.py",
          "type": "blob",
          "size": 1511
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"cmdlens-marketplace\",\n  \"owner\": {\n    \"name\": \"choam2426\"\n  },\n  \"metadata\": {\n    \"description\": \"CmdLens - Bash command explanation plugin\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"cmdlens\",\n      \"source\": \"./plugins/cmdlens\",\n      \"description\": \"Displays risk level and recovery info before every Bash command execution\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"choam2426\"\n      },\n      \"keywords\": [\n        \"bash\",\n        \"safety\",\n        \"explanation\"\n      ],\n      \"license\": \"Apache-2.0\"\n    }\n  ]\n}",
        "plugins/cmdlens/.claude-plugin/plugin.json": "{\n  \"name\": \"cmdlens\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Displays risk level and recovery info before every Bash command execution\",\n  \"author\": {\n    \"name\": \"choam2426\"\n  },\n  \"license\": \"Apache-2.0\",\n  \"hooks\": \"./hooks/hooks.json\"\n}",
        "plugins/cmdlens/hooks/hooks.json": "{\n  \"hooks\": {\n    \"SessionStart\": [{\n      \"matcher\": \"*\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python \\\"${CLAUDE_PLUGIN_ROOT}/hooks/session_start.py\\\"\",\n        \"timeout\": 5000\n      }]\n    }],\n    \"PreToolUse\": [{\n      \"matcher\": \"Bash\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python \\\"${CLAUDE_PLUGIN_ROOT}/hooks/pre_tool_use.py\\\"\",\n        \"timeout\": 3000\n      }]\n    }]\n  }\n}\n",
        "plugins/cmdlens/hooks/pre_tool_use.py": "#!/usr/bin/env python3\n\"\"\"CmdLens PreToolUse Hook\n\nParses risk level and recovery info from description field when Bash tool is called\nand displays it via systemMessage to the user.\n\"\"\"\n\nimport json\nimport re\nimport sys\nimport unicodedata\n\n\ndef get_display_width(text: str) -> int:\n    \"\"\"Calculate display width accounting for wide characters (emojis, CJK, etc.).\"\"\"\n    width = 0\n    for char in text:\n        # East Asian Width: F(ull), W(ide) = 2, others = 1\n        ea_width = unicodedata.east_asian_width(char)\n        if ea_width in ('F', 'W'):\n            width += 2\n        # Emojis and other symbols often have width 2\n        elif unicodedata.category(char) in ('So', 'Sk', 'Sm'):\n            width += 2\n        else:\n            width += 1\n    return width\n\n\ndef pad_to_width(text: str, target_width: int) -> str:\n    \"\"\"Pad text with spaces to reach target display width.\"\"\"\n    current_width = get_display_width(text)\n    padding = target_width - current_width\n    return text + \" \" * max(0, padding)\n\n\ndef parse_description(description: str) -> dict:\n    \"\"\"Parse description field and return structured information.\n\n    Expected format: [RiskLevel] Description | Recovery: RecoveryMethod\n    \"\"\"\n    result = {\n        \"risk_level\": None,\n        \"explanation\": None,\n        \"recovery\": None\n    }\n\n    if not description:\n        return result\n\n    # Parse risk level: [Safe], [Caution], [Danger]\n    risk_match = re.match(r'\\[(Safe|Caution|Danger)\\]\\s*(.+)', description, re.IGNORECASE)\n    if risk_match:\n        result[\"risk_level\"] = risk_match.group(1).capitalize()\n        rest = risk_match.group(2)\n    else:\n        rest = description\n\n    # Parse recovery info: | Recovery: ... or | ë³µêµ¬: ...\n    recovery_match = re.search(r'\\|\\s*(?:Recovery|ë³µêµ¬):\\s*(.+)$', rest, re.IGNORECASE)\n    if recovery_match:\n        result[\"recovery\"] = recovery_match.group(1).strip()\n        rest = rest[:recovery_match.start()].strip()\n\n    result[\"explanation\"] = rest.strip() if rest.strip() else None\n\n    return result\n\n\ndef get_risk_icon(risk_level: str | None) -> str:\n    \"\"\"Return icon for risk level.\"\"\"\n    icons = {\n        \"Safe\": \"ğŸŸ¢\",\n        \"Caution\": \"ğŸŸ¡\",\n        \"Danger\": \"ğŸ”´\"\n    }\n    return icons.get(risk_level, \"âšª\")\n\n\ndef format_message(command: str, parsed: dict) -> str:\n    \"\"\"Format parsed info into a message for display.\"\"\"\n    # Truncate long commands (max 40 chars)\n    if len(command) > 40:\n        display_cmd = command[:37] + \"...\"\n    else:\n        display_cmd = command\n\n    lines = [\"\", \"â”Œâ”€ ğŸ” CmdLens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"]\n    lines.append(f\"â”‚ {display_cmd}\")\n    lines.append(\"â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\")\n\n    if parsed[\"explanation\"]:\n        lines.append(f\"â”‚ ğŸ“‹ {parsed['explanation']}\")\n\n    if parsed[\"risk_level\"]:\n        icon = get_risk_icon(parsed[\"risk_level\"])\n        lines.append(f\"â”‚ âš ï¸  Risk: {icon} {parsed['risk_level']}\")\n\n    if parsed[\"recovery\"]:\n        lines.append(f\"â”‚ ğŸ’¡ Recovery: {parsed['recovery']}\")\n\n    lines.append(\"â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\")\n\n    return \"\\n\".join(lines)\n\n\ndef main() -> None:\n    try:\n        hook_input = json.load(sys.stdin)\n    except json.JSONDecodeError:\n        # Default behavior on JSON parse failure\n        output = {\"continue\": True}\n        print(json.dumps(output))\n        return\n\n    tool_input = hook_input.get(\"tool_input\", {})\n    command = tool_input.get(\"command\", \"\")\n    description = tool_input.get(\"description\", \"\")\n\n    # Truncate long commands for display\n    if len(command) > 40:\n        display_cmd = command[:37] + \"...\"\n    else:\n        display_cmd = command\n\n    # New format (starts with ğŸ“‹): parse and display each part on separate lines\n    if description.startswith(\"ğŸ“‹\"):\n        # Parse: ğŸ“‹ desc | ğŸŸ¢ Safe | ğŸ’¡ Recovery: ...\n        parts = [p.strip() for p in description.split(\"|\")]\n        desc_part = parts[0] if len(parts) > 0 else \"\"\n        risk_part = parts[1] if len(parts) > 1 else \"\"\n        recovery_part = parts[2] if len(parts) > 2 else \"\"\n\n        # Format risk part\n        if risk_part:\n            risk_part = f\"âš ï¸  Risk: {risk_part}\"\n\n        # Calculate max width for box\n        content_lines = [display_cmd, desc_part, risk_part, recovery_part]\n        content_lines = [l for l in content_lines if l]\n        max_width = max(get_display_width(line) for line in content_lines)\n        box_width = max_width + 2\n\n        lines = [\"\"]\n        lines.append(\"â”Œâ”€ ğŸ” CmdLens \" + \"â”€\" * (box_width - 11) + \"â”\")\n        lines.append(f\"â”‚ {pad_to_width(display_cmd, max_width)} â”‚\")\n        lines.append(\"â”œ\" + \"â”€\" * box_width + \"â”¤\")\n        lines.append(f\"â”‚ {pad_to_width(desc_part, max_width)} â”‚\")\n        if risk_part:\n            lines.append(f\"â”‚ {pad_to_width(risk_part, max_width)} â”‚\")\n        if recovery_part:\n            lines.append(f\"â”‚ {pad_to_width(recovery_part, max_width)} â”‚\")\n        lines.append(\"â””\" + \"â”€\" * box_width + \"â”˜\")\n        message = \"\\n\".join(lines)\n    elif description:\n        # Legacy format: parse and display\n        parsed = parse_description(description)\n        message = format_message(command, parsed)\n    else:\n        message = f\"[CmdLens] Executing: {display_cmd}\"\n\n    output = {\n        \"continue\": True,\n        \"systemMessage\": message\n    }\n\n    print(json.dumps(output, ensure_ascii=False))\n\n\nif __name__ == \"__main__\":\n    main()\n",
        "plugins/cmdlens/hooks/session_start.py": "#!/usr/bin/env python3\n\"\"\"CmdLens SessionStart Hook\n\nClaude Code ì„¸ì…˜ ì‹œì‘ ì‹œ additionalContextë¥¼ ì£¼ì…í•˜ì—¬\nBash ë„êµ¬ì˜ description í•„ë“œì— ìœ„í—˜ë„/ë³µêµ¬ ì •ë³´ë¥¼ í¬í•¨í•˜ë„ë¡ ì§€ì‹œí•©ë‹ˆë‹¤.\n\"\"\"\n\nimport json\nimport os\nfrom pathlib import Path\n\n\ndef main() -> None:\n    # í”ŒëŸ¬ê·¸ì¸ ë£¨íŠ¸ ê²½ë¡œ (í™˜ê²½ë³€ìˆ˜ ë˜ëŠ” íŒŒì¼ ìœ„ì¹˜ ê¸°ì¤€)\n    plugin_root = os.environ.get(\"CLAUDE_PLUGIN_ROOT\")\n    if plugin_root:\n        prompt_path = Path(plugin_root) / \"prompts\" / \"description_guide.md\"\n    else:\n        # fallback: ìŠ¤í¬ë¦½íŠ¸ ìœ„ì¹˜ ê¸°ì¤€\n        hook_dir = Path(__file__).parent\n        prompt_path = hook_dir.parent / \"prompts\" / \"description_guide.md\"\n\n    # í”„ë¡¬í”„íŠ¸ íŒŒì¼ ì½ê¸°\n    if prompt_path.exists():\n        prompt = prompt_path.read_text(encoding=\"utf-8\")\n    else:\n        # fallback: ê¸°ë³¸ í”„ë¡¬í”„íŠ¸\n        prompt = \"\"\"# CmdLens Description Guide\n\nBash ë„êµ¬ ì‚¬ìš© ì‹œ description í•„ë“œë¥¼ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”:\n\n[ìœ„í—˜ë„] ì„¤ëª… | ë³µêµ¬: ë³µêµ¬ë°©ë²•\n\nì˜ˆì‹œ:\n- [Safe] í˜„ì¬ ë””ë ‰í† ë¦¬ íŒŒì¼ ëª©ë¡ ì¡°íšŒ | ë³µêµ¬: ë¶ˆí•„ìš”\n- [Caution] íŒŒì¼ ì´ë™ | ë³µêµ¬: mv target source\n- [Danger] ë””ë ‰í† ë¦¬ ì‚­ì œ | ë³µêµ¬: ë¶ˆê°€ëŠ¥, ë°±ì—… í•„ìš”\"\"\"\n\n    # SessionStart í›… ì¶œë ¥ í˜•ì‹\n    output = {\n        \"hookSpecificOutput\": {\n            \"hookEventName\": \"SessionStart\",\n            \"additionalContext\": prompt\n        }\n    }\n\n    print(json.dumps(output, ensure_ascii=False))\n\n\nif __name__ == \"__main__\":\n    main()\n"
      },
      "plugins": [
        {
          "name": "cmdlens",
          "source": "./plugins/cmdlens",
          "description": "Displays risk level and recovery info before every Bash command execution",
          "version": "1.0.0",
          "author": {
            "name": "choam2426"
          },
          "keywords": [
            "bash",
            "safety",
            "explanation"
          ],
          "license": "Apache-2.0",
          "categories": [
            "bash",
            "explanation",
            "safety"
          ],
          "install_commands": [
            "/plugin marketplace add choam2426/CmdLens",
            "/plugin install cmdlens@cmdlens-marketplace"
          ]
        }
      ]
    }
  ]
}