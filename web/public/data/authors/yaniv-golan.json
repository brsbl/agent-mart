{
  "author": {
    "id": "yaniv-golan",
    "display_name": "Yaniv Golan",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/5079117?u=dadce3af041e61ab43af7bc039683a01395ec52e&v=4",
    "url": "https://github.com/yaniv-golan",
    "bio": null,
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 3,
      "total_stars": 0,
      "total_forks": 0
    }
  },
  "marketplaces": [
    {
      "name": "git-hex-marketplace",
      "version": null,
      "description": "Marketplace entry for the git-hex plugin.",
      "owner_info": {
        "name": "Yaniv Golan"
      },
      "keywords": [],
      "repo_full_name": "yaniv-golan/git-hex",
      "repo_url": "https://github.com/yaniv-golan/git-hex",
      "repo_description": null,
      "homepage": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-23T07:52:03Z",
        "created_at": "2025-12-04T22:46:04Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 321
        },
        {
          "path": ".claude-plugin/plugin.json",
          "type": "blob",
          "size": 535
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 19605
        },
        {
          "path": "server.d",
          "type": "tree",
          "size": null
        },
        {
          "path": "server.d/README.md",
          "type": "blob",
          "size": 1741
        },
        {
          "path": "skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/git-hex-branch-cleanup",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/git-hex-branch-cleanup/SKILL.md",
          "type": "blob",
          "size": 2972
        },
        {
          "path": "skills/git-hex-conflict-resolution",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/git-hex-conflict-resolution/SKILL.md",
          "type": "blob",
          "size": 3186
        },
        {
          "path": "skills/git-hex-pr-workflow",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/git-hex-pr-workflow/SKILL.md",
          "type": "blob",
          "size": 2385
        },
        {
          "path": "test",
          "type": "tree",
          "size": null
        },
        {
          "path": "test/README.md",
          "type": "blob",
          "size": 5602
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"git-hex-marketplace\",\n  \"description\": \"Marketplace entry for the git-hex plugin.\",\n  \"owner\": {\n    \"name\": \"Yaniv Golan\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"git-hex\",\n      \"description\": \"Git history rewrite and conflict-resolution tools (MCP) with curated skills.\",\n      \"source\": \"./\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"git-hex\",\n  \"version\": \"0.1.0\",\n  \"description\": \"AI-assisted, non-interactive git refactoring via MCP (safe rebase, fixups, commit surgery) for agents or chat users invoking the MCP tools.\",\n  \"author\": {\n    \"name\": \"Yaniv Golan\",\n    \"url\": \"https://github.com/yaniv-golan\"\n  },\n  \"repository\": \"https://github.com/yaniv-golan/git-hex\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"git\", \"rebase\", \"mcp\", \"git-hex\", \"mcp-bash\"],\n  \"mcpServers\": {\n    \"git-hex\": {\n      \"command\": \"${CLAUDE_PLUGIN_ROOT}/git-hex.sh\"\n    }\n  }\n}\n",
        "README.md": "# git-hex\n\n![git-hex banner](assets/git-hex-banner.png)\n[![CI Status](https://github.com/yaniv-golan/git-hex/actions/workflows/test.yml/badge.svg)](https://github.com/yaniv-golan/git-hex/actions/workflows/test.yml)\n[![Lint](https://github.com/yaniv-golan/git-hex/actions/workflows/lint.yml/badge.svg)](https://github.com/yaniv-golan/git-hex/actions/workflows/lint.yml)\n[![License](https://img.shields.io/github/license/yaniv-golan/git-hex)](LICENSE)\n[![Security Policy](https://img.shields.io/badge/security-policy-blue)](SECURITY.md)\n[![Last Commit](https://img.shields.io/github/last-commit/yaniv-golan/git-hex)](https://github.com/yaniv-golan/git-hex/commits/main)\n[![Pure Bash](https://img.shields.io/badge/pure-bash-4EAA25?logo=gnubash&logoColor=white)](https://www.gnu.org/software/bash/)\n[![MCP](https://img.shields.io/badge/MCP-server-green?logo=modelcontextprotocol)](https://yaniv-golan.github.io/affinity-sdk/mcp/)\n[![MCP Bash Framework](https://img.shields.io/badge/MCP-MCP_Bash_Framework-green?logo=modelcontextprotocol)](https://github.com/yaniv-golan/mcp-bash-framework)\n\n**AI-assisted, non-interactive git refactoring via MCP** — a focused toolset for rebase & commit perfection, usable by agents or chat users directing the MCP tools.\n\ngit-hex is an MCP (Model Context Protocol) server that provides AI assistants with safe, powerful git refactoring capabilities. It handles the complexity of interactive rebasing, fixup commits, and commit amendments while ensuring your repository is never left in a broken state.\n\nName note: “git-hex” is simply a short label for this git-history refactoring toolkit (not related to hex encoding).\n\nSee [`CHANGELOG.md`](CHANGELOG.md) for notable changes. Version metadata also lives in [`VERSION`](VERSION) and [`.claude-plugin/plugin.json`](.claude-plugin/plugin.json).\n\n**Quick links:** [`docs/install.md`](docs/install.md) • [`docs/safety.md`](docs/safety.md) • [`docs/clients.md`](docs/clients.md) • [`docs/reference/tools.md`](docs/reference/tools.md) • [`docs/reference/mcp.md`](docs/reference/mcp.md) • [`SECURITY.md`](SECURITY.md) • [`CONTRIBUTING.md`](CONTRIBUTING.md)\n\n## Table of contents\n\n- [Quick Start](#quick-start-2-minutes)\n- [Safety First](#safety-first)\n- [How it works](#how-it-works)\n- [Requirements](#requirements)\n- [Configuration](#configuration)\n- [Common workflows](#common-workflows)\n- [Tool reference](#tool-reference)\n- [CLI testing/debugging](#cli-testingdebugging)\n- [Diagnostics & Health](#diagnostics--health)\n- [Docker](#docker)\n- [Troubleshooting](#troubleshooting)\n- [Support](#support)\n- [Security](#security)\n\n## Design Principles\n\n- **Safety first**: Conflict-prone operations abort cleanly by default and create backup refs so you can always undo.\n- **Deterministic git**: Focus on well-defined history rewrites (rebase, fixup, amend, split-by-file) with predictable outputs.\n- **Minimal surface**: Tools only—no extra services. Everything runs through the MCP Bash Framework.\n- **Respect the sandbox**: Every path is validated against your client’s allowed folders (MCP `roots`); read-only mode blocks mutating tools.\n- **Agent friendly**: Outputs are structured, include summaries, and prefer explicit parameters over magic.\n\n## Features\n\n- **Safe Rebasing**: Automatic abort on conflicts so git-hex operations leave the repo clean if conflicts arise\n- **Fixup Commits**: Create fixup! commits for later auto-squashing\n- **Commit Amendments**: Safely amend the last commit with staged changes\n- **Cherry-picking**: Single-commit cherry-pick with strategy options\n- **Undo Support**: Backup refs for history-mutating operations (amend, fixup, cherry-pick, rebase, split); undo is safe unless new commits were added after the backup (see `force`)\n- **Path Security**: All operations respect your client’s allowed folders (MCP `roots`) for sandboxed access\n\n## Quick Start (2 minutes)\n\n### Connect your AI\n\n**Claude Code (recommended):**\n```text\n/plugin marketplace add yaniv-golan/git-hex\n/plugin install git-hex@git-hex-marketplace\n```\n\n**Cursor / Claude Desktop / Windsurf (MCP config):**\n```bash\ngit clone https://github.com/yaniv-golan/git-hex.git ~/git-hex\ncd ~/git-hex\n./git-hex.sh install\n```\nThen add to your MCP settings:\n```json\n{\n  \"mcpServers\": {\n    \"git-hex\": {\n      \"command\": \"~/git-hex/git-hex.sh\"\n    }\n  }\n}\n```\n\nWindows (Git Bash): see [`docs/clients.md#windows-git-bash`](docs/clients.md#windows-git-bash)\n\nPrerequisites: `git` and `jq`/`gojq`. See [`docs/install.md`](docs/install.md).\n\n### Verify it works\n\nIn your AI chat (in a repo), ask:\n\n> “Show me the last 5 commits I could rebase onto `main`.”\n\nWhen connected, your AI can use tools like `git-hex-getRebasePlan` to answer.\n\n<details>\n<summary>Having issues?</summary>\n\n- Diagnostics (no persistent changes): `./git-hex.sh doctor`\n- Install/repair prerequisites: `./git-hex.sh install`\n- macOS apps launched from Finder/Spotlight/Dock: use `git-hex-env.sh` (see [`docs/clients.md`](docs/clients.md))\n- Install/uninstall details: [`docs/install.md`](docs/install.md)\n- Allowed folders (“roots”) explanation: [`docs/concepts.md`](docs/concepts.md#allowed-folders-mcp-roots)\n\n</details>\n\n## Safety First\n\n- **Allowed folders enforcement**: repo paths must be inside configured allowed folders (MCP `roots`).\n- **Backups for mutations**: every history-mutating tool creates `refs/git-hex/backup/...` so you can recover.\n- **Conflict safety**: rebases/cherry-picks abort and restore by default on conflicts.\n- **Read-only mode**: set `GIT_HEX_READ_ONLY=1` to block all mutating tools.\n- **Scoped guarantees**: git-hex tools do not run `git push/fetch/pull`; dependency installation may use the network unless you preinstall/pin it.\n\nDetails: [`docs/safety.md`](docs/safety.md)\n\n### Next: 30-second end-to-end example (mutates history)\n\n1. Stage a fix: `git add <files>`\n2. In your AI chat, ask it to create a fixup targeting a commit, then autosquash onto `main`\n   - Tools involved: `git-hex-createFixup` → `git-hex-rebaseWithPlan` (with `autosquash=true`)\n\n## How It Works\n\n### Feature Branch Cleanup Workflow\n\nThe typical git-hex workflow for cleaning up a feature branch after code review:\n\n```mermaid\nflowchart LR\n    A[Review feedback] --> B[getRebasePlan]\n    B --> C{Inspect commits}\n    C --> D[Stage fix]\n    D --> E[createFixup]\n    E --> C\n    C --> F[rebaseWithPlan<br/>autosquash=true]\n    F --> G[Clean history ✓]\n```\n\n### Tool Overview\n\n```mermaid\nflowchart TB\n    subgraph readonly[\"Read-Only\"]\n        plan[getRebasePlan]\n        predict[checkRebaseConflicts]\n        conflictStatus[getConflictStatus]\n    end\n    \n    subgraph mutating[\"History & State Changes\"]\n        rebase[rebaseWithPlan]\n        split[splitCommit]\n        fixup[createFixup]\n        amend[amendLastCommit]\n        cherry[cherryPickSingle]\n    end\n    \n    subgraph conflict[\"Conflict Helpers (no backups)\"]\n        resolve[resolveConflict]\n        cont[continueOperation]\n        abort[abortOperation]\n    end\n    \n    subgraph safety[\"Safety Net\"]\n        undo[undoLast]\n    end\n    \n    predict -.->|\"simulate\"| rebase\n    plan -.->|\"plan first\"| rebase\n    fixup -->|\"then squash\"| rebase\n    \n    rebase --> conflictStatus\n    cherry --> conflictStatus\n    conflictStatus --> resolve\n    resolve --> cont\n    abort -.-> rebase\n\n    rebase --> undo\n    split --> undo\n    fixup --> undo\n    amend --> undo\n    cherry --> undo\n```\n\nAll history-mutating operations create backup refs, enabling `undoLast` to restore the previous state. Conflict-resolution helpers (`resolveConflict`, `continueOperation`, etc.) do not create backups.\n\n## Requirements\n\n| Dependency | Version/Notes |\n|------------|---------------|\n| MCP Bash Framework (`mcp-bash`) | v0.9.6+ |\n| bash | 3.2+ |\n| jq or gojq | Required |\n| git | 2.20+ (2.33+ for `ort`, 2.38+ for `git-hex-checkRebaseConflicts`) |\n\n## Configuration\n\n### Required\n\n| Variable | Description |\n|----------|-------------|\n| `MCPBASH_PROJECT_ROOT` | Project root containing `tools/`. **Auto-set** by `git-hex.sh` and generated wrappers; required only if you invoke `mcp-bash` directly from outside the repo. |\n\n### Optional\n\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `GIT_HEX_READ_ONLY` | unset | `1` blocks mutating tools (see [`docs/safety.md`](docs/safety.md)) |\n| `GIT_HEX_MCPBASH_SHA256` | unset | If set, `./git-hex.sh install` downloads the `FRAMEWORK_VERSION` tarball and verifies it against this checksum (fails on mismatch) instead of cloning. |\n| `GIT_HEX_MCPBASH_ARCHIVE_URL` | unset | Optional override for the tarball URL used when `GIT_HEX_MCPBASH_SHA256` is set. |\n| `MCPBASH_TOOL_ALLOWLIST` | (set by launchers) | Framework v0.7.0+: allowlisted tools may execute. The launchers set an explicit list of git-hex tool names by default (and narrow it in read-only mode). Override to `*` only for trusted environments. |\n\n**Examples:**\n\n```bash\n# Read-only mode (inspection only, no history changes)\nGIT_HEX_READ_ONLY=1 ./git-hex.sh\n\n# Verified framework install (CI/supply-chain security)\nGIT_HEX_MCPBASH_SHA256=\"10524108...\" ./git-hex.sh install\n\n# In MCP client config (e.g., Claude Desktop)\n{\n  \"mcpServers\": {\n    \"git-hex\": {\n      \"command\": \"/path/to/git-hex.sh\",\n      \"env\": { \"GIT_HEX_READ_ONLY\": \"1\" }\n    }\n  }\n}\n```\n\n### Completions\n\ngit-hex ships completion providers (refs, commits, conflict paths) registered declaratively via `server.d/register.json`. Completions require jq/gojq.\n\n> **Tip:** Running `mcp-bash` outside this repo without `MCPBASH_PROJECT_ROOT` starts the framework’s getting-started helper, not git-hex. Use `./git-hex.sh` (CLI) or `./git-hex-env.sh` (macOS apps launched from Finder/Spotlight/Dock; see `docs/clients.md`) when launching from other directories or GUI clients.\n\n## Versioning & Releases\n\n- Current development version: `0.1.0` (see `VERSION`).\n- We plan to publish GitHub Releases with signed tags, release notes, and checksums for verification. Until those are published, pin a specific commit for reproducibility (e.g., `git checkout <commit-sha>`).\n\n## Lint & Tests\n\n- Lint shell scripts: `./test/lint.sh`\n- Run all tests: `./test/run.sh` (or `./test/integration/run.sh` / `./test/security/run.sh`)\n- Optional pre-commit hook to auto-run lint: `git config core.hooksPath .githooks`\n- Contributors: see [`CONTRIBUTING.md`](CONTRIBUTING.md) for `./git-hex.sh validate` and the full workflow\n\n## Installation\n\nStart here: [`docs/install.md`](docs/install.md) (includes verified framework installs and uninstall/cleanup).\n\n```bash\ngit clone https://github.com/yaniv-golan/git-hex.git ~/git-hex\ncd ~/git-hex\n./git-hex.sh install\n```\n\n## Clients & plugin\n\nSee [`docs/clients.md`](docs/clients.md) for Claude Code plugin setup, MCP client configuration (Cursor/Windsurf/Claude Desktop/CLI), and launcher guidance.\n\n## Common Workflows\n\nThese examples show how to combine git-hex tools for typical development tasks.\n\n### Clean Up a Feature Branch After Code Review\n\nAfter receiving review feedback, create targeted fixups and squash them:\n\n```\n1. Review current commits\n   → git-hex-getRebasePlan { \"onto\": \"main\" }\n   \n2. For each piece of feedback:\n   - Make the fix in your editor\n   - Stage the changes: git add <files>\n   - Create a fixup targeting the original commit:\n     → git-hex-createFixup { \"commit\": \"<hash-of-commit-to-fix>\" }\n\n3. Squash all fixups into their targets:\n   → git-hex-rebaseWithPlan { \"onto\": \"main\", \"autosquash\": true }\n```\n\n### Bring Your Branch Up to Date with Main\n\nRebase your feature branch onto the latest main:\n\n```\n1. First, update main:\n   git checkout main && git pull\n\n2. Switch back to your feature branch:\n   git checkout feature/my-branch\n\n3. Preview what will be rebased:\n   → git-hex-getRebasePlan { \"onto\": \"main\" }\n\n4. Perform the rebase:\n   → git-hex-rebaseWithPlan { \"onto\": \"main\" }\n   \n   If conflicts occur, git-hex automatically aborts and restores your branch.\n   Resolve conflicts manually, then retry.\n```\n\n### Quick Fix to the Last Commit\n\nAmend the most recent commit with additional changes:\n\n```\n1. Make your changes in the editor\n2. Stage them: git add <files>\n3. Amend:\n   → git-hex-amendLastCommit { \"addAll\": true }\n   \n   Or with a new message:\n   → git-hex-amendLastCommit { \"message\": \"Better commit message\" }\n```\n\n### Cherry-Pick a Single Fix from Another Branch\n\nBring one specific commit to your current branch:\n\n```\n1. Find the commit hash on the source branch:\n   git log other-branch --oneline\n\n2. Cherry-pick it:\n   → git-hex-cherryPickSingle { \"commit\": \"<hash>\" }\n   \n   If conflicts occur, git-hex aborts automatically.\n```\n\n### Undo the Last git-hex Operation\n\nMade a mistake? Undo it:\n\n```\n→ git-hex-undoLast {}\n\nThis restores HEAD to its state before the last git-hex operation.\nWorks for: amendLastCommit, createFixup, rebaseWithPlan, cherryPickSingle, splitCommit\n```\n\n### When NOT to Use git-hex\n\n- **On shared/protected branches** — Use on personal feature branches only\n- **For hunk-level splitting** — `splitCommit` splits by file only; use `git add -p` + manual commits for line-level splits\n- **On repos with contribution models you don't control** — Understand the project's rebase policy first\n\n### Using git-hex with GitHub\n\ngit-hex handles the **local craft** of shaping commits, while remote collaboration tools handle working with teammates. Together, they cover the complete pull request lifecycle:\n\n1. **Local craft (git-hex)** — shape your commits:\n   - `git-hex-getRebasePlan` — review messy history\n   - `git-hex-createFixup` — fix earlier commits\n   - `git-hex-rebaseWithPlan` — squash/reword for clean history\n\n2. **Push**: `git push --force-with-lease`\n\n3. **Remote collaboration** — work with teammates:\n   - **With [GitHub Plugin](https://github.com/anthropics/claude-plugins-official/tree/main/external_plugins/github)** (from the [Official Claude Plugin Marketplace](https://github.com/anthropics/claude-plugins-official)): use its tools for PRs, reviewers, comments\n   - **With GitHub CLI**: `gh pr create`, `gh pr view`, `gh pr edit`\n\n4. **After review feedback**: return to step 1 for more local craft\n\n## Tool reference\n\nFull per-tool parameters, examples, and outputs: [`docs/reference/tools.md`](docs/reference/tools.md)\n\n## Safety & recovery\n\nDetailed safety model, read-only mode, and recovery procedures: [`docs/safety.md`](docs/safety.md)\n\n## CLI testing/debugging\n\n```bash\n# Run a tool directly (debug/CI)\n./git-hex.sh run-tool git-hex-getRebasePlan --roots /path/to/repo --args '{\"count\": 5}'\n\n# Run with MCP Inspector (must be run from project root or use ./git-hex.sh)\ncd /path/to/git-hex\nnpx @modelcontextprotocol/inspector --transport stdio -- mcp-bash\n\n# Alternative: use git-hex.sh wrapper (works from any directory)\nnpx @modelcontextprotocol/inspector --transport stdio -- /path/to/git-hex/git-hex.sh\n```\n\n> **Note:** The MCP Bash Framework CLI (`mcp-bash`) auto-detects the project root when run from within the git-hex directory. If running from elsewhere, either use the `./git-hex.sh` wrapper or set `MCPBASH_PROJECT_ROOT=/path/to/git-hex`.\n\n## Diagnostics & Health\n\n- Project validation: `./git-hex.sh validate` (or `mcp-bash validate` from the repo)\n- Ready check: `./git-hex.sh --health` (stdio exit code: `0` ready, `1` unhealthy, `2` misconfigured)\n- `install` policy refusal: exits `3` when refusing to modify a user-managed framework install (e.g., `MCPBASH_HOME` points outside the managed path).\n- Debug a single tool without starting MCP: `./git-hex.sh run-tool <tool> --args '{}' --roots <repo>`\n- Backup inventory: `git for-each-ref refs/git-hex/`\n\n## Docker\n\n```bash\ndocker build -t git-hex .\ndocker run -i --rm -v /path/to/repo:/repo git-hex\n```\n\nUse Docker in one of two modes:\n\n- Run the MCP server (stdio) in the container (for MCP clients), and configure your client’s allowed folders (MCP `roots` / `allowedRoots`) to include the mounted repo (see [`docs/concepts.md`](docs/concepts.md#allowed-folders-mcp-roots)).\n- Debug a single tool call in the container via `run-tool` (in this mode, `--roots` is valid because it applies to `run-tool`).\n\n- With MCP Inspector:\n  ```bash\n  npx @modelcontextprotocol/inspector --transport stdio -- \\\n    docker run -i --rm -v /path/to/repo:/repo git-hex\n  ```\n- With a client config that starts the server:\n  ```json\n  {\n    \"mcpServers\": {\n      \"git-hex\": {\n        \"command\": \"docker\",\n        \"args\": [\"run\", \"-i\", \"--rm\", \"-v\", \"/path/to/repo:/repo\", \"git-hex\"]\n      }\n    }\n  }\n  ```\n\n`repoPath` must be within an allowed folder (MCP `roots`); pass it explicitly when you mount multiple repositories.\n\nDebug a single tool call in the container:\n\n```bash\ndocker run --rm -v /path/to/repo:/repo git-hex \\\n  run-tool git-hex-getRebasePlan --roots /repo --args '{\"count\": 5}'\n```\n\n## Troubleshooting\n\n- `undoLast` fails because of new commits: re-run with `\"force\": true` if you intend to discard the commits added after the git-hex operation. If a rebase/merge/cherry-pick is paused, resolve/abort it first.\n- Stuck rebase/cherry-pick: run `git-hex-getConflictStatus`, resolve files, then `git-hex-continueOperation`; if you want to abandon, use `git-hex-abortOperation`.\n- MCP connectivity or repo path errors: ensure `repoPath` is inside your configured allowed folders (MCP `roots`) and that the repo is clean when required (see tool prerequisites and [`docs/concepts.md`](docs/concepts.md#allowed-folders-mcp-roots)).\n- GPG signing/pinentry hangs: tools that create commits default to unsigned commits to avoid non-interactive hangs. If you want signed commits, set `\"signCommits\": true` on the relevant tool call.\n\n## Documentation Map\n\nUser docs:\n- Install: [`docs/install.md`](docs/install.md)\n- Safety & recovery: [`docs/safety.md`](docs/safety.md)\n- Client setup: [`docs/clients.md`](docs/clients.md)\n- Tool reference: [`docs/reference/tools.md`](docs/reference/tools.md)\n- MCP/framework details: [`docs/reference/mcp.md`](docs/reference/mcp.md)\n\nPlugin/workflows:\n- Skills: [`skills/git-hex-branch-cleanup/SKILL.md`](skills/git-hex-branch-cleanup/SKILL.md), [`skills/git-hex-conflict-resolution/SKILL.md`](skills/git-hex-conflict-resolution/SKILL.md), [`skills/git-hex-pr-workflow/SKILL.md`](skills/git-hex-pr-workflow/SKILL.md)\n- Claude command templates: [`claude-commands/`](claude-commands)\n\nProject:\n- CHANGELOG: [`CHANGELOG.md`](CHANGELOG.md)\n- Plugin metadata: [`.claude-plugin/`](.claude-plugin)\n- Server metadata/policy: [`server.d/`](server.d)\n\n## Support\n\nSee [`SUPPORT.md`](SUPPORT.md).\n\n## Security\n\nSee [`SECURITY.md`](SECURITY.md) for how to report vulnerabilities.\n\n## License\n\nMIT License - see [`LICENSE`](LICENSE) for details.\n\n## Contributing\n\nContributions welcome! Please ensure:\n- All tools pass `mcp-bash validate` (MCP Bash Framework CLI)\n- New tools follow the naming convention (`git-hex-toolName`)\n- Tests are included for new functionality\n\n## Distribution\n\n**Download the latest bundle** from [GitHub Releases](https://github.com/yaniv-golan/git-hex/releases) — look for `git-hex-<version>.mcpb`.\n\nInstall by double-clicking the `.mcpb` file in Claude Desktop or other MCPB-compatible clients. The bundle includes the embedded framework, all tools, prompts, and resources.\n\nFor development or custom builds:\n```bash\nmake bundle  # Output: dist/git-hex-<version>.mcpb\n```\n\n## Related Projects\n\n- [mcp-bash-framework](https://github.com/yaniv-golan/mcp-bash-framework) - The MCP server framework powering git-hex\n- [Model Context Protocol](https://modelcontextprotocol.io/) - The protocol specification\n",
        "server.d/README.md": "# git-hex Server Configuration\n\nThis directory contains mcp-bash framework configuration files.\n\n## Files\n\n### env.sh\nEnvironment setup sourced before tool execution.\n\n**Variables configured**:\n- `MCPBASH_TOOL_ENV_MODE=allowlist` - Only pass allowed env vars to tools\n- `MCPBASH_TOOL_ENV_ALLOWLIST` - Allowed variables: `GIT_HEX_READ_ONLY`, `GIT_HEX_DEBUG`\n\n**Debug mode**: When `MCPBASH_LOG_LEVEL=debug`:\n- Enables `MCPBASH_TOOL_STDERR_CAPTURE`\n- Sets `MCPBASH_TOOL_STDERR_TAIL_LIMIT=8192`\n\n### health-checks.sh\nValidates external dependencies before serving.\n\n**Checks**:\n- `git` command availability\n- Git version warning if < 2.20 (2.33+ recommended for ort merge strategy)\n\n### policy.sh\nTool execution policy hook implementing read-only mode.\n\n**Behavior**: When `GIT_HEX_READ_ONLY=1`, blocks:\n- `git-hex-rebaseWithPlan`\n- `git-hex-splitCommit`\n- `git-hex-createFixup`\n- `git-hex-amendLastCommit`\n- `git-hex-cherryPickSingle`\n- `git-hex-resolveConflict`\n- `git-hex-continueOperation`\n- `git-hex-abortOperation`\n- `git-hex-undoLast`\n\n### register.json\nDeclarative registration of completions, resources, and prompts.\n\n**Completions**:\n- `git-ref` - Git references (branches, tags)\n- `commit-sha` - Commit SHAs with messages\n- `conflict-path` - Files with conflicts\n\n### requirements.json\nFramework and dependency version requirements.\n\n**Requirements**:\n- mcp-bash >= 0.9.10\n- bash >= 3.2.0\n- git >= 2.20.0 (2.33.0 recommended)\n- jq or gojq\n\n### server.meta.json\nServer metadata (name, version, description).\n\n## Debug Mode\n\nEnable via `server.d/.debug` file (mcp-bash 0.9.5+ native detection):\n```bash\ntouch server.d/.debug   # Enable\nrm server.d/.debug      # Disable\n```\n\nOr via environment:\n```bash\nGIT_HEX_DEBUG=1 ./git-hex.sh\n```\n",
        "skills/git-hex-branch-cleanup/SKILL.md": "---\nname: git-hex-branch-cleanup\ndescription: >\n  This skill should be used when the user wants to clean up a feature branch's\n  history using git-hex (squash/fixup commits, reorder/drop/split commits, or\n  rebase a branch onto main) without using an interactive terminal. Trigger\n  phrases include: \"clean up my branch\", \"polish history\", \"squash these commits\",\n  \"fixup commits\", \"rebase onto main\", \"rewrite commits\".\n---\n\n# Git-hex Branch Cleanup\n\n## When to use this Skill\n\nThis skill should be used when:\n\n- The user says they want to \"clean up\", \"rewrite\", \"polish\", or \"squash\" a git\n  history or feature branch.\n- The user wants to rebase a branch onto another branch (e.g. `main`) and present\n  a clean, reviewable set of commits.\n- The user wants to split, squash, or reword commits using git-hex tools instead\n  of manual interactive rebase.\n\nTrigger phrases include: \"clean up my commits\", \"squash fixups\", \"polish history\",\n\"rewrite commits\", \"rebase onto main\", \"make this branch reviewable\".\n\n## Workflow\n\n1. **Plan first**\n   - Call `git-hex-getRebasePlan` to inspect the commit range you would modify.\n   - Optionally call `git-hex-checkRebaseConflicts` to estimate whether the rebase\n     is likely to conflict.\n\n2. **Prepare changes**\n   - For small edits to the last commit, prefer `git-hex-amendLastCommit`.\n   - For fixes to older commits, guide the user to edit and stage changes, then\n     use `git-hex-createFixup` targeting the original commit.\n   - For large or mixed commits, consider `git-hex-splitCommit` to separate files\n     into focused commits.\n\n3. **Apply the rewrite**\n   - Use `git-hex-rebaseWithPlan` to reorder, drop, squash, or reword commits.\n   - Prefer `autoStash: true` and `autosquash: true` when the working tree is dirty,\n     following git-hex documentation.\n   - Never use git-hex on shared or protected branches; operate on feature branches\n     the user controls.\n\n4. **Safety and recovery**\n   - If the result is not what the user wanted, call `git-hex-undoLast` to restore\n     the previous state using git-hex backup refs.\n   - If a rebase pauses with conflicts, hand off to the conflict resolution Skill.\n\n## Tools to prefer\n\n- Planning: `git-hex-getRebasePlan`, `git-hex-checkRebaseConflicts`\n- History rewrite: `git-hex-rebaseWithPlan`, `git-hex-createFixup`,\n  `git-hex-amendLastCommit`, `git-hex-splitCommit`, `git-hex-cherryPickSingle`\n- Recovery: `git-hex-undoLast`\n\n## Key constraints\n\n- `reword` action **requires** `message` field (without it, git opens an editor → hang).\n- Messages must be **single-line** (no TAB/newline characters).\n- For reordering commits, set `requireComplete: true` in the plan.\n- Prefer `fixup` over `squash` unless you need to combine commit messages.\n- Tools that perform their own auto-stash (`amendLastCommit`, `splitCommit`, `cherryPickSingle`) expose `stashNotRestored` when stash pop failed; `rebaseWithPlan` uses Git's native `--autostash` and does not emit this flag.\n",
        "skills/git-hex-conflict-resolution/SKILL.md": "---\nname: git-hex-conflict-resolution\ndescription: >\n  This skill should be used when the user is stuck in a git-hex-driven rebase,\n  merge, or cherry-pick due to conflicts and wants the agent to inspect, resolve,\n  and then continue or abort safely. Trigger phrases include: \"resolve conflicts\",\n  \"rebase is stuck\", \"conflict markers\", \"continue the rebase\", \"abort the rebase\".\n---\n\n# Git-hex Conflict Resolution\n\n## When to use this Skill\n\nThis skill should be used when:\n\n- A git-hex tool reports that an operation is paused because of conflicts.\n- The user says a rebase or cherry-pick is \"stuck\", \"paused\", or \"in conflict\".\n- You need to see which files conflict and decide whether to continue or abort.\n\nTrigger phrases include: \"rebase conflict\", \"cherry-pick conflict\", \"merge conflict\",\n\"stuck on conflicts\", \"continue the rebase\", \"abort the cherry-pick\".\n\n## Workflow\n\n1. **Inspect conflict state**\n   - Call `git-hex-getConflictStatus` to determine:\n     - Whether a rebase/merge/cherry-pick/revert is in progress.\n     - Which files are conflicting and the overall operation type (`rebase`,\n       `merge`, `cherry-pick`, or `revert`).\n   - Use `includeContent: true` only when necessary to inspect base/ours/theirs\n     content for specific text files.\n\n2. **Resolve conflicts per file**\n   - For text files:\n     - Propose or apply edits based on `base`, `ours`, and `theirs`.\n     - Ensure conflict markers are removed before resolving.\n     - Call `git-hex-resolveConflict` with the file path (and `resolution: \"delete\"`\n       for delete conflicts when appropriate).\n  - For delete conflicts, use the `resolution` parameter to choose whether\n     to keep or remove the file.\n\n3. **Continue or abort the operation**\n   - When all conflicts are resolved (or `getConflictStatus` shows no remaining\n     conflicting files but the operation is still paused), call `git-hex-continueOperation`.\n   - If the user decides to give up on the rebase or cherry-pick, call\n     `git-hex-abortOperation` to restore the pre-operation state.\n\n4. **Escalate if needed**\n   - If the final result after continuing is not what the user wanted, suggest\n     using `git-hex-undoLast` from the branch cleanup Skill to revert.\n\n## Tools to prefer\n\n- Inspection: `git-hex-getConflictStatus`\n- Resolution: `git-hex-resolveConflict`\n- Control: `git-hex-continueOperation`, `git-hex-abortOperation`\n- Recovery: `git-hex-undoLast` (via the branch cleanup Skill)\n\n## Conflict types\n\n### Operation-level\n- `\"rebase\"` - Interactive rebase paused\n- `\"merge\"` - Merge in progress\n- `\"cherry-pick\"` - Cherry-pick paused\n- `\"revert\"` - Revert paused (detected but `continueOperation`/`abortOperation` are not supported; use `git revert --continue` or `--abort` directly)\n\n### File-level\n- `\"both_modified\"` - Both sides modified the file\n- `\"deleted_by_us\"` - We deleted, they modified\n- `\"deleted_by_them\"` - We modified, they deleted\n- `\"added_by_both\"` - Both sides added different versions\n\n## Delete conflict handling\n\n```json\n// To keep the file (must exist on disk):\n{ \"file\": \"path/to/file\", \"resolution\": \"keep\" }\n\n// To accept deletion:\n{ \"file\": \"path/to/file\", \"resolution\": \"delete\" }\n```\n",
        "skills/git-hex-pr-workflow/SKILL.md": "---\nname: git-hex-pr-workflow\ndescription: >\n  Complete pull request workflow combining git-hex (local craft) with remote\n  collaboration (GitHub plugin or CLI). This skill should be used when the user\n  wants to prepare, submit, and iterate on a PR with clean commit history.\n  Trigger phrases include: \"prepare a PR\", \"open a pull request\", \"address review\n  feedback\", \"update my PR\", \"clean up commits for PR\".\n---\n\n# Git-hex PR Workflow\n\n## When to use this Skill\n\nThis skill should be used when:\n- The user wants to prepare a branch for PR submission with clean history\n- The user is iterating on a PR after receiving review feedback\n- The user asks about combining git-hex with GitHub/PR workflows\n\nTrigger phrases include: \"prepare a PR\", \"open a PR\", \"create a pull request\",\n\"address PR feedback\", \"update the PR\", \"force-push after rebase\".\n\n## Workflow\n\n1. **Local craft (git-hex)** - shape commits before pushing:\n   - Use `git-hex-getRebasePlan` to inspect current history\n   - Use `git-hex-createFixup` + `git-hex-rebaseWithPlan` to clean up\n   - Use `git-hex-splitCommit` if commits need to be broken apart\n\n2. **Push to remote**:\n   - `git push --force-with-lease` (safe force push)\n\n3. **Remote collaboration** - work with teammates:\n   - **If the [GitHub Plugin](https://github.com/anthropics/claude-plugins-official/tree/main/external_plugins/github) is installed**: use its tools to create/update PRs, add reviewers, respond to comments\n   - **Otherwise**: use GitHub CLI (`gh`) commands:\n     - `gh pr create` - create a pull request\n     - `gh pr view` - view PR details\n     - `gh pr edit` - update PR title/body/reviewers\n     - `gh pr comment` - add comments\n\n4. **After review feedback**:\n   - Return to step 1 for more local craft\n   - Use `git-hex-undoLast` if a cleanup went wrong\n\n## Tools to prefer\n\n- **Local craft**: all git-hex tools (see branch-cleanup skill)\n- **Remote**: GitHub plugin tools if installed, otherwise `gh` CLI\n\n## Key insight\n\ngit-hex handles the **local craft** of shaping commits.\nRemote collaboration (via the [GitHub Plugin](https://github.com/anthropics/claude-plugins-official/tree/main/external_plugins/github) from the [Official Claude Plugin Marketplace](https://github.com/anthropics/claude-plugins-official), or standard `gh` CLI) handles working with teammates.\nTogether, they cover the complete pull request lifecycle.\n",
        "test/README.md": "# Testing git-hex\n\nThis directory contains tests for the git-hex MCP server.\n\n## Prerequisites\n\nThe tests require the `mcp-bash` framework. You can either:\n\n1. **Install the framework** (recommended for CI):\n   ```bash\n   # Framework version is pinned in mcp-bash.lock (includes SHA256 for verified install)\n   ./git-hex.sh install\n   ```\n\n2. **Use a local development version** by setting `MCPBASH_HOME`:\n   ```bash\n   export MCPBASH_HOME=$HOME/.local/share/mcp-bash\n   ```\n\nThe test harness auto-detects sibling directories (e.g., `../mcpbash`) for local development.\n\n## Running Tests\n\nRun all tests:\n```bash\n./test/run.sh\n```\n\nRun schema checks only:\n```bash\n./test/schema/run.sh\n```\n\nRun only integration tests:\n```bash\n./test/integration/run.sh\n```\n\n### Selecting subsets (CI profiles)\n\nThe integration runner supports optional filtering:\n\n- PR suite (skips adversarial integration tests that run in nightly CI):\n  ```bash\n  GITHEX_TEST_SUITE=pr ./test/integration/run.sh\n  ```\n- Windows PR smoke profile:\n  ```bash\n  GITHEX_TEST_PROFILE=windows-smoke GITHEX_TEST_STRICT=1 ./test/integration/run.sh\n  ```\n- Include/exclude specific tests:\n  ```bash\n  GITHEX_TEST_INCLUDE=\"test_get_rebase_plan.sh,test_read_only_mode.sh\" ./test/integration/run.sh\n  GITHEX_TEST_EXCLUDE=\"test_stash_integration.sh\" ./test/integration/run.sh\n  ```\n\nRun only security tests:\n```bash\n./test/security/run.sh\n```\n\nRun lint (shellcheck + shfmt):\n```bash\n./test/lint.sh\n```\n\n### Runner flags\n\n- `VERBOSE=1` streams per-test logs (instead of only printing on failure).\n- `UNICODE=1` uses ✅/❌ status icons.\n- `GITHEX_INTEGRATION_TMP=/tmp/githex` writes integration logs to a fixed dir (useful for CI).\n- `KEEP_INTEGRATION_LOGS=1` keeps logs even on success (default removes them on success).\n\nEnable the provided pre-commit hook to auto-run lint before commits:\n```bash\ngit config core.hooksPath .githooks\n```\nOr install pre-commit to reuse the same hook configuration:\n```bash\npre-commit install\n```\n\n## Test Structure\n\n```\ntest/\n├── run.sh                    # Main test runner (runs all suites)\n├── common/\n│   ├── env.sh               # Test environment setup\n│   ├── assert.sh            # Assertion helpers\n│   └── git_fixtures.sh      # Git repository fixtures\n├── schema/\n│   ├── run.sh               # Schema contract checks (tool.meta.json + docs coverage)\n├── integration/\n│   ├── run.sh               # Integration test runner\n│   └── test_*.sh            # Individual integration tests\n└── security/\n    ├── run.sh               # Security test runner\n    └── test_*.sh            # Security/path traversal tests\n```\n\n## Writing Tests\n\n### Integration Tests\n\nCreate a new file `test/integration/test_my_feature.sh`:\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\n# Source test helpers\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../common/env.sh\"\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../common/assert.sh\"\nsource \"$(dirname \"${BASH_SOURCE[0]}\")/../common/git_fixtures.sh\"\n\ntest_create_tmpdir\ntest_verify_framework\n\necho \"=== Testing my feature ===\"\n\n# Create a test repo\nrepo=\"${TEST_TMPDIR}/my-repo\"\ncreate_test_repo \"${repo}\" 5\n\n# Run tool and check result\nresult=\"$(run_tool \"git-hex-myTool\" \"${repo}\" '{\"arg\": \"value\"}')\"\nassert_json_field \"${result}\" \".success\" \"true\"\n\necho \"All tests passed!\"\n```\n\n### Using Test Helpers\n\n**`run_tool`** - Run a tool and get structured output:\n```bash\nresult=\"$(run_tool \"git-hex-getRebasePlan\" \"${repo}\" '{\"count\": 5}')\"\n```\n\n**`run_tool_expect_fail`** - Expect a tool to fail:\n```bash\nif run_tool_expect_fail \"git-hex-getRebasePlan\" \"/nonexistent\" '{}'; then\n    echo \"PASS: correctly rejected invalid path\"\nfi\n```\n\n**Git fixtures** - Create test repositories:\n```bash\ncreate_test_repo \"${repo}\" 5           # 5 commits\ncreate_fixup_scenario \"${repo}\"        # Repo with fixup commits\ncreate_conflict_scenario \"${repo}\"     # Repo with conflict setup\n```\n\n### Assertions\n\n```bash\nassert_eq \"actual\" \"expected\" \"description\"\nassert_json_field \"${json}\" \".field\" \"expected_value\"\n```\n\n## Testing with mcp-bash run-tool\n\nFor manual testing or debugging:\n\n```bash\n# Test a tool directly\nmcp-bash run-tool git-hex-getRebasePlan \\\n    --args '{\"repoPath\": \"/path/to/repo\", \"count\": 5}' \\\n    --roots '/path/to/repo' \\\n    --allow-self\n\n# With custom timeout\nmcp-bash run-tool git-hex-rebaseWithPlan \\\n    --args '{\"onto\": \"main\"}' \\\n    --roots '/path/to/repo' \\\n    --timeout 120 \\\n    --allow-self\n```\n\n> **Windows/Git Bash Note**: Set `MSYS2_ARG_CONV_EXCL=\"*\"` before running commands with path arguments to prevent automatic path mangling.\n\n## CI Integration\n\nSee `.github/workflows/test.yml` for the GitHub Actions configuration. The CI:\n1. Installs the mcp-bash framework (pinned version in `mcp-bash.lock`).\n2. Runs lint on Linux (shellcheck + shfmt).\n3. Runs `./git-hex.sh validate` (or `mcp-bash validate`), integration tests, and security tests on Linux and macOS (with failure logs artifacted).\n4. Runs integration tests on Windows with a time budget guard.\n5. Runs a scheduled weekly full suite on Ubuntu.\n\nCI runs with `MCPBASH_CI_MODE`, `MCPBASH_CI_VERBOSE`, and `MCPBASH_TRACE_TOOLS` enabled to capture env snapshots, failure summaries, and per-tool traces into `$MCPBASH_LOG_DIR` for easier debugging.\n\n## Reference\n\n- [mcp-bash Best Practices](https://github.com/yaniv-golan/mcp-bash-framework/blob/main/docs/BEST-PRACTICES.md)\n- [run-tool CLI Reference](https://github.com/yaniv-golan/mcp-bash-framework/blob/main/docs/BEST-PRACTICES.md#testing-tools-with-run-tool)\n"
      },
      "plugins": [
        {
          "name": "git-hex",
          "description": "Git history rewrite and conflict-resolution tools (MCP) with curated skills.",
          "source": "./",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add yaniv-golan/git-hex",
            "/plugin install git-hex@git-hex-marketplace"
          ]
        }
      ]
    }
  ]
}