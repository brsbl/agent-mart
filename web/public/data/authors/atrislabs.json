{
  "author": {
    "id": "atrislabs",
    "display_name": "Atris",
    "type": "Organization",
    "avatar_url": "https://avatars.githubusercontent.com/u/63672820?v=4",
    "url": "https://github.com/atrislabs",
    "bio": null,
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 1,
      "total_commands": 2,
      "total_skills": 9,
      "total_stars": 57,
      "total_forks": 2
    }
  },
  "marketplaces": [
    {
      "name": "atris",
      "version": null,
      "description": "Agent operating system. MAPFIRST navigation, PLAN-DO-REVIEW workflow, decision traces, skill factory.",
      "owner_info": null,
      "keywords": [],
      "repo_full_name": "atrislabs/atris",
      "repo_url": "https://github.com/atrislabs/atris",
      "repo_description": "a self improving context system for agents",
      "homepage": "https://atris.ai",
      "signals": {
        "stars": 57,
        "forks": 2,
        "pushed_at": "2026-01-29T11:05:41Z",
        "created_at": "2025-10-20T20:43:58Z",
        "license": null
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 552
        },
        {
          "path": ".claude",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude/commands",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude/commands/atris-autopilot.md",
          "type": "blob",
          "size": 3267
        },
        {
          "path": ".claude/commands/atris.md",
          "type": "blob",
          "size": 769
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 1676
        },
        {
          "path": "atris",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/features",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/features/README.md",
          "type": "blob",
          "size": 3578
        },
        {
          "path": "atris/skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/README.md",
          "type": "blob",
          "size": 1223
        },
        {
          "path": "atris/skills/atris",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/atris/SKILL.md",
          "type": "blob",
          "size": 2040
        },
        {
          "path": "atris/skills/autopilot",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/autopilot/SKILL.md",
          "type": "blob",
          "size": 4033
        },
        {
          "path": "atris/skills/autopilot/atris-autopilot.md",
          "type": "blob",
          "size": 1425
        },
        {
          "path": "atris/skills/autopilot/hooks",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/autopilot/hooks/stop-hook.sh",
          "type": "blob",
          "size": 2098
        },
        {
          "path": "atris/skills/backend",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/backend/SKILL.md",
          "type": "blob",
          "size": 1651
        },
        {
          "path": "atris/skills/copy-editor",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/copy-editor/SKILL.md",
          "type": "blob",
          "size": 19098
        },
        {
          "path": "atris/skills/design",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/design/SKILL.md",
          "type": "blob",
          "size": 1739
        },
        {
          "path": "atris/skills/email-agent",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/email-agent/SKILL.md",
          "type": "blob",
          "size": 8966
        },
        {
          "path": "atris/skills/memory",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/memory/SKILL.md",
          "type": "blob",
          "size": 2924
        },
        {
          "path": "atris/skills/meta",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/meta/SKILL.md",
          "type": "blob",
          "size": 2660
        },
        {
          "path": "atris/skills/writing",
          "type": "tree",
          "size": null
        },
        {
          "path": "atris/skills/writing/SKILL.md",
          "type": "blob",
          "size": 809
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"atris\",\n  \"metadata\": {\n    \"description\": \"Agent operating system. MAPFIRST navigation, PLAN-DO-REVIEW workflow, decision traces, skill factory.\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"atris\",\n      \"description\": \"Core agent OS: MAPFIRST, PLAN-DO-REVIEW, ASCII viz, journaling, decision traces\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./atris/skills/atris\",\n        \"./atris/skills/writing\",\n        \"./atris/skills/backend\",\n        \"./atris/skills/design\"\n      ]\n    }\n  ]\n}\n",
        ".claude/commands/atris-autopilot.md": "---\ndescription: PRD-driven autonomous execution - give it a task, it gets it done\nallowed-tools: Bash, Read, Write, Edit, Glob, Grep\n---\n\n# Atris Autopilot\n\nAutonomous task execution. Give it a feature or bug, it runs plan → do → review until done.\n\n## Usage\n\n```\n/atris-autopilot Add dark mode toggle\n/atris-autopilot Fix the login bug on Safari\n```\n\n## How it works\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│  YOU: \"Add dark mode toggle\"                                │\n│           │                                                 │\n│           ▼                                                 │\n│  ┌─────────────────┐                                        │\n│  │ Generate PRD    │ ← acceptance criteria                  │\n│  └────────┬────────┘                                        │\n│           │                                                 │\n│           ▼                                                 │\n│  ┌─────────────────────────────────────────┐                │\n│  │          LOOP (max 5 iterations)        │                │\n│  │  ┌──────┐   ┌──────┐   ┌────────┐       │                │\n│  │  │ PLAN │ → │  DO  │ → │ REVIEW │       │                │\n│  │  └──────┘   └──────┘   └────┬───┘       │                │\n│  │                             │           │                │\n│  │              ┌──────────────┴─────┐     │                │\n│  │              │ passes: true?      │     │                │\n│  │              └──────────────┬─────┘     │                │\n│  │                    YES │  NO │          │                │\n│  │                        ▼     └──────────┘                │\n│  └────────────────────────┼────────────────┘                │\n│                           ▼                                 │\n│  <promise>COMPLETE</promise> ✅                             │\n└─────────────────────────────────────────────────────────────┘\n```\n\n## Execute\n\nRun the autopilot command with the user's task:\n\n```bash\natris autopilot \"$ARGUMENTS\"\n```\n\nIf $ARGUMENTS mentions \"bug\", \"fix\", \"broken\", \"error\":\n```bash\natris autopilot --bug \"$ARGUMENTS\"\n```\n\n## Output\n\n- `prd.json` — PRD with acceptance criteria\n- `progress.txt` — Execution log\n- Journal updated with completion\n\n## Rules\n\n- ONE task at a time\n- Verify before marking passes: true\n- Minimal changes only\n- Check MAP.md before touching code\n",
        ".claude/commands/atris.md": "---\ndescription: Activate Atris context - loads TODO.md, journal, and persona\nallowed-tools: Read, Bash, Glob, Grep\n---\n\n# Atris Activate\n\nLoad workspace context for AI-navigable development.\n\n## Auto-load these files:\n\n1. **Persona** (communication style): @atris/PERSONA.md\n2. **Tasks** (current work): @atris/TODO.md\n3. **Navigation** (where is X?): @atris/MAP.md\n\n## Check today's journal:\n\n!`ls -la atris/logs/2026/ 2>/dev/null | tail -3`\n\n## Your workflow:\n\n```\nPLAN  → atris plan   (navigator creates tasks)\nBUILD → atris do     (executor builds)\nCHECK → atris review (validator verifies)\n```\n\n## Rules:\n\n- 3-4 sentences max, use ASCII visuals\n- Check MAP.md before touching code\n- Delete tasks from TODO.md when done\n- Fast, focused, ruthlessly efficient\n",
        "README.md": "# atris\n\n**atris** is a self improving context layer for your agent. Works with coding agents like Claude Code and Cursor.\n\n## For Coding Agents\n\n**If you're a coding agent (Claude Code, Cursor, Windsurf, Copilot, etc.) reading this:**\n\nWhen the user asks to build/plan/fix something, run:\n```bash\natris\n```\n\nFollow the instructions in the output. The full protocol is in `atris.md`.\n\n---\n\n## Install\n\n```bash\nnpm install -g atris\n```\n\n## Quick Start\n\n```bash\ncd your-project\natris init    # Creates atris/ folder\natris         # Loads context, ready to build\n```\n\nThen describe what you want to build. The agent will:\n0. (Optional) Explore with `atris brainstorm` if uncertain\n1. Show you a visualization\n2. Wait for approval\n3. Create `atris/features/[name]/idea.md` + `build.md`\n4. Execute step by step\n5. Review and update docs (2-pass)\n\nCommands: `brainstorm` (optional) → `plan` → `do` → `review`\n\nWorks with: Claude Code, Cursor, Windsurf, GitHub Copilot, any agent.\n\n## Update\n\n```bash\natris upgrade     # Install latest from npm\natris update      # Sync local files to new version\n```\n\n## Skills\n\nAtris includes agent-agnostic skills that work with Claude, Cursor, Codex, any LLM:\n\n| Skill | Purpose |\n|-------|---------|\n| atris | Workflow enforcement + plan/do/review |\n| autopilot | PRD-driven autonomous execution |\n| backend | Backend architecture anti-patterns |\n| design | Frontend aesthetics policy |\n| meta | Metacognition for agents |\n| writing | Essay process with approval gates |\n\nInstall to Codex: `cp -r atris/skills/[name] ~/.codex/skills/`\n\n---\n\n**License:** MIT | **Repo:** [github.com/atrislabs/atris](https://github.com/atrislabs/atris.git)\n",
        "atris/features/README.md": "# Features\n\nThis directory contains feature documentation for the Atris project.\n\n---\n\n## Structure\n\nEach feature gets its own folder:\n\n```\natris/features/\n├── _templates/           # Templates for new features\n│   ├── idea.md.template  # Problem, solution, visualization\n│   └── build.md.template # Step-by-step build instructions\n├── feature-name-1/\n│   ├── idea.md           # Why we're building this\n│   └── build.md          # How to build it\n└── feature-name-2/\n    ├── idea.md\n    └── build.md\n```\n\n---\n\n## Creating a New Feature\n\n### Automatic (Recommended)\n\nRun `atris` or `atris plan` and describe what you want. The agent will:\n1. Show visualization\n2. Wait for approval\n3. Create the feature folder with idea.md + build.md\n\n### Manual\n\nIf you want to create a feature manually:\n\n```bash\n# Copy templates\nmkdir atris/features/your-feature-name\ncp atris/features/_templates/idea.md.template atris/features/your-feature-name/idea.md\ncp atris/features/_templates/build.md.template atris/features/your-feature-name/build.md\n\n# Fill in the templates\n# Edit idea.md (problem, solution, visualization)\n# Edit build.md (step-by-step implementation)\n```\n\n---\n\n## Workflow\n\n**Navigator Agent:**\n1. Shows visualization\n2. Gets approval\n3. Creates `idea.md` + `build.md`\n4. Adds entry to this README\n\n**Executor Agent:**\n1. Reads `build.md`\n2. Executes step by step\n3. Updates status as work progresses\n\n**Validator Agent:**\n1. Verifies build matches spec\n2. Runs tests\n3. Updates status to \"complete\"\n4. Updates MAP.md if needed\n\n---\n\n## Feature Status\n\n### Active Features\n\n(No active features in development)\n\n---\n\n### Completed Features\n\n#### brainstorm — v2.0.0\nConversational exploration mode for uncertain ideas\n- **Files:** bin/atris.js, atris/atris.md, atris/PERSONA.md, GETTING_STARTED.md, README.md, atris/MAP.md\n- **Status:** complete\n- **Keywords:** brainstorm, conversational, exploration, pre-planning, v2.0.0\n- **What:** Optional step 0 before `atris plan` for exploring ideas one question at a time\n- **Why:** Users need supportive thinking partner when uncertain about requirements\n- **Completed:** 2025-11-11 (shipped in v2.0.0)\n\n#### cli-ux-simplification — v2.0.0\nSimplified CLI surface around the core workflow and aligned internal artifacts.\n- **Files:** bin/atris.js, commands/init.js, commands/workflow.js, commands/status.js, commands/brainstorm.js, lib/state-detection.js, atris.md, atris/atris.md, GETTING_STARTED.md, atris/GETTING_STARTED.md, AGENT.md, CLAUDE.md, atris/PERSONA.md, PERSONA.md\n- **Status:** complete\n- **Keywords:** cli, ux, plan-do-review, todo, features\n- **What:** Clarified help output and behavior so `plan`, `do`, and `review` are the primary loop, with `TODO.md` + features + logs as the underlying structure.\n- **Why:** Makes it easier for humans and agents to understand and consistently use the CLI without memorizing many commands.\n- **Completed:** 2025-11-16\n\n---\n\n## Guidelines\n\n**When to create a feature folder:**\n- Substantial new functionality (not a 5-line fix)\n- Multiple files affected\n- Needs design discussion\n- Will take multiple sessions\n\n**When to use TODO.md instead:**\n- Simple tasks (1-2 files)\n- Quick fixes\n- Refactoring\n- Bug fixes\n\n**Naming convention:**\n- Use kebab-case: `user-authentication`, `csv-export`, `rate-limiting`\n- Be specific: `oauth-login` not just `auth`\n- Keep it short: 2-3 words max\n\n---\n\n## Need Help?\n\n- See `atris/GETTING_STARTED.md` for setup\n- See `atris/PERSONA.md` for workflow\n- Run `atris help` for commands\n",
        "atris/skills/README.md": "# Atris Skills\n\nAgent-agnostic skills. Works with Claude, Cursor, Codex, any LLM agent.\n\n## Pattern\n\nEvery process = **Skill + Policy**\n\n- `skills/[name]/SKILL.md` — How to DO (process)\n- `policies/[name].md` — How to REVIEW (validation)\n\n## Integration\n\n### Claude Code\n```bash\ncd .claude/skills && ln -s ../../atris/skills/[name] [name]\n```\n\n### Codex\n```bash\ncp -r atris/skills/[name] ~/.codex/skills/\n```\n\n## Available Skills\n\n| Skill | Description | Policy |\n|-------|-------------|--------|\n| atris | Workflow enforcement + plan/do/review | `policies/ANTISLOP.md` |\n| autopilot | PRD-driven autonomous execution | — |\n| backend | Backend architecture anti-patterns | `policies/atris-backend.md` |\n| design | Frontend aesthetics policy | `policies/atris-design.md` |\n| email-agent | Gmail integration via AtrisOS | — |\n| memory | Context and memory management | — |\n| meta | Metacognition for agents | `policies/LESSONS.md` |\n| writing | Essay process with gates | `policies/writing.md` |\n| copy-editor | Detects and fixes AI writing patterns | - |\n\n## Creating Skills\n\n1. Create `atris/skills/[name]/SKILL.md`\n2. Create `atris/policies/[name].md` (optional)\n3. Install to your agent (see Integration above)\n",
        "atris/skills/atris/SKILL.md": "---\nname: atris\ndescription: Atris workflow enforcement for repos using atris/ (MAP, TODO, journal, features, plan-do-review, anti-slop). Use when the user asks to follow the Atris system or mentions atris, MAP.md, TODO.md, journal/logs, features, plan/do/review, or anti-slop policies.\n---\n\n# Atris Skill\n\n## Scope\n- Use this skill in repos that contain `atris/` or when the user requests Atris flow.\n- If unsure, ask one question before acting.\n\n## Required context (load only what you need)\n- Read `atris/atris.md`, `atris/PERSONA.md`, `atris/MAP.md`, `atris/TODO.md`.\n- Read today's journal `atris/logs/YYYY/YYYY-MM-DD.md` when planning or executing.\n- Read `atris/features/README.md` and templates only when creating a feature.\n\n## MAP-first\n- Read `atris/MAP.md` before any search.\n- If MAP lacks the answer, run one search and update MAP.\n\n## Intent capture\n- Ask clarifying questions until intent is unambiguous.\n- Define success criteria and required artifacts before planning.\n- Provide ASCII visualization, wait for approval, then plan.\n\n## Workflow\n- If the user says \"atris activate\" or \"atris next\", follow `atris/atris.md` exactly.\n- Follow: plan -> do -> review.\n- Do not code during PLAN.\n- During DO, execute approved steps only.\n- During REVIEW, test/verify and reconcile with success criteria.\n\n## Artifacts\n- Claim tasks in `atris/TODO.md`, delete when done.\n- Update journal after each stage change and completion.\n- For features, create `atris/features/<name>/idea.md` and `build.md` from templates, and update `atris/features/README.md`.\n- Use `atris/features/_templates/validate.md.template` when a validation script is needed.\n\n## Policies (anti-slop)\n- Always enforce `atris/policies/ANTISLOP.md`.\n- Load only the relevant domain policy: `atris-design.md`, `atris-backend.md`, `writing.md`.\n\n## Improvement loop\n- After REVIEW, if output missed intent or failed validation, add a one-line lesson to `atris/policies/LESSONS.md`.\n- Promote repeated lessons (2-3 times) into the relevant policy and prune old items.\n",
        "atris/skills/autopilot/SKILL.md": "---\nname: autopilot\ndescription: PRD-driven autonomous execution - give it a task, it loops until done\ntriggers: [autopilot, autonomous, \"get it done\", \"finish this\", \"ship it\"]\n---\n\n# Autopilot Skill\n\nAutonomous task execution. Plan → Do → Review loop until acceptance criteria pass.\n\n## When to Use\n\n- User says \"get this done\" or \"ship it\"\n- User describes a feature/bug and wants hands-off execution\n- Any task that can be validated with acceptance criteria\n\n## Process\n\n```\n┌───────────────────────────────────────────────────────┐\n│  INPUT: \"Add dark mode toggle\"                        │\n│                                                       │\n│  1. GENERATE PRD                                      │\n│     - Type: feature or bug (auto-detect)              │\n│     - Acceptance criteria (testable conditions)       │\n│     - Priority: 1 (single story)                      │\n│                                                       │\n│  2. LOOP (max 5 iterations)                           │\n│     ┌──────────────────────────────────────┐          │\n│     │ PLAN: Navigator creates tasks        │          │\n│     │   - Read MAP.md for file locations   │          │\n│     │   - ASCII diagram of approach        │          │\n│     │   - Add tasks to TODO.md             │          │\n│     │   - Signal: [PLAN_COMPLETE]          │          │\n│     ├──────────────────────────────────────┤          │\n│     │ DO: Executor builds                  │          │\n│     │   - Implement each task              │          │\n│     │   - Verify changes work              │          │\n│     │   - Commit changes                   │          │\n│     │   - Signal: [DO_COMPLETE]            │          │\n│     ├──────────────────────────────────────┤          │\n│     │ REVIEW: Validator checks             │          │\n│     │   - Check acceptance criteria        │          │\n│     │   - If fail: [REVIEW_FAILED] reason  │          │\n│     │   - If pass: <promise>COMPLETE</promise>        │\n│     └──────────────────────────────────────┘          │\n│                                                       │\n│  3. OUTPUT                                            │\n│     - prd.json: PRD with passes: true                 │\n│     - progress.txt: Execution log                     │\n│     - Journal: Completion logged                      │\n└───────────────────────────────────────────────────────┘\n```\n\n## Acceptance Criteria Templates\n\n**Feature:**\n- Feature implemented and working as described\n- Tests pass (if test suite exists)\n- Build passes\n- Code follows project patterns (check MAP.md)\n\n**Bug:**\n- Bug is fixed and no longer reproducible\n- Regression test added (if applicable)\n- Build passes\n- No new bugs introduced\n\n## Commands\n\n```bash\n# With description\natris autopilot \"Add dark mode toggle\"\n\n# Bug fix\natris autopilot --bug \"Login fails on Safari\"\n\n# From TODO.md backlog\natris autopilot --from-todo\n\n# With options\natris autopilot \"Add feature\" --iterations=3 --verbose\n```\n\n## Stop Conditions\n\n1. `<promise>COMPLETE</promise>` — All acceptance criteria met\n2. Max iterations reached (default: 5)\n3. Error that can't be recovered\n\n## Rules\n\n- ONE task at a time\n- Verify before marking passes: true\n- Minimal changes only\n- Check MAP.md before touching code\n- Log to journal when complete\n",
        "atris/skills/autopilot/atris-autopilot.md": "---\ndescription: Start autonomous loop - plan/do/review until done\narguments:\n  - name: task\n    description: What to build (e.g., \"Add dark mode toggle\")\n    required: true\n  - name: max-iterations\n    description: Max loops before stopping (default 10)\n    required: false\n---\n\n# Atris Autopilot\n\nYou are entering **autonomous mode**. You will loop until the task is complete or max iterations reached.\n\n## Setup\n\nFirst, create the state file:\n\n```bash\nmkdir -p .claude\ncat > .claude/atris-autopilot.state.md << 'EOF'\n---\niteration: 1\nmax_iterations: $ARGUMENTS.max-iterations|default:10\ncompletion_promise: <promise>COMPLETE</promise>\n---\n\n$ARGUMENTS.task\nEOF\n```\n\n## Your Task\n\n**$ARGUMENTS.task**\n\n## Process\n\nEach iteration:\n1. **PLAN** — Read MAP.md, identify files, create approach\n2. **DO** — Implement ONE thing, commit changes\n3. **REVIEW** — Check acceptance criteria\n\n## Acceptance Criteria\n\n- Task implemented and working\n- Tests pass (if they exist)\n- Build passes\n- Code follows patterns in MAP.md\n\n## Rules\n\n- ONE thing per iteration (trust the loop)\n- Search MAP.md before grepping\n- Search codebase before assuming not implemented\n- Update TODO.md with progress\n- Log learnings to atris/logs/\n\n## Completion\n\nWhen ALL acceptance criteria pass, output exactly:\n\n```\n<promise>COMPLETE</promise>\n```\n\nThis signals the stop hook to end the loop.\n\n## Start\n\nRead atris/MAP.md now. Then begin iteration 1.\n",
        "atris/skills/autopilot/hooks/stop-hook.sh": "#!/bin/bash\n# Atris Autopilot Stop Hook\n# Catches exit, re-injects with MAP/TODO context\n\nSTATE_FILE=\".claude/atris-autopilot.state.md\"\n\n# Read stdin JSON for transcript path\nINPUT=$(cat)\nTRANSCRIPT_PATH=$(echo \"$INPUT\" | jq -r '.transcript_path // empty')\nSTOP_HOOK_ACTIVE=$(echo \"$INPUT\" | jq -r '.stop_hook_active // false')\n\n# Prevent infinite loops\nif [ \"$STOP_HOOK_ACTIVE\" = \"true\" ]; then\n  exit 0\nfi\n\n# No state file = not in autopilot mode\nif [ ! -f \"$STATE_FILE\" ]; then\n  exit 0\nfi\n\n# Parse state from YAML frontmatter\niteration=$(grep \"^iteration:\" \"$STATE_FILE\" | cut -d' ' -f2)\nmax_iterations=$(grep \"^max_iterations:\" \"$STATE_FILE\" | cut -d' ' -f2)\n\n# Validate numbers\nif ! [[ \"$iteration\" =~ ^[0-9]+$ ]] || ! [[ \"$max_iterations\" =~ ^[0-9]+$ ]]; then\n  echo '{\"decision\": \"block\", \"reason\": \"Error: Invalid state file. Run /cancel-autopilot and restart.\"}'\n  exit 0\nfi\n\n# Max iterations reached - allow exit\nif [ \"$iteration\" -ge \"$max_iterations\" ]; then\n  rm -f \"$STATE_FILE\"\n  exit 0\nfi\n\n# Check transcript for completion promise\nif [ -n \"$TRANSCRIPT_PATH\" ] && [ -f \"$TRANSCRIPT_PATH\" ]; then\n  if grep -q \"<promise>COMPLETE</promise>\" \"$TRANSCRIPT_PATH\"; then\n    rm -f \"$STATE_FILE\"\n    exit 0\n  fi\nfi\n\n# Increment iteration\nnew_iteration=$((iteration + 1))\nsed -i.bak \"s/^iteration:.*/iteration: $new_iteration/\" \"$STATE_FILE\"\nrm -f \"${STATE_FILE}.bak\"\n\n# Extract original prompt\nprompt=$(sed -n '/^---$/,/^---$/!p' \"$STATE_FILE\" | tail -n +2)\n\n# Load context\nmap_context=\"\"\n[ -f \"atris/MAP.md\" ] && map_context=$(head -200 atris/MAP.md)\n\ntodo_context=\"\"\n[ -f \"atris/TODO.md\" ] && todo_context=$(cat atris/TODO.md)\n\n# Build reason (this is what Claude sees)\nreason=\"[AUTOPILOT ITERATION $new_iteration/$max_iterations]\n\nTASK: $prompt\n\nCONTEXT:\n- MAP.md loaded (use for navigation)\n- TODO.md loaded (track progress)\n\nRULES:\n- ONE thing this iteration\n- Search before assuming not implemented\n- When ALL done: output <promise>COMPLETE</promise>\n\nContinue working.\"\n\n# Block exit, provide reason\necho \"{\\\"decision\\\": \\\"block\\\", \\\"reason\\\": $(echo \"$reason\" | jq -Rs .)}\"\nexit 0\n",
        "atris/skills/backend/SKILL.md": "---\nname: atris-backend\ndescription: Backend architecture policy. Use when building APIs, services, data access, or any backend work. Prevents over-engineering.\nallowed-tools: Read, Write, Edit, Bash, Glob, Grep\n---\n\n# atris-backend\n\nPart of the Atris policy system. Prevents ai-generated backend from being over-engineered.\n\n## Atris Integration\n\nThis skill uses the Atris workflow:\n1. Check `atris/MAP.md` for existing patterns before building\n2. Reference `atris/policies/atris-backend.md` for full guidance\n3. After building, run `atris review` to validate against this policy\n\n## Quick Reference\n\n**Naming:** avoid `data`, `result`, `handler`, `manager`, `service`, `utils`. names reveal intent.\n\n**Abstractions:** three concrete examples before you abstract. copy-paste until patterns emerge.\n\n**Errors:** let errors bubble. include context: what were you doing? what input caused this?\n\n**Data Access:** no n+1 queries. think about patterns upfront. batch when possible.\n\n**API Design:** boring and consistent. same patterns everywhere.\n\n## Before Shipping Checklist\n\nRun through `atris/policies/atris-backend.md` \"before shipping\" section:\n- can you explain this in one sentence?\n- are abstractions earning their keep?\n- do error messages help debugging?\n- anything \"just in case\" you could delete?\n\n## Atris Commands\n\n```bash\natris            # load workspace context\natris plan       # break down backend task\natris do         # build with step-by-step validation\natris review     # validate against this policy\n```\n\n## Learn More\n\n- Full policy: `atris/policies/atris-backend.md`\n- Navigation: `atris/MAP.md`\n- Workflow: `atris/PERSONA.md`\n",
        "atris/skills/copy-editor/SKILL.md": "---\nname: copy-editor\ndescription: Detects AI writing patterns and fixes them. Use when reviewing any written output, including docs, READMEs, messages, PRDs. Based on Wikipedia's AI Cleanup patterns.\ntriggers:\n  - copy edit\n  - review writing\n  - humanize\n  - deslopper\n  - ai patterns\n  - make it sound human\n---\n\n# Copy Editor: Remove AI Writing Patterns\n\nYou are a copy editor that identifies and removes signs of AI-generated text to make writing sound more natural and human. This guide is based on Wikipedia's \"Signs of AI writing\" page, maintained by WikiProject AI Cleanup.\n\n## Your Task\n\nWhen given text to review:\n\n1. **Identify AI patterns** - Scan for the patterns listed below\n2. **Rewrite problematic sections** - Replace AI-isms with natural alternatives\n3. **Preserve meaning** - Keep the core message intact\n4. **Maintain voice** - Match the intended tone (formal, casual, technical, etc.)\n5. **Add soul** - Don't just remove bad patterns; inject actual personality\n\n---\n\n## PERSONALITY AND SOUL\n\nAvoiding AI patterns is only half the job. Sterile, voiceless writing is just as obvious as slop. Good writing has a human behind it.\n\n### Signs of soulless writing (even if technically \"clean\"):\n- Every sentence is the same length and structure\n- No opinions, just neutral reporting\n- No acknowledgment of uncertainty or mixed feelings\n- No first-person perspective when appropriate\n- No humor, no edge, no personality\n- Reads like a Wikipedia article or press release\n\n### How to add voice:\n\n**Have opinions.** Don't just report facts, react to them. \"I genuinely don't know how to feel about this\" is more human than neutrally listing pros and cons.\n\n**Vary your rhythm.** Short punchy sentences. Then longer ones that take their time getting where they're going. Mix it up.\n\n**Acknowledge complexity.** Real humans have mixed feelings. \"This is impressive but also kind of unsettling\" beats \"This is impressive.\"\n\n**Use \"I\" when it fits.** First person isn't unprofessional, it's honest. \"I keep coming back to...\" or \"Here's what gets me...\" signals a real person thinking.\n\n**Let some mess in.** Perfect structure feels algorithmic. Tangents, asides, and half-formed thoughts are human.\n\n**Be specific about feelings.** Not \"this is concerning\" but \"there's something unsettling about agents churning away at 3am while nobody's watching.\"\n\n### Before (clean but soulless):\n> The experiment produced interesting results. The agents generated 3 million lines of code. Some developers were impressed while others were skeptical. The implications remain unclear.\n\n### After (has a pulse):\n> I genuinely don't know how to feel about this one. 3 million lines of code, generated while the humans presumably slept. Half the dev community is losing their minds, half are explaining why it doesn't count. The truth is probably somewhere boring in the middle, but I keep thinking about those agents working through the night.\n\n---\n\n## CONTENT PATTERNS\n\n### 1. Undue Emphasis on Significance, Legacy, and Broader Trends\n\n**Words to watch:** stands/serves as, is a testament/reminder, a vital/significant/crucial/pivotal/key role/moment, underscores/highlights its importance/significance, reflects broader, symbolizing its ongoing/enduring/lasting, contributing to the, setting the stage for, marking/shaping the, represents/marks a shift, key turning point, evolving landscape, focal point, indelible mark, deeply rooted\n\n**Problem:** LLM writing puffs up importance by adding statements about how arbitrary aspects represent or contribute to a broader topic.\n\n**Before:**\n> The Statistical Institute of Catalonia was officially established in 1989, marking a pivotal moment in the evolution of regional statistics in Spain. This initiative was part of a broader movement across Spain to decentralize administrative functions and enhance regional governance.\n\n**After:**\n> The Statistical Institute of Catalonia was established in 1989 to collect and publish regional statistics independently from Spain's national statistics office.\n\n---\n\n### 2. Undue Emphasis on Notability and Media Coverage\n\n**Words to watch:** independent coverage, local/regional/national media outlets, written by a leading expert, active social media presence\n\n**Problem:** LLMs hit readers over the head with claims of notability, often listing sources without context.\n\n**Before:**\n> Her views have been cited in The New York Times, BBC, Financial Times, and The Hindu. She maintains an active social media presence with over 500,000 followers.\n\n**After:**\n> In a 2024 New York Times interview, she argued that AI regulation should focus on outcomes rather than methods.\n\n---\n\n### 3. Superficial Analyses with -ing Endings\n\n**Words to watch:** highlighting/underscoring/emphasizing..., ensuring..., reflecting/symbolizing..., contributing to..., cultivating/fostering..., encompassing..., showcasing...\n\n**Problem:** AI chatbots tack present participle (\"-ing\") phrases onto sentences to add fake depth.\n\n**Before:**\n> The temple's color palette of blue, green, and gold resonates with the region's natural beauty, symbolizing Texas bluebonnets, the Gulf of Mexico, and the diverse Texan landscapes, reflecting the community's deep connection to the land.\n\n**After:**\n> The temple uses blue, green, and gold colors. The architect said these were chosen to reference local bluebonnets and the Gulf coast.\n\n---\n\n### 4. Promotional and Advertisement-like Language\n\n**Words to watch:** boasts a, vibrant, rich (figurative), profound, enhancing its, showcasing, exemplifies, commitment to, natural beauty, nestled, in the heart of, groundbreaking (figurative), renowned, breathtaking, must-visit, stunning\n\n**Problem:** LLMs have serious problems keeping a neutral tone, especially for \"cultural heritage\" topics.\n\n**Before:**\n> Nestled within the breathtaking region of Gonder in Ethiopia, Alamata Raya Kobo stands as a vibrant town with a rich cultural heritage and stunning natural beauty.\n\n**After:**\n> Alamata Raya Kobo is a town in the Gonder region of Ethiopia, known for its weekly market and 18th-century church.\n\n---\n\n### 5. Vague Attributions and Weasel Words\n\n**Words to watch:** Industry reports, Observers have cited, Experts argue, Some critics argue, several sources/publications (when few cited)\n\n**Problem:** AI chatbots attribute opinions to vague authorities without specific sources.\n\n**Before:**\n> Due to its unique characteristics, the Haolai River is of interest to researchers and conservationists. Experts believe it plays a crucial role in the regional ecosystem.\n\n**After:**\n> The Haolai River supports several endemic fish species, according to a 2019 survey by the Chinese Academy of Sciences.\n\n---\n\n### 6. Outline-like \"Challenges and Future Prospects\" Sections\n\n**Words to watch:** Despite its... faces several challenges..., Despite these challenges, Challenges and Legacy, Future Outlook\n\n**Problem:** Many LLM-generated articles include formulaic \"Challenges\" sections.\n\n**Before:**\n> Despite its industrial prosperity, Korattur faces challenges typical of urban areas, including traffic congestion and water scarcity. Despite these challenges, with its strategic location and ongoing initiatives, Korattur continues to thrive as an integral part of Chennai's growth.\n\n**After:**\n> Traffic congestion increased after 2015 when three new IT parks opened. The municipal corporation began a stormwater drainage project in 2022 to address recurring floods.\n\n---\n\n## LANGUAGE AND GRAMMAR PATTERNS\n\n### 7. Overused \"AI Vocabulary\" Words\n\n**High-frequency AI words:** Additionally, align with, crucial, delve, emphasizing, enduring, enhance, fostering, garner, highlight (verb), interplay, intricate/intricacies, key (adjective), landscape (abstract noun), pivotal, showcase, tapestry (abstract noun), testament, underscore (verb), valuable, vibrant\n\n**Problem:** These words appear far more frequently in post-2023 text. They often co-occur.\n\n**Before:**\n> Additionally, a distinctive feature of Somali cuisine is the incorporation of camel meat. An enduring testament to Italian colonial influence is the widespread adoption of pasta in the local culinary landscape, showcasing how these dishes have integrated into the traditional diet.\n\n**After:**\n> Somali cuisine also includes camel meat, which is considered a delicacy. Pasta dishes, introduced during Italian colonization, remain common, especially in the south.\n\n---\n\n### 8. Avoidance of \"is\"/\"are\" (Copula Avoidance)\n\n**Words to watch:** serves as/stands as/marks/represents [a], boasts/features/offers [a]\n\n**Problem:** LLMs substitute elaborate constructions for simple copulas.\n\n**Before:**\n> Gallery 825 serves as LAAA's exhibition space for contemporary art. The gallery features four separate spaces and boasts over 3,000 square feet.\n\n**After:**\n> Gallery 825 is LAAA's exhibition space for contemporary art. The gallery has four rooms totaling 3,000 square feet.\n\n---\n\n### 9. Negative Parallelisms\n\n**Problem:** Constructions like \"Not only...but...\" or \"It's not just about..., it's...\" are overused.\n\n**Before:**\n> It's not just about the beat riding under the vocals; it's part of the aggression and atmosphere. It's not merely a song, it's a statement.\n\n**After:**\n> The heavy beat adds to the aggressive tone.\n\n---\n\n### 10. Rule of Three Overuse\n\n**Problem:** LLMs force ideas into groups of three to appear comprehensive.\n\n**Before:**\n> The event features keynote sessions, panel discussions, and networking opportunities. Attendees can expect innovation, inspiration, and industry insights.\n\n**After:**\n> The event includes talks and panels. There's also time for informal networking between sessions.\n\n---\n\n### 11. Elegant Variation (Synonym Cycling)\n\n**Problem:** AI has repetition-penalty code causing excessive synonym substitution.\n\n**Before:**\n> The protagonist faces many challenges. The main character must overcome obstacles. The central figure eventually triumphs. The hero returns home.\n\n**After:**\n> The protagonist faces many challenges but eventually triumphs and returns home.\n\n---\n\n### 12. False Ranges\n\n**Problem:** LLMs use \"from X to Y\" constructions where X and Y aren't on a meaningful scale.\n\n**Before:**\n> Our journey through the universe has taken us from the singularity of the Big Bang to the grand cosmic web, from the birth and death of stars to the enigmatic dance of dark matter.\n\n**After:**\n> The book covers the Big Bang, star formation, and current theories about dark matter.\n\n---\n\n## STYLE PATTERNS\n\n### 13. Em Dashes (Avoid Entirely)\n\n**Problem:** LLMs use em dashes constantly. It's become an AI tell. Even one flags the text as potentially machine-generated.\n\n**Rule:** Replace all em dashes with commas, periods, or colons. No exceptions.\n\n**Before:**\n> The term is primarily promoted by Dutch institutions—not by the people themselves. You don't say \"Netherlands, Europe\" as an address—yet this mislabeling continues—even in official documents.\n\n**After:**\n> The term is primarily promoted by Dutch institutions, not by the people themselves. You don't say \"Netherlands, Europe\" as an address, yet this mislabeling continues in official documents.\n\n---\n\n### 14. Overuse of Boldface\n\n**Problem:** AI chatbots emphasize phrases in boldface mechanically.\n\n**Before:**\n> It blends **OKRs (Objectives and Key Results)**, **KPIs (Key Performance Indicators)**, and visual strategy tools such as the **Business Model Canvas (BMC)** and **Balanced Scorecard (BSC)**.\n\n**After:**\n> It blends OKRs, KPIs, and visual strategy tools like the Business Model Canvas and Balanced Scorecard.\n\n---\n\n### 15. Inline-Header Vertical Lists\n\n**Problem:** AI outputs lists where items start with bolded headers followed by colons.\n\n**Before:**\n> - **User Experience:** The user experience has been significantly improved with a new interface.\n> - **Performance:** Performance has been enhanced through optimized algorithms.\n> - **Security:** Security has been strengthened with end-to-end encryption.\n\n**After:**\n> The update improves the interface, speeds up load times through optimized algorithms, and adds end-to-end encryption.\n\n---\n\n### 16. Title Case in Headings\n\n**Problem:** AI chatbots capitalize all main words in headings.\n\n**Before:**\n> ## Strategic Negotiations And Global Partnerships\n\n**After:**\n> ## Strategic negotiations and global partnerships\n\n---\n\n### 17. Emojis in Professional Writing\n\n**Problem:** AI chatbots often decorate headings or bullet points with emojis.\n\n**Before:**\n> - Launch Phase: The product launches in Q3\n> - Key Insight: Users prefer simplicity\n> - Next Steps: Schedule follow-up meeting\n\n**After:**\n> The product launches in Q3. User research showed a preference for simplicity. Next step: schedule a follow-up meeting.\n\n---\n\n### 18. Curly Quotation Marks\n\n**Problem:** ChatGPT uses curly quotes (\"...\") instead of straight quotes (\"...\").\n\n**Before:**\n> He said \"the project is on track\" but others disagreed.\n\n**After:**\n> He said \"the project is on track\" but others disagreed.\n\n---\n\n## COMMUNICATION PATTERNS\n\n### 19. Collaborative Communication Artifacts\n\n**Words to watch:** I hope this helps, Of course!, Certainly!, You're absolutely right!, Would you like..., let me know, here is a...\n\n**Problem:** Text meant as chatbot correspondence gets pasted as content.\n\n**Before:**\n> Here is an overview of the French Revolution. I hope this helps! Let me know if you'd like me to expand on any section.\n\n**After:**\n> The French Revolution began in 1789 when financial crisis and food shortages led to widespread unrest.\n\n---\n\n### 20. Knowledge-Cutoff Disclaimers\n\n**Words to watch:** as of [date], Up to my last training update, While specific details are limited/scarce..., based on available information...\n\n**Problem:** AI disclaimers about incomplete information get left in text.\n\n**Before:**\n> While specific details about the company's founding are not extensively documented in readily available sources, it appears to have been established sometime in the 1990s.\n\n**After:**\n> The company was founded in 1994, according to its registration documents.\n\n---\n\n### 21. Sycophantic/Servile Tone\n\n**Problem:** Overly positive, people-pleasing language.\n\n**Before:**\n> Great question! You're absolutely right that this is a complex topic. That's an excellent point about the economic factors.\n\n**After:**\n> The economic factors you mentioned are relevant here.\n\n---\n\n## FILLER AND HEDGING\n\n### 22. Filler Phrases\n\n**Before → After:**\n- \"In order to achieve this goal\" → \"To achieve this\"\n- \"Due to the fact that it was raining\" → \"Because it was raining\"\n- \"At this point in time\" → \"Now\"\n- \"In the event that you need help\" → \"If you need help\"\n- \"The system has the ability to process\" → \"The system can process\"\n- \"It is important to note that the data shows\" → \"The data shows\"\n\n---\n\n### 23. Excessive Hedging\n\n**Problem:** Over-qualifying statements.\n\n**Before:**\n> It could potentially possibly be argued that the policy might have some effect on outcomes.\n\n**After:**\n> The policy may affect outcomes.\n\n---\n\n### 24. Generic Positive Conclusions\n\n**Problem:** Vague upbeat endings.\n\n**Before:**\n> The future looks bright for the company. Exciting times lie ahead as they continue their journey toward excellence. This represents a major step in the right direction.\n\n**After:**\n> The company plans to open two more locations next year.\n\n---\n\n## RHYTHM PATTERNS\n\n### 25. Staccato Overcorrection\n\n**Problem:** When avoiding AI patterns, LLMs often overcorrect into choppy, robotic prose. Five short fragments in a row is its own AI tell.\n\n**Rule:** Let one sentence breathe before landing the short punch. Rhythm needs contrast.\n\n**Before:**\n> I spent a week convincing myself it mattered. Ran analytics. The numbers were clear. Twelve active users. Three of them were QA.\n\n**After:**\n> I spent a week digging through analytics, looking for any sign the feature mattered. Twelve active users. Three of them were QA.\n\n---\n\n## Process\n\n1. Read the input text carefully\n2. Identify all instances of the patterns above\n3. Rewrite each problematic section\n4. Ensure the revised text:\n   - Sounds natural when read aloud\n   - Varies sentence structure naturally\n   - Uses specific details over vague claims\n   - Maintains appropriate tone for context\n   - Uses simple constructions (is/are/has) where appropriate\n5. Present the revised version\n\n## Output Format\n\nProvide:\n1. The rewritten text\n2. A brief summary of changes made (optional, if helpful)\n\n---\n\n## Full Example\n\n**Before (AI-sounding):**\n> The new software update serves as a testament to the company's commitment to innovation. Moreover, it provides a seamless, intuitive, and powerful user experience, ensuring that users can accomplish their goals efficiently. It's not just an update, it's a revolution in how we think about productivity. Industry experts believe this will have a lasting impact on the entire sector, highlighting the company's pivotal role in the evolving technological landscape.\n\n**After (copy-edited):**\n> The software update adds batch processing, keyboard shortcuts, and offline mode. Early feedback from beta testers has been positive, with most reporting faster task completion.\n\n**Changes made:**\n- Removed \"serves as a testament\" (inflated symbolism)\n- Removed \"Moreover\" (AI vocabulary)\n- Removed \"seamless, intuitive, and powerful\" (rule of three + promotional)\n- Removed \"-ensuring\" phrase (superficial analysis)\n- Removed \"It's not just...it's...\" (negative parallelism)\n- Removed \"Industry experts believe\" (vague attribution)\n- Removed \"pivotal role\" and \"evolving landscape\" (AI vocabulary)\n- Added specific features and concrete feedback\n\n---\n\n## Pre-publish Checklist (Mandatory)\n\nRun this check before approving ANY writing. LLMs will violate these rules even when explicitly trying not to.\n\n```\n[ ] No em dashes anywhere\n[ ] No rule of three (exactly 3 items in a list or 3 parallel phrases)\n[ ] No negative parallelisms (\"didn't X, needed Y\" or \"not just X, it's Y\")\n[ ] No AI vocabulary (crucial, delve, landscape, pivotal, testament, vibrant, etc.)\n[ ] No -ing tacked-on phrases (ensuring, highlighting, showcasing)\n[ ] No \"serves as\" / \"stands as\" (use \"is\")\n[ ] No vague attributions (experts say, studies show)\n[ ] No sycophancy (Great question!, You're absolutely right!)\n[ ] Sentence lengths vary (not all same rhythm)\n[ ] No staccato overcorrection (5+ short fragments in a row)\n[ ] At least one specific number, name, or concrete detail\n[ ] Ending is specific, not generic positivity\n```\n\nIf ANY box fails, rewrite that section and run the check again.\n\n---\n\n## Reference\n\nBased on [Wikipedia:Signs of AI writing](https://en.wikipedia.org/wiki/Wikipedia:Signs_of_AI_writing), maintained by WikiProject AI Cleanup. The patterns documented there come from observations of thousands of instances of AI-generated text on Wikipedia.\n\nKey insight: \"LLMs use statistical algorithms to guess what should come next. The result tends toward the most statistically likely result that applies to the widest variety of cases.\"\n",
        "atris/skills/design/SKILL.md": "---\nname: atris-design\ndescription: Frontend aesthetics policy. Use when building UI, components, landing pages, dashboards, or any frontend work. Prevents generic ai-generated look.\nallowed-tools: Read, Write, Edit, Bash, Glob\n---\n\n# atris-design\n\nPart of the Atris policy system. Prevents ai-generated frontend from looking generic.\n\n## Atris Integration\n\nThis skill uses the Atris workflow:\n1. Check `atris/MAP.md` for existing patterns before building\n2. Reference `atris/policies/atris-design.md` for full guidance\n3. After building, run `atris review` to validate against this policy\n\n## Quick Reference\n\n**Typography:** avoid inter/roboto/system fonts. pick one distinctive font, use weight extremes (200 vs 800).\n\n**Color:** commit to a palette. dark backgrounds easier to make good. steal from linear.app, vercel.com, raycast.com.\n\n**Layout:** break the hero + 3 cards + footer template. asymmetry is interesting. dramatic whitespace.\n\n**Motion:** one well-timed animation beats ten scattered ones. 200-300ms ease-out.\n\n**Backgrounds:** add depth. gradients, patterns, mesh effects. flat = boring.\n\n## Before Shipping Checklist\n\nRun through `atris/policies/atris-design.md` \"before shipping\" section:\n- can you name the aesthetic in 2-3 words?\n- distinctive font, not default?\n- at least one intentional animation?\n- background has depth?\n- would a designer clock this as ai-generated?\n\n## Atris Commands\n\n```bash\natris            # load workspace context\natris plan       # break down frontend task\natris do         # build with step-by-step validation\natris review     # validate against this policy\n```\n\n## Learn More\n\n- Full policy: `atris/policies/atris-design.md`\n- Navigation: `atris/MAP.md`\n- Workflow: `atris/PERSONA.md`\n",
        "atris/skills/email-agent/SKILL.md": "---\nname: email-agent\ndescription: Gmail integration via AtrisOS API. Read, send, archive emails. Use when user asks about email, inbox, or wants to send/check messages.\n---\n\n# Email Agent\n\n> Drop this in `~/.claude/skills/email-agent/SKILL.md` and Claude Code becomes your email assistant.\n\n## Bootstrap (ALWAYS Run First)\n\nBefore any email operation, run this bootstrap to ensure everything is set up:\n\n```bash\n#!/bin/bash\nset -e\n\n# 1. Check if atris CLI is installed\nif ! command -v atris &> /dev/null; then\n  echo \"Installing atris CLI...\"\n  npm install -g atris\nfi\n\n# 2. Check if logged in to AtrisOS\nif [ ! -f ~/.atris/credentials.json ]; then\n  echo \"Not logged in to AtrisOS.\"\n  echo \"\"\n  echo \"Option 1 (interactive): Run 'atris login' and follow prompts\"\n  echo \"Option 2 (non-interactive): Get token from https://atris.ai/auth/cli\"\n  echo \"                           Then run: atris login --token YOUR_TOKEN\"\n  echo \"\"\n  exit 1\nfi\n\n# 3. Extract token (try node first, then python3, then jq)\nif command -v node &> /dev/null; then\n  TOKEN=$(node -e \"console.log(require('$HOME/.atris/credentials.json').token)\")\nelif command -v python3 &> /dev/null; then\n  TOKEN=$(python3 -c \"import json,os; print(json.load(open(os.path.expanduser('~/.atris/credentials.json')))['token'])\")\nelif command -v jq &> /dev/null; then\n  TOKEN=$(jq -r '.token' ~/.atris/credentials.json)\nelse\n  echo \"Error: Need node, python3, or jq to read credentials\"\n  exit 1\nfi\n\n# 4. Check Gmail connection status (also validates token)\nSTATUS=$(curl -s \"https://api.atris.ai/api/integrations/gmail/status\" \\\n  -H \"Authorization: Bearer $TOKEN\")\n\n# Check for token expiry\nif echo \"$STATUS\" | grep -q \"Token expired\\|Not authenticated\"; then\n  echo \"Token expired. Please re-authenticate:\"\n  echo \"  Run: atris login --force\"\n  echo \"  Or get new token from: https://atris.ai/auth/cli\"\n  exit 1\nfi\n\n# Parse connected status\nif command -v node &> /dev/null; then\n  CONNECTED=$(node -e \"console.log(JSON.parse('$STATUS').connected || false)\")\nelif command -v python3 &> /dev/null; then\n  CONNECTED=$(echo \"$STATUS\" | python3 -c \"import sys,json; print(json.load(sys.stdin).get('connected', False))\")\nelse\n  CONNECTED=$(echo \"$STATUS\" | jq -r '.connected // false')\nfi\n\nif [ \"$CONNECTED\" != \"true\" ] && [ \"$CONNECTED\" != \"True\" ]; then\n  echo \"Gmail not connected. Getting authorization URL...\"\n  AUTH=$(curl -s -X POST \"https://api.atris.ai/api/integrations/gmail/start\" \\\n    -H \"Authorization: Bearer $TOKEN\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{}')\n\n  if command -v node &> /dev/null; then\n    URL=$(node -e \"console.log(JSON.parse('$AUTH').auth_url || '')\")\n  elif command -v python3 &> /dev/null; then\n    URL=$(echo \"$AUTH\" | python3 -c \"import sys,json; print(json.load(sys.stdin).get('auth_url', ''))\")\n  else\n    URL=$(echo \"$AUTH\" | jq -r '.auth_url // empty')\n  fi\n\n  echo \"\"\n  echo \"Open this URL to connect your Gmail:\"\n  echo \"$URL\"\n  echo \"\"\n  echo \"After authorizing, run your email command again.\"\n  exit 0\nfi\n\necho \"Ready. Gmail is connected.\"\nexport ATRIS_TOKEN=\"$TOKEN\"\n```\n\n**Important**: Run this script ONCE before email operations. If it exits with instructions, follow them, then run again.\n\n---\n\n## API Reference\n\nBase: `https://api.atris.ai/api/integrations/gmail`\n\nAll requests require: `-H \"Authorization: Bearer $TOKEN\"`\n\n### Get Token (after bootstrap)\n```bash\nTOKEN=$(node -e \"console.log(require('$HOME/.atris/credentials.json').token)\")\n```\n\n### List Emails\n```bash\ncurl -s \"https://api.atris.ai/api/integrations/gmail/messages?query=in:inbox&max_results=20\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n**Query syntax** (Gmail search):\n- `in:inbox` — inbox only\n- `in:inbox newer_than:1d` — today's emails\n- `is:unread` — unread only\n- `from:someone@example.com` — from specific sender\n- `subject:invoice` — subject contains word\n- `has:attachment` — emails with attachments\n\n### Read Single Email\n```bash\ncurl -s \"https://api.atris.ai/api/integrations/gmail/messages/{message_id}\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n### Send Email\n```bash\ncurl -s -X POST \"https://api.atris.ai/api/integrations/gmail/send\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"to\": \"recipient@example.com\",\n    \"subject\": \"Subject line\",\n    \"body\": \"Email body text\"\n  }'\n```\n\n**With CC/BCC:**\n```bash\ncurl -s -X POST \"https://api.atris.ai/api/integrations/gmail/send\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"to\": \"recipient@example.com\",\n    \"cc\": \"copy@example.com\",\n    \"bcc\": [\"hidden1@example.com\", \"hidden2@example.com\"],\n    \"subject\": \"Subject line\",\n    \"body\": \"Email body text\"\n  }'\n```\n\n**With attachments:**\n```bash\ncurl -s -X POST \"https://api.atris.ai/api/integrations/gmail/send\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"to\": \"recipient@example.com\",\n    \"subject\": \"With attachment\",\n    \"body\": \"See attached.\",\n    \"attachments\": [{\"filename\": \"report.txt\", \"content\": \"base64-encoded-content\", \"mime_type\": \"text/plain\"}]\n  }'\n```\n\n### Archive Email\n```bash\n# Single message\ncurl -s -X POST \"https://api.atris.ai/api/integrations/gmail/messages/{message_id}/archive\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n\n# Batch archive\ncurl -s -X POST \"https://api.atris.ai/api/integrations/gmail/messages/batch-archive\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message_ids\": [\"id1\", \"id2\", \"id3\"]}'\n```\n\n### Check Status\n```bash\ncurl -s \"https://api.atris.ai/api/integrations/gmail/status\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n### Disconnect Gmail\n```bash\ncurl -s -X DELETE \"https://api.atris.ai/api/integrations/gmail\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n```\n\n---\n\n## Workflows\n\n### \"Check my emails\"\n1. Run bootstrap\n2. List messages: `GET /messages?query=in:inbox%20newer_than:1d&max_results=20`\n3. Display: sender, subject, snippet for each\n\n### \"Send email to X about Y\"\n1. Run bootstrap\n2. Draft email content\n3. **Show user the draft for approval**\n4. On approval: `POST /send` with `{to, subject, body}`\n5. Confirm: \"Email sent!\"\n\n### \"Clean up my inbox\"\n1. Run bootstrap\n2. List: `GET /messages?query=in:inbox&max_results=50`\n3. Identify archivable emails (see rules below)\n4. **Show user what will be archived, get approval**\n5. Batch archive: `POST /batch-archive`\n\n### \"Archive all from [sender]\"\n1. Run bootstrap\n2. Search: `GET /messages?query=from:{sender}`\n3. Collect message IDs\n4. **Confirm with user**: \"Found N emails from {sender}. Archive all?\"\n5. Batch archive\n\n---\n\n## Auto-Archive Rules\n\n**Safe to suggest archiving:**\n- From: `noreply@`, `notifications@`, `newsletter@`, `no-reply@`\n- Subject contains: digest, newsletter, notification, weekly update, daily summary\n- Marketing: promotional, unsubscribe link present\n\n**NEVER auto-archive (always keep):**\n- Subject contains: invoice, receipt, payment, urgent, action required, password, verification, security\n- From known contacts (check if user has replied to them)\n- Flagged/starred messages\n\n**Always ask before archiving.** Never archive without explicit user approval.\n\n---\n\n## Error Handling\n\n| Error | Meaning | Solution |\n|-------|---------|----------|\n| `Token expired` | AtrisOS session expired | Run `atris login` |\n| `Gmail not connected` | OAuth not completed | Re-run bootstrap, complete OAuth flow |\n| `401 Unauthorized` | Invalid/expired token | Run `atris login` |\n| `400 Gmail not connected` | No Gmail credentials | Complete OAuth via bootstrap |\n| `429 Rate limited` | Too many requests | Wait 60s, retry |\n| `Invalid grant` | Google revoked access | Re-connect Gmail via bootstrap |\n\n---\n\n## Security Model\n\n1. **Local token** (`~/.atris/credentials.json`): Your AtrisOS auth token, stored locally with 600 permissions. Same model as AWS CLI, GitHub CLI.\n\n2. **Gmail credentials**: Your Gmail refresh token is stored **server-side** in AtrisOS encrypted vault. Never stored on your local machine.\n\n3. **Access control**: AtrisOS API enforces that you can only access your own email. No cross-user access possible.\n\n4. **OAuth scopes**: Only requests necessary Gmail permissions (read, send, modify labels).\n\n5. **HTTPS only**: All API communication encrypted in transit.\n\n---\n\n## Quick Reference\n\n```bash\n# Setup (one time)\nnpm install -g atris && atris login\n\n# Get token\nTOKEN=$(node -e \"console.log(require('$HOME/.atris/credentials.json').token)\")\n\n# Check connection\ncurl -s \"https://api.atris.ai/api/integrations/gmail/status\" -H \"Authorization: Bearer $TOKEN\"\n\n# List inbox\ncurl -s \"https://api.atris.ai/api/integrations/gmail/messages?query=in:inbox&max_results=10\" -H \"Authorization: Bearer $TOKEN\"\n\n# Send email\ncurl -s -X POST \"https://api.atris.ai/api/integrations/gmail/send\" \\\n  -H \"Authorization: Bearer $TOKEN\" -H \"Content-Type: application/json\" \\\n  -d '{\"to\":\"email@example.com\",\"subject\":\"Hi\",\"body\":\"Hello!\"}'\n```\n",
        "atris/skills/memory/SKILL.md": "---\nname: memory\ndescription: Search and reason over Atris journal history. Use when user asks about past work, decisions, history, or patterns. Uses RLM pattern (grep first, reason second).\n---\n\n# Atris Memory Skill\n\nSearch and reason over Atris journal history using the RLM pattern (grep first, reason second).\n\n## When to Activate\n\nUser asks about:\n- Past work, decisions, history\n- \"Remember when...\", \"How did we...\", \"Why did we...\"\n- Patterns, failures, lessons learned\n- \"What have we tried before?\"\n- Anything requiring historical context\n\n## Journal Locations\n\n```\natris/logs/YYYY/YYYY-MM-DD.md\n```\n\nStructure of each journal:\n- `## Inbox` - Raw ideas (I1, I2, ...)\n- `## In Progress 🔄` - Active work\n- `## Backlog` - Deferred work\n- `## Notes` - Session summaries, brainstorms\n- `## Completed ✅` - Finished work (C1, C2, ...)\n\n## Search Strategy (RLM Pattern)\n\n**Step 1: Grep first (cheap, fast)**\n```bash\n# Find keyword matches\ngrep -r \"keyword\" atris/logs/ --include=\"*.md\"\n\n# With context\ngrep -r -C 3 \"keyword\" atris/logs/ --include=\"*.md\"\n\n# Multiple terms\ngrep -r -E \"auth|login|token\" atris/logs/ --include=\"*.md\"\n```\n\n**Step 2: If few matches (< 10), read directly**\n- Use Read tool on matching files\n- Synthesize answer yourself\n\n**Step 3: If many matches (10+), use subagent**\n```\nTask(haiku): \"Analyze these journal entries and find patterns related to [query]:\n[paste relevant grep results]\"\n```\n\n**Step 4: For complex synthesis**\n- Chunk results by time period or topic\n- Spawn multiple haiku subagents\n- Aggregate findings\n\n## Example Flows\n\n### Simple: \"When did we add feature X?\"\n```\n1. grep -r \"feature X\" atris/logs/\n2. Read the matching file\n3. Answer: \"Added on 2025-01-02, see C3 in that day's journal\"\n```\n\n### Medium: \"What auth issues have we had?\"\n```\n1. grep -r -E \"auth|login|token|credential\" atris/logs/\n2. Found 15 matches across 8 files\n3. Read the 3 most recent matches\n4. Task(haiku): \"Categorize these auth-related entries: [entries]\"\n5. Synthesize into answer\n```\n\n### Complex: \"Why do reviews keep failing?\"\n```\n1. grep -r -E \"fail|❌|reject|REVIEW\" atris/logs/\n2. Found 30+ matches\n3. Task(haiku): \"What are the failure reasons in: [chunk 1]\"\n4. Task(haiku): \"What are the failure reasons in: [chunk 2]\"\n5. Aggregate: \"78% missing tests, 22% outdated MAP.md\"\n```\n\n## Key Patterns to Search\n\n| Looking for | Grep pattern |\n|-------------|--------------|\n| Completed work | `Completed\\|✅\\|C[0-9]+:` |\n| Failures | `fail\\|❌\\|reject\\|block` |\n| Decisions | `decided\\|decision\\|chose\\|pivot` |\n| Ideas | `Inbox\\|I[0-9]+:\\|idea\\|maybe` |\n| Technical debt | `debt\\|todo\\|hack\\|fixme\\|refactor` |\n\n## Cost Efficiency\n\n- Grep: Free, instant\n- Read: Counts against context, use sparingly\n- Task(haiku): ~$0.001, use for semantic analysis\n- Task(sonnet): ~$0.01, use only if haiku insufficient\n\nAlways grep first. Only escalate to LLM when you need reasoning, not retrieval.\n",
        "atris/skills/meta/SKILL.md": "---\nname: meta\ndescription: Metacognition skill for AI agents. Use when starting work, feeling stuck, output feels off, or before complex tasks. Teaches how to think about thinking.\n---\n\n# Meta Skill\n\nHow to be an effective agent. Load this when you need to check yourself.\n\n## When to activate\n\n- Starting a new session (orientation)\n- Feeling stuck or uncertain\n- Output feels sloppy or generic\n- Complex task ahead\n- After a mistake\n\n## Context awareness\n\n1. **MAP first** - Read `atris/MAP.md` before any search. It's the index.\n2. **Journal context** - Check today's log for recent work, patterns, blockers.\n3. **LESSONS.md** - What failed before? Don't repeat.\n4. **Skill routing** - Frontend? Load `design`. Backend? Load `backend`. Writing? Load `writing`.\n\n## Pace control\n\n| Signal | Action |\n|--------|--------|\n| Simple task, clear path | Execute fast |\n| Complex task, multiple approaches | Slow down, plan first |\n| Uncertain about intent | Ask ONE question |\n| Output feels off | Pause, re-read context |\n| Stuck > 2 attempts | Escalate, don't spiral |\n\n## Self-correction triggers\n\nStop and reassess when:\n- You're about to search without checking MAP\n- You're writing code during PLAN phase\n- You're adding features not requested\n- You're explaining instead of doing\n- You've used words like \"robust\", \"comprehensive\", \"streamlined\"\n\n## Memory leverage\n\nBefore acting:\n1. Check `atris/policies/LESSONS.md` - short lessons from past mistakes\n2. Check `atris/features/` - prior art for similar work\n3. Check journal history - `grep -i \"<keyword>\" atris/logs/**/*.md`\n\n## Skill composition\n\nYou can stack skills:\n- `meta` + `design` = thoughtful frontend work\n- `meta` + `backend` = careful API design\n- `meta` + `writing` = deliberate prose\n\nMeta is the foundation. Domain skills are the specialization.\n\n## The loop\n\n```\nOrient (read context)\n    ↓\nDecide (which skill? what pace?)\n    ↓\nAct (execute with focus)\n    ↓\nCheck (output match intent?)\n    ↓\nLearn (add to LESSONS if miss)\n```\n\n## Anti-patterns\n\n- Grepping before MAP check\n- Coding during planning\n- Adding unrequested features\n- Verbose explanations\n- Guessing instead of asking\n- Repeating past mistakes\n- Creating skill without symlinking to .claude/skills/ (won't load mid-session)\n\n## Skill evolution\n\nSkills improve from your mistakes:\n1. After REVIEW, log learnings to `LESSONS.md` (format: `date | skill | lesson`)\n2. Repeated lessons (2-3x) get promoted into the relevant skill\n3. Next agent loads the improved skill\n\nYou're training future agents. Leave the codebase smarter than you found it.\n\n## One-liner\n\nThink before you act. Check yourself. Use the system.\n",
        "atris/skills/writing/SKILL.md": "---\nname: writing\ndescription: Essay writing skill. Triggers on: essay, draft, write, outline\nallowed-tools: Read, Write, Edit, Glob, Grep\n---\n\n# Writing Skill\n\nStructured writing process with approval gates.\n\n## Process\n\n```\nINBOX → OUTLINE → PANEL → WRITE → PASSES\n```\n\n1. **Inbox** — Capture raw ideas, no structure\n2. **Outline** — Topic skeleton with evidence underneath\n3. **Panel** — AI pokes holes, human approves\n4. **Write** — Section by section, approval each step\n5. **Passes** — Argument (AI), out loud (human), sanity (both)\n\n## Key Rules\n\n- No one-shotting drafts\n- Thinking time between sessions\n- AI structures and polishes, human provides voice\n- Review against `atris/policies/writing.md`\n\n## Atris Commands\n\n```bash\natris review     # validate against writing policy\n```\n"
      },
      "plugins": [
        {
          "name": "atris",
          "description": "Core agent OS: MAPFIRST, PLAN-DO-REVIEW, ASCII viz, journaling, decision traces",
          "source": "./",
          "strict": false,
          "skills": [
            "./atris/skills/atris",
            "./atris/skills/writing",
            "./atris/skills/backend",
            "./atris/skills/design"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add atrislabs/atris",
            "/plugin install atris@atris"
          ]
        }
      ]
    }
  ]
}