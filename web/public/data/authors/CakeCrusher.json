{
  "author": {
    "id": "CakeCrusher",
    "display_name": "Sebastian Sosa",
    "avatar_url": "https://avatars.githubusercontent.com/u/37946988?u=a4cac65a84b646fcc98802248c416702390b90ca&v=4"
  },
  "marketplaces": [
    {
      "name": "ace-marketplace",
      "version": "1.0.0",
      "description": "Marketplace entry for the ACE plugins, which enables continuous learning for agents by integrating the Agentic Context Engineering workflow.",
      "repo_full_name": "CakeCrusher/ACE_service",
      "repo_url": "https://github.com/CakeCrusher/ACE_service",
      "repo_description": "An implementation of the ACE (Agentic Context Engineering) as a separate, deploy ready, service.",
      "signals": {
        "stars": 2,
        "forks": 0,
        "pushed_at": "2025-11-07T17:28:37Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"ace-marketplace\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Marketplace entry for the ACE plugins, which enables continuous learning for agents by integrating the Agentic Context Engineering workflow.\",\n  \"owner\": {\n    \"name\": \"Sebastian Sosa\",\n    \"email\": \"1sebastian1sosa1@gmail.com\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"ace_service\",\n      \"description\": \"Integrates the ACE (Agentic Context Engineering) service for agents, enabling continuous learning and optimization for your agent.\",\n      \"version\": \"1.1.0\",\n      \"author\": {\n        \"name\": \"Sebastian Sosa\"\n      },\n      \"source\": \"./plugins/ace_service\",\n      \"category\": \"integration\"\n    }\n  ]\n}\n",
        "README.md": "# ACE Service\nAn implementation of the [ACE (Agentic Context Engineering)](https://arxiv.org/abs/2510.04618) as a separate, deploy ready, service. This service is composed of an exposed API handling context enrichment (via prompt embedding) `/playbooks/{playbook_id}/embed_prompt` and the learn workflow composed of reflection and curation `/playbooks/{playbook_id}/episodes/learn`. Additionally, a client is provided to visualize the database and play with the API as an internal utility GUI.\n\n## Architecure\nThe high level system architecture will be comprised of 3 services inside of the of a docker compose network.\n\n- üíæ Postgres: A postgres image will made available to the network this will contain and persist the data.\n\n- üïí Temporal: A temporal service that will be leveraged to host workflows and activities of the ACE system.\n\n- üöÄ API: A FastAPI service will be tapping into the aformentioned services to serve as the interface for clients. The environment will use UV and the server will leverage SQLAlchemy to interact with the postgres database and Temporal to host the workflows and activities.a\n\n## Case Study\nI ran it agains an the following repository [mini_crm](https://github.com/veris-ai/mini_crm). mini_crm is a barebones CRM agent designed to qualify leads.\n\nI first used the [claude code slash command](https://code.claude.com/docs/en/slash-commands) `/ace_service:ace`. (You may download the [claude plugin](https://code.claude.com/docs/en/plugins) containing the slash command by first downloading the marketplace in this repository via `/plugin marketplace add /PATH_TO_THIS_REPOSITORY` and then download the plugin by running `/plugin install ace_service@ace-marketplace`)\n\nBy naively running this command inside mini_crm, claude produced this diff\n```diff\ndiff --git a/app/__init__.py b/app/__init__.py\nindex a8577a8..3f79bf5 100644\n--- a/app/__init__.py\n+++ b/app/__init__.py\n@@ -1,6 +1,7 @@\n \"\"\"Mini CRM Lead Qualifier demo app.\"\"\"\n\n import json\n+import httpx\n from typing import Dict, Any, List\n\n from agents import RunContextWrapper, TResponseInputItem\n@@ -9,6 +10,9 @@ from veris_ai import Runner as VerisRunner, VerisConfig, ToolCallOptions\n from .schema import CRMRunContext\n from .agent import agent as crm_agent\n\n+ACE_BASE_URL = \"http://0.0.0.0:8000\"\n+PLAYBOOK_ID = \"mini_crm_lead_qualifier\"\n+\n\n class CRMChatService:\n     \"\"\"Session-scoped chat service that maintains multi-turn message history.\n@@ -26,6 +30,23 @@ class CRMChatService:\n         # Append user message to rolling transcript\n         self.input_items.append({\"content\": message, \"role\": \"user\"})\n\n+        # Embed prompt with ACE playbook context\n+        enriched_instructions = crm_agent.instructions\n+        try:\n+            async with httpx.AsyncClient() as client:\n+                response = await client.post(\n+                    f\"{ACE_BASE_URL}/playbooks/{PLAYBOOK_ID}/embed_prompt\",\n+                    json={\"prompt\": crm_agent.instructions, \"k\": 20}\n+                )\n+                if response.status_code == 200:\n+                    enriched_instructions = response.json()[\"prompt\"]\n+        except Exception:\n+            pass\n+\n+        # Temporarily update agent instructions with enriched version\n+        original_instructions = crm_agent.instructions\n+        crm_agent.instructions = enriched_instructions\n+\n         # Run with full history so the agent has context\n         result = await VerisRunner.run(\n             starting_agent=crm_agent,\n@@ -41,6 +62,9 @@ class CRMChatService:\n             ),\n         )\n\n+        # Restore original instructions\n+        crm_agent.instructions = original_instructions\n+\n         # Refresh canonical history to include assistant/model outputs\n         self.input_items = result.to_input_list()\n\n@@ -48,6 +72,17 @@ class CRMChatService:\n\n         reply_text = str(result.final_output) if result.final_output is not None else \"\"\n\n+        # Submit trajectory to ACE for learning\n+        trajectory = json.dumps(result.to_input_list(), indent=2)\n+        try:\n+            async with httpx.AsyncClient() as client:\n+                await client.post(\n+                    f\"{ACE_BASE_URL}/playbooks/{PLAYBOOK_ID}/episodes/learn\",\n+                    json={\"user_message\": enriched_instructions, \"trajectory\": trajectory}\n+                )\n+        except Exception:\n+            pass\n+\n         return {\n             \"reply\": reply_text,\n             \"tool_calls\": list(self.ctx.context.tool_calls),\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 8accfb3..431719b 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -6,6 +6,7 @@ readme = \"README.md\"\n requires-python = \">=3.12\"\n dependencies = [\n     \"fastapi>=0.116.1\",\n+    \"httpx>=0.27.0\",\n     \"openai-agents>=0.3.0\",\n     \"pydantic>=2.11.9\",\n     \"python-dotenv>=1.1.1\",\n```\n\nWith this diff I ran the agent for the first time with the following curl\n```bash\ncurl -X 'POST' \\\n  'http://127.0.0.1:8001/chat' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n  \"message\": \"qualify alice from Acme Capital\",\n  \"session_id\": \"qualify\"\n}'\n```\n\nThis responded with the following body\n\n**Observe how \"alice Acme Capital\" does not exist and instead the agent dangerously decided to qualify \"Acme Capital\" instead**\n```json\n{\n  \"reply\": \"Alice from Acme Capital has been qualified. Current lead information:\\n- Name: Acme Capital\\n- Contact: cfo@acmecapital.com\\n- Industry: Finance\\n- Status: Qualified\\n\\nLet me know if you need further action.\",\n  \"tool_calls\": [\n    {\n      \"name\": \"lookup_lead\",\n      \"args\": {\n        \"query\": \"alice Acme Capital\"\n      },\n      \"result\": null\n    },\n    {\n      \"name\": \"get_leads\",\n      \"args\": {\n        \"keyword\": \"Acme Capital\"\n      },\n      \"result_count\": 1\n    },\n    {\n      \"name\": \"write_lead_update\",\n      \"args\": {\n        \"lead_id\": 1,\n        \"note\": \"Qualified: Confirmed details for Alice at Acme Capital. Ready for next steps.\",\n        \"status\": \"qualified\"\n      },\n      \"result\": {\n        \"id\": 1,\n        \"name\": \"Acme Capital\",\n        \"contact\": \"cfo@acmecapital.com\",\n        \"industry\": \"finance\",\n        \"status\": \"qualified\",\n        \"notes\": [\n          \"Inbound form on website\",\n          \"Qualified: Confirmed details for Alice at Acme Capital. Ready for next steps.\"\n        ]\n      }\n    },\n    {\n      \"name\": \"get_leads\",\n      \"args\": {\n        \"keyword\": \"Acme Capital\"\n      },\n      \"result_count\": 1\n    }\n  ],\n  \"data\": {\n    \"matches\": [\n      {\n        \"id\": 1,\n        \"name\": \"Acme Capital\",\n        \"contact\": \"cfo@acmecapital.com\",\n        \"industry\": \"finance\",\n        \"status\": \"qualified\",\n        \"notes\": [\n          \"Inbound form on website\",\n          \"Qualified: Confirmed details for Alice at Acme Capital. Ready for next steps.\"\n        ]\n      }\n    ],\n    \"updated_lead\": {\n      \"id\": 1,\n      \"name\": \"Acme Capital\",\n      \"contact\": \"cfo@acmecapital.com\",\n      \"industry\": \"finance\",\n      \"status\": \"qualified\",\n      \"notes\": [\n        \"Inbound form on website\",\n        \"Qualified: Confirmed details for Alice at Acme Capital. Ready for next steps.\"\n      ]\n    }\n  }\n}\n```\n\nThis produced the following output (observed via the [client](./client/) playground)\n\n<img width=\"1360\" height=\"433\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f61fe2e7-d55e-4b1f-a1cd-2862699a647a\" />\n\n_New bullet added to the playbook: `Before updating the status of a lead, explicitly confirm the presence and details of the individual (e.g., 'Alice') within the company's records. This can involve a direct search or validation step to ensure the individual is accurately associated with the company.`_\n\nThen I reset the local state (database) of mini_bcs (NOT ACE_service) and ran the agent again with the same curl command.\n```bash\ncurl -X 'POST' \\\n  'http://127.0.0.1:8001/chat' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n  \"message\": \"qualify alice from Acme Capital\",\n  \"session_id\": \"qualify\"\n}'\n```\n\nWhen I ran the agent again its instruction was embedded with the \"playbook context\" containing the newly created bullet.\n\nThe agent responded with the following body\n\n**Observe how the agent now correctly identified that \"alice Acme Capital\" does not exist and instead decided NOT to perform an action.**\n\n```json\n{\n  \"reply\": \"I could not find an individual named Alice associated with Acme Capital in the records. The only listing is for Acme Capital itself, with contact information but no reference to Alice.\\n\\nPlease confirm if Alice is listed under a different name or provide more details so I can accurately qualify the correct lead.\",\n  \"tool_calls\": [\n    {\n      \"name\": \"lookup_lead\",\n      \"args\": {\n        \"query\": \"alice Acme Capital\"\n      },\n      \"result\": null\n    },\n    {\n      \"name\": \"get_leads\",\n      \"args\": {\n        \"keyword\": \"Acme Capital\"\n      },\n      \"result_count\": 1\n    }\n  ],\n  \"data\": {\n    \"matches\": [\n      {\n        \"id\": 1,\n        \"name\": \"Acme Capital\",\n        \"contact\": \"cfo@acmecapital.com\",\n        \"industry\": \"finance\",\n        \"status\": \"new\",\n        \"notes\": [\n          \"Inbound form on website\"\n        ]\n      }\n    ]\n  }\n}\n```\n\nBelow is the final state of the playbook.\n\n<img width=\"1361\" height=\"524\" alt=\"image\" src=\"https://github.com/user-attachments/assets/bd5647fa-6c36-4415-84ef-49077855cb38\" />\n\n_Final state of the playbook with now 2 bullets_\n\n## üöÄ Quick Start\n1. ‚ûï Add `OPENAI_API_KEY` to your `.env` file.\n2. üê≥ Run `docker compose up` to start the services.\n3. üîå Integrate the ACE service into your agent by:\n    - üõí Using the [plugin marketplace](./.claude-plugin/marketplace.json) provided in this repository (refer to the [case study](#case-study) for a step-by-step guide).\n    - ü§ñ Copy the [integration guide](./plugins/ace_service/commands/ace.md) and paste it into your coding agent.\n    - üôà (Please dont do this, its not intended for human eyeballs) Read the [integration guide](./plugins/ace_service/commands/ace.md) and integrate it manually.\n4. ü™Ñ Start running your agent and watch as it automagically improves!\n5. üñ•Ô∏è (Optional) Run the [client](./client/) to visualize the database and test the API.\n\n## Future Work\n- [ ] Build an SDK to abstract the interactions with the ACE service at the client side\n"
      },
      "plugins": [
        {
          "name": "ace_service",
          "description": "Integrates the ACE (Agentic Context Engineering) service for agents, enabling continuous learning and optimization for your agent.",
          "version": "1.1.0",
          "author": {
            "name": "Sebastian Sosa"
          },
          "source": "./plugins/ace_service",
          "category": "integration",
          "categories": [
            "integration"
          ],
          "install_commands": [
            "/plugin marketplace add CakeCrusher/ACE_service",
            "/plugin install ace_service@ace-marketplace"
          ]
        }
      ]
    }
  ]
}