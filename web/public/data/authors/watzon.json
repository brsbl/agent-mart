{
  "author": {
    "id": "watzon",
    "display_name": "Chris Watson",
    "avatar_url": "https://avatars.githubusercontent.com/u/4535422?u=ecba10ad3be6ab0ab0a536749db70fdd5f8ce655&v=4"
  },
  "marketplaces": [
    {
      "name": "watzon-marketplace",
      "version": null,
      "description": "Plugins related to Crystal and other things no one else wants to write",
      "repo_full_name": "watzon/claude-code",
      "repo_url": "https://github.com/watzon/claude-code",
      "repo_description": null,
      "signals": {
        "stars": 1,
        "forks": 0,
        "pushed_at": "2026-01-17T20:04:38Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"watzon-marketplace\",\n  \"owner\": {\n    \"name\": \"Chris Watson\",\n    \"email\": \"cawatson1993@gmail.com\",\n    \"url\": \"https://watzon.tech\"\n  },\n  \"description\": \"Plugins related to Crystal and other things no one else wants to write\",\n  \"homepage\": \"https://github.com/watzon/claude-code\",\n  \"plugins\": [\n    {\n      \"name\": \"crystal-lsp\",\n      \"source\": \"./crystal-lsp\",\n      \"description\": \"Crystal language server support\"\n    },\n    {\n      \"name\": \"ameba-ls\",\n      \"source\": \"./ameba-ls\",\n      \"description\": \"Ameba linting language server for Crystal\"\n    }\n  ]\n}\n",
        "README.md": "# Claude Code Plugins\n\nPlugins and patches for [Claude Code](https://docs.anthropic.com/en/docs/claude-code), including an LSP fix and Crystal language support.\n\n## Table of Contents\n\n- [Background](#background)\n- [Install](#install)\n- [Usage](#usage)\n  - [LSP Patch](#lsp-patch)\n  - [Plugin Marketplace](#plugin-marketplace)\n- [Plugins](#plugins)\n- [Contributing](#contributing)\n- [Credits](#credits)\n- [License](#license)\n\n## Background\n\nClaude Code v2.0.76 has a bug ([#13952](https://github.com/anthropics/claude-code/issues/13952)) where LSP servers from plugins fail to load. The initialize function in the LSP server manager is empty and does nothing.\n\nThis repository provides:\n1. A patch script to fix the LSP loading bug\n2. A plugin marketplace with custom plugins (starting with Crystal language support)\n\n## Install\n\n### LSP Patch\n\n```bash\ngit clone https://github.com/watzon/claude-code\ncd claude-code\nchmod +x lsp-patch.sh\n./lsp-patch.sh\n```\n\n### Plugin Marketplace\n\nAdd to your Claude Code settings (`~/.claude/settings.json`):\n\n```json\n{\n  \"pluginMarketplaces\": [\n    \"https://github.com/watzon/claude-code\"\n  ]\n}\n```\n\nThen install plugins:\n\n```\n/plugin install crystal-lsp@watzon-marketplace\n```\n\n## Usage\n\n### LSP Patch\n\n```bash\n# Check if patch is needed/applied\n./lsp-patch.sh --check\n\n# Apply the patch\n./lsp-patch.sh\n\n# Restore original (if needed)\n./lsp-patch.sh --restore\n```\n\nThe script auto-detects Claude Code installations:\n- Bun global (`~/.bun/install/global/...`)\n- Native (`~/.claude/local/...`)\n- npm global (`/usr/local/lib/node_modules/...`)\n- fnm/nvm managed Node versions\n\n**Note:** The patch is overwritten when Claude Code updates. Re-run after updates if LSP stops working.\n\n### Plugin Marketplace\n\nAfter adding the marketplace to settings, use `/plugin` in Claude Code to browse and install plugins.\n\n## Plugins\n\n| Plugin | Description |\n|--------|-------------|\n| [crystal-lsp](./crystal-lsp/) | Crystal language server support |\n\n## Contributing\n\nPRs welcome. For bugs, please open an issue first.\n\nTo add a plugin:\n1. Create a subdirectory with `.claude-plugin/plugin.json`\n2. Add an entry to `.claude-plugin/marketplace.json`\n3. Submit a PR\n\n## Credits\n\n- [@Zamua](https://github.com/Zamua) — Original LSP patch: https://gist.github.com/Zamua/f7ca58ce5dd9ba61279ea195a01b190c\n\n## License\n\nMIT © Chris Watson\n",
        "crystal-lsp/README.md": "# crystal-lsp\n\nCrystal language server plugin for Claude Code.\n\n## Table of Contents\n\n- [Background](#background)\n- [Install](#install)\n  - [Prerequisites](#prerequisites)\n  - [Plugin Installation](#plugin-installation)\n  - [LSP Patch](#lsp-patch)\n- [Usage](#usage)\n- [Configuration](#configuration)\n- [Troubleshooting](#troubleshooting)\n- [Contributing](#contributing)\n- [License](#license)\n\n## Background\n\nThis plugin adds Crystal language support to Claude Code via [crystal_lsp](https://github.com/skuznetsov/crystal_lsp), providing:\n\n- Document symbols (classes, methods, variables)\n- Hover information (types, documentation)\n- Go to definition\n- Find references\n- Semantic diagnostics (type errors, undefined variables)\n\n## Install\n\n### Prerequisites\n\nBuild and install [crystal_lsp](https://github.com/skuznetsov/crystal_lsp):\n\n```bash\ngit clone https://github.com/skuznetsov/crystal_lsp\ncd crystal_lsp\n./build_lsp.sh\nln -s \"$(pwd)/bin/crystal_v2_lsp\" ~/.local/bin/crystal_lsp\n```\n\nEnsure `~/.local/bin` is in your PATH.\n\n### Plugin Installation\n\n**Via marketplace:**\n\n1. Add to `~/.claude/settings.json`:\n   ```json\n   {\n     \"pluginMarketplaces\": [\n       \"https://github.com/watzon/claude-code\"\n     ]\n   }\n   ```\n\n2. Install:\n   ```\n   /plugin install crystal-lsp@watzon-marketplace\n   ```\n\n**Manual:** Copy this directory to `~/.claude/plugins/`.\n\n### LSP Patch\n\nClaude Code v2.0.76 has a bug where LSP plugins don't load ([#13952](https://github.com/anthropics/claude-code/issues/13952)).\n\nApply the fix from the parent directory:\n\n```bash\n../lsp-patch.sh\n```\n\nOr use [@Zamua's patch](https://gist.github.com/Zamua/f7ca58ce5dd9ba61279ea195a01b190c).\n\n## Usage\n\nAfter installation and restart, Claude Code provides Crystal language features for `.cr` and `.ecr` files:\n\n```\n# In Claude Code, use LSP operations on Crystal files:\nLSP documentSymbol  # List symbols in file\nLSP hover           # Get type info at cursor\nLSP goToDefinition  # Jump to definition\n```\n\n## Configuration\n\nThe `.lsp.json` configures the language server:\n\n```json\n{\n  \"crystal\": {\n    \"command\": \"crystal_lsp\",\n    \"extensionToLanguage\": {\n      \".cr\": \"crystal\",\n      \".ecr\": \"crystal\"\n    },\n    \"env\": {\n      \"CRYSTALV2_LSP_ENABLE_SEMANTIC_DIAGNOSTICS\": \"1\"\n    }\n  }\n}\n```\n\n### Using Crystalline\n\nTo use [crystalline](https://github.com/elbywan/crystalline) instead:\n\n```json\n{\n  \"crystal\": {\n    \"command\": \"crystalline\",\n    ...\n  }\n}\n```\n\n## Troubleshooting\n\n**LSP not loading:** Apply the LSP patch (see [Install](#lsp-patch)), then restart Claude Code.\n\n**No diagnostics:** Verify `CRYSTALV2_LSP_ENABLE_SEMANTIC_DIAGNOSTICS=1` is set in `.lsp.json`, then restart.\n\n**Command not found:** Ensure `crystal_lsp` is in your PATH.\n\n## Contributing\n\nPRs welcome. For bugs, open an issue at [watzon/claude-code](https://github.com/watzon/claude-code/issues).\n\n## License\n\nMIT © Chris Watson\n"
      },
      "plugins": [
        {
          "name": "crystal-lsp",
          "source": "./crystal-lsp",
          "description": "Crystal language server support",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add watzon/claude-code",
            "/plugin install crystal-lsp@watzon-marketplace"
          ]
        },
        {
          "name": "ameba-ls",
          "source": "./ameba-ls",
          "description": "Ameba linting language server for Crystal",
          "categories": [],
          "install_commands": [
            "/plugin marketplace add watzon/claude-code",
            "/plugin install ameba-ls@watzon-marketplace"
          ]
        }
      ]
    }
  ]
}