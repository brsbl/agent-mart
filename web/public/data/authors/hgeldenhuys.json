{
  "author": {
    "id": "hgeldenhuys",
    "display_name": "hgeldenhuys",
    "avatar_url": "https://avatars.githubusercontent.com/u/179999?u=989a39fc64e9eb433a91c144702942251a989d7f&v=4"
  },
  "marketplaces": [
    {
      "name": "claude-skills-marketplace",
      "version": "1.0.0",
      "description": "Official marketplace for Claude Code agent lifecycle, knowledge management, and SDLC orchestration plugins",
      "repo_full_name": "hgeldenhuys/claude-agent-lifecycle",
      "repo_url": "https://github.com/hgeldenhuys/claude-agent-lifecycle",
      "repo_description": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2025-12-06T19:43:12Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"claude-skills-marketplace\",\n  \"description\": \"Official marketplace for Claude Code agent lifecycle, knowledge management, and SDLC orchestration plugins\",\n  \"version\": \"1.0.0\",\n  \"owner\": {\n    \"name\": \"Hendrik Geldenhuys\",\n    \"url\": \"https://github.com/hgeldenhuys\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"claude-agent-lifecycle\",\n      \"description\": \"Persistent agent lifecycle management with 6 lifespans (ephemeral, turn, context, session, workflow, project)\",\n      \"version\": \"1.0.0\",\n      \"source\": \"./\",\n      \"keywords\": [\"agent-lifecycle\", \"persistent-agents\", \"workflow\", \"hooks\"]\n    },\n    {\n      \"name\": \"claude-weave\",\n      \"description\": \"11-dimensional knowledge framework with Shadow Advisor, Librarian, and Bayesian fact tracking\",\n      \"version\": \"2.1.0\",\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"hgeldenhuys/claude-weave\"\n      },\n      \"keywords\": [\"knowledge-management\", \"institutional-memory\", \"shadow-advisor\"]\n    },\n    {\n      \"name\": \"claude-loom\",\n      \"description\": \"Autonomous SDLC orchestration with workflow-scoped story execution agents\",\n      \"version\": \"2.0.0\",\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"hgeldenhuys/claude-loom\"\n      },\n      \"keywords\": [\"sdlc\", \"orchestration\", \"workflow\", \"story-execution\"]\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"claude-agent-lifecycle\",\n  \"description\": \"Persistent agent lifecycle management for Claude Code. Provides 6 agent lifespans (ephemeral, turn, context, session, workflow, project) with automatic disposal via hooks.\",\n  \"version\": \"1.0.0\",\n  \"author\": {\n    \"name\": \"Hendrik Geldenhuys\",\n    \"url\": \"https://github.com/hgeldenhuys\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/hgeldenhuys/claude-agent-lifecycle\"\n  },\n  \"license\": \"MIT\",\n  \"keywords\": [\n    \"agent-lifecycle\",\n    \"persistent-agents\",\n    \"workflow\",\n    \"session-management\",\n    \"hooks\"\n  ],\n  \"hooks\": {\n    \"Stop\": \"hooks/lifecycle-manager.ts\",\n    \"SessionEnd\": \"hooks/lifecycle-manager.ts\"\n  },\n  \"skills\": \".claude/skills/\"\n}\n",
        "README.md": "# Claude Agent Lifecycle\n\nPersistent agent lifecycle management for Claude Code. Create, resume, and dispose agents with automatic lifecycle management based on scope boundaries.\n\n## Features\n\n- **Six Agent Lifespans**: ephemeral, turn, context, session, workflow, project\n- **Automatic Disposal**: Hooks dispose agents at appropriate lifecycle events\n- **Persistent Storage**: File-based storage for session/workflow/project agents\n- **Memory Storage**: In-memory storage for ephemeral/turn/context agents\n- **Debug Mode**: Opt-in JSON logging for debugging and monitoring\n- **Hook Integration**: Uses `claude-hooks-sdk` for lifecycle event handling\n- **Claude Code Plugin**: Install via plugin marketplace with automatic hook wiring\n\n## Installation\n\n### As Claude Code Plugin (Recommended)\n\n```bash\n# Add the marketplace\n/plugin marketplace add hgeldenhuys/claude-agent-lifecycle\n\n# Install the plugin (hooks auto-wired)\n/plugin install claude-agent-lifecycle\n```\n\n### As npm Package\n\n```bash\n# Install the package\nbun add claude-agent-lifecycle\n\n# Run the installer to set up hooks\nbun scripts/install.ts\n```\n\n### Related Plugins\n\nThis plugin is the base for:\n- **[claude-weave](https://github.com/hgeldenhuys/claude-weave)** - 11D knowledge framework with Shadow Advisor\n- **[claude-loom](https://github.com/hgeldenhuys/claude-loom)** - SDLC orchestration with workflow agents\n\nInstall the full stack:\n```bash\n/plugin install claude-loom  # Installs all dependencies\n```\n\n## Quick Start\n\n```typescript\nimport { AgentRegistry } from '@anthropic/claude-agent-lifecycle';\n\nconst registry = new AgentRegistry();\n\n// Create a session-scoped agent\nconst { agent, isNew } = await registry.create({\n  lifespan: 'session',\n  name: 'shadow-advisor',\n  model: 'haiku',\n});\n\n// Resume later in the session\nconst shadow = await registry.resume('shadow-advisor');\n\n// Start a workflow-scoped agent\nconst executor = await registry.startWorkflow({\n  lifespan: 'workflow',\n  workflowId: 'FEAT-001',\n  name: 'story-executor',\n  model: 'sonnet',\n});\n\n// Complete workflow (disposes all workflow agents)\nawait registry.completeWorkflow('FEAT-001');\n```\n\n## Agent Lifespans\n\n| Lifespan | Scope | Auto-Disposal | Storage |\n|----------|-------|---------------|---------|\n| `ephemeral` | Single use | Immediately | Memory |\n| `turn` | Response cycle | Stop event | Memory |\n| `context` | Until compaction | Context reset | Memory |\n| `session` | Claude session | SessionEnd event | File |\n| `workflow` | Bounded work unit | Manual/complete | File |\n| `project` | Indefinite | Manual only | File |\n\n### Lifespan Details\n\n**ephemeral**: Fire-and-forget agents. Created, used once, and discarded.\n\n**turn**: Lives for one request-response cycle. Disposed when the assistant's response completes (Stop event).\n\n**context**: Lives until context window compaction. Useful for agents that should survive multiple turns but reset when context is cleared.\n\n**session**: Lives for the entire Claude Code session. Disposed when the session ends (SessionEnd event).\n\n**workflow**: Lives for a bounded unit of work (story, feature, task). Explicitly completed when work is done. Generic pattern - Loom uses this for stories.\n\n**project**: Lives indefinitely in the project. Must be manually disposed. Useful for singleton agents like Shadow Advisor.\n\n## API Reference\n\n### AgentRegistry\n\n```typescript\nconst registry = new AgentRegistry(options?: RegistryOptions);\n\ninterface RegistryOptions {\n  storagePath?: string;  // Default: '.agent/agents'\n  debug?: boolean;       // Enable debug logging\n}\n```\n\n#### Methods\n\n**create(config)**: Create or resume an agent\n```typescript\nconst { agent, isNew } = await registry.create({\n  lifespan: 'session',\n  name: 'my-agent',\n  sessionId: 'optional-session-id',\n  model: 'haiku', // optional\n  metadata: {},   // optional\n});\n```\n\n**resume(name, scope?)**: Resume an existing agent by name\n```typescript\nconst agent = await registry.resume('my-agent');\n```\n\n**dispose(agentId)**: Dispose a specific agent\n```typescript\nawait registry.dispose(agent.agentId);\n```\n\n**disposeByLifespan(lifespan)**: Dispose all agents of a lifespan type\n```typescript\nconst count = await registry.disposeByLifespan('turn');\n```\n\n**disposeByScope(scope)**: Dispose all agents in a scope\n```typescript\nconst count = await registry.disposeByScope('session-123');\n```\n\n**list(filter?)**: List agents matching a filter\n```typescript\nconst agents = await registry.list({ lifespan: 'session' });\n```\n\n### Workflow Methods\n\n**startWorkflow(config)**: Start a workflow-scoped agent\n```typescript\nconst agent = await registry.startWorkflow({\n  lifespan: 'workflow',\n  workflowId: 'FEAT-001',\n  name: 'executor',\n  workflowType: 'loom-story', // optional\n});\n```\n\n**completeWorkflow(workflowId)**: Complete a workflow and dispose its agents\n```typescript\nconst disposed = await registry.completeWorkflow('FEAT-001');\n```\n\n**getWorkflowAgents(workflowId)**: Get all agents for a workflow\n```typescript\nconst agents = await registry.getWorkflowAgents('FEAT-001');\n```\n\n## Hook Configuration\n\nHooks are automatically installed by the installer. They can also be manually configured:\n\n### Default Mode (Silent)\n\n```json\n{\n  \"hooks\": {\n    \"Stop\": [{\n      \"matcher\": \"*\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.agent/hooks/lifecycle-manager.ts\"\n      }]\n    }],\n    \"SessionEnd\": [{\n      \"matcher\": \"*\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.agent/hooks/lifecycle-manager.ts\"\n      }]\n    }]\n  }\n}\n```\n\n### Debug Mode\n\nEnable debug logging for troubleshooting:\n\n**Option 1: Environment Variable**\n```bash\nexport AGENT_LIFECYCLE_DEBUG=true\n```\n\n**Option 2: Command Flag**\n```json\n{\n  \"hooks\": {\n    \"Stop\": [{\n      \"matcher\": \"*\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.agent/hooks/lifecycle-manager.ts --debug\"\n      }]\n    }]\n  }\n}\n```\n\n**Option 3: Per-Session**\n```bash\nAGENT_LIFECYCLE_DEBUG=true claude\n```\n\n### Debug Log Output\n\nWhen debug mode is enabled:\n\n**Console Output:**\n```\n[agent-lifecycle] SessionStart: abc-123 (source: new)\n[agent-lifecycle] Active agents: shadow-advisor(session), helper(turn)\n[agent-lifecycle] Stop: Disposed 1 turn-scoped agents\n[agent-lifecycle] SessionEnd: Disposed 2 agents for session abc-123\n```\n\n**File Output (JSON Lines):**\n```json\n{\"event\":\"agent:created\",\"timestamp\":\"2025-01-01T00:00:00Z\",\"agentId\":\"uuid\",\"agentName\":\"shadow\",\"lifespan\":\"session\",\"scope\":\"abc-123\"}\n{\"event\":\"agent:disposed\",\"timestamp\":\"2025-01-01T00:05:00Z\",\"agentId\":\"uuid\",\"agentName\":\"shadow\",\"lifespan\":\"session\",\"scope\":\"abc-123\"}\n```\n\nLog file location: `.agent/agents/lifecycle.log`\n\n## Storage Structure\n\n```\n.agent/\n├── agents/\n│   ├── lifecycle.log      # Debug logs (when enabled)\n│   ├── session/\n│   │   └── {session-id}/\n│   │       └── {agent-name}.json\n│   ├── workflow/\n│   │   └── {workflow-id}/\n│   │       └── {agent-name}.json\n│   └── project/\n│       └── {agent-name}.json\n└── hooks/\n    └── lifecycle-manager.ts\n```\n\n## Integration Examples\n\n### Shadow Advisor Pattern\n\n```typescript\nimport { AgentRegistry } from '@anthropic/claude-agent-lifecycle';\n\nconst registry = new AgentRegistry();\n\n// Create or resume shadow advisor for the session\nconst { agent: shadow, isNew } = await registry.create({\n  lifespan: 'session',\n  name: 'shadow-advisor',\n  model: 'haiku',\n  metadata: {\n    role: 'knowledge-retrieval',\n    preloadedKnowledge: ['weave', 'librarian'],\n  },\n});\n\nif (isNew) {\n  console.log('Created new shadow advisor');\n} else {\n  console.log(`Resumed shadow advisor (turn ${shadow.turnCount})`);\n}\n```\n\n### Loom Workflow Integration\n\n```typescript\nimport { AgentRegistry } from '@anthropic/claude-agent-lifecycle';\n\nconst registry = new AgentRegistry();\n\n// Start story execution\nconst executor = await registry.startWorkflow({\n  lifespan: 'workflow',\n  workflowId: 'ACCT-001',\n  name: 'story-executor',\n  workflowType: 'loom-story',\n  model: 'sonnet',\n});\n\n// Additional helpers for the workflow\nawait registry.startWorkflow({\n  lifespan: 'workflow',\n  workflowId: 'ACCT-001',\n  name: 'backend-dev',\n  model: 'sonnet',\n});\n\n// When story is complete\nawait registry.completeWorkflow('ACCT-001');\n// All workflow agents disposed\n```\n\n### Custom Cleanup\n\n```typescript\nimport { AgentRegistry } from '@anthropic/claude-agent-lifecycle';\n\nconst registry = new AgentRegistry();\n\n// Dispose all agents for a custom scope\nawait registry.disposeByScope('my-custom-scope');\n\n// Dispose specific lifespan\nawait registry.disposeByLifespan('context');\n```\n\n## Development\n\n```bash\n# Install dependencies\nbun install\n\n# Run tests\nbun test\n\n# Run unit tests only\nbun test tests/unit/\n\n# Run integration tests only\nbun test tests/integration/\n```\n\n## License\n\nMIT\n"
      },
      "plugins": [
        {
          "name": "claude-agent-lifecycle",
          "description": "Persistent agent lifecycle management with 6 lifespans (ephemeral, turn, context, session, workflow, project)",
          "version": "1.0.0",
          "source": "./",
          "keywords": [
            "agent-lifecycle",
            "persistent-agents",
            "workflow",
            "hooks"
          ],
          "categories": [
            "agent-lifecycle",
            "hooks",
            "persistent-agents",
            "workflow"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-agent-lifecycle",
            "/plugin install claude-agent-lifecycle@claude-skills-marketplace"
          ]
        },
        {
          "name": "claude-weave",
          "description": "11-dimensional knowledge framework with Shadow Advisor, Librarian, and Bayesian fact tracking",
          "version": "2.1.0",
          "source": {
            "source": "github",
            "repo": "hgeldenhuys/claude-weave"
          },
          "keywords": [
            "knowledge-management",
            "institutional-memory",
            "shadow-advisor"
          ],
          "categories": [
            "institutional-memory",
            "knowledge-management",
            "shadow-advisor"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-agent-lifecycle",
            "/plugin install claude-weave@claude-skills-marketplace"
          ]
        },
        {
          "name": "claude-loom",
          "description": "Autonomous SDLC orchestration with workflow-scoped story execution agents",
          "version": "2.0.0",
          "source": {
            "source": "github",
            "repo": "hgeldenhuys/claude-loom"
          },
          "keywords": [
            "sdlc",
            "orchestration",
            "workflow",
            "story-execution"
          ],
          "categories": [
            "orchestration",
            "sdlc",
            "story-execution",
            "workflow"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-agent-lifecycle",
            "/plugin install claude-loom@claude-skills-marketplace"
          ]
        }
      ]
    }
  ]
}