{
  "author": {
    "id": "hgeldenhuys",
    "display_name": "hgeldenhuys",
    "avatar_url": "https://avatars.githubusercontent.com/u/179999?u=989a39fc64e9eb433a91c144702942251a989d7f&v=4"
  },
  "marketplaces": [
    {
      "name": "claude-hooks-sdk",
      "version": null,
      "description": "Production-ready plugins for Claude Code hook extensions with analytics, monitoring, debugging, and skills",
      "repo_full_name": "hgeldenhuys/claude-hooks-sdk",
      "repo_url": "https://github.com/hgeldenhuys/claude-hooks-sdk",
      "repo_description": "Type-safe TypeScript SDK for building Claude Code hook extensions",
      "signals": {
        "stars": 3,
        "forks": 0,
        "pushed_at": "2025-12-15T05:35:17Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"claude-hooks-sdk\",\n  \"owner\": {\n    \"name\": \"Herman Geldenhuys\",\n    \"email\": \"hgeldenhuys@gmail.com\"\n  },\n  \"description\": \"Production-ready plugins for Claude Code hook extensions with analytics, monitoring, debugging, and skills\",\n  \"homepage\": \"https://github.com/hgeldenhuys/claude-hooks-sdk\",\n  \"plugins\": [\n    {\n      \"name\": \"skill-claude-code-hooks\",\n      \"source\": \"./.claude-plugin/plugins/skill-claude-code-hooks\",\n      \"version\": \"0.8.6\",\n      \"description\": \"Skill: Guide for implementing Claude Code hooks - bash scripts and TypeScript patterns for all 9 hook events.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"skill\", \"hooks\", \"guide\", \"bash\", \"typescript\", \"documentation\"]\n    },\n    {\n      \"name\": \"skill-claude-hooks-sdk\",\n      \"source\": \"./.claude-plugin/plugins/skill-claude-hooks-sdk\",\n      \"version\": \"0.8.6\",\n      \"description\": \"Skill: Expert guide for using claude-hooks-sdk with HookManager, Logger, transforms, and advanced patterns.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"skill\", \"sdk\", \"typescript\", \"hookmanager\", \"transforms\", \"logger\"]\n    },\n    {\n      \"name\": \"analytics-tracker\",\n      \"source\": \"./.claude-plugin/plugins/analytics-tracker\",\n      \"version\": \"0.7.1\",\n      \"description\": \"Automatic session cost tracking, token usage monitoring, and performance metrics. Track every dollar and token spent across all sessions.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"analytics\", \"cost-tracking\", \"tokens\", \"metrics\", \"performance\"]\n    },\n    {\n      \"name\": \"conversation-logger\",\n      \"source\": \"./.claude-plugin/plugins/conversation-logger\",\n      \"version\": \"0.7.1\",\n      \"description\": \"Unified conversation logging across all sessions with color-coded output. Perfect for multi-agent development and debugging.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"conversation\", \"logging\", \"multi-agent\", \"debugging\", \"color-coded\"]\n    },\n    {\n      \"name\": \"anomaly-monitor\",\n      \"source\": \"./.claude-plugin/plugins/anomaly-monitor\",\n      \"version\": \"0.7.1\",\n      \"description\": \"Real-time anomaly detection with Slack/webhook alerts. Detect error spikes, token anomalies, and response time issues automatically.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"anomaly-detection\", \"alerts\", \"monitoring\", \"slack\", \"webhooks\"]\n    },\n    {\n      \"name\": \"event-recorder\",\n      \"source\": \"./.claude-plugin/plugins/event-recorder\",\n      \"version\": \"0.7.1\",\n      \"description\": \"Record all hook events to JSONL files for debugging, testing, and replay. Perfect for creating test fixtures from real sessions.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"recording\", \"debugging\", \"testing\", \"replay\", \"jsonl\"]\n    },\n    {\n      \"name\": \"performance-monitor\",\n      \"source\": \"./.claude-plugin/plugins/performance-monitor\",\n      \"version\": \"0.7.1\",\n      \"description\": \"Track response times, SLA compliance, and tool performance. Monitor p95/p99 metrics and get alerted when SLAs are breached.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"performance\", \"sla\", \"response-time\", \"monitoring\", \"metrics\"]\n    },\n    {\n      \"name\": \"file-auditor\",\n      \"source\": \"./.claude-plugin/plugins/file-auditor\",\n      \"version\": \"0.7.1\",\n      \"description\": \"Comprehensive file change tracking with audit trails. Track every Write, Edit, and MultiEdit operation with timestamps and session IDs.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"file-tracking\", \"audit\", \"compliance\", \"git\", \"changes\"]\n    },\n    {\n      \"name\": \"real-time-dashboard\",\n      \"source\": \"./.claude-plugin/plugins/real-time-dashboard\",\n      \"version\": \"0.7.1\",\n      \"description\": \"Stream events to a live web dashboard via SSE. Monitor Claude Code sessions in real-time with a beautiful web interface.\",\n      \"author\": {\n        \"name\": \"Herman Geldenhuys\",\n        \"email\": \"hgeldenhuys@gmail.com\"\n      },\n      \"keywords\": [\"dashboard\", \"real-time\", \"sse\", \"streaming\", \"monitoring\"]\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"claude-hooks-sdk-examples\",\n  \"version\": \"0.8.5\",\n  \"description\": \"Production-ready Claude Code hook examples built with claude-hooks-sdk. Includes event logging, edit tracking, failure queue, and context correlation.\",\n  \"author\": {\n    \"name\": \"Herman Geldenhuys\",\n    \"email\": \"hgeldenhuys@gmail.com\",\n    \"url\": \"https://github.com/hgeldenhuys\"\n  },\n  \"homepage\": \"https://github.com/hgeldenhuys/claude-hooks-sdk\",\n  \"repository\": \"https://github.com/hgeldenhuys/claude-hooks-sdk\",\n  \"license\": \"MIT\",\n  \"keywords\": [\n    \"claude-code\",\n    \"hooks\",\n    \"examples\",\n    \"event-logging\",\n    \"edit-tracking\",\n    \"observability\"\n  ],\n  \"hooks\": \"./hooks.json\",\n  \"skills\": [\n    {\n      \"name\": \"claude-code-hooks\",\n      \"path\": \"../.claude/skills/claude-code-hooks.md\",\n      \"description\": \"Generic guide for implementing Claude Code hooks - bash scripts and TypeScript patterns for all 9 hook events.\"\n    },\n    {\n      \"name\": \"claude-hooks-sdk\",\n      \"path\": \"../.claude/skills/claude-hooks-sdk.md\",\n      \"description\": \"Expert guide for building Claude Code hooks with the SDK. Covers HookManager, Logger, transforms, and advanced patterns.\"\n    }\n  ]\n}\n",
        "README.md": "# claude-hooks-sdk\n\n> Type-safe TypeScript SDK for building Claude Code hook extensions\n\n[![npm version](https://badge.fury.io/js/claude-hooks-sdk.svg)](https://www.npmjs.com/package/claude-hooks-sdk)\n[![TypeScript](https://img.shields.io/badge/TypeScript-5.6-blue.svg)](https://www.typescriptlang.org/)\n[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)\n\n## Features\n\n### Core Features\n- ‚≠ê **Session Context Injection** - ONE-LINE helper to inject session info into Claude's context (saves 50-100+ tokens/request)\n- ‚úÖ **Full Type Safety** - Complete TypeScript types for all 10 Claude Code hook events\n- ‚úÖ **Fluent API** - Intuitive `manager.onPreToolUse(...)` handler registration\n- ‚úÖ **Non-Blocking by Default** - Hook failures don't block Claude Code (opt-in blocking available)\n- ‚úÖ **Built-in Event Logging** - Enable with one flag, organized by client ID\n- ‚úÖ **Edit Tracking** - Automatically track files modified during Claude's response\n- ‚úÖ **Context Tracking** - Automatic transaction IDs, prompt IDs, git metadata, and parent session tracking\n- ‚úÖ **Failure Queue** - Sequential event processing with automatic retry (FIFO)\n- ‚úÖ **Transcript Access** - Built-in utilities for parsing and searching conversation history\n- ‚úÖ **Plugin System** - Extensible architecture for custom integrations\n- ‚úÖ **Async/Await Support** - Full async handler support for API calls, database queries, etc.\n\n### Transform Utilities (v0.6.0)\n- üîÑ **Conversation Logging** - Track user prompts and assistant responses between Stop events\n- üìÑ **File Change Tracking** - Monitor Write/Edit/MultiEdit operations\n- ‚úÖ **Todo Progress Tracking** - Extract and monitor TodoWrite events with completion percentages\n- ü§ñ **AI Summarization** - Auto-summarize Stop events using Claude Haiku API\n\n### Advanced Features (v0.7.0)\n- üíæ **Persistent State** - Durable SQLite/file/memory storage for state that survives restarts\n- üìä **Session Analytics** - Automatic cost tracking, performance metrics, token usage analysis\n- üé¨ **Event Recording & Replay** - Record sessions to JSONL and replay for testing\n- üì° **Real-time Streaming** - SSE-based event streaming to dashboards and monitoring tools\n- üîå **Middleware System** - Composable middleware with rate limiting, deduplication, PII redaction\n- üö® **Anomaly Detection** - Detect unusual patterns (error spikes, token anomalies, response time issues)\n\n## Table of Contents\n\n- [Installation](#installation)\n- [Quick Start](#quick-start)\n- [Built-in Event Logging](#built-in-event-logging)\n- [Edit Tracking](#edit-tracking)\n- [Context Tracking](#context-tracking-event-correlation)\n- [Non-Blocking Error Handling](#non-blocking-error-handling)\n- [Failure Queue](#failure-queue)\n- [API Reference](#api-reference)\n- [Documentation](#documentation)\n- [Examples](#examples)\n- [Contributing](#contributing)\n\n## Installation\n\n### Method 1: npm Package (For Developers)\n\nInstall the SDK to build custom hooks:\n\n```bash\nnpm install claude-hooks-sdk\n# or\nbun add claude-hooks-sdk\n```\n\n### Method 2: Claude Code Plugin (For Ready-to-Use Examples + Expert Skill)\n\nInstall pre-built example hooks and comprehensive SDK skill via the Claude Code marketplace:\n\n```bash\n# Add the marketplace\n/plugin marketplace add hgeldenhuys/claude-hooks-sdk\n\n# Install the plugin (includes examples + skill)\n/plugin install claude-hooks-sdk-examples\n```\n\n**What you get:**\n\nüìö **Expert Skill** - Makes Claude Code self-aware of the SDK:\n```bash\n/skill claude-hooks-sdk\n# Now Claude can answer: \"How do I enable edit tracking?\"\n# \"Show me a blocking hook example\", etc.\n```\n\nüîå **Production-Ready Hooks:**\n- **event-logger** - Full-featured event logging with edit tracking\n- **failure-queue-demo** - Automatic retry queue demonstration\n- **edit-tracking** - Track files modified by Claude\n- **non-blocking** - Non-blocking error handling example\n\n## ‚≠ê Quick Start: Session Context Injection (Recommended)\n\n**The #1 most valuable hook pattern** - automatically inject session info into Claude's context on every prompt, saving 50-100+ tokens per request.\n\nCreate `.claude/hooks/UserPromptSubmit.ts`:\n\n```typescript\n#!/usr/bin/env bun\nimport { createUserPromptSubmitHook } from 'claude-hooks-sdk';\n\n// That's it! Session context automatically available to Claude\ncreateUserPromptSubmitHook();\n```\n\nRegister in `.claude/settings.json`:\n\n```json\n{\n  \"hooks\": {\n    \"UserPromptSubmit\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/UserPromptSubmit.ts\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n**What this does:**\n- ‚úÖ Injects session ID and name into Claude's context automatically\n- ‚úÖ Saves 50-100+ tokens per request (no tool calls needed)\n- ‚úÖ Zero latency - session info instantly available\n- ‚úÖ Enables session-aware workflows, logging, and file management\n\n**Why this matters:** Claude doesn't know its own session ID by default. Without this hook, it has to use tools to read `.claude/sessions.json` on every request where it needs session info. This hook makes it available instantly.\n\n<details>\n<summary>Advanced customization</summary>\n\n```typescript\ncreateUserPromptSubmitHook({\n  // Custom session format\n  format: (name, id) => `üîµ Session: ${name} [${id.slice(0, 8)}]`,\n\n  // Add additional context\n  customContext: async (input) => {\n    const branch = execSync('git branch --show-current').toString().trim();\n    return `Git branch: ${branch}`;\n  },\n\n  // Custom error handling\n  onError: (err) => console.error('[Hook Error]', err)\n});\n```\n</details>\n\n---\n\n## Quick Start: General Hook Development\n\nCreate a hook file (e.g., `.claude/hooks/my-hook.ts`):\n\n```typescript\n#!/usr/bin/env bun\nimport { HookManager, success, block } from 'claude-hooks-sdk';\n\nconst manager = new HookManager({\n  logEvents: true,          // Enable automatic event logging\n  clientId: 'my-hook',      // Organize logs by client\n});\n\n// Block dangerous bash commands\nmanager.onPreToolUse(async (input) => {\n  if (input.tool_name === 'Bash' && input.tool_input.command.includes('rm -rf /')) {\n    return block('Dangerous command detected!');\n  }\n  return success();\n});\n\n// Log session starts (with auto-generated session name)\nmanager.onSessionStart(async (input) => {\n  console.log(`Session started: ${input.session_name} (${input.session_id})`);\n  // Example output: \"Session started: brave-elephant (af13b3cd-5185-...)\"\n  return success();\n});\n\nmanager.run();\n```\n\n**That's it!** Events are automatically logged to `.claude/hooks/my-hook/logs/events.jsonl`\n\nRegister the hook in `.claude/settings.json`:\n\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"$CLAUDE_PROJECT_DIR/.claude/hooks/my-hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"SessionStart\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"$CLAUDE_PROJECT_DIR/.claude/hooks/my-hook.ts\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## Transform Utilities\n\n**NEW**: Convenient transform utilities for common hook patterns.\n\nThe SDK now includes powerful transform utilities that make it easy to implement common logging and analytics patterns. These are production-ready and can be used in backend services.\n\n### Available Transforms\n\n1. **ConversationLogger** - Track conversation turns with user prompts and assistant responses\n2. **FileChangeTracker** - Monitor file modifications from Write/Edit/MultiEdit tools\n3. **TodoTracker** - Track todo items and progress\n4. **AISummarizer** - Auto-summarize Stop events using Claude Haiku\n\n### Quick Start with Transforms\n\n```typescript\nimport {\n  HookManager,\n  success,\n  ConversationLogger,\n  FileChangeTracker,\n  TodoTracker,\n} from 'claude-hooks-sdk';\n\nconst conversationLogger = new ConversationLogger();\nconst fileTracker = new FileChangeTracker();\nconst todoTracker = new TodoTracker();\n\nconst manager = new HookManager();\n\nmanager\n  .onUserPromptSubmit((input) => {\n    conversationLogger.recordUserPrompt(input);\n    return success();\n  })\n  .onPreToolUse((input) => {\n    conversationLogger.recordToolUse(input.tool_name);\n    return success();\n  })\n  .onPostToolUse((input) => {\n    fileTracker.recordChange(input);\n    todoTracker.recordTodoWrite(input);\n    return success();\n  })\n  .onStop(async (input, context) => {\n    // Get all transform data\n    const turn = await conversationLogger.recordStop(input, context);\n    const files = fileTracker.getBatch(input.session_id);\n    const todos = todoTracker.getSnapshot(input.session_id);\n\n    console.log('Conversation Turn:', turn.turn_number);\n    console.log('Files Modified:', files.total_files);\n    console.log('Todo Progress:', todoTracker.getCompletionPercentage(input.session_id) + '%');\n\n    return success();\n  });\n\nmanager.run();\n```\n\n### Example Output\n\n**Conversation Turn:**\n```json\n{\n  \"assistant\": {\n    \"content\": \"I'll help you implement that feature...\",\n    \"timestamp\": \"2025-11-21T23:00:00.000Z\",\n    \"toolsUsed\": [\"Read\", \"Edit\", \"TodoWrite\"]\n  },\n  \"user_prompts\": [\n    { \"text\": \"Can you add error handling?\", \"timestamp\": \"...\" }\n  ],\n  \"turn_number\": 5,\n  \"session_id\": \"abc123\"\n}\n```\n\n**File Changes:**\n```json\n{\n  \"file\": \"src/utils/api.ts\",\n  \"operation\": \"modified\",\n  \"tool\": \"Edit\",\n  \"timestamp\": \"2025-11-21T23:00:00.000Z\",\n  \"session_id\": \"abc123\",\n  \"size_hint\": 1234\n}\n```\n\n**Todo Progress:**\n```json\n{\n  \"event_type\": \"todos_updated\",\n  \"todos\": [...],\n  \"completed\": 3,\n  \"in_progress\": 1,\n  \"pending\": 2,\n  \"timestamp\": \"2025-11-21T23:00:00.000Z\"\n}\n```\n\n**AI Summary (requires ANTHROPIC_API_KEY):**\n```json\n{\n  \"summary\": \"Added error handling to API utility functions\",\n  \"model\": \"claude-haiku-3-5-20241022\",\n  \"input_tokens\": 125,\n  \"output_tokens\": 12,\n  \"timestamp\": \"2025-11-21T23:00:00.000Z\"\n}\n```\n\n### Complete Examples\n\nSee [`examples/transforms/`](./examples/transforms/) for complete working examples:\n\n- **conversation-logger.ts** - Chat-style logging\n- **file-changes-logger.ts** - File modification tracking\n- **todo-logger.ts** - Todo progress monitoring\n- **ai-summarizer.ts** - Automatic Stop event summaries\n- **all-transforms.ts** - All transforms combined\n\n### Transform API Reference\n\n#### ConversationLogger\n\n```typescript\nconst logger = new ConversationLogger();\n\n// Record events\nlogger.recordUserPrompt(input);\nlogger.recordToolUse(toolName);\nconst turn = await logger.recordStop(input, context);\n\n// Utilities\nlogger.getTurnNumber(); // Current turn number\nlogger.reset(); // Reset state\n```\n\n#### FileChangeTracker\n\n```typescript\nconst tracker = new FileChangeTracker();\n\n// Record changes\nconst change = tracker.recordChange(input);\n\n// Get data\nconst batch = tracker.getBatch(sessionId);\nconst files = tracker.getUniqueFiles(sessionId);\nconst count = tracker.getFileModificationCount(sessionId, filePath);\n\n// Cleanup\ntracker.clearSession(sessionId);\n```\n\n#### TodoTracker\n\n```typescript\nconst tracker = new TodoTracker();\n\n// Record todos\nconst event = tracker.recordTodoWrite(input);\n\n// Get data\nconst snapshot = tracker.getSnapshot(sessionId);\nconst inProgress = tracker.getTodosByStatus(sessionId, 'in_progress');\nconst pct = tracker.getCompletionPercentage(sessionId);\n\n// Cleanup\ntracker.clearSession(sessionId);\n```\n\n#### AISummarizer\n\n```typescript\nconst summarizer = new AISummarizer({\n  apiKey: process.env.ANTHROPIC_API_KEY!,\n  model: 'claude-haiku-3-5-20241022',\n});\n\n// Generate summaries\nconst summary = await summarizer.summarizeStop(input, context);\n\n// Custom prompts\nconst custom = await summarizer.summarizeWithPrompt(\n  content,\n  'Summarize: {content}',\n  sessionId\n);\n\n// Utilities\nsummarizer.getTurnNumber(); // Current turn\nsummarizer.reset(); // Reset counter\n```\n\n### Production Usage\n\n```typescript\nmanager.onStop(async (input, context) => {\n  const turn = await conversationLogger.recordStop(input, context);\n  const files = fileTracker.getBatch(input.session_id);\n  const todos = todoTracker.getSnapshot(input.session_id);\n\n  // Send to your analytics backend\n  await fetch('https://api.example.com/sessions/events', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      type: 'stop',\n      conversation: turn,\n      files,\n      todos,\n      timestamp: new Date().toISOString(),\n    }),\n  });\n\n  return success();\n});\n```\n\n## Built-in Event Logging\n\nThe SDK includes automatic event logging - just enable it with a flag!\n\n```typescript\nconst manager = new HookManager({\n  logEvents: true,              // Enable logging\n  clientId: 'my-extension',     // Organize by client\n  // logDir: '/custom/path',    // Optional: custom directory\n});\n```\n\n**Logs are saved to:** `$CLAUDE_PROJECT_DIR/.claude/hooks/{clientId}/logs/events.jsonl`\n(Falls back to current directory if `CLAUDE_PROJECT_DIR` not set)\n\n**Each log entry contains:**\n```json\n{\n  \"input\": {\n    \"hook\": {                    // Full hook event\n      \"hook_event_name\": \"PreToolUse\",\n      \"session_id\": \"...\",\n      \"tool_name\": \"Read\",\n      \"tool_input\": {...}\n    },\n    \"conversation\": {            // Last transcript line\n      \"type\": \"user\",\n      \"message\": {...}\n    },\n    \"context\": {                 // Event correlation context\n      \"transactionId\": \"tx_...\",\n      \"conversationId\": \"...\",\n      \"project_dir\": \"/path/to/project\",\n      \"promptId\": \"prompt_...\",\n      \"git\": {...}\n    },\n    \"timestamp\": \"2025-11-21T...\"\n  },\n  \"output\": {                    // What your handler returned\n    \"exitCode\": 0,\n    \"success\": true,\n    \"hasOutput\": false,\n    \"hasStdout\": false,\n    \"hasStderr\": false\n  }\n}\n```\n\n**View logs:**\n```bash\n# From project root (uses CLAUDE_PROJECT_DIR)\ntail -f .claude/hooks/my-extension/logs/events.jsonl | jq .\n\n# All events\ncat .claude/hooks/my-extension/logs/events.jsonl | jq .\n\n# Filter by event type\ncat .claude/hooks/my-extension/logs/events.jsonl | jq 'select(.input.hook.hook_event_name == \"PreToolUse\")'\n\n# View just context\ntail -f .claude/hooks/my-extension/logs/events.jsonl | jq '.input.context'\n\n# View event summary\ncat .claude/hooks/my-extension/logs/events.jsonl | jq -c '{event: .input.hook.hook_event_name, tool: .input.hook.tool_name, tx: .input.context.transactionId}'\n```\n\n---\n\n## Edit Tracking\n\n**Track all files modified during Claude's response!**\n\nEnable with one flag to automatically collect all files edited via the Edit tool:\n\n```typescript\nconst manager = new HookManager({\n  trackEdits: true,  // ‚Üê Enable edit tracking\n  logEvents: true\n});\n\nmanager.onStop(async (input) => {\n  const editedFiles = (input as any).context?.editedFiles;\n\n  if (editedFiles) {\n    console.log(`Files edited: ${editedFiles.length}`);\n    editedFiles.forEach(file => console.log(`  - ${file}`));\n\n    // Auto-commit changed files\n    execSync(`git add ${editedFiles.join(' ')}`);\n    execSync(`git commit -m \"Claude edits\"`);\n  }\n\n  return success();\n});\n```\n\n**Result in Stop event:**\n```json\n{\n  \"context\": {\n    \"transactionId\": \"tx_...\",\n    \"editedFiles\": [\n      \"/project/src/app.ts\",\n      \"/project/src/utils.ts\"\n    ]\n  }\n}\n```\n\n**Use cases:**\n- Auto-commit changed files\n- Run tests on modified files only\n- Slack notifications for large changesets\n- Code review workflows\n- Lint only changed files\n\nSee [docs/guides/EDIT-TRACKING.md](./docs/guides/EDIT-TRACKING.md) for complete documentation.\n\n---\n\n## Context Tracking (Event Correlation)\n\n**Enabled by default** - All events are automatically enriched with correlation context!\n\n### What's Tracked\n\nEvery hook event gets enriched with:\n\n```typescript\n{\n  hook_event_name: \"PreToolUse\",\n  // ... normal event fields ...\n  context: {\n    transactionId: \"tx_1234567890_abc123def\",  // Persists across session\n    conversationId: \"session-uuid\",             // Session identifier\n    promptId: \"prompt_1234567890\",              // Last prompt ID\n    project_dir: \"/path/to/project\",            // CLAUDE_PROJECT_DIR environment variable\n    git: {                                      // Git repository metadata\n      user: \"John Doe\",\n      email: \"john@example.com\",\n      repo: \"https://github.com/user/repo.git\",\n      branch: \"main\",\n      commit: \"abc1234...\",\n      dirty: false                              // Has uncommitted changes?\n    }\n  }\n}\n```\n\n### Transaction ID Lifecycle\n\n```\nSessionStart  ‚Üí Generate new transaction ID\n                ‚Üì\nAll Events    ‚Üí Same transaction ID (correlation!)\n                ‚Üì\nSessionEnd    ‚Üí Clear context\n```\n\n### Usage Example\n\n```typescript\nconst manager = new HookManager({\n  enableContextTracking: true,  // Default: true\n  clientId: 'my-hook',\n});\n\nmanager.onPreToolUse(async (input: any) => {\n  console.log(`Transaction: ${input.context.transactionId}`);\n  console.log(`Prompt: ${input.context.promptId}`);\n  console.log(`Git Branch: ${input.context.git?.branch}`);\n\n  // Send to analytics with correlation\n  await analytics.track({\n    event: 'tool_use',\n    transactionId: input.context.transactionId,\n    promptId: input.context.promptId,\n    tool: input.tool_name,\n  });\n\n  return success();\n});\n```\n\n### Benefits\n\n- **Event Correlation**: Link all events in a session with same transaction ID\n- **Prompt Tracking**: Know which prompt triggered which tool uses\n- **Git Context**: Track which branch/commit events occurred on\n- **Parent-Child Tracking**: Subagent events include `parentSessionId` and `agentId`\n\n---\n\n## Session Naming\n\n**Automatically assign user-friendly names to Claude Code sessions!**\n\nThe SDK now generates memorable names for all sessions (e.g., \"brave-elephant\", \"clever-dolphin\") instead of UUIDs. Session names are:\n- **Automatic** - Generated on SessionStart, no configuration needed\n- **Persistent** - Saved to `.claude/sessions.json` for resume support\n- **Bidirectional** - Lookup session ID by name or name by ID\n- **Manual** - Rename sessions via config or CLI scripts\n\n### Usage\n\n```typescript\nimport { HookManager, getSessionName, getSessionId } from 'claude-hooks-sdk';\n\nconst manager = new HookManager();\n\nmanager.onSessionStart(async (input) => {\n  // session_name is auto-populated by the SDK\n  console.log(`Session: ${input.session_name}`);\n  // Output: \"Session: brave-elephant\"\n\n  return { exitCode: 0 };\n});\n```\n\nWhen Claude Code starts, you'll see:\n```\nüìù Session: brave-elephant\n\nReady. How can I help?\n```\n\n### Resume by Name\n\n```bash\n# Find session ID by name\nbun .claude/scripts/session-lookup.ts brave-elephant\n# Output: af13b3cd-5185-42df-aa85-3bf6e52e1810\n\n# Resume using that ID\nclaude --resume $(bun .claude/scripts/session-lookup.ts brave-elephant)\n```\n\n### Rename Sessions\n\n```bash\n# Rename by current name\nbun .claude/scripts/session-rename.ts brave-elephant \"refactor-sse\"\n\n# Rename by session ID\nbun .claude/scripts/session-rename.ts af13b3cd \"bugfix-viewer\"\n```\n\n### Manual Names via Config\n\nSet custom names in `.claude-plugin/config.json`:\n\n```json\n{\n  \"session-namer\": {\n    \"manualNames\": {\n      \"af13b3cd-5185-42df-aa85-3bf6e52e1810\": \"refactor-realtime-sse\"\n    }\n  }\n}\n```\n\n### Conversation Logger Integration\n\nThe `conversation-logger` plugin shows session names in the viewer:\n\n```\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë ü§ñ Agent Started                                     ‚ïë\n‚ïë   Session: brave-elephant (af13b3cd)                 ‚ïë\n‚ïë   Source: resume                                     ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n```\n\n### API\n\n```typescript\nimport {\n  getSessionName,\n  getSessionId,\n  renameSession,\n  listSessions,\n} from 'claude-hooks-sdk';\n\n// Lookup name by ID\nconst name = getSessionName('af13b3cd-5185-42df-aa85-3bf6e52e1810');\n// Returns: \"brave-elephant\"\n\n// Lookup ID by name\nconst id = getSessionId('brave-elephant');\n// Returns: \"af13b3cd-5185-42df-aa85-3bf6e52e1810\"\n\n// Rename a session\nrenameSession('af13b3cd-5185-42df-aa85-3bf6e52e1810', 'new-name');\n\n// List all sessions\nconst sessions = listSessions();\n// Returns: [{ sessionId: '...', info: { name: '...', created: '...', ... } }]\n```\n\n**Name format:** `adjective-animal` (e.g., \"brave-elephant\", \"clever-dolphin\")\n- Uses `unique-names-generator` library\n- Collision handling with `-2`, `-3` suffixes\n- Stored in `.claude/sessions.json`\n\n---\n\n## Non-Blocking Error Handling\n\n**By default, hook failures DON'T block Claude Code!**\n\nThis is critical for reliability - a failed API call or network timeout shouldn't freeze your session.\n\n```typescript\nconst manager = new HookManager({\n  blockOnFailure: false,  // Default: non-blocking\n  enableFailureQueue: true,\n  maxRetries: 3\n});\n\nmanager.onPreToolUse(async (input) => {\n  // If this fails, Claude Code continues normally\n  await fetch('https://analytics.com/track', {\n    method: 'POST',\n    body: JSON.stringify(input),\n    signal: AbortSignal.timeout(5000)\n  });\n\n  return success();\n});\n```\n\n**What happens when handler fails:**\n\n| Mode | Exit Code | Claude Code | Queue | User Impact |\n|------|-----------|-------------|-------|-------------|\n| **Non-Blocking** (default) | 0 (success) | Continues | Event queued for retry | None ‚úÖ |\n| **Blocking** (opt-in) | 1 (error) | Blocked | No queue | Error shown ‚ùå |\n\n**Use non-blocking for:**\n- Analytics/telemetry\n- Logging services\n- Notifications (Slack, Discord)\n- Metrics (Datadog, Prometheus)\n- Non-critical API calls\n\n**Use blocking for:**\n- Security enforcement\n- Access control\n- Critical validation\n- Compliance checks\n\nSee [docs/guides/NON-BLOCKING-HOOKS.md](./docs/guides/NON-BLOCKING-HOOKS.md) for complete documentation.\n- **Analytics Ready**: Perfect for sending to analytics platforms\n- **Debugging**: Easily trace event chains\n\n### Disabling Context Tracking\n\n```typescript\nconst manager = new HookManager({\n  enableContextTracking: false,  // Disable if not needed\n});\n```\n\n---\n\n## Failure Queue (Sequential Event Processing)\n\nThe SDK includes a built-in failure queue for resilient, sequential event processing. When enabled, failed events are automatically queued and retried, ensuring FIFO (First-In-First-Out) ordering.\n\n### Why Use the Failure Queue?\n\n- **Guaranteed Ordering**: Events are processed sequentially - if one fails, subsequent events wait\n- **Automatic Retry**: Failed events retry automatically with configurable max attempts\n- **No Lost Events**: Failures are persisted to disk and survive restarts\n- **Consumer Notifications**: Get notified when the queue has items waiting\n\n### Basic Usage\n\n```typescript\nconst manager = new HookManager({\n  enableFailureQueue: true,        // Enable the queue\n  clientId: 'my-extension',        // Required for queue organization\n  maxRetries: 3,                   // Max retry attempts (default: 3)\n\n  // Optional: get notified when queue has items\n  onErrorQueueNotEmpty: async (queueSize, failedEvents) => {\n    console.log(`‚ö†Ô∏è ${queueSize} events in error queue`);\n    // Could trigger a notification, log to monitoring, etc.\n  }\n});\n\nmanager.onPreToolUse(async (input) => {\n  // If this handler fails (returns exitCode !== 0 or throws),\n  // the event is automatically added to the error queue\n  const result = await processEvent(input);\n\n  if (!result.success) {\n    return error('Processing failed, will retry');\n  }\n\n  return success();\n});\n\nmanager.run();\n```\n\n### How It Works\n\n**Every hook event automatically drains the queue first (FIFO order):**\n\n1. **Hook Event Arrives** ‚Üí Check if queue has events\n2. **Queue Not Empty?** ‚Üí Drain queue synchronously:\n   - Call `onErrorQueueNotEmpty` callback\n   - Retry all queued events in FIFO order\n   - Successfully processed events removed from queue\n   - Still-failing events remain (retry count incremented)\n3. **Queue Still Not Empty After Drain?** ‚Üí Queue the new event, return success\n4. **Queue Empty?** ‚Üí Process the new event\n5. **New Event Fails?** ‚Üí Add to queue for next hook event\n\n### Error Queue File Format\n\nFailed events are saved to `$CLAUDE_PROJECT_DIR/.claude/hooks/{clientId}/error-queue.jsonl`:\n\n```json\n{\"event\": {...}, \"error\": \"Connection timeout\", \"timestamp\": \"2025-11-21T...\", \"retryCount\": 0}\n{\"event\": {...}, \"error\": \"API rate limit\", \"timestamp\": \"2025-11-21T...\", \"retryCount\": 1}\n```\n\n### Automatic Queue Draining\n\n**The queue is automatically drained on every hook event - no cron jobs needed!**\n\nWhen a hook event arrives:\n1. SDK checks if queue has items\n2. If yes, drain queue synchronously (retry all events in FIFO order)\n3. Successfully processed events removed\n4. Still-failing events remain (retry count incremented)\n5. If queue still has items after draining, queue the new event\n6. If queue is empty, process the new event\n\n### Queue Behavior\n\n- **FIFO Order**: Events always processed in order they failed\n- **Automatic Retry**: Every hook event triggers drain attempt\n- **Retry Limit**: After `maxRetries`, events are dropped\n- **No External Jobs**: No cron jobs or background workers needed\n\n### Optional: Manual Queue Inspection\n\nFor monitoring or debugging:\n\n```typescript\n// Check queue status (optional)\nconst status = manager.getQueueStatus();\nconsole.log(`Queue has ${status.size} events`);\n\n// Manually drain if needed (optional - normally automatic)\nconst result = await manager.drainQueue();\nconsole.log(`Processed: ${result.processed}`);\n```\n\n### Use Cases\n\n- **API Integrations**: Retry failed API calls without losing events\n- **Database Operations**: Ensure all events are persisted even during outages\n- **External Services**: Queue events when external service is down\n- **Rate Limiting**: Respect rate limits by queuing excess events\n\n**üìñ For detailed documentation, see [docs/guides/FAILURE-QUEUE.md](./docs/guides/FAILURE-QUEUE.md)**\n\n---\n\n## API Reference\n\n### HookManager\n\nThe main class for registering and executing hook handlers.\n\n```typescript\nconst manager = new HookManager(options?: HookManagerOptions);\n```\n\n**Options:**\n```typescript\ninterface HookManagerOptions {\n  debug?: boolean;          // Enable debug output\n  logEvents?: boolean;      // Enable event logging\n  clientId?: string;        // Client ID for organizing logs\n  logDir?: string;          // Custom log directory\n\n  // Failure Queue Options\n  enableFailureQueue?: boolean;  // Enable sequential event processing with retry\n  maxRetries?: number;           // Max retry attempts (default: 3)\n  onErrorQueueNotEmpty?: (       // Callback when queue has items\n    queueSize: number,\n    failedEvents: FailedEvent[]\n  ) => Promise<void> | void;\n}\n```\n\n#### Methods\n\n**Event Handlers:**\n- `onPreToolUse(handler)` - Before tool execution\n- `onPostToolUse(handler)` - After tool execution\n- `onNotification(handler)` - On Claude notifications\n- `onUserPromptSubmit(handler)` - Before processing user input\n- `onStop(handler)` - When main agent finishes\n- `onSubagentStop(handler)` - When subagent completes\n- `onPreCompact(handler)` - Before context compaction\n- `onSessionStart(handler)` - Session lifecycle start\n- `onSessionEnd(handler)` - Session lifecycle end\n\n**Execution:**\n- `run()` - Execute handlers (reads stdin, writes stdout/stderr)\n- `execute(input)` - Manually execute handlers (advanced usage)\n\n**Plugins:**\n- `use(plugin)` - Register a plugin to extend functionality\n\n**Failure Queue (Optional - queue drains automatically):**\n- `drainQueue()` - Manually drain queue (optional), returns `{ processed, remaining, dropped }`\n- `getQueueStatus()` - Inspect queue status, returns `{ size, events }`\n\n### Handler Response Helpers\n\n```typescript\nimport { success, block, error } from 'claude-hooks-sdk';\n\n// Allow execution to continue\nreturn success();\n\n// Block execution (PreToolUse only)\nreturn block('Reason for blocking');\n\n// Return error (non-blocking)\nreturn error('Error message');\n\n// Custom response\nreturn {\n  exitCode: 0,  // 0 = success, 2 = blocking error\n  stdout: 'Message to Claude',\n  output: {\n    continue: true,\n    // ... hook-specific fields\n  }\n};\n```\n\n### Hook Context\n\nEach handler receives a `context` object with transcript utilities:\n\n```typescript\nmanager.onSessionStart(async (input, context) => {\n  // Get a specific transcript line\n  const line = await context.getTranscriptLine(42);\n\n  // Get full transcript\n  const transcript = await context.getFullTranscript();\n\n  // Search transcript\n  const matches = await context.searchTranscript(line =>\n    line.content?.role === 'user'\n  );\n\n  return success();\n});\n```\n\n### Plugin System\n\nCreate custom plugins to extend functionality:\n\n```typescript\nimport { HookPlugin } from 'claude-hooks-sdk';\n\nconst myPlugin: HookPlugin = {\n  name: 'my-plugin',\n\n  async onBeforeExecute(input, context) {\n    // Called before handlers execute\n    console.log(`Event: ${input.hook_event_name}`);\n  },\n\n  async onAfterExecute(input, result, context) {\n    // Called after handlers execute\n    if (result.exitCode !== 0) {\n      console.error('Handler failed');\n    }\n  }\n};\n\nmanager.use(myPlugin);\n```\n\n## Documentation\n\n### üß† Interactive Skill (Recommended)\n\nInstall the **claude-hooks-sdk skill** for interactive guidance:\n\n```bash\n/plugin marketplace add hgeldenhuys/claude-hooks-sdk\n/plugin install claude-hooks-sdk-examples\n/skill claude-hooks-sdk\n```\n\nThe skill makes Claude Code self-aware of the SDK - ask questions like:\n- \"How do I enable edit tracking?\"\n- \"Show me a blocking hook example\"\n- \"Why aren't my logs appearing?\"\n\n### üìö Written Guides\n\nComprehensive guides and references in the [`docs/`](./docs/) directory:\n\n#### Feature Guides\n- **[Edit Tracking](./docs/guides/EDIT-TRACKING.md)** - Automatically track files modified by Claude\n- **[Non-Blocking Hooks](./docs/guides/NON-BLOCKING-HOOKS.md)** - Error handling that doesn't block Claude Code\n- **[Failure Queue](./docs/guides/FAILURE-QUEUE.md)** - Sequential event processing with automatic retry\n- **[Repo Instance ID](./docs/guides/REPO-INSTANCE-ID.md)** - Unique ID for each repo checkout\n\n### üìñ Reference\n- **[Schema Discoveries](./docs/reference/SCHEMA_DISCOVERIES.md)** - Undocumented Claude Code schema fields\n- **[Publication Checklist](./docs/reference/PUBLICATION-CHECKLIST.md)** - Pre-publication verification\n\n### üöÄ Releases\n- **[v0.4.1 Release Notes](./docs/releases/v0.4.1-SUMMARY.md)** - Latest release overview\n- **[v0.4.1 Bug Fixes](./docs/releases/BUG-FIXES-v0.4.1.md)** - Detailed bug fix documentation\n\nSee the **[Documentation Index](./docs/README.md)** for complete list.\n\n## Examples\n\n### Basic Examples\n\nComplete working examples in [`sample-extension/`](./sample-extension/):\n- **[event-logger-v2.ts](./sample-extension/event-logger-v2.ts)** - Production-ready event logger\n\n### Advanced Examples\n\nLooking for production-ready, sophisticated examples? Check out **[claude-hooks-sdk-examples](https://github.com/hgeldenhuys/claude-hooks-sdk-examples)** for:\n\n- **custom-backend** - Real-time event visualization server with markdown rendering, thinking blocks, smart polling, and analytics dashboards\n\n### Security Validation\n\n```typescript\nmanager.onPreToolUse(async (input) => {\n  if (input.tool_name !== 'Bash') {\n    return success();\n  }\n\n  const command = input.tool_input.command;\n\n  // Block dangerous patterns\n  if (/rm\\s+-rf\\s+\\//.test(command)) {\n    return block('Dangerous command: rm -rf /');\n  }\n\n  // Warn about sudo\n  if (command.includes('sudo')) {\n    return {\n      exitCode: 0,\n      output: {\n        hookSpecificOutput: {\n          hookEventName: 'PreToolUse',\n          permissionDecision: 'ask',\n          permissionDecisionReason: 'Requires elevated privileges'\n        }\n      }\n    };\n  }\n\n  return success();\n});\n```\n\n### API Integration Plugin\n\n```typescript\nconst apiPlugin: HookPlugin = {\n  name: 'api-logger',\n  async onAfterExecute(input, result) {\n    await fetch('https://my-api.com/hooks', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        event: input.hook_event_name,\n        sessionId: input.session_id,\n        timestamp: new Date().toISOString(),\n        success: result.exitCode === 0\n      })\n    });\n  }\n};\n\nmanager.use(apiPlugin);\n```\n\n### Context Injection\n\n```typescript\nmanager.onUserPromptSubmit(async (input) => {\n  return {\n    exitCode: 0,\n    stdout: `\nCurrent time: ${new Date().toISOString()}\nWorking directory: ${input.cwd}\nSession: ${input.session_id}\n    `.trim(),\n    output: { continue: true }\n  };\n});\n```\n\n### Transcript Analysis\n\n```typescript\nmanager.onStop(async (input, context) => {\n  const transcript = await context.getFullTranscript();\n\n  // Count tool uses\n  const toolUses = transcript.filter(line =>\n    line.content?.type === 'tool_use'\n  );\n\n  console.log(`Session used ${toolUses.length} tools`);\n\n  return success();\n});\n```\n\n### Fast Transcript Lookups with Line Numbers\n\nConversation turns automatically include line numbers for blazing-fast retroactive transcript lookups:\n\n```typescript\nconst logger = new ConversationLogger();\n\nmanager.onStop(async (input, context) => {\n  const turn = await logger.recordStop(input, context);\n\n  // Line number automatically included!\n  const lineNumber = turn.assistant.transcript_line_number;  // e.g., 42\n\n  // Store for fast retrieval later\n  await db.saveTransactionPointer({\n    session_id: input.session_id,\n    line_number: lineNumber,  // Fast lookup (0.002s with sed)\n    uuid: lastLine.uuid,      // Validation\n  });\n\n  return success();\n});\n\n// Later: Retrieve specific transcript line in 0.002s\nasync function getTranscriptEntry(sessionId: string, lineNumber: number) {\n  const path = `~/.claude/projects/.../${sessionId}.jsonl`;\n  const line = await Bun.$`sed -n '${lineNumber}p' ${path}`.text();\n  return JSON.parse(line);\n}\n```\n\n**Performance:** Line number lookups are **1000x faster** than UUID searches (0.002s vs 2.5s).\n\n**ConversationLine automatically includes:**\n- `lineNumber` - 1-indexed line number in transcript JSONL\n- `uuid` - Unique identifier for validation\n- All original transcript fields\n\n### Custom Backend Integration\n\nComplete production-ready example with mini Bun server and real-time HTML dashboard:\n\nüëâ **[examples/custom-backend/](./examples/custom-backend/)** - Full backend integration example\n\n**Features:**\n- üîå HTTP POST integration with custom headers\n- üñ•Ô∏è Real-time HTML dashboard with auto-refresh\n- üîê API key authentication\n- ‚ö° Timeout management and error handling\n- üé® Beautiful gradient UI with color-coded events\n- üìä Event aggregation and visualization\n\n**Quick Start:**\n```bash\n# Start the server\ncd examples/custom-backend\nbun server.ts\n\n# Configure hook in .claude/settings.json\n{\n  \"hooks\": {\n    \"SessionStart\": [\n      { \"type\": \"command\", \"command\": \"bun /path/to/examples/custom-backend/hook.ts\" }\n    ]\n  }\n}\n\n# View dashboard at http://localhost:3030\n```\n\nSee [examples/custom-backend/README.md](./examples/custom-backend/README.md) for complete documentation, testing instructions, and production deployment guide.\n\n### Transaction Logger - Flight Recorder for Conversations\n\nComprehensive transaction tracker that captures the full context of each conversation turn:\n\nüëâ **[examples/transaction-logger/](./examples/transaction-logger/)** - Complete transaction tracking system\n\n**What It Tracks:**\n- üí¨ User prompts (all messages in the turn)\n- üõ†Ô∏è All tool calls with inputs\n- üìù File changes (Write/Edit/MultiEdit with line counts)\n- ‚úÖ Todos created/updated\n- ü§ñ Assistant responses\n- üìä Transaction metadata (IDs, timestamps, duration, line numbers)\n\n**Features:**\n- Uses `transaction_id` to group all events in a turn\n- Writes to `.claude/logs/transactions.jsonl`\n- Beautiful TUI viewer with color-coding\n- Filter by session, show latest N, watch mode\n- Overall statistics and analytics\n- Perfect for debugging, auditing, and understanding workflows\n\n**Quick Start:**\n```typescript\n// Configure in .claude/settings.json (UserPromptSubmit, PostToolUse, Stop hooks)\n// Then view transactions:\nbun examples/transaction-logger/viewer.ts --latest 10\nbun examples/transaction-logger/viewer.ts --watch\n```\n\n**Example Transaction:**\n```json\n{\n  \"transaction_id\": \"a3f2c1d8-...\",\n  \"session_name\": \"brave-elephant\",\n  \"user_prompts\": [\"Help me implement auth\"],\n  \"files_changed\": [{\"path\": \"auth.ts\", \"operation\": \"write\", \"lines_changed\": 120}],\n  \"todos_created\": [{\"content\": \"Create service\", \"status\": \"completed\"}],\n  \"assistant_response\": \"I've created the authentication service...\",\n  \"transcript_line_number\": 42,\n  \"summary\": {\n    \"total_files_changed\": 3,\n    \"total_todos_created\": 5,\n    \"unique_tools\": [\"Write\", \"Edit\", \"TodoWrite\"]\n  }\n}\n```\n\nSee [examples/transaction-logger/README.md](./examples/transaction-logger/README.md) for complete documentation, analytics examples, and integration ideas.\n\n## Type Definitions\n\nAll hook events are fully typed:\n\n```typescript\nimport type {\n  // Input types\n  PreToolUseInput,\n  PostToolUseInput,\n  SessionStartInput,\n  // ... all other events\n\n  // Output types\n  PreToolUseOutput,\n  PostToolUseOutput,\n  // ...\n\n  // Context\n  HookContext,\n  TranscriptLine,\n} from 'claude-hooks-sdk';\n```\n\n## Hook Events\n\n| Event | When It Fires | Common Use Cases |\n|-------|---------------|------------------|\n| `PreToolUse` | Before tool execution | Validation, blocking, security |\n| `PostToolUse` | After tool completion | Formatting, testing, logging |\n| `Notification` | On Claude notifications | Custom notifications |\n| `UserPromptSubmit` | Before processing input | Context injection, validation |\n| `Stop` | Agent finishes responding | Cleanup, analytics |\n| `SubagentStop` | Subagent completes | Delegation tracking |\n| `PreCompact` | Before context compaction | State preservation |\n| `SessionStart` | Session begins | Initialization, setup |\n| `SessionEnd` | Session terminates | Cleanup, reporting |\n\n## Advanced Usage\n\n### Multiple Handlers\n\nYou can register multiple handlers for the same event:\n\n```typescript\nmanager\n  .onPreToolUse(validateSecurity)\n  .onPreToolUse(logToolUse)\n  .onPreToolUse(checkRateLimit);\n```\n\nHandlers execute in registration order and can stop the chain by returning `exitCode: 2`.\n\n### Conditional Execution\n\n```typescript\nmanager.onPostToolUse(async (input) => {\n  // Only process Write tool\n  if (input.tool_name !== 'Write') {\n    return success();\n  }\n\n  const filePath = input.tool_input.file_path;\n\n  // Format TypeScript files\n  if (filePath.endsWith('.ts') || filePath.endsWith('.tsx')) {\n    await formatFile(filePath);\n  }\n\n  return success();\n});\n```\n\n### Error Handling\n\n```typescript\nmanager.onSessionStart(async (input) => {\n  try {\n    await initializeServices();\n    return success();\n  } catch (err) {\n    return error(`Initialization failed: ${err.message}`);\n  }\n});\n```\n\n## Development\n\n```bash\n# Install dependencies\nbun install\n\n# Build\nbun run build\n\n# Type check\nbun run typecheck\n\n# Run examples\nbun examples/basic-hook.ts\n```\n\n## License\n\nMIT ¬© hgeldenhuys\n\n## Contributing\n\nContributions welcome! Please read our [contributing guidelines](CONTRIBUTING.md) first.\n\n## Resources\n\n- [Claude Code Documentation](https://code.claude.com/docs)\n- [Hooks Reference](https://code.claude.com/docs/en/hooks)\n- [Examples](./examples)\n\n## Related Projects\n\nThis is the standalone, zero-dependency version of the SDK. For platform-specific integrations, check the repository for additional tooling.\n",
        ".claude-plugin/plugins/analytics-tracker/README.md": "# Analytics Tracker Plugin\n\nAutomatically track session costs, token usage, and performance metrics for Claude Code sessions.\n\n## Features\n\n- üí∞ **Automatic Cost Tracking** - Monitor costs in real-time with configurable model pricing\n- üìä **Token Usage Monitoring** - Track input/output tokens for every turn\n- üîß **Tool Usage Statistics** - See which tools are used most frequently\n- üìà **Session Summaries** - Get detailed reports at the end of each session\n- üíæ **Persistent Storage** - Metrics survive restarts using SQLite\n\n## Installation\n\n### Step 1: Install the Plugin\n\n```bash\n/plugin install analytics-tracker\n```\n\nThis copies files to `.claude/hooks/analytics-tracker/` and `.claude-plugin/`.\n\n### Step 2: Register Hooks (REQUIRED)\n\n**CRITICAL:** The plugin doesn't auto-register! You must manually add it to `.claude/settings.json`.\n\nAdd these hook registrations to your `.claude/settings.json`:\n\n```json\n{\n  \"hooks\": {\n    \"SessionStart\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/analytics-tracker/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"SessionEnd\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/analytics-tracker/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"Stop\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/analytics-tracker/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/analytics-tracker/hook.ts\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n**Note:** If you already have hooks registered, add these to your existing arrays (don't replace them).\n\n### Step 3: Install Dependencies\n\n```bash\nbun add chalk  # For the viewer script\n```\n\n### Step 4: Restart Claude Code\n\nHooks only load at startup. Restart to activate analytics-tracker.\n\n## Configuration\n\nCreate or edit `.claude-plugin/config.json`:\n\n```json\n{\n  \"analytics-tracker\": {\n    \"enabled\": true,\n    \"storagePath\": \".claude/analytics.db\",\n    \"logPath\": \".claude/logs/analytics-tracker.jsonl\",\n    \"pricing\": {\n      \"claude-sonnet-4\": {\n        \"input\": 3.0,\n        \"output\": 15.0\n      },\n      \"claude-opus-4\": {\n        \"input\": 15.0,\n        \"output\": 75.0\n      },\n      \"claude-haiku-4\": {\n        \"input\": 0.8,\n        \"output\": 4.0\n      }\n    },\n    \"reportingInterval\": \"session\"\n  }\n}\n```\n\n### Environment Variables\n\nAlternatively, use environment variables:\n\n```bash\nexport ANALYTICS_TRACKER_ENABLED=true\nexport ANALYTICS_TRACKER_STORAGE_PATH=.claude/analytics.db\n```\n\n## Usage\n\n### View Real-Time Analytics\n\nIn a separate terminal, tail the log with the viewer:\n\n```bash\ntail -f .claude/logs/analytics-tracker.jsonl | bun .claude/hooks/analytics-tracker/scripts/viewer.ts\n```\n\nOr view raw JSONL:\n\n```bash\ntail -f .claude/logs/analytics-tracker.jsonl\n```\n\nThe plugin writes to `.claude/logs/analytics-tracker.jsonl` - all output is file-based for easy tailing and processing.\n\n## Sample Output\n\n### Per-Turn Tracking\n\n```\n[analytics-tracker] üí∞ Turn 1: $0.0234 | 1,560 tokens\n[analytics-tracker] üí∞ Turn 2: $0.0456 | 3,040 tokens\n[analytics-tracker] üí∞ Turn 3: $0.0189 | 1,260 tokens\n```\n\n### Session Summary\n\n```\n[analytics-tracker] üìä Session Summary\n  Duration: 12m 45s\n  Turns: 24\n  Tokens: 156,892 (89,234 in / 67,658 out)\n  Cost: $1.2834 ($0.2677 in / $1.0157 out)\n  Tools: 12 different tools used\n  Errors: 5 (3.2% error rate)\n  Top tools: Read(45), Write(23), Edit(18), Grep(12), Bash(8)\n```\n\n### All-Time Statistics\n\n```\n[analytics-tracker] üìà All-Time Statistics\n  Total sessions: 156\n  Total cost: $234.56\n  Average cost: $1.5036 per session\n  Total tokens: 12,456,890\n  Average turns: 18.5 per session\n```\n\n## API\n\nThe plugin uses `SessionAnalytics` from claude-hooks-sdk v0.7.0. You can access analytics programmatically:\n\n```typescript\nimport { SessionAnalytics } from 'claude-hooks-sdk';\n\nconst analytics = new SessionAnalytics({\n  pricing: { /* ... */ },\n  storagePath: '.claude/analytics.db'\n});\n\n// Get metrics for a session\nconst metrics = await analytics.getMetrics(sessionId);\n\n// Get aggregated metrics\nconst agg = await analytics.getAggregatedMetrics();\n```\n\n## Pricing Updates\n\nUpdate pricing in `config.json` to match current Anthropic pricing:\n\n```json\n{\n  \"pricing\": {\n    \"claude-sonnet-4\": {\n      \"input\": 3.0,   // $ per million input tokens\n      \"output\": 15.0  // $ per million output tokens\n    }\n  }\n}\n```\n\n## Storage\n\nAnalytics are stored in SQLite at the configured `storagePath` (default: `.claude/analytics.db`). This file persists across sessions and can be queried directly:\n\n```bash\nsqlite3 .claude/analytics.db \"SELECT * FROM state WHERE key LIKE 'session:%'\"\n```\n\n## JSONL Log Format\n\nThe plugin writes structured JSONL events:\n\n**session_start**\n```json\n{\"timestamp\":\"2025-11-23T05:01:37.688Z\",\"event\":\"session_start\",\"session_id\":\"482abe2a...\"}\n```\n\n**turn_complete**\n```json\n{\"timestamp\":\"2025-11-23T05:02:15.123Z\",\"event\":\"turn_complete\",\"session_id\":\"482abe2a...\",\"turn\":1,\"cost\":{\"total\":0.0234,\"input\":0.0015,\"output\":0.0219},\"tokens\":{\"total\":1560,\"input\":500,\"output\":1060}}\n```\n\n**session_end**\n```json\n{\"timestamp\":\"2025-11-23T05:15:30.456Z\",\"event\":\"session_end\",\"session_id\":\"482abe2a...\",\"duration\":\"13m 53s\",\"turns\":12,\"tokens\":{...},\"cost\":{...},\"tools\":{...}}\n```\n\n## Troubleshooting\n\n**Q: No logs appearing after install?**\n1. Check hook registration in `.claude/settings.json`\n2. Restart Claude Code (hooks only load at startup)\n3. Check debug log: `cat .claude/logs/analytics-debug.log`\n4. Verify hook permissions: `chmod +x .claude/hooks/analytics-tracker/hook.ts`\n\n**Q: Wrong costs?**\nA: Update pricing in config.json to match current Anthropic rates (https://anthropic.com/pricing).\n\n**Q: Database locked errors?**\nA: Only one hook instance should run per session. Check for duplicate registrations in settings.json.\n",
        ".claude-plugin/plugins/conversation-logger/README.md": "# Conversation Logger Plugin\n\nUnified conversation logging across all Claude Code sessions with beautiful color-coded output.\n\n## Features\n\n- üìù **Unified Log** - All sessions write to one file (`.claude/logs/conversation.jsonl`)\n- üé® **Color-Coded Sessions** - Each session gets a unique, deterministic color (10 colors)\n- üí≠ **Thinking Blocks** - Shows Claude's internal reasoning when present\n- üîß **Tool Tracking** - Displays tool uses with descriptions\n- üìä **Token Usage** - Shows input/output tokens and cache hits\n- üîÑ **Multi-Session** - Perfect for watching multiple agents/sessions simultaneously\n\n## Installation\n\n### Step 1: Install the Plugin\n\n```bash\n/plugin install conversation-logger\n```\n\n### Step 2: Register Hooks (REQUIRED)\n\nAdd to `.claude/settings.json`:\n\n```json\n{\n  \"hooks\": {\n    \"SessionStart\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/conversation-logger/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"SessionEnd\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/conversation-logger/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"UserPromptSubmit\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/conversation-logger/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"Stop\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/conversation-logger/hook.ts\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Step 3: Install Dependencies\n\n```bash\nbun add chalk\n```\n\n### Step 4: Restart Claude Code\n\nHooks only load at startup.\n\n## Usage\n\n### Watch Live Conversations\n\nIn a separate terminal:\n\n```bash\ntail -f .claude/logs/conversation.jsonl | bun .claude/hooks/conversation-logger/scripts/viewer.ts\n```\n\n### Replay a Session\n\n```bash\ncat .claude/logs/conversation.jsonl | bun .claude/hooks/conversation-logger/scripts/viewer.ts\n```\n\n## Visual Output\n\nEach session gets a unique color and border:\n\n```\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë ü§ñ Agent Started                                                             ‚ïë\n‚ïë   Session: ea702ba6                                                          ‚ïë\n‚ïë   Source: startup                                                            ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n‚îÇ [12:45:30 AM] üë§ User:\n‚îÇ How do I install the analytics-tracker?\n‚îÇ\n\n‚îÇ [12:45:35 AM] ü§ñ Assistant:\n‚îÇ üí≠ Thinking:\n‚îÇ User wants to install analytics-tracker plugin...\n‚îÇ\n‚îÇ Great question! To install analytics-tracker...\n‚îÇ\n‚îÇ üîß Read\n‚îÇ    Check analytics-tracker installation\n‚îÇ üìä 1,234 tokens (234 in / 1,000 out) [98,234 cached]\n‚îÇ\n```\n\nWhen a **second session** starts in another terminal, it gets a different color:\n\n```\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë ü§ñ Agent Started                                                             ‚ïë\n‚ïë   Session: f3b2c891                                                          ‚ïë\n‚ïë   Source: startup                                                            ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n‚îÇ [12:46:00 AM] üë§ User:\n‚îÇ Debug the API error\n‚îÇ\n```\n\n## Color Palette\n\nThe plugin cycles through 10 colors:\n1. Cyan\n2. Green\n3. Yellow\n4. Blue\n5. Magenta\n6. Red\n7. White\n8. Gray\n9. Bright Green\n10. Bright Blue\n\n**Note:** Colors are deterministically assigned based on session ID hash, so the same session always gets the same color, even across viewer restarts.\n\n## Log Format (JSONL)\n\n### `session_start`\n```json\n{\n  \"timestamp\": \"2025-11-23T05:41:05.484Z\",\n  \"event\": \"session_start\",\n  \"session_id\": \"af13b3cd-5185-42df-aa85-3bf6e52e1810\",\n  \"source\": \"startup\"\n}\n```\n\n### `user_message`\n```json\n{\n  \"timestamp\": \"2025-11-23T05:41:38.390Z\",\n  \"event\": \"user_message\",\n  \"session_id\": \"af13b3cd-5185-42df-aa85-3bf6e52e1810\",\n  \"content\": \"How do I install analytics-tracker?\"\n}\n```\n\n### `assistant_message`\n```json\n{\n  \"timestamp\": \"2025-11-23T05:42:11.770Z\",\n  \"event\": \"assistant_message\",\n  \"session_id\": \"af13b3cd-5185-42df-aa85-3bf6e52e1810\",\n  \"text\": \"Great question! To install...\",\n  \"thinking\": \"User wants to know about installation...\",\n  \"tools\": [\n    {\"name\": \"Read\", \"description\": \"Check installation\"}\n  ],\n  \"model\": \"claude-sonnet-4-5-20250929\",\n  \"usage\": {\n    \"input_tokens\": 234,\n    \"output_tokens\": 1000,\n    \"cache_read_input_tokens\": 98234\n  }\n}\n```\n\n### `session_end`\n```json\n{\n  \"timestamp\": \"2025-11-23T05:50:00.000Z\",\n  \"event\": \"session_end\",\n  \"session_id\": \"af13b3cd-5185-42df-aa85-3bf6e52e1810\",\n  \"reason\": \"logout\"\n}\n```\n\n## Use Cases\n\n### Multi-Agent Development\nRun multiple Claude Code instances working on different parts of your project, watch them all in one terminal:\n\n```bash\n# Terminal 1: Backend agent (cyan border)\n# Terminal 2: Frontend agent (green border)\n# Terminal 3: Combined conversation log\ntail -f .claude/logs/conversation.jsonl | bun .claude/hooks/conversation-logger/scripts/viewer.ts\n```\n\n### Debugging Sessions\nReplay a problematic session to see exactly what happened:\n\n```bash\ngrep \"problem-session-id\" .claude/logs/conversation.jsonl | bun .claude/hooks/conversation-logger/scripts/viewer.ts\n```\n\n### Pair Programming\nShare your `.claude/logs/conversation.jsonl` file with teammates to show your conversation with Claude.\n\n## Combine with Analytics Tracker\n\nUse both plugins together for full observability:\n\n**Terminal 1:** Cost tracking\n```bash\ntail -f .claude/logs/analytics-tracker.jsonl | bun .claude/hooks/analytics-tracker/scripts/viewer.ts\n```\n\n**Terminal 2:** Conversation log\n```bash\ntail -f .claude/logs/conversation.jsonl | bun .claude/hooks/conversation-logger/scripts/viewer.ts\n```\n\n## Troubleshooting\n\n**Q: No logs appearing?**\n1. Check `.claude/settings.json` has all 4 hook registrations\n2. Restart Claude Code\n3. Verify log file exists: `ls -la .claude/logs/conversation.jsonl`\n\n**Q: Colors changing between viewer restarts?**\nA: This was fixed in v0.7.1 - colors are now deterministically assigned based on session ID hash.\n\n**Q: Multiple sessions showing the same color?**\nA: With 10 colors cycling, session 11 will reuse color 1. This is expected when running many concurrent sessions.\n\n## License\n\nMIT\n",
        ".claude-plugin/plugins/anomaly-monitor/README.md": "# Anomaly Monitor Plugin\n\nReal-time anomaly detection with configurable alerts for Claude Code sessions.\n\n## Features\n\n- üö® **Error Rate Monitoring** - Alert when error rates exceed thresholds\n- ‚è±Ô∏è **Response Time Analysis** - Detect slow responses using p95/p99 metrics\n- üìà **Token Spike Detection** - Statistical analysis to catch unusual token usage\n- üîî **Webhook Alerts** - Send alerts to Slack, Discord, or custom webhooks\n- üìä **Session Statistics** - View performance stats at session end\n\n## Installation\n\n```bash\n# Install from marketplace\n/plugin install anomaly-monitor\n\n# Or copy hook manually\nchmod +x .claude-plugin/plugins/anomaly-monitor/hook.ts\n```\n\n## Configuration\n\nEdit `.claude-plugin/config.json`:\n\n```json\n{\n  \"anomaly-monitor\": {\n    \"enabled\": true,\n    \"thresholds\": {\n      \"errorRate\": 0.1,      // Alert if >10% of tool calls fail\n      \"responseTime\": 30000, // Alert if p95 >30 seconds\n      \"tokenSpike\": 3        // Alert if tokens >3 std deviations from mean\n    },\n    \"alerts\": {\n      \"webhook\": \"https://hooks.slack.com/services/YOUR/WEBHOOK/URL\",\n      \"email\": \"alerts@example.com\"\n    }\n  }\n}\n```\n\n### Slack Webhook Setup\n\n1. Create a Slack webhook at https://api.slack.com/messaging/webhooks\n2. Add the webhook URL to config.json\n3. Anomalies will be posted to your Slack channel\n\n## Usage\n\nOnce configured, the plugin automatically monitors all sessions and sends alerts when anomalies are detected.\n\n## Sample Output\n\n### Real-Time Alert\n\n```\n[anomaly-monitor] üö® ANOMALY DETECTED!\n  Type: error_rate\n  Value: 0.15\n  Threshold: 0.10\n  Time: 2025-01-22 14:32:15\n  Details: {\n    \"errors\": 12,\n    \"totalEvents\": 80\n  }\n[anomaly-monitor] ‚úÖ Alert sent to webhook\n```\n\n### Token Spike Alert\n\n```\n[anomaly-monitor] üö® ANOMALY DETECTED!\n  Type: token_spike\n  Value: 45000\n  Threshold: 15000\n  Time: 2025-01-22 14:35:42\n  Details: {\n    \"zScore\": 3.2,\n    \"mean\": 12000,\n    \"stdDev\": 4200\n  }\n```\n\n### Session Summary\n\n```\n[anomaly-monitor] üìä Session Anomaly Summary\n  Total anomalies: 3\n  error_rate: 1\n  token_spike: 2\n\n[anomaly-monitor] üìà Session Statistics\n  Mean response time: 5420ms\n  Median response time: 4230ms\n  P95 response time: 18500ms\n  Std deviation: 6800ms\n```\n\n## Anomaly Types\n\n### Error Rate\nTriggers when tool call error rate exceeds threshold within a time window.\n\n**When to adjust:**\n- Lower threshold (0.05) for production systems\n- Higher threshold (0.2) during development\n\n### Response Time\nTriggers when p95 response time exceeds threshold.\n\n**When to adjust:**\n- Lower threshold (15000ms) for interactive sessions\n- Higher threshold (60000ms) for batch processing\n\n### Token Spike\nTriggers when token usage is >N standard deviations from the mean.\n\n**When to adjust:**\n- Lower stdDev (2) for consistent workloads\n- Higher stdDev (5) for variable workloads\n\n## Webhook Format\n\nAlerts are sent as JSON with this structure:\n\n```json\n{\n  \"text\": \"üö® Anomaly Detected: error_rate\",\n  \"attachments\": [{\n    \"color\": \"danger\",\n    \"fields\": [\n      {\"title\": \"Type\", \"value\": \"error_rate\"},\n      {\"title\": \"Value\", \"value\": \"0.15\"},\n      {\"title\": \"Threshold\", \"value\": \"0.10\"},\n      {\"title\": \"Session\", \"value\": \"abc-123\"},\n      {\"title\": \"Time\", \"value\": \"2025-01-22 14:32:15\"}\n    ]\n  }]\n}\n```\n\nCompatible with:\n- ‚úÖ Slack\n- ‚úÖ Discord\n- ‚úÖ Microsoft Teams\n- ‚úÖ Custom webhooks\n\n## Troubleshooting\n\n**Q: Too many alerts?**\nA: Increase thresholds in config.json\n\n**Q: Webhook not working?**\nA: Check webhook URL is correct and test it manually with curl\n\n**Q: Missing anomalies?**\nA: Lower thresholds to be more sensitive\n",
        ".claude-plugin/plugins/event-recorder/README.md": "# Event Recorder Plugin\n\nRecord all Claude Code hook events to JSONL files for debugging, testing, and replay.\n\n## Features\n\n- üìπ **JSONL Recording** - Events saved in newline-delimited JSON format\n- üéØ **Event Filtering** - Record only specific event types\n- üíæ **Auto-Save** - Events saved in real-time or at session end\n- üîÑ **Replay Support** - Replay recorded sessions for testing\n- üêõ **Debugging Aid** - Inspect exactly what happened in a session\n\n## Installation\n\n```bash\n# Install from marketplace\n/plugin install event-recorder\n\n# Or copy hook manually\nchmod +x .claude-plugin/plugins/event-recorder/hook.ts\n```\n\n## Configuration\n\nEdit `.claude-plugin/config.json`:\n\n```json\n{\n  \"event-recorder\": {\n    \"enabled\": true,\n    \"outputPath\": \".claude/events.jsonl\",\n    \"autoSave\": true,\n    \"events\": [\n      \"UserPromptSubmit\",\n      \"PostToolUse\",\n      \"Stop\"\n    ]\n  }\n}\n```\n\n### Configuration Options\n\n- **outputPath**: Where to save recorded events\n- **autoSave**: Save after each event (true) or at session end (false)\n- **events**: Array of event types to record, or empty array for all events\n\n### Event Types\n\nAvailable event types to filter:\n- `SessionStart`\n- `SessionEnd`\n- `UserPromptSubmit`\n- `PreToolUse`\n- `PostToolUse`\n- `Stop`\n- `SubagentStop`\n- `PreCompact`\n- `Notification`\n\n## Usage\n\nOnce enabled, all events are automatically recorded:\n\n```bash\n# Events are recorded in real-time\nclaude\n\n# At session end, you'll see:\n# [event-recorder] üìπ Recording Summary\n#   Events recorded: 245\n#   Duration: 12m 34s\n#   Output: .claude/events.jsonl\n#   Replay with: bun .claude-plugin/plugins/event-recorder/replay.ts\n```\n\n## File Format\n\nEvents are saved as JSONL (newline-delimited JSON):\n\n```json\n{\"timestamp\":1706012345678,\"event\":{\"hook_event_name\":\"UserPromptSubmit\",\"session_id\":\"abc-123\",\"prompt\":\"Fix the bug\"}}\n{\"timestamp\":1706012346123,\"event\":{\"hook_event_name\":\"PostToolUse\",\"session_id\":\"abc-123\",\"tool_name\":\"Read\"}}\n{\"timestamp\":1706012347890,\"event\":{\"hook_event_name\":\"Stop\",\"session_id\":\"abc-123\"}}\n```\n\n## Replay\n\nUse the EventReplayer to replay recorded sessions:\n\n```typescript\nimport { EventReplayer } from 'claude-hooks-sdk';\n\nconst replayer = new EventReplayer('.claude/events.jsonl');\n\n// Replay at 2x speed\nawait replayer.replay((event, index) => {\n  console.log(`Event ${index}:`, event.hook_event_name);\n}, {\n  speed: 2.0,\n  realtime: true\n});\n\n// Get summary\nconst summary = await replayer.getSummary();\nconsole.log('Total events:', summary.total);\nconsole.log('By type:', summary.byType);\n```\n\n## Use Cases\n\n### Debugging\n\nRecord a session where a bug occurs, then replay it to understand what happened:\n\n```bash\n# Bug occurs during this session (events recorded)\nclaude\n\n# Replay the session\nbun replay.ts\n```\n\n### Testing\n\nCreate test fixtures from real sessions:\n\n```typescript\n// Record real usage\nconst recorder = new EventRecorder({\n  output: 'test-fixtures/session-001.jsonl',\n  autoSave: true\n});\n\n// Later, use for tests\nconst replayer = new EventReplayer('test-fixtures/session-001.jsonl');\nawait replayer.replay(testHandler);\n```\n\n### Analysis\n\nAnalyze patterns across multiple sessions:\n\n```bash\n# Count events by type\ncat .claude/events.jsonl | jq '.event.hook_event_name' | sort | uniq -c\n\n# Find errors\ncat .claude/events.jsonl | jq 'select(.event.tool_response.error)'\n\n# Calculate average tokens\ncat .claude/events.jsonl | jq 'select(.event.hook_event_name==\"Stop\") | .event.usage.input_tokens' | jq -s 'add/length'\n```\n\n## Troubleshooting\n\n**Q: File too large?**\nA: Enable event filtering to record only specific events\n\n**Q: Performance impact?**\nA: Minimal with autoSave:false, saves at session end only\n\n**Q: Disk space?**\nA: Compress old recordings: `gzip .claude/events-*.jsonl`\n",
        ".claude-plugin/plugins/performance-monitor/README.md": "# Performance Monitor Plugin\n\nTrack response times, SLA compliance, and tool performance. Monitor p95/p99 metrics and get alerted when SLAs are breached.\n\n## Features\n\n- ‚è±Ô∏è **Response Time Tracking** - Monitor p50, p95, p99 response times\n- üéØ **SLA Compliance** - Set thresholds and detect breaches\n- üîß **Tool Performance** - Track which tools are slowest\n- üìä **Session Metrics** - Comprehensive performance summary at session end\n- ‚ö†Ô∏è **Real-time Alerts** - Get notified when performance degrades\n\n## Installation\n\n### Step 1: Install the Plugin\n\n```bash\n/plugin install performance-monitor\n```\n\n### Step 2: Register Hooks (REQUIRED)\n\nAdd to `.claude/settings.json`:\n\n```json\n{\n  \"hooks\": {\n    \"SessionStart\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/performance-monitor/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/performance-monitor/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"Stop\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/performance-monitor/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"SessionEnd\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/performance-monitor/hook.ts\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Step 3: Configure (Optional)\n\nCreate or edit `.claude-plugin/config.json`:\n\n```json\n{\n  \"performance-monitor\": {\n    \"enabled\": true,\n    \"slaThresholds\": {\n      \"p95ResponseTime\": 30000,\n      \"errorRate\": 0.05\n    }\n  }\n}\n```\n\n### Step 4: Restart Claude Code\n\nHooks only load at startup.\n\n## Usage\n\nOnce enabled, performance metrics are automatically tracked. At session end, you'll see:\n\n```\n[performance-monitor] ‚ö° Performance Summary\n  Duration: 8m 45s\n  Turns: 12\n  Tools used: 5\n  Error rate: 2.3%\n\n[performance-monitor] ‚úÖ All SLAs met\n```\n\n### SLA Breach Example\n\nIf performance degrades, you'll be alerted:\n\n```\n[performance-monitor] ‚ö° Performance Summary\n  Duration: 15m 32s\n  Turns: 8\n  Tools used: 6\n  Error rate: 8.4%\n\n[performance-monitor] üö® SLA Breaches:\n  ‚ö†Ô∏è  Error rate 8.4% exceeds SLA 5.0%\n```\n\n## Configuration Options\n\n### `enabled`\n- **Type**: `boolean`\n- **Default**: `true`\n- **Description**: Enable/disable the plugin\n\n### `slaThresholds.p95ResponseTime`\n- **Type**: `number` (milliseconds)\n- **Default**: `30000` (30 seconds)\n- **Description**: Maximum acceptable p95 response time\n\n**Recommended values:**\n- Interactive sessions: `15000` (15s)\n- Standard sessions: `30000` (30s)\n- Batch processing: `60000` (60s)\n\n### `slaThresholds.errorRate`\n- **Type**: `number` (0.0 - 1.0)\n- **Default**: `0.05` (5%)\n- **Description**: Maximum acceptable error rate\n\n**Recommended values:**\n- Production: `0.01` (1%)\n- Development: `0.05` (5%)\n- Experimental: `0.20` (20%)\n\n## Metrics Collected\n\n### Session-Level Metrics\n\n- **Duration**: Total session time (start to end)\n- **Turns**: Number of user prompts / assistant responses\n- **Tools used**: Unique tools invoked during session\n- **Error rate**: Percentage of tool calls that failed\n\n### Tool-Level Metrics\n\n- **Invocation count**: How many times each tool was used\n- **Success rate**: Percentage of successful tool calls\n- **Average response time**: Mean time for tool execution\n\n### Performance Percentiles\n\n- **p50 (median)**: 50% of responses were faster than this\n- **p95**: 95% of responses were faster than this\n- **p99**: 99% of responses were faster than this\n\n**Why p95 matters**: p95 represents the \"worst normal case\" - the slowest 5% of requests are often outliers or errors, so p95 gives a realistic view of typical performance.\n\n## Use Cases\n\n### Production Monitoring\n\nMonitor Claude Code sessions in production environments:\n\n```json\n{\n  \"performance-monitor\": {\n    \"enabled\": true,\n    \"slaThresholds\": {\n      \"p95ResponseTime\": 15000,\n      \"errorRate\": 0.01\n    }\n  }\n}\n```\n\nSet strict thresholds and investigate any SLA breaches.\n\n### Development Optimization\n\nTrack performance during development:\n\n```json\n{\n  \"performance-monitor\": {\n    \"enabled\": true,\n    \"slaThresholds\": {\n      \"p95ResponseTime\": 30000,\n      \"errorRate\": 0.10\n    }\n  }\n}\n```\n\nMore lenient thresholds allow experimentation while still catching major issues.\n\n### Performance Regression Detection\n\nRun performance monitor on every commit to catch regressions:\n\n```bash\n# In CI/CD pipeline\nclaude --headless \"run test suite\" 2>&1 | tee claude-output.log\n\n# Check for SLA breaches\nif grep \"SLA Breaches\" claude-output.log; then\n  echo \"Performance regression detected!\"\n  exit 1\nfi\n```\n\n## Advanced Usage\n\n### Historical Tracking\n\nPerformance data is stored in `.claude/performance.db` (SQLite):\n\n```bash\n# View all session metrics\nsqlite3 .claude/performance.db \"SELECT * FROM sessions\"\n\n# Calculate average error rate over last 10 sessions\nsqlite3 .claude/performance.db \"\n  SELECT AVG(error_rate) FROM sessions\n  ORDER BY created_at DESC\n  LIMIT 10\n\"\n\n# Find slowest sessions\nsqlite3 .claude/performance.db \"\n  SELECT session_id, duration, turns\n  FROM sessions\n  ORDER BY duration DESC\n  LIMIT 5\n\"\n```\n\n### Combining with Other Plugins\n\nUse with `analytics-tracker` for cost + performance insights:\n\n```\n[analytics-tracker] üí∞ Turn 1: $0.0154 | 1,041 tokens\n[performance-monitor] ‚ö° Performance Summary\n  Duration: 8m 45s\n  Error rate: 0.0%\n```\n\nUse with `anomaly-monitor` for real-time alerting:\n\n```\n[anomaly-monitor] üö® ANOMALY DETECTED!\n  Type: response_time\n  Value: 45000ms\n  Threshold: 30000ms\n```\n\n## Troubleshooting\n\n**Q: No performance summary showing?**\n\n1. Check `.claude/settings.json` has all 4 hook registrations\n2. Restart Claude Code\n3. Complete a full session (SessionStart ‚Üí SessionEnd)\n\n**Q: SLA thresholds too strict?**\n\nAdjust thresholds in `.claude-plugin/config.json` based on your use case. Development sessions typically need more lenient thresholds than production.\n\n**Q: Database file too large?**\n\nClean up old sessions:\n\n```bash\n# Delete sessions older than 30 days\nsqlite3 .claude/performance.db \"\n  DELETE FROM sessions\n  WHERE created_at < datetime('now', '-30 days')\n\"\n\n# Vacuum to reclaim space\nsqlite3 .claude/performance.db \"VACUUM\"\n```\n\n## Performance Impact\n\nThe plugin itself has minimal overhead:\n- **Per event**: <2ms processing time\n- **Memory**: ~5MB for session tracking\n- **Disk**: SQLite database grows ~1KB per session\n\n## License\n\nMIT\n",
        ".claude-plugin/plugins/file-auditor/README.md": "# File Auditor Plugin\n\nComprehensive file change tracking with audit trails. Track every Write, Edit, and MultiEdit operation with timestamps and session IDs.\n\n## Features\n\n- üìù **Complete Audit Trail** - Track all file Write/Edit/MultiEdit operations\n- üìä **Session Summaries** - View all files modified in a session\n- üîç **Operation Tracking** - See exactly what changes were made\n- üíæ **Audit Logs** - Persistent log file with timestamps and session IDs\n- üìà **Change Statistics** - Count operations by type\n\n## Installation\n\n### Step 1: Install the Plugin\n\n```bash\n/plugin install file-auditor\n```\n\n### Step 2: Register Hooks (REQUIRED)\n\nAdd to `.claude/settings.json`:\n\n```json\n{\n  \"hooks\": {\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/file-auditor/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"SessionEnd\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/file-auditor/hook.ts\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Step 3: Configure (Optional)\n\nCreate or edit `.claude-plugin/config.json`:\n\n```json\n{\n  \"file-auditor\": {\n    \"enabled\": true,\n    \"auditLogPath\": \".claude/file-audit.log\",\n    \"gitIntegration\": false\n  }\n}\n```\n\n### Step 4: Restart Claude Code\n\nHooks only load at startup.\n\n## Usage\n\nOnce enabled, all file operations are automatically tracked:\n\n```bash\n# File operations are logged in real-time\n[file-auditor] üìù WRITE: src/components/Button.tsx\n[file-auditor] üìù EDIT: src/utils/helpers.ts\n[file-auditor] üìù WRITE: src/pages/Home.tsx\n```\n\nAt session end, you'll see a summary:\n\n```\n[file-auditor] üìä File Change Summary\n  Total changes: 12\n  Files modified: 8\n  Operations: write(5), edit(7)\n\n  Files:\n    - src/components/Button.tsx\n    - src/utils/helpers.ts\n    - src/pages/Home.tsx\n    - src/styles/globals.css\n    - package.json\n    - README.md\n    - src/components/Header.tsx\n    - src/hooks/useAuth.ts\n```\n\n## Audit Log Format\n\nThe audit log (`.claude/file-audit.log`) uses a simple pipe-delimited format:\n\n```\n2025-11-23T12:34:56.789Z | WRITE | src/components/Button.tsx | session:abc-123-def-456\n2025-11-23T12:35:12.345Z | EDIT | src/utils/helpers.ts | session:abc-123-def-456\n2025-11-23T12:36:05.678Z | WRITE | src/pages/Home.tsx | session:abc-123-def-456\n```\n\n### Fields\n\n1. **Timestamp** - ISO 8601 format\n2. **Operation** - WRITE, EDIT, or MULTIEDIT\n3. **File Path** - Absolute or relative path to the file\n4. **Session ID** - Claude Code session identifier\n\n## Use Cases\n\n### Compliance and Auditing\n\nTrack all code changes for compliance requirements:\n\n```bash\n# View all changes today\ngrep \"$(date +%Y-%m-%d)\" .claude/file-audit.log\n\n# Count changes by file\ncat .claude/file-audit.log | cut -d'|' -f3 | sort | uniq -c | sort -rn\n\n# Find changes by session\ngrep \"session:abc-123\" .claude/file-audit.log\n```\n\n### Change Analysis\n\nUnderstand what files are modified most frequently:\n\n```bash\n# Top 10 most modified files\ncat .claude/file-audit.log | cut -d'|' -f3 | sort | uniq -c | sort -rn | head -10\n\n# Changes in last hour\nfind .claude/file-audit.log -mmin -60 -exec cat {} \\;\n```\n\n### Session Investigation\n\nReview exactly what changed in a specific session:\n\n```bash\n# Get session ID from conversation log\nSESSION_ID=\"abc-123-def-456\"\n\n# View all file changes for that session\ngrep \"session:$SESSION_ID\" .claude/file-audit.log\n```\n\n### Integration with Git\n\nVerify that all Claude Code changes were committed:\n\n```bash\n# Get list of files modified by Claude\ncat .claude/file-audit.log | cut -d'|' -f3 | sort -u > /tmp/claude-changes.txt\n\n# Compare with git status\ngit status --short | awk '{print $2}' > /tmp/git-changes.txt\n\n# Find uncommitted changes\ncomm -23 /tmp/claude-changes.txt /tmp/git-changes.txt\n```\n\n## Configuration Options\n\n### `enabled`\n- **Type**: `boolean`\n- **Default**: `true`\n- **Description**: Enable/disable the plugin\n\n### `auditLogPath`\n- **Type**: `string`\n- **Default**: `.claude/file-audit.log`\n- **Description**: Path to audit log file (relative to project root)\n\n### `gitIntegration`\n- **Type**: `boolean`\n- **Default**: `false`\n- **Description**: Enable git integration (experimental)\n\n## Performance\n\nFile auditor has minimal performance impact:\n- **Per file operation**: <1ms overhead\n- **Disk I/O**: Append-only writes (very fast)\n- **Memory**: Tracks only current session in memory\n\n## Troubleshooting\n\n**Q: No audit log appearing?**\n\n1. Check `.claude/settings.json` has PostToolUse hook registered\n2. Restart Claude Code\n3. Verify log directory exists: `mkdir -p .claude`\n\n**Q: Audit log too large?**\n\nRotate logs periodically:\n\n```bash\n# Archive old logs\nmv .claude/file-audit.log .claude/file-audit-$(date +%Y%m%d).log\ngzip .claude/file-audit-*.log\n\n# Or truncate after analysis\n: > .claude/file-audit.log\n```\n\n**Q: Missing some file changes?**\n\nThe plugin only tracks Claude Code file operations (Write, Edit, MultiEdit). Manual file edits or changes from other tools won't appear in the audit log.\n\n## License\n\nMIT\n",
        ".claude-plugin/plugins/real-time-dashboard/README.md": "# Real-Time Dashboard Plugin\n\nStream events to a live web dashboard via SSE. Monitor Claude Code sessions in real-time with a beautiful web interface.\n\n## Features\n\n- üì° **Real-Time Streaming** - Server-Sent Events (SSE) for live updates\n- üåê **Web Dashboard** - Beautiful web interface included\n- üìä **Live Metrics** - See prompts, tool usage, and token counts in real-time\n- üîÑ **Multi-Session Support** - Monitor multiple Claude instances simultaneously\n- üé® **Visual Indicators** - Color-coded events and activity timeline\n\n## Installation\n\n### Step 1: Install the Plugin\n\n```bash\n/plugin install real-time-dashboard\n```\n\n### Step 2: Register Hooks (REQUIRED)\n\nAdd to `.claude/settings.json`:\n\n```json\n{\n  \"hooks\": {\n    \"UserPromptSubmit\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/real-time-dashboard/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"PostToolUse\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/real-time-dashboard/hook.ts\"\n          }\n        ]\n      }\n    ],\n    \"Stop\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/real-time-dashboard/hook.ts\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Step 3: Configure (Optional)\n\nCreate or edit `.claude-plugin/config.json`:\n\n```json\n{\n  \"real-time-dashboard\": {\n    \"enabled\": true,\n    \"port\": 3001,\n    \"path\": \"/events\",\n    \"cors\": true\n  }\n}\n```\n\n### Step 4: Restart Claude Code\n\nHooks only load at startup.\n\n## Usage\n\n### Start Claude Code\n\nWhen you start Claude Code with the plugin enabled, you'll see:\n\n```\n[real-time-dashboard] üì° Dashboard streaming on http://localhost:3001/events\n[real-time-dashboard] üåê Open dashboard: http://localhost:3001/dashboard\n```\n\n### Open the Dashboard\n\nOpen your browser to:\n\n```\nhttp://localhost:3001/dashboard\n```\n\nYou'll see a live-updating dashboard showing:\n- User prompts as they're submitted\n- Tool usage in real-time\n- Token counts for each turn\n- Activity timeline\n\n### Dashboard Features\n\nThe dashboard displays:\n\n**Event Feed**\n- üë§ User prompts (truncated to 100 chars)\n- üîß Tool usage (tool name)\n- ü§ñ Assistant responses (token count)\n\n**Activity Timeline**\n- Visual timeline of events\n- Color-coded by event type\n- Timestamps for each event\n\n**Session Info**\n- Current session count\n- Total events received\n- Connection status\n\n## Configuration Options\n\n### `enabled`\n- **Type**: `boolean`\n- **Default**: `true`\n- **Description**: Enable/disable the plugin\n\n### `port`\n- **Type**: `number`\n- **Default**: `3001`\n- **Description**: HTTP server port for dashboard and SSE endpoint\n\n**Note**: Choose a different port if 3001 is already in use:\n```json\n{\n  \"real-time-dashboard\": {\n    \"port\": 3002\n  }\n}\n```\n\n### `path`\n- **Type**: `string`\n- **Default**: `/events`\n- **Description**: SSE endpoint path\n\n### `cors`\n- **Type**: `boolean`\n- **Default**: `true`\n- **Description**: Enable CORS for cross-origin access\n\n**When to disable**: If dashboard is served from same origin as SSE endpoint\n**When to enable**: If dashboard is hosted separately (different port/domain)\n\n## SSE Event Format\n\nEvents are streamed in Server-Sent Events format:\n\n```\nevent: message\ndata: {\"type\":\"user-prompt\",\"prompt\":\"Fix the authentication bug\",\"timestamp\":1700000000000}\n\nevent: message\ndata: {\"type\":\"tool-use\",\"tool\":\"Read\",\"timestamp\":1700000000100}\n\nevent: message\ndata: {\"type\":\"stop\",\"tokens\":1234,\"timestamp\":1700000000500}\n```\n\n### Event Types\n\n**user-prompt**\n```json\n{\n  \"type\": \"user-prompt\",\n  \"prompt\": \"First 100 characters of prompt...\",\n  \"timestamp\": 1700000000000\n}\n```\n\n**tool-use**\n```json\n{\n  \"type\": \"tool-use\",\n  \"tool\": \"Read\",\n  \"timestamp\": 1700000000100\n}\n```\n\n**stop**\n```json\n{\n  \"type\": \"stop\",\n  \"tokens\": 1234,\n  \"timestamp\": 1700000000500\n}\n```\n\n## Use Cases\n\n### Multi-Agent Development\n\nMonitor multiple Claude Code instances working on different tasks:\n\n**Terminal 1:** Backend agent\n```bash\ncd backend && claude\n```\n\n**Terminal 2:** Frontend agent\n```bash\ncd frontend && claude\n```\n\n**Browser:** Dashboard showing both agents' activity\n```\nhttp://localhost:3001/dashboard\n```\n\n### Team Collaboration\n\nShare your dashboard URL with teammates to show what Claude is working on:\n\n```bash\n# Use ngrok for public access\nngrok http 3001\n\n# Share URL with team\nhttps://abc123.ngrok.io/dashboard\n```\n\n### Debugging and Monitoring\n\nWatch Claude's thought process in real-time:\n- See which tools are being used\n- Spot patterns in prompt submissions\n- Monitor token usage per turn\n- Identify performance bottlenecks\n\n### Live Demos\n\nUse the dashboard for presentations or demos:\n- Show Claude Code in action\n- Visualize the agent's workflow\n- Display real-time metrics\n- Engage audience with live updates\n\n## Custom Dashboard\n\nYou can build your own dashboard using the SSE endpoint:\n\n```javascript\n// Connect to SSE endpoint\nconst eventSource = new EventSource('http://localhost:3001/events');\n\n// Listen for events\neventSource.onmessage = (event) => {\n  const data = JSON.parse(event.data);\n\n  switch (data.type) {\n    case 'user-prompt':\n      console.log('User:', data.prompt);\n      break;\n    case 'tool-use':\n      console.log('Tool:', data.tool);\n      break;\n    case 'stop':\n      console.log('Tokens:', data.tokens);\n      break;\n  }\n};\n\n// Handle errors\neventSource.onerror = (error) => {\n  console.error('SSE connection error:', error);\n};\n```\n\n## Advanced Usage\n\n### Integrate with Analytics\n\nCombine with `analytics-tracker` for cost + activity monitoring:\n\n```javascript\n// Subscribe to both SSE streams\nconst dashboardEvents = new EventSource('http://localhost:3001/events');\nconst analyticsEvents = new EventSource('http://localhost:3002/events');\n\n// Correlate events by timestamp\ndashboardEvents.onmessage = (e) => {\n  const event = JSON.parse(e.data);\n  if (event.type === 'stop') {\n    // Show both tokens and estimated cost\n    updateUI({ tokens: event.tokens, cost: estimateCost(event.tokens) });\n  }\n};\n```\n\n### Custom Event Types\n\nExtend the plugin to stream custom events:\n\n```typescript\n// In hook.ts\nmanager.onSessionStart(async (input) => {\n  streamer.broadcast({\n    type: 'session-start',\n    sessionId: input.session_id,\n    timestamp: Date.now(),\n  });\n});\n```\n\n### WebSocket Alternative\n\nFor bidirectional communication, switch to WebSocket:\n\n```json\n{\n  \"real-time-dashboard\": {\n    \"enabled\": true,\n    \"type\": \"websocket\",\n    \"port\": 3001\n  }\n}\n```\n\n**Note**: WebSocket support requires additional implementation in `EventStreamer`.\n\n## Security Considerations\n\n**Local Development**\n- Dashboard binds to `localhost` by default\n- Only accessible from same machine\n- No authentication required\n\n**Production/Public Access**\n- Use authentication middleware\n- Enable HTTPS/WSS\n- Restrict CORS origins\n- Use reverse proxy (nginx, Caddy)\n\nExample nginx config:\n\n```nginx\nserver {\n  listen 80;\n  server_name dashboard.example.com;\n\n  location /events {\n    proxy_pass http://localhost:3001;\n    proxy_set_header Connection '';\n    proxy_http_version 1.1;\n    chunked_transfer_encoding off;\n    proxy_buffering off;\n    proxy_cache off;\n  }\n\n  location /dashboard {\n    proxy_pass http://localhost:3001;\n  }\n}\n```\n\n## Troubleshooting\n\n**Q: Dashboard not loading?**\n\n1. Check the hook is registered in `.claude/settings.json`\n2. Restart Claude Code\n3. Verify port 3001 is not in use: `lsof -i :3001`\n4. Check console for errors: `[real-time-dashboard]` prefix\n\n**Q: Events not appearing?**\n\n1. Check browser console for SSE connection errors\n2. Verify CORS is enabled if dashboard is on different origin\n3. Check firewall settings (allow port 3001)\n\n**Q: Connection dropping?**\n\nSSE connections may timeout after 2 minutes of inactivity. The dashboard should automatically reconnect. If issues persist:\n\n1. Reduce SSE timeout in browser\n2. Send keepalive events every 30 seconds\n3. Use WebSocket instead of SSE\n\n**Q: Port already in use?**\n\nChange the port in config:\n\n```json\n{\n  \"real-time-dashboard\": {\n    \"port\": 3002\n  }\n}\n```\n\nThen access at `http://localhost:3002/dashboard`\n\n## Performance\n\n- **SSE overhead**: <1ms per event\n- **Memory**: ~10MB for event streaming server\n- **Concurrent connections**: Tested with 100+ simultaneous dashboard viewers\n- **Bandwidth**: ~1KB/event, minimal with compression\n\n## License\n\nMIT\n"
      },
      "plugins": [
        {
          "name": "skill-claude-code-hooks",
          "source": "./.claude-plugin/plugins/skill-claude-code-hooks",
          "version": "0.8.6",
          "description": "Skill: Guide for implementing Claude Code hooks - bash scripts and TypeScript patterns for all 9 hook events.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "skill",
            "hooks",
            "guide",
            "bash",
            "typescript",
            "documentation"
          ],
          "categories": [
            "bash",
            "documentation",
            "guide",
            "hooks",
            "skill",
            "typescript"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install skill-claude-code-hooks@claude-hooks-sdk"
          ]
        },
        {
          "name": "skill-claude-hooks-sdk",
          "source": "./.claude-plugin/plugins/skill-claude-hooks-sdk",
          "version": "0.8.6",
          "description": "Skill: Expert guide for using claude-hooks-sdk with HookManager, Logger, transforms, and advanced patterns.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "skill",
            "sdk",
            "typescript",
            "hookmanager",
            "transforms",
            "logger"
          ],
          "categories": [
            "hookmanager",
            "logger",
            "sdk",
            "skill",
            "transforms",
            "typescript"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install skill-claude-hooks-sdk@claude-hooks-sdk"
          ]
        },
        {
          "name": "analytics-tracker",
          "source": "./.claude-plugin/plugins/analytics-tracker",
          "version": "0.7.1",
          "description": "Automatic session cost tracking, token usage monitoring, and performance metrics. Track every dollar and token spent across all sessions.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "analytics",
            "cost-tracking",
            "tokens",
            "metrics",
            "performance"
          ],
          "categories": [
            "analytics",
            "cost-tracking",
            "metrics",
            "performance",
            "tokens"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install analytics-tracker@claude-hooks-sdk"
          ]
        },
        {
          "name": "conversation-logger",
          "source": "./.claude-plugin/plugins/conversation-logger",
          "version": "0.7.1",
          "description": "Unified conversation logging across all sessions with color-coded output. Perfect for multi-agent development and debugging.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "conversation",
            "logging",
            "multi-agent",
            "debugging",
            "color-coded"
          ],
          "categories": [
            "color-coded",
            "conversation",
            "debugging",
            "logging",
            "multi-agent"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install conversation-logger@claude-hooks-sdk"
          ]
        },
        {
          "name": "anomaly-monitor",
          "source": "./.claude-plugin/plugins/anomaly-monitor",
          "version": "0.7.1",
          "description": "Real-time anomaly detection with Slack/webhook alerts. Detect error spikes, token anomalies, and response time issues automatically.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "anomaly-detection",
            "alerts",
            "monitoring",
            "slack",
            "webhooks"
          ],
          "categories": [
            "alerts",
            "anomaly-detection",
            "monitoring",
            "slack",
            "webhooks"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install anomaly-monitor@claude-hooks-sdk"
          ]
        },
        {
          "name": "event-recorder",
          "source": "./.claude-plugin/plugins/event-recorder",
          "version": "0.7.1",
          "description": "Record all hook events to JSONL files for debugging, testing, and replay. Perfect for creating test fixtures from real sessions.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "recording",
            "debugging",
            "testing",
            "replay",
            "jsonl"
          ],
          "categories": [
            "debugging",
            "jsonl",
            "recording",
            "replay",
            "testing"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install event-recorder@claude-hooks-sdk"
          ]
        },
        {
          "name": "performance-monitor",
          "source": "./.claude-plugin/plugins/performance-monitor",
          "version": "0.7.1",
          "description": "Track response times, SLA compliance, and tool performance. Monitor p95/p99 metrics and get alerted when SLAs are breached.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "performance",
            "sla",
            "response-time",
            "monitoring",
            "metrics"
          ],
          "categories": [
            "metrics",
            "monitoring",
            "performance",
            "response-time",
            "sla"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install performance-monitor@claude-hooks-sdk"
          ]
        },
        {
          "name": "file-auditor",
          "source": "./.claude-plugin/plugins/file-auditor",
          "version": "0.7.1",
          "description": "Comprehensive file change tracking with audit trails. Track every Write, Edit, and MultiEdit operation with timestamps and session IDs.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "file-tracking",
            "audit",
            "compliance",
            "git",
            "changes"
          ],
          "categories": [
            "audit",
            "changes",
            "compliance",
            "file-tracking",
            "git"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install file-auditor@claude-hooks-sdk"
          ]
        },
        {
          "name": "real-time-dashboard",
          "source": "./.claude-plugin/plugins/real-time-dashboard",
          "version": "0.7.1",
          "description": "Stream events to a live web dashboard via SSE. Monitor Claude Code sessions in real-time with a beautiful web interface.",
          "author": {
            "name": "Herman Geldenhuys",
            "email": "hgeldenhuys@gmail.com"
          },
          "keywords": [
            "dashboard",
            "real-time",
            "sse",
            "streaming",
            "monitoring"
          ],
          "categories": [
            "dashboard",
            "monitoring",
            "real-time",
            "sse",
            "streaming"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-hooks-sdk",
            "/plugin install real-time-dashboard@claude-hooks-sdk"
          ]
        }
      ]
    },
    {
      "name": "claude-skills-marketplace",
      "version": "1.0.0",
      "description": "Official marketplace for Claude Code agent lifecycle, knowledge management, and SDLC orchestration plugins",
      "repo_full_name": "hgeldenhuys/claude-agent-lifecycle",
      "repo_url": "https://github.com/hgeldenhuys/claude-agent-lifecycle",
      "repo_description": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2025-12-06T19:43:12Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"claude-skills-marketplace\",\n  \"description\": \"Official marketplace for Claude Code agent lifecycle, knowledge management, and SDLC orchestration plugins\",\n  \"version\": \"1.0.0\",\n  \"owner\": {\n    \"name\": \"Hendrik Geldenhuys\",\n    \"url\": \"https://github.com/hgeldenhuys\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"claude-agent-lifecycle\",\n      \"description\": \"Persistent agent lifecycle management with 6 lifespans (ephemeral, turn, context, session, workflow, project)\",\n      \"version\": \"1.0.0\",\n      \"source\": \"./\",\n      \"keywords\": [\"agent-lifecycle\", \"persistent-agents\", \"workflow\", \"hooks\"]\n    },\n    {\n      \"name\": \"claude-weave\",\n      \"description\": \"11-dimensional knowledge framework with Shadow Advisor, Librarian, and Bayesian fact tracking\",\n      \"version\": \"2.1.0\",\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"hgeldenhuys/claude-weave\"\n      },\n      \"keywords\": [\"knowledge-management\", \"institutional-memory\", \"shadow-advisor\"]\n    },\n    {\n      \"name\": \"claude-loom\",\n      \"description\": \"Autonomous SDLC orchestration with workflow-scoped story execution agents\",\n      \"version\": \"2.0.0\",\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"hgeldenhuys/claude-loom\"\n      },\n      \"keywords\": [\"sdlc\", \"orchestration\", \"workflow\", \"story-execution\"]\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"claude-agent-lifecycle\",\n  \"description\": \"Persistent agent lifecycle management for Claude Code. Provides 6 agent lifespans (ephemeral, turn, context, session, workflow, project) with automatic disposal via hooks.\",\n  \"version\": \"1.0.0\",\n  \"author\": {\n    \"name\": \"Hendrik Geldenhuys\",\n    \"url\": \"https://github.com/hgeldenhuys\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/hgeldenhuys/claude-agent-lifecycle\"\n  },\n  \"license\": \"MIT\",\n  \"keywords\": [\n    \"agent-lifecycle\",\n    \"persistent-agents\",\n    \"workflow\",\n    \"session-management\",\n    \"hooks\"\n  ],\n  \"hooks\": {\n    \"Stop\": \"hooks/lifecycle-manager.ts\",\n    \"SessionEnd\": \"hooks/lifecycle-manager.ts\"\n  },\n  \"skills\": \".claude/skills/\"\n}\n",
        "README.md": "# Claude Agent Lifecycle\n\nPersistent agent lifecycle management for Claude Code. Create, resume, and dispose agents with automatic lifecycle management based on scope boundaries.\n\n## Features\n\n- **Six Agent Lifespans**: ephemeral, turn, context, session, workflow, project\n- **Automatic Disposal**: Hooks dispose agents at appropriate lifecycle events\n- **Persistent Storage**: File-based storage for session/workflow/project agents\n- **Memory Storage**: In-memory storage for ephemeral/turn/context agents\n- **Debug Mode**: Opt-in JSON logging for debugging and monitoring\n- **Hook Integration**: Uses `claude-hooks-sdk` for lifecycle event handling\n- **Claude Code Plugin**: Install via plugin marketplace with automatic hook wiring\n\n## Installation\n\n### As Claude Code Plugin (Recommended)\n\n```bash\n# Add the marketplace\n/plugin marketplace add hgeldenhuys/claude-agent-lifecycle\n\n# Install the plugin (hooks auto-wired)\n/plugin install claude-agent-lifecycle\n```\n\n### As npm Package\n\n```bash\n# Install the package\nbun add claude-agent-lifecycle\n\n# Run the installer to set up hooks\nbun scripts/install.ts\n```\n\n### Related Plugins\n\nThis plugin is the base for:\n- **[claude-weave](https://github.com/hgeldenhuys/claude-weave)** - 11D knowledge framework with Shadow Advisor\n- **[claude-loom](https://github.com/hgeldenhuys/claude-loom)** - SDLC orchestration with workflow agents\n\nInstall the full stack:\n```bash\n/plugin install claude-loom  # Installs all dependencies\n```\n\n## Quick Start\n\n```typescript\nimport { AgentRegistry } from '@anthropic/claude-agent-lifecycle';\n\nconst registry = new AgentRegistry();\n\n// Create a session-scoped agent\nconst { agent, isNew } = await registry.create({\n  lifespan: 'session',\n  name: 'shadow-advisor',\n  model: 'haiku',\n});\n\n// Resume later in the session\nconst shadow = await registry.resume('shadow-advisor');\n\n// Start a workflow-scoped agent\nconst executor = await registry.startWorkflow({\n  lifespan: 'workflow',\n  workflowId: 'FEAT-001',\n  name: 'story-executor',\n  model: 'sonnet',\n});\n\n// Complete workflow (disposes all workflow agents)\nawait registry.completeWorkflow('FEAT-001');\n```\n\n## Agent Lifespans\n\n| Lifespan | Scope | Auto-Disposal | Storage |\n|----------|-------|---------------|---------|\n| `ephemeral` | Single use | Immediately | Memory |\n| `turn` | Response cycle | Stop event | Memory |\n| `context` | Until compaction | Context reset | Memory |\n| `session` | Claude session | SessionEnd event | File |\n| `workflow` | Bounded work unit | Manual/complete | File |\n| `project` | Indefinite | Manual only | File |\n\n### Lifespan Details\n\n**ephemeral**: Fire-and-forget agents. Created, used once, and discarded.\n\n**turn**: Lives for one request-response cycle. Disposed when the assistant's response completes (Stop event).\n\n**context**: Lives until context window compaction. Useful for agents that should survive multiple turns but reset when context is cleared.\n\n**session**: Lives for the entire Claude Code session. Disposed when the session ends (SessionEnd event).\n\n**workflow**: Lives for a bounded unit of work (story, feature, task). Explicitly completed when work is done. Generic pattern - Loom uses this for stories.\n\n**project**: Lives indefinitely in the project. Must be manually disposed. Useful for singleton agents like Shadow Advisor.\n\n## API Reference\n\n### AgentRegistry\n\n```typescript\nconst registry = new AgentRegistry(options?: RegistryOptions);\n\ninterface RegistryOptions {\n  storagePath?: string;  // Default: '.agent/agents'\n  debug?: boolean;       // Enable debug logging\n}\n```\n\n#### Methods\n\n**create(config)**: Create or resume an agent\n```typescript\nconst { agent, isNew } = await registry.create({\n  lifespan: 'session',\n  name: 'my-agent',\n  sessionId: 'optional-session-id',\n  model: 'haiku', // optional\n  metadata: {},   // optional\n});\n```\n\n**resume(name, scope?)**: Resume an existing agent by name\n```typescript\nconst agent = await registry.resume('my-agent');\n```\n\n**dispose(agentId)**: Dispose a specific agent\n```typescript\nawait registry.dispose(agent.agentId);\n```\n\n**disposeByLifespan(lifespan)**: Dispose all agents of a lifespan type\n```typescript\nconst count = await registry.disposeByLifespan('turn');\n```\n\n**disposeByScope(scope)**: Dispose all agents in a scope\n```typescript\nconst count = await registry.disposeByScope('session-123');\n```\n\n**list(filter?)**: List agents matching a filter\n```typescript\nconst agents = await registry.list({ lifespan: 'session' });\n```\n\n### Workflow Methods\n\n**startWorkflow(config)**: Start a workflow-scoped agent\n```typescript\nconst agent = await registry.startWorkflow({\n  lifespan: 'workflow',\n  workflowId: 'FEAT-001',\n  name: 'executor',\n  workflowType: 'loom-story', // optional\n});\n```\n\n**completeWorkflow(workflowId)**: Complete a workflow and dispose its agents\n```typescript\nconst disposed = await registry.completeWorkflow('FEAT-001');\n```\n\n**getWorkflowAgents(workflowId)**: Get all agents for a workflow\n```typescript\nconst agents = await registry.getWorkflowAgents('FEAT-001');\n```\n\n## Hook Configuration\n\nHooks are automatically installed by the installer. They can also be manually configured:\n\n### Default Mode (Silent)\n\n```json\n{\n  \"hooks\": {\n    \"Stop\": [{\n      \"matcher\": \"*\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.agent/hooks/lifecycle-manager.ts\"\n      }]\n    }],\n    \"SessionEnd\": [{\n      \"matcher\": \"*\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.agent/hooks/lifecycle-manager.ts\"\n      }]\n    }]\n  }\n}\n```\n\n### Debug Mode\n\nEnable debug logging for troubleshooting:\n\n**Option 1: Environment Variable**\n```bash\nexport AGENT_LIFECYCLE_DEBUG=true\n```\n\n**Option 2: Command Flag**\n```json\n{\n  \"hooks\": {\n    \"Stop\": [{\n      \"matcher\": \"*\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"bun \\\"$CLAUDE_PROJECT_DIR\\\"/.agent/hooks/lifecycle-manager.ts --debug\"\n      }]\n    }]\n  }\n}\n```\n\n**Option 3: Per-Session**\n```bash\nAGENT_LIFECYCLE_DEBUG=true claude\n```\n\n### Debug Log Output\n\nWhen debug mode is enabled:\n\n**Console Output:**\n```\n[agent-lifecycle] SessionStart: abc-123 (source: new)\n[agent-lifecycle] Active agents: shadow-advisor(session), helper(turn)\n[agent-lifecycle] Stop: Disposed 1 turn-scoped agents\n[agent-lifecycle] SessionEnd: Disposed 2 agents for session abc-123\n```\n\n**File Output (JSON Lines):**\n```json\n{\"event\":\"agent:created\",\"timestamp\":\"2025-01-01T00:00:00Z\",\"agentId\":\"uuid\",\"agentName\":\"shadow\",\"lifespan\":\"session\",\"scope\":\"abc-123\"}\n{\"event\":\"agent:disposed\",\"timestamp\":\"2025-01-01T00:05:00Z\",\"agentId\":\"uuid\",\"agentName\":\"shadow\",\"lifespan\":\"session\",\"scope\":\"abc-123\"}\n```\n\nLog file location: `.agent/agents/lifecycle.log`\n\n## Storage Structure\n\n```\n.agent/\n‚îú‚îÄ‚îÄ agents/\n‚îÇ   ‚îú‚îÄ‚îÄ lifecycle.log      # Debug logs (when enabled)\n‚îÇ   ‚îú‚îÄ‚îÄ session/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {session-id}/\n‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ {agent-name}.json\n‚îÇ   ‚îú‚îÄ‚îÄ workflow/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {workflow-id}/\n‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ {agent-name}.json\n‚îÇ   ‚îî‚îÄ‚îÄ project/\n‚îÇ       ‚îî‚îÄ‚îÄ {agent-name}.json\n‚îî‚îÄ‚îÄ hooks/\n    ‚îî‚îÄ‚îÄ lifecycle-manager.ts\n```\n\n## Integration Examples\n\n### Shadow Advisor Pattern\n\n```typescript\nimport { AgentRegistry } from '@anthropic/claude-agent-lifecycle';\n\nconst registry = new AgentRegistry();\n\n// Create or resume shadow advisor for the session\nconst { agent: shadow, isNew } = await registry.create({\n  lifespan: 'session',\n  name: 'shadow-advisor',\n  model: 'haiku',\n  metadata: {\n    role: 'knowledge-retrieval',\n    preloadedKnowledge: ['weave', 'librarian'],\n  },\n});\n\nif (isNew) {\n  console.log('Created new shadow advisor');\n} else {\n  console.log(`Resumed shadow advisor (turn ${shadow.turnCount})`);\n}\n```\n\n### Loom Workflow Integration\n\n```typescript\nimport { AgentRegistry } from '@anthropic/claude-agent-lifecycle';\n\nconst registry = new AgentRegistry();\n\n// Start story execution\nconst executor = await registry.startWorkflow({\n  lifespan: 'workflow',\n  workflowId: 'ACCT-001',\n  name: 'story-executor',\n  workflowType: 'loom-story',\n  model: 'sonnet',\n});\n\n// Additional helpers for the workflow\nawait registry.startWorkflow({\n  lifespan: 'workflow',\n  workflowId: 'ACCT-001',\n  name: 'backend-dev',\n  model: 'sonnet',\n});\n\n// When story is complete\nawait registry.completeWorkflow('ACCT-001');\n// All workflow agents disposed\n```\n\n### Custom Cleanup\n\n```typescript\nimport { AgentRegistry } from '@anthropic/claude-agent-lifecycle';\n\nconst registry = new AgentRegistry();\n\n// Dispose all agents for a custom scope\nawait registry.disposeByScope('my-custom-scope');\n\n// Dispose specific lifespan\nawait registry.disposeByLifespan('context');\n```\n\n## Development\n\n```bash\n# Install dependencies\nbun install\n\n# Run tests\nbun test\n\n# Run unit tests only\nbun test tests/unit/\n\n# Run integration tests only\nbun test tests/integration/\n```\n\n## License\n\nMIT\n"
      },
      "plugins": [
        {
          "name": "claude-agent-lifecycle",
          "description": "Persistent agent lifecycle management with 6 lifespans (ephemeral, turn, context, session, workflow, project)",
          "version": "1.0.0",
          "source": "./",
          "keywords": [
            "agent-lifecycle",
            "persistent-agents",
            "workflow",
            "hooks"
          ],
          "categories": [
            "agent-lifecycle",
            "hooks",
            "persistent-agents",
            "workflow"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-agent-lifecycle",
            "/plugin install claude-agent-lifecycle@claude-skills-marketplace"
          ]
        },
        {
          "name": "claude-weave",
          "description": "11-dimensional knowledge framework with Shadow Advisor, Librarian, and Bayesian fact tracking",
          "version": "2.1.0",
          "source": {
            "source": "github",
            "repo": "hgeldenhuys/claude-weave"
          },
          "keywords": [
            "knowledge-management",
            "institutional-memory",
            "shadow-advisor"
          ],
          "categories": [
            "institutional-memory",
            "knowledge-management",
            "shadow-advisor"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-agent-lifecycle",
            "/plugin install claude-weave@claude-skills-marketplace"
          ]
        },
        {
          "name": "claude-loom",
          "description": "Autonomous SDLC orchestration with workflow-scoped story execution agents",
          "version": "2.0.0",
          "source": {
            "source": "github",
            "repo": "hgeldenhuys/claude-loom"
          },
          "keywords": [
            "sdlc",
            "orchestration",
            "workflow",
            "story-execution"
          ],
          "categories": [
            "orchestration",
            "sdlc",
            "story-execution",
            "workflow"
          ],
          "install_commands": [
            "/plugin marketplace add hgeldenhuys/claude-agent-lifecycle",
            "/plugin install claude-loom@claude-skills-marketplace"
          ]
        }
      ]
    }
  ]
}