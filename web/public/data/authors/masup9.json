{
  "author": {
    "id": "masuP9",
    "display_name": "Soichi Masuda",
    "avatar_url": "https://avatars.githubusercontent.com/u/6724665?u=947bd807373b1797dc5b85b3520a522bee5fe9dd&v=4"
  },
  "marketplaces": [
    {
      "name": "codex-collab",
      "version": null,
      "description": "Claude Code と OpenAI Codex CLI の協調タスク実行プラグイン",
      "repo_full_name": "masuP9/codex-collab",
      "repo_url": "https://github.com/masuP9/codex-collab",
      "repo_description": "Claude Code と OpenAI Codex CLI を協調させてタスクを実行するプラグイン",
      "signals": {
        "stars": 2,
        "forks": 0,
        "pushed_at": "2026-02-04T16:01:16Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"codex-collab\",\n  \"owner\": {\n    \"name\": \"masuP9\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"codex-collab\",\n      \"source\": \"./\",\n      \"description\": \"Claude Code と OpenAI Codex CLI の協調タスク実行プラグイン\",\n      \"version\": \"0.23.1\",\n      \"author\": {\n        \"name\": \"masuP9\"\n      }\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"codex-collab\",\n  \"version\": \"0.23.1\",\n  \"description\": \"Claude Code と OpenAI Codex CLI の協調タスク実行プラグイン\",\n  \"author\": {\n    \"name\": \"masuP9\"\n  },\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"prompt\",\n            \"prompt\": \"You are about to execute a Bash command. Check if this command involves codex-collab helper functions.\\n\\n## Skill Context Detection\\n\\nFirst check if we are in skill context by looking for `export CODEX_SKILL_CONTEXT=1` in the command.\\n\\n**If skill context detected**: Allow all Bash commands to proceed without blocking.\\n\\n## Detection Patterns (only when NOT in skill context)\\n\\nCheck if the command contains:\\n1. Helper function calls: `codex_find_pane`, `codex_send_prompt`, `codex_wait_completion`, etc.\\n2. Sourcing helpers: `source.*codex-helpers.sh`\\n3. Codex-collab variables: `CODEX_PANE`, `CODEX_PROMPT`, `ATTACHED_PANE`\\n\\n## Response\\n\\n**If patterns detected AND not in skill context**: Block and suggest using `/collab-codex [task]` instead.\\n\\n**If no patterns OR in skill context**: Allow silently.\\n\\nCommand to evaluate: $ARGUMENTS\"\n          }\n        ]\n      }\n    ]\n  }\n}\n",
        "README.md": "# codex-collab\n\nClaude Code と OpenAI Codex CLI を協調させてタスクを実行するプラグイン。\n\n## 概要\n\nこのプラグインは、Claude Code と Codex の強みを組み合わせた協調ワークフローを提供します。\n\n**基本パターン（レビュー型）:**\n- **Codex**: 計画作成・コードレビュー\n- **Claude Code**: 実装\n\n## インストール\n\n```bash\n# マーケットプレイスを追加\n/plugin marketplace add https://github.com/masuP9/codex-collab\n\n# プラグインをインストール\n/plugin install codex-collab@codex-collab\n```\n\n## 前提条件\n\n- OpenAI Codex CLI (`codex`) がインストールされていること\n- 環境変数 `OPENAI_API_KEY` が設定されていること\n- WSL環境: Windows Terminal (`wt.exe`) が利用可能であること（リアルタイム出力確認用）\n- オプション: tmuxセッション内で作業している場合、フォーカスを奪わずにCodexを実行可能\n- オプション: `jq` (セッション状態管理に使用。未インストールの場合は毎回新規セッションとして扱う)\n\n## セットアップ\n\n### tmux セッションの起動（推奨）\n\ntmux モードを使用する場合、**絶対パス**でソケットを指定して起動することを推奨します：\n\n```bash\n# プロジェクトディレクトリで実行\ntmux -S \"$(pwd)/collab.sock\" new -s collab\n```\n\n**なぜ絶対パスが推奨されるか:**\n- `tmux -S ./collab.sock` のような相対パスで起動すると、サブディレクトリからの実行時に問題が発生する可能性があります\n- 絶対パスなら、どのディレクトリから実行しても確実にソケットを見つけられます\n\n> **Note:** v0.20.1 以降では、相対パスで起動した場合も親ディレクトリを遡って自動検索しますが、絶対パスでの起動が最も確実です。\n\n### 環境変数での指定\n\ntmux ソケットを明示的に指定したい場合は、環境変数 `CODEX_TMUX_SOCKET` を設定できます：\n\n```bash\nexport CODEX_TMUX_SOCKET=\"/path/to/your/project/collab.sock\"\n```\n\nこの環境変数が設定されている場合、`$TMUX` からの自動検出より優先されます。\n\n## プロジェクト構造\n\n```\ncodex-collab/\n├── .claude-plugin/\n│   └── plugin.json         # プラグインメタデータ\n├── commands/\n│   ├── collab-codex.md     # /collab-codex コマンド\n│   ├── strong-inference.md # /strong-inference コマンド\n│   └── devils-advocate.md  # /devils-advocate コマンド\n├── scripts/\n│   └── codex-helpers.sh    # 共通ヘルパー関数\n└── skills/\n    ├── codex-collaboration/\n    │   └── references/     # プロトコル定義\n    ├── strong-inference/\n    │   └── references/     # 仮説テンプレート\n    └── devils-advocate/\n        └── references/     # 評価基準\n```\n\n### ヘルパースクリプト\n\n`scripts/codex-helpers.sh` には、コマンド間で共有される関数が定義されています:\n\n**コア関数:**\n- `codex_find_pane()` - Codexペイン検出（保存ID + 自動検出）\n- `codex_verify_pane()` - ペインのヘルスチェック（存在・セッション・プロセス確認）\n- `codex_get_or_create_pane()` - 既存ペインの検出または新規作成\n- `codex_send_prompt_file()` - ファイル参照によるプロンプト送信（長いプロンプト向け）\n- `codex_send_prompt_chunked()` - 分割送信によるプロンプト送信（長いプロンプトの安定送信向け）\n- `codex_wait_completion()` - マーカー + アイドル検出による完了待機\n- `codex_capture_output()` - ペイン出力のキャプチャ\n- `codex_check_tmux()` - tmuxセッション確認\n- `codex_ensure_tmp_dir()` - 一時ディレクトリ管理\n- `codex_get_language_directive()` - 言語指示生成\n\n**ユーティリティ関数:**\n- `codex_hash_content()` - クロスプラットフォームハッシュ計算\n- `codex_acquire_lock()` - 排他ロック取得（同時送信の競合防止）\n- `codex_release_lock()` - ロック解放\n- `codex_generate_signal()` - ユニークシグナル生成\n\n**メタデータ抽出:**\n- `codex_extract_metadata()` - 応答末尾のYAMLブロックを抽出\n- `codex_get_status()` - status フィールド取得（continue/stop）\n- `codex_get_verdict()` - verdict フィールド取得（pass/conditional/fail）\n\n各コマンドは自動的にヘルパーをsourceします。\n\n## 使い方\n\n### `/collab-codex` コマンド\n\n協調ワークフローを開始します。\n\n```\n/collab-codex 新しい認証機能を実装して\n```\n\n**自動検出機能 (tmuxモード):**\n- tmuxセッション内で実行時、既存のCodexペインを自動検出・再利用\n- ペインがなければ新規起動し、`tmp/codex-pane-id`に保存\n- 複数のCodexペインがある場合は最初のペインを使用（警告を表示）\n- 会話コンテキストが維持されるため、継続的な協調作業が可能\n\n### `/strong-inference` コマンド\n\nStrong Inference（強い推論）メソッドを使って、仮説駆動でバグ調査を行います。\n\n```\n# 基本的な使い方\n/strong-inference APIが時々500エラーを返す\n\n# モード指定\n/strong-inference --mode claude-only テストがフレーキーな原因を調べて\n```\n\n**特徴:**\n- 2-4個の競合仮説を生成\n- 各仮説を排除する「キラー実験」を設計\n- 仮説ツリーを `tmp/strong-inference/` に保存（調査状態を永続化）\n- tmuxモードではCodexが仮説生成、Claudeが検証実行\n\n### `/devils-advocate` コマンド\n\nDevil's Advocate（悪魔の代弁者）メソッドを使って、設計案や仮説をストレステストします。\n\n```\n# 基本的な使い方\n/devils-advocate このキャッシュ設計を検証して\n\n# モード指定\n/devils-advocate --mode claude-only マイクロサービス移行は妥当か\n\n# ラウンド数指定\n/devils-advocate --max-rounds 5 この認証設計\n```\n\n**特徴:**\n- Blue Team（提案側）vs Red Team（批判側）の構造化議論\n- 3ラウンド（デフォルト）の反論・再反論\n- 最終評価: APPROVE / CONDITIONAL / REJECT\n- tmuxモードではCodexがRed Team、ClaudeがBlue Team\n- 議論ログを `tmp/devils-advocate/` に保存\n\n### スキルの自動起動\n\n以下のようなリクエストで自動的にスキルが有効になります:\n- 「Codexと協調してタスクを実行したい」\n- 「Codexにレビューを依頼して」\n- 「Codexに計画を作成させたい」\n- 「このバグの原因を調査して」（Strong Inferenceスキル）\n- 「仮説を立てて検証して」（Strong Inferenceスキル）\n- 「この設計を批判的にレビューして」（Devil's Advocateスキル）\n- 「反論をもらいたい」（Devil's Advocateスキル）\n\n### Strong Inference vs Devil's Advocate の使い分け\n\n両スキルは目的が異なります。以下のガイドを参考にしてください。\n\n#### ユースケース別の推奨スキル\n\n| ユースケース | 推奨スキル | 理由 |\n|-------------|-----------|------|\n| バグの原因調査 | `/strong-inference` | 競合仮説を立て、実験で排除 |\n| パフォーマンス問題の調査 | `/strong-inference` | 原因を絞り込む検証が必要 |\n| なぜ動かないか分からない | `/strong-inference` | 未知の原因を特定する |\n| 設計案のレビュー | `/devils-advocate` | 反論を通じて弱点を発見 |\n| アーキテクチャ決定の検証 | `/devils-advocate` | 議論で合意形成 |\n| リスク評価 | `/devils-advocate` | 批判的視点で穴を見つける |\n| PRのコードレビュー | `/collab-codex` | 実装済みコードの品質確認 |\n\n#### 判断が難しいケース\n\n**「仮説を検証したい」と言われたら？**\n- 原因不明の問題 → `/strong-inference`（実験で仮説を排除）\n- 設計案の妥当性 → `/devils-advocate`（議論で仮説を強化）\n\n**「レビューしてほしい」と言われたら？**\n- 実装済みコード → `/collab-codex`（品質チェック）\n- 設計案・提案 → `/devils-advocate`（批判的検証）\n\n#### 簡単な見分け方\n\n```\n「なぜ？」「原因は？」 → /strong-inference\n「これで良いか？」「弱点は？」 → /devils-advocate\n「実装をチェック」 → /collab-codex\n```\n\n## 設定\n\nプロジェクト固有の設定は `.claude/codex-collab.local.md` に記述できます。\n\n```markdown\n---\nmodel: o4-mini\nsandbox: read-only\n---\n\n# プロジェクト固有の指示\n\nこのプロジェクトでは TypeScript を使用しています。\n```\n\n### 設定オプション\n\n| オプション | デフォルト | 説明 |\n|-----------|-----------|------|\n| `model` | (Codexデフォルト) | 使用するモデル (o3, o4-mini等) |\n| `sandbox` | `read-only` | サンドボックスモード (read-only, workspace-write, danger-full-access) |\n| `launch.mode` | `auto` | 起動モード (auto, tmux, wt, inline)。autoはtmuxセッション内ならtmux、そうでなければwt→inline |\n| `exchange.enabled` | `true` | Planning exchangeのグローバルキルスイッチ |\n| `exchange.max_iterations` | `3` | Planning exchangeの最大ラウンド数 |\n| `exchange.user_confirm` | `on_important` | ユーザー確認タイミング (never, always, on_important) |\n| `exchange.history_mode` | `summarize` | 履歴管理方式: full=全履歴保持, summarize=最新2ラウンドのみ全文 |\n| `review.enabled` | `true` | Review iterationの有効化 |\n| `review.max_iterations` | `5` | Review iterationの最大ラウンド数（ゴールが明確なので多め） |\n| `review.user_confirm` | `never` | レビュー時は自動でイテレーション |\n\n### Launch Mode について\n\nCodexの起動方法を選択できます:\n\n| モード | 説明 | フォーカス奪取 | 完了検知 |\n|--------|------|---------------|---------|\n| `tmux` | 現在のペインを分割してCodexを実行（右側に表示） | なし | マーカー + アイドル検出 |\n| `wt` | Windows Terminalの新しいペインで実行 | あり | ファイルポーリング |\n| `inline` | 現在のターミナルで実行（ブロッキング） | - | ファイルポーリング |\n| `auto` | tmuxセッション内ならtmux、そうでなければwt→inline | 状況による | モードに依存 |\n\n> **Note:** tmuxモードは現在のペインを水平分割し、右側でCodexを実行します。完了検出にはマーカー検出とアイドル検出を組み合わせたポーリング方式を使用します。\n\n### 設定の優先順位\n\n```\nコマンド引数 > プロジェクト設定 > グローバル設定 > 安全デフォルト\n```\n\n## ワークフロー\n\n```\n1. ユーザー: /collab \"機能Xを実装して\"\n2. Claude Code: タスク分析・Codex向けプロンプト作成\n3. Codex: 計画作成\n4. Claude Code: 計画確認・実装\n5. Codex: レビュー（Pass/Fail/Conditional）\n6. Claude Code: 修正（必要に応じて）・完了報告\n```\n\n## 軽量メタデータプロトコル\n\nClaude Code と Codex CLI 間の議論をサポートする軽量なメタデータ形式を採用しています。\n\n### 設計思想\n\n- **本文は自然言語のまま**: LLM の表現力を制限しない\n- **メタデータは末尾に付加**: 応答の最後に YAML ブロックとして追加\n- **フォールバック可能**: メタデータがなくても本文は読める\n\n### メタデータ形式\n\n応答の末尾に `---` で囲まれた YAML ブロックを付加：\n\n```markdown\n（自然言語の応答本文）\n\n...議論や説明...\n\n---\nstatus: stop\nverdict: conditional\nopen_questions:\n  - 認証方式の選択\nfindings:\n  - severity: medium\n    message: 入力バリデーションが不足\n---\n```\n\n### フィールド一覧\n\n| フィールド | 型 | 説明 |\n|-----------|-----|------|\n| `status` | enum | `continue` / `stop` - 議論を続けるか終了するか |\n| `verdict` | enum | `pass` / `conditional` / `fail` - レビュー判定 |\n| `open_questions` | list | 未解決の質問 |\n| `decisions` | list | 合意した決定事項 |\n| `findings` | list | 発見事項（severity, message） |\n\n### 使用例\n\n**レビュー応答:**\n\n```markdown\nコードを確認しました。全体的に良い実装ですが、改善点があります。\n\n1. `validate_input()` で空文字列のチェックが抜けています\n2. エラーメッセージがハードコードされています\n\n---\nstatus: stop\nverdict: conditional\nfindings:\n  - severity: medium\n    message: validate_input() で空文字列チェックが不足\n  - severity: low\n    message: エラーメッセージのハードコード\n---\n```\n\n**議論応答（継続）:**\n\n```markdown\n認証方式について検討しました。JWT と Session の両方に利点がありますが...\n\nいくつか確認したい点があります：\n- ユーザー数の想定規模は？\n- モバイルアプリからのアクセスは想定していますか？\n\n---\nstatus: continue\nopen_questions:\n  - ユーザー規模の想定\n  - モバイルアプリ対応の有無\ndecisions:\n  - REST API で実装する\n---\n```\n\n### 関連ファイル\n\n詳細な仕様は `skills/codex-collaboration/references/` にあります：\n\n- `lightweight-metadata.md` - 軽量メタデータプロトコル仕様\n- `planning-prompt.md` - 計画依頼テンプレート\n- `review-prompt.md` - レビュー依頼テンプレート\n- `deprecated/` - 旧構造化プロトコル（参考用）\n\n## ライセンス\n\nMIT\n"
      },
      "plugins": [
        {
          "name": "codex-collab",
          "source": "./",
          "description": "Claude Code と OpenAI Codex CLI の協調タスク実行プラグイン",
          "version": "0.23.1",
          "author": {
            "name": "masuP9"
          },
          "categories": [],
          "install_commands": [
            "/plugin marketplace add masuP9/codex-collab",
            "/plugin install codex-collab@codex-collab"
          ]
        }
      ]
    }
  ]
}