{
  "author": {
    "id": "harperreed",
    "display_name": "Harper Reed",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/18504?v=4",
    "url": "https://github.com/harperreed",
    "bio": "A normal person doing normal things.",
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 1,
      "total_commands": 3,
      "total_skills": 4,
      "total_stars": 3,
      "total_forks": 0
    }
  },
  "marketplaces": [
    {
      "name": "office.harper.dev",
      "version": null,
      "description": "Office productivity plugin for Claude Code - email, calendar, and CRM management",
      "owner_info": {
        "name": "Harper Reed",
        "url": "https://harper.dev"
      },
      "keywords": [],
      "repo_full_name": "harperreed/office-admin-claude",
      "repo_url": "https://github.com/harperreed/office-admin-claude",
      "repo_description": null,
      "homepage": null,
      "signals": {
        "stars": 3,
        "forks": 0,
        "pushed_at": "2025-12-04T03:21:46Z",
        "created_at": "2025-12-04T03:00:57Z",
        "license": "MIT"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 295
        },
        {
          "path": ".claude-plugin/plugin.json",
          "type": "blob",
          "size": 517
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 9954
        },
        {
          "path": "commands",
          "type": "tree",
          "size": null
        },
        {
          "path": "commands/draft-email.md",
          "type": "blob",
          "size": 2292
        },
        {
          "path": "commands/setup-office-admin.md",
          "type": "blob",
          "size": 148
        },
        {
          "path": "commands/triage-email.md",
          "type": "blob",
          "size": 1357
        },
        {
          "path": "mcp-servers",
          "type": "tree",
          "size": null
        },
        {
          "path": "mcp-servers/README.md",
          "type": "blob",
          "size": 7816
        },
        {
          "path": "skills",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/calendar-management",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/calendar-management/SKILL.md",
          "type": "blob",
          "size": 10131
        },
        {
          "path": "skills/crm-management",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/crm-management/SKILL.md",
          "type": "blob",
          "size": 11245
        },
        {
          "path": "skills/email-management",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/email-management/SKILL.md",
          "type": "blob",
          "size": 10893
        },
        {
          "path": "skills/onboarding",
          "type": "tree",
          "size": null
        },
        {
          "path": "skills/onboarding/SKILL.md",
          "type": "blob",
          "size": 5606
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"office.harper.dev\",\n  \"owner\": {\n    \"name\": \"Harper Reed\",\n    \"url\": \"https://harper.dev\"\n  },\n  \"description\": \"Office productivity plugin for Claude Code - email, calendar, and CRM management\",\n  \"plugins\": [\n    {\n      \"name\": \"office-admin\",\n      \"source\": \"./\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"office-admin\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Office Admin - A comprehensive productivity plugin for email management, CRM, and calendar handling with customizable personal style\",\n  \"author\": {\n    \"name\": \"Harper Reed\",\n    \"url\": \"https://github.com/harperreed\"\n  },\n  \"repository\": \"https://github.com/harperreed/office-admin-claude\",\n  \"keywords\": [\n    \"productivity\",\n    \"email\",\n    \"calendar\",\n    \"crm\",\n    \"personal-assistant\",\n    \"mcp\",\n    \"automation\"\n  ],\n  \"license\": \"MIT\"\n}\n",
        "README.md": "# Office Admin: Claude Code Office Productivity Plugin\n\n**Office Admin** is a comprehensive productivity plugin for Claude Code that helps you manage email, calendar, and contacts in your personal style. It learns your communication preferences and handles routine tasks while maintaining your authentic voice.\n\n## Features\n\n### üìß Email Management\n- **Smart inbox triage** - Categorize emails, draft replies, extract action items\n- **Personal voice matching** - Learns your email style (tone, length, patterns)\n- **Proper threading** - Drafts appear in correct conversations\n- **Bulk processing** - Efficient handling of large inboxes via subagents\n- **Calendar integration** - Auto-detects scheduling and checks conflicts\n\n### üìÖ Calendar Management\n- **Conflict detection** - Checks availability before committing\n- **Timezone handling** - Accurate conversion for international contacts\n- **Working hours respect** - Honors your configured schedule\n- **Event extraction** - Pulls meeting details from emails automatically\n- **Tentative holds** - Creates \"HOLD\" events for pending confirmations\n\n### üë• CRM Management (Optional)\n- **Contact deduplication** - Prevents duplicate entries\n- **Company associations** - Links contacts to organizations\n- **Interaction logging** - Tracks communication history\n- **Deal tracking** - Manages business opportunities\n- **Relationship mapping** - Connects contacts to each other\n\n## Quick Start\n\n### 1. Install MCP Servers\n\nOffice Admin requires these MCP servers:\n\n**Required:**\n- Pipedream (Gmail + Google Calendar)\n\n**Optional:**\n- Pagen CRM\n\nAdd to `~/.claude/settings.json`:\n```json\n{\n  \"mcpServers\": {\n    \"pd\": {\n      \"command\": \"npx\",\n      \"args\": [\"-y\", \"@pipedream/mcp-server@latest\"]\n    }\n  }\n}\n```\n\nSee [`mcp-servers/README.md`](./mcp-servers/README.md) for detailed setup instructions.\n\n### 2. Install Office Admin Plugin\n\n```bash\n# Add the plugin marketplace\n/plugin marketplace add harperreed/office-admin-claude\n\n# Install the plugin\n/plugin install office-admin\n\n# Restart Claude Code\n```\n\n### 3. Run Onboarding\n\n```bash\n/setup-office-admin\n```\n\nThis interactive process will:\n- Ask about your email communication style\n- Configure calendar preferences\n- Set up CRM workflow (if enabled)\n- Create your personal config at `~/.claude/office-admin-config.json`\n\n### 4. Start Using\n\nTry these commands:\n```bash\n# Triage your inbox\n/triage-email\n\n# Draft a new email\n/draft-email\n\n# Or just ask naturally:\n\"Check my inbox and draft replies to anything urgent\"\n\"Add the lunch meeting from Mike's email to my calendar\"\n\"Find contact info for Jane Smith\"\n```\n\n## How It Works\n\nOffice Admin consists of four integrated skills that work together:\n\n### Skills\n\n1. **office:onboarding** - Sets up your personal style\n2. **office:email-management** - Handles email workflows\n3. **office:calendar-management** - Manages scheduling\n4. **office:crm-management** - Tracks contacts and relationships\n\nThese skills automatically activate when you perform related tasks. You don't need to explicitly invoke them - just work naturally with Claude Code.\n\n### Slash Commands\n\n- `/setup-office-admin` - Run onboarding (or update preferences)\n- `/triage-email` - Bulk inbox triage with categorization and drafts\n- `/draft-email` - Guided email composition in your style\n\n## Configuration\n\nYour config is stored at `~/.claude/office-admin-config.json`:\n\n```json\n{\n  \"version\": \"1.0\",\n  \"personal\": {\n    \"name\": \"Your Name\",\n    \"timezone\": \"America/Chicago\",\n    \"workingHours\": {\n      \"start\": \"09:30\",\n      \"end\": \"16:30\",\n      \"lunchStart\": \"12:00\",\n      \"lunchEnd\": \"13:30\"\n    }\n  },\n  \"email\": {\n    \"tone\": \"ultra-terse | conversational | professional | warm\",\n    \"signature\": \"none | minimal | full\",\n    \"formality\": \"casual | standard | formal\",\n    \"responseLength\": \"minimal | balanced | detailed\",\n    \"patterns\": [\"your\", \"common\", \"phrases\"],\n    \"customGuidelines\": \"Additional style notes...\"\n  },\n  \"calendar\": {\n    \"defaultDuration\": 30,\n    \"bufferMinutes\": 15,\n    \"schedulingLink\": \"https://your.cal.link\",\n    \"autoAddFromEmail\": true,\n    \"eventNaming\": {\n      \"includeLocation\": true,\n      \"includeAttendees\": false\n    }\n  },\n  \"crm\": {\n    \"contactTypes\": \"professional | personal | mixed\",\n    \"detailLevel\": \"minimal | standard | detailed\",\n    \"autoLogInteractions\": true,\n    \"trackRelationships\": true\n  }\n}\n```\n\nYou can edit this file directly or re-run `/setup-office-admin` to update preferences.\n\n## Example Workflows\n\n### Morning Email Routine\n\n```\nYou: /triage-email\n\nClaude: Analyzing 15 unread emails...\n\n## üìß Inbox Triage Summary\n\n### üî¥ ACTION NEEDED (3)\n1. **From:** Mike | **Subject:** Quick sync tomorrow?\n   **Summary:** Wants to schedule a call\n   **Draft:** Created - \"how about 2pm est tomorrow?\"\n\n2. **From:** Sarah | **Subject:** Project proposal review\n   **Summary:** Needs feedback by Friday\n   **Draft:** Created - \"will review by thursday and send notes\"\n\n### üìÖ CALENDAR (2)\n1. **From:** Team | **Subject:** Q1 Planning Meeting\n   **Event:** Thursday Dec 7, 10:00 AM - 11:30 AM\n   **Conflicts:** None\n   **Status:** Added to calendar\n\n### üìã ARCHIVE (10)\n...\n```\n\n### Scheduling with Conflict Detection\n\n```\nYou: Mike wants to meet for lunch on Tuesday\n\nClaude: Let me check your calendar for Tuesday...\n\nYour schedule on Tuesday, Dec 5:\n- 10:00 AM - 12:00 PM: Team standup\n- 12:00 PM - 1:30 PM: FREE (lunch window)\n- 1:30 PM - 3:00 PM: Client call\n\nYou're free for lunch from 12:00-1:30pm. Should I draft a reply and add it to your calendar?\n\nYou: yes\n\nClaude: Done! Created draft: \"that works perfect. 12:30 at soho house?\"\nAdded to calendar: \"Lunch with Mike at Soho House\" on Dec 5, 12:30-1:30 PM\n```\n\n### Adding Contact from Email\n\n```\nYou: Add Jane from that email to my CRM\n\nClaude: Checking for existing contact...\nNot found. Adding Jane Smith:\n- Email: jane@example.com\n- Company: Acme Corp\n- Note: Met via introduction from Bob. Interested in AI consulting.\n\nLogged interaction: \"Initial email exchange about AI consulting project. Scheduled call for next week.\"\n\nDone! Jane Smith added to CRM and linked to Acme Corp.\n```\n\n## Customization\n\n### Email Style Examples\n\n**Ultra-terse** (minimal communication):\n```\nthat works perfect\n\nsure\n\nunsubscribe\n```\n\n**Conversational** (casual but complete):\n```\nHey Sarah! That time works great for me.\nLooking forward to catching up.\n```\n\n**Professional** (formal, structured):\n```\nDear Ms. Johnson,\n\nThank you for reaching out regarding the proposal. I have reviewed the materials and would be happy to schedule a call at your earliest convenience.\n\nBest regards,\n[Your Name]\n```\n\n**Warm** (friendly, personal):\n```\nHi Mike!\n\nGreat to hear from you! I'd love to grab coffee next week.\nHow about Tuesday morning? I know a great spot near your office.\n\nHope you're doing well!\n[Your Name]\n```\n\nOffice Admin will match whichever style you configure.\n\n## Best Practices\n\n1. **Run onboarding first** - Sets up your preferences properly\n2. **Review drafts before sending** - Office Admin creates drafts, you send them\n3. **Use bulk triage for efficiency** - Process 10+ emails at once with `/triage-email`\n4. **Let calendar auto-add events** - Enable `autoAddFromEmail` for seamless scheduling\n5. **Keep config updated** - Re-run `/setup-office-admin` as your preferences change\n\n## Troubleshooting\n\n### \"Email drafts aren't threaded properly\"\n- Check that Gmail MCP has proper permissions\n- Verify thread ID and message ID are being captured\n- Try creating the draft manually once to test\n\n### \"Calendar events have wrong timezone\"\n- Update `timezone` in `~/.claude/office-admin-config.json`\n- Verify Google Calendar is set to same timezone\n- Re-create the event after fixing config\n\n### \"CRM not working\"\n- Check if Pagen CRM MCP server is configured (optional component)\n- Verify database is running: `psql pagen_crm -c \"SELECT 1;\"`\n- See [`mcp-servers/README.md`](./mcp-servers/README.md) for CRM setup\n\n### \"Skills not activating\"\n- Restart Claude Code completely\n- Check plugin is installed: `/plugin list`\n- Verify config exists: `cat ~/.claude/office-admin-config.json`\n\n## Development\n\nWant to contribute or customize Office Admin?\n\n```bash\n# Clone the repo\ngit clone https://github.com/harperreed/office-admin-claude.git\n\n# Create development marketplace\ncd office-admin-claude\ncat > .claude-plugin/marketplace.json <<EOF\n{\n  \"name\": \"office-admin-dev\",\n  \"plugins\": [{\"name\": \"office-admin\", \"source\": \"./\"}]\n}\nEOF\n\n# Install in dev mode\n/plugin marketplace add /path/to/office-admin-claude\n/plugin install office-admin@office-admin-dev\n\n# Make changes and test\n# Restart Claude Code after changes\n```\n\n### Plugin Structure\n\n```\noffice-admin-claude/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îú‚îÄ‚îÄ plugin.json          # Plugin manifest\n‚îÇ   ‚îî‚îÄ‚îÄ marketplace.json      # Dev marketplace config\n‚îú‚îÄ‚îÄ skills/\n‚îÇ   ‚îú‚îÄ‚îÄ onboarding.md         # Interactive setup\n‚îÇ   ‚îú‚îÄ‚îÄ email-management.md   # Email workflows\n‚îÇ   ‚îú‚îÄ‚îÄ crm-management.md     # Contact management\n‚îÇ   ‚îî‚îÄ‚îÄ calendar-management.md # Scheduling logic\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îú‚îÄ‚îÄ setup-office-admin.md # Onboarding command\n‚îÇ   ‚îú‚îÄ‚îÄ triage-email.md       # Bulk triage command\n‚îÇ   ‚îî‚îÄ‚îÄ draft-email.md        # Guided drafting command\n‚îú‚îÄ‚îÄ mcp-servers/\n‚îÇ   ‚îî‚îÄ‚îÄ README.md             # MCP setup docs\n‚îî‚îÄ‚îÄ README.md                 # This file\n```\n\n## License\n\nMIT License - See LICENSE file for details\n\n## Credits\n\nCreated by [Harper Reed](https://harper.lol)\n\nBased on patterns from the [pagen](https://github.com/harperreed/pw) productivity agent.\n\n## Support\n\n- **Issues:** https://github.com/harperreed/office-admin-claude/issues\n- **Discussions:** https://github.com/harperreed/office-admin-claude/discussions\n- **Twitter:** [@harper](https://twitter.com/harper)\n\n---\n\n**Office Admin** - *Your personal office productivity agent, in Claude Code*\n",
        "commands/draft-email.md": "Draft an email in your personal style with guided assistance. Use the office:email-management skill.\n\n**Workflow:**\n\n1. **Ask clarifying questions:**\n   - Who is this email to? (name or email address)\n   - Is this a reply to an existing email? (yes/no)\n   - What's the main purpose? (scheduling, confirming, declining, requesting, etc.)\n\n2. **If replying to existing email:**\n   - Search for the original email thread\n   - Get thread ID, message ID, and recipient email\n   - Read original email for context\n\n3. **If calendar-related (scheduling):**\n   - Use office:calendar-management skill to check availability\n   - Include specific available times in draft\n   - Note any conflicts that need to be resolved\n\n4. **Draft the email:**\n   - Load user's style from `~/.claude/office-admin-config.json`\n   - Match their tone, formality, and response length preferences\n   - Use their common phrases from config\n   - Apply signature preference (none/minimal/full)\n   - **CRITICAL:** Always include explicit `To:` email address\n\n5. **Create the draft:**\n   - Save as DRAFT (never send)\n   - Ensure proper threading if reply\n   - Verify subject line is appropriate\n   - Provide link to draft for user review\n\n6. **Post-draft actions:**\n   - If email contains event info, offer to add to calendar\n   - If mentioning a new contact, offer to add to CRM\n   - Summarize what was created\n\n**Example interaction:**\n```\nUser: /draft-email\n\nClaude: I'll help you draft an email. Let me ask a few questions:\n\n1. Who is this email to? (name or email address)\n2. Is this a reply to an existing email?\n3. What's the main purpose? (scheduling, confirming, declining, requesting, etc.)\n\nUser: It's a reply to Sarah about scheduling a call next week\n\nClaude: Let me search for Sarah's email... Found it!\n\nI see Sarah asked about scheduling a call to discuss the Q1 project.\n\nLet me check your calendar for next week...\n\nYou're available:\n- Monday 2:00pm-4:30pm\n- Tuesday 9:30am-12:00pm, 1:30pm-4:30pm\n- Wednesday 10:00am-12:00pm\n\nI'll draft a reply in your ultra-terse style:\n\n---\n**DRAFT CREATED:**\n\nTo: sarah@example.com\nSubject: Re: Q1 Project Call\n\nthat works perfect. tuesday 2pm?\n\n---\n\nDraft saved to Gmail. Would you like me to:\n- Add this to your calendar as a hold?\n- Adjust the wording?\n- Send it now?\n```",
        "commands/setup-office-admin.md": "Run the office:onboarding skill to set up your personal productivity style, including email voice, calendar preferences, and CRM workflow patterns.\n",
        "commands/triage-email.md": "Perform bulk email triage on your inbox:\n\n1. Use the office:email-management skill\n2. Search for unread emails in your inbox\n3. Categorize each email as:\n   - **ACTION NEEDED** - Requires response or calendar addition\n   - **CALENDAR** - Contains event information (extract and check conflicts)\n   - **ARCHIVE** - Informational only, no action needed\n4. For ACTION NEEDED emails, draft replies using your personal style from `~/.claude/office-admin-config.json`\n5. For CALENDAR emails, proactively add events and check for conflicts using office:calendar-management skill\n6. Present a comprehensive summary organized by priority\n\nIf there are more than 10 unread emails, use a Task tool with general-purpose subagent for efficient bulk processing.\n\nFormat the output as:\n```\n## üìß Inbox Triage Summary\n\n### üî¥ ACTION NEEDED ([count])\n1. **From:** [sender] | **Subject:** [subject]\n   **Summary:** [brief summary]\n   **Draft:** [link to created draft or \"Draft created in Gmail\"]\n\n### üìÖ CALENDAR ([count])\n1. **From:** [sender] | **Subject:** [subject]\n   **Event:** [event details]\n   **Conflicts:** [none | list conflicts]\n   **Status:** [added to calendar | hold created | awaiting confirmation]\n\n### üìã ARCHIVE ([count])\n1. **From:** [sender] | **Subject:** [subject]\n   **Summary:** [brief summary]\n\n---\n**Total processed:** [count] emails\n```\n",
        "mcp-servers/README.md": "# MCP Servers for Office Plugin\n\nThe Office plugin bundles several MCP servers to provide comprehensive productivity features. This document explains what each server does and how to set them up.\n\n## Bundled MCP Servers\n\nThe Office plugin automatically configures the following MCP servers via `.mcp.json`:\n\n### 1. Pipedream MCP Server (Auto-configured ‚úÖ)\n\n**Purpose:** Email (Gmail) and Calendar (Google Calendar) management\n\n**What it provides:**\n- üìß Gmail: Reading, drafting, threading, sending emails\n- üìÖ Google Calendar: Event creation, conflict checking, scheduling\n\n**Installation:**\n‚úÖ **Automatically configured when you install the plugin!** No manual setup needed.\n\n**Setup:**\n1. Install the Office plugin: `/plugin install office@harper.dev`\n2. First time you use email/calendar features, you'll be prompted to authenticate via OAuth\n3. Grant permissions for Gmail and Google Calendar\n4. Done!\n\n**Required OAuth Scopes:**\n- Gmail: `gmail.readonly`, `gmail.send`, `gmail.compose`, `gmail.labels`, `gmail.modify`\n- Calendar: `calendar.events`, `calendar.readonly`, `calendar.freebusy`\n\n### 2. Toki - Todo Tracker (Auto-configured ‚úÖ)\n\n**Purpose:** Straightforward todo tracking and task management\n\n**What it provides:**\n- ‚úÖ Create, list, update, and complete todos\n- üè∑Ô∏è Tag and categorize tasks\n- üìä Project-based organization\n- üîç Search and filter capabilities\n\n**Installation:**\n```bash\nbrew install harperreed/tap/toki\n```\n\n**More info:** https://github.com/harperreed/toki\n\n**Setup:**\n1. Install via Homebrew (see above)\n2. The MCP server is auto-configured by the plugin\n3. Restart Claude Code after installing\n4. Use naturally: \"Add a todo to follow up with Sarah\"\n\n### 3. Chronicle - Agent Action Log (Auto-configured ‚úÖ)\n\n**Purpose:** Log and track what your agents are doing\n\n**What it provides:**\n- üìù Log agent actions and decisions\n- üîç Search through action history\n- ‚è±Ô∏è Timestamp tracking\n- üìä Activity patterns and insights\n\n**Installation:**\n```bash\nbrew install harperreed/tap/chronicle\n```\n\n**More info:** https://github.com/harperreed/chronicle\n\n**Setup:**\n1. Install via Homebrew (see above)\n2. The MCP server is auto-configured by the plugin\n3. Restart Claude Code after installing\n4. Agents will automatically log important actions\n\n### 4. Pagen - CRM (Auto-configured ‚úÖ)\n\n**Purpose:** Contact, company, and deal management (the CRM backend for Office plugin)\n\n**What it provides:**\n- üë• Contact management\n- üè¢ Company tracking\n- üíº Deal pipeline\n- üîó Relationship mapping\n- üìä Communication history\n\n**Installation:**\n```bash\nbrew install harperreed/tap/pagen\n```\n\n**More info:** https://github.com/harperreed/pagen\n\n**Setup:**\n1. Install via Homebrew (see above)\n2. Initialize database: `pagen init`\n3. The MCP server is auto-configured by the plugin\n4. Restart Claude Code after installing\n5. Start adding contacts naturally: \"Add John Doe from Acme Corp to my contacts\"\n\n**Note:** Pagen IS the CRM for the Office plugin. There is no separate \"CC-Office CRM\" server - Pagen provides all CRM functionality.\n\n## Quick Setup Guide\n\n### Minimum (Email + Calendar only)\n\n1. **Install the Office plugin:**\n   ```bash\n   /plugin install office@harper.dev\n   ```\n\n2. **Authenticate with Google:**\n   When you first use email/calendar features, you'll be prompted to authenticate\n\n3. **Configure your style:**\n   ```bash\n   /setup-office\n   ```\n\n4. **Start using it:**\n   ```bash\n   /triage-email\n   ```\n\nThat's it! Pipedream MCP is auto-configured by the plugin.\n\n### Full Setup (All Features)\n\nGet the complete productivity stack:\n\n1. **Install the Office plugin:**\n   ```bash\n   /plugin install office@harper.dev\n   ```\n\n2. **Install the Harper Reed productivity stack:**\n   ```bash\n   brew install harperreed/tap/toki\n   brew install harperreed/tap/chronicle\n   brew install harperreed/tap/pagen\n   ```\n\n3. **Initialize Pagen CRM:**\n   ```bash\n   pagen init\n   ```\n\n4. **Restart Claude Code** to activate all MCP servers\n\n5. **Authenticate with Google:**\n   OAuth prompts will appear on first use\n\n6. **Configure your style:**\n   ```bash\n   /setup-office\n   ```\n\n7. **You now have:**\n   - üìß Email management (Gmail)\n   - üìÖ Calendar management (Google Calendar)\n   - ‚úÖ Todo tracking (Toki)\n   - üìù Agent action logging (Chronicle)\n   - üë• CRM (Pagen)\n\n## Verifying Setup\n\nAfter configuration, verify MCP servers are working:\n\n```bash\n# In Claude Code\n/mcp\n\n# Should show all active servers:\n# - pd (Pipedream) - active ‚úÖ\n# - toki (if installed) - active ‚úÖ\n# - chronicle (if installed) - active ‚úÖ\n# - pagen (if installed) - active ‚úÖ\n```\n\nTest each server:\n\n**Gmail:**\n```\n\"Check my inbox for unread emails\"\n```\n\n**Calendar:**\n```\n\"Show me my calendar for tomorrow\"\n```\n\n**Toki:**\n```\n\"Add a todo to follow up with Sarah next week\"\n\"Show me all my pending todos\"\n```\n\n**Chronicle:**\n```\n\"Show me what actions I took today\"\n\"Search my agent history for email-related actions\"\n```\n\n**Pagen CRM:**\n```\n\"Add John Doe from Acme Corp to my contacts\"\n\"Show me all contacts from Acme Corp\"\n```\n\n## Troubleshooting\n\n### Pipedream (Gmail/Calendar) not working\n- Check OAuth credentials are valid\n- Re-authenticate: `/mcp` ‚Üí select pd ‚Üí reconnect\n- Verify scopes include all required permissions\n- Check internet connection\n\n### Toki not working\n- Verify installation: `which toki` (should show path)\n- Test CLI directly: `toki list`\n- Restart Claude Code to reload MCP servers\n- Check logs: `~/.claude/logs/`\n\n### Chronicle not working\n- Verify installation: `which chronicle` (should show path)\n- Test CLI directly: `chronicle list`\n- Restart Claude Code to reload MCP servers\n- Check logs: `~/.claude/logs/`\n\n### Pagen not working\n- Verify installation: `which pagen` (should show path)\n- Check database initialized: `pagen status`\n- Re-initialize if needed: `pagen init`\n- Test CLI directly: `pagen contacts list`\n- Restart Claude Code to reload MCP servers\n\n### General MCP issues\n- Restart Claude Code completely\n- Check `~/.claude/logs/` for error messages\n- Verify all tools are in PATH: `echo $PATH`\n- Check MCP status: `/mcp` (shows all servers and their status)\n- For homebrew tools, try reinstalling: `brew reinstall harperreed/tap/toki`\n\n## Security Notes\n\n- OAuth tokens (Pipedream) are stored securely by the MCP server\n- Local data (Toki, Chronicle, Pagen) is stored in your home directory\n- Never commit credentials or tokens to version control\n- Regularly review connected apps in Google account settings\n- All MCP servers run locally on your machine\n\n## What Each Tool Does\n\n**Quick reference:**\n\n| Tool | Purpose | Data Storage |\n|------|---------|-------------|\n| **Pipedream** | Gmail + Calendar access | Cloud (OAuth tokens) |\n| **Toki** | Todo tracking | Local SQLite |\n| **Chronicle** | Agent action logging | Local file-based |\n| **Pagen** | CRM (contacts/companies/deals) | Local database |\n\n## Next Steps\n\nAfter setting up MCP servers:\n\n1. **Configure your style:**\n   ```bash\n   /setup-office\n   ```\n\n2. **Test email functionality:**\n   ```bash\n   /triage-email\n   ```\n\n3. **Draft a test email:**\n   ```bash\n   /draft-email\n   ```\n\n4. **Add a todo:**\n   ```\n   \"Add a todo to review the office plugin documentation\"\n   ```\n\n5. **Add a contact (if Pagen installed):**\n   ```\n   \"Add Jane Smith from Example Corp to my contacts\"\n   ```\n\n6. **Check agent history (if Chronicle installed):**\n   ```\n   \"What have I accomplished today?\"\n   ```\n\n## Support\n\nFor issues and questions:\n\n- **Office plugin:** https://github.com/harperreed/office-admin-claude/issues\n- **Toki:** https://github.com/harperreed/toki/issues\n- **Chronicle:** https://github.com/harperreed/chronicle/issues\n- **Pagen:** https://github.com/harperreed/pagen/issues\n- **Pipedream MCP:** https://github.com/PipedreamHQ/pipedream/issues\n",
        "skills/calendar-management/SKILL.md": "---\nname: office:calendar-management\ndescription: Manage calendar events, check conflicts, handle scheduling from emails. Use when adding events or coordinating meetings to ensure proper timezone handling and conflict detection.\n---\n\n# Calendar Management with Office Admin\n\n## When to Use This Skill\n\nUse this skill when:\n- Adding events from emails\n- Checking for scheduling conflicts\n- Creating calendar holds for tentative events\n- Converting timezones for international contacts\n- Managing working hours and availability\n- Blocking focus time or recurring events\n\n## User Calendar Preferences\n\nLoad preferences from `~/.claude/office-admin-config.json`:\n\n```json\n{\n  \"personal\": {\n    \"timezone\": \"America/Chicago\",\n    \"workingHours\": {\n      \"start\": \"09:30\",\n      \"end\": \"16:30\",\n      \"lunchStart\": \"12:00\",\n      \"lunchEnd\": \"13:30\"\n    }\n  },\n  \"calendar\": {\n    \"defaultDuration\": 30,\n    \"bufferMinutes\": 15,\n    \"schedulingLink\": \"https://user.cal.com/schedule\",\n    \"autoAddFromEmail\": true,\n    \"eventNaming\": {\n      \"includeLocation\": true,\n      \"includeAttendees\": false\n    }\n  }\n}\n```\n\n## Core Principles\n\n1. **Always check conflicts first** - Before committing to an event\n2. **Respect working hours** - Use user's configured schedule\n3. **Handle timezones carefully** - Convert accurately, show both zones\n4. **Be proactive** - Auto-add events from emails when configured\n5. **Use descriptive titles** - Include location/context per user preference\n\n## Adding Events from Emails\n\n### Step 1: Extract Event Details\n\nLook for in the email:\n- **Date and time** (or phrases like \"tomorrow\", \"next Tuesday\", \"in two weeks\")\n- **Duration** (or use defaultDuration from config)\n- **Location** (physical address, restaurant name, virtual link)\n- **Event type** (meeting, lunch, coffee, party, etc.)\n- **Attendees** (who else is invited)\n- **Special notes** (dress code, what to bring, etc.)\n\n### Step 2: Parse Relative Dates\n\nHandle conversational dates:\n- \"tomorrow\" ‚Üí current date + 1 day\n- \"next Monday\" ‚Üí next occurrence of Monday\n- \"in two weeks\" ‚Üí current date + 14 days\n- \"Dec 5\" ‚Üí December 5 of current year (or next if passed)\n\n### Step 3: Check Calendar for Conflicts\n\nBEFORE creating the event:\n\n```bash\n# Get user's calendar for that date\nmcp__pd__google_calendar-list-events(\n  instruction=\"Get all events for [date], between [start_time - bufferMinutes] and [end_time + bufferMinutes]\"\n)\n```\n\nLook for:\n- Direct conflicts (overlapping times)\n- Buffer violations (< bufferMinutes between events)\n- Lunch conflicts (check workingHours.lunch* from config)\n- End-of-day violations (past workingHours.end)\n\n### Step 4: Report Availability\n\nTell the user:\n\n**If free:**\n```\nYou're free at [time] on [date].\n```\n\n**If conflict exists:**\n```\nThat conflicts with:\n- [event name] from [start] to [end]\n\nYour schedule that day:\n9:30am - 10:30am: Team standup\n10:30am - 12:00pm: FREE\n12:00pm - 1:30pm: Lunch\n1:30pm - 3:00pm: [Proposed event would go here]\n3:00pm - 4:00pm: Client call\n```\n\n### Step 5: Create the Event\n\nIf user confirms or no conflict exists:\n\n```bash\nmcp__pd__google_calendar-create-event(\n  instruction=\"Create event with:\n  - Title: [descriptive title with location if includeLocation=true]\n  - Date: [YYYY-MM-DD]\n  - Start time: [HH:MM] [timezone]\n  - End time: [HH:MM] [timezone]\n  - Location: [physical address or link]\n  - Description: [context about who invited, what it's about]\n  - Attendees: [email addresses]\n  \"\n)\n```\n\n**Title format examples:**\n- If `includeLocation: true`: \"Lunch with Mike at Soho House\"\n- If `includeLocation: false`: \"Lunch with Mike\"\n- If `includeAttendees: true`: \"Meeting with Mike, Sarah, John\"\n\n**Timezone:** Always use user's timezone from config unless explicitly scheduling with someone in another timezone.\n\n### Step 6: Confirm Addition\n\nProvide:\n- Event summary\n- Calendar link for verification\n- Note any adjustments made (e.g., moved 15min earlier to respect buffer)\n\n## Handling Tentative Events\n\nFor events pending confirmation:\n\n1. **Create with \"HOLD:\" prefix**\n   ```\n   Title: \"HOLD: Call with Jean (pending confirmation)\"\n   ```\n\n2. **Add note in description**\n   ```\n   Description: \"(pending confirmation) Call with Jean Labuschagne about consulting opportunity\"\n   ```\n\n3. **Update when confirmed**\n   - Remove \"HOLD:\" prefix\n   - Update description to remove \"pending\" note\n\n4. **Delete if falls through**\n   - Remove the calendar event\n   - Log in CRM why it didn't happen (if tracking deals)\n\n## Timezone Handling\n\n### For Same-Timezone Contacts\n\nUse user's timezone from config:\n```\nTime: 2:00 PM America/Chicago\n```\n\n### For Different-Timezone Contacts\n\nWhen scheduling with someone in another timezone:\n\n1. **Specify both timezones in email:**\n   ```\n   \"How about 9am Chicago time (4pm Zurich)?\"\n   ```\n\n2. **Double-check conversion:**\n   - Look up their timezone\n   - Calculate offset from user's timezone\n   - Verify conversion is correct\n   - Account for DST differences\n\n3. **Common international contacts:**\n   Keep a mental note of frequent timezone conversions:\n   - US East Coast: +1 hour from Chicago (America/New_York)\n   - UK: +6 hours from Chicago (Europe/London)\n   - Central Europe: +7 hours from Chicago (Europe/Zurich)\n   - Tokyo: +15 hours from Chicago (Asia/Tokyo)\n\n4. **Create event in user's timezone:**\n   ```\n   Title: \"Call with Jean in Zurich\"\n   Time: 9:00 AM America/Chicago\n   Description: \"9am Chicago / 4pm Zurich - Call with Jean Labuschagne\"\n   ```\n\n## Working Hours Awareness\n\n### Checking Availability\n\nWhen someone asks \"when are you free?\":\n\n1. Check user's workingHours from config\n2. Look for gaps between existing events\n3. Respect bufferMinutes between meetings\n4. Avoid scheduling during lunch hours\n5. Prefer morning or afternoon blocks\n\n### Typical Day Structure\n\nBased on config defaults:\n```\n9:30am - Start of working day\n    ‚Üì\n[Morning block for meetings/work]\n    ‚Üì\n12:00pm - 1:30pm - Lunch (avoid scheduling)\n    ‚Üì\n[Afternoon block for meetings/work]\n    ‚Üì\n4:30pm - End of working day\n```\n\n### Buffer Management\n\nApply bufferMinutes (default: 15) between events:\n```\n10:00am - 11:00am: Meeting A\n[15 min buffer]\n11:15am - 12:00pm: Meeting B\n```\n\nDon't schedule back-to-back unless user explicitly requests.\n\n## Recurring Events\n\nFor recurring events (weekly standups, monthly check-ins):\n\n```bash\nmcp__pd__google_calendar-create-event(\n  instruction=\"Create recurring event:\n  - Title: [name]\n  - Frequency: [daily/weekly/monthly]\n  - Day: [Monday, Tuesday, etc. for weekly]\n  - Time: [HH:MM]\n  - Duration: [minutes]\n  - Until: [end date or 'indefinitely']\n  \"\n)\n```\n\n## Focus Time / Blocking\n\nFor work blocks or focus time:\n\n```bash\nmcp__pd__google_calendar-create-event(\n  instruction=\"Create focus time block:\n  - Title: 'Focus Time' or 'Deep Work'\n  - Mark as: Busy\n  - Visibility: Private (optional)\n  - Duration: [typically 2-4 hours]\n  - Recurring: [if regular pattern]\n  \"\n)\n```\n\n## Integration with Email Skill\n\nWhen email-management skill sees scheduling language:\n\n1. **Extract event details**\n2. **Call this skill to check conflicts**\n3. **Report back to email skill**\n4. **Email skill includes availability in draft response**\n5. **This skill creates event once confirmed**\n\nSeamless handoff between skills.\n\n## Common Scenarios\n\n### Scenario 1: Lunch Invitation\n```\nEmail: \"Want to grab lunch next Tuesday?\"\n\n1. Check calendar for next Tuesday\n2. Check lunch hours (12:00-1:30pm from config)\n3. Look for conflicts in that window\n4. Report: \"You're free for lunch on Tuesday Dec 5\"\n5. Create tentative hold\n6. Once confirmed, create proper event with restaurant location\n```\n\n### Scenario 2: Meeting Request with Multiple Options\n```\nEmail: \"Can we meet Monday or Tuesday afternoon?\"\n\n1. Check both Monday and Tuesday afternoons\n2. Identify all free slots after lunch\n3. Report: \"You're free:\n   - Monday 2:00pm-4:30pm\n   - Tuesday 1:30pm-3:00pm, 4:00pm-4:30pm\"\n4. Let user choose\n5. Create event for chosen slot\n```\n\n### Scenario 3: International Call\n```\nEmail from Switzerland: \"9am your time?\"\n\n1. Confirm user's timezone (America/Chicago)\n2. Calculate Switzerland time (4pm CET)\n3. Check 9am Chicago for conflicts\n4. Report availability\n5. Create event with both timezones in description\n```\n\n## Common Mistakes to Avoid\n\n### ‚ùå Not Checking Conflicts\n**Problem:** Double-booking user\n**Solution:** ALWAYS check calendar before confirming availability\n\n### ‚ùå Wrong Timezone\n**Problem:** Event created in wrong timezone, user misses meeting\n**Solution:** Use timezone from config, verify conversions carefully\n\n### ‚ùå Ignoring Buffers\n**Problem:** Back-to-back meetings with no break\n**Solution:** Apply bufferMinutes between events\n\n### ‚ùå Scheduling During Lunch\n**Problem:** Booking meetings during lunch hours\n**Solution:** Check workingHours.lunchStart/End from config\n\n### ‚ùå Vague Event Titles\n**Problem:** \"Meeting\" with no context\n**Solution:** Include who, what, where based on eventNaming preferences\n\n### ‚ùå Forgetting to Create Holds\n**Problem:** User verbally commits but event not tracked\n**Solution:** Always create HOLD events for tentative commitments\n\n## Integration Checklist\n\nBefore completing a calendar task:\n\n- [ ] Loaded user's calendar preferences from config\n- [ ] Checked for conflicts with sufficient buffer\n- [ ] Verified timezone is correct\n- [ ] Respected working hours and lunch time\n- [ ] Used descriptive event title per preferences\n- [ ] Added location if includeLocation enabled\n- [ ] Included relevant attendees\n- [ ] Added context in description\n- [ ] Confirmed event was created successfully\n- [ ] Provided calendar link to user\n\n## Success Criteria\n\nYou're managing calendar well when:\n- No double-bookings occur\n- User has appropriate buffers between meetings\n- Timezone conversions are accurate\n- Event titles are clear and helpful\n- Working hours are respected\n- Conflicts are caught before committing\n- Integration with email is seamless\n\n## Remember\n\nCalendar management is about protecting user's time and making scheduling effortless. Be proactive, be accurate, and always check conflicts first.\n",
        "skills/crm-management/SKILL.md": "---\nname: office:crm-management\ndescription: Manage contacts, companies, deals, and relationships. Use when adding contacts, logging interactions, or working with CRM data to prevent duplicates and maintain data quality.\n---\n\n# Office Admin CRM Management\n\n## When to Use This Skill\n\nUse this skill ANY time you:\n- Add contacts from emails or conversations\n- Create or update deals\n- Log interactions with people\n- Search for existing contacts or companies\n- Work with relationships between contacts\n- Backfill CRM data from email history\n- Need to check if a contact already exists\n\n## User CRM Preferences\n\nLoad user preferences from `~/.claude/office-admin-config.json`:\n\n```json\n{\n  \"crm\": {\n    \"contactTypes\": \"professional\" | \"personal\" | \"mixed\",\n    \"detailLevel\": \"minimal\" | \"standard\" | \"detailed\",\n    \"autoLogInteractions\": true | false,\n    \"trackRelationships\": true | false\n  }\n}\n```\n\nAdapt your CRM workflow to match these preferences.\n\n## Core Principles\n\n### 1. Always Check Before Adding\n**NEVER add a contact or company without checking if they already exist first.**\n\n```bash\n# WRONG - adds without checking\nmcp__pagen__add_contact(name=\"John Doe\", email=\"john@example.com\")\n\n# RIGHT - check first\nmcp__pagen__find_contacts(query=\"john@example.com\")\n# Only add if not found\n```\n\n### 2. Associate Contacts with Companies\nWhen you know someone's company, ALWAYS link them:\n\n```bash\n# Add company first (if needed)\nmcp__pagen__add_company(\n  name=\"Acme Corp\",\n  domain=\"acme.com\",\n  industry=\"Technology\"\n)\n\n# Then add contact with company association\nmcp__pagen__add_contact(\n  name=\"John Doe\",\n  email=\"john@example.com\",\n  company_name=\"Acme Corp\",\n  phone=\"+1-555-0100\"\n)\n```\n\n### 3. Log Meaningful Interactions\nAfter ANY significant email exchange, meeting, or conversation, log it (if user has `autoLogInteractions` enabled):\n\n```bash\nmcp__pagen__log_contact_interaction(\n  contact_id=\"abc-123\",\n  note=\"Discussed Q4 partnership. They're interested in our AI tool. Follow up after Thanksgiving.\",\n  interaction_date=\"2025-11-22\"\n)\n```\n\nAdjust detail level based on user's `detailLevel` preference:\n- **Minimal**: Just key facts\n- **Standard**: Context about interaction\n- **Detailed**: Thorough notes with quotes, decisions, next steps\n\n## Available CRM Tools\n\n### Core Tools\n- `mcp__pagen__add_company(name, domain, industry, notes)` - Add new company\n- `mcp__pagen__add_contact(name, email, company_name, phone, notes)` - Add new contact\n- `mcp__pagen__update_contact(id, name, email, phone, notes)` - Update existing contact\n- `mcp__pagen__create_deal(title, company_name, amount, stage, contact_name, initial_note, expected_close_date, currency)` - Create business opportunity\n- `mcp__pagen__update_deal(id, title, stage, amount, expected_close_date)` - Update deal status\n\n### Search & Query Tools\n- `mcp__pagen__query_crm(entity_type, query, filters, limit)` - Universal search (contact/company/deal/relationship)\n- `mcp__pagen__find_contacts(query, company_id, limit)` - Search contacts by name/email\n- `mcp__pagen__find_companies(query, limit)` - Search companies by name/domain\n\n### Relationship & Interaction Tools\n- `mcp__pagen__log_contact_interaction(contact_id, note, interaction_date)` - Log interactions\n- `mcp__pagen__link_contacts(contact_id_1, contact_id_2, relationship_type, context)` - Connect contacts\n- `mcp__pagen__find_contact_relationships(contact_id, relationship_type)` - View relationships\n- `mcp__pagen__add_deal_note(deal_id, content)` - Add notes to deals\n\n## Deal Stages\n\nUse these standard stages for deals:\n- **prospecting** - Initial conversations, exploring possibilities\n- **qualification** - Determining if it's a real opportunity with potential\n- **proposal** - Active proposal or pitch in progress\n- **negotiation** - Terms being discussed, getting close\n- **closed_won** - Deal completed successfully\n- **closed_lost** - Deal didn't happen (still valuable to track why)\n\n## Workflow: Adding Contact from Email\n\nWhen processing an email with a new person:\n\n```bash\n# 1. Check if contact exists\nmcp__pagen__find_contacts(query=\"person@example.com\")\n\n# 2. If not found, extract info from email:\n#    - Full name\n#    - Email address\n#    - Company (if mentioned)\n#    - Phone (if in signature)\n#    - Context about them (adapt detail level to user's preference)\n\n# 3. Check if company exists (if applicable)\nmcp__pagen__find_companies(query=\"Example Corp\")\n\n# 4. Add company if needed\nmcp__pagen__add_company(\n  name=\"Example Corp\",\n  domain=\"example.com\",\n  industry=\"Technology\",\n  notes=\"[Context based on user's detailLevel preference]\"\n)\n\n# 5. Add contact with company association\nmcp__pagen__add_contact(\n  name=\"Jane Smith\",\n  email=\"jane@example.com\",\n  company_name=\"Example Corp\",\n  phone=\"+1-555-0200\",\n  notes=\"[Context based on user's detailLevel preference]\"\n)\n\n# 6. Log the interaction (if autoLogInteractions enabled)\nmcp__pagen__log_contact_interaction(\n  contact_id=\"<returned_id>\",\n  note=\"[Detail based on user's detailLevel preference]\",\n  interaction_date=\"2025-11-22\"\n)\n\n# 7. Track relationships (if trackRelationships enabled)\n# If they mention knowing someone else in your CRM:\nmcp__pagen__link_contacts(\n  contact_id_1=\"<jane_id>\",\n  contact_id_2=\"<bob_id>\",\n  relationship_type=\"colleague\",\n  context=\"Jane mentioned working with Bob at previous company\"\n)\n```\n\n## Workflow: Creating a Deal\n\nWhen you identify a business opportunity:\n\n```bash\n# 1. Ensure contact and company exist (see above)\n\n# 2. Create the deal\nmcp__pagen__create_deal(\n  title=\"AI Consulting Project - Example Corp\",\n  company_name=\"Example Corp\",\n  contact_name=\"Jane Smith\",\n  stage=\"prospecting\",\n  amount=50000,  # in cents\n  currency=\"USD\",\n  expected_close_date=\"2026-03-01\",\n  initial_note=\"[Detail based on user's detailLevel preference]\"\n)\n\n# 3. Log updates as deal progresses\nmcp__pagen__add_deal_note(\n  deal_id=\"<deal_id>\",\n  content=\"[Detail based on user's detailLevel preference]\"\n)\n\n# 4. Update deal stage when it changes\nmcp__pagen__update_deal(\n  id=\"<deal_id>\",\n  stage=\"proposal\",\n  amount=75000  # updated after scope discussion\n)\n```\n\n## What Counts as a \"Deal\"?\n\nTrack these as deals:\n- ‚úÖ Consulting or advisory opportunities\n- ‚úÖ Speaking engagements with compensation\n- ‚úÖ Book publishing opportunities\n- ‚úÖ Partnership or collaboration opportunities\n- ‚úÖ Investment opportunities\n- ‚úÖ Real estate transactions\n- ‚úÖ Major purchases or sales\n- ‚úÖ Sponsorships (being a sponsor or receiving sponsorship)\n\nDon't track as deals:\n- ‚ùå Social lunches with no business angle\n- ‚ùå Informational coffee chats\n- ‚ùå Personal favors or introductions\n- ‚ùå Newsletter subscriptions\n- ‚ùå Generic networking\n\n## Email Backfill Best Practices\n\nWhen backfilling CRM from email history:\n\n1. **Work in time-bounded batches** - Process 1-2 months at a time\n2. **Start with SENT emails** - You're usually the initiator, so sent emails have better signal\n3. **Then do INBOX** - Catch incoming opportunities you might have missed\n4. **Skip noise** - Ignore newsletters, receipts, automated emails\n5. **Focus on humans** - Only add real people they interact with\n6. **Log context** - Include what was discussed, not just \"sent email\"\n7. **Check for dupes** - Always search before adding\n8. **Respect detailLevel** - Match note detail to user's preference\n\n## Contact Types and Filtering\n\nBased on user's `contactTypes` setting:\n\n**Professional:**\n- Focus on work relationships\n- Track company associations carefully\n- Emphasize business context in notes\n- Create deals for opportunities\n\n**Personal:**\n- Focus on personal relationships\n- Company associations optional\n- Emphasize personal context (how you met, shared interests)\n- Deals less common\n\n**Mixed:**\n- Handle both types\n- Clearly distinguish in notes which category\n- Be flexible with detail level\n- Track both business and personal context\n\n## Common Mistakes to Avoid\n\n### ‚ùå Adding without checking\n```bash\n# This creates duplicates!\nmcp__pagen__add_contact(name=\"Bob Jones\", email=\"bob@test.com\")\nmcp__pagen__add_contact(name=\"Bob Jones\", email=\"bob@test.com\")\n```\n\n### ‚ùå Not associating with company\n```bash\n# Missing valuable context\nmcp__pagen__add_contact(\n  name=\"Jane Smith\",\n  email=\"jane@bigcorp.com\"\n  # Should include company_name=\"BigCorp\"!\n)\n```\n\n### ‚ùå Wrong level of detail\n```bash\n# User has detailLevel: \"minimal\" but you write:\nmcp__pagen__log_contact_interaction(\n  contact_id=\"abc\",\n  note=\"Had extensive discussion about their company's AI strategy including their plans for Q1 implementation of LLM-based customer support, concerns about hallucinations, budget constraints around $50k, and follow-up scheduled for next Tuesday at 2pm to review proposal draft...\"\n)\n\n# Should be:\nmcp__pagen__log_contact_interaction(\n  contact_id=\"abc\",\n  note=\"Discussed AI strategy. Follow up Tue 2pm with proposal.\"\n)\n```\n\n### ‚ùå Not tracking deals\n```bash\n# Someone asks about consulting work - this is a deal!\n# Don't just log it as an interaction\n# Create a deal to track the opportunity\n```\n\n### ‚ùå Over-logging when autoLogInteractions is false\n```bash\n# If user disabled auto-logging, only log:\n# - Significant milestones\n# - Explicit user request\n# - Deal-related interactions\n```\n\n## Data Quality Guidelines\n\n### Good Contact Notes (based on detailLevel)\n\n**Minimal:**\n- How you met\n- Their role or what they do\n- One-line context\n\n**Standard:**\n- How you met\n- What they're interested in\n- Current conversation or project\n- Key personal detail (timezone, etc.)\n\n**Detailed:**\n- Comprehensive background\n- Detailed conversation history\n- Personal preferences and patterns\n- Relationship mapping\n- Next steps and follow-ups\n\n### Good Company Notes\n\nInclude (scaled to detailLevel):\n- Industry or sector\n- Company size if relevant\n- What they do\n- Context about the relationship\n\n### Good Interaction Notes\n\nInclude (scaled to detailLevel):\n- What was discussed\n- Outcomes or decisions\n- Next steps or follow-ups\n- Date of interaction\n\n## Integration with Email Skill\n\nWhen email-management skill identifies a new contact:\n1. Automatically trigger CRM workflow\n2. Check for existing contact\n3. Add if new (respecting CRM preferences)\n4. Log interaction if enabled\n5. Return to email workflow\n\n## Summary Checklist\n\nBefore adding to CRM, ask yourself:\n\n- ‚òê Did I check user's CRM preferences from config?\n- ‚òê Did I search to see if this contact already exists?\n- ‚òê Did I search to see if their company already exists?\n- ‚òê Did I include company association if I know it?\n- ‚òê Did I match the user's preferred detail level?\n- ‚òê Is autoLogInteractions enabled? Should I log this?\n- ‚òê Is this a deal I should be tracking?\n- ‚òê Should I track relationships to other contacts?\n- ‚òê Did I include phone number if available?\n\n**Remember**: The CRM is only valuable if the data is clean and contextual. Quality over quantity, always.\n\n## Success Criteria\n\nYou're managing CRM well when:\n- No duplicate contacts are created\n- Contact notes match user's preferred detail level\n- Interactions are logged appropriately (not too much, not too little)\n- Deals are tracked consistently\n- Relationships are mapped when user has that enabled\n- Integration with email workflow is seamless\n",
        "skills/email-management/SKILL.md": "---\nname: office:email-management\ndescription: Handle email tasks (checking inbox, drafting replies, managing threads, adding events to calendar). Use when working with emails to prevent common mistakes like broken threading or missing recipients.\n---\n\n# Email Management with Office Admin\n\nUse this skill when handling:\n- Checking inbox or finding specific emails\n- Drafting email replies\n- Adding events from emails to calendar\n- Managing email workflows\n- Bulk email triage\n\n## Core Principles\n\n1. **Always draft, never send** - Save emails as drafts for user review before sending\n2. **Threading is critical** - Replies must appear in the correct conversation thread\n3. **Match user's voice** - Reference their office-admin config for tone and style\n4. **Extract structured data** - Pull event details, action items, contact info from emails\n5. **Proactive calendar integration** - Auto-check conflicts and add events\n\n## User Style Configuration\n\nBefore drafting emails, load the user's style from `~/.claude/office-admin-config.json`:\n\n```json\n{\n  \"email\": {\n    \"tone\": \"ultra-terse\" | \"conversational\" | \"professional\" | \"warm\",\n    \"signature\": \"none\" | \"minimal\" | \"full\",\n    \"formality\": \"casual\" | \"standard\" | \"formal\",\n    \"responseLength\": \"minimal\" | \"balanced\" | \"detailed\",\n    \"patterns\": [\"common phrases they use\"],\n    \"customGuidelines\": \"Additional freeform style notes\"\n  }\n}\n```\n\nIf config doesn't exist, prompt user to run `/setup-office-admin` first.\n\n## Email Drafting Workflow\n\n### Step 1: Find the Thread\n\nWhen drafting a reply, ALWAYS search for the original email first:\n\n```\nSearch for: [subject] from [sender name]\nGet: Full email content, thread ID, message ID, recipient email\n```\n\n**Why:** You need context AND threading information. Skipping this = standalone draft instead of threaded reply.\n\n### Step 2: Get Threading Details\n\nExtract from search results:\n- `thread_id` - Links all messages in the conversation\n- `message_id` - The specific message you're replying to (usually most recent)\n- `recipient_email` - The To: address (CRITICAL - tool doesn't auto-extract!)\n\n**Critical:** All three are required for proper threading. Missing any = broken draft.\n\n### Step 3: Draft Using User's Voice\n\nReference their config for:\n\n**Tone Guidelines:**\n- **Ultra-terse**: 1-2 lines, no fluff, direct\n- **Conversational**: Casual but complete, friendly\n- **Professional**: Formal, structured, proper grammar\n- **Warm**: Friendly, personal, include pleasantries\n\n**Signature Guidelines:**\n- **None**: No sign-off, message ends immediately\n- **Minimal**: Simple \"Best,\" or \"Thanks,\"\n- **Full**: Complete signature block from config\n\n**Response Length:**\n- **Minimal**: One-liners when possible\n- **Balanced**: 2-3 sentences typical\n- **Detailed**: Thorough explanations\n\n**User Patterns:**\nUse their common phrases from config `patterns` array when appropriate.\n\n### Step 4: Create Threaded Draft\n\nWhen creating the draft, specify:\n- **To:** Recipient's email address (CRITICAL - always explicit!)\n- **Thread ID** (to keep it in conversation)\n- **In-Reply-To message ID** (the message you're replying to)\n- **Subject** (maintain thread subject, usually \"Re: [original]\")\n- **Body** (match user's voice from config)\n- **Signature** (based on user's preference)\n\n**CRITICAL:** Always explicitly provide the `To:` email address. The MCP tool does NOT automatically extract the recipient from the thread - if you omit it, it will create a broken draft with invalid addresses.\n\n**Example tool call structure:**\n```\nTo: sender@example.com\nThread ID: 19a5fc252ad4dd3a\nIn-Reply-To message ID: 19a711957d96874d\nSubject: Re: Project Discussion\nBody: [message in user's style]\n[Signature if configured]\n```\n\n### Step 5: Verify Threading\n\nAfter creating draft, confirm:\n- Draft appears in the correct conversation thread\n- Subject line maintains thread format\n- Draft is saved (not sent)\n\nIf threading failed:\n1. Get correct thread ID and message ID again\n2. Recreate draft with proper IDs\n3. Don't create a new standalone email\n\n### Step 6: Iterate on Feedback\n\nUser will refine wording:\n- Update the draft with changes\n- Maintain proper threading\n- Keep user's voice consistent\n\n## Calendar Integration\n\n**IMPORTANT:** When emails contain event information, PROACTIVELY add them to the calendar and check for conflicts. Don't wait for user to ask.\n\n### Step 1: Extract Event Details\n\nLook for:\n- Date and time\n- Location\n- Event title/description\n- Attendees/who's invited\n- Any special notes\n\n### Step 2: Check Calendar for Conflicts\n\nBEFORE creating the event:\n1. Check user's calendar for the event date\n2. Look for conflicts around the event time\n3. Note any existing commitments\n4. Reference their working hours from config\n\n**Why:** User needs to know if there's a conflict before committing.\n\n### Step 3: Report Conflicts or Availability\n\nTell the user:\n- \"You're free at [time] on [date]\" ‚úÖ\n- \"That conflicts with [existing event] at [time]\" ‚ö†Ô∏è\n- Show the relevant portion of the day's schedule\n\n### Step 4: Add Event to Calendar (if appropriate)\n\nIf user confirms or if there's no conflict, create the event with:\n- Clear title (include location if helpful)\n- Correct date/time with timezone awareness (from config)\n- Location field\n- Description noting who invited/context\n- Attendees (if it's a meeting with others)\n\n**Example:**\n```\nTitle: \"Lunch with Mike Evans at Soho House\"\nDate: December 3, 2025\nTime: 12:00 PM to 1:30 PM ([User's Timezone from config])\nLocation: Soho House\nDescription: \"Lunch invitation from Mike Evans to discuss Q1 planning\"\nAttendees: mike@example.com\n```\n\n### Step 5: Confirm Addition\n\nLet user know the event was added and provide:\n- Calendar link for verification\n- Note any conflicts that were identified\n- Confirm if adjustments are needed\n\n### Step 6: Handle Tentative Events\n\nFor events pending confirmation:\n- Create calendar event with \"HOLD:\" prefix in title\n- Example: \"HOLD: Call with Jean (pending confirmation)\"\n- Add \"(pending confirmation)\" in description\n- Update to remove \"HOLD\" once confirmed\n- Delete if falls through\n\n### Step 7: Timezone Handling\n\nWhen scheduling with people in other timezones:\n- Use user's timezone from config as primary\n- Specify BOTH timezones in the email\n- Example: \"9am [your timezone] (4pm their timezone)\"\n- Double-check timezone conversion before sending\n\n## Inbox Triage\n\nWhen checking inbox:\n\n### Step 1: Search for Unread\n\nGet recent unread emails with:\n- Sender\n- Subject\n- Date\n- Preview snippet\n\n### Step 2: Categorize\n\nGroup mentally by type:\n- **Urgent/Today**: Meetings, time-sensitive requests\n- **Action needed**: Need response or calendar add\n- **FYI**: Updates, newsletters\n- **Archive**: No action needed, informational only\n\n**NEVER categorize as \"DELETE\"** - Users should archive instead of deleting.\n\n**For spam/unwanted emails:**\n- Mark as spam using Gmail's spam function (if truly spam)\n- Unsubscribe from newsletters (if there's an unsubscribe link)\n- Archive everything else (don't delete - email storage is cheap, deletion is permanent)\n\n### Step 3: Summarize Clearly\n\nPresent in order of priority:\n- Recent/urgent first\n- Group related emails (threads)\n- Highlight action items\n- Note any follow-ups needed\n\n### Step 4: Use Subagents for Bulk Processing\n\nFor large triage operations (10+ emails):\n- Use Task tool with general-purpose subagent\n- Have subagent categorize all emails\n- Subagent can draft multiple replies in one go\n- More efficient than processing one-by-one\n\n## Bulk Email Processing with Subagents\n\nWhen user asks to triage many emails or handle multiple replies:\n\n1. **Use subagent for triage**:\n   - Pass clear categorization criteria\n   - Have subagent check calendars for scheduling\n   - Pass user's email style config to subagent\n   - Get comprehensive report back\n\n2. **Use subagent for bulk drafting**:\n   - Provide list of emails needing replies\n   - Give subagent user's voice guidelines from config\n   - Subagent creates all drafts with proper threading\n   - Review and user sends\n\n**Example prompt structure for subagent:**\n```\nTriage all unread emails in inbox. Categorize as:\n- ACTION NEEDED (with specific next steps)\n- CALENDAR (extract event details, check conflicts)\n- ARCHIVE (no action needed)\n\nFor ACTION NEEDED, draft replies using this style:\n[Include user's email config]\n\nReturn comprehensive report.\n```\n\n## Common Mistakes to Avoid\n\n### ‚ùå Creating Standalone Drafts Instead of Threaded Replies\n**Problem:** Draft appears as new email, not in conversation thread\n**Solution:** Always get thread ID and message ID before creating draft\n\n### ‚ùå Not Matching User's Voice\n**Problem:** Email doesn't sound like the user\n**Solution:** Reference their office-admin config for tone, formality, patterns\n\n### ‚ùå Adding Wrong Signature\n**Problem:** Adding \"Best,\" when user configured \"none\"\n**Solution:** Check config `email.signature` setting\n\n### ‚ùå Sending Instead of Drafting\n**Problem:** User can't review before it goes out\n**Solution:** ALWAYS save as draft, let user send\n\n### ‚ùå Forgetting to Extract Calendar Events\n**Problem:** User has to manually add events later\n**Solution:** Proactively offer to add events when you see them in emails\n\n### ‚ùå Missing the `To:` Field\n**Problem:** Draft created with invalid `@example.com` address that bounces\n**Solution:** ALWAYS explicitly provide recipient email address from thread search\n\n### ‚ùå Wrong Timezone\n**Problem:** Event added in wrong timezone\n**Solution:** Use timezone from user's config (default: their local timezone)\n\n## Integration Checklist\n\nBefore completing an email task, verify:\n\n- [ ] Loaded user's office-admin config for style preferences\n- [ ] Found original email/thread for context\n- [ ] Got thread ID, message ID, AND recipient email if replying\n- [ ] Drafted in user's voice (matched config settings)\n- [ ] Created as DRAFT (not sent)\n- [ ] Verified proper threading if reply\n- [ ] Extracted and added calendar events if present\n- [ ] Checked for scheduling conflicts\n- [ ] Summarized what was done for user\n\n## CRM Integration\n\nWhen processing emails with new contacts:\n- Check if contact exists in CRM\n- Add to CRM if significant contact\n- Log interaction in CRM\n- Associate with company if applicable\n\nSee `office:crm-management` skill for details.\n\n## Success Criteria\n\nYou've successfully handled email tasks when:\n- Drafts appear in correct conversation threads\n- User says \"looks good\" without needing changes\n- Calendar events are added proactively\n- Inbox summaries surface what matters\n- Process feels efficient and natural\n- Voice matches user's configured style\n\n## Remember\n\nEmail is personal communication using the user's voice. The goal is to save time while maintaining authentic, effective communication that sounds like THEM.\n\nWhen in doubt: Check their config, follow their patterns, and always draft first.\n",
        "skills/onboarding/SKILL.md": "---\nname: office:onboarding\ndescription: Set up your personal productivity style and preferences. Use when you first install office or want to customize your workflow patterns.\n---\n\n# Office Onboarding\n\nWelcome to **Office**! This skill helps you set up your personal productivity style so that the assistant can help you manage email, calendar, and contacts in a way that matches YOUR preferences.\n\n## When to Use This Skill\n\n- First time installing office-admin\n- Want to update your productivity style preferences\n- Need to configure how email drafts should sound\n- Setting up your working hours and calendar preferences\n- Defining your CRM workflow patterns\n\n## Onboarding Process\n\n### Step 1: Introduce Yourself\n\nAsk the user:\n1. **What should I call you?** (Their preferred name/nickname)\n2. **What's your timezone?** (Default: America/Chicago)\n3. **What are your typical working hours?** (Default: 9:30am - 4:30pm, lunch 12:00-1:30pm)\n\n### Step 2: Email Communication Style\n\nAsk about their email preferences:\n\n1. **Email Tone** - How do you typically write emails?\n   - Ultra-terse (1-2 lines, no fluff, get to point)\n   - Conversational (casual but complete)\n   - Professional (formal, structured)\n   - Warm (friendly, personal touch)\n\n2. **Email Signatures** - Do you use signatures?\n   - None (no signatures or sign-offs)\n   - Minimal (\"Best,\" or \"Thanks,\")\n   - Full signature block\n\n3. **Formality Level**\n   - Super casual (lowercase is fine, minimal punctuation)\n   - Standard (proper grammar and capitalization)\n   - Formal (perfect grammar, structured sentences)\n\n4. **Response Length**\n   - Minimal (one-liners when possible)\n   - Balanced (2-3 sentences typical)\n   - Detailed (thorough explanations)\n\n5. **Specific Patterns** - Any phrases or patterns you always use?\n   - Examples: \"Does [time] work for you?\", \"Let's sync on this\", specific greetings\n\n### Step 3: Calendar Preferences\n\nAsk about calendar management:\n\n1. **Default meeting duration** (Default: 30 minutes)\n2. **Buffer time between meetings** (Default: 15 minutes)\n3. **Calendar link for scheduling** (If they have one)\n4. **Event naming preferences** (Include location? Attendee names?)\n5. **Auto-add events from email?** (Yes/No - should calendar skill proactively add events)\n\n### Step 4: CRM Workflow\n\nAsk about contact management:\n\n1. **What type of contacts do you manage?**\n   - Professional (colleagues, clients, vendors)\n   - Personal (friends, family, social)\n   - Mixed (both personal and professional)\n\n2. **How detailed should contact notes be?**\n   - Minimal (just basics)\n   - Standard (basic context about relationship)\n   - Detailed (thorough interaction logging)\n\n3. **Relationship tracking**\n   - Track how you know people (who introduced you)\n   - Log all interactions automatically\n   - Manual logging only\n\n### Step 5: Generate Configuration\n\nAfter gathering preferences, create a configuration file at:\n`~/.claude/office-admin-config.json`\n\n**Format:**\n```json\n{\n  \"version\": \"1.0\",\n  \"personal\": {\n    \"name\": \"User's Name\",\n    \"timezone\": \"America/Chicago\",\n    \"workingHours\": {\n      \"start\": \"09:30\",\n      \"end\": \"16:30\",\n      \"lunchStart\": \"12:00\",\n      \"lunchEnd\": \"13:30\"\n    }\n  },\n  \"email\": {\n    \"tone\": \"ultra-terse\",\n    \"signature\": \"none\",\n    \"formality\": \"casual\",\n    \"responseLength\": \"minimal\",\n    \"patterns\": [\n      \"how about [time]?\",\n      \"that works perfect\"\n    ],\n    \"customGuidelines\": \"Additional freeform guidelines from user\"\n  },\n  \"calendar\": {\n    \"defaultDuration\": 30,\n    \"bufferMinutes\": 15,\n    \"schedulingLink\": \"https://user.cal.com/schedule\",\n    \"autoAddFromEmail\": true,\n    \"eventNaming\": {\n      \"includeLocation\": true,\n      \"includeAttendees\": false\n    }\n  },\n  \"crm\": {\n    \"contactTypes\": \"mixed\",\n    \"detailLevel\": \"standard\",\n    \"autoLogInteractions\": true,\n    \"trackRelationships\": true\n  }\n}\n```\n\n### Step 6: MCP Server Setup Guide\n\nAfter configuration, provide guidance on required MCP servers:\n\n**Required Servers:**\n1. **Gmail** - For email management\n   - Installation: Follow Gmail MCP setup docs\n   - Scopes needed: read, send, drafts, labels\n\n2. **Google Calendar** - For calendar management\n   - Installation: Follow Calendar MCP setup docs\n   - Scopes needed: read, write events\n\n3. **Pagen CRM** (optional) - For contact/company/deal management\n   - Installation: Set up Pagen MCP server\n   - Requires: Database configuration\n\n4. **Notion** (optional) - For advanced note-taking integration\n   - Installation: Follow Notion MCP setup docs\n\nProvide installation links and next steps.\n\n### Step 7: Create Personal Style Guide\n\nGenerate a markdown file at `~/.claude/docs/office-admin-style.md` with:\n\n```markdown\n# My Office Admin Style Guide\n\n## About Me\n- Name: [User's Name]\n- Timezone: [Timezone]\n- Working Hours: [Hours]\n\n## Email Style\n\n### Tone\n[Description of their tone with 3-4 example phrases]\n\n### Typical Responses\n- Scheduling: [Example]\n- Quick confirms: [Example]\n- Declining: [Example]\n\n### What NOT to Do\n- [Anti-patterns based on their preferences]\n\n## Calendar Preferences\n[Summary of their calendar settings]\n\n## CRM Workflow\n[Summary of their contact management approach]\n```\n\n## Completing Onboarding\n\nAfter setup:\n1. Confirm configuration was saved\n2. Show the user their style guide\n3. Suggest they try `/triage-email` or `/draft-email` to test\n4. Remind them they can re-run `/setup-office-admin` to update preferences\n\n## Example Interaction\n\n```\nAssistant: I'm using the office:onboarding skill to help you set up your personal productivity style.\n\nWhat should I call you?\n\nUser: Call me Alex"
      },
      "plugins": [
        {
          "name": "office-admin",
          "source": "./",
          "description": null,
          "categories": [],
          "install_commands": [
            "/plugin marketplace add harperreed/office-admin-claude",
            "/plugin install office-admin@office.harper.dev"
          ]
        }
      ]
    }
  ]
}