{
  "author": {
    "id": "27Bslash6",
    "display_name": "Ray Walker",
    "avatar_url": "https://avatars.githubusercontent.com/u/2221076?v=4"
  },
  "marketplaces": [
    {
      "name": "27b",
      "version": null,
      "description": "27B.io plugin marketplace - Security and productivity tools for Claude Code",
      "repo_full_name": "27Bslash6/schlock",
      "repo_url": "https://github.com/27Bslash6/schlock",
      "repo_description": "Claude Code safety net - prevent dangerous Bash tool invocations before they happen",
      "signals": {
        "stars": 1,
        "forks": 0,
        "pushed_at": "2025-12-18T23:58:09Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"27b\",\n  \"owner\": {\n    \"name\": \"27B.io\",\n    \"email\": \"hello@27b.io\"\n  },\n  \"metadata\": {\n    \"description\": \"27B.io plugin marketplace - Security and productivity tools for Claude Code\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"schlock\",\n      \"source\": \"./\",\n      \"description\": \"LLM command safety validator. Blocks dangerous bash commands and Claude advertising spam.\",\n      \"version\": \"0.3.1\",\n      \"author\": {\n        \"name\": \"27B.io\"\n      },\n      \"homepage\": \"https://github.com/27Bslash6/schlock\",\n      \"license\": \"WTFPL\",\n      \"keywords\": [\n        \"safety\",\n        \"validation\",\n        \"bash\",\n        \"hooks\",\n        \"security\"\n      ],\n      \"category\": \"security\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"schlock\",\n  \"version\": \"0.3.1\",\n  \"description\": \"LLM command safety validator for AI coding assistants. Blocks dangerous bash commands and Claude advertising spam.\",\n  \"author\": {\n    \"name\": \"27B.io\",\n    \"url\": \"https://27b.io\"\n  },\n  \"repository\": \"https://github.com/27Bslash6/schlock\",\n  \"license\": \"WTFPL\",\n  \"keywords\": [\n    \"safety\",\n    \"validation\",\n    \"bash\",\n    \"hooks\",\n    \"security\"\n  ]\n}\n",
        "README.md": "# schlock\n\n**A safety net for Claude Code** â€” Intercepts dangerous bash commands before they execute.\n\n\n[![Tests](https://github.com/27Bslash6/schlock/actions/workflows/test.yml/badge.svg)](https://github.com/27Bslash6/schlock/actions)\n[![codecov](https://codecov.io/github/27bslash6/schlock/graph/badge.svg?token=LWEX0I3SNE)](https://codecov.io/github/27bslash6/schlock)\n[![License](https://img.shields.io/badge/license-WTFPL-blue)](https://www.wtfpl.net/)\n\n**Features**: AST-based parsing (plus regex) Â· 60+ security rules Â· 3 risk presets Â· Audit logging Â· Commit ad-blocker\n\n[Quick Start](#quick-start) Â· [How It Works](#how-it-works) Â· [Configuration](#configuration) Â· [Docs](#documentation)\n\n---\n\n## The Problem\n\nYou're using Claude Code with `Bash(*)` permissions because you want it to actually get things done. But then it does this:\n\n```\nClaude: I'll clean up those temp files for you.\nClaude: Bash(`rm -rf project-*`)\n```\n\nWhile you're thinking: *\"Wait, which directory am I in? What else matches that glob? Did I have anything important in there?\"* it's already too late.\n\nOr worse:\n\n```\nClaude: Let me fix that git history.\nClaude: Bash(`git reset --hard HEAD~5`)\nClaude: Bash(`git push --force origin main`)\n```\n\nBy the time you've processed what happened, it's done. Your git history is rewritten. Your team is not happy.\n\n## The Solution\n\n**schlock** is a Claude Code plugin that intercepts every bash command and blocks the dangerous ones *before* they execute.\n\n```\nClaude: Bash(`rm -rf /`)\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ ğŸš« BLOCKED by schlock                               â”‚\nâ”‚                                                     â”‚\nâ”‚ Command: rm -rf /                                   â”‚\nâ”‚ Risk: BLOCKED - Recursive delete from root          â”‚\nâ”‚                                                     â”‚\nâ”‚ This command would delete your entire filesystem.   â”‚\nâ”‚ If you actually need to do this, run it manually.   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\nClaude sees the rejection and adjusts. Your filesystem survives. You sleep at night.\n\n---\n\n## Quick Start\n\n```bash\n# In Claude Code\n/plugin marketplace add 27Bslash6/schlock\n/plugin install schlock@schlock\n\n# Optional\n/schlock:setup\n```\n\nThat's it. Safety validation is automatic. The setup wizard configures to your liking.\n\n**Recommended**: Install [ShellCheck](https://www.shellcheck.net/) for enhanced security detection:\n\n```bash\n# macOS\nbrew install shellcheck\n\n# Linux\napt-get install shellcheck  # or: dnf install ShellCheck\n```\n\nShellCheck catches command injection, format string vulnerabilities, and the infamous \"MongoDB disaster\" pattern (`rm -rf $EMPTY_VAR/*` â†’ `rm -rf /*`). schlock integrates automatically when ShellCheck is available.\n\n**Zero friction**: <1ms validation on most commands. You won't notice it's there.\n\n**Team installation**: Add to `.claude/settings.json` and commit â€” teammates get it automatically when they trust the repo. See [docs/INSTALLING.md](docs/INSTALLING.md).\n\n---\n\n## How It Works\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Claude wants â”‚     â”‚   schlock    â”‚     â”‚   Command    â”‚\nâ”‚ to run bash  â”‚ â”€â”€â–¶ â”‚  validates   â”‚ â”€â”€â–¶ â”‚   executes   â”‚\nâ”‚   command    â”‚     â”‚   command    â”‚     â”‚  (or not)    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                            â”‚\n                     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”\n                     â”‚             â”‚\n                 â”Œâ”€â”€â”€â–¼â”€â”€â”€â”    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”\n                 â”‚ Parse â”‚    â”‚ Match â”‚\n                 â”‚  AST  â”‚    â”‚ Rules â”‚\n                 â””â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n1. **Hook**: schlock registers a `PreToolUse` hook with Claude Code\n2. **Parse**: When Claude calls `Bash()`, schlock parses the command using [bashlex](https://github.com/idank/bashlex) (proper AST, not regex)\n3. **Match**: The parsed command is checked against 40+ security rules\n4. **Decide**: Commands are allowed, warned, or blocked based on risk level\n5. **Log**: Every decision is logged to `~/.config/schlock/audit.jsonl`\n\n**Why AST parsing matters**: Regex-based blockers are trivially bypassed. `rm -rf /` is easy to catch, but what about `r\\m -rf /` or `$(echo rm) -rf /`? bashlex parses the actual shell semantics, not string patterns.\n\n---\n\n## What Gets Caught\n\nEvery command is classified into a risk level:\n\n| Risk Level | What | Examples |\n|------------|------|----------|\n| ğŸš« **BLOCKED** | System destruction, credential exposure | `rm -rf /`, `chmod 000 /`, `cat ~/.ssh/id_rsa` |\n| âš ï¸ **HIGH** | History rewriting, broad permissions | `git push --force`, `chmod 777`, `sudo rm` |\n| âš¡ **MEDIUM** | Risky patterns | `curl \\| sh`, `eval \"$var\"` |\n| â„¹ï¸ **LOW** | Potentially slow/resource-intensive | `find / -name`, `dd if=/dev` |\n| âœ… **SAFE** | Read-only operations | `ls`, `git status`, `cat file.txt` |\n\nWhat happens at each level depends on your [risk tolerance preset](#risk-tolerance). By default (balanced), BLOCKED commands are denied, HIGH commands prompt for confirmation, and everything else is allowed.\n\nSee [`data/rules/`](data/rules/) for the complete ruleset (60+ rules across multiple categories).\n\n---\n\n## Performance\n\nschlock is designed to be invisible:\n\n| Operation | Time |\n|-----------|------|\n| Cached validation | <0.5ms |\n| Simple command | <1ms |\n| Complex pipeline | <15ms |\n| Throughput | ~100/sec |\n\nYou won't notice it's there â€” until it saves you.\n\n---\n\n## Configuration\n\n### Risk Tolerance\n\nNot everyone wants the same level of protection. schlock has three presets:\n\n| Preset | BLOCKED | HIGH | MEDIUM | LOW | Best For |\n|--------|---------|------|--------|-----|----------|\n| **permissive** | ğŸš« deny | âœ… allow | âœ… allow | âœ… allow | Experienced users, local dev |\n| **balanced** *(default)* | ğŸš« deny | â“ ask | âœ… allow | âœ… allow | Most users |\n| **paranoid** | ğŸš« deny | ğŸš« deny | â“ ask | âœ… allow | Production, compliance |\n\nConfigure in `.claude/hooks/schlock-config.yaml`:\n\n```yaml\nrisk_tolerance:\n  preset: balanced  # or: permissive, paranoid\n```\n\nOr go custom:\n\n```yaml\nrisk_tolerance:\n  levels:\n    SAFE: allow\n    LOW: allow\n    MEDIUM: allow\n    HIGH: ask      # Prompt before allowing\n    BLOCKED: deny  # Always block\n```\n\n**Actions explained:**\n- `allow` â€” Execute without prompting\n- `ask` â€” Prompt user for confirmation\n- `deny` â€” Block execution, Claude must find another way\n\n### ShellCheck Integration\n\nIf ShellCheck is installed, enable integration for enhanced security analysis:\n\n```yaml\nshellcheck:\n  enabled: true\n  severity: info        # info, warning, or error\n  security_only: true   # Only flag security-relevant issues\n```\n\nThis catches vulnerabilities that AST parsing alone can't detect:\n- **SC2114/SC2115**: System destruction (`rm -rf $var/*` where `$var` is empty)\n- **SC2086/SC2046**: Command injection via unquoted variables\n- **SC2059**: Format string vulnerabilities in `printf`\n- **SC2156**: Filename injection in `find -exec`\n\n### Advertising Blocker\n\nOptional but recommended. Blocks \"Generated with Claude Code\" spam from commits:\n\n```yaml\ncommit_filter:\n  enabled: true\n  rules:\n    advertising:\n      enabled: true\n```\n\nSee [docs/CONFIGURATION.md](docs/CONFIGURATION.md) for advanced options and team-wide settings.\n\n---\n\n## Limitations\n\nschlock is **defense-in-depth**, not a security boundary. It catches obvious mistakes and dangerous patterns. It won't stop:\n\n- A determined attacker (or LLM) trying to bypass it\n- Commands that are dangerous in context but safe in isolation\n- Anything that doesn't go through Claude Code's `Bash()` tool\n\nThink of it like a seatbelt: you should still drive carefully, but it's better than nothing.\n\n---\n\n## Documentation\n\n- [**INSTALLING.md**](docs/INSTALLING.md) â€” Installation guide (individual, team, troubleshooting)\n- [**CONFIGURATION.md**](docs/CONFIGURATION.md) â€” Power-user configuration\n- [**CHANGELOG.md**](docs/CHANGELOG.md) â€” Release history\n- [**CONTRIBUTING.md**](CONTRIBUTING.md) â€” Development workflow\n\n---\n\n## The Name\n\n\"Schlock\" is slang for cheap, low-quality horror movies â€” the kind where you yell at the screen because the character is about to do something obviously stupid.\n\nThat's what this plugin does. It yells at Claude before it does something obviously stupid.\n\nSecure Claude Hook LOCK? ğŸ’­\n\n---\n\n## License\n\n[WTFPL](LICENSE) â€” Do what you want. Just don't blame us if Claude still finds a way to `rm -rf /` your production server.\n"
      },
      "plugins": [
        {
          "name": "schlock",
          "source": "./",
          "description": "LLM command safety validator. Blocks dangerous bash commands and Claude advertising spam.",
          "version": "0.3.1",
          "author": {
            "name": "27B.io"
          },
          "homepage": "https://github.com/27Bslash6/schlock",
          "license": "WTFPL",
          "keywords": [
            "safety",
            "validation",
            "bash",
            "hooks",
            "security"
          ],
          "category": "security",
          "categories": [
            "bash",
            "hooks",
            "safety",
            "security",
            "validation"
          ],
          "install_commands": [
            "/plugin marketplace add 27Bslash6/schlock",
            "/plugin install schlock@27b"
          ]
        }
      ]
    }
  ]
}