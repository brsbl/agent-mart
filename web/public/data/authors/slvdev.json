{
  "author": {
    "id": "slvDev",
    "display_name": "Slava S.",
    "avatar_url": "https://avatars.githubusercontent.com/u/15254847?u=e843f2d73087b964653fa395c9efc992210419d2&v=4"
  },
  "marketplaces": [
    {
      "name": "weasel",
      "version": null,
      "description": "Weasel - Solidity static analyzer with AI integration",
      "repo_full_name": "slvDev/weasel",
      "repo_url": "https://github.com/slvDev/weasel",
      "repo_description": "Solidity static analyzer you can talk to. MCP integration for Claude Code, Cursor, and Windsurf.",
      "signals": {
        "stars": 23,
        "forks": 0,
        "pushed_at": "2026-01-27T10:26:46Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"$schema\": \"https://anthropic.com/claude-code/marketplace.schema.json\",\n  \"name\": \"weasel\",\n  \"description\": \"Weasel - Solidity static analyzer with AI integration\",\n  \"owner\": {\n    \"name\": \"slvDev\"\n  },\n  \"metadata\": {\n    \"description\": \"Security-focused static analysis tool for Solidity smart contracts with AI-powered skills for auditing and secure development\",\n    \"version\": \"1.0.0\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"weasel\",\n      \"description\": \"Solidity static analysis with security skills for auditing and secure development\",\n      \"source\": \"./weasel\",\n      \"version\": \"0.4.5\",\n      \"author\": {\n        \"name\": \"slvDev\"\n      },\n      \"homepage\": \"https://github.com/slvDev/weasel\",\n      \"repository\": \"https://github.com/slvDev/weasel\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"solidity\", \"security\", \"audit\", \"smart-contracts\", \"static-analysis\"],\n      \"category\": \"security\",\n      \"tags\": [\"web3\", \"ethereum\", \"defi\", \"vulnerability-detection\"]\n    }\n  ]\n}\n",
        "README.md": "<h1 align=\"center\">Weasel</h1>\n\n<p align=\"center\">\n  <strong>Solidity static analyzer you can talk to</strong>\n</p>\n\n<p align=\"center\">\n  Ask your AI assistant to audit your contracts. Get explained results.\n</p>\n\n<p align=\"center\">\n  <a href=\"https://opensource.org/licenses/MIT\"><img src=\"https://img.shields.io/badge/License-MIT-blue.svg\" alt=\"License: MIT\"></a>\n  <a href=\"#installation\"><img src=\"https://img.shields.io/badge/install-weaselup-green.svg\" alt=\"Install\"></a>\n  <img src=\"https://img.shields.io/badge/⚡-Blazing_Fast-orange\" alt=\"Blazing Fast\">\n</p>\n\n<p align=\"center\">\n  <img src=\"assets/demo.gif\" alt=\"Weasel demo\" width=\"800\">\n</p>\n\n```bash\n# 1. Install weasel\ncurl -L https://raw.githubusercontent.com/slvDev/weasel/main/weaselup/install | bash\n\n# 2. Add to your AI tool:\n# Claude Code (recommended - MCP + skills)\n/plugin marketplace add slvDev/weasel\n/plugin install weasel\n\n# MCP only for Claude Code, Cursor, Windsurf, Codex, Gemini\nweasel mcp add\n```\n\nNow just say `weasel <command>`:\n\n> \"weasel analyze my contracts\"\n\n> \"weasel poc for this reentrancy bug\"\n\n> \"weasel report this finding\"\n\n> \"weasel explain this function\"\n\nWeasel skills activate. Your AI runs analysis, writes PoCs, formats reports, and more.\n\n---\n\n## Features\n\n- **AI-Native Skills** — 9 specialized skills for Claude Code (PoC writing, report formatting, gas optimization, and more)\n- **Blazing Fast** — Parallel Rust analysis, instant MCP responses\n- **MCP Server** — Works with Claude Code, Cursor, Windsurf, OpenAI Codex, Gemini CLI, and any MCP-compatible tool\n- **Extensive Detectors** — Vulnerabilities, gas optimizations, and code quality checks\n- **Auto-Detection** — Automatically configures for Foundry, Hardhat, and Truffle projects\n\n---\n\n## Why Weasel?\n\n|                    | Weasel                              | Other Analyzers              |\n| ------------------ | ----------------------------------- | ---------------------------- |\n| **AI Integration** | Native skills + MCP                 | Copy-paste output to ChatGPT |\n| **Setup**          | `plugin install` / `mcp add`        | Manual config, scripts       |\n| **Workflow**       | \"weasel poc for this bug\"           | Read reports, search fixes   |\n| **Context**        | AI knows Solidity security patterns | Context lost between tools   |\n| **Speed**          | Parallel Rust analysis              | Often single-threaded        |\n\n---\n\n## Installation\n\n```bash\ncurl -L https://raw.githubusercontent.com/slvDev/weasel/main/weaselup/install | bash\n```\n\nUpdate anytime with `weaselup`. Use `weaselup --nightly` for latest dev build.\n\n<details>\n<summary>From Source</summary>\n\n```bash\ngit clone https://github.com/slvDev/weasel.git\ncd weasel && cargo build --release\n```\n\n</details>\n\n---\n\n## Claude Code Integration\n\nFor **Claude Code** users, install the Weasel plugin for intelligent skills:\n\n```bash\n/plugin marketplace add slvDev/weasel\n/plugin install weasel\n```\n\nUse `weasel` prefix to activate skills:\n\n**Audit:**\n\n| Skill             | What it does                                              |\n| ----------------- | --------------------------------------------------------- |\n| `weasel analyze`  | Security review (quick scan / manual review / full audit) |\n| `weasel validate` | Verify if attack hypothesis is exploitable                |\n| `weasel filter`   | Triage findings, filter false positives                   |\n| `weasel poc`      | Write exploit PoC (Foundry/Hardhat)                       |\n| `weasel report`   | Format findings as professional audit report              |\n| `weasel overview` | Scope project, map architecture/attack surface            |\n\n**Dev:**\n\n| Skill             | What it does                                   |\n| ----------------- | ---------------------------------------------- |\n| `weasel gas`      | Find and implement gas optimizations           |\n| `weasel explain`  | Explain code logic, patterns, and risks        |\n| `weasel simplify` | Refactor for clarity without changing behavior |\n\n**Skills provide context-aware expertise** — Claude knows how to analyze Solidity, write PoCs in Foundry/Hardhat, format audit reports, and more. The `weasel` prefix ensures skills only activate when you want them.\n\n> To update the plugin, run `/plugin update weasel` in Claude Code.\n\n---\n\n## IDE Integration (MCP)\n\nFor **Cursor**, **Windsurf**, **Codex**, **Gemini**, or Claude Code without skills:\n\n```bash\nweasel mcp add                      # auto-detect all installed IDEs\nweasel mcp add --target cursor      # Cursor only\nweasel mcp add --target windsurf    # Windsurf only\nweasel mcp add --target claude      # Claude Code only\nweasel mcp add --target codex       # OpenAI Codex only\nweasel mcp add --target gemini      # Gemini CLI only\n```\n\n| IDE          | MCP Tools | Skills                     |\n| ------------ | --------- | -------------------------- |\n| Claude Code  | yes       | yes (via `/plugin install`) |\n| Cursor       | yes       | no                         |\n| Windsurf     | yes       | no                         |\n| OpenAI Codex | yes       | no                         |\n| Gemini CLI   | yes       | no                         |\n\nMCP tools (`weasel_analyze`, `weasel_finding_details`, `weasel_detectors`) work in all IDEs. Skills (PoC writing, report formatting, etc.) are Claude Code exclusive.\n\n---\n\n## What It Detects\n\n| Severity   | What                     | Examples                                        |\n| ---------- | ------------------------ | ----------------------------------------------- |\n| **High**   | Critical vulnerabilities | Reentrancy, unchecked calls, delegatecall risks |\n| **Medium** | Security concerns        | Missing access control, oracle manipulation     |\n| **Low**    | Best practices           | Unlocked pragma, zero-address checks            |\n| **Gas**    | Optimizations            | Storage reads, loop efficiency, packing         |\n| **NC**     | Code quality             | Naming, style, documentation                    |\n\nRun `weasel detectors` to see all checks, or ask your AI: _\"what can weasel detect?\"_\n\n---\n\n## How It Works\n\n<p align=\"center\">\n  <img src=\"assets/flow.png\" alt=\"Weasel flow\" width=\"800\">\n</p>\n\n<p align=\"center\">\n  Your AI calls Weasel via MCP, gets structured findings, and explains them to you.\n</p>\n\n| MCP Command              | What It Does                        |\n| ------------------------ | ----------------------------------- |\n| `weasel_analyze`         | Scan contracts, get compact summary |\n| `weasel_finding_details` | Deep dive into specific issues      |\n| `weasel_detectors`       | List all available checks           |\n\n---\n\n## Standalone Usage\n\nNo AI? Weasel works great from the terminal.\n\n```bash\nweasel run                              # analyze ./src\nweasel run -s ./contracts               # specify path\nweasel run -e ./test -e ./mocks         # exclude paths\nweasel run -m High                      # only critical\nweasel run -o report.md                 # save report\nweasel run -o report -f json            # JSON format\nweasel run -o report -f sarif           # SARIF format (for GitHub Code Scanning)\n```\n\n### Detectors\n\n```bash\nweasel detectors                # list all\nweasel detectors -s High        # filter by severity\nweasel detectors -d <id>        # details for one\n```\n\n### Configuration\n\nCreate `weasel.toml` with `weasel init`:\n\n```toml\nscope = [\"src\", \"contracts\"]\nexclude = [\"test\", \"script\"]\nmin_severity = \"Low\"\nformat = \"md\"\nremappings = [\"@openzeppelin/=lib/openzeppelin-contracts/\"]\nexclude_detectors = [\"floating-pragma\", \"line-length\"]\n\n[protocol]\nuses_fot_tokens = true       # Fee-on-transfer token detectors\nuses_weird_erc20 = true      # Non-standard ERC20 detectors\nuses_native_token = true     # Native ETH handling detectors\nuses_l2 = true               # L2-specific detectors (Arbitrum, Optimism)\nuses_nft = true              # NFT-related detectors\n```\n\n| Option                | Short | Default           |\n| --------------------- | ----- | ----------------- |\n| `--scope`             | `-s`  | `[\"src\"]`         |\n| `--exclude`           | `-e`  | `[\"lib\", \"test\"]` |\n| `--min-severity`      | `-m`  | `NC`              |\n| `--format`            | `-f`  | `md`              |\n| `--output`            | `-o`  | stdout            |\n| `--remappings`        | `-r`  | auto              |\n| `--exclude-detectors` | `-x`  | none              |\n\n**Priority:** CLI flags > config file > auto-detection\n\n---\n\n## GitHub Actions\n\nRun Weasel in your CI/CD pipeline:\n\n```yaml\n- uses: slvDev/weasel@main\n```\n\n### Example Workflow\n\n```yaml\nname: Security\n\non: [push, pull_request]\n\njobs:\n  weasel:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - uses: slvDev/weasel@main\n        with:\n          path: ./src\n          fail-on: High\n          exclude: test,mocks\n```\n\n### Nightly Builds\n\nUse the latest development version:\n\n```yaml\n- uses: slvDev/weasel@main\n  with:\n    version: nightly\n```\n\n### GitHub Code Scanning\n\nEnable inline findings in PR diffs and the Security tab:\n\n```yaml\n- uses: slvDev/weasel@main\n  with:\n    sarif: true\n    upload-sarif: true\n```\n\nRequires `security-events: write` permission.\n\n### AI-Powered Review (Experimental)\n\nCombine Weasel with Claude, OpenAI, or Gemini for intelligent security review:\n\n```yaml\n- uses: anthropics/claude-code-action@v1\n  with:\n    anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}\n    claude_args: |\n      --mcp-config '{\"mcpServers\":{\"weasel\":{\"command\":\"weasel\",\"args\":[\"mcp\",\"serve\"]}}}'\n```\n\nAI can analyze findings, filter false positives, and suggest fixes.\n\n**Ready-to-use examples** in [`gh-actions-examples/`](gh-actions-examples/):\n\n| File | Description |\n|------|-------------|\n| `weasel-basic.yml` | Basic Weasel analysis with SARIF upload |\n| `weasel-claude.yml` | Claude filters false positives, outputs clean SARIF |\n| `weasel-openai.yml` | OpenAI Codex filters false positives, outputs clean SARIF |\n| `weasel-gemini.yml` | Gemini filters false positives, outputs clean SARIF |\n| `weasel-claude-diff.yml` | Claude reviews PR diff for logic bugs |\n| `weasel-openai-diff.yml` | OpenAI reviews PR diff for logic bugs |\n| `weasel-gemini-diff.yml` | Gemini reviews PR diff for logic bugs |\n\n\n### Verify Downloads\n\nRelease binaries include SHA256 checksums and build attestation:\n\n```bash\n# Verify checksum\nsha256sum -c checksums.txt\n\n# Verify attestation (requires gh CLI)\ngh attestation verify weasel-<target>.tar.gz --owner slvDev\n# Example: gh attestation verify weasel-aarch64-apple-darwin.tar.gz --owner slvDev\n```\n\n### Inputs\n\n| Input | Description | Default |\n|-------|-------------|---------|\n| `version` | Weasel version (`latest`, `nightly`, or specific like `0.5.0`) | `latest` |\n| `path` | Path to analyze | `.` |\n| `min-severity` | Minimum severity to report | `Low` |\n| `fail-on` | Fail CI at this severity (`High`, `Medium`, `Low`, `none`) | `none` |\n| `exclude` | Paths to exclude (comma-separated) | |\n| `config` | Path to `weasel.toml` | |\n| `sarif` | Generate SARIF output for Code Scanning | `false` |\n| `upload-sarif` | Upload SARIF to GitHub Code Scanning | `false` |\n\n### Outputs\n\n| Output | Description |\n|--------|-------------|\n| `findings` | Number of issues found |\n| `report` | Path to JSON report |\n| `sarif-report` | Path to SARIF report (if `sarif: true`) |\n\n---\n\n## Project Support\n\n**Foundry** — Remappings loaded in order:\n\n1. Default paths (`forge-std/`, `@openzeppelin/`)\n2. `remappings.txt`\n3. `foundry.toml`\n4. CLI `-r` flags\n\n**Hardhat / Truffle** — Auto-detects config, uses `node_modules/`, defaults to `./contracts`\n\n---\n\n## FAQ\n\n<details>\n<summary><strong>AI can't find Weasel?</strong></summary>\n\n```bash\nwhich weasel          # should show path\nweasel mcp add        # re-run setup\n# restart your AI tool\n```\n\n</details>\n\n<details>\n<summary><strong>How do I check MCP config?</strong></summary>\n\n```bash\ncat ~/.claude.json              # Claude Code\ncat ~/.cursor/mcp.json          # Cursor\ncat ~/.codeium/windsurf/mcp_config.json  # Windsurf\n```\n\n</details>\n\n<details>\n<summary><strong>Manual MCP setup</strong></summary>\n\nAdd to your AI tool's config:\n\n```json\n{\n  \"mcpServers\": {\n    \"weasel\": {\n      \"type\": \"stdio\",\n      \"command\": \"/path/to/weasel\",\n      \"args\": [\"mcp\", \"serve\"]\n    }\n  }\n}\n```\n\n</details>\n\n<details>\n<summary><strong>How do I exclude test files?</strong></summary>\n\n```bash\nweasel run -e ./test -e ./src/mocks\n```\n\n</details>\n\n<details>\n<summary><strong>How do I analyze only critical issues?</strong></summary>\n\n```bash\nweasel run -m High\n```\n\n</details>\n\n---\n\n## License\n\nMIT — [LICENSE.md](LICENSE.md)\n"
      },
      "plugins": [
        {
          "name": "weasel",
          "description": "Solidity static analysis with security skills for auditing and secure development",
          "source": "./weasel",
          "version": "0.4.5",
          "author": {
            "name": "slvDev"
          },
          "homepage": "https://github.com/slvDev/weasel",
          "repository": "https://github.com/slvDev/weasel",
          "license": "MIT",
          "keywords": [
            "solidity",
            "security",
            "audit",
            "smart-contracts",
            "static-analysis"
          ],
          "category": "security",
          "tags": [
            "web3",
            "ethereum",
            "defi",
            "vulnerability-detection"
          ],
          "categories": [
            "audit",
            "defi",
            "ethereum",
            "security",
            "smart-contracts",
            "solidity",
            "static-analysis",
            "vulnerability-detection",
            "web3"
          ],
          "install_commands": [
            "/plugin marketplace add slvDev/weasel",
            "/plugin install weasel@weasel"
          ]
        }
      ]
    }
  ]
}