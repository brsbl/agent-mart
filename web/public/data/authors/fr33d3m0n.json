{
  "author": {
    "id": "fr33d3m0n",
    "display_name": "fr33d3m0n",
    "type": "User",
    "avatar_url": "https://avatars.githubusercontent.com/u/127989854?v=4",
    "url": "https://github.com/fr33d3m0n",
    "bio": null,
    "stats": {
      "total_marketplaces": 1,
      "total_plugins": 1,
      "total_commands": 0,
      "total_skills": 1,
      "total_stars": 127,
      "total_forks": 16
    }
  },
  "marketplaces": [
    {
      "name": "skill-threat-modeling",
      "version": null,
      "description": "Code-First Deep Threat Modeling - LLM-native security analysis framework with automated 8-phase workflow, dual-track knowledge architecture (Security Controls + Threat Patterns), and comprehensive verification capabilities. Transform any codebase into structured threat models without design documents.",
      "owner_info": {
        "name": "fr33d3m0n",
        "url": "https://github.com/fr33d3m0n"
      },
      "keywords": [],
      "repo_full_name": "fr33d3m0n/skill-threat-modeling",
      "repo_url": "https://github.com/fr33d3m0n/skill-threat-modeling",
      "repo_description": "Code-First Deep Risk Analysis Skill for Claude Code - 8-Phase Workflow with Security design review, STRIDE Threat modeling, PenTest and attack chain analysis, Software compliance assessment",
      "homepage": null,
      "signals": {
        "stars": 127,
        "forks": 16,
        "pushed_at": "2026-01-26T17:02:57Z",
        "created_at": "2026-01-03T09:56:18Z",
        "license": "BSD-3-Clause"
      },
      "file_tree": [
        {
          "path": ".claude-plugin",
          "type": "tree",
          "size": null
        },
        {
          "path": ".claude-plugin/marketplace.json",
          "type": "blob",
          "size": 7569
        },
        {
          "path": ".claude-plugin/plugin.json",
          "type": "blob",
          "size": 764
        },
        {
          "path": "README.md",
          "type": "blob",
          "size": 15114
        },
        {
          "path": "SKILL.md",
          "type": "blob",
          "size": 74518
        }
      ],
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"skill-threat-modeling\",\n  \"owner\": {\n    \"name\": \"fr33d3m0n\",\n    \"url\": \"https://github.com/fr33d3m0n\"\n  },\n  \"metadata\": {\n    \"description\": \"Code-First Deep Threat Modeling - LLM-native security analysis framework with automated 8-phase workflow, dual-track knowledge architecture (Security Controls + Threat Patterns), and comprehensive verification capabilities. Transform any codebase into structured threat models without design documents.\",\n    \"version\": \"2.2.1\",\n    \"license\": \"BSD-3-Clause\",\n    \"homepage\": \"https://github.com/fr33d3m0n/skill-threat-modeling\",\n    \"documentation\": \"https://github.com/fr33d3m0n/skill-threat-modeling/wiki\",\n    \"changelog\": \"https://github.com/fr33d3m0n/skill-threat-modeling/blob/main/CHANGELOG.md\",\n    \"keywords\": [\n      \"threat-modeling\",\n      \"STRIDE\",\n      \"security-assessment\",\n      \"DFD\",\n      \"risk-validation\",\n      \"penetration-testing\",\n      \"OWASP\",\n      \"CWE\",\n      \"CAPEC\",\n      \"MITRE-ATT&CK\",\n      \"code-first\",\n      \"automated-security\",\n      \"LLM-native\",\n      \"AI-security\"\n    ],\n    \"categories\": [\n      \"security\",\n      \"code-analysis\",\n      \"threat-intelligence\",\n      \"compliance\",\n      \"risk-assessment\"\n    ],\n    \"languages\": [\n      \"en\",\n      \"zh\"\n    ]\n  },\n  \"plugins\": [\n    {\n      \"name\": \"threat-modeling\",\n      \"description\": \"Code-First Deep Threat Modeling Skill with strict 8-phase sequential workflow: P1 Project Understanding, P2 Call Flow & DFD Analysis, P3 Trust Boundary Evaluation, P4 Security Design Review, P5 STRIDE Threat Analysis, P6 Risk Validation with POC Design, P7 Mitigation Planning with ASVS alignment, P8 Report Generation with mandatory outputs.\",\n      \"source\": \"./\",\n      \"strict\": false,\n      \"skills\": [\n        \"./\"\n      ]\n    }\n  ],\n  \"installation\": {\n    \"scope\": \"user\",\n    \"instructions\": [\n      \"Run: /plugin install threat-modeling@skill-threat-modeling\",\n      \"Or: claude plugin install threat-modeling@skill-threat-modeling\",\n      \"Manual: Copy to ~/.claude/skills/threat-modeling/\"\n    ],\n    \"dependencies\": [],\n    \"post_install\": \"Skill auto-activates when triggered by: 'threat model', 'STRIDE', 'security assessment', 'DFD', 'risk analysis', '威胁建模', '安全评估'\"\n  },\n  \"features\": {\n    \"8_phase_workflow\": {\n      \"enabled\": true,\n      \"phases\": [\n        \"P1: Project Understanding - Codebase structure analysis, tech stack detection\",\n        \"P2: Call Flow & DFD - Data flow diagram construction from code\",\n        \"P3: Trust Boundary - Security zone identification and boundary mapping\",\n        \"P4: Security Design Review - 16 security domain assessment matrix\",\n        \"P5: STRIDE Analysis - Systematic threat enumeration with KB integration\",\n        \"P6: Risk Validation - Attack path verification, POC design, count conservation\",\n        \"P7: Mitigation Planning - Tech-specific remediation with ASVS alignment\",\n        \"P8: Report Generation - 4 mandatory reports + 6 phase documents\"\n      ]\n    },\n    \"knowledge_base\": {\n      \"5_layer_architecture\": true,\n      \"layer_1_threat_intelligence\": {\n        \"cwe_count\": 974,\n        \"capec_count\": 615,\n        \"attack_techniques\": 835,\n        \"cve_index\": 323830,\n        \"semantic_embeddings\": 3278\n      },\n      \"layer_2_security_controls\": {\n        \"security_domains\": 16,\n        \"control_sets\": 18,\n        \"owasp_references\": 74\n      },\n      \"layer_3_verification\": {\n        \"wstg_tests\": 121,\n        \"mastg_tests\": 206,\n        \"asvs_requirements\": 345\n      },\n      \"layer_4_compliance\": {\n        \"frameworks\": 14,\n        \"controls\": 115\n      },\n      \"layer_5_realtime\": {\n        \"nvd_api\": true,\n        \"kev_lookup\": true\n      }\n    },\n    \"output_formats\": [\n      \"markdown\",\n      \"mermaid-dfd\",\n      \"ascii-diagrams\",\n      \"yaml-structured\"\n    ],\n    \"bilingual\": true,\n    \"session_recovery\": true,\n    \"count_conservation\": true,\n    \"parallel_subagents\": true\n  },\n  \"usage_modes\": {\n    \"standard\": {\n      \"name\": \"Full 8-Phase Assessment\",\n      \"description\": \"Complete sequential threat modeling workflow\",\n      \"trigger\": \"threat model [project]\"\n    },\n    \"flexible_modes\": {\n      \"description\": \"Beyond 8-phase workflow - knowledge base as versatile security asset\",\n      \"modes\": [\n        {\n          \"name\": \"Knowledge Base Consultation\",\n          \"name_zh\": \"知识库咨询模式\",\n          \"description\": \"Use knowledge base as security consulting resource for developers, auditors, and architects\",\n          \"use_cases\": [\"Security questions during coding\", \"Vulnerability type understanding\", \"Best practice reference\"],\n          \"output\": \"Structured knowledge responses (CWE, attack patterns, test methods, mitigations)\"\n        },\n        {\n          \"name\": \"Deep Vulnerability Analysis\",\n          \"name_zh\": \"深度漏洞分析模式\",\n          \"description\": \"In-depth assessment of specific vulnerabilities or code snippets\",\n          \"use_cases\": [\"SAST tool report evaluation\", \"Penetration test findings deep-dive\", \"Security research\"],\n          \"output\": \"Vulnerability mechanism analysis, attack paths, POC design\"\n        },\n        {\n          \"name\": \"Security Test Generation\",\n          \"name_zh\": \"安全测试生成模式\",\n          \"description\": \"Generate automated security test cases based on knowledge base\",\n          \"use_cases\": [\"CI/CD pipeline testing\", \"Penetration test preparation\", \"Security training demos\"],\n          \"output\": \"WSTG-standard test case checklist\"\n        },\n        {\n          \"name\": \"Forward Integration (Design Phase Security)\",\n          \"name_zh\": \"前向集成模式\",\n          \"description\": \"Pre-emptive threat modeling during design phase - shift-left security\",\n          \"use_cases\": [\"New project security architecture\", \"Major feature change assessment\"],\n          \"input\": \"API specs (OpenAPI), design documents\",\n          \"output\": \"Endpoint-based DFD, trust boundary identification, STRIDE analysis\"\n        },\n        {\n          \"name\": \"Backward Integration (Penetration Test Support)\",\n          \"name_zh\": \"后向集成模式\",\n          \"description\": \"Attack path and POC support for penetration testing - shift-right validation\",\n          \"use_cases\": [\"Penetration test planning\", \"Vulnerability deep exploitation\", \"Security report generation\"],\n          \"output\": \"Attack chain construction, POC payloads, ATT&CK mapping\"\n        }\n      ]\n    }\n  },\n  \"design_principles\": {\n    \"code_first\": \"No design documents required - analyze directly from codebase\",\n    \"llm_autonomous\": \"Knowledge base provides context, not control - LLM performs semantic reasoning\",\n    \"dual_track_knowledge\": \"Security Control Set (defensive) + Threat Pattern Set (offensive)\",\n    \"context_not_control\": \"Empower LLM intelligence rather than constrain it\",\n    \"script_as_blackbox\": \"Scripts handle deterministic operations, LLM handles semantic analysis\"\n  },\n  \"security_domains\": [\n    \"AUTHN - Authentication & Session\",\n    \"AUTHZ - Authorization & Access Control\",\n    \"INPUT - Input Validation\",\n    \"OUTPUT - Output Encoding\",\n    \"CLIENT - Client-Side Security\",\n    \"CRYPTO - Cryptography & Transport\",\n    \"LOG - Logging & Monitoring\",\n    \"ERROR - Error Handling\",\n    \"API - API & Service Security\",\n    \"DATA - Data Protection\",\n    \"INFRA - Infrastructure Security\",\n    \"SUPPLY - Supply Chain Security\",\n    \"AI - AI/LLM Security (OWASP LLM Top 10)\",\n    \"MOBILE - Mobile Security\",\n    \"CLOUD - Cloud Security\",\n    \"AGENT - Agentic Security (OWASP ASI Top 10)\"\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"skill-threat-modeling\",\n  \"version\": \"2.2.1\",\n  \"description\": \"Code-First Deep Threat Modeling Skill - Automated 8-phase security analysis with STRIDE methodology, knowledge base integration, and risk validation\",\n  \"author\": {\n    \"name\": \"fr33d3m0n\",\n    \"url\": \"https://github.com/fr33d3m0n\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/fr33d3m0n/skill-threat-modeling\"\n  },\n  \"license\": \"BSD-3-Clause\",\n  \"keywords\": [\n    \"threat-modeling\",\n    \"STRIDE\",\n    \"security\",\n    \"DFD\",\n    \"risk-assessment\",\n    \"penetration-testing\",\n    \"OWASP\",\n    \"CWE\",\n    \"CAPEC\",\n    \"ATT&CK\"\n  ],\n  \"engines\": {\n    \"claude-code\": \">=1.0.0\"\n  },\n  \"categories\": [\n    \"security\",\n    \"code-analysis\",\n    \"documentation\"\n  ]\n}\n",
        "README.md": "# STRIDE Deep Threat Modeling Skill\n\n**Code-First Automated Threat Modeling Toolkit** | Version 2.2.1\n\n8-Phase Serial Workflow · Dual Knowledge Base Architecture · STRIDE+CWE+CAPEC+ATT&CK Full Chain Mapping · LLM-Native Design\n\n[Installation](#installation) · [Quick Start](#quick-start) · [Documentation](#documentation) · [中文版](README-cn.md)\n\n---\n\n## Overview\n\nA comprehensive **Code-First** threat modeling toolkit for Claude Code that transforms source code analysis into actionable security insights through an 8-phase serial workflow.\n\n### Key Features\n\n| Feature | Description |\n|---------|-------------|\n| **8-Phase Serial Workflow** | Strict sequential execution ensuring maximum depth and complete coverage |\n| **Dual Knowledge Base** | Core DB (969 CWE, 615 CAPEC) + CVE Extension (323K+ CVE) |\n| **Full Chain Mapping** | STRIDE → CWE → CAPEC → ATT&CK → CVE/KEV intelligence chain |\n| **Attack Path Validation** | CAPEC + ATT&CK attack chain mapping with POC design |\n| **KB-Enhanced Mitigations** | Context-aware mitigation suggestions per threat |\n| **AI/LLM Extensions** | OWASP LLM Top 10 + AI component threat coverage |\n| **Parallel Sub-Agent Support** | Multi-risk parallel analysis for large projects |\n| **Semantic Search** | 3,278 embeddings for intelligent threat lookup |\n\n### Workflow Overview\n\n```\nPhase 1 ──► Phase 2 ──► Phase 3 ──► Phase 4 ──► Phase 5 ──► Phase 6 ──► Phase 7 ──► Phase 8\nProject     Call Flow    Trust      Security    STRIDE      Risk        Mitigation   Report\nUnderstanding  DFD      Boundaries   Design     Analysis   Validation\n```\n\n---\n\n## Installation\n\n### Installation Options\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│                 How to Choose Installation?                  │\n├─────────────────────────────────────────────────────────────┤\n│                                                              │\n│  Personal use, share across projects  ──────►  Global       │\n│                                        ~/.claude/skills/     │\n│                                                              │\n│  Team collaboration, version control  ──────►  Project-local│\n│                                        project/.claude/skills│\n│                                                              │\n└─────────────────────────────────────────────────────────────┘\n```\n\n### System Requirements\n\n```\nPython 3.8+  |  PyYAML >= 6.0\n```\n\n### Option 1: Global Installation (Available to All Projects)\n\n```bash\n# Copy to Claude Code global skills directory\ncp -r threat-modeling ~/.claude/skills/threat-modeling\n\n# Install dependencies\npip install pyyaml\n```\n\n### Option 2: Project-Local Installation (Current Project Only)\n\n```bash\n# Create .claude/skills directory in project root\nmkdir -p /path/to/your-project/.claude/skills\n\n# Copy skill to project local\ncp -r threat-modeling /path/to/your-project/.claude/skills/threat-modeling\n\n# Install dependencies\npip install pyyaml\n```\n\n**Installation Comparison**:\n\n| Method | Path | Scope |\n|--------|------|-------|\n| Global | `~/.claude/skills/` | All projects |\n| Project-local | `project/.claude/skills/` | Current project only |\n\n> **Recommendation**: For team-shared security assessment projects, use project-local installation so the skill can be version controlled with project code.\n\n### Verify Installation\n\n```bash\npython scripts/unified_kb_query.py --all-stride --pretty\n```\n\n### Directory Structure\n\n```\nthreat-modeling/\n├── SKILL.md              # ← Claude Code entry point (8-phase workflow)\n├── WORKFLOW.md           # Detailed workflow templates\n├── scripts/              # Tool scripts\n│   ├── list_files.py         # Phase 1: Project structure analysis\n│   ├── stride_matrix.py      # Phase 5: STRIDE matrix\n│   └── unified_kb_query.py   # Phase 5/6/7: Unified KB query\n└── assets/knowledge/            # Dual database knowledge system (317MB)\n    ├── security_kb.sqlite        # Core DB (13MB)\n    └── security_kb_extension.sqlite  # CVE extension (304MB)\n```\n\n---\n\n## Quick Start\n\n### Using in Claude Code\n\n#### Auto-Activation\n\nThe skill automatically activates when you mention these keywords:\n\n| English | Chinese |\n|---------|---------|\n| threat model | 威胁建模 |\n| security assessment | 安全评估 |\n| DFD / data flow diagram | 数据流图 |\n| trust boundary | 信任边界 |\n| attack surface | 攻击面 |\n| STRIDE analysis | STRIDE 分析 |\n\n#### Usage Examples\n\n**Threat Modeling**\n```\nUser: Help me threat model @/path/to/project\n\nClaude: [Auto-activates skill]\n        Phase 1: Analyzing project structure...\n        Phase 2: Building DFD...\n        Phase 5: STRIDE analysis...\n\n        ## Threat List\n        | ID | Category | Description | Priority |\n        | T-S-P001-001 | Spoofing | API lacks authentication | Critical |\n        ...\n```\n\n**Quick Security Check**\n```\nUser: Quick security check on this service @/path/to/service\n\nClaude: Found 3 high-severity threats:\n        - T-S-P001-001: API endpoint lacks authentication\n        - T-E-P002-001: Delete endpoint missing authorization\n        - T-I-DF001-001: Sensitive data transmitted in plaintext\n```\n\n**AI/LLM Applications**\n```\nUser: Analyze security risks for this RAG app @/path/to/rag-app\n\nClaude: [Enables OWASP LLM Top 10 extension]\n        - LLM01: Prompt Injection risk\n        - LLM06: Sensitive information disclosure risk\n        ...\n```\n\n### Manual Script Execution\n\n```bash\n# Project structure analysis (Phase 1)\npython scripts/list_files.py ./project --categorize --detect-type --pretty\n\n# Knowledge base queries (Phase 5/6/7)\npython scripts/unified_kb_query.py --full-chain CWE-89\npython scripts/unified_kb_query.py --capec CAPEC-66 --attack-chain\npython scripts/unified_kb_query.py --attack-technique T1059\npython scripts/unified_kb_query.py --cwe CWE-89 --mitigations\npython scripts/unified_kb_query.py --all-llm\n```\n\n---\n\n## Core Capabilities\n\n### 8-Phase Workflow Outputs\n\n| Phase | Output |\n|-------|--------|\n| **1-4** | Project overview, DFD diagram, key interfaces/boundaries/data nodes, security design matrix |\n| **5** | Threat list (STRIDE+CWE+ATT&CK+LLM) |\n| **6** | **Validation methods** (attack paths + POC) |\n| **7** | **Mitigations** (remediation suggestions per threat) |\n| **8** | `THREAT-MODEL-REPORT.md` comprehensive report |\n\n### Capability Matrix\n\n| Capability | Description |\n|------------|-------------|\n| 8-Phase Serial Workflow | Strict sequential execution with phase output chaining |\n| DFD Construction | Mermaid templates + element inventory + trust boundaries |\n| STRIDE Matrix | TMT-compatible STRIDE per Interaction |\n| Threat ID | Standard format `T-{STRIDE}-{Element}-{Seq}` |\n| Dual Database KB | Core DB (969 CWE, 615 CAPEC) + CVE extension (323K+ CVE) |\n| Attack Path Validation | CAPEC + ATT&CK attack chain mapping + POC design |\n| KB-Enhanced Mitigations | Query knowledge base to generate customized mitigations per threat |\n\n### Scenario Extensions\n\n| Extension | Coverage |\n|-----------|----------|\n| **Cloud Services** | AWS / Azure / GCP / Alibaba Cloud / Tencent Cloud |\n| **AI/LLM** | OWASP LLM Top 10 + AI component threats |\n| **CVE Validation** | 323K+ CVE + KEV (Known Exploited Vulnerabilities) checks |\n\n---\n\n## Documentation\n\n| Document | Content |\n|----------|---------|\n| **[SKILL.md](SKILL.md)** | Claude Code skill entry point (8-phase workflow overview) |\n| **[WORKFLOW.md](WORKFLOW.md)** | Detailed 8-phase deep workflow templates |\n| **[GUIDE.md](GUIDE.md)** | Design philosophy, script reference, KB architecture, troubleshooting |\n| **[EXAMPLES.md](EXAMPLES.md)** | 5 real-world cases (REST API, microservices, AI/LLM, cloud-native) |\n\n### Architecture Documentation\n\n| Document | Content |\n|----------|---------|\n| **[references/KNOWLEDGE-ARCHITECTURE-v5.2.md](references/KNOWLEDGE-ARCHITECTURE-v5.2.md)** | Knowledge base architecture (Dual System A+B) |\n| **[references/COMPREHENSIVE-ARCHITECTURE-WORKFLOW-GUIDE.md](references/COMPREHENSIVE-ARCHITECTURE-WORKFLOW-GUIDE.md)** | Complete architecture and workflow guide |\n\n---\n\n## Knowledge Architecture\n\n### Dual Knowledge System\n\n```\n┌─────────────────────────────────────────────────────────────────────────────┐\n│                         Dual Knowledge Architecture                          │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│  System A: Security Control Hierarchy        System B: Threat Intelligence  │\n│  ─────────────────────────────────           ─────────────────────────────  │\n│  L1: ASVS Control Requirements               L1: STRIDE Classification      │\n│  L2: Security Implementation Patterns        L2: CWE+CAPEC+ATT&CK Mapping   │\n│  L3: Verification Test Cases                 L3: CVE Vulnerability Database │\n│                                              L4: KEV Real-time Intelligence │\n│                                                                              │\n│  Verification Set: WSTG(121) + MASTG(206) + ASVS(345) = 672 Tests          │\n│  → Mapped to 1,269 STRIDE+Test combinations                                 │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n```\n\n### Threat Intelligence Chain\n\n```\nSTRIDE → CWE → CAPEC → ATT&CK → CVE/KEV\n  L1      ├────── L2 ──────┤    L3 + L4\n\nL1 STRIDE → L2 Threat Intelligence:\n───────────────────────────────────────────────────────────────────────────────\nS(Spoofing)      → CWE-287/290/307 → CAPEC-151/194/600 → T1078/T1110 → CVE-*\nT(Tampering)     → CWE-20/77/89    → CAPEC-66/88/248   → T1190/T1059 → CVE-*\nR(Repudiation)   → CWE-117/223/778 → CAPEC-93/268      → T1070/T1562 → CVE-*\nI(Info Disclosure)→ CWE-200/209/311 → CAPEC-116/157/497 → T1552/T1213 → CVE-*\nD(Denial of Svc) → CWE-400/770/918 → CAPEC-125/227/469 → T1498/T1499 → CVE-*\nE(Elev. of Priv) → CWE-269/284/862 → CAPEC-122/233/17  → T1068/T1548 → CVE-*\n```\n\n---\n\n## LLM Compatibility\n\n### Design Principles\n\nThis skill follows **LLM-Native Design** principles for broad compatibility:\n\n| Principle | Description |\n|-----------|-------------|\n| **Context Not Control** | Knowledge base empowers LLM intelligence rather than constraining it |\n| **LLM Autonomous** | KB provides context; LLM performs semantic reasoning |\n| **Script as Blackbox** | Scripts handle deterministic operations; LLM handles analysis |\n| **Dual-Track Knowledge** | Security Controls (defensive) + Threat Patterns (offensive) |\n\n### Agent Architecture\n\nSupports parallel sub-agent patterns for Phases 5/6/7:\n\n```\nMain Agent ──► Risk 1 ──► Sub-Agent 1 ──► KB Query ──► Result 1\n           ──► Risk 2 ──► Sub-Agent 2 ──► KB Query ──► Result 2\n           ──► Risk N ──► Sub-Agent N ──► KB Query ──► Result N\n                                            │\n           ◄─────────── Aggregate Results ──┘\n```\n\n**Scale Thresholds**:\n| Project Scale | Files | Strategy |\n|--------------|-------|----------|\n| Small | <50 | Standard 8-phase |\n| Medium | 50-200 | Module-priority analysis |\n| Large | 200-500 | Subsystem split + merge |\n| Very Large | >500 | Parallel sub-agents |\n\n---\n\n## Version History\n\n### v2.2.1 (Current)\n\n- **Phase 2 DFD/CFD Knowledge Enhancement**: Added 4 YAML pattern files for improved DFD/CFD analysis\n  - `framework-routing-patterns.yaml`: Framework routing detection (Express, FastAPI, Spring, AI/LLM frameworks)\n  - `data-store-patterns.yaml`: Data store identification patterns\n  - `security-checkpoint-patterns.yaml`: Security checkpoint detection patterns\n  - `completeness-rules.yaml`: Phase 2 output completeness validation rules\n- **MCP Architecture & LLM Security Detection**: Enhanced detection for MCP Server patterns and Agent architecture threats\n- **Claude Code Ecosystem Security Analysis**: Skills and plugin (MCP Server, hooks) security analysis integration\n- **Session Version Control**: Workflow phase traceability and version management improvements\n- **Test Coverage Improvement**: `unified_kb_query.py` coverage increased to 53% (target ≥80%)\n\n### v2.1.3\n\n- **STRIDE Name-to-Code Mapping Fix**: `get_cwes_for_stride_sqlite()` now accepts both full names (\"spoofing\") and codes (\"S\")\n- **FTS5 Index Rebuild**: All 12 full-text search indexes rebuilt and verified\n- **E2E Interface Tests**: Comprehensive 25-test suite for UnifiedKnowledgeBase\n- **LLM Compatibility Documentation**: Added design principles and agent architecture sections\n- **Semantic Embeddings**: 3,278 entries for intelligent threat lookup\n\n### v2.1.2\n\n- **ATT&CK Tactics Parsing Fix**: Changed `json.loads()` to `str.split(',')` for comma-separated fields\n- **FTS Exception Handling**: Added `sqlite3.DatabaseError` catch for corrupted FTS indexes\n\n### v2.1.1\n\n- **ATT&CK JSON Parsing Fix**: Corrected tactics and platforms field parsing\n- **Obsolete Test Script Removed**: Deleted reference to non-existent database\n\n### v2.1.0\n\n- **Directory Structure Refactoring**: Reorganized to `references/`, `assets/knowledge/`, `assets/schemas/`, `assets/templates/`\n\n### v2.0.0\n\n- **STRIDE→Test Mapping Expansion**: 162 → 1,269 test mappings\n- **Verification Set Integration**: WSTG(121) + MASTG(206) + ASVS(345)\n- **Dual Knowledge Architecture**: System A (Controls) + System B (Threats)\n- **Bilingual Documentation**: Full English + Chinese documentation\n\nSee [CHANGELOG.md](CHANGELOG.md) for complete version history.\n\n---\n\n**Version 2.2.1** | [Full Documentation](GUIDE.md) | [Changelog](CHANGELOG.md) | [中文版](README-cn.md)\n",
        "SKILL.md": "<!-- Code-First Deep Threat Modeling Workflow | Version 2.1.3 | https://github.com/fr33d3m0n/skill-threat-modeling | License: BSD-3-Clause | Welcome to cite but please retain all sources and declarations -->\n\n---\nname: threat-modeling\ndescription: |\n  Code-first automated threat modeling toolkit. STRICT 8-PHASE WORKFLOW - DO NOT MODIFY.\n\n  **MANDATORY: Create exactly 8 TodoWrite items with these EXACT names:**\n  - Phase 1: Project Understanding (项目理解)\n  - Phase 2: Call Flow & DFD Analysis (数据流分析)\n  - Phase 3: Trust Boundary Evaluation (信任边界)\n  - Phase 4: Security Design Review (安全设计评审)\n  - Phase 5: STRIDE Threat Analysis (STRIDE分析)\n  - Phase 6: Risk Validation (风险验证) ← NOT mitigation!\n  - Phase 7: Mitigation Planning (缓解措施) ← AFTER validation!\n  - Phase 8: Report Generation (报告生成) ← Output to Risk_Assessment_Report/\n\n  **MANDATORY OUTPUT (Phase 8):**\n  - Directory: `{PROJECT_ROOT}/Risk_Assessment_Report/`\n  - Main report: `{PROJECT}-RISK-ASSESSMENT-REPORT.md` (PROJECT=UPPERCASE)\n  - Required: 4 reports + 6 phase docs (P1-P6)\n  - ❌ FORBIDDEN: `THREAT-MODEL-REPORT.md` or reports in project root\n\n  Use when: threat model, STRIDE, DFD, security assessment, 威胁建模, 安全评估.\n---\n\n# Code-First Deep Risk Analysis v2.2.1\n\nCode-first automated deep threat modeling with comprehensive security chain analysis.\n\n## Execution Mode\n\n**Full Assessment Only** - All 8 phases executed sequentially with maximum depth.\n\n```\nPhase 1 ──► Phase 2 ──► Phase 3 ──► Phase 4 ──► Phase 5 ──► Phase 6 ──► Phase 7 ──► Phase 8\nProject     Call Flow    Trust      Security    STRIDE      Risk        Mitigation   Report\nUnderstanding  DFD      Boundaries   Design     Analysis   Validation\n```\n\n**Strict Workflow Rules**:\n1. Phases execute strictly in order (1→2→3→4→5→6→7→8)\n2. Each phase output passes to next phase as input\n3. Summary and reflection after each phase before proceeding\n4. No skipping, reordering, or parallel execution of phases\n5. Multi-risk analysis within phases can use parallel sub-agents\n\n### Phase Todo Creation — CRITICAL REQUIREMENT\n\n> ⚠️ **STOP AND READ**: Before ANY analysis, you MUST create EXACTLY 8 todo items.\n> DO NOT proceed until you have created all 8 phases as separate todo items.\n> DO NOT modify phase names or descriptions. Copy EXACTLY as shown below.\n\n**MANDATORY TodoWrite Call (copy exactly, do not modify)**:\n\n```json\n[\n  {\"content\": \"Phase 1: Project Understanding\", \"status\": \"pending\", \"activeForm\": \"分析项目架构和技术栈\"},\n  {\"content\": \"Phase 2: Call Flow & DFD Analysis\", \"status\": \"pending\", \"activeForm\": \"构建数据流图\"},\n  {\"content\": \"Phase 3: Trust Boundary Evaluation\", \"status\": \"pending\", \"activeForm\": \"识别信任边界\"},\n  {\"content\": \"Phase 4: Security Design Review\", \"status\": \"pending\", \"activeForm\": \"评估安全设计\"},\n  {\"content\": \"Phase 5: STRIDE Threat Analysis\", \"status\": \"pending\", \"activeForm\": \"执行STRIDE分析\"},\n  {\"content\": \"Phase 6: Risk Validation\", \"status\": \"pending\", \"activeForm\": \"验证风险和攻击路径\"},\n  {\"content\": \"Phase 7: Mitigation Planning\", \"status\": \"pending\", \"activeForm\": \"制定缓解措施\"},\n  {\"content\": \"Phase 8: Report Generation\", \"status\": \"pending\", \"activeForm\": \"生成威胁建模报告\"}\n]\n```\n\n**VIOLATIONS (will cause incorrect analysis)**:\n- ❌ Creating fewer than 8 phases\n- ❌ Combining phases (e.g., \"Phase 2-7: Complete analysis\")\n- ❌ Renaming phases (e.g., \"Phase 6: 缓解措施\" instead of \"Phase 6: Risk Validation\")\n- ❌ Skipping Phase 6 (Risk Validation) or Phase 7 (Mitigation Planning)\n- ❌ Starting analysis before creating all 8 todo items\n\n**CORRECT execution order**:\n1. Phase 6 = Risk Validation (验证风险和攻击路径) — NOT mitigation\n2. Phase 7 = Mitigation Planning (制定缓解措施) — comes AFTER validation\n3. Phase 8 = Report Generation (生成报告) — final phase, MUST exist\n\n## Report Output Convention\n\n### Output Directory Structure\n\n```\n{PROJECT_ROOT}/\n└── Risk_Assessment_Report/              ← 最终报告输出目录\n    │\n    │  ┌─ 必需报告 (4份) ──────────────────────────────────────────────┐\n    ├── {PROJECT}-RISK-ASSESSMENT-REPORT.md    ← 风险评估报告 (主报告)\n    ├── {PROJECT}-RISK-INVENTORY.md            ← 风险清单\n    ├── {PROJECT}-MITIGATION-MEASURES.md       ← 缓解措施\n    ├── {PROJECT}-PENETRATION-TEST-PLAN.md     ← 渗透测试方案 ✨ NEW\n    │  └──────────────────────────────────────────────────────────────┘\n    │\n    │  ┌─ 阶段过程文档 (从.phase_working复制，保留英文名) ──────────────┐\n    ├── P1-PROJECT-UNDERSTANDING.md            ← Phase 1 项目理解\n    ├── P2-DFD-ANALYSIS.md                     ← Phase 2 DFD分析\n    ├── P3-TRUST-BOUNDARY.md                   ← Phase 3 信任边界\n    ├── P4-SECURITY-DESIGN-REVIEW.md           ← Phase 4 安全设计评估\n    ├── P5-STRIDE-THREATS.md                   ← Phase 5 STRIDE威胁分析\n    ├── P6-RISK-VALIDATION.md                  ← Phase 6 风险验证\n    │  └──────────────────────────────────────────────────────────────┘\n    │\n    └── .phase_working/                        ← 阶段产物工作目录 (隐藏)\n        ├── _session_meta.yaml                 ← 会话元数据\n        ├── P1-PROJECT-UNDERSTANDING.md        ← Phase 1 工作文档\n        ├── P2-DFD-ANALYSIS.md                 ← Phase 2 工作文档\n        ├── P3-TRUST-BOUNDARY.md               ← Phase 3 工作文档\n        ├── P4-SECURITY-DESIGN-REVIEW.md       ← Phase 4 工作文档\n        ├── P5-STRIDE-THREATS.md               ← Phase 5 工作文档\n        ├── P6-RISK-VALIDATION.md              ← Phase 6 工作文档\n        └── P7-MITIGATION-PLAN.md              ← Phase 7 工作文档\n```\n\n### File Naming Convention\n\n**Format**: `{PROJECT}-{REPORT_TYPE}.md`\n\n- **PROJECT**: 从项目名提取，转大写，最多30字符\n  - 格式: `^[A-Z][A-Z0-9-]{0,29}$`\n  - 示例: `OPEN-WEBUI`, `MY-PROJECT`, `STRIDE-DEMO`\n- **REPORT_TYPE**: 标准报告类型 (大写)\n\n| 报告类型 | 必需条件 | 文件名示例 |\n|---------|---------|-----------|\n| 风险评估报告 (主报告) | ✅ 始终 | `OPEN-WEBUI-RISK-ASSESSMENT-REPORT.md` |\n| 风险清单 | ✅ 始终 | `OPEN-WEBUI-RISK-INVENTORY.md` |\n| 缓解措施 | ✅ 始终 | `OPEN-WEBUI-MITIGATION-MEASURES.md` |\n| 渗透测试方案 | ✅ 始终 | `OPEN-WEBUI-PENETRATION-TEST-PLAN.md` |\n| 架构分析 | ⚪ 可选 | `OPEN-WEBUI-ARCHITECTURE-ANALYSIS.md` |\n| DFD图 | ⚪ 可选 | `OPEN-WEBUI-DFD-DIAGRAM.md` |\n| 合规映射 | ⚪ 可选 | `OPEN-WEBUI-COMPLIANCE-MAPPING.md` |\n| 攻击路径 | ⚪ 可选 | `OPEN-WEBUI-ATTACK-PATHS.md` |\n| 执行摘要 | ⚪ 可选 | `OPEN-WEBUI-EXECUTIVE-SUMMARY.md` |\n\n**图例**: ✅ 必需 | ⚪ 可选\n\n### Phase Output Persistence\n\n**每阶段完成时**:\n1. 将阶段输出写入 `.phase_working/P{N}-*.md`\n2. 更新 `_session_meta.yaml` 的 `phases_completed`\n\n**会话元数据** (`_session_meta.yaml`) — **Authoritative Definition**:\n```yaml\n# Session Management Schema (v2.2.0)\n# This is the single source of truth for session state\nsession_id: \"20260103-120000\"       # Format: YYYYMMDD-HHMMSS\nproject_name: \"OPEN-WEBUI\"          # Uppercase, max 30 chars\nproject_path: \"/path/to/project\"    # Absolute path to target project\nstarted_at: \"2026-01-03T12:00:00+08:00\"  # ISO 8601 with timezone\nphases_completed: [1, 2, 3]         # List of completed phase numbers\ncurrent_phase: 4                    # Currently active phase (1-8)\nskill_version: \"2.2.1\"              # Skill version for compatibility\n```\n\n### Session Recovery\n\n新会话启动时检查 `.phase_working/`:\n- 存在且 `project_name` 匹配 → 提示: \"继续上次会话\" 或 \"覆盖重新开始\"\n- 存在但 `project_name` 不同 → 清空目录，开始新会话\n- 不存在 → 创建目录，开始新会话\n\n> **详细规范**: 见 `WORKFLOW.md` Phase 8 部分\n> **示例**: 见 `EXAMPLES.md`\n\n## Language Adaptation Rules\n\n**原则**: 输出语言跟随上下文语言，除非显式指定。\n\n### 语言检测逻辑\n\n```\n用户指令语言 → 输出语言\n├── 中文指令/上下文 → 中文文件名 + 中文内容\n├── 英文指令/上下文 → 英文文件名 + 英文内容\n├── 其他语言 → 跟随该语言\n└── --lang=xx 显式指定 → 覆盖自动检测\n```\n\n### 影响范围\n\n| 元素 | 语言自适应 | 示例 (中文上下文) | 示例 (英文上下文) |\n|------|-----------|------------------|------------------|\n| 报告文件名 | ✅ | `项目-风险评估报告.md` | `PROJECT-RISK-ASSESSMENT-REPORT.md` |\n| 阶段产物文件名 | ✅ | `P1-项目理解.md` | `P1-PROJECT-UNDERSTANDING.md` |\n| 报告内容 | ✅ | 中文正文 | English content |\n| 目录名 | ✅ | `风险评估报告/` | `Risk_Assessment_Report/` |\n| 模板占位符 | ❌ | 保持英文 (内部使用) | 保持英文 |\n\n### 显式语言指定\n\n```bash\n# 强制英文输出 (即使上下文是中文)\n--lang=en\n\n# 强制中文输出 (即使上下文是英文)\n--lang=zh\n\n# 支持的语言代码: en, zh, ja, ko, es, fr, de, pt, ru\n```\n\n### 实现方式\n\n- **模板**: 保持单一英文模板 (assets/templates/*.template.md)\n- **转换**: LLM 根据上下文语言实时翻译输出\n- **文件名映射**: 见下表\n\n#### 文件名语言映射表\n\n| English (Default) | 中文 | Français | Español |\n|-------------------|------|----------|---------|\n| `RISK-ASSESSMENT-REPORT` | `风险评估报告` | `RAPPORT-EVALUATION-RISQUES` | `INFORME-EVALUACION-RIESGOS` |\n| `RISK-INVENTORY` | `风险清单` | `INVENTAIRE-RISQUES` | `INVENTARIO-RIESGOS` |\n| `MITIGATION-MEASURES` | `缓解措施` | `MESURES-ATTENUATION` | `MEDIDAS-MITIGACION` |\n| `PENETRATION-TEST-PLAN` | `渗透测试方案` | `PLAN-TEST-PENETRATION` | `PLAN-PRUEBA-PENETRACION` |\n| `P1-PROJECT-UNDERSTANDING` | `P1-项目理解` | `P1-COMPREHENSION-PROJET` | `P1-COMPRENSION-PROYECTO` |\n| `P2-DFD-ANALYSIS` | `P2-数据流分析` | `P2-ANALYSE-DFD` | `P2-ANALISIS-DFD` |\n| `P3-TRUST-BOUNDARY` | `P3-信任边界` | `P3-LIMITE-CONFIANCE` | `P3-LIMITE-CONFIANZA` |\n| `P4-SECURITY-DESIGN-REVIEW` | `P4-安全设计评审` | `P4-REVUE-CONCEPTION-SECURITE` | `P4-REVISION-DISENO-SEGURIDAD` |\n| `P5-STRIDE-THREATS` | `P5-STRIDE威胁分析` | `P5-MENACES-STRIDE` | `P5-AMENAZAS-STRIDE` |\n| `P6-RISK-VALIDATION` | `P6-风险验证` | `P6-VALIDATION-RISQUES` | `P6-VALIDACION-RIESGOS` |\n| `Risk_Assessment_Report/` | `风险评估报告/` | `Rapport_Evaluation_Risques/` | `Informe_Evaluacion_Riesgos/` |\n\n> **注意**: 技术术语 (STRIDE, DFD, CWE, CAPEC, ATT&CK) 保持英文不翻译。\n\n## Skill Path Resolution\n\n**Issue**: Scripts use relative paths `scripts/unified_kb_query.py`, but Claude may work in project root.\n\n**Solution**: Resolve Skill installation path before executing scripts.\n\n### Path Detection Algorithm\n\n```\nPriority: Project-level > Global\n1. Check $PROJECT_ROOT/.claude/skills/threat-modeling/\n2. Check ~/.claude/skills/threat-modeling/\n3. Use SKILL_PATH environment variable (if set)\n```\n\n### Claude Invocation Pattern\n\n**Step 1**: Detect and cache SKILL_PATH at session start:\n```bash\n# Detect skill path (execute once, cache result)\nSKILL_PATH=$(\n  if [ -d \".claude/skills/threat-modeling\" ]; then\n    echo \"$(pwd)/.claude/skills/threat-modeling\"\n  elif [ -d \"$HOME/.claude/skills/threat-modeling\" ]; then\n    echo \"$HOME/.claude/skills/threat-modeling\"\n  else\n    echo \"\"\n  fi\n)\n```\n\n**Step 2**: Execute scripts using detected path:\n```bash\n# Standard invocation pattern\npython \"$SKILL_PATH/scripts/unified_kb_query.py\" --stride spoofing\n\n# Or cd to skill directory\ncd \"$SKILL_PATH\" && python scripts/unified_kb_query.py --stride spoofing\n```\n\n### Shortcut 1: kb wrapper (Recommended)\n\nSkill includes `kb` wrapper script for invocation from any directory:\n```bash\n# Use absolute path to invoke kb wrapper\n$SKILL_PATH/kb --stride spoofing\n$SKILL_PATH/kb --full-chain CWE-89\n$SKILL_PATH/kb --all-llm\n\n# Or add to PATH\nexport PATH=\"$SKILL_PATH:$PATH\"\nkb --stride spoofing\n```\n\n### Shortcut 2: skill_path.sh\n\nGet skill path for other operations:\n```bash\n# Get skill path\nSKILL_PATH=$(bash skill_path.sh)\n\n# One-liner invocation\npython \"$(bash skill_path.sh)/scripts/unified_kb_query.py\" --stride spoofing\n```\n\n### Development Mode\n\nUse source path directly during development:\n```bash\n# Development path (non-installed mode)\ncd /path/to/threat-modeling\npython scripts/unified_kb_query.py --stride spoofing\n```\n\n### Script Invocation Convention\n\nAll `python scripts/unified_kb_query.py ...` examples in this document assume:\n1. `cd $SKILL_PATH` has been executed, or\n2. Use `$SKILL_PATH/kb ...` as replacement\n\n**Claude should detect SKILL_PATH at session start and use `kb` wrapper or cd mode.**\n\n---\n\n## Security Knowledge Architecture\n\n### Three Knowledge Sets\n\nThe security knowledge system consists of three complementary sets:\n\n```\n┌───────────────────────────────────────────────────────────────────────────────────────────────┐\n│                              Security Knowledge Architecture                                   │\n├───────────────────────────────────────────────────────────────────────────────────────────────┤\n│                                                                                                │\n│                       ┌───────────────────────────────────────────┐                           │\n│                       │         Security Principles               │                           │\n│                       │    (Foundation - Guides All Phases)       │                           │\n│                       │  DID │ LP │ ZT │ FS │ SOD │ SBD │ CM │ EOM │ OD │ IV │ LA            │\n│                       └───────────────────────────────────────────┘                           │\n│                                           │                                                    │\n│                 ┌─────────────────────────┴─────────────────────────┐                         │\n│                 │                                                    │                         │\n│                 ▼                                                    ▼                         │\n│  ┌─────────────────────────────────────┐      ┌─────────────────────────────────────┐        │\n│  │      Security Control Set          │      │      Threat Pattern Set             │        │\n│  │      (What to do & How to do)      │      │      (What to know & Validate)      │        │\n│  ├─────────────────────────────────────┤      ├─────────────────────────────────────┤        │\n│  │  Security Domains (16)              │      │  CWE Weakness Types (974)           │        │\n│  │      │                              │      │      │                              │        │\n│  │      ▼                              │      │      ▼                              │        │\n│  │  Control Sets (18 files, 107)       │      │  CAPEC Attack Patterns (615)        │        │\n│  │      │                              │      │      │                              │        │\n│  │      ▼                              │      │      ▼                              │        │\n│  │  OWASP References (74)              │      │  ATT&CK Techniques (835)            │        │\n│  │      │                              │      │      │                              │        │\n│  │      ▼                              │      │      ▼                              │        │\n│  │  Compliance Frameworks (14)         │      │  CVE/KEV Vulnerabilities (323K+)    │        │\n│  └──────────────┬──────────────────────┘      └──────────────┬──────────────────────┘        │\n│                 │                                             │                               │\n│                 │      ┌─────────────────────────────┐        │                               │\n│                 │      │    Verification Set         │        │                               │\n│                 │      │  (How to verify & test)     │        │                               │\n│                 └─────▶│                             │◀───────┘                               │\n│                        │  WSTG Tests (121)           │                                        │\n│                        │  MASTG Tests (206)          │                                        │\n│                        │  ASVS Requirements (345)    │                                        │\n│                        └─────────────────────────────┘                                        │\n│                                     │                                                          │\n│                                     ▼                                                          │\n│                        Used in: Phase 6 / Phase 7 / Phase 8                                   │\n│                                                                                                │\n└───────────────────────────────────────────────────────────────────────────────────────────────┘\n```\n\n### Security Principles (11)\n\nCore security principles that guide all security design decisions across all 8 phases.\n\n| Code | Principle | Definition |\n|------|-----------|------------|\n| **DID** | Defense in Depth | Multiple independent security controls; single point failure doesn't compromise system |\n| **LP** | Least Privilege | Grant only minimum permissions required to complete task |\n| **ZT** | Zero Trust | Never trust, always verify; assume network is compromised |\n| **FS** | Fail Secure | Default to most secure state on error |\n| **SOD** | Separation of Duties | Critical operations require multiple parties; prevent single-person abuse |\n| **SBD** | Secure by Default | Default configuration is secure; user must actively reduce security |\n| **CM** | Complete Mediation | Every access must be verified; no bypass paths |\n| **EOM** | Economy of Mechanism | Security mechanisms should be simple and auditable; complexity is security's enemy |\n| **OD** | Open Design | Security doesn't depend on algorithm or design secrecy |\n| **IV** | Input Validation | All input must be validated before processing; default deny |\n| **LA** | Least Agency | Limit AI agent autonomy, tool access, and decision scope to minimum required |\n\n**Phase References**:\n- Phase 1: DID, LP, ZT, LA (architecture assessment, agent scope)\n- Phase 2: CM, IV, ZT (data flow security)\n- Phase 3: ZT, SOD, LP, LA (trust boundaries, agent boundaries)\n- Phase 4: All 11 principles (security function completeness)\n\n> Detailed definitions in `assets/knowledge/security-principles.yaml`\n\n### Security Control Set\n\nDefines \"what to do\" and \"how to do it\" from a defensive perspective.\n\n```\nSecurity Domains ──▶ Control Sets ──▶ OWASP References ──▶ Compliance Frameworks\n       │                  │                  │                      │\n   security-         control-set-       reference-set-          YAML + SQLite\n   design.yaml         *.md               *.md              (compliance tables)\n```\n\n**Security Domains (16 total)**:\n\n| Seq | Code | Name | STRIDE | Description |\n|-----|------|------|--------|-------------|\n| 01 | AUTHN | Authentication & Session | S | Identity verification and session lifecycle |\n| 02 | AUTHZ | Authorization & Access Control | E | Access permission enforcement |\n| 03 | INPUT | Input Validation | T | External input validation and sanitization |\n| 04 | OUTPUT | Output Encoding | T,I | Context-aware output encoding |\n| 05 | CLIENT | Client-Side Security | S,T,I | Browser and client-side security |\n| 06 | CRYPTO | Cryptography & Transport | I | Data encryption in transit and at rest |\n| 07 | LOG | Logging & Monitoring | R | Security event logging and audit |\n| 08 | ERROR | Error Handling | I | Secure error handling and information control |\n| 09 | API | API & Service Security | S,T,I,D,E | API endpoint and service communication security |\n| 10 | DATA | Data Protection | I | Sensitive data and credential protection |\n| ext-11 | INFRA | Infrastructure Security | - | Container and orchestration security |\n| ext-12 | SUPPLY | Supply Chain Security | - | Dependency and pipeline security |\n| ext-13 | AI | AI/LLM Security | - | LLM-specific threats (OWASP LLM Top 10) |\n| ext-14 | MOBILE | Mobile Security | - | Mobile app security |\n| ext-15 | CLOUD | Cloud Security | - | Cloud-native security controls |\n| ext-16 | AGENT | Agentic Security | S,T,R,I,D,E | AI Agent security (OWASP Agentic Top 10) |\n\n### Threat Pattern Set\n\nDefines \"what to know\" and \"what to validate\" from an offensive perspective.\n\n```\nCWE Weaknesses ──▶ CAPEC Patterns ──▶ ATT&CK Techniques ──▶ CVE/KEV Vulnerabilities\n       │                 │                   │                       │\n   SQLite:cwe       SQLite:capec      SQLite:attack_*         SQLite:cve + API\n   (974 entries)    (615 entries)     (835 entries)           (323K+ entries)\n```\n\n**STRIDE to CWE Mapping**:\n\n| STRIDE | Primary CWEs | Attack Patterns |\n|--------|--------------|-----------------|\n| S (Spoofing) | CWE-287, 290, 307 | CAPEC-151, 194, 600 |\n| T (Tampering) | CWE-20, 77, 78, 89 | CAPEC-66, 88, 248 |\n| R (Repudiation) | CWE-117, 223, 778 | CAPEC-93 |\n| I (Information Disclosure) | CWE-200, 209, 311 | CAPEC-116, 157 |\n| D (Denial of Service) | CWE-400, 770, 918 | CAPEC-125, 227 |\n| E (Elevation of Privilege) | CWE-269, 284, 862 | CAPEC-122, 233 |\n\n### Verification Set (Cross-Cutting)\n\nBridges Security Control Set and Threat Pattern Set, providing test procedures for Phase 6/7/8.\n\n| Component | Tests/Requirements | Usage |\n|-----------|-------------------|-------|\n| WSTG (Web Security Testing Guide) | 121 tests | Phase 6: Risk validation |\n| MASTG (Mobile App Security Testing Guide) | 206 tests | Phase 6: Mobile risk validation |\n| ASVS (Application Security Verification Standard) | 345 requirements | Phase 7-8: Mitigation & compliance |\n\n**STRIDE to Verification Mapping**:\n\n| STRIDE | Verification Categories | Test Count |\n|--------|------------------------|------------|\n| S (Spoofing) | WSTG-ATHN/IDNT/SESS, MASTG-AUTH, ASVS-V6/V7/V9/V10 | 240 |\n| T (Tampering) | WSTG-INPV/CONF/CLNT, MASTG-PLATFORM/RESILIENCE, ASVS-V1/V2/V3 | 402 |\n| R (Repudiation) | WSTG-BUSL, ASVS-V7/V16 | 46 |\n| I (Information Disclosure) | WSTG-INFO/ERRH/CRYP, MASTG-STORAGE/NETWORK, ASVS-V11/V12/V14 | 442 |\n| D (Denial of Service) | WSTG-BUSL/APIT, MASTG-RESILIENCE | 49 |\n| E (Elevation of Privilege) | WSTG-AUTHZ, MASTG-PLATFORM, ASVS-V8 | 90 |\n| **Total** | All verification tests mapped to STRIDE | **1,269** |\n\n---\n\n## 8-Phase Workflow Overview\n\n| Phase | Name | Type | Knowledge Sets Used | Key Output |\n|-------|------|------|---------------------|------------|\n| **1** | Project Understanding | Exploratory | Security Principles | findings_1: project_context |\n| **2** | Call Flow & DFD | Constructive | Principles + security-design.yaml | findings_2: dfd_elements |\n| **3** | Trust Boundaries | Evaluative | Principles + security-design.yaml | findings_3: boundary_context |\n| **4** | Security Design | Evaluative | Control Sets + References | findings_4: security_gaps |\n| **5** | STRIDE Analysis | Enumerative | CWE → CAPEC (Threat Pattern Set) | findings_5: threat_inventory |\n| **6** | Risk Validation | Verification | Threat Pattern Set + Verification Set | validated_risks |\n| **7** | Mitigation | Prescriptive | Control Sets + CWE Mitigations + ASVS | mitigation_plan |\n| **8** | Report | Comprehensive | All outputs + Compliance + ASVS | RISK-ASSESSMENT-REPORT.md |\n\n---\n\n## Core Data Model (核心数据模型) ⚠️ CRITICAL\n\n> **Design Principle**: 从数据流动和转换的本质出发，定义清晰的实体、关系和转换规则\n\n### Entity Definitions (实体定义)\n\n```\n┌─────────────────────────────────────────────────────────────────┐\n│                      Core Entity Model                           │\n├─────────────────────────────────────────────────────────────────┤\n│                                                                  │\n│  ┌─────────────────────────────────────────────────────────┐   │\n│  │  Finding (发现)                                          │   │\n│  │  ─────────────────                                       │   │\n│  │  来源: Phase 1-4                                         │   │\n│  │  ID: F-P{N}-{Seq}  例: F-P1-001, F-P4-003               │   │\n│  │  性质: 安全相关的观察、缺陷、风险点                         │   │\n│  │  数量: 通常 10-30 个                                      │   │\n│  └─────────────────────────────────────────────────────────┘   │\n│                              │                                   │\n│                              ▼ (输入 Phase 5)                   │\n│  ┌─────────────────────────────────────────────────────────┐   │\n│  │  Threat (威胁)                                           │   │\n│  │  ─────────────────                                       │   │\n│  │  来源: Phase 5 STRIDE 分析                               │   │\n│  │  ID: T-{STRIDE}-{ElementID}-{Seq}  例: T-T-P013-002      │   │\n│  │  性质: 针对 DFD 元素的潜在攻击向量                         │   │\n│  │  数量: 通常 50-200 个 (每元素多个)                         │   │\n│  │  状态: identified (已识别)                                │   │\n│  └─────────────────────────────────────────────────────────┘   │\n│                              │                                   │\n│                              ▼ (验证 Phase 6)                   │\n│  ┌─────────────────────────────────────────────────────────┐   │\n│  │  ValidatedRisk (验证风险)                                │   │\n│  │  ─────────────────                                       │   │\n│  │  来源: Phase 6 风险验证                                   │   │\n│  │  ID: VR-{Seq}  例: VR-001                                │   │\n│  │  性质: 经过验证的、可利用的风险                            │   │\n│  │  数量: 通常 5-30 个 (威胁合并/过滤后)                      │   │\n│  │  ⚠️ 必填: threat_refs[] 追溯到原始威胁                   │   │\n│  └─────────────────────────────────────────────────────────┘   │\n│                              │                                   │\n│                              ▼ (缓解 Phase 7)                   │\n│  ┌─────────────────────────────────────────────────────────┐   │\n│  │  Mitigation (缓解措施)                                   │   │\n│  │  ─────────────────                                       │   │\n│  │  来源: Phase 7 缓解规划                                   │   │\n│  │  ID: M-{Seq}  例: M-001                                  │   │\n│  │  性质: 针对验证风险的修复方案                              │   │\n│  │  数量: 通常 5-20 个 (可一对多)                            │   │\n│  │  包含: risk_refs[] 追溯到验证风险                         │   │\n│  └─────────────────────────────────────────────────────────┘   │\n│                                                                  │\n└─────────────────────────────────────────────────────────────────┘\n```\n\n### Entity Relationships (实体关系)\n\n```\nDFD Element              1:N                 ┌──────────┐\n(P001, DS001, DF001...) ─────────────────────▶│  Threat  │\n                                             │ (T-xxx)  │\n                                             └────┬─────┘\n                                                  │\n                                                  │ N:1 (合并)\n                                                  ▼\n                                        ┌─────────────────┐\nFinding ────────────────────────────────▶│ ValidatedRisk   │\n(F-xxx)   合并                           │   (VR-xxx)      │\n                                        │                 │\n                                        │ threat_refs:    │\n                                        │ [T-T-P013-001,  │\n                                        │  T-T-P013-002,  │\n                                        │  T-E-P013-001]  │\n                                        └────────┬────────┘\n                                                 │\n                                                 │ N:1 (覆盖)\n                                                 ▼\n                                        ┌─────────────────┐\n                                        │   Mitigation    │\n                                        │    (M-xxx)      │\n                                        │                 │\n                                        │ risk_refs:      │\n                                        │ [VR-001,        │\n                                        │  VR-002]        │\n                                        └─────────────────┘\n\n关键关系:\n• Threat N:1 ValidatedRisk (多威胁合并为一个风险)\n• ValidatedRisk N:1 Mitigation (多风险可被同一措施覆盖)\n• 所有关系通过 *_refs[] 显式追溯\n```\n\n### Unified ID Convention (统一ID规范)\n\n| 实体类型 | ID 格式 | 示例 | 阶段 |\n|---------|--------|------|------|\n| Finding | F-P{N}-{Seq:03d} | F-P1-001 | P1-P4 |\n| Threat | T-{STRIDE}-{Element}-{Seq} | T-T-P013-002 | P5 |\n| ValidatedRisk | VR-{Seq:03d} | VR-001 | P6 |\n| Mitigation | M-{Seq:03d} | M-001 | P7 |\n| POC | POC-{Seq:03d} | POC-001 | P6 |\n| AttackPath | AP-{Seq:03d} | AP-001 | P6 |\n| AttackChain | AC-{Seq:03d} | AC-001 | P6 |\n\n**❌ 禁止的 ID 格式** (不再使用):\n- `RISK-{Seq}` → 改用 `VR-{Seq}`\n- `T-E-RCE-001` → 改用 `T-E-P013-001` (保留 ElementID)\n- `SD-{Seq}` → 改用 `F-P4-{Seq}`\n\n### Count Conservation Rules (数量守恒规则) ⚠️ CRITICAL\n\n```yaml\n# 威胁处理守恒公式\ncount_conservation:\n  p5_output: \"threat_inventory.total = T\"  # 例: 120\n  p6_processing:\n    verified: V      # 验证确认的威胁数\n    theoretical: Th  # 理论可行的威胁数\n    pending: P       # 待验证的威胁数\n    excluded: E      # 排除的威胁数 (有理由)\n\n  conservation_formula: \"V + Th + P + E = T\"\n\n  traceability_rule: |\n    FOR each threat T in p5_output:\n      T MUST appear in exactly one VR.threat_refs[]\n      OR T.status = 'excluded' with documented reason\n\n  report_consistency:\n    RISK-INVENTORY.count = \"len(VR where status != 'excluded')\"\n    MAIN-REPORT.risk_count = \"RISK-INVENTORY.count\"\n\n# 验证检查点\ncheckpoints:\n  cp1_p5_to_p6: \"P6.input_count = P5.threat_inventory.summary.total\"\n  cp2_p6_output: \"sum(verified, theoretical, pending, excluded) = input_count\"\n  cp3_report_gen: \"RISK-INVENTORY.count = P6.final_risk_count\"\n```\n\n### ValidatedRisk Structure (验证风险数据结构)\n\n```yaml\nValidatedRisk:\n  # === 标识 ===\n  id:\n    format: \"VR-{Seq:03d}\"\n    example: \"VR-001\"\n\n  # === 追溯 (MANDATORY!) ===\n  threat_refs:\n    type: array[Threat.id]\n    description: \"此风险来源的所有威胁 ID\"\n    example: [\"T-T-P013-001\", \"T-T-P013-002\", \"T-E-P013-001\"]\n    requirement: \"MANDATORY - 必须列出所有源威胁\"\n\n  finding_refs:\n    type: array[Finding.id]\n    description: \"此风险来源的 P1-P4 发现\"\n    example: [\"F-P4-003\"]\n    requirement: \"OPTIONAL - 如有关联发现\"\n\n  # === 风险评估 ===\n  severity:\n    cvss_score: float  # 0.0-10.0\n    priority: \"P0|P1|P2|P3\"\n    stride_types: [\"T\", \"E\"]  # 可包含多个 STRIDE 类型\n\n  # === 验证状态 ===\n  validation:\n    status: \"verified|theoretical|pending|excluded\"\n    poc_available: boolean\n    poc_id: \"POC-{Seq}\"  # 如有 POC\n```\n\n> **详细设计**: 见 `tmp_data/DATA-ARCHITECTURE-DESIGN.md`\n\n### Phase Data Flow\n\n```\n┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐\n│                              Phase Data Flow Architecture                                            │\n├─────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│                                                                                                      │\n│  Phase 1          Phase 2          Phase 3          Phase 4          Phase 5                        │\n│  ┌─────┐          ┌─────┐          ┌─────┐          ┌─────┐          ┌─────┐                        │\n│  │ P1  │─findings1─▶│ P2  │─findings2─▶│ P3  │─findings3─▶│ P4  │─findings4─▶│ P5  │                        │\n│  └──┬──┘          └──┬──┘          └──┬──┘          └──┬──┘          └──┬──┘                        │\n│     │                ▼                ▼                │                │                           │\n│     │           security-        security-             │                │                           │\n│     │           design.yaml      design.yaml           │                │                           │\n│     │                                                  ▼                ▼                           │\n│     │                                          control-set-*.md    CWE → CAPEC                     │\n│     │                                          reference-set-*.md                                   │\n│     ▼                                                                   │                           │\n│  ┌────────────────────────────────────────────────────────────────────────────────────────┐        │\n│  │                              Phase 6: Risk Validation                                  │        │\n│  │  INPUT: findings_1 + findings_2 + findings_3 + findings_4 + findings_5                │        │\n│  │         (ALL issues consolidated and deduplicated)                                     │        │\n│  │  KNOWLEDGE: CAPEC → ATT&CK → CVE/KEV + WSTG + MASTG                                   │        │\n│  │  OUTPUT: validated_risks                                                              │        │\n│  │    ├── risk_summary (counts, categorization)                                          │        │\n│  │    ├── risk_details (per-item: location, analysis, root cause, test cases)           │        │\n│  │    └── attack_paths (chains, step-by-step with commands/POC)                          │        │\n│  └───────────────────────────────────────────────────────────────────────────────────────┘        │\n│                                             │                                                       │\n│                                             ▼                                                       │\n│  ┌───────────────────────────────────────────────────────────────────────────────────────┐        │\n│  │                              Phase 7: Mitigation Planning                              │        │\n│  │  INPUT: validated_risks (complete Phase 6 output)                                     │        │\n│  │  KNOWLEDGE: Control Sets + OWASP References + CWE Mitigations + ASVS                  │        │\n│  │  OUTPUT: mitigation_plan (per-risk: immediate, short-term, long-term)                 │        │\n│  └───────────────────────────────────────────────────────────────────────────────────────┘        │\n│                                             │                                                       │\n│                                             ▼                                                       │\n│  ┌───────────────────────────────────────────────────────────────────────────────────────┐        │\n│  │                              Phase 8: Report Generation                                │        │\n│  │  INPUT: ALL phase outputs (findings_1 → mitigation_plan)                              │        │\n│  │  KNOWLEDGE: Compliance Frameworks + ASVS                                              │        │\n│  │  CRITICAL: Must include COMPLETE Phase 6 and Phase 7 outputs (no omission)           │        │\n│  └───────────────────────────────────────────────────────────────────────────────────────┘        │\n│                                                                                                      │\n└─────────────────────────────────────────────────────────────────────────────────────────────────────┘\n```\n\n### Phase Context Protocol\n\n**Core Principle**: Each phase must explicitly declare Input Context and Output Context for cross-phase data continuity.\n\n| Phase | Context Name | Key Fields |\n|-------|--------------|------------|\n| P1→P2 | `project_context` | project_type, modules[], integrations[], security_design{} |\n| P2→P3 | `dfd_elements` | external_interactors[], processes[], data_stores[], data_flows[], dfd_diagram, dfd_issues[] |\n| P3→P4 | `boundary_context` | boundaries[], interfaces[], data_nodes[], cross_boundary_flows[] |\n| P4→P5 | `security_gaps` | gaps[{domain,severity,description}], design_matrix{} |\n| P5→P6 | `threat_inventory` | threats[{id,element_id,stride,cwe,priority}] |\n| P6→P7 | `validated_risks` | risk_summary{}, risk_details[], attack_paths[] |\n| P7→P8 | `mitigation_plan` | mitigations[{risk_id,measures,implementation}], roadmap{} |\n\n### `dfd_elements` Detailed Structure (P2 Output)\n\n```yaml\ndfd_elements:\n  external_interactors:\n    - id: \"EI001\"                   # Format: EI{NNN}\n      name: \"用户\"\n      type: \"人类|系统\"\n      sends: [\"凭证\", \"API请求\"]     # Data sent to system\n      receives: [\"响应数据\"]         # Data received from system\n\n  processes:\n    - id: \"P001\"                    # Format: P{NNN}\n      name: \"API网关\"\n      function: \"请求路由\"\n      authn_required: true          # Authentication required\n      authz_required: true          # Authorization required\n\n  data_stores:\n    - id: \"DS001\"                   # Format: DS{NNN}\n      name: \"用户数据库\"\n      type: \"PostgreSQL|MongoDB|Redis|...\"\n      sensitivity: \"高(PII)|中|低\"\n      encrypted: true|false\n      backup: true|false\n\n  data_flows:\n    - id: \"DF001\"                   # Format: DF{NNN}\n      source: \"EI001\"               # Source element ID\n      target: \"P001\"                # Target element ID\n      data: \"用户请求\"\n      protocol: \"HTTPS|gRPC|TCP|...\"\n      encrypted: true|false\n\n  dfd_diagram: |\n    # Mermaid source code\n    graph LR\n      ...\n\n  dfd_issues:\n    - issue_id: \"DFD-001\"\n      element_id: \"DF003\"\n      description: \"敏感数据未加密传输\"\n      severity: \"High\"\n```\n\n### Element ID Naming Convention\n\n**DFD Element ID Format** (Phase 2 generates, subsequent phases must reference):\n\n| Element Type | Prefix | Format | Example |\n|--------------|--------|--------|---------|\n| External Interactor | EI | EI{NNN} | EI001, EI002 |\n| Process | P | P{NNN} | P001, P002, P003 |\n| Data Store | DS | DS{NNN} | DS001, DS002 |\n| Data Flow | DF | DF{NNN} | DF001, DF002 |\n| Trust Boundary | TB | TB{NNN} | TB001, TB002 |\n\n**Threat ID Format** (Phase 5 generates):\n```\nT-{STRIDE}-{ElementID}-{Seq}\n```\n- STRIDE: S/T/R/I/D/E (single letter)\n- ElementID: From P2 element ID (3-digit format)\n- Seq: Three-digit sequence (001-999)\n- Example: `T-S-P001-001` (First Spoofing threat for Process 001)\n\n---\n\n## Phase Details\n\n### Phase 1: Project Understanding <ultrathink><critical thinking>\n\n#### 1.1 Core Analysis Goal\n> **Goal**: Comprehensively understand project architecture, functional modules, tech stack, and security design decisions.\n> This is an **exploratory** task where LLM needs to understand overall project structure through code reading.\n\n#### 1.2 Input Context\n**Input**: Project path/codebase\n\n#### 1.3 Knowledge Reference\n**Security Principles**: `assets/knowledge/security-principles.yaml`\n- Evaluate if project embodies core security principles (DID, LP, ZT)\n- Identify obvious security design flaws\n\n#### 1.4 Script Support\n```bash\n# Get project structure with type detection\npython $SKILL_PATH/scripts/list_files.py <path> --categorize --detect-type --pretty\n```\n\n#### 1.5 Output Context\n**→ P2**: `project_context` {project_type, modules[], integrations[], security_design{}}\n\n**Required Output**:\n```markdown\n## Project Summary\n- Project Type: [Web/API/Microservice/AI-LLM/Hybrid]\n- Primary Language: [Language]\n- Framework: [Frameworks]\n\n## Functional Description\n- Core Functions: [...]\n- User Roles: [...]\n\n## Major Modules\n| Module | Responsibility | Location |\n|--------|---------------|----------|\n\n## Key Security Design\n- Authentication: [...]\n- Data Storage: [...]\n- External Integrations: [...]\n```\n\n**Scenario Confirmation** (based on Phase 1 analysis):\n\n| Scenario Type | Trigger Condition | Enable Extension |\n|--------------|-------------------|------------------|\n| Standard Web/API | No AI/No Cloud-Native | Standard STRIDE flow |\n| AI/LLM Application | Model calls/RAG/Prompt processing detected | `--all-llm`, `--ai-component` |\n| Cloud-Native App | AWS/Azure/GCP/K8s detected | `--cloud {provider}` |\n| Microservices | Multi-service/Docker/K8s | Cross-service threat analysis |\n| Hybrid | Multiple features | Combined extensions |\n\n**Checkpoint**: Summarize and reflect before Phase 2.\n\n---\n\n### Phase 2: Call Flow & DFD <ultrathink><critical thinking>\n\n#### 2.1 Core Analysis Goal\n> **Goal**: Build Data Flow Diagram (DFD), trace complete data path from entry to storage.\n> This is a **constructive** task where LLM needs to understand code call relationships and visualize data flow.\n\n#### 2.2 Input Context\n**← P1**: `project_context`\n\n#### 2.3 Knowledge Reference\n**Security Principles**: `assets/knowledge/security-principles.yaml`\n- Apply Complete Mediation (CM) to identify access checkpoints\n- Apply Input Validation (IV) to mark validation points\n\n**Security Design**: `assets/knowledge/security-design.yaml`\n- Reference 16 security domains to identify security-relevant DFD elements\n\n#### 2.4 Output Context\n**→ P3**: `dfd_elements` {elements[], flows[], dfd_diagram, dfd_issues[]}\n\n**Output Requirements**:\n- ASCII DFD diagram (in body)\n- Mermaid DFD source (in appendix)\n- Element inventory table\n\n**Checkpoint**: Summarize and reflect before Phase 3.\n\n---\n\n### Phase 3: Trust Boundaries <ultrathink><critical thinking>\n\n#### 3.1 Core Analysis Goal\n> **Goal**: Based on DFD, identify trust boundaries, key interfaces, and data nodes; evaluate security posture.\n> This is an **evaluative** task where LLM needs to identify security boundaries and assess cross-boundary risks.\n\n#### 3.2 Input Context\n**← P1/P2**: `project_context`, `dfd_elements`\n\n#### 3.3 Knowledge Reference\n**Security Principles**: Apply ZT, SOD, LP principles\n**Security Design**: `assets/knowledge/security-design.yaml` - AUTHN, AUTHZ, API domains\n\n#### 3.4 Output Context\n**→ P4**: `boundary_context` {boundaries[], interfaces[], data_nodes[], boundary_issues[]}\n\n**Checkpoint**: Summarize and reflect before Phase 4.\n\n---\n\n### Phase 4: Security Design Assessment <ultrathink><critical thinking>\n\n#### 4.1 Core Analysis Goal\n> **Goal**: Evaluate project's design maturity across all security domains, identify gaps.\n> This is an **evaluative** task requiring LLM to understand code security implementation and compare with best practices.\n\n#### 4.2 Input Context\n**← P1/P2/P3**: All cumulative findings\n\n#### 4.3 Knowledge Reference (Progressive Loading)\n1. Load `security-design.yaml` - Get all 16 domains with core requirements\n2. For each relevant domain, load corresponding `control-set-*.md`\n3. When specific implementation details needed, load `reference-set-*.md`\n\n**Query Commands**:\n```bash\n# Get security domain details\n$SKILL_PATH/kb --control authentication\n$SKILL_PATH/kb --stride-controls S\n```\n\n#### 4.4 Output Context\n**→ P5**: `security_gaps` {gaps[], design_matrix{}}\n\n**Required Output**:\n```markdown\n## Security Design Assessment Matrix\n| Domain | Current Implementation | Assessment | Gap | Risk Level | KB Reference |\n|--------|----------------------|------------|-----|------------|--------------|\n| AUTHN | [...] | Yes/No/Partial | [...] | High/Medium/Low | control-set-01 |\n```\n\n**Checkpoint**: Summarize and reflect before Phase 5.\n\n---\n\n### Phase 5: STRIDE Analysis <ultrathink><critical thinking>\n\n#### 5.1 Core Analysis Goal\n> **Goal**: Apply STRIDE method to DFD elements, generate complete threat inventory.\n> This is an **enumerative** task where LLM systematically identifies potential threats for each element.\n\n#### 5.2 Input Context\n**← P2/P4**: `dfd_elements`, `security_gaps`\n\n#### 5.3 Knowledge Reference\n**Threat Pattern Set**: CWE → CAPEC mapping\n\n**Query Commands**:\n```bash\n$SKILL_PATH/kb --stride spoofing           # STRIDE category details\n$SKILL_PATH/kb --full-chain CWE-XXX        # Complete chain: STRIDE→CWE→CAPEC→ATT&CK\n$SKILL_PATH/kb --all-llm                    # LLM threats (AI components)\n```\n\n#### 5.4 STRIDE per Element Matrix\n\n| Element Type | Applicable STRIDE |\n|--------------|-------------------|\n| Process | S, T, R, I, D, E (all 6) |\n| Data Store | T, R, I, D |\n| Data Flow | T, I, D |\n| External Entity (as source) | S, R |\n\n#### 5.5 Output Context\n**→ P6**: `threat_inventory` {threats[{id, element_id, stride, cwe, priority}]}\n\n**Checkpoint**: Summarize and reflect before Phase 6.\n\n---\n\n### Phase 6: Risk Validation <ultrathink><critical thinking>\n\n> **📄 Detailed Workflow**: See `@VALIDATION.md` for complete Phase 6 workflow, consolidation process, and POC templates.\n\n#### 6.1 Core Analysis Goal\n> **Goal**: Consolidate ALL findings from P1-P5, perform deep validation, design attack paths and POC.\n> This is a **verification** task where LLM thinks from attacker's perspective.\n\n#### 6.2 Input Context\n**← ALL P1-P5**: findings_1 + findings_2 + findings_3 + findings_4 + findings_5\n\n**CRITICAL**: Phase 6 must consolidate ALL previous findings, not just Phase 5 threats.\n\n#### 6.3 Knowledge Reference\n**Threat Pattern Set**: CAPEC → ATT&CK → CVE/KEV\n**Verification Set**: WSTG + MASTG (test generation)\n\n**Query Commands**:\n```bash\n# Attack path analysis\n$SKILL_PATH/kb --capec CAPEC-XXX --attack-chain\n$SKILL_PATH/kb --attack-technique TXXX\n$SKILL_PATH/kb --check-kev CVE-XXXX\n\n# Verification tests\n$SKILL_PATH/kb --stride-tests S              # STRIDE category tests\n$SKILL_PATH/kb --cwe-tests CWE-89            # CWE-specific tests\n$SKILL_PATH/kb --wstg-category ATHN          # WSTG tests by category\n```\n\n#### 6.4 Output Structure (5 Parts)\n\n> **Schema Reference**: `assets/schemas/risk-detail.schema.md` defines complete risk detail format.\n> **Template Reference**: `assets/templates/RISK-ASSESSMENT-REPORT.template.md` Section 5-6 for output format.\n\n**Priority Mapping** (from schema):\n\n| CVSS 评分 | 严重程度 | 优先级 | 行动要求 |\n|-----------|---------|--------|----------|\n| 9.0 - 10.0 | Critical | P0 | 立即修复 |\n| 7.0 - 8.9 | High | P1 | 紧急处理 (24h) |\n| 4.0 - 6.9 | Medium | P2 | 高优先级 (7d) |\n| 0.1 - 3.9 | Low | P3 | 计划中 (30d) |\n\n**POC Verification Status Types**:\n\n| 状态标识 | 含义 | 判定标准 |\n|---------|------|---------|\n| ✅ **已验证** | POC 执行成功 | 成功复现攻击行为并获得预期结果 |\n| ⚠️ **需验证** | 理论可行但需手动验证 | 需要特定环境或权限才能验证 |\n| 📋 **理论可行** | 基于代码分析推导 | 代码路径存在但未实际测试 |\n| ❌ **已排除** | 验证后确认不可利用 | 存在缓解措施或条件不满足 |\n\n```yaml\nvalidated_risks:\n  # Part 1: Risk Summary (验证覆盖统计)\n  risk_summary:\n    total_identified: N\n    total_verified: N                           # ✅ 已验证\n    total_pending: N                            # ⚠️ 需验证\n    total_theoretical: N                        # 📋 理论可行\n    total_excluded: N                           # ❌ 已排除\n    verification_rate: \"N%\"\n    risk_by_severity: {critical: N, high: N, medium: N, low: N}\n    risk_by_stride: {S: N, T: N, R: N, I: N, D: N, E: N}\n\n  # Part 2: POC Details (每个 Critical/High 威胁一个完整块)\n  poc_details:\n    - poc_id: \"POC-001\"                         # Format: POC-{SEQ:03d}\n      threat_ref: \"T-S-P001-001\"                # 关联威胁ID\n      stride_type: \"S\"                          # STRIDE类型\n      verification_status: \"verified\"           # verified|pending|theoretical|excluded\n      exploitation_difficulty: \"medium\"         # low|medium|high\n      prerequisites:                            # 前置条件\n        - \"有效的用户会话\"\n        - \"知道目标用户ID\"\n      vulnerability_location:\n        file_path: \"src/api/auth.py\"\n        function_name: \"verify_token\"\n        line_number: 45\n      vulnerable_code: |                        # 漏洞代码片段\n        def verify_token(token):\n            # 缺少签名验证\n            return jwt.decode(token, options={\"verify_signature\": False})\n      exploitation_steps:                       # 利用步骤\n        - \"构造恶意JWT Token\"\n        - \"发送请求到认证端点\"\n        - \"绕过身份验证\"\n      poc_code: |                               # POC代码 (完整可执行)\n        import jwt\n        # 构造恶意token\n        malicious_token = jwt.encode({\"user_id\": \"admin\"}, \"any_key\", algorithm=\"HS256\")\n        # 发送请求...\n      expected_result: |                        # 预期结果\n        {\"status\": \"authenticated\", \"user\": \"admin\"}\n      verification_log: \"...\"                   # 验证日志/截图\n      risk_assessment:\n        complexity: \"medium\"\n        attack_vector: \"network\"\n        impact_scope: \"user_data\"\n        data_sensitivity: \"high\"\n\n  # Part 3: Risk Details (per item) - See assets/schemas/risk-detail.schema.md\n  risk_details:\n    - risk_id: \"VR-001\"                         # Format: VR-{SEQ:03d}\n      original_refs: [\"T-S-P001-001\", \"SD-001\"] # From multiple phases\n      priority: \"P1\"                             # P0/P1/P2/P3\n      location: {files: [], elements: [], trust_boundary: \"\"}\n      detailed_analysis: {...}\n      root_cause: {...}\n      related_cwe: \"CWE-XXX\"                     # Required field\n      related_poc: \"POC-001\"                     # Link to POC detail\n      validation:\n        test_cases: []\n        poc_available: true\n        cvss_score: 8.8\n        verification_status: \"verified\"\n\n  # Part 4: Attack Path Feasibility Matrix (可行性评分)\n  attack_path_matrix:\n    - path_id: \"AP-001\"\n      path_name: \"认证绕过→数据库访问\"\n      entry_point: \"API Gateway\"\n      key_nodes: [\"Auth Service\"]\n      final_target: \"数据库\"\n      feasibility_score: 8.5                    # 0.0-10.0\n      detection_difficulty: \"low\"               # low|medium|high\n      priority_fix: true\n\n  # Part 5: Attack Chains (完整攻击链分析)\n  attack_chains:\n    - chain_id: \"AC-001\"\n      chain_name: \"权限提升攻击链\"\n      entry_point: \"公共API端点\"\n      target: \"管理员权限\"\n      impact_scope: \"完全系统控制\"\n      difficulty: \"medium\"\n      related_threats: [\"T-E-P001-001\", \"T-S-P002-001\"]\n      steps:\n        - step: 1\n          title: \"初始访问\"\n          source: \"攻击者\"\n          target: \"API网关\"\n          action: \"发送恶意请求\"\n          code_location: \"api/routes.py:120\"\n          data_change: \"获得会话token\"\n        - step: 2\n          title: \"权限提升\"\n          source: \"API网关\"\n          target: \"认证服务\"\n          action: \"利用JWT漏洞\"\n          code_location: \"auth/jwt.py:45\"\n          data_change: \"获得管理员角色\"\n      # ASCII 攻击链图 (必须在报告中展示)\n      attack_flow_diagram: |\n        ┌─────────────────────────────────────────────────────────────────┐\n        │                     攻击链: 权限提升攻击                         │\n        ├─────────────────────────────────────────────────────────────────┤\n        │  Step 1: 初始访问                                               │\n        │  ┌─────────────────────────────────────────────────────────┐   │\n        │  │  攻击者 ──→ API网关                                       │   │\n        │  │  动作: 发送恶意请求                                        │   │\n        │  │  代码位置: api/routes.py:120                              │   │\n        │  └─────────────────────────────────────────────────────────┘   │\n        │                              │                                   │\n        │                              ▼                                   │\n        │  Step 2: 权限提升                                               │\n        │  ┌─────────────────────────────────────────────────────────┐   │\n        │  │  API网关 ──→ 认证服务                                     │   │\n        │  │  动作: 利用JWT漏洞获得管理员角色                           │   │\n        │  │  代码位置: auth/jwt.py:45                                 │   │\n        │  └─────────────────────────────────────────────────────────┘   │\n        │                              │                                   │\n        │                              ▼                                   │\n        │  结果: 获得管理员权限，完全系统控制                              │\n        └─────────────────────────────────────────────────────────────────┘\n      prerequisites:\n        - \"网络访问权限\"\n        - \"基础用户账户\"\n      exploitation_commands: |\n        # Step 1: 获取初始token\n        curl -X POST https://target/api/login -d '{\"user\":\"test\",\"pass\":\"test\"}'\n        # Step 2: 构造提权token\n        python3 jwt_exploit.py --token $TOKEN --role admin\n      ioc_indicators:\n        - \"异常的JWT token结构\"\n        - \"短时间内角色变更\"\n      defense_recommendations:\n        - cutpoint: \"Step 1\"\n          recommendation: \"实施请求速率限制和异常检测\"\n        - cutpoint: \"Step 2\"\n          recommendation: \"启用JWT签名验证，使用强密钥\"\n```\n\n#### 6.5 Output Quality Requirements\n\n**CRITICAL**: Phase 6 output MUST include:\n1. **POC Details**: Every Critical/High threat must have a complete POC block with executable code\n2. **Attack Chains**: At least one detailed attack chain diagram per high-risk attack path\n3. **Feasibility Matrix**: All attack paths must have feasibility scores (0.0-10.0)\n4. **ASCII Diagrams**: Attack chains must include ASCII box diagrams in `attack_flow_diagram` field\n\n**Checkpoint**: Summarize and reflect before Phase 7.\n\n---\n\n### Phase 7: Mitigation Planning <ultrathink><critical thinking>\n\n> **📄 Detailed Workflow**: See `@REPORT.md` for complete Phase 7-8 workflow with content aggregation instructions.\n\n#### 7.1 Core Analysis Goal\n> **Goal**: Design specific mitigation measures and implementation plans for each validated risk.\n> This is a **prescriptive** task requiring LLM to design feasible security controls for the tech stack.\n\n#### 7.2 Input Context\n**← P6**: `validated_risks` (complete Phase 6 output)\n\n#### 7.3 Knowledge Reference\n**Security Control Set**: Control Sets + OWASP References\n**Threat Pattern Set**: CWE Mitigations\n**Verification Set**: ASVS (requirement verification)\n\n**Query Commands**:\n```bash\n$SKILL_PATH/kb --cwe CWE-XXX --mitigations    # CWE mitigations\n$SKILL_PATH/kb --control authentication        # Security controls\n$SKILL_PATH/kb --asvs-level L2                 # ASVS requirements\n$SKILL_PATH/kb --asvs-chapter V4               # ASVS by chapter\n```\n\n#### 7.4 Output Context\n**→ P8**: `mitigation_plan` {mitigations[], roadmap{}}\n\n**Required Output for Each Risk**:\n```markdown\n### Mitigation Measures\n| Risk ID | CWE | Recommended Measure | Implementation | Priority | Effort |\n|---------|-----|---------------------|----------------|----------|--------|\n| VR-XXX | CWE-XXX | [Measure] | [Code/Config] | Critical/High/Medium/Low | [Est.] |\n```\n\n**Checkpoint**: Summarize and reflect before Phase 8.\n\n---\n\n### Phase 8: Comprehensive Report <ultrathink><critical thinking>\n\n> **📄 Detailed Workflow**: See `@REPORT.md` for complete Phase 8 workflow with **mandatory content aggregation rules**.\n> **⚠️ CRITICAL**: Phase 8 MUST read all phase files and copy content completely — do NOT summarize from memory!\n\n#### 8.1 Core Analysis Goal\n> **Goal**: Synthesize all phase outputs into complete threat model report.\n> This is a **comprehensive** task where LLM integrates all 7 phases of analysis.\n\n#### 8.2 Input Context\n**← P1-P7**: ALL preceding phase outputs\n\n#### 8.3 Knowledge Reference\n**Compliance Frameworks** + **ASVS** (compliance verification)\n\n```bash\n$SKILL_PATH/kb --compliance nist-csf\n$SKILL_PATH/kb --asvs-level L2 --chapter V1\n```\n\n#### 8.4 ⚠️ MANDATORY: Output Directory Setup\n\n**在生成任何报告之前，必须执行以下步骤**:\n\n1. **确定 PROJECT 名称**: 从项目名提取，转换为大写\n   - 示例: `open-webui` → `OPEN-WEBUI`\n   - 格式: `^[A-Z][A-Z0-9-]{0,29}$`\n\n2. **创建输出目录**:\n   ```bash\n   mkdir -p {PROJECT_ROOT}/Risk_Assessment_Report/\n   ```\n\n3. **所有报告必须输出到此目录**:\n   - 主报告: `Risk_Assessment_Report/{PROJECT}-RISK-ASSESSMENT-REPORT.md`\n   - 风险清单: `Risk_Assessment_Report/{PROJECT}-RISK-INVENTORY.md`\n   - 缓解措施: `Risk_Assessment_Report/{PROJECT}-MITIGATION-MEASURES.md`\n\n⚠️ **禁止**: 直接在项目根目录创建报告文件！\n\n#### 8.5 Report Structure (9 Sections + Appendix)\n**CRITICAL**: Sections 5, 6, and 8 must include COMPLETE Phase 6 and Phase 7 outputs without omission.\n\n> **Template Reference**: `assets/templates/RISK-ASSESSMENT-REPORT.template.md`\n\n```markdown\n# {PROJECT}-RISK-ASSESSMENT-REPORT.md\n\n## 1. 执行摘要 (Executive Summary)\n- 威胁统计、STRIDE分布、关键发现、立即行动建议\n\n## 2. 系统架构概览 (System Architecture)\n- 组件拓扑ASCII图、数据流图DFD、信任边界、技术栈\n- (from findings_1, findings_2, findings_3)\n\n## 3. 安全功能设计评估 (Security Design Assessment)\n- 9安全域评估矩阵、关键安全发现详情\n- (from findings_4)\n\n## 4. STRIDE 威胁分析 (STRIDE Threat Analysis)\n- 威胁汇总表、按STRIDE分类表、威胁详细分析\n- (from findings_5)\n\n## 5. 风险验证与POC设计 (Risk Validation & POC) ← CRITICAL\n- POC验证方法论、验证覆盖统计、POC验证详情、POC汇总表\n- 每个Critical/High威胁必须有完整POC代码块\n- (from validated_risks.poc_details)\n\n## 6. 攻击路径分析 (Attack Path Analysis) ← CRITICAL\n- 攻击路径可行性矩阵、攻击链详细分析、攻击面热力图、优先级排序\n- 每条高危攻击路径必须有ASCII攻击链图\n- (from validated_risks.attack_chains, validated_risks.attack_path_matrix)\n\n## 7. 威胁优先级矩阵 (Threat Priority Matrix)\n- 风险评估矩阵、威胁分布矩阵、攻击面热力图\n\n## 8. 缓解措施建议 (Mitigation Recommendations) ← CRITICAL\n- P0/P1/P2分级措施、实施路线图、防御纵深架构\n- (from mitigation_plan)\n\n## 9. 合规性映射 (Compliance Mapping)\n- OWASP Top 10映射、OWASP LLM Top 10映射(如适用)\n\n## 附录 (Appendices)\n- A: DFD元素完整清单\n- B: Mermaid DFD源码\n- C: 威胁完整清单\n- D: 知识库查询记录\n- E: 参考资料\n```\n\n#### 8.6 Output Files\n\n**输出目录**: `{PROJECT_ROOT}/Risk_Assessment_Report/`\n\n**必需报告** (始终生成):\n| 序号 | 报告文件 | 说明 |\n|------|---------|------|\n| 1 | `{PROJECT}-RISK-ASSESSMENT-REPORT.md` | 风险评估报告 (主报告) |\n| 2 | `{PROJECT}-RISK-INVENTORY.md` | 风险清单 |\n| 3 | `{PROJECT}-MITIGATION-MEASURES.md` | 缓解措施 |\n| 4 | `{PROJECT}-PENETRATION-TEST-PLAN.md` | 渗透测试方案 |\n\n#### 8.7 ⚠️ MANDATORY: Phase Output Publication\n\n**在生成所有报告后，必须执行阶段过程文档发布**:\n\n将 `.phase_working/` 中的阶段产物复制到 `Risk_Assessment_Report/` 目录，**保留英文文件名**:\n\n```yaml\nphase_output_publication:\n  source_dir: \".phase_working/\"\n  target_dir: \"Risk_Assessment_Report/\"\n  files:  # 直接复制，保留原文件名\n    - P1-PROJECT-UNDERSTANDING.md    # Phase 1 项目理解\n    - P2-DFD-ANALYSIS.md             # Phase 2 DFD分析\n    - P3-TRUST-BOUNDARY.md           # Phase 3 信任边界\n    - P4-SECURITY-DESIGN-REVIEW.md   # Phase 4 安全设计评估\n    - P5-STRIDE-THREATS.md           # Phase 5 STRIDE威胁分析\n    - P6-RISK-VALIDATION.md          # Phase 6 风险验证\n```\n\n**执行命令** (示例):\n```bash\n# 复制阶段过程文档到报告目录 (保留英文名)\ncp .phase_working/P1-PROJECT-UNDERSTANDING.md Risk_Assessment_Report/\ncp .phase_working/P2-DFD-ANALYSIS.md Risk_Assessment_Report/\ncp .phase_working/P3-TRUST-BOUNDARY.md Risk_Assessment_Report/\ncp .phase_working/P4-SECURITY-DESIGN-REVIEW.md Risk_Assessment_Report/\ncp .phase_working/P5-STRIDE-THREATS.md Risk_Assessment_Report/\ncp .phase_working/P6-RISK-VALIDATION.md Risk_Assessment_Report/\n```\n\n**价值说明**:\n- 阶段过程文档记录完整分析过程\n- 支持审计追溯和质量验证\n- 便于团队理解威胁建模推导逻辑\n- 保留英文名确保命名规范一致性\n\n---\n\n## Scripts Reference\n\n| Script | Purpose | Key Commands |\n|--------|---------|--------------|\n| `list_files.py` | Phase 1: File listing | `--categorize`, `--detect-type` |\n| `stride_matrix.py` | Phase 5: STRIDE matrix | `--element`, `--generate-id` |\n| `unified_kb_query.py` | **Phase 4-8: KB queries** | See below |\n\n### unified_kb_query.py - Complete Parameter Reference\n\n#### STRIDE Queries\n```bash\n--stride {spoofing|tampering|repudiation|information_disclosure|denial_of_service|elevation_of_privilege}\n--all-stride                    # All STRIDE categories overview\n--element {process|data_store|data_flow|external_interactor}\n```\n\n#### CWE Queries\n```bash\n--cwe CWE-XXX                   # Query specific CWE\n--cwe CWE-XXX --mitigations     # Include detailed mitigations\n--full-chain CWE-XXX            # Complete chain: STRIDE→CWE→CAPEC→ATT&CK\n```\n\n#### CAPEC Attack Patterns\n```bash\n--capec CAPEC-XXX               # Query specific CAPEC\n--capec CAPEC-XXX --attack-chain  # Include ATT&CK technique mapping\n```\n\n#### ATT&CK Techniques\n```bash\n--attack-technique TXXX         # Query ATT&CK technique\n--attack-mitigation MXXX        # Query ATT&CK mitigation\n--attack-search \"keyword\"       # Search ATT&CK techniques\n```\n\n#### CVE Queries\n```bash\n--cve CVE-XXXX-XXXXX            # Direct CVE query\n--cve-for-cwe CWE-XXX           # CVEs by CWE\n--cve-severity {CRITICAL|HIGH|MEDIUM|LOW}\n--check-kev CVE-XXXX            # Check Known Exploited Vulnerability\n```\n\n#### Verification Set Queries (NEW)\n```bash\n--stride-tests {S|T|R|I|D|E}    # Get verification tests for STRIDE category\n--cwe-tests CWE-XXX             # Get verification tests for CWE\n--asvs-level {L1|L2|L3}         # Get ASVS requirements by level\n--asvs-chapter {V1|V2|...}      # Get ASVS requirements by chapter\n--wstg-category {ATHN|AUTHZ|...}  # Get WSTG tests by category\n```\n\n#### Cloud & LLM Extensions\n```bash\n--cloud {aws|azure|gcp|alibaba|tencent}\n--category {compute|storage|database|networking|identity|serverless}\n--llm LLM01                     # Query OWASP LLM Top 10\n--all-llm                       # All OWASP LLM Top 10 threats\n--ai-component {llm_inference_service|rag_retrieval|...}\n```\n\n#### Semantic Search\n```bash\n--semantic-search \"query\"       # Natural language search\n--search-type {cwe|capec|all}\n```\n\n---\n\n## Knowledge Base Layers\n\n| Layer | Source | Content | Use Case |\n|-------|--------|---------|----------|\n| **L1: Curated** | YAML + Markdown | Security domains, controls, references | Phase 2-4 |\n| **L2: Indexed** | SQLite (18MB) | 974 CWEs, 615 CAPECs, 835 ATT&CK | Phase 5-7 |\n| **L3: Extension** | SQLite (304MB) | 323K+ CVEs | Phase 6 CVE lookup |\n| **L4: Live** | NVD/KEV API | Real-time CVE/KEV | Exploit context |\n| **L5: Verification** | SQLite | WSTG, MASTG, ASVS | Phase 6-8 |\n\n---\n\n## Parallel Sub-Agent Pattern <ultrathink><critical thinking>\n\nFor Phases 5/6/7 with multiple risks:\n\n```\nMain Agent                    Sub-Agents (Parallel)\n    │                         ┌─────────────────┐\n    │──► Risk 1 ──────────────► Agent 1 ──► KB Query ──► Result 1\n    │                         └─────────────────┘\n    │                         ┌─────────────────┐\n    │──► Risk 2 ──────────────► Agent 2 ──► KB Query ──► Result 2\n    │                         └─────────────────┘\n    │                         ┌─────────────────┐\n    │──► Risk N ──────────────► Agent N ──► KB Query ──► Result N\n    │                         └─────────────────┘\n    │\n    ◄───────────────── Aggregate Results ──────────────────\n```\n\n---\n\n## Large Project Handling\n\n| Scale | File Count | Module Count | Strategy |\n|-------|------------|--------------|----------|\n| Small | <50 | <5 | Standard 8-phase analysis |\n| Medium | 50-200 | 5-15 | Module-priority (key modules deep) |\n| Large | 200-500 | 15-30 | Subsystem split + merge |\n| Very Large | >500 | >30 | Layered analysis + parallel sub-agents |\n\n**Subsystem Threat ID**: `T-{STRIDE}-{SubsysID}-{ElementID}-{Seq}`\n\n---\n\n## Common Pitfalls\n\n| Pitfall | Solution |\n|---------|----------|\n| Skipping phases | Execute all 8 phases in order |\n| Not using KB queries | Use `unified_kb_query.py` for every risk |\n| Generic mitigations | Query CWE-specific mitigations from KB |\n| Missing attack paths | Use CAPEC + ATT&CK for verification |\n| No reflection | Summarize and reflect after each phase |\n| Parallel phase execution | Phases are strictly serial |\n| Incomplete Phase 6 consolidation | Must include ALL P1-P5 findings |\n| Phase 8 omissions | Must include COMPLETE P6 and P7 outputs |\n\n---\n\n## Reference Files\n\n**Workflow & Phase Details** (load progressively):\n- `@WORKFLOW.md` - Phase 1-5 detailed workflow\n- `@VALIDATION.md` - Phase 6 (Risk Validation) complete workflow, consolidation process, POC templates\n- `@REPORT.md` - Phase 7-8 (Mitigation & Report) with **mandatory content aggregation rules**\n- `EXAMPLES.md` - Real-world threat modeling examples\n\n**Schemas** (format specifications):\n- `assets/schemas/risk-detail.schema.md` - Risk detail format, priority mapping (P0-P3), required fields\n- `assets/schemas/phase-risk-summary.schema.md` - Phase output summary format (if exists)\n\n**Knowledge Base** (query via scripts—do NOT load directly):\n- `assets/knowledge/security_kb.sqlite` - Core database\n- `assets/knowledge/security_kb_extension.sqlite` - CVE extension\n- `assets/knowledge/*.yaml` - Curated mappings\n- `assets/knowledge/security-controls/*.md` - Control sets\n- `assets/knowledge/security-controls/references/*.md` - OWASP references\n"
      },
      "plugins": [
        {
          "name": "threat-modeling",
          "description": "Code-First Deep Threat Modeling Skill with strict 8-phase sequential workflow: P1 Project Understanding, P2 Call Flow & DFD Analysis, P3 Trust Boundary Evaluation, P4 Security Design Review, P5 STRIDE Threat Analysis, P6 Risk Validation with POC Design, P7 Mitigation Planning with ASVS alignment, P8 Report Generation with mandatory outputs.",
          "source": "./",
          "strict": false,
          "skills": [
            "./"
          ],
          "categories": [],
          "install_commands": [
            "/plugin marketplace add fr33d3m0n/skill-threat-modeling",
            "/plugin install threat-modeling@skill-threat-modeling"
          ]
        }
      ]
    }
  ]
}