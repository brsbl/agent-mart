{
  "author": {
    "id": "8DE4732A",
    "display_name": "8DE4732A",
    "avatar_url": "https://avatars.githubusercontent.com/u/10718172?u=24cf97f7c250bcdc07e33eefe47e33a782d1d93c&v=4"
  },
  "marketplaces": [
    {
      "name": "teamclaude-marketplace",
      "version": null,
      "description": "TeamClaude plugin marketplace – tools for team coding analytics and virtual office",
      "repo_full_name": "8DE4732A/teamclaude",
      "repo_url": "https://github.com/8DE4732A/teamclaude",
      "repo_description": null,
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-02-11T14:01:41Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"teamclaude-marketplace\",\n  \"owner\": {\n    \"name\": \"TeamClaude\"\n  },\n  \"metadata\": {\n    \"description\": \"TeamClaude plugin marketplace – tools for team coding analytics and virtual office\",\n    \"version\": \"0.1.0\",\n    \"pluginRoot\": \"./plugins\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"teamclaude-sidecar\",\n      \"source\": \"./plugins/teamclaude-sidecar\",\n      \"description\": \"Auto-reports coding activity from Claude Code sessions to your TeamClaude server\",\n      \"version\": \"0.0.1\",\n      \"author\": {\n        \"name\": \"TeamClaude\"\n      },\n      \"keywords\": [\"analytics\", \"telemetry\", \"team\"],\n      \"category\": \"analytics\"\n    }\n  ]\n}\n",
        "README.md": "# TeamClaude\n\n**Claude Code 团队效能可视化与虚拟办公室系统**\n\nTeamClaude 通过自动采集 Claude Code 的使用行为，将团队成员的工作状态映射到一个像素风 2D 虚拟办公室中。管理者可以直观看到\"谁在编码、谁在摸鱼\"，开发者也能感受到团队的协作氛围——即使大家都在远程办公。\n\n## 背景与目标\n\n团队全面采用 Claude Code 后，管理者需要量化工具使用情况，开发者也需要缓解远程协作的疏离感。TeamClaude 用三个核心目标解决这个问题：\n\n1. **数据透明化** — 自动采集 Claude Code 使用事件（命令执行、代码生成、对话交互），仅收集元数据，不采集代码或 Prompt 内容\n2. **可视化管理** — 提供个人/团队维度的活跃度报表和热力图\n3. **团队虚拟化** — 像素风虚拟办公室，Avatar 行为实时反映工作状态（编码中→坐在工位 / 空闲→走廊闲逛 / 离线→消失）\n\n## 架构\n\n```\n开发者本地                         服务端                        浏览器\n┌──────────────┐    HTTP POST    ┌──────────────┐  WebSocket   ┌──────────────┐\n│ Claude Code  │───────────────→ │   Server     │────────────→ │  Virtual     │\n│ + Sidecar    │  events/heartbeat│  (NestJS)    │  presence    │  Office      │\n│   Plugin     │                 │              │  broadcast   │  (Vite+TS)   │\n└──────────────┘                 └──────┬───────┘              └──────────────┘\n                                        │\n                                   MongoDB + Redis\n```\n\n| 组件 | 位置 | 职责 |\n|---|---|---|\n| **Sidecar Plugin** | `plugins/teamclaude-sidecar/` | Claude Code 钩子，本地事件队列，批量上报 |\n| **Server** | `apps/server/` | 事件接收、去重、Presence 状态机、WebSocket 广播、统计聚合 |\n| **Web** | `apps/web/` | 虚拟办公室渲染、Avatar 动画、HUD 数据卡片 |\n\n## 当前实现状况\n\n### 已完成\n\n- **Sidecar Plugin** — 完整的事件采集链路：钩子拦截 → 本地 NDJSON 队列 → 批量 flush + 心跳上报；支持离线缓存；异步执行不阻塞 Claude Code\n- **事件接收 API** — `POST /v1/ingest/events` + `POST /v1/ingest/heartbeat`，字段白名单校验，eventId 去重，租户隔离\n- **Presence 状态机** — Coding / Idle / Offline 三态转换，5 分钟无活动→Idle，15 分钟无心跳→Offline\n- **WebSocket 广播** — Socket.io 按租户分房间推送 `presence.stateChanged` 和 `presence.targetChanged`\n- **Office 模块** — 静态地图加载、座位分配、Avatar 预设选择\n- **Stats 模块** — 个人今日统计（交互次数、最后活跃、24h 热力图）、团队 7 日趋势\n- **Web 前端** — API Client、OfficeScene 状态机、PresenceStore 响应式订阅、UserHudCard 组件\n- **E2E 测试** — 验证事件写入后 2 秒内产生 Coding 状态广播\n- **Plugin Marketplace** — 仓库级 marketplace 清单，支持一键安装插件\n\n### 待实现\n\n- 虚拟办公室像素风渲染（Tilemap + Canvas）和 Avatar 寻路动画\n- 管理后台数据报表 UI\n- SSO 登录（当前仅 header-based 租户认证）\n- AI 生成像素头像\n\n## 路线图\n\n| 阶段 | 内容 |\n|---|---|\n| **P1 (MVP)** | 数据上报、基础认证、虚拟办公室（闲逛/编码状态切换）、基础报表 |\n| **P2** | AI 生成像素头像、个人详细分析面板、SSO 集成 |\n| **P3** | 虚拟办公室互动功能（角色靠近触发聊天气泡）、团队协作检测 |\n\n## 本地运行\n\n1. 安装依赖：\n\n```bash\npnpm install\n```\n\n2. 准备环境变量：\n\n```bash\ncp apps/server/.env.example apps/server/.env\ncp apps/web/.env.example apps/web/.env\n```\n\n3. 使用 Compose 启动（server + web + MongoDB + Redis）：\n\n```bash\ndocker compose up -d\n```\n\n## 安装 Sidecar 插件\n\n```bash\n# 方式一：通过 Marketplace\n/plugin marketplace add https://github.com/<owner>/teamclaude.git\n/plugin install teamclaude-sidecar\n\n# 方式二：直接添加\nclaude plugin add /path/to/plugins/teamclaude-sidecar\n```\n\n配置环境变量（`~/.zshrc` 或 `~/.bashrc`）：\n\n```bash\nexport SIDECAR_API_BASE_URL=\"https://your-server.com\"\nexport SIDECAR_TENANT_ID=\"your-org\"\nexport SIDECAR_USER_ID=\"your-name\"\n```\n\n## 测试\n\n```bash\n# 单元/模块测试\npnpm -C apps/server test\npnpm -C apps/web test\npnpm -C plugins test\n\n# 端到端测试\npnpm test:e2e tests/e2e/presence-flow.spec.ts\n```\n",
        "plugins/teamclaude-sidecar/README.md": "# TeamClaude Sidecar — Claude Code Plugin\n\nAutomatically reports coding activity from Claude Code sessions to your TeamClaude server.\n\n## Prerequisites\n\n- Node.js 18+\n- A running TeamClaude server instance\n\n## Environment Variables\n\n| Variable | Required | Description | Default |\n|---|---|---|---|\n| `SIDECAR_API_BASE_URL` | Yes | TeamClaude server URL | — |\n| `SIDECAR_TENANT_ID` | Yes | Your organization identifier | — |\n| `SIDECAR_USER_ID` | Yes | Your user identifier | — |\n| `SIDECAR_QUEUE_FILE` | No | Path to the offline queue file | `~/.teamclaude/queue.ndjson` |\n\nAdd these to `~/.zshrc` or `~/.bashrc`:\n\n```bash\nexport SIDECAR_API_BASE_URL=\"https://your-server.com\"\nexport SIDECAR_TENANT_ID=\"your-org\"\nexport SIDECAR_USER_ID=\"your-name\"\n```\n\n## Installation\n\n### Option A: Marketplace (Recommended)\n\n```bash\n# Add the marketplace (one-time)\n/plugin marketplace add https://github.com/<owner>/teamclaude.git\n\n# Install the plugin\n/plugin install teamclaude-sidecar\n```\n\n### Option B: CLI (direct)\n\n```bash\nclaude plugin add /path/to/plugins/teamclaude-sidecar\n```\n\n### Option C: Manual\n\nEdit `~/.claude/settings.json`:\n\n```json\n{\n  \"enabledPlugins\": [\"/path/to/plugins/teamclaude-sidecar\"]\n}\n```\n\n## How It Works\n\nThe plugin registers Claude Code hooks that fire on coding activity:\n\n| Hook | Trigger | Event Type |\n|---|---|---|\n| `PostToolUse` (Bash) | Shell command executed | `command` |\n| `PostToolUse` (Edit/Write) | File modified | `codegen` |\n| `UserPromptSubmit` | User sends a prompt | `chat` |\n| `SessionStart` | Session begins | flush + heartbeat |\n| `Stop` | Task completes | flush + heartbeat |\n| `SessionEnd` | Session ends | flush |\n\n**Privacy**: Only metadata is collected (event type, timestamp, project hash). No prompts, code, or command content is ever transmitted.\n\n### Architecture\n\nTwo scripts handle all work:\n\n- **`handle-hook.mjs`** — Runs on every tool use / prompt. Appends a single NDJSON line to the queue file. No network I/O (<50ms).\n- **`flush-and-heartbeat.mjs`** — Runs on session start/stop. Sends queued events to the server and reports a heartbeat. Retains events on failure.\n\nAll hooks run with `\"async\": true` so they never block Claude Code.\n"
      },
      "plugins": [
        {
          "name": "teamclaude-sidecar",
          "source": "./plugins/teamclaude-sidecar",
          "description": "Auto-reports coding activity from Claude Code sessions to your TeamClaude server",
          "version": "0.0.1",
          "author": {
            "name": "TeamClaude"
          },
          "keywords": [
            "analytics",
            "telemetry",
            "team"
          ],
          "category": "analytics",
          "categories": [
            "analytics",
            "team",
            "telemetry"
          ],
          "install_commands": [
            "/plugin marketplace add 8DE4732A/teamclaude",
            "/plugin install teamclaude-sidecar@teamclaude-marketplace"
          ]
        }
      ]
    }
  ]
}