{
  "author": {
    "id": "aannoo",
    "display_name": "Anno",
    "avatar_url": "https://avatars.githubusercontent.com/u/31200447?v=4"
  },
  "marketplaces": [
    {
      "name": "hcom",
      "version": "1.0.0",
      "description": "Multi-agent communication for AI CLI tools (Claude Code, Gemini CLI, Codex)",
      "repo_full_name": "aannoo/hcom",
      "repo_url": "https://github.com/aannoo/hcom",
      "repo_description": "Realtime messaging and context sharing for AI coding agents (Claude Code, Gemini CLI, Codex)",
      "signals": {
        "stars": 64,
        "forks": 9,
        "pushed_at": "2026-01-27T18:10:16Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\r\n  \"$schema\": \"https://anthropic.com/claude-code/marketplace.schema.json\",\r\n  \"name\": \"hcom\",\r\n  \"version\": \"1.0.0\",\r\n  \"description\": \"Multi-agent communication for AI CLI tools (Claude Code, Gemini CLI, Codex)\",\r\n  \"metadata\": {\r\n    \"description\": \"Multi-agent communication for AI CLI tools (Claude Code, Gemini CLI, Codex)\"\r\n  },\r\n  \"owner\": {\r\n    \"name\": \"aannoo\"\r\n  },\r\n  \"plugins\": [\r\n    {\r\n      \"name\": \"hcom\",\r\n      \"source\": \"./plugin/hcom\",\r\n      \"description\": \"Real-time messaging and context sharing for AI coding agents (Claude Code, Gemini CLI, Codex)\",\r\n      \"category\": \"productivity\",\r\n      \"homepage\": \"https://github.com/aannoo/hcom\"\r\n    }\r\n  ]\r\n}\r\n",
        "README.md": "# hcom\n\n[![PyPI](https://img.shields.io/pypi/v/hcom)](https://pypi.org/project/hcom/)\n[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)\n[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)\n\n\n**hcom connects Claude Code, Gemini CLI, and Codex through hooks and a live event bus.**\n\nWhen agents send messages or trigger subscribed events, hooks inject notifications into other agents - waking them from idle or delivering mid-turn.\n\n\n![demo](https://raw.githubusercontent.com/aannoo/hcom/refs/heads/assets/screencapture-new.gif)\n\n---\n\n## Quickstart\n\n```bash\npip install hcom\n```\n\nRun agents with `hcom` in front:\n\n```bash\nhcom claude\nhcom gemini\nhcom codex\n```\n\nTalk to any agent in natural language:\n\n>\\> send a message to claude\n\n\n```bash\nhcom            # TUI\n```\n\n---\n\n## What it is\n\n**hcom is a local message bus + event log.**\n\n- Hooks + CLI capture agent activity into sqlite\n- Hooks + PTY deliver relevant events back into agent context\n\n```text\nagents ──→ hooks ──→ sqlite ──→ hooks ──→ other agents\n```\n\n---\n\n## Messaging\n\nMessages arrive mid-turn after tool calls, or instantly wake agents when idle.\n\n- Route to everyone\n- @mention specific agents\n- Group agents at runtime with tag prefixes\n\n\n\n## Transcripts\n\nEach agent can query another's conversation history in structured chunks:\n\n```bash\nhcom transcript @agent 5-10     # exchanges 5 through 10\nhcom transcript timeline        # user prompts across all agents\n```\n\n> \\> send claude the transcript slice where I decided on the cake feature\n\n\n\n## Event Subscriptions\n\nAgents subscribe to patterns and get notified via hcom messages:\n\n```bash\n--collision             # 2 agents edit the same file\n--idle peso             # agent peso finishes its turn\n--cmd \"git\"             # shell commands containing pattern\n--agent peso --file Y    # agent peso edits file Y\n--sql \"query\"           # any SQL WHERE clause\n```\n\n> \\> subscribe to when any agent runs \"git commit\" and do something\n\n**Collision detection runs by default** - when agents edit the same file within 20s, both get instant notifications.\n\n## Spawn\n\nAgents can launch other agents into new terminal windows/tabs/panes.\n\n```bash\nhcom 3 codex              # open 3 codex instances\n```\n\n> \\> spawn a gemini to write tests for this feature\n\nWorks with any terminal emulator—iTerm, tmux, etc. See `hcom config terminal --info`\n\n---\n\n## Examples\n\nRun with `hcom run <script>`\n\n`clone` - spawn a fork of the current agent into a new terminal with a task. Result send back via hcom message.\n\n`watcher` - background reviewer subscribes to an agent's work (gets hcom notification every turn boundary to review diff) and logs 'lgtm' or flags real issues to the agent via hcom message.\n\n`confess` — honesty self-evaluation based on OpenAI's confessions paper: the target agent writes a confession report; a calibrator generates an independent report from transcript-only; a judge compares and returns a verdict via hcom to the target agent. `--fork` runs in the background with a fork.\n\n`debate` — launches a judge/coordinator who sets up a structured debate where existing agents choose sides dynamically with shared context of transcript ranges + workspace files. Rounds, rebuttals, verdict.\n\nCreate new workflows by telling agent: *\"look at `hcom run docs` then make a script that does X\"*\n\n---\n\n## Tools\n\n| Agents | When messages arrive | Why |\n|------|----------------------|-------|\n| **Claude Code** (including subagents) | idle + mid-turn | *many hooks* |\n| **Gemini CLI** (v0.24.0+) | idle + mid-turn | *many hooks* |\n| **Codex** | idle + `hcom listen` | *1 hook* |\n| **Any AI tool that can run shell commands** | manual (`hcom start`, `hcom listen`) | *no hooks* |\n\n### Connect from inside any session\n\n> \\> Run this and connect: hcom start -h\n\n### Ping from any process\n\n```bash\nhcom send <message> --from bot-name\n```\n\n#### Claude Code headless\n\n```bash\nhcom claude -p 'do task'    # detached background (manage via TUI)\n```\n#### Claude code subagents\n\n> \\> run 2x task tool and get them to talk to each other in hcom\n\n---\n\n## Cross-Device\n\nConnect agents across machines via free private HuggingFace Space:\n\n```bash\n# local\nhcom relay hf <HF_TOKEN>\n\n# remote/cloud                 \npip install hcom && hcom relay hf <HF_TOKEN> && hcom start -h   \n```\n\n---\n\n## What gets installed\n\nHooks install to `~/` (or `HCOM_DIR`) on launch or `hcom start`. \nIf you aren't using hcom, the hooks do nothing.\n\n```bash\nhcom hooks remove                  # Safely remove only hcom hooks\nhcom status                        # install status\n```\n\n```bash\nHCOM_DIR=$PWD/.hcom                # for sandbox or project local\n```\n\n---\n\n## Reference\n\n<details>\n<summary>CLI</summary>\n\n```\n# hcom CLI Reference\n\nhcom (hook-comms) v0.6.13 - multi-agent communication\n\nUsage:\n  hcom                                  TUI dashboard\n  hcom <N> claude|gemini|codex [args]   Launch (args passed to tool)\n  hcom <command>                        Run command\n\nCommands:\n  send         Send message to your buddies\n  listen       Block and receive messages\n  bundle       Create and query bundles\n  list         Show participants, status, read receipts\n  start        Enable hcom participation\n  stop         Disable hcom participation\n  events       Query events / subscribe for push notifications\n  transcript   View another agent's conversation\n  run          Run workflows from ~/.hcom/scripts/\n  config       Get/set config environment variables\n  relay        Cross-device live chat\n  archive      Query archived sessions\n  reset        Archive & clear database\n  hooks        Add or remove hooks\n  status       Show installation status and diagnostics\n\nIdentity:\n  1. Run hcom start to get name\n  2. Use --name in all the other hcom commands\n\nRun 'hcom <command> --help' for details.\n\n\n\n## events\n\nUsage:\n  Query the event stream (messages, status changes, file edits, lifecycle)\n\n\nQuery:\n    events                         Recent events as JSON\n    --last N                       Limit count (default: 20)\n    --all                          Include archived sessions\n    --wait [SEC]                   Block until match (default: 60s)\n    --sql EXPR                     SQL WHERE filter\n\n\nFilters (compose with AND):\n    --agent NAME                   Match specific agent\n    --type TYPE                    message | status | life\n    --status VAL                   listening | active | blocked\n    --context PATTERN              tool:Bash | deliver:X (supports * wildcard)\n    --file PATH                    File path (*.py for glob, file.py for contains)\n    --cmd PATTERN                  Command (contains default, ^start, =exact)\n    --from NAME                    Message sender\n    --mention NAME                 Message mentions\n    --action VAL                   created | stopped | ready\n    --intent VAL                   request | inform | ack | error\n    --thread NAME                  Message thread\n    --after TIME                   Events after timestamp (ISO-8601)\n    --before TIME                  Events before timestamp (ISO-8601)\n    --collision                    File collision detection\n\n\nShortcuts:\n    --idle NAME                    --agent NAME --status listening\n    --blocked NAME                 --agent NAME --status blocked\n\n\nSubscribe:\n    events sub                     List subscriptions\n    events sub [filters]           Push notification when event matches\n      --once                       Auto-remove after first match\n      --for <name>                 Subscribe for another agent\n    events unsub <id>              Remove subscription\n\n\nExamples:\n    events --agent peso --status listening \n    events --cmd git --agent peso  \n    events --file '*.py' --last 100 \n    events sub --idle peso         \n    events sub --cmd 'npm test' --once \n\n\nSQL columns (events_v view):\n    Base                           id, timestamp, type, instance\n    msg_*                          from, text, scope, sender_kind, delivered_to[], mentions[], intent, thread, reply_to\n    status_*                       val, context, detail\n    life_*                         action, by, batch_id, reason\n\nField values:\n    type                           message, status, life\n    msg_scope                      broadcast, mentions\n    msg_sender_kind                instance, external, system\n    status_context                 tool:X, deliver:X, approval, prompt, exit:X\n    life_action                    created, ready, stopped, batch_launched\n\n  Example SQL: msg_from = 'luna' AND type = 'message'\n  Use <> instead of != for SQL negation\n\n## list\n\nUsage:\n  hcom list                       All agents\n    -v                             Verbose\n    --json                         Verbose JSON (one per line)\n\n  hcom list [self|<name>]         Details\n    [field]                        Print specific field (status, directory, session_id, etc)\n    --json                         Output as JSON\n    --sh                           Shell exports: eval \"$(hcom list self --sh)\"\n\n  hcom list --stopped [name]      Stopped instances (from events)\n    --all                          All stopped (default: last 20)\n\n## send\n\nUsage:\n  hcom send \"msg\"                 Broadcast message\n  hcom send \"@name msg\"           Send to specific agent/group\n  hcom send --stdin               Read message from stdin\n    --name <name>                  Identity (agent name or UUID)\n    --from <name>                  External sender identity, alias: -b\n\n\nBundle flags (inline creation):\n    --title <text>                 Create and attach bundle inline\n    --description <text>           Bundle description (required with --title)\n    --events <ids>                 Event IDs/ranges: 1,2,5-10 (required)\n    --files <paths>                Comma-separated file paths (required)\n    --transcript <ranges>          Transcript ranges with detail (required)\n      Format: range:detail (e.g., 3-14:normal,6:full,22-30:detailed)\n    --extends <id>                 Parent bundle (optional)\n  See 'hcom bundle --help' for bundle details\n\n\nEnvelope (optional):\n    --intent <type>                request|inform|ack|error\n    --reply-to <id>                Link to event (42 or 42:BOXE for remote)\n    --thread <name>                Group related messages\n\n## bundle\n\nUsage:\n  hcom bundle                     List recent bundles (alias: bundle list)\n  hcom bundle list                List recent bundles\n    --last N                       Limit count (default: 20)\n    --json                         Output JSON\n\n  hcom bundle cat <id>            Expand and display full bundle content\n  Shows: metadata, files (metadata only), transcript (respects detail level), events\n\n  hcom bundle prepare             Show recent context and suggest bundle template\n    --for <agent>                  Prepare for specific agent (default: self)\n    --last-transcript N            Transcript entries to suggest (default: 20)\n    --last-events N                Events to scan per category (default: 30)\n    --json                         Output JSON\n  Shows suggested transcript ranges, relevant events, and files\n  Outputs ready-to-use bundle create command\n  TIP: Skip 'bundle create' by using bundle flags directly in 'hcom send'\n\n  hcom bundle show <id>           Show bundle by id/prefix\n    --json                         Output JSON\n\n  hcom bundle create \"title\"      Create bundle (positional or --title)\n    --title <text>                 Bundle title (alternative to positional)\n    --description <text>           Bundle description (required)\n    --events 1,2,5-10              Event IDs/ranges, comma-separated (required)\n    --files a.py,b.py              Comma-separated file paths (required)\n    --transcript RANGES            Transcript with detail levels (required)\n      Format: range:detail (e.g., 3-14:normal,6:full,22-30:detailed)\n      normal = truncated | full = --full flag | detailed = --detailed flag\n    --extends <id>                 Parent bundle\n    --bundle JSON                  Create from JSON payload\n    --bundle-file F                Create from JSON file\n    --json                         Output JSON\n\n\nJSON format:\n  {\n    \"title\": \"Bundle Title\",\n    \"description\": \"What happened, decisions, state, next steps\",\n    \"refs\": {\n      \"events\": [\"123\", \"124-130\"],  // IDs or ranges\n      \"files\": [\"src/auth.py\", \"tests/test_auth.py\"],\n      \"transcript\": [\"10-15:normal\", \"20:full\", \"30-35:detailed\"]\n    },\n    \"extends\": \"bundle:abc123\"  // optional\n  }\n\n  Note: All refs fields (events, files, transcript) are required\n\n  hcom bundle chain <id>          Show bundle lineage\n    --json                         Output JSON\n\n## stop\n\nUsage:\n  hcom stop                       End hcom participation\n  hcom stop <name>                End hcom for <name>\n  hcom stop <n1> <n2> ...         End hcom for multiple\n  hcom stop tag:<name>            End hcom for all with tag\n  hcom stop all                   End hcom for all\n\n## start\n\nUsage:\n  hcom is a cli tool for multi agent communication\n  the hcom start command shows you more info about hcom\n\n  hcom start                      Connect to hcom with new identity\n  hcom start --as <name>          Reclaim identity after compaction/resume\n\n  Inside a sandbox? Put this in front of every hcom command you run: HCOM_DIR=$PWD/.hcom\n\n## kill\n\nUsage:\n  hcom kill <name>                Kill headless process (Unix only)\n  hcom kill all                   Kill all with tracked PIDs\n  Sends SIGTERM to the process group\n\n## listen\n\nUsage:\n  hcom listen --name X [timeout]  Block and receive messages\n    [timeout]                      Timeout in seconds (alias for --timeout)\n    --timeout N                    Timeout in seconds (default: 86400)\n    --json                         Output messages as JSON\n    --sql \"filter\"                 Wait for event matching SQL (uses temp subscription)\n\n\nFilter flags:\n  Supports all filter flags from 'events' command\n  (--agent, --type, --status, --file, --cmd, --from, etc.)\n  Run 'hcom events --help' for full list\n  Filters combine with --sql using AND logic\n\n\nSQL filter mode:\n    --sql \"type='message'\"         Custom SQL against events_v\n    --idle NAME                    Wait for instance to go idle\n    --sql EXPR                     SQL WHERE filter\n    --sql stopped:name             Preset: wait for instance to stop\n    --sql blocked:name             Preset: wait for instance to block\n\n\nExit codes:\n    0                              Message received / event matched\n    1                              Timeout or error\n\n## reset\n\nUsage:\n  hcom reset                      Clear database (archive conversation)\n  hcom reset all                  Stop all + clear db + remove hooks + reset config\n\n\nSandbox/Local Mode:\n    If you can't write to ~/.hcom, set: \n      export HCOM_DIR=\"$PWD/.hcom\" \n    This installs hooks under $PWD (.claude/.gemini/.codex) and stores state in $HCOM_DIR \n\n    To remove local setup:         \n      hcom hooks remove && rm -rf \"$HCOM_DIR\" \n\n    To use explicit location:      \n      export HCOM_DIR=/your/path/.hcom \n\n    To regain global access:       \n      Fix ~/.hcom permissions, then: hcom hooks remove \n\n## config\n\nUsage:\n  hcom config                     Show all config values\n  hcom config <key>               Get single config value\n  hcom config <key> <val>         Set config value\n  hcom config <key> --info        Detailed help for a setting (presets, examples)\n    --json                         JSON output\n    --edit                         Open config in $EDITOR\n    --reset                        Reset config to defaults\n\nRuntime agent config:\n  hcom config -i <name>           Show agent config\n  hcom config -i <name> <key>     Get agent config value\n  hcom config -i <name> <key> <val> Set agent config value\n    -i self                        Current agent (requires Claude/Gemini/Codex context)\n    keys: tag, timeout, hints, subagent_timeout \n\nGlobal settings:\n    HCOM_TAG                       Group tag (creates tag-* names for agents)\n    HCOM_TERMINAL                  default | <preset> | \"cmd {script}\"\n    HCOM_HINTS                     Text appended to all messages received by agent\n    HCOM_SUBAGENT_TIMEOUT          Claude subagent timeout in seconds (default: 30)\n    HCOM_CLAUDE_ARGS               Default claude args (e.g. \"--model opus\")\n    HCOM_GEMINI_ARGS               Default gemini args\n    HCOM_CODEX_ARGS                Default codex args\n    HCOM_RELAY                     Relay server URL (set by 'hcom relay hf')\n    HCOM_RELAY_TOKEN               HuggingFace token (set by 'hcom relay hf')\n    HCOM_AUTO_APPROVE              Auto-approve safe hcom commands (1|0)\n    HCOM_AUTO_SUBSCRIBE            Auto-subscribe presets (e.g. \"collision\")\n    HCOM_NAME_EXPORT               Export instance name to custom env var\n\n  Non-HCOM_* vars in config.env pass through to Claude/Gemini/Codex\n  e.g. ANTHROPIC_MODEL=opus\n\n\nPrecedence: HCOM defaults < config.env < shell env vars\n  Each resolves independently\n\n  HCOM_DIR - per project/sandbox (must be set in shell, see 'hcom reset --help')\n\n## relay\n\nUsage:\n  hcom relay                      Show relay status\n  hcom relay on                   Enable cross-device live sync\n  hcom relay off                  Disable cross-device live sync\n  hcom relay pull                 Force sync now\n  hcom relay hf [token]           Setup HuggingFace Space relay\n    --update                       Update existing Space\n  Finds or duplicates a private, free HF Space to your account as the relay server.\n  Provide HF_TOKEN or run 'huggingface-cli login' first.\n\n## transcript\n\nUsage:\n  hcom transcript @name           View another agent's conversation\n  hcom transcript @name N         Show exchange N\n  hcom transcript @name N-M       Show exchanges N through M\n  hcom transcript timeline        Follow user prompts across all transcripts by time\n    --last N                       Limit to last N exchanges (default: 10)\n    --full                         Show full assistant responses\n    --detailed                     Show tool I/O, edits, errors\n    --json                         JSON output\n\n  hcom transcript search \"pattern\" Search hcom-tracked transcripts (rg or grep)\n    --live                         Only currently alive agents\n    --all                          All transcripts (includes non-hcom sessions)\n    --limit N                      Max results (default: 20)\n    --agent TYPE                   Filter: claude, gemini, or codex\n    --json                         JSON output\n\n  Tip: Reference transcript ranges in messages (e.g., \"see my transcript 7-10\")\n\n## archive\n\nUsage:\n  hcom archive                    List archived sessions (numbered)\n  hcom archive <N>                Query events from archive (1 = most recent)\n  hcom archive <N> agents         Query agents from archive\n  hcom archive <name>             Query by stable name (prefix match works)\n    --here                         Filter to archives with current directory\n    --sql \"expr\"                   SQL WHERE filter\n    --last N                       Limit to last N events (default: 20)\n    --json                         JSON output\n\n## run\n\nUsage:\n  hcom run                        List available workflow/launch scripts\n  hcom run <name> [args]          Run script or profile\n\n  Run `hcom run` to see available scripts and more info\n  Run `hcom run <script> --help` for script options\n  Run `hcom run docs` for Python API + full CLI ref + examples\n\n  Docs sections:\n    hcom run docs --cli            CLI reference only\n    hcom run docs --config         Config settings only\n    hcom run docs --api            Python API + scripts guide\n\n## claude\n\nUsage:\n  hcom [N] claude [args...]       Launch N Claude agents (default N=1)\n\n    hcom claude                    Opens new terminal\n    hcom N claude (N>1)            Opens new terminal windows\n    hcom N claude \"do task x\"      initial prompt\n    hcom 3 claude -p \"prompt\"      3 headless in background\n    HCOM_TAG=api hcom 2 claude     Group tag (creates api-*)\n    hcom 1 claude --agent <name>   .claude/agents/<name>.md\n    hcom 1 claude --system-prompt \"text\" System prompt\n\n\nEnvironment:\n    HCOM_TAG                       Group tag (agents become tag-*)\n    HCOM_TERMINAL                  default | <preset> | \"cmd {script}\"\n    HCOM_CLAUDE_ARGS               Default args (merged with CLI)\n    HCOM_HINTS                     Appended to messages received\n    HCOM_SUBAGENT_TIMEOUT          Seconds claude subagents are kept alive after finishing task\n\n\nResume:\n  Get session_id: 'hcom list --stopped' or 'hcom archive'\n    hcom claude --resume <session_id> 'reclaim identity' Resume stopped agent\n\n  Run \"claude --help\" for Claude CLI options\n  Run \"hcom config --help\" for config details\n\n## gemini\n\nUsage:\n  hcom [N] gemini [args...]       Launch N Gemini agents (default N=1)\n\n    hcom gemini                    Opens new terminal\n    hcom N gemini (N>1)            Opens new terminal windows\n    hcom N gemini -i \"do task x\"   initial prompt (-i flag required)\n    hcom N gemini --yolo           flags forwarded to gemini\n    HCOM_TAG=api hcom 2 gemini     Group tag (creates api-*)\n\n\nEnvironment:\n    HCOM_TAG                       Group tag (agents become tag-*)\n    HCOM_TERMINAL                  default | <preset> | \"cmd {script}\"\n    HCOM_GEMINI_ARGS               Default args (merged with CLI)\n    HCOM_HINTS                     Appended to all messages received\n    HCOM_GEMINI_SYSTEM_PROMPT      Use this for system prompt\n\n\nResume:\n  Get session_id: 'hcom list --stopped' or 'hcom archive'\n    hcom gemini --resume <session_id> -i 'reclaim identity' Resume stopped session\n\n  Run \"gemini --help\" for Gemini CLI options\n  Run \"hcom config --help\" for config details\n\n## codex\n\nUsage:\n  hcom [N] codex [args...]        Launch N Codex agents (default N=1)\n\n    hcom codex                     Opens new terminal\n    hcom N codex (N>1)             Opens new terminal windows\n    hcom N codex \"do task x\"       initial prompt (positional)\n    hcom codex --sandbox danger-full-access flags forwarded to codex\n    HCOM_TAG=api hcom 2 codex      Group tag (creates api-*)\n\n\nEnvironment:\n    HCOM_TAG                       Group tag (agents become tag-*)\n    HCOM_TERMINAL                  default | <preset> | \"cmd {script}\"\n    HCOM_CODEX_ARGS                Default args (merged with CLI)\n    HCOM_HINTS                     Appended to messages received\n    HCOM_CODEX_SYSTEM_PROMPT       Use this for system prompt\n\n\nResume:\n  Get session_id: 'hcom list --stopped' or 'hcom archive'\n    hcom codex resume <session_id> 'reclaim identity' Resume stopped session\n\n  Run \"codex --help\" for Codex CLI options\n  Run \"hcom config --help\" for config details\n\n## status\n\nUsage:\n  hcom status                     Show hcom installation status and diagnostics\n  hcom status --logs              Include recent errors and warnings\n  hcom status --json              Machine-readable output\n\n## hooks\n\nUsage:\n  hcom hooks                      Show hook status\n  hcom hooks status               Same as above\n  hcom hooks add [tool]           Add hooks (claude|gemini|codex|all)\n  hcom hooks remove [tool]        Remove hooks (claude|gemini|codex|all)\n\n  Hooks enable automatic message delivery and status tracking.\n  Without hooks, use ad-hoc mode (run hcom start in any ai tool).\n\n  After adding, restart the tool to activate hooks.\n  Remove cleans both global (~/) and HCOM_DIR-local if set.\n```\n\n</details>\n\n<details>\n<summary>Config</summary>\n\n```\n# Config Settings Reference\n\nConfig is stored in ~/.hcom/config.env (or $HCOM_DIR/config.env).\n\nCommands:\n  hcom config                 Show all values\n  hcom config <key> <val>     Set value\n  hcom config <key> --info    Detailed help for a setting\n  hcom config --edit          Open in $EDITOR\n\nPrecedence: defaults < config.env < shell environment variables\n\n## HCOM_TAG\n\nHCOM_TAG - Group tag for launched instances\n\nCurrent value: Use 'hcom config tag' to see current value\n\nPurpose:\n  Creates named groups of agents that can be addressed together.\n  When set, launched instances get names like: <tag>-<name>\n\nUsage:\n  hcom config tag myteam        # Set tag\n  hcom config tag \"\"            # Clear tag\n\n  # Or via environment:\n  HCOM_TAG=myteam hcom 3 claude\n\nEffect:\n  Without tag: launches create → luna, nova, kira\n  With tag \"dev\": launches create → dev-luna, dev-nova, dev-kira\n\nAddressing:\n  @dev         → sends to all agents with tag \"dev\"\n  @dev-luna    → sends to specific agent\n\nAllowed characters: letters, numbers, hyphens (a-z, A-Z, 0-9, -)\n\n## HCOM_TERMINAL\n\nHCOM_TERMINAL - Terminal for launching new instances\n\nCurrent value: Use 'hcom config terminal' to see current value\n\nValues:\n  default         Use platform default terminal\n  <preset>        Use a named preset (see list below)\n  <command>       Custom command with {script} placeholder\n\nAvailable presets:\n  default              Platform default (Terminal.app / wt / gnome-terminal)\n  Terminal.app         macOS Terminal\n  iTerm                macOS iTerm2\n  Ghostty              Fast GPU-accelerated terminal\n  kitty                GPU-accelerated terminal\n  WezTerm              Cross-platform GPU terminal\n  Alacritty            Minimal GPU-accelerated terminal\n  ttab                 Open in new tab (npm install -g ttab)\n  tmux-split           Split current tmux pane horizontally\n  wezterm-tab          New tab in WezTerm (requires wezterm CLI)\n  kitty-tab            New tab in kitty (requires kitten CLI)\n  custom               Custom command (see below)\n\n------------------------------------------------------------------------\nCUSTOM TERMINAL SETUP\n------------------------------------------------------------------------\n\nTo use a terminal not in the presets list, set a custom command.\nThe command MUST include {script} where the launch script path goes.\n\nHow it works:\n  1. hcom creates a bash script with the claude/gemini/codex command\n  2. Your terminal command is executed with {script} replaced by script path\n  3. The terminal runs the script, which starts the AI tool\n\nExamples (what the presets are):\n  ghostty:        open -na Ghostty.app --args -e bash {script}\n  kitty:          kitty {script}\n  alacritty:      alacritty -e bash {script}\n  gnome-terminal: gnome-terminal --window -- bash {script}\n  wezterm:        wezterm start -- bash {script}\n\nTesting your command:\n  1. Set the terminal: hcom config terminal \"your-command {script}\"\n  2. Launch a test: hcom 1 claude\n  3. If it fails, check that:\n     - The terminal binary/app exists\n     - {script} is in the right position\n\nReset to default:\n  hcom config terminal default\n\n## HCOM_HINTS\n\nHCOM_HINTS - Text injected with all messages\n\nCurrent value: Use 'hcom config hints' to see current value\n\nPurpose:\n  Appends text to every message received by launched agents.\n  Useful for persistent instructions or context.\n\nUsage:\n  hcom config hints \"Always respond in JSON format\"\n  hcom config hints \"\"   # Clear hints\n\nExample:\n  hcom config hints \"You are part of team-alpha. Coordinate with @team-alpha members.\"\n\nNotes:\n  - Hints are appended to message content, not system prompt\n  - Each agent can have different hints (set via hcom config -i <name> hints)\n  - Global hints apply to all new launches\n\n## HCOM_SUBAGENT_TIMEOUT\n\nHCOM_SUBAGENT_TIMEOUT - Timeout for Claude subagents (seconds)\n\nCurrent value: Use 'hcom config subagent_timeout' to see current value\nDefault: 30\n\nPurpose:\n  How long Claude waits for a subagent (Task tool) to complete.\n  Shorter than main timeout since subagents should be quick.\n\nUsage:\n  hcom config subagent_timeout 60    # 1 minute\n  hcom config subagent_timeout 30    # 30 seconds (default)\n\nNotes:\n  - Only applies to Claude Code's Task tool spawned agents\n  - Parent agent blocks until subagent completes or times out\n  - Increase for complex subagent tasks\n\n## HCOM_CLAUDE_ARGS\n\nHCOM_CLAUDE_ARGS - Default args passed to claude on launch\n\nExample: hcom config claude_args \"--model opus\"\nClear:   hcom config claude_args \"\"\n\nMerged with launch-time cli args (launch args win on conflict).\n\n## HCOM_GEMINI_ARGS\n\nHCOM_GEMINI_ARGS - Default args passed to gemini on launch\n\nExample: hcom config gemini_args \"--model gemini-2.5-flash\"\nClear:   hcom config gemini_args \"\"\n\nMerged with launch-time cli args (launch args win on conflict).\n\n## HCOM_CODEX_ARGS\n\nHCOM_CODEX_ARGS - Default args passed to codex on launch\n\nExample: hcom config codex_args \"--search\"\nClear:   hcom config codex_args \"\"\n\nMerged with launch-time cli args (launch args win on conflict).\n\n## HCOM_RELAY\n\nHCOM_RELAY - Relay server URL\n\nSet automatically by 'hcom relay hf'.\n\nCustom server: implement POST /push/{device_id}, GET /poll, GET /version\nSee: https://huggingface.co/spaces/aannoo/hcom-relay/blob/main/app.py\n\n## HCOM_RELAY_TOKEN\n\nHCOM_RELAY_TOKEN - HuggingFace token for private Space auth\nSet automatically by 'hcom relay hf'\n\nOr optional authentication token for custom server.\n\n## HCOM_AUTO_APPROVE\n\nHCOM_AUTO_APPROVE - Auto-approve safe hcom commands\n\nCurrent value: Use 'hcom config auto_approve' to see current value\n\nPurpose:\n  When enabled, Claude/Gemini/Codex auto-approve \"safe\" hcom commands\n  without requiring user confirmation.\n\nUsage:\n  hcom config auto_approve 1    # Enable auto-approve\n  hcom config auto_approve 0    # Disable (require approval)\n\nSafe commands (auto-approved when enabled):\n  send, start, list, events, listen, relay, config,\n  transcript, archive, status, help, --help, --version\n\nAlways require approval:\n  - hcom reset          (archives and clears database)\n  - hcom stop           (stops instances)\n  - hcom <N> claude     (launches new instances)\n\nValues: 1, true, yes, on (enabled) | 0, false, no, off, \"\" (disabled)\n\n## HCOM_AUTO_SUBSCRIBE\n\nHCOM_AUTO_SUBSCRIBE - Auto-subscribe event presets for new instances\n\nCurrent value: Use 'hcom config auto_subscribe' to see current value\nDefault: collision\n\nPurpose:\n  Comma-separated list of event subscriptions automatically added\n  when an instance registers with 'hcom start'.\n\nUsage:\n  hcom config auto_subscribe \"collision,created\"\n  hcom config auto_subscribe \"\"   # No auto-subscribe\n\nAvailable presets:\n  collision    - Alert when agents edit same file (within 20s window)\n  created      - Notify when new instances join\n  stopped      - Notify when instances leave\n  blocked      - Notify when any instance is blocked (needs approval)\n\nNotes:\n  - Instances can add/remove subscriptions at runtime\n  - See 'hcom events --help' for subscription management\n\n## HCOM_NAME_EXPORT\n\nHCOM_NAME_EXPORT - Export instance name to custom env var\n\nCurrent value: Use 'hcom config name_export' to see current value\n\nPurpose:\n  When set, launched instances will have their name exported to\n  the specified environment variable. Useful for scripts that need\n  to reference the current instance name.\n\nUsage:\n  hcom config name_export \"MY_AGENT_NAME\"   # Export to MY_AGENT_NAME\n  hcom config name_export \"\"                 # Disable export\n\nExample:\n  # Set export variable\n  hcom config name_export \"HCOM_NAME\"\n\n  # Now launched instances have:\n  # HCOM_NAME=luna (or whatever name was generated)\n\n  # Scripts can use it:\n  # hcom send \"@$HCOM_NAME completed task\"\n\nNotes:\n  - Only affects hcom-launched instances (hcom N claude/gemini/codex)\n  - Variable name must be a valid shell identifier\n  - Works alongside HCOM_PROCESS_ID (always set) for identity\n```\n\n</details>\n\n<details>\n<summary>Python API</summary>\n\n```\n# hcom Python API Reference\n\n## hcom.session()\n\nGet an identity-bound session for hcom operations.\n\nArgs:\n    name: Instance name. Auto-detects from environment if None.\n    external: If True, creates external sender (no instance required).\n\nReturns:\n    Session object with messaging and event methods.\n\nRaises:\n    HcomError: If name required but not provided or not found.\n\nExamples:\n    s = hcom.session()                    # auto-detect\n    s = hcom.session(name=\"luna\")        # explicit instance\n    s = hcom.session(name=\"ci\", external=True)  # external sender\n\n## hcom.instances()\n\nList active instances or get one by name.\n\nArgs:\n    name: Specific instance name, or None for all.\n\nReturns:\n    If name: dict with keys name, session_id, status, directory, parent_name, tool\n    If None: list of such dicts\n\nRaises:\n    HcomError: If name specified but not found.\n\nExamples:\n    all_instances = hcom.instances()\n    nova = hcom.instances(name=\"nova\")\n\n## hcom.launch()\n\nLaunch AI tool instances.\n\nArgs:\n    count: Number of instances to launch.\n    tool: One of 'claude', 'gemini', 'codex'.\n    tag: Group tag (instances named tag-0, tag-1, ...).\n    prompt: Initial prompt for all instances.\n    system_prompt: System prompt override.\n    background: If True, run headless (Claude only).\n    claude_args: Additional Claude CLI args as string.\n    resume: Session ID to resume from.\n    fork: If True with resume, fork instead of continue.\n    tool_args: Additional tool-specific args as string.\n    cwd: Working directory for instances.\n\nReturns:\n    Dict with keys:\n        tool (str): Normalized tool name ('claude', 'gemini', 'codex').\n        batch_id (str): UUID identifying this launch batch.\n        launched (int): Number of instances successfully launched.\n        failed (int): Number of instances that failed to launch.\n        background (bool): Whether instances were launched in background mode.\n        log_files (list[str]): Paths to background log files (empty for interactive).\n        handles (list[dict]): Info about launched instances, each with\n            {\"tool\": str, \"instance_name\": str}.\n        errors (list[dict]): Info about failed launches, each with\n            {\"tool\": str, \"error\": str}. Hook setup failures raise HcomError\n            instead of returning errors.\n\nRaises:\n    HcomError: On invalid tool, hook setup failure, or launch failure.\n\nExamples:\n    hcom.launch(3, tag=\"worker\", prompt=\"do task\")\n    hcom.launch(1, tool=\"gemini\", prompt=\"review code\")\n    hcom.launch(1, resume=\"abc123\", fork=True)\n\n## hcom.bundle()\n\nManage bundles for context handoff and review workflows.\n\nBundles package conversation transcript ranges, event IDs, and file paths\ninto referenceable context units for handoffs between agents.\n\nArgs:\n    action: One of 'list', 'show', 'create', 'chain'.\n    title: Title for new bundle.\n    description: Description for new bundle.\n    events: List of event IDs/ranges for new bundle (e.g., [\"123-125\", \"130\"]).\n    files: List of file paths for new bundle.\n    transcript: List of transcript ranges for new bundle (e.g., [\"5-10\", \"15\"]).\n    extends: Parent bundle ID for chaining related work.\n    data: Full bundle dict (alternative to separate fields).\n    bundle_id: ID for show/chain actions.\n    last: Limit for list action.\n\nReturns:\n    list (for 'list', 'chain'): List of bundle dicts.\n    dict (for 'show'): Bundle details.\n    str (for 'create'): New bundle ID.\n\nExamples:\n    # Create a bundle\n    bundle_id = hcom.bundle(\"create\",\n        title=\"Code review: auth module\",\n        description=\"Implementation complete, ready for review\",\n        events=[\"123-125\", \"130\"],\n        files=[\"auth.py\", \"tests/test_auth.py\"],\n        transcript=[\"10-15\"]\n    )\n\n    # List recent bundles\n    bundles = hcom.bundle(\"list\", last=10)\n\n    # Get bundle details\n    details = hcom.bundle(\"show\", bundle_id=\"abc123\")\n\n    # Get bundle chain (all related bundles)\n    chain = hcom.bundle(\"chain\", bundle_id=\"abc123\")\n\n## Session\n\nIdentity-bound session for hcom operations.\n\nProvides messaging, events, and transcript access tied to a specific\ninstance identity. Data is fetched fresh on each call (no caching).\n\nCreate via hcom.session():\n    s = hcom.session()                    # auto-detect\n    s = hcom.session(name=\"luna\")        # explicit\n    s = hcom.session(name=\"bot\", external=True)  # external sender\n\n### Session.name\n\nInstance name (e.g., 'luna' or 'worker-0').\n\n### Session.info\n\nFresh instance info from database.\n\n    Returns:\n        Dict with keys:\n            name (str): Full instance name (may include tag prefix).\n            session_id (str): Claude session ID for transcript binding.\n            connected (bool): True if instance exists in DB, False if external.\n            directory (str): Working directory path.\n            status (str): Current status ('active', 'listening', 'inactive').\n            transcript_path (str): Path to transcript file.\n            parent_name (str): Parent instance name (for subagents).\n            tool (str): Tool type ('claude', 'gemini', 'codex').\n\n    Raises:\n        HcomError: If instance no longer exists.\n\n### Session.send\n\nSend message to instances.\n\n    Args:\n        message: Message text. Use @name or @prefix- for targeting.\n        to: Target name (auto-prepends @name if not in message).\n        intent: One of 'request', 'inform', 'ack', 'error'.\n        reply_to: Event ID to reply to (required for intent='ack').\n        thread: Thread name for grouping related messages.\n        bundle: Bundle dict to create and attach. If provided, creates bundle event\n            and appends bundle summary to message.\n\n    Returns:\n        List of instance names that received the message.\n\n    Examples:\n        s.send(\"@nova hello\")\n        s.send(\"@worker- start task\", thread=\"batch-1\", intent=\"request\")\n        s.send(\"received\", to=\"luna\", intent=\"ack\", reply_to=\"42\")\n\n        # With bundle\n        s.send(\"@reviewer check this\", bundle={\n            \"title\": \"Code review\",\n            \"description\": \"Auth module complete\",\n            \"refs\": {\n                \"events\": [\"123-125\"],\n                \"files\": [\"auth.py\"],\n                \"transcript\": [\"10-15\"]\n            }\n        })\n\n### Session.messages\n\nGet messages for this instance.\n\n    Args:\n        unread: If True, only messages delivered to this instance (mentions or\n            broadcasts). If False, returns all messages in the system.\n        last: Maximum number of messages to return (most recent first).\n\n    Returns:\n        List of dicts with keys:\n            ts (str): ISO timestamp when message was sent.\n            from (str): Sender's display name.\n            text (str): Message text content.\n            mentions (list[str]): Instance names mentioned in message.\n            delivered_to (list[str]): Instance names message was delivered to.\n            intent (str, optional): Message intent ('request', 'inform', 'ack', 'error').\n            thread (str, optional): Thread name for grouping messages.\n            reply_to (int, optional): Event ID this message replies to.\n\n### Session.events\n\nQuery the event stream.\n\n    Args:\n        sql: SQL WHERE clause filter (e.g., \"msg_from='nova'\").\n        params: Parameters for SQL placeholders (?).\n        last: Maximum events to return.\n\n    Returns:\n        List of dicts with keys: ts, type, instance, data\n\n    SQL fields:\n        Common: id, timestamp, type, instance\n        Message: msg_from, msg_text, msg_thread, msg_intent,\n                 msg_reply_to, msg_mentions, msg_delivered_to, msg_bundle_id\n        Status: status_val, status_context, status_detail\n        Lifecycle: life_action, life_by, life_batch_id\n        Bundle: bundle_id, bundle_title, bundle_description, bundle_extends,\n                bundle_events, bundle_files, bundle_transcript, bundle_created_by\n\n    Examples:\n        s.events(sql=\"type='message'\")\n        s.events(sql=\"msg_from=?\", params=[\"nova\"])\n        s.events(sql=\"msg_thread='task-1'\", last=50)\n\n### Session.wait\n\nBlock until an event matches the SQL condition.\n\n    Args:\n        sql: SQL WHERE clause to match.\n        params: Parameters for SQL placeholders (?).\n        timeout: Seconds to wait before returning None.\n\n    Returns:\n        Matching event dict, or None if timeout.\n\n    Examples:\n        event = s.wait(\"msg_from='nova'\", timeout=60)\n        event = s.wait(\"msg_thread=?\", params=[\"task-1\"], timeout=120)\n\n### Session.subscribe\n\nCreate a push subscription for events.\n\n    When matching events occur, a notification is sent via hcom.\n\n    Args:\n        sql: SQL WHERE clause to match events.\n        params: Parameters for SQL placeholders (?).\n        once: If True, subscription auto-removes after first match.\n\n    Returns:\n        Subscription ID (e.g., 'sub-a1b2').\n\n    Raises:\n        HcomError: If called from external session (can't receive notifications).\n\n    Examples:\n        sub_id = s.subscribe(\"msg_thread='task-1'\")\n        sub_id = s.subscribe(\"msg_from=?\", params=[\"nova\"], once=True)\n\n### Session.subscriptions\n\nList all active event subscriptions.\n\n    Returns:\n        List of dicts with keys: id, sql, caller, once\n\n### Session.unsubscribe\n\nRemove an event subscription.\n\n    Args:\n        sub_id: Subscription ID (with or without 'sub-' prefix).\n\n    Returns:\n        True if removed, False if not found.\n\n### Session.transcript\n\nGet conversation transcript for an instance or timeline across all instances.\n\n    Args:\n        agent: Instance name, or \"timeline\" for timeline mode (all instances).\n        last: Number of recent exchanges to return.\n        full: If True, include truncated tool output (use detailed for full output).\n        range: Exchange range like \"5-10\" (1-indexed, inclusive). Only valid for specific agent.\n        detailed: If True, include full tool calls, results, file edits, errors.\n\n    Returns:\n        If agent is name: List of exchange dicts with keys: user, assistant, position, timestamp\n        If agent is \"timeline\": List of entry dicts with keys: instance, position,\n            user, action, timestamp, files, command\n\n    Examples:\n        s.transcript(\"nova\")                     # nova's transcript\n        s.transcript(\"nova\", last=5)             # nova's last 5\n        s.transcript(\"nova\", range=\"1-10\")       # nova's exchanges 1-10\n        s.transcript(\"timeline\", last=20)        # timeline across all agents\n        s.transcript(\"timeline\", detailed=True)  # detailed timeline\n\n### Session.stop\n\nStop this instance's hcom participation.\n\n    The instance will no longer receive messages or appear in listings.\n\n## hcom.HcomError\n\nException raised for hcom errors.\n\n# Creating Custom Scripts\n\n## Location\n\nUser scripts (shadow bundled by name):\n  ~/.hcom/scripts\n\nBundled scripts (reference examples):\n  <hcom-package>/scripts/bundled\n\nFile types:\n  *.py   Python scripts (executable with python3)\n  *.sh   Shell scripts (executable with bash)\n\n## Script Structure Template\n\n# --- python ---\n#!/usr/bin/env python3\n\"\"\"Brief one-line description shown in hcom run list.\"\"\"\nimport argparse\nimport sys\nimport hcom\n\ndef main():\nparser = argparse.ArgumentParser(description=\"...\")\nparser.add_argument('--target', help='target instance')\nparser.add_argument('--name', help='instance identity (optional)')\n\nargs = parser.parse_args()\n\ns = hcom.session(name=args.name) if args.name else hcom.session()\ns.send(\"@target hello\")\n\nreturn 0\n\nif __name__ == '__main__':\nsys.exit(main())\n# ---\n## Common Workflow Patterns\n\nLaunch agents:\n  instances = hcom.launch(count=3, tool='claude', tag='worker',\n                      prompt='your task here')\n\nSend messages:\n  s = hcom.session()\n  s.send(\"@luna check this\")               # to specific instance\n  s.send(\"@group- broadcast to group\")    # to all in group\n  s.send(\"message\", intent=\"request\")     # with envelope\n\nSubscribe to events:\n  s.subscribe(\"instance='luna' AND type='status'\")\n  s.wait()  # block until event matches\n\nRead transcripts:\n  exchanges = s.transcript('luna', last=5, detailed=True)    # specific agent\n  timeline = s.transcript('timeline', last=20)               # all agents (timeline)\n\nCheck messages:\n  for msg in s.messages():\n  print(msg['text'])\n\n## Identity Handling\n\nAuto-detect (when run from hcom instance):\n  s = hcom.session()\n\nExplicit (for testing or specific workflows):\n  s = hcom.session(name=\"watcher-luna\")\n\nExternal (script not run by an instance):\n  s = hcom.session(name=\"ci-bot\", external=True)\n\nSupport --name flag in your script:\n  parser.add_argument('--name', help='instance identity')\n  s = hcom.session(name=args.name) if args.name else hcom.session()\n\n## Reference Examples\n\nView bundled script sources as working examples:\n  hcom run clone --source        # Spawn clone for a task, result sent back automatically via hcom. (1 fork)\n  hcom run confess --source      # Honesty self-evaluation based on OpenAI's confessions paper. (3 agents)\n  hcom run debate --source       # PRO/CON debaters (fresh or existing agents) + judge evaluate a topic in shared hcom thread. (2+ agents)\n  hcom run ensemble --source     # Ensemble Refinement - multiple agents implement, see each other's work, refine iterativly with a judge. (3-6 agents)\n  hcom run glue --source         # Background glue that watches transcript timeline and connects dots across agents. (1 agent)\n  hcom run watcher --source      # Background code reviewer that subscribes to activity, sends review back via hcom (1 agent)\n\n## Best Practices\n\n- Use hcom API for all hcom operations (not CLI commands in subprocess)\n- Support --name flag for identity (allows external callers)\n- Scripts can call other scripts: hcom.launch() or subprocess to hcom run\n\n# Examples\n\nView workflow script sources:\n\n  hcom run clone --source\n  hcom run confess --source\n  hcom run debate --source\n  hcom run ensemble --source\n  hcom run glue --source\n  hcom run watcher --source\n```\n\n</details>\n\n---\n## License\n\nMIT\n"
      },
      "plugins": [
        {
          "name": "hcom",
          "source": "./plugin/hcom",
          "description": "Real-time messaging and context sharing for AI coding agents (Claude Code, Gemini CLI, Codex)",
          "category": "productivity",
          "homepage": "https://github.com/aannoo/hcom",
          "categories": [
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add aannoo/hcom",
            "/plugin install hcom@hcom"
          ]
        }
      ]
    }
  ]
}