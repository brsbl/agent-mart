{
  "author": {
    "id": "pydantic",
    "display_name": "Pydantic",
    "avatar_url": "https://avatars.githubusercontent.com/u/110818415?v=4"
  },
  "marketplaces": [
    {
      "name": "pydantic-claude-code-logfire-plugin",
      "version": null,
      "description": "Claude Code plugin for Pydantic Logfire observability",
      "repo_full_name": "pydantic/claude-code-logfire-plugin",
      "repo_url": "https://github.com/pydantic/claude-code-logfire-plugin",
      "repo_description": "Claude Code plugin that sends OpenTelemetry traces to Logfire.",
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-02-17T12:29:59Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"pydantic-claude-code-logfire-plugin\",\n  \"owner\": {\n    \"name\": \"Pydantic\",\n    \"email\": \"engineering@pydantic.dev\"\n  },\n  \"metadata\": {\n    \"description\": \"Claude Code plugin for Pydantic Logfire observability\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"logfire-session-capture\",\n      \"source\": \"./\",\n      \"description\": \"Captures Claude Code sessions and exports pydantic-ai compatible OTel traces to Pydantic Logfire, with local JSONL fallback.\",\n      \"version\": \"0.3.0\",\n      \"author\": {\n        \"name\": \"Pydantic\"\n      },\n      \"homepage\": \"https://logfire.pydantic.dev\",\n      \"repository\": \"https://github.com/pydantic/claude-code-logfire-plugin\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"logfire\", \"opentelemetry\", \"observability\", \"tracing\"],\n      \"category\": \"observability\"\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"logfire-session-capture\",\n  \"version\": \"0.4.0\",\n  \"description\": \"Captures Claude Code sessions and exports pydantic-ai compatible OTel traces to Pydantic Logfire, with local JSONL fallback.\"\n}\n",
        "README.md": "# Logfire plugin for Claude Code\n\nA [Claude Code](https://docs.anthropic.com/en/docs/claude-code) plugin that sends OpenTelemetry traces to [Pydantic Logfire](https://logfire.pydantic.dev), giving you full observability into your Claude Code sessions.\n\nEach session becomes a trace with child spans per LLM API call, with full token usage, cost tracking, and conversation history visible in Logfire.\n\n<!-- TODO: add Logfire screenshot here -->\n\n## Installation\n\n### System requirements\n\n- [Claude Code](https://docs.anthropic.com/en/docs/claude-code) installed\n- A [Logfire](https://logfire.pydantic.dev) project with a write token\n- `python3` (3.7+) — pre-installed on macOS and most Linux distributions; uses stdlib only (no pip dependencies)\n\n### Install the plugin\n\nFrom within Claude Code, run:\n\n```\n/plugin marketplace add pydantic/claude-code-logfire-plugin\n/plugin install logfire-session-capture@pydantic-claude-code-logfire-plugin\n```\n\n### Update the plugin\n\n```\n/plugin update logfire-session-capture@pydantic-claude-code-logfire-plugin\n```\n\n### Set your Logfire token\n\n```bash\nexport LOGFIRE_TOKEN=\"your-logfire-write-token\"\n```\n\nAdd this to your shell profile (`~/.zshrc`, `~/.bashrc`, etc.) so it persists across sessions.\n\nFor the EU region:\n\n```bash\nexport LOGFIRE_BASE_URL=\"https://logfire-eu.pydantic.dev\"\n```\n\n| Variable | Required | Default | Description |\n|---|---|---|---|\n| `LOGFIRE_TOKEN` | Yes | _(none)_ | Logfire write token |\n| `LOGFIRE_BASE_URL` | No | `https://logfire-us.pydantic.dev` | Logfire ingest endpoint |\n| `LOGFIRE_LOCAL_LOG` | No | `false` | Set to `true` to write JSONL event logs locally |\n| `LOGFIRE_DIAGNOSTICS` | No | `false` | Set to `true` to write diagnostic logs (enabled automatically when `LOGFIRE_LOCAL_LOG` is set) |\n\nWithout `LOGFIRE_TOKEN`, no traces are sent. The plugin does nothing unless at least one of `LOGFIRE_TOKEN` or `LOGFIRE_LOCAL_LOG` is set.\n\n## What you get\n\nEvery Claude Code session produces a trace in Logfire:\n\n```\nClaude Code session              <- root span (the full session)\n├── chat claude-opus-4-6         <- LLM API call 1\n├── chat claude-opus-4-6         <- LLM API call 2\n└── chat claude-opus-4-6         <- LLM API call 3\n```\n\nEach `chat` child span includes:\n\n- **Token usage** (`gen_ai.usage.input_tokens`, `gen_ai.usage.output_tokens`)\n- **Cost** (`operation.cost` in USD)\n- **Messages** (`gen_ai.input.messages`, `gen_ai.output.messages`)\n- **Finish reason** (`gen_ai.response.finish_reasons`)\n\nThe root span carries the full conversation, so you can inspect the entire session in Logfire's trace view.\n\n## Distributed tracing\n\nIf you call Claude Code from a Python application that already uses Logfire or OpenTelemetry, you can link the Claude Code session into your existing trace by passing a `TRACEPARENT` environment variable:\n\n```bash\nTRACEPARENT=\"00-<trace_id>-<parent_span_id>-01\" claude --print \"your prompt\"\n```\n\nSee [`examples/distributed-tracing.py`](examples/distributed-tracing.py) for a complete example using `logfire` and `subprocess`.\n\n## Local JSONL log\n\nSet `LOGFIRE_LOCAL_LOG=true` to write all hook events as JSON Lines to `.claude/logs/session-events.jsonl` in the project directory. This is off by default.\n\n## Data collected\n\nWhen `LOGFIRE_TOKEN` is set, the plugin sends the following data to Logfire as OpenTelemetry span attributes:\n\n| Data | Span | Attribute |\n|---|---|---|\n| Full conversation (user prompts, assistant responses, tool calls and results) | Root span | `pydantic_ai.all_messages` |\n| Per-call input/output messages | Child spans | `gen_ai.input.messages`, `gen_ai.output.messages` |\n| Token counts | Child spans | `gen_ai.usage.input_tokens`, `gen_ai.usage.output_tokens` |\n| Cost in USD | Child spans | `operation.cost` |\n| Model name | Both | `gen_ai.request.model` |\n| Working directory | Root span | `session.cwd` |\n| Assistant thinking blocks | Child spans | Included in `gen_ai.output.messages` |\n\n**Privacy note:** Conversation data sent to Logfire may contain sensitive information including file contents read by Claude, tool outputs, environment details, and any text in the conversation. Logfire data is stored according to [Pydantic's privacy policy](https://pydantic.dev/privacy). If this is a concern, use `LOGFIRE_LOCAL_LOG=true` without `LOGFIRE_TOKEN` to keep all data local.\n\n## Troubleshooting\n\n**Enable diagnostics** to see what the plugin is doing:\n\n```bash\nexport LOGFIRE_DIAGNOSTICS=true\n```\n\nDiagnostic logs are written to `.claude/logs/diagnostics.jsonl` in the project directory.\n\n**Common issues:**\n\n- **No traces appearing in Logfire** -- Check that `LOGFIRE_TOKEN` is set and valid. Enable diagnostics to see if OTLP exports are failing.\n- **Export errors (HTTP 401/403)** -- Your Logfire token may be invalid or expired. Generate a new write token in the Logfire console.\n- **Export errors (HTTP 4xx/5xx)** -- Check `LOGFIRE_BASE_URL` if using a non-default region. The plugin logs HTTP status codes to stderr and diagnostics.\n\n## Development\n\n```bash\nuv sync\nuv run ruff check scripts/\nuv run ruff format scripts/\n```\n\n## How it works\n\nThe plugin is a single Python script ([`scripts/log-event.py`](scripts/log-event.py), stdlib only) invoked by Claude Code hooks on every session event. On `Stop` events it parses the transcript file to extract per-API-call data (deduplicating streaming fragments) and sends OTLP/HTTP JSON to Logfire. On `SessionEnd` it sends the root span with the accumulated conversation.\n\nState is persisted in a temp file between hook invocations. The `trace_id` is deterministically derived from `session_id` via SHA-256.\n\n## License\n\nMIT\n"
      },
      "plugins": [
        {
          "name": "logfire-session-capture",
          "source": "./",
          "description": "Captures Claude Code sessions and exports pydantic-ai compatible OTel traces to Pydantic Logfire, with local JSONL fallback.",
          "version": "0.3.0",
          "author": {
            "name": "Pydantic"
          },
          "homepage": "https://logfire.pydantic.dev",
          "repository": "https://github.com/pydantic/claude-code-logfire-plugin",
          "license": "MIT",
          "keywords": [
            "logfire",
            "opentelemetry",
            "observability",
            "tracing"
          ],
          "category": "observability",
          "categories": [
            "logfire",
            "observability",
            "opentelemetry",
            "tracing"
          ],
          "install_commands": [
            "/plugin marketplace add pydantic/claude-code-logfire-plugin",
            "/plugin install logfire-session-capture@pydantic-claude-code-logfire-plugin"
          ]
        }
      ]
    }
  ]
}