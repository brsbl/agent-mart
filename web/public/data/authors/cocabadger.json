{
  "author": {
    "id": "Cocabadger",
    "display_name": "Artem",
    "avatar_url": "https://avatars.githubusercontent.com/u/199284188?v=4"
  },
  "marketplaces": [
    {
      "name": "saferun-guard",
      "version": null,
      "description": "Runtime safety plugins for AI coding agents",
      "repo_full_name": "Cocabadger/saferun-guard",
      "repo_url": "https://github.com/Cocabadger/saferun-guard",
      "repo_description": "Runtime safety firewall for Claude Code â€” blocks dangerous commands and protects sensitive files before they execute.",
      "signals": {
        "stars": 2,
        "forks": 0,
        "pushed_at": "2026-02-11T22:36:28Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"name\": \"saferun-guard\",\n  \"owner\": {\n    \"name\": \"Cocabadger\"\n  },\n  \"metadata\": {\n    \"description\": \"Runtime safety plugins for AI coding agents\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"saferun-guard\",\n      \"source\": \"./\",\n      \"description\": \"Runtime safety firewall for AI coding agents. Blocks dangerous commands and protects sensitive files before they execute.\",\n      \"version\": \"0.1.0\",\n      \"author\": {\n        \"name\": \"Cocabadger\"\n      },\n      \"homepage\": \"https://github.com/Cocabadger/saferun-guard\",\n      \"repository\": \"https://github.com/Cocabadger/saferun-guard\",\n      \"license\": \"MIT\",\n      \"keywords\": [\"safety\", \"security\", \"firewall\", \"agent\", \"guardrails\", \"hooks\"],\n      \"category\": \"security\",\n      \"tags\": [\"safety\", \"security\", \"autonomous-agents\", \"guardrails\"]\n    }\n  ]\n}\n",
        ".claude-plugin/plugin.json": "{\n  \"name\": \"saferun-guard\",\n  \"version\": \"0.1.0\",\n  \"description\": \"Runtime safety firewall for AI coding agents. Blocks dangerous commands and protects sensitive files before they execute.\",\n  \"author\": {\n    \"name\": \"Cocabadger\",\n    \"url\": \"https://github.com/Cocabadger\"\n  },\n  \"homepage\": \"https://github.com/Cocabadger/saferun-guard\",\n  \"repository\": \"https://github.com/Cocabadger/saferun-guard\",\n  \"license\": \"MIT\",\n  \"keywords\": [\"safety\", \"security\", \"firewall\", \"agent\", \"guardrails\", \"hooks\"]\n}\n",
        "README.md": "# ğŸ›¡ï¸ SafeRun Guard\n\n**Runtime safety firewall for AI coding agents.**\n\nSafeRun Guard is a Claude Code Plugin that intercepts dangerous commands and file operations **before they execute**. It protects your codebase from accidental `rm -rf /`, force pushes to main, credential overwrites, and more â€” automatically, silently, in ~20ms.\n\nCompound commands like `echo ok && rm -rf /` are split and each segment is checked independently. Secret patterns (AWS keys, private keys, API tokens) are detected in file writes before they hit disk.\n\n> **95% of actions â€” invisible.** SafeRun Guard only speaks up when something is actually dangerous.\n\n---\n\n## Quick Start\n\n```bash\n# Add marketplace and install (two commands, one time)\nclaude plugin marketplace add Cocabadger/saferun-guard\nclaude plugin install saferun-guard@saferun-guard\n```\n\nThat's it. SafeRun Guard is now active for every Claude Code session.\n\n### Other install methods\n\n```bash\n# Via marketplace â€” browse + install\n/plugin marketplace add Cocabadger/saferun-guard\n/plugin install saferun-guard@saferun-guard\n\n# Clone and install locally\ngit clone https://github.com/Cocabadger/saferun-guard.git\nclaude plugin install ./saferun-guard\n\n# Load for one session only\nclaude --plugin-dir ./saferun-guard\n```\n\n### Set up for your team\n\nAdd to your project's `.claude/settings.json` so every team member gets prompted to install:\n\n```json\n{\n  \"extraKnownMarketplaces\": {\n    \"saferun-guard\": {\n      \"source\": {\n        \"source\": \"github\",\n        \"repo\": \"Cocabadger/saferun-guard\"\n      }\n    }\n  },\n  \"enabledPlugins\": {\n    \"saferun-guard@saferun-guard\": true\n  }\n}\n```\n\n---\n\n## What It Does\n\nSafeRun Guard sits between Claude and your system. Every time Claude wants to run a shell command or write a file, SafeRun Guard checks it against **112 safety rules + 9 secret patterns** in ~20ms:\n\n```\nClaude wants to run: git push --force origin main\n                          â”‚\n                          â–¼\n                   SafeRun Guard\n                          â”‚\n       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n       â”‚          â”‚       â”‚       â”‚          â”‚\n    ğŸ”„ REDIRECT  ğŸš« BLOCK  â“ ASK  âœ… ALLOW\n    (3 rules)  (27+25)  (25+23)  (silent)\n       â”‚          â”‚       â”‚       â”‚\n    Suggest    Agent    User    Command\n    safer      sees     sees    executes\n    command    block    prompt  normally\n```\n\n### Four Decisions\n\n- ğŸ”„ **REDIRECT** â€” suggest a safer alternative. Agent rewrites the command.\n  `git push --force` â†’ *\"Use --force-with-lease instead\"*\n\n- ğŸš« **BLOCK** â€” command denied. Claude sees the reason and adapts.\n  `sudo rm -rf /` â†’ *\"Recursive delete as root\"*\n\n- â“ **ASK** â€” user gets a confirmation prompt.\n  `git push origin main` â†’ *\"Push to production branch â€” allow?\"*\n\n- âœ… **ALLOW** â€” silent passthrough. No delay, no prompt.\n  `npm test`, `git status`, `ls -la`\n\n### Compound Command Splitting\n\nCommands chained with `&&`, `||`, or `;` are split and each segment is checked independently:\n\n```\necho ok && rm -rf /\n    â”‚           â”‚\n    âœ…          ğŸš« BLOCK â€” caught!\n```\n\nPipe `|` is **not** split â€” it's part of a single pipeline (`grep foo | wc -l` is safe).\n\n### Content Scanning\n\nFile writes and edits are scanned for **9 secret patterns** before they hit disk:\n\n- AWS access keys (`AKIA...`) and secret keys\n- Private keys (PEM `-----BEGIN...PRIVATE KEY-----`)\n- GitHub tokens (`ghp_`, `gho_`, `ghs_`, `ghr_`)\n- OpenAI / Stripe keys (`sk-...`)\n- Slack tokens (`xox[bpras]-...`)\n- Database connection strings with passwords\n- Generic API keys and hardcoded passwords\n\n---\n\n## What's Protected\n\n### ğŸš« Blocked Commands (27 rules)\n\n- **Git destructive** â€” `git push --force`, `git reset --hard`, `git clean -fd`, delete main/master branch, interactive rebase\n- **Filesystem** â€” `rm -rf /`, `rm -rf .`, `chmod 777`, `chmod -R 777`, `dd`, `mkfs`, `sudo rm -rf`\n- **Code execution** â€” `curl ... | bash`, `wget ... | sh` â€” remote code execution\n- **Credentials** â€” `rm -rf ~/.ssh`, destroy SSH keys, overwrite `/etc/passwd`\n- **Infrastructure** â€” `docker system prune -a`, fork bombs, `kubectl delete namespace`\n- **History** â€” `history -c`, `history --clear` â€” audit trail destruction\n- **Lockfiles** â€” overwrite `package-lock.json`, `yarn.lock`, `Cargo.lock` via shell\n\n### â“ Ask User (25 rules)\n\n- **Git production** â€” `git push origin main`, `git merge main`, delete tags\n- **Infrastructure** â€” `kubectl apply/delete`, `terraform apply/destroy`\n- **Cloud / IaC** â€” `helm install/upgrade/uninstall/rollback`, `pulumi up/destroy`, `cdk deploy/destroy`\n- **CI / GitHub** â€” `gh pr merge/close`, `gh release create/delete`\n- **AWS** â€” `aws ec2 run/terminate/stop`, `aws s3 rm/rb`\n- **Config mgmt** â€” `ansible-playbook` (excluding `--check`/`--diff`/`--syntax-check`)\n- **Publishing** â€” `npm publish`, `pip upload`, `docker push`, `gem push`\n- **Database** â€” `db migrate`, `db drop`, SQL execution on prod\n- **Services** â€” `systemctl stop`, `service restart`\n\n### ğŸš« Blocked File Writes (25 rules)\n\n- **Secrets** â€” `.env`, `.env.*`\n- **SSH/Keys** â€” `.ssh/`, `*.pem`, `*.key`, `*.p12`\n- **Cloud credentials** â€” `.aws/credentials`, `.config/gcloud/`, `.kube/config`\n- **Registry tokens** â€” `.npmrc`, `.pypirc`\n- **Docker/Network auth** â€” `.docker/config.json`, `.netrc`\n- **GPG keys** â€” `.gnupg/`\n- **Git internals** â€” `.git/` (objects, refs, HEAD â€” not `.gitignore`)\n- **Shell config** â€” `.bashrc`, `.zshrc`, `.profile`, `.bash_profile`\n- **System paths** â€” `/etc/`, `/usr/`, `/var/`, `/System/`\n- **Lockfiles** â€” `package-lock.json`, `yarn.lock`, `pnpm-lock.yaml`, `poetry.lock`, `Cargo.lock`, `Gemfile.lock`, `Pipfile.lock`, `composer.lock`\n\n### â“ Ask Before Writing (23 rules)\n\nCI/CD configs (`.github/workflows/`, `.circleci/`, `buildspec.yml`, `cloudbuild.yaml`), Dockerfiles, Terraform (`*.tf`), Kubernetes manifests, Ansible playbooks, SQL files, migration files, CODEOWNERS, Nginx (`nginx.conf`), Serverless (`serverless.yml`), deployment configs (Procfile, `fly.toml`, `vercel.json`, `netlify.toml`, `render.yaml`, `heroku.yml`).\n\n### ğŸ”„ Redirect Commands (3 rules)\n\n| Dangerous | Safer Alternative |\n|---|---|\n| `git push --force` | `git push --force-with-lease` |\n| `git clean -f` | `git clean -n` (dry-run first) |\n| `docker system prune` | `docker system prune --dry-run` |\n\n---\n\n## Real-World Examples\n\n### 1. Prevents accidental force push to production\n\nA developer asks Claude to \"push my changes.\" Claude runs `git push --force origin main`. SafeRun Guard intercepts it via the REDIRECT tier and tells Claude: *\"Use `git push --force-with-lease` instead â€” it only overwrites if no one else has pushed since your last fetch.\"* Claude rewrites the command automatically. No data loss, no broken team history.\n\n### 2. Catches destructive commands hidden in compound chains\n\nClaude runs `echo \"cleaning up temp files\" && rm -rf . && echo \"done\"`. SafeRun Guard splits the compound command on `&&`, checks each segment independently, and blocks `rm -rf .` â€” even though it's sandwiched between two harmless echo commands. Without splitting, this would pass a simple regex check.\n\n### 3. Detects leaked secrets before they're written to disk\n\nClaude generates a config file and includes `AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"` directly in the source code. SafeRun Guard scans file content for 9 secret patterns (AWS keys, private keys, GitHub tokens, API keys) and asks the user before allowing the write. The secret never reaches git history.\n\n---\n\n## Slash Commands\n\n- `/saferun-guard:status` â€” show loaded rules count, audit stats, plugin info\n- `/saferun-guard:log` â€” show last 20 agent actions from audit log\n\n---\n\n## Audit Log\n\nEvery action Claude takes is logged to `~/.saferun/audit.jsonl`:\n\n```json\n{\"ts\":\"2026-02-10T14:32:01Z\",\"session\":\"abc123\",\"tool\":\"Bash\",\"input\":\"npm test\",\"cwd\":\"/Users/art/project\"}\n{\"ts\":\"2026-02-10T14:32:15Z\",\"session\":\"abc123\",\"tool\":\"Write\",\"input\":\"/Users/art/project/src/app.ts\",\"cwd\":\"/Users/art/project\"}\n```\n\nUse `/saferun-guard:log` to view recent activity, or read the file directly.\n\n---\n\n## How It Works\n\nSafeRun Guard uses [Claude Code Hooks](https://docs.anthropic.com/en/docs/claude-code/hooks) â€” the official plugin API for intercepting tool calls:\n\n- **PreToolUse** hooks on `Bash` â†’ `scripts/classify-command.sh`\n  - Splits compound commands (`&&`, `||`, `;`) into segments\n  - Checks each segment independently: REDIRECT â†’ BLOCK â†’ ASK â†’ ALLOW\n- **PreToolUse** hooks on `Write|Edit` â†’ `scripts/classify-file.sh`\n  - Path-based rules (BLOCK/ASK) + content scanning for secrets\n- **PostToolUse** hook (async) â†’ `scripts/audit-log.sh`\n\nAll scripts are **bash + jq** â€” zero dependencies. No Python, no Node, no pip install. Works on any macOS/Linux machine with jq installed.\n\nPattern matching uses **jq's Oniguruma regex engine** with case-insensitive matching. Every rule is a JSON object with `id`, `pattern`, `reason`, and `category`. Redirect rules add a `safe_pattern` field â€” if the command already uses the safe form, the redirect is skipped.\n\n### Performance\n\n- Safe command (no match, worst case) â€” **~20ms**\n- Blocked command (early match) â€” **~19ms**\n- Safe file write â€” **~20ms**\n- Empty/missing input â€” **~9ms**\n\nFor context: Claude thinks for 2-10 seconds between actions. 20ms is imperceptible.\n\n### Fail-Open Design\n\nIf any script errors (missing jq, corrupt JSON, etc.), the command **passes through**. SafeRun Guard should never block your work due to a plugin bug.\n\n---\n\n## Project Structure\n\n```\nsaferun-guard/\nâ”œâ”€â”€ .claude-plugin/\nâ”‚   â”œâ”€â”€ plugin.json                # Plugin manifest\nâ”‚   â””â”€â”€ marketplace.json           # Marketplace catalog\nâ”œâ”€â”€ hooks/hooks.json               # Hook event â†’ script mapping\nâ”œâ”€â”€ scripts/\nâ”‚   â”œâ”€â”€ classify-command.sh        # PreToolUse: Bash (compound split + 4-tier)\nâ”‚   â”œâ”€â”€ classify-file.sh           # PreToolUse: Write/Edit (path + content scan)\nâ”‚   â””â”€â”€ audit-log.sh              # PostToolUse: async JSONL logger\nâ”œâ”€â”€ rules/\nâ”‚   â”œâ”€â”€ redirect-commands.json     # 3 REDIRECT patterns (safer alternatives)\nâ”‚   â”œâ”€â”€ block-commands.json        # 27 BLOCK patterns\nâ”‚   â”œâ”€â”€ ask-commands.json          # 25 ASK patterns\nâ”‚   â”œâ”€â”€ allow-commands.json        # 17 ALLOW categories\nâ”‚   â”œâ”€â”€ block-files.json           # 25 BLOCK file patterns\nâ”‚   â”œâ”€â”€ ask-files.json             # 23 ASK file patterns\nâ”‚   â””â”€â”€ scan-content.json          # 9 secret detection patterns\nâ”œâ”€â”€ skills/\nâ”‚   â”œâ”€â”€ log/SKILL.md               # /saferun-guard:log\nâ”‚   â””â”€â”€ status/SKILL.md            # /saferun-guard:status\nâ””â”€â”€ tests/\n    â”œâ”€â”€ test-commands.sh           # 143 tests\n    â””â”€â”€ test-files.sh             # 100 tests\n```\n\n---\n\n## Testing\n\n```bash\n# Run all tests\nbash tests/test-commands.sh && bash tests/test-files.sh\n\n# 243 tests â€” command rules, file rules, compound splitting,\n# redirect tier, content scanning, edge cases\n```\n\n---\n\n## Requirements\n\n- **macOS or Linux** (bash + jq)\n- **jq 1.6+** (`brew install jq` or `apt install jq`)\n- **Claude Code** with plugin support\n\n---\n\n## Disable or Uninstall\n\n```bash\n# Temporarily disable (keeps installed, can re-enable)\nclaude plugin disable saferun-guard@saferun-guard\n\n# Re-enable\nclaude plugin enable saferun-guard@saferun-guard\n\n# Update to latest version\nclaude plugin update saferun-guard@saferun-guard\n\n# Remove completely\nclaude plugin uninstall saferun-guard@saferun-guard\n```\n\n---\n\n## License\n\nMIT â€” see [LICENSE](LICENSE).\n\n---\n\n## Links\n\n- [Claude Code Plugins](https://code.claude.com/docs/en/plugins)\n- [Discover Plugins & Marketplaces](https://code.claude.com/docs/en/discover-plugins)\n- [Create a Plugin Marketplace](https://code.claude.com/docs/en/plugin-marketplaces)\n- [Plugins Reference](https://code.claude.com/docs/en/plugins-reference)\n\n---\n\nBuilt by [SafeRun](https://github.com/Cocabadger/saferun-guard). SafeRun Guard is invisible until it saves your project.\n"
      },
      "plugins": [
        {
          "name": "saferun-guard",
          "source": "./",
          "description": "Runtime safety firewall for AI coding agents. Blocks dangerous commands and protects sensitive files before they execute.",
          "version": "0.1.0",
          "author": {
            "name": "Cocabadger"
          },
          "homepage": "https://github.com/Cocabadger/saferun-guard",
          "repository": "https://github.com/Cocabadger/saferun-guard",
          "license": "MIT",
          "keywords": [
            "safety",
            "security",
            "firewall",
            "agent",
            "guardrails",
            "hooks"
          ],
          "category": "security",
          "tags": [
            "safety",
            "security",
            "autonomous-agents",
            "guardrails"
          ],
          "categories": [
            "agent",
            "autonomous-agents",
            "firewall",
            "guardrails",
            "hooks",
            "safety",
            "security"
          ],
          "install_commands": [
            "/plugin marketplace add Cocabadger/saferun-guard",
            "/plugin install saferun-guard@saferun-guard"
          ]
        }
      ]
    }
  ]
}