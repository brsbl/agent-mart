{
  "author": {
    "id": "ahundt",
    "display_name": "Andrew Hundt",
    "avatar_url": "https://avatars.githubusercontent.com/u/55744?v=4"
  },
  "marketplaces": [
    {
      "name": "clautorun-dev",
      "version": "1.0.0",
      "description": "Automation suite: clautorun (file policies, autonomous sessions) + plan-export (plan archiving) + pdf-extractor (PDF data extraction)",
      "repo_full_name": "ahundt/clautorun",
      "repo_url": "https://github.com/ahundt/clautorun",
      "repo_description": "Claude Code plugin for autonomous task completion, file policy control, and session management. Reduce interruptions while Claude works.",
      "signals": {
        "stars": 0,
        "forks": 0,
        "pushed_at": "2026-01-29T20:16:54Z"
      },
      "files": {
        ".claude-plugin/marketplace.json": "{\n  \"$schema\": \"https://anthropic.com/claude-code/marketplace.schema.json\",\n  \"name\": \"clautorun-dev\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Automation suite: clautorun (file policies, autonomous sessions) + plan-export (plan archiving) + pdf-extractor (PDF data extraction)\",\n  \"owner\": {\n    \"name\": \"Andrew Hundt\",\n    \"email\": \"ATHundt@gmail.com\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"clautorun\",\n      \"description\": \"Autonomous task automation with file creation policies and session persistence\",\n      \"source\": \"./plugins/clautorun\",\n      \"category\": \"productivity\",\n      \"version\": \"0.6.0\",\n      \"author\": {\n        \"name\": \"Andrew Hundt\",\n        \"email\": \"ATHundt@gmail.com\"\n      }\n    },\n    {\n      \"name\": \"plan-export\",\n      \"description\": \"Automatically exports plan files to project notes when exiting plan mode\",\n      \"source\": \"./plugins/plan-export\",\n      \"category\": \"productivity\",\n      \"version\": \"1.0.0\",\n      \"author\": {\n        \"name\": \"Andrew Hundt\",\n        \"email\": \"ATHundt@gmail.com\"\n      }\n    },\n    {\n      \"name\": \"pdf-extractor\",\n      \"description\": \"PDF data extraction with 9 backend support (markitdown, docling, marker, pdfplumber, pdfminer, pypdf2, pymupdf4llm, pdfbox, pdftotext)\",\n      \"source\": \"./plugins/pdf-extractor\",\n      \"category\": \"data-processing\",\n      \"version\": \"0.1.0\",\n      \"author\": {\n        \"name\": \"Andrew Hundt\",\n        \"email\": \"ATHundt@gmail.com\"\n      }\n    }\n  ]\n}\n",
        "README.md": "# clautorun\n\n[![Python Version](https://img.shields.io/badge/python-3.10+-blue.svg)](https://python.org)\n[![License](https://img.shields.io/badge/license-Apache%20v2-green.svg)](LICENSE)\n\n**clautorun** - Reduce interruptions while Claude completes tasks autonomously.\n\n## Table of Contents\n\n- [Key Features](#key-features)\n- [Quick Start](#quick-start)\n- [Command Reference](#command-reference)\n  - [AutoFile Policy Commands](#autofile-commands-file-creation-control)\n  - [Autorun Commands](#autorun-commands-autonomous-execution)\n  - [Plan Management Commands](#plan-management-commands)\n  - [Command Blocking](#command-blocking-commands-new-in-v060)\n  - [Tmux Session Commands](#tmux-automation-commands)\n  - [Legacy Commands](#legacy-commands-backward-compatible)\n- [How It Works](#how-it-works)\n  - [Three-Stage Autorun System](#three-stage-autorun-system)\n  - [AutoFile Policy System](#autofile-policy-system)\n  - [Command Blocking System](#command-blocking-v060)\n- [Tmux Integration](#why-byobu--tmux-integration)\n- [Development](#development)\n- [Testing](#testing)\n- [Plugin Architecture](#plugin-architecture-and-integration-guide)\n- [Troubleshooting](#troubleshooting)\n- [Contributing](#contributing-and-sharing)\n- [License](#license)\n\n## Key Features\n\n- **Autonomous Execution**: Claude continues working without constant \"continue\" prompts\n- **Three-Stage Verification**: Ensures tasks are actually complete before stopping\n- **File Policy Control**: Prevent AI from creating unnecessary files\n- **Command Blocking**: Block dangerous commands with safer alternatives (v0.6.0)\n- **Plan Management**: Create, refine, update, and execute structured plans\n- **Session Management**: Work with tmux/byobu for crash-safe sessions\n\n## Quick Start\n\n```bash\n# Install from GitHub\n/plugin install https://github.com/ahundt/clautorun.git\n\n# Verify installation\n/cr:st\n# Expected: \"AutoFile policy: allow-all\"\n\n# Start autonomous task\n/cr:go Build a REST API with authentication and tests\n\n# Set file policy (prevent file clutter)\n/cr:f                    # Strict: only modify existing files\n/cr:j                    # Justify: require justification for new files\n/cr:a                    # Allow: create files freely (default)\n\n# Emergency stop\n/cr:sos\n```\n\n## UV Installation (Recommended)\n\nThe clautorun marketplace includes 3 plugins: **clautorun**, **plan-export**, and **pdf-extractor**.\n\n### GitHub Installation\n\nInstall the entire marketplace directly from GitHub:\n\n```bash\n# Install all 3 plugins from GitHub\nuv pip install git+https://github.com/ahundt/clautorun.git\n\n# Register plugins with Claude Code\nuv run clautorun-marketplace\n```\n\n### Local Installation\n\nInstall from a local clone:\n\n```bash\n# Clone repository\ngit clone https://github.com/ahundt/clautorun.git\ncd clautorun\n\n# Install marketplace\nuv pip install .\n\n# Register plugins with Claude Code\nuv run clautorun-marketplace\n```\n\n> **Note:** Use `uv run clautorun-marketplace` to ensure the command runs in the correct UV environment. If `clautorun-marketplace` is in your PATH, you can run it directly without `uv run`.\n\n### Development Installation\n\nFor contributors and developers:\n\n```bash\n# Clone repository\ngit clone https://github.com/ahundt/clautorun.git\ncd clautorun\n\n# Create UV workspace and install dependencies\nuv sync --all-extras\n\n# Register plugins with Claude Code\nuv run clautorun-marketplace\n\n# Or use the installer with marketplace flag\nuv run clautorun-install install --marketplace\n```\n\n### Verification\n\nAfter installation, verify plugins are registered:\n\n```bash\n# Check installed plugins\nclaude plugin marketplace list\n\n# See all available commands\n/help\n\n# Test clautorun\n/cr:st\n# Expected: \"AutoFile policy: allow-all\"\n```\n\n## What clautorun Does For You\n\n**Problem Statement**: Claude Code sessions can end unexpectedly during extended tasks, requiring manual intervention to continue work. AI creates numerous experimental files during development, leading to cluttered project directories. Network disconnections or application crashes terminate active sessions, losing all in-progress work.\n\n**Solution Overview**: clautorun addresses these specific limitations through session automation, file policy enforcement, and session persistence.\n\n### Reduce User Interruptions\n- **Current Behavior**: Claude Code sessions can end unexpectedly, requiring manual intervention to continue work\n- **With clautorun**: Claude continues working autonomously on the same task, reducing user interruptions\n- **Mechanism**: Automatic task continuation when Claude stops working, ensuring focus stays on completing the original task without user intervention\n- **Result**: Tasks get completed with reduced interruptions\n\n### File Creation Control\n- **Current Behavior**: AI creates multiple experimental files during development\n- **With clautorun**: Three-tier policy system restricts unnecessary file creation\n- **Policy Levels**:\n  1. Strict search (search for and modify existing files instead of creating new ones)\n  2. Justified creation (require explanation for new files)\n  3. Allow all (unrestricted for new projects)\n- **Mechanism**: \"Strict search\" requires AI to first search for existing functionality or similar files, then modify those files rather than creating new ones\n- **Result**: Project directories contain essential files only, reducing cleanup requirements\n\n### Reduce Manual Interventions (clautorun feature)\n- **Current Behavior**: Claude Code stops and waits for manually typing continue\n- **clautorun Action**: Hook system intercepts Claude Code stop events and automatically re-injects continuation prompts\n- **Mechanism**: UserPromptSubmit and Stop hooks detect when Claude stops working, analyze the transcript for completion markers, and inject \"continue working\" prompts when tasks are incomplete\n- **Benefit**: Start autonomous tasks and return to completed work with fewer interruptions\n\n### Prevent File Clutter (clautorun feature)\n- **Current Behavior**: AI creates multiple experimental files during development\n- **clautorun Action**: PreToolUse hooks intercept Write tool calls and enforce file creation policies\n- **Mechanism**: Before each file creation, the hook scans the conversation transcript for policy compliance. It blocks or allows file operations based on the current policy level (`/afs`, `/afj`, `/afa`) and any required justifications\n- **Policy Levels**:\n  1. Strict search - Hook blocks all new file creation, forcing AI to modify existing files found through search\n  2. Justified creation - Hook allows new files only when AI includes required justification tags\n  3. Allow all - Hook allows all file creation operations\n- **Benefit**: Maintain clean project directories with only essential files\n\n### Ensure Complete Tasks (clautorun feature)\n- **Current Behavior**: AI may claim task completion after implementing only partial requirements\n- **clautorun Action**: Hook system implements three-stage verification by detecting completion markers and re-injecting the original task\n- **Mechanism**: When AI outputs a completion marker, the hook detects this first completion and re-injects the original task with a verification checklist. Only after a second completion marker does the system allow the session to end\n- **Benefit**: Reduce incomplete features and ensure all requirements are implemented\n\n### Survive Crashes and Disconnections (tmux/byobu feature)\n- **Current Behavior**: Application crashes or network drops terminate work sessions\n- **tmux/byobu Action**: Maintains session state across interruptions using terminal multiplexing\n- **How it Works**: Terminal multiplexer keeps processes running on the server regardless of client connectivity\n- **Benefit**: Resume work from the exact interruption point after reconnection\n- **Note**: clautorun integrates with tmux/byobu but does not provide session persistence itself\n\n### Work From Anywhere (tmux/byobu + SSH/Mosh feature)\n- **Current Behavior**: Users must stay at their workstation to monitor and intervene in AI sessions\n- **SSH/Mosh + tmux Action**: Enables remote session monitoring and intervention from any device\n- **How it Works**: SSH/Mosh clients connect to the tmux session through network connections\n- **Benefit**: Monitor and control AI work from any location with internet access\n- **Note**: clautorun provides commands to work within tmux sessions but does not provide remote access\n\n### Concrete Capabilities Matrix\n\n**tmux/byobu Base Capabilities:**\n- **Session Persistence**: Processes continue running even when client disconnects\n- **Session Isolation**: Multiple independent sessions can run simultaneously\n- **Remote Access**: SSH/Mosh provides secure remote access from any device\n- **Multiplexing**: Split terminal windows for simultaneous viewing\n- **Process Recovery**: Automatic session recovery after system restart\n\n**clautorun Enhanced Capabilities:**\n- **Automatic Continuation**: Keeps Claude working without manually typing continue\n- **File Policy Enforcement**: Three-tier system to prevent file clutter\n- **Three-Stage Verification**: Helps ensure tasks are complete\n- **Session State Management**: Robust state isolation and recovery\n- **Targeted Session Safety**: Commands never affect current Claude Code session\n\n### Measurable Technical Benefits\n\n**Before clautorun + tmux/byobu:**\n- AI work lost when terminal closes\n- Manual intervention required for session interruptions\n- No file creation control during autonomous workflows\n- No verification that tasks are actually complete\n\n**With clautorun + tmux/byobu:**\n- Reduced data loss during crashes or disconnections\n- Decreased need for manual intervention\n- File creation policies to reduce unnecessary files\n- Three-stage verification to help ensure task completion\n\n### Testing\n\nclautorun includes a comprehensive testing suite with multiple approaches to verify functionality and integration.\n\n#### Quick Integration Test\n\n**Test the complete workflow:**\n```bash\n# Create byobu session with crash protection\nbyobu-new-session clautorun-work\n\n# Start autonomous task that simulates crash\n/clautorun /autorun simulate network issues during build process\n\n# Test session recovery\n# Close terminal, reconnect with SSH/Mosh\nbyobu-attach clautorun-work\n# Expected: AI work continues from interruption point\n```\n\n**Recovery Verification:**\n```bash\n# Check if AI is still working\nps aux | grep python  # Look for running clautorun processes\n\n# Verify session state persistence\ntmux list-sessions | grep clautorun\n# Expected: \"clautorun-work\" session exists and is running\n```\n\n#### Comprehensive pytest Testing\n\n**What is pytest?**\npytest is a popular testing framework for Python that makes it easy to write simple and scalable tests. It automatically discovers test files and functions, provides detailed output, and supports powerful fixtures and plugins.\n\n**What are Virtual Environments?**\nVirtual environments are isolated Python environments that keep project dependencies separate. Think of them as clean rooms for each project - they prevent different projects from conflicting with each other's requirements.\n\n**What is UV?**\nUV is a modern, extremely fast Python package manager and virtual environment manager. It's like `pip` + `venv` but 10-100x faster with better dependency resolution.\n\n**Quick Core Tests:**\n```bash\n# With UV (Recommended)\nuv run pytest tests/test_unit_simple.py tests/test_autorun_compatibility.py -v\n\n# With Traditional pip\npython3 -m venv .venv\nsource .venv/bin/activate\npip install -e \".[dev]\"\npytest tests/test_unit_simple.py tests/test_autorun_compatibility.py -v\n\n# Using Makefile\nmake test-quick\n```\n\n**Expected output:**\n```\n============================= test session starts ==============================\ncollected 29 items\n\ntests/test_unit_simple.py::TestConfiguration::test_completion_marker PASSED [ 3%]\ntests/test_unit_simple.py::TestConfiguration::test_emergency_stop_phrase PASSED [ 6%]\n...\ntests/test_autorun_compatibility.py::test_completion_marker PASSED [ 84%]\ntests/test_autorun_compatibility.py::test_emergency_stop_phrase PASSED [ 87%]\n...\n============================== 29 passed in 0.15s ==============================\n```\n\n**Full Test Suite with Coverage:**\n```bash\n# With UV\nuv run pytest --cov=src/clautorun --cov-report=term-missing\n\n# With make\nmake test-all\n\n# With traditional pip\npytest --cov=src/clautorun --cov-report=term-missing\n```\n\n**Test Categories:**\n- **Unit Tests** (`test_unit_simple.py`): Configuration constants, command handlers, command detection logic\n- **Compatibility Tests** (`test_autorun_compatibility.py`): String compatibility, policy descriptions, configuration verification\n- **Integration Tests** (`test_interceptor.py`, `test_interactive.py`): Command processing, interactive mode functionality\n\n**Specific Test Categories:**\n```bash\n# Unit tests only\nuv run pytest tests/test_unit_simple.py -v\n\n# Compatibility tests only\nuv run pytest tests/test_autorun_compatibility.py -v\n\n# With markers\nuv run pytest -m unit -v\nuv run pytest -m compatibility -v\n```\n\n**Test Coverage Report:**\nAfter running tests with coverage, view detailed reports:\n```bash\n# HTML report (opens in browser)\nopen htmlcov/index.html\n\n# Terminal summary\ncat coverage.txt\n```\n\n**Manual Testing:**\n```bash\n# Test interactive commands\nuv run python src/clautorun/main.py\n# Then try: /afs, /afa, /afj, /afst, quit\n\n# Test hook integration\necho '{\"hook_event_name\": \"UserPromptSubmit\", \"session_id\": \"test\", \"prompt\": \"/afs\"}' | uv run python src/clautorun/main.py\n\n# Test plugin mode (same as hook integration now)\necho '{\"hook_event_name\": \"UserPromptSubmit\", \"prompt\": \"/afa\", \"session_id\": \"test\"}' | uv run python src/clautorun/main.py\n```\n\n## Why Byobu + tmux Integration\n\n**clautorun is designed for use with byobu (tmux-compatible terminal multiplexer)** - this integration provides concrete technical capabilities:\n\n### Survive System Failures\n- **Technical Issue**: Terminal application crashes, network disconnections, or system reboots terminate Claude Code sessions, losing all in-progress AI work\n- **Solution**: byobu + tmux maintains session state on the server. Session persists even when your local machine loses power or network connection\n- **Concrete Result**: SSH back to the same session after system reboot; AI work continues from exactly where it left off\n\n### Access Sessions Remotely\n- **Technical Issue**: You must be physically present at your workstation to monitor or intervene in AI sessions\n- **Solution**: SSH access to byobu session from any device with SSH client (phone, tablet, laptop)\n- **Concrete Result**: Monitor AI progress from mobile device; intervene when needed without returning to desk\n\n**What is SSH?** SSH (Secure Shell) is a secure network protocol that lets you securely access and control your computer from anywhere in the world.\n\n**SSH Clients for Different Devices:**\n\n**Enhanced SSH Experience (Recommended):**\n- **Mosh (Mobile Shell)**: [mosh.org](https://mosh.org/) - A mobile SSH client that handles network interruptions gracefully\n  - **Why Mosh?** Keeps your connection alive even when switching networks (WiFi ‚Üí 4G ‚Üí WiFi), works with poor connections, provides intelligent local echo for reduced lag, and automatically resumes where you left off after reconnection\n  - **Installation**: `brew install mosh` (macOS), `sudo apt install mosh` (Ubuntu/Debian)\n  - **Usage**: `mosh username@your-server-address` instead of `ssh username@your-server-address`\n\n**Traditional SSH Clients:**\n- **Windows**: [Windows Terminal](https://learn.microsoft.com/en-us/windows/terminal/) (built-in, modern), [VS Code Terminal](https://code.visualstudio.com/) (built-in to VS Code), [Fluent Terminal](https://github.com/felixse/FluentTerminal) (free), [Hyper](https://hyper.is/) (modern, extensible)\n- **macOS**: [iTerm2](https://iterm2.com/) (recommended, powerful), [VS Code Terminal](https://code.visualstudio.com/) (built-in to VS Code), or built-in Terminal app\n- **Linux**: Most terminal emulators work well (gnome-terminal, konsole, etc.), [VS Code Terminal](https://code.visualstudio.com/) (built-in to VS Code)\n- **iOS**: [Terminus](https://www.termius.com/mobile) (supports Mosh), [Prompt](https://panic.com/prompt/) (supports Mosh), or [Blink Shell](https://blink.sh/) (supports Mosh)\n- **Android**: [Termius](https://www.termius.com/mobile) (supports Mosh), [JuiceSSH](https://juicessh.com/), or [ConnectBot](https://github.com/connectbot/connectbot)\n\n### Monitor Multiple Processes Simultaneously\n- **Technical Issue**: Single terminal window hides AI output, error messages, and system status\n- **Solution**: byobu splits terminal into multiple panes: AI output, error logs, file system monitoring, command history\n- **Concrete Result**: See AI responses in real-time while monitoring system resources and errors simultaneously\n\n### Control File Creation\n- **Technical Issue**: AI creates numerous experimental files during development, leading to cluttered project directories\n- **Solution**: Three-tier file policy system (`/afs` strict-search, `/afj` justify-create, `/afa` allow-all) with PreToolUse hook enforcement\n- **Concrete Result**: Clean project directories with meaningful files only; unified implementation approach reduces file proliferation\n\n## AUTOFILE LIFECYCLE FLOW\n\n```mermaid\ngraph TD\n    A[User sets AutoFile policy] --> B{Policy Level}\n    B -->|Level 3<br/>allow-all| C[All file creation allowed]\n    B -->|Level 2<br/>justify-create| D[Require justification check]\n    B -->|Level 1<br/>strict-search| E[Block all new files]\n\n    C --> F[PreToolUse Hook]\n    D --> G{Justification found?}\n    E --> H{File exists?}\n\n    G -->|Yes| F\n    G -->|No| I[Block file creation]\n    H -->|Yes| F\n    H -->|No| I\n\n    F --> J{Tool is Write?}\n    J -->|No| K[Allow tool execution]\n    J -->|Yes| L{File already exists?}\n    L -->|Yes| K\n    L -->|No| M[Allow new file creation]\n```\n\n**Policy Level 1: Strict Search** (`/afs`)\n- Blocks all new file creation via PreToolWrite hooks\n- Forces AI to modify existing files using Glob/Grep\n- Ideal for refactoring established codebases\n- Prevents pollution with experimental files\n\n**Policy Level 2: Justify Create** (`/afj`)\n- Requires `<AUTOFILE_JUSTIFICATION>` tag in AI reasoning\n- Hook scans transcript for proper justification before allowing new files\n- Balances innovation with organization\n- Records why each file was created in reasoning\n\n**Policy Level 3: Allow All** (`/afa`)\n- No restrictions on file creation (default for new projects)\n- Full creative freedom for initial development\n- Best for prototyping and new project setup\n- All tools pass through without intervention\n\n## How It Works\n\n### Three-Stage Autorun System\n\n```mermaid\ngraph TD\n    A[\"/cr:go task description\"] --> B[Stage 1: Initial Implementation]\n    B --> C{AUTORUN_STAGE1_COMPLETE?}\n    C -->|No| D[Continue working]\n    D --> B\n    C -->|Yes| E[Stage 2: Critical Evaluation]\n    E --> F{AUTORUN_STAGE2_COMPLETE?}\n    F -->|No| G[Continue evaluation]\n    G --> E\n    F -->|Yes| H[Stage 3: Final Verification]\n    H --> I{AUTORUN_STAGE3_COMPLETE?}\n    I -->|No| J[Continue verification]\n    J --> H\n    I -->|Yes| K[Task Complete - Session Ends]\n```\n\n**Stage 1 - Initial Implementation**: Claude works on the task, outputs `AUTORUN_STAGE1_COMPLETE` when done.\n\n**Stage 2 - Critical Evaluation**: Claude critically evaluates work, identifies gaps, outputs `AUTORUN_STAGE2_COMPLETE` when satisfied.\n\n**Stage 3 - Final Verification**: Claude verifies all requirements met, outputs `AUTORUN_STAGE3_COMPLETE` to finish.\n\n### How It Works\n\n1. User sends `/cr:go <task description>` (or legacy `/autorun`)\n2. UserPromptSubmit hook activates session state with three-stage tracking\n3. AI works autonomously through each stage\n4. At each stage boundary, the system validates completion markers\n5. Only after all three stages complete does the session end\n6. Emergency stop (`/cr:sos`) immediately halts at any point\n\n### Safety Mechanisms\n- **Maximum recheck limit**: Prevents infinite loops (default: 3 attempts per stage)\n- **Emergency stop**: `/cr:sos` immediately terminates any runaway process\n- **Plan acceptance**: Plans can auto-trigger autorun via \"PLAN ACCEPTED\" marker\n- **State validation**: Ensures session integrity throughout process\n\n### Verification Example\n\n**Before clautorun**: Claude stops after implementing basic login form\n**With clautorun three-stage verification**:\n1. Stage 1: \"Login form implemented!\" ‚Üí `AUTORUN_STAGE1_COMPLETE`\n2. Stage 2: \"Critically evaluated - added error handling, tests missing\" ‚Üí continues working ‚Üí `AUTORUN_STAGE2_COMPLETE`\n3. Stage 3: \"Verified: Form works, tests pass, error handling complete\" ‚Üí `AUTORUN_STAGE3_COMPLETE` ‚Üí Session ends\n\n## Tmux Integration\n\nFor crash-safe sessions that survive disconnections, use **byobu** (recommended) with clautorun.\n\n### Install byobu (Recommended)\n\n**[byobu](https://www.byobu.org/)** is a user-friendly terminal multiplexer that wraps tmux with helpful defaults and keyboard shortcuts.\n\n```bash\n# macOS\nbrew install byobu\n\n# Ubuntu/Debian\nsudo apt install byobu\n```\n\n**Why byobu?**\n- Simpler than raw tmux - designed for humans\n- **F3/F4** or **Cmd+Left/Right** to switch between tabs (windows)\n- Helpful status bar and keyboard shortcut reminders (press F1 for help)\n- Session persistence across disconnections\n- Multiple windows/panes in one terminal\n- Remote session access via SSH/Mosh\n\n**Resources:**\n- [byobu.org](https://www.byobu.org/) - Official site and documentation\n- [byobu Quick Start](https://www.byobu.org/documentation) - Getting started guide\n- [Ubuntu byobu Guide](https://help.ubuntu.com/community/Byobu) - Community documentation\n\n### Start a Crash-Safe Session\n\n```bash\n# Create byobu session\nbyobu-new-session clautorun-work\n\n# Start autonomous work\n/cr:go Build a complete web application with authentication\n\n# Detach: Ctrl+A, D (or close terminal)\n# Reattach anytime: byobu-attach clautorun-work\n```\n\n### Remote Access with Mosh (Optional)\n\nFor better mobile/unreliable connections, use [Mosh](https://mosh.org/) instead of SSH:\n```bash\n# Install: brew install mosh (macOS) or sudo apt install mosh (Linux)\nmosh user@server    # Then: byobu-attach clautorun-work\n```\n\n## Development\n\n### Repository Structure\n\n**Git Repository (Development Location):**\n- Edit source files in your clautorun git repository\n- Run tests from the plugin directory\n- Commit changes to git\n- Push changes to GitHub for sharing\n\n**Plugin Cache (Runtime Location - READ ONLY):**\n- Claude Code installs plugins to a cache directory\n- Changes in cache do NOT persist\n- For reference only, NOT for development\n\n**Typical Development Workflow:**\n```bash\n# Navigate to your clautorun repository\ncd /path/to/clautorun\n\n# Edit files in the repository\n# Run tests\nuv run pytest tests/\n\n# Commit changes\ngit add .\ngit commit -m \"Description of changes\"\n\n# Update plugin (or reinstall for local development)\n/plugin update clautorun\n# OR for local development: /plugin install clautorun@clautorun-dev\n```\n\n### Active vs Deprecated\n\n**‚úÖ clautorun plugin v0.6.0 (Current)**\n- Installed via `/plugin install https://github.com/ahundt/clautorun.git`\n- Commands: `/cr:st`, `/cr:a`, `/cr:j`, `/cr:f`, `/cr:go`, `/cr:gp`, `/cr:x`, `/cr:sos`, `/cr:tm`, `/cr:tt`, `/cr:tabs`\n- **NEW v0.6.0:** `/cr:no`, `/cr:ok`, `/cr:clear`, `/cr:globalno`, `/cr:globalok`, `/cr:globalstatus` (Command Blocking)\n- Active and maintained\n\n## üîß Advanced Setup (Optional)\n\n### Development Installation (Contributors)\n\nFor contributing to clautorun development:\n\n```bash\n# Clone repository and set up development environment\ngit clone https://github.com/ahundt/clautorun.git\ncd clautorun\n\n# Install development dependencies\nuv sync --extra dev\n\n# Add local development marketplace for testing\n/plugin marketplace add ./clautorun\n\n# Install your local development version\n/plugin install clautorun@clautorun-dev\n```\n\n**Contributor Workflow:**\n1. **Make changes**: Edit code in your local clone\n2. **Test locally**: Use the installed development version to test your changes\n3. **Run tests**: `uv run pytest tests/` to ensure nothing breaks\n4. **Submit PR**: Create a pull request with your improvements\n\n**Git for Contributors:**\nGit provides complete version control for collaborative development. Essential commands:\n- `git diff` - Review your changes before committing\n- `git add . && git commit -m \"Description\"` - Commit your changes\n- `git push origin feature-branch` - Share your changes for review\n\n**AI Safety with Git:**\n- **Instant rollback**: `git reset --hard HEAD~1` undoes all AI changes instantly\n- **Selective revert**: `git checkout -- filename` restores specific files\n- **Safe experimentation**: Test AI suggestions knowing you can revert completely\n- **Change visibility**: See exactly what AI modified before committing\n\n### Manual Installation (if plugin system fails)\n\n```bash\n# Create virtual environment\npython3 -m venv .venv\nsource .venv/bin/activate\n\n# Install dependencies\npip install -e \".[dev]\"\n\n# Manual plugin setup\nPYTHONPATH=$(pwd)/src python src/clautorun/install.py install\n```\n\n## üìã Available Commands\n\n### Plugin Naming\n\n- **Project/Repo name**: `clautorun`\n- **Marketplace name**: `clautorun` (used for `/plugin install clautorun@clautorun`)\n- **Command prefix**: `cr` (used for short commands like `/cr:st`, `/cr:a`, `/cr:f`)\n\nThe short `cr` prefix is intentional to make commands quick to type while the full name `clautorun` is used for the project, repository, and marketplace identification.\n\n### Command Prefix\n\nCommands use the `/cr:` prefix with both **short** (for power users) and **long** (for discoverability) forms.\n\n### Command Reference Table\n\n| Short | Long | Legacy | Description |\n|-------|------|--------|-------------|\n| `/cr:a` | `/cr:allow` | `/afa` | Allow all file creation (Level 3) |\n| `/cr:j` | `/cr:justify` | `/afj` | Require justification for new files (Level 2) |\n| `/cr:f` | `/cr:find` | `/afs` | Find existing files only - no creation (Level 1) |\n| `/cr:st` | `/cr:status` | `/afst` | Show current policy status |\n| `/cr:go` | `/cr:run` | `/autorun` | Start autonomous task execution |\n| `/cr:gp` | `/cr:proc` | `/autoproc` | Procedural autonomous workflow |\n| `/cr:x` | `/cr:stop` | `/autostop` | Graceful stop |\n| `/cr:sos` | `/cr:estop` | `/estop` | Emergency stop |\n| `/cr:pn` | `/cr:plannew` | - | Create new structured plan |\n| `/cr:pr` | `/cr:planrefine` | - | Refine and improve existing plan |\n| `/cr:pu` | `/cr:planupdate` | - | Update plan with new information |\n| `/cr:pp` | `/cr:planprocess` | - | Execute plan with development process |\n| `/cr:tm` | `/cr:tmux` | - | Tmux session management |\n| `/cr:tt` | `/cr:ttest` | - | Tmux test workflow |\n| `/cr:tabs` | - | - | Discover and manage Claude sessions across tmux |\n| `/cr:no <p>` | - | - | Block command pattern in session |\n| `/cr:ok <p>` | - | - | Allow command pattern in session |\n| `/cr:clear` | - | - | Clear session blocks |\n| `/cr:globalno <p>` | - | - | Block command pattern globally |\n| `/cr:globalok <p>` | - | - | Allow command pattern globally |\n\n### AutoFile Commands (File Creation Control)\n\n- **/cr:a** or **/cr:allow** - Allow all file creation (Level 3 - default)\n  - No restrictions on creating new files\n  - Best for new projects and initial development\n\n- **/cr:j** or **/cr:justify** - Require justification before creating new files (Level 2)\n  - AI must include \\<AUTOFILE_JUSTIFICATION> tag with reasoning\n  - Ideal for security-sensitive work and established projects\n\n- **/cr:f** or **/cr:find** - Find existing files only (Level 1 - strictest)\n  - Blocks ALL new file creation\n  - Forces AI to FIND and modify existing files via Glob/Grep search\n  - Perfect for refactoring established codebases\n\n- **/cr:st** or **/cr:status** - Display current AutoFile policy and settings\n  - Shows current policy level and name\n  - Displays current enforcement status\n\n\n### Command Blocking Commands (ENHANCED in v0.6.0+)\n\n**General-purpose command blocking** - Block dangerous commands per-session or globally\n\n**Session Commands:**\n- **/cr:no \\<pattern> [description]** - Block pattern in this session\n- **/cr:ok \\<pattern>** - Allow pattern in this session\n- **/cr:clear [pattern]** - Clear blocks (or specific pattern)\n- **/cr:status** - Show blocked patterns\n\n**Global Commands:**\n- **/cr:globalno \\<pattern> [description]** - Block pattern globally (all sessions)\n- **/cr:globalok \\<pattern>** - Allow pattern globally\n- **/cr:globalstatus** - Show global blocks\n\n**Pattern Type Prefixes (NEW):**\n- **regex:\\<pattern>** - Use regular expression matching\n- **glob:\\<pattern>** - Use glob pattern matching\n- **/\\<pattern>/** - Auto-detects regex when pattern contains metacharacters\n- *(default)* - Literal substring matching\n\n**Custom Descriptions (NEW):**\nAdd custom descriptions when blocking patterns to provide specific guidance to users.\n\n**Examples:**\n```bash\n# Basic blocking (uses DEFAULT_INTEGRATIONS for suggestions)\n/cr:no rm\n\n# Custom description for specific guidance\n/cr:no \"exec(\" unsafe exec function - use alternatives\n\n# Regex pattern matching for flexible patterns\n/cr:no regex:eval\\( dangerous eval usage - blocked for security\n\n# Glob pattern matching for wildcards\n/cr:no glob:*.tmp temporary files are not allowed in this session\n\n# Global blocking with custom description\n/cr:globalno \"git reset --hard\" PERMANENTLY DESTRUCTIVE - use git restore instead\n\n# Auto-detect regex when pattern contains metacharacters\n/cr:no /eval\\(.*assert/ matches eval( or assert(\n```\n\n**Pattern Type Examples:**\n\n| Type | Prefix | Description | Example Pattern | Matches |\n|------|--------|-------------|---------------|--------|\n| Literal | *(none)* | Substring/part matching (default) | `rm` | `rm file.txt` |\n| Regex | `regex:` | Regular expression | `regex:eval\\(` | `code(eval(x))` |\n| Glob | `glob:` | Glob pattern matching | `glob:*.tmp` | `file.tmp` |\n| Auto | `/.../` | Auto-detects regex | `/eval\\(./` | `eval(...` |\n\n**Default Integrations:**\n- `rm` ‚Üí Suggests 'trash' CLI (safe file deletion with recovery)\n- `rm -rf` ‚Üí Dangerous, suggests trash CLI alternatives\n- `git reset --hard` ‚Üí CRITICAL: Permanently discards uncommitted changes, suggests safer git alternatives\n- `dd if=` ‚Üí Disk write warning, suggests backup tools\n- `mkfs` ‚Üí Filesystem warning, suggests backup first\n- `fdisk` ‚Üí Partition warning, suggests GUI alternatives\n\n**Installing trash CLI:**\n- macOS: `brew install trash`\n- Linux: `go install github.com/andraschume/trash-cli@latest`\n- Restores files from: `trash-restore` or system trash\n\n**State Hierarchy:**\n1. Session blocks (highest priority)\n2. Global blocks (fallback)\n3. Default integrations (built-in suggestions)\n\n**Backward Compatibility:**\nAll existing patterns without type prefixes default to literal matching. Existing blocks continue to work as before.\n\n### Autorun Commands (Autonomous Execution)\n\n- **/cr:go** or **/cr:run** \\<prompt> - Start autonomous workflow with extended work sessions\n  - Reduces manual \"continue\" prompts significantly\n  - Enables three-stage verification to prevent premature exits\n  - Takes task description as argument (required)\n\n- **/cr:gp** or **/cr:proc** \\<prompt> - Procedural autonomous workflow\n  - Uses Sequential Improvement Methodology\n  - Includes wait process and best practices generation\n\n- **/cr:x** or **/cr:stop** - Stop gracefully after current task completion\n  - Allows AI to finish current work before stopping\n  - Cleans up processes and state files properly\n\n- **/cr:sos** or **/cr:estop** - Emergency stop - immediately halt any runaway process\n  - Stops all processes immediately without waiting\n  - Use for critical situations or when something goes wrong\n\n### Plan Management Commands\n\nStructured planning for complex development tasks.\n\n| Short | Long | Description |\n|-------|------|-------------|\n| `/cr:pn` | `/cr:plannew` | Create a new structured plan |\n| `/cr:pr` | `/cr:planrefine` | Refine and improve an existing plan |\n| `/cr:pu` | `/cr:planupdate` | Update plan with new information |\n| `/cr:pp` | `/cr:planprocess` | Execute plan with development process |\n\n- **/cr:pn** or **/cr:plannew** - Create a new development plan\n  - Generates structured plan with checkboxes and dependencies\n  - Includes task breakdown and verification criteria\n\n- **/cr:pr** or **/cr:planrefine** - Refine an existing plan\n  - Critically evaluates and improves plan quality\n  - Identifies gaps and adds missing steps\n\n- **/cr:pu** or **/cr:planupdate** - Update plan with new context\n  - Incorporates new requirements or changes\n  - Maintains plan consistency\n\n- **/cr:pp** or **/cr:planprocess** - Execute development process\n  - Follows the plan with Sequential Improvement Methodology\n  - Auto-triggers autorun when plan is approved (\"PLAN ACCEPTED\" marker)\n\n### Tmux Automation Commands\n\n- **/cr:tm** or **/cr:tmux** - Session lifecycle management (create, list, cleanup)\n- **/cr:tt** or **/cr:ttest** - Comprehensive CLI and plugin testing in isolated sessions\n- **/cr:tabs** - Discover and manage Claude sessions running across tmux windows\n  - Scans all tmux panes for Claude Code sessions using pattern matching\n  - Displays organized table with session letter (A, B, C), directory, purpose, and status\n  - Supports batch actions: `all:continue`, `awaiting:continue`, `A:git status, B:pwd`\n  - Interactive workflow with user approval before executing commands\n\n#### Session Status Types\n\nWhen `/cr:tabs` discovers sessions, it displays these status indicators:\n\n| Status | Description | Action |\n|--------|-------------|--------|\n| `awaiting input` | Claude waiting for user prompt | Can send commands |\n| `working` | Claude actively generating | Use `:escape` to stop |\n| `plan approval` | Awaiting plan approval | Respond with approval |\n| `tool permission` | Awaiting tool permission | Use `:y` or `:n` |\n| `idle` | Session inactive, no Claude | Safe to send commands |\n| `error` | Error state detected | Investigate before acting |\n\n**See also**:\n- `/cr:tmux` or `/cr:tm` - Create and manage isolated tmux sessions\n- `/cr:ttest` or `/cr:tt` - Automated CLI testing in isolated sessions\n- `tmux-session-automation.md` agent - Advanced session lifecycle automation\n\n### Usage Examples\n\n```bash\n# Start autonomous work on a large project\n/cr:go Build complete REST API with authentication, testing, and documentation\n\n# Enable strict file control for security-sensitive work\n/cr:j\n/cr:go Implement OAuth2 authentication system\n\n# Check current file creation policy\n/cr:st\n# Output: \"Current policy: justify-create\"\n\n# Protect existing codebase during refactoring (find existing files, don't create new ones)\n/cr:f\n/cr:go Refactor authentication module to use new database schema\n\n# Stop gracefully when task is complete\n/cr:x\n\n# Emergency stop if something goes wrong\n/cr:sos\n\n# Tmux session management\n/cr:tm create my-project\n/cr:tm list\n/cr:tm cleanup\n\n# Discover and manage Claude sessions across tmux windows\n/cr:tabs\n# Shows table of sessions (A, B, C...) with status\n# Then respond with selections like: \"A, B:git status, all:continue\"\n\n# Advanced session discovery examples\n/cr:tabs                    # Show all Claude sessions with AI analysis\n# Output: Table with sessions labeled A, B, C... with status and purpose\n\n# Continue all sessions awaiting input\n/cr:tabs awaiting:continue\n\n# Run different commands on specific sessions\n/cr:tabs A:git status, B:pwd, C:ls -la\n\n# Emergency stop all active sessions\n/cr:tabs all:escape\n\n# Check status of all sessions\n/cr:tabs all:pwd\n```\n\n### Legacy Commands (Backward Compatible)\n\nAll legacy commands continue to work: `/afa`, `/afj`, `/afs`, `/afst`, `/autorun`, `/autoproc`, `/autostop`, `/estop`\n\n## üõ†Ô∏è Plugin Architecture and Integration Guide\n\n**Official Claude Code Plugin Structure:**\n```\nclautorun/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json          # Plugin manifest and metadata\n‚îú‚îÄ‚îÄ agents/\n‚îÇ   ‚îú‚îÄ‚îÄ tmux-session-automation.md      # Session lifecycle automation\n‚îÇ   ‚îî‚îÄ‚îÄ cli-test-automation.md         # CLI testing automation\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îú‚îÄ‚îÄ clautorun            # Core plugin command script\n‚îÇ   ‚îú‚îÄ‚îÄ tmux-test-workflow.md           # Testing workflow\n‚îÇ   ‚îî‚îÄ‚îÄ tmux-session-management.md      # Session management\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îî‚îÄ‚îÄ clautorun/           # Package code\n‚îî‚îÄ‚îÄ ... (other files)\n```\n\n### Integration Approach Guidance\n\n**clautorun provides three integration approaches - choose based on your needs:**\n\n#### 1. **Official Plugin Integration** (Recommended for most users)\n- **Use When**: Standard clautorun functionality via `/plugin install`\n- **Commands**: `/afs`, `/afa`, `/afj`, `/afst`, `/autorun`, `/autostop`, `/estop`\n- **How**: `/plugin install https://github.com/ahundt/clautorun.git`\n- **Benefits**: Official plugin system, automatic updates, seamless integration\n- **State Management**: Enhanced session management with verification engine\n\n#### 2. **Hook Integration** (Advanced users)\n- **Use When**: Fine-grained control over command interception, custom workflows\n- **Setup**: Configure hooks in `settings.json` to intercept all prompts\n- **Benefits**: Complete control over prompt processing, custom logic injection\n- **State Management**: Same core system as plugin integration\n\n#### 3. **Interactive Mode** (Development and testing)\n- **Use When**: Standalone command processing, development, testing\n- **Setup**: `AGENT_MODE=SDK_ONLY python src/clautorun/main.py`\n- **Benefits**: Direct testing, development debugging, standalone operation\n- **State Management**: Local session state for testing purposes\n\n**How the Plugin Works:**\n- Claude Code automatically discovers and loads the plugin from marketplace\n- Uses official plugin structure with `.claude-plugin/plugin.json` manifest\n- Commands are processed locally through the plugin system\n- Session state is preserved between command invocations\n- Plugin integrates seamlessly with Claude Code's plugin management\n- Automatic dependency resolution through plugin environment\n\n**Canonical Entry Point:**\nThe canonical entry point for clautorun is `commands/clautorun` - this is the executable that Claude Code calls when processing plugin commands. Configuration is centralized in `src/clautorun/config.py` which serves as the single source of truth for all CONFIG values used throughout the plugin (DRY principle).\n\n**Plugin Documentation:**\n- Follows Claude Code plugin specification with `.claude-plugin/plugin.json` manifest\n- Uses command components in `commands/` directory with executable scripts\n- Implements standard plugin layout as defined in [Claude Code Plugin Documentation](https://docs.claude.com/en/docs/claude-code/plugins)\n- Compatible with [Plugin Marketplace](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces) installation and verification\n- See [Develop More Complex Plugins](https://docs.claude.com/en/docs/claude-code/plugins#develop-more-complex-plugins) for advanced patterns\n- Follows [Claude Code Plugin Reference](https://docs.claude.com/en/docs/claude-code/plugins-reference) specification\n- Compatible with [Plugin Marketplace Installation](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces#verify-marketplace-installation)\n- Reference: [Claude Code GitHub Plugin Examples](https://raw.githubusercontent.com/anthropics/claude-code/refs/heads/main/plugins/README.md) for official plugin patterns\n\n**Environment Variables:**\n- `${CLAUDE_PLUGIN_ROOT}`: Absolute path to plugin directory for script execution\n- `${CLAUDE_PLUGIN_NAME}`: Plugin name from manifest (clautorun)\n\n**Debugging Plugin Issues:**\n```bash\n# Check plugin loading details\nclaude --debug\n\n# Verify plugin structure\nls -la ~/.claude/plugins/clautorun/.claude-plugin/\nls -la ~/.claude/plugins/clautorun/commands/\n\n# Test plugin manually\necho '{\"prompt\": \"/afs\", \"session_id\": \"test\"}' | ~/.claude/plugins/clautorun/commands/clautorun\n```\n\n**Plugin Management Commands:**\n```bash\n# Uninstall plugin\n/plugin uninstall clautorun\n\n# Reinstall plugin\n/plugin install clautorun@main\n\n# Update plugin from repository\n/plugin update clautorun\n\n# Browse available plugins\n/plugin marketplace list\n```\n\n### Option 2: Hook Integration\n\nThis method intercepts all Claude Code prompts through the hook system.\n\n**What are Hooks?**\nHooks are automated scripts that run at specific points during program execution. Think of them as custom triggers that let you extend or modify how a program works. In clautorun, hooks intercept commands before they reach Claude Code, enabling file policy enforcement and command processing.\n\n**What is JSON?**\nJSON (JavaScript Object Notation) is a lightweight data format that's easy for humans to read and write, and easy for computers to parse and generate. It's commonly used for configuration files and data exchange between programs.\n\n**Setup:**\n```bash\n# Copy to hooks directory\ncp src/clautorun/main.py ~/.claude/hooks/clautorun_hook.py\n```\n\n**Update settings.json:**\n```json\n{\n  \"hooks\": {\n    \"hooks\": [\n      {\n        \"command\": \"~/.claude/hooks/clautorun_hook.py\"\n      }\n    ]\n  }\n}\n```\n\n**What happens:**\n- All prompts go through clautorun first\n- File policy commands are handled locally\n- Other prompts continue to Claude Code normally\n\n### Option 3: Interactive Mode\n\nRun as a standalone application that communicates with Claude Code via the Agent SDK.\n\n**Setup:**\n```bash\n# Navigate to clautorun directory\ncd /path/to/clautorun\n\n# Activate virtual environment\nsource .venv/bin/activate\n\n# Run interactive mode\nAGENT_MODE=SDK_ONLY python clautorun.py\n```\n\n**Example session:**\n```\nüöÄ Agent SDK Command Interceptor - Interactive Mode\n‚úÖ Ready for commands...\n\n‚ùì /afs\n‚úÖ AutoFile policy: strict-search - STRICT SEARCH: ONLY modify existing files...\n\n‚ùì help me understand this codebase\nü§ñ Processing with Claude Code...\n[Claude's response appears here]\n```\n\n## Command Reference\n\n### Interactive Mode Commands\n- `quit`, `exit`, `q` - Exit the application\n- Ctrl+C - Interrupt, Ctrl+C twice - Exit\n- Ctrl+D - Exit immediately\n\n## Tmux Automation Agents\n\nclautorun includes specialized agents for tmux-based automation and testing workflows with reliable session targeting:\n\n### tmux-session-automation Agent\nAutomates tmux session lifecycle management with health monitoring and recovery:\n\n- **Session Management**: Create, monitor, and clean up tmux sessions automatically\n- **Health Monitoring**: Continuous monitoring of session responsiveness and resource usage\n- **Automated Recovery**: Detect and recover from stuck or unresponsive sessions\n- **Integration Ready**: Works with ai-monitor for extended autonomous workflows\n- **Safe Session Targeting**: Commands always target \"clautorun\" session, never affect current Claude Code session\n\n### cli-test-automation Agent\nComprehensive CLI application testing automation with verification capabilities:\n\n- **Test Framework Integration**: Automated test discovery and systematic execution\n- **Session Management**: Isolated test environments with proper cleanup\n- **Verification and Validation**: Output pattern matching and error condition testing\n- **Plugin Testing Specialization**: Claude Code plugin compatibility and functionality testing\n- **Secure Test Environments**: Tests run in isolated tmux sessions to prevent interference\n\n### Session Targeting and Safety\n\n**Critical Safety Feature**: All tmux utilities use explicit session targeting to prevent commands from accidentally affecting the current Claude Code session.\n\n- **Default Session**: \"clautorun\" - ensures commands never interfere with current session\n- **Custom Targeting**: Pass session parameter to target different sessions when needed\n- **Format**: `session:window.pane` for precise targeting\n- **Guarantee**: Commands will NEVER go to the wrong session accidentally\n\n```python\nfrom clautorun.tmux_utils import get_tmux_utilities\n\n# Default: Always targets \"clautorun\" session\ntmux = get_tmux_utilities()\ntmux.send_keys(\"npm test\")  # Executes in \"clautorun\" session, not current session\n\n# Custom: Target specific session\ntmux.send_keys(\"npm test\", \"my-test-session\")  # Executes in \"my-test-session\"\n```\n\n### Usage Examples\n\n```bash\n# Test claude CLI with comprehensive automation\n/clautorun tmux-test-workflow claude --test-categories basic,integration,performance\n\n# Create and manage interactive development session\n/clautorun tmux-session-management create my-project --template development\n\n# Start health monitoring for existing session\n/clautorun tmux-session-management monitor my-dev-session\n\n# Safe command execution - never affects current Claude Code session\n/clautorun tmux-test-workflow --session=test-session --verify-functionality\n```\n\n## File Policy Details\n\n**STRICT SEARCH** (`/afs`):\n- Response: \"AutoFile policy: strict-search - STRICT SEARCH: ONLY modify existing files. Use Glob/Grep. NO new files.\"\n- Can only modify existing files\n- Must search for similar functionality first\n\n**ALLOW ALL** (`/afa`):\n- Response: \"AutoFile policy: allow-all - ALLOW ALL: Full permission to create/modify files.\"\n- Can create or modify any files\n- No restrictions on file operations\n\n**JUSTIFY** (`/afj`):\n- Response: \"AutoFile policy: justify-create - JUSTIFIED: Search existing first. Include <AUTOFILE_JUSTIFICATION>reason</AUTOFILE_JUSTIFICATION> for new files.\"\n- Must search existing files first\n- Must provide justification for creating new files\n\n\n## Project Structure\n\n```\nclautorun/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json          # Plugin manifest and metadata\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îî‚îÄ‚îÄ clautorun            # Plugin command script (Claude Code commands)\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îî‚îÄ‚îÄ clautorun/\n‚îÇ       ‚îú‚îÄ‚îÄ __init__.py          # Package exports\n‚îÇ       ‚îú‚îÄ‚îÄ main.py              # Hook handler and interactive CLI (source of truth)\n‚îÇ       ‚îú‚îÄ‚îÄ mcp_server.py        # MCP server for external apps\n‚îÇ       ‚îú‚îÄ‚îÄ install.py           # Plugin installation management\n‚îú‚îÄ‚îÄ tests/\n‚îÇ   ‚îú‚îÄ‚îÄ test_autorun_compatibility.py  # Command compatibility tests\n‚îÇ   ‚îú‚îÄ‚îÄ test_interactive.py           # Interactive mode tests\n‚îÇ   ‚îú‚îÄ‚îÄ simple_test.py                # Basic functionality tests\n‚îÇ   ‚îú‚îÄ‚îÄ test_interceptor.py           # Hook integration tests\n‚îÇ   ‚îî‚îÄ‚îÄ test_pretooluse_policy_enforcement.py # PreToolUse policy tests\n‚îú‚îÄ‚îÄ docs/\n‚îÇ   ‚îî‚îÄ‚îÄ INTEGRATION_GUIDE.md           # Detailed setup instructions\n‚îú‚îÄ‚îÄ clautorun.py                       # Entry point for interactive mode\n‚îú‚îÄ‚îÄ requirements.txt                   # Python dependencies\n‚îú‚îÄ‚îÄ pyproject.toml                    # Package configuration\n‚îú‚îÄ‚îÄ README.md                          # This file\n‚îú‚îÄ‚îÄ CLAUDE.md                          # Symlink to README.md for Claude Code reference\n‚îî‚îÄ‚îÄ .gitignore                        # Git ignore rules\n```\n\n**Plugin Components:**\n- **Agents** (`agents/` directory): Specialized automation agents for tmux and CLI workflows\n- **Commands** (`commands/` directory): Claude Code slash commands using markdown files and executable scripts\n- **Hooks** (`main.py`): Event handlers for UserPromptSubmit, PreToolUse, Stop, and SubagentStop events\n- **MCP Servers** (`mcp_server.py`): Model Context Protocol integration for external applications\n\n**Plugin Manifest** (`.claude-plugin/plugin.json`):\n- Required: `name`, `description`, `commands` path\n- Optional: `version`, `author`, `homepage`, `repository`, `license`, `keywords`\n- Follows [Claude Code Plugin Reference](https://docs.claude.com/en/docs/claude-code/plugins-reference) specification\n\n**Environment Variables:**\n- `${CLAUDE_PLUGIN_ROOT}`: Absolute path to plugin directory for script execution\n- `${CLAUDE_PLUGIN_NAME}`: Plugin name from manifest\n\n## Developer Documentation\n\n### Core Design Principles\n\nThis section outlines the essential design principles, patterns, and architectural decisions that guide clautorun development.\n\n#### **RAII Pattern Implementation**\n\nclautorun uses Resource Acquisition Is Initialization (RAII) patterns for robust resource management:\n\n```python\n# RAII Session Lock - Automatic acquisition and guaranteed release\nwith SessionLock(session_id, timeout, state_dir) as lock_fd:\n    # Lock is acquired automatically when entering context\n    # All resources are cleaned up automatically when exiting context\n    pass  # Exception safety guaranteed\n```\n\n**Key RAII Benefits:**\n- **Automatic Resource Management**: No manual cleanup required\n- **Exception Safety**: Resources released even if exceptions occur\n- **Deadlock Prevention**: Timeout-based lock acquisition\n- **Thread/Process Isolation**: Each session gets isolated access\n\n#### **Thread & Process Safety Architecture**\n\n**Concurrency Model:**\n- **Thread Safety**: File-based locking using `fcntl.flock` for cross-thread synchronization\n- **Process Safety**: POSIX file locks work across process boundaries\n- **Deadlock Prevention**: Configurable timeouts with exponential backoff\n\n**Safety Mechanisms:**\n```python\n# Session lock with automatic timeout handling\nwith SessionLock(session_id, timeout=30.0, state_dir) as lock_fd:\n    # Exclusive access guaranteed during context\n    pass  # Lock automatically released after context exits\n```\n\n**Testing Validation:**\n- **6/6 RAII tests passed** - Resource management and cleanup\n- **4/4 safety tests passed** - Concurrent access patterns validated\n- **27/29 unit tests passed** - Core functionality verified\n\n#### **Dispatch Pattern**\n\nclautorun uses a **command dispatch pattern** for processing different types of commands:\n\n```python\n# Command Detection and Dispatch Logic\ncommand = next((v for k, v in CONFIG[\"command_mappings\"].items() if k == prompt), None)\n\nif command and command in COMMAND_HANDLERS:\n    # Handle command locally (don't send to AI)\n    response = COMMAND_HANDLERS[command](state)\nelse:\n    # Let AI handle non-commands\n    result = {\"continue\": True, \"response\": \"\"}\n```\n\n**Dispatch Categories:**\n- **Policy Commands**: File policy management (`/afs`, `/afa`, `/afj`, `/afst`)\n- **Control Commands**: Session control (`/autostop`, `/estop`)\n- **Autorun Commands**: Task automation (`/autorun`, `/autoproc`)\n- **AI Commands**: All other prompts (sent to Claude Code)\n\n#### **Environment Requirements**\n\n**Development Environment:**\n```bash\n# Required: UV package manager for Python version management\nuv --version  # Verify UV installation\nuv venv --python 3.10  # Create with preferred Python version\nsource .venv/bin/activate  # Activate environment\nuv sync --extra claude-code  # Install dependencies\n```\n\n**Production Environment:**\n- **Claude Code Plugin**: Official installation via `/plugin install`\n- **Virtual Environment**: Activated for dependency isolation\n- **Session Storage**: `~/.claude/sessions/` for state persistence\n- **Lock Management**: File-based locks for cross-process coordination\n\n#### **Python Version Support**\n\n- **Minimum**: Python 3.0+ (basic functionality)\n- **Preferred**: Python 3.10+ (full compatibility)\n- **Testing**: Python 2.7 compatibility in error handling\n\n#### **Centralized Error Handling (DRY)**\n\nFollowing DRY principles, clautorun implements centralized error handling:\n\n```python\nfrom clautorun.error_handling import show_comprehensive_uv_error\n\n# Single source of truth for all import errors\nshow_comprehensive_uv_error(\"MODULE ERROR\", \"Specific error details\")\n```\n\n**Centralized Features:**\n- **UV Environment Checking**: Automatic UV detection and setup guidance\n- **Version Compatibility**: Flexible Python version support\n- **Comprehensive Troubleshooting**: Step-by-step resolution guides\n- **Consistent Messaging**: Same error format across all components\n\n### System Architecture\n\n**Integration Architecture:**\nclautorun provides multiple integration approaches, each using the same core session management and error handling infrastructure:\n\n1. **Claude Code Plugin**: Official plugin system integration\n2. **Hook Integration**: Event-based command interception\n3. **MCP Server**: External application communication\n4. **Interactive Mode**: Standalone command processing\n\n**Technical Implementation Details:**\n- **RAII Pattern**: Resource Acquisition Is Initialization for robust resource management\n- **Thread & Process Safety**: File-based locking with POSIX file locks across process boundaries\n- **Command Dispatch Pattern**: Efficient command detection and routing\n- **Centralized Error Handling**: Single source of truth for all error scenarios\n\n##### Approach 1: Markdown Commands (Basic)\n\n**Source**: [Claude Code Plugin Reference](https://docs.claude.com/en/docs/claude-code/plugins-reference)\n\n**Key Finding**: \"Commands directory contains slash command markdown files with frontmatter.\"\n\n- Plugin commands can be **markdown files** with YAML frontmatter\n- Commands appear in Claude Code with the format: `plugin-name:command-name`\n- Example: `commands/test.md` appears as `/clautorun:test` in slash commands list\n\n**Plugin Manifest Structure**:\n```json\n{\n  \"name\": \"plugin-name\",\n  \"commands\": [\"./custom/commands/special.md\"]\n}\n```\n\nSource: https://docs.claude.com/en/docs/claude-code/plugins-reference\n\n##### Approach 2: Agent SDK Executable Scripts (Advanced)\n\n**Key Finding**: Executable scripts in `commands/` directory that follow the Agent SDK JSON protocol\n\n**JSON Protocol Format**:\n```python\n# Input (via stdin):\n{\"prompt\": \"/command args\", \"session_id\": \"uuid\"}\n\n# Output (via stdout):\n{\"continue\": false, \"response\": \"Command response text\"}\n```\n\n**How It Works**:\n1. Executable script in plugin's `commands/` directory\n2. Claude Code calls script and sends JSON via stdin\n3. Script processes command and returns JSON via stdout\n4. `continue: false` means command was handled locally\n5. `continue: true` means pass to AI for processing\n\n**Current Implementation**:\n- ‚úÖ `commands/clautorun` executable script - Agent SDK JSON protocol\n- ‚úÖ Receives: `{\"prompt\": \"/afst\", \"session_id\": \"test\"}`\n- ‚úÖ Returns: `{\"continue\": false, \"response\": \"Current policy: strict-search\"}`\n- ‚úÖ Symlinked in `~/.claude/commands/clautorun` for system-wide access\n\n**Testing**:\n```bash\necho '{\"prompt\": \"/afst\", \"session_id\": \"test\"}' | ~/.claude/commands/clautorun\n# Output: {\"continue\": false, \"response\": \"Current policy: strict-search\"}\n```\n\n#### Environment Variables\n\n**Available in Plugins**:\n- `${CLAUDE_PLUGIN_ROOT}`: Absolute path to plugin directory\n- `${CLAUDE_PLUGIN_NAME}`: Plugin name from manifest\n\nSource: https://docs.claude.com/en/docs/claude-code/plugins-reference\n\n#### UV Tool Integration\n\n**Current UV Tool Setup**:\n```bash\n# Main plugin functionality (reads JSON stdin)\nclautorun\n\n# Installation management utility\nclautorun-install\n\n# Interactive standalone mode\nclautorun-interactive\n```\n\n**Entry Points** (from `pyproject.toml`):\n```toml\n[project.scripts]\nclautorun = \"clautorun.main:main\"\nclautorun-interactive = \"clautorun.main:main\"\nclautorun-install = \"clautorun.install:main\"\n```\n\n#### Plugin Development Workflow\n\n1. **Create markdown commands** in `commands/` directory\n2. **Markdown files call UV tool** via shell execution\n3. **UV tool** (`clautorun`) processes commands using Python package\n4. **Fallback mechanisms** ensure functionality when UV tool unavailable\n\n**Testing Plugin Loading**:\n```bash\n# Check if plugin is loaded\necho '{\"prompt\": \"/test-command\"}' | claude -p --output-format json | jq '.slash_commands'\n\n# Verify plugin commands appear as \"plugin-name:command-name\"\n```\n\n#### Plugin Implementation Approaches - Research Findings\n\n**Official Plugin Pattern** (Sources: [Agent SDK Overview](https://docs.claude.com/en/api/agent-sdk/overview), [Plugins](https://github.com/anthropics/claude-code/tree/main/plugins)):\n\nOfficial documentation states: *\"Slash Commands: Use custom commands defined as Markdown files in `./.claude/commands/`\"*\n\n- Plugins use **markdown files** in `commands/` directory\n- Example: `/new-sdk-app` is implemented as `new-sdk-app.md`\n- Markdown files contain prompts that tell Claude what to do\n- No executable scripts found in official plugins\n\n**Example: agent-sdk-dev Plugin** ([Source](https://github.com/anthropics/claude-code/blob/main/plugins/agent-sdk-dev/README.md)):\n\nPlugin Structure:\n```\nagent-sdk-dev/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îî‚îÄ‚îÄ new-sdk-app.md          # Main command - interactive project setup\n‚îú‚îÄ‚îÄ agents/\n‚îÇ   ‚îú‚îÄ‚îÄ agent-sdk-verifier-py   # Python verification agent\n‚îÇ   ‚îî‚îÄ‚îÄ agent-sdk-verifier-ts   # TypeScript verification agent\n‚îî‚îÄ‚îÄ README.md\n```\n\nHow It Works:\n1. **Command File** ([new-sdk-app.md](https://github.com/anthropics/claude-code/blob/main/plugins/agent-sdk-dev/commands/new-sdk-app.md)) contains:\n   - Detailed prompt with requirements gathering questions\n   - Step-by-step setup instructions\n   - Verification procedures\n   - Best practices and principles\n\n2. **Command Execution**:\n   - User runs `/new-sdk-app`\n   - Claude reads the markdown prompt\n   - Interactively asks questions one at a time\n   - Creates project files based on responses\n   - Runs verification agent to check setup\n\n3. **Key Principles from Official Plugin**:\n   - \"ALWAYS USE LATEST VERSIONS\"\n   - \"VERIFY CODE RUNS CORRECTLY\"\n   - Ask questions one at a time\n   - Use modern syntax and patterns\n   - Include proper error handling\n\nThis shows the official pattern: **Markdown files define prompts that guide Claude's behavior**, not executable code that processes commands.\n\n**Bash Integration in Slash Commands** ([Documentation](https://docs.claude.com/en/docs/claude-code/slash-commands)):\n\nCommands can execute bash scripts using the `!` prefix:\n\n```markdown\n---\nallowed-tools: Bash(git add:*), Bash(git status:*)\ndescription: Create a git commit\n---\n\n## Context\n- Current git status: !`git status`\n- Current branch: !`git branch --show-current`\n\n## Your task\nBased on the above changes, create a single git commit.\n```\n\n**How Bash Integration Works**:\n- Use `!` prefix before bash command in markdown\n- Must declare `allowed-tools` in frontmatter\n- Command output is included in context for Claude\n- Can call external scripts: `!`./scripts/my-script.sh``\n\n**Python Agent SDK** ([Documentation](https://docs.claude.com/en/api/agent-sdk/python), [README](https://github.com/anthropics/claude-agent-sdk-python), [client.py](https://github.com/anthropics/claude-agent-sdk-python/blob/main/src/claude_agent_sdk/client.py)):\n\nThe SDK provides direct communication with Claude Code:\n- `query()` - Async function for querying Claude Code directly\n- `ClaudeSDKClient()` - Advanced client for interactive conversations\n- `@tool` decorator - Define custom tools (in-process MCP servers)\n- Hooks support via `ClaudeAgentOptions`\n- `get_server_info()` - Can retrieve available commands from server\n\n**Key Quote from README**: *\"In-process MCP servers for custom tools - No subprocess management - Direct Python function calls with type safety\"*\n\nThis means Python code CAN communicate with Claude Code directly, but the documented pattern for slash commands is still markdown files that can call bash scripts.\n\n**Our Implementation** (Non-standard JSON Protocol):\n- Executable `commands/clautorun` script using JSON stdin/stdout protocol\n- Works when symlinked to `~/.claude/commands/clautorun`\n- Not recognized by plugin system's command discovery\n- Uses Agent SDK-style JSON communication pattern\n\n**Current Status**:\n- ‚ùå Plugin system doesn't auto-discover executable commands\n- ‚úÖ Executable works via manual symlink in `~/.claude/commands/`\n- ‚ùå No documentation found for executable-based plugin commands\n- ‚ö†Ô∏è May need to switch to markdown command files OR use hooks instead\n\n#### Possible Solutions\n\n1. **Bash Integration in Markdown** (RECOMMENDED - Official Pattern):\n   - Create markdown command files (e.g., `afs.md`, `afa.md`)\n   - Use `allowed-tools: Bash(...)` in frontmatter\n   - Call our executable with `!`echo '{\"prompt\": \"/afs\"}' | clautorun``\n   - Output becomes context for Claude's response\n   - Fully documented and supported approach\n\n2. **Use Hooks Instead**:\n   - UserPromptSubmit hooks can intercept commands programmatically\n   - Configure in plugin.json or hooks.json\n   - Can process commands before they reach Claude\n\n3. **Python SDK Direct Integration**:\n   - Use `ClaudeSDKClient()` with hooks support\n   - Create in-process tools with `@tool` decorator\n   - Communicate directly with Claude Code (no subprocess)\n\n4. **Direct Symlink** (Current Working Solution):\n   - Keep using `~/.claude/commands/` symlink\n   - Works but not discoverable via plugin system\n   - Non-standard but functional\n\n5. **Pure Markdown** (Simplest):\n   - Convert to pure prompts without executable code\n   - Example: `/afs` becomes a markdown prompt explaining strict-search policy\n   - Loses programmatic state management\n\n## Dependencies\n\n- `claude-agent-sdk>=0.1.4` - For Claude Code communication\n- `ruff>=0.14.1` - Code formatting and linting\n- Python 3.8+ - Required for type hints and async support\n\n## Configuration Notes\n\n**Session Storage:**\n- Uses shelve database for session persistence\n- Located in `~/.claude/sessions/`\n- State includes file policies and session status\n\n**Agent SDK Integration:**\n- Uses ClaudeAgentClient for communication\n- Session IDs maintain conversation context\n- Costs are tracked when using Claude Code APIs\n\n## Installation Management\n\n### Official Claude Code Plugin Management\n\n**GitHub Version Management:**\n```bash\n# Install or update from GitHub (recommended)\n/plugin install https://github.com/ahundt/clautorun.git\n\n# Update to latest version\n/plugin update clautorun\n\n# List installed plugins\n/plugin\n\n# Uninstall plugin\n/plugin uninstall clautorun\n```\n\n**Local Development Management:**\n```bash\n# Add/refresh local development marketplace\n/plugin marketplace add ./clautorun\n\n# Install or update local development version\n/plugin install clautorun@clautorun-dev\n\n# List available marketplaces\n/plugin marketplace list\n\n# Remove local marketplace when done\n/plugin marketplace remove clautorun-dev\n```\n\n**General Management:**\n```bash\n# List all installed plugins\n/plugin\n\n# Debug plugin loading issues\nclaude --debug\n\n# Browse available plugins in marketplaces\n/plugin\n```\n\n### UV Development Commands\n\nUV provides simple, clean commands for development:\n\n```bash\n# Install plugin (handles everything automatically)\nuv run clautorun install\n\n# Check installation status\nuv run clautorun check\n\n# Uninstall plugin\nuv run clautorun uninstall\n\n# Force reinstall (overwrites existing)\nuv run clautorun install --force\n```\n\n**Testing with UV:**\nSee the comprehensive [Testing](#testing) section above for all testing commands and approaches.\n\n**Python Environment Reminders:**\n- Always activate UV environment: `source .venv/bin/activate`\n- Or use explicit Python3: `python3 -m clautorun install`\n- The plugin inherits dependencies from the active Python environment\n- For production use, prefer the official `/plugin` commands\n\n**That's it!** But remember to activate virtual environment in each new terminal session:\n```bash\nsource .venv/bin/activate  # Must be done in each new terminal\n```\n\n## Companion Tools\n\nclautorun works well with these complementary tools for a complete development workflow. These tools solve different problems than clautorun and can be used alongside it.\n\n### Git Workflow Utilities\n\n**git-transfer-commits** - Cross-repository commit transfer\n- Transfer commits between repositories while preserving metadata\n- Uses `git format-patch` + `git am` for safe transfers\n- Useful for moving commits from backup/polluted repos to fresh clones\n- Usage: `/git-transfer-commits`\n\n**Why this is separate:** Git commit transfer is a cross-repository operation, while clautorun handles intra-repository session automation. Different domains, separate tools.\n\n### Security Hooks\n\n**Command Blocking System (Integrated in clautorun v0.6.0)** - General-purpose command blocking\n- **Built into clautorun** - No separate hook installation needed\n- Session-level commands: `/cr:no <pattern>`, `/cr:ok <pattern>`, `/cr:clear`, `/cr:status`\n- Global-level commands: `/cr:globalno <pattern>`, `/cr:globalok <pattern>`, `/cr:globalstatus`\n- Supports any command pattern (not just `rm`)\n- All block messages include \"To allow in this session: /cr:ok <pattern>\" instruction\n- Default integrations include installation instructions:\n  - `rm` ‚Üí trash CLI (`brew install trash` on macOS, or `go install github.com/andraschume/trash-cli@latest` on Linux)\n  - `rm -rf` ‚Üí trash CLI with warning about permanent deletion\n  - `git reset --hard` ‚Üí CRITICAL: Suggests safer git alternatives (git restore, git status)\n  - `dd if=` ‚Üí Suggests backup tools (rsync, ddrescue)\n  - `mkfs` ‚Üí Suggests GUI partition managers (GNOME Disks, gparted)\n  - `fdisk` ‚Üí Suggests GUI alternatives with backup reminder\n\n**Relationship to AutoFile:** AutoFile policies control ALL file creation (Write tool), while Command Blocking only affects specific Bash commands. Complementary scopes, no overlap.\n\n**Hookify Rules** - Pattern-based safety and guidance\n- `hookify.secrets.local.md` - Blocks hardcoded secrets\n- `hookify.dangerous-rm.local.md` - Warns about `rm -rf`\n- `hookify.block-sed-use-edit-tools.local.md` - Blocks sed with edit tools\n- `hookify.use-bun-not-npm.local.md` - Encourages bun over npm\n- `hookify.block-gh-pr-issue-create-comment.local.md` - Blocks direct GitHub API calls\n- Managed via `/hookify` command\n\n**Relationship to clautorun:** Hookify is a separate Claude Code plugin for creating custom hooks based on patterns. Can work alongside clautorun for additional safety.\n\n### Session Discovery\n\n**session-explorer** - Find and analyze Claude sessions\n- Discover sessions across tmux windows\n- Analyze conversation history\n- Usage: `/session-explorer`\n\n**Why this is separate:** Session discovery is an analysis tool for finding existing sessions, while clautorun creates and manages new autonomous sessions. Different purposes.\n\n## Troubleshooting\n\n**Official Plugin Installation Issues:**\n```bash\n# Check if plugin is installed\n/plugin\n\n# Debug plugin loading\nclaude --debug\n\n# Reinstall plugin (GitHub version)\n/plugin uninstall clautorun\n/plugin install https://github.com/ahundt/clautorun.git\n\n# Reinstall plugin (local development version)\n/plugin uninstall clautorun\n/plugin marketplace add ./clautorun\n/plugin install clautorun@clautorun-dev\n\n# Check plugin structure after installation\nls -la ~/.claude/plugins/clautorun/.claude-plugin/\nls -la ~/.claude/plugins/clautorun/commands/\n```\n\n**UV Installation Issues:**\n```bash\n# ‚ö†Ô∏è CRITICAL: First activate virtual environment\nsource .venv/bin/activate\n\n# Check installation status\nuv run clautorun check\n\n# Force reinstall if needed\nuv run clautorun install --force\n\n# Ensure dependencies are up to date\nuv sync --extra claude-code\n```\n\n**Python Environment Issues:**\n- **Automatic Version Detection**: clautorun now checks Python version and provides helpful error messages\n- **Error: \"PYTHON VERSION ERROR: clautorun requires Python 3.10 or higher\"** ‚Üí Follow the on-screen solutions\n- **Error: \"ImportError: No module named pathlib\"** ‚Üí You're using Python 2.7, use `python3` instead\n- **Error: \"dbm error: db type could not be determined\"** ‚Üí Normal for first run, plugin still works\n- **Solution**: Always activate UV environment: `source .venv/bin/activate`\n- **Alternative**: Use explicit Python3: `python3 -m clautorun check`\n\n**Built-in Python Version Checking:**\nclautorun includes comprehensive Python version validation:\n- **Python 2.x**: Blocked with clear error message and solutions\n- **Python 3.0-3.9**: Warning shown but functionality allowed\n- **Python 3.10+**: Full compatibility and no warnings\n- **Automatic Solutions**: Provides specific commands to fix Python version issues\n\n**Plugin not working:**\n- Verify the plugin installation: `uv run clautorun check`\n- Check plugin structure: `ls -la ~/.claude/plugins/clautorun/.claude-plugin/`\n- Check plugin permissions: `ls -la ~/.claude/plugins/clautorun/commands/`\n- Test plugin manually: `echo '{\"prompt\": \"/afs\", \"session_id\": \"test\"}' | ~/.claude/plugins/clautorun/commands/clautorun`\n\n**UV Environment Issues:**\n- Ensure UV is installed: `uv --version`\n- Check project structure: `ls pyproject.toml uv.lock`\n- Re-sync dependencies: `uv sync --extra claude-code`\n\n**Testing Issues:**\n- Run tests with UV: `uv run pytest tests/`\n- Check test coverage: `uv run pytest --cov=src/clautorun --cov-report=term-missing`\n\n**Common Solutions:**\n- Force reinstall: `uv run clautorun install --force`\n- Check installation: `uv run clautorun check`\n- Ensure UV is working: `uv run python --version`\n\n## Contributing and Sharing\n\nclautorun is an open source project that thrives on community contributions. If you find bugs, have suggestions, or create improvements, please consider sharing them with the community.\n\n### How to Share Your Improvements\n\n**Option 1: Submit a Pull Request**\n```bash\n# Fork the repository on GitHub\n# Clone your fork\ngit clone https://github.com/yourusername/clautorun.git\ncd clautorun\n\n# Add the original repository as upstream\ngit remote add upstream https://github.com/ahundt/clautorun.git\n\n# Create your improvement branch\ngit checkout -b feature/your-improvement\n\n# Make your changes, test them, then:\ngit add .\ngit commit -m \"Add your improvement description\"\n\n# Push to your fork\ngit push origin feature/your-improvement\n\n# Create pull request on GitHub\n```\n\n**Option 2: Report Issues**\n- **Bugs**: Use the [GitHub Issues](https://github.com/ahundt/clautorun/issues) page\n- **Feature requests**: Share ideas for new functionality\n- **Documentation**: Help improve clarity and completeness\n\n**Option 3: Share Knowledge**\n- Write blog posts about your clautorun workflows\n- Share screenshots of successful autonomous tasks\n- Document unique use cases and solutions\n- Help other users in discussions\n\n### Why Share?\n\n- **Help others**: Your improvements benefit the entire community\n- **Get feedback**: Community review makes your contributions stronger\n- **Build reputation**: Contributors are recognized in the project\n- **Improve the tool**: Shared knowledge makes clautorun better for everyone\n\n## License\n\nApache License 2.0 - see [LICENSE](LICENSE) file for details.\n\n### Custom Command Workflows\n\nYou can extend clautorun with your own command workflows by creating markdown files:\n\n#### Creating Custom Workflows\n1. Create a markdown file in `~/.claude/commands/` (e.g., `myworkflow.md`)\n2. Include `$ARGUMENTS` placeholder in the file to receive arguments\n3. Title must include `(/autorun: Your Methodology Name)`\n4. Use `/autorun myworkflow` to execute with your custom methodology\n\n#### Argument Handling\n- `$ARGUMENTS` in your command file gets replaced with everything after `/autorun`\n- Example: `/autorun myworkflow build database with migrations`\n- The `$ARGUMENTS` placeholder becomes: `\"build database with migrations\"`\n- Your workflow template can reference these arguments throughout\n\n#### Example Custom Command\nFile: `~/.claude/commands/debug.md`\n\n```markdown\n# Your Task (/autorun: Systematic Debugging)\n\n$ARGUMENTS - analyze and resolve technical issues using systematic debugging methodology\n\n1. Analyze the problem: $ARGUMENTS\n2. Use systematic debugging approach\n3. Document findings and solutions\n```\n\n",
        "plugins/plan-export/README.md": "# Plan Export Plugin\n\nAutomatically exports plan files to your project when exiting plan mode, with configurable output paths and filename patterns.\n\n## Features\n\n- **Automatic Export**: When you exit plan mode, the most recent plan is copied to your project\n- **Configurable Output**: Set custom directories and filename patterns with template variables\n- **Presets**: Quick configuration with 8 built-in presets\n- **Template Variables**: Use `{YYYY}`, `{MM}`, `{DD}`, `{name}`, etc. in paths\n- **Enable/Disable**: Control export behavior via slash commands\n\n## Installation\n\n### Option 1: Local Plugin\n\n```bash\n/plugin marketplace add ~/.claude/plugins/repos/plan-export\n/plugin install plan-export@plan-export\n```\n\n### Option 2: Direct Settings Integration\n\nAdd to your `~/.claude/settings.json` under `hooks`:\n\n```json\n\"PostToolUse\": [\n  {\n    \"matcher\": \"ExitPlanMode\",\n    \"hooks\": [\n      {\n        \"type\": \"command\",\n        \"command\": \"python3 ~/.claude/plugins/repos/plan-export/scripts/export-plan.py\",\n        \"timeout\": 30\n      }\n    ]\n  }\n]\n```\n\n## Commands\n\n| Command | Description |\n|---------|-------------|\n| `/plan-export:status` | Show current configuration |\n| `/plan-export:enable` | Enable automatic export |\n| `/plan-export:disable` | Disable automatic export |\n| `/plan-export:configure` | Interactive configuration help |\n| `/plan-export:presets` | List available presets |\n| `/plan-export:preset <name>` | Apply a preset (e.g., `dated`, `docs`) |\n| `/plan-export:dir <path>` | Set output directory |\n| `/plan-export:pattern <pattern>` | Set filename pattern |\n| `/plan-export:reset` | Reset to defaults |\n\n## Template Variables\n\nUse these in both `dir` and `pattern`:\n\n| Variable | Description | Example |\n|----------|-------------|---------|\n| `{YYYY}` | 4-digit year | 2025 |\n| `{YY}` | 2-digit year | 25 |\n| `{MM}` | Month (01-12) | 12 |\n| `{DD}` | Day (01-31) | 10 |\n| `{date}` | Full date | 2025_12_10 |\n| `{name}` | Plan name from heading | implement_auth |\n| `{original}` | Original filename | fuzzy-dancing-star |\n\n## Presets\n\n| Preset | Output | Description |\n|--------|--------|-------------|\n| `default` | `notes/YYYY_MM_DD_name.md` | Standard (default) |\n| `plans` | `plans/YYYY_MM_DD_name.md` | Plans folder |\n| `docs` | `docs/plans/YYYY_MM_DD_name.md` | Documentation |\n| `dated` | `notes/YYYY/MM/DD_name.md` | Date hierarchy |\n| `yearly` | `notes/YYYY/MM_DD_name.md` | Yearly folders |\n| `simple` | `notes/name.md` | Name only (may overwrite!) |\n| `archive` | `.archive/plans/YYYY/date_name.md` | Hidden archive |\n| `original` | `notes/YYYY_MM_DD_original.md` | Keep original name |\n\n## Examples\n\n### Date-organized hierarchy\n```bash\n/plan-export:preset dated\n# Creates: notes/2025/12/10_my_plan.md\n```\n\n### Custom configuration\n```bash\n/plan-export:dir docs/decisions/{YYYY}\n/plan-export:pattern {MM}_{DD}_{name}\n# Creates: docs/decisions/2025/12_10_my_plan.md\n```\n\n### Keep original Claude plan names\n```bash\n/plan-export:preset original\n# Creates: notes/2025_12_10_fuzzy-dancing-star.md\n```\n\n## Configuration File\n\nSettings are stored in `~/.claude/plan-export.config.json`:\n\n```json\n{\n  \"enabled\": true,\n  \"output_dir\": \"notes\",\n  \"filename_pattern\": \"{date}_{name}\",\n  \"extension\": \".md\"\n}\n```\n\n## How It Works\n\n1. When you exit plan mode (ExitPlanMode tool), the PostToolUse hook fires\n2. The script finds the most recently modified plan in `~/.claude/plans/`\n3. It extracts a useful name from the plan's first heading\n4. Template variables are expanded in the output path\n5. The plan is copied to the configured location\n\n## Files\n\n```\nplan-export/\n‚îú‚îÄ‚îÄ .claude-plugin/\n‚îÇ   ‚îî‚îÄ‚îÄ plugin.json\n‚îú‚îÄ‚îÄ commands/\n‚îÇ   ‚îú‚îÄ‚îÄ configure.md\n‚îÇ   ‚îú‚îÄ‚îÄ dir.md\n‚îÇ   ‚îú‚îÄ‚îÄ disable.md\n‚îÇ   ‚îú‚îÄ‚îÄ enable.md\n‚îÇ   ‚îú‚îÄ‚îÄ pattern.md\n‚îÇ   ‚îú‚îÄ‚îÄ preset.md\n‚îÇ   ‚îú‚îÄ‚îÄ presets.md\n‚îÇ   ‚îú‚îÄ‚îÄ reset.md\n‚îÇ   ‚îî‚îÄ‚îÄ status.md\n‚îú‚îÄ‚îÄ hooks/\n‚îÇ   ‚îî‚îÄ‚îÄ hooks.json\n‚îú‚îÄ‚îÄ scripts/\n‚îÇ   ‚îú‚îÄ‚îÄ config.py\n‚îÇ   ‚îî‚îÄ‚îÄ export-plan.py\n‚îî‚îÄ‚îÄ README.md\n```\n",
        "plugins/pdf-extractor/README.md": "# PDF Extractor Plugin\n\nExtract text and structured data from PDF documents using a multi-backend approach with automatic fallback.\n\n## Installation\n\n```bash\ncd ~/.claude/clautorun/plugins/pdf-extractor\nuv venv\nsource .venv/bin/activate\nuv pip install -e .\n```\n\nFor GPU-accelerated backends (docling, marker):\n```bash\nuv pip install -e \".[gpu]\"\n```\n\n## Usage\n\n### Single File\n```bash\nextract-pdfs document.pdf\n# Output: document.md\n```\n\n### Batch Directory\n```bash\nextract-pdfs /path/to/pdfs/ /path/to/output/\n```\n\n### Custom Backend Order\n```bash\nextract-pdfs document.pdf --backends pdfplumber markitdown pdfminer\n```\n\n### List Available Backends\n```bash\nextract-pdfs --list-backends\n```\n\n### Python API\n```python\nfrom pdf_extraction import extract_single_pdf, pdf_to_txt\n\nresult = extract_single_pdf(\"document.pdf\", \"output.md\")\nfiles, metadata = pdf_to_txt(\"./pdfs/\", \"./output/\", return_metadata=True)\n```\n\n## Available Backends\n\n| Backend | License | Best For |\n|---------|---------|----------|\n| markitdown | MIT | General text, forms |\n| pdfplumber | MIT | Tables, structured data |\n| pdfminer | MIT | Simple text documents |\n| pypdf2 | BSD-3 | Basic extraction |\n| docling | MIT | Layout analysis (GPU) |\n| marker | GPL-3.0 | Scanned documents (GPU) |\n| pymupdf4llm | AGPL-3.0 | LLM-optimized output |\n| pdfbox | Apache-2.0 | Tables (Java-based) |\n| pdftotext | System | Simple text (CLI) |\n\n## Skill Triggers\n\nThis skill activates when you ask to:\n- \"extract text from PDF\"\n- \"convert PDF to markdown\"\n- \"parse PDF contents\"\n- \"read this PDF file\"\n- \"batch extract PDFs\"\n\n## License\n\nMIT\n"
      },
      "plugins": [
        {
          "name": "clautorun",
          "description": "Autonomous task automation with file creation policies and session persistence",
          "source": "./plugins/clautorun",
          "category": "productivity",
          "version": "0.6.0",
          "author": {
            "name": "Andrew Hundt",
            "email": "ATHundt@gmail.com"
          },
          "categories": [
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add ahundt/clautorun",
            "/plugin install clautorun@clautorun-dev"
          ]
        },
        {
          "name": "plan-export",
          "description": "Automatically exports plan files to project notes when exiting plan mode",
          "source": "./plugins/plan-export",
          "category": "productivity",
          "version": "1.0.0",
          "author": {
            "name": "Andrew Hundt",
            "email": "ATHundt@gmail.com"
          },
          "categories": [
            "productivity"
          ],
          "install_commands": [
            "/plugin marketplace add ahundt/clautorun",
            "/plugin install plan-export@clautorun-dev"
          ]
        },
        {
          "name": "pdf-extractor",
          "description": "PDF data extraction with 9 backend support (markitdown, docling, marker, pdfplumber, pdfminer, pypdf2, pymupdf4llm, pdfbox, pdftotext)",
          "source": "./plugins/pdf-extractor",
          "category": "data-processing",
          "version": "0.1.0",
          "author": {
            "name": "Andrew Hundt",
            "email": "ATHundt@gmail.com"
          },
          "categories": [
            "data-processing"
          ],
          "install_commands": [
            "/plugin marketplace add ahundt/clautorun",
            "/plugin install pdf-extractor@clautorun-dev"
          ]
        }
      ]
    }
  ]
}